.\" Automatically generated by Podwrapper::Man 1.36.5 (Pod::Simple 3.35)
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" Set up some character translations and predefined strings.  \*(-- will
.\" give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
.\" double quote, and \*(R" will give a right double quote.  \*(C+ will
.\" give a nicer C++.  Capital omega is used to do unbreakable dashes and
.\" therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
.\" nothing in troff, for use with C<>.
.tr \(*W-
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.ie n \{\
.    ds -- \(*W-
.    ds PI pi
.    if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.    if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\"  diablo 12 pitch
.    ds L" ""
.    ds R" ""
.    ds C` ""
.    ds C' ""
'br\}
.el\{\
.    ds -- \|\(em\|
.    ds PI \(*p
.    ds L" ``
.    ds R" ''
.    ds C`
.    ds C'
'br\}
.\"
.\" Escape single quotes in literal strings from groff's Unicode transform.
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\"
.\" If the F register is >0, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.SS), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.\"
.\" Avoid warning from groff about undefined register 'F'.
.de IX
..
.if !\nF .nr F 0
.if \nF>0 \{\
.    de IX
.    tm Index:\\$1\t\\n%\t"\\$2"
..
.    if !\nF==2 \{\
.        nr % 0
.        nr F 2
.    \}
.\}
.\" ========================================================================
.\"
.IX Title "guestfs-release-notes 1"
.TH guestfs-release-notes 1 "2017-06-22" "libguestfs-1.36.5" "Virtualization Support"
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.if n .ad l
.nh
.SH "名前"
.IX Header "名前"
guestfs-release-notes \- libguestfs リリースノート
.SH "RELEASE NOTES FOR LIBGUESTFS 1.36"
.IX Header "RELEASE NOTES FOR LIBGUESTFS 1.36"
These release notes only cover the differences from the previous stable/dev
branch split (1.34.0).  For detailed changelogs, please see the git
repository, or the ChangeLog file distributed in the tarball.
.SS "New features"
.IX Subsection "New features"
\fINew tools\fR
.IX Subsection "New tools"
.PP
Virt-tail is a new tool for following (tailing) log files within a guest,
similar to the regular \f(CW\*(C`tail \-f\*(C'\fR command.
.PP
\fINew features in existing tools\fR
.IX Subsection "New features in existing tools"
.PP
Virt-customize, virt-get-kernel, virt-sparsify and virt-sysprep can now
handle encrypted guests (Pino Toscano).
.PP
Virt-builder and virt-customize now support \fI\-\-append\-line\fR, which is
useful for adding lines to the end of configuration files.
.PP
Virt-resize can now shrink and expand swap partitions (Pino Toscano).
.PP
Virt-resize can now output to non-local disks (Pino Toscano).
.PP
Virt-sysprep has a new operation called \f(CW\*(C`backup\-files\*(C'\fR for removing editor
backups, and \f(CW\*(C`passwd\-backups\*(C'\fR for removing \fI/etc/passwd\-\fR and similar.
.PP
Virt-dib can now create checksums using the new \fI\-\-checksum\fR option (Pino
Toscano).
.PP
Virt-dib can now create tgz files.  In addition, extended attributes and
SELinux labels are preserved in the output tar file (Pino Toscano).
.PP
Virt-dib can now create squashfs files (Pino Toscano).
.PP
Bash tab-completion is now available in every command line tool that is
shipped.
.PP
\fIvirt\-v2v and virt\-p2v\fR
.IX Subsection "virt-v2v and virt-p2v"
.PP
Conversions of Debian (6+) and Ubuntu (10.04+) guests are now supported
(Tomáš Golembiovský, Pino Toscano).
.PP
Conversions from \s-1SUSE\s0 Xen hypervisor have now been tested (Cédric
Bosdonnat).
.PP
Windows conversions may now install a program \f(CW\*(C`pnp_wait.exe\*(C'\fR which prevents
conflicts between the Windows Plug-and-Play Manager and our own scripts that
install virtio device drivers.  Enabling this requires the \f(CW\*(C`pnp_wait.exe\*(C'\fR
program to be built separately (Roman Kagan).
.PP
\&\s-1OVA\s0 files exported from \s-1AWS\s0 can now be converted (Shahar Havivi).
.PP
When converting \s-1OVA\s0 files, in some circumstances virt\-v2v can now read disk
images directly from the \s-1OVA\s0 input file instead of needing to unpack the \s-1OVA\s0
file to a temporary directory.  This can save large amounts of disk space,
and is quicker (Tomáš Golembiovský).
.PP
Virt\-p2v can now be built on \s-1RHEL 5\s0 (2007\-era) Linux and \s-1RHEL 6,\s0 which means
that 32 bit and hardware with ancient fakeraid disks can be virtualized.
Binaries of virt\-p2v based on these old versions of \s-1RHEL\s0 can be found at
http://oirase.annexia.org/virt\-p2v/
.PP
Virt\-p2v can now use nbdkit (an \s-1NBD\s0 server) as an alternative to qemu-nbd.
In addition, virt\-p2v can use \*(L"socket activation\*(R" which is a more robust
method for opening the \s-1NBD\s0 listening socket.  Socket activation works with
qemu-nbd or nbdkit, but requires the most up to date versions.
.PP
To prevent timeouts during P2V conversions, virt\-p2v inhibits power saving
on the physical machine, and also sends ping packets over the ssh control
and data connections.
.PP
Virt\-v2v no longer removes the \f(CW\*(C`Processor\*(C'\fR and \f(CW\*(C`Intelppm\*(C'\fR nodes from the
Windows Registry.
.PP
Xen and vCenter conversions can now be done using the libvirt backend,
provided libvirt ≥ 2.1.0 is used.
.PP
\&\fI/dev/srX\fR (\s-1SCSI\s0 CD-ROM) devices are ignored (Tomáš Golembiovský).
.PP
When converting \s-1SUSE\s0 Linux guests, use \fI/etc/modprobe.conf.local\fR if it
exists.
.PP
Removing VMware tools from Linux guests should now work reliably (Pino
Toscano).
.PP
When converting \s-1OVA\s0 files, virt\-v2v now checks the disk image hash contained
in the manifest file, whereas previously it was ignored because of a mistake
in the code.  In addition, \s-1SHA256\s0 hashes are now supported (Tomáš
Golembiovský).
.PP
When converting \s-1OVA\s0 files that contain compressed disk images, we now trust
the \f(CW\*(C`ovf:compression\*(C'\fR attribute from the metadata instead of using content
sniffing on the disk image (Tomáš Golembiovský).
.PP
A new flag \fI\-\-vdsm\-compat\fR has been added to \fI\-o vdsm\fR mode, allowing more
efficient qcow2 images to be generated.
.PP
Since the \s-1RHEV\s0 product [commercially supported version of oVirt] has now
been renamed to \s-1RHV, \*(L"RHEV\*(R"\s0 was changed to \*(L"\s-1RHV\*(R"\s0 throughout the tooling.  In
particular, \fI\-o rhev\fR becomes \fI\-o rhv\fR, although the old name can be used
for backwards compatibility.
.PP
The \f(CW\*(C`RHEV\-APT\*(C'\fR utility is only installed when the output hypervisor is
oVirt or \s-1RHV.\s0
.PP
A problem with virt\-v2v running out of memory when doing an SELinux relabel
of the guest filesystem should now be resolved.
.PP
\fILanguage bindings\fR
.IX Subsection "Language bindings"
.PP
Setting \f(CW\*(C`EXTRA_JAVAC_FLAGS\*(C'\fR before \fI./configure\fR allows you to add
arbitrary flags to \f(CW\*(C`javac\*(C'\fR when compiling the Java bindings.
.PP
Use of any libguestfs \s-1API\s0 which returned a single struct, from Perl or Java
bindings, would have leaked memory.  This has now been fixed (Pino Toscano).
.PP
\fIInspection\fR
.IX Subsection "Inspection"
.PP
Inspection of Windows guests with mildly corrupted Windows Registry hives
should now work instead of failing with an error.  This feature requires
hivex ≥ 1.3.14 (Dawid Zamirski).
.PP
For Debian guests, we can now read the \s-1URL,\s0 source name, summary and full
description of installed packages.  For RPM-based guests we can read the
\&\s-1URL,\s0 summary and description (Pino Toscano).
.PP
Inspection of guest operating systems that use a separate \fI/usr\fR partition
should now work more reliably (Pino Toscano).
.PP
When parsing guest \fI/etc/fstab\fR, paths are reduced to a canonical form
(eg. \f(CW"///usr//local//"\fR → \f(CW"/usr/local"\fR).
.PP
Inspection of btrfs subvolumes now works where the \fI/etc/fstab\fR options
field contains commas.
.PP
\&\fI/dev/cdN\fR devices in guest \fI/etc/fstab\fR are ignored (Pino Toscano).
.PP
\fIArchitectures and platforms\fR
.IX Subsection "Architectures and platforms"
.PP
Stable releases are now tested on aarch64, ppc64 and ppc64le architectures.
.PP
The RISC-V architecture is now handled as a guest, and libguestfs will now
at least compile on RISC-V (but probably not work as there is no usable qemu
at the time of writing).
.PP
Detection of S/390 and S/390x binaries and guests is now supported.
.PP
\fIOther\fR
.IX Subsection "Other"
.PP
ExFAT filesystems are now supported (Miles Wolbe).
.SS "Security"
.IX Subsection "Security"
See also \fIguestfs\-security\fR\|(1).
.PP
There were no CVEs reported in this development cycle.  However some
security-related hardening was carried out as described below.
.PP
Temporary filenames are now always generated using randomness from
\&\fI/dev/urandom\fR (previously the C function \fIrandom\fR\|(3) was used in one
case).
.PP
The \f(CW$TERM\fR environment variable is now validated before passing it through
to the appliance kernel command line.
.SS "\s-1API\s0"
.IX Subsection "API"
\fINew APIs\fR
.IX Subsection "New APIs"
.ie n .IP """guestfs_aug_transform""" 4
.el .IP "\f(CWguestfs_aug_transform\fR" 4
.IX Item "guestfs_aug_transform"
Exposes the Augeas \f(CW\*(C`aug_transform\*(C'\fR \s-1API\s0 (Pino Toscano).
.ie n .IP """guestfs_find_inode""" 4
.el .IP "\f(CWguestfs_find_inode\fR" 4
.IX Item "guestfs_find_inode"
Find files by inode number (Matteo Cafasso).
.ie n .IP """guestfs_inspect_get_windows_software_hive""" 4
.el .IP "\f(CWguestfs_inspect_get_windows_software_hive\fR" 4
.IX Item "guestfs_inspect_get_windows_software_hive"
.PD 0
.ie n .IP """guestfs_inspect_get_windows_system_hive""" 4
.el .IP "\f(CWguestfs_inspect_get_windows_system_hive\fR" 4
.IX Item "guestfs_inspect_get_windows_system_hive"
.PD
Return the path to the Windows \f(CW\*(C`HKLM\eSYSTEM\*(C'\fR and \f(CW\*(C`HKLM\eSOFTWARE\*(C'\fR hives
computed during inspection.
.ie n .IP """guestfs_mksquashfs""" 4
.el .IP "\f(CWguestfs_mksquashfs\fR" 4
.IX Item "guestfs_mksquashfs"
Create a squashfs filesystem from a path (Pino Toscano).
.PP
\fIOther \s-1API\s0 changes\fR
.IX Subsection "Other API changes"
.ie n .IP """guestfs_add_domain""" 4
.el .IP "\f(CWguestfs_add_domain\fR" 4
.IX Item "guestfs_add_domain"
This call now handles libvirt file-based volumes correctly, where previously
these would have been ignored.  Also handled are disks which require libvirt
authentication secrets to open (Pino Toscano).
.ie n .IP """guestfs_canonical_device_name""" 4
.el .IP "\f(CWguestfs_canonical_device_name\fR" 4
.IX Item "guestfs_canonical_device_name"
This call will no longer incorrectly modify Linux software \s-1RAID\s0 device names
(like \fI/dev/mdX\fR).
.ie n .IP """guestfs_file_architecture""" 4
.el .IP "\f(CWguestfs_file_architecture\fR" 4
.IX Item "guestfs_file_architecture"
Previously the \f(CW\*(C`file_architecture\*(C'\fR \s-1API\s0 could return either of the strings
\&\f(CW\*(C`i386\*(C'\fR or \f(CW\*(C`i486\*(C'\fR for 32 bit x86 binaries.  It now only returns \f(CW\*(C`i386\*(C'\fR (as
documented).
.Sp
This \s-1API\s0 can now return the following new values: \f(CW\*(C`riscv32\*(C'\fR, \f(CW\*(C`riscv64\*(C'\fR,
\&\f(CW\*(C`riscv128\*(C'\fR, \f(CW\*(C`s390\*(C'\fR, \f(CW\*(C`s390x\*(C'\fR.
.ie n .IP """guestfs_hivex_open""" 4
.el .IP "\f(CWguestfs_hivex_open\fR" 4
.IX Item "guestfs_hivex_open"
This now has an optional \f(CW\*(C`GUESTFS_HIVEX_OPEN_UNSAFE\*(C'\fR flag which allows
certain corrupted Windows Registry hives to be opened.  This feature
requires hivex ≥ 1.3.14 (Dawid Zamirski).
.ie n .IP """guestfs_list_partitions""" 4
.el .IP "\f(CWguestfs_list_partitions\fR" 4
.IX Item "guestfs_list_partitions"
This call now returns Linux software \s-1RAID\s0 partitions.
.ie n .IP """guestfs_part_to_dev""" 4
.el .IP "\f(CWguestfs_part_to_dev\fR" 4
.IX Item "guestfs_part_to_dev"
This call now correctly handles partition names which include
\&\f(CW\*(C`p<N>\*(C'\fR (Pino Toscano).
.ie n .IP """guestfs_set_label""" 4
.el .IP "\f(CWguestfs_set_label\fR" 4
.IX Item "guestfs_set_label"
This call can now change the labels of swap partitions (Pino Toscano).
.SS "Build changes"
.IX Subsection "Build changes"
libmagic, the library part of the \f(CW\*(C`file\*(C'\fR command, is now required at build
time (previously optional).
.PP
\&\s-1GCC 7\s0 is now supported.
.PP
\&\*(L"Silent rules\*(R" are now used for OCaml programs, Java bindings.  To show the
full command line executed, add \f(CW\*(C`V=1\*(C'\fR on the make command line (Pino
Toscano).
.PP
Slow testing (\f(CW\*(C`make check\-slow\*(C'\fR) now covers: firstboot scripts in Linux
guests; v2v conversion of a selection of real Linux guests; the
virt-customize \fI\-\-hostname\fR and \fI\-\-timezone\fR settings; the
\&\fI\-\-root\-password\fR parameter; that the serial console works in virt-builder
guests.
.PP
Large generated C source files, eg. the list of commands found in
\&\fIfish/cmds.c\fR (and many more), have been split into smaller files to speed
parallel compilation.
.PP
\&\f(CW\*(C`make maintainer\-check\-extra\-dist\*(C'\fR now checks that all generated files are
included in the tarball.
.PP
The tests no longer assume that \f(CW\*(C`.\*(C'\fR is in Perl's \f(CW@INC\fR, as it is going to
be removed soon (Pino Toscano).
.PP
Debian hosts using UsrMerge are now supported (Pino Toscano).
.PP
Header files and C structs can now have internal documentation using the
special \f(CW\*(C`/** ... */\*(C'\fR comments.
.PP
\&\f(CW\*(C`@VAR@\*(C'\fR subtitutions in \f(CW\*(C`./run\*(C'\fR are now fully quoted.  This is necessary
so that (eg) \f(CW\*(C`./configure PYTHON=/some/path\*(C'\fR works robustly if
\&\f(CW\*(C`/some/path\*(C'\fR contains characters that need to be quoted (Hilko Bengen).
.PP
gperf ≥ 3.1 is now supported.
.PP
Kraxel's old edk2 builds can no longer be used for \s-1UEFI\s0 support.  \s-1UEFI\s0 code
is now fully free software, so use the versions bundled with your Linux
distro instead.
.PP
Virt\-p2v can now be compiled on \s-1RHEL 5\s0 (2007\-era) Linux with Gtk 2.10.
.SS "内部"
.IX Subsection "内部"
The generator and mllib \f(CW\*(C`Common_utils\*(C'\fR modules are now shared from the same
source file.
.PP
A considerable amount of common code has been moved into the \fIcommon\fR
directory in the source and is now compiled only once.  The mini-libraries
located under here are: \fIcommon/edit\fR, \fIcommon/errnostring\fR,
\&\fIcommon/miniexpect\fR, \fIcommon/options\fR, \fIcommon/parallel\fR,
\&\fIcommon/progress\fR, \fIcommon/protocol\fR, \fIcommon/utils\fR, \fIcommon/visit\fR,
\&\fIcommon/windows\fR.
.PP
The directory containing the main library code has moved from \fIsrc\fR →
\&\fIlib\fR.
.PP
All tests written in shell script now use a common file of utility functions
(\fItests/test\-functions.sh\fR).  There are several new utility functions,
mainly for skipping tests.  Also these test scripts can now use
autoconf-like path variables like \f(CW$abs_top_srcdir\fR.
.PP
\&\s-1UEFI\s0 paths are now stored in the generator (\fIgenerator/uefi.ml\fR).
.PP
The way the generator handles actions and procedure numbers was changed
quite substantially.  See \fIgenerator/actions_*.ml\fR and
\&\fIgenerator/proc_nr.ml\fR.
.PP
The gnulib \f(CW\*(C`getprogname\*(C'\fR module is now used everywhere when
needing/printing the program name (Pino Toscano).
.PP
\&\fIperl/Guestfs.c\fR is not translatable (Nikos Skalkotos).
.PP
Virt-builder templates moved from \fIbuilder/website\fR to \fIbuilder/templates\fR
and there is now a single unified program which can build any template.
.PP
All Windows registry utilities used by virt-customize and virt\-v2v have been
moved to a common module called \f(CW\*(C`Registry\*(C'\fR under \fImllib\fR.
.PP
All \s-1POSIX\s0 bindings have been moved to a new module called \f(CW\*(C`Unix_utils\*(C'\fR
under \fImllib\fR.
.PP
Inspection, virt-customize and virt\-v2v no longer recompute the Windows
\&\f(CW\*(C`%systemroot%\*(C'\fR, \f(CW\*(C`CurrentControlSet\*(C'\fR or paths to the \f(CW\*(C`HKLM\eSYSTEM\*(C'\fR and
\&\f(CW\*(C`HKLM\eSOFTWARE\*(C'\fR hives in multiple places.  Instead these are all computed
once (during inspection) and passed to the other tools through various
\&\f(CW\*(C`guestfs_inspect_get_windows_*\*(C'\fR APIs.
.PP
\&\f(CW\*(C`/dev/pts\*(C'\fR is now available inside the appliance, so any tools we run which
require a pty will now work (Pino Toscano).
.PP
Most OCaml warnings have been fixed.
.PP
There is now a single common function for creating temporary files
(\f(CW\*(C`guestfs_int_make_temp_path\*(C'\fR) (Matteo Cafasso).
.PP
The \f(CW$TERM\fR environment variable is now validated before passing it through
to the appliance kernel command line.
.PP
Useless \s-1USB\s0 and memballoon devices are no longer created in the appliance
(Laine Stump).
.PP
On aarch64 we now use virtio-pci for the appliance.  This is somewhat faster
than virtio-mmio.
.PP
Use of \fIsrandom\fR\|(3) and \fIrandom\fR\|(3) has been minimized.  In particular,
temporary filenames are no longer created based on randomness returned by
\&\fIrandom\fR\|(3), but \fI/dev/urandom\fR is used instead.
.SS "バグ修正"
.IX Subsection "バグ修正"
.IP "https://bugzilla.redhat.com/1425306" 4
.IX Item "https://bugzilla.redhat.com/1425306"
typo error in virt-tail man page
.IP "https://bugzilla.redhat.com/1418283" 4
.IX Item "https://bugzilla.redhat.com/1418283"
virt\-v2v: appliance runs out of memory running setfiles command
.IP "https://bugzilla.redhat.com/1417549" 4
.IX Item "https://bugzilla.redhat.com/1417549"
/usr/bin/x86_64\-linux\-gnu\-ld.bfd.real:
\&../common/progress/.libs/libprogress.a(libprogress_la\-progress.o): undefined
reference to symbol 'UP@@NCURSES_TINFO_5.0.19991023'
.IP "https://bugzilla.redhat.com/1417444" 4
.IX Item "https://bugzilla.redhat.com/1417444"
*** No rule to make target '../perl/lib/Sys/Guestfs.c', needed by
\&'libguestfs.pot'
.IP "https://bugzilla.redhat.com/1416941" 4
.IX Item "https://bugzilla.redhat.com/1416941"
compile of 1.34.3 fails with gperf 3.1
.IP "https://bugzilla.redhat.com/1414682" 4
.IX Item "https://bugzilla.redhat.com/1414682"
guestfs_canonical_device_name incorrectly returns /dev/sd0 for \s-1MD\s0 devices
(/dev/md0)
.IP "https://bugzilla.redhat.com/1414510" 4
.IX Item "https://bugzilla.redhat.com/1414510"
guestfs_list_filesystems does not recognize ddf partitions
.IP "https://bugzilla.redhat.com/1409023" 4
.IX Item "https://bugzilla.redhat.com/1409023"
[Debian] ldmtool not installed in the appliance
.IP "https://bugzilla.redhat.com/1404287" 4
.IX Item "https://bugzilla.redhat.com/1404287"
qemu-kvm cannot boot \s-1RHEL 7\s0 kernel with \s-1TCG,\s0 hangs at \*(L"Probing \s-1EDD\s0 (edd=off
to disable)...\*(R"
.IP "https://bugzilla.redhat.com/1404182" 4
.IX Item "https://bugzilla.redhat.com/1404182"
\&\s-1RFE:\s0 virt-resize should support a \s-1URL\s0 as the outdisk
.IP "https://bugzilla.redhat.com/1401474" 4
.IX Item "https://bugzilla.redhat.com/1401474"
Importing VMs from VMware is failing with error \*(L"Inspection field 'i_arch'
was 'unknown'\*(R"
.IP "https://bugzilla.redhat.com/1401320" 4
.IX Item "https://bugzilla.redhat.com/1401320"
\&\s-1RFE:\s0 Increate virt-sysprep coverage a bit
.IP "https://bugzilla.redhat.com/1400205" 4
.IX Item "https://bugzilla.redhat.com/1400205"
Add \-\-vdsm\-compat=1.1 flag for \s-1VDSM\s0
.IP "https://bugzilla.redhat.com/1398070" 4
.IX Item "https://bugzilla.redhat.com/1398070"
typo error in man page
.IP "https://bugzilla.redhat.com/1392798" 4
.IX Item "https://bugzilla.redhat.com/1392798"
secrets from libvirt domains are not read
.IP "https://bugzilla.redhat.com/1390876" 4
.IX Item "https://bugzilla.redhat.com/1390876"
\&\*(L"\-\-machine\-readable\*(R" info should be updated in virt\-v2v manual page
.IP "https://bugzilla.redhat.com/1379289" 4
.IX Item "https://bugzilla.redhat.com/1379289"
\&\s-1RFE:\s0 virt\-p2v should support mnemonic operations
.IP "https://bugzilla.redhat.com/1378022" 4
.IX Item "https://bugzilla.redhat.com/1378022"
There is virt\-v2v warning about <listen type='none'> during converting a
guest which has listen type='none' in \s-1XML\s0
.IP "https://bugzilla.redhat.com/1377081" 4
.IX Item "https://bugzilla.redhat.com/1377081"
virt\-p2v manual should update the new dialog information
.IP "https://bugzilla.redhat.com/1375157" 4
.IX Item "https://bugzilla.redhat.com/1375157"
virt\-v2v: \-i ova: Permission denied when using libvirt and running as root
.IP "https://bugzilla.redhat.com/1374651" 4
.IX Item "https://bugzilla.redhat.com/1374651"
Can't install qxl driver for display device in win7 guest after converting
to glance by virt\-v2v
.IP "https://bugzilla.redhat.com/1374405" 4
.IX Item "https://bugzilla.redhat.com/1374405"
There is \s-1HTTP 404\s0 error info when convert guest to glance by virt\-v2v
.IP "https://bugzilla.redhat.com/1374232" 4
.IX Item "https://bugzilla.redhat.com/1374232"
selinux relabel fails on \s-1RHEL 6.2\s0 guests with \*(L"libguestfs error:
selinux_relabel: : Success\*(R"
.IP "https://bugzilla.redhat.com/1372668" 4
.IX Item "https://bugzilla.redhat.com/1372668"
Process status is not normal in windows guest after converted from kvm to
rhev by virt\-v2v
.IP "https://bugzilla.redhat.com/1372269" 4
.IX Item "https://bugzilla.redhat.com/1372269"
Builder does not set hostname properly for Debian 8 (Jessie)
.IP "https://bugzilla.redhat.com/1371843" 4
.IX Item "https://bugzilla.redhat.com/1371843"
Improve \s-1OVA\s0 import compatibility
.IP "https://bugzilla.redhat.com/1370424" 4
.IX Item "https://bugzilla.redhat.com/1370424"
virt-manager coredump when vm with gluster image exists
.IP "https://bugzilla.redhat.com/1367839" 4
.IX Item "https://bugzilla.redhat.com/1367839"
Cannot import VMs from Xen and VMware when using \s-1RHEL7.3\s0 host.
.IP "https://bugzilla.redhat.com/1367738" 4
.IX Item "https://bugzilla.redhat.com/1367738"
Missing bash completion scripts for: virt-diff guestunmount virt-copy-in
virt-copy-out virt-customize virt-get-kernel virt\-p2v\-make\-disk
virt\-p2v\-make\-kickstart virt-tar-in virt-tar-out virt\-v2v\-copy\-to\-local
virt-win-reg
.IP "https://bugzilla.redhat.com/1367615" 4
.IX Item "https://bugzilla.redhat.com/1367615"
\&\s-1OVMF\s0 file which is built for rhel7.3 can't be used for virt\-v2v uefi
conversion
.IP "https://bugzilla.redhat.com/1366456" 4
.IX Item "https://bugzilla.redhat.com/1366456"
Converting rhel7 host installed on RAID:warning: fstrim: fstrim: /sysroot/:
the discard operation is not supported
.IP "https://bugzilla.redhat.com/1366049" 4
.IX Item "https://bugzilla.redhat.com/1366049"
\&\s-1RFE:\s0 libvirt backend: support handling disks stored as volume name in a pool
.IP "https://bugzilla.redhat.com/1365005" 4
.IX Item "https://bugzilla.redhat.com/1365005"
Guest name is incorrect if convert guest from disk image by virt\-v2v
.IP "https://bugzilla.redhat.com/1362649" 4
.IX Item "https://bugzilla.redhat.com/1362649"
\&\s-1RFE:\s0 virt-sysprep does not utilize libguestfs encryption support
.IP "https://bugzilla.redhat.com/1354507" 4
.IX Item "https://bugzilla.redhat.com/1354507"
virt\-v2v conversions from vCenter do not consistently obey the proxy
environment variables
.IP "https://bugzilla.redhat.com/1168144" 4
.IX Item "https://bugzilla.redhat.com/1168144"
warning: fstrim: fstrim: /sysroot/: \s-1FITRIM\s0 ioctl failed: Operation not
supported (ignored) when convert win2003 guest from xen server
.IP "https://bugzilla.redhat.com/1161019" 4
.IX Item "https://bugzilla.redhat.com/1161019"
\&\s-1RFE:\s0 Only install RHEV-APT if virt\-v2v \-o rhev/\-o vdsm option is used
.IP "https://bugzilla.redhat.com/1152369" 4
.IX Item "https://bugzilla.redhat.com/1152369"
virt\-v2v failed to convert \s-1RHEL 6.7 UEFI\s0 guest: no grub1/grub\-legacy or
grub2 configuration file was found
.IP "https://bugzilla.redhat.com/1141631" 4
.IX Item "https://bugzilla.redhat.com/1141631"
[\s-1RFE\s0] virt\-v2v should support convert a guest to a dir-pool with using
pool's uuid
.IP "https://bugzilla.redhat.com/1134878" 4
.IX Item "https://bugzilla.redhat.com/1134878"
libvirt reports json \*(L"backing file\*(R" is missing
.IP "https://bugzilla.redhat.com/1019388" 4
.IX Item "https://bugzilla.redhat.com/1019388"
firstboot scripts (virt-builder, virt-sysprep) don't work for Debian 6 & 7
guests
.IP "https://bugzilla.redhat.com/737600" 4
.IX Item "https://bugzilla.redhat.com/737600"
virt\-v2v windows xp \- machine dies \s-1BSOD\s0 \- processr,sys \- workaround provided
.SH "RELEASE NOTES FOR LIBGUESTFS 1.34"
.IX Header "RELEASE NOTES FOR LIBGUESTFS 1.34"
These release notes only cover the differences from the previous stable/dev
branch split (1.32.0).  For detailed changelogs, please see the git
repository, or the ChangeLog file distributed in the tarball.
.SS "New features"
.IX Subsection "New features"
Multiple performance enhancements were made in libguestfs.  The \*(L"hot cache\*(R"
time to launch to appliance should be under 1 second assuming recent qemu
and kernel are installed.  There are also new utilities for precisely
benchmarking libguestfs (\fIutils/boot\-benchmark\fR and \fIutils/boot\-analysis\fR
in the source tree).
.PP
The virt\-p2v tool for converting physical machines to virtual machines was
substantially improved.  This includes: clearer, coloured output during
conversions, support for Gtk 3, more detailed information about hardware,
click to identify network interfaces, more debugging tools included with the
\&\s-1ISO,\s0 and many bug fixes.
.PP
f2fs (Flash Friendly File System) is now supported (Pino Toscano).
.PP
\fINew tools\fR
.IX Subsection "New tools"
.PP
\&\fIvirt\-p2v\-make\-kiwi\fR\|(1) can be used to build the virt\-p2v \s-1ISO\s0 based on \s-1SLES\s0
and openSUSE, using the kiwi utility (Cédric Bosdonnat).
.PP
\fINew features in existing tools\fR
.IX Subsection "New features in existing tools"
.PP
virt-resize will now preserve the \s-1GPT GUID.\s0  This was required for Windows
Server 2012 R2, where the bootloader would become confused if the \s-1GUID\s0
changed (Maxim Perevedentsev).
.PP
virt-resize will use sparse copying for (old MBR-style) extended
partitions.  This makes resizing of guests that use extended partitions much
faster (Maxim Perevedentsev).
.PP
virt\-p2v kernel command line options can now be used to set defaults for \s-1GUI\s0
configuration.
.PP
The virt\-p2v debugging options have been completely removed, simplifying the
interface and documentation.  Debugging information is now captured fully
automatically.
.PP
virt\-p2v\-make\-disk lets you specify an \fI\-\-arch\fR option, allowing you to
build a 32 bit virt\-p2v, for compatibility with older systems.
.PP
virt\-p2v\-make\-disk no longer requires that you specify an \f(CW\*(C`os\-version\*(C'\fR for
the virt\-p2v disk.  If omitted it will try to choose a suitable
\&\f(CW\*(C`os\-version\*(C'\fR depending on your host system.
.PP
virt\-p2v\-make\-disk and virt\-p2v\-make\-kickstart both gain a new \fI\-\-install\fR
option that allows you to add arbitrary extra packages to the virt\-p2v \s-1ISO,\s0
for customization, additional debugging tools and so on.
.PP
virt\-v2v will now uninstall Parallels Tools (or the equivalent Virtuozzo
Tools) from Linux guests.  Also stop the Windows drivers from loading at
boot.  (Roman Kagan and Pavel Butsykin)
.PP
virt\-v2v \fI\-\-in\-place\fR mode has been enhanced to allow the caller to choose
whether or not to install certain virtio drivers in the guest (Roman Kagan).
.PP
virt\-v2v conversion of Windows guests was substantially rewritten and
simplified (Roman Kagan).
.PP
virt\-v2v \fI\-\-in\-place\fR mode now supports installing virtio-scsi drivers in
guests (Roman Kagan).
.PP
virt\-v2v can now convert \s-1SUSE\s0 guests and \s-1SUSE\s0 guests using \s-1UEFI\s0 (Cédric
Bosdonnat and Jim Fehlig).
.PP
virt\-v2v can now convert guests to Glance that have multiple disks.
Previously it would fail on such guests.
.PP
The virt\-v2v \fI\-\-no\-trim\fR and \fI\-\-vmtype\fR options are now no-ops.  They will
print a warning but are otherwise ignored.  virt\-v2v can now generate the
\&\s-1OVF\s0 vmtype correctly without user intervention.
.PP
virt\-v2v has now been tested against \s-1SUSE\s0 Xen as a source hypervisor (Cédric
Bosdonnat).
.PP
virt\-v2v adds support for \s-1SUSE VMDP\s0 drivers (Cédric Bosdonnat).
.PP
virt\-v2v can convert \s-1OVA\s0 files containing subfolders, as produced by \s-1SUSE\s0
Studio (Cédric Bosdonnat).
.PP
virt\-v2v sets the \s-1OVF\s0 \f(CW\*(C`<Origin>\*(C'\fR element correctly.  oVirt has been
extended to support more source hypervisors (Shahar Havivi).
.PP
virt\-v2v now supports Windows Server 2016 (Tomáš Golembiovský).
.PP
The virt-builder \fI\-\-list\fR option can now be used to show all templates or a
single template (Pino Toscano).
.PP
All OCaml-based tools now use \fIgetopt_long\fR\|(3) for option parsing, and
\&\fI\-\-help\fR output has been improved (Pino Toscano).
.PP
virt-builder and virt-customize \fI\-\-selinux\-relabel\fR option can now fully
relabel the guest filesystem at build time, without requiring a lengthy
autorelabel at first boot.
.PP
virt-customize \fI\-\-delete\fR now accepts globs.
.PP
New virt-customize \fI\-\-uninstall\fR option lets you uninstall packages.
.PP
virt-customize can now use \f(CW\*(C`pvvxsvc\*(C'\fR as an alternative to \f(CW\*(C`rhsrvany\*(C'\fR for
running firstboot scripts in Windows guests (Cédric Bosdonnat).
.PP
virt-customize now uses the strongest hashing scheme for passwords on Arch
and Void Linux (Pino Toscano).
.PP
virt-customize \fI\-\-install\fR now works correctly on Arch (Pino Toscano).
.PP
virt-inspector has new options \fI\-\-no\-applications\fR and \fI\-\-no\-icon\fR to
prevent the list of applications and icon from being included in the \s-1XML\s0
output (Pino Toscano).
.PP
New virt-sysprep \fI\-\-network\fR option has been added, allowing you to
actually use the \fI\-\-install\fR etc options which were present in virt-sysprep
before but did not usually work.  Note that the network is still disabled by
default.
.PP
virt-sysprep \f(CW\*(C`fs\-uuids\*(C'\fR operation no longer fails on btrfs guests (Maxim
Perevedentsev).
.PP
virt-dib can output Docker images (Pino Toscano).
.PP
virt-dib has a new \fI\-\-drive\-format\fR option to allow the user to specify the
format of the helper drive (Pino Toscano).
.PP
All OCaml virt tools now have a \fI\-\-colors\fR/\fI\-\-colours\fR option which
enables coloured output (using \s-1ANSI\s0 escape sequences) even if the output is
not a tty.  The default is to check if the output is a tty and disable
coloured output if not.  This allows coloured output to be consumed by other
tools.
.PP
\fILanguage bindings\fR
.IX Subsection "Language bindings"
.PP
\&\s-1PHP\s0 test coverage has been enhanced (Pino Toscano).
.PP
\&\s-1PHP 7\s0 is now supported (Pino Toscano).
.PP
Python bindings are now compliant with \s-1PEP 8\s0 (Pino Toscano).
.PP
A Python pip package is available in
http://libguestfs.org/download/python/
.PP
The Ruby bindings now print the full exception if one is thrown by the event
callback.  Note this is still incorrect behaviour as event callbacks should
not throw exceptions, but it aids debugging.
.PP
All OCaml libraries and programs are now compiled with \fI\-safe\-string\fR, if
supported by the OCaml compiler.
.PP
\fIInspection\fR
.IX Subsection "Inspection"
.PP
Alpine Linux using busybox can now be inspected.  Also the \s-1APK\s0 package
manager is supported in virt-customize (Pino Toscano).
.PP
We now handle inspection of Mageia 4 (Pino Toscano).
.PP
Void Linux and the Void Linux xbps package manager are fully supported (Pino
Toscano).
.PP
Parsing of CoreOS version information has been enhanced (Pino Toscano).
.PP
It is now possible to get an icon from \s-1ALT\s0 Linux (Pino Toscano).
.PP
\&\s-1PLD\s0 Linux versions < 3 are now recognized (Pino Toscano).
.PP
Windows drive letters are now returned for guests using \s-1GPT\s0 partitions
(Dawid Zamirski).
.PP
We can now correctly inspect Unix guests that do not have an \fI/etc/fstab\fR
file (Pino Toscano).
.PP
Added another source for the Ubuntu icon which doesn't rely on \s-1GNOME\s0 having
been installed in the guest.
.PP
We can now get an icon for Windows 7 64 bit guests.
.PP
Libosinfo integration was rewritten to deal with the new database format
used by osinfo (Pino Toscano).
.PP
\fIDocumentation\fR
.IX Subsection "Documentation"
.PP
New manual page \fIguestfs\-building\fR\|(1) describes how to build libguestfs
from source.
.PP
The man pages, tools and tool \fI\-\-help\fR output is now automatically checked
to ensure that all tool options are properly documented, that warning
sections are included where necessary, and that every page has a description
section.
.PP
The \fIguestfs\-testing\fR\|(1) man page has been refreshed and based on a newer
libguestfs.
.PP
\fIArchitectures and platforms\fR
.IX Subsection "Architectures and platforms"
.PP
virt-customize now works on \s-1POWER7\s0 and \s-1POWER8\s0 platforms, both big endian and
little endian (Xianghua Chen and Hu Zhang).
.SS "Security"
.IX Subsection "Security"
See also \fIguestfs\-security\fR\|(1).
.PP
\fI\s-1CVE\-2015\-8869\s0\fR
.IX Subsection "CVE-2015-8869"
.PP
https://bugzilla.redhat.com/CVE\-2015\-8869
.PP
This vulnerability in OCaml might affect virt tools written in the OCaml
programming language.  It affects only 64 bit platforms.  Because this bug
affects code generation it is difficult to predict which precise software
could be affected, and therefore our recommendation is that you recompile
libguestfs using a version of the OCaml compiler where this bug has been
fixed (or ask your Linux distro to do the same).
.PP
\fIvirt-customize ownership of \fI.ssh\fI, \fI.ssh/authorized_keys\fI\fR
.IX Subsection "virt-customize ownership of .ssh, .ssh/authorized_keys"
.PP
https://bugzilla.redhat.com/1337561
.PP
Previously when virt-customize injected an \s-1SSH\s0 key into a guest, when it
created the \fI~/.ssh\fR and \fI~/.ssh/authorized_keys\fR directory and file (in
case they were missing) it created them with owner and group \f(CW\*(C`root.root\*(C'\fR.
This has been fixed so the correct user is used.  This is not thought to
have been exploitable.
.PP
\fIWindows \f(CI\*(C`%systemroot%\*(C'\fI\fR
.IX Subsection "Windows %systemroot%"
.PP
The inspection code has been made more robust against guests which might use
very long \f(CW\*(C`%systemroot%\*(C'\fR (derived from the guest-controlled Windows
Registry).  This is not thought to have been exploitable.
.PP
\fIVirtio-rng is now available in the appliance\fR
.IX Subsection "Virtio-rng is now available in the appliance"
.PP
virtio-rng (the virtual Random Number Generator device) is now passed to the
appliance, which should improve the quality random numbers generated for
GUIDs and cryptographic key generation.
.SS "\s-1API\s0"
.IX Subsection "API"
\fINew APIs\fR
.IX Subsection "New APIs"
.ie n .IP """btrfs_filesystem_show""" 4
.el .IP "\f(CWbtrfs_filesystem_show\fR" 4
.IX Item "btrfs_filesystem_show"
List all devices where a btrfs filesystem is spanned (Pino Toscano).
.ie n .IP """download_blocks""" 4
.el .IP "\f(CWdownload_blocks\fR" 4
.IX Item "download_blocks"
.PD 0
.ie n .IP """download_inode""" 4
.el .IP "\f(CWdownload_inode\fR" 4
.IX Item "download_inode"
.ie n .IP """filesystem_walk""" 4
.el .IP "\f(CWfilesystem_walk\fR" 4
.IX Item "filesystem_walk"
.PD
Download filesystem data blocks from a given partition.  Download arbitrary
files by inode number.  Retrieve all files from a filesystem including
deleted files.
.Sp
Note these require optional dependency The Sleuth Kit.  (Matteo Cafasso)
.ie n .IP """get_sockdir""" 4
.el .IP "\f(CWget_sockdir\fR" 4
.IX Item "get_sockdir"
Read the path where temporary sockets are stored (Pino Toscano).
.ie n .IP """mountable_device""" 4
.el .IP "\f(CWmountable_device\fR" 4
.IX Item "mountable_device"
.PD 0
.ie n .IP """mountable_subvolume""" 4
.el .IP "\f(CWmountable_subvolume\fR" 4
.IX Item "mountable_subvolume"
.PD
Split a Mountable into device name and subvolume (Cédric Bosdonnat).
.ie n .IP """ntfscat_i""" 4
.el .IP "\f(CWntfscat_i\fR" 4
.IX Item "ntfscat_i"
Download \s-1NTFS\s0 file by inode number (Matteo Cafasso).
.ie n .IP """part_expand_gpt""" 4
.el .IP "\f(CWpart_expand_gpt\fR" 4
.IX Item "part_expand_gpt"
Allow in-place expanding of \s-1GPT\s0 partitions by moving the second (backup)
partition table to the end of the disk (Maxim Perevedentsev).
.ie n .IP """part_get_disk_guid""" 4
.el .IP "\f(CWpart_get_disk_guid\fR" 4
.IX Item "part_get_disk_guid"
.PD 0
.ie n .IP """part_set_disk_guid""" 4
.el .IP "\f(CWpart_set_disk_guid\fR" 4
.IX Item "part_set_disk_guid"
.ie n .IP """part_set_disk_guid_random""" 4
.el .IP "\f(CWpart_set_disk_guid_random\fR" 4
.IX Item "part_set_disk_guid_random"
.PD
Get and set the \s-1GPT\s0 disk \s-1GUID,\s0 or set it to a fresh random value (Maxim
Perevedentsev).
.ie n .IP """selinux_relabel""" 4
.el .IP "\f(CWselinux_relabel\fR" 4
.IX Item "selinux_relabel"
SELinux-relabel part or all of the guest filesystem.
.PP
\fIOther \s-1API\s0 changes\fR
.IX Subsection "Other API changes"
.PP
\&\f(CW\*(C`guestfs_set_selinux\*(C'\fR, \f(CW\*(C`guestfs_get_selinux\*(C'\fR, \f(CW\*(C`guestfs_setcon\*(C'\fR,
\&\f(CW\*(C`guestfs_getcon\*(C'\fR and \f(CW\*(C`guestfs_llz\*(C'\fR have been deprecated.  Use the new \s-1API\s0
\&\f(CW\*(C`guestfs_selinux_relabel\*(C'\fR to relabel filesystems.  Use
\&\f(CW\*(C`guestfs_lgetxattrs\*(C'\fR to list the \f(CW\*(C`security.selinux\*(C'\fR extended attributes of
existing files.
.PP
\&\f(CW\*(C`guestfs_vfs_minimum_size\*(C'\fR can now be used on dirty filesystems (Maxim
Perevedentsev).
.PP
\&\f(CW\*(C`guestfs_ll\*(C'\fR now works on paths which contain absolute symlinks (Pino
Toscano).
.PP
\&\f(CW\*(C`guestfs_glob_expand\*(C'\fR now has an optional \f(CW\*(C`directoryslash\*(C'\fR boolean
parameter which controls whether trailing slashes are returned for directory
names (Pino Toscano).
.PP
\&\f(CW\*(C`guestfs_lvs\*(C'\fR will no longer return LVs which have the \f(CW\*(C`activationskip\*(C'\fR
flag set.  The reason is that such LVs have no \f(CW\*(C`/dev/VG/LV\*(C'\fR device node and
so code which read the list of LVs and then probed the devices themselves
would immediately fail.  You can use \f(CW\*(C`guestfs_lvs_full\*(C'\fR if you want to read
all LVs.  (Pino Toscano).
.PP
\&\f(CW\*(C`guestfs_list_disk_labels\*(C'\fR now no longer fails if no disks with labels were
added.  Instead it now returns an empty list (Pino Toscano).
.PP
\&\f(CW\*(C`guestfs_is_lv\*(C'\fR no longer fails if passed a btrfs subvolume, it returns
false instead (Maxim Perevedentsev).
.SS "Build changes"
.IX Subsection "Build changes"
qemu ≥ 1.3.0 is required.
.PP
yajl (a \s-1JSON\s0 parsing library) is required to build libguestfs.
.PP
You can now build with \s-1GCC 6.\s0
.PP
\&\f(CW\*(C`make check\-valgrind\*(C'\fR now has substantially better coverage.
.PP
\&\f(CW\*(C`make check\-slow\*(C'\fR now works again.
.PP
Use \f(CW\*(C`make \-C appliance clean\-supermin\-appliance\*(C'\fR to clean the supermin
appliance (it will be rebuilt on next \f(CW\*(C`make\*(C'\fR).
.PP
There are a variety of new rules for running virt\-p2v from the source
directory: \f(CW\*(C`make \-C p2v run\-virt\-p2v\-directly\*(C'\fR | \f(CW\*(C`run\-virt\-p2v\-in\-a\-vm\*(C'\fR |
\&\f(CW\*(C`run\-virt\-p2v\-non\-gui\-conversion\*(C'\fR.  These are documented further in
\&\fIguestfs\-hacking\fR\|(1).
.PP
virt\-p2v may be built using either Gtk 2 or Gtk 3.  To force a particular
version of Gtk to be used, \f(CW\*(C`./configure \-\-with\-gtk=2|3\*(C'\fR
.PP
The \f(CW\*(C`./configure\*(C'\fR options are now mostly documented in
\&\fIguestfs\-building\fR\|(1).
.SS "内部"
.IX Subsection "内部"
In git, versions are now tagged with \f(CW\*(C`v1.XX.YY\*(C'\fR (previously they were
tagged with \f(CW\*(C`1.XX.YY\*(C'\fR).  Using the \f(CW\*(C`v\-\*(C'\fR prefix is more common in git
repositories.
.PP
When using the libvirt backend, we now wait for qemu to exit gracefully
instead of killing it after 15 seconds.  This helps when writing to slow
devices (especially cheap \s-1USB\s0 keys).
.PP
Error messages from libvirt now include the \f(CW\*(C`err\->int1\*(C'\fR field which
usually contains the \f(CW\*(C`errno\*(C'\fR.
.PP
On \s-1ARM,\s0 all \s-1DTB\s0 (device tree) code has been removed.  qemu creates the right
device tree on the fly, we do not need to specify one.
.PP
The C \s-1API\s0 tests now use larger test disks, allowing \s-1BTRFS\s0 to be tested
properly (Pino Toscano).
.PP
The tests should now work on a pure Python 3 host (Pino Toscano).
.PP
In C bindings, internal functions are now (mostly) consistently named
\&\f(CW\*(C`guestfs_int_*\*(C'\fR whereas previously there was no consistent scheme.
.PP
The old \f(CW\*(C`safe_malloc\*(C'\fR etc functions are now no longer exported by the
library, nor used in language bindings.
.PP
Setting \s-1TMPDIR\s0 to a path longer than ~ 100 characters will no longer cause
libguestfs to fail silently and randomly when creating Unix domain sockets
(Pino Toscano).
.PP
The \f(CW\*(C`COMPILE_REGEXP\*(C'\fR macro can now be used in the daemon.
.PP
When tracing, results containing structs are now printed in full (Pino
Toscano).
.PP
The Perl \f(CW\*(C`Sys::Guestfs\*(C'\fR module now no longer embeds an incrementing \s-1API\s0
\&\*(L"version number\*(R".  This module is now always at phony version \*(L"1.0\*(R".  To
find the real version of libguestfs from Perl you must call
\&\f(CW\*(C`$g\->version\*(C'\fR.
.PP
All code is compiled with \f(CW\*(C`\-Wstack\-usage=10000\*(C'\fR and multiple changes have
been made to remove stack allocation of large strings and buffers.
.PP
The \fIerror\fR\|(3) function is now used everywhere, replacing most previous
uses of \fIperror\fR\|(3) + \fIexit\fR\|(3), and \fIfprintf\fR\|(3) + exit.
.PP
In C code, \f(CW\*(C`/**\*(C'\fR comments are turned into documentation which is
automatically added to the \fIguestfs\-hacking\fR\|(1) manual page.
.PP
A safe \*(L"getumask\*(R" function has been added.  For recent Linux kernels this
uses the newly added \f(CW\*(C`Umask\*(C'\fR field in \fI/proc/self/status\fR.  For older
Linux and other Unix, this uses a thread-safe technique involving \fIfork\fR\|(2)
(thanks: Josh Stone, Jiri Jaburek, Eric Blake).
.PP
Safe \fIposix_fadvise\fR\|(2) wrappers have been added, and more hints have been
added to the code which may make a minor difference to performance.
.PP
A safe wrapper around \fIwaitpid\fR\|(2) has been added which handles \f(CW\*(C`INTR\*(C'\fR
properly.
.PP
\&\f(CW\*(C`podwrapper.pl\*(C'\fR (used to generate the manual pages) now stops if any \s-1POD\s0
error is found.  A new script called \f(CW\*(C`podcheck.pl\*(C'\fR does cross-checking of
\&\fI\-\-help\fR output, tool options and manual pages.
.PP
All version numbers in the library (eg. versions of qemu, versions of
libvirt, versions of guest operating systems) are unified in a single file
\&\fIsrc/version.c\fR (Pino Toscano).
.PP
On Windows guests, virt-customize will use the vendor-neutral path
\&\f(CW\*(C`C:\eProgram Files\eGuestfs\eFirstboot\*(C'\fR to store firstboot scripts.
Previously it used \f(CW\*(C`C:\eProgram Files\eRed Hat\eFirstboot\*(C'\fR.  This change
should be invisible to the scripts themselves.  (Cédric Bosdonnat)
.PP
On Linux guests, the firstboot services generated by virt-builder
\&\fI\-\-firstboot\fR etc have been renamed to \f(CW\*(C`guestfs\-firstboot\*(C'\fR (Pino Toscano).
.PP
There is now a common \f(CW\*(C`debug\*(C'\fR function used by all OCaml tools, replacing
previous code which did \f(CW\*(C`if verbose () then printf ...\*(C'\fR.
.PP
virt\-p2v copies files it needs over to the virt\-v2v conversion server using
\&\fIscp\fR\|(1), instead of trying to send them via the shell session.  This
should improve reliability and should be a completely transparent to end
users.
.PP
All code in \fImllib\fR is now built into a single \f(CW\*(C`mllib.cma\*(C'\fR or
\&\f(CW\*(C`mllib.cmxa\*(C'\fR library.  All code in \fIcustomize\fR is now built into a single
\&\f(CW\*(C`customize.cma\*(C'\fR or \f(CW\*(C`customize.cmxa\*(C'\fR library.  This simplifies the build of
the OCaml tools.
.PP
\&\fIlvmetad\fR\|(8) is now used in the appliance when available (Pino Toscano).
.PP
\&\*(L"Silent rules\*(R" are used for OCaml, Java, Erlang and \s-1POD.\s0  Use \f(CW\*(C`make V=1\*(C'\fR to
see the full command lines again (Pino Toscano).
.SS "バグ修正"
.IX Subsection "バグ修正"
.IP "https://bugzilla.redhat.com/1364347" 4
.IX Item "https://bugzilla.redhat.com/1364347"
virt-sparsify \-\-in\-place failed with \s-1UEFI\s0 system
.IP "https://bugzilla.redhat.com/1362357" 4
.IX Item "https://bugzilla.redhat.com/1362357"
run_command runs exit handlers when execve fails (e.g. due to missing
executable)
.IP "https://bugzilla.redhat.com/1362354" 4
.IX Item "https://bugzilla.redhat.com/1362354"
virt-dib failed to create image using \s-1DIB_YUM_REPO_CONF\s0
.IP "https://bugzilla.redhat.com/1359652" 4
.IX Item "https://bugzilla.redhat.com/1359652"
Fail to inspect Windows \s-1ISO\s0 file
.IP "https://bugzilla.redhat.com/1358142" 4
.IX Item "https://bugzilla.redhat.com/1358142"
Some info will show when convert guest to libvirt by virt\-v2v with parameter
\&\-\-quiet
.IP "https://bugzilla.redhat.com/1354335" 4
.IX Item "https://bugzilla.redhat.com/1354335"
overlay of disk images does not specify the format of the backing file
.IP "https://bugzilla.redhat.com/1352761" 4
.IX Item "https://bugzilla.redhat.com/1352761"
Virt-manager can't show \s-1OS\s0 icons of win7/win8/ubuntu guest.
.IP "https://bugzilla.redhat.com/1350363" 4
.IX Item "https://bugzilla.redhat.com/1350363"
Improve error info \*(L"remote server timeout unexpectedly waiting for password
prompt\*(R" when connect to a bogus server at p2v client
.IP "https://bugzilla.redhat.com/1348900" 4
.IX Item "https://bugzilla.redhat.com/1348900"
virt\-p2v should update error prompt when 'Test connection' with a
non-existing user in conversion server
.IP "https://bugzilla.redhat.com/1345813" 4
.IX Item "https://bugzilla.redhat.com/1345813"
virt-sysprep \-\-install always failed to install the packages specified
.IP "https://bugzilla.redhat.com/1345809" 4
.IX Item "https://bugzilla.redhat.com/1345809"
virt-customize \-\-truncate\-recursive should give an error message when
specifying a no-existing path
.IP "https://bugzilla.redhat.com/1343423" 4
.IX Item "https://bugzilla.redhat.com/1343423"
[\s-1RFE\s0]Should give a better description about 'curl error 22' when failed
using ssh identity http url at p2v client
.IP "https://bugzilla.redhat.com/1343414" 4
.IX Item "https://bugzilla.redhat.com/1343414"
Failed \s-1SSH\s0 to conversion server by ssh identity http url at p2v client
.IP "https://bugzilla.redhat.com/1343375" 4
.IX Item "https://bugzilla.redhat.com/1343375"
[\s-1RFE\s0] uninstall packages inside the \s-1VM\s0
.IP "https://bugzilla.redhat.com/1342447" 4
.IX Item "https://bugzilla.redhat.com/1342447"
Ifconfig command is not supported on p2v client
.IP "https://bugzilla.redhat.com/1342398" 4
.IX Item "https://bugzilla.redhat.com/1342398"
Convert a guest from \s-1RHEL\s0 by virt\-v2v but its origin info shows \s-1RHEV\s0 at
rhevm
.IP "https://bugzilla.redhat.com/1342337" 4
.IX Item "https://bugzilla.redhat.com/1342337"
Should remind a warning about disk image has a partition when using
virt\-p2v\-make\-disk
.IP "https://bugzilla.redhat.com/1341984" 4
.IX Item "https://bugzilla.redhat.com/1341984"
virt-get-kernel prompts an 'invalid value' error when using \-\-format auto
.IP "https://bugzilla.redhat.com/1341564" 4
.IX Item "https://bugzilla.redhat.com/1341564"
virt\-p2v spinner should be hidden when it stops spinning
.IP "https://bugzilla.redhat.com/1340809" 4
.IX Item "https://bugzilla.redhat.com/1340809"
Testing connection timeout when input regular user of conversion server with
checked \*(L"use sudo......\*(R"button
.IP "https://bugzilla.redhat.com/1340464" 4
.IX Item "https://bugzilla.redhat.com/1340464"
[\s-1RFE\s0] Suggestion give user a reminder for \*(L"Cancel conversion\*(R" button
.IP "https://bugzilla.redhat.com/1340407" 4
.IX Item "https://bugzilla.redhat.com/1340407"
Multiple network ports will not be aligned at p2v client
.IP "https://bugzilla.redhat.com/1338083" 4
.IX Item "https://bugzilla.redhat.com/1338083"
Update \s-1UEFI\s0 whitelist for official fedora packages
.IP "https://bugzilla.redhat.com/1337561" 4
.IX Item "https://bugzilla.redhat.com/1337561"
virt-customize \-\-ssh\-inject not applying correct file permission
.IP "https://bugzilla.redhat.com/1335671" 4
.IX Item "https://bugzilla.redhat.com/1335671"
extra quotes around \s-1UUID\s0 confuses findfs in \s-1RHEL\s0 (but not in Fedora)
.IP "https://bugzilla.redhat.com/1332025" 4
.IX Item "https://bugzilla.redhat.com/1332025"
Inspection does not parse /etc/redhat\-release containing \*(L"Derived from Red
Hat Enterprise Linux 7.1 (Source)\*(R"
.IP "https://bugzilla.redhat.com/1327488" 4
.IX Item "https://bugzilla.redhat.com/1327488"
\&\s-1RFE:\s0 Allow p2v kernel options without p2v.server to set defaults
.IP "https://bugzilla.redhat.com/1325825" 4
.IX Item "https://bugzilla.redhat.com/1325825"
virt\-v2v should prevent using multiple '\-b' and '\-n' option appears on the
command line
.IP "https://bugzilla.redhat.com/1321620" 4
.IX Item "https://bugzilla.redhat.com/1321620"
libguestfs: error: could not parse integer in version number: 7"
.IP "https://bugzilla.redhat.com/1321338" 4
.IX Item "https://bugzilla.redhat.com/1321338"
[1.33.16] Compilation Error: Unbound value List.sort_uniq in v2v.ml line
988, characters 10\-24:
.IP "https://bugzilla.redhat.com/1317843" 4
.IX Item "https://bugzilla.redhat.com/1317843"
`virt\-builder \-\-update` fails with: \*(L"dnf \-y \-\-best upgrade: command exited
with an error\*(R"
.IP "https://bugzilla.redhat.com/1316479" 4
.IX Item "https://bugzilla.redhat.com/1316479"
v2v cmd cannot exit and \*(L"block I/O error in device 'appliance': No space
left on device (28)\*(R" is printed when specified \*(L"\-v \-x\*(R"
.IP "https://bugzilla.redhat.com/1316041" 4
.IX Item "https://bugzilla.redhat.com/1316041"
virt-rescue fails, but missing error message
.IP "https://bugzilla.redhat.com/1314244" 4
.IX Item "https://bugzilla.redhat.com/1314244"
\&\s-1RFE:\s0 virt\-p2v log window should process colour escapes and backspaces
.IP "https://bugzilla.redhat.com/1312254" 4
.IX Item "https://bugzilla.redhat.com/1312254"
virt\-v2v \-o libvirt doesn't preserve or use correct <graphics
type=\*(L"vnc|spice\*(R">
.IP "https://bugzilla.redhat.com/1309706" 4
.IX Item "https://bugzilla.redhat.com/1309706"
error: internal error: Invalid floppy device name: hdb
.IP "https://bugzilla.redhat.com/1309619" 4
.IX Item "https://bugzilla.redhat.com/1309619"
Wrong warning info \*(L"use standard \s-1VGA\*(R"\s0 shows when converting windows > 7 by
virt\-v2v
.IP "https://bugzilla.redhat.com/1309580" 4
.IX Item "https://bugzilla.redhat.com/1309580"
\&\s-1OS\s0 name of win8.1 x64 guest shows incorrect in rhevm3.6 general info
.IP "https://bugzilla.redhat.com/1308769" 4
.IX Item "https://bugzilla.redhat.com/1308769"
virt\-v2v does not copy additional disks to Glance
.IP "https://bugzilla.redhat.com/1306666" 4
.IX Item "https://bugzilla.redhat.com/1306666"
Failure when disk contains an \s-1LV\s0 with activationskip=y
.IP "https://bugzilla.redhat.com/1296606" 4
.IX Item "https://bugzilla.redhat.com/1296606"
virt\-v2v doesn't remove VirtualBox additions correctly because of file
quoting
.IP "https://bugzilla.redhat.com/1293527" 4
.IX Item "https://bugzilla.redhat.com/1293527"
There should be a reminder to avoid user to edit a guest image by multiple
tools at the same time in guestfish man page
.IP "https://bugzilla.redhat.com/1293276" 4
.IX Item "https://bugzilla.redhat.com/1293276"
guestfish can not ll a symbolic link dir or edit a file in it
.IP "https://bugzilla.redhat.com/1278878" 4
.IX Item "https://bugzilla.redhat.com/1278878"
guestfish should be able to handle \s-1LVM\s0 thin layouts
.IP "https://bugzilla.redhat.com/1264835" 4
.IX Item "https://bugzilla.redhat.com/1264835"
ppc64le: virt-customize \-\-install fail to detect the guest arch
.IP "https://bugzilla.redhat.com/1264332" 4
.IX Item "https://bugzilla.redhat.com/1264332"
Test that trimming in virt\-v2v doesn't regress
.IP "https://bugzilla.redhat.com/1232192" 4
.IX Item "https://bugzilla.redhat.com/1232192"
Virt\-v2v gives an error on a blank disk: part_get_parttype: unknown
signature, of the output: \s-1BYT\s0;
.IP "https://bugzilla.redhat.com/1229386" 4
.IX Item "https://bugzilla.redhat.com/1229386"
virt\-p2v in non-GUI mode doesn't show any conversion progress or status
.IP "https://bugzilla.redhat.com/1227599" 4
.IX Item "https://bugzilla.redhat.com/1227599"
P2V invalid password prints unexpected end of file waiting for command
prompt.
.IP "https://bugzilla.redhat.com/1224795" 4
.IX Item "https://bugzilla.redhat.com/1224795"
On Ubuntu, virt-builder \-\-install and \-\-update cannot use the network
.IP "https://bugzilla.redhat.com/1213324" 4
.IX Item "https://bugzilla.redhat.com/1213324"
virt\-v2v: warning: unknown guest operating system: windows windows 6.3 when
converting win8,win8.1,win2012,win2012R2,win10 to rhev
.IP "https://bugzilla.redhat.com/1203898" 4
.IX Item "https://bugzilla.redhat.com/1203898"
Support inspecting docker images without /etc/fstab
.IP "https://bugzilla.redhat.com/1186935" 4
.IX Item "https://bugzilla.redhat.com/1186935"
libguestfs cannot inspect recent Fedora / \s-1RHEL\s0 >= 7 when /usr is a separate
partition
.IP "https://bugzilla.redhat.com/1167916" 4
.IX Item "https://bugzilla.redhat.com/1167916"
P2V: invalid conversion server prints unexpected end of file waiting for
password prompt.
.IP "https://bugzilla.redhat.com/1152825" 4
.IX Item "https://bugzilla.redhat.com/1152825"
virt-rescue \-\-selinux can not work well, when enable selinux in the command
line the value of 'getenforce' is still Disabled in virt-rescue appliance
.IP "https://bugzilla.redhat.com/1150298" 4
.IX Item "https://bugzilla.redhat.com/1150298"
\&\s-1ARM 32\s0 bit on Ubuntu: warning: cast to pointer from integer of different
size [\-Wint\-to\-pointer\-cast]
.IP "https://bugzilla.redhat.com/1089100" 4
.IX Item "https://bugzilla.redhat.com/1089100"
NetworkManager avc unlink denied for resolv.conf after using
\&\-\-selinux\-relabel
.IP "https://bugzilla.redhat.com/983969" 4
.IX Item "https://bugzilla.redhat.com/983969"
\&\s-1RFE:\s0 virt-sysprep should be SELinux-aware
.IP "https://bugzilla.redhat.com/855058" 4
.IX Item "https://bugzilla.redhat.com/855058"
\&\s-1RFE:\s0 virt\-p2v: display more information about storage devices
.IP "https://bugzilla.redhat.com/554829" 4
.IX Item "https://bugzilla.redhat.com/554829"
SELinux handling could be done better.
.SH "RELEASE NOTES FOR LIBGUESTFS 1.32"
.IX Header "RELEASE NOTES FOR LIBGUESTFS 1.32"
These release notes only cover the differences from the previous stable/dev
branch split (1.30.0).  For detailed changelogs, please see the git
repository, or the ChangeLog file distributed in the tarball.
.SS "New features"
.IX Subsection "New features"
\fINew tools\fR
.IX Subsection "New tools"
.PP
The new \fIvirt\-v2v\-copy\-to\-local\fR\|(1) tool is an ancillary tool for
\&\fIvirt\-v2v\fR\|(1) allowing you to convert source guests that virt\-v2v is unable
to access directly.
.PP
\fINew features in existing tools\fR
.IX Subsection "New features in existing tools"
.PP
Virt-customize knows how to write a random seed to CirrOS (Pino Toscano).
.PP
On Fedora, virt-customize runs \fIdnf\fR\|(8) with the \fI\-\-best\fR flag, ensuring
it always updates to the latest available packages.
.PP
Virt-builder now provides 32 bit Fedora templates.
.PP
Virt-builder and virt-customize \fI\-\-install\fR option now works on 32 bit
Fedora guests.  Previously it would try to install 64 bit packages (Jan
Sedlák).
.PP
Virt-builder can now fetch cloud images using Simple Streams v1.0 metadata
(Pino Toscano).
.PP
Virt-builder can now fetch openSUSE cloud images out of the box (Cédric
Bosdonnat).
.PP
Virt-customize will now use stronger (\s-1SHA\-512\s0) encrypted passwords by
default on openSUSE ≥ 11 (Pino Toscano).
.PP
Virt-builder will now correctly handle output filenames containing colon
characters (\f(CW\*(C`:\*(C'\fR), and will create temporary files in the libguestfs cache
directory instead of defaulting to \fI/tmp\fR (Pino Toscano).
.PP
Virt-resize has a new \fI\-\-unknown\-filesystems\fR option to control what to do
when asked to resize a filesystem that libguestfs doesn't know how to
resize.
.PP
Virt\-v2v now has an \fI\-\-in\-place\fR flag/mode, allowing in-place conversion of
guests (Roman Kagan).
.PP
Virt\-v2v has a \fI\-\-compressed\fR option for creating compressed qcow2 output
files.
.PP
Virt\-v2v can now correctly get the VMware datacenter path (dcPath)  from
libvirt, instead of having to calculate it using an algorithm that
occasionally got the wrong answer (Matthias Bolte, Tingting Zheng).
.PP
Virt\-v2v now processes \s-1RAM\s0 sizes correctly for 64 bit guests when running on
a 32 bit host.
.PP
\fILanguage bindings\fR
.IX Subsection "Language bindings"
.PP
In Perl and Python programs, the \f(CW\*(C`get_program_name\*(C'\fR \s-1API\s0 now returns the
true program name, instead of the incorrect string \f(CW\*(C`perl\*(C'\fR or \f(CW\*(C`python\*(C'\fR.
.PP
The Python bindings can now be compiled against a different version of
libguestfs, allowing the pip module to be built against any version of
libguestfs (instead of requiring the pip module and libguestfs to have
exactly the same version).
.PP
The quality of the Ruby rdoc (documentation) has been improved (Pino
Toscano).
.PP
Perl scripts no longer hard-code the location of perl in the shebang line,
but use \fIenv\fR\|(1) to locate it instead (Pino Toscano).
.PP
In OCaml programs, the guestfs handle was incorrectly made into a global
root, meaning it could never be garbage collected.  If you didn't call the
\&\f(CW\*(C`close\*(C'\fR function explicitly, the handle would not be closed until the whole
program exited.  This has now been fixed so handles will be garbage
collected in the usual way.  This changes the \s-1API\s0 of the OCaml function
\&\f(CW\*(C`Guestfs.event_callback\*(C'\fR.  Note that non-C language bindings are not
covered by the libguestfs \s-1API/ABI\s0 guarantee, although we try hard not to
change them, but in this case it was essential in order to fix this very
serious bug.
.PP
\fIInspection\fR
.IX Subsection "Inspection"
.PP
Alpine Linux and the \s-1APK\s0 package manager, \s-1ALT\s0 Linux, Frugalware, and \s-1PLD\s0
Linux are now recognized (Pino Toscano).
.PP
If it exists, \fI/etc/os\-release\fR will be preferred for inspecting Linux
guests (Pino Toscano).
.PP
The correct kernel version is returned for Windows guests ≥ 10.
.PP
\fIDocumentation\fR
.IX Subsection "Documentation"
.PP
The large \fIguestfs\fR\|(3) man page has been split into several separate man
pages: \fIguestfs\-hacking\fR\|(1) \fIguestfs\-internals\fR\|(1)
\&\fIguestfs\-security\fR\|(1).  In the source tree, a new \fIdocs\fR directory
contains this documentation.
.PP
\fIArchitectures and platforms\fR
.IX Subsection "Architectures and platforms"
.PP
Libguestfs now supports \s-1ARM 64\s0 bit platforms with vGICv3.
.SS "Security"
.IX Subsection "Security"
See also \fIguestfs\-security\fR\|(1).
.ie n .IP """CVE\-2015\-5745""" 4
.el .IP "\f(CWCVE\-2015\-5745\fR" 4
.IX Item "CVE-2015-5745"
https://bugzilla.redhat.com/1251157
.Sp
This is not a vulnerability in libguestfs, but because we always give a
virtio-serial port to each guest (since that is how guest-host communication
happens), an escalation from the appliance to the host qemu process is
possible.  This could affect you if:
.RS 4
.IP "\(bu" 4
your libguestfs program runs untrusted programs out of the guest (using
\&\*(L"guestfs_sh\*(R" etc), or
.IP "\(bu" 4
another exploit was found in (for example) kernel filesystem code that
allowed a malformed filesystem to take over the appliance.
.RE
.RS 4
.Sp
If you use sVirt to confine qemu, that would thwart some attacks.
.RE
.IP "Virt-customize permissions on \fI.ssh\fR, \fI.ssh/authorized_keys\fR" 4
.IX Item "Virt-customize permissions on .ssh, .ssh/authorized_keys"
https://bugzilla.redhat.com/1260778.
.Sp
Previously when asked to inject an \s-1SSH\s0 key into a guest, virt-customize
(hence virt-builder too) would create the \fI.ssh\fR directory and
\&\fI.ssh/authorized_keys\fR file with too broad permissions, allowing other
users to read.  They are now created as \f(CW0700\fR and \f(CW0600\fR respectively,
which is the same as the \fIssh\-copy\-id\fR\|(1) utility.
.SS "\s-1API\s0"
.IX Subsection "API"
\fINew APIs\fR
.IX Subsection "New APIs"
.ie n .IP """guestfs_get_identifier""" 4
.el .IP "\f(CWguestfs_get_identifier\fR" 4
.IX Item "guestfs_get_identifier"
.PD 0
.ie n .IP """guestfs_set_identifier""" 4
.el .IP "\f(CWguestfs_set_identifier\fR" 4
.IX Item "guestfs_set_identifier"
.PD
Get/set a per-handle identifier.  The main effect of this is to change trace
output from:
.Sp
.Vb 1
\& libguestfs: trace: foo
.Ve
.Sp
to:
.Sp
.Vb 1
\& libguestfs: trace: ID: foo
.Ve
.Sp
making it easier to follow traces in multi-threaded programs, or where a
program uses multiple handles (especially virt\-v2v).
.ie n .IP """guestfs_vfs_minimum_size""" 4
.el .IP "\f(CWguestfs_vfs_minimum_size\fR" 4
.IX Item "guestfs_vfs_minimum_size"
Return the minimum size of a filesystem (when shrunk).  This supports
ext2/3/4, \s-1XFS\s0 and btrfs, and can support other filesystem types in future
(Maxim Perevedentsev).
.PP
\fIOther \s-1API\s0 changes\fR
.IX Subsection "Other API changes"
.ie n .IP """guestfs_disk_create"": add ""preallocation"" = ""off""/""metadata""/""full""." 4
.el .IP "\f(CWguestfs_disk_create\fR: add \f(CWpreallocation\fR = \f(CWoff\fR/\f(CWmetadata\fR/\f(CWfull\fR." 4
.IX Item "guestfs_disk_create: add preallocation = off/metadata/full."
For raw, this allows \f(CW\*(C`off\*(C'\fR as a synonym for \f(CW\*(C`sparse\*(C'\fR (making it consistent
with qcow2).  For qcow2, this allows \f(CW\*(C`sparse\*(C'\fR as a synonym for \f(CW\*(C`off\*(C'\fR.
.Sp
It also adds \f(CW\*(C`full\*(C'\fR, which corresponds to fully allocated, but uses
\&\fIposix_fallocate\fR\|(3) for efficiency.
.ie n .IP """guestfs_tar_in"": new ""xattrs"", ""selinux"", ""acl"" parameters." 4
.el .IP "\f(CWguestfs_tar_in\fR: new \f(CWxattrs\fR, \f(CWselinux\fR, \f(CWacl\fR parameters." 4
.IX Item "guestfs_tar_in: new xattrs, selinux, acl parameters."
.PD 0
.ie n .IP """guestfs_tar_out"": new ""xattrs"", ""selinux"", ""acl"" parameters." 4
.el .IP "\f(CWguestfs_tar_out\fR: new \f(CWxattrs\fR, \f(CWselinux\fR, \f(CWacl\fR parameters." 4
.IX Item "guestfs_tar_out: new xattrs, selinux, acl parameters."
.PD
These extra parameters control whether extended attributes, SELinux contexts
and/or \s-1POSIX\s0 ACLs are restored from / saved to tarballs.
.ie n .IP """guestfs_add_drive""" 4
.el .IP "\f(CWguestfs_add_drive\fR" 4
.IX Item "guestfs_add_drive"
The existing \f(CW\*(C`username\*(C'\fR and \f(CW\*(C`secret\*(C'\fR parameters can be used to supply
authentication for iSCSI (Pino Toscano).
.SS "Build changes"
.IX Subsection "Build changes"
The \f(CW\*(C`./configure \-\-enable\-valgrind\-daemon\*(C'\fR option has been removed.
.PP
You can no longer build libguestfs on \s-1RHEL\s0 5\-era (c.2007) machines.  See the
\&\f(CW\*(C`oldlinux\*(C'\fR branch if you need (limited) \s-1RHEL 5\s0 support.
.PP
Virt\-p2v can now be built on \s-1RHEL\s0 6\-era (c.2010) Linux distros.
.PP
OCaml ≥ 3.11 (released in 2008) is now required to build from git.
.PP
Building the Perl bindings now requires \f(CW\*(C`Module::Build\*(C'\fR (instead of
\&\f(CW\*(C`ExtUtils::MakeMaker\*(C'\fR).
.PP
Builds should be faster (especially when incrementally rebuilding), because
work was done to reduce build times.
.PP
Both OCaml and the OCaml findlib module are required if you need to run the
generator at build time.  Previously the build would have failed if findlib
was not installed.
.PP
\&\f(CW\*(C`make check\*(C'\fR tests now run in parallel (within each test directory).
.PP
\&\f(CW\*(C`make install\*(C'\fR no longer installs OCaml \fIbindtests.*\fR files incorrectly.
.PP
\&\f(CW\*(C`make install\*(C'\fR can now be run twice.  Previously it would fail on the
second run.
.PP
\&\f(CW\*(C`make clean\*(C'\fR should now remove nearly every file that \f(CW\*(C`make\*(C'\fR creates.
.PP
A new \f(CW\*(C`make installcheck\*(C'\fR rule has been added, allowing the installed copy
of libguestfs to be tested.
.SS "内部"
.IX Subsection "内部"
Some effort was put into minimizing the size of the appliance, which reduces
temporary disk space and time needed by libguestfs handles.
.PP
The appliance now passes the \s-1NIC\s0 name to dhcpd, fixing hangs when running
the appliance on some distros (Cédric Bosdonnat).
.PP
OCaml \f(CW\*(C`Guestfs.Errno\*(C'\fR is now generated (Pino Toscano).
.PP
In OCaml tools, common code now handles \fI\-\-debug\-gc\fR, \fI\-\-verbose\fR and
other common options (Roman Kagan, Pino Toscano).
.PP
The virt\-v2v test harness allows us to boot the test guests at fixed dates
in the past, ensuring that Windows reactivation doesn't kick in.
.PP
There is a new internal \s-1API\s0 for reading/writing a subprocess via a pipe from
library code.
.PP
Used \f(CW\*(C`deheader\*(C'\fR program to remove unused \f(CW\*(C`#include\*(C'\fR directives.
.PP
In OCaml tools, the \f(CW\*(C`Char\*(C'\fR and \f(CW\*(C`String\*(C'\fR modules now implicitly reference
the \f(CW\*(C`Common_utils.Char\*(C'\fR and \f(CW\*(C`Common_utils.String\*(C'\fR modules (instead of the
ones from stdlib).  The \f(CW\*(C`Common_utils\*(C'\fR modules contain a number of extra
char/string utility functions, and also hide some unsafe functions in
stdlib.
.PP
Many more virt\-v2v tests will now be run even if you don't have rhsrvany and
virtio-win installed (Roman Kagan).
.PP
The huge \fIconfigure.ac\fR file has been split into several smaller files
called \fIm4/guestfs_*.m4\fR.
.PP
The old \fItests/data\fR and \fItests/guests\fR directories have been moved to
\&\fItest\-data/\fR.  This new top level directory carries all test data which is
common, large and/or shared between multiple tests.
.PP
There is a new top level \fIwebsite/\fR directory containing the public
http://libguestfs.org website (or most of it).
.PP
The fuzz testing of inspection (\fItests/fuzz\fR) has been removed.
.PP
Virt\-p2v now saves the source physical machine dmesg output into the
conversion server debug directory, making it simpler to debug cases of
missing drivers, firmware etc.
.SS "バグ修正"
.IX Subsection "バグ修正"
.IP "https://bugzilla.redhat.com/1294956" 4
.IX Item "https://bugzilla.redhat.com/1294956"
set-label returns wrong error message when set the ext3/ext4 filesystem
label
.IP "https://bugzilla.redhat.com/1288733" 4
.IX Item "https://bugzilla.redhat.com/1288733"
Add a Fedora 23 32\-bit base image for virt-builder
.IP "https://bugzilla.redhat.com/1288201" 4
.IX Item "https://bugzilla.redhat.com/1288201"
virt-builder writes temporary files to /tmp
.IP "https://bugzilla.redhat.com/1285847" 4
.IX Item "https://bugzilla.redhat.com/1285847"
virt-resize does not copy logical partitions
.IP "https://bugzilla.redhat.com/1281578" 4
.IX Item "https://bugzilla.redhat.com/1281578"
virt-inspector returns version 6.3 for win10 images (should return 10.0)
.IP "https://bugzilla.redhat.com/1281577" 4
.IX Item "https://bugzilla.redhat.com/1281577"
virt-inspector \-\-xpath segfault on attribute get
.IP "https://bugzilla.redhat.com/1280029" 4
.IX Item "https://bugzilla.redhat.com/1280029"
libguestfs can run commands with stdin not open (or worse still, connected
to arbitrary guest-chosen random devices)
.IP "https://bugzilla.redhat.com/1279273" 4
.IX Item "https://bugzilla.redhat.com/1279273"
About compression option for qcow2
.IP "https://bugzilla.redhat.com/1278878" 4
.IX Item "https://bugzilla.redhat.com/1278878"
guestfish should be able to handle \s-1LVM\s0 thin layouts
.IP "https://bugzilla.redhat.com/1278382" 4
.IX Item "https://bugzilla.redhat.com/1278382"
\&\s-1DNF\s0 python programming error when run from virt-builder
.IP "https://bugzilla.redhat.com/1278371" 4
.IX Item "https://bugzilla.redhat.com/1278371"
inspection returns arch=\*(L"unknown\*(R" for Windows guest if file command is not
installed
.IP "https://bugzilla.redhat.com/1277274" 4
.IX Item "https://bugzilla.redhat.com/1277274"
Document permissions needed for non-admin users to use virt\-v2v
.IP "https://bugzilla.redhat.com/1277122" 4
.IX Item "https://bugzilla.redhat.com/1277122"
\&\s-1RFE:\s0 virt-sparsify: make '\-\-in\-place' sparsification safe to abort
(gracefully or ungracefully)
.IP "https://bugzilla.redhat.com/1277074" 4
.IX Item "https://bugzilla.redhat.com/1277074"
Virt\-p2v client shouldn't present the vdsm option because it's not usable
.IP "https://bugzilla.redhat.com/1276540" 4
.IX Item "https://bugzilla.redhat.com/1276540"
virt\-v2v fails to convert Windows raw image: error \*(L"device name is not a
partition\*(R"
.IP "https://bugzilla.redhat.com/1275806" 4
.IX Item "https://bugzilla.redhat.com/1275806"
virt-builder: error: [file] is not a regular file in the guest
.IP "https://bugzilla.redhat.com/1270011" 4
.IX Item "https://bugzilla.redhat.com/1270011"
Simplestreams test fails: virt-builder: error: the value for the key 'size'
is not an integer
.IP "https://bugzilla.redhat.com/1267032" 4
.IX Item "https://bugzilla.redhat.com/1267032"
guestfish copy-in command behaves oddly/unexpectedly with wildcards
.IP "https://bugzilla.redhat.com/1262983" 4
.IX Item "https://bugzilla.redhat.com/1262983"
python: Cannot compile pip module if installed libguestfs != pip guestfs
version
.IP "https://bugzilla.redhat.com/1262127" 4
.IX Item "https://bugzilla.redhat.com/1262127"
Better diagnostic message when virbr0 doesn't exist
.IP "https://bugzilla.redhat.com/1261436" 4
.IX Item "https://bugzilla.redhat.com/1261436"
No warning shows when convert a win7 guest with \s-1AVG\s0 AntiVirus installed
.IP "https://bugzilla.redhat.com/1260778" 4
.IX Item "https://bugzilla.redhat.com/1260778"
virt-builder \-\-ssh\-inject doesn't set proper permissions on created files
.IP "https://bugzilla.redhat.com/1260689" 4
.IX Item "https://bugzilla.redhat.com/1260689"
\&\s-1RFE: V2V\s0 to check and warn user to disable group policy and anti virus on
Windows guests
.IP "https://bugzilla.redhat.com/1260590" 4
.IX Item "https://bugzilla.redhat.com/1260590"
Wrong graphics protocal and video type set for guest after convert to rhev
3.6 by virt\-v2v
.IP "https://bugzilla.redhat.com/1258342" 4
.IX Item "https://bugzilla.redhat.com/1258342"
extra slashes in vcenter \s-1URL\s0 confuses virt\-v2v
.IP "https://bugzilla.redhat.com/1257895" 4
.IX Item "https://bugzilla.redhat.com/1257895"
[\s-1RHEV\s0][V2V] virt\-v2v ignores \s-1NIC\s0 if interface source/@network or
source/@bridge is an empty string
.IP "https://bugzilla.redhat.com/1256405" 4
.IX Item "https://bugzilla.redhat.com/1256405"
virt-builder created Fedora 22 32bit disk image cannot be updated
.IP "https://bugzilla.redhat.com/1256222" 4
.IX Item "https://bugzilla.redhat.com/1256222"
virt\-p2v no \s-1GUI\s0 mode:error opening control connection to \f(CW$ip:22:unexpected\fR
…rompt
.IP "https://bugzilla.redhat.com/1251909" 4
.IX Item "https://bugzilla.redhat.com/1251909"
Option \-oa preallocated \-of qcow2 of virt\-v2v didn't work efficiently
.IP "https://bugzilla.redhat.com/1250715" 4
.IX Item "https://bugzilla.redhat.com/1250715"
v2v: spaces need to be escaped as \f(CW%20\fR in paths
.IP "https://bugzilla.redhat.com/1248678" 4
.IX Item "https://bugzilla.redhat.com/1248678"
Close all incoming ports on virt\-p2v \s-1ISO\s0
.IP "https://bugzilla.redhat.com/1246882" 4
.IX Item "https://bugzilla.redhat.com/1246882"
man virt-customize shows synopsis twice
.IP "https://bugzilla.redhat.com/1242853" 4
.IX Item "https://bugzilla.redhat.com/1242853"
mount-loop failed to setup loop device: No such file or directory
.IP "https://bugzilla.redhat.com/1237136" 4
.IX Item "https://bugzilla.redhat.com/1237136"
\&\s-1BUG:\s0 unable to handle kernel \s-1NULL\s0 pointer dereference at <addr> in function
_\|_blkg_lookup
.IP "https://bugzilla.redhat.com/1230412" 4
.IX Item "https://bugzilla.redhat.com/1230412"
virt\-v2v should ignore bogus kernel entries in grub config
.IP "https://bugzilla.redhat.com/1229119" 4
.IX Item "https://bugzilla.redhat.com/1229119"
Unrelated info in fstab makes virt\-v2v fail with unclear error info
.IP "https://bugzilla.redhat.com/1227609" 4
.IX Item "https://bugzilla.redhat.com/1227609"
virt\-p2v: Using \*(L"Back\*(R" button causes output list to be repopulated multiple
times
.IP "https://bugzilla.redhat.com/1225789" 4
.IX Item "https://bugzilla.redhat.com/1225789"
Wrong video driver is installed for rhel5.11 guest after conversion to
libvirt
.IP "https://bugzilla.redhat.com/1204131" 4
.IX Item "https://bugzilla.redhat.com/1204131"
\&\s-1RFE:\s0 virt-builder creates qcow v3 images, add build option for qcow v2
.IP "https://bugzilla.redhat.com/1176801" 4
.IX Item "https://bugzilla.redhat.com/1176801"
File /etc/sysconfig/kernel isn't updated when convert XenPV guest with
regular kernel installed
.IP "https://bugzilla.redhat.com/1174551" 4
.IX Item "https://bugzilla.redhat.com/1174551"
\&\*(L"lstatnslist\*(R" and \*(L"lstatlist\*(R" don't give an error if the \s-1API\s0 is used wrongly
.IP "https://bugzilla.redhat.com/1168223" 4
.IX Item "https://bugzilla.redhat.com/1168223"
koji spin-livecd cannot build a working live \s-1CD\s0
.IP "https://bugzilla.redhat.com/1165785" 4
.IX Item "https://bugzilla.redhat.com/1165785"
mount-loop command fails: mount failed: Unknown error \-1
.IP "https://bugzilla.redhat.com/1164708" 4
.IX Item "https://bugzilla.redhat.com/1164708"
set-label can only set <=127 bytes for btrfs and <=126 bytes for ntfs
filesystem which not meet the help message. Also for ntfs it should give a
warning message when the length >128 bytes
.IP "https://bugzilla.redhat.com/1020216" 4
.IX Item "https://bugzilla.redhat.com/1020216"
libvirt fails to shut down domain: could not destroy libvirt domain:
Requested operation is not valid: domain is not running
.IP "https://bugzilla.redhat.com/1011907" 4
.IX Item "https://bugzilla.redhat.com/1011907"
mount-loop failed to setup loop device: No such file or directory
.SH "RELEASE NOTES FOR LIBGUESTFS 1.30"
.IX Header "RELEASE NOTES FOR LIBGUESTFS 1.30"
These release notes only cover the differences from the previous stable/dev
branch split (1.28.0).  For detailed changelogs, please see the git
repository, or the ChangeLog file distributed in the tarball.
.SS "New features"
.IX Subsection "New features"
\fINew tools\fR
.IX Subsection "New tools"
.PP
\&\fIvirt\-dib\fR\|(1) is a secure and safe alternative to the OpenStack
\&\*(L"diskimage-builder\*(R" tool.  It is compatible with diskimage-builder
elements.  (Pino Toscano)
.PP
\&\fIvirt\-get\-kernel\fR\|(1) extracts the kernel and ramdisk from a disk image.
Previously this functionality was part of \fIvirt\-builder\fR\|(1), but the new
tool is more featureful.  (Pino Toscano)
.PP
\fINew features in existing tools\fR
.IX Subsection "New features in existing tools"
.PP
\&\fIvirt\-v2v\fR\|(1) \fI\-i ova\fR mode can now read a wider range of \s-1OVA\s0 files, and
also unpacked files (directories).
.PP
virt\-v2v now securely passes options to curl, so passwords, cookies and so
on cannot be seen by users with shell access on the same machine.
.PP
virt\-v2v has a new \fI\-\-password\-file\fR option to allow you to securely pass
in a password, and to avoid an interactive prompt.
.PP
virt\-v2v disables Windows autoreboot, making debugging conversion failures
on Windows easier.
.PP
virt\-v2v now comes with an extensive external test suite.  See
\&\fIvirt\-v2v\-test\-harness\fR\|(1).
.PP
virt\-v2v allows virtio drivers to come from any location (Roman Kagan), and
drivers can be read directly from the virtio \s-1ISO.\s0
.PP
virt\-v2v supports conversion of Windows ≥ 8.  Note this is experimental,
and possibly broken.  Use with caution.
.PP
virt\-v2v can now convert \s-1UEFI\s0 guests.
.PP
\&\fIvirt\-p2v\fR\|(1) adds a network configuration dialog.
.PP
virt\-p2v now has \f(CW\*(C`p2v.pre\*(C'\fR, \f(CW\*(C`p2v.post\*(C'\fR and \f(CW\*(C`p2v.fail\*(C'\fR triggers, allowing
arbitrary scripts for preparing the host for conversion and tidying up
post-conversion.
.PP
virt\-p2v now uses the more advanced metacity window manager (instead of
matchbox).
.PP
\&\fIvirt\-sysprep\fR\|(1) will remove \f(CW\*(C`/var/spool/mail/username\*(C'\fR for non-root
accounts (Hu Tao).
.PP
\&\fIvirt\-customize\fR\|(1), \fIvirt\-builder\fR\|(1) and virt-sysprep have the following
new options:
.IP "\fI\-\-commands\-from\-file\fR" 4
.IX Item "--commands-from-file"
allow long lists of commands to be read from a file instead of from the
command line (Pino Toscano)
.IP "\fI\-\-copy\fR" 4
.IX Item "--copy"
copy files inside the guest (Maros Zatko)
.IP "\fI\-\-copy\-in\fR" 4
.IX Item "--copy-in"
copy host files recursively into the guest (Pino Toscano)
.IP "\fI\-\-move\fR" 4
.IX Item "--move"
move files inside the guest (Maros Zatko)
.IP "\fI\-\-ssh\-inject\fR" 4
.IX Item "--ssh-inject"
inject \s-1SSH\s0 keys into a guest (Pino Toscano)
.IP "\fI\-\-sm\-attach\fR" 4
.IX Item "--sm-attach"
.PD 0
.IP "\fI\-\-sm\-credentials\fR" 4
.IX Item "--sm-credentials"
.IP "\fI\-\-sm\-register\fR" 4
.IX Item "--sm-register"
.IP "\fI\-\-sm\-remove\fR" 4
.IX Item "--sm-remove"
.IP "\fI\-\-sm\-unregister\fR" 4
.IX Item "--sm-unregister"
.PD
register and unregister a guest from subscription-manager (Pino Toscano)
.IP "\fI\-\-touch\fR" 4
.IX Item "--touch"
touch a file in the guest (Pino Toscano)
.IP "\fI\-\-truncate\fR" 4
.IX Item "--truncate"
.PD 0
.IP "\fI\-\-truncate\-recursive\fR" 4
.IX Item "--truncate-recursive"
.PD
truncate files (Maros Zatko)
.PP
Improvements to virt-customize firstboot support.  In particular, Windows
firstboot should work as well as Linux (Roman Kagan).
.PP
\&\fIvirt\-df\fR\|(1) can now use PolicyKit, \s-1SASL\s0 and other authentication methods
when getting the list of domains from libvirt.
.PP
Improvements to guestfish bash completion (Pino Toscano).
.PP
Bash completion now completes short options as well as long options (Pino
Toscano).
.PP
\&\fIguestfish\fR\|(1) now displays a command synopsis if the number of parameters
given to a command is wrong (Hu Tao).
.PP
virt-builder now supports Red Hat Enterprise Linux versions back to \s-1RHEL 3.\s0
.PP
virt-builder supports \s-1SUSE\s0 guests using zypper (Cédric Bosdonnat).
.PP
\fILanguage bindings\fR
.IX Subsection "Language bindings"
.PP
The Java bindings now include validated Javadoc, and other improvements
(Pino Toscano).
.PP
Multiple fixes and improvements to the \s-1PHP\s0 bindings (Pino Toscano).
.PP
\fIInspection\fR
.IX Subsection "Inspection"
.PP
Inspection can now get icons from \s-1RHEL 7\s0 and CentOS 7.
.PP
\&\fI/etc/favicon.png\fR is now allowed to be a symbolic link.
.PP
For RPM-based guests, inspection now returns \s-1RPM\s0 Epoch fields.
.PP
Debian packages now have separate Epoch and Version fields (Nikos
Skalkotos).
.PP
OpenBSD detection added, FreeBSD and NetBSD added as separate \*(L"distros\*(R", and
other \s-1BSD\s0 inspection improvements and bug fixes (Nikos Skalkotos).
.PP
CoreOS detection added (Nikos Skalkotos).
.PP
The package manager in Fedora ≥ 22 is \f(CW\*(C`dnf\*(C'\fR.
.PP
ReactOS guests can be inspected (Maros Zatko).
.PP
Add support for \s-1UEFI\s0 guests.
.PP
Inspection now works when kernel modules are gzip or xz compressed (Pino
Toscano).
.PP
Inspection now recognizes ppc64 and ppc64le guests (Maros Zatko).
.PP
Inspection lists the installed applications on Archlinux guests (Nikos
Skalkotos).
.PP
\fIArchitectures and platforms\fR
.IX Subsection "Architectures and platforms"
.PP
\&\s-1PPC64\s0 (\s-1POWER7\s0) and \s-1PPC64LE\s0 (\s-1POWER8\s0) architectures are now much better
supported, and should work out of the box.
.PP
For aarch64, we use \s-1AAVMF\s0 (an open source \s-1UEFI\s0 implementation based on \s-1OVMF\s0)
if available to run the appliance.
.PP
For armv7, we now use the \fI\-M virt\fR machine type by default.
.PP
There is better support for compiling on non-Linux platforms (Pino Toscano,
Margaret Lewicka).
.PP
Libguestfs should now work on \s-1MIPS 32\s0 bit little endian (\*(L"mipsel\*(R").  I have
not been able to try 64 bit or big endian.
.SS "Security"
.IX Subsection "Security"
.IP "\s-1CVE\-2014\-8484\s0" 4
.IX Item "CVE-2014-8484"
.PD 0
.IP "\s-1CVE\-2014\-8485\s0" 4
.IX Item "CVE-2014-8485"
.PD
Libguestfs previously ran the \fIstrings\fR\|(1) utility on untrusted files.
Strings could parse \s-1BFD\s0 headers in an unsafe way, leading to possible
arbitrary code execution.  Libguestfs now runs strings with a flag to ensure
it does not try to parse \s-1BFD\s0 headers.  This could have led to exploitation
of the libguestfs appliance, but since libguestfs further constrains the
appliance through virtualization, SELinux and other techniques, it was
unlikely to have caused any privilege escalation on the host.
.IP "XPath injection in virt\-v2v" 4
.IX Item "XPath injection in virt-v2v"
One possible XPath injection vulnerability was fixed in virt\-v2v.  This
might have allowed a malicious guest which was being converted by virt\-v2v
to construct an arbitrary XPath expression which would have been evaluated
on the host (by the libxml2 library linked to the virt\-v2v binary).  It is
not clear what the effects of this might be.
.Sp
For further information, see upstream commit
https://github.com/libguestfs/libguestfs/commit/6c6ce85f94c36803fe2db35a98db436bff0c14b0
.ie n .IP "Denial of service problems when using ""qemu\-img info""" 4
.el .IP "Denial of service problems when using \f(CWqemu\-img info\fR" 4
.IX Item "Denial of service problems when using qemu-img info"
When using the American Fuzzy Lop fuzzer (\f(CW\*(C`afl\-fuzz\*(C'\fR) on the \f(CW\*(C`qemu\-img
info\*(C'\fR command, Richard W.M. Jones found that certain files can cause the
\&\f(CW\*(C`qemu\-img\*(C'\fR program to use lots of memory and time (for example 6GB of heap
and 14 seconds of \s-1CPU\s0 time on a fast Intel processor), and in some cases to
crash.  Since libguestfs may run \f(CW\*(C`qemu\-img info\*(C'\fR on disk images to find out
what they contain, this transitively could cause libguestfs to hang or
consume lots of memory.
.Sp
Libguestfs was modified so that it uses resource limits to limit the space
and time used by \f(CW\*(C`qemu\-img info\*(C'\fR, to avoid this problem.  If a malicious
user tries to pass one of these disk images to libguestfs, \f(CW\*(C`qemu\-img\*(C'\fR will
crash and the crash is reported back to libguestfs callers as an error
message.
.SS "\s-1API\s0"
.IX Subsection "API"
\fINew APIs\fR
.IX Subsection "New APIs"
.ie n .IP """guestfs_add_libvirt_dom""" 4
.el .IP "\f(CWguestfs_add_libvirt_dom\fR" 4
.IX Item "guestfs_add_libvirt_dom"
This exposes a previously private \s-1API\s0 that allows you to pass a
\&\f(CW\*(C`virDomainPtr\*(C'\fR object directly from libvirt to libguestfs.
.ie n .IP """guestfs_blockdev_setra""" 4
.el .IP "\f(CWguestfs_blockdev_setra\fR" 4
.IX Item "guestfs_blockdev_setra"
Adjust readahead parameter for devices.  See \f(CW\*(C`blockdev \-\-setra\*(C'\fR command.
.ie n .IP """guestfs_btrfs_balance""" 4
.el .IP "\f(CWguestfs_btrfs_balance\fR" 4
.IX Item "guestfs_btrfs_balance"
.PD 0
.ie n .IP """guestfs_btrfs_balance_cancel""" 4
.el .IP "\f(CWguestfs_btrfs_balance_cancel\fR" 4
.IX Item "guestfs_btrfs_balance_cancel"
.ie n .IP """guestfs_btrfs_balance_pause""" 4
.el .IP "\f(CWguestfs_btrfs_balance_pause\fR" 4
.IX Item "guestfs_btrfs_balance_pause"
.ie n .IP """guestfs_btrfs_balance_resume""" 4
.el .IP "\f(CWguestfs_btrfs_balance_resume\fR" 4
.IX Item "guestfs_btrfs_balance_resume"
.ie n .IP """guestfs_btrfs_balance_status""" 4
.el .IP "\f(CWguestfs_btrfs_balance_status\fR" 4
.IX Item "guestfs_btrfs_balance_status"
.PD
Balance support for Btrfs filesystems (Hu Tao).
.ie n .IP """guestfs_btrfs_filesystem_defragment""" 4
.el .IP "\f(CWguestfs_btrfs_filesystem_defragment\fR" 4
.IX Item "guestfs_btrfs_filesystem_defragment"
Filesystem defragmentation support for Btrfs filesystems (Hu Tao).
.ie n .IP """guestfs_btrfs_image""" 4
.el .IP "\f(CWguestfs_btrfs_image\fR" 4
.IX Item "guestfs_btrfs_image"
Create an image of a Btrfs filesystem (Chen Hanxiao)
.ie n .IP """guestfs_btrfs_qgroup_assign""" 4
.el .IP "\f(CWguestfs_btrfs_qgroup_assign\fR" 4
.IX Item "guestfs_btrfs_qgroup_assign"
.PD 0
.ie n .IP """guestfs_btrfs_qgroup_create""" 4
.el .IP "\f(CWguestfs_btrfs_qgroup_create\fR" 4
.IX Item "guestfs_btrfs_qgroup_create"
.ie n .IP """guestfs_btrfs_qgroup_destroy""" 4
.el .IP "\f(CWguestfs_btrfs_qgroup_destroy\fR" 4
.IX Item "guestfs_btrfs_qgroup_destroy"
.ie n .IP """guestfs_btrfs_qgroup_limit""" 4
.el .IP "\f(CWguestfs_btrfs_qgroup_limit\fR" 4
.IX Item "guestfs_btrfs_qgroup_limit"
.ie n .IP """guestfs_btrfs_qgroup_remove""" 4
.el .IP "\f(CWguestfs_btrfs_qgroup_remove\fR" 4
.IX Item "guestfs_btrfs_qgroup_remove"
.ie n .IP """guestfs_btrfs_qgroup_show""" 4
.el .IP "\f(CWguestfs_btrfs_qgroup_show\fR" 4
.IX Item "guestfs_btrfs_qgroup_show"
.ie n .IP """guestfs_btrfs_quota_enable""" 4
.el .IP "\f(CWguestfs_btrfs_quota_enable\fR" 4
.IX Item "guestfs_btrfs_quota_enable"
.ie n .IP """guestfs_btrfs_quota_rescan""" 4
.el .IP "\f(CWguestfs_btrfs_quota_rescan\fR" 4
.IX Item "guestfs_btrfs_quota_rescan"
.PD
Quote support for Btrfs filesystems (Hu Tao).
.ie n .IP """guestfs_btrfs_rescue_chunk_recover""" 4
.el .IP "\f(CWguestfs_btrfs_rescue_chunk_recover\fR" 4
.IX Item "guestfs_btrfs_rescue_chunk_recover"
Scan and recover the chunk tree in Btrfs filesystems (Hu Tao).
.ie n .IP """guestfs_btrfs_rescue_super_recover""" 4
.el .IP "\f(CWguestfs_btrfs_rescue_super_recover\fR" 4
.IX Item "guestfs_btrfs_rescue_super_recover"
Restore superblocks in Btrfs filesystems (Hu Tao).
.ie n .IP """guestfs_btrfs_replace""" 4
.el .IP "\f(CWguestfs_btrfs_replace\fR" 4
.IX Item "guestfs_btrfs_replace"
Replace a device in a Btrfs filesystem (Cao Jin).
.ie n .IP """guestfs_btrfs_scrub""" 4
.el .IP "\f(CWguestfs_btrfs_scrub\fR" 4
.IX Item "guestfs_btrfs_scrub"
.PD 0
.ie n .IP """guestfs_btrfs_scrub_cancel""" 4
.el .IP "\f(CWguestfs_btrfs_scrub_cancel\fR" 4
.IX Item "guestfs_btrfs_scrub_cancel"
.ie n .IP """guestfs_btrfs_scrub_resume""" 4
.el .IP "\f(CWguestfs_btrfs_scrub_resume\fR" 4
.IX Item "guestfs_btrfs_scrub_resume"
.ie n .IP """guestfs_btrfs_scrub_status""" 4
.el .IP "\f(CWguestfs_btrfs_scrub_status\fR" 4
.IX Item "guestfs_btrfs_scrub_status"
.PD
Scrub a Btrfs filesystem (Hu Tao).
.ie n .IP """guestfs_btrfs_subvolume_get_default""" 4
.el .IP "\f(CWguestfs_btrfs_subvolume_get_default\fR" 4
.IX Item "guestfs_btrfs_subvolume_get_default"
Get the default subvolume of a Btrfs filesystem (Hu Tao).
.ie n .IP """guestfs_btrfs_subvolume_show""" 4
.el .IP "\f(CWguestfs_btrfs_subvolume_show\fR" 4
.IX Item "guestfs_btrfs_subvolume_show"
List detailed information about the subvolume of a Btrfs filesystem (Hu
Tao).
.ie n .IP """guestfs_btrfstune_enable_extended_inode_refs""" 4
.el .IP "\f(CWguestfs_btrfstune_enable_extended_inode_refs\fR" 4
.IX Item "guestfs_btrfstune_enable_extended_inode_refs"
.PD 0
.ie n .IP """guestfs_btrfstune_enable_skinny_metadata_extent_refs""" 4
.el .IP "\f(CWguestfs_btrfstune_enable_skinny_metadata_extent_refs\fR" 4
.IX Item "guestfs_btrfstune_enable_skinny_metadata_extent_refs"
.ie n .IP """guestfs_btrfstune_seeding""" 4
.el .IP "\f(CWguestfs_btrfstune_seeding\fR" 4
.IX Item "guestfs_btrfstune_seeding"
.PD
Various tuning parameters for Btrfs filesystems (Chen Hanxiao).
.ie n .IP """guestfs_c_pointer""" 4
.el .IP "\f(CWguestfs_c_pointer\fR" 4
.IX Item "guestfs_c_pointer"
Return the C pointer to the underlying \f(CW\*(C`guestfs_h *\*(C'\fR.  This allows
interworking of libguestfs bindings with bindings from other libraries.  For
further information see https://bugzilla.redhat.com/1075164
.ie n .IP """guestfs_copy_in""" 4
.el .IP "\f(CWguestfs_copy_in\fR" 4
.IX Item "guestfs_copy_in"
.PD 0
.ie n .IP """guestfs_copy_out""" 4
.el .IP "\f(CWguestfs_copy_out\fR" 4
.IX Item "guestfs_copy_out"
.PD
Flexible APIs for recursively copying directories of files between the host
and guest filesystem.  Previously these were available only as guestfish
commands, but now any \s-1API\s0 users can call them (Pino Toscano).
.ie n .IP """guestfs_part_get_gpt_guid""" 4
.el .IP "\f(CWguestfs_part_get_gpt_guid\fR" 4
.IX Item "guestfs_part_get_gpt_guid"
.PD 0
.ie n .IP """guestfs_part_set_gpt_guid""" 4
.el .IP "\f(CWguestfs_part_set_gpt_guid\fR" 4
.IX Item "guestfs_part_set_gpt_guid"
.PD
Get and set the \s-1GPT\s0 per-partition \s-1GUID.\s0
.ie n .IP """guestfs_part_get_mbr_part_type""" 4
.el .IP "\f(CWguestfs_part_get_mbr_part_type\fR" 4
.IX Item "guestfs_part_get_mbr_part_type"
Get \s-1MBR\s0 partition type (Chen Hanxiao).
.ie n .IP """guestfs_set_uuid_random""" 4
.el .IP "\f(CWguestfs_set_uuid_random\fR" 4
.IX Item "guestfs_set_uuid_random"
Set the \s-1UUID\s0 of a filesystem to a randomly generated value; supported
filesystems currently are ext2/3/4, \s-1XFS,\s0 Btrfs, and swap partitions.  (Chen
Hanxiao).
.PP
\fIOther \s-1API\s0 changes\fR
.IX Subsection "Other API changes"
.PP
\&\f(CW\*(C`guestfs_disk_create\*(C'\fR can now use \s-1VMDK\s0 files as backing files.
.PP
\&\f(CW\*(C`guestfs_btrfs_subvolume_snapshot\*(C'\fR takes extra optional parameters (all
added by Hu Tao):
.ie n .IP """ro""" 4
.el .IP "\f(CWro\fR" 4
.IX Item "ro"
for creating a read-only Btrfs snapshot
.ie n .IP """qgroupid""" 4
.el .IP "\f(CWqgroupid\fR" 4
.IX Item "qgroupid"
for adding the snapshot to a qgroup
.PP
\&\f(CW\*(C`guestfs_btrfs_subvolume_create\*(C'\fR can also take the optional \f(CW\*(C`qgroupid\*(C'\fR
parameter (Hu Tao).
.PP
\&\f(CW\*(C`guestfs_set_uuid\*(C'\fR can set \s-1UUID\s0 of swap partitions, Btrfs (Hu Tao, Chen
Hanxiao).
.PP
\&\f(CW\*(C`guestfs_copy_device_to_file\*(C'\fR and \f(CW\*(C`guestfs_copy_file_to_file\*(C'\fR have a new
optional \f(CW\*(C`append\*(C'\fR parameter, allowing you to append to the output file
instead of truncating it.
.PP
\&\f(CW\*(C`guestfs_mkfs\*(C'\fR has a new optional \f(CW\*(C`label\*(C'\fR parameter to set the initial
label of the new filesystem (Pino Toscano).
.PP
\&\f(CW\*(C`guestfs_set_label\*(C'\fR and \f(CW\*(C`guestfs_set_uuid\*(C'\fR now set \f(CW\*(C`ENOTSUP\*(C'\fR as errno
when there is no implemented support for the filesystem of the specified
mountable (Chen Hanxiao).
.PP
Environment variables now let you write \f(CW\*(C`LIBGUESTFS_DEBUG=true\*(C'\fR,
\&\f(CW\*(C`LIBGUESTFS_DEBUG=0\*(C'\fR and so on.
.PP
All \f(CW\*(C`guestfs_sfdisk*\*(C'\fR APIs have been deprecated.  Because \fIsfdisk\fR\|(8) was
rewritten, incompatibly, upstream, we don't recommend using these APIs in
future code.  Use the \f(CW\*(C`guestfs_part*\*(C'\fR APIs as replacements.
.PP
APIs such as \f(CW\*(C`guestfs_download\*(C'\fR do not truncate \fI/dev/stdout\fR or
\&\fI/dev/stderr\fR when writing to them, meaning that if you redirect stdout or
stderr to a file, the file is no longer truncated.
.SS "Build changes"
.IX Subsection "Build changes"
The daemon no longer uses its own separate copy of gnulib.  Instead it
shares a single copy with the library.
.PP
OCaml \fI.annot\fR files are now created, so IDEs and editors like emacs and vi
can browse OCaml types in the source code.
.PP
Various fixes to allow different host/appliance architecture builds (Pino
Toscano).
.PP
Automake is now used directly to build all the OCaml programs, instead of ad
hoc Makefile rules.  One side effect of this is to enable warnings in all
the C code used by OCaml programs.
.PP
\&\f(CW\*(C`\-fno\-strict\-overflow\*(C'\fR is used throughout the build to avoid dubious \s-1GCC\s0
optimizations.
.PP
Multiple cleanups to support \s-1GCC 5.\s0
.PP
OCaml OUnit2 is needed to run some OCaml tests.
.PP
Creating a statically linked \fIlibguestfs.a\fR should work again.
.PP
The \fIsrc/api\-support\fR subdirectory and its scripts are no longer used.
Instead we store in the \fIgenerator/actions.ml\fR when the \s-1API\s0 was added to
libguestfs.
.SS "Internationalization"
.IX Subsection "Internationalization"
The translation service has changed from Transifex to Zanata.
.PP
Many more translations are available now, for both library and tools
messages and documentation.
.SS "内部"
.IX Subsection "内部"
In all OCaml tools, there are now common \f(CW\*(C`error\*(C'\fR, \f(CW\*(C`warning\*(C'\fR, \f(CW\*(C`info\*(C'\fR
functions, and common way to set and get the \fI\-\-quiet\fR, \fI\-x\fR (trace)  and
\&\fI\-v\fR (verbose) flags, and colour highlighting used consistently.
.PP
\&\f(CW\*(C`COMPILE_REGEXP\*(C'\fR macros are used to simplify \s-1PCRE\s0 constructors and
destructors.
.PP
In the generator, \f(CW\*(C`Pointer\*(C'\fR arguments have finally been implemented.
.PP
Internal identifiers no longer use double and triple underscores
(eg. \f(CW\*(C`guestfs_\|_\|_program_name\*(C'\fR).  These identifiers are invalid for C99 and
\&\*(C+ programs, although compilers would accept them.
.PP
The daemon no longer parses \f(CW\*(C`guestfs_*\*(C'\fR options from \fI/proc/cmdline\fR.
Instead it only takes ordinary command line options.  The appliance init
script turns \fI/proc/cmdline\fR into daemon command line options.
.PP
The tests can now run the daemon as a \*(L"captive process\*(R", allowing it to be
run directly on the host.  The main advantage of this is we can run valgrind
directly on the daemon during testing.
.SS "バグ修正"
.IX Subsection "バグ修正"
.IP "https://bugzilla.redhat.com/1239053" 4
.IX Item "https://bugzilla.redhat.com/1239053"
virt\-v2v error reporting when grub.conf cannot be parsed by Augeas
.IP "https://bugzilla.redhat.com/1238053" 4
.IX Item "https://bugzilla.redhat.com/1238053"
v2v:Duplicate disk target set when convert guest with cdrom attached
.IP "https://bugzilla.redhat.com/1237869" 4
.IX Item "https://bugzilla.redhat.com/1237869"
Virtio drivers are not installed for windows 2008 guests by virt\-v2v
.IP "https://bugzilla.redhat.com/1234351" 4
.IX Item "https://bugzilla.redhat.com/1234351"
virt\-v2v Support for Fedora virtio-win drivers
.IP "https://bugzilla.redhat.com/1232192" 4
.IX Item "https://bugzilla.redhat.com/1232192"
Virt\-v2v gives an error on a blank disk: part_get_parttype: unknown
signature, of the output: \s-1BYT\s0;
.IP "https://bugzilla.redhat.com/1229385" 4
.IX Item "https://bugzilla.redhat.com/1229385"
virt\-p2v in kernel command line mode should power off the machine after
conversion
.IP "https://bugzilla.redhat.com/1229340" 4
.IX Item "https://bugzilla.redhat.com/1229340"
virt\-p2v no \s-1GUI\s0 mode appends \en to the final command line parameter
.IP "https://bugzilla.redhat.com/1229305" 4
.IX Item "https://bugzilla.redhat.com/1229305"
virt-sysprep at cleanup deletes /var/spool/at/.SEQ which results in failing
at
.IP "https://bugzilla.redhat.com/1226794" 4
.IX Item "https://bugzilla.redhat.com/1226794"
\&\*(L"Doing conversion……\*(R" still shows after cancel the conversion from virt\-p2v
client
.IP "https://bugzilla.redhat.com/1215042" 4
.IX Item "https://bugzilla.redhat.com/1215042"
Memory leak in virNetSocketNewConnectUNIX
.IP "https://bugzilla.redhat.com/1213324" 4
.IX Item "https://bugzilla.redhat.com/1213324"
virt\-v2v: warning: unknown guest operating system: windows windows 6.3 when
converting win8,win8.1,win2012,win2012R2 to rhev
.IP "https://bugzilla.redhat.com/1213247" 4
.IX Item "https://bugzilla.redhat.com/1213247"
virt tools should print the same format of version string
.IP "https://bugzilla.redhat.com/1212808" 4
.IX Item "https://bugzilla.redhat.com/1212808"
\&\s-1RFE:\s0 virt-builder \-\-touch
.IP "https://bugzilla.redhat.com/1212807" 4
.IX Item "https://bugzilla.redhat.com/1212807"
virt-builder \-\-selinux\-relabel flag fails on cross-architecture builds
.IP "https://bugzilla.redhat.com/1212680" 4
.IX Item "https://bugzilla.redhat.com/1212680"
\&\s-1RFE:\s0 virt-inspector xpath query should output a neat format of the query
element
.IP "https://bugzilla.redhat.com/1212152" 4
.IX Item "https://bugzilla.redhat.com/1212152"
virt-builder firstboot-command fails: File name too long
.IP "https://bugzilla.redhat.com/1211996" 4
.IX Item "https://bugzilla.redhat.com/1211996"
virt-inspector gives incorrect arch (ppc64) for ppc64le guest
.IP "https://bugzilla.redhat.com/1203817" 4
.IX Item "https://bugzilla.redhat.com/1203817"
\&\s-1RFE:\s0 virt-customize \-\-move and \-\-copy
.IP "https://bugzilla.redhat.com/1201526" 4
.IX Item "https://bugzilla.redhat.com/1201526"
index-parser can't parse systemd mount files properly
.IP "https://bugzilla.redhat.com/1196101" 4
.IX Item "https://bugzilla.redhat.com/1196101"
virt-builder \-\-upload option doesn't work to a \s-1FAT\s0 partition
.IP "https://bugzilla.redhat.com/1196100" 4
.IX Item "https://bugzilla.redhat.com/1196100"
virt-builder \-x option on its own does not enable tracing
.IP "https://bugzilla.redhat.com/1195204" 4
.IX Item "https://bugzilla.redhat.com/1195204"
`virt\-builder` should create \f(CW$HOME\fR/.cache directory if it already doesn't
exist
.IP "https://bugzilla.redhat.com/1193237" 4
.IX Item "https://bugzilla.redhat.com/1193237"
Virt-builder fingerprint is required even when no check desired
.IP "https://bugzilla.redhat.com/1189284" 4
.IX Item "https://bugzilla.redhat.com/1189284"
virt-resize should preserve \s-1GPT\s0 partition UUIDs, else \s-1EFI\s0 guests become
unbootable
.IP "https://bugzilla.redhat.com/1188866" 4
.IX Item "https://bugzilla.redhat.com/1188866"
Performance regression in virt-builder when uncompressing image
.IP "https://bugzilla.redhat.com/1186800" 4
.IX Item "https://bugzilla.redhat.com/1186800"
virt\-v2v should support gzip format ova as input
.IP "https://bugzilla.redhat.com/1185561" 4
.IX Item "https://bugzilla.redhat.com/1185561"
virt-sparsify should ignore read-only LVs
.IP "https://bugzilla.redhat.com/1182463" 4
.IX Item "https://bugzilla.redhat.com/1182463"
\&\*(L"mknod-b\*(R", \*(L"mknod-c\*(R", and \*(L"mkfifo\*(R" do not strip non-permissions bits from
\&\*(L"mode\*(R"
.IP "https://bugzilla.redhat.com/1176493" 4
.IX Item "https://bugzilla.redhat.com/1176493"
virt\-v2v ignores sound device when convert xen guest to local kvm
.IP "https://bugzilla.redhat.com/1175676" 4
.IX Item "https://bugzilla.redhat.com/1175676"
Typo error in 'help ping\-daemon'
.IP "https://bugzilla.redhat.com/1175196" 4
.IX Item "https://bugzilla.redhat.com/1175196"
\&\*(L"parse-environment\*(R" and \*(L"parse-environment-list\*(R" fail to parse
\&\*(L"\s-1LIBGUESTFS_TRACE\s0 = 0\*(R"
.IP "https://bugzilla.redhat.com/1175035" 4
.IX Item "https://bugzilla.redhat.com/1175035"
\&\*(L"is\-blockdev\*(R"/\*(L"is\-blockdev\-opts\*(R" fail to detect \*(L"/dev/sda\*(R"
.IP "https://bugzilla.redhat.com/1174280" 4
.IX Item "https://bugzilla.redhat.com/1174280"
\&\s-1RFE:\s0 Allow v2v conversion of Oracle Linux 5.8 VMware \s-1VM\s0
.IP "https://bugzilla.redhat.com/1174200" 4
.IX Item "https://bugzilla.redhat.com/1174200"
New virt\-v2v failure: \s-1CURL:\s0 Error opening file: \s-1NSS:\s0 client certificate not
found (nickname not specified): Invalid argument
.IP "https://bugzilla.redhat.com/1174123" 4
.IX Item "https://bugzilla.redhat.com/1174123"
Graphics password disappear after conversion of virt\-v2v
.IP "https://bugzilla.redhat.com/1174073" 4
.IX Item "https://bugzilla.redhat.com/1174073"
The listen address for vnc is changed after conversion by virt\-v2v
.IP "https://bugzilla.redhat.com/1171666" 4
.IX Item "https://bugzilla.redhat.com/1171666"
inspection thinks \s-1EFI\s0 partition is a separate operating system
.IP "https://bugzilla.redhat.com/1171130" 4
.IX Item "https://bugzilla.redhat.com/1171130"
virt\-v2v conversion of \s-1RHEL 3\s0 guest fails with: All of your loopback devices
are in use
.IP "https://bugzilla.redhat.com/1170685" 4
.IX Item "https://bugzilla.redhat.com/1170685"
Conversion of \s-1RHEL 4\s0 guest fails: rpm \-ql 1:kernel\-utils\-2.4\-23.el4:
virt\-v2v: error: libguestfs error: command_lines:
.IP "https://bugzilla.redhat.com/1170073" 4
.IX Item "https://bugzilla.redhat.com/1170073"
virt\-v2v picks debug kernels over non-debug kernels when versions are equal
.IP "https://bugzilla.redhat.com/1169045" 4
.IX Item "https://bugzilla.redhat.com/1169045"
virt-sparsify: libguestfs error: qemu-img info: 'virtual\-size' is not
representable as a 64 bit integer
.IP "https://bugzilla.redhat.com/1169015" 4
.IX Item "https://bugzilla.redhat.com/1169015"
virt-resize \-\-expand fails on ubuntu\-14.04.img image (regression)
.IP "https://bugzilla.redhat.com/1168144" 4
.IX Item "https://bugzilla.redhat.com/1168144"
warning: fstrim: fstrim: /sysroot/: \s-1FITRIM\s0 ioctl failed: Operation not
supported (ignored) when convert win2003 guest from xen server
.IP "https://bugzilla.redhat.com/1167921" 4
.IX Item "https://bugzilla.redhat.com/1167921"
p2v: No Network Connection dialog
.IP "https://bugzilla.redhat.com/1167774" 4
.IX Item "https://bugzilla.redhat.com/1167774"
virt\-p2v fails with error:\*(L"nbd.\fIc:nbd_receive_negotiate()\fR:L501: read failed\*(R"
.IP "https://bugzilla.redhat.com/1167623" 4
.IX Item "https://bugzilla.redhat.com/1167623"
Remove \*(L"If reporting bugs, run virt\-v2v with debugging enabled ..\*(R" message
when running virt\-p2v
.IP "https://bugzilla.redhat.com/1167601" 4
.IX Item "https://bugzilla.redhat.com/1167601"
\&\*(L"Conversion was successful\*(R" pop out even virt\-p2v fails
.IP "https://bugzilla.redhat.com/1167302" 4
.IX Item "https://bugzilla.redhat.com/1167302"
virt\-v2v: warning: ova hard disk has no parent controller when convert from
a ova file
.IP "https://bugzilla.redhat.com/1166618" 4
.IX Item "https://bugzilla.redhat.com/1166618"
virt-resize should give out the detail warning info to let customers know
what's going wrong
.IP "https://bugzilla.redhat.com/1165975" 4
.IX Item "https://bugzilla.redhat.com/1165975"
File \*(L"/boot/grub2/device.map\*(R" showing is not right after converting a rhel7
guest from esx server
.IP "https://bugzilla.redhat.com/1165785" 4
.IX Item "https://bugzilla.redhat.com/1165785"
mount-loop command fails: mount failed: Unknown error \-1
.IP "https://bugzilla.redhat.com/1165569" 4
.IX Item "https://bugzilla.redhat.com/1165569"
Disable \*(L"cancel conversion\*(R" button after virt\-p2v conversion finished
.IP "https://bugzilla.redhat.com/1165564" 4
.IX Item "https://bugzilla.redhat.com/1165564"
Provide Reboot/Shutdown button after virt\-p2v
.IP "https://bugzilla.redhat.com/1164853" 4
.IX Item "https://bugzilla.redhat.com/1164853"
Booting in qemu found no volume groups and failed checking the filesystems
.IP "https://bugzilla.redhat.com/1164732" 4
.IX Item "https://bugzilla.redhat.com/1164732"
The description of 'help append' is not accurately, it add the kernel
options to libguestfs appliance not the guest kernel
.IP "https://bugzilla.redhat.com/1164697" 4
.IX Item "https://bugzilla.redhat.com/1164697"
typo errors in man pages
.IP "https://bugzilla.redhat.com/1164619" 4
.IX Item "https://bugzilla.redhat.com/1164619"
Inspect-get-icon failed on \s-1RHEL7\s0 guest
.IP "https://bugzilla.redhat.com/1162966" 4
.IX Item "https://bugzilla.redhat.com/1162966"
xfs should also give a warning out to let customer know the limitation
.IP "https://bugzilla.redhat.com/1161575" 4
.IX Item "https://bugzilla.redhat.com/1161575"
Failed to import guest with \*(L"rtl8139\*(R" nic to openstack server after
converted by v2v
.IP "https://bugzilla.redhat.com/1159651" 4
.IX Item "https://bugzilla.redhat.com/1159651"
virt-sysprep firstboot script is not deleted if it reboot a \s-1RHEL 7\s0 guest
.IP "https://bugzilla.redhat.com/1159258" 4
.IX Item "https://bugzilla.redhat.com/1159258"
esx win2008 32 bit guest fail to load after conversion because the firmware
isn't \s-1ACPI\s0 compatible
.IP "https://bugzilla.redhat.com/1159016" 4
.IX Item "https://bugzilla.redhat.com/1159016"
libvirt backend does not set \s-1RBD\s0 password
.IP "https://bugzilla.redhat.com/1158526" 4
.IX Item "https://bugzilla.redhat.com/1158526"
Use password file instead of process interaction
.IP "https://bugzilla.redhat.com/1157679" 4
.IX Item "https://bugzilla.redhat.com/1157679"
virt\-p2v\-make\-disk should add firmwares
.IP "https://bugzilla.redhat.com/1156449" 4
.IX Item "https://bugzilla.redhat.com/1156449"
libguestfs \s-1FTBFS\s0 on f21 ppc64le
.IP "https://bugzilla.redhat.com/1156301" 4
.IX Item "https://bugzilla.redhat.com/1156301"
virt-inspector support adding a remote disk, but in its man page \-a \s-1URI /\s0
\&\-\-add \s-1URI\s0 is missing
.IP "https://bugzilla.redhat.com/1155121" 4
.IX Item "https://bugzilla.redhat.com/1155121"
Virt\-v2v will fail when using relative path for \-i ova
.IP "https://bugzilla.redhat.com/1153844" 4
.IX Item "https://bugzilla.redhat.com/1153844"
Redundancy whitespace at the end of directory name when use <\s-1TAB\s0> to
complete the directory name in guestfish with a xfs filesystem in guest
.IP "https://bugzilla.redhat.com/1153589" 4
.IX Item "https://bugzilla.redhat.com/1153589"
virt\-v2v will hang when converting esx guest before disk copy phase
.IP "https://bugzilla.redhat.com/1152998" 4
.IX Item "https://bugzilla.redhat.com/1152998"
virt\-v2v / qemu-img fails on ova image
.IP "https://bugzilla.redhat.com/1151910" 4
.IX Item "https://bugzilla.redhat.com/1151910"
virt-ls should remove '/' in the output when specify the directory name as
/etc/
.IP "https://bugzilla.redhat.com/1151900" 4
.IX Item "https://bugzilla.redhat.com/1151900"
Should also add a field for directory files when run virt-ls with \-\-csv
option
.IP "https://bugzilla.redhat.com/1151033" 4
.IX Item "https://bugzilla.redhat.com/1151033"
virt\-v2v conversions from VMware vCenter server run slowly
.IP "https://bugzilla.redhat.com/1146832" 4
.IX Item "https://bugzilla.redhat.com/1146832"
virt\-v2v fail to convert guest with disk type volume
.IP "https://bugzilla.redhat.com/1146007" 4
.IX Item "https://bugzilla.redhat.com/1146007"
Input/output error during conversion of esx guest.
.IP "https://bugzilla.redhat.com/1135585" 4
.IX Item "https://bugzilla.redhat.com/1135585"
[\s-1RFE\s0] virt-builder should support copying in a directory/list of files
.IP "https://bugzilla.redhat.com/1089566" 4
.IX Item "https://bugzilla.redhat.com/1089566"
[abrt] livecd-tools: kickstart.py:276:apply:IOError: [Errno 2] No such file
or directory:
\&'/run/media/jones/2tp001data/createlive/temp/imgcreate\-_dX8Us/install_root/etc/rpm/macros.imgcreate'
.IP "https://bugzilla.redhat.com/1079625" 4
.IX Item "https://bugzilla.redhat.com/1079625"
virt-sparsify fails if a btrfs filesystem contains readonly snapshots
.IP "https://bugzilla.redhat.com/1075164" 4
.IX Item "https://bugzilla.redhat.com/1075164"
\&\s-1RFE:\s0 allow passing in a pre-opened libvirt connection from python
.IP "https://bugzilla.redhat.com/912499" 4
.IX Item "https://bugzilla.redhat.com/912499"
Security context on image file gets reset
.IP "https://bugzilla.redhat.com/889082" 4
.IX Item "https://bugzilla.redhat.com/889082"
[\s-1RFE\s0] virt\-v2v should check whether guest with same name exist on target
first then transfer the disk
.IP "https://bugzilla.redhat.com/855059" 4
.IX Item "https://bugzilla.redhat.com/855059"
\&\s-1RFE:\s0 virt\-p2v: display more information about network devices such as
topology, bonding, etc.
.IP "https://bugzilla.redhat.com/823758" 4
.IX Item "https://bugzilla.redhat.com/823758"
p2v client should have largest number restrictions for \s-1CPU\s0 and Memory
settings
.IP "https://bugzilla.redhat.com/709327" 4
.IX Item "https://bugzilla.redhat.com/709327"
hivex cannot read registry hives from ReactOS
.IP "https://bugzilla.redhat.com/709326" 4
.IX Item "https://bugzilla.redhat.com/709326"
virt-inspector cannot detect ReactOS
.IP "https://bugzilla.redhat.com/119673" 4
.IX Item "https://bugzilla.redhat.com/119673"
installation via \s-1NFS\s0 doesn't seem to work
.SH "RELEASE NOTES FOR LIBGUESTFS 1.28"
.IX Header "RELEASE NOTES FOR LIBGUESTFS 1.28"
These release notes only cover the differences from the previous stable/dev
branch split (1.26.0).  For detailed changelogs, please see the git
repository, or the ChangeLog file distributed in the tarball.
.SS "New features"
.IX Subsection "New features"
\fITools\fR
.IX Subsection "Tools"
.PP
\&\fIvirt\-v2v\fR\|(1) and \fIvirt\-p2v\fR\|(1) are tools for converting from foreign
hypervisors (such as VMware or Xen) or physical machines, to \s-1KVM.\s0  These
tools were previously a separate project.  The code for both tools has been
integrated into the libguestfs tree.  As part of the refactoring, virt\-p2v
has been rewritten (from Ruby, now C), and virt\-v2v now uses several modern
features of qemu which make it run many times faster than before.
\&\fIvirt\-v2v\fR\|(1) can import from: VMware vCenter, VMware \s-1OVA\s0 files, local disk
files, libvirt, \s-1RHEL 5\s0 Xen.  It can output to: oVirt or Red Hat Enterprise
Virtualization (RHEV-M), OpenStack Glance, libvirt, qemu, local disk files.
.PP
\&\fIvirt\-log\fR\|(1) is a new tool for listing log files from guests.  It supports
a variety of guests including Linux traditional, Linux using journal, and
Windows event log.
.PP
\&\fIvirt\-builder\fR\|(1) has a new \f(CW\*(C`\-\-machine\-readable\*(C'\fR option to make it simpler
to consume virt-builder from other programs.
.PP
New \fIvirt\-builder\fR\|(1) and \fIvirt\-customize\fR\|(1) \fI\-\-chmod\fR option.
.PP
\&\fIvirt\-sysprep\fR\|(1) will now remove: systemd journals, anaconda logs, lightdm
logs, debian-installer files, apt logs, exim logs, ConsoleKit logs,
firewalld logs, grubby logs, proftpd logs, libvirt/libxml logs, and several
other log files.  The virt-sysprep \f(CW\*(C`user\-account\*(C'\fR operation is now able to
remove or keep particular user accounts.  (Pino Toscano).
.PP
New \fIguestmount\fR\|(1) \fI\-\-fd\fR option, allowing you to run guestmount captive
under another process.
.PP
\&\fIvirt\-sparsify\fR\|(1) has a new \fI\-\-tmp\fR option allowing you to precisely
control where temporary files are stored.
.PP
\&\fIvirt\-sparsify\fR\|(1) can now write to a block device.
.PP
\&\fIvirt\-customize\fR\|(1) and \fIvirt\-sysprep\fR\|(1) now support adding firstboot
scripts to Windows guests.
.PP
\&\fIvirt\-cat\fR\|(1), \fIvirt\-edit\fR\|(1), \fIvirt\-ls\fR\|(1) now support the \fI\-m\fR option,
allowing you to override automatic inspection of guests and instead specify
where to mount partitions (Pino Toscano).
.PP
The virt tools now have coloured output: green for \s-1OK,\s0 red for errors, blue
for warnings.
.PP
\fILanguage bindings\fR
.IX Subsection "Language bindings"
.PP
You can build a Python distribution using \f(CW\*(C`make \-C python sdist\*(C'\fR
.PP
Ruby bindings have switched from \f(CW\*(C`Test::Unit\*(C'\fR to \f(CW\*(C`MiniTest\*(C'\fR.
.PP
The Java bindings are now compatible with OpenJDK 8 (Pino Toscano).
.PP
\fIInspection\fR
.IX Subsection "Inspection"
.PP
Oracle Linux is returned as \f(CW\*(C`oraclelinux\*(C'\fR (Nikos Skalkotos).
.PP
Linux guests which do not have \fI/etc/fstab\fR can now be handled (Pino
Toscano).
.PP
Minix is returned as \f(CW\*(C`minix\*(C'\fR (Pino Toscano).
.PP
\fIArchitectures\fR
.IX Subsection "Architectures"
.PP
Aarch64 (64 bit \s-1ARM\s0) support has been added.
.PP
Inspection and the \f(CW\*(C`guestfs_file_architecture\*(C'\fR call can now recognize arm
(32 bit) and aarch64 guests.
.SS "Security"
.IX Subsection "Security"
.IP "\s-1CVE\-2014\-0191\s0 Network usage and entity resolution in \s-1XML\s0 parsing" 4
.IX Item "CVE-2014-0191 Network usage and entity resolution in XML parsing"
Libguestfs previously used unsafe libxml2 APIs for parsing libvirt \s-1XML.\s0
These APIs defaulted to allowing network connections to be made when certain
\&\s-1XML\s0 documents were presented.  Using a malformed \s-1XML\s0 document it was also
possible to exhaust all \s-1CPU,\s0 memory or file descriptors on the machine.
.Sp
Since the libvirt \s-1XML\s0 comes from a trusted source (the libvirt daemon)  it
is not thought that this could have been exploitable.
.Sp
This was fixed in libguestfs ≥ 1.27.9 and the fix was backported to
stable versions ≥ 1.26.2, ≥ 1.24.9, ≥ 1.22.10 and ≥
1.20.13.  (Thanks: Dan Berrange, Pino Toscano).
.IP "Shellshock (bash \s-1CVE\-2014\-6271\s0)" 4
.IX Item "Shellshock (bash CVE-2014-6271)"
This bash bug indirectly affects libguestfs.  For more information see:
https://www.redhat.com/archives/libguestfs/2014\-September/msg00252.html
.SS "\s-1API\s0"
.IX Subsection "API"
\fINew APIs\fR
.IX Subsection "New APIs"
.ie n .IP """guestfs_clear_backend_setting""" 4
.el .IP "\f(CWguestfs_clear_backend_setting\fR" 4
.IX Item "guestfs_clear_backend_setting"
.PD 0
.ie n .IP """guestfs_get_backend_setting""" 4
.el .IP "\f(CWguestfs_get_backend_setting\fR" 4
.IX Item "guestfs_get_backend_setting"
.ie n .IP """guestfs_set_backend_setting""" 4
.el .IP "\f(CWguestfs_set_backend_setting\fR" 4
.IX Item "guestfs_set_backend_setting"
.PD
Use these APIs to set individual backend settings.
.ie n .IP """guestfs_cpio_out""" 4
.el .IP "\f(CWguestfs_cpio_out\fR" 4
.IX Item "guestfs_cpio_out"
Convert a directory within the disk image to cpio format.
.ie n .IP """guestfs_journal_get_realtime_usec""" 4
.el .IP "\f(CWguestfs_journal_get_realtime_usec\fR" 4
.IX Item "guestfs_journal_get_realtime_usec"
Fetch precise journal times, see \fIsd_journal_get_realtime_usec\fR\|(3).
.ie n .IP """guestfs_lstatns""" 4
.el .IP "\f(CWguestfs_lstatns\fR" 4
.IX Item "guestfs_lstatns"
.PD 0
.ie n .IP """guestfs_lstatnslist""" 4
.el .IP "\f(CWguestfs_lstatnslist\fR" 4
.IX Item "guestfs_lstatnslist"
.ie n .IP """guestfs_statns""" 4
.el .IP "\f(CWguestfs_statns\fR" 4
.IX Item "guestfs_statns"
.PD
Enhanced versions of \f(CW\*(C`guestfs_lstat\*(C'\fR, \f(CW\*(C`guestfs_lstatlist\*(C'\fR, \f(CW\*(C`guestfs_stat\*(C'\fR
which return nanosecond timestamps.
.SS "Build changes"
.IX Subsection "Build changes"
Libguestfs can now be built with qemu 2.x.
.PP
Add support for packaging the appliance on Mageia (Joseph Wang, Thierry
Vignaud).
.PP
Augeas is now a required dependency.
.PP
Flex and bison are now required dependencies.
.SS "内部"
.IX Subsection "内部"
User-Mode Linux (\s-1UML\s0) is no longer a supported backend (although still
available).  It will be supported again once someone steps in and fixes
various regressions and brokenness in the \s-1UML\s0 (Linux) kernel.
.PP
You can now connect gdb to qemu by specifying
\&\f(CW\*(C`LIBGUESTFS_BACKEND_SETTINGS=gdb\*(C'\fR
.PP
Serial \s-1BIOS\s0 (sgabios) is now used by the libvirt backend (on x86 only)  so
that we see early \s-1BIOS\s0 messages.
.PP
For the OCaml virt tools, exceptions are now handled and printed by a common
function.
.PP
A \s-1GCC\s0 warning about large stack frames is now enabled by default.  Several
places that used large arrays and structures on the stack have been fixed.
.PP
There is now a test for booting the appliance repeatedly.  Useful for
finding kernel leaks.  See: \fItests/qemu/qemu\-boot.c\fR
.PP
There is a test for testing the speed of various qemu features such as
virtio-serial uploads and block device writes.  See:
\&\fItests/qemu/qemu\-speed\-test.c\fR
.PP
\&\s-1GCC\s0 warnings are now enabled for OCaml-C bindings in the OCaml virt tools.
.PP
The code for editing files used by \fIvirt\-edit\fR\|(1), \fIguestfish\fR\|(1) \f(CW\*(C`edit\*(C'\fR
command, \fIvirt\-customize\fR\|(1) \fI\-\-edit\fR option and more is now shared
between all these utilities (thanks Pino Toscano).
.PP
The \s-1FUSE\s0 tests were rewritten in C to ensure finer control over how system
calls are tested.
.PP
The \fIupdate\-bugs.sh\fR script has been fixed so it should no longer create an
empty \f(CW\*(C`BUGS\*(C'\fR file if the Bugzilla server is unavailable.
.PP
The \fIvirt\-resize\fR\|(1) tests now use a stochastic method to ensure much
deeper and broader testing.
.PP
When the network is enabled, the appliance now uses \s-1DHCP\s0 to acquire an \s-1IP\s0
address.
.PP
If libvirt is being used then the appliance will connect to \f(CW\*(C`virbr0\*(C'\fR (can
be overridden by setting
\&\f(CW\*(C`LIBGUESTFS_BACKEND_SETTINGS=network_bridge=<some_bridge>\*(C'\fR).  This
enables full-featured network connections, with working \s-1ICMP,\s0 ping and so
on.
.SS "バグ修正"
.IX Subsection "バグ修正"
.IP "https://bugzilla.redhat.com/1153515" 4
.IX Item "https://bugzilla.redhat.com/1153515"
empty (but set) \s-1LIBGUESTFS_BACKEND\s0 prints libguestfs: error: invalid
backend:
.IP "https://bugzilla.redhat.com/1151766" 4
.IX Item "https://bugzilla.redhat.com/1151766"
libguestfs-bash-completion package contains file
/usr/share/bash\-completion/completions/virt\-log, but no \fI_virt_log()\fR function
in that file
.IP "https://bugzilla.redhat.com/1151738" 4
.IX Item "https://bugzilla.redhat.com/1151738"
typo error in man page of virt-edit
.IP "https://bugzilla.redhat.com/1151033" 4
.IX Item "https://bugzilla.redhat.com/1151033"
virt\-v2v conversions from VMware vCenter server run slowly
.IP "https://bugzilla.redhat.com/1150880" 4
.IX Item "https://bugzilla.redhat.com/1150880"
virt\-v2v: warning: display <graphics type='sdl'> was ignored when converting
rhel5 guest with sdl graphics
.IP "https://bugzilla.redhat.com/1150867" 4
.IX Item "https://bugzilla.redhat.com/1150867"
\&'copy\-file\-to\-file /src /dest' create file /dest even if command
\&'copy\-file\-to\-file /src /dest' failed
.IP "https://bugzilla.redhat.com/1150815" 4
.IX Item "https://bugzilla.redhat.com/1150815"
Can not find \*(L"\s-1RECURSIVE LONG LISTING\*(R"\s0 in 'man virt\-diff'
.IP "https://bugzilla.redhat.com/1150701" 4
.IX Item "https://bugzilla.redhat.com/1150701"
virt\-v2v does not fstrim data disks and non-mounted filesystems
.IP "https://bugzilla.redhat.com/1150475" 4
.IX Item "https://bugzilla.redhat.com/1150475"
Exporting 2+ disk guest to \s-1RHEV,\s0 only one disk shows after import
.IP "https://bugzilla.redhat.com/1148355" 4
.IX Item "https://bugzilla.redhat.com/1148355"
virt-filesystems: incorrect \s-1LVM\s0 vg name when listing Fedora 21 Alpha Atomic
image filesystems
.IP "https://bugzilla.redhat.com/1148072" 4
.IX Item "https://bugzilla.redhat.com/1148072"
Option missing \-\-no\-selinux\-relabel
.IP "https://bugzilla.redhat.com/1148012" 4
.IX Item "https://bugzilla.redhat.com/1148012"
\&\s-1RFE:\s0 Allow qemu-bridge-helper to be used to implement guestfs_set_network
.IP "https://bugzilla.redhat.com/1146815" 4
.IX Item "https://bugzilla.redhat.com/1146815"
virt\-v2v prints warning: /files/etc/fstab/8/spec references unknown device
\&\*(L"cdrom\*(R"
.IP "https://bugzilla.redhat.com/1146275" 4
.IX Item "https://bugzilla.redhat.com/1146275"
regression setting root password with virt\-builder/virt\-customize
.IP "https://bugzilla.redhat.com/1146017" 4
.IX Item "https://bugzilla.redhat.com/1146017"
virt\-v2v \-v \-x during windows guest conversion will hang at hivex:
hivex_open: used block id ……
.IP "https://bugzilla.redhat.com/1145995" 4
.IX Item "https://bugzilla.redhat.com/1145995"
Improve the error info when converting windows guest with unclean file
system
.IP "https://bugzilla.redhat.com/1145916" 4
.IX Item "https://bugzilla.redhat.com/1145916"
virt\-v2v fails to convert win7 guest
.IP "https://bugzilla.redhat.com/1144891" 4
.IX Item "https://bugzilla.redhat.com/1144891"
\&\s-1RFE:\s0 stat calls do not return nanosecond timestamps
.IP "https://bugzilla.redhat.com/1144766" 4
.IX Item "https://bugzilla.redhat.com/1144766"
\&\fIfutimens()\fR is a no-op via guestmount
.IP "https://bugzilla.redhat.com/1144201" 4
.IX Item "https://bugzilla.redhat.com/1144201"
guestfish can not restore terminal's output colour when exit guestfish, if
the terminal's background colour is black then it will make a inconvenient
.IP "https://bugzilla.redhat.com/1143949" 4
.IX Item "https://bugzilla.redhat.com/1143949"
virt-customize option '\-\-password\-crypto' do not work
.IP "https://bugzilla.redhat.com/1143887" 4
.IX Item "https://bugzilla.redhat.com/1143887"
Warning shows when converting guests to rhev:chown: changing ownership of
‘/tmp/v2v.u48xag/*.ovf’: Invalid argument
.IP "https://bugzilla.redhat.com/1143883" 4
.IX Item "https://bugzilla.redhat.com/1143883"
warning shows when converting rhel7 guest:virt\-v2v:could not update grub2
console: aug_get: no matching node (ignored)
.IP "https://bugzilla.redhat.com/1143866" 4
.IX Item "https://bugzilla.redhat.com/1143866"
virt\-v2v fails with error: cannot open Packages index using db5
.IP "https://bugzilla.redhat.com/1142416" 4
.IX Item "https://bugzilla.redhat.com/1142416"
part-get-name give 'libguestfs: error: part_get_name: parted does not
support the machine output (\-m)' error message when run 'part\-get\-name
/dev/sda 1'
.IP "https://bugzilla.redhat.com/1142186" 4
.IX Item "https://bugzilla.redhat.com/1142186"
virt-sysprep option '\-\-mount\-options' don't work well
.IP "https://bugzilla.redhat.com/1142158" 4
.IX Item "https://bugzilla.redhat.com/1142158"
Illegal command 'part\-get\-name /dev/sda1 1' cause libguestfs appliance
crashed
.IP "https://bugzilla.redhat.com/1142004" 4
.IX Item "https://bugzilla.redhat.com/1142004"
virt\-v2v prints warning:WARNING:/files/boot/grub/device.map references
unknown device \*(L"xvda\*(R"
.IP "https://bugzilla.redhat.com/1141723" 4
.IX Item "https://bugzilla.redhat.com/1141723"
virt\-v2v: error: disk sda has no defined format shows when converting xen
hvm guest
.IP "https://bugzilla.redhat.com/1141680" 4
.IX Item "https://bugzilla.redhat.com/1141680"
[\s-1RFE\s0] virt\-v2 should support convert a domain with using domain's \s-1UUID\s0
instead of domain name
.IP "https://bugzilla.redhat.com/1141631" 4
.IX Item "https://bugzilla.redhat.com/1141631"
[\s-1RFE\s0] virt\-v2 should support convert a guest to a dir-pool with using pool's
uuid
.IP "https://bugzilla.redhat.com/1141157" 4
.IX Item "https://bugzilla.redhat.com/1141157"
virt-sysprep option '\-\-user\-accounts' don't work well
.IP "https://bugzilla.redhat.com/1141145" 4
.IX Item "https://bugzilla.redhat.com/1141145"
virt\-v2v fails to convert xen pv guests.
.IP "https://bugzilla.redhat.com/1141113" 4
.IX Item "https://bugzilla.redhat.com/1141113"
virt\-v2v fails to convert esx guests
.IP "https://bugzilla.redhat.com/1140946" 4
.IX Item "https://bugzilla.redhat.com/1140946"
qemu-img shows error message for backing file twice
.IP "https://bugzilla.redhat.com/1140894" 4
.IX Item "https://bugzilla.redhat.com/1140894"
No error messages output if append '\-\-format qcow2' after '\-a guest.img',
guest.img is a raw format image file
.IP "https://bugzilla.redhat.com/1140547" 4
.IX Item "https://bugzilla.redhat.com/1140547"
virt-builder option '\-\-format' don't work well
.IP "https://bugzilla.redhat.com/1140156" 4
.IX Item "https://bugzilla.redhat.com/1140156"
\&\s-1RFE:\s0 Export to \s-1RHEV\s0 data domain
.IP "https://bugzilla.redhat.com/1140050" 4
.IX Item "https://bugzilla.redhat.com/1140050"
No error shows when multiple conflicting options used with virt\-v2v
.IP "https://bugzilla.redhat.com/1139973" 4
.IX Item "https://bugzilla.redhat.com/1139973"
Improve the error info when converting xen guest with no passwordless \s-1SSH\s0
access configured
.IP "https://bugzilla.redhat.com/1139543" 4
.IX Item "https://bugzilla.redhat.com/1139543"
Improve the error info when converting guest with no space left
.IP "https://bugzilla.redhat.com/1138586" 4
.IX Item "https://bugzilla.redhat.com/1138586"
No error shows when converting running guest with virt\-v2v
.IP "https://bugzilla.redhat.com/1138184" 4
.IX Item "https://bugzilla.redhat.com/1138184"
virt\-v2v will fail when converting guests with initramfs\-*kdump.img under
/boot
.IP "https://bugzilla.redhat.com/1138182" 4
.IX Item "https://bugzilla.redhat.com/1138182"
xen guest will be kernel panic after converted by virt\-v2v
.IP "https://bugzilla.redhat.com/1130189" 4
.IX Item "https://bugzilla.redhat.com/1130189"
Annoying message about permissions of /dev/kvm
.IP "https://bugzilla.redhat.com/1123007" 4
.IX Item "https://bugzilla.redhat.com/1123007"
libguestfs 'direct' backend should close file descriptors before exec-ing
qemu to avoid leaking !O_CLOEXEC fds
.IP "https://bugzilla.redhat.com/1122557" 4
.IX Item "https://bugzilla.redhat.com/1122557"
virt-sparsify overwrites block devices if used as output files
.IP "https://bugzilla.redhat.com/1113156" 4
.IX Item "https://bugzilla.redhat.com/1113156"
Empty fstab breaks libguestfs inspection
.IP "https://bugzilla.redhat.com/1111662" 4
.IX Item "https://bugzilla.redhat.com/1111662"
Guestfs.Error(\*(L"vgchange_uuid_all: Volume group has active logical volumes\*(R")
.IP "https://bugzilla.redhat.com/1109174" 4
.IX Item "https://bugzilla.redhat.com/1109174"
virt-win-reg manual page is corrupted
.IP "https://bugzilla.redhat.com/1106548" 4
.IX Item "https://bugzilla.redhat.com/1106548"
root gets an error accessing to a non-root dir on a snapshot guestmount \s-1VMDK\s0
img
.IP "https://bugzilla.redhat.com/1103877" 4
.IX Item "https://bugzilla.redhat.com/1103877"
These APIs also need to add to `guestfish \-h` command list
.IP "https://bugzilla.redhat.com/1102448" 4
.IX Item "https://bugzilla.redhat.com/1102448"
mageia package list is incorrect
.IP "https://bugzilla.redhat.com/1102447" 4
.IX Item "https://bugzilla.redhat.com/1102447"
libguestfs 1.27.13 does not build due to libxml library order
.IP "https://bugzilla.redhat.com/1100498" 4
.IX Item "https://bugzilla.redhat.com/1100498"
\&\s-1RFE:\s0 non-polling mechanism to detect guestmount \-\-no\-fork readiness
.IP "https://bugzilla.redhat.com/1099490" 4
.IX Item "https://bugzilla.redhat.com/1099490"
scrub-file can't handle link file
.IP "https://bugzilla.redhat.com/1099284" 4
.IX Item "https://bugzilla.redhat.com/1099284"
typo errors in man pages
.IP "https://bugzilla.redhat.com/1098718" 4
.IX Item "https://bugzilla.redhat.com/1098718"
\&\s-1RFE:\s0 virt-builder aliases
.IP "https://bugzilla.redhat.com/1096465" 4
.IX Item "https://bugzilla.redhat.com/1096465"
virt-builder \*(L"proxy=off\*(R" setting doesn't turn off the proxy for downloads
.IP "https://bugzilla.redhat.com/1094746" 4
.IX Item "https://bugzilla.redhat.com/1094746"
virt-sparsify man failes to mention what happens to snapshots within a qcow2
image (they are discarded)
.IP "https://bugzilla.redhat.com/1092753" 4
.IX Item "https://bugzilla.redhat.com/1092753"
virt-builder: If several repos contain the same os-version images, then they
are duplicated in \-l output
.IP "https://bugzilla.redhat.com/1091803" 4
.IX Item "https://bugzilla.redhat.com/1091803"
tar-in-opts execute failed that cause libguestfs appliance crashed
.IP "https://bugzilla.redhat.com/1088424" 4
.IX Item "https://bugzilla.redhat.com/1088424"
virt-resize: libguestfs error: part_set_name: parted: /dev/sdb: Error during
translation: Invalid or incomplete multibyte or wide character
.IP "https://bugzilla.redhat.com/1088262" 4
.IX Item "https://bugzilla.redhat.com/1088262"
virt-builder cannot write to a block device
.IP "https://bugzilla.redhat.com/1085029" 4
.IX Item "https://bugzilla.redhat.com/1085029"
Ruby tests fail with latest Ruby
.IP "https://bugzilla.redhat.com/1079210" 4
.IX Item "https://bugzilla.redhat.com/1079210"
virt-sparsify \-\-in\-place cannot sparsify as much as it should
.IP "https://bugzilla.redhat.com/1079182" 4
.IX Item "https://bugzilla.redhat.com/1079182"
virt-df cannot report used disk space of windows guest when updated to 6.5
.IP "https://bugzilla.redhat.com/1077817" 4
.IX Item "https://bugzilla.redhat.com/1077817"
virt-builder error: \*(L"syntax error at line 3: syntax error\*(R"
.IP "https://bugzilla.redhat.com/1056290" 4
.IX Item "https://bugzilla.redhat.com/1056290"
virt-sparsify overwrites block devices if used as output files
.IP "https://bugzilla.redhat.com/812970" 4
.IX Item "https://bugzilla.redhat.com/812970"
virt-rescue cannot set ≥<rescue> prompt, on Ubuntu 12.04
.SH "RELEASE NOTES FOR LIBGUESTFS 1.26"
.IX Header "RELEASE NOTES FOR LIBGUESTFS 1.26"
These release notes only cover the differences from the previous stable/dev
branch split (1.24.0).  For detailed changelogs, please see the git
repository, or the ChangeLog file distributed in the tarball.
.SS "New features"
.IX Subsection "New features"
\fITools\fR
.IX Subsection "Tools"
.PP
\&\fIvirt\-customize\fR\|(1) is a new tool for customizing virtual machine disk
images.  It lets you install packages, edit configuration files, run
scripts, set passwords and so on.  \fIvirt\-builder\fR\|(1) and \fIvirt\-sysprep\fR\|(1)
use virt-customize, and command line options across all these tools are now
identical.
.PP
\&\fIvirt\-diff\fR\|(1) is a new tool for showing the differences between the
filesystems of two virtual machines.  It is mainly useful when showing what
files have been changed between snapshots.
.PP
\&\fIvirt\-builder\fR\|(1) has been greatly enhanced.  There are many more ways to
customize the virtual machine.  It can pull templates from multiple
repositories.  A parallelized internal xzcat implementation speeds up
template decompression.  Virt-builder uses an optimizing planner to choose
the fastest way to build the \s-1VM.\s0  It is now easier to use virt-builder from
other programs.  Internationalization support has been added to metadata.
More efficient SELinux relabelling of files.  Can build guests for multiple
architectures.  Error messages have been improved.  (Pino Toscano)
.PP
\&\fIvirt\-sparsify\fR\|(1) has a new \fI\-\-in\-place\fR option.  This sparsifies an
image in place (without copying it) and is also much faster.  (Lots of help
provided by Paolo Bonzini)
.PP
\&\fIvirt\-sysprep\fR\|(1) can delete and scrub files under user control.  You can
lock user accounts or set random passwords on accounts.  Can remove more log
files.  Can unsubscribe a guest from Red Hat Subscription Manager.  New
flexible way to enable and disable operations.  (Wanlong Gao, Pino Toscano)
.PP
\&\fIvirt\-win\-reg\fR\|(1) allows you to use URIs to specify remote disk images.
.PP
\&\fIvirt\-format\fR\|(1) can now pass the extra space that it recovers back to the
host.
.PP
\&\fIguestfish\fR\|(1) has additional environment variables to give fine control
over the \f(CW\*(C`><fs>\*(C'\fR prompt.  Guestfish reads its (rarely used)
configuration file in a different order now so that local settings override
global settings.  (Pino Toscano)
.PP
\&\fIvirt\-make\-fs\fR\|(1) was rewritten in C, but is unchanged in terms of
functionality and command line usage.
.PP
\fILanguage bindings\fR
.IX Subsection "Language bindings"
.PP
The OCaml bindings have a new \f(CW\*(C`Guestfs.Errno\*(C'\fR module, used to check the
error number returned by \f(CW\*(C`Guestfs.last_errno\*(C'\fR.
.PP
\&\s-1PHP\s0 tests now work.  (Pino Toscano)
.PP
\fIInspection\fR
.IX Subsection "Inspection"
.PP
Inspection can recognize Debian live images.
.PP
\fIArchitectures\fR
.IX Subsection "Architectures"
.PP
ARMv7 (32 bit) now supports \s-1KVM\s0 acceleration.
.PP
Aarch64 (\s-1ARM 64\s0 bit) is supported, but the appliance part does not work yet.
.PP
\&\s-1PPC64\s0 support has been fixed and enhanced.
.SS "Security"
.IX Subsection "Security"
.IP "Denial of service when inspecting disk images with corrupt btrfs volumes" 4
.IX Item "Denial of service when inspecting disk images with corrupt btrfs volumes"
It was possible to crash libguestfs (and programs that use libguestfs as a
library) by presenting a disk image containing a corrupt btrfs volume.
.Sp
This was caused by a \s-1NULL\s0 pointer dereference causing a denial of service,
and is not thought to be exploitable any further.
.Sp
See commit d70ceb4cbea165c960710576efac5a5716055486 for the fix.  This fix
is included in libguestfs stable branches ≥ 1.26.0, ≥ 1.24.6
and ≥ 1.22.8, and also in \s-1RHEL\s0 ≥ 7.0.  Earlier versions of
libguestfs are not vulnerable.
.IP "Better generation of random root passwords and random seeds" 4
.IX Item "Better generation of random root passwords and random seeds"
When generating random root passwords and random seeds, two bugs were fixed
which are possibly security related.  Firstly we no longer read excessive
bytes from \fI/dev/urandom\fR (most of which were just thrown away).  Secondly
we changed the code to avoid modulo bias.  These issues were not thought to
be exploitable.  (Both changes suggested by Edwin Török)
.SS "\s-1API\s0"
.IX Subsection "API"
\&\s-1GUID\s0 parameters are now validated when they are passed to \s-1API\s0 calls, whereas
previously you could have passed any string.  (Pino Toscano)
.PP
\fINew APIs\fR
.IX Subsection "New APIs"
.ie n .IP """guestfs_add_drive_opts"": new ""discard"" parameter" 4
.el .IP "\f(CWguestfs_add_drive_opts\fR: new \f(CWdiscard\fR parameter" 4
.IX Item "guestfs_add_drive_opts: new discard parameter"
The new \f(CW\*(C`discard\*(C'\fR parameter allows fine-grained control over discard/trim
support for a particular disk.  This allows the host file to become more
sparse (or thin-provisioned) when you delete files or issue the
\&\f(CW\*(C`guestfs_fstrim\*(C'\fR \s-1API\s0 call.
.ie n .IP """guestfs_add_domain"": new parameters: ""cachemode"", ""discard""" 4
.el .IP "\f(CWguestfs_add_domain\fR: new parameters: \f(CWcachemode\fR, \f(CWdiscard\fR" 4
.IX Item "guestfs_add_domain: new parameters: cachemode, discard"
These parameters are passed through when adding the domain's disks.
.ie n .IP """guestfs_blkdiscard""" 4
.el .IP "\f(CWguestfs_blkdiscard\fR" 4
.IX Item "guestfs_blkdiscard"
Discard all blocks on a guestfs device.  Combined with the \f(CW\*(C`discard\*(C'\fR
parameter above, this makes the host file sparse.
.ie n .IP """guestfs_blkdiscardzeroes""" 4
.el .IP "\f(CWguestfs_blkdiscardzeroes\fR" 4
.IX Item "guestfs_blkdiscardzeroes"
Test if discarded blocks read back as zeroes.
.ie n .IP """guestfs_compare_*""" 4
.el .IP "\f(CWguestfs_compare_*\fR" 4
.IX Item "guestfs_compare_*"
.PD 0
.ie n .IP """guestfs_copy_*""" 4
.el .IP "\f(CWguestfs_copy_*\fR" 4
.IX Item "guestfs_copy_*"
.PD
For each struct returned through the \s-1API,\s0 libguestfs now generates
\&\f(CW\*(C`guestfs_compare_*\*(C'\fR and \f(CW\*(C`guestfs_copy_*\*(C'\fR functions to allow you to compare
and copy structs.
.ie n .IP """guestfs_copy_attributes""" 4
.el .IP "\f(CWguestfs_copy_attributes\fR" 4
.IX Item "guestfs_copy_attributes"
Copy attributes (like permissions, xattrs, ownership) from one file to
another.  (Pino Toscano)
.ie n .IP """guestfs_disk_create""" 4
.el .IP "\f(CWguestfs_disk_create\fR" 4
.IX Item "guestfs_disk_create"
A flexible \s-1API\s0 for creating empty disk images from scratch.  This avoids the
need to call out to external programs like \fIqemu\-img\fR\|(1).
.ie n .IP """guestfs_get_backend_settings""" 4
.el .IP "\f(CWguestfs_get_backend_settings\fR" 4
.IX Item "guestfs_get_backend_settings"
.PD 0
.ie n .IP """guestfs_set_backend_settings""" 4
.el .IP "\f(CWguestfs_set_backend_settings\fR" 4
.IX Item "guestfs_set_backend_settings"
.PD
Per-backend settings (can also be set via the environment variable
\&\f(CW\*(C`LIBGUESTFS_BACKEND_SETTINGS\*(C'\fR).  The main use for this is forcing \s-1TCG\s0 mode
in the qemu-based backends, for example:
.Sp
.Vb 2
\& export LIBGUESTFS_BACKEND=direct
\& export LIBGUESTFS_BACKEND_SETTINGS=force_tcg
.Ve
.ie n .IP """guestfs_part_get_name""" 4
.el .IP "\f(CWguestfs_part_get_name\fR" 4
.IX Item "guestfs_part_get_name"
Get the label or name of a partition (for \s-1GPT\s0 disk images).
.SS "Build changes"
.IX Subsection "Build changes"
The following extra packages are required to build libguestfs 1.26:
.IP "supermin ≥ 5" 4
.IX Item "supermin ≥ 5"
Supermin version 5 is required to build this version of libguestfs.
.IP "flex, bison" 4
.IX Item "flex, bison"
Virt-builder now uses a real parser to parse its metadata file, so these
tools are required.
.IP "xz" 4
.IX Item "xz"
This is now a required build dependency, where previously it was (in theory)
optional.
.SS "内部"
.IX Subsection "内部"
\&\s-1PO\s0 message extraction rewritten to be more robust.  (Pino Toscano)
.PP
\&\f(CW\*(C`podwrapper\*(C'\fR gives an error if the \fI\-\-insert\fR or \fI\-\-verbatim\fR argument
pattern is not found.
.PP
Libguestfs now passes the qemu \fI\-enable\-fips\fR option to enable \s-1FIPS,\s0 if
qemu supports it.
.PP
\&\f(CW\*(C`./configure \-\-without\-qemu\*(C'\fR can be used if you don't want to specify a
default hypervisor.
.PP
Copy-on-write [\s-1COW\s0] overlays, used for example for read-only drives, are now
created through an internal backend \s-1API\s0 (\f(CW\*(C`.create_cow_overlay\*(C'\fR).
.PP
Libvirt backend uses some funky C macros to generate \s-1XML.\s0  These are simpler
and safer.
.PP
The ChangeLog file format has changed.  It is now just the same as \f(CW\*(C`git
log\*(C'\fR, instead of using a custom format.
.PP
Appliance start-up has changed:
.IP "\(bu" 4
The libguestfs appliance now initializes \s-1LVM\s0 the same way as it is done on
physical machines.
.IP "\(bu" 4
The libguestfs appliance does not write an empty string to
\&\fI/proc/sys/kernel/hotplug\fR when starting up.
.Sp
Note that you \fBmust\fR configure your kernel to have
\&\f(CW\*(C`CONFIG_UEVENT_HELPER_PATH=""\*(C'\fR otherwise you will get strange \s-1LVM\s0 errors
(this applies as much to any Linux machine, not just libguestfs).  (Peter
Rajnoha)
.PP
Libguestfs can now be built on arches that have \fIocamlc\fR\|(1) but not
\&\fIocamlopt\fR\|(1).  (Hilko Bengen, Olaf Hering)
.PP
You cannot use \f(CW\*(C`./configure \-\-disable\-daemon \-\-enable\-appliance\*(C'\fR.  It made
no sense anyway.  Now it is expressly forbidden by the configure script.
.PP
The packagelist file uses \f(CW\*(C`m4\*(C'\fR for macro expansion instead of \f(CW\*(C`cpp\*(C'\fR.
.SS "バグ修正"
.IX Subsection "バグ修正"
.IP "https://bugzilla.redhat.com/1073906" 4
.IX Item "https://bugzilla.redhat.com/1073906"
java bindings inspect_list_applications2 throws
java.lang.ArrayIndexOutOfBoundsException:
.IP "https://bugzilla.redhat.com/1063374" 4
.IX Item "https://bugzilla.redhat.com/1063374"
[\s-1RFE\s0] enable subscription manager clean or unregister operation to sysprep
.IP "https://bugzilla.redhat.com/1060404" 4
.IX Item "https://bugzilla.redhat.com/1060404"
virt-resize does not preserve \s-1GPT\s0 partition names
.IP "https://bugzilla.redhat.com/1057504" 4
.IX Item "https://bugzilla.redhat.com/1057504"
mount-local should give a clearer error if root is not mounted
.IP "https://bugzilla.redhat.com/1056290" 4
.IX Item "https://bugzilla.redhat.com/1056290"
virt-sparsify overwrites block devices if used as output files
.IP "https://bugzilla.redhat.com/1055452" 4
.IX Item "https://bugzilla.redhat.com/1055452"
libguestfs: error: invalid backend: appliance
.IP "https://bugzilla.redhat.com/1054761" 4
.IX Item "https://bugzilla.redhat.com/1054761"
guestfs_pvs prints \*(L"unknown device\*(R" if a physical volume is missing
.IP "https://bugzilla.redhat.com/1053847" 4
.IX Item "https://bugzilla.redhat.com/1053847"
Recommended default clock/timer settings
.IP "https://bugzilla.redhat.com/1046509" 4
.IX Item "https://bugzilla.redhat.com/1046509"
ruby-libguestfs throws \*(L"expecting 0 or 1 arguments\*(R" on Guestfs::Guestfs.new
.IP "https://bugzilla.redhat.com/1045450" 4
.IX Item "https://bugzilla.redhat.com/1045450"
Cannot inspect cirros 0.3.1 disk image fully
.IP "https://bugzilla.redhat.com/1045033" 4
.IX Item "https://bugzilla.redhat.com/1045033"
LIBVIRT_DEFAULT_URI=qemu:///system breaks libguestfs
.IP "https://bugzilla.redhat.com/1044585" 4
.IX Item "https://bugzilla.redhat.com/1044585"
virt-builder network (eg. \-\-install) doesn't work if resolv.conf sets
nameserver 127.0.0.1
.IP "https://bugzilla.redhat.com/1044014" 4
.IX Item "https://bugzilla.redhat.com/1044014"
When \s-1SSSD\s0 is installed, libvirt configuration requires authentication, but
not clear to user
.IP "https://bugzilla.redhat.com/1039995" 4
.IX Item "https://bugzilla.redhat.com/1039995"
virt-make-fs fails making fat/vfat whole disk: Device partition expected,
not making filesystem on entire device '/dev/sda' (use \-I to override)
.IP "https://bugzilla.redhat.com/1039540" 4
.IX Item "https://bugzilla.redhat.com/1039540"
virt-sysprep to delete more logfiles
.IP "https://bugzilla.redhat.com/1033207" 4
.IX Item "https://bugzilla.redhat.com/1033207"
\&\s-1RFE:\s0 libguestfs inspection does not recognize Free4NAS live \s-1CD\s0
.IP "https://bugzilla.redhat.com/1028660" 4
.IX Item "https://bugzilla.redhat.com/1028660"
\&\s-1RFE:\s0 virt\-sysprep/virt\-builder should have an option to lock a user account
.IP "https://bugzilla.redhat.com/1026688" 4
.IX Item "https://bugzilla.redhat.com/1026688"
libguestfs fails examining libvirt guest with ceph drives: rbd: image name
must begin with a '/'
.IP "https://bugzilla.redhat.com/1022431" 4
.IX Item "https://bugzilla.redhat.com/1022431"
virt-builder fails if \f(CW$HOME\fR/.cache doesn't exist
.IP "https://bugzilla.redhat.com/1022184" 4
.IX Item "https://bugzilla.redhat.com/1022184"
libguestfs: do not use versioned jar file
.IP "https://bugzilla.redhat.com/1020806" 4
.IX Item "https://bugzilla.redhat.com/1020806"
All libguestfs \s-1LVM\s0 operations fail on Debian/Ubuntu
.IP "https://bugzilla.redhat.com/1008417" 4
.IX Item "https://bugzilla.redhat.com/1008417"
Need update helpout of part-set-gpt-type
.IP "https://bugzilla.redhat.com/953907" 4
.IX Item "https://bugzilla.redhat.com/953907"
virt-sysprep does not correctly set the hostname on Debian/Ubuntu
.IP "https://bugzilla.redhat.com/923355" 4
.IX Item "https://bugzilla.redhat.com/923355"
guestfish prints literal \*(L"\en\*(R" in error messages
.IP "https://bugzilla.redhat.com/660687" 4
.IX Item "https://bugzilla.redhat.com/660687"
guestmount: \*(L"touch\*(R" command fails: touch: setting times of `timestamp':
Invalid argument
.IP "https://bugzilla.redhat.com/593511" 4
.IX Item "https://bugzilla.redhat.com/593511"
[\s-1RFE\s0] function to get partition name
.IP "https://bugzilla.redhat.com/563450" 4
.IX Item "https://bugzilla.redhat.com/563450"
list-devices returns devices of different types out of order
.SH "RELEASE NOTES FOR LIBGUESTFS 1.24"
.IX Header "RELEASE NOTES FOR LIBGUESTFS 1.24"
These release notes only cover the differences from the previous stable/dev
branch split (1.22.0).  For detailed changelogs, please see the git
repository, or the ChangeLog file distributed in the tarball.
.SS "New features"
.IX Subsection "New features"
User-Mode Linux (\s-1UML\s0) can be used as an alternative backend (ie. instead of
\&\s-1KVM\s0).  This improves performance especially when using libguestfs inside a
\&\s-1VM\s0 (eg. in the cloud).  \s-1UML\s0 is supported as a first-class backend.  See
\&\*(L"USER-MODE \s-1LINUX BACKEND\*(R"\s0 in \fIguestfs\fR\|(3) for how to use this.
.PP
\&\s-1ARM\s0 (32 bit) and \s-1PPC64\s0 are now fully supported.
.PP
\fITools\fR
.IX Subsection "Tools"
.PP
\&\fIvirt\-builder\fR\|(1) is a new tool for building virtual machine images.  It
lets you rapidly and securely create guests and customize them.
.PP
New \fIvirt\-sysprep\fR\|(1) operations: Remove files in \fI/tmp\fR and \fI/var/tmp\fR.
Remove \s-1RPM\s0 database files.  Change root and user passwords.  More log files
are removed.  New operations which are not enabled by default: Create random
UUIDs for filesystems.  Reset firewall rules.  (Wanlong Gao)
.PP
\&\fIvirt\-resize\fR\|(1) and virt-sysprep can now use URIs to specify a remote
disk.
.PP
Use \f(CW\*(C`guestfish \-N filename=type\*(C'\fR to create a named disk image (instead of
the default \fItest1.img\fR etc).
.PP
\&\fIvirt\-sparsify\fR\|(1) now tests if there is enough disk space to complete the
operation, instead of possibly running out of space half way through.
.PP
\&\fIvirt\-format\fR\|(1) and \fIvirt\-make\-fs\fR\|(1): new \fI\-\-label\fR option for setting
filesystem label.
.PP
virt-resize \fI\-\-no\-sparse\fR flag can be used to resize on to partitions and
other targets that are not zeroed.
.PP
\fILanguage bindings\fR
.IX Subsection "Language bindings"
.PP
New bindings for the Go programming language.
.PP
\fI\s-1API\s0\fR
.IX Subsection "API"
.PP
Support for the systemd journal.
.PP
\&\f(CW\*(C`guestfs_add_drive_opts\*(C'\fR can now control the qemu caching mode through a
new \f(CW\*(C`cachemode\*(C'\fR parameter.  You can select improved performance for
temporary drives, or safety.
.PP
\&\f(CW\*(C`guestfs_set_label\*(C'\fR now works for \s-1XFS\s0 and btrfs.
.PP
New \s-1GUESTFS_EVENT_WARNING\s0 event for warning messages.
.PP
\fIInspection\fR
.IX Subsection "Inspection"
.PP
Better inspection of \s-1SUSE\s0 guests (Olaf Hering).
.PP
Better support for non-standard Windows \f(CW%systemroot\fR% (Matthew Booth).
.PP
Enhanced error reporting for Augeas errors.
.SS "Security"
.IX Subsection "Security"
.IP "\s-1CVE\-2013\-2124\s0" 4
.IX Item "CVE-2013-2124"
https://bugzilla.redhat.com/show_bug.cgi?id=968306
.Sp
A denial of service was possible when inspecting certain guests.  The fix
has been backported to 1.20 and 1.22 branches.
.IP "\s-1CVE\-2013\-4419\s0" 4
.IX Item "CVE-2013-4419"
https://www.redhat.com/archives/libguestfs/2013\-October/msg00031.html
.Sp
Fix insecure temporary directory handling for remote guestfish.  The fix has
been backported to 1.20 and 1.22 branches.
.SS "New APIs"
.IX Subsection "New APIs"
.Vb 12
\& add\-drive\-scratch: Add a temporary scratch drive
\& aug\-label
\& aug\-setm
\& journal\-open: Systemd journal support
\& journal\-close
\& journal\-next
\& journal\-skip
\& journal\-get
\& journal\-get\-data\-threshold
\& journal\-set\-data\-threshold
\& remount: Allow rw flag to be adjusted on mounted filesystems
\& set\-uuid: Set UUID of filesystem
.Ve
.PP
\&\f(CW\*(C`is\-file\*(C'\fR, \f(CW\*(C`is\-dir\*(C'\fR, \f(CW\*(C`is\-blockdev\*(C'\fR, \f(CW\*(C`is\-chardev\*(C'\fR, \f(CW\*(C`is\-fifo\*(C'\fR,
\&\f(CW\*(C`is\-socket\*(C'\fR APIs now have an extra \f(CW\*(C`followsymlinks\*(C'\fR flag.
.PP
\&\f(CW\*(C`add\-drive\*(C'\fR has a new \f(CW\*(C`cachemode\*(C'\fR parameter.
.SS "Build changes"
.IX Subsection "Build changes"
The following packages are required to build libguestfs 1.24:
.IP "Augeas ≥ 1.0.0" 4
.IX Item "Augeas ≥ 1.0.0"
.PP
The following optional packages may be added to enhance functionality but
are not required:
.IP "sd-journal" 4
.IX Item "sd-journal"
To read journal files from guests which use that.
.IP "url_mkcow" 4
.IX Item "url_mkcow"
For \s-1UML\s0 backend.
.IP "curl" 4
.IX Item "curl"
.PD 0
.IP "gpg" 4
.IX Item "gpg"
.IP "xz" 4
.IX Item "xz"
.PD
For virt-builder.
.IP "golang ≥ 1.1.1" 4
.IX Item "golang ≥ 1.1.1"
For Go language bindings.
.SS "内部"
.IX Subsection "内部"
New \f(CW\*(C`make check\-*\*(C'\fR rules replace \f(CW\*(C`make extra\-tests\*(C'\fR.  See \f(CW\*(C`make help\*(C'\fR and
\&\fIguestfs\fR\|(3) for details.
.PP
Perl code can now be valgrinded.
.PP
Inspection code is now fuzz-tested.
.PP
\&\f(CW\*(C`make\*(C'\fR no longer recurses into the generator directory in every other
directory.  This reduces the overhead of builds considerably.
.PP
Additional tests for Augeas, hivex.
.PP
Add a launch timeout of 20 minutes waiting for the appliance to start up.
.PP
Add a timeout (4 hours) to all tests so we can catch the case where qemu or
other components hang.
.PP
Use kvmclock and \f(CW\*(C`\-cpu host\*(C'\fR.  This improves clock stability and overall
performance.
.PP
\&\f(CW\*(C`./configure \-\-enable\-packet\-dump\*(C'\fR mode is fixed.
.PP
\&\f(CW\*(C`./configure \-\-enable\-valgrind\-daemon\*(C'\fR mode has been rewritten.  It is now
feasible for developers to keep this flag enabled at all times.
.PP
Backends have been refactored to be modular (although they are not actually
loadable modules).
.PP
When enabled, the network now uses resolver configuration
(ie. /etc/resolv.conf) from the host.
.SS "バグ修正"
.IX Subsection "バグ修正"
.IP "https://bugzilla.redhat.com/1019889" 4
.IX Item "https://bugzilla.redhat.com/1019889"
libguestfs\-tools.conf should have a man page
.IP "https://bugzilla.redhat.com/1018149" 4
.IX Item "https://bugzilla.redhat.com/1018149"
valgrind errors in btrfs_subvolume_list
.IP "https://bugzilla.redhat.com/1002032" 4
.IX Item "https://bugzilla.redhat.com/1002032"
mke2fs can't return the correct filesystem type when blockscount is less
than 2048 for ext3
.IP "https://bugzilla.redhat.com/1001876" 4
.IX Item "https://bugzilla.redhat.com/1001876"
Update \*(L"rsync-out\*(R" helpout for using wildcard
.IP "https://bugzilla.redhat.com/1001875" 4
.IX Item "https://bugzilla.redhat.com/1001875"
Argument 'excludes' of tar-out does not work
.IP "https://bugzilla.redhat.com/1000428" 4
.IX Item "https://bugzilla.redhat.com/1000428"
virt-format uses wrong partition type for vfat filesystems
.IP "https://bugzilla.redhat.com/1000121" 4
.IX Item "https://bugzilla.redhat.com/1000121"
\&'sh' command before mount causes daemon to segfault
.IP "https://bugzilla.redhat.com/998513" 4
.IX Item "https://bugzilla.redhat.com/998513"
guestfish does not work when you mix \-\-remote and \-\-add options
.IP "https://bugzilla.redhat.com/998482" 4
.IX Item "https://bugzilla.redhat.com/998482"
guestfish remote prints \*(L"libguestfs: error: waitpid (qemu): No child
processes\*(R"
.IP "https://bugzilla.redhat.com/995711" 4
.IX Item "https://bugzilla.redhat.com/995711"
list-filesystems command fails if there are no block devices
.IP "https://bugzilla.redhat.com/994517" 4
.IX Item "https://bugzilla.redhat.com/994517"
cache=none/O_DIRECT workaround doesn't work for images with backing files
.IP "https://bugzilla.redhat.com/989356" 4
.IX Item "https://bugzilla.redhat.com/989356"
cap-get-file will return error if the file has not be set capabilities
.IP "https://bugzilla.redhat.com/986877" 4
.IX Item "https://bugzilla.redhat.com/986877"
\&\s-1RFE:\s0 Implement set-uuid command
.IP "https://bugzilla.redhat.com/986875" 4
.IX Item "https://bugzilla.redhat.com/986875"
\&\s-1RFE:\s0 Implement set-label for xfs
.IP "https://bugzilla.redhat.com/985269" 4
.IX Item "https://bugzilla.redhat.com/985269"
Can't set acl value for a specified user with 'acl\-set\-file'
.IP "https://bugzilla.redhat.com/983218" 4
.IX Item "https://bugzilla.redhat.com/983218"
libguestfs double free when kernel link fails during launch
.IP "https://bugzilla.redhat.com/981715" 4
.IX Item "https://bugzilla.redhat.com/981715"
Make xfs filesystem failed with specified blocksize, gives \*(L"unknown option
\&\-b\*(R" error
.IP "https://bugzilla.redhat.com/981683" 4
.IX Item "https://bugzilla.redhat.com/981683"
\&\*(L"hivex-commit\*(R" should fail with a relative path
.IP "https://bugzilla.redhat.com/981663" 4
.IX Item "https://bugzilla.redhat.com/981663"
disk-format \*(L"qemu-img info: \s-1JSON\s0 parse error\*(R" when target file does not
exist
.IP "https://bugzilla.redhat.com/978302" 4
.IX Item "https://bugzilla.redhat.com/978302"
mke2fs\-J should give a meaningful error when specified type is anything
except 'ext{2,3,4}'
.IP "https://bugzilla.redhat.com/975797" 4
.IX Item "https://bugzilla.redhat.com/975797"
Specifying virtio interface ('iface' parameter) breaks the direct backend \-
libguestfs hangs
.IP "https://bugzilla.redhat.com/975753" 4
.IX Item "https://bugzilla.redhat.com/975753"
\&\*(L"virt-resize \-\-expand\*(R" and \*(L"virt-resize \-\-resize\*(R" outputs error message for
Win2008 32bit \s-1OS\s0
.IP "https://bugzilla.redhat.com/975412" 4
.IX Item "https://bugzilla.redhat.com/975412"
inspection: Augeas expressions are broken with augeas >= 0.10
.IP "https://bugzilla.redhat.com/974904" 4
.IX Item "https://bugzilla.redhat.com/974904"
virt-resize \-\-expand fails on Ubuntu Cloud Image
.IP "https://bugzilla.redhat.com/974489" 4
.IX Item "https://bugzilla.redhat.com/974489"
Regression: Fedora inspection broken by change from guestfs_exists to
guestfs_is_file
.IP "https://bugzilla.redhat.com/972775" 4
.IX Item "https://bugzilla.redhat.com/972775"
txz-out command produces a bzip2\-compressed file (should be xz-compressed)
.IP "https://bugzilla.redhat.com/969845" 4
.IX Item "https://bugzilla.redhat.com/969845"
upload to a directory occasionally hangs instead of failing
.IP "https://bugzilla.redhat.com/968875" 4
.IX Item "https://bugzilla.redhat.com/968875"
virt-sysprep should support URL-type arguments
.IP "https://bugzilla.redhat.com/624334" 4
.IX Item "https://bugzilla.redhat.com/624334"
blockdev-setbsz succeeds, but does not affect blockdev-getbsz
.SH "RELEASE NOTES FOR LIBGUESTFS 1.22"
.IX Header "RELEASE NOTES FOR LIBGUESTFS 1.22"
These release notes only cover the differences from the previous stable/dev
branch split (1.20.0).  For detailed changelogs, please see the git
repository, or the ChangeLog file distributed in the tarball.
.SS "New features"
.IX Subsection "New features"
\fI\s-1API\s0\fR
.IX Subsection "API"
.PP
Remote access to disks:
.IP "\(bu" 4
Network Block Device (nbd)
.IP "\(bu" 4
Secure Shell (ssh)
.IP "\(bu" 4
\&\s-1HTTP\s0 and \s-1HTTPS\s0
.IP "\(bu" 4
\&\s-1FTP\s0 and \s-1FTPS\s0
.IP "\(bu" 4
iSCSI
.IP "\(bu" 4
Gluster
.IP "\(bu" 4
Ceph/rbd (Mike Kelly)
.IP "\(bu" 4
Sheepdog
.IP "\(bu" 4
\&\s-1TFTP\s0
.PP
The \s-1SYSLINUX\s0 and \s-1EXTLINUX\s0 bootloaders can now be installed in disk images
using the \s-1API.\s0
.PP
Inspection can now handle filesystems such as btrfs where subvolumes are
separately mountable (Matthew Booth).
.PP
\&\*(L"Attach methods\*(R" are now known as \*(L"backends\*(R".  Compatibility with existing
code is preserved.
.PP
Filenames can contain ':', as long as newer \s-1QEMU\s0 is being used.
.PP
\fITools\fR
.IX Subsection "Tools"
.PP
Virt-alignment-scan and virt-df scan multiple guests in parallel.
.PP
Guestmount now passes errno accurately back to userspace in almost all
cases.
.PP
Guestfish and other tools can now use a URI-like syntax to access remote
disks, eg:
.PP
.Vb 1
\& guestfish \-a ssh://example.com/path/to/disk.img
.Ve
.PP
Guestfish and guestmount now allow you to specify the filesystem type when
mounting, which is more secure (Dave Vasilevsky).
.PP
Guestfish is now the \*(L"guest filesystem shell\*(R".
.PP
Guestfish allows only \f(CW1\fR \f(CW\*(C`true\*(C'\fR \f(CW\*(C`t\*(C'\fR \f(CW\*(C`yes\*(C'\fR \f(CW\*(C`y\*(C'\fR \f(CW\*(C`on\*(C'\fR \f(CW0\fR \f(CW\*(C`false\*(C'\fR \f(CW\*(C`f\*(C'\fR
\&\f(CW\*(C`no\*(C'\fR \f(CW\*(C`n\*(C'\fR \f(CW\*(C`off\*(C'\fR for boolean values (case insensitive), and gives an error
for all other strings.
.PP
New tool \f(CW\*(C`guestunmount\*(C'\fR for unmounting \s-1FUSE\s0 filesystems safely.
.PP
\&\f(CW\*(C`guestmount \-\-no\-fork\*(C'\fR flag prevents guestmount from daemonizing.
.PP
Virt-resize now uses sparse copies by default, saving considerable space for
guests which are mostly empty.
.PP
Bash tab completion has been rewritten and can now handle most tools, and
correctly tab-complete \f(CW\*(C`\-\-long\*(C'\fR options.  In addition, bash completion
scripts are loaded on demand.
.PP
\fILanguage bindings\fR
.IX Subsection "Language bindings"
.PP
The Java \s-1API\s0 now supports events.
.PP
The Python object now inherits from the \f(CW\*(C`object\*(C'\fR base class.
.PP
Python methods which previously returned lists of tuples can now be made to
return a Python dict.  For backwards compatibility, you have to enable this
by using the constructor option \f(CW\*(C`guestfs.GuestFS (python_return_dict=True)\*(C'\fR.
.PP
The \s-1PHP\s0 bindings are now tested properly, and have had multiple fixes.
.PP
The long-deprecated Perl \f(CW\*(C`Sys::Guestfs::Lib\*(C'\fR library has been removed.
https://www.redhat.com/archives/libguestfs/2013\-April/msg00001.html
.PP
\fI例\fR
.IX Subsection "例"
.PP
新しいプログラム例は、デバッグを有効化し、ログメッセージを採取する方法を示します。
.PP
\fIOther\fR
.IX Subsection "Other"
.PP
Distributors can add arbitrary extra packages to the appliance by doing:
.PP
.Vb 1
\& ./configure \-\-with\-extra\-packages="list of package names"
.Ve
.PP
Distributors can use:
.PP
.Vb 1
\& ./configure \-\-with\-supermin\-extra\-options="..."
.Ve
.PP
to add arbitrary extra options to supermin.
.SS "Security"
.IX Subsection "Security"
No security issues were found in this release.
.SS "New APIs"
.IX Subsection "New APIs"
.Vb 10
\& cp\-r
\& extlinux
\& feature\-available
\& get\-program
\& is\-whole\-device
\& part\-get\-gpt\-type
\& part\-set\-gpt\-type
\& rename
\& set\-program
\& syslinux
.Ve
.PP
C のみ:
.PP
.Vb 1
\& guestfs_event_to_string
.Ve
.SS "内部"
.IX Subsection "内部"
The febootstrap tool has now been renamed to \*(L"supermin\*(R".  Libguestfs can use
either, but now prefers \*(L"supermin\*(R".
http://people.redhat.com/~rjones/supermin/
.PP
libxml2 が libguestfs をビルドするために必要です。
.PP
(hivex の) hivexregedit プログラムが git からビルドするために必要です。
.PP
Internal functions can no longer be used unless the caller defines
\&\f(CW\*(C`\-DGUESTFS_PRIVATE=1\*(C'\fR.
.PP
Enable C compiler warnings in Python, Ruby bindings.
.PP
Fail early and clearly if libvirt does not support qemu/KVM (eg. if default
libvirt connection is to Xen).
.PP
\&\f(CW\*(C`make print\-subdirs\*(C'\fR rule, useful for selectively running tests.
.PP
Multiple fixes to allow separated (sourcedir != builddir) builds.
.PP
Multiple fixes to Haskell bindings.
.PP
\&\f(CW\*(C`ln\*(C'\fR and \f(CW\*(C`ln\-f\*(C'\fR APIs now capture \f(CW\*(C`errno\*(C'\fR correctly.
.PP
Language binding tests use (mostly) a standard numbering scheme and aim to
test the same range of features in each language.  Also the number of
launches required has been reduced so these tests should run much more
quickly.
.PP
Library code internally uses \s-1GCC\s0 \f(CW\*(C`_\|_attribute_\|_((cleanup))\*(C'\fR (if available)
to simplify memory allocation.
.PP
Internal header files have been reorganized.  See the comments in
\&\fIsrc/guestfs\-internal*.h\fR
.PP
Internal code shared between the library and certain tools is now located in
a static \f(CW\*(C`libutils\*(C'\fR library.
.PP
Almost all subdirectories can now use parallel builds, although note that
the top-level directories still build in series.
.PP
Use of \f(CW\*(C`PATH_MAX\*(C'\fR and \f(CW\*(C`NAME_MAX\*(C'\fR has been eliminated from the code.
.PP
The Java \s-1API\s0 now requires \s-1JVM\s0 ≥ 1.6.
.PP
Force use of \f(CW\*(C`serial\-tests\*(C'\fR with automake ≥ 1.12.
.PP
Use of sockets in the library protocol layer is abstracted, allowing other
non-POSIX layers to be added in future (see \fIsrc/conn\-socket.c\fR).
.PP
\&\f(CW\*(C`qemu\-img info \-\-output json\*(C'\fR is used if available, for more secure parsing
of the output of this command.
.PP
Distros can now use \f(CW\*(C`make INSTALLDIRS=vendor install\*(C'\fR to place Ruby
bindings in vendordir.  This eliminates a non-upstream patch carried by both
Fedora and Debian.
.PP
Valgrind log files are now written to \fItmp/valgrind\-\fI\s-1DATE\s0\fI\-\fI\s-1PID\s0\fI.log\fR
.PP
\&\f(CW\*(C`make clean\*(C'\fR cleans the local \f(CW\*(C`tmp/\*(C'\fR directory.
.PP
The C \s-1API\s0 tests have been rewritten using a more flexible generator language
that allows arbitrary C code to be executing during tests.
.SS "バグ修正"
.IX Subsection "バグ修正"
.IP "https://bugzilla.redhat.com/961812" 4
.IX Item "https://bugzilla.redhat.com/961812"
Segfault in inspect\-fs.c in mountable code
.IP "https://bugzilla.redhat.com/957772" 4
.IX Item "https://bugzilla.redhat.com/957772"
tar-out and base64\-out quoting error
.IP "https://bugzilla.redhat.com/957380" 4
.IX Item "https://bugzilla.redhat.com/957380"
libguestfs: error: btrfsvol:/dev/sda2/root: root device not found: only call
this function with a root device previously returned by guestfs_inspect_os
.IP "https://bugzilla.redhat.com/948324" 4
.IX Item "https://bugzilla.redhat.com/948324"
inspection fails if libosinfo is not installed
.IP "https://bugzilla.redhat.com/928995" 4
.IX Item "https://bugzilla.redhat.com/928995"
file on zero-sized file now produces \*(L"empty \*(R" instead of \*(L"empty\*(R"
.IP "https://bugzilla.redhat.com/921292" 4
.IX Item "https://bugzilla.redhat.com/921292"
qemu: could not open disk image /tmp/.../snapshot1: Permission denied
.IP "https://bugzilla.redhat.com/921040" 4
.IX Item "https://bugzilla.redhat.com/921040"
\&\*(L"error: external command failed, see earlier error messages\*(R" message needs
to change
.IP "https://bugzilla.redhat.com/920225" 4
.IX Item "https://bugzilla.redhat.com/920225"
libguestfs should use \-\-output json (if supported) to safely parse the
output of qemu-img command
.IP "https://bugzilla.redhat.com/916780" 4
.IX Item "https://bugzilla.redhat.com/916780"
機能リクエスト: guestmount \-\-with\-cleanup\-pipefd
.IP "https://bugzilla.redhat.com/914934" 4
.IX Item "https://bugzilla.redhat.com/914934"
oom-killer kills guestfsd when tar-in a lot of data
.IP "https://bugzilla.redhat.com/914931" 4
.IX Item "https://bugzilla.redhat.com/914931"
FileIn commands cause segfault if appliance dies during the file copy in
.IP "https://bugzilla.redhat.com/913145" 4
.IX Item "https://bugzilla.redhat.com/913145"
Misc leaks in virNetClientProgramCall in libvirt 1.0.2
.IP "https://bugzilla.redhat.com/912499" 4
.IX Item "https://bugzilla.redhat.com/912499"
Security context on image file gets reset
.IP "https://bugzilla.redhat.com/909836" 4
.IX Item "https://bugzilla.redhat.com/909836"
libguestfs-test-tool \-\-qemu segfaults
.IP "https://bugzilla.redhat.com/909624" 4
.IX Item "https://bugzilla.redhat.com/909624"
Unexpected non-tail recursion in recv_from_daemon results in stack overflow
in very long-running \s-1API\s0 calls that send progress messages
.IP "https://bugzilla.redhat.com/908322" 4
.IX Item "https://bugzilla.redhat.com/908322"
virt-tar fails on non-existent directory names \*(L"error in chunked encoding at
/home/rjones/d/libguestfs/tools/virt\-tar line 272.\*(R"
.IP "https://bugzilla.redhat.com/908321" 4
.IX Item "https://bugzilla.redhat.com/908321"
virt-cat fails on directory names \*(L"/dev/stdout: error in chunked encoding\*(R"
.IP "https://bugzilla.redhat.com/907554" 4
.IX Item "https://bugzilla.redhat.com/907554"
btrfs causes subsequent ntfs\-3g filesystem to fail
.IP "https://bugzilla.redhat.com/905341" 4
.IX Item "https://bugzilla.redhat.com/905341"
\&\*(L"No such file or directory\*(R" when execute \*(L"hivex-commit\*(R"
.IP "https://bugzilla.redhat.com/903620" 4
.IX Item "https://bugzilla.redhat.com/903620"
btrfs_subvolume_list broken due to change in subvolume list output
.IP "https://bugzilla.redhat.com/895910" 4
.IX Item "https://bugzilla.redhat.com/895910"
guestmount: \fIrename()\fR incorrectly follows symbolic links
.IP "https://bugzilla.redhat.com/895905" 4
.IX Item "https://bugzilla.redhat.com/895905"
guestmount: \fIlink()\fR incorrectly returns \s-1ENOENT,\s0 when it should be \s-1EXDEV\s0
.IP "https://bugzilla.redhat.com/895904" 4
.IX Item "https://bugzilla.redhat.com/895904"
checksums-out fail to compute the checksums of all regular files in
directory
.IP "https://bugzilla.redhat.com/894545" 4
.IX Item "https://bugzilla.redhat.com/894545"
libguestfs \s-1FTBFS\s0 on Fedora 19 because of new ruby
.IP "https://bugzilla.redhat.com/890027" 4
.IX Item "https://bugzilla.redhat.com/890027"
virt-sysprep: Setting hostname, domain name and pretty name on Fedora 18
correctly
.IP "https://bugzilla.redhat.com/887971" 4
.IX Item "https://bugzilla.redhat.com/887971"
pvcreate fails if partition contains a swap signature
.IP "https://bugzilla.redhat.com/887520" 4
.IX Item "https://bugzilla.redhat.com/887520"
zero_free_space: open: /sysroot//ujqqq135.rd3: Cannot allocate memory
.IP "https://bugzilla.redhat.com/886915" 4
.IX Item "https://bugzilla.redhat.com/886915"
libguestfs with libvirt attach-method fails with odd error if default
hypervisor is Xen
.IP "https://bugzilla.redhat.com/847549" 4
.IX Item "https://bugzilla.redhat.com/847549"
Adding a zero-length virtio-scsi disk causes: qemu-kvm: hw/scsi\-bus.c:1568:
scsi_req_complete: Assertion `req\->status == \-1' failed.
.IP "https://bugzilla.redhat.com/811649" 4
.IX Item "https://bugzilla.redhat.com/811649"
libguestfs cannot open disk images which are symlinks to files that contain
\&':' (colon) character
.IP "https://bugzilla.redhat.com/664558" 4
.IX Item "https://bugzilla.redhat.com/664558"
\&\s-1RFE:\s0 Allow to set log callback in Ruby bindings
.SH "libguestfs 1.20 のリリースノート"
.IX Header "libguestfs 1.20 のリリースノート"
These release notes only cover the differences from the previous stable/dev
branch split (1.18.0).  For detailed changelogs, please see the git
repository, or the ChangeLog file distributed in the tarball.
.SS "New features"
.IX Subsection "New features"
\fIlibvirt and sVirt (SELinux confinement)\fR
.IX Subsection "libvirt and sVirt (SELinux confinement)"
.PP
You can \fIoptionally\fR use libvirt to launch and manage the backend appliance
by:
.IP "\(bu" 4
setting \f(CW\*(C`LIBGUESTFS_ATTACH_METHOD=libvirt[:URI]\*(C'\fR
.IP "\(bu" 4
using \f(CW\*(C`./configure \-\-with\-default\-attach\-method=libvirt[:URI]\*(C'\fR
.IP "\(bu" 4
or calling the \s-1API\s0 method \f(CW\*(C`guestfs_set_attach_method\*(C'\fR
.PP
SVirt (SELinux confinement) is used to secure the libguestfs appliance, if
the libvirt backend is selected.
.PP
\fIvirtio-scsi, larger number of drives, hotplugging\fR
.IX Subsection "virtio-scsi, larger number of drives, hotplugging"
.PP
Virtio-scsi is now used by default, if it is available.  This greatly
increases the number of drives that can be added to a single libguestfs
handle (up to 255).
.PP
You can now hotplug drives (add and remove drives after launch).
.PP
Libguestfs can now handle > 25 disks, in all APIs, tools and tests.
.PP
You can label drives when adding them, then refer to them by label
(\fI/dev/disk/guestfs/LABEL\fR) instead of having to use device names
(\fI/dev/sda\fR).
.PP
\fInew library features\fR
.IX Subsection "new library features"
.PP
\&\s-1POSIX\s0 Access Control Lists (ACLs) and Linux filesystem capabilities can now
be read and written through the \s-1API.\s0
.PP
Windows Dynamic Disks are now supported.  The metadata can only be read
(volumes cannot be modified or created).  However the data/filesystems in
the volumes themselves can be mounted, read and written (Matthew Booth).
.PP
Hivex (Windows Registry editing) is now directly supported through the \s-1API,\s0
making reading or editing the Windows Registry much more efficient.
.PP
Several libguestfs APIs were reimplemented so they no longer have any limits
on output.  The reimplemented APIs are: \f(CW\*(C`guestfs_cat\*(C'\fR, \f(CW\*(C`guestfs_find\*(C'\fR,
\&\f(CW\*(C`guestfs_read_file\*(C'\fR, \f(CW\*(C`guestfs_read_lines\*(C'\fR, \f(CW\*(C`guestfs_write\*(C'\fR,
\&\f(CW\*(C`guestfs_write_append\*(C'\fR, \f(CW\*(C`guestfs_lstatlist\*(C'\fR, \f(CW\*(C`guestfs_lxattrlist\*(C'\fR,
\&\f(CW\*(C`guestfs_readlinklist\*(C'\fR, \f(CW\*(C`guestfs_ls\*(C'\fR.
.PP
\fIvirt tools\fR
.IX Subsection "virt tools"
.PP
\&\f(CW\*(C`guestfish touch \*(Aqwin:c:\enew_file\*(Aq\*(C'\fR now works as expected.
.PP
\&\f(CW\*(C`guestfish\*(C'\fR has a new \fI\-\-network\fR option, which enables the user network
in libguestfs.
.PP
You can set \f(CW\*(C`GUESTFISH_PS1\*(C'\fR to use fancy prompts in \f(CW\*(C`guestfish\*(C'\fR.
.PP
\&\f(CW\*(C`rsync\*(C'\fR, \f(CW\*(C`ssh\*(C'\fR, \f(CW\*(C`less\*(C'\fR and \f(CW\*(C`lrzip\*(C'\fR commands are now available in
virt-rescue.  In addition, \f(CW\*(C`rsync\*(C'\fR can be used through the \s-1API\s0 for doing
incremental copies.
.PP
\&\f(CW\*(C`virt\-sparsify\*(C'\fR uses qcow2 v3 for increased efficiency.
.PP
\&\f(CW\*(C`virt\-sysprep\*(C'\fR enhancements:
.IP "\(bu" 4
generate new UUIDs for PVs and VGs
.IP "\(bu" 4
remove the local machine \s-1ID\s0 (Wanlong Gao)
.IP "\(bu" 4
remove \s-1ABRT\s0 data (Wanlong Gao)
.IP "\(bu" 4
remove puppet keys and log files (Wanlong Gao)
.IP "\(bu" 4
remove process accounting files (Wanlong Gao)
.IP "\(bu" 4
new \fI\-\-firstboot\fR parameter allowing firstboot scripts for customizing
guests
.IP "\(bu" 4
remove \s-1HOSTNAME\s0 field from \f(CW\*(C`ifcfg\-eth*\*(C'\fR files (Wanlong Gao)
.IP "\(bu" 4
miscellaneous improvements for SuSE (Olaf Hering)
.IP "\(bu" 4
remove man pages cache (Wanlong Gao)
.IP "\(bu" 4
remove crash data generated by kexec-tools (Wanlong Gao)
.PP
\&\f(CW\*(C`virt\-make\-fs\*(C'\fR can now create virtual floppy disks (VFDs).
.PP
\&\f(CW\*(C`guestmount\*(C'\fR has a \fI\-\-pid\-file\fR option, which can be used to avoid a race
condition between unmounting the filesystem and using the underlying disk
image.
.PP
\fIlanguage bindings\fR
.IX Subsection "language bindings"
.PP
Full-featured Lua bindings have been added in this release (thanks to Jerome
Vuarand for many suggestions).
.PP
In Ruby, optional arguments hash is optional.
.PP
In Python, optional arguments now don't use special \*(L"sentinel\*(R" values, so
any integer can be passed as an optional argument.
.PP
Erlang bindings now come with examples and tests.
.PP
Erlang bindings now handle 64 bit integer parameters correctly.
.PP
The automated 'bindtests' now test for 64 bit cleanliness in parameter
passing.  Several bugs in the bindings were found and fixed as a result.
.PP
Better handling of blocking and non-blocking functions should make
libguestfs calls more efficient.
.PP
\fIinspection\fR
.IX Subsection "inspection"
.PP
Windows guests with unlimited-sized Registries are now supported.  By adding
the hivex \s-1API\s0 to the libguestfs \s-1API,\s0 it is much more efficient and easier to
inspect and modify the Windows Registry in guests.
.PP
Better support for SuSE guests (Olaf Hering).
.PP
Return the architecture of installed applications (John Eckersberg).
.PP
Windows 8 is now supported.
.PP
Fedora 18 is now supported.
.PP
Inspection of ISOs/CDs/DVDs can now use the libosinfo database.
.PP
\fIports\fR
.IX Subsection "ports"
.PP
Libguestfs without the appliance can be compiled on Mac \s-1OS X\s0 (Masami
\&\s-1HIRATA\s0).
.PP
\&\s-1RHEL 5\s0 is now explicitly supported through the 'oldlinux' branch in upstream
git.
.PP
PowerPC 64 bit is now supported.  Also libguestfs has been examined for
endianness bugs and these have been fixed.
.PP
\fIdaemon\fR
.IX Subsection "daemon"
.PP
A man page for the daemon (\fIguestfsd\fR\|(8)) is included.
.SS "Security"
.IX Subsection "Security"
\fIguestfish history file\fR
.IX Subsection "guestfish history file"
.PP
The \fI\f(CI$HOME\fI/.guestfish\fR history file is now created with 0600 permissions
(instead of 0644 before) so it is no longer world readable.
.PP
\fI\s-1CVE\-2012\-2690\s0\fR
.IX Subsection "CVE-2012-2690"
.PP
Old versions of both \f(CW\*(C`virt\-edit\*(C'\fR and the \f(CW\*(C`guestfish\*(C'\fR \f(CW\*(C`edit\*(C'\fR command
created a new file containing the changes but did not set the permissions,
etc of the new file to match the old one.  The result of this was that if
you edited a security sensitive file such as \fI/etc/shadow\fR then it would be
left world-readable after the edit.
.PP
この問題は \s-1CVE\-2012\-2690\s0 に割り当てられおり、libguestfs ≥ 1.16 において修正されています。
.PP
詳細は https://bugzilla.redhat.com/show_bug.cgi?id=788642 を参照してください。
.SS "New APIs"
.IX Subsection "New APIs"
.Vb 10
\& acl\-delete\-def\-file
\& acl\-get\-file
\& acl\-set\-file
\& canonical\-device\-name
\& cap\-get\-file
\& cap\-set\-file
\& create\-flags
\& device\-index
\& disk\-has\-backing\-file
\& disk\-format
\& disk\-virtual\-size
\& filesystem\-available
\& fill\-dir
\& fstrim
\& get\-cachedir
\& get\-libvirt\-requested\-credentials
\& get\-libvirt\-requested\-credential\-prompt
\& get\-libvirt\-requested\-credential\-challenge
\& get\-libvirt\-requested\-credential\-defresult
\& get\-tmpdir
\& hivex\-close
\& hivex\-commit
\& hivex\-node\-add\-child
\& hivex\-node\-children
\& hivex\-node\-delete\-child
\& hivex\-node\-get\-child
\& hivex\-node\-get\-value
\& hivex\-node\-name
\& hivex\-node\-parent
\& hivex\-node\-set\-value
\& hivex\-node\-values
\& hivex\-open
\& hivex\-root
\& hivex\-value\-key
\& hivex\-value\-type
\& hivex\-value\-utf8
\& hivex\-value\-value
\& inspect\-list\-applications2 (John Eckersberg)
\& list\-ldm\-volumes
\& list\-ldm\-partitions
\& ldmtool\-create\-all
\& ldmtool\-diskgroup\-disks
\& ldmtool\-diskgroup\-name
\& ldmtool\-diskgroup\-volumes
\& ldmtool\-remove\-all
\& ldmtool\-scan
\& ldmtool\-scan\-devices
\& ldmtool\-volume\-hint
\& ldmtool\-volume\-partitions
\& ldmtool\-volume\-type
\& ls0
\& max\-disks
\& mke2fs (Wanlong Gao)
\& mklost\-and\-found
\& mkswap [added label and uuid optional arguments]
\& mktemp (Wanlong Gao)
\& nr\-devices
\& parse\-environment
\& parse\-environment\-list
\& rm\-f
\& rsync
\& rsync\-in
\& rsync\-out
\& set\-cachedir
\& set\-libvirt\-supported\-credentials
\& set\-libvirt\-requested\-credential
\& set\-tmpdir
\& shutdown [backported to 1.16 and 1.18]
\& tar\-in [added compress flag]
\& tar\-out [added compress, numericowner, excludes flags]
\& umount [added force and lazy optional arguments]
\& utsname
\& xfs\-admin (Wanlong Gao)
\& xfs\-growfs (Wanlong Gao)
\& xfs\-info (Wanlong Gao)
\& xfs\-repair (Wanlong Gao)
.Ve
.PP
In the C \s-1API\s0 only:
.PP
.Vb 2
\& guestfs_push_error_handler
\& guestfs_pop_error_handler
.Ve
.SS "内部"
.IX Subsection "内部"
qemu ≥ 1.1 is required (≥ 1.2 preferred).
.PP
febootstrap ≥ 3.20 is required.
.PP
libvirt is optional, but if you want to use the new libvirt backend for
launching the appliance then libvirt ≥ 0.10.2 would be required.
.PP
Coverity has been run over the complete codebase, and many issues fixed
(thanks Ondrej Vasik, Kamil Dudka).
.PP
Functions which previously had no optargs can now be converted to ones with
optargs, making extending the \s-1API\s0 much more flexible.  Source and binary
backwards compatibility is preserved for users of the \s-1API.\s0
.PP
The way that libguestfs APIs and structures are represented in the generator
has changed to use an OCaml struct instead of a tuple.  This makes generator
descriptions more flexible and easier to understand.  For details see
commits 39d1a7db and eb185eef.
.PP
Separation of the library code into more files:
.IP "\(bu" 4
Launch backends are now located in separate files
eg. \fIsrc/launch\-appliance.c\fR, \f(CW\*(C`src/launch\-libvirt.c\*(C'\fR.
.IP "\(bu" 4
Generated action code is now split over several \fIsrc/action*.c\fR files, for
faster compilation.
.IP "\(bu" 4
The huge \fIsrc/guestfs.c\fR file is now split into smaller logical units.
.PP
\&\s-1POD\s0 (documentation) is now generated using a rewritten Perl program instead
of pod2* + shell scripts.
.PP
Man pages now contain stable dates (Hilko Bengen).
.PP
Skipped tests now exit with code 77, so they appear as \f(CW\*(C`SKIP:\*(C'\fR in \f(CW\*(C`make
check\*(C'\fR output.
.PP
The parallel mount-local test has been rewritten in C (RHBZ#838081).
.PP
Ruby 1.8.5 is now supported (though Ruby ≥ 1.9 is preferred).
.PP
Perl bindings can be disabled via \f(CW\*(C`./configure \-\-disable\-perl\*(C'\fR (Wulf
C. Krueger).  Note that Perl is still required in order to build libguestfs.
.PP
Java bindings are now enabled/disabled using \f(CW\*(C`./configure \-\-with\-java\*(C'\fR or
\&\f(CW\*(C`./configure \-\-without\-java\*(C'\fR (Wulf C. Krueger).
.PP
New configure options \f(CW\*(C`./configure \-\-enable\-code\-profiling\*(C'\fR and
\&\f(CW\*(C`./configure \-\-enable\-code\-coverage\*(C'\fR.
.PP
Multiple fixes to use of 64 bit integers in language bindings.
.PP
The appliance backend now uses sgabios instead of vgabios (Dan Berrange).
.PP
The \f(CW\*(C`./run\*(C'\fR script now sets enough environment variables that you can run
OCaml, Python, Ruby, Java, \s-1GJS,\s0 Erlang, Lua programs.
.PP
\&\f(CW\*(C`./run \-\-test\*(C'\fR flag for running tests with minimal output.  It also prints
the time taken to run each test.
.PP
The \f(CW\*(C`./run\*(C'\fR script now builds up paths cumulatively, meaning that you can
use \f(CW\*(C`./run\*(C'\fR twice, or use the libguestfs and libvirt \f(CW\*(C`./run\*(C'\fR scripts
together.
.PP
You can extract a list of external commands required by the daemon, making
building the appliance on certain distros easier (Olaf Hering).
.PP
The \f(CW\*(C`virt\-rescue\*(C'\fR command is now tested during \f(CW\*(C`make check\*(C'\fR.
.PP
The generator now removes unused generated files.  This helps when going
back and forth with git rebase, git bisect, etc.
.PP
Tests now run in a separate toplevel \f(CW\*(C`tmp/\*(C'\fR directory in the source.  This
allows the directory to be labelled for SELinux (sVirt), and also makes it
easier to clean up.
.PP
\&\f(CW\*(C`make syntax\-check\*(C'\fR now works to a greater extent, and many problems in the
main code that were found by syntax-check have been fixed (thanks Jim
Meyering).
.PP
Emacs mode (\-*\- foo \-*\-) has been added to generated files.
.PP
Progress bar output is now sent to \fI/dev/tty\fR so it doesn't end up in the
regular output of the program.  virt-resize and virt-sparsify now suppress
progress bars if stdout is not a tty.
.PP
There is now a \f(CW\*(C`./configure \-\-without\-libvirt\*(C'\fR option.  This is useful for
testing that the code still compiles without libvirt.
.PP
There is now an internal mini-library for running commands.  This allows us
to redirect errors from external commands into events.
.PP
Code for handling temporary directories and the appliance cache was
completely overhauled.
.PP
Code for temporarily ignoring/disabling errors now looks like this:
.PP
.Vb 3
\& guestfs_push_error_handler (g, NULL, NULL);
\& guestfs_mkdir (g, "/foo"); /* We don\*(Aqt care if this fails. */
\& guestfs_pop_error_handler (g);
.Ve
.PP
The \f(CW\*(C`tests/extra\*(C'\fR directory has gone.  The \*(L"extra tests\*(R" are now split into
separately runnable targets, such as \f(CW\*(C`make check\-valgrind\*(C'\fR.  Use \f(CW\*(C`make
help\*(C'\fR to get a summary of the targets.
.PP
The \f(CW\*(C`lpj\*(C'\fR option is passed to the appliance kernel when using \s-1TCG.\s0  This
should improve clock stability (thanks Marcelo Tosatti, Olaf Hering).
.SS "バグ修正"
.IX Subsection "バグ修正"
.IP "https://bugzilla.redhat.com/882417" 4
.IX Item "https://bugzilla.redhat.com/882417"
libguestfs tools fail with odd error messages if \s-1TMPDIR\s0 is not an absolute
path
.IP "https://bugzilla.redhat.com/882299" 4
.IX Item "https://bugzilla.redhat.com/882299"
Windows 8 guest disks can't be mounted: \*(L"The \s-1NTFS\s0 partition is in an unsafe
state. Please resume and shutdown Windows fully (no hibernation or fast
restarting), or mount the volume read-only with the 'ro' mount option.\*(R"
.IP "https://bugzilla.redhat.com/881953" 4
.IX Item "https://bugzilla.redhat.com/881953"
libguestfs: migration to /etc/hostname, /etc/vconsole.conf, /etc/locale.conf
.IP "https://bugzilla.redhat.com/880801" 4
.IX Item "https://bugzilla.redhat.com/880801"
virt-df with two \-a options displays incorrect disk image name
.IP "https://bugzilla.redhat.com/879416" 4
.IX Item "https://bugzilla.redhat.com/879416"
libguestfs-test-tool pauses when you use \-\-help option
.IP "https://bugzilla.redhat.com/876579" 4
.IX Item "https://bugzilla.redhat.com/876579"
mke2fs \s-1API\s0 does not apply block device naming translation to journaldevice
optarg
.IP "https://bugzilla.redhat.com/860235" 4
.IX Item "https://bugzilla.redhat.com/860235"
SELinux policy ought to allow qemu to write to
unconfined_u:object_r:user_tmp_t:s0
.IP "https://bugzilla.redhat.com/859949" 4
.IX Item "https://bugzilla.redhat.com/859949"
\&\s-1RFE:\s0 inspect-list-applications does not return the architecture of \s-1RPM\s0
packages
.IP "https://bugzilla.redhat.com/859885" 4
.IX Item "https://bugzilla.redhat.com/859885"
inspect-list-applications does not list all installed \s-1RPM\s0 packages with same
name and different versions
.IP "https://bugzilla.redhat.com/859876" 4
.IX Item "https://bugzilla.redhat.com/859876"
guestfish printed paths are not canonicalized
.IP "https://bugzilla.redhat.com/859875" 4
.IX Item "https://bugzilla.redhat.com/859875"
Progress bar output should go to tty(?) stderr(?)
.IP "https://bugzilla.redhat.com/858696" 4
.IX Item "https://bugzilla.redhat.com/858696"
virt-sysprep reports Guestfs.Error(\*(L"read_lines: fopen:
/etc/sysconfig/network: No such file or directory\*(R") on some Fedora guests
.IP "https://bugzilla.redhat.com/858128" 4
.IX Item "https://bugzilla.redhat.com/858128"
libguestfs fail to list devices added by add-drive-ro-with-if twice
.IP "https://bugzilla.redhat.com/858126" 4
.IX Item "https://bugzilla.redhat.com/858126"
virt-inspector fail to work with some windows guests
.IP "https://bugzilla.redhat.com/853762" 4
.IX Item "https://bugzilla.redhat.com/853762"
virt-sparsify should use a more robust method to detect the input format
.IP "https://bugzilla.redhat.com/853393" 4
.IX Item "https://bugzilla.redhat.com/853393"
libvirt doesn't label console, serial sockets
.IP "https://bugzilla.redhat.com/853159" 4
.IX Item "https://bugzilla.redhat.com/853159"
virt-rescue in Fedora 18 is completely broken
.IP "https://bugzilla.redhat.com/852394" 4
.IX Item "https://bugzilla.redhat.com/852394"
libguestfs inspection limits registries to 100 MiB
.IP "https://bugzilla.redhat.com/852194" 4
.IX Item "https://bugzilla.redhat.com/852194"
virt-sparsify \-\-compress fails if output is raw format
.IP "https://bugzilla.redhat.com/847881" 4
.IX Item "https://bugzilla.redhat.com/847881"
\&\s-1RFE:\s0 allow extra arguments (like \-\-exclude) to tar-out
.IP "https://bugzilla.redhat.com/847880" 4
.IX Item "https://bugzilla.redhat.com/847880"
tar-out should allow (or force) \-\-numeric\-owner
.IP "https://bugzilla.redhat.com/845522" 4
.IX Item "https://bugzilla.redhat.com/845522"
guestfish \*(L"copy-out / localdir\*(R" command fails with \*(L"No such file or
directory\*(R"
.IP "https://bugzilla.redhat.com/845488" 4
.IX Item "https://bugzilla.redhat.com/845488"
Long filenames on \s-1NTFS\s0 cause tar-out, copy-out etc to fail with error
\&\*(L"Cannot open: File name too long\*(R"
.IP "https://bugzilla.redhat.com/842307" 4
.IX Item "https://bugzilla.redhat.com/842307"
\&\s-1RFE:\s0 Need help designing and implementing selinux policy for
libguestfs/sVirt
.IP "https://bugzilla.redhat.com/840572" 4
.IX Item "https://bugzilla.redhat.com/840572"
virt-make-fs / tar-in should support vfat properly
.IP "https://bugzilla.redhat.com/840115" 4
.IX Item "https://bugzilla.redhat.com/840115"
guestfish touch problem \- case_sensitive_path \s-1API\s0 expects the file to exist
.IP "https://bugzilla.redhat.com/836710" 4
.IX Item "https://bugzilla.redhat.com/836710"
Data loss when writing to qcow2\-format disk files
.IP "https://bugzilla.redhat.com/834712" 4
.IX Item "https://bugzilla.redhat.com/834712"
lvresize, lvresize-free fail unnecessarily if you don't change the size of
the \s-1LV:\s0 \*(L"New size (nn extents) matches existing size (nn extents)\*(R"
.IP "https://bugzilla.redhat.com/824716" 4
.IX Item "https://bugzilla.redhat.com/824716"
compress-device-out didn't support bzip2
.IP "https://bugzilla.redhat.com/824043" 4
.IX Item "https://bugzilla.redhat.com/824043"
guestfish unrecognized mount option gives confusing error message
.IP "https://bugzilla.redhat.com/823887" 4
.IX Item "https://bugzilla.redhat.com/823887"
Filenames containing Chinese characters can't be created on vfat filesystems
.IP "https://bugzilla.redhat.com/823885" 4
.IX Item "https://bugzilla.redhat.com/823885"
virt-make-fs cannot create vfat filesystem containing filesystems with
Chinese characters
.IP "https://bugzilla.redhat.com/823883" 4
.IX Item "https://bugzilla.redhat.com/823883"
virt-make-fs \-t fat fails with an obscure error message
.IP "https://bugzilla.redhat.com/823821" 4
.IX Item "https://bugzilla.redhat.com/823821"
Inspection fails when /etc/HOSTNAME is empty
.IP "https://bugzilla.redhat.com/801117" 4
.IX Item "https://bugzilla.redhat.com/801117"
libguestfs cannot get icon for Windows 8
.IP "https://bugzilla.redhat.com/798979" 4
.IX Item "https://bugzilla.redhat.com/798979"
Ubuntu install CDs from oneiric onwards are not recognized: \*(L"multi-boot
operating systems are not supported\*(R"
.IP "https://bugzilla.redhat.com/782167" 4
.IX Item "https://bugzilla.redhat.com/782167"
libguestfs doesn't recognize Windows Dynamic disks in some configurations,
eg. spanned
.IP "https://bugzilla.redhat.com/713678" 4
.IX Item "https://bugzilla.redhat.com/713678"
Not all febootstrap messages are redirected to log callbacks
.IP "https://bugzilla.redhat.com/627675" 4
.IX Item "https://bugzilla.redhat.com/627675"
libguestfs inspector code cannot handle /dev/disk/by\-id/* paths
.IP "https://bugzilla.redhat.com/602997" 4
.IX Item "https://bugzilla.redhat.com/602997"
part-get-bootable gives wrong result with an unordered part layout
.SH "RELEASE NOTES FOR LIBGUESTFS 1.18"
.IX Header "RELEASE NOTES FOR LIBGUESTFS 1.18"
These release notes only cover the differences from the previous stable/dev
branch split (1.16.0).  For detailed changelogs, please see the git
repository, or the ChangeLog file distributed in the tarball.
.SS "New features"
.IX Subsection "New features"
\fIvirt tools\fR
.IX Subsection "virt tools"
.PP
.Vb 2
\&   \- virt\-sysprep has been rewritten and expanded (thanks Wanlong Gao)
\&     http://libguestfs.org/virt\-sysprep.1.html
\&
\&   \- virt\-sparsify \-\-zero is a new option that zeroes the named
\&     partition or filesystem
\&
\&   \- virt\-sparsify can now safely sparsify Linux swap partitions
\&
\&   \- virt\-sparsify fixed so it cleans up after ^C
\&     http://libguestfs.org/virt\-sparsify.1.html
\&
\&   \- a new tool \*(Aqlibguestfs\-make\-fixed\-appliance\*(Aq is provided to build
\&     fixed appliances that can be copied to other machines that don\*(Aqt
\&     have febootstrap support
\&     http://libguestfs.org/libguestfs\-make\-fixed\-appliance.1.html
\&
\&   \- virt\-filesystems now displays the parents (containers) of MD
\&     devices and volume groups
\&
\&   \- virt\-alignment\-scan, run with no args, displays alignment information
\&     for all libvirt domains
\&
\&   \- virt\-df and virt\-alignment\-scan will display information from all
\&     guests even when a disk is inaccessible
\&
\&   \- virt\-rescue new \-\-scratch option to make scratch disks
\&     https://rwmj.wordpress.com/2012/04/26/virt\-rescue\-scratch/#content
\&
\&   \- virt\-make\-fs can now be used to create btrfs
\&
\&   \- virt\-edit preserves permissions, UID, GID and SELinux context
\&     when editing files
\&
\&   \- guestfish passes the close event over stdout and remote correctly
\&
\&   \- guestfish new \*(Aq\-\-pipe\-error\*(Aq option lets you detect errors in pipe
\&     commands
\&
\&   \- guestfish globs now expand device names
\&
\&   \- comma and colon characters in filenames now handled correctly by
\&     all virt tools
.Ve
.PP
\fIinspection\fR
.IX Subsection "inspection"
.PP
.Vb 1
\&   \- Fedora 17+ のサポートの追加
\&
\&   \- FreeDOS のサポートの追加
\&
\&   \- Buildroot および Cirros のサポートの追加
\&
\&   \- inspection is now compatible with Windows guests that have been
\&     sysprepped (thanks Grant Williamson).
.Ve
.PP
\fI\s-1API\s0\fR
.IX Subsection "API"
.PP
.Vb 2
\&   \- broad support for btrfs added, including adding multiple devices,
\&     fsck, snapshots (thanks Wanlong Gao)
\&
\&   \- the new \*(Aqmount\-local\*(Aq API brings FUSE support directly into the
\&     core libguestfs API
\&     https://rwmj.wordpress.com/2012/05/14/tip\-using\-mount\-local\-api\-from\-c/#content
\&
\&   \- new man page: guestfs\-performance(1), which contains performance
\&     tuning tips
\&     http://libguestfs.org/guestfs\-performance.1.html
\&
\&   \- new man page: guestfs\-faq(1), Frequently Asked Questions
\&     http://libguestfs.org/guestfs\-faq.1.html
\&
\&   \- ENOTSUP (from guestfs_last_errno) is now returned for APIs that
\&     are not supported
.Ve
.PP
\fI例\fR
.IX Subsection "例"
.PP
.Vb 1
\&   \- \*(Aqcopy_over\*(Aq example showing how to copy between two handles
\&
\&   \- \*(Aqdisplay_icon\*(Aq program displays the icon associated with a guest
\&
\&   \- \*(Aqmount_local.c\*(Aq example shows how to use the mount\-local API
.Ve
.SS "Security"
.IX Subsection "Security"
.Vb 1
\&  (no security problems were found or fixed in this release)
.Ve
.SS "New APIs"
.IX Subsection "New APIs"
.Vb 10
\&  btrfs\-device\-add: Add devices to a btrfs filesystem.
\&  btrfs\-device\-delete: Remove devices from a btrfs filesystem.
\&  btrfs\-filesystem\-sync: Sync a btrfs filesystem.
\&  btrfs\-filesystem\-balance: Balance a btrfs filesystem.
\&  btrfs\-fsck: Check btrfs filesystem.
\&  btrfs\-set\-seeding: Enable or disable seeding.
\&  btrfs\-subvolume\-create: Create a btrfs snapshot.
\&  btrfs\-subvolume\-delete: Delete a btrfs snapshot.
\&  btrfs\-subvolume\-list: List btrfs snapshots and subvolumes.
\&  btrfs\-subvolume\-set\-default: Set default btrfs subvolume.
\&  btrfs\-subvolume\-snapshot: Create a writable btrfs snapshot.
\&  get\-e2attrs: List ext2 file attributes of a file.
\&  get\-e2generation: Get ext2 file generation of a file.
\&  isoinfo, isoinfo\-device: Get information from the header of ISO files.
\&  llz: List files with SELinux information.
\&  lvcreate\-free: Create an LVM logical volume in % remaining free space.
\&  md\-stat: Return underlying devices from an MD device.
\&  mkfs\-brtfs: Make btrfs filesystem, with all tunables.
\&  mount\-local, mount\-local\-run, umount\-local: FUSE support in the API.
\&  ntfsclone\-in, ntfsclone\-out: Save, restore NTFS from backup.
\&  ntfsfix: Fix common errors and force Windows to check NTFS.
\&  set\-e2attrs: Set or clear ext2 file attributes of a file.
\&  set\-e2generation: Set ext2 file generation of a file.
\&  set\-label: Unified interface for setting filesystem label.
\&  vgmeta: Get volume group metadata.
\&  wipefs: Wipe filesystem signatures from a device.
\&  zero\-free\-space: Zero free space in a filesystem.
.Ve
.SS "内部"
.IX Subsection "内部"
.Vb 4
\& \- The debian/ subdirectory has been removed.  We recommend you use
\&   the official Debian packages made by Hilko Bengen.
\&   http://people.debian.org/~bengen/libguestfs/
\&   http://packages.debian.org/search?keywords=libguestfs
\&
\& \- O_CLOEXEC / SOCK_CLOEXEC is now used for almost all file
\&   descriptors that the library opens.
\&
\& \- posix_fadvise is called when sequentially reading or writing large
\&   files.
\&
\& \- close all file descriptors and remove all signal handlers in the
\&   recovery process
\&
\& \- multiple gcc warnings and Coverity bugs have been fixed;  many
\&   strict\-overflow bugs have also been fixed
\&
\& \- use ./configure \-\-enable\-valgrind\-daemon to use valgrind on the
\&   daemon;  many errors have been fixed
\&
\& \- use ./configure \-\-with\-qemu\-options to pass extra options to qemu
\&
\& \- the daemon now has a growable strings buffer type (DECLARE_STRINGSBUF)
\&
\& \- the <guestfs.h> header file works with C++ and we have a regression
\&   test for this
\&
\& \- multiple APIs which should only be called in the CONFIG state now
\&   give an error if they are not
\&
\& \- .gitignore fixed to use absolute paths
\&
\& \- gobject bindings have been expanded, including mapping libguestfs
\&   events to gobject signals (thanks Matt Booth)
\&
\& \- gobject documentation is generated properly (thanks Matt Booth)
\&
\& \- gobject header files now live in a subdirectory
\&
\& \- CompareWithString test in the generator now works
\&
\& \- FUInt32, FUInt64 struct field types now use the correct XDR type
\&
\& \- OCaml tests are now run on bytecode and native code.
\&
\& \- java \-Xlint:all is used, and all warnings have been fixed
\&
\& \- bmptopng, wrestool (etc) missing or failure no longer prints
\&   warning messages
\&
\& \- ruby: Use RbConfig instead of Config.
\&
\& \- PYTHONPATH is set by the ./run script.
\&
\& \- appliance building is now thread\-safe.
\&
\& \- appliance now uses \*(Aqip\*(Aq instead of \*(Aqifconfig\*(Aq and \*(Aqnetstat\*(Aq
\&   commands
\&
\& \- several fixes to make parallel builds work properly
\&
\& \- guestfish \-\-listen now cleans up properly
\&
\& \- the BUSY state has been removed
\&
\& \- gettextize has been removed, replaced by a simple Makefile.am
\&
\& \- gettext support now covers virt\-resize, virt\-sparsify and virt\-sysprep
\&
\& \- better support for the arm architecture
.Ve
.SS "バグ修正"
.IX Subsection "バグ修正"
.Vb 10
\& \- 822490 virt\-ls error: "libguestfs: error: checksum: path: parameter cannot be NULL"
\& \- 816839 data overflow error when debug progress \-1
\& \- 816098 virt\-make\-fs fails to make a btrfs filesystem because it doesn\*(Aqt allocate enough space
\& \- 811872 inspection fails on ubuntu 10.04 guest with encrypted swap
\& \- 811650 guestfs_last_error not set when qemu fails early during launch
\& \- 811649 libguestfs cannot open disk images which are symlinks to files that contain \*(Aq:\*(Aq (colon) character
\& \- 811117 [RFE][virt\-sysprep] net\-hwaddr not removed from "ifcfg\-*" files on rhel
\& \- 811112 [RFE][virt\-sysprep] hostname can not be changed on rhel system
\& \- 809361 inspection doesn\*(Aqt recognize Fedora 18 (grub2 + GPT)
\& \- 807905 mkfs blocksize option breaks when creating btrfs
\& \- 805070 virt\-filesystems should show \*(Aqparents\*(Aq of LV and RAID devices
\& \- 804464 libguestfs cannot be built when LINGUAS is different then ja or uk
\& \- 803664 libguestfs inspection fails on Windows XP: libguestfs: error: hivex: could not locate HKLM\eSYSTEM\eMountedDevices
\& \- 803533 guestfish: write error
\& \- 802389 event handlers for \*(Aqclose\*(Aq event doesn\*(Aqt work in remote mode
\& \- 802109 libguestfs uses putc on stderr, results in many individual 1 byte writes of debug messages
\& \- 801640 [RFE] the error reported by resize2fs\-M need to be more clear
\& \- 801298 Possible null dereference and resource leaks
\& \- 801273 Document for set\-pgroup need to be updated
\& \- 798196 virt\-resize confuses format and output_format variables; using \-\-output\-format sets the input format
\& \- 797986 virt\-resize on Windows XP in sysprep state causes "UNMOUNTABLE_BOOT_VOLUME" BSOD
\& \- 796520 [RFE] Prevent user from running some appliance configure commands after appliance boot up
\& \- 790721 multiprovider build error: RuntimeError: link: /tmp/.guestfs\-0/kernel /tmp/.guestfs\-0/kernel.10139: File exists
\& \- 789960 guestfsd crash when try to mount non\-exist disk
\& \- 789504 virt\-df (other tools?) should not give up if a guest disk is missing
\& \- 788641 virt\-edit doesn\*(Aqt preserve file permissions
\& \- 786215 libguestfs inspection does not recognize FreeDOS operating system
\& \- 786188 libguestfs inspection does not recognize FreeDOS install CD
\& \- 785668 aug\-defnode: daemon crash
\& \- 784647 Libguestfs uses deprecated net\-tools
\& \- 769304 virt\-resize on RHEL 6 kernel fails to re\-read the partition table
\& \- 755729 Error message for resize2fs\-M needs tweaking
\& \- 701814 virt\-win\-reg fails on a libvirt guest that has no defined disk format: "format parameter is empty or contains disallowed characters"
\& \- 679737 libguestfs: improve error message when zerofree is not available in the appliance
\& \- 635971 glob mkfs ext2 /dev/vd[b\-t]1 does not expand
.Ve
.SH "RELEASE NOTES FOR LIBGUESTFS 1.16"
.IX Header "RELEASE NOTES FOR LIBGUESTFS 1.16"
These release notes only cover the differences from the previous stable/dev
branch split (1.14.0).  For detailed changelogs, please see the git
repository, or the ChangeLog file distributed in the tarball.
.SS "New features"
.IX Subsection "New features"
\fIlibguestfs\fR
.IX Subsection "libguestfs"
.PP
.Vb 2
\&   \- allow XFS filesystems to be created over an existing filesystem
\&     (Wanlong Gao)
\&
\&   \- the (unspecified) default alignment for part\-disk has been
\&     changed to 64K for better support of high\-end network\-attached
\&     storage
\&
\&   \- new guestfs\-testing(1) man page
\&
\&   \- list\-filesystems returns MD devices containing filesystems
\&     (Matthew Booth)
\&
\&   \- support for GCC >= 4.7 (Jim Meyering)
\&
\&   \- check user does not add the same drive twice (Wanlong Gao).
.Ve
.PP
\fIlanguage bindings\fR
.IX Subsection "language bindings"
.PP
.Vb 4
\&   \- Experimental GObject bindings, with support for GObject
\&     Introspection.  You can now use libguestfs from Javascript.
\&     Please note these are not stable and final in this release.
\&     (Matthew Booth).
\&
\&   \- support for Ruby >= 1.9
\&
\&   \- Ruby bindings can be disabled individually (Hilko Bengen)
\&
\&   \- support for Python 2.6, 3.x (Richard Jones, Hilko Bengen)
\&
\&   \- support for PHP >= 5.4
\&
\&   \- new %guestfs_introspection hash is available in Perl bindings so
\&     you can query which optional arguments are available
.Ve
.PP
\fIinspection\fR
.IX Subsection "inspection"
.PP
.Vb 1
\&   \- guests with MD devices can be inspected (Matthew Booth)
\&
\&   \- support for GNU/Hurd guests
.Ve
.PP
\fIguestfish\fR
.IX Subsection "guestfish"
.PP
.Vb 2
\&   \- libguestfs events (such as progress bar events and log messages) can
\&     be trapped and processed by user\-defined shell scripts.
\&
\&   \- MD devices are tab\-completed (Matthew Booth)
.Ve
.PP
\fIvirt tools\fR
.IX Subsection "virt tools"
.PP
.Vb 1
\&   \- New tool virt\-format for erasing and making blank disks
\&
\&   \- virt\-sparsify new \-\-compress and \-o options to allow for compressed
\&     and different format output
\&
\&   \- virt\-sparsify can now detect and sparsify .vdi files
\&
\&   \- virt\-sysprep no longer requires xmlstarlet; a new virt\-inspector \-\-xpath
\&     option has been added to replace this functionality
\&
\&   \- virt\-rescue has a new \-\-suggest option which suggests mount commands
\&     for the guest
\&
\&   \- virt\-resize no longer requires OCaml pcre library
.Ve
.PP
\fIlibguestfs live\fR
.IX Subsection "libguestfs live"
.PP
.Vb 1
\&   \- daemon will no longer try to edit your live /etc/lvm configuration
\&
\&   \- fix a potential security problem with predictable /tmp names (Steve Kemp)
.Ve
.SS "Security"
.IX Subsection "Security"
.Vb 3
\&  CVE\-2011\-4127, RHBZ#757071
\&  Mitigate possible privilege escalation via SG_IO ioctl
\&  For more information, see: https://github.com/libguestfs/libguestfs/commit/9a5f784d511a8f00a8386f316eab41fe660430db
.Ve
.SS "New APIs"
.IX Subsection "New APIs"
.Vb 7
\&  blkid: print all attributes of a device known to blkid (Wanlong Gao)
\&  e2fsck: access to more features of e2fsck (Wanlong Gao)
\&  list\-md\-devices: list of Linux MD devices (Matthew Booth)
\&  md\-create: create an MD device
\&  md\-detail: returns metadata for an MD device (Matthew Booth)
\&  md\-stop: stop an MD device (Wanlong Gao)
\&  tune2fs: allow ext2/3/4 filesystems to be tuned
.Ve
.SS "内部"
.IX Subsection "内部"
.Vb 1
\&  Git hosting has moved to http://github.com/libguestfs
\&
\&  The various test directories have been rearranged logically, and now
\&  all appear under \*(Aqtests/\*(Aq.
\&
\&  There is a \*(Aqmake extra\-tests\*(Aq rule which runs ordinary tests and
\&  additional tests, using valgrind to check for memory problems.
\&
\&  Multiple memory leaks and other problems found by valgrind and fixed.
\&
\&  Support for optional arguments in the generator has been rewritten
\&  to provide more features and safety (Matthew Booth).
\&
\&  With gcc \-fvisibility=hidden is used for internal symbols, avoiding
\&  call indirection via the PLT.
\&
\&  RHashtable functions can be tested in the generator.
\&
\&  ADD_ARG macro in daemon allows arg lists to be constructed without
\&  risk of stack smashing.
\&
\&  Fix generation of OCaml functions that have more than 10 arguments.
\&
\&  psmisc has been added to the appliance, allowing use of \*(Aqfuser\*(Aq,
\&  \*(Aqkillall\*(Aq and \*(Aqpstree\*(Aq for debugging.
\&
\&  bindtests now cover RBufferOut and optional arguments (Matthew Booth).
.Ve
.SS "バグ修正"
.IX Subsection "バグ修正"
.Vb 9
\& \- 769680 temporary directories created during appliance builds are not cleaned up on error
\& \- 761460 guestfs_utimens hangs on named pipes
\& \- 761451 guestfs_utimens cannot set times on a directory
\& \- 760775 "guestfish: multi\-boot operating systems are not supported by the \-i option" should be more explanatory
\& \- 760669 guestfish copy\-in and <! (inline execution) don\*(Aqt mix well: pclose: No child processes
\& \- 760000 libguestfs fails to compile with Ruby >= 1.9
\& \- 755729 Error message for resize2fs\-M needs tweaking
\& \- 750889 Python code incompatible with Python v3.
\& \- 596761 Ctrl\-\e causes guestfish to abort
.Ve
.SH "RELEASE NOTES FOR LIBGUESTFS 1.14"
.IX Header "RELEASE NOTES FOR LIBGUESTFS 1.14"
These release notes only cover the differences from the previous stable/dev
branch split (1.12.0).  For detailed changelogs, please see the git
repository, or the ChangeLog file distributed in the tarball.
.SS "New features"
.IX Subsection "New features"
.Vb 1
\&  Erlang bindings.
\&
\&  virt\-alignment\-scan is a new tool to check the alignment of
\&  partitions within virtual machines or disk images.
\&
\&  virt\-sparsify is a new tool to make virtual machine disk images
\&  sparse.
\&
\&  virt\-sysprep is a new tool to make cloning guests from a template
\&  simpler.
.Ve
.PP
\fIguestfish\fR
.IX Subsection "guestfish"
.PP
.Vb 1
\&   \- New commands setenv, unsetenv, to set environment variables.
\&
\&   \- The input file and line number is printed in error messages.
\&
\&   \- guestfish progress bars are now a "mini\-library" used by other
\&     tools too.
.Ve
.PP
\fIguestmount\fR
.IX Subsection "guestmount"
.PP
.Vb 1
\&   \- the \-\-live option (for access to live VMs) now works.
.Ve
.PP
\fIvirt-cat\fR
.IX Subsection "virt-cat"
.PP
.Vb 1
\&   \- virt\-cat can now handle Windows paths and drive letters (RHBZ#693359).
.Ve
.PP
\fIvirt-filesystems\fR
.IX Subsection "virt-filesystems"
.PP
.Vb 1
\&   \- the MBR partition type byte is displayed in \-\-long output.
.Ve
.PP
\fIvirt-make-fs\fR
.IX Subsection "virt-make-fs"
.PP
.Vb 2
\&   \- virt\-make\-fs now sets the MBR partition type byte correctly,
\&     improving compatibility with Windows (RHBZ#746295).
.Ve
.PP
\fIvirt-resize\fR
.IX Subsection "virt-resize"
.PP
.Vb 2
\&   \- virt\-resize can now work with guests using extended and logical
\&     partitions, in particular Ubuntu guests.
\&
\&   \- virt\-resize can now align the first partition of Windows guests,
\&     improving performance.  The new virt\-resize \-\-align\-first option
\&     controls this behaviour.
\&
\&   \- The virt\-resize \-\-machine\-readable flag makes it possible to use
\&     virt\-resize from other programs.
\&
\&   \- Partitions are now aligned to 128 sectors (usually 64K) by
\&     default.  This improves efficiency on high\-end storage.  The new
\&     virt\-resize \-\-alignment option allows the alignment to be
\&     adjusted.
.Ve
.PP
\fIvirt-win-reg\fR
.IX Subsection "virt-win-reg"
.PP
.Vb 2
\&   \- The syntax for deleting registry keys and values is documented
\&     in the man page (RHBZ#737944).
.Ve
.PP
\fIlibrary\fR
.IX Subsection "library"
.PP
.Vb 1
\&   \- non\-printing characters are escaped correctly in debug output.
\&
\&   \- GUESTFS_EVENT_ENTER is a new event type generated whenever a
\&     libguestfs function is called.
\&
\&   \- the library contains systemtap/DTrace probes.
\&
\&   \- the library can now be compiled without hivex (RHBZ#723474).
.Ve
.PP
\fIinspection\fR
.IX Subsection "inspection"
.PP
.Vb 1
\&   \- Improve detection of Windows disks.
\&
\&   \- Adds support for:
\&         ttylinux \- a minimal Linux
\&         Mageia (thanks Michael Scherer)
\&         OpenSUSE and zypper (thanks Michael Scherer, Vincent Untz)
\&         Ubuntu logos (thanks Michael Scherer)
\&         NetBSD and pkgsrc (thanks Michael Scherer)
\&
\&   \- Handle some guest types that use /dev/root in /etc/fstab.
\&
\&   \- Fix handling of guests with > 26 disks (thanks Matthew Booth)
\&
\&   \- Add support for guests with HP Smart Array disks (thanks Matthew Booth)
.Ve
.PP
\fIfebootstrap\fR
.IX Subsection "febootstrap"
.PP
.Vb 2
\&   \- FEBOOTSTRAP_KERNEL, FEBOOTSTRAP_MODULES environment variables can
\&     be set in order to choose which kernel to use for the appliance.
.Ve
.PP
\fImisc\fR
.IX Subsection "misc"
.PP
.Vb 1
\&   \- ArchLinux support now working with Linux 3.0 (thanks Erik Nolte)
\&
\&   \- libvirt disks marked <readonly/> are now added readonly when
\&     using the virt\-tools \*(Aq\-d\*(Aq option.
.Ve
.SS "Security"
.IX Subsection "Security"
.Vb 1
\&  (no security problems were found or fixed in this release)
.Ve
.SS "New APIs"
.IX Subsection "New APIs"
.Vb 3
\&  compress\-out, compress\-device\-out, copy\-device\-to\-device,
\&  copy\-device\-to\-file, copy\-file\-to\-device, copy\-file\-to\-file,
\&  get\-smp, part\-to\-partnum, set\-smp.
\&
\&  The mount API no longer implicitly adds \-o sync,noatime options.
\&
\&  add\-domain has a new \*(Aqreadonlydisk\*(Aq optional parameter to control
\&  how <readonly/> disks are handled.
.Ve
.SS "内部"
.IX Subsection "内部"
.Vb 2
\& \- Coverity was run on the source and more bugs were identified and
\&   fixed.
\&
\& \- PCRE library is now required to build libguestfs.
\&
\& \- APIC is now the default for the appliance.  You can also enable
\&   SMP support in the appliance.
\&
\& \- OCaml bindings now correctly acquire GC lock during callbacks.
\&
\& \- Out of tree builds should now work correctly (thanks Hilko Bengen).
\&
\& \- ./configure \-\-with\-extra="..." can be used by packagers to set
\&   the extra version string.
\&
\& \- zero, zero\-device APIs: if the blocks already contain zeroes,
\&   don\*(Aqt write zeroes, so that we don\*(Aqt unnecessarily make the
\&   underlying storage non\-sparse.
\&
\& \- is\-zero, is\-zero\-device APIs: optimize these so zero detection is
\&   faster.
.Ve
.SS "バグ修正"
.IX Subsection "バグ修正"
.Vb 10
\& \- 748266 libguestfs should detect versions of qemu which require \-machine pc option
\& \- 747290 libguestfs ignores <readonly/> in libvirt XML
\& \- 747287 Misleading error message when permission denied opening a disk image
\& \- 746295 virt\-make\-fs doesn\*(Aqt set partition ID
\& \- 744795 guestmount \-\-live is not usable
\& \- 737944 virt\-win\-reg hyphen (delete key) syntax may be wrong, and is not documented
\& \- 733297 ruby event handlers fail with "exception in callback: wrong argument type Proc (expected Data)"
\& \- 731744 libguestfs should escape special/non\-printing characters in debug output
\& \- 729887 appliance crashes running aug_init with flags=4
\& \- 729075 libguestfs confuses Hp_recovery partition with Windows root filesystem
\& \- 727178 error: luks_open: cryptsetup: error while loading shared libraries: libfipscheck.so.1: cannot open shared object file: No such file or directory
\& \- 726739 libguestfs: error: aug_get: no matching node, trying to find hostname
\& \- 723474 If hivex and/or pcre not installed, libguestfs fails to compile
\& \- 693359 virt\-cat and virt\-edit don\*(Aqt handle case sensitive NTFS paths properly
\& \- 678231 virt\-inspector reports unknown filesystem UUID
\& \- 671082 libguestfs does not work with kernel\-rt
\& \- 666578 libguestfs: unknown filesystem label SWAP\-sda2
\& \- 642821 virt\-resize falls over on a disk image with a logical swap partition
.Ve
.SH "RELEASE NOTES FOR LIBGUESTFS 1.12"
.IX Header "RELEASE NOTES FOR LIBGUESTFS 1.12"
These release notes only cover the differences from the previous stable/dev
branch split (1.10.0).  For detailed changelogs, please see the git
repository, or the ChangeLog file distributed in the tarball.
.SS "New features"
.IX Subsection "New features"
\fIguestfish\fR
.IX Subsection "guestfish"
.PP
.Vb 2
\&   \- guestfish strings can use escapes,
\&     eg. ><fs> write /foo "line 1\enline 2\en"
\&
\&   \- guestfish write\-append command can be used to append to files.
\&
\&   \- Long\-running file uploads and downloads can be cancelled through the
\&     API or by hitting ^C in guestfish.
\&
\&   \- New guestfish "display" command for displaying graphical files
\&     inside guests.
\&
\&   \- In guestfish, tab completion now works on /dev/mapper devices.
.Ve
.PP
\fIvirt-inspector\fR
.IX Subsection "virt-inspector"
.PP
.Vb 1
\&   \- Inspection API can get an icon or logo for certain guests.
\&
\&   \- virt\-inspector includes the logo and hostname for certain guests.
\&
\&   \- virt\-inspector can now get the version and release numbers for RPM
\&     packages.
\&
\&   \- CentOS and Scientific Linux are now treated as separate distros by
\&     the inspection API.
.Ve
.PP
\fIvirt-resize\fR
.IX Subsection "virt-resize"
.PP
.Vb 1
\&   \- virt\-resize can now handle btrfs.
\&
\&   \- New virt\-resize \-\-ntfsresize\-force option allows Windows VMs to be
\&     resized multiple times.
.Ve
.PP
\fIother virt tools\fR
.IX Subsection "other virt tools"
.PP
.Vb 4
\&   \- guestfish, guestmount, virt\-cat, virt\-df, virt\-edit, virt\-filesystems,
\&     virt\-inspector, virt\-ls and virt\-rescue now allow you to use
\&     "\-d UUID" option to specify a guest by UUID.  This makes them more
\&     robust to use from other programs.
\&
\&   \- virt\-ls \-lR option allows complex file iteration and guest analysis.
\&
\&   \- virt\-win\-reg supports HKEY_USERS\e<SID> and HKEY_USERS\e<username>.
\&
\&   \- virt\-win\-reg new option \-\-unsafe\-printable\-strings allows printable
\&     strings to be displayed in the output (unsafely: read the documentation
\&     before using).
\&
\&   \- virt\-edit has been rewritten in C.
.Ve
.PP
\fI\s-1API\s0 and language bindings\fR
.IX Subsection "API and language bindings"
.PP
.Vb 2
\&   \- Java is now completely supported.
\&     See http://libguestfs.org/guestfs\-java.3.html
\&
\&   \- JRuby is supported via the Java bindings.
\&
\&   \- guestfs_close now appears in trace messages.
\&
\&   \- Python binding adds explicit g.close() method.
\&
\&   \- Python programs can now use the new event API.
\&
\&   \- Python GIL is released during libguestfs calls, allowing multithreaded
\&     Python programs to work properly.
\&
\&   \- 9pfs (Plan 9 filesystems exported from the host) are now supported.
\&
\&   \- Add \-DGUESTFS_WARN_DEPRECATED=1 to warn about use of deprecated API
\&     functions in C programs.
\&
\&   \- New manual page guestfs\-recipes(1) with recipes.
\&
\&   \- mkfs\-opts can now set inode size and sector size on created filesystems
\&     (thanks Nikita Menkovich).
\&
\&   \- guestfs_last_errno is now accessible from OCaml (as g#last_errno ()).
.Ve
.SS "Security"
.IX Subsection "Security"
.Vb 3
\& \- optargs_bitmask is checked even for calls that have no optional
\&   arguments.  This closes a possible exploit in the daemon from
\&   untrusted callers.
.Ve
.SS "New APIs"
.IX Subsection "New APIs"
.Vb 3
\&  btrfs\-filesystem\-resize, get\-pgroup, inspect\-get\-icon, is\-zero,
\&  is\-zero\-device, list\-9p, list\-dm\-devices, mount\-9p, ntfsresize\-opts,
\&  set\-pgroup, write\-append
.Ve
.SS "内部"
.IX Subsection "内部"
.Vb 2
\& \- Coverity (a static analysis tool) was run across the codebase and
\&   many fixes were made.
\&
\& \- Generator can handle functions that return RBufferOut and have
\&   optional arguments.
\&
\& \- Compatible with Perl 5.14.
\&
\& \- Compatible with gcc 4.6.
\&
\& \- Perform safety checks on QEMU.
\&
\& \- C API tests can now fully test calls that have optional arguments.
\&
\& \- Use ./configure \-\-enable\-install\-daemon to install /usr/sbin/guestfsd.
\&
\& \- po\-docs directory now covers all man pages.
\&
\& \- stderr from qemu process is now captured by the event subsystem.
.Ve
.SS "バグ修正"
.IX Subsection "バグ修正"
.Vb 7
\& \- 602997 part\-get\-bootable gives wrong result with an unordered part layout
\& \- 661280 virt\-rescue: panic when shutting down: "/sbin/reboot: No such file or directory"
\& \- 700369 qemu\-system\-x86_64 says \*(AqKVM not supported for this target\*(Aq
\& \- 705200 guestmount attempt results in access denied
\& \- 714981 \*(Aqlist\-filesystems\*(Aq does not know about virtio 9p filesystems or detect existing mounts
\& \- 717786 libguestfs python bindings should have an explicit close call
\& \- 721275 virt\-resize in F16 should support btrfs
.Ve
.SH "Release notes for libguestfs 1.10.0"
.IX Header "Release notes for libguestfs 1.10.0"
These release notes only cover the differences from the previous stable/dev
branch split (1.8.0).  For detailed changelogs, please see the git
repository, or the ChangeLog file distributed in the tarball.
.SS "New features"
.IX Subsection "New features"
.Vb 4
\& \- libguestfs and tools can be used against live virtual machines.
\&   See the \*(Aqguestfish \-\-live\*(Aq and \*(Aqguestmount \-\-live\*(Aq options, and (for
\&   the low\-level interface) the new APIs set\-attach\-method and
\&   get\-attach\-method.
\&
\& \- New virt tools:
\&   virt\-copy\-in, virt\-copy\-out, virt\-tar\-in, virt\-tar\-out.
\&
\& \- libguestfs can get the drive letter mappings for Windows guests.
\&
\& \- virt\-inspector displays drive letter mappings for Windows guests.
\&
\& \- Drive letters can now be used in virt\-edit and guestfish programs
\&   when operating on Windows guests.
\&
\& \- virt\-resize now works on 32 bit hosts.
\&
\& \- You can now inspect the install disks and live CDs of many different
\&   operating systems.
\&
\& \- guestfish <! cmd which executes a shell cmd and inlines the result.
\&
\& \- guestfish, guestmount, virt\-rescue now all support \-\-ro and \-\-rw
\&   options, and the default for this can be chosen via a configuration
\&   file (/etc/libguestfs\-tools.conf).
\&
\& \- New event API allows more than one callback to be registered for
\&   each event, makes it possible to call the API from other languages,
\&   and allows nearly all log, debug and trace messages to be rerouted
\&   from stderr.
\&
\& \- Greater FHS compliance for temporary files, including using /var/tmp
\&   for large cached files that should survive reboot (instead of /tmp).
\&
\& \- guestfish, guestmount \-m option allows mount options to be passed
\&   through to the underlying filesystem.
\&
\& \- mkfs\-opts allows filesystem features to be specified.
\&
\& \- More intelligent handling of mountpoints, allowing mkmountpoint, mount
\&   and umount\-all commands to work together properly.
\&
\& \- Trace messages are prefixed with a distinct string, allowing them to
\&   be easily \*(Aqgrepped\*(Aq out from debug output.
\&
\& \- guestfs_launch (guestfish \*(Aqrun\*(Aq command) now produces progress
\&   messages (a guestfish progress bar) if it takes longer than 5
\&   seconds to run.
\&
\& \- Several long\-running commands where we are unable to estimate time
\&   to completion generate "pulse mode" progress events.  Progress bar
\&   in guestfish has been updated to display these.
\&
\& \- Publish new example code in: C, Perl, Python, OCaml, Ruby.
\&
\& \- New virt\-dhcp\-address example program.
\&
\& \- The Java and Ruby bindings have been improved greatly.
\&
\& \- Perl includes a way to get the errno of the last error.
\&
\& \- Python bindings now compatible with rpyc (thanks Erez Shinan).
\&
\& \- Transifex is now being used to manage translations.
\&   http://www.transifex.net/projects/p/libguestfs/
\&
\& \- Inspection now supports Red Hat Desktop, Slackware distributions.
\&
\& \- Inspection no longer fails for Windows guests that have two or
\&   more disks.
\&
\& \- Inspection can now tell the difference between Windows 2008 Server
\&   and Windows 7.
\&
\& \- Inspection can detect 32 bit applications installed in 64 bit
\&   Windows, running on the WOW64 emulator.
\&
\& \- A series of protocol fixes has fixed the old bug RHBZ#576879
\&   which used to cause errors during the upload command to lose
\&   protocol synchronization.
\&
\& \- New logo!
.Ve
.SS "Security"
.IX Subsection "Security"
.Vb 1
\&  [none]
.Ve
.SS "New APIs"
.IX Subsection "New APIs"
.Vb 4
\&  first\-private, get\-attach\-method, inspect\-get\-drive\-mappings,
\&  inspect\-get\-product\-variant,
\&  inspect\-get\-windows\-current\-control\-set, next\-private, resize2fs\-M,
\&  set\-attach\-method.
.Ve
.SS "内部"
.IX Subsection "内部"
.Vb 2
\& \- The \*(AqHACKING\*(Aq file is obsolete.  The contents have been moved into
\&   a section of the guestfs(3) manual page.
\&
\& \- libguestfs\-test\-tool simplified.  It no longer needs the static
\&   binary or tries to construct an ISO.
\&
\& \- rpcgen\-generated files are compiled with \-fno\-strict\-aliasing
\&   which should be safer (thanks Matt Booth).
\&
\& \- virt\-resize was rewritten in OCaml.
\&
\& \- guestfish and other tools tested with valgrind; some memory leaks
\&   were fixed.
.Ve
.SS "バグ修正"
.IX Subsection "バグ修正"
.Vb 10
\& \- 502533 Updated Polish translation of libguestfs
\& \- 576879 libguestfs protocol loses synchronization if you \*(Aqupload\*(Aq before mounting disks
\& \- 599503 document that mkmountpoint and umount\-all cannot be mixed
\& \- 617440 guestfish: fails to tilde expand \*(Aq~\*(Aq when the $HOME env is unset
\& \- 664558 RFE: Allow to set log callback in Ruby bindings
\& \- 665358 Punjabi Translation Completed (pa_IN)
\& \- 666577 libguestfs: unknown filesystem /dev/fd0
\& \- 667610 Multiple bugs, memory leaks in libguestfs ruby bindings
\& \- 668112 virt\-filesystems command fails on guest with corrupt filesystem label
\& \- 668574 guestfish \-i is trying to mount all mounts from /etc/fstab and fails with an error when device doesn\*(Aqt exists
\& \- 673479 Add a grep\-friendly string to LIBGUESTFS_TRACE output
\& \- 674130 Inspection code fails for Windows guest with two disks
\& \- 682756 libguestfs trace segfaults when list\-filesystems returns error
\& \- 682979 libguestfs incorrectly detects Red Hat desktop as \*(Aqredhat\-based\*(Aq instead of \*(Aqredhat\*(Aq
\& \- 690819 mkfs fails creating a filesystem on a disk device when using a disk with \*(Aqide\*(Aq interface
\& \- 691389 Extended attributes don\*(Aqt work over guestmount (FUSE)
\& \- 691724 virt\-inspector reports unknown filesystem /dev/vda1
\& \- 692545 inspect\-list\-applications fails to detect 32 bit apps installed under WOW64 emulator on 64 bit Windows
\& \- 693324 sfdisk\*(Aqs python interface only accepts lists of type \*(Aqlist\*(Aq for the lines parameter
.Ve
.SH "libguestfs 1.8 のリリースノート"
.IX Header "libguestfs 1.8 のリリースノート"
These release notes only cover the differences from the previous stable/dev
branch split (1.6.0).  For detailed changelogs, please see the git
repository, or the ChangeLog file distributed in the tarball.
.SS "New features"
.IX Subsection "New features"
.Vb 1
\& \- Support and packages for Debian and Ubuntu.
\&
\& \- Daily builds from git repository on Debian and Ubuntu to reduce risk
\&   of regressions.
\&
\& \- Port to ArchLinux \*(Aqpacman\*(Aq (thanks Thomas S Hatch).
\&
\& \- The following tools have been rewritten in C (originally in Perl):
\&
\&     . virt\-cat
\&     . virt\-df
\&     . virt\-inspector
\&     . virt\-ls
\&     . virt\-rescue
\&
\& \- Some C tools support encrypted guests automatically.  This is
\&   supported in: guestfish, guestmount, virt\-cat, virt\-inspector,
\&   virt\-ls.
\&
\& \- New tool virt\-filesystems (in C) which is a replacement for
\&   virt\-list\-filesystems and virt\-list\-partitions, and has a superset
\&   of the functionality of those tools.
\&
\& \- guestfish, guestmount and the C tools use unified command line option
\&   parsing, so they support many common options such as \*(Aq\-a disk.img\*(Aq,
\&   \*(Aq\-d libvirt\-domain\*(Aq, \*(Aq\-x\*(Aq, \*(Aq\-v\*(Aq.  The old command line option
\&   parsing is preserved for compatibility in scripts etc.
\&
\& \- guestfish no longer has any dependencies on Perl
\&
\& \- New man pages containing programming examples: guestfs\-examples(3) (C/C++),
\&   guestfs\-ocaml(3), guestfs\-python(3), guestfs\-ruby(3).
\&
\& \- Trace mode prints return values from API functions.
\&
\& \- virt\-inspector can list applications installed in Windows guests, along
\&   with a great deal of information about those applications.
\&
\& \- Add support for inspecting: Linux Mint, Mandriva, FreeBSD.
\&
\& \- guestfish \-\-rw option (with no effect currently) to make potentially
\&   dangerous write access explicit.
\&
\& \- guestfish \-\-listen \-\-csh for compatibility with csh, tcsh (thanks
\&   Eric Blake).
\&
\& \- The first upstream version that introduced each API function is now
\&   documented in guestfs(3).
\&
\& \- guestfs_last_errno allows you to retrieve the errno from the
\&   daemon, correctly translated to the local operating system.
\&
\& \- Functions can now have optional parameters.
\&
\& \- Progress bars and progress notifications can now happen for upload
\&   commands.
\&
\& \- Appliance builder more careful about not leaving temporary files
\&   around in /tmp.
\&
\& \- getfattr/setfattr commands added to virt\-rescue.
\&
\& \- ROADMAP file covers roadmap and goals for future releases.
.Ve
.SS "Security"
.IX Subsection "Security"
.Vb 1
\& \- New SECURITY section in guestfs(3) API documentation.
\&
\& \- virt\-inspector no longer runs any guest commands.
\&
\& \- Inspection code is more careful about avoiding very large files
\&   from guests which might previously have caused a denial of service.
\&
\& \- FUSE calls into guestmount are now traced when using guestmount \-x.
.Ve
.SS "New APIs"
.IX Subsection "New APIs"
.Vb 10
\& \- add\-domain
\& \- add\-drive\-opts
\& \- getxattr
\& \- inspect\-get\-hostname
\& \- inspect\-get\-package\-format
\& \- inspect\-get\-package\-management
\& \- inspect\-get\-roots
\& \- inspect\-list\-applications
\& \- lgetxattr
\& \- mkfs\-opts
.Ve
.SS "内部"
.IX Subsection "内部"
.Vb 1
\& \- C programs now only link precisely with the libraries that they use.
\&
\& \- PCRE, libmagic, hivex and libvirt libraries are now completely
\&   optional for building.
\&
\& \- Multiple memory leaks and file descriptor leaks fixed.
\&
\& \- Add a POD wrapper to unify generation of man pages and HTML files
\&   across all programs.
\&
\& \- Source includes phony images of Fedora, Debian, Ubuntu and
\&   Windows guests.
\&
\& \- Ruby bindings have \*(Aqmake install\*(Aq rule.
\&
\& \- <guestfs.h> is now a single file.
\&
\& \- <guestfs.h> does not require XDR headers.
\&
\& \- ocaml xml\-light library is no longer required to build (thanks
\&   Maxim Koltsov).
\&
\& \- ./configure \-\-disable\-[...] for each language binding (thanks
\&   Maxim Koltsov).
\&
\& \- Old ocaml\-viewer program removed (use guestfs\-browser instead).
\&
\& \- New C API test type \*(AqInitScratchFS\*(Aq makes the tests run a little
\&   more quickly.
\&
\& \- Excluded packages in the appliance are now listed in a separate
\&   file appliance/excludelist.in, and can be customized per\-distro.
.Ve
.SS "バグ修正"
.IX Subsection "バグ修正"
.Vb 6
\& \- 663407 readlink and readlinklist returns /sysroot/ in some paths
\& \- 661280 virt\-rescue: panic when shutting down: "/sbin/reboot: No such file or directory"
\& \- 657499 checksum: wrong check sum type causes umount to fail
\& \- 655554 Whole disk paths are not made canonical by virt\-inspector
\& \- 654638 openssl updated to 1.0.0b libguestfs depends on exact file names
\& \- 652796 ruby bindings not installed by \*(Aqmake install\*(Aq, hence omitted from the binary distribution
.Ve
.SH "RELEASE NOTES FOR LIBGUESTFS 1.6"
.IX Header "RELEASE NOTES FOR LIBGUESTFS 1.6"
These release notes only cover the differences from the previous stable/dev
branch split (1.4.0).  For detailed changelogs, please see the git
repository, or the ChangeLog file distributed in the tarball.
.SS "New features"
.IX Subsection "New features"
.Vb 3
\& \- Use a new method for creating and caching the appliance.  This
\&   greatly improves the performance of libguestfs, often by a factor
\&   of x 4 to x 5.
\&
\& \- Support for guest inspection (like virt\-inspector) via the ordinary
\&   API and all language bindings.  \*(Aqguestfish \-i\*(Aq option is as a side\-
\&   effect much quicker.
\&
\& \- virt\-inspector and core inspection API can now detect guests running:
\&   Fedora, Debian, Ubuntu, Windows, Red Hat Enterprise Linux, CentOS,
\&   Scientific Linux, Gentoo, Pardus, Arch Linux, MeeGo.
\&
\& \- Support for LUKS whole\-disk encryption in guests.
\&
\& \- PHP バインディング。
\&
\& \- Progress messages (and progress bars in guestfish and virt\-resize)
\&   for certain long\-running operations.
\&
\& \- virt\-df is now much more efficient.  Use \*(Aq\-\-one\-per\-guest\*(Aq to restore
\&   the old per\-guest isolation behaviour.
\&
\& \- guestfish \*(Aqcopy\-in\*(Aq and \*(Aqcopy\-out\*(Aq commands for copying files and
\&   directories recursively in and out of the guest.
\&
\& \- guestfish \*(Aqhexedit\*(Aq command for doing binary edits to devices and
\&   files.
\&
\& \- Change guestfish \-i syntax to allow commands to be specified on the
\&   command line (retaining backwards compatibility).
\&
\& \- guestfish \*(Aq\-d <domain>\*(Aq for adding disks from libvirt domains.
\&
\& \- guestfish \*(Aq\-N\*(Aq option supports several new prepared disk image types:
\&         lvfs : disk with LV formatted with filesystem
\&           lv : disk with LV
\&     bootroot : boot+root
\&   bootrootlv : boot and root on LV
\&
\& \- guestfish \*(Aqmore\*(Aq and \*(Aqedit\*(Aq commands now work with arbitrary files.
\&
\& \- guestfish \*(Aq\-\-echo\-keys\*(Aq option allows you to echo keys/passphrases
\&   while typing them.
\&
\& \- guestmount now supports \-a / \-d / \-i options, like guestfish.
\&
\& \- Use virtio\-serial for communications with the appliance.  This
\&   also has a major performance benefit.
\&
\& \- virt\-edit \*(Aq\-b\*(Aq option to create a backup of edited files.
\&
\& \- virt\-edit \*(Aq\-e\*(Aq option for non\-interactive edits to files.
\&
\& \- Ability to capture core dumps from the appliance (thanks Matthew Booth).
\&
\& \- virt\-rescue now shuts down cleanly (thanks Matthew Booth).
\&
\& \- virt\-rescue now has a \-\-network option to enable network access.
\&
\& \- virt\-resize can now handle guests which use GPT partition table format.
\&
\& \- virt\-resize has better support for shrinking guests.
\&
\& \- virt\-resize supports qcow2\-format guests.
\&
\& \- $TMPDIR can be used to override almost all temporary directory usage.
\&
\& \- OCaml users can use an alternate OO\-style of coding, eg. g#launch ()
\&
\& \- The API supports calls which take optional parameters, eg.
\&     $g\->add_drive_opts ("disk", readonly => 1);
\&
\& \- Trace output now escapes and shortens large strings (thanks
\&   Matthew Booth).
\&
\& \- Autosync is now on by default, resulting in more reliable behaviour
\&   when the handle is closed.
\&
\& \- virt\-df \-\-uuid option allows you to follow a domain across migration
\&   and renaming.
\&
\& \- Translations of manual pages.
.Ve
.SS "Security"
.IX Subsection "Security"
.Vb 4
\& \- CVE\-2010\-3851 libguestfs: missing disk format specifier when adding a disk
\&   https://www.redhat.com/archives/libguestfs/2010\-October/msg00036.html
\&   This is comprehensively fixed in this release, and the fix will be
\&   backported to the other stable branches after more testing.
\&
\& \- virt\-inspector no longer relies on untrusted guest code to list
\&   applications in some guests.
.Ve
.SS "New APIs"
.IX Subsection "New APIs"
.Vb 10
\&  download\-offset, file\-architecture, findfs\-label, findfs\-uuid,
\&  inspect\-os, inspect\-get\-arch, inspect\-get\-distro,
\&  inspect\-get\-filesystems, inspect\-get\-major\-version,
\&  inspect\-get\-minor\-version, inspect\-get\-mountpoints,
\&  inspect\-get\-product\-name, inspect\-get\-type, is\-blockdev, is\-chardev,
\&  is\-fifo, is\-lv, is\-socket, is\-symlink, list\-filesystems, luks\-add\-key,
\&  luks\-close, luks\-format, luks\-format\-cipher, luks\-kill\-slot,
\&  luks\-open, luks\-open\-ro, lvm\-clear\-filter, lvm\-canonical\-lv\-name,
\&  lvm\-set\-filter, part\-to\-dev, pread\-device, pwrite\-device,
\&  upload\-offset
.Ve
.SS "内部"
.IX Subsection "内部"
.Vb 10
\& \- Use size_t for loop iterators.
\& \- Refactor the library code into separate files.
\& \- Refactor the generator code into separate files.
\& \- Generate guestfish commands.
\& \- guestfish & guestmount options processing is unified.
\& \- Protocol changes:
\&     error message size increased to 64K
\&     send errno to library
\& \- Add \*(Aqmake bindist\*(Aq to make a binary distribution.
\& \- Cleaner behaviour under valgrind.
\& \- More testing of the guestfish command line options and libvirt
\&   integration.
\& \- The Perl inspection code is no longer used by any of the tools.
.Ve
.SS "バグ修正"
.IX Subsection "バグ修正"
.Vb 10
\& \- 646822 libguestfs trace mode should not print long binary strings
\& \- 646821 virt\-df should have \-\-uuid option
\& \- 646432 /dev/mapper paths should not be returned from guestfs_mountpoints
\& \- 643624 libguestfs tools documentation should describe how to quote guest domain names from shell
\& \- 642934 No way to specify disk format when adding a disk to libguestfs
\& \- 642933 guestfs_list_filesystems should be used in all possible places
\& \- 642932 guestmount options should match guestfish options
\& \- 642930 virt\-inspector (Sys::Guestfs::Lib) should use C inspection APIs
\& \- 642929 C inspection code should ignore /dev/fd* in /etc/fstab
\& \- 642826 virt\-resize converts any other image format to raw without notifying user, instructions do not account for this
\& \- 640961 Document that grub\-install might be needed for old Linux guests after virt\-resize
\& \- 639986 virt\-df \-\-csv does not properly quote " in libvirt domain names
\& \- 639405 Interrupted cached appliance creation leaves libguestfs unusable
\& \- 638901 Appliance filename should not contain repository name
\& \- 638899 /dev/mapper paths should not be returned from C inspection APIs
\& \- 636918 Updates to Spanish translation
\& \- 636061 [abrt] guestfish\-1.2.11\-1.fc12: malloc_consolidate: Process /usr/bin/guestfish was killed by signal 11 (SIGSEGV)
\& \- 635969 glob echo mkfs ext2 /dev/vd[b\-t]1 prints garbage
\& \- 634246 guestfs_part_get_parttype returns "loop" when run against a partition, LV or filesystem
\& \- 633766 virt\-resize \-\-shrink fails
\& \- 633357 Updates to Spanish translation
\& \- 633096 virt\-resize calculates block device size incorrectly, doesn\*(Aqt work with qcow2 target
\& \- 629593 Dutch translation added
\& \- 627556 Updates to Spanish translations of libguestfs
\& \- 626843 Updates to Spanish translations
\& \- 619793 [RFE] Need a way to determine if a particular block device is a logical volume
\& \- 618556 virt\-rescue return none zero value when exit
\& \- 617200 mount operation failed and hung on some images which running in read\-only mode
\& \- 610880 libguestfs should set broader read perms on tmpdir, so works in some situations when executed with umask 077
\& \- 599503 document that mkmountpoint and umount\-all cannot be mixed
\& \- 571714 Running virt\-df on disk image relabels it, so qemu can no longer write to it.
\& \- 502533 Updated Polish translation of libguestfs
.Ve
.SH "RELEASE NOTES FOR LIBGUESTFS 1.4"
.IX Header "RELEASE NOTES FOR LIBGUESTFS 1.4"
These release notes only cover the differences from the previous stable/dev
branch split (1.2.0).  For detailed changelogs, please see the git
repository, or the ChangeLog file distributed in the tarball.
.SS "New features"
.IX Subsection "New features"
.Vb 2
\& \- guestfish lets you choose a prepared disk image, eg:
\&     guestfish \-N fs:ext4
\&
\& \- Add write support to guestmount (FUSE) module.
\&
\& \- virt\-resize can now resize the content of partitions and logical
\&   volumes in the guest, and we have better support for shrinking guests.
\&
\& \- Bash tab\-completion script for guestfish.
\&
\& \- Add ZFS support to virt\-rescue.
\&
\& \- New tool \*(Aqvirt\-make\-fs\*(Aq for creating filesystems with content.
\&
\& \- Allow suffixes on any guestfish number parameter, eg. "1M".
\&
\& \- guestfish \*(Aqman\*(Aq command opens the manual page.
\&
\& \- guestfish supports a "heredoc" syntax for uploading files:
\&     upload \-<<_end_ /foo
\&     content
\&     _end_
\&
\& \- Some guestfish commands now print their output in octal or hex
\&   where appropriate (RHBZ#583242).
\&
\& \- Allow dash prefix on guestfish command line.  This ignores any
\&   error from the second command:                   (RHBZ#578407)
\&     guestfish \-\- cmd1 : \-cmd2 : cmd3
\&
\& \- guestfish \-h / help command now returns an error for non\-existent
\&   commands (RHBZ#597145).
\&
\& \- New \*(Aqsupported\*(Aq command in guestfish to list optional groups of
\&   commands which are supported by the daemon / configuration.
\&
\& \- virt\-inspector and guestfish \-i now work for filenames which
\&   contain spaces (RHBZ#507810).
\&
\& \- Change the protocol to use link\-local addresses, to avoid
\&   conflicting with any address that the host might be using
\&   (RHBZ#588763).
\&
\& \- libguestfs now sets the correct time and timezone on filesystem
\&   modifications.
\&
\& \- Sort the domains into alphabetical order in virt\-df.
\&
\& \- Make mkfs\-b command work for FAT and NTFS by mapping the blocksize
\&   parameter to the cluster size (RHBZ#599464).
\&
\& \- Add version numbers to Perl modules (RHBZ#521674).
\&
\& \- Localization now works for all the libguestfs tools (RHBZ#559963).
\&
\& \- Tools now support filesystem\-on\-image VMs (RHBZ#590167).
\&
\& \- virt\-list\-partitions has a \*(Aq\-t\*(Aq option to show the total size of disks.
\&
\& \- Include extra Augeas lenses in the supermin appliance (Matthew Booth).
\&
\& \- Add error and close callbacks.
\&
\& \- Add explicit close method in the Perl API.
\&
\& \- Multiple fixes for RHEL 5 compatibility.
\&
\& \- Multiple fixes for Debian/Ubuntu compatibility.
\&
\& \- Multiple revisions to improve the documentation.
.Ve
.SS "Security"
.IX Subsection "Security"
.Vb 3
\& \- Fix a potential DoS in virt\-inspector and virt\-v2v if a specially
\&   crafted disk image contained a char device in place of one of the
\&   configuration files that we read under /etc (RHBZ#582484).
.Ve
.SS "New APIs"
.IX Subsection "New APIs"
.Vb 10
\& \- aug\-clear \- clear Augeas path
\& \- available\-all\-groups \- return a list of all optional groups
\& \- base64\-in \- upload base64\-encoded data to file
\& \- base64\-out \- download file and encode as base64
\& \- checksum\-device \- compute checksums on the contents of a device
\& \- checksums\-out \- compute checksums of multiple files in a directory
\& \- debug\-upload \- upload a file to the appliance
\& \- fallocate64 \- preallocate a file in the guest filesystem
\& \- fill\-pattern \- fill a file with a repeating pattern of bytes
\& \- get\-umask \- get the current umask
\& \- lvresize\-free \- expand an LV to fill free space
\& \- ntfsresize \- resize an NTFS filesystem
\& \- ntfsresize\-size \- resize an NTFS filesystem (with size)
\& \- part\-del \- delete a partition
\& \- part\-get\-bootable \- get the bootable flag of a partition
\& \- part\-get\-mbr\-id \- get the MBR type byte of a partition
\& \- part\-set\-mbr\-id \- set the MBR type byte of a partition
\& \- pvresize\-size \- resize a physical volume (with size)
\& \- pwrite \- write to part of a file
\& \- resize2fs\-size \- resize an ext2/3/4 filesystem (with size)
\& \- txz\-in \- unpack compressed tarball to directory (RHBZ#580556)
\& \- txz\-out \- pack directory into compressed tarball (RHBZ#580556)
\& \- vfs\-label \- get the filesystem label
\& \- vfs\-uuid \- get the filesystem UUID
\& \- vgscan \- rescan for LVM physical volumes, volume groups and logical volumes
\& \- write \- create a new file
\& \- zero\-device \- write zeroes to an entire device
.Ve
.SS "内部"
.IX Subsection "内部"
.Vb 9
\& \- Extend the generator to support testing optional features.
\& \- Stricter checks on input parameters to many calls (RHBZ#501893 RHBZ#501894)
\& \- Extend the protocol to support sending arbitrary 8 bit data buffers.
\& \- Ship \*(AqBUGS\*(Aq file with releases.  This is a summary of the bugs in
\&   the Red Hat Bugzilla database.
\& \- Ship \*(AqRELEASE\-NOTES\*(Aq file with releases, containing release notes.
\& \- Unify supermin appliance building into one place, in febootstrap 2.7.
\& \- Fix the protocol code to handle the case where both ends send cancel
\&   messages at the same time.
.Ve
.SS "バグ修正"
.IX Subsection "バグ修正"
.Vb 10
\& \- 612178 guestfish: using \-m option in conjunction with \-\-listen option causes appliance to die
\& \- 610880 libguestfs should set broader read perms on tmpdir, so works in some situations when executed with umask 077
\& \- 604691 OCaml bindings are not thread safe
\& \- 603870 Updates to Spanish translation
\& \- 602592 [RFE] expose guestfs_close in perl bindings
\& \- 600977 virt\-df \-h \-\-csv "Argument .. isn\*(Aqt numeric in printf"
\& \- 599464 mkfs\-b does not support vfat/ntfs
\& \- 598807 add_cdrom does not work in RHEL 6
\& \- 598309 part\-list and several other cmd failed on libguestfs on RHEL5
\& \- 597145 guestfish \*(Aqhelp\*(Aq command should indicate error in exit status with an unknown command
\& \- 597135 guestfish write\-file cmd does not check "size" parameter
\& \- 597118 A warning should be given in the help of mke2journal\-L for the length of label
\& \- 597112 get\-e2uuid should use blkid instead of "tune2fs \-l" to get filesystem UUID
\& \- 596776 virt\-inspector doesn\*(Aqt discover modprobe aliases on RHEL 3 guests
\& \- 596763 Updates to Spanish translation
\& \- 593292 Updates to Spanish translation
\& \- 592883 can not edit files on  images mounted with guestmount cmd
\& \- 592360 Updates to Spanish translation
\& \- 591250 virt\-tar prints "tar_in: tar subcommand failed on directory" if the archive is compressed or not in the right format
\& \- 591155 virt\-tar prints "tar_in: tar subcommand failed on directory" if a disk image is not writable
\& \- 591142 virt\-inspector should give an error for unrecognized disk images
\& \- 590167 virt\-inspector and other virt tools should be able to handle filesystem\-on\-image VMs
\& \- 589039 guestfish read\-file cmd will cause daemon hang when read large files
\& \- 588851 guestfs_launch() returns \-1, but guestfs_last_error() == NULL
\& \- 588763 libguestfs should use non\-public or link\-local addresses for appliance network
\& \- 588733 Updates to Spanish translation
\& \- 588651 guestfish \*(Aqstrings\-e\*(Aq cmd does not give proper error message or hint
\& \- 587484 lvresize can\*(Aqt reduce size of a volumn
\& \- 585961 Updates to Spanish translation
\& \- 585223 ntfsresize should support shrinking filesystems
\& \- 585222 pvresize should support shrinking PVs
\& \- 585221 resize2fs should support shrinking filesystems
\& \- 584038 Updates to Spanish translation
\& \- 583554 [FEAT] mknod\-mode command is needed to set mode explicitly
\& \- 583242 [RFE] guestfish should print outputs in a suitable base (eg. octal for modes)
\& \- 582993 guestfish eats words when tab completing case (in)sensitive paths
\& \- 582953 Misleading help information about lvcreate command
\& \- 582948 mknod command doesn\*(Aqt make block, character or FIFO devices
\& \- 582929 mknod doesn\*(Aqt check for invalid mode
\& \- 582901 guestfish chmod/umask commands do not check invalid mode value
\& \- 582899 guestfish:sparse is missed from command autocomplete list
\& \- 582891 [Feature Request] behavior and return value of guestfish umask cmd should be changed
\& \- 582548 [mknod] umask shouldn\*(Aqt take effect when mode is set explicitly
\& \- 582484 some guestfish sub commands can not handle special files properly
\& \- 582252 Updates to Spanish translation
\& \- 581501 Updates to Spanish translation
\& \- 580650 virt\-inspector warns "No grub default specified at /usr/lib/perl5/Sys/Guestfs/Lib.pm at [...]"
\& \- 580556 request for libguestfs to support .txz tarballs
\& \- 580246 tar\-in command hangs if uploading more than available space
\& \- 580016 aug\-ls in guestfish does not take augeas variable as argument
\& \- 579664 guestfish doesn\*(Aqt report error when there is not enough space for image allocation
\& \- 579608 multiple commands in guestfish can not work for symbol links
\& \- 579155 libguestfs hangs if qemu doesn\*(Aqt start (in null vmchannel mode)
\& \- 578407 the prefix \*(Aq\-\*(Aq in sub\-command isn\*(Aqt handled by guestfish in remote control mode
\& \- 576879 libguestfs protocol loses synchronization if you \*(Aqupload\*(Aq before mounting disks
\& \- 559963 libguestfs Perl programs do set locale, but still localization doesn\*(Aqt work
\& \- 521674 Perl modules are unversioned, but should carry version numbers
\& \- 516096 Race condition in test_swapon_label_0: /sbin/blockdev: BLKRRPART: Device or resource busy
\& \- 507810 guestfish \-i / virt\-inspector cannot handle spaces in filenames
\& \- 502533 Updated Polish translation of libguestfs
\& \- 501894 Some String parameters should be OptString
\& \- 501893 String parameters should be checked for != NULL
\& \- 501889 write\-file does not support strings containing ASCII NUL
\& \- 484986 grub\-install fails on virtio disk
.Ve
.SH "これまでのバージョンの libguestfs に関するリリースノート"
.IX Header "これまでのバージョンの libguestfs に関するリリースノート"
2010
年より前は、公式なリリースノートまたは形式化されたバージョン管理システムがありませんでした。ただ、これらはこれまでの重要なバージョンへのリンクです。
.IP "2009\-11\-10 (1.0.78)" 4
.IX Item "2009-11-10 (1.0.78)"
https://www.redhat.com/archives/libguestfs/2009\-November/msg00095.html
.IP "2009\-09\-13 (1.0.67)" 4
.IX Item "2009-09-13 (1.0.67)"
https://www.redhat.com/archives/libguestfs/2009\-August/msg00281.html
.IP "2009\-07\-23 (1.0.64)" 4
.IX Item "2009-07-23 (1.0.64)"
https://www.redhat.com/archives/libguestfs/2009\-July/msg00059.html
.IP "2009\-07\-14 (1.0.59)" 4
.IX Item "2009-07-14 (1.0.59)"
https://www.redhat.com/archives/libguestfs/2009\-July/msg00023.html
.IP "2009\-04\-01 (the initial announcement)" 4
.IX Item "2009-04-01 (the initial announcement)"
http://rwmj.wordpress.com/2009/04/01/libguestfs\-access\-and\-modify\-virtual\-machine\-disk\-images/
.SH "関連項目"
.IX Header "関連項目"
\&\fIguestfs\-examples\fR\|(1), \fIguestfs\-faq\fR\|(1), \fIguestfs\-performance\fR\|(1),
\&\fIguestfs\-recipes\fR\|(1), \fIguestfs\-testing\fR\|(1), \fIguestfs\fR\|(3),
\&\fIguestfish\fR\|(1), http://libguestfs.org/
.SH "著者"
.IX Header "著者"
Richard W.M. Jones
.SH "COPYRIGHT"
.IX Header "COPYRIGHT"
Copyright (C) 2009\-2017 Red Hat Inc.
.SH "LICENSE"
.IX Header "LICENSE"
.SH "BUGS"
.IX Header "BUGS"
To get a list of bugs against libguestfs, use this link:
https://bugzilla.redhat.com/buglist.cgi?component=libguestfs&product=Virtualization+Tools
.PP
To report a new bug against libguestfs, use this link:
https://bugzilla.redhat.com/enter_bug.cgi?component=libguestfs&product=Virtualization+Tools
.PP
When reporting a bug, please supply:
.IP "\(bu" 4
The version of libguestfs.
.IP "\(bu" 4
Where you got libguestfs (eg. which Linux distro, compiled from source, etc)
.IP "\(bu" 4
Describe the bug accurately and give a way to reproduce it.
.IP "\(bu" 4
Run \fIlibguestfs\-test\-tool\fR\|(1) and paste the \fBcomplete, unedited\fR
output into the bug report.
