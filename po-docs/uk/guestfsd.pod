
=head1 НАЗВА

guestfsd — фонова служба guestfs

=head1 КОРОТКИЙ ОПИС

 guestfsd [-r] [-v|--verbose]

=head1 ОПИС

C<guestfsd> є фоновою службою libguestfs. У звичайних користувачів ніколи не
виникатиме потреби у явному запуску цієї програми. На цій сторінці
підручника обговорено, що саме C<guestfsd> робить у базовій системі
libguestfs і коли libguestfs використовується «вживу».

=head2 БАЗОВА СИСТЕМА LIBGUESTFS

Архітектуру базової системи libguestfs описано у розділі
L<guestfs(3)/АРХІТЕКТУРА>.

Після завантаження базової системи скрипт F</init> у базовій системі
запускає C<guestfsd> без аргументів. C<guestfsd> відкриває послідовний порт
virtio за відомим шляхом (див. L</ФАЙЛИ>). Він ініціює протокол
(див. L<guestfs(3)/ПРОТОКОЛ ОБМІНУ ДАНИМИ>) і обробляє запити один за одним
з бібліотеки, аж доки базову систему не буде знищено.

Файлові системи монтуються до каталогу F</sysroot>, а усі дії із файловими
системами здійснюються відносно цього каталогу.

=head2 LIBGUESTFS LIVE

У випадку libguestfs, C<guestfsd -r> запускається зі скриптів rc, systemd
тощо.

Параметр C<-r> наказує фоновій службі працювати з кореневою файловою
системою, а не з F</sysroot>.

У поточній версії (через обмеження у virtio-serial) одночасно із фоновою
службою може бути з'єднано лише один клієнт, а після від'єднання кожного з
клієнтів C<guestfsd> має бути перезапущено. Якщо libguestfs live буде
перемкнуто на використання іншого каналу передавання даних, зокрема TCP/IP,
це обмеження буде знято.

=head1 ПАРАМЕТРИ

=over 4

=item B<-?>

=item B<--help>

Показати коротку довідку.

=item B<-c> КАНАЛ

=item B<--channel> КАНАЛ

=item B<--channel> дф:N

Передати назву послідовного каналу virtio, послідовного порту тощо, яким
guestfsd обмінюватиметься даними із бібліотекою. Якщо цей параметр не
вказано, буде використано внутрішній типовий порт.

Формат C<дф:N> спричиняє використання у guestfsd дескриптора файла C<N>
безпосередньо.

=item B<-l>

=item B<--listen>

Замість відкриття C<guestfs_channel> і, таким чином, сподівання на його
існування, створити канал як сокет домену Unix, очікувати на дані на ньому і
прийняти одинарне з'єднання. В основному, це використовується для тестування
фонової служби.

=item B<-n>

=item B<--network>

Увімкнути мережеві можливості у фоновій службі.

=item B<-r>

Встановити кореневу файлову систему F</> (замість типової, якою є
F</sysroot>). Крім того, не демонтувати файлові системи, якщо існує фонова
служба.

Цей параметр використовується для вмикання libguestfs live.

=item B<-v>

=item B<--verbose>

Увімкнути докладний показ повідомлень з метою діагностики.

Прапорець докладних повідомлень також встановлюється, якщо у командному
рядку Linux міститься підрядок C<guestfs_verbose=1>.

=back

=head1 СТАН ВИХОДУ

Ця програма повертає значення 0 у разі успішного завершення і ненульове
значення, якщо сталася помилка.

=head1 ФАЙЛИ

=over 4

=item F</dev/virtio-ports/org.libguestfs.channel.0>

Послідовний порт virtio, з яким встановлює з’єднання C<guestfsd>.

=item F</proc/cmdline>

Командний рядок Linux буде оброблено з метою виявлення прапорців
C<guestfs_*>. Розпізнаються такі прапорці:

=over 4

=item B<guestfs_verbose=1>

Увімкнути докладні повідомлення. Цей прапорець передається бібліотекою
libguestfs до базової системи з метою зробити повідомлення фонової служби
докладнішими (працює як прапорець I<-v> у командному рядку). Незалежно від
самої фонової служби, спричиняє виведення скриптом ініціалізації базової
системи набагато ширшого обсягу інформації.

=item B<guestfs_channel=ШЛЯХ>

Встановити якийсь нетиповий шлях до послідовного каналу virtio (типовим є
шлях F</dev/virtio-ports/org.libguestfs.channel.0>). Використовується
модулем режиму користувача Linux для використання звичайного емульованого
послідовного порту замість послідовного порту virtio.

=item B<guestfs_network=1>

Встановлюється, якщо увімкнено мережу у базовій системі
(див. C<guestfs_set_network>).

=back

=back

=head1 ТАКОЖ ПЕРЕГЛЯНЬТЕ

L<guestfs(3)>, L<http://libguestfs.org/>.

=head1 АВТОР

Richard W.M. Jones L<http://people.redhat.com/~rjones/>

=head1 АВТОРСЬКІ ПРАВА

Copyright (C) 2009-2018 Red Hat Inc.

