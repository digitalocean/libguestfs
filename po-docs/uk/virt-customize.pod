
=head1 НАЗВА

virt-customize — налаштовування віртуальної машини

=head1 КОРОТКИЙ ОПИС

 virt-customize
    [ -a диск.img [ -a диск.img ... ] | -d назва домену ]
    [--attach файл ISO] [--attach-format ФОРМАТ]
    [ -c АДРЕСА | --connect АДРЕСА ] [ -n | --dry-run ]
    [ --format ФОРМАТ] [ -m МБ | --memsize МБ ]
    [ --network | --no-network ]
    [ -q | --quiet ] [--smp N] [ -v | --verbose ] [-x]
__CUSTOMIZE_SYNOPSIS__

 virt-customize [ -V | --version ]

=head1 ОПИС

За допомогою virt-customize можна налаштувати віртуальну машину (образ
диска) встановленням пакунків, редагуванням файлів налаштувань тощо.

Virt-customize вносить зміни до гостьової системи або образу диска I<на
місці>. Гостьова система має бути вимкненою. Якщо ви хочете зберегти наявний
вміст гостьової системи, I<вам слід спочатку зробити її знімок, скопіювати
або клонувати її диск>.

Вам I<не потрібно> запускати virt-customize від імені користувача
root. Фактично, запуск у такому режимі є нерекомендованим.

Пов'язані інструменти: L<virt-sysprep(1)> і L<virt-builder(1)>.

=head1 ПАРАМЕТРИ

=over 4

=item B<--help>

Показати коротку довідку.

=item B<-a> файл

=item B<--add> файл

Додати I<файл>, який має бути образом диска з віртуальної машини.

Формат образу диска визначається автоматично. Щоб перевизначити його і
примусово використати певний формат, скористайтеся параметром I<--format>.

=item B<-a> адреса

=item B<--add> адреса

Додати віддалений диск. Формат адреси є сумісним із
guestfish. Див. L<guestfish(1)/ДОДАВАННЯ ВІДДАЛЕНОГО СХОВИЩА>.

=item B<--attach> ФАЙЛ_ISO

Вказаний диск долучається до базової системи libguestfs. Цей диск
використовується для отримання даних додаткових сховищ програмного
забезпечення або інших даних для створення нетипової системи.

Ймовірно, вам варто додати мітки для долучених дисків (або скористатися
назвою тому ISO), щоб надалі монтувати диски за міткою у ваших скриптах
запуску:

 mkdir /tmp/mount
 mount LABEL=EXTRA /tmp/mount

Параметр I<--attach> можна вказати декілька разів, а форматом може бути
будь-який формат образу (не лише ISO).

=item B<--attach-format> ФОРМАТ

Вказати формат диска для наступного параметра I<--attach>. Значенням
аргументу C<ФОРМАТ> зазвичай є C<raw> або C<qcow2>.  Для образів ISO
скористайтеся варіантом C<raw>.

=item B<--colors>

=item B<--colours>

Використовувати послідовності символів ANSI для розфарбовування
повідомлень. Ці послідовності типово використовуються, якщо дані виводяться
на термінал tty.  Якщо дані, виведені програмою, спрямовуються до файла,
послідовності визначення кольорів ANSI буде вимкнено, якщо ви не додасте до
команди цей параметр.

=item B<-c> адреса

=item B<--connect> адреса

Якщо використовується libvirt, встановити з’єднання з вказаним I<URI>. Якщо
пропущено, з’єднання буде встановлено з типовим гіпервізором libvirt.

Якщо вказати блокові пристрої гостьових систем безпосередньо (I<-a>),
libvirt не буде використовуватися взагалі.

=item B<-d> гість

=item B<--domain> гість

Додати всі диски з вказаної гостьової системи libvirt. UUID доменів можна
використовувати замість назв.

=item B<-n>

=item B<--dry-run>

Виконати тестову обробку гостьової системи у режимі «лише читання». Буде
виконано дію sysprep, але наприкінці усі зміни до диска буде відкинуто.

=item B<--echo-keys>

Типово, якщо virt-customize попросить вас ввести ключ або пароль, програма
не відтворюватиме введені символи на екрані. Якщо ви не боїтеся
TEMPEST-нападів, або у вашій кімнаті нікого, окрім вас, немає, ви можете
скористатися цим прапорцем, щоб бачити, які саме символи ви вводите.

=item B<--format> raw|qcow2|..

=item B<--format> auto

Типовим значенням для параметра I<-a> є автоматичне визначення формату
образу диска. Використання цього параметра примусово визначає значення
параметрів I<-a> формату диска у наступному рядку команди. Використання
параметра I<--format auto> перемикає програму у режим автоматичного
визначення у наступних параметрах I<-a>.

Приклад:

 virt-customize --format raw -a диск.img

примусове встановлення формату без обробки (без автоматичного визначення)
для F<disk.img>.

 virt-customize --format raw -a диск.img --format auto -a іще_диск.img

примусове встановлення формату без обробки (без автоматичного визначення)
для F<diskimg> і повернення до автоматичного визначення для F<another.img>.

Якщо ви користуєтеся ненадійними образами гостьових систем у необробленому
форматі, вам слід скористатися цим параметром для визначення формату
диска. Таким чином можна уникнути можливих проблем з захистом для
сформованих зловмисниками гостьових систем (CVE-2010-3851).

=item B<--key> SELECTOR

Specify a key for LUKS, to automatically open a LUKS device when using the
inspection.  C<SELECTOR> can be in one of the following formats:

=over 4

=item B<--key> C<DEVICE>:key:KEY_STRING

Use the specified C<KEY_STRING> as passphrase.

=item B<--key> C<DEVICE>:file:FILENAME

Read the passphrase from F<FILENAME>.

=back

=item B<--keys-from-stdin>

Прочитати параметри ключа або пароля із джерела стандартного
введення. Типово програма намагається читати паролі від користувача
відкриттям F</dev/tty>.

=item B<-m> МБ

=item B<--memsize> МБ

Зміна обсягу пам'яті, наданого скриптам I<--run>. Збільште це значення, якщо
виявиться, що для використання скриптів I<--run> або параметра I<--install>
не вистачає пам'яті.

Типові значення можна визначити за допомогою такої команди:

 guestfish get-memsize

=item B<--network>

=item B<--no-network>

Увімкнути чи вимкнути доступ до мережі для гостьової системи під час
встановлення.

Типово увімкнено. Скористайтеся параметром I<--no-network>, щоб вимкнути
доступ.

У мережі працюватимуть лише вихідні з'єднання, а також буде декілька інших
незначних обмежень. Див. L<virt-rescue(1)/МЕРЕЖА>.

Якщо ви скористаєтеся параметром I<--no-network>, тоді інші параметри,
зокрема I<--install>, не працюватимуть.

Це не вплине на доступність мережі для гостьової системи після її
завантаження, оскільки така доступність керується вашим гіпервізором або
хмарним середовищем і не має нічого спільного з virt-customize.

Загалом кажучи, вам I<не варто> використовувати I<--no-network>. Але ось
декілька випадків, коли у вас може виникнути потреба у використанні цього
параметра:

=over 4

=item 1.

У модулі обробки libguestfs, яким ви користуєтеся, не передбачено підтримки
мережі.  (Див. L<guestfs(3)/МОДУЛЬ>).

=item 2.

Усе програмне забезпечення, яке ви маєте намір встановити, походить з
долученого образу ISO, отже потреби у мережі немає.

=item 3.

Ви не хочете, щоб ненадійний код із гостьової системи намагався отримати
доступ до мережевого з'єднання вашої основної системи під час роботи
virt-customize. Таке, зокрема, може трапитися, якщо ви не довіряєте джерелу
шаблонів операційних систем.  (Див. L</БЕЗПЕКА> нижче).

=item 4.

Ви не хочете користуватися мережею основної системи (наприклад, через
захищеність або обмеженість середовища у ній).

=back

=item B<-q>

=item B<--quiet>

Не виводити повідомлення до журналу.

Для вмикання ведення докладного журналу окремих дій з файлами скористайтеся
I<-x>.

=item B<--smp> N

Увімкнути N E<ge> 2 віртуальних процесорів для використання у скриптах
I<--run>.

=item B<-v>

=item B<--verbose>

Увімкнути докладний показ повідомлень з метою діагностики.

=item B<-V>

=item B<--version>

Показати дані щодо версії і завершити роботу.

=item B<-x>

Увімкнути трасування викликів програмного інтерфейсу libguestfs.

=back

=head2 Параметри налаштовування

__CUSTOMIZE_OPTIONS__

=head1 SELINUX

Для гостьових систем, у яких використовується SELinux, може знадобитися
спеціальна обробка, якщо використовуються дії, які створюють нові файли або
вносять зміни до наявних файлів.

Докладніший опис наведено у розділі L<virt-builder(1)/SELINUX>.

=head1 СТАН ВИХОДУ

Ця програма повертає 0, якщо роботу виконано успішно, і 1, якщо сталися
помилки.

=head1 ЗМІННІ СЕРЕДОВИЩА

=over 4

=item C<VIRT_TOOLS_DATA_DIR>

Ця змінна визначає каталог, у якому містяться файли даних, які
використовуються для встановлення Windows з першим завантаженням.

Зазвичай, потреби у встановленні власного значення немає. Якщо значення не
встановлено, буде використано вбудоване типове значення (щось схоже на
F</usr/share/virt-tools>).

Цей каталог може містити такі файли:

=over 4

=item F<rhsrvany.exe>

Це виконуваний файл для Windows RHSrvAny, який використовується для
встановлення скрипту «firstboot» у гостьові системи Windows. Він
знадобиться, якщо ви маєте намір використовувати параметри I<--firstboot> і
I<--firstboot-command> для гостьових операційних систем Windows.

Див. також C<https://github.com/rwmjones/rhsrvany>

=item F<pvvxsvc.exe>

Це виконуваний файл Windows, що постачається разом із VMDP SUSE,
використовується для встановлення скрипту «firstboot» у гостьові системи
Windows. Він знадобиться, якщо ви маєте намір використовувати параметри
I<--firstboot> і I<--firstboot-command> для гостьових операційних систем
Windows.

=back

=back

Опис інших змінних середовища наведено у розділі L<guestfs(3)/ENVIRONMENT
VARIABLES>.

=head1 ТАКОЖ ПЕРЕГЛЯНЬТЕ

L<guestfs(3)>, L<guestfish(1)>, L<virt-builder(1)>, L<virt-clone(1)>,
L<virt-rescue(1)>, L<virt-resize(1)>, L<virt-sparsify(1)>,
L<virt-sysprep(1)>, L<virsh(1)>, L<lvcreate(8)>, L<qemu-img(1)>,
L<scrub(1)>, L<http://libguestfs.org/>, L<http://libvirt.org/>.

=head1 АВТОРИ

Richard W.M. Jones L<http://people.redhat.com/~rjones/>

=head1 АВТОРСЬКІ ПРАВА

Copyright (C) 2011-2019 Red Hat Inc.

