.\" Automatically generated by Podwrapper::Man 1.38.2 (Pod::Simple 3.35)
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" Set up some character translations and predefined strings.  \*(-- will
.\" give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
.\" double quote, and \*(R" will give a right double quote.  \*(C+ will
.\" give a nicer C++.  Capital omega is used to do unbreakable dashes and
.\" therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
.\" nothing in troff, for use with C<>.
.tr \(*W-
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.ie n \{\
.    ds -- \(*W-
.    ds PI pi
.    if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.    if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\"  diablo 12 pitch
.    ds L" ""
.    ds R" ""
.    ds C` ""
.    ds C' ""
'br\}
.el\{\
.    ds -- \|\(em\|
.    ds PI \(*p
.    ds L" ``
.    ds R" ''
.    ds C`
.    ds C'
'br\}
.\"
.\" Escape single quotes in literal strings from groff's Unicode transform.
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\"
.\" If the F register is >0, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.SS), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.\"
.\" Avoid warning from groff about undefined register 'F'.
.de IX
..
.nr rF 0
.if \n(.g .if rF .nr rF 1
.if (\n(rF:(\n(.g==0)) \{\
.    if \nF \{\
.        de IX
.        tm Index:\\$1\t\\n%\t"\\$2"
..
.        if !\nF==2 \{\
.            nr % 0
.            nr F 2
.        \}
.    \}
.\}
.rr rF
.\" ========================================================================
.\"
.IX Title "virt-sysprep 1"
.TH virt-sysprep 1 "2018-05-15" "libguestfs-1.38.2" "Virtualization Support"
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.if n .ad l
.nh
.SH "НАЗВА"
.IX Header "НАЗВА"
virt-sysprep — скидання налаштувань віртуальної машини до початкових, так,
щоб з неї можна було роботи клони
.SH "КОРОТКИЙ ОПИС"
.IX Header "КОРОТКИЙ ОПИС"
.Vb 1
\& virt\-sysprep [\-\-параметри] \-d назва_домену
\&
\& virt\-sysprep [\-\-параметри] \-a disk.img [\-a disk.img ...]
.Ve
.SH "ОПИС"
.IX Header "ОПИС"
Virt-sysprep can reset or unconfigure a virtual machine so that clones can
be made from it.  Steps in this process include removing \s-1SSH\s0 host keys,
removing persistent network \s-1MAC\s0 configuration, and removing user accounts.
Virt-sysprep can also customize a virtual machine, for instance by adding
\&\s-1SSH\s0 keys, users or logos.  Each step can be enabled or disabled as required.
.PP
Virt-sysprep modifies the guest or disk image \fIin place\fR.  The guest must
be shut down.  If you want to preserve the existing contents of the guest,
\&\fIyou must snapshot, copy or clone the disk first\fR.  See \*(L"\s-1COPYING AND
CLONING\*(R"\s0 below.
.PP
You do \fInot\fR need to run virt-sysprep as root.  In fact we'd generally
recommend that you don't.  The time you might want to run it as root is when
you need root in order to access the disk image, but even in this case it
would be better to change the permissions on the disk image to be writable
as the non-root user running virt-sysprep.
.PP
\&\*(L"Sysprep\*(R" stands for \*(L"system preparation\*(R" tool.  The name comes from the
Microsoft program \fIsysprep.exe\fR which is used to unconfigure Windows
machines in preparation for cloning them.  Having said that, virt-sysprep
does \fInot\fR currently work on Microsoft Windows guests.  We plan to support
Windows sysprepping in a future version, and we already have code to do it.
.SH "ПАРАМЕТРИ"
.IX Header "ПАРАМЕТРИ"
.IP "\fB\-\-help\fR" 4
.IX Item "--help"
Показати коротку довідку.
.IP "\fB\-a\fR файл" 4
.IX Item "-a файл"
.PD 0
.IP "\fB\-\-add\fR файл" 4
.IX Item "--add файл"
.PD
Додати \fIфайл\fR, який має бути образом диска з віртуальної машини.
.Sp
Формат образу диска визначається автоматично. Щоб перевизначити його і
примусово використати певний формат, скористайтеся параметром \fI\-\-format\fR.
.IP "\fB\-a\fR адреса" 4
.IX Item "-a адреса"
.PD 0
.IP "\fB\-\-add\fR адреса" 4
.IX Item "--add адреса"
.PD
Додати віддалений диск. Формат адреси є сумісним із
guestfish. Див. \*(L"ДОДАВАННЯ ВІДДАЛЕНОГО СХОВИЩА\*(R" in \fBguestfish\fR\|(1).
.IP "\fB\-\-colors\fR" 4
.IX Item "--colors"
.PD 0
.IP "\fB\-\-colours\fR" 4
.IX Item "--colours"
.PD
Використовувати послідовності символів \s-1ANSI\s0 для розфарбовування
повідомлень. Ці послідовності типово використовуються, якщо дані виводяться
на термінал tty.  Якщо дані, виведені програмою, спрямовуються до файла,
послідовності визначення кольорів \s-1ANSI\s0 буде вимкнено, якщо ви не додасте до
команди цей параметр.
.IP "\fB\-c\fR адреса" 4
.IX Item "-c адреса"
.PD 0
.IP "\fB\-\-connect\fR адреса" 4
.IX Item "--connect адреса"
.PD
Якщо використовується libvirt, встановити з’єднання з вказаним \fI\s-1URI\s0\fR. Якщо
пропущено, з’єднання буде встановлено з типовим гіпервізором libvirt.
.Sp
Якщо вказати блокові пристрої гостьових систем безпосередньо (\fI\-a\fR),
libvirt не буде використовуватися взагалі.
.IP "\fB\-d\fR гість" 4
.IX Item "-d гість"
.PD 0
.IP "\fB\-\-domain\fR гість" 4
.IX Item "--domain гість"
.PD
Додати всі диски з вказаної гостьової системи libvirt. \s-1UUID\s0 доменів можна
використовувати замість назв.
.IP "\fB\-n\fR" 4
.IX Item "-n"
.PD 0
.IP "\fB\-\-dry\-run\fR" 4
.IX Item "--dry-run"
.PD
Виконати тестову обробку гостьової системи у режимі «лише читання». Буде
виконано дію sysprep, але наприкінці усі зміни до диска буде відкинуто.
.IP "\fB\-\-enable\fR дії" 4
.IX Item "--enable дії"
Choose which sysprep operations to perform.  Give a comma-separated list of
operations, for example:
.Sp
.Vb 1
\& \-\-enable ssh\-hostkeys,udev\-persistent\-net
.Ve
.Sp
would enable \s-1ONLY\s0 \f(CW\*(C`ssh\-hostkeys\*(C'\fR and \f(CW\*(C`udev\-persistent\-net\*(C'\fR operations.
.Sp
If the \fI\-\-enable\fR option is not given, then we default to trying most
sysprep operations (see \fI\-\-list\-operations\fR to show which are enabled).
.Sp
Regardless of the \fI\-\-enable\fR option, sysprep operations are skipped for
some guest types.
.Sp
Use \fI\-\-list\-operations\fR to list operations supported by a particular
version of virt-sysprep.
.Sp
See \*(L"\s-1OPERATIONS\*(R"\s0 below for a list and an explanation of each operation.
.IP "\fB\-\-operation\fR дії" 4
.IX Item "--operation дії"
.PD 0
.IP "\fB\-\-operations\fR дії" 4
.IX Item "--operations дії"
.PD
Choose which sysprep operations to perform.  Give a comma-separated list of
operations, for example:
.Sp
.Vb 1
\& \-\-operations ssh\-hostkeys,udev\-persistent\-net
.Ve
.Sp
would enable \s-1ONLY\s0 \f(CW\*(C`ssh\-hostkeys\*(C'\fR and \f(CW\*(C`udev\-persistent\-net\*(C'\fR operations.
.Sp
\&\fI\-\-operations\fR allows you to enable and disable any operation, including
the default ones (which would be tried when specifying neither
\&\fI\-\-operations\fR nor \fI\-\-enable\fR) and all the available ones; prepending a
\&\f(CW\*(C`\-\*(C'\fR in front of an operation name removes it from the list of enabled
operations, while the meta-names \f(CW\*(C`defaults\*(C'\fR and \f(CW\*(C`all\*(C'\fR represent
respectively the operations enabled by default and all the available ones.
For example:
.Sp
.Vb 1
\& \-\-operations firewall\-rules,defaults,\-tmp\-files
.Ve
.Sp
would enable the \f(CW\*(C`firewall\-rules\*(C'\fR operation (regardless whether it is
enabled by default), all the default ones, and disable the \f(CW\*(C`tmp\-files\*(C'\fR
operation.
.Sp
\&\fI\-\-operations\fR can be specified multiple times; the first time the set of
enabled operations is empty, while any further \fI\-\-operations\fR affects the
operations enabled so far.
.Sp
If the \fI\-\-operations\fR option is not given, then we default to trying most
sysprep operations (see \fI\-\-list\-operations\fR to show which are enabled).
.Sp
Regardless of the \fI\-\-operations\fR option, sysprep operations are skipped for
some guest types.
.Sp
Use \fI\-\-list\-operations\fR to list operations supported by a particular
version of virt-sysprep.
.Sp
See \*(L"\s-1OPERATIONS\*(R"\s0 below for a list and an explanation of each operation.
.IP "\fB\-\-echo\-keys\fR" 4
.IX Item "--echo-keys"
Типово, якщо virt-sysprep попросить вас ввести ключ або пароль, програма не
відтворюватиме введені символи на екрані. Якщо ви не боїтеся
TEMPEST\-нападів, або у вашій кімнаті нікого, окрім вас, немає, ви можете
скористатися цим прапорцем, щоб бачити, які саме символи ви вводите.
.IP "\fB\-\-format\fR raw|qcow2|.." 4
.IX Item "--format raw|qcow2|.."
.PD 0
.IP "\fB\-\-format\fR auto" 4
.IX Item "--format auto"
.PD
Типовим значенням для параметра \fI\-a\fR є автоматичне визначення формату
образу диска. Використання цього параметра примусово визначає значення
параметрів \fI\-a\fR формату диска у наступному рядку команди. Використання
параметра \fI\-\-format auto\fR перемикає програму у режим автоматичного
визначення у наступних параметрах \fI\-a\fR.
.Sp
Приклад:
.Sp
.Vb 1
\& virt\-sysprep \-\-format raw \-a disk.img
.Ve
.Sp
примусове встановлення формату без обробки (без автоматичного визначення)
для \fIdisk.img\fR.
.Sp
.Vb 1
\& virt\-sysprep \-\-format raw \-a disk.img \-\-format auto \-a another.img
.Ve
.Sp
примусове встановлення формату без обробки (без автоматичного визначення)
для \fIdiskimg\fR і повернення до автоматичного визначення для \fIanother.img\fR.
.Sp
Якщо ви користуєтеся ненадійними образами гостьових систем у необробленому
форматі, вам слід скористатися цим параметром для визначення формату
диска. Таким чином можна уникнути можливих проблем з захистом для
сформованих зловмисниками гостьових систем (\s-1CVE\-2010\-3851\s0).
.IP "\fB\-\-keys\-from\-stdin\fR" 4
.IX Item "--keys-from-stdin"
Прочитати параметри ключа або пароля із джерела стандартного
введення. Типово програма намагається читати паролі від користувача
відкриттям \fI/dev/tty\fR.
.IP "\fB\-\-list\-operations\fR" 4
.IX Item "--list-operations"
List the operations supported by the virt-sysprep program.
.Sp
These are listed one per line, with one or more single-space-separated
fields, eg:
.Sp
.Vb 6
\& $ virt\-sysprep \-\-list\-operations
\& bash\-history * Remove the bash history in the guest
\& cron\-spool * Remove user at\-jobs and cron\-jobs
\& dhcp\-client\-state * Remove DHCP client leases
\& dhcp\-server\-state * Remove DHCP server leases
\& [etc]
.Ve
.Sp
The first field is the operation name, which can be supplied to
\&\fI\-\-enable\fR.  The second field is a \f(CW\*(C`*\*(C'\fR character if the operation is
enabled by default or blank if not.  Subsequent fields on the same line are
the description of the operation.
.Sp
Before libguestfs 1.17.33 only the first (operation name) field was shown
and all operations were enabled by default.
.IP "\fB\-\-mount\-options\fR mp:opts[;mp:opts;...]" 4
.IX Item "--mount-options mp:opts[;mp:opts;...]"
Set the mount options used when libguestfs opens the disk image.  Note this
has no effect on the guest.  It is used when opening certain guests such as
ones using the \s-1UFS\s0 (\s-1BSD\s0) filesystem.
.Sp
Use a semicolon-separated list of \f(CW\*(C`mountpoint:options\*(C'\fR pairs.  You may need
to quote this list to protect it from the shell.
.Sp
Приклад:
.Sp
.Vb 1
\& \-\-mount\-options "/:noatime"
.Ve
.Sp
will mount the root directory with \f(CW\*(C`notime\*(C'\fR.  This example:
.Sp
.Vb 1
\& \-\-mount\-options "/:noatime;/var:rw,nodiratime"
.Ve
.Sp
will do the same, plus mount \fI/var\fR with \f(CW\*(C`rw,nodiratime\*(C'\fR.
.IP "\fB\-q\fR" 4
.IX Item "-q"
.PD 0
.IP "\fB\-\-quiet\fR" 4
.IX Item "--quiet"
.PD
Не виводити повідомлення до журналу.
.Sp
Для вмикання ведення докладного журналу окремих дій з файлами скористайтеся
\&\fI\-x\fR.
.IP "\fB\-\-network\fR" 4
.IX Item "--network"
.PD 0
.IP "\fB\-\-no\-network\fR" 4
.IX Item "--no-network"
.PD
Увімкнути чи вимкнути доступ до мережі для гостьової системи під час
встановлення.
.Sp
In virt-sysprep, the network is \fIdisabled\fR by default.  You must use
\&\fI\-\-network\fR to enable it, in order that options such as \fI\-\-install\fR or
\&\fI\-\-update\fR will work.
.Sp
\&\fBvirt\-builder\fR\|(1) has more information about the security advantages of
disabling the network.
.IP "\fB\-v\fR" 4
.IX Item "-v"
.PD 0
.IP "\fB\-\-verbose\fR" 4
.IX Item "--verbose"
.PD
Увімкнути докладний показ повідомлень з метою діагностики.
.IP "\fB\-V\fR" 4
.IX Item "-V"
.PD 0
.IP "\fB\-\-version\fR" 4
.IX Item "--version"
.PD
Показати дані щодо версії і завершити роботу.
.IP "\fB\-x\fR" 4
.IX Item "-x"
Увімкнути трасування викликів програмного інтерфейсу libguestfs.
.ie n .IP "\fB\-\-append\-line\fR ФАЙЛ:РЯДОК (див. ""customize"" нижче)" 4
.el .IP "\fB\-\-append\-line\fR ФАЙЛ:РЯДОК (див. \f(CWcustomize\fR нижче)" 4
.IX Item "--append-line ФАЙЛ:РЯДОК (див. customize нижче)"
Дописати один рядок тексту до файла \f(CW\*(C`ФАЙЛ\*(C'\fR. Якщо файл ще не завершується
порожнім рядком, такий рядок буде додано перед дописаним. Крім того,
автоматично буде дописано символ нового рядка наприкінці рядка \f(CW\*(C`РЯДОК\*(C'\fR.
.Sp
Наприклад, (припускаємо, що у командній оболонці використовуються звичайні
лапки) така команда:
.Sp
.Vb 1
\& \-\-append\-line \*(Aq/etc/hosts:10.0.0.1 foo\*(Aq
.Ve
.Sp
додасть \f(CW\*(C`10.0.0.1 foo⏎\*(C'\fR або \f(CW\*(C`⏎10.0.0.1 foo⏎\*(C'\fR до файла; останній запис буде
додано, лише якщо наявний файл ще не закінчується символом нового рядка.
.Sp
\&\f(CW\*(C`⏎\*(C'\fR позначає символ нового рядка, конкретне значення якого визначається за
наявним вмістом файла, отже, команда обробляє файли однаково правильно для
варіантів із завершеннями рядка у форматах  Unix і Windows. Це працює і для
порожніх і ще не створених файлів.
.Sp
Щоб додати декілька рядків, скористайтеся тим самим параметром декілька
разів:
.Sp
.Vb 2
\& \-\-append\-line \*(Aq/etc/hosts:10.0.0.1 foo\*(Aq
\& \-\-append\-line \*(Aq/etc/hosts:10.0.0.2 bar\*(Aq
.Ve
.Sp
Щоб додати порожній рядок перед дописаним рядком, скористайтеся такою
конструкцією:
.Sp
.Vb 2
\& \-\-append\-line \*(Aq/etc/hosts:\*(Aq
\& \-\-append\-line \*(Aq/etc/hosts:10.0.0.1 foo\*(Aq
.Ve
.ie n .IP "\fB\-\-chmod\fR ПРАВА_ДОСТУПУ:ФАЙЛ (див. ""customize"" нижче)" 4
.el .IP "\fB\-\-chmod\fR ПРАВА_ДОСТУПУ:ФАЙЛ (див. \f(CWcustomize\fR нижче)" 4
.IX Item "--chmod ПРАВА_ДОСТУПУ:ФАЙЛ (див. customize нижче)"
Змінити права доступу до файла \f(CW\*(C`ФАЙЛ\*(C'\fR на \f(CW\*(C`ПРАВА_ДОСТУПУ\*(C'\fR.
.Sp
\&\fIЗауваження\fR: типово \f(CW\*(C`ПРАВА_ДОСТУПУ\*(C'\fR записуються у десятковому форматі,
якщо ви не додасте початковий \f(CW0\fR , щоб вказати вісімкове число, тобто
скористаєтеся \f(CW0700\fR, а не \f(CW700\fR.
.ie n .IP "\fB\-\-commands\-from\-file\fR НАЗВА_ФАЙЛА (див. ""customize"" нижче)" 4
.el .IP "\fB\-\-commands\-from\-file\fR НАЗВА_ФАЙЛА (див. \f(CWcustomize\fR нижче)" 4
.IX Item "--commands-from-file НАЗВА_ФАЙЛА (див. customize нижче)"
Прочитати команди налаштовування з файла, по одній (разом із аргументами) на
рядок.
.Sp
Кожен рядок містить команду налаштовування та її аргументи, наприклад:
.Sp
.Vb 3
\& delete /якийсь/файл
\& install якийсь_пакунок
\& password якийсь\-користувач:password:його\-новий\-пароль
.Ve
.Sp
Порожні рядки ігноруються, а рядки, що починаються з \f(CW\*(C`#\*(C'\fR, є коментарями і
також ігноруються. Крім того, аргументи можна розділити на декілька рядків
додаванням \f(CW\*(C`\e\*(C'\fR (символу продовження) наприкінці рядка. Приклад:
.Sp
.Vb 2
\& edit /якийсь/файл:\e
\&   s/^OPT=.*/OPT=ok/
.Ve
.Sp
Команди обробляються у тому самому порядку, у якому їх вказано у файлі, так,
наче їх вказано як \fI\-\-delete /якийсь/файл\fR у рядку команди.
.ie n .IP "\fB\-\-copy\fR ДЖЕРЕЛО:ПРИЗНАЧЕННЯ (див. ""customize"" нижче)" 4
.el .IP "\fB\-\-copy\fR ДЖЕРЕЛО:ПРИЗНАЧЕННЯ (див. \f(CWcustomize\fR нижче)" 4
.IX Item "--copy ДЖЕРЕЛО:ПРИЗНАЧЕННЯ (див. customize нижче)"
Копіювати файли або каталоги рекурсивно у межах гостьової системи.
.Sp
Не можна використовувати символи\-замінники.
.ie n .IP "\fB\-\-copy\-in\fR ЛОКАЛЬНИЙ_ШЛЯХ:ВІДДАЛЕНИЙ_КАТАЛОГ (див. ""customize"" нижче)" 4
.el .IP "\fB\-\-copy\-in\fR ЛОКАЛЬНИЙ_ШЛЯХ:ВІДДАЛЕНИЙ_КАТАЛОГ (див. \f(CWcustomize\fR нижче)" 4
.IX Item "--copy-in ЛОКАЛЬНИЙ_ШЛЯХ:ВІДДАЛЕНИЙ_КАТАЛОГ (див. customize нижче)"
Скопіювати локальні файли або каталоги рекурсивно до образу диска,
розташувавши його у каталозі \f(CW\*(C`ВІДДАЛЕНИЙ_КАТАЛОГ\*(C'\fR (який має існувати).
.Sp
Не можна використовувати символи\-замінники.
.ie n .IP "\fB\-\-delete\fR ШЛЯХ (див. ""customize"" нижче)" 4
.el .IP "\fB\-\-delete\fR ШЛЯХ (див. \f(CWcustomize\fR нижче)" 4
.IX Item "--delete ШЛЯХ (див. customize нижче)"
Вилучити файл з гостьової системи. Або вилучити каталог (і увесь його вміст,
рекурсивно).
.Sp
Ви можете скористатися символами\-замінниками у вказаному шляху. Не забудьте
екранувати символи\-замінники у командній оболонці основної системи, якщо це
потрібно. Приклад:
.Sp
.Vb 1
\& virt\-customize \-\-delete \*(Aq/var/log/*.log\*(Aq.
.Ve
.Sp
Див. також \fI\-\-upload\fR, \fI\-\-scrub\fR.
.ie n .IP "\fB\-\-edit\fR ФАЙЛ:ВИРАЗ (див. ""customize"" нижче)" 4
.el .IP "\fB\-\-edit\fR ФАЙЛ:ВИРАЗ (див. \f(CWcustomize\fR нижче)" 4
.IX Item "--edit ФАЙЛ:ВИРАЗ (див. customize нижче)"
Редагувати \f(CW\*(C`ФАЙЛ\*(C'\fR з використанням виразу Perl \f(CW\*(C`ВИРАЗ\*(C'\fR.
.Sp
Слід подбати про належне розставлення лапок у виразі, щоб запобігти його
зміні у командній оболонці.
.Sp
Зауважте, що цим параметром можна буде скористатися, лише якщо встановлено
Perl 5.
.Sp
Див. \*(L"NON-INTERACTIVE \s-1EDITING\*(R"\s0 in \fBvirt\-edit\fR\|(1).
.ie n .IP "\fB\-\-firstboot\fR СКРИПТ (див. ""customize"" нижче)" 4
.el .IP "\fB\-\-firstboot\fR СКРИПТ (див. \f(CWcustomize\fR нижче)" 4
.IX Item "--firstboot СКРИПТ (див. customize нижче)"
Встановити \f(CW\*(C`СКРИПТ\*(C'\fR у гостьовій системі і запустити його під час першого
завантаження гостьової системи (від імені root, у останній частині процесу
завантаження).
.Sp
До скрипту, після встановлення до гостьової системи, буде автоматично
застосовано команду chmod +x.
.Sp
Альтернативна версія \fI\-\-firstboot\-command\fR є такою самою, але зручно
включає команду у однорядковому скрипті.
.Sp
Можна вказати декілька параметрів \fI\-\-firstboot\fR. Їх буде виконано у тому
самому порядку, у якому їх вказано у рядку команди.
.Sp
Будь ласка, зверніться до розділу \*(L"СКРИПТИ ПЕРШОГО
ЗАВАНТАЖЕННЯ\*(R" in \fBvirt\-builder\fR\|(1), щоб ознайомитися із відомостями щодо скриптів першого
завантаження і проблемами у їх використанні.
.Sp
Див. також \fI\-\-run\fR.
.ie n .IP "\fB\-\-firstboot\-command\fR 'КОМАНДА+ПАРАМЕТРИ' (див. ""customize"" нижче)" 4
.el .IP "\fB\-\-firstboot\-command\fR 'КОМАНДА+ПАРАМЕТРИ' (див. \f(CWcustomize\fR нижче)" 4
.IX Item "--firstboot-command 'КОМАНДА+ПАРАМЕТРИ' (див. customize нижче)"
Виконати команду (разом із аргументами) у гостьовій системі під час першого
завантаження гостьової системи (від імені root, у останній частині процесу
завантаження).
.Sp
Можна вказати декілька параметрів \fI\-\-firstboot\fR. Їх буде виконано у тому
самому порядку, у якому їх вказано у рядку команди.
.Sp
Будь ласка, зверніться до розділу \*(L"СКРИПТИ ПЕРШОГО
ЗАВАНТАЖЕННЯ\*(R" in \fBvirt\-builder\fR\|(1), щоб ознайомитися із відомостями щодо скриптів першого
завантаження і проблемами у їх використанні.
.Sp
Див. також \fI\-\-run\fR.
.ie n .IP "\fB\-\-firstboot\-install\fR ПАКУНОК,ПАКУНОК... (див. ""customize"" нижче)" 4
.el .IP "\fB\-\-firstboot\-install\fR ПАКУНОК,ПАКУНОК... (див. \f(CWcustomize\fR нижче)" 4
.IX Item "--firstboot-install ПАКУНОК,ПАКУНОК... (див. customize нижче)"
Встановити іменовані пакунки (список значень, відокремлених комами). Ці
пакунки буде встановлено під час першого завантаження гостьової системи за
допомогою програми для керування пакунків гостьової системи (наприклад, apt,
yum тощо) і з'єднання із мережею гостьової системи.
.Sp
Огляд різних способів встановлення пакунків наведено у розділі
\&\*(L"ВСТАНОВЛЕННЯ ПАКУНКІВ\*(R" in \fBvirt\-builder\fR\|(1).
.ie n .IP "\fB\-\-hostname\fR НАЗВА_ВУЗЛА (див. ""customize"" нижче)" 4
.el .IP "\fB\-\-hostname\fR НАЗВА_ВУЗЛА (див. \f(CWcustomize\fR нижче)" 4
.IX Item "--hostname НАЗВА_ВУЗЛА (див. customize нижче)"
Встановити як назву вузла гостьової системи значення \f(CW\*(C`НАЗВА_ВУЗЛА\*(C'\fR. Якщо
потрібно, можете скористатися форматом із крапкою,
«назва_вузла.назва_домену» (\s-1FQDN\s0).
.ie n .IP "\fB\-\-install\fR ПАКУНОК,ПАКУНОК... (див. ""customize"" нижче)" 4
.el .IP "\fB\-\-install\fR ПАКУНОК,ПАКУНОК... (див. \f(CWcustomize\fR нижче)" 4
.IX Item "--install ПАКУНОК,ПАКУНОК... (див. customize нижче)"
Встановити іменовані пакунки (список значень, відокремлених комами). Ці
пакунки буде встановлено під час збирання образу за допомогою програми для
керування пакунків гостьової системи (наприклад, apt, yum тощо) і з'єднання
із мережею основної системи.
.Sp
Огляд різних способів встановлення пакунків наведено у розділі
\&\*(L"ВСТАНОВЛЕННЯ ПАКУНКІВ\*(R" in \fBvirt\-builder\fR\|(1).
.Sp
Див. також \fI\-\-update\fR, \fI\-\-uninstall\fR.
.ie n .IP "\fB\-\-keep\-user\-accounts\fR КОРИСТУВАЧІ (див. ""user\-account"" нижче)" 4
.el .IP "\fB\-\-keep\-user\-accounts\fR КОРИСТУВАЧІ (див. \f(CWuser\-account\fR нижче)" 4
.IX Item "--keep-user-accounts КОРИСТУВАЧІ (див. user-account нижче)"
Облікові записи користувачів, які слід залишити у гостьовій
системі. Значенням цього параметра є список імен користувачів, відокремлених
комами, який визначатиме ті записи, які слід зберегти. Приклад:
.Sp
.Vb 1
\& \-\-keep\-user\-accounts mary
.Ve
.Sp
збереже обліковий запис користувача \f(CW\*(C`mary\*(C'\fR.
.Sp
Цей параметр можна вказувати декілька разів у одній команді.
.ie n .IP "\fB\-\-link\fR TARGET:LINK[:LINK..] (see ""customize"" below)" 4
.el .IP "\fB\-\-link\fR TARGET:LINK[:LINK..] (see \f(CWcustomize\fR below)" 4
.IX Item "--link TARGET:LINK[:LINK..] (see customize below)"
Створити символічне посилання або декілька посилань у гостьовій системі так,
щоб вони з \f(CW\*(C`ПОСИЛАННЯ\*(C'\fR вказували на \f(CW\*(C`ПРИЗНАЧЕННЯ\*(C'\fR.
.ie n .IP "\fB\-\-mkdir\fR КАТАЛОГ (див. ""customize"" нижче)" 4
.el .IP "\fB\-\-mkdir\fR КАТАЛОГ (див. \f(CWcustomize\fR нижче)" 4
.IX Item "--mkdir КАТАЛОГ (див. customize нижче)"
Створити каталог у гостьовій системі.
.Sp
Використовується \f(CW\*(C`mkdir \-p\*(C'\fR, отже буде створено усі проміжні
каталоги. Також команда працює, якщо каталог вже існує.
.ie n .IP "\fB\-\-move\fR ДЖЕРЕЛО:ПРИЗНАЧЕННЯ (див. ""customize"" нижче)" 4
.el .IP "\fB\-\-move\fR ДЖЕРЕЛО:ПРИЗНАЧЕННЯ (див. \f(CWcustomize\fR нижче)" 4
.IX Item "--move ДЖЕРЕЛО:ПРИЗНАЧЕННЯ (див. customize нижче)"
Пересунути файли або каталоги у межах гостьової системи.
.Sp
Не можна використовувати символи\-замінники.
.ie n .IP "\fB\-\-no\-logfile\fR (див. ""customize"" нижче)" 4
.el .IP "\fB\-\-no\-logfile\fR (див. \f(CWcustomize\fR нижче)" 4
.IX Item "--no-logfile (див. customize нижче)"
Витерти \f(CW\*(C`builder.log\*(C'\fR (файл журналу із командами збирання) з образу після
завершення збирання. Якщо ви не хочете явним чином показувати, як було
зібрано образ, скористайтеся цим параметром.
.Sp
Див. також \*(L"\s-1LOG FILE\*(R"\s0.
.ie n .IP "\fB\-\-password\fR КОРИСТУВАЧ:ВАРІАНТ (див. ""customize"" нижче)" 4
.el .IP "\fB\-\-password\fR КОРИСТУВАЧ:ВАРІАНТ (див. \f(CWcustomize\fR нижче)" 4
.IX Item "--password КОРИСТУВАЧ:ВАРІАНТ (див. customize нижче)"
Встановити пароль для користувача \f(CW\*(C`КОРИСТУВАЧ\*(C'\fR. (Зауважте, що за допомогою
цього параметра \fIне можна\fR створювати облікові записи користувачів.)
.Sp
Формат поля \f(CW\*(C`ВАРІАНТ\*(C'\fR та способи налаштовування облікових записів
користувачів описано у розділі \*(L"КОРИСТУВАЧІ І ПАРОЛІ\*(R" in \fBvirt\-builder\fR\|(1).
.ie n .IP "\fB\-\-password\-crypto\fR md5|sha256|sha512 (див. ""customize"" нижче)" 4
.el .IP "\fB\-\-password\-crypto\fR md5|sha256|sha512 (див. \f(CWcustomize\fR нижче)" 4
.IX Item "--password-crypto md5|sha256|sha512 (див. customize нижче)"
Якщо змінюється чи встановлюється пароль для гостьової системи, за допомогою
цього параметра можна встановити шифрування для цього пароля у значення
\&\f(CW\*(C`md5\*(C'\fR, \f(CW\*(C`sha256\*(C'\fR або \f(CW\*(C`sha512\*(C'\fR.
.Sp
Для використання значень \f(CW\*(C`sha256\*(C'\fR та \f(CW\*(C`sha512\*(C'\fR має бути встановлено glibc
≥ 2.7 (перевірте у \fBcrypt\fR\|(3) всередині гостьової системи).
.Sp
\&\f(CW\*(C`md5\*(C'\fR працюватиме з відносно давніми гостьовими системами Linux
(наприкладRHEL 3), але є незахищеним щодо новітніх способів атак.
.Sp
Типовим способом шифрування є \f(CW\*(C`sha512\*(C'\fR. Він використовується, якщо
libguestfs вдасться виявити у гостьовій системі підтримку \s-1SHA\-512.\s0 Якщо
такої підтримки не буде виявлено, використовуватиметься \f(CW\*(C`md5\*(C'\fR. За допомогою
цього параметра ви можете перевизначити автоматично визначений libguestfs
спосіб шифрування.
.Sp
Зауважте, що це не змінить типового шифрування, яке використовується
гостьовою системою, коли ви створюєте у ній нові облікові записи
користувачів. Якщо ви хочете змінити це шифрування, вам слід скористатися
параметром \fI\-\-edit\fR для внесення змін до \f(CW\*(C`/etc/sysconfig/authconfig\*(C'\fR
(Fedora, \s-1RHEL\s0) або \f(CW\*(C`/etc/pam.d/common\-password\*(C'\fR (Debian, Ubuntu).
.ie n .IP "\fB\-\-remove\-user\-accounts\fR КОРИСТУВАЧІ (див. ""user\-account"" нижче)" 4
.el .IP "\fB\-\-remove\-user\-accounts\fR КОРИСТУВАЧІ (див. \f(CWuser\-account\fR нижче)" 4
.IX Item "--remove-user-accounts КОРИСТУВАЧІ (див. user-account нижче)"
Облікові записи користувачів, які слід вилучити з гостьової
системи. Значенням цього параметра є список імен користувачів, відокремлених
комами, який визначатиме ті записи, які слід вилучити. Приклад:
.Sp
.Vb 1
\& \-\-remove\-user\-accounts bob,eve
.Ve
.Sp
вилучить лише облікові записи користувачів \f(CW\*(C`bob\*(C'\fR та \f(CW\*(C`eve\*(C'\fR.
.Sp
Цей параметр можна вказувати декілька разів у одній команді.
.ie n .IP "\fB\-\-root\-password\fR ВАРІАНТ (див. ""customize"" нижче)" 4
.el .IP "\fB\-\-root\-password\fR ВАРІАНТ (див. \f(CWcustomize\fR нижче)" 4
.IX Item "--root-password ВАРІАНТ (див. customize нижче)"
Встановити пароль користувача root.
.Sp
Формат поля \f(CW\*(C`ВАРІАНТ\*(C'\fR та способи налаштовування облікових записів
користувачів описано у розділі \*(L"КОРИСТУВАЧІ І ПАРОЛІ\*(R" in \fBvirt\-builder\fR\|(1).
.Sp
Зауваження: якщо у virt-builder ви \fIне встановите\fR \fI\-\-root\-password\fR, для
гостьової системи буде використано \fIвипадковий\fR пароль root.
.ie n .IP "\fB\-\-run\fR СКРИПТ (див. ""customize"" нижче)" 4
.el .IP "\fB\-\-run\fR СКРИПТ (див. \f(CWcustomize\fR нижче)" 4
.IX Item "--run СКРИПТ (див. customize нижче)"
Виконати скрипт оболонки (або будь\-яку програму), яка називається \f(CW\*(C`СКРИПТ\*(C'\fR
у образі диска. Скрипт буде запущено у віртуалізованому режимі у малій
допоміжній системі, у пісочниці гостьової файлової системи.
.Sp
Для скрипта буде автоматично використано команду chmod +x.
.Sp
Якщо у libguestfs передбачено підтримку цього, буде доступним обмежене
мережеве з'єднання, але лише для вихідних з'єднань. Ви також можете долучати
диски з даними (наприклад, файли \s-1ISO\s0), як ще один спосіб надання даних
(наприклад, пакунків із програмним забезпеченням) для скрипту без потреби у
з'єднанні із мережею (\fI\-\-attach\fR). Також ви можете вивантажувати файли з
даними (\fI\-\-upload\fR).
.Sp
Можна вказати декілька параметрів \fI\-\-run\fR. Їх буде виконано у тому самому
порядку, у якому їх вказано у рядку команди.
.Sp
Див. також \fI\-\-firstboot\fR, \fI\-\-attach\fR, \fI\-\-upload\fR.
.ie n .IP "\fB\-\-run\-command\fR 'КОМАНДА+ПАРАМЕТРИ' (див. ""customize"" нижче)" 4
.el .IP "\fB\-\-run\-command\fR 'КОМАНДА+ПАРАМЕТРИ' (див. \f(CWcustomize\fR нижче)" 4
.IX Item "--run-command 'КОМАНДА+ПАРАМЕТРИ' (див. customize нижче)"
Виконати команду із аргументами у образі диска. Команду буде виконано у
віртуалізованому режимі у малій допоміжній системі, у пісочниці гостьової
файлової системи.
.Sp
Якщо у libguestfs передбачено підтримку цього, буде доступним обмежене
мережеве з'єднання, але лише для вихідних з'єднань. Ви також можете долучати
диски з даними (наприклад, файли \s-1ISO\s0), як ще один спосіб надання даних
(наприклад, пакунків із програмним забезпеченням) для скрипту без потреби у
з'єднанні із мережею (\fI\-\-attach\fR). Також ви можете вивантажувати файли з
даними (\fI\-\-upload\fR).
.Sp
Можна вказати декілька параметрів \fI\-\-run\-command\fR. Їх буде виконано у тому
самому порядку, у якому їх вказано у рядку команди.
.Sp
Див. також \fI\-\-firstboot\fR, \fI\-\-attach\fR, \fI\-\-upload\fR.
.ie n .IP "\fB\-\-script\fR СКРИПТ (див. ""script"" нижче)" 4
.el .IP "\fB\-\-script\fR СКРИПТ (див. \f(CWscript\fR нижче)" 4
.IX Item "--script СКРИПТ (див. script нижче)"
Запустити вказаний \f(CW\*(C`СКРИПТ\*(C'\fR (скрипт оболонки або програму) над
гостьовою системою. Скриптом може бути будь\-яка програма у
основній системі. Поточним каталогом скрипту буде кореневий
каталог гостьової системи.
.Sp
\&\fBНотатка:\fR якщо скрипт не перебуває у каталозі \f(CW$PATH\fR, вам слід вказати шлях
до скрипту повністю.
.ie n .IP "\fB\-\-scriptdir\fR КАТАЛОГ_СКРИПТІВ (див. ""script"" нижче)" 4
.el .IP "\fB\-\-scriptdir\fR КАТАЛОГ_СКРИПТІВ (див. \f(CWscript\fR нижче)" 4
.IX Item "--scriptdir КАТАЛОГ_СКРИПТІВ (див. script нижче)"
Точку монтування (порожній каталог на вузлі), використану при виконанні дії
\&\f(CW\*(C`script\*(C'\fR, увімкнено і вказано використання одного або декількох скриптів за
допомогою \fI\-\-script\fR.
.Sp
\&\fBЗауваження:\fR \f(CW\*(C`SCRIPTDIR\*(C'\fR \fBмає\fR бути вказано повністю.
.Sp
Якщо \fI\-\-scriptdir\fR не вказано, буде створено тимчасову точку монтування
.ie n .IP "\fB\-\-scrub\fR ФАЙЛ (див. ""customize"" нижче)" 4
.el .IP "\fB\-\-scrub\fR ФАЙЛ (див. \f(CWcustomize\fR нижче)" 4
.IX Item "--scrub ФАЙЛ (див. customize нижче)"
Витерти файл з гостьової системи. Подібне до \fI\-\-delete\fR, окрім того, що:
.RS 4
.IP "\(bu" 4
Витирає дані так, що їх не можна буде відновити з гостьової системи.
.IP "\(bu" 4
Не може вилучати каталоги, лише звичайні файли.
.RE
.RS 4
.RE
.ie n .IP "\fB\-\-selinux\-relabel\fR (див. ""customize"" нижче)" 4
.el .IP "\fB\-\-selinux\-relabel\fR (див. \f(CWcustomize\fR нижче)" 4
.IX Item "--selinux-relabel (див. customize нижче)"
Повторно встановити мітки для файлів у гостьовій системі так, щоб вони були
правильними з точки зору SELinux.
.Sp
Якщо буде використано цей параметр, програма спробує змінити мітки файлів
негайно, але якщо цього зробити не вдасться, вона змінить часову мітку файла
\&\fI/.autorelabel\fR на образі, щоб дію зі зміни міток було заплановано на
наступне завантаження образу.
.Sp
Вам слід використовувати цей параметр лише для гостьових систем із
підтримкою SELinux.
.ie n .IP "\fB\-\-sm\-attach\fR ВАРІАНТ (див. ""customize"" нижче)" 4
.el .IP "\fB\-\-sm\-attach\fR ВАРІАНТ (див. \f(CWcustomize\fR нижче)" 4
.IX Item "--sm-attach ВАРІАНТ (див. customize нижче)"
Долучити систему до буфера передплати за допомогою \f(CW\*(C`subscription\-manager\*(C'\fR.
.Sp
Формат поля \f(CW\*(C`ВАРІАНТ\*(C'\fR описано у розділі
\&\*(L"SUBSCRIPTION-MANAGER\*(R" in \fBvirt\-builder\fR\|(1).
.ie n .IP "\fB\-\-sm\-credentials\fR ВАРІАНТ (див. ""customize"" нижче)" 4
.el .IP "\fB\-\-sm\-credentials\fR ВАРІАНТ (див. \f(CWcustomize\fR нижче)" 4
.IX Item "--sm-credentials ВАРІАНТ (див. customize нижче)"
Встановити реєстраційні дані для \f(CW\*(C`subscription\-manager\*(C'\fR.
.Sp
Формат поля \f(CW\*(C`ВАРІАНТ\*(C'\fR описано у розділі
\&\*(L"SUBSCRIPTION-MANAGER\*(R" in \fBvirt\-builder\fR\|(1).
.ie n .IP "\fB\-\-sm\-register\fR (див. ""customize"" нижче)" 4
.el .IP "\fB\-\-sm\-register\fR (див. \f(CWcustomize\fR нижче)" 4
.IX Item "--sm-register (див. customize нижче)"
Зареєструвати гостьову систему за допомогою \f(CW\*(C`subscription\-manager\*(C'\fR.
.Sp
Потребує встановлення реєстраційних даних за допомогою \fI\-\-sm\-credentials\fR.
.ie n .IP "\fB\-\-sm\-remove\fR (див. ""customize"" нижче)" 4
.el .IP "\fB\-\-sm\-remove\fR (див. \f(CWcustomize\fR нижче)" 4
.IX Item "--sm-remove (див. customize нижче)"
Вилучити усі передплати з гостьової системи за допомогою
\&\f(CW\*(C`subscription\-manager\*(C'\fR.
.ie n .IP "\fB\-\-sm\-unregister\fR (див. ""customize"" нижче)" 4
.el .IP "\fB\-\-sm\-unregister\fR (див. \f(CWcustomize\fR нижче)" 4
.IX Item "--sm-unregister (див. customize нижче)"
Зняти гостьову систему з реєстрації за допомогою \f(CW\*(C`subscription\-manager\*(C'\fR.
.ie n .IP "\fB\-\-ssh\-inject\fR КОРИСТУВАЧ[:ВАРІАНТ] (див. ""customize"" нижче)" 4
.el .IP "\fB\-\-ssh\-inject\fR КОРИСТУВАЧ[:ВАРІАНТ] (див. \f(CWcustomize\fR нижче)" 4
.IX Item "--ssh-inject КОРИСТУВАЧ[:ВАРІАНТ] (див. customize нижче)"
Вставити ключ ssh так, щоб вказаний \f(CW\*(C`КОРИСТУВАЧ\*(C'\fR зміг увійти до системи з
використанням ssh без потреби у визначенні пароля. Запис користувача
\&\f(CW\*(C`КОРИСТУВАЧ\*(C'\fR має вже існувати у гостьовій системі.
.Sp
Формат поля \f(CW\*(C`ВАРІАНТ\*(C'\fR описано у розділі \*(L"КЛЮЧІ \s-1SSH\*(R"\s0 in \fBvirt\-builder\fR\|(1).
.Sp
Ви можете додати декілька параметрів \fI\-\-ssh\-inject\fR для різних
користувачів, а також для додавання декількох ключів для кожного з
користувачів.
.ie n .IP "\fB\-\-timezone\fR ЧАСОВИЙ_ПОЯС (див. ""customize"" нижче)" 4
.el .IP "\fB\-\-timezone\fR ЧАСОВИЙ_ПОЯС (див. \f(CWcustomize\fR нижче)" 4
.IX Item "--timezone ЧАСОВИЙ_ПОЯС (див. customize нижче)"
Встановити типовий часовий пояс гостьової системи у значення
\&\f(CW\*(C`ЧАСОВИЙ_ПОЯС\*(C'\fR. Скористайтеся рядком місця у форматі \f(CW\*(C`Europe/London\*(C'\fR
.ie n .IP "\fB\-\-touch\fR ФАЙЛ (див. ""customize"" нижче)" 4
.el .IP "\fB\-\-touch\fR ФАЙЛ (див. \f(CWcustomize\fR нижче)" 4
.IX Item "--touch ФАЙЛ (див. customize нижче)"
Ця команда виконує подібну до \fBtouch\fR\|(1) дію над файлом \f(CW\*(C`ФАЙЛ\*(C'\fR.
.ie n .IP "\fB\-\-truncate\fR ФАЙЛ (див. ""customize"" нижче)" 4
.el .IP "\fB\-\-truncate\fR ФАЙЛ (див. \f(CWcustomize\fR нижче)" 4
.IX Item "--truncate ФАЙЛ (див. customize нижче)"
Ця команда обрізає файл \f(CW\*(C`ФАЙЛ\*(C'\fR до нульової довжини. Для її успішного
виконання файл має існувати.
.ie n .IP "\fB\-\-truncate\-recursive\fR ШЛЯХ (див. ""customize"" нижче)" 4
.el .IP "\fB\-\-truncate\-recursive\fR ШЛЯХ (див. \f(CWcustomize\fR нижче)" 4
.IX Item "--truncate-recursive ШЛЯХ (див. customize нижче)"
Ця команда рекурсивно обрізає усі файли у каталозі \f(CW\*(C`ШЛЯХ\*(C'\fR до нульової
довжини.
.ie n .IP "\fB\-\-uninstall\fR ПАКУНОК,ПАКУНОК... (див. ""customize"" нижче)" 4
.el .IP "\fB\-\-uninstall\fR ПАКУНОК,ПАКУНОК... (див. \f(CWcustomize\fR нижче)" 4
.IX Item "--uninstall ПАКУНОК,ПАКУНОК... (див. customize нижче)"
Вилучити іменовані пакунки (список значень, відокремлених комами). Ці
пакунки буде вилучено під час збирання образу за допомогою програми для
керування пакунків гостьової системи (наприклад, apt, yum тощо). З метою
виконання запиту також може бути вилучено пакунки, залежні від вилучених
пакунків.
.Sp
Див. також \fI\-\-install\fR, \fI\-\-update\fR.
.ie n .IP "\fB\-\-update\fR (див. ""customize"" нижче)" 4
.el .IP "\fB\-\-update\fR (див. \f(CWcustomize\fR нижче)" 4
.IX Item "--update (див. customize нижче)"
Виконує еквівалент \f(CW\*(C`yum update\*(C'\fR, \f(CW\*(C`apt\-get upgrade\*(C'\fR або якоїсь іншої
команди, яка потрібна для оновлення пакунків, які вже встановлено у шаблоні,
до найсвіжіших версій.
.Sp
Див. також \fI\-\-install\fR, \fI\-\-uninstall\fR.
.ie n .IP "\fB\-\-upload\fR ФАЙЛ:ПРИЗНАЧЕННЯ (див. ""customize"" нижче)" 4
.el .IP "\fB\-\-upload\fR ФАЙЛ:ПРИЗНАЧЕННЯ (див. \f(CWcustomize\fR нижче)" 4
.IX Item "--upload ФАЙЛ:ПРИЗНАЧЕННЯ (див. customize нижче)"
Вивантажити локальний файл \f(CW\*(C`ФАЙЛ\*(C'\fR до призначення \f(CW\*(C`ПРИЗНАЧЕННЯ\*(C'\fR на образі
диска. Буде збережено власника і права доступу, отже вам слід вказати такі
значення для цих параметрів, які мають бути на остаточному образі диска.
.Sp
Значенням параметра \f(CW\*(C`ПРИЗНАЧЕННЯ\*(C'\fR може бути назва остаточного файла. Цим
можна скористатися для перейменовування файла під час вивантаження.
.Sp
Якщо значенням параметра \f(CW\*(C`ПРИЗНАЧЕННЯ\*(C'\fR є назва каталогу (який вже має
існувати у гостьовій системі), файл буде вивантажено до вказаного каталогу,
назву файла з локальної файлової системи буде збережено.
.Sp
Див. також \fI\-\-mkdir\fR, \fI\-\-delete\fR, \fI\-\-scrub\fR.
.ie n .IP "\fB\-\-write\fR ФАЙЛ:ВМІСТ (див. ""customize"" нижче)" 4
.el .IP "\fB\-\-write\fR ФАЙЛ:ВМІСТ (див. \f(CWcustomize\fR нижче)" 4
.IX Item "--write ФАЙЛ:ВМІСТ (див. customize нижче)"
Записати \f(CW\*(C`ДАНІ\*(C'\fR до файла \f(CW\*(C`ФАЙЛ\*(C'\fR.
.SH "ДІЇ"
.IX Header "ДІЇ"
If the \fI\-\-enable\fR/\fI\-\-operations\fR option is \fInot\fR given, then most sysprep
operations are enabled.
.PP
Use \f(CW\*(C`virt\-sysprep \-\-list\-operations\*(C'\fR to list all operations for your
virt-sysprep binary.  The ones which are enabled by default are marked with
a \f(CW\*(C`*\*(C'\fR character.  Regardless of the \fI\-\-enable\fR/\fI\-\-operations\fR options,
sysprep operations are skipped for some guest types.
.PP
Operations can be individually enabled using the \fI\-\-enable\fR/\fI\-\-operations\fR
options.  Use a comma-separated list, for example:
.PP
.Vb 1
\& virt\-sysprep \-\-operations ssh\-hostkeys,udev\-persistent\-net [тощо..]
.Ve
.PP
Future versions of virt-sysprep may add more operations.  If you are using
virt-sysprep and want predictable behaviour, specify only the operations
that you want to have enabled.
.PP
\&\f(CW\*(C`*\*(C'\fR = enabled by default when no \fI\-\-enable\fR/\fI\-\-operations\fR option is
given.
.SS "\fBabrt-data\fP *"
.IX Subsection "abrt-data *"
Вилучити дані щодо аварії, створені \s-1ABRT.\s0
.PP
Вилучити автоматично створені \s-1ABRT\s0 дані щодо аварії у \f(CW\*(C`/var/spool/abrt/\*(C'\fR.
.SS "\fBbackup-files\fP *"
.IX Subsection "backup-files *"
Вилучити файли резервних копій редактора з гостьової системи.
.PP
Вказані нижче файли буде вилучено з усіх каталогів файлової системи
гостьової операційної системи:
.IP "·" 4
*.bak
.IP "·" 4
*~
.PP
У операційних системах Linux та Unix оброблятимуться лише такі файлові
системи:
.IP "·" 4
/etc
.IP "·" 4
/root
.IP "·" 4
/srv
.IP "·" 4
/tmp
.IP "·" 4
/var
.SS "\fBbash-history\fP *"
.IX Subsection "bash-history *"
Вилучити журнал команд bash у гостьовій системі.
.PP
Вилучити журнал команд bash користувача «root» та всіх інших користувачів, у
домашніх каталогах яких містяться файли \f(CW\*(C`.bash_history\*(C'\fR.
.PP
\fINotes on bash-history\fR
.IX Subsection "Notes on bash-history"
.PP
У поточній версії пошук домашніх каталогів користувачів виконується лише у
\&\f(CW\*(C`/root\*(C'\fR і \f(CW\*(C`/home/*\*(C'\fR. Отже, журнал bash користувачів, дані яких
зберігаються у інших каталогах, не буде вилучено.
.SS "\fBblkid-tab\fP *"
.IX Subsection "blkid-tab *"
Вилучити вкладку ідентифікаторів блоків у гостьовій системі.
.SS "\fBca-certificates\fP"
.IX Subsection "ca-certificates"
Вилучити сертифікати \s-1CA\s0 у гостьовій системі.
.SS "\fBcrash-data\fP *"
.IX Subsection "crash-data *"
Вилучити дані щодо аварії, створені kexec-tools.
.PP
Вилучити автоматично створені kdump дані аварії ядра.
.SS "\fBcron-spool\fP *"
.IX Subsection "cron-spool *"
Вилучити завдання at та cron користувачів.
.SS "\fBcustomize\fP *"
.IX Subsection "customize *"
Налаштувати гостьову систему.
.PP
Налаштувати гостьову систему визначенням параметрів \fBvirt\-customize\fR\|(1) для
встановлення пакунків, редагування файлів тощо.
.SS "\fBdhcp-client-state\fP *"
.IX Subsection "dhcp-client-state *"
Вилучити надані клієнтські адреси \s-1DHCP.\s0
.SS "\fBdhcp-server-state\fP *"
.IX Subsection "dhcp-server-state *"
Вилучити надані серверні адреси \s-1DHCP.\s0
.SS "\fBdovecot-data\fP *"
.IX Subsection "dovecot-data *"
Вилучити дані Dovecot (поштового сервера).
.SS "\fBfirewall-rules\fP"
.IX Subsection "firewall-rules"
Вилучити правила брандмауера.
.PP
Вилучає нетипові правила брандмауера вилученням \f(CW\*(C`/etc/sysconfig/iptables\*(C'\fR
або нетипових налаштувань firewalld з \f(CW\*(C`/etc/firewalld/*/*\*(C'\fR.
.PP
Зауважте, що цю можливість типово \fIне\fR увімкнено, оскільки може відкрити
гостьову систему для вразливостей. Користуйтеся обережно.
.SS "\fBflag-reconfiguration\fP"
.IX Subsection "flag-reconfiguration"
Позначити систему для зміни налаштувань.
.PP
Для гостьових систем Linux оновлює часову позначку \f(CW\*(C`/.unconfigured\*(C'\fR, отже,
під час першого завантаження користувачеві буде надіслано запит щодо
параметрів, зокрема пароля root та часового поясу.
.SS "\fBfs-uuids\fP"
.IX Subsection "fs-uuids"
Змінити \s-1UUID\s0 файлових систем.
.PP
У гостьових системах та типах файлових систем, де передбачено таку
підтримку, буде створено нові випадкові \s-1UUID,\s0 які буде пов’язано з файловими
системами.
.PP
\fIЗауваження щодо fs-uuids\fR
.IX Subsection "Зауваження щодо fs-uuids"
.PP
Типово, дію fs-uuids вимкнено, оскільки у поточній версії програма ще не
здатна знайти і оновити усі записи у гостьовій системі, які використовують
\&\s-1UUID,\s0 наприклад \f(CW\*(C`/etc/fstab\*(C'\fR або завантажувач. Вмикання цієї дії може з
високою ймовірністю зробити вашу гостьову систему непридатною до
завантаження.
.PP
Див. https://bugzilla.redhat.com/show_bug.cgi?id=991641
.SS "\fBдані\-kerberos\fP"
.IX Subsection "дані-kerberos"
Вилучити дані Kerberos у гостьовій системі.
.SS "\fBlogfiles\fP *"
.IX Subsection "logfiles *"
Вилучити з гостьової системи багато файлів журналів.
.PP
У Linux вилучено такі файли:
.IP "·" 4
/etc/Pegasus/*.cnf
.IP "·" 4
/etc/Pegasus/*.crt
.IP "·" 4
/etc/Pegasus/*.csr
.IP "·" 4
/etc/Pegasus/*.pem
.IP "·" 4
/etc/Pegasus/*.srl
.IP "·" 4
/root/anaconda\-ks.cfg
.IP "·" 4
/root/anaconda\-post.log
.IP "·" 4
/root/initial\-setup\-ks.cfg
.IP "·" 4
/root/install.log
.IP "·" 4
/root/install.log.syslog
.IP "·" 4
/root/original\-ks.cfg
.IP "·" 4
/var/cache/fontconfig/*
.IP "·" 4
/var/cache/gdm/*
.IP "·" 4
/var/cache/man/*
.IP "·" 4
/var/lib/AccountService/users/*
.IP "·" 4
/var/lib/fprint/*
.IP "·" 4
/var/lib/logrotate.status
.IP "·" 4
/var/log/*.log*
.IP "·" 4
/var/log/BackupPC/LOG
.IP "·" 4
/var/log/ConsoleKit/*
.IP "·" 4
/var/log/anaconda.syslog
.IP "·" 4
/var/log/anaconda/*
.IP "·" 4
/var/log/apache2/*_log
.IP "·" 4
/var/log/apache2/*_log\-*
.IP "·" 4
/var/log/apt/*
.IP "·" 4
/var/log/aptitude*
.IP "·" 4
/var/log/audit/*
.IP "·" 4
/var/log/btmp*
.IP "·" 4
/var/log/ceph/*.log
.IP "·" 4
/var/log/chrony/*.log
.IP "·" 4
/var/log/cron*
.IP "·" 4
/var/log/cups/*_log*
.IP "·" 4
/var/log/debug*
.IP "·" 4
/var/log/dmesg*
.IP "·" 4
/var/log/exim4/*
.IP "·" 4
/var/log/faillog*
.IP "·" 4
/var/log/firewalld*
.IP "·" 4
/var/log/gdm/*
.IP "·" 4
/var/log/glusterfs/*glusterd.vol.log
.IP "·" 4
/var/log/glusterfs/glusterfs.log
.IP "·" 4
/var/log/grubby*
.IP "·" 4
/var/log/httpd/*log
.IP "·" 4
/var/log/installer/*
.IP "·" 4
/var/log/jetty/jetty\-console.log
.IP "·" 4
/var/log/journal/*
.IP "·" 4
/var/log/lastlog*
.IP "·" 4
/var/log/libvirt/libvirtd.log
.IP "·" 4
/var/log/libvirt/libxl/*.log
.IP "·" 4
/var/log/libvirt/lxc/*.log
.IP "·" 4
/var/log/libvirt/qemu/*.log
.IP "·" 4
/var/log/libvirt/uml/*.log
.IP "·" 4
/var/log/lightdm/*
.IP "·" 4
/var/log/mail/*
.IP "·" 4
/var/log/maillog*
.IP "·" 4
/var/log/messages*
.IP "·" 4
/var/log/ntp
.IP "·" 4
/var/log/ntpstats/*
.IP "·" 4
/var/log/ppp/connect\-errors
.IP "·" 4
/var/log/rhsm/*
.IP "·" 4
/var/log/sa/*
.IP "·" 4
/var/log/secure*
.IP "·" 4
/var/log/setroubleshoot/*.log
.IP "·" 4
/var/log/spooler*
.IP "·" 4
/var/log/squid/*.log
.IP "·" 4
/var/log/syslog*
.IP "·" 4
/var/log/tallylog*
.IP "·" 4
/var/log/tuned/tuned.log
.IP "·" 4
/var/log/wtmp*
.IP "·" 4
/var/log/xferlog*
.IP "·" 4
/var/named/data/named.run
.SS "\fBlvm-uuids\fP *"
.IX Subsection "lvm-uuids *"
Змінити \s-1UUID\s0 ФТ і ГТ \s-1LVM2.\s0
.PP
Для гостьових систем Linux, які містять фізичні томи (ФТ) або групи томів
(ГТ) \s-1LVM2\s0 для ФТ і ГТ буде створено і призначено випадкові \s-1UUID.\s0
.SS "\fBід\-комп’ютера\fP *"
.IX Subsection "ід-комп’ютера *"
Вилучити ідентифікатор локального комп’ютера.
.PP
Зазвичай, ідентифікатор системи створюється на основі випадкових джерел
даних під час встановлення системи і не змінюється під час всіх наступних її
завантажень. За потреби у системах без певного стану цей ідентифікатор
створюється під час роботи завантажувача,
якщо буде виявлено порожнє значення.
.SS "\fBmail-spool\fP *"
.IX Subsection "mail-spool *"
Вилучити поштове повідомлення з локального каталогу поштового буфера.
.SS "\fBnet-hostname\fP *"
.IX Subsection "net-hostname *"
Вилучити \s-1HOSTNAME\s0 та \s-1DHCP_HOSTNAME\s0 у налаштуваннях інтерфейсу мережі.
.PP
Для Fedora і Red Hat Enterprise Linux це вилучається з файлів \f(CW\*(C`ifcfg\-*\*(C'\fR.
.SS "\fBnet-hwaddr\fP *"
.IX Subsection "net-hwaddr *"
Вилучити налаштування \s-1HWADDR\s0 (апаратної адреси \s-1MAC\s0).
.PP
Для Fedora і Red Hat Enterprise Linux це вилучається з файлів \f(CW\*(C`ifcfg\-*\*(C'\fR.
.SS "\fBpacct-log\fP *"
.IX Subsection "pacct-log *"
Вилучити файли журналу обліку процесів.
.PP
Дані обліку процесів системи будуть зберігатися у файлах журналу pacct, якщо
увімкнено облік процесів.
.SS "\fBpackage-manager-cache\fP *"
.IX Subsection "package-manager-cache *"
Вилучити кеш керування пакунками.
.SS "\fBpam-data\fP *"
.IX Subsection "pam-data *"
Вилучити дані \s-1PAM\s0 у гостьовій системі.
.SS "\fBpasswd-backups\fP *"
.IX Subsection "passwd-backups *"
Вилучити /etc/passwd\- та подібні файли резервних копій.
.PP
У Linux вилучено такі файли:
.IP "·" 4
/etc/group\-
.IP "·" 4
/etc/gshadow\-
.IP "·" 4
/etc/passwd\-
.IP "·" 4
/etc/shadow\-
.IP "·" 4
/etc/subgid\-
.IP "·" 4
/etc/subuid\-
.SS "\fBpuppet-data-log\fP *"
.IX Subsection "puppet-data-log *"
Вилучити дані та файли журналів puppet.
.SS "\fBrh-subscription-manager\fP *"
.IX Subsection "rh-subscription-manager *"
Вилучити файли керування передплатою \s-1RH.\s0
.SS "\fBrhn-systemid\fP *"
.IX Subsection "rhn-systemid *"
Вилучити ідентифікатор системи у \s-1RHN.\s0
.SS "\fBrpm-db\fP *"
.IX Subsection "rpm-db *"
Вилучити специфічні для системи файли баз даних \s-1RPM.\s0
.PP
Вилучити специфічні для системи файли баз даних \s-1RPM. RPM\s0 буде повторно
створено ці файли, якщо це потрібно.
.SS "\fBsamba-db-log\fP *"
.IX Subsection "samba-db-log *"
Вилучити бази даних та файли журналів Samba.
.SS "\fBscript\fP *"
.IX Subsection "script *"
Запустити довільні скрипти дій над гостьовою системою.
.PP
The \f(CW\*(C`script\*(C'\fR module lets you run arbitrary shell scripts or programs
against the guest.
.PP
Зауважте, що використання цієї можливості потребує підтримки \s-1FUSE.\s0 Вам варто
увімкнути цю підтримку у вашій основній системі, наприклад, додаванням
поточного користувача до групи \f(CW\*(C`fuse\*(C'\fR або завантаженням модуля ядра.
.PP
Use one or more \fI\-\-script\fR parameters to specify scripts or programs that
will be run against the guest.
.PP
The script or program is run with its current directory being the guest’s
root directory, so relative paths should be used.  For example: \f(CW\*(C`rm
etc/resolv.conf\*(C'\fR in the script would remove a Linux guest’s \s-1DNS\s0
configuration file, but \f(CW\*(C`rm /etc/resolv.conf\*(C'\fR would (try to) remove the
host’s file.
.PP
Normally a temporary mount point for the guest is used, but you can choose a
specific one by using the \fI\-\-scriptdir\fR parameter.
.PP
\&\fBNote:\fR This is different from \fI\-\-firstboot\fR scripts (which run in the
context of the guest when it is booting first time).  \fI\-\-script\fR scripts
run on the host, not in the guest.
.SS "\fBsmolt-uuid\fP *"
.IX Subsection "smolt-uuid *"
Вилучити \s-1UUID\s0 обладнання Smolt.
.SS "\fBssh-hostkeys\fP *"
.IX Subsection "ssh-hostkeys *"
Вилучити ключі вузла \s-1SSH\s0 у гостьовій системі.
.PP
Ключі вузла \s-1SSH\s0 повторно створюються (незалежно) під час наступного
завантаження гостьової системи.
.PP
Якщо після клонування гостьова система отримати ту саму IP\-адресу, ssh
надасть вам додаткове попередження щодо зміни ключа вузла:
.PP
.Vb 4
\& @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
\& @    WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED!     @
\& @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
\& IT IS POSSIBLE THAT SOMEONE IS DOING SOMETHING NASTY!
.Ve
.SS "\fBssh-userdir\fP *"
.IX Subsection "ssh-userdir *"
Вилучити каталоги «.ssh» у гостьовій системі.
.PP
Вилучити каталог \f(CW\*(C`.ssh\*(C'\fR користувача «root» та всіх інших користувачів,
домашні каталоги яких містять каталог \f(CW\*(C`.ssh\*(C'\fR.
.PP
\fIЗауваження щодо ssh-userdir\fR
.IX Subsection "Зауваження щодо ssh-userdir"
.PP
У поточній версії пошук домашніх каталогів користувачів виконується лише у
\&\f(CW\*(C`/root\*(C'\fR і \f(CW\*(C`/home/*\*(C'\fR. Отже, файли ssh користувачів, дані яких зберігаються
у інших каталогах, не буде вилучено.
.SS "\fBsssd-db-log\fP *"
.IX Subsection "sssd-db-log *"
Вилучити бази даних і файли журналів sssd.
.SS "\fBtmp-files\fP *"
.IX Subsection "tmp-files *"
Вилучити тимчасові файли.
.PP
Вилучає тимчасові файли з \f(CW\*(C`/tmp\*(C'\fR і \f(CW\*(C`/var/tmp\*(C'\fR.
.SS "\fBudev-persistent-net\fP *"
.IX Subsection "udev-persistent-net *"
Вилучити постійні правила мережі udev.
.PP
Вилучити постійні правила мережі udev, які відображають вже створену
MAC\-адресу гостьової системи на фіксований пристрій ethernet (наприклад
eth0).
.PP
Після клонування гостьової системи MAC\-адреса зазвичай змінюється. Оскільки
стару MAC\-адресу вже пов’язано зі старою назвою (наприклад eth0), це
означає, що нову MAC\-адресу буде пов’язано з новою назвою (наприклад eth1),
а це зазвичай є небажаним. За допомогою вилучення постійних правил мережі
udev цьому можна запобігти.
.SS "\fBuser-account\fP"
.IX Subsection "user-account"
Вилучити облікові записи користувачів у гостьовій системі.
.PP
Типово вилучити всі облікові записи користувачів та відповідні домашні
каталоги. Обліковий запис «root» вилучено не буде.
.PP
Див. опис параметра \fI\-\-remove\-user\-accounts\fR, щоб дізнатися про те, як
наказати
програмі вилучити лише деяких з користувачів і не вилучати інших.
.SS "\fButmp\fP *"
.IX Subsection "utmp *"
Вилучити файл utmp.
.PP
У цьому файлі зберігаються записи щодо входу користувачів до машини. У
сучасних дистрибутивах Linux ці записи зберігаються на диску у пам’яті, тому
не є частиною віртуальної машини на диску, але ці дані зберігаються на диску
у старіших версіях дистрибутивів.
.SS "\fByum-uuid\fP *"
.IX Subsection "yum-uuid *"
Вилучити \s-1UUID\s0 yum.
.PP
Yum створить новий \s-1UUID\s0 під час наступного запуску, коли виявить, що
початковий \s-1UUID\s0 було вилучено.
.SH "КОПІЮВАННЯ ТА КЛОНУВАННЯ"
.IX Header "КОПІЮВАННЯ ТА КЛОНУВАННЯ"
Virt-sysprep can be used as part of a process of cloning guests, or to
prepare a template from which guests can be cloned.  There are many
different ways to achieve this using the virt tools, and this section is
just an introduction.
.PP
A virtual machine (when switched off) consists of two parts:
.IP "\fIналаштування\fR" 4
.IX Item "налаштування"
The configuration or description of the guest.  eg. The libvirt \s-1XML\s0 (see
\&\f(CW\*(C`virsh dumpxml\*(C'\fR), the running configuration of the guest, or another
external format like \s-1OVF.\s0
.Sp
Some configuration items that might need to be changed:
.RS 4
.IP "\(bu" 4
назва
.IP "\(bu" 4
\&\s-1UUID\s0
.IP "\(bu" 4
шлях до блокових пристроїв
.IP "\(bu" 4
MAC\-адреса мережевої картки
.RE
.RS 4
.RE
.IP "\fIблокові пристрої\fR" 4
.IX Item "блокові пристрої"
One or more hard disk images, themselves containing files, directories,
applications, kernels, configuration, etc.
.Sp
Ось деякі параметри всередині блокових пристроїв, які, можливо, доведеться
змінити:
.RS 4
.IP "\(bu" 4
назва вузла та інші налаштування мережі
.IP "\(bu" 4
\&\s-1UUID\s0
.IP "\(bu" 4
ключі \s-1SSH\s0 вузла
.IP "\(bu" 4
Windows unique security \s-1ID\s0 (\s-1SID\s0)
.IP "\(bu" 4
Реєстрація маріонетки
.RE
.RS 4
.RE
.SS "КОПІЮВАННЯ БЛОКОВОГО ПРИСТРОЮ"
.IX Subsection "КОПІЮВАННЯ БЛОКОВОГО ПРИСТРОЮ"
Starting with an original guest, you probably wish to copy the guest block
device and its configuration to make a template.  Then once you are happy
with the template, you will want to make many clones from it.
.PP
.Vb 7
\&                        virt\-sysprep
\&                             |
\&                             v
\& original guest \-\-\-\-\-\-\-\-> template \-\-\-\-\-\-\-\-\-\->
\&                                      \e\-\-\-\-\-\-> cloned
\&                                       \e\-\-\-\-\-> guests
\&                                        \e\-\-\-\->
.Ve
.PP
You can, of course, just copy the block device on the host using \fBcp\fR\|(1) or
\&\fBdd\fR\|(1).
.PP
.Vb 5
\&                   dd                 dd
\& original guest \-\-\-\-\-\-\-\-> template \-\-\-\-\-\-\-\-\-\->
\&                                      \e\-\-\-\-\-\-> cloned
\&                                       \e\-\-\-\-\-> guests
\&                                        \e\-\-\-\->
.Ve
.PP
There are some smarter (and faster) ways too:
.PP
.Vb 5
\&                          snapshot
\&                template \-\-\-\-\-\-\-\-\-\->
\&                            \e\-\-\-\-\-\-> cloned
\&                             \e\-\-\-\-\-> guests
\&                              \e\-\-\-\->
.Ve
.PP
You may want to run virt-sysprep twice, once to reset the guest (to make a
template) and a second time to customize the guest for a specific user:
.PP
.Vb 6
\&                    virt\-sysprep        virt\-sysprep
\&                      (reset)      (add user, keys, logos)
\&                         |                   |
\&                 dd      v          dd       v
\& original guest \-\-\-\-> template \-\-\-\-\-\-\-\-\-> copied \-\-\-\-\-\-> custom
\&                                          template       guest
.Ve
.IP "\(bu" 4
Create a snapshot using qemu-img:
.Sp
.Vb 1
\& qemu\-img create \-f qcow2 \-o backing_file=original snapshot.qcow
.Ve
.Sp
The advantage is that you don’t need to copy the original (very fast)  and
only changes are stored (less storage required).
.Sp
Note that writing to the backing file once you have created guests on top of
it is not possible: you will corrupt the guests.
.IP "\(bu" 4
Create a snapshot using \f(CW\*(C`lvcreate \-\-snapshot\*(C'\fR.
.IP "\(bu" 4
Other ways to create snapshots include using filesystems-level tools (for
filesystems such as btrfs).
.Sp
Most Network Attached Storage (\s-1NAS\s0) devices can also create cheap snapshots
from files or LUNs.
.IP "\(bu" 4
Get your \s-1NAS\s0 to duplicate the \s-1LUN.\s0  Most \s-1NAS\s0 devices can also duplicate LUNs
very cheaply (they copy them on-demand in the background).
.IP "\(bu" 4
Приготуйте ваш шаблон за допомогою \fBvirt\-sparsify\fR\|(1). Див. нижче.
.SS "VIRT-CLONE"
.IX Subsection "VIRT-CLONE"
A separate tool, \fBvirt\-clone\fR\|(1), can be used to duplicate the block device
and/or modify the external libvirt configuration of a guest.  It will reset
the name, \s-1UUID\s0 and \s-1MAC\s0 address of the guest in the libvirt \s-1XML.\s0
.PP
\&\fBvirt\-clone\fR\|(1) does not use libguestfs and cannot look inside the disk
image.  This was the original motivation to write virt-sysprep.
.SS "\s-1SPARSIFY\s0"
.IX Subsection "SPARSIFY"
.Vb 2
\&              virt\-sparsify
\& original guest \-\-\-\-\-\-\-\-> template
.Ve
.PP
\&\fBvirt\-sparsify\fR\|(1) can be used to make the cloning template smaller, making
it easier to compress and/or faster to copy.
.PP
Notice that since virt-sparsify also copies the image, you can use it to
make the initial copy (instead of \f(CW\*(C`dd\*(C'\fR).
.SS "ЗМІНА РОЗМІРІВ"
.IX Subsection "ЗМІНА РОЗМІРІВ"
.Vb 5
\&                         virt\-resize
\&                template \-\-\-\-\-\-\-\-\-\->
\&                            \e\-\-\-\-\-\-> cloned
\&                             \e\-\-\-\-\-> guests
\&                              \e\-\-\-\->
.Ve
.PP
If you want to give people cloned guests, but let them pick the size of the
guest themselves (eg. depending on how much they are prepared to pay for
disk space), then instead of copying the template, you can run
\&\fBvirt\-resize\fR\|(1).  Virt-resize performs a copy and resize, and thus is
ideal for cloning guests from a template.
.SH "FIRSTBOOT VS SCRIPT"
.IX Header "FIRSTBOOT VS SCRIPT"
The two options \fI\-\-firstboot\fR and \fI\-\-script\fR both supply shell scripts
that are run against the guest.  However these two options are significantly
different.
.PP
\&\fI\-\-firstboot script\fR uploads the file \f(CW\*(C`script\*(C'\fR into the guest and arranges
that it will run, in the guest, when the guest is next booted.  (The script
will only run once, at the \*(L"first boot\*(R").
.PP
\&\fI\-\-script script\fR runs the shell \f(CW\*(C`script\*(C'\fR \fIon the host\fR, with its current
directory inside the guest filesystem.
.PP
If you needed, for example, to \f(CW\*(C`yum install\*(C'\fR new packages, then you \fImust
not\fR use \fI\-\-script\fR for this, since that would (a) run the \f(CW\*(C`yum\*(C'\fR command
on the host and (b) wouldn't have access to the same resources
(repositories, keys, etc.) as the guest.  Any command that needs to run on
the guest \fImust\fR be run via \fI\-\-firstboot\fR.
.PP
On the other hand if you need to make adjustments to the guest filesystem
(eg. copying in files), then \fI\-\-script\fR is ideal since (a)  it has access
to the host filesystem and (b) you will get immediate feedback on errors.
.PP
Кожен з параметрів або обидва параметри можна використовувати у рядку
команди довільну кількість разів.
.SH "БЕЗПЕКА"
.IX Header "БЕЗПЕКА"
Although virt-sysprep removes some sensitive information from the guest, it
does not pretend to remove all of it.  You should examine the \*(L"\s-1OPERATIONS\*(R"\s0
above and the guest afterwards.
.PP
Sensitive files are simply removed.  The data they contained may still exist
on the disk, easily recovered with a hex editor or undelete tool.  The
\&\fI\-\-scrub\fR option can be used to scrub files instead of just deleting them.
\&\fBvirt\-sparsify\fR\|(1) is another way to remove this content.  See also the
\&\fBscrub\fR\|(1) command to get rid of deleted content in directory entries and
inodes.
.SS "БАЗА ВИПАДКОВОСТІ"
.IX Subsection "БАЗА ВИПАДКОВОСТІ"
\&\fI(Цей розділ стосується лише гостьових систем Linux)\fR
.PP
For supported guests, virt-sysprep writes a few bytes of randomness from the
host into the guest’s random seed file.
.PP
If this is just done once and the guest is cloned from the same template,
then each guest will start with the same entropy, and things like \s-1SSH\s0 host
keys and \s-1TCP\s0 sequence numbers may be predictable.
.PP
Therefore you should arrange to add more randomness \fIafter\fR cloning from a
template too, which can be done by enabling just the customize module:
.PP
.Vb 2
\& cp template.img newguest.img
\& virt\-sysprep \-\-enable customize \-a newguest.img
.Ve
.SH "SELINUX"
.IX Header "SELINUX"
Для гостьових систем, у яких використовується SELinux, може знадобитися
спеціальна обробка, якщо використовуються дії, які створюють нові файли або
вносять зміни до наявних файлів.
.PP
Докладніший опис наведено у розділі \*(L"\s-1SELINUX\*(R"\s0 in \fBvirt\-builder\fR\|(1).
.SH "WINDOWS 8"
.IX Header "WINDOWS 8"
Windows 8 \*(L"fast startup\*(R" can prevent virt-sysprep from working.  See
\&\*(L"\s-1WINDOWS HIBERNATION AND WINDOWS 8 FAST STARTUP\*(R"\s0 in \fBguestfs\fR\|(3).
.SH "СТАН ВИХОДУ"
.IX Header "СТАН ВИХОДУ"
Ця програма повертає 0, якщо роботу виконано успішно, і 1, якщо сталися
помилки.
.SH "ЗМІННІ СЕРЕДОВИЩА"
.IX Header "ЗМІННІ СЕРЕДОВИЩА"
.ie n .IP """VIRT_TOOLS_DATA_DIR""" 4
.el .IP "\f(CWVIRT_TOOLS_DATA_DIR\fR" 4
.IX Item "VIRT_TOOLS_DATA_DIR"
Ця змінна визначає каталог, у якому містяться файли даних, які
використовуються для встановлення Windows з першим завантаженням.
.Sp
Зазвичай, потреби у встановленні власного значення немає. Якщо значення не
встановлено, буде використано вбудоване типове значення (щось схоже на
\&\fI/usr/share/virt\-tools\fR).
.Sp
Цей каталог може містити такі файли:
.RS 4
.IP "\fIrhsrvany.exe\fR" 4
.IX Item "rhsrvany.exe"
Це виконуваний файл для Windows RHSrvAny, який використовується для
встановлення скрипту «firstboot» у гостьові системи Windows. Він
знадобиться, якщо ви маєте намір використовувати параметри \fI\-\-firstboot\fR і
\&\fI\-\-firstboot\-command\fR для гостьових операційних систем Windows.
.Sp
Див. також \f(CW\*(C`https://github.com/rwmjones/rhsrvany\*(C'\fR
.IP "\fIpvvxsvc.exe\fR" 4
.IX Item "pvvxsvc.exe"
Це виконуваний файл Windows, що постачається разом із \s-1VMDP SUSE,\s0
використовується для встановлення скрипту «firstboot» у гостьові системи
Windows. Він знадобиться, якщо ви маєте намір використовувати параметри
\&\fI\-\-firstboot\fR і \fI\-\-firstboot\-command\fR для гостьових операційних систем
Windows.
.RE
.RS 4
.RE
.PP
Опис інших змінних середовища наведено у розділі \*(L"\s-1ENVIRONMENT
VARIABLES\*(R"\s0 in \fBguestfs\fR\|(3).
.SH "ТАКОЖ ПЕРЕГЛЯНЬТЕ"
.IX Header "ТАКОЖ ПЕРЕГЛЯНЬТЕ"
\&\fBguestfs\fR\|(3), \fBguestfish\fR\|(1), \fBvirt\-builder\fR\|(1), \fBvirt\-clone\fR\|(1),
\&\fBvirt\-customize\fR\|(1), \fBvirt\-rescue\fR\|(1), \fBvirt\-resize\fR\|(1),
\&\fBvirt\-sparsify\fR\|(1), \fBvirsh\fR\|(1), \fBlvcreate\fR\|(8), \fBqemu\-img\fR\|(1),
\&\fBscrub\fR\|(1), http://libguestfs.org/, http://libvirt.org/.
.SH "АВТОРИ"
.IX Header "АВТОРИ"
Richard W.M. Jones http://people.redhat.com/~rjones/
.PP
Wanlong Gao, Fujitsu Ltd.
.SH "АВТОРСЬКІ ПРАВА"
.IX Header "АВТОРСЬКІ ПРАВА"
Copyright (C) 2011\-2018 Red Hat Inc.
.PP
Авторські права належать Fujitsu Ltd., 2012
.SH "LICENSE"
.IX Header "LICENSE"
This program is free software; you can redistribute it and/or modify it
under the terms of the \s-1GNU\s0 General Public License as published by the
Free Software Foundation; either version 2 of the License, or (at your
option) any later version.
.PP
This program is distributed in the hope that it will be useful, but
\&\s-1WITHOUT ANY WARRANTY\s0; without even the implied warranty of
\&\s-1MERCHANTABILITY\s0 or \s-1FITNESS FOR A PARTICULAR PURPOSE.\s0  See the \s-1GNU\s0
General Public License for more details.
.PP
You should have received a copy of the \s-1GNU\s0 General Public License along
with this program; if not, write to the Free Software Foundation, Inc.,
51 Franklin Street, Fifth Floor, Boston, \s-1MA 02110\-1301 USA.\s0
.SH "BUGS"
.IX Header "BUGS"
To get a list of bugs against libguestfs, use this link:
https://bugzilla.redhat.com/buglist.cgi?component=libguestfs&product=Virtualization+Tools
.PP
To report a new bug against libguestfs, use this link:
https://bugzilla.redhat.com/enter_bug.cgi?component=libguestfs&product=Virtualization+Tools
.PP
When reporting a bug, please supply:
.IP "\(bu" 4
The version of libguestfs.
.IP "\(bu" 4
Where you got libguestfs (eg. which Linux distro, compiled from source, etc)
.IP "\(bu" 4
Describe the bug accurately and give a way to reproduce it.
.IP "\(bu" 4
Run \fBlibguestfs\-test\-tool\fR\|(1) and paste the \fBcomplete, unedited\fR
output into the bug report.
