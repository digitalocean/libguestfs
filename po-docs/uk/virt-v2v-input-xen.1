.\" Automatically generated by Podwrapper::Man 1.40.2 (Pod::Simple 3.35)
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" Set up some character translations and predefined strings.  \*(-- will
.\" give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
.\" double quote, and \*(R" will give a right double quote.  \*(C+ will
.\" give a nicer C++.  Capital omega is used to do unbreakable dashes and
.\" therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
.\" nothing in troff, for use with C<>.
.tr \(*W-
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.ie n \{\
.    ds -- \(*W-
.    ds PI pi
.    if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.    if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\"  diablo 12 pitch
.    ds L" ""
.    ds R" ""
.    ds C` ""
.    ds C' ""
'br\}
.el\{\
.    ds -- \|\(em\|
.    ds PI \(*p
.    ds L" ``
.    ds R" ''
.    ds C`
.    ds C'
'br\}
.\"
.\" Escape single quotes in literal strings from groff's Unicode transform.
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\"
.\" If the F register is >0, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.SS), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.\"
.\" Avoid warning from groff about undefined register 'F'.
.de IX
..
.nr rF 0
.if \n(.g .if rF .nr rF 1
.if (\n(rF:(\n(.g==0)) \{\
.    if \nF \{\
.        de IX
.        tm Index:\\$1\t\\n%\t"\\$2"
..
.        if !\nF==2 \{\
.            nr % 0
.            nr F 2
.        \}
.    \}
.\}
.rr rF
.\" ========================================================================
.\"
.IX Title "virt-v2v-input-xen 1"
.TH virt-v2v-input-xen 1 "2019-02-07" "libguestfs-1.40.2" "Virtualization Support"
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.if n .ad l
.nh
.SH "НАЗВА"
.IX Header "НАЗВА"
virt\-v2v\-input\-xen \- Using virt\-v2v to convert guests from Xen
.SH "КОРОТКИЙ ОПИС"
.IX Header "КОРОТКИЙ ОПИС"
.Vb 2
\& export LIBGUESTFS_BACKEND=direct
\& virt\-v2v \-ic \*(Aqxen+ssh://root@xen.example.com\*(Aq GUEST_NAME [\-o* options]
.Ve
.SH "ОПИС"
.IX Header "ОПИС"
This page documents how to use \fBvirt\-v2v\fR\|(1) to convert guests from \s-1RHEL 5\s0
Xen, or \s-1SLES\s0 and OpenSUSE Xen hosts.
.SH "ВХІДНІ ДАНІ З XEN"
.IX Header "ВХІДНІ ДАНІ З XEN"
.SS "Set up ssh-agent access to Xen host"
.IX Subsection "Set up ssh-agent access to Xen host"
У поточній версії вам слід уможливити безпарольний доступ \s-1SSH\s0 до віддаленого
вузла Xen з боку сервера перетворення virt\-v2v.
.PP
Вам також слід скористатися ssh-agent і додати ваш відкритий ключ ssh до
\&\fI/root/.ssh/authorized_keys\fR (на вузлі Xen).
.PP
Після налаштовування вам слід перевірити працездатність безпарольного
доступу з боку сервера virt\-v2v на вузлі Xen. Приклад:
.PP
.Vb 2
\& $ ssh root@xen.example.com
\& [ журналювання безпосередньо до оболонки, пароль не потрібен ]
.Ve
.PP
Зауважте, що підтримки інтерактивного режиму введення пароля та доступу за
допомогою Kerberos \fBне\fR передбачено. Вам \fBдоведеться\fR налаштувати доступ
ssh за допомогою ssh-agent і authorized_keys.
.PP
У деяких сучасних реалізаціях ssh застарілі правила шифрування, потрібні для
взаємодії із sshd \s-1RHEL 5\s0 вимкнено. Щоб увімкнути ці правила у вас може
виникнути потреба у запуску вказаної нижче команди на сервері перетворення
(тобто клієнті ssh), втім, спочатку ознайомтеся зі сторінкою підручника щодо
\&\fBupdate\-crypto\-policies\fR\|(8):
.PP
.Vb 1
\& # update\-crypto\-policies LEGACY
.Ve
.SS "Test libvirt connection to remote Xen host"
.IX Subsection "Test libvirt connection to remote Xen host"
Скористайтеся командою \fBvirsh\fR\|(1) для отримання списку гостьових систем на
віддаленому вузлі Xen:
.PP
.Vb 5
\& $ virsh \-c xen+ssh://root@xen.example.com list \-\-all
\&  Id    Name                           State
\& \-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-
\&  0     Domain\-0                       running
\&  \-     rhel49\-x86_64\-pv               shut off
.Ve
.PP
Крім того, вам слід спробувати створити дамп метаданих з будь\-якої гостьової
системи на вашому сервері, ось так:
.PP
.Vb 5
\& $ virsh \-c xen+ssh://root@xen.example.com dumpxml rhel49\-x86_64\-pv
\& <domain type=\*(Aqxen\*(Aq>
\&   <name>rhel49\-x86_64\-pv</name>
\&   [...]
\& </domain>
.Ve
.PP
\&\fBЯкщо наведені вище команди не дають бажаного результату, virt\-v2v також не
працюватиме\fR.  Перш ніж продовжувати, виправте ваші налаштування на
віддаленому сервері.
.PP
\&\fBIf the guest disks are located on a host block device\fR, then the
conversion will fail.  See \*(L"Xen or ssh conversions from block devices\*(R"
below for a workaround.
.SS "Importing a guest"
.IX Subsection "Importing a guest"
Щоб імпортувати певну гостьову систему з сервера Xen, віддайте такі команди:
.PP
.Vb 4
\& $ LIBGUESTFS_BACKEND=direct \e
\&       virt\-v2v \-ic \*(Aqxen+ssh://root@xen.example.com\*(Aq \e
\&           rhel49\-x86_64\-pv \e
\&           \-o local \-os /var/tmp
.Ve
.PP
де \f(CW\*(C`rhel49\-x86_64\-pv\*(C'\fR — назва гостьової системи (яку має бути вимкнено).
.PP
У цьому випадку прапорці виведення встановлено так, щоб перетворена гостьова
система записувалася до тимчасового каталогу, оскільки це лише приклад, але
ви також можете записати перетворену систему до libvirt або будь\-якого
іншого підтримуваного призначення.
.PP
Встановлення для модуля значення \f(CW\*(C`direct\*(C'\fR є тимчасовим
обхідним заходом, доки не буде виправлено ваду libvirt
1140166.
.SS "Xen or ssh conversions from block devices"
.IX Subsection "Xen or ssh conversions from block devices"
У поточній версії virt\-v2v не може безпосередньо отримувати доступ до
гостьової системи Xen (або будь\-якої іншої гостьової системи, доступ до якої
здійснюється віддалено за допомогою ssh), якщо диски цієї гостьової системи
розташовано на блокових пристроях основної системи.
.PP
Щоб визначити, чи використовує гостьова система Xen блокові пристрої
основної системи, зверніться до вмісту \s-1XML\s0 гостьової системи. Там ви
побачите таке:
.PP
.Vb 3
\&  <disk type=\*(Aqblock\*(Aq device=\*(Aqdisk\*(Aq>
\&    ...
\&    <source dev=\*(Aq/dev/VG/guest\*(Aq/>
.Ve
.PP
де \f(CW\*(C`type=\*(Aqblock\*(Aq\*(C'\fR, \f(CW\*(C`source dev=\*(C'\fR і \f(CW\*(C`/dev/...\*(C'\fR усі вказують на тек, що
диск розташовано на блоковому пристрої основної системи.
.PP
Причиною проблем є те, що драйвер блокових пристроїв із доступом за
допомогою ssh у qemu, яким ми користуємося для доступу до віддалених дисків,
використовує протокол sftp ssh, а цей протокол не може правильно визначати
розмір блокових пристроїв основної системи.
.PP
Обійти проблему можна скопіювавши гостьову систему на сервер перетворення за
допомогою окремої програми \fBvirt\-v2v\-copy\-to\-local\fR\|(1), а потім запустивши
virt\-v2v. Вам знадобиться достатньо вільного місця на дисках сервера
перетворення, щоб зберегти повну копію гостьової системи.
.PP
.Vb 3
\& virt\-v2v\-copy\-to\-local \-ic xen+ssh://root@xen.example.com guest
\& virt\-v2v \-i libvirtxml guest.xml \-o local \-os /var/tmp
\& rm guest.xml guest\-disk*
.Ve
.SH "ТАКОЖ ПЕРЕГЛЯНЬТЕ"
.IX Header "ТАКОЖ ПЕРЕГЛЯНЬТЕ"
\&\fBvirt\-v2v\fR\|(1).
.SH "АВТОР"
.IX Header "АВТОР"
Richard W.M. Jones
.SH "АВТОРСЬКІ ПРАВА"
.IX Header "АВТОРСЬКІ ПРАВА"
Copyright (C) 2009\-2019 Red Hat Inc.
.SH "LICENSE"
.IX Header "LICENSE"
.SH "BUGS"
.IX Header "BUGS"
To get a list of bugs against libguestfs, use this link:
https://bugzilla.redhat.com/buglist.cgi?component=libguestfs&product=Virtualization+Tools
.PP
To report a new bug against libguestfs, use this link:
https://bugzilla.redhat.com/enter_bug.cgi?component=libguestfs&product=Virtualization+Tools
.PP
When reporting a bug, please supply:
.IP "\(bu" 4
The version of libguestfs.
.IP "\(bu" 4
Where you got libguestfs (eg. which Linux distro, compiled from source, etc)
.IP "\(bu" 4
Describe the bug accurately and give a way to reproduce it.
.IP "\(bu" 4
Run \fBlibguestfs\-test\-tool\fR\|(1) and paste the \fBcomplete, unedited\fR
output into the bug report.
