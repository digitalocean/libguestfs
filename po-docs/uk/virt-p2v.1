.\" Automatically generated by Podwrapper::Man 1.40.2 (Pod::Simple 3.35)
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" Set up some character translations and predefined strings.  \*(-- will
.\" give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
.\" double quote, and \*(R" will give a right double quote.  \*(C+ will
.\" give a nicer C++.  Capital omega is used to do unbreakable dashes and
.\" therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
.\" nothing in troff, for use with C<>.
.tr \(*W-
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.ie n \{\
.    ds -- \(*W-
.    ds PI pi
.    if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.    if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\"  diablo 12 pitch
.    ds L" ""
.    ds R" ""
.    ds C` ""
.    ds C' ""
'br\}
.el\{\
.    ds -- \|\(em\|
.    ds PI \(*p
.    ds L" ``
.    ds R" ''
.    ds C`
.    ds C'
'br\}
.\"
.\" Escape single quotes in literal strings from groff's Unicode transform.
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\"
.\" If the F register is >0, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.SS), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.\"
.\" Avoid warning from groff about undefined register 'F'.
.de IX
..
.nr rF 0
.if \n(.g .if rF .nr rF 1
.if (\n(rF:(\n(.g==0)) \{\
.    if \nF \{\
.        de IX
.        tm Index:\\$1\t\\n%\t"\\$2"
..
.        if !\nF==2 \{\
.            nr % 0
.            nr F 2
.        \}
.    \}
.\}
.rr rF
.\" ========================================================================
.\"
.IX Title "virt-p2v 1"
.TH virt-p2v 1 "2019-02-07" "libguestfs-1.40.2" "Virtualization Support"
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.if n .ad l
.nh
.SH "НАЗВА"
.IX Header "НАЗВА"
virt\-p2v — перетворення фізичної машини для використання \s-1KVM\s0
.SH "КОРОТКИЙ ОПИС"
.IX Header "КОРОТКИЙ ОПИС"
.Vb 1
\& virt\-p2v
\&
\& virt\-p2v.iso
.Ve
.SH "ОПИС"
.IX Header "ОПИС"
Virt\-p2v перетворює фізичну машину для запуску віртуалізованою у \s-1KVM,\s0 під
керуванням libvirt, OpenStack, oVirt, Red Hat Virtualisation (\s-1RHV\s0) або одним
із інших призначень, підтримку яких передбачено у \fBvirt\-v2v\fR\|(1).
.PP
Зазвичай, потреби у безпосередньому запуску програми virt\-p2v немає. Замість
цього, вам слід завантажити фізичну машину за допомогою придатного до
завантаження компакт\-диска, \s-1ISO\s0 або образу \s-1PXE.\s0 Цей придатний до
завантаження образ містить виконуваний файл virt\-p2v і запускає його
автоматично. Завантаження з компакт\-диска або іншого носія є обов'язковим,
оскільки диски, які перетворюватимуться, мають бути статичними. Перетворення
активної фізичної машини не є безпечним, оскільки під час створення образу
інші програми можуть вносити до нього зміни.
.PP
Цю сторінку підручника присвячено документуванню використання програми
virt\-p2v. Щоб створити придатний до завантаження образ, вам слід
скористатися \fBvirt\-p2v\-make\-disk\fR\|(1) або \fBvirt\-p2v\-make\-kickstart\fR\|(1).
.SH "НАЛАШТОВУВАННЯ МЕРЕЖІ"
.IX Header "НАЛАШТОВУВАННЯ МЕРЕЖІ"
Virt\-p2v працюватиме над фізичною машиною, яку ви хочете
перетворити. Програма має обмінюватися даними із іншим сервером, який
називається «сервером перетворення» і на якому має бути встановлено
\&\fBvirt\-v2v\fR\|(1). Обмін даними із сервером перетворення завжди
виконуватиметься за допомогою \s-1SSH:\s0
.PP
.Vb 5
\& ┌──────────────┐                  ┌─────────────────┐
\& │ virt\-p2v     │                  │ virt\-v2v        │
\& │ (фізичний    │  з\*(Aqєднання ssh    │ (сервер         │
\& │  сервер)   ╍╍╍╍╍╍╍╍╍╍╍╍╍╍╍╍╍╍╍╍╍╍╍▶ перетворення)  │
\& └──────────────┘                  └─────────────────┘
.Ve
.PP
Програма virt\-v2v на сервері перетворення виконає саме перетворення
(перетворення машини з фізичної на віртуальну і з віртуальної машини на
віртуальну достатньо подібні, щоб використовувати для них обох ту саму
програму).
.PP
З'єднання \s-1SSH\s0 завжди ініціюється з фізичного сервера. Усі дані передаються
цим з'єднанням \s-1SSH.\s0 У термінах налаштування брандмауера і мережі, вам слід
лише забезпечити доступ до порту (зазвичай, порту \s-1TCP 22\s0) для фізичного
сервера на серверів перетворення. Зауважте, що під час процесу перетворення
фізична машина може повторно встановлювати з'єднання декілька разів.
.PP
Для роботи  virt\-p2v потрібна можливість зворотного переспрямовування портів
ssh (тобто працездатність команди \f(CW\*(C`ssh \-R\*(C'\fR). Програма не працюватиме, якщо
цю можливість вимкнено на сервері перетворення. (Для \f(CW\*(C`AllowTcpForwarding\*(C'\fR
має бути встановлено значення \f(CW\*(C`yes\*(C'\fR у файлі \fBsshd_config\fR\|(5) на сервері
перетворення.)
.PP
Можливість ssh використовувати scp (безпечне копіювання) є обов'язковою для
virt\-p2v для надсилання малих файлів (це \fIне\fR той спосіб, у який копіюються
диски).
.PP
The conversion server does not need to be a physical machine.  It could be a
virtual machine, as long as it has sufficient memory and disk space to do
the conversion, and as long as the physical machine can connect directly to
its \s-1SSH\s0 port.  (See also \*(L"Resource requirements\*(R" in \fBvirt\-v2v\fR\|(1)).
.PP
Оскільки усі дані на дисках фізичного сервера має бути скопійовано мережею,
швидкість перетворення багато у чому визначається швидкість обміну даними
мережею між двома машинами.
.SH "ІНТЕРАКТИВНЕ НАЛАШТОВУВАННЯ ЗА ДОПОМОГОЮ ГРАФІЧНОГО ІНТЕРФЕЙСУ"
.IX Header "ІНТЕРАКТИВНЕ НАЛАШТОВУВАННЯ ЗА ДОПОМОГОЮ ГРАФІЧНОГО ІНТЕРФЕЙСУ"
Після запуску virt\-p2v ви побачите графічне діалогове вікно налаштовування,
яке допоможе вам встановити з'єднання із сервером перетворення, запитає про
пароль, надасть змогу вказати, які локальні жорсткі диски слід перетворити,
та інші речі, зокрема назву гостьової системи, яку слід створити, та
кількість віртуальних процесорів, які їй слід надати у користування.
.SS "ВІКНО НАЛАШТОВУВАННЯ \s-1SSH\s0"
.IX Subsection "ВІКНО НАЛАШТОВУВАННЯ SSH"
Після запуску virt\-p2v у режимі графічного інтерфейсу перше діалогове вікно
виглядатиме ось так:
.PP
.Vb 11
\& ┌─────────────────────────────────────────────────────────────┐
\& │                           virt\-p2v                          │
\& │                                                             │
\& │ Сервер перетворення: [_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_] : [22_\|_\|_] │
\& │                                                             │
\& │         Користувач: [root_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_] │
\& │                                                             │
\& │          Пароль:   [_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_] │
\& │                                                             │
\& │  Адреса профілю SSH: [_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_] │
\& │                                                             │
.Ve
.PP
У зазначених вище полях вам слід вказати параметри сервера перетворення:
назву вузла, номер порту \s-1SSH,\s0 ім'я віддаленого користувача і або пароль або
адресу профілю \s-1SSH\s0 (закритого ключа). На сервері перетворення має бути
встановлено достатньо сучасну версію virt\-v2v.
.PP
Зазвичай, вам доведеться входити до сервера перетворення від імені
користувача root, але якщо ви позначите такий пункт:
.PP
.Vb 3
\& │                                                             │
\& │         [ ] Використовувати sudo для запуску virt\-v2v       │
\& │                                                             │
.Ve
.PP
ви зможете увійти до нього від імені іншого користувача, а virt\-p2v
використовуватиме команду \fBsudo\fR\|(8) для розширення прав доступу до прав
доступу root. Зауважте, що доступ до sudo має здійснюватися без пароля.
.PP
Крім того, virt\-v2v можна запустити на сервері перетворення повністю без
прав доступу root, але режими виведення у цьому випадку може бути
обмежено. Зверніться до сторінки підручника \fBvirt\-v2v\fR\|(1), щоб дізнатися
більше.
.PP
У нижній частині діалогового вікна розташовано такі кнопки:
.PP
.Vb 6
\& │                                                             │
\& │                  [ Перевірити з\*(Aqєднання ]                   │
\& │                                                             │
\& │ [ Налаштувати мережу ] [ XTerm ] [ Про virt\-p2v ] [ Далі ] │
\& │                                                             │
\& └─────────────────────────────────────────────────────────────┘
.Ve
.PP
Спочатку вам слід натиснути кнопку \f(CW\*(C`Перевірити з\*(Aqєднання\*(C'\fR, щоб перевірити
з'єднання \s-1SSH\s0 із сервером перетворення. Якщо з'єднання вдасться встановити
(тобто ви вказали правильно назву сервера, ім'я користувача, пароль та інші
дані, а на віддаленій машині встановлено придатну версію virt\-v2v),
натисніть кнопку \f(CW\*(C`Далі\*(C'\fR, щоб перейти до наступного діалогового вікна.
.PP
Ви можете скористатися кнопкою \f(CW\*(C`Налаштувати мережу\*(C'\fR, якщо вам потрібно
визначити статичну IP\-адресу фізичної машини або скористатися Wifi,
прив'язкою або іншими можливостями мережі.
.PP
Кнопка \f(CW\*(C`XTerm\*(C'\fR відкриває командну оболонку, якою можна скористатися для
діагностики, налаштовування мережі вручну тощо.
.SS "ДІАЛОГОВЕ ВІКНО НАЛАШТОВУВАННЯ ДИСКА І МЕРЕЖІ"
.IX Subsection "ДІАЛОГОВЕ ВІКНО НАЛАШТОВУВАННЯ ДИСКА І МЕРЕЖІ"
За допомогою другого діалогового вікна налаштувань ви можете налаштувати
параметри перетворення, зокрема визначити, що слід перетворити, і те, куди
слід надіслати гостьову систему.
.PP
У лівому стовпчику, починаючи згори, за допомогою властивостей призначення
ви можете вибрати назву гостьової системи (тобто назву системи після
перетворення) і скільки віртуальних процесорів та оперативної пам'яті слід
надати гостьовій системі. Типові значення визначаються за параметрами
фізичної машини, ви, звичайно ж, можете їх не змінювати:
.PP
.Vb 9
\& ┌─────────────────────────────────────── ─ ─ ─ ─
\& │ Властивості призначення:
\& │
\& │        Назва: [hostname_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_]
\& │
\& │     К\-ть вірт. процесорів: [4_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_]
\& │
\& │ Пам\*(Aqять (у МБ): [16384_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_]
\& │
.Ve
.PP
Друга панель ліворуч керує параметрами виведення virt\-v2v. Для того, щоб
краще зрозуміти ці параметри, варто ознайомитися зі сторінкою підручника
\&\fBvirt\-v2v\fR\|(1). Ви можете не змінювати типові значення цих параметрів для
створення гостьової системи як образу диска і файла \s-1XML\s0 libvirt, який
зберігатиметься у теці \fI/var/tmp\fR на сервері перетворення. Це непоганий
варіант, якщо ви є користувачем\-початківцем virt\-p2v.
.PP
.Vb 10
\& │
\& │ Параметри виведення virt\-v2v:
\& │
\& │          Вивести до (\-o): [local             ▼]
\& │
\& │      З\*(Aqєднання виведення (\-oc): [_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_]
\& │
\& │    Сховище виведення (\-os): [/var/tmp_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_]
\& │
\& │     Формат виведення (\-of): [_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_]
\& │
\& │ Розподіл виведення (\-oa): [sparse            ▼]
\& │
.Ve
.PP
Всі параметри виведення і шляхи вказуються відносно сервера перетворення
(\fIне\fR фізичного сервера).
.PP
Нарешті, у лівому стовпчику ви знайдете буде наведено інформація щодо версії
virt\-p2v (на фізичному сервері) та virt\-v2v (на сервері перетворення). Вам
слід надавати ці дані під час створення звітів щодо вад.
.PP
У правому стовпчику розташовано три панелі, які керують тим, які диски,
портативні носії даних та мережеві інтерфейси буде створено у отриманій у
результаті обробки гостьовій системі. Зазвичай, достатньо використати типові
параметри.
.PP
.Vb 11
\& ─ ─ ───────────────────────────────────────┐
\&     Фіксовані жорсткі диски                       │
\&                                            │
\&     Перетворити пристрій                        │
\&     [✔]      sda                           │
\&              1024G HITACHI                 │
\&              s/n 12345                     │
\&     [✔]      sdb                           │
\&              119G HITACHI                  │
\&              s/n 12346                     │
\&                                            │
.Ve
.PP
Зазвичай, виконується перетворення усіх дисків. Якщо ви хочете, щоб програма
virt\-p2v повністю проігнорувала локальний диск, зніміть позначку з його
пункту. Має бути позначено диск, на якому міститься операційна система. Якщо
диск є частиною масиву \s-1RAID\s0 або групи томів \s-1LVM\s0 (\s-1VG\s0), має бути позначено або
усі диски з масиву або групи томів, або жодного диска з масиву або групи
томів.
.PP
.Vb 6
\&                                            │
\&     Портативний носій                     │
\&                                            │
\&     Перетворити пристрій                  │
\&     [✔]      sr0                           │
\&                                            │
.Ve
.PP
Якщо у фізичній машині містяться оптичні диски, ви можете скористатися
панеллю «Портативні носії» для створення відповідних дисків у гостьовій
системі після перетворення. Зауважте, що усі дані на компакт\-дисках так \s-1DVD,\s0
які було змонтовано, \fIне\fR буде скопійовано.
.PP
.Vb 7
\&                                            │
\&     Інтерфейси мережі                     │
\&                                            │
\&     Перетворити пристрій, з\*(Aqєднаний із... |
\&     [✔]      em1    [типовий_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_] │
\&     [ ]      wlp3s0 [типовий_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_] │
\&                                            │
.Ve
.PP
In the Network interfaces panel, select the network interfaces that should
be created in the guest after conversion.  You can also connect these to
target hypervisor networks (for further information about this feature, see
\&\*(L"Networks and bridges\*(R" in \fBvirt\-v2v\fR\|(1)).
.PP
Якщо підтримку відповідної можливості передбачено у обладнанні, клацання
лівою кнопкою на назві пристрою (наприклад \f(CW\*(C`em1\*(C'\fR) призведе до того, що на
фізичному інтерфейсі почне блимати лампочка, що надасть змогу оператору
ідентифікувати інтерфейс.
.PP
Коли будете готові розпочати перетворення, натисніть кнопку \f(CW\*(C`Розпочати
перетворення\*(C'\fR:
.PP
.Vb 4
\&                                            │
\&       [ Назад ]  [ Розпочати перетворення ] │
\&                                            │
\& ─ ─ ───────────────────────────────────────┘
.Ve
.SS "ДІАЛОГОВЕ ВІКНО ПОСТУПУ ПЕРЕТВОРЕННЯ"
.IX Subsection "ДІАЛОГОВЕ ВІКНО ПОСТУПУ ПЕРЕТВОРЕННЯ"
Протягом процедури перетворення ви бачитимете таке діалогове вікно:
.PP
.Vb 10
\& ┌────────────────────────────────────────────────────────┐
\& │                      virt\-p2v                          │
\& │                                                        │
\& │  ┌──────────────────────────────────────────────────┐  │
\& │  │                                                 ▲│  │
\& │  │                                                  │  │
\& │  │                                                  │  │
\& ∼  ∼                                                  ∼  ∼
\& │  │                                                  │  │
\& │  │                                                  │  │
\& │  │                                                 ▼│  │
\& │  └──────────────────────────────────────────────────┘  │
\& │                                                        │
\& │ Файли журналу ... до /tmp/virt\-p2v\-xxx                 │
\& │                                                        │
\& │ Виконуємо перетворення ...                              │
\& │                                                        │
\& │                             [ Скасувати перетворення ]  │
\& │                                                        │
\& └────────────────────────────────────────────────────────┘
.Ve
.PP
У основній області зі смужкою гортання ви побачите повідомлення від процесу
virt\-v2v.
.PP
Під основною областю virt\-p2v показуватиме вам каталог на сервері
перетворення, який міститиме файли журналу та інші діагностичні дані. Нижче
буде показано дані щодо поточного стану та кнопку для скасовування
перетворення.
.PP
Після завершення перетворення вам слід вимкнути фізичну машину. Якщо
перетворення буде успішним, вам уже ніколи не доведеться її
перезавантажувати.
.SH "НАЛАШТОВУВАННЯ КОМАНДНОГО РЯДКА ЯДРА"
.IX Header "НАЛАШТОВУВАННЯ КОМАНДНОГО РЯДКА ЯДРА"
Якщо ви не хочете налаштовувати параметри за допомогою графічного інтерфейсу
користувача, можете налаштувати їх за допомогою командного рядка ядра. Це
особливо зручно, якщо вам потрібно перетворити багато фізичних машин, які
завантажуються із використанням \s-1PXE.\s0
.PP
Точне місце того, де слід вказувати аргументи командного рядка, залежить від
вашої реалізації \s-1PXE,\s0 але для pxelinux вам слід вказати їх у полі \f(CW\*(C`APPEND\*(C'\fR
файла \fIpxelinux.cfg\fR. Приклад:
.PP
.Vb 6
\& DEFAULT p2v
\& TIMEOUT 20
\& PROMPT 0
\& LABEL p2v
\&   KERNEL vmlinuz0
\&   APPEND initrd=initrd0.img [....] p2v.server=conv.example.com p2v.password=secret p2v.o=libvirt
.Ve
.PP
Вам слід встановити деякі або усі такі аргументи командного рядка:
.IP "\fBp2v.remote.server=SERVER\fR" 4
.IX Item "p2v.remote.server=SERVER"
.PD 0
.IP "\fBp2v.server=СЕРВЕР\fR" 4
.IX Item "p2v.server=СЕРВЕР"
.PD
Назву або IP\-адресу сервера перетворення.
.Sp
Ці дані є завжди обов'язковими, якщо ви використовуєте спосіб із
налаштовуванням ядра. Якщо virt\-p2v не знайде цих даних у командному рядку
ядра, програма автоматично перемкнеться на спосіб налаштовування за
допомогою графічного інтерфейсу (інтерактивний спосіб).
.IP "\fBp2v.remote.port=PORT\fR" 4
.IX Item "p2v.remote.port=PORT"
.PD 0
.IP "\fBp2v.port=PORT\fR" 4
.IX Item "p2v.port=PORT"
.PD
Номер порту \s-1SSH\s0 на сервері перетворення (типове значення: \f(CW22\fR).
.IP "\fBp2v.auth.username=USERNAME\fR" 4
.IX Item "p2v.auth.username=USERNAME"
.PD 0
.IP "\fBp2v.username=КОРИСТУВАЧ\fR" 4
.IX Item "p2v.username=КОРИСТУВАЧ"
.PD
Ім'я користувача \s-1SSH,\s0 яке буде використано для входу на сервер перетворення
(типове значення: \f(CW\*(C`root\*(C'\fR).
.IP "\fBp2v.auth.password=PASSWORD\fR" 4
.IX Item "p2v.auth.password=PASSWORD"
.PD 0
.IP "\fBp2v.password=ПАРОЛЬ\fR" 4
.IX Item "p2v.password=ПАРОЛЬ"
.PD
Пароль \s-1SSH,\s0 який буде використано для входу на сервер перетворення.
.Sp
Типовою поведінкою буде спроба встановлення зв'язку без пароля. Якщо зв'язок
встановити не вдасться, virt\-p2v  попросить користувача ввести пароль
(ймовірно, декілька разів протягом перетворення).
.Sp
This setting is ignored if \f(CW\*(C`p2v.auth.identity.url\*(C'\fR is present.
.IP "\fBp2v.auth.identity.url=URL\fR" 4
.IX Item "p2v.auth.identity.url=URL"
.PD 0
.IP "\fBp2v.identity=АДРЕСА\fR" 4
.IX Item "p2v.identity=АДРЕСА"
.PD
Вказує адресу файла профілю \s-1SSH\s0 (закритого ключа). Адресу буде оброблено за
допомогою \fBcurl\fR\|(1), тому тут можна вказати будь\-яку адресу, підтримку якої
передбачено у curl, зокрема \f(CW\*(C`https://\*(C'\fR та \f(CW\*(C`file://\*(C'\fR. Щоб дізнатися більше
про використання профілів \s-1SSH,\s0 ознайомтеся із розділом \*(L"ПРОФІЛІ \s-1SSH\*(R"\s0
нижче.
.Sp
If \f(CW\*(C`p2v.auth.identity.url\*(C'\fR is present, it overrides \f(CW\*(C`p2v.auth.password\*(C'\fR.
There is no fallback.
.IP "\fBp2v.auth.sudo\fR" 4
.IX Item "p2v.auth.sudo"
.PD 0
.IP "\fBp2v.sudo\fR" 4
.IX Item "p2v.sudo"
.PD
Скористайтеся \f(CW\*(C`p2v.sudo\*(C'\fR, щоб наказати virt\-p2v використовувати \fBsudo\fR\|(8)
для отримання прав доступу root на сервері перетворення після входу до
системи від імені користувача, відмінного від root (типова поведінка: не
використовувати sudo).
.IP "\fBp2v.guestname=GUESTNAME\fR" 4
.IX Item "p2v.guestname=GUESTNAME"
.PD 0
.IP "\fBp2v.name=НАЗВА_ГОСТЬОВОЇ_СИСТЕМИ\fR" 4
.IX Item "p2v.name=НАЗВА_ГОСТЬОВОЇ_СИСТЕМИ"
.PD
Назва гостьової системи, яку буде створено. Типовою поведінкою є
встановлення назви на основі назви вузла фізичної машини (якщо це
можливо). Якщо назву встановити не вдасться, буде використано назву, яку
створено випадковим чином.
.IP "\fBp2v.vcpus=N\fR" 4
.IX Item "p2v.vcpus=N"
Кількість віртуальних процесорів, про які буде повідомлено гостьовій
системі. Типово, ця кількість дорівнюватиме кількості фізичних процесорів у
системі.
.IP "\fBp2v.memory=n(M|G)\fR" 4
.IX Item "p2v.memory=n(M|G)"
The size of the guest memory.  You must specify the unit such as megabytes
or gigabytes by using for example \f(CW\*(C`p2v.memory=1024M\*(C'\fR or \f(CW\*(C`p2v.memory=1G\*(C'\fR.
.Sp
Типово, буде використано той самий об'єм оперативної пам'яті, який є у
фізичної машини.
.IP "\fBp2v.cpu.vendor=VENDOR\fR" 4
.IX Item "p2v.cpu.vendor=VENDOR"
The vCPU vendor, eg. \*(L"Intel\*(R" or \*(L"\s-1AMD\*(R".\s0  The default is to use the same \s-1CPU\s0
vendor as the physical machine.
.IP "\fBp2v.cpu.model=MODEL\fR" 4
.IX Item "p2v.cpu.model=MODEL"
The vCPU model, eg. \*(L"IvyBridge\*(R".  The default is to use the same \s-1CPU\s0 model
as the physical machine.
.IP "\fBp2v.cpu.sockets=N\fR" 4
.IX Item "p2v.cpu.sockets=N"
Number of vCPU sockets to use.  The default is to use the same as the
physical machine.
.IP "\fBp2v.cpu.cores=N\fR" 4
.IX Item "p2v.cpu.cores=N"
Number of vCPU cores to use.  The default is to use the same as the physical
machine.
.IP "\fBp2v.cpu.threads=N\fR" 4
.IX Item "p2v.cpu.threads=N"
Number of vCPU hyperthreads to use.  The default is to use the same as the
physical machine.
.IP "\fBp2v.cpu.acpi\fR" 4
.IX Item "p2v.cpu.acpi"
Whether to enable \s-1ACPI\s0 in the remote virtual machine.  The default is to use
the same as the physical machine.
.IP "\fBp2v.cpu.apic\fR" 4
.IX Item "p2v.cpu.apic"
Whether to enable \s-1APIC\s0 in the remote virtual machine.  The default is to use
the same as the physical machine.
.IP "\fBp2v.cpu.pae\fR" 4
.IX Item "p2v.cpu.pae"
Whether to enable \s-1PAE\s0 in the remote virtual machine.  The default is to use
the same as the physical machine.
.IP "\fBp2v.rtc.basis=(unknown|utc|localtime)\fR" 4
.IX Item "p2v.rtc.basis=(unknown|utc|localtime)"
Set the basis of the Real Time Clock in the virtual machine.  The default is
to try to detect this setting from the physical machine.
.IP "\fBp2v.rtc.offset=[+|\-]HOURS\fR" 4
.IX Item "p2v.rtc.offset=[+|-]HOURS"
The offset of the Real Time Clock from \s-1UTC.\s0  The default is to try to detect
this setting from the physical machine.
.IP "\fBp2v.disks=sda,sdb,...\fR" 4
.IX Item "p2v.disks=sda,sdb,..."
Список фізичних жорстких дисків для перетворення. Приклад:
.Sp
.Vb 1
\& p2v.disks=sda,sdc
.Ve
.Sp
Типово, буде перетворено усі знайдені локальні жорсткі диски.
.IP "\fBp2v.removable=sra,srb,...\fR" 4
.IX Item "p2v.removable=sra,srb,..."
Список портативних носіїв даних, які слід включити до перетворення. Типовою
поведінкою є створення віртуальних портативних пристроїв для усіх знайдених
фізичних портативних пристроїв. Зауважте, що вміст портативних пристроїв
ніколи не копіюватиметься до гостьової системи.
.IP "\fBp2v.interfaces=em1,...\fR" 4
.IX Item "p2v.interfaces=em1,..."
Список інтерфейсів мережі для перетворення. Типовою поведінкою є створення
інтерфейсів мережі для усіх знайдених фізичних інтерфейсів мережі.
.IP "\fBp2v.network_map=interface:target,...\fR" 4
.IX Item "p2v.network_map=interface:target,..."
.PD 0
.IP "\fBp2v.network=інтерфейс:призначення,...\fR" 4
.IX Item "p2v.network=інтерфейс:призначення,..."
.PD
Керує тим, як інтерфейси мережі буде з'єднано із віртуальними мережами у
гіпервізорі призначення. Типовою поведінкою є встановлення з'єднання на усіх
інтерфейсах мережі із мережею \f(CW\*(C`default\*(C'\fR у гіпервізорі.
.Sp
Вам слід вказати список пар \f(CW\*(C`інтерфейс:призначення\*(C'\fR, відокремлених комами,
і, необов'язково, типове призначення. Приклади:
.Sp
.Vb 1
\& p2v.network=em1:ovirtmgmt
.Ve
.Sp
пов'язує інтерфейс \f(CW\*(C`em1\*(C'\fR із мережею призначення \f(CW\*(C`ovirtmgmt\*(C'\fR.
.Sp
.Vb 1
\& p2v.network=em1:ovirtmgmt,em2:management,other
.Ve
.Sp
пов'язує інтерфейс \f(CW\*(C`em1\*(C'\fR із \f(CW\*(C`ovirtmgmt\*(C'\fR, а інтерфейс \f(CW\*(C`em2\*(C'\fR із
\&\f(CW\*(C`management\*(C'\fR; усі інші знайдені інтерфейси буде пов'язано із \f(CW\*(C`other\*(C'\fR.
.IP "\fBp2v.output.type=(libvirt|local|...)\fR" 4
.IX Item "p2v.output.type=(libvirt|local|...)"
.PD 0
.IP "\fBp2v.o=(libvirt|local|...)\fR" 4
.IX Item "p2v.o=(libvirt|local|...)"
.PD
Встановити режим для виведення даних. Те саме, що і параметр virt\-v2v
\&\fI\-o\fR. Див. \*(L"ПАРАМЕТРИ\*(R" in \fBvirt\-v2v\fR\|(1).
.Sp
Якщо не вказано, типовим значенням є \f(CW\*(C`local\*(C'\fR, а перетворені гостьові
системи буде записано до \fI/var/tmp\fR.
.IP "\fBp2v.output.allocation=(none|sparse|preallocated)\fR" 4
.IX Item "p2v.output.allocation=(none|sparse|preallocated)"
.PD 0
.IP "\fBp2v.oa=(none|sparse|preallocated)\fR" 4
.IX Item "p2v.oa=(none|sparse|preallocated)"
.PD
Встановити режим отримання пам'яті для виведення даних. Те саме, що і
параметр virt\-v2v \fI\-oa\fR. Див. \*(L"ПАРАМЕТРИ\*(R" in \fBvirt\-v2v\fR\|(1).
.IP "\fBp2v.output.connection=URI\fR" 4
.IX Item "p2v.output.connection=URI"
.PD 0
.IP "\fBp2v.oc=URI\fR" 4
.IX Item "p2v.oc=URI"
.PD
Встановити для з'єднання виведення адресу libvirt. Те саме, Що параметр
virt\-v2v \fI\-oc\fR. Див. \*(L"ПАРАМЕТРИ\*(R" in \fBvirt\-v2v\fR\|(1) та
http://libvirt.org/uri.html
.IP "\fBp2v.output.format=(raw|qcow2|...)\fR" 4
.IX Item "p2v.output.format=(raw|qcow2|...)"
.PD 0
.IP "\fBp2v.of=(raw|qcow2|...)\fR" 4
.IX Item "p2v.of=(raw|qcow2|...)"
.PD
Встановити формат для виведення даних. Те саме, що і параметр virt\-v2v
\&\fI\-of\fR. Див. \*(L"ПАРАМЕТРИ\*(R" in \fBvirt\-v2v\fR\|(1).
.IP "\fBp2v.output.storage=STORAGE\fR" 4
.IX Item "p2v.output.storage=STORAGE"
.PD 0
.IP "\fBp2v.os=STORAGE\fR" 4
.IX Item "p2v.os=STORAGE"
.PD
Встановити сховище даних для виведення. Те саме, що і параметр virt\-v2v
\&\fI\-os\fR. Див. \*(L"ПАРАМЕТРИ\*(R" in \fBvirt\-v2v\fR\|(1).
.Sp
Якщо не вказано, типово буде використано \fI/var/tmp\fR (на сервері
перетворення).
.IP "\fBp2v.pre=КОМАНДА\fR" 4
.IX Item "p2v.pre=КОМАНДА"
.PD 0
.ie n .IP "\fBp2v.pre=""КОМАНДА АРГУМЕНТ ...""\fR" 4
.el .IP "\fBp2v.pre=``КОМАНДА АРГУМЕНТ ...''\fR" 4
.IX Item "p2v.pre=КОМАНДА АРГУМЕНТ ..."
.PD
Вибрати команду, яку буде виконано до перетворення. Тут можна вказати
будь\-яку команду або скрипт. Якщо у команді містяться пробіли, вам слід
взяти усю команду у подвійні лапки. Типово, ніяка команда не
виконуватиметься.
.IP "\fBp2v.post=poweroff\fR" 4
.IX Item "p2v.post=poweroff"
.PD 0
.IP "\fBp2v.post=reboot\fR" 4
.IX Item "p2v.post=reboot"
.IP "\fBp2v.post=КОМАНДА\fR" 4
.IX Item "p2v.post=КОМАНДА"
.ie n .IP "\fBp2v.post=""КОМАНДА АРГУМЕНТ ...""\fR" 4
.el .IP "\fBp2v.post=``КОМАНДА АРГУМЕНТ ...''\fR" 4
.IX Item "p2v.post=КОМАНДА АРГУМЕНТ ..."
.PD
Визначити команду, яку буде виконано після успішного перетворення. Це може
бути будь\-яка команда або скрипт. Якщо у записі команди є пробіли, вам слід
взяти усю команду у подвійні лапки.
.Sp
\&\fIЯкщо\fR virt\-p2v запущено від імені користувача root, \fIі\fR командний рядок
було встановлено з \fI/proc/cmdline\fR (не з \fI\-\-cmdline\fR), типовою поведінкою
буде запуск програми \fBpoweroff\fR\|(8). У всіх інших випадках ніякої додаткової
команди не виконуватиметься.
.IP "\fBp2v.fail=КОМАНДА\fR" 4
.IX Item "p2v.fail=КОМАНДА"
.PD 0
.ie n .IP "\fBp2v.fail=""КОМАНДА АРГУМЕНТ ...""\fR" 4
.el .IP "\fBp2v.fail=``КОМАНДА АРГУМЕНТ ...''\fR" 4
.IX Item "p2v.fail=КОМАНДА АРГУМЕНТ ..."
.PD
Вибрати команду, яку буде виконано після перетворення, якщо перетворення не
вдасться виконати. Тут можна вказати будь\-яку команду або скрипт. Якщо у
команді містяться пробіли, вам слід взяти усю команду у подвійні
лапки. Типово, ніяка команда не виконуватиметься.
.IP "\fBip=dhcp\fR" 4
.IX Item "ip=dhcp"
Скористатися \s-1DHCP\s0 для налаштовування інтерфейсу мережі (типова поведінка).
.SH "ПРОФІЛІ SSH"
.IX Header "ПРОФІЛІ SSH"
Як дещо безпечнішу альтернативу розпізнаванню за допомогою пароля, ви можете
використати для розпізнавання профіль \s-1SSH\s0 (закритий ключ).
.PP
Спочатку створіть пару ключів. Пароль до пари ключів має бути порожнім:
.PP
.Vb 1
\& ssh\-keygen \-t rsa \-N \*(Aq\*(Aq \-f id_rsa
.Ve
.PP
Буде створено пару з закритого ключа (\f(CW\*(C`id_rsa\*(C'\fR) та відкритого ключа
(\f(CW\*(C`id_rsa.pub\*(C'\fR).
.PP
Відкритий ключ слід дописати до файла \f(CW\*(C`authorized_keys\*(C'\fR на сервері
перетворення virt\-v2v (зазвичай, до файла \f(CW\*(C`/root/.ssh/authorized_keys\*(C'\fR).
.PP
Для поширення закритого ключа можна скористатися одним з таких чотирьох
сценаріїв (від менш безпечного до більш безпечного):
.IP "1." 4
Взагалі не використовувати профілі \s-1SSH,\s0 розпізнавати користувачів за
паролями.
.Sp
Будь\-хто з тих, хто має доступ до параметрів завантаження \s-1PXE\s0 з мережі або
може побачити пароль у якийсь інший спосіб, може увійти до сервера
перетворення virt\-v2v.
.IP "2." 4
Профіль \s-1SSH,\s0 вбудований до образу \s-1ISO\s0 або образу диска virt\-p2v. У
графічному інтерфейсі скористайтеся такими налаштуваннями:
.Sp
.Vb 3
\& │            Пароль: [    <не заповнюйте>               ] │
\& │                                                          │
\& │  Адреса профілю SSH: [file:///var/tmp/id_rsa_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_\|_] │
.Ve
.Sp
або командним рядком ядра:
.Sp
.Vb 1
\& p2v.identity=file:///var/tmp/id_rsa
.Ve
.Sp
Закритий ключ \s-1SSH\s0 може бути отримано перехопленням пакетів у мережі, якщо
використовується стандартний \s-1PXE.\s0
.IP "3." 4
Профіль \s-1SSH,\s0 отриманий з сайта. У графічному інтерфейсі скористайтеся такими
налаштуваннями:
.Sp
.Vb 3
\& │            Пароль: [    <не заповнюйте>               ] │
\& │                                                          │
\& │  Адреса профілю SSH: [https://internal.example.com/id_rsa] │
.Ve
.Sp
або командним рядком ядра:
.Sp
.Vb 1
\& p2v.identity=https://internal.example.com/id_rsa
.Ve
.Sp
Знову ж таки, будь\-хто може отримати закритий ключ і скористатися ним для
входу до сервера перетворення virt\-v2v, але ви можете подбати про надійніший
захист, налаштувавши сервер так, щоб він встановлював з'єднання лише з
машинами P2V.
.Sp
Зауважте, що \fBssh\-keygen\fR\|(1) створює файл \f(CW\*(C`id_rsa\*(C'\fR (закритий ключ) із
режимом доступу 0600. Якщо ви просто скопіюєте цей файл на сервер, сервер не
зможе його обслуговувати. Він повідомлятиме про помилки «403 Forbidden». Вам
слід змінити режим доступу до файла, щоб зробити його загальнодоступним для
читання, наприклад, скориставшись такою командою:
.Sp
.Vb 1
\& chmod 0644 id_rsa
.Ve
.IP "4." 4
Профіль \s-1SSH,\s0 вбудований до образу \s-1ISO\s0 або образу диска virt\-p2v (подібно до
2.) \fIі\fR використання безпечного \s-1PXE, PXE\s0 на основі окремої фізичної мережі
або sneakernet для надсилання даних virt\-p2v на фізичну машину.
.PP
У обох скриптах, \fBvirt\-p2v\-make\-disk\fR\|(1) і \fBvirt\-p2v\-make\-kickstart\fR\|(1),
передбачено той самий параметр \fI\-\-inject\-ssh\-identity\fR для вставляння
закритого ключа до образу диска або образу \s-1ISO\s0 virt\-p2v. Ознайомтеся із
такими розділами підручника:
.PP
\&\*(L"ДОДАВАННЯ ПРОФІЛЮ \s-1SSH\*(R"\s0 in \fBvirt\-p2v\-make\-disk\fR\|(1)
.PP
\&\*(L"ДОДАВАННЯ ПРОФІЛЮ \s-1SSH\*(R"\s0 in \fBvirt\-p2v\-make\-kickstart\fR\|(1)
.SH "ТИПОВІ ПРОБЛЕМИ"
.IX Header "ТИПОВІ ПРОБЛЕМИ"
.SS "Тайм\-аути"
.IX Subsection "Тайм-аути"
Як це описано нижче (див. \*(L"ЯК ПРАЦЮЄ \s-1VIRT\-P2V\*(R"\s0), virt\-p2v створює декілька
довготривалих з'єднань ssh із сервером перетворення. Якщо час очікування на
з'єднання у цих з'єднаннях буде перевищено, virt\-p2v не зможе продовжувати
роботу.
.PP
Щоб перевірити, чи не спричиняє час очікування (тайм\-аут) проблеми,
відкрийте термінал XTerm на машині з virt\-p2v, відайте команду \f(CW\*(C`ssh
root@\f(CIсервер перетворення\f(CW\*(C'\fR і почекайте на результати протягом принаймні
години. Якщо з'єднання буде розірвано без вашого втручання, працює якийсь із
інструментів контролю часу очікування, і ви маєте його вимкнути.
.PP
Причиною перевищення часу очікування може бути:
.ie n .IP "Змінна середовища ""TIMEOUT"" або ""TMOUT""" 4
.el .IP "Змінна середовища \f(CWTIMEOUT\fR або \f(CWTMOUT\fR" 4
.IX Item "Змінна середовища TIMEOUT або TMOUT"
Перевірте, чи не задано одну з цих змінних середовища у командній оболонці
root на сервері перетворення.
.ie n .IP "Параметр sshd ""ClientAlive*""" 4
.el .IP "Параметр sshd \f(CWClientAlive*\fR" 4
.IX Item "Параметр sshd ClientAlive*"
Пошукайте параметр \f(CW\*(C`ClientAlive*\*(C'\fR в \f(CW\*(C`/etc/ssh/sshd_config\*(C'\fR на сервері
перетворення.
.IP "Параметри брандмауера або \s-1NAT\s0" 4
.IX Item "Параметри брандмауера або NAT"
Перевірте, чи немає брандмауера або блоку \s-1NAT\s0 між virt\-p2v та сервером
перетворення і чи не розриває цей брандмауер з'єднання, якщо з'єднання буде
бездіяльним протягом надто короткого періоду часу.
.Sp
virt\-p2v ≥ 1.36 намагається обійти проблеми із надто короткими
значеннями часу очікування у брандмауері, надсилаючи повідомлення
підтримання зв'язку кожні 5 хвилин.
.SH "ПАРАМЕТРИ"
.IX Header "ПАРАМЕТРИ"
.IP "\fB\-\-help\fR" 4
.IX Item "--help"
Показати довідкове повідомлення.
.IP "\fB\-\-cmdline=РЯДОК_КОМАНДИ\fR" 4
.IX Item "--cmdline=РЯДОК_КОМАНДИ"
Використовується для діагностики. Замість обробки командного рядка ядра з
\&\fI/proc/cmdline\fR, обробити рядковий параметр \f(CW\*(C`CMDLINE\*(C'\fR.
.IP "\fB\-\-colors\fR" 4
.IX Item "--colors"
.PD 0
.IP "\fB\-\-colours\fR" 4
.IX Item "--colours"
.PD
Використовувати послідовності символів \s-1ANSI\s0 для розфарбовування
повідомлень. Ці послідовності типово використовуються, якщо дані виводяться
на термінал tty.  Якщо дані, виведені програмою, спрямовуються до файла,
послідовності визначення кольорів \s-1ANSI\s0 буде вимкнено, якщо ви не додасте до
команди цей параметр.
.IP "\fB\-\-iso\fR" 4
.IX Item "--iso"
This flag is passed to virt\-p2v when it is launched inside the virt\-p2v \s-1ISO\s0
environment, ie. when it is running on a real physical machine (and thus not
when testing).  It enables various dangerous features such as the Shutdown
popup button.
.IP "\fB\-\-nbd=сервер[,сервер...]\fR" 4
.IX Item "--nbd=сервер[,сервер...]"
Вибрати сервер \s-1NBD\s0 для використання. Типово, буде виконано спробу зв'язатися
із такими серверами, і буде використано перший з працездатних серверів:
\&\fI\-\-nbd=qemu\-nbd,qemu\-nbd\-no\-sa,nbdkit,nbdkit\-no\-sa\fR
.RS 4
.IP "\fBqemu-nbd\fR" 4
.IX Item "qemu-nbd"
Використовувати qemu-nbd.
.IP "\fBqemu-nbd-no-sa\fR" 4
.IX Item "qemu-nbd-no-sa"
Використовувати qemu-nbd, але вимкнути активацію сокетів.
.IP "\fBnbdkit\fR" 4
.IX Item "nbdkit"
Використовувати nbdkit із додатком обробки файлів
(див. \fBnbdkit\-file\-plugin\fR\|(1)).
.IP "\fBnbdkit-no-sa\fR" 4
.IX Item "nbdkit-no-sa"
Використовувати nbdkit, але вимкнути активацію сокетів.
.RE
.RS 4
.Sp
Варіанти \f(CW\*(C`*\-no\-sa\*(C'\fR надають змогу virt\-p2v повернутися до старіших версій
qemu-nbd і nbdkit, у яких не передбачено підтримки активації за допомогою
сокета.
.RE
.IP "\fB\-\-test\-disk=/ШЛЯХ/ДО/ОБРАЗУ_ДИСКА\fR" 4
.IX Item "--test-disk=/ШЛЯХ/ДО/ОБРАЗУ_ДИСКА"
З метою тестування або діагностики можна замінити \fI/dev/sda\fR на локальний
файл. Має бути вказано абсолютний шлях до файла.
.IP "\fB\-v\fR" 4
.IX Item "-v"
.PD 0
.IP "\fB\-\-verbose\fR" 4
.IX Item "--verbose"
.PD
У libguestfs ≥ 1.33.41 діагностику завжди увімкнено на сервері
перетворення, тому додавання цього прапорця нічого не змінює.
.IP "\fB\-V\fR" 4
.IX Item "-V"
.PD 0
.IP "\fB\-\-version\fR" 4
.IX Item "--version"
.PD
Показати дані щодо версії і завершити роботу.
.SH "ЯК ПРАЦЮЄ VIRT\-P2V"
.IX Header "ЯК ПРАЦЮЄ VIRT-P2V"
\&\fBЗауважте, що цей розділ не є нормативним.\fR Ми можемо змінити принципи
роботи virt\-p2v будь\-коли у майбутніх версіях.
.PP
Як описано вище, virt\-p2v працює на фізичній машині, опитує користувача або
обробляє командний рядок ядра для отримання параметрів налаштування, а потім
встановлює одне або декілька з'єднань із сервером перетворення
virt\-v2v. З'єднання ssh є інтерактивними сеансами командної оболонки із
віддаленим вузлом, але команди, які надсилаються, створюються лише самою
програмою virt\-p2v, а не користувачем. Для передавання даних virt\-p2v
використовуватиме можливість ssh зі зворотного переспрямовування даних
портів (тобто \f(CW\*(C`ssh \-R\*(C'\fR).
.PP
Спочатку програма створить одне або декілька тестових з'єднань, які
використовуватимуться для отримання даних щодо віддаленої версії virt\-v2v та
її можливостей. Тестові з'єднання буде розірвано до того, як буде розпочато
перетворення.
.PP
.Vb 5
\& ┌──────────────┐                      ┌─────────────────┐
\& │ virt\-p2v     │                      │ virt\-v2v        │
\& │ (фізичний    │  керівне з’єднання   │ (сервер         │
\& │  сервер)   ╍╍╍╍╍╍╍╍╍╍╍╍╍╍╍╍╍╍╍╍╍╍╍╍╍╍╍▶ перетворення) │
\& └──────────────┘                      └─────────────────┘
.Ve
.PP
Щойно virt\-p2v буде готовим розпочати перетворення, програма відкриє
одинарне керівне з'єднання ssh. Спочатку вона надішле команду mkdir для
створення тимчасового каталогу на сервері перетворення. Назву каталогу буде
вибрано випадковим чином і показано за допомогою графічного
інтерфейсу. Формат назви буде таким:
.PP
.Vb 1
\& /tmp/virt\-p2v\-РРРРММДД\-XXXXXXXX
.Ve
.PP
де \f(CW\*(C`РРРРММДД\*(C'\fR — поточна дата, а «X» — випадкові символи.
.PP
До цього каталогу буде записано різноманітні файли, серед яких:
.IP "\fIdmesg\fR" 4
.IX Item "dmesg"
.PD 0
.IP "\fIlscpu\fR" 4
.IX Item "lscpu"
.IP "\fIlspci\fR" 4
.IX Item "lspci"
.IP "\fIlsscsi\fR" 4
.IX Item "lsscsi"
.IP "\fIlsusb\fR" 4
.IX Item "lsusb"
.PD
\&\fI(до перетворення)\fR
.Sp
Виведені дані відповідних команд (тобто \fBdmesg\fR\|(1), \fBlscpu\fR\|(1) тощо) на
фізичній машині.
.Sp
Виведені dmesg дані корисні для виявлення проблем, зокрема нестачі драйверів
пристроїв або мікропрограм на образі \s-1ISO\s0 virt\-p2v. Дані інших програм
корисні для діагностування проблем із новітніми конфігураціями обладнання.
.IP "\fIenvironment\fR" 4
.IX Item "environment"
\&\fI(до перетворення)\fR
.Sp
Вміст середовища, у якому буде працювати \fBvirt\-v2v\fR\|(1).
.IP "\fIname\fR" 4
.IX Item "name"
\&\fI(до перетворення)\fR
.Sp
Назва (зазвичай, назва вузла) фізичної машини.
.IP "\fIphysical.xml\fR" 4
.IX Item "physical.xml"
\&\fI(до перетворення)\fR
.Sp
\&\s-1XML\s0 libvirt, який описує фізичну машину. Використовується для передавання
даних щодо фізичної початкової основної системи до \fBvirt\-v2v\fR\|(1) за
допомогою параметра \fI\-i libvirtxml\fR.
.Sp
Зауважте, що це не «справжній» \s-1XML\s0 libvirt (його \fBніколи\fR не слід
завантажувати до libvirt, яка все одно його не сприйме). Крім того, він не
збігається із \s-1XML\s0 libvirt, який створює virt\-v2v у певних режимах виведення.
.IP "\fIp2v\-version\fR" 4
.IX Item "p2v-version"
.PD 0
.IP "\fIv2v\-version\fR" 4
.IX Item "v2v-version"
.PD
\&\fI(до перетворення)\fR
.Sp
Версії virt\-p2v і virt\-v2v, відповідно.
.IP "\fIstatus\fR" 4
.IX Item "status"
\&\fI(після перетворення)\fR
.Sp
Остаточний стан перетворення. \f(CW0\fR, якщо перетворення виконано
успішно. Ненульове значення, якщо під час перетворення сталися помилки.
.IP "\fItime\fR" 4
.IX Item "time"
\&\fI(до перетворення)\fR
.Sp
Дата і час початку перетворення.
.IP "\fIvirt\-v2v\-conversion\-log.txt\fR" 4
.IX Item "virt-v2v-conversion-log.txt"
\&\fI(під час/після перетворення)\fR
.Sp
Журнал перетворення. Це усього лише виведені програмою virt\-v2v дані на
сервері перетворення. Якщо спроба перетворення зазнає невдачі, вам слід
ознайомитися із цим журналом. Крім того, вас можуть попросити надати
\&\fBповний\fR, \fBнередагований\fR файл журналу у системі звітування щодо вад або у
системі квитків підтримки.
.IP "\fIvirt\-v2v\-wrapper.sh\fR" 4
.IX Item "virt-v2v-wrapper.sh"
\&\fI(до перетворення)\fR
.Sp
Це скрипт\-обгортка, який використовується для запуску virt\-v2v. Лише для
зацікавлених — не намагайтеся запускати цей скрипт власноруч.
.PP
Перш ніж розпочнеться саме перетворення, virt\-p2v створить іще одне або
декілька додаткових з'єднань ssh зі сервером для передавання даних.
.PP
У поточній версії протоколом для передавання даних є \s-1NBD\s0 (Network Block
Device), дані пропускаються крізь ssh. Типовим сервером \s-1NBD\s0 є
\&\fBqemu\-nbd\fR\|(1), але можна вибрати інші сервери за допомогою параметра
командного рядка \fI\-\-nbd\fR.
.PP
Для кожного фізичного диска на початковій машині буде створено одне
з'єднання ssh (поширений випадок, коли диск є єдиним, продемонстровано
нижче):
.PP
.Vb 11
\& ┌──────────────┐                      ┌─────────────────┐
\& │ virt\-p2v     │                      │ virt\-v2v        │
\& │ (фізичний    │  керівне з’єднання   │ (сервер         │
\& │  сервер)   ╍╍╍╍╍╍╍╍╍╍╍╍╍╍╍╍╍╍╍╍╍╍╍╍╍╍╍▶ перетворення) │
\&  │              │                      │                 │
\& │              │  з\*(Aqєднання для даних  │                 │
\& │            ╍╍╍╍╍╍╍╍╍╍╍╍╍╍╍╍╍╍╍╍╍╍╍╍╍╍╍▶               │
\& │qemu\-nbd ← ─┘ │                      │└─ ← запити      │
\& │/dev/sda      │                      │     NBD         │
\& ∼              ∼                      ∼                 ∼
\& └──────────────┘                      └─────────────────┘
.Ve
.PP
Хоча з'єднання для передавання даних за допомогою ssh починається з
фізичного сервера і завершується на сервері перетворення, фактично, потік
запитів \s-1NBD\s0 рухається у протилежному напрямку. Так відбувається через те, що
для відкриття порту на петльовому інтерфейсі сервера перетворення
використовується можливість зворотного переспрямовування портів ssh (\f(CW\*(C`ssh
\&\-R\*(C'\fR). Дані пропускаються назад каналом ssh на сервер \s-1NBD,\s0 який запущено на
фізичний машині. У результаті virt\-v2v за допомогою libguestfs може
відкривати з'єднання nbd, які безпосередньо читають дані з жорстких дисків
фізичного сервера.
.PP
Для захисту жорстких дисків від запису використовується два шари. По\-перше,
використовується параметр qemu-nbd \fI\-r\fR (лише читання). По\-друге,
libguestfs створює накладку над з'єднанням \s-1NBD,\s0 яка зберігає записані дані
у тимчасовому файлі для файла перетворення.
.PP
Довга команда \f(CW\*(C`virt\-v2v \-i libvirtxml physical.xml ...\*(C'\fR загортається у
скрипт і вивантажується на сервер перетворення. Кінцевим кроком є запуск
цього скрипту\-обгортки, який запустить програму virt\-v2v. Програма virt\-v2v
використає дані з файла \fIphysical.xml\fR (див. вище), який посилається на
порти очікування даних \s-1NBD\s0 для встановлення з'єднань для обміну даними.
.PP
Дані, виведені програмою virt\-v2v (повідомлення, діагностика тощо)
зберігаються у файлі журналу на сервері перетворення. Лише інформаційні
повідомлення надсилаються назад керівним з'єднанням для показу у графічному
інтерфейсі.
.SH "ТАКОЖ ПЕРЕГЛЯНЬТЕ"
.IX Header "ТАКОЖ ПЕРЕГЛЯНЬТЕ"
\&\fBvirt\-p2v\-make\-disk\fR\|(1), \fBvirt\-p2v\-make\-kickstart\fR\|(1),
\&\fBvirt\-p2v\-make\-kiwi\fR\|(1), \fBvirt\-v2v\fR\|(1), \fBqemu\-nbd\fR\|(1), \fBnbdkit\fR\|(1),
\&\fBnbdkit\-file\-plugin\fR\|(1), \fBssh\fR\|(1), \fBsshd\fR\|(8), \fBsshd_config\fR\|(5),
http://libguestfs.org/.
.SH "АВТОРИ"
.IX Header "АВТОРИ"
Matthew Booth
.PP
John Eckersberg
.PP
Richard W.M. Jones http://people.redhat.com/~rjones/
.PP
Mike Latimer
.PP
Pino Toscano
.PP
Tingting Zheng
.SH "АВТОРСЬКІ ПРАВА"
.IX Header "АВТОРСЬКІ ПРАВА"
Copyright (C) 2009\-2019 Red Hat Inc.
.SH "LICENSE"
.IX Header "LICENSE"
This program is free software; you can redistribute it and/or modify it
under the terms of the \s-1GNU\s0 General Public License as published by the
Free Software Foundation; either version 2 of the License, or (at your
option) any later version.
.PP
This program is distributed in the hope that it will be useful, but
\&\s-1WITHOUT ANY WARRANTY\s0; without even the implied warranty of
\&\s-1MERCHANTABILITY\s0 or \s-1FITNESS FOR A PARTICULAR PURPOSE.\s0  See the \s-1GNU\s0
General Public License for more details.
.PP
You should have received a copy of the \s-1GNU\s0 General Public License along
with this program; if not, write to the Free Software Foundation, Inc.,
51 Franklin Street, Fifth Floor, Boston, \s-1MA 02110\-1301 USA.\s0
.SH "BUGS"
.IX Header "BUGS"
To get a list of bugs against libguestfs, use this link:
https://bugzilla.redhat.com/buglist.cgi?component=libguestfs&product=Virtualization+Tools
.PP
To report a new bug against libguestfs, use this link:
https://bugzilla.redhat.com/enter_bug.cgi?component=libguestfs&product=Virtualization+Tools
.PP
When reporting a bug, please supply:
.IP "\(bu" 4
The version of libguestfs.
.IP "\(bu" 4
Where you got libguestfs (eg. which Linux distro, compiled from source, etc)
.IP "\(bu" 4
Describe the bug accurately and give a way to reproduce it.
.IP "\(bu" 4
Run \fBlibguestfs\-test\-tool\fR\|(1) and paste the \fBcomplete, unedited\fR
output into the bug report.
