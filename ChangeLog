commit b617cb558119646ab720b2d41fe11cd5ba61a5a3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 22 10:21:55 2017 +0100

    Version 1.36.5.

commit dca732d3b66a85718674a5499eb56b8ccb1b4ef3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 21 22:23:12 2017 +0100

    maintainer: New layout of libguestfs website.
    
    (cherry picked from commit 13cc6faedb28c8889430181e997f65d139430225)

commit 73e26fad43fe6ce31b932fdeccdc3099fde76bcd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 21 17:13:29 2017 +0100

    mllib: Handle empty files correctly in read_first_line_from_file.
    
    The OCaml function ‘input_line’ throws an End_of_file exception if the
    end of the file is read before any other input, ie. if the file here
    is zero length.  Return an empty string instead.
    
    This can produce peculiar errors such as:
    
    $ virt-customize ... --root-password file:/dev/null
    libguestfs: uncaught OCaml exception in getopt callback: End_of_file
    
    (cherry picked from commit 68a88a6b0e6127c40ba1a5fcc346f0184ed67af2)

commit 47cf44600646be857048bd655cb440d8d7844e4c
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Jun 21 16:34:05 2017 +0200

    resize: make sure the input disk is read-only
    
    Fixes commit 8a2b0738d1b79f288b14fc35294567430d10b7ec.
    
    (cherry picked from commit 1ca2a8b7ba41d7e4baf1aec5d65ace3b66f2dc37)

commit 0016ba79d80b87242b52c8570417b803f60ef4c8
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Jun 21 13:46:58 2017 +0200

    python: PEP 8: remove extra spaces in example lines
    
    Remove (before opening round bracket) whitespaces in the documentation
    of the Python binding, according to the PEP 8 specification.
    
    This is just code reformatting, with no behaviour changes; no content
    changed beside whitespaces, so "git diff -w" gives an empty diff.
    
    (cherry picked from commit 713243b3cbe8b4dc8d9ee050ba9d04260f26dab6)

commit ba33ee1343d274de283cf3974b7b9d4142767700
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 19 14:47:20 2017 +0100

    gitignore: Remove a few unused patterns from this file.
    
    (cherry picked from commit 19498b199d7f75e27875018438b11c6e0d9cefc4)

commit 1d0bafe79a5e6b4a313a9d20365236b8e14b2470
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 13 08:49:05 2017 +0100

    lib: direct, uml: Refactor unblocking SIGTERM code.
    
    A small refactoring of
    commit 1f1cd11cf0f5a6652c1571fd01a4cce2c7e411ae.
    
    (cherry picked from commit db8fdfd8d61873b2c5129870014b4af6d2ad6602)

commit 91935a05d8ab08dfdd7e344eeeb61b3bb4755614
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 13 08:42:29 2017 +0100

    lib: Move close_file_descriptors into guestfs-internal.h.
    
    This macro is only used by the library, so move it to
    lib/guestfs-internal.h.
    
    (cherry picked from commit 92995c55644a8be9333660e9be4d0013a92629cc)

commit c0baa96a43d51c20944513fbb575dbc136b17242
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 12 13:15:34 2017 +0100

    daemon: lvm: Pass --yes option to force pvresize (RHBZ#1460577).
    
    LVM2 >= 2.02.171 requires the ‘--yes’ option to force pvresize to work
    in various circumstances, eg. reducing the size of an existing PV.
    
    Pass this flag unconditionally.
    
    Note this does NOT break earlier versions which just ignore this flag.
    
    (cherry picked from commit 8a98fe91b889f666c8160f4c23af220247b4b8f3)

commit df9ab03b1e8ffd8e4e2fdb7f27de25681d0d742c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 10 18:30:05 2017 +0100

    lib: direct, uml: Unblock SIGTERM in the hypervisor and recovery processes (RHBZ#1460338).
    
    If SIGTERM is blocked in the main program, then it ends up still being
    blocked in the subprocess after we fork.  This means that we cannot
    kill qemu by sending SIGTERM to it.  This commit fixes the problem by
    unblocking SIGTERM unconditionally after fork.
    
    Thanks: wtfuzz on IRC for reporting and analysis.
    (cherry picked from commit 1f1cd11cf0f5a6652c1571fd01a4cce2c7e411ae)

commit a316b0066afce6eb6bf221d9dfa7110e673476d8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 8 08:16:04 2017 +0100

    lib: create: Allow any [[:alnum:]]+ string as a backingfmt parameter (RHBZ#1459979).
    
    If you use the libguestfs tools which open disk images read-only
    (eg. virt-df), with formats such as 'vdi', then you will see an error:
    
      error: invalid value for backingformat parameter 'vdi'
    
    This is because opening a disk image read-only will try to create a
    qcow2 file with the original image as a backing file.  However the
    list of permitted backing formats was very restrictive and did not
    include 'vdi' (nor many other uncommon formats).
    
    Instead of using a whitelist for backing formats, just validate that
    the string is alphanumeric and short.
    
    Thanks: Mike Goodwin for reporting the bug.
    (cherry picked from commit 5856323e6f35bffd5105b138754bc5e554b2e900)

commit 308feddd938a5011f2abdadbe4f4312a1d5c66b8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 9 12:54:41 2017 +0100

    daemon: ldm: Use CLEANUP_FREE on list of static strings.
    
    This likely causes a double-free in the ‘ldmtool_scan_devices’ API.
    
    (cherry picked from commit 0b8556695f6190614521f14a7fdfc00fe8897d5a)

commit b0cb74bf92d94b29185b925a5ef17d8566f89168
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jun 4 09:27:52 2017 +0100

    builder: Add cirros-0.3.5.
    
    (cherry picked from commit ab1620b8d0386ea038d7f10de0c324333cb4d01a)

commit dd70b225e7874b1f2625315a612a0b782f45d205
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jun 4 09:35:01 2017 +0100

    builder: templates: Ensure a stable sort when creating index file.
    
    (cherry picked from commit d606edfba400b2a3ceb5f311b0bf4ec84bf1eb44)

commit bf70b6b9365b002ef610590581c61f383c78d0f0
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Jun 1 18:03:37 2017 +0200

    v2v: tell v2v the real root device to mkinitrd
    
    Complementary fix of commit 2d25872df3619a3077006ad0f91c029602db6780.
    On SLES 11 SP4 with kdump enabled mkinitrd calls mkdumprd which calls
    mkinitrd, but mkdumprd doesn't have any clue of the root device.
    
    Call mkinitrd with rootdev environment variable to tell them all
    what device to use as root.
    
    Tested-By: Cédric Bosdonnat <cbosdonnat@suse.com>
    (cherry picked from commit 76eeb0afc9b2d7f5ca1edc95af2156b03c934682)

commit 7def64e59796bf45adeb3dfa7600fe75d60ba61a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 25 12:16:53 2017 +0100

    mllib: Export which in "stdlib mode".
    
    As with the previous commit, this was already being compiled in, but
    not exported, so there's no substantive change here.
    
    (cherry picked from commit 8c89299d8abac79516f7668bbe61304da6490420)

commit e55c9ebea43a934b5aaf7d5e5e55f5c363ef4bd7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 24 15:46:52 2017 +0100

    mllib: Export prog, quiet, trace, verbose in "stdlib mode".
    
    These were already included in the .ml implementation file, but just
    weren't being exported in the interface, so there's no real change
    here.  It just allows these functions to be used.
    
    (cherry picked from commit 5e49e3ff538fc3a238887dfb3447d18ec7384507)

commit 55fcd8b36dc541fecea3e5bd49664d78481f5536
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue May 30 12:50:10 2017 +0200

    btrfs_replace: fix position of subcommand options
    
    btrfs-progs 4.11 is more strict with option parsing, so subcommand
    options must appear now before the subcommand arguments.
    
    (cherry picked from commit 2c41f001de4625b786e3b1a7f69057514b34da3d)

commit d5a26d4ec9cec1eecb04f810e7a60c65e8ca5552
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 19 11:44:36 2017 +0100

    Version 1.36.4.

commit a4f8cd12f324aed7937e577383f42dc9c50a006d
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon May 15 14:41:03 2017 +0200

    v2v: linux: pass the root device when using SUSE's mkinitrd
    
    mkinitrd in SLE guests < 12 tries to get the root device by scanning the
    fstab: this will fail, since v2v already remapped the devices from
    hd*/sd* to vd* in the guest (including in its fstab).
    
    Since we know what is the root device in the appliance, pass it to
    mkinitrd directly, so it does not have to do guesswork.
    
    Thanks to: Cédric Bosdonnat, for reporting the issue, and testing
    the fix.
    
    (cherry picked from commit 2d25872df3619a3077006ad0f91c029602db6780)

commit dd213273f31f7f4df002b2a9e2d1373bf652e726
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon May 15 14:31:56 2017 +0200

    python: PEP 8: add empty line
    
    Small update for commit 45e046dac95ce6895af95832def7e40ad786e36f.
    
    This is just formatting, no behaviour changes.
    
    (cherry picked from commit 00bf11cba8f069d9708eb19b6854e5e82e10b8bd)

commit 6acd29c7d0b148c39d8b6a2dd984417db143a45b
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri May 12 17:03:01 2017 +0200

    daemon: lvm: use 'yes' as boolean for lvm2
    
    It looks like older versions of lvm2 (recent enough to have selectors)
    do not recognize '1' (and '0') as boolean values.  Switch to 'yes',
    which seems to be supported.
    
    Updates commit 7367945647e774aec4b93c3bf13181212d3c6430.
    
    (cherry picked from commit 5cbedebdb04ac7e6f4f09b0407655b1629a37eeb)

commit 7c10ba7725eab7c3880c9611f53b6b2936fc2b8a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 8 09:50:17 2017 +0100

    v2v: -i ova: Refactor constructing zcat command.
    
    (cherry picked from commit 5e55a9cd4ebb85e1b6905d731f97d5f216d653f2)

commit 124532918fd9920b4359f9c0fb05b48b6627091d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 8 09:40:36 2017 +0100

    v2v: -i ova: Refactor untar function.
    
    (cherry picked from commit d2f2c3f4b249accbd73868303870f2bc16e19b17)

commit 428e9d7317ea641ea6afabf86c6df9a350e9cd1b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 8 10:01:47 2017 +0100

    v2v: -i ova: Rearrange functions.
    
    No change, just move one function.
    
    (cherry picked from commit 6c0d520842d92fcdc022e598025a4e2b4a693b82)

commit 357fd0116f044eb37f5c4fa14549d5f1374f24ac
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed May 3 15:15:45 2017 +0200

    inspector: validate resulting XML files
    
    Run xmllint to validate the XML output files of virt-inspector, so the
    schema is checked against actual output of virt-inspector.
    
    (cherry picked from commit bf1d1d3685ef9188f824eebbffe5c917814fd215)

commit c1d48a9fce3f9c3ec7a076dd6c3161ddd08082a4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 28 09:59:23 2017 +0100

    common/options: Change drv struct to store drive index instead of device name.
    
    The device name is only used by guestfish (when using the -N option to
    prepare drives).  We constructed the device name very naively,
    basically ‘sprintf ("/dev/sd%c", next_drive)’.
    
    This stores the device index instead, and only constructs the device
    name in guestfish.  Also the device name is constructed properly using
    guestfs_int_drive_name so it can cope with #drives > 26.
    
    As a side effect of this change we can remove the extra parameter of
    the add_drives macro.
    
    Thanks: Pino Toscano
    (cherry picked from commit 8c9a4bc84f9727236d9a61405cab8e2bd1ef9041)

commit b045636463ac3153fe867a1d02a56bdf218c1bf8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 2 10:57:53 2017 +0100

    v2v: -o rhv: Add Windows 2016 Server type in OVF output (RHBZ#1447202).
    
    Thanks: Kun Wei
    
    See also:
    https://github.com/oVirt/ovirt-engine/commit/d233325d7b808e8bae83645ac645dfea9dfe8407
    
    (cherry picked from commit d0344f3522c116d3ccba6d52cd100562ee6e1e23)

commit c9a587f9c7ff86dbbd83ffa21dc55418237ffa1e
Author: Pavel Butsykin <pbutsykin@virtuozzo.com>
Date:   Fri Apr 28 17:04:15 2017 +0300

    appliance: more reliable check for the supermin appliance
    
    At least two control files (packages and base.tar.gz) are necessary for the
    supermin appliance.
    
    Signed-off-by: Pavel Butsykin <pbutsykin@virtuozzo.com>
    (cherry picked from commit f885fd227cf629a53e90cf61c7a2ccfd7a09ab43)

commit 4d8b68c57a9eb4519d23bb63a977cf0fe31c1087
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Apr 26 16:05:15 2017 +0200

    v2v: -o glance: add property for UEFI firmware (RHBZ#1445659)
    
    When converting a guest with UEFI firmware, set the also
    hw_firmware_type=uefi property for all the disks of the guest, so Nova
    can properly boot the guest.
    
    (cherry picked from commit 7409c9d9d36dc59f3b44824b8fd3b710225531ab)

commit 714271bbeb1839dbefa01f59eb53e44d8b2bf4fe
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Apr 12 17:58:40 2017 +0200

    appliance: add cdrkit-cdrtools-compat on openSUSE
    
    It looks like isoinfo is in that package since openSUSE Leap 42.1, so
    make sure to include it to not break the isoinfo* APIs.
    
    (cherry picked from commit 79c5acc13d713a911b4ed857555f68a6bbb8a41c)

commit d1fb02c317e06598074f39b36fe3f813c0083968
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 25 12:49:12 2017 +0100

    generator: python: Omit unused parameter names in match cases.
    
    (cherry picked from commit 965d253c7404e98c4a4e30f0633f118eedecbfe1)

commit 8ea761fd984577cac18a61ea58c8ca2da4f83a8e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 25 12:49:12 2017 +0100

    generator: perl: Omit unused parameter names in match cases.
    
    (cherry picked from commit 9243910ea23d2acf58047dc71b2cc096e44dd221)

commit 5f9a5fa37ece30b4c0bdf32ef0488b7cad7176f7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 25 12:37:01 2017 +0100

    daemon: Use CLEANUP_* functions to avoid an explicit free in stub functions.
    
    (cherry picked from commit 5a1257a886aba5aa21f02adc33b51ddd877786d5)

commit 43f0e303a6bebf8a9bbf7eaf6c8c3d30b5a8d06b
Author: Matteo Cafasso <noxdafox@gmail.com>
Date:   Tue Apr 25 00:19:59 2017 +0300

    daemon: ignore unused return value in upload function
    
    Signed-off-by: Matteo Cafasso <noxdafox@gmail.com>
    (cherry picked from commit ffbf1b5605ab02e49622b37b36d3cc04889094de)

commit 7a03dc8741957dd32e92d51d9725bcbdaea7ab4d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 20 15:08:24 2017 +0100

    daemon: stubs.h is generated, so should be listed in generator_built.
    
    Fixes commit 20f190617aafcddd08f99c0abec4fef90426ec9e.
    
    (cherry picked from commit 99813d11955a85725177a038be26ce25d720c426)

commit e5d497f4936fc51fe161ef1d2fe277edc2260fb1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 20 15:07:23 2017 +0100

    generator: daemon: Move *RESOLVE* macros to an ordinary header file.
    
    It's clumsy to define these in the generator, as they are essentially
    just static text.
    
    (cherry picked from commit ca12aaa90c7780a56bddd30c2199ca7b8d664979)

commit c2518c98631512ce8fad9f2d2db156a6d72a7c64
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 20 13:48:58 2017 +0100

    generator: daemon: Replace ‘cancel_stmt’ with ‘is_filein’ flag.
    
    In every instance where we used the ‘cancel_stmt’ parameter of
    these macros:
    
      ABS_PATH
      NEED_ROOT
    
    the value was only ever ‘cancel_receive ()’ or empty.  We only use
    ‘cancel_receive’ for FileIn functions, so replace it with a simple
    flag for whether the current function is a FileIn function.
    
    This also removes some incorrect comments about macros that cannot be
    used with FileIn functions when in fact they can.
    
    (cherry picked from commit 3f3dfe68de9910af2c5dcbac747e4164b0fb02de)

commit 270be5441aa57d922c85bbdbdf8b85dc31f91ec5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 20 13:35:17 2017 +0100

    generator: daemon: Remove fail_stmt parameter from *RESOLVE* macros.
    
    As a simple consequence of the previous commit, every instance of the
    ‘fail_stmt’ parameter to one of the following macros:
    
      RESOLVE_DEVICE
      RESOLVE_MOUNTABLE
      REQUIRE_ROOT_OR_RESOLVE_DEVICE
      REQUIRE_ROOT_OR_RESOLVE_MOUNTABLE
    
    is now ‘return’ and therefore we can replace it in the macro and drop
    the parameter completely.
    
    (cherry picked from commit 5200e51719624fc675747b14d7e210614fb3ec94)

commit 1b5f74b39a8ed5056de04bfdf3c834e4ee555663
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 20 13:28:04 2017 +0100

    generator: daemon: Remove done label.
    
    As a simple consequence of the previous commit, the ‘done’ label can
    be removed, and any instance of ‘goto done’ can be replaced by
    ‘return’.
    
    (cherry picked from commit 671b1d10a0be604d4975f94ec0cc52f94ffaf20e)

commit 69bab5ff403a36ccdf13b852c7e0cdb9f5b3c58d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 20 13:23:49 2017 +0100

    generator: daemon: Use a cleanup function to free XDR args struct.
    
    Previously stubs were generated like this:
    
      void
      fn_stub (XDR *xdr_in)
      {
        struct guestfs_fn_args args;
        ...
        // on error paths, ‘goto done’
        ...
      done:
        xdr_free ((xdrproc_t) xdr_guestfs_fn_args, (char *) &args);
      }
    
    This replaces the call to xdr_free with a generated cleanup function.
    
    (cherry picked from commit 378cb6f818ec401e4fe77b59c955f3c3cb3da274)

commit 6023d750612552fa2df02803ee3ea6f8d02f09a9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 20 13:00:21 2017 +0100

    generator: daemon: Get rid of useless done_no_free label.
    
    The generated code had:
    
        ...
      done_no_free:
        return;
      }
    
    There was no possible code between the label and the return statement,
    so both the label and the return statement are redundant.  The
    instances of ‘goto done_no_free’ can simply be replaced by ‘return’.
    
    The only small complication is that there is a label just before this
    which contains some optional code.  So we might have ended up with
    generated code looking like:
    
      done:
        // if there was no optional code, this would be empty
      }
    
    which provokes a parse error in C.  Therefore I had to add a semicolon
    after the ‘done:’ label.  This will be removed in a subsequent commit,
    so it's just to make the current commit bisectable.
    
    (cherry picked from commit b2cd4367b1883f68be6beb86da1cfc8d42cadf5b)

commit 93cb3e76f0eed8bc0389d69ac0e92166e2f2682e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 19 17:07:55 2017 +0100

    daemon: Add an assertion to suppress a warning with GCC.
    
    swap.c: In function 'do_mkswap_U':
    swap.c:62:9: error: argument 1 null where non-null expected [-Werror=nonnull]
         if (strlen (label) > SWAP_LABEL_MAX) {
             ^~~~~~~~~~~~~~
    
    (cherry picked from commit 8b68d00977ae4d2b00f6e26c73bcc877ff54b6d1)

commit b90d2b816b2657894d06f4ed17fb78b73d65c9a0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 19 16:55:16 2017 +0100

    daemon: Remove use of fixed-size stack buffers.
    
    GCC 7 complains that the fixed size buffers are not large enough
    (at least in theory) when using ‘-O3 -mtune=broadwell’.
    
    (cherry picked from commit 2de5e317adb925475a5b88cf534a769f4c3bfe59)

commit 5a6faafee7ca3c82a6cff8a2cf75a81193334346
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 19 17:26:03 2017 +0100

    lib: Reimplement is_zero.
    
    As suggested by Eric Blake.
    
    (cherry picked from commit 067d442cdc906840f1775bae3883c5aee9806458)

commit 6dd40cc225c25ec6bbe9f925ba35946819869677
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 19 14:32:49 2017 +0100

    daemon: Move the useful 'is_zero' function into common code.
    
    This is largely a simple refactoring, but it combines another
    definition of this function from virt-builder which had a slightly
    different prototype.
    
    (cherry picked from commit c0fdeb36c7f86791cb0a77f11bfa9c366f561e82)

commit 09f65b62e08cb0cec2f95aa49c5737838d6ac3ba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 18 12:38:21 2017 +0100

    lib: libvirt: Document virtio-scsi controller/bus/target/unit fields.
    
    This adds comments documenting what the fields correspond to in qemu,
    and the range of each field.
    
    (cherry picked from commit 7eb26f03b95277f12f7fff06a4bfb135cb1f776f)

commit a896590a56225982ca10ba220bd09da4f3b65ac9
Author: Pavel Butsykin <pbutsykin@virtuozzo.com>
Date:   Thu Apr 13 19:44:07 2017 +0300

    daemon: add udev_settle_file to is_root_device
    
    It fixes a fail with ENOENT when device is not yet present after system boot.
    
    Signed-off-by: Pavel Butsykin <pbutsykin@virtuozzo.com>
    (cherry picked from commit 684aa261157bad7aa0409db91d07d84537325673)

commit d2e04db05c1e87f23ff7a737ab1a71292968e4a3
Author: Pavel Butsykin <pbutsykin@virtuozzo.com>
Date:   Thu Apr 13 19:44:06 2017 +0300

    daemon: run 'udevadm settle' with --exit-if-exists option
    
    Add udev_settle_file() to run 'udevadm settle' with --exit-if-exists option. It
    will slightly reduce the waiting-time for pending events if we need to wait
    for events related to a particular device/file.
    
    Signed-off-by: Pavel Butsykin <pbutsykin@virtuozzo.com>
    
    RWMJ:
     - Use local variable for MAX_ARGS.
     - Use commandv instead of commandrv, fix checking of return code.
    (cherry picked from commit 93664d38d26afb1086fc4a56ef9e6e58dcb1a3ec)

commit 6bf905c305e3fd9b05953669b3fde4d76a9aac4c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 12 23:09:32 2017 +0100

    v2v: windows: Install both legacy and modern virtio keys in the registry (RHBZ#1431579).
    
    Thanks: Kun Wei (for finding the bug)
    Thanks: Ladi Prosek (for diagnosing the problem and proposing the fix)
    (cherry picked from commit d8e1c4bb474203d71903261fb06fe267c3cce3c7)

commit 0eeb0c38fa2ef292165a17f0b501059264347ffb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 13 00:10:28 2017 +0100

    mllib: Bind %identity C primitive to Common_utils.identity.
    
    (cherry picked from commit 9e0781f0969c8290222ac4da5042084c2069fc61)

commit 98bd5a55f5ab470221b165d4818360a597d2264a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 13 10:11:00 2017 +0100

    v2v: -o rhv: Document how to test RHV conversions without RHV.
    
    (cherry picked from commit c509abef437d80268911833a8e54cde6d66820e8)

commit fbf330e377f542b4682d14ace54d0cdd5b34625f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 13 09:57:37 2017 +0100

    v2v: -o rhv: Quote parameter to rm -rf.
    
    This was safe before, the change just prevents accidental errors.
    
    (cherry picked from commit 24a6c5b57c25e0e59697831b55000d6f8e21fd38)

commit e48ce74f77c64036bde55d1dc8b628381e5dd018
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Apr 10 11:29:17 2017 +0200

    builder: various improvements to the documentation
    
    - convert the Fedora 20 examples to Fedora 25
    - convert the yum examples to dnf
    - convert the Debian 7 examples to Debian 8
    - mention that --core updates all the installed packages, not "core"
      ones
    - convert i386 to i686 for the Fedora 32bit examples
    - mention that autogenerated root passwords are printed on stdout
    - mention --get-kernel is deprecated in favour of virt-get-kernel
    - update URL to the Puppet installation documentation
    - edit the repository index documentation to make it clearer
      non-compressed templates are supported
    - remove old wrong paragraph about customization specified in command
      line not processed in the same order
    - use --install instead of --run-command '$pkgmgr install ...'
    - other minor changes
    
    (cherry picked from commit 56c4387b38a3ef48658d303e6d846315512fcacf)

commit c038a6c15c08efafbd0879e5f59bb2dee7aadd7d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 11 08:32:04 2017 +0100

    mllib: Add Char.hexdigit function.
    
    Same as the function defined in fish/fish.c.
    
    (cherry picked from commit ef261d69ed199cc07474a36c890f63df461b35a7)

commit b87f6c755f384da2d28f94f2d666087e2780ac6f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 11 08:29:47 2017 +0100

    ocaml: Add Bytes.sub_string function to Bytes compat module.
    
    This is only used when OCaml < 4.02 (eg. RHEL 7).  For more recent
    versions the real Bytes.sub_string function is used instead.
    
    (cherry picked from commit bb846887de7a252204152c3e6df80d39a5ea33af)

commit 26f304102e00ad56ff3fda0f711fcaff6834318e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 11 14:52:24 2017 +0100

    v2v: -o qemu: Add a comment about ICH9 audio device.
    
    Just a comment.
    
    (cherry picked from commit aa16d5ca8ed8ea4a9cec4ab6fe578c34bf183c06)

commit 326c850a67411cbb9a1a96f0e5c73dc06968d80a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 11 12:16:51 2017 +0100

    v2v: -o qemu: Fix creation of ICH6 sound device.
    
    Fixes commit f6ece2c01a9a1a43d6715103e7dbdda0f09ee862.
    
    (cherry picked from commit e562f52c95fe8eefdab778918d152335f56012c6)

commit 73d52ab96f106a7a5f494aee98fa93ccafde6d9d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 6 11:15:22 2017 +0100

    builder: Allow GnuPG v2 or v1 to be used (RHBZ#1438939).
    
    All of the GPG commands we run are compatible with either v1 or v2, so
    this simply involves looking for either gpg2 or gpg binaries at
    runtime.
    
    (cherry picked from commit 069eb3d3df891365b94f5ec4c09ef8a50d7e13c1)

commit f74f055faf61b43d60661b542b40eee984c34cff
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 6 10:24:50 2017 +0100

    v2v: linux: Print best kernel in debug output.
    
    After sorting kernels to find the best one, print the best kernel if
    verbose is enabled.
    
    (cherry picked from commit f5ce03c4dafe084111c832fa23353b66a9f8a553)

commit 3b3d11b878a988fee9d5e1d46a36803ab720648f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 5 13:55:28 2017 +0100

    v2v: linux: Replace 'ki_supports_virtio' field.
    
    Previously the kernel_info field 'ki_supports_virtio' really meant
    that the kernel supports virtio-net.  That was used as a proxy to mean
    the kernel supports virtio in general.
    
    This change splits the field so we explicitly test for both virtio-blk
    and virtio-net drivers, and store the results as separate fields.
    
    The patch is straightforward, except for the change to the
    'rebuild_initrd' function.  Instead of making the module list
    conditional on whether virtio-net is available and using the old
    (probably wrong) fallback if it happens to be unavailable, this now
    tries to enable the common virtio kernel modules (just the ones needed
    for virtio-blk and virtio-net to work).  The fallback is only used if
    none of the common virtio modules can be found.
    
    This also adds a print_kernel_info function (as the
    string_of_kernel_info function was unwieldy) and exports it from the
    module.
    
    (cherry picked from commit e6c9c4f69f10fecbf372253f44afe22389ebcb30)

commit 28605ae01e0c1404b2aff10bc6fd39b2f7629597
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 5 13:44:00 2017 +0100

    v2v: linux: Fix Xen PV-only detection.
    
    We want to detect if a Linux kernel is Xen PV only ("PV-only").  Such
    a kernel will not boot on KVM, and if a guest has only PV-only
    kernels, it will not be able to boot at all on the target.
    
    Our previous test was wrong.  It tested whether the xennet.ko module
    exists.  This module was renamed in more recent kernels (to
    xen-netfront.ko), so it happened to not detect modern kernels as
    PV-only, but this was by chance.
    
    Modern kernel images can be compiled with Xen PV guest support.  The
    same image can boot on baremetal, KVM, Xen PV or Xen HVM.  Testing if
    the xennet (or xen-netfront) module exists is irrelevant to this.
    
    This test, which is based on ideas from Laszlo Ersek and
    
      https://wiki.xen.org/wiki/Xen_Project_Software_Overview#Guest_Types
    
    uses the kernel config test CONFIG_X86_XEN || CONFIG_X86_64_XEN to
    determine PV-only kernels.
    
    Note that these CONFIG flags were never upstream, and existed only in
    Linux kernels forked by Xen ("XenLinux").  By the time Xen guest
    support was added upstream, it was implemented using pvops support, so
    a single image could boot on Xen and non-Xen as described above, and
    these flags were no longer used.
    
    Updates commit 7eb219d1938968c4d6bffda038aaace936f7efbf.
    
    Thanks: Laszlo Ersek.
    (cherry picked from commit 413ebec0392892ca36b86f416f650090ef8825d3)

commit 39eea2c1fd5a6a79b3b6719de32b791ebacc9ec5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 5 13:35:58 2017 +0100

    v2v: linux: Don't return virtio flag from configure_kernel function.
    
    This is pure refactoring, no change to functionality.
    
    (cherry picked from commit 95f1e83bafafba38c8c745630bce5da3367265b5)

commit a1f15e13a866744b0d34c09627f61f5aabe7d995
Author: Pavel Butsykin <pbutsykin@virtuozzo.com>
Date:   Mon Apr 3 19:44:45 2017 +0300

    v2v: windows convert: fix virtio block driver installation for w10/w2k16
    
    This patch fixes the problem of the first boot after installation virtio block
    drivers on Windows 10 / Server 2016. The problem is related to the change in
    the behavior of Windows-Kernel-Pnp. To fix we need to add a field "Version" to
    HKLM/SYSTEM/DriverDatabase/DriverPackages/drv_inf_label then Windows-Kernel-Pnp
    will be able to correctly install the virtio block driver.
    
    Signed-off-by: Pavel Butsykin <pbutsykin@virtuozzo.com>
    (cherry picked from commit cc162b49e6c87bf3535168853dadf10f7610865f)

commit 852143fb97f6c0e91af45103e2134cbd07e6800f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 31 11:47:34 2017 +0100

    po: Fix charset=CHARSET -> charset=utf-8 in pot file.
    
    (cherry picked from commit 604be8ced8c11e9096e1cf7efcd2a8fcd4ee75c2)

commit cfd1f6a6b03081420f026131aee72ed08e3d213f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 31 09:51:17 2017 +0100

    perl: Add =encoding to Sys::Guestfs man page.
    
    Otherwise the man page cannot contain any non-7-bit-ASCII characters.
    
    The test error seen was:
    
    Failed test 'POD test for blib/lib/Sys/Guestfs.pm'
    at /usr/share/perl5/vendor_perl/Test/Pod.pm line 187.
    Wide character in print at /usr/share/perl5/vendor_perl/Test2/Formatter/TAP.pm line 112.
    blib/lib/Sys/Guestfs.pm (1811): Non-ASCII character seen before =encoding in 'caller’s'. Assuming UTF-8
    Looks like you failed 1 test of 1.
    
    (cherry picked from commit ee9af92963144b646c8568fdd2f3ae80b2d78490)

commit 9ae1e0e7016069af1dffb7c61a72e3feb7351e56
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 31 09:13:10 2017 +0100

    docs: Fix documentation for btrfs_group_limit API.
    
    (cherry picked from commit e0385c6902e2f0a98880f4a3079a7427903f6361)

commit 41a8ba8b2f3426e109c7c194ccf626f34e709cb0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 30 22:11:15 2017 +0100

    v2v: utils: Remove another reference to kraxel's OVMF repo.
    
    Updates commit 889386f8c6088e57fd68f2bb6bf85f69ecfc6f6c.
    
    (cherry picked from commit 707c60ccb3db91a5eabaa8a1ec994e0058f20efc)

commit 2fdedc6875111b747261bbb31bda011d3b77ca9e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 28 23:03:31 2017 +0100

    p2v, v2v: Ensure the full version is always available in several places.
    
    Ensure the full version of virt-v2v and virt-p2v is available in the
    conversion log file, the only log file that we reliably get from users
    and customers.  "Full version" means the major, minor, release and
    extra fields.  The extra field is especially important as it contains
    the downstream package release in Fedora, RHEL etc.
    
    This change saves the virt-p2v version as a comment in the
    physical.xml file, which is included in full in the conversion log (by
    virt-v2v).
    
    It also ensures that the initial virt-v2v debug message contains the
    full version number including the 'extra' field.
    
      $ cat virt-v2v-conversion-log.txt
      virt-v2v: libguestfs 1.37.7local,libvirt (x86_64)
      ...
      <!-- virt-p2v 1.37.7local,libvirt -->
    
    It also adds 'p2v-version' and 'v2v-version' files in the virt-p2v
    debug directory.  These are strictly superfluous but could be useful
    for end users.
    
      $ cat p2v-version
      virt-p2v 1.37.7local,libvirt
      $ cat v2v-version
      virt-v2v 1.37.7local,libvirt
    
    (cherry picked from commit 7cae10f0c11ebde643ec575f7f779aa1e7103d6b)

commit a1851ebd056b956365762c3546797eb9ca42bb08
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 30 12:27:57 2017 +0100

    p2v: Rebuild dependencies.* files if config.status changes.
    
    If you switch from ./configure --with-gtk=2 to =3 (or vice versa) the
    dependencies files don't get rebuilt.  As a result the wrong Gtk
    libraries can be included in the ISO and virt-p2v won't run.
    
    (cherry picked from commit 86a166458c062cc8add8df94fc404d6a67616e14)

commit a0715fd11b372ba25b55daf5ec0f77215419bca9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 30 12:27:39 2017 +0100

    docs: security: Document new CVEs in PCRE which may affect inspection.
    
    (cherry picked from commit 8ee74dcc472fda3622adc2a6725856b1f331979c)

commit 41254d5e22ac359bd7210e94a85e4e616aee279c
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Mar 29 18:54:49 2017 +0200

    mllib: cast integer pointers to intptr_t as intermediate step
    
    This make sure there is no mismatch between the size of the integer
    value that Int64_val returns, and the size of the guestfs_h pointer.
    
    This should fix the warning on 32bit environments (and thus build, when
    --enable-werror is enabled).
    
    (cherry picked from commit c85eb443db07d337a365619bd7b2267e29a8d4da)

commit 61c1a6091868244e4887c6472d349112816f3666
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Mar 29 15:57:40 2017 +0200

    automake2junit.ml: escape text in message of <skipped>
    
    Escape XML characters in the logs to use as message for <skipped>, so
    special characters such as &, ", and < do not make the whole XML
    invalid.
    
    (cherry picked from commit 12c4cc7a6b81c8de87f6500f75f71ff1085ea255)

commit 87c475c3dff6f82940b6ea17255d4214998badb4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 27 17:41:32 2017 +0100

    v2v: In --help output, note that --compressed only applies to -of qcow2.
    
    Just a minor documentation change.
    
    (cherry picked from commit 5faa917972fc45c75fda10a7235af8cc38a68708)

commit 1507025ff9b1721d2e7daec26e4ab39599d1acd3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 25 12:11:48 2017 +0000

    docs: hacking: Document 'make maintainer-*' targets.
    
    (cherry picked from commit 9287e8954df0e38dd461fd413165446b84345a95)

commit 95f17c6e4189bbad6575ad9967e0ae3723286140
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 25 12:03:23 2017 +0000

    docs: hacking: Fix the headings.
    
    Just grouping things more logically.
    
    (cherry picked from commit ea13da21ead3a67e8957eec7f3fb84123a260801)

commit 272154fb4b03251317d2afdb8c7ced5195cb9942
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 24 12:03:30 2017 +0000

    Version 1.36.3.

commit 484a41abddcc22dede2c4be9a39386065f0870c0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 24 11:19:27 2017 +0000

    tests: v2v: -i ova: Fix test for reordered XML.
    
    Commit 8e617b792f9c7cc8131ba59c0b0a9c545356778d reversed the order in
    which the <features> and <os> sections appear in the XML.
    
    (cherry picked from commit 0782da088b4bf8666ac33fcfdb7bce31570bd7ad)

commit 934a9acad8aa92454ab7e2e5ffb0de4a02510aaf
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Mar 24 11:04:14 2017 +0100

    inspect: get a more common size icon for ALT Linux guests (RHBZ#1433937)
    
    A 64px icon does not exists everywhere, so just use a 48px one.
    
    Updates commit bc54e0d605682385f460c6e90ba87c5a48f8077e and
    commit 9928296c1ca8df5bd8f108ed00039adc6468cac3.
    
    Thanks to: Xiang Hua Chen.
    
    (cherry picked from commit 439b9189f0e2834c97ada3af0b0d959d394726ea)

commit 9ef20bf813a2d57f44779cf635daf530d68da09a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 24 08:59:53 2017 +0000

    bash: Implement tab completion for virt-win-reg (RHBZ#1367738).
    
    This only implements long and short options.
    
    Thanks: Ming Xie.
    (cherry picked from commit 5acd69ed6cf2d186b0ee7a83d1a80f9cdc54abf5)

commit 1679d58eec411fc69e342a3774cf70be6726e593
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 22 15:44:18 2017 +0000

    v2v: xen: Require direct backend when doing Xen conversions over SSH.
    
    Unfortunately libvirt has another bug related to the qemu
    ssh driver, as described here:
    
      https://bugzilla.redhat.com/show_bug.cgi?id=1434651#c3
    
    (The libvirt bug is https://bugzilla.redhat.com/1140166)
    
    Until this bug is fixed we have to require the direct backend to be
    used for xen+ssh conversions.
    
    This partially reverts commit ecbf09385033ba0acf14e914927ec81ad20a5308.
    
    (cherry picked from commit 7cf85ace19231085e514b980bd13b7976e21a242)

commit 70750a1c41efa429b837dfb2dd950a9b9062bce4
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Mar 22 17:10:42 2017 +0100

    inspect: improve detection of Mageia install discs
    
    Check for a "product.id" file in an architecture-specific subdirectory
    of the main partition, and use its data to improve the data on the
    media.
    
    Only Mageia as distribution name is recognized there, since most
    probably this file will not be available on other distros.
    
    (cherry picked from commit 46d5a26ddc58dc2ec5aa76e1d08a96b5556c5859)

commit 3076bd19b21bffff51093840e8be2730485ddbce
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 22 10:30:12 2017 +0000

    bash: Add a bash completion script for virt-v2v-copy-to-local (RHBZ#1367738).
    
    Thanks: Ming Xie
    (cherry picked from commit 2f25d23ac85bbc341459da03da6cfa6d85dae8dc)

commit 66b83a10c67e9adf23a0097c131c6746c1ec6532
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 21 17:19:52 2017 +0000

    p2v: gui: Change mnemonics so 's' is not used twice (RHBZ#1379289).
    
    Change mnemonics so 's' is not used twice:
    
      Start Conversion: 's' -> 'c'
      Output Connection: 'c' -> 'o'
      Output Storage: continues to use 's'
    
    Thanks: Ming Xie.
    (cherry picked from commit 9d6b1ec28811255ec4447e3f67eb508f0b6f8396)

commit 3a7857fe82d9b2e6d439a71cfedf40e6da99dc89
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 21 13:12:09 2017 +0000

    p2v: Allow setting QEMU_OPTIONS when testing qemu in a VM.
    
    Also document both QEMU and QEMU_OPTIONS in guestfs-hacking(1).
    
    (cherry picked from commit cecf1ea135fa286c1616e1438f57fb7796909498)

commit fd8f9caa6c4a30e0c4c198d744b2a0587df500c0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 20 16:54:51 2017 +0000

    daemon: selinux: Add setfiles -m option to suppress extra excludes (RHBZ#1433577).
    
    (cherry picked from commit fc0abf2354e38394c5e930b01221fcdfe05797b8)

commit 852d7378aac22bb075685294544efd3178bc9bb7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 20 15:02:33 2017 +0000

    v2v: inspect source: Don't tell people twice to run virt-v2v -v -x (RHBZ#1167623).
    
    There were two related bugs in the virt-v2v error messages when source
    inspection failed.
    
    Firstly it would print the message about running 'virt-v2v -v -x' twice:
    
      virt-v2v: error: inspection could not detect the source guest (or physical
      machine).
    
      Assuming that you are running virt-v2v/virt-p2v on a source which is
      supported (and not, for example, a blank disk), then this should not
      happen.  You should run 'virt-v2v -v -x ... >& log' and attach the complete
      log to a new bug report (see http://libguestfs.org).
    
      No root device found in this operating system image.
    
      If reporting bugs, run virt-v2v with debugging enabled and include the
      complete output:
    
        virt-v2v -v -x [...]
    
    And secondly it would tell you to run virt-v2v -v -x even if you were
    running with verbose messages.
    
    Further fix for https://bugzilla.redhat.com/show_bug.cgi?id=1167623
    which updates commit ab7197476de1cb3c8727caf4da429f6293ca4227.
    
    Thanks: Kun Wei.
    (cherry picked from commit 84d791cda138f03fd7f1d14b6d358261e624348f)

commit 736e35e72a1c4382ea64b7a749b59d6fab643633
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Mar 20 13:45:56 2017 +0100

    inspect: get a better icon for ALT Linux guests (RHBZ#1433937)
    
    Use a 64px icon which is in the menu-icons-default package, hopefully
    part of the default installation of any flavour.
    
    Updates commit 9928296c1ca8df5bd8f108ed00039adc6468cac3.
    
    Thanks to: Xiang Hua Chen.
    
    (cherry picked from commit bc54e0d605682385f460c6e90ba87c5a48f8077e)

commit 63c55b49c1cac55258b6acac26ac039e6e0351cb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 20 10:46:58 2017 +0000

    customize: slow-tests: Test Fedora 25 instead of Fedora 24.
    
    Just an update so we're testing the latest available version of Fedora.
    
    (cherry picked from commit 0b5e3b1196c8def229b9c81fa7f1d87b80257eb0)

commit 0c9373575aa05f2cf6264648a2337c1fb0f226bb
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Mar 17 17:57:40 2017 +0100

    p2v: virt-p2v-make-disk: prevent daemons to run on Debian
    
    On Debian systems, usually daemons are run automatically after their
    installations; since we are upgrading the template, and installing
    packages such as openssh, network-manager, etc, this may cause few
    daemon to stay running during the virt-builder execution, causing it to
    fail when shutting down (since e.g. /sysroot/dev would be in use).
    
    As workaround, use a temporary policy-rc.d policy layer [1]: give an
    error code so no daemon is ever started at any point of package upgrades
    and installation.  The script is removed at the very end of the
    building, so the final image will spawn daemons just fine when booted.
    
    [1] https://people.debian.org/~hmh/invokerc.d-policyrc.d-specification.txt
    
    (cherry picked from commit fdd3dd7a7fd1d8d7feaf505b34f81d4b537e0832)

commit 56d75dc2d20b1ed52fe83cd70741844ff00acc5e
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Mar 17 17:51:54 2017 +0100

    p2v: virt-p2v-make-disk: fix systemd paths
    
    Usually systemd is configured with prefix=/, so units are in
    /lib/systemd.  On a system with UsrMove, such as Fedora/RHEL7, /lib is
    a symlink to /usr/lib, so both /lib/systemd and /usr/lib/systemd work;
    OTOH, on non-UsrMove systems, such as Debian, the two paths are
    different locations, and thus trying to edit system files as
    /usr/lib/systemd/etc will fail.
    
    As solution, just reference /lib/systemd for systemd files.
    
    (cherry picked from commit 99818be41025828bffc6c3eec8724b43a9bf5a7f)

commit b76650a3076804991639e5b8cfaa100f69d6b562
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Mar 17 17:48:49 2017 +0100

    p2v: remove network-manager-applet Debian dependency
    
    On Debian, network-manager-gnome contains nm-applet, which is what
    launch-virt-p2v spawns.  network-manager-gnome is already in the list of
    packages for Debian, while network-manager-applet does not exist.
    
    (cherry picked from commit 6913630004accc4ef0609ae39ca302087df7bcbf)

commit 99c10492598625c3a11bbdea3f07bbaa2307b100
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Mar 17 17:43:42 2017 +0100

    p2v: fix Gtk dependencies on Debian
    
    On Debian, the names of the packages containing the Gtk 2 and 3
    libraries have different patterns, and thus just the name will not work
    for Gtk 3.
    
    Apply a bit of m4 to use a different package name on Gtk 2 and other
    versions.  It can be easily adapted to new models in future Gtk 4+,
    should the naming pattern change from Gtk 3.
    
    (cherry picked from commit 80029641b45a11af3232f7e0ee62b4962e130bd0)

commit 4a6f57af5ec3f288aac3dbc6aa3db697d8841a45
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Mar 17 16:18:57 2017 +0100

    btrfs_filesystem_show: work with another old btrfs version
    
    An old version of btrfs-progs (3.17 in this case) has a different
    version string, so adapt our filtering to include this line as well.
    
    Related to/updates commit 839ae5bcd537b3dc4f13bbea6fe40091ebc2b7f0.
    
    (cherry picked from commit 12bfb3c6319b10b379d5deb1f5e163462f0aca41)

commit d50df2516113d65c076f5645b24fdef1d31680bd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 18 18:31:10 2017 +0000

    tests: Add further valgrind suppressions for glib and gtk3.
    
    (cherry picked from commit 2e93f72297f6ec3522747896ba0493a520ac1e1d)

commit ec6b68fdf606e04a1eb7805e371acbb555235717
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 18 10:11:13 2017 +0000

    test-data: Use another name for boot and root MD devices.
    
    mdadm 4.0 no longer lets you create devices called literally "boot" or
    "root", giving a very obscure error message:
    
    https://bugzilla.redhat.com/show_bug.cgi?id=1433575
    
    Work around this by calling them something else.
    
    (cherry picked from commit 327caa1f084acca6fba288781c99002b6a71aff7)

commit 8a2dae62c09b839f373bbb5b698068c902e5eae2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 17 15:20:57 2017 +0000

    v2v: Add new test-v2v-print-source.* files to EXTRA_DIST.
    
    Fixes commit 12a3b735f92727c15fd5bc5c492ad90a29002174.
    
    (cherry picked from commit 589261d99f01eb2004b4e13949dd12b8b575c9ea)

commit 1da1296ef4fc5e779c8c69299e53b16554497e3c
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Mar 17 13:39:56 2017 +0100

    p2v: un-duplicate common dependencies
    
    Move all the dependencies with the same name in all the distributions to
    a single list at the end.
    
    There should be no change to the package list used to build the p2v ISO.
    
    (cherry picked from commit df29936cf8bbf2b9e3f58167cf69129e3c851fb6)

commit c3366917bd24e7d0739e666b28938e34a47690a4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 17 11:11:45 2017 +0000

    v2v: -o glance: Build properties list imperatively.
    
    No change, just refactoring.
    
    (cherry picked from commit c5fe98dde4df26283dbdaf0d66139e9120701b09)

commit ee3ff29f9cef12d10efbc24859401242715a215e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 16 17:37:41 2017 +0000

    v2v: -o libvirt: Refactor creation of XML body.
    
    Just refactoring, no change in semantics.
    
    (cherry picked from commit 8e617b792f9c7cc8131ba59c0b0a9c545356778d)

commit 35786a060a81d527fdb4f22748f031ec0362d079
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 16 17:59:42 2017 +0000

    tests: v2v: Rearrange test-v2v-print-source.
    
    This rearranges the input files for the test of virt-v2v
    --print-source, but does not change its semantics.
    
    (cherry picked from commit 12a3b735f92727c15fd5bc5c492ad90a29002174)

commit f1558fbbe63aa021ba62b9ceafe371a5fecb098a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 16 21:46:14 2017 +0000

    p2v: Enable check-valgrind in this directory.
    
    A couple of valgrind suppressions are required to work around memory
    leaks in Gtk.
    
    (cherry picked from commit a73f4599046326bced5281def13775cb98a05cfe)

commit cf4ab4db16ce94aefc98f70b8411196ff0a70269
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 16 21:55:54 2017 +0000

    p2v: Free config struct before exit.
    
    Memory leak found by valgrind.
    
    (cherry picked from commit 9170513c8a8895d66b36c5bdd0baa12001afa7ee)

commit 43f855588acec8d5c3ebbbca570a91aacbab33b1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 16 12:10:21 2017 +0000

    p2v: Add awk as a dependency.
    
    The code to parse /proc/cpuinfo runs awk, but it was not included as a
    specific dependency so the parsing code might silently fail.
    
    (cherry picked from commit 9bba13b9cff0332730923eb297ad80b6e3be9bd4)

commit df026c5ff177e0e8c965e636776a702bd7309b82
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 16 09:58:09 2017 +0000

    lib: direct: Don't ever use -no-kvm-pit-reinjection.
    
    On qemu 1.1.2:
    
      qemu-system-x86_64: -no-kvm-pit-reinjection: invalid option
    
    Thanks: John Sucaet.
    (cherry picked from commit c0a8afb3e6d0ce96c5062265b35813f7812686bd)

commit ab074aeaa59ef60075876bb33f532cba067d7d08
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Mar 16 18:01:37 2017 +0100

    dib: avoid using Unix.O_CLOEXEC
    
    It looks like Unix.O_CLOEXEC does not exist in OCaml < 4, so resort to
    manually using Unix.set_close_on_exec on the filedesc after opening it.
    
    Thanks to: John Sucaet and Richard W.M. Jones.
    
    (cherry picked from commit ece9c35e58a3ba18ac9bed955251482bb774ab97)

commit 26bb7577c3434ddc7ac55fefef5dc978de75e616
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Mar 15 16:45:41 2017 +0100

    generator: open Common_utils where needed
    
    This makes it possible to use the operators from Common_utils that do
    not exist in older OCaml versions (e.g. < 4.00).
    
    Thanks to: John Sucaet.
    
    (cherry picked from commit 509adede7b4ba5d419efc7f6483f3d9d99d27233)

commit c31d1885f05c9778b8b382a1cd33e90eaf150ef8
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Mar 15 11:07:43 2017 +0100

    v2v: linux: accept 'scd' devices in fstab
    
    Avoid warnings for another kind of SCSI CD-ROMs in fstab, like it is
    done already for other CD devices.
    
    (cherry picked from commit 2f22f2c46981490b8dfdb3bcb6efdf46a916e415)

commit 0c8b6a1588f5fd035355ab7008b75c47f5fb820a
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Mar 14 14:43:53 2017 +0100

    v2v: bootloaders: look for device.map also in /boot/grub (Grub2)
    
    On Debian-based systems, Grub2 is in /boot/grub (as already known after
    commit 03b9f2b967c4c61a5acda6a3802317be109d213e), so make sure
    device.map is changed even in this situation.
    
    (cherry picked from commit da4757fd157a60c7ba4a224b40ccf49a1d0c38a4)

commit 4e48b622a1ad9bcd9bceb82985bba3af380bf579
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Mar 14 14:40:08 2017 +0100

    v2v: OVF: add Debian and Ubuntu osinfo variants
    
    Unfortunately, there are very few osinfo types available for Debian and
    Ubuntu, so make sure to use them only when the version is enough, and
    use the higher version available also for any following version.
    
    (cherry picked from commit 4e5f011508dd0c3ae0ee80d144a9728489370786)

commit 84dfa249152a7d20373f2d19c902695485d04f87
Author: Yann E. MORIN <yann.morin.1998@free.fr>
Date:   Mon Mar 13 23:42:37 2017 +0100

    configure: fix check for attribute cleanup
    
    In cross-compilation, it is not possible to run tests, so the configure
    aborts when checking for attribute cleanup.
    
    The comment above the test hints at why we would need to do an actual
    run test rather than a compile test: gcc only warns on unrecognised
    attributes.
    
    But warnings can be turned into error with -Werror.
    
    Change the AC_RUN_IFELSE into an AC_COMPILE_IFELSE test that runs with
    -Werror set. Save the CFLAGS before adding -Werror, and restore them
    after the test.
    
    Signed-off-by: "Yann E. MORIN" <yann.morin.1998@free.fr>
    (cherry picked from commit 0d023e7f3d9d86a1ecb48140337266da5381300b)

commit f147e4d6e368e5fd31bd3ed6f12dd206423b39a8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 10 13:13:10 2017 +0000

    v2v: Add a root test for access to root-only-readable OVAs (RHBZ#1430680).
    
    (cherry picked from commit ebb0d32395ee90af862d7fed33891174a3599091)

commit 5bcb6f4ecc76e14e3ecac8fa771db5e4b18fb85b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 10 13:02:54 2017 +0000

    tests: Add infrastructure for running certain tests as root.
    
    '[sudo] make check-root' is analogous to 'make check-slow'.
    
    (cherry picked from commit 80d3e0548316bb7ec5ea957bafb94163ad6a8c21)

commit f8b2790400fcb462b3240426ec4e26f279f794da
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 13 12:20:41 2017 +0000

    v2v: chmod original OVA file if running as root (RHBZ#1430680).
    
    In the case where we are going to read the disk directly from the OVA
    file (partial = true), we will create a qcow2 image backed by the OVA.
    If running as root, libvirt will run qemu as a non-root user (because
    of no qemu:///session support for root, which is a libvirt bug).  qemu
    will not be able to read the backing file and thus will fail.
    
    To work around this problem, chmod the backing (OVA) file.
    
    This isn't a complete fix since (eg) the OVA might be located in a
    directory which isn't accessible by root, but there's only so much we
    can do here until libvirt is fixed.
    
    Thanks: Kun Wei.
    (cherry picked from commit 542eb560bd8c7b24d4628837730d636713d02f56)

commit 392eda2f1eb5e7bf6a572f1f616a67f612277ba0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 13 14:21:56 2017 +0000

    v2v: -i ova: Use full path for backing file.
    
    Works around a libvirt bug:
    https://bugzilla.redhat.com/show_bug.cgi?id=1431652
    
    (cherry picked from commit 91b5fb3641c91ff4e4778879d4bc866089923c28)

commit 82fccc2820e9f9f0cd684f2676437a65b873230e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Mar 12 19:47:38 2017 +0000

    v2v: -i ova: Factor out the OVF parsing into a separate module.
    
    Mixing the XML parsing with the other functions of this module made it
    very hard to understand.  Splitting the XML parsing into another
    module simplifies the flow considerably.
    
    This is just code refactoring and should not affect the semantics.
    
    (cherry picked from commit f34636700ae2f9b0762e00fd5a386a8d5733b660)

commit 727d76d279a9f64d696cfb62cee4a96ec03d7c49
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 10 14:58:15 2017 +0000

    v2v: -i ova: Hoist utility functions to the top of the file.
    
    These functions obscure the true flow of the code, so hoist
    them out of the source () method to the top of the file.
    
    No change, just refactoring.
    
    (cherry picked from commit 57949e68538341f41504d76c808280bf59987d75)

commit 21bf7e3162e027177e68bdf1bd356e9c3466c6f8
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Mar 13 09:46:36 2017 +0100

    v2v: support no socket for <listen type='socket'>
    
    Support also a "socket" listen type with no explicitly specified socket
    (which will be generated by libvirt).
    
    Updates commit a4adf48915c0e3e7f4e8b7bbdbb5ac622da1ac58.
    
    Related to: RHBZ#1378022
    
    (cherry picked from commit b1975468391261b91258d420dafea5fe4076e4c2)

commit 9d743720ac19b34ffd18b13ed897bbab3d7c3f35
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Mar 10 14:31:01 2017 +0100

    appliance: run systemd-tmpfiles also for /var/run
    
    Commit a6330e9d3af0f5286f1d53d909fd868387b67f69 enabled /run for
    systemd-tmpfiles: while this works fine in most of the cases, there are
    few tmpfiles configurations that still references /var/run instead of
    /run.  As result, include also /var/run in the systemd-tmpfiles
    execution.
    
    (cherry picked from commit e48c17b10d8f3bf6b6766ceca478f4ad0aaac744)

commit 4d34aed1bbdac7fb743649a08b200a423b4fdfb5
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Mar 10 13:54:30 2017 +0100

    daemon: fix memory leak in xfs implementation of vfs_minimum_size
    
    Use the proper cleanup handler for deleting the guestfs_int_xfsinfo
    struct (so the string fields are deleted too).
    
    Fixes commit f5caa421d1bb826559ec7a6d98c1a6b6b1f0a629.
    
    (cherry picked from commit 31fb6e20418e8f1b0647c92af0464f2009e9a997)

commit d66fbe189dcec1c5d63cf5b447934fd39256705c
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Mar 10 13:50:24 2017 +0100

    daemon: generate cleanup handlers for structs
    
    This way it is possible to cleanup properly structs in the daemon, when
    using them within other daemon functions.
    
    (cherry picked from commit 32f0f9b032db592b50c4a4b0da29ef0de0478633)

commit 70e7db2a1392b938f50f5d121028e7b2511351b7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 10 14:01:42 2017 +0000

    v2v: Refactor some command line error messages.
    
    This change (mostly) has no effect, except I changed the content of
    two error messages to make them consistent with the others.
    
    (cherry picked from commit e3782a361136748c617e664415ace10f95778faa)

commit 175722ab41974d782de8340875af0ee71b5a8da5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 10 13:47:13 2017 +0000

    v2v: -o null: Force output format to be raw sparse.
    
    When converting and throwing away the output (-o null), the input
    format should not really matter.  However it does currently matter for
    a couple of reasons:
    
    (1) If the input is not raw or qcow2, then you'll get the error below
    because virt-v2v wants to write the same output format as input format
    but only allows raw or qcow2 as output formats:
    
      virt-v2v: error: output format should be 'raw' or 'qcow2'.
    
    (2) If you use -o null -oa preallocated then a non-sparse temporary
    disk is created before being deleted, but that just wastes disk space
    for no reason.
    
    Therefore this change
    
    (i) prevents '-o null -oa preallocated' from being specified on the
    command line,
    
    (ii) prevents '-o null -of <anything>',
    
    (iii) forces the output (temporary file) to be raw sparse.
    
    (cherry picked from commit 09b061378776b656b7d3ef1e63a490de011aa6c7)

commit 59052ee85fcb1451a12b7cef016cd00bf10b3d01
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 10 14:13:28 2017 +0000

    v2v: -i ova: Avoid long line in file.
    
    Just a whitespace change.
    
    (cherry picked from commit 9bde1526445369044ccf730fff366a05c5eb6ee3)

commit c5dfd14cb26d7d6ac62e7878f46f5eb0926af868
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Mar 8 13:13:36 2017 +0100

    v2v: fix skip check in test-v2v-o-libvirt.sh
    
    This test needs windows.img, not fedora.img.  This way, the test is
    properly skipped when NTFS support is not available.
    
    Fixes commit a1b3d8d04b65298dd13c44a057a4e2b650ebc59e.
    
    (cherry picked from commit de7d6df4be415a3883cf6fa90f7ab3b622d66f82)

commit 458a7b06243b8310cf7190a2237c1a7c5e067123
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Mar 8 09:45:08 2017 +0100

    dib: actually generate SHA256 checksums (RHBZ#1430184)
    
    diskimage-builder generates MD5, and SHA256 checksums when using
    --checksum, so stick to that list for compatibility reasons.
    
    (cherry picked from commit ba52e0a217e3d78c9a0e4d51240674e832a22619)

commit 0b793550d430cd8135c177f74dec13341c731b6d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 7 18:43:02 2017 +0000

    Version 1.36.2.

commit 976778f9f310c571d77855ca20a4696ec8cbe392
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 7 15:36:38 2017 +0000

    v2v: Add new OVA tests to EXTRA_DIST.
    
    Updates commit a1843b9d727d0eddb54b5e93b4c3aa0d6901e5f4.
    
    (cherry picked from commit 1ac8a9e40b189935dc100c27a14a332d704074ed)

commit aa03c83b0d9bf8bb58f5d39b90f21c7576478b7d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 3 09:56:03 2017 +0000

    appliance: Fix job control in virt-rescue.
    
    See comment and link to busybox FAQ for explanation.
    
    (cherry picked from commit 8c73e9aa4e09659bf6770a0bb85f8126a97f42d1)

commit c1b09eea5ef42530d2c5dd1c7b40a2da8a5983e6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 6 14:27:19 2017 +0000

    v2v: Add extra tests for malformed OVA files.
    
    Test:
     - Bad SHA1 sum
     - Bad SHA256 sum
     - Invalid lines in manifest (x2)
     - Good checksum and manifest
    
    These tests were originally written by Tomáš Golembiovský.  All I have
    done is to integrate them into the virt-v2v test suite.
    
    (cherry picked from commit a1843b9d727d0eddb54b5e93b4c3aa0d6901e5f4)

commit b69421590f78fbec7f5c88da14a156739ef19a1d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 7 10:50:25 2017 +0000

    docs: Document vulnerabilities in icoutils wrestool affecting libguestfs.
    
    (cherry picked from commit 9f447837ae14651d06228ff77ae9196e258ca3f3)

commit 5059b7c5871aa4861d625041847465e21c2ec4f5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 6 18:11:29 2017 +0000

    v2v: -o local: Check that UEFI firmware is installed before conversion (RHBZ#1429506).
    
    Avoids a lengthy conversion followed by failure if we discover at the
    end that OVMF is not installed.
    
    This also changes the order of the methods in -o libvirt and -o qemu
    so that it matches the order in the class interface, and also
    logically makes more sense.
    
    Thanks: Christopher Brown
    (cherry picked from commit a05e0fc0e8ffa2638e66ed1d71d41c470eadc4d7)

commit ecd4d5b873da97b2e77746881c4c6542c1657e8e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 6 16:07:04 2017 +0000

    v2v: Fix typo in previous commit (RHBZ#1374232).
    
    Fixes commit 25772a8123a1a800caf3472fb79c8eb3b4a074f3.
    
    (cherry picked from commit c6d8d68a4643794128c1d617bc83fc22438cc7c5)

commit 3a2e64c9feab090b1d35605303f4544901b47201
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 6 10:42:03 2017 +0000

    v2v: Fix invalid regexp in file_contexts file (RHBZ#1374232).
    
    Instead of just documenting this bug, fix it in the file_contexts
    file.
    
    Replaces commit ad3c8fe7f49c4991e1aa536856a1a408f55d5409.
    
    (cherry picked from commit 25772a8123a1a800caf3472fb79c8eb3b4a074f3)

commit 72b57fa3ea64c1492349e4d239e618a449d3a432
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Mar 6 16:05:56 2017 +0100

    v2v, p2v: rename rhvm network to ovirtmgmt (RHBZ#1429491)
    
    Since RHV 3.6.10, the default network name is 'ovirtmgmt' instead of
    'rhvm'.
    
    This is just a documentation change.
    
    (cherry picked from commit 5dd261ce5c169256673f9d2b8e4b241b87c5b5d9)

commit 84d842c223e626e5f55beae1fc70242617b11b84
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Mar 6 14:53:36 2017 +0100

    p2v: fix possible close(-1) issue
    
    Make sure the error handler (i.e. the code after the 'cleanup' label)
    does not attempt to call close(-1), in case 'sockfd' is not initialized
    yet.
    
    (cherry picked from commit 5036ec67d5e001fd07bda160242d908f5f2e0023)

commit bb41848eb212ee3fdbd30b9e702e9a6ef03df287
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Mar 6 14:47:44 2017 +0100

    p2v: check more return values
    
    Check for the (rare) failures of open(/dev/null), and setsockopt.
    
    (cherry picked from commit 0507daf7e6c34a159391fe6e430f713474b74472)

commit dd9fde4f6fcc7363c61704fdb6bb6cb023dcb8ed
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Mar 6 14:23:55 2017 +0100

    lib: qemu: improve handling of FILE*
    
    Create own blocks for all the parts dealing with FILE*: this way there
    is no need to recycle the same FILE* variable for all the operations,
    and have each block its own variable automatically cleaned up.
    
    This also fixes a potential undefined behaviour on error: POSIX says
    that after a call fclose(), a FILE* cannot be used anymore, not even
    on fclose() failure. The previous behaviour for fclose == -1 was to jump
    to the error label, which would then try to call fclose() again (since
    the FILE* pointer was still non-null).
    
    (cherry picked from commit d36940992ed81053fdbf8117ce6da30a8fef2a0f)

commit f2e5424b66934425eac0041394d7782d47b1bc7d
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Mar 6 13:25:48 2017 +0100

    java: use cleanup handlers for structs (lists) as return values
    
    Filling some of their fields may cause the flow to skip to throw the
    "out of memory" exception, and return immediately.  To avoid leaking the
    struct, or struct list, from the C implementation, use a cleanup handler
    so there is no need to manually clean it up.
    
    (cherry picked from commit 18ee68ad1240b84739b603ee03e53b552f904e8c)

commit ec3b1125a7537f26e4d27c2bc82991f3e9220ec3
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Mar 6 11:38:37 2017 +0100

    daemon: btrfs: check end_stringsbuf return values everywhere
    
    Make sure to check the return value of end_stringsbuf everywhere, as
    that would generate invalid string lists.
    
    (cherry picked from commit c5fa352087dc4ebc5270ca2ee47487cf9a44d827)

commit 11e9ad53e7965f8f6fd7a8cfdf1458c05bcdbb36
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Mar 6 10:59:00 2017 +0100

    tail: check the return value pf guestfs_set_pgroup
    
    It is done when creating the handle, so do it also when duplicating the
    handle.
    
    (cherry picked from commit 61a6f7e2d009f97d8896fa4646e0e951824cb392)

commit 39f82bfefb9ad4838eb8276b20213c914ea5b728
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 3 14:16:22 2017 +0000

    Use gnulib set_cloexec_flag in a few places.
    
    (cherry picked from commit e5474df1acdb0a8eaeb50886c928e0c2ec4ebad7)

commit c4e4f630937e1c1cd1861ee78f504bd1d51e1528
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 3 14:08:36 2017 +0000

    Use gnulib set_nonblocking_flag function instead of fcntl.
    
    The previous code:
    
      fcntl (fd, F_SETFL, O_NONBLOCK)
    
    was technically incorrect, because it would have reset any
    other flags on the file descriptor.
    
    Thanks: Eric Blake
    (cherry picked from commit 58d6becc8af28babca0d52cef05eb8826231ae35)

commit 5755eed6d790832f1fd7fab62bd0426e1af27f5f
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Mar 3 13:50:46 2017 +0100

    java: do not try to malloc 0 elements in get_all_event_callbacks
    
    In case there are no event handlers registered with the handle,
    get_all_event_callbacks will count 0 elements, trying to malloc a buffer
    of that size.  POSIX says that this can result in either a null pointer,
    or an unusable pointer.
    
    Short-circuit get_all_event_callbacks to allocate nothing when there are
    no events, making sure to use its results only when there were events.
    
    (cherry picked from commit c6543875aea501dd1c1db1873276526f3eca494f)

commit 43ef692c449b3b3463f6ee9e0272420f4df22399
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Mar 3 13:48:25 2017 +0100

    ruby: do not try to malloc 0 elements in get_all_event_callbacks
    
    In case there are no event handlers registered with the handle,
    get_all_event_callbacks will count 0 elements, trying to malloc a buffer
    of that size.  POSIX says that this can result in either a null pointer,
    or an unusable pointer.
    
    Short-circuit get_all_event_callbacks to allocate nothing when there are
    no events, making sure to use its results only when there were events.
    
    (cherry picked from commit 4fc85f27c492e8e97b46083a2bcb11c81846f5a0)

commit 63e9cd5536f0d92cb93a01c5ecac764e9c591ca5
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Mar 3 13:47:48 2017 +0100

    python: do not try to malloc 0 elements in get_all_event_callbacks
    
    In case there are no event handlers registered with the handle,
    get_all_event_callbacks will count 0 elements, trying to malloc a buffer
    of that size.  POSIX says that this can result in either a null pointer,
    or an unusable pointer.
    
    Short-circuit get_all_event_callbacks to allocate nothing when there are
    no events, making sure to use its results only when there were events.
    
    (cherry picked from commit b890fd2900310c9e4f0781aa3427a3bb114788b1)

commit 4208be6f9762540e7d53a88462b19bc221cf0da5
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Mar 3 13:40:17 2017 +0100

    ocaml: do not try to malloc 0 elements in get_all_event_callbacks
    
    In case there are no event handlers registered with the handle,
    get_all_event_callbacks will count 0 elements, trying to malloc a buffer
    of that size.  POSIX says that this can result in either a null pointer,
    or an unusable pointer.
    
    Short-circuit get_all_event_callbacks to allocate nothing when there are
    no events, making sure to use its results only when there were events.
    
    (cherry picked from commit 64e1101631778b4167218adc93101a1587215f02)

commit 9335ec81c68b4b55d0f62b706be1a00189f363b3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 3 08:44:15 2017 +0000

    generator: ocaml: Don't link to undocumented methods.
    
    As for the previous commit, don't link to a method if it's not
    exported by the OCaml bindings.
    
    (cherry picked from commit 7527312784c7c054e30df9ed57cf891cd98b2aeb)

commit 2116720e78784086ce86012f14c337249c2bb2e6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 3 08:44:15 2017 +0000

    generator: java: Don't link to undocumented methods.
    
    We aren't generating Java bindings for internal and other undocumented
    methods, and therefore providing {@link #...}  for deprecated methods
    replaced by internal methods doesn't work.  The easiest way is just to
    check for this and turn such links into plain text.
    
    (cherry picked from commit 41040182ae63107034e6bacf63843dec496e0a9c)

commit 32910d2a89a31d5691c8330f40887a592f74dd45
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 3 16:49:41 2017 +0000

    generator: Add a function to find an action by name.
    
    Fairly simple refactoring.
    
    (cherry picked from commit 994a8f6a7167c0fe795f4611ebe85bdb488f9dd7)

commit c59bed4914864e38c6b1d3b400f7b205988b1431
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 2 12:39:57 2017 +0000

    generator: Allow actions to be deprecated with no replacement.
    
    There is precisely one such function at the moment
    (guestfs_wait_ready).
    
    (cherry picked from commit 67ce5342c2cdcf760f891341ee37901a9792d04d)

commit 16dd22d68f33b8f06fc917fa4fd3accb74f43401
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Mar 3 13:02:00 2017 +0100

    tail: pass the right path for Windows guests
    
    Call windows_path with the actual path to resolve, instead of a null
    pointer ('filename' is still null at that point), so Windows paths can
    be properly resolved.
    
    (cherry picked from commit df6cd838729d53934a70fc99ac8e3926d25d56c0)

commit 6a3741e8ca884b4a8f1687a1897b4a3d82098d7e
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Mar 3 11:00:37 2017 +0100

    fish: fully init the msghdr buffers
    
    This way no fields (msg_flags in particular) remain uninitialized.
    
    (cherry picked from commit be82ba38df31730a2910aeb962bbafa29851f920)

commit c702acbc1f1c02b9932d2570455045faf7510401
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Mar 3 10:39:10 2017 +0100

    java: fix possible memory leak on error
    
    Use CLEANUP_FREE to properly dispose the temporary array used for
    StringList, DeviceList, FilenameList, and OStringList parameters: this
    way, an early return (jumping to the ret_error label) will not forget
    cleaning them up.
    
    (cherry picked from commit bd55fa553f16aca12d5c882be26e528f35752ae8)

commit 7c8365e342bb63721e7dce351aec56da30d76cc3
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Mar 2 18:00:47 2017 +0100

    edit: fix small memory leak on error
    
    If guestfs_int_random_string fails, make sure to free the buffer
    allocated as return string.
    
    (cherry picked from commit 099ce1d49089d2a4f6a1afb833b895849c3d47e2)

commit b610f82d7bfc9eedcecd311761140fcdc1baf2c1
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Mar 2 17:42:10 2017 +0100

    daemon: tsk: properly use GUESTFS_MAX_CHUNK_SIZE
    
    Pass to fread the size of the buffer allocated, so it can be filled
    completely. This is even faster than reading only 4/8 bytes each
    iteration.
    
    (cherry picked from commit 9aef2c7e3a5b9d6dd35378082357d96c921e78c1)

commit 79d5e0c37a3a6bbba9626040d5359f9bc4fb815c
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Mar 2 17:32:58 2017 +0100

    java: fix invalid memory access for FBuffer in struct lists
    
    When convering FBuffer fields of structs in each element of the return
    list, make sure to allocate enough buffer to hold also the trailing null
    character.
    
    (cherry picked from commit c9df2d44cd4301b6522cd26d8791093033c4a340)

commit a4a6f69835620db8c10b3294f9296421990a62e6
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Mar 2 17:30:16 2017 +0100

    java: link libguestfs_jni against libutils
    
    The JNI library uses CLEANUP_FREE macros, whose functions are built in
    the internal libutils.  Currently, trying to use functions that use
    CLEANUP_FREE variables will cause the java execution to stop with a
    symbol lookup error (for guestfs_int_cleanup_free).
    
    (cherry picked from commit eeacc86a106471ecf0bf061e1951284fdb262107)

commit 5bd55b59faca465a5923d7bd6e8d4ab579530a12
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 2 11:35:38 2017 +0000

    erlang: Rename 'message' to something less generic.
    
    It's not possible to define an action which takes a parameter called
    'message' because the Erlang bindings use that as the name of an
    internal variable.  Solve this by renaming the Erlang internal
    variable.
    
    Fixes commit 84763d7fca3668c62ee3fe53d0e00a5a672f687b.
    
    (cherry picked from commit 843d61c2d405f011853e4f33d3e3306d3d1ca6d3)

commit 977ca2c4c2aeeacdc449a58d9a19ef7a82116b22
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 2 09:07:08 2017 +0000

    generator: Move some deprecated functions to actions_core_deprecated.ml.
    
    Fixes commit 97773d2bbee8e28830fd689deef9e9f63ce0c18e.
    
    (cherry picked from commit da6ea8937153015958a952808671e06e412a5eaa)

commit 3836d61dc83466afe500ad9e5563eab074a0e9b1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 1 11:36:26 2017 +0000

    Use AC_HEADER_MAJOR to find definitions of major, minor, makedev.
    
    Note this requires either the following fix in autoconf:
    
    http://git.savannah.gnu.org/cgit/autoconf.git/commit/?id=e17a30e98
    
    OR gnulib sys_types module plus gnulib
    commit a512e041120e9012e69afa2f5c3adc196ec4999a (any gnulib more
    recent than Sep 2016) which corrects the AC_HEADER_MAJOR macro in a
    similar way.
    
    (cherry picked from commit 7a26804569703166a30bbc545986218ede03de04)

commit b074c09475467f5c5c5620078ba1e3a100091e84
Author: Dawid Zamirski <dzamirski@datto.com>
Date:   Thu Mar 2 17:44:40 2017 -0500

    parted: add more udev_settle calls.
    
    add udev_settle calls to print_partition_table and
    sgdisk_info_extract_field because the inspect-os calls
    guestfs_part_get_parttype and guestfs_part_get_gpt_guid for all
    parition devices found and this causes intermittent with opening block
    devices that are certainly present yet RESOLVE_DEVICE macro would fail
    wiht ENOENT.
    
    (cherry picked from commit 4fd6c3ad6e04f6b8133439094c9bcb403c03ca03)

commit c1dd33e612067c5581416168daad99876666eed6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 1 15:07:00 2017 +0000

    ruby: Simplify and fix regression test.
    
    This test failed on ppc64le with:
    
      Failure:
        </wrong argument type Fixnum \(expected Array\)/> was expected to be =~
        <"wrong argument type Integer (expected Array)">.
    
    In addition the test generated a warning:
    
      tc_800_rhbz507346.rb:29: warning: ambiguous first argument; put parentheses or a space even after `/' operator
    
    This commit fixes both of these and also makes it simpler and faster
    by not bothering to launch the appliance.
    
    Fixes commit 227b1eea90713d190a9cf5463af106af0b4eee2c.
    
    (cherry picked from commit 9fbdea695b70918b37dd42310bf6ba5a5240c67f)

commit d5ae8089d675a30a5cb1a53a111c161e9ec8dc5e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 28 21:11:41 2017 +0000

    Version 1.36.1.

commit 5c82a564c21a832097ba63f0af2f3ad2d017fe4d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 28 20:52:40 2017 +0000

    python: Fix python sdist.
    
    Fixes commit d45986d21b6f1709264f7e2ecfeb240c9c578090.
    
    (cherry picked from commit c4106d34cb617d56dadc765dc6577116256af947)

commit 6213bd04482eda69be024bee126d28e58cfc847b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 28 09:18:05 2017 +0000

    Version 1.36.0.

commit 97fb89387899564bcd571010b978edfe76fc0aa1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 27 23:02:56 2017 +0000

    docs: Finalize release notes for libguestfs 1.36 release.

commit d2b56f08f057f990e594a02742239c66c95cb341
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 27 12:16:07 2017 +0000

    lib: Require libmagic.
    
    If libmagic isn't installed then the guestfs_file_architecture API
    doesn't work.  This means that inspection will always return
    <arch>unknown</arch> for every guest.  This subtly breaks a few
    features.  In particular it was reported that the
    virt-builder/virt-customize --install option did not work because the
    "unknown" architecture of the guest was not compatible with the host.
    
    libmagic is a small, widely available C library, so the easiest fix is
    just to make it mandatory.
    
    Reported by: Solarix on IRC

commit f6ece2c01a9a1a43d6715103e7dbdda0f09ee862
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Feb 26 12:17:14 2017 +0000

    v2v: -o qemu: Refactor generation of the qemu shell script.
    
    This change refactors how the qemu shell script is generated, making
    it a bit less likely that we'll get the quoting wrong.  Parameters are
    now added to a list, unquoted, and all quoting is done when printing
    out the list.
    
    Checked by running virt-v2v -o qemu before and after the change and
    manually comparing the output (which is not identical, but still
    correct).

commit 5982b9f7debfa0beebf8c3d7f7608f0cfe82ccc2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 25 20:32:30 2017 +0000

    v2v: -o rhv: Remove unused exported function.
    
    In fact mount_and_check_storage_domain is not used by -o vdsm, and
    hasn't been used since commit 889e55516869d1eadcdeae15e38dd8d3bbca8d20.

commit 073a5cd976c5f48d08a66772d4e4e480c303ea20
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 25 20:13:22 2017 +0000

    v2v: Various whitespace or other very minor cleanups.

commit eb4357b7674a5428ae5b0c1d5fcfd65bfe8ad507
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 25 20:19:10 2017 +0000

    v2v: Move libvirt XML output code into a new module.
    
    Just code motion.
    
    Analogous to commit 512e5fd85836f03f661d13bc35b3bf685554de10.

commit 012577e0a4d53eea5eaa9bfcc2f001f4afb7488e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 25 19:59:54 2017 +0000

    v2v: Fix comment so it refers to new parse_libvirt_xml.ml file.
    
    Fixes commit 512e5fd85836f03f661d13bc35b3bf685554de10.

commit 50f544d971ace72cae91c262d129865c2a39f048
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 25 15:16:21 2017 +0000

    tests: regressions: Move another test to use $TEST_FUNCTIONS.
    
    Omitted from commit a1b3d8d04b65298dd13c44a057a4e2b650ebc59e.

commit 512e5fd85836f03f661d13bc35b3bf685554de10
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 25 12:43:52 2017 +0000

    v2v: Move libvirt XML parsing code into a new module.
    
    Just code motion.

commit 2a29cf90fa8ca9410cf50a5b0272b1e6c054b5d6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 25 12:29:44 2017 +0000

    v2v: -i libvirtxml: Modify get_drive_slot calls.
    
    Just a small refactoring to make the function safer to use.

commit 124e7bfd1519f7b69166cf0b1f918b35c3c2da7b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 25 12:29:35 2017 +0000

    v2v: -i libvirt: Move comments.
    
    Just whitespace changes.

commit d4d526c109848624ce2dfbb2ab3fc5d92884aaad
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 24 20:59:17 2017 +0000

    v2v: Fix incorrect skips in tests.
    
    Fixes commit a1b3d8d04b65298dd13c44a057a4e2b650ebc59e.

commit b105f81783a0425995500b9208594553330d4a6d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 24 20:43:41 2017 +0000

    mllib: Move VIRT_TOOLS_DATA_DIR calculation to common code.
    
    Share the computation of $VIRT_TOOLS_DATA_DIR in a single place.
    Use of 'lazy' ensures it is computed at most once.

commit 6070f70e54e786d56414546b060dca00abba7e9f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 24 17:37:55 2017 +0000

    docs: release notes: add-domain now supports libvirt secrets.
    
    Thanks: Pino Toscano

commit a1173828285aeaab67d7d38aa3eb19bceb2e1a32
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 24 15:08:27 2017 +0000

    docs: Update release notes for libguestfs 1.36 release.

commit e53ee5befa3e067a3c7d163d63eb2a2eba960858
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 24 15:06:45 2017 +0000

    docs: Test release on aarch64, ppc64 and ppc64le.
    
    Before a stable release, we will now test on aarch64, ppc64
    and ppc64le.

commit f27d19485ccd3abaa70d7265b692f08575fd975b
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Feb 24 16:02:20 2017 +0100

    v2v: document Convert_linux as more generic
    
    Make the documentation in Convert_linux more generic than just
    Enterprise distros using RPM.  Also, rename the name of the module from
    "enterprise-linux" to simply "linux".

commit b927172f85986a590544d7ef9ab7734a18d36005
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Feb 24 15:52:28 2017 +0100

    v2v: document Debian/Ubuntu support

commit 814786334ed0f94fe282b728a2046cbf6a96eb0e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 24 12:27:17 2017 +0000

    Version 1.35.28.

commit ba1e9f8bfc775e2f17112421a7c8005b52cb0cc5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 23 17:38:12 2017 +0000

    docs: Begin updating release notes for libguestfs 1.36.

commit 8066b34b60ca8837617c9b64c7981f8163afc282
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Feb 23 18:44:51 2017 +0100

    inspect: read more fields for RPM packages
    
    In particular, read the URL, and both the summary and the description.

commit ca997dce6c28eac40dd2aea3c163b566e2181dea
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Feb 23 17:54:17 2017 +0100

    inspect: read more fields for Debian packages
    
    In particular, read the URL, the source name, and both the summary and
    the description.  For the long description, add a small system to read
    continuation lines.
    
    Adapt the expected result of virt-inspector for Debian and Ubuntu phony
    guests, so test-virt-inspector.sh still passes.

commit a920c948700269e949941b555b391ebc9248ce87
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Feb 23 13:35:00 2017 +0100

    inspect: add source and summary to internal add_application
    
    This way source and summary can be specified for any package read from
    the guest.

commit 8e6f6305c252cc88508df787998562cbd5a5bd7e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 24 12:49:32 2017 +0000

    po-docs: Fix mistranslated message in Ukrainian file.
    
    A message was translated without the trailing \n.  As it was in a
    verbatim section of POD, I actually reverted the whole translation.
    
    The error was:
    
      ./uk.po:53533: 'msgid' and 'msgstr' entries do not both end with '\n'
      msgfmt: found 1 fatal error
    
    In fact po4a (or whatever calls msgfmt) seems to ignore the error and
    continues which is another problem.
    
    Fixes commit 794b6a1acfb3af96caf901d64c9658052b3d5438.

commit 1e2555c1b8b3e18d89ea0b84cb633a09e1d9a5e2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 24 12:47:55 2017 +0000

    po-docs: Add cs to lingas_not_translated.
    
    Commit 794b6a1acfb3af96caf901d64c9658052b3d5438 added cs.po, but
    because this wasn't also added to lingas_not_translated the file was
    not included in EXTRA_DIST or processed properly.
    
    Fixes commit 794b6a1acfb3af96caf901d64c9658052b3d5438.

commit 7d0ed596c2fe41fde770d4624f248560cbbb3373
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 24 12:23:47 2017 +0000

    po-docs: ja: Fix internal link L</...> which was translated.
    
    Compiling po-docs/ja/guestfish.pod failed with:
    
      Pod input around line 277: L<> starts or ends with whitespace
      Pod input around line 362: L<> starts or ends with whitespace
    
    I reverted the part of the L</...> link which had been translated.
    
    The fix isn't quite correct -- headings *can* be translated, and the
    corresponding internal links should be translated too.  However
    pod2man has problems dealing with such links and in any case the
    partial translation was not correct, so revert to the English version
    of the link.
    
    Updates commit 794b6a1acfb3af96caf901d64c9658052b3d5438.

commit 57d17ca301095d761163f966222d42b38880a543
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 24 04:56:44 2017 -0500

    mllib: visit: Initialize CAMLlocal-allocated value.
    
    Somewhere between OCaml 4.01 and OCaml 4.04, <caml/memory.h> changed
    the way that CAMLlocalX() values on the stack are initialized.  In
    OCaml 4.01:
    
      #define CAMLlocal1(x) \
        value x = 0; \
        CAMLxparam1 (x)
    
    but in OCaml 4.04:
    
      #define CAMLlocal1(x) \
        value x = Val_unit; \
        CAMLxparam1 (x)
    
    The code in mllib/visit-c.c assumed that the value would be
    initialized to Val_unit, and used a check (exn != Val_unit) to see if
    the value had been updated.  This failed badly (with a segfault) on
    OCaml 4.01 in Debian 8.
    
    Resolve this by always initializing CAMLlocalX() values before use.

commit 8b950deb26ebc841d4e289e883aad88395005725
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 24 09:04:24 2017 +0000

    v2v: Add a utility function for testing if the backend is libvirt.
    
    This also fixes one of the places where we checked this so it now
    recognizes both "libvirt" and "libvirt:...".

commit ad9e9c98b56bdede24a44d5d171d380d02c62ea5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 24 08:56:39 2017 +0000

    v2v: Rename Domainxml -> Libvirt_utils.
    
    The name 'Domainxml' made no sense.

commit 94f44b99832a1258e61dd9eee09b36def31ec7f9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 24 08:50:22 2017 +0000

    v2v: ova: Move libvirt version test to input_ova.ml.
    
    Updates commit 90521da5d45aea60dc3f47f90b97151fd3b484f5.

commit df2006b2756eb102fb47307ae78b594e0f91aed0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 23 15:09:02 2017 +0000

    v2v: -i libvirt: Fix test for "json:" backing file support.
    
    Thanks: Tomáš Golembiovský for pointing out the error and
    showing how to fix it.

commit 560a3682c6c0344067bbac312abaebe728462e98
Author: Tomáš Golembiovský <tgolembi@redhat.com>
Date:   Thu Feb 23 16:02:25 2017 +0100

    v2v: tests: restore disabled OVA test
    
    We are redy to restore the disabled test. The relevant libvirt fixes
    should be available in 3.1.0.
    
    Signed-off-by: Tomáš Golembiovský <tgolembi@redhat.com>

commit 90521da5d45aea60dc3f47f90b97151fd3b484f5
Author: Tomáš Golembiovský <tgolembi@redhat.com>
Date:   Thu Feb 23 16:02:24 2017 +0100

    v2v: ova: check libvirt version before OVA import
    
    Libvirt < 3.1.0 lacks enough support for json: pseudo-URLs. Notably it
    does not allow use of "raw" driver that we need.
    
    Signed-off-by: Tomáš Golembiovský <tgolembi@redhat.com>

commit 2dbf6bd7b79015f4417b3897628997fc0b04ea15
Author: Tomáš Golembiovský <tgolembi@redhat.com>
Date:   Thu Feb 23 16:02:23 2017 +0100

    v2v: ova: fix generated JSON for libvirt support
    
    We have to be explicit about the drivers in backing file JSON in order
    for libvirt to work.
    
    Signed-off-by: Tomáš Golembiovský <tgolembi@redhat.com>

commit 794b6a1acfb3af96caf901d64c9658052b3d5438
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 23 15:07:46 2017 +0000

    Update translations from Zanata.

commit 45e046dac95ce6895af95832def7e40ad786e36f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 23 12:36:53 2017 +0000

    tests: Disable some tests so they don't break when ./configure --without-libvirt

commit a7bd49924445d11fe1843db659e61ca6fb2bb5cf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 23 13:33:48 2017 +0000

    tests: regressions: Ignore SIGPIPE in test.
    
    The test tests/regressions/rhbz914931.c works by causing the daemon to
    segfault while writing to it.
    
    For reasons unknown, when configured --without-libvirt, this causes
    the test to fail receiving SIGPIPE (exit code 141).  We can prevent
    this by installing a signal handler to ignore SIGPIPE, so the signal
    is converted to EPIPE which the code handles properly.

commit c72be578c1bbd2df6a4ddf957319084863ad7306
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 23 08:14:44 2017 -0500

    debian: Old qemu-img does not support -f raw -o preallocation=off
    
    The old version of qemu-img available in Debian 8 doesn't support the
    preallocation option for raw format.  However this doesn't matter
    because the default is preallocation=off (ie. sparse) for old and new
    versions of qemu-img so we can just omit this parameter.
    
    Fixes commit 53317e3f079863d9ea87725b73c7104b34a607e2
    and commit fa83b4787653aa296a09d149cfa3e30aaed4eea6
    and commit 74ded0dbc17b84638cc06c0b4d028484d114c00f.

commit bf7aab615b42b4d366e0f5e3873f7725ac899d9c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 23 12:49:25 2017 +0000

    v2v: Fix incorrect test skip.
    
    The test should be skipped *if* uml, not unless uml.
    
    Fixes commit a1b3d8d04b65298dd13c44a057a4e2b650ebc59e.

commit e53418558a86e724bc26d571857005ddcb8ccb05
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 23 09:23:48 2017 +0000

    v2v: windows: Only warn on RHEV-APT if requested, install VMDP unconditionally.
    
    Slightly change the logic for installing RHEV-APT and VMDP:
    
    - Only warn on failure to install RHEV-APT if the output hypervisor
      requested it.  Otherwise the warning is pointless because RHEV-APT
      can't be used anyway.
    
    - Make the warning clearer and actionable.
    
    - Try to install VMDP unconditionally (rather than only if RHEV-APT
      failed).  It is always useful for SuSE hosts.  However don't warn if
      it's not available.

commit 83488cb6f39d5c58cd389962965c059bd3c7d791
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 23 09:13:15 2017 +0000

    v2v: windows: Simplify installing pnp_wait.exe.
    
    Updates commit 09eb831e8d4f209c2177111c8473b1b094bfc8cb.

commit cf85da5b7eb1a956447a620da893a0ab53b244a7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 23 09:10:15 2017 +0000

    v2v: Add fake test-data/fake-virt-tools/pnp_wait.exe for testing.
    
    Analogous to commit f5c9357c8ed96cf6be986ba7d7b4269a8566b3ab.

commit 7a4234088befc58c0c01a57ab964845cb7385512
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 22 22:15:53 2017 +0000

    Version 1.35.27.

commit 990241f0234a8e72018859201a360137259c27a9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 22 17:26:36 2017 +0000

    v2v: windows: Only try to install rhev-apt if the target is RHV (RHBZ#1161019).
    
    Thanks: Tingting Zheng

commit f5c9357c8ed96cf6be986ba7d7b4269a8566b3ab
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 22 17:45:06 2017 +0000

    v2v: Add fake test-data/fake-virt-tools/vmdp.exe for testing.

commit c280df7a4d100ea8f29d9f866e9dccc0e291dcca
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 22 17:14:06 2017 +0000

    v2v: windows: Simplify installing rhev-apt.exe or vmdp.exe.
    
    This just simplifies the code and should make no functional
    difference.
    
    Updates commit c466d4cb928fcfea37908cc66c90ac8430d6d4c6.

commit 4b465468b114ec215165a98717b58c7ed1b2b993
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 22 17:06:16 2017 +0000

    v2v: Pass output object into the conversion module.
    
    Previously the Convert_linux conversion module depended on one feature
    of the output module (#keep_serial_console).  This was extracted in an
    ad-hoc way from the output module and passed as an extra parameter to
    the conversion module.
    
    Instead of doing it this way, just pass the output module into the
    conversion module, so it can call output#keep_serial_console itself.
    
    This is just a simplification of the existing code, but otherwise adds
    no new features.

commit 00bac2e5da5fc85e3782275ae7584b4c5b15c66d
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Feb 22 18:33:03 2017 +0100

    inspect: ignore /dev/cdN devices in /etc/fstab
    
    Non-Linux Unix guests may have static devices for CDs, so make sure to
    skip them when reading /etc/fstab.  This is the same as done for
    /dev/fdN devices, i.e. floppy devices.

commit 24d2150047f2414f29d0cecd0adc3c9b18d2cefe
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 22 14:32:18 2017 +0000

    v2v: vCenter: Remove proxy environment variables (RHBZ#1354507).
    
    Currently imports from vCenter sometimes obey proxy environment
    variables (eg. $http_proxy) and sometimes don't.  The initial libvirt
    connection to fetch metadata never uses the proxy, but because the
    subsequent conversion and copying uses libcurl, it will pick up on
    proxy environment variables.
    
    This makes no sense, and in any case vCenter is really slow as it is
    without putting another device into the data path.  Therefore ensure
    that libcurl does not see any proxy environment variables by unsetting
    them.

commit 592c960c15a368e347f967843bebeddff50560ed
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 22 14:49:43 2017 +0000

    mllib: Add unsetenv(3) binding to Unix_utils.
    
    Missing from the OCaml stdlib.  This implementation is the same as the
    one in Jane St's Core, except we don't bother to throw an exception on
    error.

commit 4b6a482bc8751d15c62bf6a72b38ba63b0a25c93
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 22 14:05:32 2017 +0000

    mllib: Combine small Unix library call bindings into Unix_utils module.
    
    Concatenate six small modules containing Unix/POSIX library call
    bindings into a single module called Unix_utils.
    
    The previous modules and the library functions bound were:
    
     - Dev_t:   makedev(3), major(3), minor(3)
     - Exit:    _exit(2)
     - Fnmatch: fnmatch(3)
     - Fsync:   sync(2)
     - Mkdtemp: mkdtemp(3)
     - StatVFS: statvfs(2)

commit 6130411a595ab7c302566f6eb1780446802818ea
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 21 20:07:43 2017 +0000

    Version 1.35.26.

commit a1b3d8d04b65298dd13c44a057a4e2b650ebc59e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 18 15:09:13 2017 +0000

    tests: Extend $TEST_FUNCTIONS with predefined functions for skipping tests etc.
    
    Apply this change across all the shell scripts containing tests.
    
    Additionally this defines the environment variables $abs_srcdir,
    $abs_builddir, $top_srcdir, $top_builddir, $abs_top_srcdir and
    $abs_top_builddir which can now be used throughout test scripts.

commit e66be4401674f63b9af49264d2610b25a199fef0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 18 14:49:43 2017 +0000

    tests: Add $TEST_FUNCTIONS.
    
    This macro(?) expands to some shell script to source the
    tests/test-functions.sh file from its correct location.  The intention
    is to use this in all tests, but in this commit only the existing
    tests which already include test-functions.sh are modified.

commit 51a703775c59b8f8e5d9315c71c761550e732b15
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 18 14:43:37 2017 +0000

    tests: Rename test-data/test-utils.sh -> tests/test-functions.sh.
    
    This is pure code motion.

commit 3a4a491712df2f02d7c32c6a08768d6cdf7542d3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 21 10:58:41 2017 +0000

    generator: Put all the daemon procedure numbers (proc_nr) into a single table.
    
    Daemon 'proc_nr's have to be assigned monotonically and uniquely to
    each daemon function.  However in practice it can be difficult to work
    out which is the next free proc_nr.  Placing all of them into a single
    table in a new file (proc_nr.ml) should make this easier.

commit cf3001c2edcb1c7c19c6dbaf5f79a8c82183b192
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 18 12:28:25 2017 +0000

    generator: Move guestfish commands to new module Fish_commands.

commit 97773d2bbee8e28830fd689deef9e9f63ce0c18e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 18 10:32:33 2017 +0000

    generator: Group and move APIs from actions.ml into actions_*.ml.
    
    Group the APIs logically and move them into new modules:
    
    Actions_core:
      Core APIs and anything that doesn't fit into another group, eg. launch.
      (With some more effort this could be split further.)
    
    Actions_augeas:
      Augeas APIs, eg. aug-init.
    
    Actions_debug:
      Debug APIs.
    
    Actions_hivex:
      Hivex APIs, eg. hivex-open.
    
    Actions_inspection:
      Inspection APIs, eg. inspect-get-type.
    
    Actions_properties:
      Handle properties, eg. set-hv, get-hv.
    
    Actions_tsk:
      SleuthKit APIs, eg. filesystem-walk.
    
    *_deprecated:
      All of the above modules have deprecated variants, where we
      place the deprecated actions.

commit 736ee3586f420c67afafe76db584e79e2933402a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 18 09:46:14 2017 +0000

    generator: Move test APIs to new module.

commit 7d6fcfc733dc78ce0dcb04487db1a40d610e3cdc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 18 09:36:30 2017 +0000

    generator: Move defaults to Types module.
    
    Just code motion in preparation for the following commits.

commit 18777adf31afe5c3a8b1a1fda57d7f15b3d8a6a7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 18 11:06:49 2017 +0000

    generator: Stablise output of common/protocol/*, daemon/*, lib/* and tests/c-api/tests.c
    
    Sort the functions so the output is stable.
    
    This changes the order in which the C API tests run.  Previously we
    ran the newest tests first, which was useful when we were frequently
    adding new APIs.  Now we run them in sorted order.

commit 5b0fa9ced90e4b6e037bf07f23662ada5b198bb2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 18 10:08:34 2017 +0000

    generator: Generate stable UUID from contents of all action*.ml files.
    
    Also rename the function 'uuidgen ()' (conflicts with a same-named
    function in Common_utils) to 'stable_uuid'.  Notice that the UUID is
    now only computed once per run of the generator, whereas previously
    the same value was computed over and over again.

commit dc159ac5a10481c8b95b221cf05648dffc0c50ae
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Feb 20 15:18:02 2017 +0100

    dib: rename "aux" to "in_target.aux"
    
    Sadly, there are elements (hello "gentoo"!) that, during the cleanup.d
    phase, wipe out almost everything in the /tmp of the guest, including
    the /tmp/aux where virt-dib mounts the auxiliary data. Since that
    removal excludes things starting with "in_target" (mostly to avoid
    wiping the "in_target.d" that disk-image-create itself sets up, then
    rename our "aux" subdirectory to "in_target.aux" to work it around.
    
    Hopefully, the "gentoo" element will be fixed upstream:
    https://review.openstack.org/#/c/436101/

commit 57a638234e82d58ff2de8c60277e1f0c1d2b23e1
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Feb 20 10:12:15 2017 +0100

    dib: handle lack of phases when reloading scripts list
    
    Commit 8ee51ee39603d8a1117c471e6660bf605c7d6b3a re-scans for the
    available scripts when running certain phases; OTOH, some of them may be
    missing, usually due to the lack of scripts for that phase in the
    selected set of elements.
    
    Indeed, if there is no directory for a phase, safely raise Not_found so
    the case is handled as if the phase was missing in the final_hooks
    Hashtbl.

commit e4adfed804ca6195a109a00e11094d16042292be
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Feb 20 09:44:34 2017 +0100

    dib: unset all temporary dirs envvars in fake-sudo
    
    The real sudo does it as well, and leaving them when preserving the
    environment (-E) maybe breaks the applications, as e.g. chroot will have
    a TMPDIR path pointing outside of it.

commit cc0b961b683f0c69423bd34e039c6143e9b9b096
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 18 07:52:03 2017 +0000

    Use the new Windows software/system hive APIs in various places.

commit 7ac977f12c39a3e9a7c3d9115105d9d2a107edc2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 18 07:44:19 2017 +0000

    New APIs: guestfs_inspect_get_windows_software_hive and guestfs_inspect_get_windows_system_hive.
    
    The inspection code already computed the paths of the software hive
    (twice!) and the system hive, plus we also recompute the same paths
    elsewhere, in virt-v2v for example.  Therefore it makes sense to store
    the paths from the inspection code and make them available through two
    new APIs.

commit e2a661f49b2e5f57b53da0a8551b0ba64917b9b1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 17 22:41:42 2017 +0000

    v2v: Simplify and document gnarly set_reg_val_dword_1 function.

commit a210aaafd388209f3e70f3a8431840bd5d6acf7a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 17 22:30:19 2017 +0000

    mllib: registry: New function for creating paths in the registry.

commit b4809a12ea4f2021fb2234a9b753bfc7f7b5ebef
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 17 22:16:43 2017 +0000

    mllib: Add Registry.t = Guestfs.guestfs * Registry.node
    
    Add a convenient tuple Registry.t for the currently open hive.  It
    contains the guestfs handle and the root node of a registry.
    
    The functions with_hive_readonly and with_hive_write are modified to
    pass this tuple to their callbacks.

commit 5b48a8d59decd8dabfdcd471cd65fce39c1a6760
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 17 21:53:01 2017 +0000

    customize, v2v: Use %systemroot% and CurrentControlSet from inspection.
    
    For reasons unknown virt-v2v recomputed the CurrentControlSet from
    first principles, and passed %systemroot% around to all functions.
    However that data is available from the libguestfs inspection APIs.

commit 441db174f5102ca8e2c3ebcc41c413c24b827a42
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 17 20:07:08 2017 +0000

    customize: firstboot: Use Registry.with_hive_write instead of open coding.

commit ca5e7233df44a5c8a7103d4bac422bbbda2a6228
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 17 19:58:50 2017 +0000

    mllib: Move Windows Registry functions from v2v to common code.
    
    Move the functions decode_utf16le, encode_utf16le, get_node,
    with_hive_readonly and with_hive_write to common code in a new module
    called Registry.
    
    This also defines types for nodes and values, instead of using int64
    directly.
    
    Just code motion.

commit 2643c4d5f425b216d0d3fadee8f0f4ed69cfafba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 21 12:05:42 2017 +0000

    tail: Fix mistake in the man page (RHBZ#1425306).
    
    Thanks: Xianghua Chen

commit 08e7506abacee23d635bd37fc9586be3cad9099f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 20 20:09:30 2017 +0000

    p2v: Fix slow test to pass LIBGUESTFS_PATH & LIBGUESTFS_CACHEDIR to virt-v2v.
    
    Adding a new optional parameter to hivex_open in
    commit 1f99251223ccee252ee1259bc2bdb9b64e3df96b reveals a subtle bug
    in the virt-p2v slow test.
    
    Because we didn't pass LIBGUESTFS_PATH through to the instance of
    virt-v2v, it was running with the new binary and library code, but
    with the installed appliance (or would have failed if libguestfs
    wasn't installed on the host when running the test).  In particular
    this bug was revealed when the new virt-v2v binary passed the
    GUESTFS_HIVEX_OPEN_UNSAFE flag to the guestfs_hivex_open call, which
    the (old, installed) daemon did not recognize and rejected with an
    error.
    
    For the same reason we also have to pass in LIBGUESTFS_CACHEDIR to
    make sure that supermin doesn't reuse the cached appliance from
    /var/tmp.

commit 3feb957c8afc2ed300858e17e951939fb6419454
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 20 12:05:02 2017 +0000

    9p: Update test for virtio-pci on aarch64.
    
    Fixes commit 4a9af91e3632047579c3a7e011c1484c97bd959a.

commit 911317dc666c5d3ea0a22a66e50df0ac34e2b532
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Feb 17 14:41:33 2017 +0100

    dib: small documentation improvements
    
    Improve the grammar, and the wording, and make few details explicit.
    No change in the actual content.

commit 654eb254071e0869412c128e0d6bcb122855b475
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Feb 17 13:46:21 2017 +0100

    dib: preserve xattrs and SELinux attributes when exporting as tar
    
    When extracting the content of the guest as tar, save also the extended
    attributes and the SELinux attributes.  This makes sure guests exported
    as tar, tgz, and as docker image will work fine afterwards.
    
    This is what disk-image-create does as well.

commit 8ee7da48c54e4baafa90dd787cd3708834205b52
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 17 10:17:57 2017 +0000

    lib, tools, v2v: Use unsafe flag when reading (but NOT writing) hives.
    
    Pass the HIVEX_OPEN_UNSAFE flag when opening hives for reading.
    Do NOT pass it when opening hives for writing.
    
    This should make inspection, virt-win-reg and virt-v2v more tolerant
    about handling Windows Registry corruption, without increasing the
    risk of causing new corruption in hives.

commit 1f99251223ccee252ee1259bc2bdb9b64e3df96b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 17 10:08:34 2017 +0000

    hivex: Map new HIVEX_OPEN_UNSAFE flag into the API.
    
    In hivex >= 1.3.14, there is a new HIVEX_OPEN_UNSAFE flag allowing
    heuristics to be used to deal with corrupted hives.  Map this flag
    into the libguestfs API.
    
    If the flag is not supported (because libguestfs was compiled with
    hivex < 1.3.14) then the flag is ignored.  This is safe behaviour:
    opening corrupted hives will give an error, as happened previously.

commit ad3c8fe7f49c4991e1aa536856a1a408f55d5409
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 16 14:06:18 2017 +0000

    v2v: Document conversion failure with RHEL 6.2 (RHBZ#1374232).

commit 7bc618c89dba9ec9f41bffb235609acc3579b8b5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 15 15:05:25 2017 +0000

    Version 1.35.25.

commit 462cc4a502ec62fc84a60eab7ae93706256e6ef1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 15 14:26:26 2017 +0000

    docs/C_SOURCE_FILES, po/POTFILES, po/POTFILES-ml: Update these files.

commit e46b07ca1bef6c63d742e67f731a6244d75eda6d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 15 14:24:14 2017 +0000

    docs/C_SOURCE_FILES, po/POTFILES: Remove duplicate files.
    
    Because v2v/test-harness is a subdirectory of v2v, and because both
    paths are listed in $(DIST_SUBDIRS), using find $(DIST_SUBDIRS) will
    list files in v2v/test-harness twice.  (This probably happens in other
    directories too, but I noticed it here.)  The easiest fix for this is
    simply to use 'sort -u' to remove the duplicates.

commit 6dcfd85623e9a0dedcae3e9c3ea88af526dc2391
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 15 13:44:27 2017 +0000

    Update gnulib to latest.

commit 3c0bd14852d20226ae4b8431a6f21f9582dd1a6c
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Feb 13 14:26:46 2017 +0100

    dib: add squashfs output format
    
    Implement the "squash" output format, i.e. a squashfs compressed
    filesystem.
    
    This was implemented in diskimage-builder upstream as
    commit 9d13084c4183b63587e1f5e4b03395a8df6538f6.

commit 7a3854001e6dee87cc374f1207c979ae3740d38f
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Feb 13 11:35:13 2017 +0100

    New API: mksquashfs
    
    Introduce a new API to create a new squashfs filesystem out of a path
    in the guest.  It can be configured to exclude paths based on patterns,
    and to select which compression use for the filesystem.
    
    The advantage of running mksquashfs directly in the appliance is that
    ownerships are properly saved, as opposed to tar_out + local untar.

commit 35d97daa5a8bd2ab143b9b7f079e25c642dad33e
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Feb 13 14:20:59 2017 +0100

    daemon: move make_exclude_from_file as common helper
    
    It will be useful also for APIs different than tar-out, so move it to
    guestfsd.c, and add it a parameter to specify the function name that
    invoked it.
    
    This is mostly code motion.

commit 468d335fdf454e138020bd016c8ad179a2d9d6d3
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Feb 13 13:17:08 2017 +0100

    dib: add appliance check hook in Output_format
    
    Add a new hook for Output_format's to check for prerequisites on the
    appliance (which can be done only when the appliance is run).

commit c8236b2f1c92d65e109072fade58eb72c2f333f1
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Feb 10 16:10:10 2017 +0100

    dib: cleanup logs at end of build
    
    Recently, diskimage-builder moved the log cleanup from the 'base'
    element to disk-image-create proper; the cleanup done is:
    - truncate any file in /var/log
    - remove *.log files in /root
    
    This was implemented in diskimage-builder upstream as
    commit 022d93ee822e71245af52c4cf8f8a8e82f599af3.

commit 8ee51ee39603d8a1117c471e6660bf605c7d6b3a
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Feb 10 14:47:26 2017 +0100

    dib: re-read list of scripts when running in-chroot hooks
    
    Scripts (especially root.d and extra-data.d) may add new scripts to the
    existing set during their execution: in this case, re-read the list of
    available scripts, so we do not miss any new addition.

commit 551eb2072fefde7e2ba71ac7d0532ddf8fa734ff
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Feb 10 14:32:52 2017 +0100

    dib: change hooks path when running extra-data.d scripts
    
    It looks like scripts (in particular in the extra-data.d phase) may
    in-flight add new scripts to the existing ones.  As first step to
    handle this situation, change the path of hooks passed for extra-data.d
    scripts: instead of the local temporary directory, use the in-guest
    location that is visible as result of the local fuse-based mount of the
    guest.

commit dfc700d2b574beebc40759a3c463a8656762046a
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Feb 8 13:32:12 2017 +0100

    dib: source dib "die" script in some phases
    
    Source the "die" script, part of the diskimage-builder library, when
    running hooks that run outside the guest chroot.  This is what
    disk-image-create does, and scripts expect to use the "die" function
    without sourcing the "die" script containing it.

commit 0ab539d82fd6330464dd13aa7899d755dd4a3ad0
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Feb 6 16:17:21 2017 +0100

    dib: fix listing envvars in fake-sudo
    
    Query awk for the list of environment variables, instead of trying to
    extract the list from the output of `env`: the old approach breaks when
    any of the environment variable contains more than one line.

commit a75076f271680122a17614e4721be48e9251b21c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 14 14:52:53 2017 +0000

    GCC 7: Allocate sufficient space for sprintf output.
    
    GCC 7.0.1 can determine if there is likely to be sufficient space in
    the output buffer when using sprintf/snprintf, based on the format
    string.
    
    The errors were all either of this form:
    
    bindtests.c:717:29: error: '%zu' directive output may be truncated writing between 1 and 19 bytes into a region of size 16 [-Werror=format-truncation=]
         snprintf (strs[i], 16, "%zu", i);
                                 ^~~
    bindtests.c:717:28: note: directive argument in the range [0, 2305843009213693951]
         snprintf (strs[i], 16, "%zu", i);
                                 ^~~~~
    
    or this form:
    
    sync.c: In function 'fsync_devices':
    sync.c:108:50: error: '%s' directive output may be truncated writing up to 255 bytes into a region of size 251 [-Werror=format-truncation=]
           snprintf (dev_path, sizeof dev_path, "/dev/%s", d->d_name);
                                                      ^~
    
    Fixed by converting these into dynamic allocation, or making the
    output buffer larger, whichever was easier.
    
    There is a gnulib macro we can use to make this simpler for integers.
    It requires a new gnulib module (intprops), but it turns out that we
    were already pulling that in through dependencies, so the change to
    bootstrap is a no-op.  (thanks: Dan Berrange)

commit 0b3a5a0b00bf3f677d570281c0fcf06a54bdeca3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 14 14:51:39 2017 +0000

    GCC 7: Add __attribute__((noreturn)) to some usage functions which call exit.
    
    This happens with GCC 7.0.1.  The errors were all of the form:
    
    qemu-speed-test.c: In function 'main':
    qemu-speed-test.c:153:7: error: this statement may fall through [-Werror=implicit-fallthrough=]
           usage (EXIT_SUCCESS);
           ^~~~~~~~~~~~~~~~~~~~
    qemu-speed-test.c:155:5: note: here
         default:
         ^~~~~~~

commit 39daa0418118a03dafecb70a0d0c71a94f20a119
Author: Cédric Bosdonnat <cbosdonnat@suse.com>
Date:   Fri Feb 10 16:05:58 2017 +0100

    mllib: add Xml.parse_file helper
    
    Provide a helper function rather than having callers read the
    file and then parse the string.

commit 2fe2e17f7d9522e197e538846f2987e58f825f19
Author: Cédric Bosdonnat <cbosdonnat@suse.com>
Date:   Fri Feb 10 16:05:57 2017 +0100

    Move xml and xpath_helpers OCAML code to mllib
    
    To allow other pieces of code to process XML files easily, move the
    xml.ml* and xpath_helpers.ml* from v2v to mllib.

commit c45ce1a7bb0b10ee05a920f445065f298ecdfe04
Author: Cédric Bosdonnat <cbosdonnat@suse.com>
Date:   Fri Feb 10 16:05:56 2017 +0100

    mllib: factorize code to add Checksum.get_checksum function
    
    Getting checksum involves the same code than verifying them. Create
    a get_checksum function and use it in verify_checksum.

commit 1230543f7159c8a936b52eda792340c9759a420b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 31 08:44:21 2017 +0000

    fish: Link to libtinfo (RHBZ#1417549).
    
    Fixes commit a8c5739fd2637038b753669e5a9469d6addd3e15.
    
    Reported by: Jean-Christophe Manciot

commit 23c2351e367e0dc82def6702649279c49d0679cc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 11 09:15:25 2017 +0000

    Version 1.35.24.

commit 53317e3f079863d9ea87725b73c7104b34a607e2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 11 09:07:09 2017 +0000

    test-data: Use qemu-img instead of guestfish to create blank disks.
    
    Since this step runs during make (not make check), guestfish
    hasn't been built yet.
    
    Fixes commit fa83b4787653aa296a09d149cfa3e30aaed4eea6
    and commit 74ded0dbc17b84638cc06c0b4d028484d114c00f.

commit e9deb6fab40d804d1a076b2c52b7287a2d514efd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 10 22:54:04 2017 +0000

    Version 1.35.23.

commit fa83b4787653aa296a09d149cfa3e30aaed4eea6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 10 22:41:55 2017 +0000

    test-data: Use ./run script to run 'guestfish disk-create'.
    
    Commit 74ded0dbc17b84638cc06c0b4d028484d114c00f changes existing calls
    to truncate to run 'guestfisk disk-create' instead.  However this
    fails if guestfish has not been installed.  By using the ./run script,
    we can use the just-built guestfish instead.
    
    Fixes commit 74ded0dbc17b84638cc06c0b4d028484d114c00f.

commit 74660366f6f91cc93de36d4cf87d4f3d06a062c5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 10 13:15:44 2017 +0000

    Version 1.35.22.

commit c99cf0caadc71f834d660ff639c87bf0fcc0edca
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 10 13:29:38 2017 +0000

    v2v: Add result of qemu-img offset/size test to debug output.
    
    Updates commit 3fc95200696f5f572749008b6ce81af71e18a334.

commit 430604ef37f951f452718e06faf4d639ffc125fb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 10 13:29:15 2017 +0000

    v2v: Fix quoting in external qemu-img command.
    
    Fixes commit 3fc95200696f5f572749008b6ce81af71e18a334.

commit 3a8e2babed63d3631c2a0c3821e4e13daed7f155
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 10 13:05:00 2017 +0000

    contrib: Sort patches into alphabetical order and add to EXTRA_DIST.
    
    We also have to use AM_INIT_AUTOMAKE(tar-pax), since otherwise
    automake uses some ancient tar format that doesn't support a filename
    this long.  (See: https://noiselabs.io/2010/02/27/tar-file-name-is-too-long-max-99/
    for a clear explanation)
    
    Fixes commit b702ec19e859f6f3333b129a8b0a7fc278ed400f.

commit 0a8f95a2227a3e43f3560360f9e3580f80ffad52
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 10 12:54:56 2017 +0000

    v2v: ova: Further fix test cases.
    
    Updates commit 7461a8fab14829086f723cba44d07d008994bd5c.
    Fixes and partly reverts commit 8f91d3a9b0356a701c1904e0a2efa5d272d08ac2.

commit 2c340682b500d97143623bb82a10fde2f91bd169
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 10 10:14:15 2017 +0000

    daemon: selinux: Document cases where setfiles takes a long time to run.
    
    Just adding a comment pointed back to the bug.

commit b702ec19e859f6f3333b129a8b0a7fc278ed400f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 8 17:00:57 2017 +0000

    contrib: p2v: Add scripts to build and test virt-p2v ISOs with RHEL 5, 6.
    
    This adds a contrib script which can be used to build the virt-p2v ISO
    on top of RHEL 5 or RHEL 6, i686 (32 bit) or x86-64 (64 bit) base.
    
    There is also a script for testing the ISOs produced this way.

commit 4ab07a9949e75363a193e8f274d53d63d2377526
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 9 17:49:49 2017 +0000

    builder: templates: Call sync after running virt-install.
    
    I don't think this will really make any difference.  However there is
    some puzzling disk corruption in the recently built RHEL 5 & 6 i686
    images, and I want to make absolutely sure they are not caused by an
    unsynchronized disk image.

commit eeb3f42d1f0e77813b5af7b83b4bb18541f579bc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 9 13:23:37 2017 +0000

    builder: templates: Add 32 bit (i386) templates for RHEL 5 and 6.

commit d74ed7b1229c1a837d82d505c3cf2a770ed98b9c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 8 18:37:46 2017 +0000

    p2v: Fix RHEL URLs in kickstart.
    
    Also make the repo directives use the --proxy flag if specified and
    supported.

commit 3e7e6d95c1fef072b628d612edbbe3a04d6e0b06
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 8 17:38:54 2017 +0000

    p2v: Fix virt-p2v-make-kickstart when run from local directory.
    
    It was looking for the binary in p2v/virt-p2v/virt-p2v.xz.  This fix
    makes it look for the correct path p2v/virt-p2v.xz.

commit 3fc95200696f5f572749008b6ce81af71e18a334
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 6 15:38:35 2017 +0000

    v2v: ova: Don't rely on qemu-img version, test "offset" and "size" features.
    
    See:
    
    https://www.redhat.com/archives/libguestfs/2017-February/msg00064.html

commit a1bc37d673d8d8b2db8a88cea51ec1a46bf0c8da
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 4 10:28:41 2017 +0000

    p2v: Document sources of ssh/session timeout problems.

commit 2f97cd5517e68128d6d93d27ca6bd328bbd4a4da
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 4 14:30:29 2017 +0000

    p2v: Send ping packets every 5 minutes to sshd.
    
    Also drop the connection if no response at all has been received after
    30 minutes.
    
    This action should prevent firewall timeouts from causing virt-p2v to
    fail (see this thread:
    https://www.redhat.com/archives/libguestfs/2017-February/msg00010.html).
    
    Thanks: Tomáš Golembiovský

commit 27b64f82272a5bcc3caf8aa17ce4afd2a52a943c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 4 14:26:10 2017 +0000

    p2v: Use the ADD_ARG macro to simplify ssh/scp parameters.
    
    No functional change.

commit 0de08f6527c9d825e85366e5f43e78df1e5842e9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 4 14:25:14 2017 +0000

    daemon: Allow ADD_ARG macro to be used everywhere.
    
    This is a simple macro with no dependencies.  Allow it to be used from
    any program.

commit 4983084b8c3e3bf9bb6284ae1aa5eff28f0468ab
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 8 12:04:23 2017 +0000

    resize: tests: Remove comment.
    
    Doesn't look like we'll handle extended partitions any time
    soon, so remove comment.

commit 23878acbbdb54d2035bc54436f84e0ddf968c848
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 8 11:58:34 2017 +0000

    builder: tests: Disable valgrind for test with multi-line parameters.
    
    Breaks libtool, see:
    https://bugzilla.redhat.com/show_bug.cgi?id=1420301
    
    This updates commit 736a8465a6c80700c76078ba581f2cd30374eb03.

commit 736a8465a6c80700c76078ba581f2cd30374eb03
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 8 10:30:58 2017 +0000

    valgrind: Add libtool to the @VG@ macro.
    
    There were still a few places where we were testing bash rather than
    the intended program.  Add `libtool --mode=execute' to the beginning
    of the @VG@ macro to try to get around this.

commit 6ec23eeac03d27657c548cf2cf87c419889cdd58
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 7 18:51:39 2017 +0000

    Version 1.35.21.

commit 0276b3e24609c3dd5a765811a557c002e89f15c5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 7 21:53:22 2017 +0000

    v2v: ova: Add various test data files to EXTRA_DIST.
    
    Fixes commit 8f91d3a9b0356a701c1904e0a2efa5d272d08ac2.

commit f73ac1fc9c21d70e33824e61cf091533afb57273
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 7 21:08:38 2017 +0000

    v2v: Skip one test because virt-v2v -i ova can break with libvirt backend.
    
    See:
    https://www.redhat.com/archives/libguestfs/2017-February/msg00101.html

commit 74ded0dbc17b84638cc06c0b4d028484d114c00f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 7 17:34:14 2017 +0000

    RHEL 5: tests: Don't use 'truncate' command.
    
    The coreutils 'truncate' command does not exist in RHEL 5.  Replace
    use of this command in tests with the guestfish 'disk-create' command.

commit 7461a8fab14829086f723cba44d07d008994bd5c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 7 18:50:52 2017 +0000

    v2v: ova: Normalize the output in test case.
    
    Fixes commit 8f91d3a9b0356a701c1904e0a2efa5d272d08ac2.

commit fa6016af19d3fbda749cf0b4d5835a92a5cfd1bc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 2 17:59:26 2017 +0000

    p2v: Use socket activation with qemu-nbd and nbdkit.
    
    If supported, use socket activation to pass a pre-opened listening
    socket to the NBD server.  This means we can guarantee to choose an
    unused port even if there are multiple instances of virt-p2v running
    (ie. when testing) or if there are unexpected services running on the
    same machine.
    
    This change applies to both NBD servers, since both now (or will
    shortly) support this feature.

commit 2e0c33a7b91d2f556e70b70665891d0843df4f0d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 3 13:39:48 2017 +0000

    p2v: Don't hard code "localhost" (NBD listening address) everywhere.
    
    No functional change.

commit 4dd4a9b1a6c11e6c9d65d96420221f797b6a4a9d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 2 17:38:18 2017 +0000

    p2v: Move nbd_local_port to nbd.c.
    
    In preparation for using socket activation, move the nbd_local_port
    global inside nbd.c and make it private.
    
    This is largely code motion.  However I rearranged the order in which
    the ssh data connection and the NBD server are started up.  Previously
    the ssh connection was made first, and the NBD server was then
    started.  Now the NBD server starts first.  This happens so that nbd.c
    can choose the local port, and when we implement socket activation it
    will allow nbd.c to open the socket and choose a free port too.

commit cdd8dc4145b464e41b31f974bc69660f23355105
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 2 16:39:56 2017 +0000

    p2v: Clean up ugly implementation of --nbd option.
    
    The previous implementation was pretty ugly.  This reimplements things
    a bit more cleanly.

commit d9ab95ec168a3b7a48fbbf3981b809d84fe9b7da
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 2 15:44:48 2017 +0000

    p2v: Move NBD-related functions into a separate file.
    
    This is almost pure code motion, but I changed the name and prototype
    of the function 'wait_nbd' to make its purpose clearer, and to remove
    the unnecessary timeout setting (which is hard-coded).

commit 8a2b0738d1b79f288b14fc35294567430d10b7ec
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Jan 12 11:28:28 2017 +0100

    resize: support non-local output disks (RHBZ#1404182)
    
    Parse the output disk as URI, and use all its attributes just like
    it is done for the input disk.  The only change is that the fsync of the
    output disk is limited now for local URIs only, since it will not work
    with remote protocols.

commit 10a5567dc785cb0b840fcc4fdf2c0b9480857492
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 3 15:08:52 2017 +0000

    lib: g->program is now never the empty string.
    
    The getprogname module either sets g->program to a string derived from
    argv[0] or fails at compile time.
    
    Fixes commit eea210dbf7d781bc253f927977868dbc6776f20d.

commit c1bd2c3e742dc5a37e4a673822a4588d1c211c37
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Feb 2 13:34:13 2017 +0100

    dib: add tgz output format
    
    Implement the "tgz" output format, i.e. "tar" compressed as gzip.
    
    This was implemented in diskimage-builder upstream as
    commit da41ee6012b064aa6901c871a1104a3a3933117e.

commit 91646e0bb605adf62c879a15f14db8f5f2b25646
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Feb 2 11:58:06 2017 +0100

    dib: clarify "output:" lines in --machine-readable documentation

commit 35f29deacc199bf91f116e87259ea7782feb5536
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Feb 2 11:53:53 2017 +0100

    dib: refactor output formats handling
    
    Implement a system similar to the operations in virt-sysprep, so each
    output format has its own file and attributes (such as command line
    arguments).
    
    The result is that there is no more need to spread everywhere the job
    required by each output format, such as checking for tools, or hooking
    at the right point.

commit 00ecda5d9c375393e01f6f60df35c9aeeed93314
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Jan 18 14:38:59 2017 +0100

    dib: pass custom mkfs options after the filesystem type
    
    Make sure they are handled as options for the actual mkfs driver,
    instead of mkfs itself.  Also, improve the documentation of
    --mkfs-options accordingly.
    
    This was fixed in diskimage-builder upstream as
    commit 5e2330d89c6c0e55b270464abea7e99a4d3246ad.

commit 380fd71dc87505b2965b08a0f05bd6007e3f0408
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Jan 18 13:50:04 2017 +0100

    dib: add --checksum
    
    Add a new option to create files with the MD5 and SHA512 checksums of
    all the disk image types produced.
    
    This was implemented in diskimage-builder upstream as
    commit 2ea5feca5c4b64867ac327736edfb20408f8840e and
    commit 22952b7ea0543bb4f446752976d1d8ba232b021a.

commit bc06d59855fd607b660d8d73bfc8ae4da1b1d9be
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jan 17 15:57:47 2017 +0100

    dib: clear up "already provided" message
    
    Improve the error message that is shown when trying to selecting an
    element, and another element provides it.
    
    This was implemented in diskimage-builder upstream as
    commit 452f7b8d5aaa6e85e3b01b970cd9cbc842b34b86.

commit ab0cf0012fa11939a73cc97dac3b6b865f2244d4
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Jan 5 13:26:48 2017 +0100

    fuse: use the configured program name
    
    When initializing FUSE, use the program name as set (either
    automatically or manually) in the guestfs handle.

commit 5657d4726d316a48d5433f0bb7a07376252afdd7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 4 15:49:26 2017 +0000

    v2v: Use failwithf instead of failwith (sprintf ...)

commit a11040d9cdaa567eed06b41ff56aa2a9b2b81e6e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 4 15:46:58 2017 +0000

    v2v: Use failwith/failwithf instead of raise (Failure ...)
    
    Minor refactoring of ommit d3c93e332030891426db3800ce137050590ba4f6.

commit 8f91d3a9b0356a701c1904e0a2efa5d272d08ac2
Author: Tomáš Golembiovský <tgolembi@redhat.com>
Date:   Sat Feb 4 15:10:46 2017 +0100

    v2v: ova: don't extract files from OVA if it's not needed
    
    We don't have to always extract all files from the OVA archive. The OVA,
    as defined in the standard, is plain tar. We can work directly over the
    tar archive if we use correct 'offset' and 'size' options when defining
    the backing file for QEMU. This puts much lower requirement on available
    disk space.
    
    Since the virt-v2v behaviour for OVA input now depends on QEMU version
    available this affects some of the tests. Expected result of the
    affected also has to depend on the QEMU used thus such tests will have
    two *.expected files.
    
    Signed-off-by: Tomáš Golembiovský <tgolembi@redhat.com>

commit d3c93e332030891426db3800ce137050590ba4f6
Author: Tomáš Golembiovský <tgolembi@redhat.com>
Date:   Sat Feb 4 15:10:45 2017 +0100

    v2v: add function find_file_in_tar to utils
    
    The function looks up file in tar archive and returns a tuple containing
    which at byte it starts and how long the file is.
    
    Signed-off-by: Tomáš Golembiovský <tgolembi@redhat.com>

commit 3839b0be5ba05e8189e6617c568c39e98fccf0bb
Author: Tomáš Golembiovský <tgolembi@redhat.com>
Date:   Sat Feb 4 15:10:44 2017 +0100

    v2v: add function qemu_img_version to utils
    
    The function returns version of qemu-img as a tuple (major, minor), or
    the value (0,9) in case there was an error detecting the version.
    
    Signed-off-by: Tomáš Golembiovský <tgolembi@redhat.com>

commit e9eb3a79da47a5c99ad0cd5d49d1990e7fd2dd8e
Author: Tomáš Golembiovský <tgolembi@redhat.com>
Date:   Sat Feb 4 15:10:43 2017 +0100

    mllib: add subdirectory function to common_utils
    
    Signed-off-by: Tomáš Golembiovský <tgolembi@redhat.com>

commit 152657178d5e0eb6f48d17bf9db0cc8238678566
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 4 15:11:39 2017 +0000

    generator: Move failwithf to mllib.
    
    A useful function.  This is just code motion.

commit 2b5173712ba07e3e89926c82a236390a4ea6626a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 1 13:36:07 2017 +0000

    v2v: Further increase memory allocated to the appliance (RHBZ#1418283).
    
    In commit 08f82f2e3d6975b72340dd59f438862e152a15ef we increased the
    memory size to 800MB (on x86) so that the semodule command would work.
    
    However it has been discovered that another SELinux command takes
    large amounts of RAM (setfiles during the SELinux relabel step).
    Therefore increase the memory size again, this time to 2000MB.

commit d5383ca06647b9fce3d6a6b7c89e99c6485a417b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 1 12:22:11 2017 +0000

    docs: Document that virt-p2v can use qemu-nbd or nbdkit.
    
    Fixes commit 4af9081e0d8e9e16fccad0150ac1cb1c2cae4c4d.

commit 889386f8c6088e57fd68f2bb6bf85f69ecfc6f6c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 31 19:25:25 2017 +0000

    uefi: Remove references to kraxel's old edk2 builds.
    
    As noted in the source code, these were due to be removed at
    the end of 2016.

commit c465e794b26304c5998562313b02a23c18a29f28
Author: Tomáš Golembiovský <tgolembi@redhat.com>
Date:   Mon Jan 30 22:43:14 2017 +0100

    v2v: ova: don't detect compressed disks, read the OVF instead
    
    The information whether the disk is gzip compressed or not is stored
    in the OVF. There is no reason to do the detection.
    
    Signed-off-by: Tomáš Golembiovský <tgolembi@redhat.com>

commit 2e5033349ab132c6721d701ea19eddde98e2d0bd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 31 11:00:51 2017 +0000

    configure: Fix release date of 1.35.20.
    
    Fixes commit 7b6b9d9bea648a88c7c6519c2780f2291771c28d.

commit d5752538bf7c62c1538b707902ed20fa39b236f8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jan 29 17:54:06 2017 +0000

    common/miniexpect: Add README and miniexpect.pod from upstream.

commit e79a2af219f5b55a1b62299524118b86a5c76136
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jan 29 17:25:41 2017 +0000

    generator: Make 'main.ml' clearer.
    
    - Make module name explicit, so it's more obvious which module a
      function is defined in.
    
    - Group lines of code by feature.
    
    - Capitalize some module names properly.
    
    Just code motion, no functional change.

commit c9a51b2fd27b269f5250904040667282ffaaebbb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jan 29 13:33:16 2017 +0000

    po: Really ignore perl/lib/Sys/Guestfs.c (RHBZ#1417444).
    
    Incorrect grep expression meant this file was not being ignored
    before.
    
    Thanks: Marius Cirsta

commit 48d4117789e92489b9a3c6f3456b0770b3fdb290
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 28 13:23:40 2017 +0000

    fish: Handle changed type of 'len' parameter in gperf 3.1 (RHBZ#1416941).
    
    Commit 004de6cf45cfe66ca166cbdcb1c3125a2a81eb31 was not sufficient to
    solve this problem.  We are also using gperf in guestfish.  Rewrite
    the code in the same way to avoid having to prototype the hash
    function.

commit 7b6b9d9bea648a88c7c6519c2780f2291771c28d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 27 13:02:36 2017 +0000

    Version 1.35.20.

commit 4733cb6ceafe4b5890e1f30006281e0053aaf71b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 26 14:32:23 2017 +0000

    p2v: Add a test for virt-p2v with nbdkit.

commit 4af9081e0d8e9e16fccad0150ac1cb1c2cae4c4d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 26 14:30:42 2017 +0000

    p2v: Allow nbdkit as an alternative NBD server to qemu-nbd.
    
    Add code in virt-p2v so that it can use nbdkit (with the file plugin)
    as an alternative to qemu-nbd.
    
    This is controlled through the virt-p2v --nbd command line option,
    allowing you to select which server (out of qemu-nbd or nbdkit) you
    prefer (with a fallback).  The default is: --nbd=qemu-nbd,nbdkit so
    qemu-nbd will be used preferentially.

commit 57d1e553744dc2777d059b8e04a8c4a82065e438
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 26 14:51:41 2017 +0000

    p2v: In non-ISO environment, don't use hard-coded port 50123.
    
    When testing virt-p2v (eg. on the host machine) this prevents us from
    testing two instances of virt-p2v at the same time because both will
    try to use the same port.

commit 535e6f5ebb84cd7147d9b810c9c7c6db3327c92b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 26 15:49:35 2017 +0000

    tests/mount-local, tests/parallel: Use srandom (time (NULL) + getpid ()).
    
    If two instances of the test start at exactly the same time, they
    would have the same random number seed.

commit 5d607f752bcdabcffded0ee1595df3c7b980cbce
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 26 19:23:46 2017 +0000

    common/edit: Don't use random() function.
    
    Generate the random filename using our utility function
    guestfs_int_random_string.  This also means that we will not need to
    call srandom() in guestfish or virt-edit.

commit 004de6cf45cfe66ca166cbdcb1c3125a2a81eb31
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 26 21:22:48 2017 +0000

    errnostring: Handle changed type of 'len' parameter in gperf 3.1 (RHBZ#1416941).
    
    The prototype of the hash function changed in gperf 3.1:
    
    * The 'len' parameter of the hash function and of the lookup function is now
      of type 'size_t' instead of 'unsigned int'. This makes it safe to call these
      functions with strings of length > 4 GB, on 64-bit machines.
    
    This commit moves the guestfs_int_string_to_errno function into the
    third (functions) section of the gperf file so it is able to use the
    lookup function without needing a prototype.
    
    Thanks: Marius Cirsta

commit 00a2b689b36d9e8680f5360da991d770b634092a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 27 09:31:40 2017 +0000

    Revert "errnostring: Handle changed type of 'len' parameter in gperf 3.1 (RHBZ#1416941)."
    
    This reverts commit 3a2b89a09ea12db7c55b07cb9e95cdf09b5b845b.

commit 3a2b89a09ea12db7c55b07cb9e95cdf09b5b845b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 26 21:22:48 2017 +0000

    errnostring: Handle changed type of 'len' parameter in gperf 3.1 (RHBZ#1416941).
    
    The prototype of the hash function changed in gperf 3.1:
    
    * The 'len' parameter of the hash function and of the lookup function is now
      of type 'size_t' instead of 'unsigned int'. This makes it safe to call these
      functions with strings of length > 4 GB, on 64-bit machines.
    
    This change tries to detect the required type in ./configure
    
    Thanks: Marius Cirsta

commit 8ee97b8859d9da805500c54761d4681c8ef26bb1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 25 17:59:45 2017 +0000

    p2v: Move miniexpect library to common/miniexpect.
    
    No change, just code motion.

commit db48870cf3ed8fab266ba38b2a941944077979f0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 25 13:21:03 2017 +0000

    df: Move framework for processing domains in parallel to common/parallel.
    
    Just code motion.

commit a8c5739fd2637038b753669e5a9469d6addd3e15
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 25 12:03:40 2017 +0000

    fish: Move edit, progress, windows under common/
    
    Three more pieces of common code are moved under the common/
    subdirectory.  This is just code motion.
    
    Note that windows.[ch] wasn't even being used by guestfish.  That code
    was only used in other virt tools.

commit a9199a46b12b4efe3a12046e556a8b52032e8cda
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 20 11:24:49 2017 +0000

    fish: Move fishcommon library to common/options.
    
    This is mostly code motion but:
    
    (1) I had to remove the compile-time COMPILING_GUESTFISH and
    COMPILING_VIRT_RESCUE macros and replace them with runtime constants
    and checks.
    
    (2) I moved the fish/config.c file into this library.

commit 779bc1de23e11e787dc063780fbd4cda5e49c83f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 19 19:34:21 2017 +0000

    cat: Move visit library to new directory common/visit.
    
    Just code motion.

commit f161c9ea573fa193ef178da8741aee7241e04593
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 19 18:19:07 2017 +0000

    Rename src/ to lib/

commit b53cec584d46e710e534312a7aefdbb9f25856da
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 19 15:53:19 2017 +0000

    lib: Move utilities to new directory common/utils.
    
    Just code motion.
    
    This commit makes it clearer what is a utility and what is part of the
    library.  It also makes it clear that we should rename:
    
      guestfs-internal-frontend.h -> utils.h
      guestfs-internal-frontend-cleanups.h -> cleanups.h (?)
    
    but this commit does not make that change.

commit 88c0ce2397a7fe9106c1b91658882292d48a7ee8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 19 15:02:17 2017 +0000

    lib: Share common protocol and errnostring libraries with the library and daemon.
    
    This commit, which is just code motion, moves the common XDR protocol
    code (libprotocol) and the common errno handling (liberrnostring) into
    libraries which are each built once and shared between the library and
    daemon.

commit e285566369c4aabb97641372cc9ede530cc5a434
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 25 18:00:31 2017 +0000

    gobject: Avoid multiply defined CLEANFILES.
    
    The error is:
    
    gobject/docs/gtk-doc.make:52: warning: CLEANFILES multiply defined in condition TRUE ...
    gobject/docs/Makefile.am:95:   'gobject/docs/gtk-doc.make' included from here
    common-rules.mk:28: ... 'CLEANFILES' previously defined here
    gobject/docs/Makefile.am:18:   'subdir-rules.mk' included from here
    subdir-rules.mk:20:   'common-rules.mk' included from here

commit 84254bf739a5be49e3aacccdac0aa9b8233194a7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 26 14:37:49 2017 +0000

    p2v: Don't inhibit D-Bus support for modern systems.
    
    Fixes commit c526afbe95cdc613fc24a948e5323c73eafc69f0.

commit c90baa812af4e1e7c924d0c517f981af2fed89d2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 25 12:25:08 2017 +0000

    p2v: gtk: Update docs/C_SOURCE_FILES.
    
    Updates commit 17cc502d9b14e36854f1fa26ab551665f9b6ba91.

commit 571269bf72a4ccbce22d723ca2a166593a8cc34e
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Jan 20 14:47:51 2017 +0100

    p2v: log also environment on conversion server
    
    Save the content of the environment on the conversion server, so it is
    one additional help when debugging failed conversions.

commit 718ce7964c198b40176f9cf854e07e3dda667a00
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 21 13:54:02 2017 +0000

    RHEL 5: p2v: Ignore garbage when decoding base64 sections in kickstart.
    
    RHEL 5 base64 utility requires this flag to ignore newlines in input.

commit ae160215ca02b2d48568dc595e0c8861900ed73c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 21 05:22:36 2017 -0500

    RHEL 5: p2v: Workarounds for limited partial match support in ancient PCRE.
    
    In the ancient version of PCRE in RHEL 5, partial match support does
    not support /.*/, returning PCRE_ERROR_BADPARTIAL.  However the
    equivalent regular expression /(?:.)*/ works fine, so use that
    instead.

commit 17cc502d9b14e36854f1fa26ab551665f9b6ba91
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 21 09:51:52 2017 +0000

    p2v: gtk: Move Gtk compat macros into separate files.
    
    Just code motion.

commit 9ceb0cca05b8045234d653ed100ee98f3392d892
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 21 04:41:05 2017 -0500

    p2v: Include file and line number in internal errors.

commit a77ef0e7c8d8464b54d1296a18307ce40c1ac794
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 21 04:34:17 2017 -0500

    RHEL 5: p2v: Compile GUI for ancient Gtk 2.10.
    
    RHEL 5 has ancient Gtk 2.10 which lacks several functions and whole
    features we need (eg the spinner).  Add various macros and function
    definitions to work around this.

commit c526afbe95cdc613fc24a948e5323c73eafc69f0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 21 04:33:08 2017 -0500

    RHEL 5: p2v: Don't compile inhibit support if dbus doesn't support FD passing.
    
    Since RHEL 5 doesn't have systemd, inhibit isn't supported anyway, so
    compiling it out is no problem.

commit 035d83960198455e12f7fda8a1550851e50a0036
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 21 04:29:05 2017 -0500

    RHEL 5: p2v: Skip partial match checking when PCRE_INFO_OKPARTIAL is not defined.
    
    This test is only a sanity check, so skip it when pcre doesn't define
    this symbol.

commit 4f102b6832efe5957aae6f294d6b1cf36c850b75
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 20 13:47:35 2017 +0000

    p2v: Document lscpu, lspci, lsscsi, lsusb files.
    
    Updates commit 5f0bcc3057ec22dba37a8cb8468892e85023998e.

commit 5f0bcc3057ec22dba37a8cb8468892e85023998e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 20 09:09:49 2017 +0000

    p2v: Add more debugging information: lscpu, lspci, lsscsi, lsusb.
    
    Dump extra information from the source physical machine to help with
    debugging.

commit 1aefcbcc9b43668045429e5c71dcafd32349aa33
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 19 12:06:25 2017 +0000

    daemon: Add comment explaining why we remove 'p' character.
    
    No code change, just a comment.
    
    Updates commit 6fd2ddb35068b114b8f4bf1ac0ad30fde0ab0eba.

commit 5b02e7e6dfa3fffd091c406433025ad902976db5
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Jan 19 11:22:17 2017 +0000

    daemon: Return MD partitions in guestfs_list_partitions (RHBZ#1414510).

commit 6fd2ddb35068b114b8f4bf1ac0ad30fde0ab0eba
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Jan 19 11:00:21 2017 +0000

    daemon: Fix part-to-dev when the partition name includes p<N>.
    
    If the device name ends with a number, Linux uses partition names of
    the form <device>p<N>.  Handle this case by knocking off the 'p'
    character.

commit 5c350db94d9861190454da406c13d1722f387447
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 19 09:16:52 2017 +0000

    tests: Add unit tests for guestfs_canonical_device_name.

commit 4fa7df3ed7b1814f5061ff8d512704bf831aae9c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 19 09:15:16 2017 +0000

    canonical_device_name: Don't rewrite /dev/mdX as /dev/sdX (RHBZ#1414682).
    
    The guestfs_canonical_device_name API was rewriting /dev/mdX as
    /dev/sdX.  This is wrong since (eg) /dev/sd0 is not a device name, so
    if you pass the canonicalized name back to the API it will fail.
    virt-v2v was one tool doing this.

commit 4a9af91e3632047579c3a7e011c1484c97bd959a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 17 10:18:48 2017 +0000

    aarch64: launch: direct: Use virtio-pci devices.
    
    qemu-system-aarch64 -M virt now supports virtio-pci devices.  These
    are considerably faster than virtio-mmio so use them by default.

commit faff6f23ff958c4fbb66603349d7a984361a2818
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 18 12:19:01 2017 +0000

    lib: uefi: Don't call access(NULL) if no UEFI debug file exists.
    
    Bug found by valgrind on aarch64:
    
    ==21350== Syscall param faccessat(pathname) points to unaddressable byte(s)
    ==21350==    at 0x4F05274: access (access.c:29)
    ==21350==    by 0x4954DC3: guestfs_int_get_uefi (appliance-uefi.c:90)
    ==21350==    by 0x49752D7: launch_libvirt (launch-libvirt.c:413)
    ==21350==    by 0x496FD83: guestfs_impl_launch (launch.c:98)
    ==21350==    by 0x4902003: guestfs_launch (actions-3.c:145)
    [...]
    ==21350==  Address 0x0 is not stack'd, malloc'd or (recently) free'd

commit d45986d21b6f1709264f7e2ecfeb240c9c578090
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 24 16:25:36 2016 +0000

    lib: Use a common function to validate strings.

commit e035d848f78b2151fdba23832e99b019679578a5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 18 10:23:10 2017 +0000

    mllib: Avoid OCaml local roots corruption.
    
    Because we used 'return' directly, the effect of the CAMLparam0()
    macro was not undone, resulting in local roots corruption when the
    visit callback throws an exception.
    
    The visit_tests unit test picked this up, but the corruption was only
    seen on aarch64.
    
    Fixes commit 4a62e521116cd6b464718a5a54dba6230c639f28.

commit 3a160fe16b0accfe85f371b6ba42b3477a6433aa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 17 08:57:25 2017 +0000

    lib: Add missing <unistd.h> to appliance-uefi.c.
    
    appliance-uefi.c: In function 'guestfs_int_get_uefi':
    appliance-uefi.c:67:9: error: implicit declaration of function 'access' [-Werror=implicit-function-declaration]
         if (access (codefile, R_OK) == 0 && access (varsfile, R_OK) == 0) {
             ^~~~~~
    appliance-uefi.c:67:5: error: nested extern declaration of 'access' [-Werror=nested-externs]
         if (access (codefile, R_OK) == 0 && access (varsfile, R_OK) == 0) {
         ^~
    appliance-uefi.c:67:27: error: 'R_OK' undeclared (first use in this function)
         if (access (codefile, R_OK) == 0 && access (varsfile, R_OK) == 0) {
                               ^~~~
    appliance-uefi.c:67:27: note: each undeclared identifier is reported only once for each function it appears in
    cc1: all warnings being treated as errors
    
    Fixes commit dd519e8a8ea2be89862f3cec99aff9e19c458afa.

commit b9f510328accb18d907fae8b6804f2eadb387016
Author: Cédric Bosdonnat <cbosdonnat@suse.com>
Date:   Tue Jan 3 11:18:52 2017 +0100

    builder: extract Yajl helper functions to yajl.ml
    
    Extract the yajl object_get_* helpers in the Yajl module since this
    could be useful for any Yajl user code.

commit c96bcb4e24755007de527c8280a9617effb04bfc
Author: Tomáš Golembiovský <tgolembi@redhat.com>
Date:   Sun Dec 18 23:16:32 2016 +0100

    tests: rename guestfs-hashsums.sh to test-utils.sh
    
    Signed-off-by: Tomáš Golembiovský <tgolembi@redhat.com>

commit 8644ea724279dc8a99381fdf3d0799952b6077c9
Author: Tomáš Golembiovský <tgolembi@redhat.com>
Date:   Sun Dec 18 23:16:30 2016 +0100

    v2v: ova: move the untar function
    
    Move the untar function so it can be used later in the code.
    
    Signed-off-by: Tomáš Golembiovský <tgolembi@redhat.com>

commit 347e4b16487eafa404d34829fde2aee52e4f649d
Author: Tomáš Golembiovský <tgolembi@redhat.com>
Date:   Sun Dec 18 23:16:28 2016 +0100

    mllib: compute checksum of file inside tar
    
    Signed-off-by: Tomáš Golembiovský <tgolembi@redhat.com>

commit e86b36a31c1be9fdf80893a2bc702c40de05ee76
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jan 3 17:41:16 2017 +0100

    appliance: add ldmtools/libldm packages on more distros (RHBZ#1409023)
    
    Add them also for Debian and Mageia, where libldm is shipped, and
    adjust the comment on the RedHat line.

commit 55bf7de97ca57329146ee65b9f2974e3be334a52
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jan 3 16:48:21 2017 +0100

    Update copyright dates for 2017
    
    Run the following command over the source:
    
      perl -pi.bak -e 's/(20[01][0-9])-2016/$1-2017/g' `git ls-files`
    
    (Thanks Rich for the perl snippet, as used in past years.)

commit dd519e8a8ea2be89862f3cec99aff9e19c458afa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 24 15:58:36 2016 +0000

    lib: Move some appliance functions around.
    
    Move some appliance functions out of src/appliance.c and src/launch.c
    into separate files.
    
    No functional change, just code movement.

commit 61d26f85fc7a3b206cf054aa623e66d87f7af2ad
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 23 22:56:15 2016 +0000

    Version 1.35.19.

commit f7bd9bd37fa08f1965ec85e305dc9441352644ff
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 18 20:08:32 2016 +0000

    launch: Validate $TERM before passing it through to the kernel command line.
    
    Make sure it is reasonable before we pass it through to the kernel
    command line.  I don't believe this is exploitable, but it might cause
    obscure bugs.

commit f94cfde5e7fc33387c3679be1609a21468a98754
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 18 20:04:05 2016 +0000

    launch: Rationalize how we construct the Linux kernel command line.
    
    This is just code refactoring.

commit 764fd3fcc629ff91582ec8549ff80c240ba8393b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 18 19:27:20 2016 +0000

    appliance: Disable EDD (edd=off) (RHBZ#1404287).
    
    EDD (https://en.wikipedia.org/wiki/Enhanced_Disk_Drive) is a BIOS INT 13h
    subcall for communicating the extended size of the boot disk over 8GB
    to the OS.  Since libguestfs doesn't use a boot disk, and the
    appliance disk is limited to 4GB, and we use virtio-scsi, this is all
    useless.
    
    EDD is also broken currently on RHEL 7.3, see:
    https://bugzilla.redhat.com/show_bug.cgi?id=1404287
    
    Also the EDD probing takes significant extra time (about 80ms on my
    laptop), and using edd=off reduces this time although doesn't entirely
    eliminate it.

commit 331517d9a3ffd6555dad1a3857c2fe1d9e6a434d
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Dec 15 09:37:01 2016 +0100

    sysprep: remove anaconda's /root/original-ks.cfg
    
    Remove one more leftover file from anaconda.
    
    Related to: RHBZ#1401320.
    Thanks to: Marko Myllynen.

commit adb6a85bf942d2a57e663f1b98f06e8ca675e683
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 14 18:16:16 2016 +0000

    Version 1.35.18.

commit b460c50bf5657068c37014ee88a0abf6ce548d10
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 14 18:14:26 2016 +0000

    sysprep: Add new test to EXTRA_DIST.
    
    Fixes commit 3cb43460d38d357ff7482f7d4c4cebc110e28a0b.

commit d131d2af921fc6bc2aa59ca609a1f811466de29e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 14 17:13:30 2016 +0000

    sysprep: Add common pod_of_list function to new module 'Utils'.

commit d12636daddc44c2217ae3e3d335d6d0cbb16de4b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 14 10:21:36 2016 +0000

    sysprep: Add new operation for removing /etc/passwd- and other backup files (RHBZ#1401320).

commit 3cb43460d38d357ff7482f7d4c4cebc110e28a0b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 14 09:59:52 2016 +0000

    sysprep: Add a new operation to remove editor backup files (RHBZ#1401320).
    
    Remove editor backup files such as *~ and *.bak wherever
    they occur within the guest filesystem.
    
    This also includes a test.

commit ca0ce0c2ec7952f79416724f563a7c7cfcbbfb28
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 14 16:49:14 2016 +0000

    mllib: Add a function to test if a guest is "unix-like".
    
    This is not a precise replacement, since we now allow SSH key
    injection into Minix, but that is probably correct anyway.

commit 2dd2d5cc64239e1f9e6f1a68a313c13d64276448
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 14 09:50:10 2016 +0000

    mllib: Add a binding for fnmatch(3) in glibc or gnulib.
    
    This is taken from supermin.

commit 4a62e521116cd6b464718a5a54dba6230c639f28
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 13 22:03:26 2016 +0000

    mllib: Add a binding for visit function in cat/visit.c.

commit f87ec46558b7319468c5913367c6eeca13d73bd9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 14 16:35:44 2016 +0000

    v2v: Add a comment about why virt-v2v needs the network.
    
    Only to run unconfigure_vmware ().

commit 401e58cba811c43d8a1191713e84121513d1b94f
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Dec 14 17:09:32 2016 +0100

    tests: drop expected-failing btrfs_subvolume_show test
    
    One of the tests for btrfs_subvolume_show tries to invoke it on the
    toplevel subvolume, expecting its failure (since btrfs-progs used to not
    be able to list that).  However, since v4.8.3 btrfs-progs can do that
    (even if the data returned for that subvolume is limited/incomplete),
    and thus this test fails because the API does not fail anymore.
    
    Since we can consider that functionality working (for some kind of it),
    then drop this test.

commit 7bd6a73f0092cf1e23f9b0584a3212df5309367c
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Dec 14 11:09:37 2016 +0100

    libvirt: fix reading secret by usage type
    
    Use the right variable to determine the usage type of a secret.
    
    Fixes commit a94d5513456d7255d6e562953ac163f2d7a816fb.

commit 46669d17c53cd96f4c42d001507427bb41b7e5b2
Author: Matteo Cafasso <noxdafox@gmail.com>
Date:   Sun Dec 11 20:02:23 2016 +0200

    lib: use guestfs_int_make_temp_path to generate temporary files
    
    Signed-off-by: Matteo Cafasso <noxdafox@gmail.com>

commit 774b00e862728babb6a742417aa5810268571f2c
Author: Matteo Cafasso <noxdafox@gmail.com>
Date:   Sun Dec 11 20:02:22 2016 +0200

    lib: generic function for temporary path generation
    
    Signed-off-by: Matteo Cafasso <noxdafox@gmail.com>

commit 3ed0a7a57d8e7ccbfa8e2a644ee88a210f5bb359
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Dec 12 18:18:37 2016 +0100

    v2v: tests: avoid '..' in member names for tar
    
    Very recent versions of tar (most probably as a consequence of
    CVE-2016-6321) may refuse archive members with '..', like the relative
    paths to upper level directories.
    
    Since these are just tests, simply copy the files in the temporary
    directories where tar (or zip as well) is run, so all the files are in
    the same directory.

commit 99834b85b214a72aa6a00d6b4b0aa8a0f8e591ff
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Dec 12 14:02:35 2016 +0100

    perl: fix memory leak in RStruct actions
    
    The return value struct was freed using a simple free() instead of the
    own cleanup function of each struct: this meant dynamically allocated
    values (such as strings) were leaked.
    
    Use the proper cleanup functions instead.

commit 9089b9eaa2ac62ef0729e278ddd20be56be45df7
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Dec 12 13:57:46 2016 +0100

    java: fix memory leak in RStruct actions
    
    The return value struct was freed using a simple free() instead of the
    own cleanup function of each struct: this meant dynamically allocated
    values (such as strings) were leaked.
    
    Use the proper cleanup functions instead.

commit 25ed84c64d05fc1510ee120ef92f54d4733128f6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 12 22:13:00 2016 +0000

    builder: Fixed CentOS 7.3 image.
    
    The previous one had apparent filesystem corruption.
    
    Fixes commit b16627d679d4ff53daba168e125e92db04579efb.

commit b16627d679d4ff53daba168e125e92db04579efb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 12 20:12:11 2016 +0000

    builder: Add CentOS 7.3 template.
    
    Release notice:
    https://lists.centos.org/pipermail/centos-announce/2016-December/022172.html

commit a200c4c32b5c9667d12d93e82ad1f454e9bd83dc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 11 18:30:46 2016 +0000

    Version 1.35.17.

commit 8f32e5d67e3e69c4ad8599e03601551677f840bf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 11 18:23:11 2016 +0000

    builder: Fix copying of virt-builder index.asc etc to website.
    
    The definition of BUILDFILES was accidentally removed, resulting
    in the error:
    
      cp  /home/rjones/d/websites/libguestfs/download/builder/
      cp: missing destination file operand after '/home/rjones/d/websites/libguestfs/download/builder/'
    
    Fixes commit 65a05703858341476b9b2ceea2ef43e6f1447c43.

commit 89ea624571981decfe6afab0679e266d850243a1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 10 16:31:17 2016 +0000

    Version 1.35.16.

commit 2e7aecd1add859adec208b5a9948a955852b0cb6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 10 16:20:34 2016 +0000

    builder: Don't try to translate make-template.ml.
    
    It fails with:
    
      File "../builder/templates/make-template.ml", line 1, characters 0-1:
      Parse error: [a_LIDENT] expected after "#" (in [implem])
      End_of_file
      An error occurs while processing.
    
    In any case this doesn't matter because this file should not be
    translated.
    
    Fixes commit a1ea9a2599f7039a8b69ffe359ab05a155145589.

commit a1ea9a2599f7039a8b69ffe359ab05a155145589
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 10 15:37:13 2016 +0000

    Version 1.35.15.

commit f070774e2cb15b99e784b9285a92a566dbc35d4b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 10 15:36:46 2016 +0000

    v2v: Fix POTFILES-ml.
    
    Fixes commit 222535fa1252cfe127c5eac0b70f5e37c8add396.

commit 546fd23504c8c1d243778ecccba87186f30b3d8f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 10 15:36:09 2016 +0000

    builder: Add website/download/builder/* files to EXTRA_DIST.
    
    Fixes commit 65a05703858341476b9b2ceea2ef43e6f1447c43.

commit f2435c7ab4abefea460b25c92eb5541c6ee67ba6
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Dec 9 13:52:00 2016 +0100

    inspect: improve canonical_mountpoint implementation
    
    Use a simplier version using a loop, skipping multiple '/' at once,
    reducing the amount of memmove and strlen needed.
    
    Updates commit 865d070ddcbb071a919614f45c8eef8fcb4497ff.

commit 24d14e1d26e81ba858ae9a92ca86888d30f2f46e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 8 13:24:11 2016 +0000

    v2v: Fix ambiguous and probably incorrect pattern match (warning 57).
    
    See:
    http://caml.inria.fr/pub/docs/manual-ocaml/comp.html#ss%3Awarn57
    
    I believe the code as written previously was incorrect.  However we
    are lucky because if neither clause matches then it will fall through
    to displaying an error message, allowing the user to correct the
    problem.

commit c540676f5eafacef5b5e245a2614e6d7d74b50d6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 8 13:17:22 2016 +0000

    Remove most instances of OCaml warning 52.
    
    See:
    http://caml.inria.fr/pub/docs/manual-ocaml/comp.html#s:comp-warnings

commit 63ff96ccda6a0d27e8874d0bb0356c42deb3eff3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 8 12:58:51 2016 +0000

    customize: Remove Customize_utils module.
    
    After the previous commit this module is empty, so remove it.

commit 07fb30b1618310e5a944a947499c4d121d8bd3d8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 8 12:49:38 2016 +0000

    mllib: Add quote function to Common_utils module.
    
    Remove multiple places where we let quote = Filename.quote

commit 2cc348448ae3a0ca2f68c36f78b5ae7aeecc80e7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 8 09:53:50 2016 +0000

    generator: Share Common_utils code.
    
    For a very long time we have maintained two sets of utility functions,
    in mllib/common_utils.ml and generator/utils.ml.  This changes things
    so that the same set of utility functions can be shared with both
    directories.
    
    It's not possible to use common_utils.ml directly in the generator
    because it provides several functions that use modules outside the
    OCaml stdlib.  Therefore we add some lightweight post-processing which
    extracts the functions using only the stdlib:
    
      (*<stdlib>*)
      ...
      (*</stdlib>*)
    
    and creates generator/common_utils.ml and generator/common_utils.mli
    from that.  The effect is we only need to write utility functions
    once.
    
    As with other tools, we still have generator-specific utility
    functions in generator/utils.ml.
    
    Also in this change:
    
     - Use String.uppercase_ascii and String.lowercase_ascii in place
       of deprecated String.uppercase/String.lowercase.
    
     - Implement String.capitalize_ascii to replace deprecated
       String.capitalize.
    
     - Move isspace, isdigit, isxdigit functions to Char module.

commit 865d070ddcbb071a919614f45c8eef8fcb4497ff
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 6 09:40:42 2016 +0000

    inspect: fstab: Canonicalize paths appearing in fstab.
    
    For example, converts "///usr//local//" -> "/usr/local".

commit 222535fa1252cfe127c5eac0b70f5e37c8add396
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 1 13:00:51 2016 +0000

    v2v: Rename RHEV to RHV throughout.
    
    You can now use -o rhv (-o rhev is supported for compatibility).

commit bdaeeb4e606f3828887da87ad5acb4f7b49cfed5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 30 16:52:42 2016 +0000

    v2v: -o vdsm: Add --vdsm-compat flag. -o rhev: Drop support for RHV < 4.1 (RHBZ#1400205).
    
    Support for RHEV with RHEL 6 nodes required us to output the old style
    qcow2 compat=0.10 images.  Since RHEV 3.6 GA, RHEL 6 has not been
    supported as a RHEV node type.  Since RHV 4.1, compat=1.1 is
    supported.  (Support for compat=1.1 is uncertain in RHV 4.0 even on
    RHEL 7 nodes.)
    
    There are significant downsides to using qcow2 compat=0.10 instead of
    the modern default (compat=1.1).
    
    Therefore this patch does two things:
    
    For -o rhev, it drops support for compat=0.10 completely.  You must
    use RHV 4.1.
    
    For -o vdsm, it adds an interim flag (--vdsm-compat=0.10 or
    --vdsm-compat=1.1) which controls the compat level of the qcow2 output
    file.  VDSM should use --vdsm-compat=1.1 when it is known that modern
    qemu is available.  We can make this the default later when all RHV
    instances have moved to 4.1.
    
    It also adds:
    
      vdsm-compat-option
    
    to the `virt-v2v --machine-readable' output to indicate that this flag
    can be used.
    
    Thanks: Yaniv Kaul, Michal Skrivanek.

commit 1d86b3768956f818262a5189bb1ba996dedbf531
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Dec 6 16:08:12 2016 +0100

    inspect: gather info from /usr filesystems as well (RHBZ#1401474)
    
    Flag the filesystems for Linux /usr properly as USR role, and detect
    some data out of it, like the distro information from an os-release
    (if present), and the architecture (since the binaries used for our
    architecture check will be available there only).
    
    Later on, collect the results in a way similar to what is done for
    CoreOS: for each non-CoreOS root, try to find its /usr filesystem, and
    if found then merge what is missing from root; in the last case, also
    override the distro inspection data (version, product name) if available
    in /usr.

commit dad35e55fac526dbcd50964500f2d5047ae011af
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Dec 6 15:18:34 2016 +0100

    inspect: fix existance check of /dev/mapper devices
    
    When checking for the existance of /dev/mapper devices found in the
    fstab of a filesystem, using guestfs_exists means they are checked as
    files in the guest, while they really appear as devices on the
    appliance. Instead, try the lvm name resolution anyway, and ignore them
    when they are reported as missing.
    
    Thanks to: Richard W.M. Jones.
    
    Fixes commit 96b6504b09461aeb6850bb2e7b870a0a4c2f5edf.

commit e21b055f3e449c918391d30b01d038b15d49b39f
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Nov 25 11:18:41 2016 +0100

    resize: shrink/expand swap partitions
    
    Handle the swap partition on their own, rebuilding them using the
    existing UUID and label.

commit aad24f4d562fcfa14596c7981421a8eb289d8d0e
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Nov 25 10:49:16 2016 +0100

    daemon: allow to change the labels of swap partitions

commit a94d5513456d7255d6e562953ac163f2d7a816fb
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Nov 16 11:47:51 2016 +0100

    libvirt: read secrets of disks (RHBZ#1392798)
    
    Read also the secrets associated to disks (<secret> tag within <auth>),
    so qemu can properly open them later on.

commit bef838202b533aa008e62af3f78e0c4654b7c5e9
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Nov 15 15:03:45 2016 +0100

    libvirt: un-duplicate XPath code
    
    Move the checks for empty xmlXPathObjectPtr, and for extracting the
    result string out of it, to a new helper functions.
    
    This is just code motion, there should be no behaviour changes.

commit e77e1ef95ed79d34dfcbaa08e26a333462471899
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Dec 5 17:20:58 2016 +0100

    inspect: mark CoreOS /usr partitions with own USR role
    
    Add a new inspect role for "/usr" partitions, and use that to mark the
    /usr partition in CoreOS: this additional role allows to ease its lookup
    later on, when merging its results into those of the root.

commit 0c4edcecbaa82be2251d296e524e3bb50840ba9e
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Dec 5 16:10:20 2016 +0100

    inspect: change is_root flag into enum
    
    Introduce a new enum to classify the role of a filesystem, if available.
    This will help later on when doing operations on non-root filesystems,
    like detecting particular mountpoints such as /usr.
    
    The new enum has only "root" as known role, which replaces the is_root
    flag.

commit b01416121f59d48566a0ce6d2cf98a39772424d3
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Dec 6 18:04:38 2016 +0100

    appliance: mount also /dev/pts
    
    Tools could require the use of pseudo-terminals, so make sure we have
    /dev/pts available in the appliance.  The "command" API already
    bind-mounts it when running commands, so this is the only bit needed.

commit 601e05508b997e485a27de146bdbbd28407e8af2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 1 16:16:56 2016 +0000

    builder: Refactor command line parsing in make-template script.
    
    This refactors command line parsing into a parse_cmdline function.
    The function uses the Arg module to parse the command line instead of
    ad hoc parsing.
    
    This also enforces use of the ./run script to run the program, since
    otherwise you can end up with mixed versions of the OCaml bindings and
    the C library.
    
    This updates commit 65a05703858341476b9b2ceea2ef43e6f1447c43.

commit 8462b1ea32e125cbeb8690afd3064a3f35864ec9
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Dec 1 15:58:10 2016 +0100

    environment: fix error message for LIBGUESTFS_DEBUG failure
    
    Properly mention LIBGUESTFS_DEBUG as environment variable when it
    cannot be parsed as boolean.

commit c2f53304474427fdd61019d7492c782b12afa7cf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 1 12:48:49 2016 +0000

    v2v: Remove bogus backslash in test.

commit cd78fa4c881c56cbf09b33165741a164a2ef4242
Author: Cédric Bosdonnat <cbosdonnat@suse.com>
Date:   Wed Nov 30 17:49:20 2016 +0100

    packagelist: add initviocons package on SUSE
    
    initviocons package provides tools to resize the terminal. Having it
    in the appliance will allow SUSE users to have proper line wrapping
    in their terminal when using virt-rescue.

commit e4b73d67f21465f195ad246b8b23fd8b969cd421
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 29 19:08:17 2016 +0000

    builder: Update Fedora 25 and RHEL 7.3 ppc64 and ppc64le images.
    
    Rebuild these images with the new make-template.ml script.  This fixes
    the lack of virtio-scsi driver and broken initramfs.
    
    These images all use LVM because without that both Fedora and RHEL put
    the root filesystem on an extended partition (/dev/sda5) which
    virt-resize cannot handle.
    
    (Note the RHEL images are not public.)

commit 7a9f9b7cdc9a5f0bba0f2121097ca3dcf0c3886f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 28 11:18:47 2016 +0000

    builder: ppc64: Enable virtio-scsi in templates.
    
    Workaround for dracut bug RHBZ#1396217.

commit 65a05703858341476b9b2ceea2ef43e6f1447c43
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 25 12:18:01 2016 +0000

    builder: Rearrange how template-building scripts work.
    
    Create a new directory (builder/template).  Integrate all of the
    scripts into a single program, so that templates are generated more
    consistently.
    
    This also changes how the index file is generated.  The script now
    generates the index file fragment and saves it under version control,
    and then generates the final index file by concatenating these.
    (Previously the index was written by hand which was tedious and
    error-prone.)
    
    The new script also saves the generated kickstart under version
    control so it can be referenced later.

commit 06dc0e52eba9e5daada1ec577708e63b6f4a409f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 24 18:45:11 2016 +0000

    Revert "builder: ppc64, ppc64le: Force add virtio-scsi driver."
    
    It turns out that adding the virtio-scsi driver does not help
    to fix the dracut problem.
    
    This partially reverts commit f766c84c39aae5d4b03ad4d935700455a7c0ef9e,
    keeping the change to index.

commit f766c84c39aae5d4b03ad4d935700455a7c0ef9e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 24 15:27:56 2016 +0000

    builder: ppc64, ppc64le: Force add virtio-scsi driver.
    
    Works around dracut bug RHBZ#1396217.
    
    Also update new Fedora ppc64 & ppc64le images.

commit 0cd54ff45b7772d5d1c80b75d2f04917b9777ff1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 24 10:35:45 2016 +0000

    builder: Add Fedora 25 templates.

commit bad1059bc4869c2dea6a27cf640dfbdacbd4d2a4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 24 09:53:10 2016 +0000

    fish: Fix small typos in virt-copy-in and virt-copy-out man pages (RHBZ#1398070).
    
    Thanks: Xianghua Chen

commit 0ae56ad7116bc6f0c9e8f417f6d82a48328e4829
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 24 09:51:33 2016 +0000

    builder: fedora-armv7l: Increase RAM for installation.
    
    In Fedora 25 the guest runs out of RAM when loading the
    Anaconda initramfs.

commit f45d9d3cd2a6251fa0825cbe2deda31b224a0af5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 23 22:01:31 2016 +0000

    builder: fedora-ppc64le: Require POWER8 CPU.
    
    This is the same as commit 4919f4f7409066c4565832a83a4252abdcf0b934
    for Fedora.

commit 6c50cfd4643ca6e659151e811b5d8631b8052c0a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 23 21:57:02 2016 +0000

    builder: fedora-aarch64: Add --arch flag.
    
    This is the same thing as
    commit 4a5605e7be4d96b2461d64852961c7bdd9f94b8e, but for Fedora.

commit 4919f4f7409066c4565832a83a4252abdcf0b934
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 17 14:50:42 2016 +0000

    builder: ppc64le: Require POWER8 CPU.
    
    RHEL 7.3 requires POWER8 instructions.

commit 4a5605e7be4d96b2461d64852961c7bdd9f94b8e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 17 14:50:20 2016 +0000

    builder: aarch64: Add --arch flag.
    
    This allows us to cross-build the image from x86_64 which is
    more convenient than doing it on aarch64 host.

commit c08788ef1bb274fe86946397b497b89b2be60d5c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 9 11:42:54 2016 +0000

    filearch: Add s390 and s390x detection and tests.
    
    Unfortunately I was unable to build s390 binaries since multilib was
    dropped in Fedora 24 on s390x.  Going from the source of the 'file'
    command it seems as if it prints "32-bit" (the architecture is really
    31 bit).

commit 6d805f3b33001dc7d46fc50b6a144a6b42f9d436
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Nov 13 18:31:52 2016 +0000

    docs: Fix man pages references to incorrect section numbers.

commit fc73cdc0146db71963ec50a7f88f5af0a97de9e7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Nov 13 18:27:45 2016 +0000

    Fix HACKING file in top level directory.

commit cf0967542fc60fbab8a8818d2c6dc88e1894a1a4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 10 11:39:04 2016 +0000

    installcheck: p2v: Make virt-p2v binary executable after uncompressing it.
    
    Fixes commit 415238853010a7b88f796c65ea77532845724dd0
    and commit face52f62e5731cc33183d5995a13b04f7f6a4c2.

commit 5d36f5ae8200e24590eb581dec81141ffb80644b
Author: Matteo Cafasso <noxdafox@gmail.com>
Date:   Wed Nov 9 22:52:25 2016 +0200

    upload: improve file write callback
    
    As noted by Pino in another patch, the logic passes the first member of
    the struct which happens to be the right address to the callback
    function.
    
    This will break the callback if order of the members of the struct will
    change.
    
    As the callback is using the entire struct, better to pass the pointer
    to the struct itself.
    
    Signed-off-by: Matteo Cafasso <noxdafox@gmail.com>

commit 415238853010a7b88f796c65ea77532845724dd0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 9 17:53:48 2016 +0000

    installcheck: p2v: Fix tests of virt-p2v.
    
    Fixes commit face52f62e5731cc33183d5995a13b04f7f6a4c2.

commit 086be00aca450f94494b53234523d03e908b5d99
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Nov 2 09:41:20 2016 +0100

    v2v: add "colours-option" to machine readable sample output (RHBZ#1390876)

commit 49dd176974862ce4542b78cb05fe0576b8003655
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Nov 2 11:00:03 2016 +0100

    builder: distribute fedora-s390x.sh
    
    Followup of commit c25a8987108664a43beb00de1c3010a6355880dd.

commit 0acdc837363f81d7bac21b7221b139ec00b9d6e8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 1 13:58:40 2016 +0000

    v2v: glance: Set hw_video_model property to qxl|cirrus (RHBZ#1374651).
    
    Thanks: Vladik Romanovsky, Ming Xie.

commit 1c51773b0985f0a3c2e15f2f6a3435f8b8715f01
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Nov 1 18:15:25 2016 +0100

    v2v: update again URL with glance metadata
    
    Finally got the (hopefully stable) right URL for them.

commit c25a8987108664a43beb00de1c3010a6355880dd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 1 11:50:22 2016 +0000

    builder: Add script for starting Fedora/s390x.
    
    However it does not currently work because of a bug in libvirt:
    
    https://bugzilla.redhat.com/show_bug.cgi?id=1376547

commit c7ce5e47faa9d0dc893975023097624ab8ad49fd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 31 08:47:15 2016 +0000

    handle: Improve error messaging if XDG_RUNTIME_DIR path does not exist.
    
    If an environment variable such as XDG_RUNTIME_DIR or one of the
    tmpdirs or cachedir is set to a non-existent directory, improve the
    error message that the user will see so that (where possible) it
    includes the environment variable or API call.
    
    This is still not bullet-proof because it's hard to display the
    environment variable if it is LIBGUESTFS_TMPDIR or
    LIBGUESTFS_CACHEDIR, but the main problem is with XDG_RUNTIME_DIR
    (because of systemd bugs).
    
    Thanks: Hilko Bengen for identifying the bug.

commit a8b206234c9a90e48d5d58b31c88b19fd695c1b4
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Oct 31 13:08:40 2016 +0100

    docs: fix link to guestfs-golang(3)

commit eecb1d81777219113f7e5434829aca6f93a92b9a
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Thu Oct 27 18:46:01 2016 +0200

    run.in: Quote contents of @VAR@ substitutions

commit d411cd6127440170b1105c726e784be07f79ad79
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 25 22:06:32 2016 +0100

    Version 1.35.14.

commit e73763de1fc150f51469568052cd494f2f018917
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 25 22:22:59 2016 +0100

    docs: Ignore ruby/ext/guestfs/extconf.h
    
    Updates commit bd21993d77bd2d38557ba2c74476e619732a543a.

commit 67cc867da84077d2480cbbe7dd9b10ceaf862d24
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 25 21:59:19 2016 +0100

    docs: Ignore php/extension/config.h.
    
    Updates commit bd21993d77bd2d38557ba2c74476e619732a543a.

commit 7d85796466601ebc17a7fb30327e2416c7819f0c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 25 21:43:32 2016 +0100

    Version 1.35.13.

commit 4f3269ac23f15ad950204a7fda22d27f67c562ff
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 25 21:37:30 2016 +0100

    docs: Ignore java/com_redhat_et_libguestfs_GuestFS.h
    
    Updates commit bd21993d77bd2d38557ba2c74476e619732a543a.

commit d76d916501b0d2753f0c38aee5fb6debe93f7f3c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 25 21:19:18 2016 +0100

    Version 1.35.12.

commit 08759893846683af14fcda79f4098ce0a4a13c28
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 25 21:12:56 2016 +0100

    docs: Ignore more generated headers.
    
    Updates commit bd21993d77bd2d38557ba2c74476e619732a543a.

commit 959ed964b8e2da7035efd7ffaf667bc2b18a8324
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 25 20:49:21 2016 +0100

    Version 1.35.11.

commit 7855c8e4a8f7ac9e85c2420ebdedd9a5756af2de
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 25 20:42:40 2016 +0100

    docs: Ignore errnostring.h files too.
    
    Updates commit bd21993d77bd2d38557ba2c74476e619732a543a.

commit f68388eec5aab4d83de8fcdf2cfc649d518b79cf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 25 20:02:59 2016 +0100

    Version 1.35.10.

commit bd21993d77bd2d38557ba2c74476e619732a543a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 25 19:14:06 2016 +0100

    docs: Remove builder/index-parse.h from documented files.
    
    Breaks things when building from clean.

commit 0e1f8c4de70b98d6177984f02a78d1027cd1112f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 25 19:05:15 2016 +0100

    p2v: Add dbus dependency to dependencies.m4.
    
    Probably not necessary since dbus is part of most base distros, but
    added for completeness.
    
    Fixes commit 54979e88421e08987cc2361707863d51d35138d2.

commit 851f1771bc8475f405cd4b9a65d5413d49e3f4d6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 25 15:47:39 2016 +0100

    docs: Document some more internal library structs.

commit 4d535c7038ee71436f74ae30b397ddfb866d54f1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 25 12:49:15 2016 +0100

    docs: internal: Allow headers and structs to be documented.
    
    This makes a number of small changes to how the internal documentation
    is generated and what can be documented.
    
    Header files are now permitted to contain internal documentation.
    This works in the same wasy as .c files.
    
    Also documentation can be added for structs as well as functions.
    
    This commit also adds documentation to some header files and structs,
    and fixes a few places which contained broken header documentation.

commit 8823247bd50c17e00ffb250e4239c88164e37050
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 25 11:57:47 2016 +0100

    docs: building: Document additional deps needed to build from git.
    
    Also document the gettext (C library) dependency which was missing.

commit 54979e88421e08987cc2361707863d51d35138d2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 24 16:58:18 2016 +0100

    p2v: Inhibit power saving during the conversion.
    
    We do this by sending an Inhibit() message to logind and receiving a
    file descriptor back, which we hold open until the conversion
    completes (or fails).  This is described here:
    https://www.freedesktop.org/wiki/Software/systemd/inhibit/
    
    This adds an additional optional dependency on DBus since we use DBus
    to call the Inhibit() method.
    
    Reported-by: Chris Cowley.

commit 75fbe4511e05dfcd20c6fec6d6e50a17f69f821f
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Oct 24 18:14:59 2016 +0200

    builder: consolidate handling of temporary files/dirs
    
    Create a single temporary directory for all the files created during the
    virt-builder run (except big disk images, which already use the
    libguestfs cache directory).  A single directory means there is no need
    to manually schedule all the temporary files and directories for removal
    when the application quits.

commit 0a5954f4f7c5f2f4baafd09a6d485985862c0645
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Oct 24 18:12:04 2016 +0200

    mllib: curl: add optional tmpdir parameter
    
    Add a new optional parameter for the Curl ADT, so temporary files can be
    created in a specified directory (which is supposed to be temporary, and
    disposed only when the application quits).

commit 79e9c87d560d74049ddbae5943784e4b4ef10223
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 24 15:56:57 2016 +0100

    customize: Check SLOW flag is set before running password tests.
    
    Fixes commit 2f57eb181f5083c131c59da9c71dc354cc6070fe.
    
    Thanks: Pino Toscano for finding the bug and suggesting the fix.

commit ab8007ecda28ad14dee027a9a0e938803a94bba0
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Oct 21 16:53:12 2016 +0200

    inspect: map "sled" in /etc/os-release as "sles" distro
    
    Map SLED as "sles" when parsing /etc/os-release, just like it is done
    already when using /etc/SuSE-release.
    
    Thanks to Cédric Bosdonnat for testing.

commit 7822d4dccba29a8ac35217b293d2049db4312d08
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 21 12:30:07 2016 +0100

    FAQ: Document how to switch kernel and qemu.

commit 1d5cd15e3a4a61d7fba53b52d4606c2264b243bf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 20 18:27:02 2016 +0100

    Version 1.35.9.

commit 2f57eb181f5083c131c59da9c71dc354cc6070fe
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 20 13:14:36 2016 +0100

    customize: Test that the --root-password parameter works.
    
    Add a slow test to ensure that the --root-password option
    doesn't regress.

commit 05f201a6e69990a4695ed95368ee84eab303edd2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 19 09:54:43 2016 +0100

    builder: Add test that a serial console is set up for guest templates we supply.

commit a01c828f0c465d16fe75b7130e42606d881c13ae
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 19 14:50:01 2016 +0100

    builder: Add virt-builder --notes for enabling serial console.
    
    On debian-8 and ubuntu-16.04.

commit fc35cfe361fef0a618485f7c36c9fddcfd6e6477
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 19 11:38:14 2016 +0100

    builder: Allow test-virt-builder-planner to be skipped.

commit 8d19c1a08f28bcb9757387cf6545236064b2841d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 19 11:41:45 2016 +0100

    customize, v2v: Use script name instead of $0 in test-*-<guestname>.sh scripts.
    
    $0 is set to the name of the test script, eg. test-settings.sh, and in
    bash there is no way to change that.
    
    Create a new environment variable, $script, which is set to the name
    of the wrapper script (eg. test-settings-fedora-24.sh).
    
    This should give more accurate error messages.

commit d61e9df151cf4027237b93dd754b56dce8660690
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 3 11:27:53 2016 +0100

    Add a test for virt-tail.

commit 8b076d87a14a0fa05c255cc4e12487139b0b1462
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 1 13:32:22 2016 +0100

    New tool: virt-tail.
    
    This follows (tails) a log file within a guest, rather like
    the regular 'tail -f' command.  For example:
    
      virt-tail -d guest /var/log/messages

commit 19332919a224e8fd989d30a28673d4e6dea5f58d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 12 13:46:37 2016 +0100

    p2v: Fix virt-p2v-make-kickstart for new location of virt-p2v.xz.
    
    Fixes commit face52f62e5731cc33183d5995a13b04f7f6a4c2.

commit bb782a9dd5e89ef75db34e67ed7e611f5998ee29
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 11 19:05:22 2016 +0100

    Version 1.35.8.

commit d6c42a6c587028bfb29ccfcdf343fa00d86b6e52
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 11 18:02:16 2016 +0100

    valgrind: Don't use "nested" run scripts.
    
    When TESTS_ENVIRONMENT already uses 'run', the VG variable
    doesn't also need to use 'run'.
    
    The specific problem is that if the command contains newlines
    then double invocations of the 'run' script fails (in libtool).
    ie the following command failed causing errors in check-valgrind:
    
      $VG virt-builder phony-fedora \
          -v --no-cache --no-check-signature $no_network \
      ...
          --write '/etc/append4:line1
      ' \
      ...

commit 9bcdffc2bb05661a9813f5abeadd884e88fbf785
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 11 14:19:08 2016 +0100

    Version 1.35.7.

commit 4c8fc40d6624181939aaa3a6e4eda4f2505318cd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 11 14:17:06 2016 +0100

    p2v: Fix EXTRA_DIST.
    
    Fixes commit face52f62e5731cc33183d5995a13b04f7f6a4c2.

commit face52f62e5731cc33183d5995a13b04f7f6a4c2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 10 19:40:38 2016 +0100

    p2v: Compress virt-p2v binary and store it in $libdir/virt-p2v (RHBZ#1382275).
    
    Currently 'make install' installs the virt-p2v binary in
    /usr/libexec/virt-p2v on the host.  It is never supposed to be run
    from there, even by another program, so use of /usr/libexec is
    incorrect.  It is only supposed to be copied into USB keys / ISOs /
    etc created by virt-p2v-make-* scripts.
    
    The other problem with shipping a "naked" binary on the host is that
    packages built from that get all the dependencies of virt-p2v, for
    example Gtk.  This is unnecessary just for running the command line
    scripts mentioned above.
    
    This changes the Makefile and scripts so that the binary is stored
    compressed in $libdir/virt-p2v/virt-p2v.xz.  It is compressed to avoid
    exposing the dependencies.  It is stored under $libdir since the
    binary is still architecture-dependent.
    
    A further change is that when we copy the binary into the virt-p2v
    ISO, it is now installed in /usr/bin instead of /usr/libexec.  (And
    note that we always use /usr/bin, not $bindir, since this path should
    not need to be affected by the configuration of libguestfs).

commit 2bed3e480138e33caa59327fb3b92e389bbdf8cb
Author: Tomáš Golembiovský <tgolembi@redhat.com>
Date:   Thu Oct 6 16:54:33 2016 +0200

    appliance: add/remove some packages for Arch Linux
    
    Added:
    - cdrtools: added as alternative to cdrkit
    - multipath-tools: contains kpartx (in AUR)
    
    Removed:
    - ntfsprogs: the package is no longer available, it has been completely
      replaced by ntfs-3g (already in packagelist.in)
    - zfs-fuse: no longer in AUR
    
    Signed-off-by: Tomáš Golembiovský <tgolembi@redhat.com>

commit d9b2a16c71d0c87195e28c1325fd83b344741339
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 12 11:52:38 2016 +0100

    v2v: ova: Make OVA directory public readable to work around libvirt bug (RHBZ#1375157).
    
    Only do this if running as root and if the backend is set
    to libvirt.

commit 9ab8b1bebd6be38ee2b6f649c01ca9b302f1a06b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 6 16:17:30 2016 +0100

    launch: libvirt: Remove unused USB and memballoon devices.
    
    Thanks: Laine Stump.
    
    See also:
    https://www.redhat.com/archives/libvir-list/2016-October/msg00246.html

commit d0c86f287da6f4164131956f0eb649a7d5d5a1ed
Author: Tomáš Golembiovský <tgolembi@redhat.com>
Date:   Fri Oct 7 15:42:36 2016 +0200

    v2v: test Debian/Ubuntu conversion
    
    Enable testing of Debian and Ubuntu guest conversion.
    
    Signed-off-by: Tomáš Golembiovský <tgolembi@redhat.com>

commit 162fe71b8dc5a25d178b377d225fda252e6111ea
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Oct 7 14:55:51 2016 +0200

    v2v: linux: enable conversion of Debian guests
    
    A basic conversion of Debian-based guests works now; it needs more
    thorough testing for all the operations done with different sources.

commit 52a8202635b22557416b8aa19ca44557c8e5c168
Author: Tomáš Golembiovský <tgolembi@redhat.com>
Date:   Fri Oct 7 14:12:22 2016 +0200

    v2v: ova: support SHA256 hashes in manifest
    
    The OVF standard allows the use of SHA256 hashes in the manifest file.
    Adding support for this.
    
    One of the tests was updated to put SHA256 into manifest file.
    
    Signed-off-by: Tomáš Golembiovský <tgolembi@redhat.com>

commit 6b7ea3c681dd3dbcdf90a30540a0b36fa9840189
Author: Tomáš Golembiovský <tgolembi@redhat.com>
Date:   Fri Oct 7 14:12:21 2016 +0200

    v2v: ova: fix checking of the manifest file
    
    The regular expression for parsing the manifest line was wrong. There is
    a mandatory space between '=' and the hash.
    
    Another problem was that only the first line of the manifest file was
    actually processed.
    
    Also added some debugging info and warning to catch problems with
    parsing.
    
    Signed-off-by: Tomáš Golembiovský <tgolembi@redhat.com>

commit b9f6eb51320c1d358f3464989f7ab89c8ba92cde
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Oct 6 09:22:51 2016 +0200

    po: manually update POTFILES-ml
    
    Followup/fix of commit 5681db5ed85823ca171560782fdc5e9e9112148d and
    commit 7a09db5e485672748018a3b0cdba953225a0eb9b.

commit be8ad60b8ecac51037ba2815c0675e3cac5edaa1
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Oct 4 14:45:18 2016 +0200

    v2v: linux: try to fix removal of VMware tools
    
    Try to improve the way packages of VMware tools are removed from
    YUM-based guests:
    
    - when filtering the package itself from its providers, do a stricter
      check so either the provide is the unversioned package, or it is
      exactly its own name
    
    - if the package has no other providers, then going further will cause
      the invocation of 'yum install' with no packages, and thus the package
      itself will not be added to the list of packages to be removed; to
      overcome this issue, just mark the package as "to be removed" in that
      case
    
    Related to: RHBZ#1155150

commit 664842763cb4cec713e85e56a4bee96f644b4608
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Oct 4 09:40:54 2016 +0200

    v2v: linux kernels: remove unused parameter
    
    Remove an unused paramter of the internal check_config function.
    
    Followup of commit 7eb219d1938968c4d6bffda038aaace936f7efbf.

commit ca4a67940038c5b43a209787398d8e848acc48d7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Oct 2 20:07:01 2016 +0100

    appliance: Add ExFAT packages.
    
    Thanks: Miles Wolbe

commit 7eb219d1938968c4d6bffda038aaace936f7efbf
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Oct 3 11:24:36 2016 +0200

    v2v: linux: check also kernel config for modules
    
    When checking whether a kernel supports virtio or it is Xen-based, it is
    assumed that the feature has the kernel module for it; this will fail if
    the feature is built-in in the kernel, misrepresenting it.
    
    The solution is to check the kernel configuration whether the feature
    is built-in, in case there is no module available.
    
    This fixes the virtio detection on Ubuntu kernels, where virtio is
    built in and not as module.

commit 52b63e6b3304af1778db2e8208dcda57b485f3b2
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Oct 3 11:18:33 2016 +0200

    v2v: linux kernels: detect config file
    
    Add a simple detection for the config file of each kernel, so that can
    be used later to get more information on what a kernel provides.

commit 19b7495d4661f46bbb1cc7dee8905ae1efc8d44b
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Sep 27 17:48:23 2016 +0200

    v2v: bootloaders: improve detection of Grub2 default method
    
    Detect only once which method must be used to get and set the default
    Grub2 kernel in the guest: this avoids the same checks in list_kernels
    and set_default_kernel.
    
    Also, add a "no method" option as well: Debian/Ubuntu guests do not have
    neither grubby nor Perl's Bootloader::Tools, so there is no way to know
    what is the default kernel, nor to change it.  In this case, add a
    warning about this situation.

commit d3736eb0a3e5f095d3bb26d111dfb27e4d7cdc97
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Sep 27 17:24:57 2016 +0200

    v2v: linux kernels: set type of 'g'
    
    Make sure the type checker can detect the real type of 'g', even when
    adding more code using it in detect_kernels.

commit b548c41951ec85d6f1c8b054f5ce2d10183a2ae7
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Sep 30 11:24:30 2016 +0200

    v2v: -i ova: use Checksums
    
    Make use of the Checksums module to ease the verification of the SHA1
    checksums in manifests.

commit 484c64c29faa735f729fc34cbabe4eee5f9f4b11
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Sep 30 11:09:13 2016 +0200

    mllib: add SHA1 support in Checksums
    
    This way Checksums can be used in v2v.

commit a58dff49c501db3d7d357541494cc6683a13b77c
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Sep 30 11:04:27 2016 +0200

    mllib, builder: add and use Checksums.of_string
    
    Add a simple way to turn a combination of checksum type and value into a
    csum_t.  Use it in builder, even if still constrained.

commit 7a09db5e485672748018a3b0cdba953225a0eb9b
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Sep 30 10:30:24 2016 +0200

    mllib: move Checksums from builder
    
    Move the Checksums module from virt-builder mostly as it is; the only
    change is that on checksum mismatch an exception is raised rather than
    invoking "error" directly: this way users of verify_checksum &
    verify_checksums can do their own handling of the situation.

commit 5681db5ed85823ca171560782fdc5e9e9112148d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 30 14:47:48 2016 +0100

    customize: Add --append-line.
    
    This appends a single line to a file, with some cleverness
    involving guessing the right line endings to use.
    
    Also adds a test.

commit a31f657db02bb570a645eb33938c09196ff93553
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 28 11:06:09 2016 +0100

    daemon: Choose /usr/sbin first for the daemon (debian bug 838995).
    
    Debian is also doing a UsrMove/UsrMerge:
    https://wiki.debian.org/UsrMerge
    
    However it is not finalized that Debian will actually make this
    change.
    
    Since some Debian systems have /sbin as a symlink and other have /sbin
    as a real directory, and we should avoid choosing a symlinked
    directory for the daemon, the easiest fix is simply to probe /usr/sbin
    before /sbin since under all scenarios (and Fedora too) /usr/sbin is a
    real directory.
    
    https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=838995

commit 7f236d2201e1063570ac18b118e83b31c778f304
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Sep 26 16:04:10 2016 +0200

    p2v: add mnemonics to labels and buttons (RHBZ#1379289)
    
    Set mnemonics for all the labels with a text entry or combo box next to
    them, and for all the buttons, and check boxes.

commit e3f681e1b80dba5e3c3981cadad3ee6aea1a7def
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Sep 26 14:16:44 2016 +0200

    tools: build common fish sources in a static library
    
    Create a new libfishcommon convenience static library to build just once
    (instead of 12 times!) the majority of the guestfish sources used in the
    rest of the C tools (mostly for command line stuff, inspection, and
    mount).
    
    The notable exceptions not using libfishcommon are guestfish itself, and
    virt-rescue: both need to build at least one of the common sources using
    additional CPPFLAGS.

commit 23ca442f63b1be891378186a44bf8f49218b4e8f
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Sep 26 11:45:07 2016 +0200

    fish, inspector: get rid of COMPILING_VIRT_INSPECTOR
    
    All the define was doing in options.h was masking the declaration of
    inspect_mount_root, which was always built-in in inspect.c (because of
    the unconditional #define there) anyway.
    
    Since this is common code used by all the C tools, try to avoid extra
    knobs which add different code paths for no benefit.

commit 284c6e10785b7bd642f1f850a35ccaf0ac7c67c9
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Sep 26 11:13:17 2016 +0200

    build: remove extra libconfig linkage
    
    Some of the C tools were building also config.c as part of the shared
    sources from guestfish, and thus bringing a dependency on libconfig.
    Since none of them actually read the libguestfs configuration at all,
    then exclude fish/config.c from their build, and stop linking to
    libconfig.

commit f057086b60530032acd240b53354858476a86bfe
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Sep 23 17:43:07 2016 +0200

    dib: use remove_duplicates instead of own code
    
    Use a common function to remove duplicates in an unsorted list.
    
    Just refactoring, with no behaviour change.

commit d7551ec39b84e912a27b1829b8bd49cafb9e9b89
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Sep 23 17:40:09 2016 +0200

    mllib: move remove_duplicates from v2v
    
    Simple code motion.

commit b5d57baf3ddf784dd5f06f8eb239180c25a803b8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 23 10:33:20 2016 +0100

    Version 1.35.6.

commit 967280566dee130b76a376b95a0858c3ee5e1be9
Author: Tomáš Golembiovský <tgolembi@redhat.com>
Date:   Tue Sep 20 12:55:42 2016 +0200

    v2v: linux: correctly reconfigure the initrd on Debian
    
    Using update-initramfs is the native way of updating initrd on Debian
    based systems.
    
    To add some modules to the image we can list them in file
    /etc/initramfs-tools/modules.
    
    Signed-off-by: Tomáš Golembiovský <tgolembi@redhat.com>

commit 4c3968f262e8a45f65f8980d6af39144bd52f0ea
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Sep 22 17:35:20 2016 +0200

    libvirt: read disk paths from pools (RHBZ#1366049)
    
    A disk of type 'volume' is stored as
      <source pool='pool_name' volume='volume_name'/>
    and its real location is inside the 'volume_name', as 'pool_name': in
    this case, query libvirt for the actual path of the specified volume in
    the specified pool.
    
    Adjust the code so that:
    - for_each_disk gets the virConnectPtr, needed to do operations with
      libvirt
    - when extracting the disk filename depending on the type, the code
      snippet doing it can directly set 'filename', without setting an XPath
      result variable
    
    Only file-based volumes are supported for now; more types can be added
    (with proper testing) later on.

commit a4adf48915c0e3e7f4e8b7bbdbb5ac622da1ac58
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 21 13:56:55 2016 +0100

    v2v: Support <listen type='socket'> and <listen type='none'> (RHBZ#1378022).
    
    Since libvirt 2.0.0, these two new <listen/> types have been
    supported: https://libvirt.org/formatdomain.html#elementsGraphics
    
    This change just copies that configuration over from the source to the
    destination if the destination is also libvirt.
    
    Since we previously used 'LNone' to mean "no parseable <listen/>
    element" I also had to change previous uses of 'LNone' to 'LNoListen',
    so we can use 'LNone' to mean "<listen type='none'>".
    
    Thanks: Ming Xie.

commit 79fdc9ad47a1d797b00f2f24188799ec2bfc84eb
Author: Matteo Cafasso <noxdafox@gmail.com>
Date:   Mon Sep 19 19:42:52 2016 +0300

    find_inode: added API tests
    
    NTFS file system always has the MFT file at inode 0. This reliable
    information helps testing the API.
    
    Signed-off-by: Matteo Cafasso <noxdafox@gmail.com>

commit 9eb21ca54a947fa56255a178ce00640c1f6acb30
Author: Matteo Cafasso <noxdafox@gmail.com>
Date:   Mon Sep 19 19:42:51 2016 +0300

    New API: find_inode
    
    Library's counterpart of the daemon's internal_find_inode command.
    
    It writes the daemon's command output on a temporary file and parses it,
    deserialising the XDR formatted tsk_dirent structs.
    
    It returns to the caller the list of tsk_dirent structs generated by the
    internal_find_inode command.
    
    Signed-off-by: Matteo Cafasso <noxdafox@gmail.com>

commit eccce186a36339e9f102b4d0c9f60d2cee8c5fef
Author: Matteo Cafasso <noxdafox@gmail.com>
Date:   Mon Sep 19 19:42:50 2016 +0300

    New API: internal_find_inode
    
    The internal_find_inode command searches all entries referring to the
    given inode and returns a tsk_dirent structure for each of them.
    
    The command is able to retrieve information regarding deleted
    or unaccessible files where other commands such as stat or find
    would fail.
    
    The gathered list of tsk_dirent structs is serialised into XDR format
    and written to a file by the appliance.
    
    Signed-off-by: Matteo Cafasso <noxdafox@gmail.com>

commit 76a2bdd0f1d417ff5a02682230f0531fdce0769f
Author: Matteo Cafasso <noxdafox@gmail.com>
Date:   Mon Sep 19 19:42:49 2016 +0300

    lib: logic refactoring
    
    Code changes in preparation for new APIs.
    
    Signed-off-by: Matteo Cafasso <noxdafox@gmail.com>

commit 6b26a0cce4f1d6264bee88902b8931e39288c901
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Sep 19 18:45:09 2016 +0200

    OCaml tools: add crypto support (RHBZ#1362649)
    
    Make use of the additional command line arguments, and API needed to
    decrypt LUKS partitions.
    
    This affects only virt-customize, virt-get-kernel, virt-sparsify, and
    virt-sysprep, as they are the main OCaml tools interacting with
    user-provided images.

commit 5281e08802c47b3fd6a945d17d7d6ee3b428b896
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Sep 19 18:39:14 2016 +0200

    mllib: expose disk decrypt functionalities
    
    Expose via Common_utils the C functions & variables (part of guestfish)
    that handle decryption of LUKS partitions, and the additional command
    line arguments to tune the way they work.  This way it will be easy to
    provide (basic) crypto support also in OCaml-based tools.
    
    Related to: RHBZ#1362649

commit 0920b805fda02729d5204d2ab2cbfa192ba6570f
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Sep 19 14:48:19 2016 +0200

    fish: move disk decryption helpers in own file
    
    This way it is easier to use them outside the rest of the code in
    guestfish for inspection & mount.
    
    Just code motion, no behaviour changes.

commit 21a201051dd42c5433a68a036461dc3d53c16fe1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 19 12:53:35 2016 +0100

    p2v: Add C<...> around XTerm button string.
    
    Thanks: Pino Toscano.
    
    Fixes commit 2e9d0588818a1b24ca617057a6a51f198fe6505d.

commit 2e9d0588818a1b24ca617057a6a51f198fe6505d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 19 12:31:47 2016 +0100

    p2v: Update virt-p2v docs to describe XTerm button (RHBZ#1377081).
    
    Thanks: Tingting Zheng.
    
    Fixes commit bf434bdb3523b7629d50144f35a6bccc05bf94e6.

commit a1b5bbfced1a6c24c766e36242bb83e037a1f5c1
Author: Matteo Cafasso <noxdafox@gmail.com>
Date:   Sat Sep 17 00:04:24 2016 +0300

    daemon: refactor tsk code
    
    Refactor logic in preparation for new APIs.
    
    Signed-off-by: Matteo Cafasso <noxdafox@gmail.com>

commit 011f29f50679cad50e6dd79e622e0d63441e9552
Author: Matteo Cafasso <noxdafox@gmail.com>
Date:   Sat Sep 17 00:04:23 2016 +0300

    filesystem_walk: fixed root inode listing
    
    With the current implementation, the root inode of the given partition
    is ignored.
    
    The root inode is now reported. Its name will be a single dot '.'
    reproducing the TSK API.
    
    Signed-off-by: Matteo Cafasso <noxdafox@gmail.com>

commit 59999f055b68eb3bb7633a634927cdc5b3760561
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 15 16:03:58 2016 +0100

    filearch: Return 'i386' instead of 'i486' (as documented).
    
    And some incidental code refactoring.

commit 7907abcdc0404f792d2113358432376ed4995051
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 15 16:02:47 2016 +0100

    filearch: Add architectures missing from the documentation.
    
    Updates commit 68d9b04735f45e10e807353b00238ac7603f0e4d
    and commit 33d2b4a7341830efeddb1f258ac77f67a8004d30.

commit 536338ee9393eaa8c599da302e45815ed2770127
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 15 15:57:48 2016 +0100

    filearch: Sort architectures into alphabetical order in documentation.

commit 85327319ad93797783acef1c955be6a184aa6e0d
Author: Tomáš Golembiovský <tgolembi@redhat.com>
Date:   Tue Sep 13 15:51:31 2016 +0200

    v2v: linux: detect name of grub2-mkconfig
    
    On Debian family of OSes Grub2 tools are prefixed with 'grub-', not with
    'grub2-'. We have to detect the correct name of the tool to use it.
    
    Signed-off-by: Tomáš Golembiovský <tgolembi@redhat.com>

commit c3bbd129abe5fe3eb931e0191d4adf3ed0168712
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 14 11:55:25 2016 +0100

    Add riscv64 test binaries, and new tests of guestfs_file_architecture.

commit 68d9b04735f45e10e807353b00238ac7603f0e4d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 14 15:38:43 2016 +0100

    filearch: Add RISC-V architecture.

commit 775e9cbd2a53c095518152c7a2a19f4044f0c91b
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Sep 15 13:46:25 2016 +0200

    v2v: -o libvirt: always write pool names (RHBZ#1141631)
    
    When creating the XML for the new guest, always put the name of the pool
    containing the disks, even when -os specified a pool UUID: libvirt does
    not handle pool UUIDs for storage, but only names.

commit f4ca4de207f33847871a95e686997476b82ec1af
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Sep 14 09:59:12 2016 +0200

    v2v: -o glance: log glance client version in verbose mode
    
    When running in verbose mode for debugging, run `glance --version` to
    print the version of the glance client.  This helps when dealing with
    failures, or making its output actionable.

commit 04fe77c5199059a76f16875d6d2b495936ba7b82
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Sep 14 09:56:04 2016 +0200

    v2v: -i libvirtxml: tweak warning message
    
    Use a placeholder for the type of disk, so the message becomes exactly
    like another warning message used already in this function.

commit 1497a9f722f9a3c4c75282fb19578573e3cc89db
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Sep 13 15:30:52 2016 +0200

    v2v: -o glance: set all properties during creation (RHBZ#1374405)
    
    The glance client v1.0.0 defaults to the Image v2 API: this means that
    an image can be referenced only by its UUID, and not anymore by the name
    as well (which does not need to be unique).  This caused our glance
    invocation to set the properties for the newly created image to fail,
    since we are using the name as identifier.
    
    Instead of first creating the image and then setting all the properties
    for it, set all the properties when creating the image: other than being
    simpler, it also avoid parsing the output of the 'glance image-create'
    command for the UUID ('id') of the image.

commit 5714439d944d904296f3995da3ca272cb8a953ba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 12 14:55:43 2016 +0100

    perl: Guestfs.c file is not translatable, don't include it in po/POTFILES.
    
    Reported by Nikos Skalkotos
    https://aur.archlinux.org/packages/libguestfs/

commit 65e1c66bb98894f143e718c03da1ef893730188d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 9 17:46:23 2016 +0100

    Version 1.35.5.

commit 089f54b0d32c9f99adb1e21337bd8a30b4537c27
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 9 16:37:24 2016 +0100

    v2v: linux: Use /etc/modprobe.conf.local if it exists.
    
    On SUSE (only) there is /etc/modprobe.conf which is generated from a
    /usr/share file.  Local changes are meant to be added to
    /etc/modprobe.conf.local.

commit 0e1b1ccfb22e6215d34a11c9db3ae78641edfa25
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 9 16:29:52 2016 +0100

    v2v: linux: Avoid recursive functions.
    
    Just code motion.

commit 15661d8760c8867cc01f38f3c9a4db8e7e3a310e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 9 17:06:33 2016 +0100

    v2v: linux: Don't use duck typing in interface of Linux_kernels.
    
    On reflection we want the precise bootloaders type, not some other
    object that happens to implement a #list_kernels method.
    
    Fixes commit 2d7fa1db6a21ac5a3ea3e166af8c20b40c16427a.

commit 2d7fa1db6a21ac5a3ea3e166af8c20b40c16427a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 9 15:53:27 2016 +0100

    v2v: linux: Move kernel detection to a separate module.
    
    Create a new module [Linux_kernels] which does all kernel detection,
    and also provides a place to define the kernel_info data structure.
    
    This is essentially just code motion.

commit 171bc5374ede26cde5366d0cc985959fd3e7542c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 9 15:36:45 2016 +0100

    v2v: utils: Move external functions together.
    
    Just a small code movement.

commit b7a8247b5adbd285d310ba8a8a46d961b69ba8be
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 9 15:20:20 2016 +0100

    v2v: Move xpath* functions to new module Xpath_helpers.
    
    Just code motion.

commit 1ec78f34d868da680f742c7ee404fa08ddb79bae
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 9 15:13:24 2016 +0100

    v2v: Split up 'amend_source' function.
    
    Just code motion.

commit 98619f9c26076d034574b8822dfcc6799741ed96
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 9 14:56:11 2016 +0100

    v2v: -i ova: Derive the name from the OVA filename.
    
    If the guest has no <Name> element in the OVF, previously we chose
    "default" as the name.  This changes that so it uses a name derived
    from the basename of the OVA file instead.
    
    For example:
    
      virt-v2v -i ova /path/to/myguest.ova [...]
    
    would use "myguest" as the name (assuming no <Name> was present).
    
    Modifies the behaviour of
    commit 1ae4252c93c685cb8561b55c1231502b37212b5a.

commit 312379c8a61cd4a16aa7c80c1adda3081e601d43
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 9 14:45:05 2016 +0100

    v2v: -i disk: Move code that creates name from disk to separate module.
    
    Simple code motion.

commit 8335af37fa22710b396e47429447bc66c21d451b
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Sep 9 14:42:05 2016 +0200

    tests: do not assume '.' is in Perl's @INC
    
    Upstream Perl is going to remove '.' from @INC (the include path for
    modules) by default for the next major release (= 5.26) [1], as measure
    to fix security issues.  Debian already started backporting the fixes
    for this [2], thus behaving this way in current Sid installations.
    
    Since the affected Perl sources are only the local daemon testing
    scripts, a simple fix is to force the 'requires' for the local
    captive-daemon.pm module to start from the current directory: this way
    there is no need to manually augment @INC, and only our local module is
    loaded automatically.
    
    [1] https://rt.perl.org/Public/Bug/Display.html?id=127810
    [2] https://lists.debian.org/debian-devel-announce/2016/08/msg00013.html

commit 839fe4997b72d24d0bec84f7a6706b76f73ebde7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 9 08:59:46 2016 +0100

    daemon: Use reply_with_error instead of *_perror for setfiles command.
    
    Fixes commit 9d205f1c284a69390907120ca44f5c723fecc244.

commit 1ae4252c93c685cb8561b55c1231502b37212b5a
Author: Shahar Havivi <shaharh@redhat.com>
Date:   Thu Sep 8 09:53:37 2016 +0300

    virt-v2v: Support for ova exported from AWS (RHBZ#1371843).
    
    1. AWS the name tag is not mandatory - using default as a name
    2. AWD doesn't prefix 'ovf:' as prefix to disk path
    
    There is an open bug for oVirt:
    https://bugzilla.redhat.com/show_bug.cgi?id=1371843
    
    Signed-off-by: Shahar Havivi <shaharh@redhat.com>

commit 12c605f8fa15e35751c8f8cb5246200b1b5b8c11
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Sep 7 19:21:09 2016 +0200

    daemon: drop program_name definition
    
    It was previously needed by the 'error' module of gnulib; recent
    versions are able to get the name of the current program on their own.

commit eea210dbf7d781bc253f927977868dbc6776f20d
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Sep 7 19:20:21 2016 +0200

    Use the getprogname gnulib module
    
    Make use of the recently added 'getprogname' module in gnulib: replace
    our guestfs_int_program_name with the getprogname() provided by the
    module, since it does the same thing, and in a portable way.
    As consequence of the above, use gnulib in a couple of tests that use
    getprogname().
    
    Since guestfs_int_program_name is gone, drop the configure checks
    associated with it.

commit 1f65143a4295260f820028b2e6f373a77f497b3c
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Sep 7 17:21:27 2016 +0200

    Update gnulib to latest

commit 03032e2419a67a2b993f103fdcef884c2ce0d1d6
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Sep 7 19:06:55 2016 +0200

    tests: make test-noexec-stack.pl work in non-English locales
    
    Set C as language when running the script, as the output of readelf is
    parsed: this way the parsing works also when the system locale is not
    English.

commit be737c9574659c26721258a186c59f5e8dd29447
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 2 23:32:01 2016 +0100

    Version 1.35.4.

commit c4b7b5d6156627c0d0c2af1f7f45f0832cebd769
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 2 22:25:50 2016 +0100

    erlang: Split up large Erlang extension into smaller C files.
    
    Reduce build times in this directory from about 10s to about 2s.

commit 76eee79a65efcd4ff1daf5e0b9937779bf7f13eb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 2 22:25:50 2016 +0100

    java: Split up large Java extension into smaller C files.

commit 63db9ae81fa44ae7cfb53e7447214e87ec8b7811
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 2 20:51:04 2016 +0100

    python: Split up large Python extension into smaller C files.
    
    Reduces build time in this directory from 11s to 3s.

commit d95f1d7102d6613a49f35ea0fbc6d524448380bf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 2 18:48:16 2016 +0100

    build: Check generated files are included in the tarball.
    
    When running 'make maintainer-check-extra-dist', check also that all
    generated files are included in the tarball.  This is done so that end
    users will not need OCaml to compile from tarball releases.

commit 20aa0f6496cba9fdc7f34a397007f26fc3dd43d3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 2 16:42:05 2016 +0100

    ruby: Split up large Ruby extension into smaller C files.

commit 20f190617aafcddd08f99c0abec4fef90426ec9e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 2 16:00:37 2016 +0100

    daemon: Split up very large daemon/stubs.c file.

commit a749b5d93aa7f27793a5c939c985df82df406492
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 2 15:05:44 2016 +0100

    fish: Split up the very large fish/cmds.c file.
    
    Make parallel compiles faster in this directory (about 8s down to 3s).

commit 4730f4a91815d9de33119f6d27dedb7ab38464ba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 2 13:44:46 2016 +0100

    generator: Generalize the code used to split actions across files.
    
    Previously we used an awkward hack to split up the large src/actions.c
    into smaller files (which can benefit from being compiled in
    parallel).  This commit generalizes that code, so that we pass a
    subsetted actions list to certain generator functions.
    
    The output of the generator is identical after this commit and the
    previous commit, except for the UUID encoded into tests/c-api/tests.c
    since that is derived from the MD5 hash of generator/actions.ml.

commit f8978239e37a0af0f33bfafce7145df58937e59d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 2 13:40:25 2016 +0100

    generator: Move all actions into a single list and add filter functions.
    
    This mostly mechanical change moves all of the libguestfs API
    lists of functions into a struct in the Actions module.
    
    It also adds filter functions to be used elsewhere to get
    subsets of these functions.
    
    Original code         Replacement
    
    all_functions         actions
    
    daemon_functions      actions |> daemon_functions
    non_daemon_functions  actions |> non_daemon_functions
    external_functions    actions |> external_functions
    internal_functions    actions |> internal_functions
    documented_functions  actions |> documented_functions
    fish_functions        actions |> fish_functions
    
    *_functions_sorted    ... replacement as above ... |> sort

commit 71a95becbd09e740e90eb90ecbfd639fcac3a674
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 2 14:38:02 2016 +0100

    generator: Add |> (revapply) operator for compat with OCaml < 4.01.

commit 13e47b12187c2485101bb34030b10f2bbf9f9b9d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 1 12:14:27 2016 +0100

    customize: Add a slow test of --hostname and --timezone settings.
    
    Run these in real guests to ensure they really work.

commit cbb70f1deee861e71081349ee20bf8fe0601a615
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 1 13:27:48 2016 +0100

    customize: Update "unassigned-hostname" etc in Debian/Ubuntu /etc/hosts (RHBZ#1372269).
    
    Commit ab2df2e6598d421067d600f89a3d225162424d9b attempted to rewrite
    /etc/hosts if it contained the old hostname.
    
    However this wasn't done reliably for a couple of reasons:
    
    (1) Certain Debian/Ubuntu /etc/hostname contains
    "localhost.localdomain" but still has "unassigned-hostname" or
    "unassigned-hostname.unassigned-domain" in /etc/hosts.
    
    (2) Even if (1) doesn't apply, you still need to split out the
    hostname and domainname parts and deal with them separately.

commit e6d9c1b32866c14c7c744890e04286d91d609c19
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Aug 31 18:04:39 2016 +0200

    build: improve distro check
    
    Use /etc/os-release as first option, translating the distro name to the
    current identifier used.  The other options (the release files) are left
    as following checks, avoiding them if any matches.

commit 56e566af38c893e30f4dec1e079a9fc31eaf5104
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 2 12:20:03 2016 +0100

    v2v: Don't remove Processor and Intelppm nodes (RHBZ#1372668).
    
    Don't remove the Processor and Intelppm nodes since that just breaks
    the device driver.
    
    The only remaining node being removed by the original code was
    "rhelscsi" (the xenpv-win driver).  I changed this so that instead of
    deleting the whole node, it simply disables that driver.  If you look
    at RHBZ#737600, it's not even clear that deleting nodes was the right
    fix for anything.  I also renamed the function.
    
    Reviewed-by: Roman Kagan <rkagan@virtuozzo.com>
    Signed-off-by: Richard W.M. Jones <rjones@redhat.com>

commit 97cbddac12b060f946d175714d6f6917188ef6e6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 2 10:30:20 2016 +0100

    build: In silent rules, differentiate between .cmi and ocamlc.
    
    Although we happen to use 'ocamlc' to compile .mli files to .cmi,
    it is used in a different mode from bytecode compilation.

commit 09eb831e8d4f209c2177111c8473b1b094bfc8cb
Author: Roman Kagan <rkagan@virtuozzo.com>
Date:   Tue Aug 9 16:13:36 2016 +0300

    v2v:windows: prevent conflicts with PnP on firstboot
    
    When put on new virtual hardware Windows will start driver installation
    for newly discovered devices.
    
    The problem is that it happens asynchronously and concurrently with
    other activities, in particular, the firstboot scripts.  This may result
    in conflicts (because a firstboot script may want to install or
    uninstall a driver, etc.) and eventually in the system left in
    inconsistent state.
    
    In order to prevent it, add another firstboot script which calls a
    special utility, pnp_wait, whose sole purpose is to wait until all
    PnP-related activities are finished.  (It does so via a WinAPI call
    which isn't available from a script so it has to be a compiled .exe.
    The source code for it can be found in the corresponding directory in
    https://github.com/rwmjones/rhsrvany).  This firstboot script is put
    first, so that other firstboot scripts do not have to worry about
    interactions with PnP manager any more.
    
    One caveat is that on Windows XP and Windows 2003 the PnP manager always
    fires the "Found New Hardware" wizard, which doesn't allow PnP to make
    any progress until the user closes it.  As a result, this firstboot
    script would never finish.
    
    To work it around, follow the Microsoft KB
    (https://support.microsoft.com/en-us/kb/938596) and set up a registry
    key to make the the PnP manager not fire the wizard; the key is restored
    to its initial state upon PnP completion.  Unfortunately this only works
    on systems having the mentioned update installed; otherwise the user
    will have to interact with the UI.
    
    Signed-off-by: Roman Kagan <rkagan@virtuozzo.com>
    Reviewed-by: "Richard W.M. Jones" <rjones@redhat.com>

commit 5eb9ea489e5eb05b5a26f15bb31a1ef7a39793ec
Author: Roman Kagan <rkagan@virtuozzo.com>
Date:   Tue Aug 9 16:11:10 2016 +0300

    v2v:windows: factor out getting CurrentControlSet
    
    It will be used in new code in a followup patch.
    
    Signed-off-by: Roman Kagan <rkagan@virtuozzo.com>
    Reviewed-by: "Richard W.M. Jones" <rjones@redhat.com>

commit ed607984ad70f74ae7dac265e4eb70d0c1f7693d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 1 08:51:06 2016 +0100

    Version 1.35.3.

commit 2efd8d0b1daa92db4fc1d54eff2ba4f03199bc7e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 1 08:41:06 2016 +0100

    v2v: Use a random pool name in the test to avoid conflicts.
    
    If multiple tests (eg. from different branches) are running in
    parallel, they will attempt to use and delete the same temporary pool.
    Use a random pool name to avoid this.

commit 0797427807d1d1b88b44b6aabd63d218d628c679
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 31 23:09:10 2016 +0100

    valgrind: Add suppression for another --run-libc-freeres=no non-leak.

commit 6e547abe439a946722368b0047cd8c2a96c6a1e3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 31 19:35:12 2016 +0100

    lib: Fix incorrect example in comment.

commit 092ef3234d5b5cac9b6101063edf6816930afc01
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 31 11:24:44 2016 +0100

    v2v: xml: Fix misleading error message.
    
    Other functions, such as ``-i ova'', also call Xml.parse_memory.
    Therefore the error is not always from XML generated by libvirt, the
    XML might be generated from other sources too.
    
    Thanks: Ming Xie.

commit 8f6103d87de1766ffa854498a42371e7012c971e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 30 23:04:57 2016 +0100

    Version 1.35.2.

commit 57c327538ee18c1736bc4cd6d655c4d96c309900
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Aug 29 18:13:57 2016 +0200

    Include <sys/sysmacros.h> for major()/minor()
    
    GNU libc pulls them implicitly from <sys/types.h>, but it will not do
    that at some point in the future.  Hence, include <sys/sysmacros.h>
    explicitly.

commit f14dd26d361d9dd4a8f9278c0d5860db35eb63e3
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Aug 29 10:18:00 2016 +0200

    tests: add rhbz1370424.xml to EXTRA_DIST
    
    Fixes commit 98aa78f288e44868bcccf56b777d57d9fd4ec6a6.

commit 823ecfef3942ed2ec0b3e50f5fdbc70cb37ba3be
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 27 13:51:14 2016 +0100

    v2v: Use separate scripts for the slow tests of real guests.
    
    Following the same style used for the firstboot tests in the
    customize/ subdirectory, use a separate test script for each real
    guest that we test.  This has two advantages: (a) the tests run in
    parallel (and are thus faster) and (b) automake "knows" about each
    test and reports the results separately.

commit 58c1f7f7e657d835735e46c84ee79a7828029cbb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 26 13:40:20 2016 +0100

    customize: Add a slow test that firstboot works on a variety of real guests.

commit c2d21340db1465b0d96f4467060b0d7837c0c57b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 26 18:23:58 2016 +0100

    customize: Fix firstboot scripts on Debian 6 & 7 (RHBZ#1019388).

commit 2e2a0264ae060b920d72b202f11707527c814ab5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 27 09:09:16 2016 +0100

    lib: Remove some unnecessary translation of debugging messages.

commit 98aa78f288e44868bcccf56b777d57d9fd4ec6a6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 27 07:32:49 2016 +0100

    tests: Add a regression test for RHBZ#1370424.
    
    Regression test for previous commit which just tests that
    guestfs_add_domain doesn't assert-fail on guests with no port
    attribute.

commit 9e7b564fc1d9fa0e99a46e4739614820812ca42b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 27 08:51:29 2016 +0100

    lib: Don't assert fail if port is missing in XML (RHBZ#1370424).
    
    Thanks: Xiaodai Wang

commit 43e078abc0051664b54b81f6a4354d6e93c8c968
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 26 13:58:07 2016 +0100

    v2v: Use unitless methods for methods which don't change the internal state.
    
    Methods in OCaml which don't take any parameters don't require the
    dummy unit arg, ie writing:
    
      method foo = ...
    
    is fine.  The reason you might need the unit arg is if you need to
    create a closure from the method without calling it, for example if
    you need to use the method in a callback.
    
    In lablgtk2 the convention is to use unitless methods if either: the
    method shouldn't be used as a callback; or: (conceptually) the method
    doesn't change the object's internal state.  Let's do that here.

commit 7882fb7247cee3b209ed319a1bf4d2b027b7f017
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Aug 26 15:22:54 2016 +0200

    v2v: linux: adapt initrd name for Debian
    
    The name of the initrd image on Debian-based systems is different from
    what used on Fedora/RHEL/SUSE and derived; set a different regexp to
    avoid making the current regexp even more complex.

commit bb3da3b0748b7cfd5eb0ffa286644390b1f206d9
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Aug 8 18:19:27 2016 +0200

    v2v: linux: check the kernel package name for Debian
    
    On Debian-based systems, the kernel packages are named like
    "linux-image-$kver", so check for them.

commit 03b9f2b967c4c61a5acda6a3802317be109d213e
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Aug 8 18:06:22 2016 +0200

    v2v: add /boot/grub/grub.cfg as Grub2 config
    
    This is the location of the Grub2 configuration in Debian-based systems.

commit bfa2f140d22b04588587abe1296b7b04021d3e52
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Aug 8 18:04:40 2016 +0200

    v2v: linux: identify Debian-based distros as `Debian_family
    
    Identify these distributions, so it is possible to add specific code
    for them.
    
    This does not allow them as supported distributions, yet.

commit 0dc0e7834042c25ce1fc873cb7f326d9c33d3b4a
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Aug 8 18:01:56 2016 +0200

    v2v: add basic support for the "deb" package manager
    
    Implement the 'remove', 'file_list_of_package', and 'file_owner' methods
    of the Linux module for the "deb" package manager (dpkg basically, on
    Debian and derived distributions).
    
    Also allow it for the main conversion code.

commit dc9e6c39f7d61a5469a4f6b9ee72e869b6ff4a7a
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Aug 8 17:55:30 2016 +0200

    v2v: refactor Linux.remove
    
    Move the actual job in an helper function, so the common bits (like the
    check of the size of 'packages' and the reload of Augeas) can be done
    for all the package manager implementations.
    
    This should be code motion with no behaviour change.

commit 7141afd1904446e9bbe372009fca57a9c36785b9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 26 07:39:56 2016 -0400

    v2v: Use our definitions of iteri and mapi.
    
    OCaml 3.12 (in Debian Wheezy) did not have these functions.

commit bde35ca809ed21a2507e6564d80f168e1bec915e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 26 07:36:10 2016 -0400

    v2v: Small fix to POD documentation for old perl/POD.
    
    Old perl/POD from Debian Wheezy has a bug where <name>NAME</name>
    gives the error:
    
     Unknown E content in E</name>
    
    even though this is in a verbatim section.  Fudge the documentation to
    avoid this.

commit 619905ac5dfd46fa3d14095aa97fd25ef4a4cf6f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 26 07:34:02 2016 -0400

    builder: Rename cmdline 'ops' field.
    
    In OCaml 3.12, type inference was not as smart and could not use local
    information to disambiguate same-named fields in different structures.
    The easiest fix for this is just to rename the field so it doesn't
    have the same name as a field in the Customize_cmdline.ops struct.

commit 2c69865a7087053e392decec7ed7ac75123e0ae3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 26 07:09:43 2016 -0400

    build: Check for minimum version of libvirt in the configure script.
    
    In Debian Wheezy with libvirt 0.9.12.3, HAVE_LIBVIRT was defined, but
    HAVE_LIBVIRT_BACKEND was undefined, so src/libvirt-auth.c failed to
    compile.
    
    It's easy, and better, to check the minimum version in the configure
    script.

commit 79e2d44365230cb3b8706b2f6ea390cf58c784b6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 26 10:00:21 2016 +0100

    docs: Fix release notes, Citrix Xen -> SUSE Xen.
    
    I got the wrong end of the stick.  Cédric tested SUSE Xen,
    not Citrix (upstream) Xen.

commit ffa28d8722715a8f5475d480da173ec823cd7850
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 26 09:59:56 2016 +0100

    Revert "v2v: Citrix Xen has been tested, adapt the documentation"
    
    This reverts commit 68ba0609c70d09afe5555524873662aa67ebe149.

commit 6f2090099e68239aa1470b26183c65d483811166
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Aug 26 10:13:33 2016 +0200

    v2v: factor out bootloader handling
    
    Create an object hierarchy to represent different bootloaders for Linux
    guests, moving the separate handling of grub1 and grub2 in different
    classes: this isolates the code for each type of bootloader together,
    instead of scattering it all around.
    
    This is mostly code refactoring, with no actual behaviour change.

commit 5802c7750ee47b12a0497b45d8ca52e347328207
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 25 22:44:15 2016 +0100

    mllib: Add String.map function for OCaml < 4.00.0.
    
    String.map was added in OCaml 4.00.0.  However we use this function
    to implement String.lowercase_ascii etc.
    
    Therefore include a definition of the function for older versions of
    OCaml.  (Debian Wheezy has OCaml 3.12.1.)

commit 76c0a67d306db1903d7e1755dfded51361aabb4d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 25 15:13:41 2016 +0100

    build: Add common CLEANFILES and DISTCLEANFILES to common-rules.mk.
    
    By adding common CLEANFILES and DISTCLEANFILES variables to
    common-rules.mk, we can remove these from most other Makefiles, and
    also clean files more consistently.
    
    Note that bin_PROGRAMS are already cleaned by 'make clean', so I
    removed cases where these were unnecessarily added to CLEANFILES.

commit c39d5e89c3b3884309cfaea16721b9ec25c98868
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 25 14:12:42 2016 +0100

    java: Don't try to set -source 1.5 in options.
    
    There was some code in configure.ac dating back to 2009
    (commit b9014d6a0da8b2b3a76c4ab51fab2773fe7480b2) which attempted to
    add the javac option `-source 1.5'.  I don't think this code ever
    worked.
    
    However, if -source 1.5 is added, then you get this warning:
    
    warning: [options] bootstrap class path not set in conjunction with -source 1.5
    warning: [options] source value 1.5 is obsolete and will be removed in a future release
    warning: [options] To suppress warnings about obsolete options, use -Xlint:-options.
    
    and that's very hard to reliably fix because you have to know somehow
    a magic path.  For more details, see:
    
    https://blogs.oracle.com/darcy/entry/bootclasspath_older_source
    https://blogs.oracle.com/darcy/entry/how_to_cross_compile_for
    
    Anyway, remove the voodoo from configure.ac.
    
    As a side effect, this allows you to set the EXTRA_JAVAC_FLAGS
    environment variable before ./configure with any extra javac flags
    that you want.

commit 473a753382c36c39c6b93803b49e60d2a7953fae
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 25 14:57:26 2016 +0100

    bash completion: Add a simple test that the 'complete' command is not missing.

commit 035533d67a922e7690e340fb95fb1981f4c966a6
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Aug 19 16:21:12 2016 +0200

    v2v: linux: handle UEFI path for Grub1 (RHBZ#1152369)
    
    Add also /boot/efi/EFI/redhat/grub.conf as configuration of Grub 1;
    since the "grub" lens of Augeas does not handle this path, add a
    transformation so Augeas can parse it.

commit cf5915aee3b33a7889d34901be08608deab5c179
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Aug 19 16:19:34 2016 +0200

    New API: aug_transform
    
    Expose the aug_transform API through the library, so it's possible to
    add/remove Augeas transformations to handle files in custom places using
    existing lenses.

commit 50a3abb95f14d2b86854668989a86e217e68f238
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 25 11:36:51 2016 +0100

    bash completion: Add missing bash completion scripts (RHBZ#1367738).
    
    Add new scripts for:
    
    - guestunmount
    - virt-copy-in
    - virt-copy-out
    - virt-customize
    - virt-dib
    - virt-diff
    - virt-get-kernel
    - virt-p2v-make-disk
    - virt-p2v-make-kickstart
    - virt-p2v-make-kiwi
    - virt-tar-in
    - virt-tar-out
    
    Also combine the separate virt-resize script into the general script
    virt-alignment-scan.  There wasn't really any reason to have separate
    scripts.

commit 6a5b08065c82f8a70fed725ae1f4b3544dec0f2b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 25 11:36:22 2016 +0100

    bash completions: Add tip for how to run bash completions locally to README.

commit 4df8a099ab68df852bff707f2781b424c0377140
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 25 13:08:25 2016 +0100

    p2v: Implement --short-options and --long-options in virt-p2v-make-* scripts.

commit 2af8d07af6eaf071fcebf5ca58935d743d5077ce
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 25 12:43:21 2016 +0100

    fuse: Implement --long-options and --short-options in guestunmount.

commit c795d50af3a3864fe530bc12a3990d7e45cde143
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 25 12:41:58 2016 +0100

    fish: Move display_*_options functions to a separate file.
    
    By moving these two functions out of the common options parsing code,
    it means we don't need to depend on all the other machinery of options
    parsing, such as the global variables ("verbose"), libconfig, etc.

commit 738c3bf4fdce569858369b2d2ce3879bf4b75f50
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 25 11:08:15 2016 +0100

    inspection: Fix parsing of btrfs subvolumes in /etc/fstab.
    
    The code to parse btrfs subvol entries in /etc/fstab failed if the
    entry had more than one comma-separated option, for example:
    
    /dev/sda4 /home btrfs rw,user,subvol=foo 0 0
    
    This commit fixes that code to use Augeas correctly.
    
    Fixes commit 7ba0e10501f23358c38939930d613bf2393d744d.
    
    Reported by: Zhongfu Li
    https://bugs.launchpad.net/ubuntu/+source/libguestfs/+bug/1615337

commit ecbf09385033ba0acf14e914927ec81ad20a5308
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 24 14:52:25 2016 +0100

    v2v: Allow libvirt >= 2.1.0 to be used for Xen and vCenter conversions.
    
    Libvirt >= 2.1.0 now allows you to open files which have a "json:"
    QEMU pseudo-URL as backingfile, whereas previously it would fail hard
    in this case (RHBZ#1134878).
    
    When virt-v2v performs conversions from Xen (over SSH) or vCenter
    (over HTTPS) it uses these pseudo-URLs as backingfiles.  We had to
    tell people to use LIBGUESTFS_BACKEND=direct to avoid libvirt in this
    situation.
    
    This commit narrows the check so it will now only print the error if
    libvirt < 2.1.0 and LIBGUESTFS_BACKEND=direct is not set.  Also the
    error is modified to tell users they can either upgrade libvirt or set
    LIBGUESTFS_BACKEND=direct to work around the problem.
    
    Note there is not an easy way apart from checking the version number
    of libvirt to tell if the json pseudo-URL is supported.
    
    As a side-effect, this commit also prints the libvirt version number
    in debugging output when virt-v2v starts up, which is sometimes useful
    information for narrowing down bugs (it is in fact already printed by
    libguestfs, so this is duplicate information, but it's a bit easier to
    find when it's at the top of the debug).
    
    Thanks: Peter Krempa.

commit 6502a7b83107e53dcf21e686c77c05a26882113e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 22 14:26:27 2016 +0100

    v2v: Separate out machine="q35" and <smm> properties.
    
    This is a simple refactoring of
    commit 913dd8a087597f4d9fc658fb75813148107ff72e.

commit e7e446c926a5d4c8a5ead55db9f5644233ec8b22
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Aug 23 15:51:47 2016 +0200

    mllib: do not assume $PATH is set
    
    Make 'which' gracefully handle the case where $PATH is not set
    (it will raise Executable_not_found, but that is the expected thing to
    do).
    
    Related to RHBZ#1367839.

commit c711b517094375d4c321af4800e747b955643133
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 18 16:13:12 2016 +0100

    aarch64: uefi: Fix the build on aarch64.
    
    Fixes commit 0c396650b0018dc3fcd7ca809202ad46ae2c327d.

commit 913dd8a087597f4d9fc658fb75813148107ff72e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 17 14:27:24 2016 +0100

    v2v: Use OVMF secure boot file (RHBZ#1367615).
    
    From RHEL 7.3, Red Hat have decided to only compile the secure boot
    version of OVMF on x86-64, with flags -D SECURE_BOOT_ENABLE -D SMM_REQUIRE.
    
    The filename has also changed to reflect this - it is now
    /usr/share/OVMF/OVMF_CODE.secboot.fd.  The old file
    /usr/share/OVMF/OVMF_CODE.fd is no longer shipped.
    
    However switching to using this variant of OVMF for UEFI guests is not
    just a matter of changing the filename.  The new OVMF variant won't
    run unless we also change:
    
     - The qemu machine model, from the default ("pc" ==
       "pc-i440fx-rhel7.3.0" or later) to Q35 ("q35" == "pc-q35-rhel7.3.0"
       or later).
    
     - Add <smm> under <features>.
    
     - Set <loader ... secure="yes">.
    
    NB: On RHEL the changes requires qemu-kvm-rhev.  It is no longer
    possible to convert UEFI guests using the basic qemu-kvm.
    
    Thanks: Laszlo Ersek, Ming Xie.

commit 0c396650b0018dc3fcd7ca809202ad46ae2c327d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 18 12:35:16 2016 +0100

    Generate the lists of UEFI firmware paths.
    
    Previously we had a list of UEFI paths in src/uefi.c, which was
    accessed in virt-v2v using a private (guestfs_int_*) API and some C
    binding code.  This was clumsy and required the paths to be replicated
    in the virt-v2v unit tests.
    
    Instead just generate the list of paths from the generator, creating
    src/uefi.c and v2v/uefi.ml with the same content.
    
    Remove the C bindings and the virt-v2v unit tests associated with UEFI
    paths.

commit 17a971212682537de94e4bbb086e97cea0781c93
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Aug 18 14:00:43 2016 +0200

    v2v: linux: simplify RPM database cleaning
    
    Iterate on the array directly, instead of converting it to a list to do
    the same; also, avoid a temporary variable for it.

commit 5991ce1c2a83b02fdec0b9a5fc4c358b856cbcd3
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Aug 18 12:54:11 2016 +0200

    build: add silent rules for jar

commit c5a06ae1ad6b7bdeb6d79d2a6a4f12c913bf8707
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 17 17:10:29 2016 +0100

    v2v: test-harness: Print the full path of the virt-v2v binary under test.

commit 5c03a2ca8b0bcc5ea31a0c169dd022cad30d2ace
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 17 14:36:44 2016 +0100

    v2v: OVMF is now fully open source, fix the man page.

commit 326200c433ca0a04a335c6a1c979160539b32e21
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 16 15:06:17 2016 +0100

    Version 1.35.1.

commit dd22e376c4ec8fd7c78c78f94c60bb763ddcf08f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 12 10:34:54 2016 +0100

    v2v: Add -o discard option when fstrimming.
    
    This *may* be required by some filesystems in order for fstrim to
    work.  I'm not actually sure if this is true, but it's what
    virt-sparsify --in-place does, and that utility has been tested a lot
    more in regards to trimming.

commit 66816e11332b07a07efd6821e7ecf090691ce441
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 12 10:32:26 2016 +0100

    v2v: Make fstrim warning clearer (RHBZ#1366456).
    
    This reverts the change made for RHBZ#1168144.  The warning is now
    always displayed.
    
    It would be nice to make the warning actionable, but there is not a
    lot that end users can do since fstrim is such a complex topic
    interacting with all filesystem and storage layers.

commit d33e28c98807757d53ff87870a83604b4f8381d5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 12 10:43:44 2016 +0100

    p2v: Fix s/is/are/ in GUI message.
    
    I reordered the 'and' clause to make it sound a bit more natural.
    
    Thanks: Junqin Zhou.

commit 7eab864c21f84192a0e8b9149b9784c6192809b8
Author: Tomáš Golembiovský <tgolembi@redhat.com>
Date:   Thu Aug 11 00:25:53 2016 +0200

    v2v: linux: accept 'sr' devices in fstab
    
    Do not print warning for 'sr' devices when converting fstab. Not all
    systems create the /dev/cdrom symlink for SCSI CD-ROM devices. Moreover,
    on systems with multiple CD-ROMs, having entries for /dev/sr* devices
    may be inevitable.
    
    RWMJ: Use String.is_prefix instead of String.find, to more accurately
    match on the device name.
    
    Signed-off-by: Tomáš Golembiovský <tgolembi@redhat.com>
    Signed-off-by: Richard W.M. Jones <rjones@redhat.com>

commit 68ba0609c70d09afe5555524873662aa67ebe149
Author: Tomáš Golembiovský <tgolembi@redhat.com>
Date:   Thu Aug 11 00:26:38 2016 +0200

    v2v: Citrix Xen has been tested, adapt the documentation
    
    Conversion from Citrix Xen has now been tested and should work. Remove
    the comment about it from the documentation.
    
    Signed-off-by: Tomáš Golembiovský <tgolembi@redhat.com>

commit 42bccd78b8f1c8eb983b94866797e6d381403f9f
Author: Matteo Cafasso <noxdafox@gmail.com>
Date:   Mon Aug 8 23:28:56 2016 +0300

    sleuthkit code cleanup
    
    Small cosmetic changes.
    
    Signed-off-by: Matteo Cafasso <noxdafox@gmail.com>

commit 8a9c747ff655fa51eb6e5dbff3271d5bd05ebfbd
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Aug 8 17:25:40 2016 +0200

    sparsify, v2v: use Common_utils.absolute_path
    
    Use the common function for ensuring a path is absolute; it should not
    change the behaviour at all.

commit 98dea4978d96c373b01bf61b16eaca3146da5306
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Aug 8 17:21:03 2016 +0200

    v2v: disk: strip only common extension (RHBZ#1365005)
    
    In disk input mode, to determine the guest name strip the extension from
    the filename only if it's a very well extension for disk images.

commit 48e4012d03135aa2650b227cfee662a0da424e20
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 8 13:57:17 2016 +0100

    website: Get rid of some quite old branches.
    
    RHEL 7.3 will have 1.32.6, so we should encourage people to move to at
    least that version for recent features.
    
    Fixes commit f4e4a668aeec69c69d96168dc0cfbd0abe3716da.

commit 2c3b829bd86e3124d45adb1b1c95dfd891927c84
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 8 13:46:24 2016 +0100

    Version 1.35.0.

commit 4c84033d8c0a5b6c16e929727c8caa69a74e49cb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 8 12:49:58 2016 +0100

    Version 1.34.0.

commit f4e4a668aeec69c69d96168dc0cfbd0abe3716da
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 8 12:37:25 2016 +0100

    Update website for 1.34 release.

commit 4ad5652c99f3513f0dca13cddc0e420461348906
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 8 10:53:48 2016 +0100

    Update release notes.
    
    Also remove "draft" logo since these are close to being finalized
    for the 1.34 release.

commit 4ddc0add85fd2d08fcc45606c73ff6efb833ef4a
Author: Tomáš Golembiovský <tgolembi@redhat.com>
Date:   Sat Aug 6 20:04:53 2016 +0200

    v2v: fix regex replacement in grub2_update_console
    
    The replacement string was wrong. There are only two match groups in the
    regular expression, not three.
    
    Signed-off-by: Tomáš Golembiovský <tgolembi@redhat.com>

commit 56e5cf14e9f29cb7979786d52f5af1d478fbb35a
Author: Tomáš Golembiovský <tgolembi@redhat.com>
Date:   Fri Aug 5 11:32:27 2016 +0200

    v2v: do not hide the error, rather report it
    
    The Invalid_argument exception is there to catch unexpected situation
    when rpm returns no output. Such situation should be reported rather
    then hidden.
    
    Signed-off-by: Tomáš Golembiovský <tgolembi@redhat.com>

commit 34c7215a2f087c4de03c25d5c13e78874ffb9f9f
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Aug 5 18:04:25 2016 +0200

    ruby: ignore -Wshift-overflow warnings
    
    There seems to be a -Wshift-overflow bug in a Ruby 2.3 header, so
    add a GCC diagnostic override to avoid build failures with
    --enable-werror.

commit 71de3d49a395b4b91d282ad01bb2d382060c8392
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 5 12:20:49 2016 +0100

    sparsify: Add a regression test for RHBZ#1364347.
    
    Add a regression test for the previous commit.

commit 4d5335a56d709fdd4357ab9ae04ba0a758b12fe9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 5 12:20:00 2016 +0100

    sparsify: Warn instead of error if a filesystem cannot be fstrimmed (RHBZ#1364347).
    
    Thanks:  Xianghua Chen

commit 116a41d04877fda40bc986abc43e98f6c787a59e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 5 12:18:53 2016 +0100

    daemon: fstrim: Turn "discard operation is not supported" into ENOTSUP.
    
    Because we run the external fstrim command we don't have access to the
    kernel errno when it fails.  However in the case where it prints this
    specific error message, turn that into errno ENOTSUP.

commit 97b6b4a4ebc6f6e333ee448f61e1d6142cfffe27
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 5 12:09:59 2016 +0100

    sparsify: Exit with error code 3 if fstrim is not supported by the appliance.
    
    This replaces the indirect exception catching from
    commit 931aec5b8846ce63b0e2b6beba5861a019b5f694 with a direct feature
    test.
    
    Fixes commit 931aec5b8846ce63b0e2b6beba5861a019b5f694.

commit 7de25f7d710862fe4adfa85995825800d5b68e9d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 5 10:37:21 2016 +0100

    build: Line up "OCAMLOPT" with other silent rules.
    
    Tidies up commit 0b94c4d3bb0b72b0608b65ab97294747383e32d8.

commit a11a7ebbc3afcaf0b7d249b41f73fc2150fdacbe
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 4 23:33:58 2016 +0100

    build: Add silent rules for podwrapper.
    
    Also quietens the podwrapper script itself, as there is no reason to
    print 'wrote <output>' for each output file.

commit 320b05317800624ca3ce08e5a06ba4fc59c0dc40
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 4 22:34:42 2016 +0100

    Version 1.33.49.

commit 0b94c4d3bb0b72b0608b65ab97294747383e32d8
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Aug 4 16:18:33 2016 +0200

    build: add simple custom silent rules for automake
    
    Add makefile variables to enable silent rules for simple command
    invocations, such as ocamlc, ocamlopt, javac, and erlc.
    
    This reduces the log output when building with silent rules, still
    showing the full command lines otherwise.

commit 5630e0eb058bd3df67b1448f8407bee64daec178
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Aug 4 14:43:21 2016 +0200

    dib: add --drive-format
    
    Allow to specify the format of the helper drive, to avoid relying on the
    format autodetection.  This is the same approach used also in all the
    other tools.

commit 6e198634ac62a7c680879f757e321c57eb270677
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Aug 4 13:53:31 2016 +0200

    firstboot: make SysV symlinks as relative on Debian
    
    Turn the rc.d symlinks for the guestfs-firstboot service as relative,
    instead of absolute paths: the result is the same (the service works the
    same), and this way is more coherent with symlinks created by
    update-rc.d.

commit d394e01c2bba20bc33caa9019c08cd1c36ea22df
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Aug 4 13:44:03 2016 +0200

    firstboot: rename systemd and sysvinit
    
    Currently we install a systemd service named firstboot.service and a
    SysV service named virt-sysprep-firstboot.  On systems where systemd is
    the init system and runs with the SysV compatibility, the different
    names make systemd handle them as different services, and thus trying to
    run the firstboot script runner twice.
    
    Rename both the systemd service and the SysV one to guestfs-firstboot:
    the new name is less generic, and allows the systemd service to be
    shadowed by the SysV service (and thus running just once).
    
    Also cleanup the old services: the old SysV service can be removed
    directly, since its former name had "virt-sysprep" in it, and so there
    could not be much room for confusion and conflict.  Regarding the old
    systemd service: to avoid leaving it behind, a simple cleanup strategy
    is in place, checking the content of the old firstboot.service to really
    ensure we are removing one of our versions of this file.

commit 1d32637c6470fcd99784b6bdecb165da7e0e4d0f
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Aug 4 12:07:06 2016 +0200

    dib: export FS_TYPE for elements
    
    Export FS_TYPE for the elements, so they can know what is the filesystem
    created.
    
    This was implemented in diskimage-builder upstream as
    commit be521bdec6233530cc952be246a66f1957b0dd58.

commit 8ad870e563305c47e5b47e702b94739afcc3a938
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Aug 4 11:02:19 2016 +0200

    dib: add docker output format
    
    Implement the "docker" output format, to import an image into docker.
    
    This was implemented in diskimage-builder upstream as
    commit 1187f9d5df6d6eddba478ac75d3834391480755f and
    commit edc06a20e57bdf0a9a03949b54395008d73520dc.

commit d14a8f500c3ef041be3093fed235cec9035da79b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 4 10:00:06 2016 +0100

    Version 1.33.48.

commit 9d387b5eebecd01c1dec8eea6705caba69f4b4e4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 4 09:52:07 2016 +0100

    po: Update POTFILES.

commit 9fc0418db541065841af53632ae2406efc968416
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 4 09:25:55 2016 +0100

    mllib: _exit should return 'a
    
    Fixes commit 0dfa96c043cee4ce82c0a45c3ad09b0a61798b79.

commit bdfce1995b24744f19198c974774faedea58cefc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 3 16:43:45 2016 +0100

    Version 1.33.47.

commit d12be6625a74b4a088c75da5ae3a968678d814fd
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Aug 3 16:40:20 2016 +0200

    dib: rework run of extra-data.d hooks (RHBZ#1362354)
    
    Instead of running them before lanching the appliance with the disks and
    then uploading the result after root.d hooks run, mount the root in the
    local temporary directory using FUSE and then run the hooks on the
    guest.  Other than being closer to what diskimage-builder does, it also
    avoids issues with the extra-data.d scripts assuming to find things
    already, and we don't error out while trying to unpack files on the
    guest.
    
    Since virt-dib requires FUSE now, build it only if FUSE is supported.

commit 5077c020469827e104995cb2143d6d4eda981b9f
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Aug 3 15:01:59 2016 +0200

    mllib: move _exit from v2v as Exit module
    
    Move the OCaml binding to C _exit to an own module.
    
    Just code motion, adapting v2v in the process.

commit 2cb053d3fea709b1f72681f1c556c5623c8f6fa7
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Aug 2 18:45:34 2016 +0200

    mllib: check for executable existance in run_command (RHBZ#1362357)
    
    run_command uses Unix.create_process which forks a child process, and
    executes execve: the latter fails when the executable does not exist,
    triggering the exit which, in older OCaml versions [1], also runs the
    at_exit handlers.
    
    Since there is not much that can be done to avoid this on the OCaml
    side, to keep run_command working also in older OCaml version then
    manually search for the existance of the given executable, exiting with
    code 127 (as a shell does) in this case.
    
    [1] http://caml.inria.fr/mantis/view.php?id=7209

commit 398b940ea4a6069b1d0233c8a6f5d6ed823eddb9
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Aug 2 18:34:09 2016 +0200

    mllib: move which and its exception from dib
    
    Rename it from "tool" to "executable" in the process, but otherwise
    it is just code motion (with minimal adjustments in dib).

commit c8c181e8d9729ea09e56431b568dceba3873af7b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 2 14:44:50 2016 +0100

    launch: libvirt: Autodetect backing format for readonly drive overlays (RHBZ#1354335).
    
    If the user doesn't specify a format (ie. they want autodetection),
    and the drive is set to read-only, previously we created a qcow2
    overlay to protect the drive but didn't set the backing_fmt field.
    However libvirt disabled this so now libvirt doesn't work at all on
    qcow2 files that have no backing_fmt field set.
    
    We must therefore do autodetection in libguestfs and use that to set
    the backing_fmt field.
    
    We were already doing autodetection in the non-readonly case, so this
    commit refactors that code into a new function
    ("get_source_format_or_autodetect") and uses it on the readonly path
    too.

commit 3b9cc56a4566a6bd53dd74c0cbe0e6b70ea154c6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 2 12:10:06 2016 +0100

    v2v: linux: Ignore unused string return value of 'file_owner'.
    
    Because we didn't give the type of 'g' there wasn't sufficient
    information for the type checker to pick up this problem.  By
    specifying the real type of 'g' in a type annotation, that reveals the
    problem.
    
    Thanks: Pino Toscano, Nyoxi on IRC.

commit 75d3c5d3c917f7779b01fb27919ea010702950f3
Author: Tomáš Golembiovský <tgolembi@redhat.com>
Date:   Mon Aug 1 14:46:14 2016 +0200

    v2v: fixed file_owner function
    
    What was happening in file_owner function did not match the description
    in the comment. When a path is owned by multiple packages the returned
    string was in fact a concatenation of the names of all packages that own
    it. E.g. for `Linux.is_file_owned g inspect "/etc"` the returned value
    was "filesystemyum" (i.e. "filesystem" + "yum").
    
    Signed-off-by: Tomáš Golembiovský <tgolembi@redhat.com>

commit 1d3f075502e3e9871a7c68260e2bf01940fb2a35
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jul 31 17:20:08 2016 +0100

    v2v: xml: Rename internal xpath_new_context function.
    
    This change is not necessary, but is consistent with the naming scheme
    of the rest of the code in this file.

commit 9e0022cea8ab02dd5b1ca5fbd5b94e20a39e5b7f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jul 31 17:02:10 2016 +0100

    v2v: xml: Link to libxml2 website.
    
    No change, just finessing the documentation.

commit 19b0ae6c6502c4833c73e1b1bfa47b43a40f21e9
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Jul 29 17:21:25 2016 +0200

    lvm: do not pass --cache to vgscan
    
    This breaks lvm setups with no lvmetad, and it seems to not be needed
    even with lvmetad.
    
    Reverts parts of commit 2c4f154b91215e775c77920b291ac081e93542fd.

commit 12c05d5c364c222854217c18a26d056ac2214b11
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Jul 29 11:36:37 2016 +0200

    osinfo: fix reading of shared osinfo DB
    
    $OSINFO_SYSTEM_DIR (or its /usr/share/osinfo fallback) represents the
    top-level directory of the osinfo data, while we need to read the "os"
    subdirectory of it.
    
    Fixes commit c2ae46a9ebcf9e6bd0037a5cc895095a255c1a24.

commit fa2949b7a5f5118796b160f95fe55cb0188c58fa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 29 09:07:57 2016 +0100

    docs: In API overview, add note that you should free returned values.

commit 11a359c76c973f815aeb029e0ca6fa82b7ed7e62
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Jul 28 15:53:26 2016 +0200

    osinfo: do not assume every media is an installer
    
    The osinfo has an "installer" attribute in <media>, which defaults to
    true, and there are few entries which are marked as not.

commit bfedfb6e3c599dfac2d2debc979ceb31404c3552
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Jul 28 15:32:31 2016 +0200

    osinfo: simplify reading of attributes from <media>
    
    Directly query the attributes in the media node, instead of using an
    XPath expression to read it.
    
    Saves ~10ms when parsing the libosinfo DB on a Fedora 24 installation
    (other than making the code easier).

commit 38ef48cde552984be87563e0fde443944056b12b
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Jul 28 15:30:49 2016 +0200

    utils: add new CLEANUP_XMLFREE cleanup, to call xmlFree()
    
    Small cleanup helper to dispose xmlChar* buffers.

commit 2ed76e6f17d67b3218f10551cb394d46cbd0fb9a
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Jul 28 10:56:58 2016 +0200

    build: improve Gtk check
    
    Check the presence of Gtk properly depending on the value of --with-gtk:
    if a specific version is chosen, then let PKG_CHECK_MODULES fail if that
    version if not found, otherwise fallback from gtk3 to gtk2 to no gtk.
    
    Also move few common AC_SUBST in a single place.

commit 108509ec19cd6584e46971118e7c563dfd00fac8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 27 19:02:49 2016 +0100

    docs: hacking: Add a section describing the build system.

commit 7561d1bcaef005257486a2a99c98dcd15a8cf6e2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 27 19:02:27 2016 +0100

    docs: hacking: Improve documentation on how OCaml programs are built.

commit c008dd15a72124c5fb81b968aac7e3c09dc8747a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 27 15:09:18 2016 +0100

    Version 1.33.46.

commit 0a808d986afbf242b5a9a47a948ef4f5150affb6
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Jul 27 14:41:31 2016 +0200

    builder: fix EOF check with flex >= 2.6.1
    
    It looks like flex 2.6.1 changed [1] the return code for EOF in
    yyinput.  Therefore, use the right value depending on the version of
    flex which generates the lexer.
    
    [1] https://github.com/westes/flex/commit/f863c9490e6912ffcaeb12965fb3a567a10745ff

commit a6330e9d3af0f5286f1d53d909fd868387b67f69
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jul 26 17:34:43 2016 +0200

    appliance: run systemd-tmpfiles also for /run
    
    Setup the volatile /run in the appliance also with the tmpfiles
    configurations available.  In particular, setting up correctly the lvm
    bits allow lvmetad to run.

commit 7367945647e774aec4b93c3bf13181212d3c6430
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jul 26 17:23:34 2016 +0200

    daemon: lvm: improve filter for LVs with activationskip flag set
    
    Commit 2e16e3e99324112845446c82b6a6e8b3e652e10d added lv_active=active
    as additional condition when listing LVs, to ignore those with the
    activationskip flag set.  OTOH, this check is too broad, and matches
    also other kind of LVs.
    
    Change the condition to lv_skip_activation!=1, so matching precisely
    what was meant, and only that.
    
    Related to: RHBZ#1306666

commit 2c4f154b91215e775c77920b291ac081e93542fd
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jul 26 17:12:38 2016 +0200

    daemon: lvm-filter: start lvmetad better
    
    Currently lvmetad is started in init, and thus using the system
    (= appliance) configuration of lvm.  Later on, in the daemon, a local
    copy of the lvm configuration is setup, and set it for use using the
    LVM_SYSTEM_DIR environment variable: this means only the programmes
    executed by the daemon will use the local lvm configuration, and not
    lvmetad.
    
    Thus manually start lvmetad from the daemon, right after having setup
    the local lvm configuration, and still without failing if it cannot be
    executed.
    
    Additionally, since lvmetad now respects the right configuration, make
    sure to update its cache when rescanning the VGs by passing --cache to
    vgscan.

commit 5ce19cec4cd6d819a9405d1a470dc128fdc0e4d7
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jul 26 16:58:53 2016 +0200

    daemon: lvm-filter: set also global_filter
    
    When editing the lvm configuration to set the LVM filter, edit the
    'global_filter' key in addition to 'filter': the latter is not used when
    lvmetad is running, when only the former works.

commit ca1f8efd29b7de8507c713b1ba48dcf4121be972
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jul 26 14:46:49 2016 +0200

    daemon: lvm: change the separator character to '\r'
    
    Commit b91b39e06ab7eb9b9b06c8b4dfef2ef9f381ab19 changed the separator to
    ':', although this creates parsing issues when there are fields with
    colons (for example lv_tags=imgbased:pool).
    
    Change once more the separator, but this time using a non-printable
    character such as '\r': while it will produce uglier debug logs, this
    should greatly reduce the possibilities of conflicts with texts of
    metadata.

commit 1b8e6c78806fa25f14eaef24dab254d0494a3ecf
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jul 26 10:43:10 2016 +0200

    osinfo: map "sled" as "sles"
    
    The "sles" distribution string in libguestfs represents both SLES and
    SLED, so map the osinfo descriptions of "sled" distributions as "sles".

commit 9dc3aa37868c17e0cb1a921e13d5ddd09c1893f0
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Jul 25 18:15:54 2016 +0200

    osinfo: parse also single-digit version numbers
    
    Switch to guestfs_int_version_from_x_y_or_x to parse version numbers --
    although, restrict the parsing to what could look like a valid version
    number, to discard quickly version strings like "unknown".
    
    This makes sure that Debian, Fedora, Mageia, and SLED ISOs have the
    right version number.

commit c2ae46a9ebcf9e6bd0037a5cc895095a255c1a24
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Jul 25 17:35:06 2016 +0200

    osinfo: revamp db reading (RHBZ#1359652)
    
    More recent versions of libosinfo switched the internal directory with
    the XML files of OSes to a different layout (still with the same XML
    format), causing libguestfs to not read them anymore.  Furthermore, the
    internal directory is going to disappear soon, replaced by a public
    osinfo database [1].
    
    Revamp the way libguestfs reads the data: first try the upcoming osinfo
    layout, falling back to the current libosinfo layout (which is the same
    as osinfo), and then to the old flat layout.
    
    [1] https://gitlab.com/libosinfo/libosinfo/blob/master/docs/database-layout.txt

commit d5a8f82887fe0a0240fc361712f962dac9a8f284
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 26 10:19:22 2016 +0100

    Use 'const' for stack integers where possible.
    
    May improve optimization possibilities in a few cases.

commit 4e391aad67c056f34388f5ec16ac4eb22e3a2ee7
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jul 26 10:29:45 2016 +0200

    po: fix markups in Japanese translation
    
    Avoid extra spaces in L<>, they cause the POD to be invalid.

commit 91d17dfe7b75e6ba22758b44a8ff5fdbfb5917a2
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jul 26 10:29:00 2016 +0200

    po: fix placeholder in Ukrainian translation
    
    __SOMETHING__ strings are placeholders which must be left as-is.

commit 7b90ff3fc8fb4f5e728908f02bcccd021022f1b0
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Jul 25 19:45:03 2016 +0200

    Limit GCC 6 pragmas.
    
    -Wnull-dereference and -Wshift-overflow are new warnings in GCC 6, so do
    not try to disable them with pragmas on older GCC versions.
    
    Fixes commit a8e15ea924991f0182e89a3e0f80be78373d644c.

commit 5363502a38524f64af338eea8a5f074bce200c0e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 23 23:28:04 2016 +0100

    Update gnulib to latest.
    
    As a side effect this enables the -Wnull-dereference &
    -Wshift-overflow warnings.

commit a8e15ea924991f0182e89a3e0f80be78373d644c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jul 24 10:47:07 2016 +0100

    daemon: Ignore -Wnull-dereference & -Wshift-overflow warnings.
    
    One -Wnull-dereference warning is real: we deliberately cause a
    segfault in one of the tests.
    
    There is a -Wshift-overflow bug in a Gtk 2 header.
    
    The others are the result of shortcomings in GCC.
    
    In all cases we have to add GCC diagnostic overrides to ignore
    the warnings when compiling with ./configure --enable-werror.

commit d0e263248dd876fb41639df9071697df6a288e6b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 23 23:26:16 2016 +0100

    Update translations from Zanata.

commit 5fe8149e000fbe1979217b8756bccfe195a1cfad
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 23 23:08:42 2016 +0100

    df: Fix uninitialized variable when compiled without libvirt.

commit 1fac79e86994b2ec209aaaf065138b5e4cd38f51
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 22 17:34:50 2016 +0100

    Version 1.33.45.

commit 8e57268dd4b343751e58df7feaa6242836f5a3e1
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Jul 22 13:16:02 2016 +0200

    static const char *str -> static const char str[]
    
    Make all the static constant strings as char arrays, so they can be
    fully stored in read-only memory.

commit 8689bfa4375c9de920b0b8587465be24d425bb4f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 21 22:33:02 2016 +0100

    p2v: Remove dead code from virt-p2v kickstart.
    
    Including some code which looks like it is disabling SELinux, but is
    in fact commented out -- see previous commit.

commit fcce1f694e46933dd5d6a0ef1369cef3c5152fc5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 21 22:29:05 2016 +0100

    Revert "p2v: Disable SELinux in virt-p2v-make-disk."
    
    The commit claimed that SELinux was disabled in the
    virt-p2v-make-kickstart script, and so this was just making things
    consistent.  However this is not true.  SELinux *is* enabled in the
    kickstart version.  There is some code to disable it, but it is
    commented out (admittedly it's hard to tell because the code is buried
    in a multi-line sed expression).
    
    The commit message also claimed (this time correctly) that the
    '--selinux-relabel' step caused an extra reboot each time virt-p2v is
    run from the ISO.  However we have recently fixed this so it can
    usually do the relabelling during the build, not at boot time, so this
    is no longer a problem.
    
    This reverts commit 25ffcc7d436cd8f6bcf29d8bde5efd4b8823d6cc.

commit 74b13550db4c953b5a35824179ae44d46a0785fd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 12 21:47:23 2016 +0100

    Update release notes.

commit bb842b415e8de7785e3abad45a6306af468c1f64
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Jul 21 11:25:18 2016 +0200

    customize: use --noconfirm when installing Arch Linux packages
    
    Otherwise the installation will fail right away, since pacman by default
    asks for confirmation of the operation.

commit a5176e60142a9e018d15c1dae655a73b0ba52fbc
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Jul 21 11:20:51 2016 +0200

    customize: password: use SHA-512 on Void Linux and Arch Linux
    
    They are rolling distributions, so we can assume they have a glibc
    version greater than 2.7 (cca Oct 2007).

commit 5e65da07fa3b80413465def0a30a5961d98234a8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 19 12:31:23 2016 +0100

    podcheck: Check tool --help output.
    
    For OCaml tools this does essentially nothing useful because the
    --help output is automatically generated from the options, and so
    cannot be wrong.  However for C tools this is a useful check.
    
    It would be nice to generate C tools --help output, but there isn't
    enough information in the getopt data to do that.
    
    This commit also includes fixes to the --help output for a few tools.

commit a77c6aac81f30f1a8248b16ba22397759c067d28
Author: Matteo Cafasso <noxdafox@gmail.com>
Date:   Sun Jul 17 20:40:20 2016 +0300

    Added download_blocks API test
    
    The test shows how the function can be used to retrieve deleted data
    from a disk partition.
    
    Signed-off-by: Matteo Cafasso <noxdafox@gmail.com>

commit 007ef02e7d1822e83b64b1cfa1f2d3937e23cfb8
Author: Matteo Cafasso <noxdafox@gmail.com>
Date:   Sun Jul 17 20:40:19 2016 +0300

    New API: download_blocks
    
    This function allows to download file system data units (blocks) from
    the given partition.
    
    The API can be used to detect data hidden within filesystem bad blocks
    or slack space.
    
    Moreover for filesystems such as Ext3 and Ext4, this function is the
    only way to retrieve deleted files. An example is given in the function
    tests.
    
    Signed-off-by: Matteo Cafasso <noxdafox@gmail.com>

commit 5996080f7c77e7469b020ac14806ef0138cb8d67
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Jul 20 11:22:20 2016 +0200

    v2v: make virsh command quiet if v2v is quiet (RHBZ#1358142)
    
    Pass -q to virsh if virt-v2v was run with -q, to reduce its output in
    quiet mode.
    
    Unfortunately this does not currently work in virsh as it should, see
    RHBZ#1358179, so only after that bug is fixed this change can actually
    take effect.

commit fb1e9267fed73c6fa480973405a76771d9224aac
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 19 21:41:07 2016 +0100

    mllib, customize: Don't add -g option to ocamlmklib command line.
    
    ocamlmklib -g does not work in OCaml 4.01.0.  It does work (and is
    desirable) in OCaml 4.02.2.  However since we would like to support
    back to OCaml 3.11, we cannot use it.

commit 08a7c5c47be6f4fd7ff1a133b4acdd606cb2d536
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jul 19 18:42:23 2016 +0200

    daemon: mkfs: allow setting labels for f2fs filesystems
    
    Pass -L $LABEL to set the label of a f2fs filesystem when creating it.

commit 52d4e566cc9df3519c459931b02cd279d0e6f75d
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jul 19 18:41:32 2016 +0200

    appliance: add f2fs-tools to the appliance
    
    Helper tools for f2fs filesystems.

commit 8d518c37cd16a1ba7bc703412c15aae2ee7bd23d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 19 19:00:27 2016 +0100

    customize: Fix the test.
    
    In libguestfs 1.33.43 we managed to release a completely
    non-functional virt-customize binary (it ran without error but did
    nothing at all, whatever command line arguments you gave it).
    
    Improve the test so this cannot happen again.

commit 326f37d547641dd8203c759ffb026f07ca808266
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jul 19 15:19:04 2016 +0200

    tests: check documented tool options also for inspector and p2v
    
    This includes the additional tests, and the few needed fixes.
    
    Followup of commit 08e27451a6658c58a7fb23b5c5c773bee34dbf72.

commit 093f1ee546ad40002399e960ea2c8cc6f05e829d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 19 14:05:24 2016 +0100

    Version 1.33.44.

commit 08e27451a6658c58a7fb23b5c5c773bee34dbf72
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 16 20:52:49 2016 +0100

    tests: Add script to check documented tool options match actual options.
    
    podcheck.pl is run as part of the tests to perform various checks on
    the documentation and the tool.
    
    Currently we check only that the documented options matches the
    options that the tool implements and vice versa.  This commit would
    also allow us (in future) to check --help, --long-options,
    --short-options, --version output.
    
    This commit includes scripts to run the tests and various fixes to the
    manual pages to ensure that the tests pass.

commit 1fa3bf14e5dcf548fd3922b23d4e0cd9244d561a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 19 12:44:35 2016 +0100

    builder: Fix rhel-ppc64le guestroot to match reality.

commit 8886f2951de5c90b4f308cdd4ae460271e6b04d7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 18 17:26:41 2016 +0100

    fish, format, fuse: Remove bogus short options.
    
    For guestfish, guestmount, remove '?' from short options.  Currently
    those tools don't process -?, so I believe these are erroneous:
    
      $ guestfish -\?
      Try `guestfish --help' for more information.
    
    For virt-format, the -c, -d and -q options are removed.  These options
    just give errors because they appear in the short options list but not
    in the case statement.

commit d03e8f461ece3b32103fc546c9dc0cf17ff0b088
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 19 10:51:52 2016 +0100

    builder: Fix URL for RHEL 7.2 ppc64le images.

commit faf41e7fbbc673cdfebb7970073aedc2fe102c59
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 18 17:57:33 2016 +0100

    mllib: tests: Add tests to EXTRA_DIST.
    
    Fixes commit 41a1b8a5cacd86950c7791b74cadb934cce66e9b.

commit 34cdb1145e6bd9e9bc4da131b4c2bd02602b6e41
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Jul 18 11:42:22 2016 +0200

    builder: improve the handling of list formats
    
    Store them directly in List_entries, an adding helper function to
    convert from string.
    
    Also use Getopt.Symbol for them, so there is no need to manually reject
    invalid formats.

commit 99797a3d2f983f141e86dde2cf4f96032cd3e690
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Jul 18 11:39:34 2016 +0200

    mllib: Getopt: add Getopt.Symbol
    
    Introduce a new type of option to allow a value out of a fixed choice,
    much like Arg.Symbol.

commit 41a1b8a5cacd86950c7791b74cadb934cce66e9b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 15 13:09:51 2016 +0100

    mllib: tests: Add tests of the new Getopt module.

commit ba2cf9a2eb5376151f66181c4366983097520f4a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 15 13:10:19 2016 +0100

    mllib: Use L"..." and S '...' for long and short options.
    
    There is also an M"..." variant which acts the same way as
    L but handles the annoying virt-v2v two letter options.

commit 4ac1744db45de8303fbc3e12527caeeb56aee1bf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 18 11:44:23 2016 +0100

    mllib: getopt: Further fix int parsing.
    
    Don't allow suffixes on integers, and fix the bounds to match the
    definitions of Min_long and Max_long in <caml/mlvalues.h>.
    
    Fixes commit 66b54bfefe42f2996d1b42c3646511bbd4349317.

commit bef2d2f30ec5663d3119c547fca8c0eddf114c5c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 18 16:49:42 2016 +0100

    rescue: Implement virt-rescue -w option.
    
    Documented, but never implemented.

commit 7352071dbf9d581f9a72ffda314b21917751b384
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 18 15:58:09 2016 +0100

    diff: Implement virt-diff --long-options.
    
    The code was only partially implemented so the option did
    not function.

commit b7e7fe396df32e20a30a509c2fbd7d460d319604
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Jul 18 11:25:17 2016 +0200

    mllib: Getopt: point to man page as additional help
    
    On error, point also to the man page of the current tool in addition to
    '$TOOL --help'.

commit c2fda2c1f29632ff411e30f7029b6b2705bb3b70
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 16 18:28:17 2016 +0100

    build: Factor out definition of BEST and OCAMLLINKFLAGS.
    
    No change, just refactoring.

commit 2c6bfccb062222097ee42fb551507c18245c9874
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 15 16:50:07 2016 +0100

    build: Fix dependencies on mllib and customize.
    
    Binaries should be rebuilt if mllib.cma/mllib.cmxa or
    customize.cma/customize.cmxa change.
    
    Fixes commit 1e2877c6f4d1d254026d38b1cac4895d8dba7d5d.

commit fde0b735974cd288e3eb278f2ae337bcdaf2b703
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 18 13:53:24 2016 +0100

    customize: Build virt-customize properly.
    
    Fixes commit 6a0fe553b9f5a0474f826a1978bf824f2b483887.

commit 66b54bfefe42f2996d1b42c3646511bbd4349317
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Jul 18 10:01:45 2016 +0200

    mllib: Getopt: fix integer parsing
    
    Since we are using gnulib already, make use of xstrtol to parse the
    integer arguments to avoid extra suffixes, etc.
    
    Fixes commit 0f7bf8f714898c606e5d5015fff5b7803dcd1aee.

commit 4920ff57c90ae63d6e28d641230810b9475658c5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 14 15:40:23 2016 +0100

    Version 1.33.43.

commit 3bf9420f94d41ae8eb9228ada4a0ef66f5bd8a35
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 14 15:39:19 2016 +0100

    builder: Add new centos-aarch64.sh script to EXTRA_DIST.
    
    Fixes commit c168638ae7212cb27eb9434ce55957a58ae5336c.

commit 6a0fe553b9f5a0474f826a1978bf824f2b483887
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 14 12:19:14 2016 +0100

    customize: Build a customize.cma/customize.cmxa library.
    
    Instead of linking with individual objects, which is very tedious,
    build a proper library and link virt-builder, virt-customize and
    virt-sysprep to it.
    
    This makes the binaries a tiny bit smaller because .cmxa/.a files
    allow unused code to be removed by the linker, whereas explicitly
    linking .cmx/.o files does not.

commit 1e2877c6f4d1d254026d38b1cac4895d8dba7d5d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 14 12:19:14 2016 +0100

    mllib: Build a mllib.cma/mllib.cmxa library.
    
    Instead of linking with individual objects, which is very tedious,
    build a proper library and link the other tools with it.
    
    This doesn't make the resulting binaries any larger.

commit fc114904848559e02d8f4e4a8bfb57277c349f0f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 13 22:50:10 2016 +0100

    v2v: linux: Use new SELinux_relabel module to relabel Linux guests.

commit 35bac3a6501354e4a3805877d950e741429f169b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 13 21:21:07 2016 +0100

    lib: Deprecate old SELinux APIs, rewrite SELinux documentation (RHBZ#1152825).
    
    Also turns the --selinux option of guestfish, guestmount and
    virt-rescue into a no-op -- it didn't work before so this is
    effectively no change.

commit b6e92b1100b4ca462a35549bd36322f0510739bc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 13 20:16:23 2016 +0100

    builder: Use virt-sysprep --selinux-relabel when preparing templates.
    
    Don't need to be clever now.

commit f3c69fe60bc29ebfcef0ea9d86d407e1a88686b0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 13 18:34:21 2016 +0100

    customize: Add module for doing SELinux relabel of filesystem (RHBZ#554829, RHBZ#983969, RHBZ#1089100).
    
    This implements the --selinux-relabel option for virt-customize,
    virt-builder and virt-sysprep.  There is no need to autorelabel
    functionality now.
    
    Thanks: Stephen Smalley

commit 6ec75f8cfe455493b46f1a3a5a00282359e588a5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 14 09:03:19 2016 +0100

    tests: Add a test of the setfiles API.

commit 9d205f1c284a69390907120ca44f5c723fecc244
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 13 18:33:55 2016 +0100

    New API: selinux_relabel - SELinux relabel parts of the filesystem.

commit fd60be95091a1923e108f72caf251f5549eeccd0
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Jul 14 14:09:18 2016 +0200

    appliance: touch /etc/fstab when enabling the network (RHBZ#1224795)
    
    Sadly, the dhclient-script shipped as part of isc-dhcp-client in Ubuntu
    unconditionally reads from /etc/fstab without checking for its
    existence.  Since no package holds /etc/fstab, this file will not exist
    in the appliance, cause dhclient to fail (actually keep looping calling
    the failing dhclient-script) when the network is requested.
    
    As a workaround, touch /etc/fstab just before enabling the network: if
    that file exists nothing changes, while an empty file will be available
    in the other case, making at least dhclient-script in Ubuntu working.

commit eb22e2d36e3a28805f36e43b2be549ccbd3457b1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 13 19:16:07 2016 +0100

    v2v: Move augeas_debug_errors (renamed debug_augeas_errors) to common code.
    
    Since the function uses the StringMap module, I also had to
    move this to mllib.
    
    The function is renamed and the 'if verbose ()' part is moved into the
    function, but apart from that, it's all just code motion.

commit 412dedd0294cbfa8d968d2756352ec255f481bfe
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Jul 14 11:02:36 2016 +0200

    po: fix markups in Ukrainian translation
    
    - remove extra \n at end of msgstr (not present in its msgstr)
    - fix printf format specifier

commit 7a404b111022c8810a5aa94c90beaa37c9a6b1d3
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Jul 13 15:13:18 2016 +0200

    mllib: Getopt: support hidden options
    
    Add a dummy description value to mark an option as "hidden", so it will
    not be shown in the help text.
    
    Mark few options as hidden:
    - common: --short-options, --long-options, --debug-gc
    - virt-sysprep: --dump-pod, --dump-pod-options
    
    Since --debug-gc is now really considered internal, it is no more
    documented.

commit 0f7bf8f714898c606e5d5015fff5b7803dcd1aee
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Jul 13 14:56:11 2016 +0200

    OCaml tools: add and use a Getopt module
    
    Add a new Getopt module to mllib, to parse command line arguments with
    handlers close to the ones used with Arg, but using getopt(3) (actually
    getopt_long_only) to do the real parsing.  This allow us to provide
    options for OCaml tools with a syntax similar to the C tools, and use
    the additional features getopt offers and Arg does not.
    Getopt now handles every part of the command line handling, including
    the output of short & long options.
    
    Do a single-step conversion of Common_utils and all the OCaml tools to
    the syntax of Getopt.
    
    Move a couple of utility functions from Common_utils to Getopt, since
    they fit better there (and Common_utils cannot be used in Getopt, as
    the former already uses the latter).
    
    As side-change due to the conversion, extra arguments for sysprep
    operation can have more keys for the same argument.

commit cbf4bbf266c8bb444c2283565ddff24e0f88e021
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Jul 13 17:49:24 2016 +0200

    i18n: fix markups in Japanese translation
    
    Avoid extra spaces in L<>, they cause the POD to be invalid.

commit c168638ae7212cb27eb9434ce55957a58ae5336c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 13 11:49:11 2016 +0100

    builder: Add CentOS aarch64 image.

commit 6dc3a59e73b2ef23161393fbaf20cde4b0346d6e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 12 21:43:31 2016 +0100

    Upload and download files to Zanata.

commit a468e8b92f495b8f97105edf40ff7675b02462ab
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 12 14:22:54 2016 +0100

    p2v: Set LD_LIBRARY_PATH for "remote" virt-v2v process.
    
    In previous commit c5f12e47e4e0dc7846897cad3184ac0892f51ef8 we changed
    the PATH environment variable to run the locally built virt-v2v, not
    the system-installed virt-v2v.
    
    However this meant that we were running the locally built virt-v2v
    against the system-installed libguestfs.so.0.  We also need to set
    LD_LIBRARY_PATH.
    
    Fixes commit c5f12e47e4e0dc7846897cad3184ac0892f51ef8.

commit e93d4ea320485e68b2e629ca3498d5475a373781
Author: Tomáš Golembiovský <tgolembi@redhat.com>
Date:   Tue Jul 12 05:53:49 2016 +0200

    v2v: Add support for Win2016 virtio drivers
    
    Support virtio drivers for Windows Server 2016 once they are available.
    
    Signed-off-by: Tomáš Golembiovský <tgolembi@redhat.com>

commit 2c7f8e9c5f02c3d65fe6fc346d3043ce93d65b99
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 11 19:11:01 2016 +0100

    utils: Clarify why some uses of gnulib are OK and others not OK.

commit 56eb5f36f425ddb3c5c5cd5598ab29709cca6ef4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 11 19:08:41 2016 +0100

    Revert "utils: Allow use of gnulib in this file."
    
    This reverts commit 975eafe4baf19442ab972d92d5b2a4f0c20f0295.

commit d272cee8389c33baa2cbb4f9ea62b427fa027610
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 11 18:28:23 2016 +0100

    python: Don't generate calls with non-existent C optargs structures.
    
    In the case where we are building a Python dist (which can be
    distributed separately), we generated calls to non-existent optargs
    structures if an API was once no-optargs but had optargs added.  A
    typical error was this (library: 1.32.5, Python sdist: 1.33.42):
    
        guestfs-py.c: In function ‘guestfs_int_py_glob_expand’:
        guestfs-py.c:9648:40: error: storage size of ‘optargs_s’ isn’t known
           struct guestfs_glob_expand_opts_argv optargs_s;
    
    This is a simple solution to this, although it has the possible
    disadvantage that such functions will not be bound at all.

commit 1f650932e34ca03bde41f19b2e477717521d2f12
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 11 15:47:51 2016 +0100

    python: Add documentation to guestfs-python about using pip & virtualenvs.

commit c56c6e901090bdd49f9de88cb263ab70697b88f2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 11 15:46:23 2016 +0100

    python: Fix python sdist.
    
    Since commit 83e92b4a972a4dafdcc42388f4a5394e804dd7bf, utils.c
    includes "ignore-value.h".  We copy utils.c into the python sdist
    tarball, but it didn't not compile because of the missing header file.
    Therefore we need to copy the header in too.
    
    Fixes commit 83e92b4a972a4dafdcc42388f4a5394e804dd7bf.

commit 41407664603d8fc58b2e74065cbb0ca2ba9e9aa6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 11 13:22:22 2016 +0100

    v2v: Document ports, firewall and proxy settings used by vCenter.

commit 711c4c923d196a506da04ad8bcfbe6aa3c1a5edc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 9 09:36:58 2016 +0100

    Version 1.33.42.

commit 4e0dbf94e77cf18d01e30a81d3bc4c007f64d4a4
Author: Maxim Perevedentsev <mperevedentsev@virtuozzo.com>
Date:   Fri Jul 8 14:08:11 2016 +0300

    sysprep: fix btrfs subvolume processing in fs-uuids
    
    guestfs_set_uuid wants device as argument.
    Moreover, btrfstune -U is unable to set uuid for subvolumes,
    only unmounted partitions are supported.
    
    Here we skip btrfs subvolumes.

commit f90185dfdffa52ca38c249ac8a628baee15c2cae
Author: Maxim Perevedentsev <mperevedentsev@virtuozzo.com>
Date:   Fri Jul 8 14:08:10 2016 +0300

    lvm: modify guestfs_is_lv to take mountable
    
    Calling guestfs_is_lv on btrfs subvolume throws an error.
    Here we workaround it by taking Mountable instead of Device
    and returning 'false' for non-device mountables.

commit d6bba9bc42f28276a070327630f889e69a5ca2fa
Author: Maxim Perevedentsev <mperevedentsev@virtuozzo.com>
Date:   Fri Jul 8 14:08:09 2016 +0300

    mllib: add checking for btrfs subvolume
    
    This is needed to skip btrfs subvolumes from output
    of list_filesystems where device is needed.

commit abf85b050edf04a446e07f4c251e3bd76a8b9f70
Author: Matteo Cafasso <noxdafox@gmail.com>
Date:   Thu Jul 7 20:48:24 2016 +0300

    filesystem_walk: more information into tsk_dirent
    
    Access, modification, last status change and creation time in
    Unix format as for statns.
    
    Number of links pointing to a given entry.
    
    If the entry is a symbolic link, report the its target path.
    
    A new flag (DIRENT_COMPRESSED 0x04) indicating whether the file is
    compressed using native filesystem compression support.
    
    Signed-off-by: Matteo Cafasso <noxdafox@gmail.com>

commit 123dc018b8b30cfe0b17731981ecfb1b6a1cfe33
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 8 09:17:21 2016 +0100

    mllib: Rename unshift -> push_front, push -> push_back etc.
    
    The C++ function names are more regular.
    
    Updates commit 1c57c71d46dae2c61c393c32ec85a7022c95f818.

commit 1a3e986b614276d765247ace48a64db21ea8b7e8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 7 20:36:12 2016 +0100

    builder: Add Fedora 24 (aarch64) image.

commit 7d99c2eb84b18da0a1fbe3ba4dbd0920f8cc1ea3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 7 18:22:09 2016 +0100

    builder: downloader: More tweaks to curl code.
    
    No functional change.

commit 560156d899ac8210fae2bef7a421da10c743ab25
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 7 16:13:48 2016 +0100

    v2v: Use imperative list functions to simplify DOM building code.

commit 6a3416361bb8ecf29e70813b048e6f301854bf54
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 7 16:12:18 2016 +0100

    v2v: Don't open DOM module in output_rhev and output_vdsm.
    
    I think this is left over from before we moved the OVF code
    out to its own module.

commit 442092a305b962fe795e6b366446c28caddeac5f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 7 15:02:05 2016 +0100

    Replace 'xs := x :: !xs' with 'unshift x xs'.
    
    In one case, I used prepend instead.

commit e84382e9f823070d4dcf88456015e7b228a74cd4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 7 14:58:05 2016 +0100

    builder, v2v: Use imperative list functions to simplify curl arg code.
    
    No functional change in this commit.

commit 1c57c71d46dae2c61c393c32ec85a7022c95f818
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 7 14:52:18 2016 +0100

    mllib: Add some imperative list manipulation functions.
    
    This adds imperative list manipulation functions inspired by Perl.
    The functions are passed list refs which get updated in place.
    
    This allows us to replace some awkward pure functional code like:
    
      let xs = ys in
      let xs = if foo then xs @ zs else xs in
    
    with:
    
      let xs = ref ys in
      if foo then append xs zs;

commit 906c05c70f5ca3e2046e0340dcef0e52a3cafb96
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 7 13:43:11 2016 +0100

    builder: Use the new Curl module for passing parameters to curl.
    
    These are now passed using a curl configuration file, which is a
    little bit safer than using command lines.  virt-builder doesn't need
    to pass usernames and passwords to curl, but if it ever does in future
    this will be a lot safer.

commit 20509df94eea1d8973310904ee53d4ef90086891
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 7 13:10:00 2016 +0100

    curl: Change the API to use an abstract data type.
    
    Change the Curl module to use an ADT to store the name of the curl
    binary and the arguments.
    
    The callers in virt-v2v are changed accordingly.
    
    This also adds a (currently unused) ?proxy argument to allow callers
    to override the proxy.  It also adds some safety arguments implicitly.

commit 10e096c0639c67c66d176733ad28f817fe45323a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 7 12:23:03 2016 +0100

    v2v: Move Curl wrapper to mllib.
    
    Just code motion, no change.

commit b35819d990d6935de5650af3fb7580c096b4385e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 7 10:07:15 2016 +0100

    v2v: changeuid: Improve error messages.

commit 9fa8e0746566e03387518f6c03b768de6ce95a71
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Jul 7 16:20:13 2016 +0200

    daemon: fix cleanup of stringsbuf usages
    
    Declare most of the stringsbuf as CLEANUP_FREE_STRINGSBUF, so they are
    freed completely on stack unwind: use take_stringsbuf() in return
    places to take away from the stringsbuf its content, and remove all the
    manual calls to free_stringslen (no more needed now).
    This requires to not use free_stringslen anymore on failure in the
    helper functions of stringsbuf, which now leave the content as-is (might
    be still useful even on error).
    
    This allows us to simplify the memory management of stringsbuf's, which
    are not properly fully freed, fixing memory leaks in some error paths
    (which were not calling free_stringslen).

commit 6a06b8755950b5bb02ced3f826cf2d0cd6e0f15c
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Jul 7 15:10:37 2016 +0200

    daemon: free the string on stringsbuf add failure
    
    If add_string_nodup fails free the passed string instead of leaking it,
    as that string would have been owned by the stringbuf.
    
    Adapt few places to this behaviour.

commit d061b67410973ac09012cfffbeab1d583c206f9c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 6 14:57:06 2016 +0100

    Version 1.33.41.

commit 70faafddbad555bd01ab00b09b1e63a60663b82f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 6 10:46:21 2016 +0100

    v2v: Fix documentation, [--in-place] -> I<--in-place>.
    
    Fixes commit 9221ef6f7959ae3b979fd05007363810bc66062b.

commit 9cf220e73ec58bb6179f9074910ee8b1283f6b3a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 5 13:52:15 2016 +0100

    inspection: Find icon in Windows 7 64 bit guests (RHBZ#1352761).
    
    We have to download the old 32 bit explorer.exe in order to find the
    icons as the 64 bit version doesn't contain any icons (where are they?).
    Thus prefer the 32 bit (WoW64 subsystem) directory if found.
    
    Fixes commit 7f16c346bbeba2f2fe3c31ccb85158178a284d84.
    
    Thanks: Xiaoyun Hu

commit 4e806c4bd2aa9267c736384870dd216d2d95d8ae
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 5 12:40:22 2016 +0100

    inspection: Find Ubuntu logo from an alternate location (RHBZ#1352761).
    
    The current location doesn't exist unless you've installed GNOME,
    which is not so common on Ubuntu.  Unfortunately I couldn't find any
    other location containing a clean, high quality logo.
    
    This adds another low quality icon source, and also prevents any icon
    being returned if the highquality flag was set (note this prevents
    virt-manager from displaying an icon, but there's nothing we can do
    about that, and it's no worse than the current situation).
    
    Updates commit 1d0683964f996b24b8fcf5bce7611a98443344f3.
    
    Thanks: Xiaoyun Hu

commit d6744dac60be0b99f6b6fcfb6a1209a8cc5faabc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 2 10:16:55 2016 +0100

    p2v: Remove p2v.debug option from test command lines.
    
    Fixes commit 0c04919f50685c583842b48ca035626753e959e5.

commit 0c04919f50685c583842b48ca035626753e959e5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 2 10:01:09 2016 +0100

    p2v: Remove the Enable debugging option, -v, p2v.debug.
    
    This is now enabled by default and cannot be changed/disabled by the
    user.  The output is saved into /tmp/.../virt-v2v-conversion-log.txt
    on the conversion server.

commit 88be0a237f5d7552ff28648965369b6bf7c4fb1a
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Jul 1 17:46:23 2016 +0200

    v2v: fix priority of match in configure_kernel_modules
    
    This makes sure that in the internal configure_kernel_modules function,
    for virtio or SCSI block types:
    a) the warnings about leftover Xen modules are printed
    b) the changes in Augeas are saved
    
    Fixes commit ee0219148352695ddf1102a426dcfe4e3be55fba.

commit d4dfa47158d045c512e7a0b7537e033fa22859a5
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Jul 1 17:38:34 2016 +0200

    v2v: fix and implify the internal Convert_linux:discover_modpath
    
    First check for the existence of the directory /etc/modprobe.d, in case
    using a file under it; this also skips all the other checks, since they
    are not needed at all.  Also /etc/modprobe.d exists on recent Linux
    versions, so let's give priority to the more common methods.
    When /etc/modprobe.d does not exist, check for the file to edit using a
    single list of possible files, now in order of priority, where the first
    find is used without checking further for the rest.
    
    Also, make sure all the returned paths are absolute: they are used in
    Augeas paths later on, so relative paths will not do anything useful.

commit 026992d58d9319b517fa48c9e222ac3e54bd4005
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Jul 1 15:48:04 2016 +0200

    docs: fix link to csvtool
    
    Refer to the new home of the OCaml csv module.
    
    Thanks to: Yehuda Zimmerman.

commit 30b728bc3bb8f0cdf3383ee12480ce8f6b54f5af
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 1 12:22:05 2016 +0100

    Version 1.33.40.

commit 87131d8681b6e72dac4d8c952f3b3fb7ade02eed
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 30 14:13:24 2016 +0100

    p2v: Send ^C to remote end to cancel the conversion.
    
    We are now able to cancel the conversion instantly by sending ^C to
    the remote virt-v2v process.
    
    Also, this reverts:
    "p2v: Poll to make Cancel Conversion button more responsive."
    (commit 6da4941db7f8a85997d6281b9b4c5165768e6489)

commit fa6402a0f8c54397588597e3553bc05576a3863d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 30 13:52:43 2016 +0100

    p2v: ssh: Set cooked mode on the ssh session which runs virt-v2v.

commit 6d9bac80b20024a397232f42d136fb48a537a7c4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 30 13:42:53 2016 +0100

    p2v: Use 'scp' to copy the files to remote debugging directory.
    
    Previously we copied / creates files in the remote dir by running
    complex shell commands like:
    
      cat > file <<'EOF'
        ## the file was copied in here
      EOF
    
    This was a little hairy, but in particular it doesn't allow us to set
    the ssh session to cooked mode (so we can send ^C to cancel a
    conversion).
    
    A cleaner way to do it is to use 'scp' to copy the files over.

commit c2fab43dd657af5df270cc86635aa38f36d91c36
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 30 13:51:56 2016 +0100

    p2v: Set an SSH error message if mexp_spawnv fails.

commit 9445a4da17010a850b0a09c8d252aeb083812280
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 29 21:21:40 2016 +0100

    p2v: miniexpect: Add mexp_send_interrupt, mexp_spawnvf, mexp_spawnlf and various flags.

commit 3390df44d30a0805e9d64d24ec7929e59f23b19d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 29 15:22:29 2016 +0100

    miniexpect: Set signals to defaults and close other file descriptors after forking.

commit b15b6e69e37cb3b6520d301442a67b9971ae8d51
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 29 12:51:39 2016 +0100

    p2v: Colourize kernel-conversion status messages from virt-p2v.
    
    The messages that come "through" from virt-v2v are already colourized.
    However the other messages are not.  This colourizes the ones
    generated during kernel-mode conversions.
    
    Note that because of the way journal/syslog works we have to write the
    ansi_restore before the end of line, thus code like this:
    
     ansi_magenta (stdout);
     printf ("%s: %s", guestfs_int_program_name, data);
     ansi_restore (stdout);
     putchar ('\n');
    
    This also adds a "Conversion finished successfully" message (in green).
    
    Thanks: Ming Xie

commit d2abfc7b486039efdfb3fa9b910e14911215b85a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 29 12:49:46 2016 +0100

    utils: Move ansi_* functions to header guestfs-internal-frontend.h.
    
    This is just code motion.

commit 3ac0aa82327a23e3a2538f46938481beae72d2ec
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 29 10:09:27 2016 +0100

    mllib: Add powerpc64 and powerpc64le to normalize_arch (RHBZ#1264835).
    
    Add powerpc64 (ppc64) and powerpc64le (ppc64le) cases to the
    normalize_arch function.  Also remove a few duplicate cases which are
    already caught in the catch-all case at the end of the match.

commit 2d65129e7e43b4ce861dd882218cb2f36f3b68d1
Author: Matteo Cafasso <noxdafox@gmail.com>
Date:   Tue Jun 28 22:49:16 2016 +0300

    Reserve entries to tsk_dirent struct
    
    Already implemented entries.
    
    tsk_inode
    tsk_type
    tsk_size
    tsk_name
    tsk_flags
    
    Easy ones to add.
    
    tsk_atime_sec
    tsk_atime_nsec
    tsk_mtime_sec
    tsk_mtime_nsec
    tsk_ctime_sec
    tsk_ctime_nsec
    tsk_blksize
    tsk_blocks
    
    Further ideas.
    
    tsk_nlink
    tsk_link_name
    
    Signed-off-by: Matteo Cafasso <noxdafox@gmail.com>

commit b221863f220ee3bb7aea986a17660f2d1f62ec76
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 28 16:43:40 2016 +0100

    p2v: Add more utilities to the virt-p2v ISO.
    
    - iscsi-initiator-utils (open-iscsi), as a partial fix for RHBZ#1337052
    
    - vi (Vim), to use as an editor inside the XTerm window.

commit 13307325e8a4bf12016897224d069309deb34135
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 28 13:38:34 2016 +0100

    p2v: Remove trailing \n from fixed disks device box.
    
    Fixes commit 6aba5a49448d8ed9776164005080620d37bb97e0.

commit cc38d62fdfff9dd72ecb379038e99727077f639d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 28 12:29:29 2016 +0100

    p2v: Ensure messages are flushed through to the journal immediately (RHBZ#1229386).
    
    In kernel conversion mode, we must ensure messages are flushed to the
    journal as soon as they are received from virt-v2v, otherwise (now
    that debugging is not the default) we won't see any messages at all
    until the last moment.
    
    Thanks: Ming Xie

commit 5f248dcd395907f80e5a7a1ccb0d5f56b3e2e015
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 27 15:31:37 2016 +0100

    p2v: Add 'less' package to the ISO.
    
    When running the xterm it is very useful to be able to do:
    
      dmesg | less

commit 2783f695ff425ba4ff9cd59f28bb6046a3bb1114
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 27 11:40:18 2016 +0100

    p2v: Add --install option to virt-p2v-make-disk, virt-p2v-make-kickstart.
    
    This allows you to install extra packages in the disk/ISO.  The
    implementation of this option in virt-p2v-make-disk was particularly
    simple and followed naturally from the previous commit.

commit 07137ea565653ca22e055cef09a08add6ad5f1c9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 27 11:18:43 2016 +0100

    p2v: virt-p2v-make-disk passes through --no-warn-if-partition to virt-builder.
    
    See: https://bugzilla.redhat.com/show_bug.cgi?id=1342337#c4
    
    Thanks: Junqin Zhou

commit de5c00eebf0a9d173f37bbcacce5e628ff09580d
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Jun 27 11:49:13 2016 +0200

    automake2junit.ml: sanitize logs, make it more conformant
    
    - sanitize the logs, removing terminal color codes and carriage returns
    - add an empty "properties" node
    - put the log for skipped tests as "message" attribute, hoping it is
      read from there
    - do not blacklist the log of test-virt-rescue.pl, which should not
      cause issues now

commit 0b836c40f2674e8632212363b9ad4f7781e5622e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 27 10:16:51 2016 +0100

    p2v: Fix timeout error when connecting to unresponsive ssh server (RHBZ#1350363).
    
    If an ssh server is completely unresponsive (ie. it doesn't even send
    back ICMP errors), then eventually ssh times out after ConnectTimeout
    seconds [ConnectTimeout is an ssh option].
    
    Unfortunately the miniexpect timeout (default 60 seconds) was less
    than ConnectTimeout so we never saw the ssh error.  Instead we would
    see the internal error:
    
      remote server closed the connection unexpectedly,
      waiting for: password prompt
    
    This commit sets the ssh ConnectTimeout to an explicit value, and sets
    the miniexpect timeout to be 20 seconds larger than ConnectTimeout, so
    that in most cases we will see the ssh error message before miniexpect
    times out.
    
    Thanks: Ming Xie for finding and diagnosing the problem

commit 40448d6d0d63d79da540c2a9e5eb098b537ede50
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 24 22:28:40 2016 +0100

    p2v: Make the conversion dialog slightly higher.
    
    Otherwise the information pane is smaller than its content.

commit 9270a27650abaf586070c51cb90b6a77ec13e0cf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 24 15:28:46 2016 +0100

    p2v: Display serial number of fixed disks (RHBZ#855058).
    
    Use "lsblk -o serial" to get the serial number of each fixed disk, and
    if it is available display that in the GUI.

commit 6aba5a49448d8ed9776164005080620d37bb97e0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 24 14:53:52 2016 +0100

    p2v: Combine size & model columns into the device column.
    
    In the GUI disks block, instead of using separate "Size" and "Model"
    columns, combine that information into a markup column under "Device".
    
    To make the GUI look consistent I also had to change the removables
    "Device" column to be a markup column and embolden the device name
    there too.

commit 68ff3ffd1de7b72255ee5098c0bfef90e6236cb5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 24 14:45:05 2016 +0100

    p2v: Refactor into get_blockdev_size and get_blockdev_model functions.
    
    This is just refactoring, but it reveals and fixes a bug too.  The
    size_gb field was left as NULL when the --test-disk option was used.
    Apparently passing NULL to gtk_list_store_set is fine, but just in
    case I replaced it with "".

commit 5ea62c57c4405e45b325b83e6ee0816bf4b1868a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 24 10:51:22 2016 +0100

    Revert "p2v: add -x option to nm-online"
    
    This reverts commit f51c0bc83717181304277dc335f8aaea1eaf5db1.

commit 95448111d2850e9b8ecaa435bfd5a828ff2ba9db
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 23 23:10:07 2016 +0100

    Version 1.33.39.

commit 82b74ed0bdb6d0cfd207343f75fa8e362c11d58e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 23 14:51:58 2016 +0100

    v2v: windows: Fix priority of match statement which stopped Xen/Parallels code from being uninstalled.
    
    Fixes commit c466d4cb928fcfea37908cc66c90ac8430d6d4c6.

commit 7c52d86de98d1844f09e86dfd50ee85e6edb59ad
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 23 14:44:14 2016 +0100

    virt tools: Use Sys.file_exists instead of clumsy open_in/close_in hack.
    
    No functional change.
    
    Fixes commit c466d4cb928fcfea37908cc66c90ac8430d6d4c6.

commit 8f8a651e591064d87974bd322a995519347ebae7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 23 14:25:23 2016 +0100

    p2v: ssh: Improve consistency of error messages.

commit 323c3e20a4d47fc5a0f1b5fcd3352f746c8bd9dd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 23 13:52:46 2016 +0100

    p2v: Make the sudo error message actionable.
    
    Updates commit 5b6a8e086264c85fb048c0eadff6c34351663133.

commit 9221ef6f7959ae3b979fd05007363810bc66062b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 23 13:27:09 2016 +0100

    v2v: Refuse to convert if < 1GB of free space in temporary directory (RHBZ#1316479).
    
    The error you would see is:
    
      virt-v2v: error: insufficient free space in the conversion server temporary
      directory /var/tmp (853.8M).
    
      Either free up space in that directory, or set the LIBGUESTFS_CACHEDIR
      environment variable to point to another directory with more than 1GB of
      free space.
    
      See also the virt-v2v(1) manual, section "Minimum free space check in the
      host".
    
    Also adds some documentation.
    
    Thanks: Ming Xie and Xiaodai Wang

commit d8a465a14c3596a9fea53560bc7ad2ee6c3111bc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 23 13:12:44 2016 +0100

    v2v: Rename check_free_space -> check_guest_free_space.

commit a7fb3d601ab2ae3cdf2074d4c47afe59f00eea6d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 23 13:11:45 2016 +0100

    v2v: Move calculation of overlay directory to common code.
    
    There is a tiny functional change in this patch, since overlay_dir is
    now always evaluated once (eg. even in --inplace mode), whereas
    previously it was evaluated twice but only in copying mode.

commit 24130d787256dc3d9e37e85b1ba35ac7dbeb86a1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 23 13:10:35 2016 +0100

    sparsify: Move statvfs wrapper function to mllib.
    
    We wish to use this function in virt-v2v too, so move it to the common
    directory.
    
    No functional change.

commit 5e794b86072cfaa1d2017d93bd3a24be72636c02
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 23 11:27:01 2016 +0100

    p2v: Set LANG=C in the remote shell so we can match on error messages.
    
    Since commit 5b6a8e086264c85fb048c0eadff6c34351663133 we are now
    matching on error messages, and therefore we must set LANG=C.

commit d41cf142e1eb285eca798889d3b6a955afffbe32
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 23 11:19:37 2016 +0100

    p2v: Force bash as the remote shell.
    
    As described in the comment, this solves a number of problems with
    non-standard remote configurations.
    
    I tested this with:
    
     - tcsh
     - zsh
     - ksh
    
    and all behaved correctly.

commit 5b6a8e086264c85fb048c0eadff6c34351663133
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Jun 23 11:07:18 2016 +0200

    p2v: improve error message for sudo with password
    
    Print a better error message when the non-root user on the conversion
    server requires a password to use sudo, and p2v is told to use sudo.
    
    See also RHZ#1340809.

commit 32cc27bb61840f21e448ca8a1571dc22d69a1cb9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 23 08:30:48 2016 +0100

    generator: filesystem_walk APIs added in 1.33.39 (not .37).
    
    Updates commit 3de8abac4a3c51fb6ccf3cbd93533a2ff8b6ab1e and
    commit 19e7a52f8f1a4a83f25978053611385b6be8bffc.

commit 19e7a52f8f1a4a83f25978053611385b6be8bffc
Author: Matteo Cafasso <noxdafox@gmail.com>
Date:   Wed Jun 15 20:28:52 2016 +0300

    New API: filesystem_walk
    
    Library's counterpart of the daemon's internal_filesystem_walk command.
    
    It writes the daemon's command output on a temporary file and parses it,
    deserialising the XDR formatted tsk_dirent structs.
    
    It returns to the caller the list of tsk_dirent structs generated by the
    internal_filesystem_walk command.
    
    Signed-off-by: Matteo Cafasso <noxdafox@gmail.com>

commit 7d8fbde4b29b711964a4f8326a9d654e3959faf5
Author: Matteo Cafasso <noxdafox@gmail.com>
Date:   Wed Jun 15 20:28:53 2016 +0300

    lib: Added filesystem_walk command tests
    
    The tests check whether the filesystem_walk command is able to retrieve
    information regarding both existing and deleted files.
    
    A NTFS image is used as Ext3+ filesystems deletion is more aggressive
    in terms of metadata removal.
    
    Signed-off-by: Matteo Cafasso <noxdafox@gmail.com>

commit 3de8abac4a3c51fb6ccf3cbd93533a2ff8b6ab1e
Author: Matteo Cafasso <noxdafox@gmail.com>
Date:   Wed Jun 15 20:28:51 2016 +0300

    New API: internal_filesystem_walk
    
     - generator: Added tsk_dirent struct
    
    The tsk_dirent struct contains the information gathered via TSK APIs.
    
    The struct contains the following fields:
     * tsk_inode: inode of a file
     * tsk_type: type of file such as for dirwalk command
     * tsk_size: file size in bytes
     * tsk_name: path relative to its disk partition
     * tsk_flags: bitfield containing extra information
     * tsk_spare[1-5]: extra space for future usage
    
     - configure: Added libtsk compile-time check
    
    Ensure libtsk is available at compile time.
    If not, daemon routines depending on it won't be available.
    
     - API: internal_filesystem_walk
    
    The internal_filesystem_walk command walks through the FS structures
    of a disk partition and returns all the files or directories
    which could be found.
    
    The command is able to retrieve information regarding deleted
    or unaccessible files where other commands such as stat or find
    would fail.
    
    The gathered list of tsk_dirent structs is serialised into XDR format
    and written to a file by the appliance.
    
    Signed-off-by: Matteo Cafasso <noxdafox@gmail.com>

commit 90e623d4c7aac1a7f4bd0ca21847cfd3d53fa8be
Author: Matteo Cafasso <noxdafox@gmail.com>
Date:   Wed Mar 30 22:18:10 2016 +0300

    Code cleanup in daemon/sleuthkit.c
    
    Adhere to coding standards.
    
    Signed-off-by: Matteo Cafasso <noxdafox@gmail.com>

commit 434f617bdd32dc680c93707f3c21d6339f376965
Author: Matteo Cafasso <noxdafox@gmail.com>
Date:   Wed Mar 30 22:18:09 2016 +0300

    Improve download_inode documentation string.
    
    The download_inode does not require the disk to be mounted
    in order to work.
    
    Signed-off-by: Matteo Cafasso <noxdafox@gmail.com>

commit 0421c5afa330b80c17d8dce88abed2cb53f4f5cc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 22 14:48:22 2016 +0100

    v2v: Add a regression test for floppy assignment (RHBZ#1309706).

commit b9613acb94e3328204d96efab0dfc8b8ed1d3368
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 22 15:04:26 2016 +0100

    v2v: Fix conversion of floppy removable devices (RHBZ#1309706).
    
    The previous code treated floppy disks and CD-ROMs as the same kind of
    thing, resulting in malformed libvirt XML.  You would see the
    following error when importing a guest into libvirt:
    
      error: Failed to define domain from /tmp/v2vlibvirt063486.xml
      error: internal error: Invalid floppy device name: hdb
    
    because we incorrectly generated this bogus libvirt XML fragment:
    
      <disk device='floppy' type='file'>
        <driver name='qemu' type='raw'/>
        <target dev='hdb' bus='ide'/>
      </disk>
    
    This commit models floppy devices as a distinct type, occupying their
    own bus ("/dev/fdX").  When writing to libvirt, we generate correct
    XML fragments, looking like this:
    
      <disk device='floppy' type='file'>
        <driver name='qemu' type='raw'/>
        <target dev='fda'/>
      </disk>
    
    Miscellaneous other changes were required in the code.  There is also
    a regression test (see following commit).
    
    Note this ignores floppy disks in '-o qemu' mode.

commit 044de389e750487f6a515fcf4ec9b0cfca89ce9b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 22 15:52:00 2016 +0100

    builder: Add Fedora 24 images for x86-64, i686, armv7l.
    
    aarch64 image isn't buildable at the moment because of
    Anaconda bug RHBZ#1348980.
    
    ppc64 & ppc64le images are not buildable because of delays updating
    the Fedora mirrors.

commit 94e1504146bfb2d0dd9661865d0a423b6be07eb7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 22 15:44:25 2016 +0100

    v2v: OVF: Add <BootOrder/> to the first drive.
    
    This adds <BootOrder>1</BootOrder> to the first drive, which is
    necessary to make the drive bootable (or would be necessary, if oVirt
    hadn't implemented their own workaround for the OVF we were previously
    generating).
    
    https://bugzilla.redhat.com/show_bug.cgi?id=1308535#c11
    
    This is not a full solution to the problem.  Really we should be
    copying the boot order over from the source hypervisor, but that
    requires extensions to libvirt as discussed here:
    
    https://bugzilla.redhat.com/show_bug.cgi?id=1308535#c7
    
    Thanks: Shmuel Melamud

commit 6521be3aa7667aea1e46b44b0c9c5428a7124cc2
Author: Maxim Perevedentsev <mperevedentsev@virtuozzo.com>
Date:   Wed Jun 22 16:43:13 2016 +0300

    ext: change e2fsck retcode processing during resize
    
    e2fsck returns 1 in case of "file system errors corrected".
    We treat it as success in normal e2fsck, but fail if e2fsck
    is run by resize2fs.
    
    Change 'manual' execution of e2fsck to dedicated function call.

commit 62d23aa4f9dbfd133558189f726d342e3823d8d2
Author: Cédric Bosdonnat <cbosdonnat@suse.com>
Date:   Wed Jun 22 14:02:27 2016 +0200

    p2v: use yast2 lan on SUSE distros rather than NM
    
    NetworkManager isn't provided on SLES. As yast2 lan is available on all
    openSUSE / SLE distro, use it instead.

commit e4e197bb8699247fac1ac4d7fe2dd331dd9fc249
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 22 12:45:18 2016 +0100

    builder: Use newly open sourced edk2 from Fedora, replacing kraxel's builds.

commit 27b3b2cf7d677008d93fb7d1198a0871e08e2599
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 22 12:41:57 2016 +0100

    builder: Use a different mirror when building armv7l image.

commit f51c0bc83717181304277dc335f8aaea1eaf5db1
Author: Cédric Bosdonnat <cbosdonnat@suse.com>
Date:   Wed Jun 22 11:45:35 2016 +0200

    p2v: add -x option to nm-online
    
    On distros not running NetworkManager, use the nm-online -x parameter
    to exit quickly. The network connection will be checked just after
    anyway when attempting to connect to the conversion server using ssh.

commit 9c0f547b029e9e7f5a709c4af7c0e51a60d09822
Author: Cédric Bosdonnat <cbosdonnat@suse.com>
Date:   Wed Jun 22 11:45:34 2016 +0200

    p2v: add virt-p2v-make-kiwi to generate kiwi config
    
    Kiwi is the tool used by openSUSE / SLES to generate many sort of
    disk images. Add a virt-p2v-make-kiwi tool and his documentation to
    geneate the p2v appliance kiwi configuration.

commit 9507c79945c1b300fc12a10ba9331506da3d3c96
Author: Cédric Bosdonnat <cbosdonnat@suse.com>
Date:   Wed Jun 22 11:45:33 2016 +0200

    p2v: fix dependencies for SLES / openSUSE
    
    Use the common denominator for SLES and openSUSE in the dependencies.
    For example most of NetworkManager pieces and metacity aren't provided
    on SLES.
    
    ifconfig is in the net-tools-deprecated package in openSUSE Factory,
    which means after openSUSE Leap 42.2. Older versions have it in the
    net-tools package. Adding this complexity only to add ifconfig because
    sysadmins prefer it isn't too good:  iproute2 is doing the job.

commit 10cbf35cbd7d4feb315fd484901ae53530cd34e2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 22 10:17:22 2016 +0100

    p2v: Use a more specific password prompt regexp.
    
    The password prompt is actually generated by the openssh client which
    is under our control, so we can regexp match on the specific prompt
    printed by openssh.  This also avoids mistaking any server-side
    issue.net message for a password prompt (eg. if the server prints a
    message like "all users must change their passwords today!")  which
    would have prevented virt-p2v from logging in.

commit c44ff0b789b782d9cee385f1f0193f804287a945
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 22 10:10:03 2016 +0100

    p2v: Improve the error message when login fails (RHBZ#1348900).
    
    This can fail because the username is wrong.  Also don't unnecessarily
    reveal irrelevant implementation details in the error message, just
    say the login failed.
    
    Thanks: Juquin Zhou

commit 572b416468483d7345ec7ce7574c7ba83eca980a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 21 14:18:04 2016 +0100

    Revert "aarch64: launch: libvirt: As a workaround, pass -cpu parameter to qemu."
    
    Since libvirt bug https://bugzilla.redhat.com/1184411 is now fixed, we
    don't need this workaround any longer.
    
    This reverts commit 7e4b7a346a4558a02aeb58f82d518509ce6e5d03.

commit c87eab35c0b206306f98a2a267e299be32a9e5f2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 21 14:11:57 2016 +0100

    p2v: Gtk 3 workaround for RHEL 7.
    
    New enough to complain about gtk_widget_modify_font, not new enough to
    have gtk_style_context.
    
    Fixes commit ca6fea7616f89775180ab686133052eca18f0e00.

commit b5725ef856f850867d1d9ea875c03d3cf3417c4b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 20 10:48:11 2016 +0100

    docs: internals: Fix cross-references to guestfs(3) man page.

commit 6da4941db7f8a85997d6281b9b4c5165768e6489
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 20 10:18:22 2016 +0100

    p2v: Poll to make Cancel Conversion button more responsive.
    
    Previously cancelling the conversion only set a flag, which was
    checked when the run dialog displayed new output from virt-v2v.  When
    virt-v2v was showing hundreds of debugging messages, this wasn't a
    problem, but now that we are hiding those messages, cancelling the
    conversion might mean a wait of seconds or minutes.
    
    By polling (albeit infrequently) we can make the cancel button more
    responsive.

commit 55a0ab845d570c781d321b09213aa43a709e91cd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 20 10:02:11 2016 +0100

    p2v: Don't display libvirt XML and wrapper script on stderr.
    
    Confusing for end users, and not necessary for debugging since those
    files are saved on the conversion server.

commit 6f5abc9539a4d47c98898b4c491d6b017d9abbbb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 20 09:56:48 2016 +0100

    p2v: Display up to 50 lines of the virt-v2v conversion log on failure.
    
    For some failures, 30 lines was not sufficient and only part of the
    error was shown.  Increase the number of lines shown to 50.
    
    This also colourizes the failure message, and prominently displays the
    location of the full log.  The following message is now shown:
    
      *** virt-v2v command failed ***
    
      The full log is available on the conversion server in:
          /tmp/virt-p2v-20160620-sga9rhk7/virt-v2v-conversion-log.txt
      Only the last 50 lines are shown below.
    
      [followed by up to 50 lines of log]
    
    Updates and fixes commit 7447fe2478e49f5121a40db973f8a1fb1daaec53.

commit 44483e7eb3d00b23b601efc6f9f6acf09f754f73
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Jun 20 14:20:11 2016 +0200

    inspect: recognize older PLD Linux versions
    
    PLD Linux got /etc/os-release only in the recent 3.0 release; since
    older versions have only /etc/pld-release, check for it to identify
    the guest and get its version.

commit 6db10433426646d308e039a2917d172662b2eb26
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 18 22:40:55 2016 +0100

    Version 1.33.38.

commit 257f2cc6b4d61b7c5ce77830cdf0a1408bc15231
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 18 21:47:21 2016 +0100

    p2v: Use absolute path in test.
    
    Fixed because of change in commit 7447fe2478e49f5121a40db973f8a1fb1daaec53.

commit ca6fea7616f89775180ab686133052eca18f0e00
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 18 15:31:34 2016 +0100

    p2v: Use a monospace font for the run dialog.

commit 7301c51da34a9c35c314bc01767c83cd2ea7339b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 18 15:52:09 2016 +0100

    p2v: Add DejaVu Sans and Monospace fonts to the ISO.
    
    Improves the general look of virt-p2v.

commit 7447fe2478e49f5121a40db973f8a1fb1daaec53
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 18 15:12:08 2016 +0100

    p2v: Don't display debugging messages in the run dialog.
    
    Previously we displayed the complete output of virt-v2v in the run
    dialog.  This output included all the debugging messages, and was very
    long and confusing for users (especially we had false bug reports
    about "errors" appearing in the debug output).
    
    Only display stdout in the run dialog.  However make sure everything
    (stdout and stderr) is still logged to the conversion log.

commit 514893b68b6180b3adc5bb762e9d67054a9a7f63
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 18 14:44:24 2016 +0100

    p2v: Use a wrapper script instead of long virt-v2v command lne.
    
    Instead of constructing and directly executing a long virt-v2v command
    line, build a wrapper script with the same command line and send it to
    the remote server (stored in /<remote_dir>/virt-v2v-wrapper.sh).
    
    This will make it a bit easier to construct more complex virt-v2v
    wrappers.
    
    Note this commit on its own is a simple refactoring and does not
    change any functionality.

commit 5e8f820494e70766a48fee38bc617c37b0c61a48
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 18 10:40:09 2016 +0100

    p2v: Use virt-v2v --colours option, support colour in the run dialog (RHBZ#1314244).

commit b000d6bc68543035e3fc14853c8a9f518ed1b0f3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 18 10:22:46 2016 +0100

    virt tools: Add common --colours option.
    
    This option (alternately spelled: --color, --colour, --colors, or
    --colours) enables ANSI colour sequences output even if that would be
    disabled becaues the output is not a TTY.

commit 5b131356e261ab949083c0347a0fca9ec0743732
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 18 15:25:14 2016 +0100

    virt tools: Warnings are not errors, send them to stdout.

commit bda1224b2b140962223e15a6de3af29b906cd079
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 18 21:08:54 2016 +0100

    p2v: Fix size of run dialog window in Gtk 3.
    
    Setting the size on the surrounding scrolled window works better.

commit 377bd8f921cb65f3447193f7d51623a1752d3568
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 18 19:55:58 2016 +0100

    p2v: Fix the rule for rebuilding windows.img.
    
    Fixes commit 53ec66c7e2d1dd6fa74165749374e4834ea043a0.

commit fc292631da48ebfe1bfa965a4fbdb982e276f1f6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 18 14:05:26 2016 +0100

    v2v: Be careful to send all debug messages to stderr.
    
    The debug() function is already sending these to stderr, but in a few
    places we were using printf.  Change those to eprintf, except for one
    informational message which should have been using info().

commit c5f12e47e4e0dc7846897cad3184ac0892f51ef8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 18 11:28:16 2016 +0100

    p2v: Fix slow test so it runs our locally built virt-v2v.
    
    The virt-p2v slow test tested the local virt-p2v.  However it ran
    against the installed virt-v2v (and in fact would have failed if
    virt-v2v was not installed).
    
    This commit sets the environment up to run the locally built virt-v2v.
    
    This is unfortunately quite a lot more complex than it should be.
    There is no simple "set this environment variable" option in
    sshd_config.

commit 87addfb44085f8c059d3348fc093d47f2f0deded
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 18 11:13:30 2016 +0100

    p2v: test-virt-p2v-pxe.sshd_config is generated by awk, not configure.

commit 4f4f0f1fe98dbc82227c3a393d76498b6624a400
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 18 09:19:10 2016 +0100

    p2v: Add a dialog confirming the user really means to cancel (RHBZ#1340464).
    
    Thanks: Kean Li

commit 072cf26dc3fdd90e8301b15f430b3f34a9bbf85b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 17 22:24:45 2016 +0100

    p2v: Disable the sudo button when the username is root.

commit b0d2d697e03a11642ab36f4a92b1f849085d2db9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 17 21:32:33 2016 +0100

    p2v: Don't allow password & SSH identity URL fields to both be non-empty.
    
    It makes no sense.  By setting one field to non-sensitive when the
    other field is populated, we can avoid this happening, and also make
    tabbing between the fields simpler.
    
    As a consequence of making this change, I also got rid of the now
    unnecessary explanatory text telling you to leave one field blank.

commit e6a173d5d4f2fc59dee96d022fe3fc59339a046c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 17 21:15:47 2016 +0100

    p2v: Hide the spinner in more cases when it is not running (RHBZ#1341564).
    
    In particular if you hit the 'Test Connection' button when the server
    name field was empty, you would still see a stopped spinner.
    
    This updates commit 036a11f37927934132aab4fe01ed6f37c03fd805.

commit b92fe7a6664d75f741e71f996df5038f4d79eff8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 17 15:13:49 2016 +0100

    Version 1.33.37.

commit 02f648f656567f3c5d56d8d12b565501fbfb2109
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 17 14:25:25 2016 +0100

    p2v: Add various disk utilities to the virt-p2v ISO (RHBZ#855058).

commit bb053d067d7e2aaeb02af2adc9d15fd48467ecf7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 17 13:24:22 2016 +0100

    p2v: Fix 'run-virt-p2v-in-a-vm' so it boots the USB disk automatically.
    
    Thanks: Stefan Hajnoczi for working out the right qemu incantation.

commit 762f24c1f3ffabe7412a08f4ca302c5f614aaa9c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 17 12:47:13 2016 +0100

    p2v: In non-GUI mode, make sure the progress of virt-p2v is visible (RHBZ#1229386).
    
    By changing the logging mode of the p2v.service unit, we can make sure
    that the progress of virt-p2v is visible in non-GUI mode at the
    console.
    
    Since the output is now always shown on the console, there's no need
    to print the journalctl command for following that output when the
    user logs in.

commit 3c7c63e1dcd1fb45caa22515e04b662cd14944bb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 17 12:26:48 2016 +0100

    p2v: Don't run X in non-GUI mode.
    
    Even in non-GUI mode we were starting up the X server in the virt-p2v
    ISO.  This is a waste of time and resources, so don't do it.

commit 784d8bd8949235463075006203032b9b5646b57b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 17 12:47:08 2016 +0100

    p2v: Tidy up long line in Makefile.am.
    
    Just a whitespace change.

commit e5fcda8a5a8a75789a89676d3b5b4c7d3f0d0929
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 17 12:25:51 2016 +0100

    p2v: test-virt-p2v-pxe: Fix dependencies for rebuilding the image.
    
    Not all dependencies were included, so some file changes (eg. to
    launch-virt-p2v) would not rebuild the test image.

commit 896e1e191a93c849ea6cbaf602be98834275896c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 17 12:15:20 2016 +0100

    p2v: Add run-virt-p2v-non-gui-conversion target.
    
    This simulates doing a non-GUI conversion with virt-p2v being
    downloaded over PXE.  Conveniently we already had a test that was
    doing this, and this rule just runs the same test.

commit 8717a110120f84973f1148adf48e59222cf45e73
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 16 21:22:16 2016 +0100

    p2v: ssh: Print ssh error if user gives invalid conversion server (RHBZ#1167916).
    
    Instead of throwing away the ssh error and printing the generic
    message "unexpected end of file waiting for password prompt", we
    capture the ssh error and print it.  The user will see the ssh
    diagnostic, eg. "No route to host".

commit 3dd3bba77837f011d6fd81cd6c3407341e4a30c7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 16 21:18:54 2016 +0100

    p2v: ssh: Don't send wrong password more than once (RHBZ#1227599).
    
    For some reason I don't quite understand, in
    commit fd82bb12fd5fc8233955b8ffd4a42c3d6f8d748b if it got the password
    prompt unexpectedly a second time then it would send the password
    again, continually until ssh closed the connection because of too many
    retries.
    
    This obviously makes no sense.  If we get the password prompt back,
    then we must have sent an incorrect password so abort the connection
    and report the error at once.

commit 172b38014b9633e69c84f296d9d96ea08d3a1b3d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 15 12:08:15 2016 +0100

    ocaml: Use -safe-string option in OCaml >= 4.02.
    
    In a follow up to the previous commit, enable the -safe-string option
    when we detect the version of the compiler which supports this option.

commit 6e79a3c84d2bc048b2213c87cc9e96f620f754c5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 14 17:21:47 2016 +0100

    Convert source so it can be compiled with OCaml '-safe-string' option.
    
    OCaml 4.02 introduced the 'bytes' type, a mutable string intended to
    replace the existing 'string' type for those cases where the byte
    array can be mutated.  In future the 'string' type will become
    immutable.  This is not the default now, but it can be forced using
    the '-safe-string' compile option.
    
    This commit changes the code so that it could be compiled using
    '-safe-string' (but does not actually make that change).
    
    If we detect OCaml < 4.02, we create a dummy 'Bytes' compatibility
    module ((nearly) an alias for the 'String' module).  The only
    significant difference from upstream OCaml is that you must write the
    'bytes' type as 'Bytes.t' in interfaces, apart from that everything
    else should work.

commit 66856b6ba09a96552dae5309f51b4ec7630a76aa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 15 12:19:01 2016 +0100

    generator: Use common OCaml rules for building the generator too.
    
    Updates commit a3cb12ab2c1eb323647cc598ab166181aa98545c.

commit a2d0511904aad636f3a217d56b5d3c7f7f64cfda
Author: Andrea Bolognani <abologna@redhat.com>
Date:   Thu Jun 16 16:14:58 2016 +0200

    builder: Fix description for --long option

commit cf137ef30601f81fc017f6627ecf6df03a5bb0ea
Author: Cédric Bosdonnat <cbosdonnat@suse.com>
Date:   Wed Jun 15 14:09:49 2016 +0200

    filesystems: don't try to get the size of btrfs subvolume
    
    virt-filesystem -l tries to get the size of btrfs subvolumes, which
    results in an error. Teach it to skip the subvolumes.

commit 2ecdc46114f564a42f8d6c51c2c2763ba3dda15e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 14 18:54:44 2016 +0100

    mllib: Use Unix.F_OK instead of plain F_OK.
    
    Removes this warning:
    
      File "common_utils.ml", line 826, characters 24-28:
      Warning 40: F_OK was selected from type Unix.access_permission.
      It is not visible in the current scope, and will not
      be selected if the type becomes unknown.

commit bbb83aeccc995341881eb90eaf15f69069c82bc1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 14 17:00:26 2016 +0100

    generator: Remove unnecessary 'chars' function.
    
    String.make can be used instead, and that function has been around
    since at least RHEL 6 era OCaml.

commit a88418621d79805a54c3b0ce9771095848247f8f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 14 13:13:49 2016 +0100

    v2v: OVF: Add new <Origin/> values for virt-p2v and HyperV.
    
    See proposed change to oVirt: https://gerrit.ovirt.org/#/c/59147/
    and RHBZ#1342398.
    
    This enhances commit 9467777fdf08ef7158b63354b9b46b003845daee.
    
    Thanks: Shahar Havivi

commit c9bfe1ee9b071413ff2afdde0a4fac3f3f2aba85
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 14 13:13:23 2016 +0100

    v2v: OVF: Add a comment about what happens for unknown <Origin/>.

commit 669e25049e5e2ba8c252363a93a01a6eebfe5509
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 13 10:53:00 2016 +0100

    sysprep: Add --network to enable the network (RHBZ#1345813).
    
    In commit ae6f726ecc3bc1b67fd76e51a7b1e1a33d4dcfc0 we started to use
    the virt-customize code to replace various virt-sysprep operations.
    This had the effect of adding many more possible operations to
    virt-sysprep, but some of them (specifically --install) did not work
    unless the appliance network is enabled.  It was not enabled in
    virt-sysprep, so these operations never worked.
    
    This change does NOT enable the network by default.  However it adds a
    --network flag which may be used in conjunction with --install etc to
    make those commands work.
    
    In addition we now emit a warning for certain customize operations if
    they fail and if the network is not enabled.  It will print:
    
      [   4.5] Installing packages: tcpdump
      Error: Cannot retrieve repository metadata (repomd.xml) for repository: base. Please verify its path and try again
      Could not retrieve mirrorlist http://mirrorlist.centos.org/?release=6&arch=x86_64&repo=os&infra=stock error was
    
      virt-sysprep: warning: the command may have failed because the network is
      disabled.  Try either removing '--no-network' or adding '--network' on the
      command line.
    
      virt-sysprep: error: yum -y install 'tcpdump': command exited with an error
    
    (If the network is already enabled, or if the command is successful,
    then the warning is not printed.)
    
    Thanks: Xianghua Chen

commit 0b5c6174b8b1222abb2b28a29d9ad9f3dce8c8e6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 13 11:31:10 2016 +0100

    customize: Give an error if --truncate-recursive path does not exist (RHBZ#1345809).
    
    You will now see an error such as:
    
    $ virt-customize -a centos-6.img --truncate-recursive /home/foo
    [   0.0] Examining the guest ...
    [  16.5] Setting a random seed
    [  16.5] Recursively truncating: /home/foo
    virt-customize: error: libguestfs error: find0: /home/foo: No such file or
    directory
    
    Thanks: Xianghua Chen

commit 07c34fa65fc008dc9806e8218c2975d1da1cc02b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 13 11:27:30 2016 +0100

    customize: Use C<> around parameter name in documentation.
    
    Fixes commit a084758e83eddb0c5b57ce904856218240011419
    and commit 7e8ed7cb218c4104753fa5aae9d945d5a84054e9.

commit e6adcae770ce955cf6c550f2609570bcc0da3c74
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 13 10:46:31 2016 +0100

    Version 1.33.36.

commit dba54ec0a275ea8b198c9a1ece24274eb5b53fd3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 13 10:21:14 2016 +0100

    v2v: Fix get_firmware_bootable_device.
    
    Commit 82df76851478f52e02ed6beef0f1576772d066cd breaks the regression
    test for RHBZ#1232192 because g#part_list can return an error when
    called on a completely blank disk.
    
    By rewriting and simplifying the code using higher-order functions we
    can avoid the need for the double-nested imperative loop and calling
    g#part_list at all.
    
    Fixes commit 82df76851478f52e02ed6beef0f1576772d066cd.

commit 08f82f2e3d6975b72340dd59f438862e152a15ef
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jun 12 12:58:57 2016 +0100

    v2v: Allocate extra RAM to the appliance during conversion.
    
    The 'semodule' command, called by the guest tools uninstaller, will
    run out of memory with the default of 500MB
    (https://bugzilla.redhat.com/426775).
    
    Allocate a large amount of RAM, that will be at least 800MB, but scale
    correspondingly on other architectures like ppc64 that have larger
    memory requirements.
    
    Thanks: Pavel Butsykin

commit 736cc8f8a9bdf0b4de0e7fa0732e807da2f16426
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 13 08:54:48 2016 +0100

    mllib: Document open_guestfs identifier parameter.
    
    Just a documentation fix.

commit a3cb12ab2c1eb323647cc598ab166181aa98545c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jun 12 22:40:01 2016 +0100

    ocaml: Move identical rules for building OCaml objects to common file.

commit 0321797c7a866828faed74665b007dcd16c03874
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jun 12 21:56:00 2016 +0100

    v2v: XML: Fold some over-long lines of code.
    
    Just whitespace, no functional changes.

commit ec63594b67f4a766a27048faf1e6ec8117a9b971
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jun 12 21:02:28 2016 +0100

    v2v: XML: Rename internal types.
    
    This is a mostly mechanical renaming of the internal pointer types
    used in the libxml2 bindings.  Also I have added a longer comment to
    make the system clearer.

commit 22190afce91a5ae84d4018b17031cf4499d7a1e2
Author: Pavel Butsykin <pbutsykin@virtuozzo.com>
Date:   Sat Jun 11 13:29:42 2016 +0300

    v2v: remove the 'graphicsmodedisabled' entry in ESP BCD
    
    Guest tools for Windows in Parallels / Virtuozzo Server 6 contain a
    paravirtualized video driver, which wants to take full control of the video
    mode. To avoid excessive video mode switches in UEFI VMs it executes
    "bcdedit /set {current} graphicsmodedisabled true".
    
    When such a VM is imported into a QEMU/KVM-based hypervisor, the
    standard video drivers in Windows do not set the video mode as they
    expect it to have already been configured by the bootloader.  As a result,
    the VM runs with black screen.
    
    So patch the BCD store (which is a Windows registry hive with a special
    structure, located on the EFI system partition) to clear this setting.
    
    Signed-off-by: Pavel Butsykin <pbutsykin@virtuozzo.com>

commit 82df76851478f52e02ed6beef0f1576772d066cd
Author: Pavel Butsykin <pbutsykin@virtuozzo.com>
Date:   Sat Jun 11 13:29:41 2016 +0300

    v2v: fill the list of the EFI system partitions
    
    Store the list of EFI system partitions on the inspect object in order  to be
    able to tune their contents later in the process.
    
    Signed-off-by: Pavel Butsykin <pbutsykin@virtuozzo.com>

commit 3719d75098c94c04100c0bba1742c875ef0b0806
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jun 12 18:03:37 2016 +0100

    docs: hacking: Small updates to virt-p2v code documentation.
    
    Use Unicode box-drawing characters instead of ASCII art.
    
    Reference virt-p2v manual for how virt-p2v works.

commit 09eeb04578b90718dfff4f0c6544bd3562cf586d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jun 12 17:52:52 2016 +0100

    docs: hacking: Document how OCaml programs are compiled and linked.

commit b8f1ea3fff3d7fc22d0b9a609edb345f191cb691
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jun 12 17:35:14 2016 +0100

    v2v: DOM: Make 'doc' and 'element' types distinct.
    
    No functional change, just enforces the distinct type for callers.

commit 4d09ce225154d8c71ad642c0916126ee12662460
Author: Pavel Butsykin <pbutsykin@virtuozzo.com>
Date:   Sat Jun 11 20:51:57 2016 +0300

    v2v: linux: uninstall Parallels tools
    
    Guest tools for Linux in Parallels / Virtuozzo Server 6 come with a script
    that can be used to uninstall them.
    
    Signed-off-by: Pavel Butsykin <pbutsykin@virtuozzo.com>

commit 4df28a433a9e19c21b0b02796b37ee161391ec11
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 10 22:24:38 2016 +0100

    v2v: Whitespace change in DOM.

commit 9467777fdf08ef7158b63354b9b46b003845daee
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 9 15:03:52 2016 +0100

    v2v: OVF: Set <Origin/> field correctly based on source hypervisor.
    
    https://bugzilla.redhat.com/show_bug.cgi?id=1342398#c6

commit 4ed70d558ab04dd668c6f42412f7dac8ad56c14f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 7 22:10:28 2016 +0100

    ruby: tests: Give each test class and method a unique name.
    
    'tc_410_close_event.rb' was not being run.  You could prove this by
    simply inserting "exit 1" into that test.
    
    The reason is unclear, but by renaming every class and method in the
    tests to be unique, this ensures the tests are run.

commit 4d6899ee91ddaa7b5758de50fd2cc09b46e6a7f3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 7 20:52:04 2016 +0100

    ruby: Print exceptions thrown by event callbacks.

commit 35fa14152245bcae2c0842abf120cd4ec7bd098c
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Jun 8 16:12:49 2016 +0200

    get-kernel: use "auto" as real autodetection marker (RHBZ#1341984)

commit 0e0a350c02b9c4d7a4108d2743ee1a61ce88a1f1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 7 14:50:47 2016 +0100

    p2v: Print full curl error when failing to fetch SSH identify URL (RHBZ#1343423).

commit 3064c853726d2904f73b45b5d35140b5a54a5859
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 7 14:32:26 2016 +0100

    p2v: Add note about 403 Forbidden errors when serving id_rsa file (RHBZ#1343414).

commit 6425a8824b13a60ddf5d04270808da00568b1b53
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 7 10:24:54 2016 +0100

    customize: Add --uninstall operation (RHBZ#1343375).

commit a3ca5182d4ea16f71918a3bbad849127de98801d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 6 15:50:27 2016 +0100

    docs: hacking: Describe which order to look at directories.
    
    When browsing the source code.

commit 613a7e0884756fe17c21da990cbaf10a421c4f17
Author: Roman Kagan <rkagan@virtuozzo.com>
Date:   Mon Jun 6 15:12:36 2016 +0300

    v2v:windows: prevent Parallels drivers from loading at boot
    
    Parallels proprietary hypervisor uses RDPMC as the hypercall
    instruction.  As this instruction is supported since early P6 family,
    the drivers didn't even bother to check for the presence of the
    corresponding feature in CPUID.
    
    In QEMU/KVM, however, this instruction triggers #GP unless the VM is run
    with PMU (performance monitoring unit) enabled, which is often not the
    case (due to its impact on perfromance and migratability).
    
    So, to prevent crashes upon conversion, stop respective drivers from
    loading by disabling the corresponding services.  Note that the services
    are being disabled ("Start" value set to 4) rather than their node
    removed, to avoid confusing the uninstaller which is scheduled to run
    from a firstboot script.
    
    In addition, prl_strg (storage filter driver) is unlinked from the
    storage subsystem following the DelReg directive from its .inf file,
    otherwise Windows crashes with BSOD 0x7b due to missing dependency of
    the storage subsystem.
    
    Signed-off-by: Roman Kagan <rkagan@virtuozzo.com>
    Reviewed-by: Richard W.M. Jones <rjones@redhat.com>

commit ba5767d69e580891987ea6435da6d2f6801c3e4a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 6 11:50:15 2016 +0100

    Version 1.33.35.

commit 4c24531d907d888d20498bbac8bd4a4aef424e49
Author: Roman Kagan <rkagan@virtuozzo.com>
Date:   Fri Jun 3 18:14:17 2016 +0300

    v2v: copy all driver files into guest
    
    Some virtio-win drivers contain more files than just *.{cat,inf,sys}.
    They are filtered out currently, which prevents the drivers from being
    installed by PnP.
    
    Stop filtering driver files by extension, and copy all of them instead.
    
    Signed-off-by: Roman Kagan <rkagan@virtuozzo.com>
    Reviewed-by: Richard W.M. Jones <rjones@redhat.com>

commit 3a231afcfa295489fc07cafb60108e0d05ecf4bb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 4 14:46:20 2016 +0100

    p2v: Add more authors who have worked on virt-v2v and virt-p2v.
    
    Use this command as a starting point:
    
      git shortlog -s -- p2v v2v | awk -F'\t' '{print $2}' | sort -f
    
    However note the above will include people who made only incidental
    code changes, and also misses out QA team members, so the actual list
    still has to be curated by hand.

commit 5bc56f4c6bc2be5a2d6aa83574ec1d1f33cc6bb3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 4 14:41:22 2016 +0100

    docs: performance: Mention optimizations added in libguestfs 1.33, qemu 2.7

commit 2e5542a65e5534d4ed9e29db4fe8ad1d84460323
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 4 14:27:07 2016 +0100

    docs: hacking: It's the 'docs' subdirectory, not 'doc'.

commit 5f118f1dd27e8cdcd911f222a47264f6d6cda1db
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 4 14:25:33 2016 +0100

    docs: hacking: Move subdirectories list higher up in the file.
    
    It's better to have this overview of how the code is arranged before
    any details about modifying the code, since most people will be
    reading code before writing.

commit 5d9db47033d30fa8dda0d0be4ff62af489ea8509
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 4 13:53:52 2016 +0100

    docs: building: Document ./configure options.

commit fe84ce852117f2e14c2781c02f38ad07fcf87304
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 4 14:06:32 2016 +0100

    docs: building: Add a warning about running tests as root.
    
    It's a really bad idea, don't do it.

commit 0e469badff42a8dd09f226d5ce3498dda203ca40
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 4 14:00:18 2016 +0100

    docs: building: Fix link to RHEL sources.
    
    These are now stored at centos.org, not at ftp.redhat.com.

commit 2eb1d849f25196820beedfb6ec0b7c6c19a4bd67
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 4 13:53:12 2016 +0100

    docs: Remove imaginary '--enable-gcc-warnings' flag.
    
    It doesn't actually exist.  Not sure if it did in some earlier
    version, but it doesn't exist now.

commit 9d920732a35d9ef1b6a33509dabbbd44123e7eda
Author: Roman Kagan <rkagan@virtuozzo.com>
Date:   Fri Jun 3 18:46:54 2016 +0300

    v2v: recognize Virtuozzo tools as Parallels tools
    
    Recent updates of Virtuozzo Server 6 (fka Parallels Cloud Server 6) have
    "Virtuozzo tools" instead of "Parallels tools" as their display name in
    the corresponding Uninstall registry key.
    
    Recognize those, too, and schedule their uninstallation on first boot.
    
    Signed-off-by: Roman Kagan <rkagan@virtuozzo.com>
    Reviewed-by: Richard W.M. Jones <rjones@redhat.com>

commit 69e5410e6264f58082883beb5254726a1113a4a5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 3 21:35:37 2016 +0100

    fish: rc: Rewrite file descriptor send/receive.
    
    On Linux 4.7.0 the old code was giving -EINVAL errors.  This rewrites
    the code based on online sources, and it works on at least RHEL 7,
    Linux 4.4 and 4.7.  Also checked with valgrind.

commit 8417eb4587133e0c685dd5269b4a4f33e77dde35
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 3 21:01:36 2016 +0100

    fish: rc: Fail hard if recvmsg doesn't receive a file descriptor.
    
    Also some code reformatting.

commit b2cc087e8fe5b4f210d243a7ecf27501ab1b7fd0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 3 14:52:18 2016 +0100

    Version 1.33.34.

commit c97ca67a5c000dac24fdd3f3f749e77501eecd3f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 3 14:21:59 2016 +0100

    mllib: Fix other places where Dev_t module must be linked to Common_utils.
    
    Fixes commit df7a33768eab2381b958ede2c8a40bc9cbc87928.

commit a7c4061a2e38a3eddd0ddd10ec84ac6cc9241d34
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 3 13:04:36 2016 +0100

    Version 1.33.33.

commit f0a7c68146776500fc8749a2de2f0fef40221369
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 3 13:03:39 2016 +0100

    v2v: Don't distribute binary v2v_unit_tests in EXTRA_DIST.
    
    Because EXTRA_DIST included $(TESTS) this ended up distributing the
    binary file v2v_unit_tests.
    
    Unfortunately to fix this we need to list all the test scripts and
    data files explicitly a second time, but there we are.

commit 9f3b6aa6e207b22792973577d7c6b21e6166b77e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 3 11:10:20 2016 +0100

    p2v: Place conversion server name and port side by side.
    
    Just a small rearrangement of the UI.

commit bf434bdb3523b7629d50144f35a6bccc05bf94e6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 3 10:29:46 2016 +0100

    p2v: Add "XTerm" button which launches a terminal window.

commit 60d4b7f544e9143e70ecf04ee8a031a5bc285304
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 3 10:25:59 2016 +0100

    p2v: Add ifconfig to the ISO (RHBZ#1342447).
    
    Suggested by Ming Xie.

commit 57dbad4bba7a8998e2f34b69dc79b644aaf9859a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 3 08:57:00 2016 +0100

    p2v: Rename internal Makefile rule 'run-virt-p2v' -> 'run-virt-p2v-in-a-vm'.
    
    Now there are two rules for running virt-p2v:
    
      make -C p2v run-virt-p2v-directly
    
      make -C p2v run-virt-p2v-in-a-vm
    
    Updates commit f8cfdf274fdbf165036ad90cbe8f96df9757f182.

commit 15079131680d72265cd9f13216b4e357d7767e29
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 2 23:25:07 2016 +0100

    p2v: Fix docs for new hot key to use when testing virt-p2v in a VM.
    
    The QEMU hot key for choosing the boot disk has changed in qemu 2.6.0
    so update the documentation to reflect this.

commit 57abf866768688f8fd237b8a3e25e821d55cc565
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 2 23:20:14 2016 +0100

    p2v: Make run-virt-p2v rule depend on $(PHYSICAL_MACHINE).
    
    Fixes commit f8cfdf274fdbf165036ad90cbe8f96df9757f182.

commit 523a65b65f20c62e04e0f97e4d2c0ee598a703dd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 2 23:12:02 2016 +0100

    p2v: Pass special --iso flag when running in the ISO environment.
    
    If this flag is not set (ie. we are doing local testing) then we
    disable some dangerous features.  Currently this is just the "Reboot"
    button, but may include other features in future.

commit b2bd2beeb6a085484145a7cc5a0859b4f33992b9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 28 17:02:11 2016 +0100

    p2v: Allow virt-p2v to be built with Gtk 2 or 3.
    
    Currently virt-p2v requires Gtk 2.  This commit changes virt-p2v so it
    can be built with either Gtk 2 or 3.
    
    By careful use of macros, this code should compile on both recent
    Gtk 2 and Gtk 3.
    
    With no other options, ./configure will now prefer Gtk 3 if it finds
    it, or fall back to Gtk 2.  But you can control this by setting
    './configure --with-gtk=2|3|check|no' where the options mean:
    
      * --with-gtk=2 - Only test for Gtk 2
      * --with-gtk=3 - Only test for Gtk 3
      * --with-gtk=check - Check for Gtk 3 then Gtk 2 (default)
      * --with-gtk=no - Don't build virt-p2v
    
    In the ./configure output you will see something like this:
    
      checking for --with-gtk option... 2
      checking for GTK... yes
      checking if we can build virt-p2v... yes, with Gtk 2

commit b5ea940d524e8c0d3309fc1ea58ab9e3f557f8c3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 30 21:26:56 2016 +0100

    p2v: Remove GDK thread synchronization.
    
    Gtk 3 deprecates the GDK thread synchronization locks (functions such
    as gdk_threads_enter/gdk_threads_leave), and requires that you issue
    all Gtk calls in the main thread.  To do this you have to restructure
    any code that calls Gtk from other threads so it is wrapped in an idle
    task, and so is run from the main thread.
    
    This commit transforms the code in this way.
    
    I found through experimentation that libxcb crashes noisily if you
    issue any X11 calls (and hence any significant Gtk calls) when the GDK
    thread sychronization initializer has been removed, so if there are
    any remaining calls that are missed by this patch we should find out
    about them quickly.

commit 53ec66c7e2d1dd6fa74165749374e4834ea043a0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 30 19:14:30 2016 +0100

    p2v: Add --test-disk option for testing conversions.
    
    Use, for example:
    
      ./run virt-p2v --test-disk=$(pwd)/test-data/phony-guests/windows.img
    
    to test conversions using a file of test data instead of the real host
    /dev/sda.

commit 7274f11ad408bcd4299ba82b3b26f46e62930d03
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 2 14:51:12 2016 +0100

    builder: Warn if --output is a host partition (RHBZ#1342337).
    
    But allow the warning to be turned off using --no-warn-if-partition.
    
    Ming Xie tried to create a bootable USB key using
    'virt-p2v-make-disk -o /dev/sdX1'.  That works, but doesn't create a
    bootable key because it puts everything into the first partition.
    
    Emit a warning if someone tries to do this to try to prevent user
    error:
    
      virt-builder: warning: output device (/dev/sdb1) is a partition.  If you
      are writing to a USB key or external drive then you probably need to write
      to the whole device, not to a partition.  If this warning is wrong then you
      can disable it with --no-warn-if-partition

commit df7a33768eab2381b958ede2c8a40bc9cbc87928
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 2 15:10:04 2016 +0100

    mllib: Add Common_utils.is_partition function.
    
    Returns true if the device is a host partition.
    
    The only tedious bit of this patch is that now Common_utils depends on
    Dev_t so we have to add extra objects every time something links with
    Common_utils.

commit dd2ce98d242c0598a3bd484110f8cb0f9e88ec54
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 2 14:50:44 2016 +0100

    mllib: Add bindings for makedev(3), major(3) and minor(3).

commit 6358633bf22d19c1bc9b9638dfff8e5ac50a37eb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 2 13:53:37 2016 +0100

    p2v: Add --verbose option to virt-p2v-make-{disk,kickstart}.
    
    For virt-p2v-make-kickstart this doesn't do very much.  But for
    virt-p2v-make-disk it enables verbose mode in virt-builder which is
    extremely useful for debugging problems.
    
    Thanks: Ming Xie.

commit 036a11f37927934132aab4fe01ed6f37c03fd805
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 1 12:04:16 2016 +0100

    p2v: Hide the spinner when it is not running (RHBZ#1341564).
    
    Thanks: keanli

commit 2b670734325d8db17ef502aea090aa9f751b686a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 1 11:18:05 2016 +0100

    p2v: Add missing ethtool dependency.
    
    virt-p2v runs `ethtool --identify' command, but since the command was
    not included in the ISO the command always failed.
    
    Thanks: Ming Xie.

commit 603f4f1c230a459462e4fddb0ab7a766ae2f6199
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue May 31 12:03:44 2016 +0200

    p2v: require a non-interative sudo (RHBZ#1340809)
    
    Run sudo with -n (non-interactive), so it will fail right away when not
    configured to not require a password.  This will avoid the connection to
    time out.

commit 3e437d1671ee5b1043b64b8567c4075d8a4b38f7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 28 22:47:14 2016 +0100

    p2v: Rebuild the virt-p2v disk image if dependencies.m4 changes.
    
    Fixes commit f8cfdf274fdbf165036ad90cbe8f96df9757f182.

commit d3b2a5bbd2491808148b10dba966d1e898078bf8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 28 22:45:41 2016 +0100

    p2v: Add xterm to the virt-p2v ISO.
    
    You can run `xterm -display :0' at the virtual console in order to get
    a shell in the graphical environment.
    
    This is useful for debugging and doesn't have much overhead unlike
    other terminals.

commit af4502c95f8d62f8e81ae381d08a0ae2ce2cd1fb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 28 15:54:07 2016 +0100

    p2v: Preserve and display the full version of p2v and v2v.
    
    Fetch the full version from the remote virt-v2v, including the
    --with-extra field, since that tells us which distro virt-v2v was
    compiled for which is useful information.
    
    Display this information in all debug output and dialogs.

commit adef54ad1a558726e55e53671ec51441449739dc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 28 15:53:56 2016 +0100

    p2v: Translate comments in About dialog.
    
    Also make the translatable string more accurate.

commit ffc53c318ec0b04e97f29351edb45897e4f722fc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 28 15:26:27 2016 +0100

    p2v: More internal documentation.

commit 3c3472f3e54b497b5a8bc9f63731e86864250cc6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 28 15:09:31 2016 +0100

    p2v: Add Ming Xie (from QA team) to authors page.

commit c20b06dc0804b3978431280c7064931eb49b0ea5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 28 14:34:58 2016 +0100

    p2v/gui.c: Add internal documentation.
    
    No functional change.

commit a90343f1e9daf2d4cc8dd34a80521bc1e1b0eddd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 27 13:18:47 2016 +0100

    p2v: Fix alignment issues in treeviews on right of conversion dialog (RHBZ#1340407).
    
    Multiple cell alignment issues in the treeviews on the right of the
    conversion dialog.  This particularly showed up when you had multiple
    heterogeneous disks or network cards because the description cells did
    not align nicely.
    
    Thanks: Ming Xie.

commit 4bbdb858226eeb35aef7bd7eecdf47ca246bbda7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 27 13:05:32 2016 +0100

    p2v: Update 'make run-virt-p2v' rule.
    
    Use KVM, fallback to TCG.
    
    Add more network devices so we can test the layout of that
    dialog box.
    
    Move the documentation into guestfs-hacking(1).
    
    Updates commit f8cfdf274fdbf165036ad90cbe8f96df9757f182.

commit cb803ef37e4b996b007d242481e32ab1b6b73104
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 27 09:53:54 2016 +0100

    Version 1.33.32.

commit f8cfdf274fdbf165036ad90cbe8f96df9757f182
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 26 15:21:10 2016 +0100

    p2v: Add a 'make run-virt-p2v' rule which boots virt-p2v in a VM.
    
    A convenience method instead of having to work out the right
    qemu command line each time.

commit 25ffcc7d436cd8f6bcf29d8bde5efd4b8823d6cc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 26 16:28:07 2016 +0100

    p2v: Disable SELinux in virt-p2v-make-disk.
    
    The kickstart version of virt-p2v has SELinux disabled, so this is at
    least consistent.  Mainly it avoids the very long relabel when the
    disk boots first time.

commit 10b3065b8911d2f5cf070db29b921f701315b690
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 26 14:14:57 2016 +0100

    p2v: Consolidate EXTRA_DIST and CLEANFILES into single lists.
    
    No functional change.

commit 0e1f12f2e18cbd221bd9ba90d2834e153cdaa171
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu May 26 17:38:03 2016 +0200

    osinfo: use guestfs_int_version_from_x_y to parse the os version
    
    Make use of the common version code, and avoid a separate regexp.

commit 03ce1a4e0cbe6a8d6ca8738333c728bef97bd65f
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu May 26 17:25:47 2016 +0200

    lib: qemu: use guestfs_int_version_from_x_y for qemu version parsing
    
    Make use of the common version code, and avoid a separate regexp.

commit 7023f20830a681ef36f8f99415fe41791555a3db
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 26 15:48:32 2016 +0100

    aarch64: launch: Only pass gic-version=host when KVM is likely to be enabled.
    
    See:
    https://bugzilla.redhat.com/show_bug.cgi?id=1339977

commit ea41945e883b96ca90adb431bc5972649899b244
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu May 26 13:38:39 2016 +0200

    customize: random_seed: avoid one file checking for existing files
    
    When the random-seed file is found, then avoid checking its existance
    again.

commit 0f4dfa828271ac269ece041ca66f7fa28bab4871
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu May 26 15:13:54 2016 +0200

    dib: pass envvars also to extra-data.d scripts
    
    Inject the variables passed via --envvars also when running extra-data.d
    scripts.  This removes the need to exporting them before running
    virt-dib.

commit 6cc640b55857f0940a4709aab11eb0ef3a131740
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 26 12:55:32 2016 +0100

    Version 1.33.31.

commit e516b85bd72986568690db0169516923297c6918
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 26 12:54:08 2016 +0100

    v2v: Add test-v2v-i-ova-subfolders test files to EXTRA_DIST.
    
    Fixes commit 9de9300e8b7a99fa06e290f20ef1aaa1eb6f7431.

commit 55e515010601a1063b1bf668e372db4026c37b73
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 26 11:36:05 2016 +0100

    todo: Use query-qmp-schema.

commit 0c49869366ceeb1053eb3b53051534a390c72ca3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 25 13:42:21 2016 +0100

    Revert "utils/boot-analysis: Make seabios optional in timeline."
    
    The loss of SeaBIOS messages was actually caused by a bug in my code,
    not a change in the boot process.
    
    This reverts commit 6fa24e768af9ddde83106b6bfe53c8d5ab2af861.

commit 6fa24e768af9ddde83106b6bfe53c8d5ab2af861
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 24 22:04:49 2016 +0100

    utils/boot-analysis: Make seabios optional in timeline.

commit 9928296c1ca8df5bd8f108ed00039adc6468cac3
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue May 24 18:49:53 2016 +0200

    inspect: get icon of ALT Linux guests
    
    The icon is part of a documentation package, although it's the best hit
    so far...

commit 77ad2e1f18cf724e46d36b8903c2c4f6a2f29506
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue May 24 18:14:38 2016 +0200

    customize: add support for the xbps package manager

commit 5d1dfe89cd7fc9abe6fb139bf0b72b9b71da335e
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue May 24 17:44:23 2016 +0200

    inspect: support the xbps package manager and its format
    
    Associate the Void Linux distribution with it.

commit 0251c0fcaa4fbb3b42968792996748136700c8d8
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue May 24 17:29:52 2016 +0200

    inspect: recognize the Void Linux distribution
    
    Since Void Linux provides only an /etc/os-release with no VERSION_ID
    field, then special-case it to avoid that the os-release parsing ignore
    it.
    
    This provides basic distro identification, and icon.

commit c0534db2cb6af75cecbd832e1c64327805124f29
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue May 24 15:09:17 2016 +0200

    inspect: allow single-number version in DISTRIB_RELEASE of lsb-release
    
    When parsing lsb-release, allow a version number in the format "X" other
    than "X.Y" for the DISTRIB_RELEASE key.
    
    This fixes version parsing in Mageia 4 guests.

commit c605765c95fa5f8a0994e6676bad967b0448767b
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon May 23 18:15:29 2016 +0200

    mllib: add a new run_command helper
    
    Add a simple helper to run a command from a sequence of arguments,
    without using a shell: this should help reducing the amount of quoting
    ineeded, since arguments are passed straight as such.
    
    Make use of it in the places currently using shell_command, and which
    don't assume they can run anything (so no shell redirections, `env`,
    etc).

commit d58b2437e46a69dbd40015945e3bf5ba7205314a
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon May 23 18:04:09 2016 +0200

    mllib: move stringify_args from dib
    
    Move the make_dib_args helper function to Common_utils as
    stringify_args, so it can be used also within Common_utils itself.
    
    This is mostly code motion.

commit f06b7dbe4566cbcf097bbe5776e6a79bc71bcc74
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon May 23 15:07:25 2016 +0200

    v2v: use common debug function where possible
    
    Followup of commit 063af7f987e2c010fbcf3535f3b278b7397c7089.

commit a52ee88f883ca462154fd14adbd19c60250ba49c
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon May 23 14:24:21 2016 +0200

    mllib: add an helper shell_command
    
    Add a simple shell_command, which is mostly a wrapper around
    Sys.command but with logging of the command run.

commit 3dad36dab27403c047d9e30b62d4fed2807fcbd3
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon May 23 13:23:00 2016 +0200

    mllib: make external_command echo the command executed
    
    Add an optional parameter to disable this behaviour, so the Curl module
    in v2v won't print user-sensible data (like passwords).

commit 9de9300e8b7a99fa06e290f20ef1aaa1eb6f7431
Author: Cédric Bosdonnat <cbosdonnat@suse.com>
Date:   Mon May 23 15:31:46 2016 +0200

    v2v: handle subfolders in ova files
    
    Some ova files like those produced by SUSE Studio have their ovf, mf
    and other files inside a folder rather than at the root of the
    tarball. Consider the paths relative to the ovf and mf files to cover
    this case too.

commit c466d4cb928fcfea37908cc66c90ac8430d6d4c6
Author: Cédric Bosdonnat <cbosdonnat@suse.com>
Date:   Mon May 23 15:31:45 2016 +0200

    v2v: add support for SUSE VMDP drivers
    
    To add this support, two things are needed:
     * make the existing code searches for either the viostor
       or the SUSE VMDP (Virtual Machine Driver Pack) files.
    
     * add a firstboot script setting up VMDP.
    
    Note that 2 firstboot scripts are intentionally added for the VMDP
    setup. This is due to windows potentially rebooting after loading the
    virtio block driver. It may happen that this reboot interrupts the VMDP
    setup in the firstboot script, we thus make sure the setup is run a
    second time in case it needs to finish the previous run.

commit 07f7bfa608b19d5401791be1e4f2493005ed9fdc
Author: Cédric Bosdonnat <cbosdonnat@suse.com>
Date:   Mon May 23 15:31:44 2016 +0200

    customize: fix windows firstboot script
    
    Sync the windows firstboot script with its linux brother. Also change
    the main redirection to append to the log rather than overwriting it.
    With this change, the firstboot script will resist reboots in the
    executed scripts.

commit 0a4aac0d086cca238f92c67c1efbe88fea0bd78c
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon May 23 18:19:34 2016 +0200

    appliance: add kpartx to the dib packages
    
    Newer diskimage-builder versions run kpartx in root.d elements.

commit 50e1ae5aa00c07abd8929a3487ff2acd605674c3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 23 12:02:52 2016 +0100

    Version 1.33.30.

commit d5cd752e25ee6199d518d27883cfac25046e7ac9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 23 12:00:28 2016 +0100

    v2v: Fix unit tests for new UEFI paths.
    
    Fixes commit f755918fb5b11364bc56c130fcc6a529943b5bcd.

commit 063af7f987e2c010fbcf3535f3b278b7397c7089
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 21 15:53:31 2016 +0100

    ocaml tools: Use a common debug function.
    
    Add a common debug function for printing debugging messages.  It only
    emits the debug message when the verbose (-v) flag is used on the
    command line.
    
    It sends the output to stderr, which is flushed immediately after the
    message is printed (to help with debugging unexpected crashes).  There
    are good arguments for sending the debug to either stdout or stderr,
    and almost all existing debug messages replaced by this change went to
    stdout.  However using stderr is consistent with libguestfs's own
    debug messages which also go to stderr.
    
    I only made simple changes to code of the form 'if verbose () then
    printf ...'.  There are more places which could be changed in future.
    In a few places I removed gettext calls since we probably should not
    translate debug messages.

commit 87c18474b5f7a5e66bb75bf9af0740e7825ca6b8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun May 22 20:40:06 2016 +0100

    customize: Turn print into warning.
    
    It is still only emitted if we are debugging in order not to cause
    unnecessary alarm.  Note this code needs a better long term fix, this
    is still a hack.

commit 1f09537a9c0366648655b51231bf649b032098f1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 23 10:29:45 2016 +0100

    umask: Use /proc/self/status instead of unnecessary path computation.
    
    Fixes commit 2feeeb8fb4aa1102e46308bdfbd6fef31761d073.
    
    Thanks: Roman Kagan.

commit f755918fb5b11364bc56c130fcc6a529943b5bcd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun May 22 21:29:49 2016 +0100

    uefi: Add new locations for UEFI files on Fedora (RHBZ#1338083).
    
    Now that UEFI is fully open source the UEFI firmware can be included
    in Fedora.  However the location is slightly different from the
    location that was used by kraxel's out of distro firmware.  This
    commit searches for UEFI files in the new location, falling back to
    the old location (until the end of this year when we will drop it
    entirely).
    
    Thanks: Cole Robinson, Gerd Hoffmann (kraxel) & Microsoft for
    relicensing the FAT code.

commit 1d79964bf7210807abca541dc36e39d121990fa1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun May 22 21:21:46 2016 +0100

    utils: Move UEFI firmware lists to src/uefi.c.
    
    Just code motion, no functional change.

commit 607b2b9b0ce0ca65fc34e6d149ba0f9910219d7f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 21 15:43:59 2016 +0100

    v2v: Remove unused and unimplemented Linux.install function.
    
    This function did 'assert false' and was also never called
    from anywhere else.  Delete it.

commit 2feeeb8fb4aa1102e46308bdfbd6fef31761d073
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 21 13:07:55 2016 +0100

    umask: Use /proc/<PID>/status to read umask in Linux >= 4.7.
    
    Since Linux 4.7, the process umask is available in /proc/<pid>/status.
    See:
    https://github.com/torvalds/linux/commit/3e42979e65dace1f9268dd5440e5ab096b8dee59
    
    Use this value if available, else fall back to the existing codepath
    for Linux <= 4.6 and other Unix.

commit 7855f15ad93fd18221cdd9fde5ac37d75fcaf75a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 21 15:36:56 2016 +0100

    v2v: windows: Minor documentation fixes.
    
    Fixes commit 19f3689e5dcd06a0967ba88b5516a7ce70203576
    and commit ee0219148352695ddf1102a426dcfe4e3be55fba.

commit a11dd820c7339ecd70b2ae2bce2fc347a87cf78b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 20 21:03:49 2016 +0100

    src/version.c: Move internal documentation before includes.
    
    The internal documentation generator only works if the file
    description comment appears before the first #include line.
    
    Fixes commit f277087d2a86104b10923e919d36834ed7c49e19.

commit 23ebc3d9ebe2754f0e77f2d6211e041323cd3990
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri May 20 13:11:33 2016 +0200

    tests: disable UUID change on ext journal_dev
    
    Newer versions of e2fsprogs refuse modifying journal devices, causing
    the test #1 of get_e2uuid to fail with:
    
      libguestfs: error: set_e2uuid: Cannot modify a journal device.
    
    Since the test case just needs to verify get_e2uuid runs without
    failing, run it without expecting a certain UUID set earlier.
    
    Followup of commit da4812ab6b44c29cb3cf181c7aa896420ecb8aa6.

commit ff0a622a6f049bb95759457a39da53779f38ef83
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri May 20 13:17:15 2016 +0200

    tests: fix --format in virt-customize
    
    Only in very recent OCaml versions (or in Fedora) the Arg module
    supports the --foo=bar syntax for options with arguments.  Do not
    require it yet.
    
    Fixes commit 64bb9edd527c9c7082721891cb7f090484858ab3.

commit 536ef6f34a81eae75d09b7641c063d8318e228db
Author: Cédric Bosdonnat <cbosdonnat@suse.com>
Date:   Wed May 18 14:00:52 2016 +0200

    customize: change windows firstboot path
    
    Rename the C:\Program Files\Red Hat\Firstboot folder into the more vendor
    independent C:\Program Files\Guestfs\Firstboot.

commit 75fe93ea74938d4a6c6b81f7cce3f19b7ffa894d
Author: Cédric Bosdonnat <cbosdonnat@suse.com>
Date:   Wed May 18 14:00:59 2016 +0200

    v2v: improve initrd search
    
    To make sure we can also find the initrd on openSUSE and SLES, we need two improvements:
     * the initrd filename may not end with '.img'
     * don't use the version + release from the RPM data, rather from the
       /lib/modules/<version>/ path as we need to find it out anyway.

commit e9082ea4d97bda2b69f5553b098275e462144ad2
Author: Cédric Bosdonnat <cbosdonnat@suse.com>
Date:   Wed May 18 14:00:58 2016 +0200

    v2v: rename RHEL 5 Xen input section into Xen in man
    
    In virt-v2v man page the documentation on how to use RHEL 5 Xen as
    input is generic enough to fit other Xen versions.

commit 25848b59e593f343e10ed85e5abf03b78a3070ff
Author: Cédric Bosdonnat <cbosdonnat@suse.com>
Date:   Wed May 18 14:00:54 2016 +0200

    v2v: document SUSE's Xen as a working input hypervisor

commit ee78c06b7f0356e3ca9955669df691907b2c379e
Author: Cédric Bosdonnat <cbosdonnat@suse.com>
Date:   Wed May 18 14:00:53 2016 +0200

    customize: add support for pvvxsvc
    
    SUSE VMDP comes with a replacement for rhsrvany.exe named pvvxsvc.exe.
    Check for either one of them instead of only rhsrvany.

commit 1c9e808eee88a685d8f13ee1fa9dc45a53833f49
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu May 19 18:52:42 2016 +0200

    fish: generate test-prep.sh with generator
    
    Generate test-prep.sh using the generator, so the prepared disk types
    tested are the same as the ones configured in prepopts.ml.

commit d5b3f558e0348ad4ecd653fc6b654ed46ac878e1
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu May 19 18:12:21 2016 +0200

    tests: remove remaining relative paths to binaries
    
    Tests are run via the ./run binary, so all the binaries in the build
    directory are available via $PATH already.
    
    Followup of commit e85a976c5a474d751c6e8352370047a3177a7c45.

commit 64bb9edd527c9c7082721891cb7f090484858ab3
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu May 19 17:52:32 2016 +0200

    tests: specify the image format when possible
    
    When possible, make the disk image format explicit when invoking tools
    or using add-drive. This avoids warnings from qemu about the unspecified
    format for the image, and also makes qemu slightly faster (skipping the
    disk image probing).
    Tests checking the image probing are not touched.
    
    This changes also:
    - old-style invocations of tools (`$tool $filename`) into new style
      (`$tool -a $filename`)
    - add-drive-ro/add-drive-with-if guestfish commands into add/add-drive
      with explicit readonly/iface arguments
    
    There should be no change in the tests results.

commit b5c81b3e1212d9a6d4993ccf7e54e2e5d39606bc
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu May 19 17:14:52 2016 +0200

    customize: fix ownership when creating ~/.ssh/authorized_keys (RHBZ#1337561)
    
    When creating ~/.ssh and ~/.ssh/authorized_keys (in case they are
    missing), change their ownership to the target user.  If not, they are
    owned by root.

commit 59690dfc0429e4c349d4022a9a6739566c5e2c0d
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu May 19 17:07:48 2016 +0200

    customize: minor function factoring in ssh_key
    
    Turn the snippet reading user information from /etc/passwd in a slightly
    more generic function, so there is no need to copy&paste for other
    details.
    
    Mostly code motion.

commit 89ae53ecddf3491a6bb73119bd997a22423081ab
Author: Cédric Bosdonnat <cbosdonnat@suse.com>
Date:   Wed May 18 14:00:57 2016 +0200

    appliance: skip /etc/mtab creation is already existing
    
    At least on openSUSE and SLES, the /etc/mtab file is already existing.
    Skipping the symlink creation in init removes one error message during
    the appliance boot.

commit 3bf7d307b6f226163ea798e80d87931ff9beac61
Author: Cédric Bosdonnat <cbosdonnat@suse.com>
Date:   Wed May 18 14:00:50 2016 +0200

    Update packagelist for SLES and openSUSE
    
    SUSE Linux Entreprise Server doesn't have dhcpcd and the hivex package
    is not in the default repositories. Better use dhcp-client and
    libhivex0.
    
    openSUSE needs ntfs-3g and ntfsprogs packages.

commit bba9ea9d5056122c3a3348c76694a7aa9f3fa64e
Author: Cédric Bosdonnat <cbosdonnat@suse.com>
Date:   Wed May 18 14:00:49 2016 +0200

    v2v: also search for windows virtio drivers in symlinks
    
    To allow saving space in the package shipping the windows virtio
    drivers, we can use symlinks between the drivers folders. For example
    SUSE VMDP drivers are the same for Win8.1 and Win2012r2, one folder
    is a symlink to the other.
    
    To take advantages of this, find must use the -L flag.

commit 54629d3d34da770628c65731454843b6ef585ee9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 19 13:21:33 2016 +0100

    p2v: Run udevadm settle when virt-p2v starts up.

commit 1817d9a96624b65a2cd19d0b61660203b269d4d9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 12 20:48:48 2016 +0100

    lib: qemu: Memoize qemu feature detection.
    
    qemu feature detection takes about 95ms on my laptop.  The overhead is
    almost all due to the time taken by the glibc link loader opening the
    170+ libraries that qemu is linked to (×2 because we need to run qemu
    twice).
    
    Fixing that is seriously hard work.
    
    Therefore memoize the results of guestfs_int_test_qemu.
    
    This is keyed on the size and mtime of the qemu binary, so if the user
    changes the qemu binary (eg. setting LIBGUESTFS_HV) we discard the
    memoized result and rerun the qemu commands.  There is also a
    generation number so we can bump the generation in future versions of
    libguestfs to invalidate all previously cached data.
    
    The memo is stored in the supermin cache directory (eg. /var/tmp/.guestfs-*)
    in the files:
    
      qemu.stat     Result of 'stat(2)' of the qemu binary
      qemu.help     qemu -help output
      qemu.devices  qemu -devices ? output
    
    Note these files are only stored when using the 'direct' backend.  For
    the libvirt backend, libvirt itself memoizes this data in its own
    place.

commit 4e36f2fa9ea048b33b738d7d2ed7c418d7d221bb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 12 19:01:46 2016 +0100

    lib: Move qemu testing code to a new module called 'qemu.c'.
    
    This is code motion, but I have cleaned up and formalized the
    interface between this module and other parts of the library.
    
    Also this adds documentation to the interface.

commit 166ac594cc88302597856e21f1644c8de9c3a788
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 18 18:06:51 2016 +0100

    launch: direct: Capture and display maxrss of qemu subprocess.
    
    The maxrss is described in getrusage(2) as "This is the maximum
    resident set size used (in kilobytes).".  This lets us find out how
    much memory qemu really used, and is useful for determining if memory
    minimization techniques such as DAX are having any effect.

commit 9b305eae2904b5c44fb1907b4e464b1e2bf0e62e
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed May 18 17:25:28 2016 +0200

    drives: force format=raw for /dev/null dummy drives
    
    When creating the dummy scratch disk for a /dev/null drive, force its
    format as raw if it was not specified already.  After all, raw was
    already the only format allowed for this kind of drives, so it makes
    sense to specify the format explicitly and avoid the autodetection in
    qemu.

commit 3fb35e66272ab675bb335a7ae1b6c0299b96bd18
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue May 17 15:24:27 2016 +0200

    inspect: switch to version struct for os major/minor version
    
    Use the version struct in inspect_fs to hold the version of a
    filesystem, adapting the inspection code to that.
    
    Also, move the parts of the version parsing to helper functions of the
    version struct, so common bits like parsing "X.Y" or "X" version strings
    is done only once.

commit f277087d2a86104b10923e919d36834ed7c49e19
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon May 16 16:59:43 2016 +0200

    src: start unifying version handling
    
    Introduce a new struct version with few helper functions for it: this
    allows to "atomically" represent a version number, without different
    variables to be used and checked together.
    
    Add a initialization function from a libvirt-style version number, and
    apply it for the qemu and libvirt versions in the direct and libvirt
    backends.

commit d6ec6e06d2d405dc67c39287df6814b34d24cd01
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 17 21:31:44 2016 +0100

    Version 1.33.29.

commit 613fe4c089d132d63edddf1ccb53c082c20aded3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 17 15:34:42 2016 +0100

    utils: boot-analysis: Make insmod message handling a bit more robust.

commit 8a4dcde16accef1a2e1a1bc5a71146295ed6a214
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 17 13:20:14 2016 +0100

    appliance: Find udevd a bit faster.
    
    Rearrange the paths that we check for udevd so that the systemd paths
    are first.  Break from the loop as soon as we find udevd.

commit db1f811b29b055625ae1b03cf0daa9fed0d443ac
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 16 22:29:58 2016 +0100

    appliance: Reenable ACPI.
    
    Previously I disabled ACPI because it was not necessary and was slow.
    However measuring it again now, I can see no significant difference in
    performance, and it is necessary if we are going to use DAX.
    
    It's also useful to keep the appliance kernel state as similar to the
    ordinary state, and setting acpi=off is a massive change to the way
    that the kernel boots.
    
    Therefore, reenable it.

commit aec89b62becc513f35c9f136f89833a8a38d3315
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 12 21:25:28 2016 +0100

    appliance: Move code for creating supermin appliance directory to tmpdirs.c.
    
    This is largely code motion.

commit 2c474923b41d26ca42475197b6fbdd414f39d3ad
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 12 21:17:12 2016 +0100

    src/tmpdirs.c: Add internal documentation.

commit bb9893ab5117fd0d8cc5d1be8639af4872ebe92c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 16 18:22:07 2016 +0100

    launch: direct: Simplify -machine parameter.
    
    Use the ADD_CMDLINE_PRINTF to simplify this code.  No functional
    change.

commit 214ec3dee7df80a9acc0892ebfcc7bf8c188a827
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 16 18:16:30 2016 +0100

    launch: direct: Break some long source code lines.
    
    Just cosmetic, no functional change.

commit 839ae5bcd537b3dc4f13bbea6fe40091ebc2b7f0
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon May 16 14:23:07 2016 +0200

    btrfs_filesystem_show: work with btrfs < 4.3.1
    
    Versions older than 4.3.1 output also the version string after the
    output.  Ignore such line, since it isn't relevant to what
    btrfs_filesystem_show needs.

commit 653e374ef6a5fda3e6575166e159d5727b9248fa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 16 07:22:20 2016 -0400

    inspection: Unquote UUID=.. or LABEL=.. before passing to findfs (RHBZ#1335671).
    
    In /etc/fstab the UUID= or LABEL= field may be quoted.  Augeas returns
    the field including the quotes, and we passed this directly to
    guestfs_findfs_uuid or guestfs_findfs_label.  It happens that this
    works on upstream findfs, although it doesn't work in RHEL 7.2.  The
    correct thing to do is to remove the quotes before passing the UUID or
    label to these functions.
    
    Thanks: Thom Carlin for reporting the bug, Karel Zak for identifying
    the change in behaviour in util-linux.

commit e13334a1a2a934ad9dd4fc9500491b0dba3cd687
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 16 07:19:49 2016 -0400

    v2v: Move the shell_unquote function to src/utils.c.
    
    This function is useful outside virt-v2v so move it into the core
    utilities library.
    
    The function has been rewritten from OCaml into C, but it should be
    functionally identical.

commit 12fb49c5ddb57eb9ee0ca76ba15a32cb5a2d8570
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 16 07:19:22 2016 -0400

    build: Fix missing +=.
    
    noinst_DATA is defined earlier in the Makefile.am, so we must
    use the += operator to append to the previous value.

commit 1b35d1d2255805d624a7fe512c44a3380e8e790d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 14 23:41:59 2016 +0100

    mllib: Update documentation for qemu_input_filename.
    
    Don't describe internally how the function works in the
    public interface documentation, since that is misleading.

commit 1f4a0bd90df35df56eb86c2386d801b51828cb22
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 14 19:22:49 2016 +0100

    utils: boot-analysis: Avoid overflow when comparing large doubles.

commit bf80587367d5f01e493426bbb2cda6099a15e7ab
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 14 18:45:25 2016 +0100

    utils: boot-analysis: Add magic & asserts to some structs.
    
    I suspected data corruption (but didn't prove it).  This commit just
    adds some magic numbers to the structs so we will see data corruption
    quickly if it happens again.

commit 12d8decfa9f9b684d49b59aa66f1c3b7d19538ab
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 12 15:48:22 2016 +0100

    launch: Use tsc=reliable.
    
    This saves about 21ms per secondary CPU when using guestfs_set_smp.

commit b6f5a0cd90c356ab1d7e519c0e24e66bfe33cfcc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 10 21:53:59 2016 +0100

    utils: boot-analysis: Make handling of first kernel message more flexible.
    
    Allows us to disable EDD completely, and still have boot-analysis work.

commit 634f47e6d4f1cf7ce343789d8b6257d89001f74f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 12 16:51:53 2016 +0100

    appliance: Copy /etc/ld.so.cache from the host into the appliance.
    
    Previously we were running ldconfig to create /etc/ld.so.cache.
    
    This is required, at least on Fedora, if we need to run any binary
    that uses a library with a weird path.  libiscsi (a dependency of
    qemu-img, used by virt-dib) is an example of such a weird library,
    since it puts its single library into /usr/lib64/iscsi for no readily
    understandable reason, and drops a configuration file into
    /etc/ld.so.conf.d/ so that this new directory gets picked up.
    
    By copying the /etc/ld.so.cache from the host we get an already
    configured cache which should contain every library on the host, so
    there is no need to run ldconfig.

commit ba8e8d277daba14ea8e33faee7dfb6ddb613bb07
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 12 16:24:10 2016 +0100

    Revert "appliance: init: run ldconfig"
    
    Running ldconfig adds about 100ms to the boot time.  I would prefer
    that we understood which libraries need ldconfig to be run, and fix
    that.  We could also consider running ldconfig in parallel, but since
    it might be required by just about any binary that the init script
    runs it's not clear what benefit that gives.
    
    This reverts commit 66aa98265dd215dcd4c717e7ef6845fbac859e54.

commit e3d429d37d882d06f25991ea0076d0c3bef44e80
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu May 12 17:14:11 2016 +0200

    New API: btrfs-filesystem-show (RHBZ#1164765)
    
    Add a new API to list all the devices where a btrfs filesystem is
    spanned.

commit ddcd9c2a10b58888e291bb16c3e3ac2b3a5a36ad
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue May 10 15:11:53 2016 +0200

    builder: run/schedule a SELinux relabel if needed
    
    If the guest uses SELinux, then make sure to run a relabel (or at least
    schedule one) after the image build: this way the template is
    relabelled, or at least it will do that at the next boot, without the
    need for the user to ask for a relabel.
    
    This just covers the case of building a new image with no additional
    operations on it though.

commit 754b8f5ef391ec4ee1b39db66b4923f9a8aa5cd9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 10 12:17:28 2016 +0100

    boot-analysis: Flush out debug data after printing it.
    
    Just makes it easier to see bugs causing the analysis stage to
    hang / infinite loop.

commit e4edede3641f3c8d3ac729c1a6c871f532b2b996
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 10 12:16:36 2016 +0100

    boot-analysis: Make ftrace optional in the timeline.
    
    This allows me to test minimal kernels with ftrace disabled at
    compile time.

commit 320b0faeaf67d80bccf8f81b9ebfcbcb68516fa1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 9 12:19:16 2016 +0100

    utils: boot-analysis: Fix minor typo in string.

commit a608865caca473d3be5f894792d323e639bbed21
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 9 10:10:36 2016 +0100

    Version 1.33.28.

commit 999df471603098a2f1d1d45f698c40757d08f142
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 9 09:14:25 2016 +0100

    src/utils.c: Update comment.

commit 873560f495478e20e13f73532bf3426cde0d517c
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri May 6 11:40:08 2016 +0200

    perl: use INT2PTR macro for casting back to guestfs_h * (RHBZ#1150298)
    
    Use the right macro, which should avoid the warnings seen with Perl
    headers on some architecture.

commit ea71e00d1a8d39d370406832da79b4111f021b72
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun May 8 20:48:58 2016 +0100

    fish: Add internal documentation to several files.

commit 13017c852ecea15ec24dca50f2c2d2ad889b5111
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 7 12:44:39 2016 +0100

    lib: Rename test-utils -> unit-tests.

commit 4910a448f43677ffc8fea3fb5397b8018abb6871
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 7 09:20:55 2016 +0100

    lib: Add more unit tests.
    
    Add unit tests for the following internal functions:
    
     - guestfs_int_getumask
     - guestfs_int_new_command and other src/command.c functions
     - guestfs_int_qemu_escape_param
     - guestfs_int_timeval_diff
     - guestfs_int_match, match1, match2
     - guestfs_int_add_string and other src/stringsbuf.c functions
    
    Because we now need to use a libguestfs handle, we have to link the
    unit tests to the library.  But because we also need to access the
    internal functions (to test them) we need to link the test statically
    to the objects making up the library.  So this requires a small change
    to the linking of this test too.

commit c3ff4da0883329f47e9bca992d57bec91d84137f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 7 12:40:44 2016 +0100

    src/stringsbuf.c: Add internal documentation.

commit 479828ccd0e592e4f7600203eb5c72748a57ac93
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 7 07:47:25 2016 +0100

    src/test-utils.c: Add internal documentation.

commit 0ff9b808d9ee1028efc461e5b1138518d510f89b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 7 07:44:47 2016 +0100

    src/conn-socket.c: Add internal documentation.

commit b4f440e65a30559d8f71b4ed03ab88d82f6ca222
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 7 07:38:24 2016 +0100

    src/whole-file.c: Add internal documentation.

commit cad516cae56cd7ec64d7fa33aafbc40f38130b1d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 5 22:54:34 2016 +0100

    src/command.c: Add documentation markup.

commit 3965c9f56ead6bfacb4c81601fb91b33da2261bb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 5 22:35:45 2016 +0100

    lib: Turn qemu_escape_param into a shared function.
    
    This function appeared twice (identically).  Turn it into a single
    shared function.
    
    This also adds some documentation for the two files affected.

commit f3c278474db0eb7648901094eee7b838d141e018
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu May 5 17:53:31 2016 +0200

    inspect: check also /etc/hosts for detecting Linux root (RHBZ#1203898)
    
    Use /etc/hosts as alternative of /etc/fstab to detect whether a partition
    represents the root of a Linux installation; the latter might not exist
    in smaller/special installations like Docker images.

commit 48116cfb4ef325bf89b1a3b497f5b11580daea8e
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu May 5 16:09:35 2016 +0200

    python: use constants instead of raw values
    
    Extend the internal libguestfsmod module with the CREATE values, so
    there is no need to hardcode values in GuestFS.__init__.

commit dc02e8985f75fef3142c50f0ef352d9087ba4248
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu May 5 14:25:28 2016 +0200

    tools: improve reporting for option errors (RHBZ#1316041)
    
    Improve the error messages produced by C-based tools in case of issues
    with the command line options:
    - explicitly mention to use -a/-d (and -A/-D in virt-diff)
    - when extra arguments are found, mention the correct way to pass
      options to certain command line switches (like --format)
    - in virt-inspector, give a cleaner error message when neither -i nor
      any -m is specified
    
    In all the cases, keep the extra notice to use 'TOOL --help' to get more
    help with it.

commit cd689c9d3a467362025e1027ca58f4475bdbdd68
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 4 18:20:20 2016 +0100

    Version 1.33.27.

commit ff7e755f954d1385d0d352d38f5d34c0e426972e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 4 18:16:26 2016 +0100

    utils: Add README to EXTRA_DIST.
    
    Updates commit 3b581a727c9e906f9d9b10e2f73ed853ab324fd0
    and commit bbec1b570b8b1edff7f2a39b0b86d625445dbaf2.

commit 43358290b340349340deaaca40d07dc4cfb35540
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed May 4 15:54:22 2016 +0200

    python: PEP 8: miscellaneous coding fixes
    
    python/guestfs.py:136:37: E712 comparison to True should be 'if cond is True:' or 'if cond:'
    python/t/tests_helper.py:42:8: E713 test for membership should be 'not in'
    
    No functional changes, as the new versions follow the suggested Python
    coding style to do the same things.

commit 060b724c490ac5fe12c53dbc008be0b844db222c
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed May 4 15:47:41 2016 +0200

    python: PEP 8: avoid whitespace-only lines in docstrings
    
    Tweak the docstring generation to avoid lines with only indentation
    spaces.
    
    No functional changes, only whitespaces removals.

commit 845d518b8b5f4d540de795ec93b4483591a786fd
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed May 4 15:18:21 2016 +0200

    python: PEP 8: miscellaneous indentation fixes
    
    Small fixes for few remaining indentation issues.
    
    No behaviour changes.

commit 6e34396661703b865c354e5fef2790960087c6d2
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed May 4 15:13:06 2016 +0200

    python: PEP 8: avoid too long lines
    
    Reindent Python scripts to make sure lines are not longer than 80
    columns.
    
    Regarding autogenerated code (guestfs.py and bindtests.py): add an
    helper function to make sure comma-separated lists are wrapped at the
    wanted length.
    
    This produces only differences in the indentation of long Python lines,
    with no behaviour changes.

commit d8337077e3312781da45b05c248e2028387f9643
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed May 4 13:22:10 2016 +0200

    python: PEP 8: break compound statements
    
    Avoid compound statements, simply indenting their blocks.
    
    No functional changes.

commit 2c7bba637464554ecc1342fc189d721c89e6e543
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed May 4 13:13:58 2016 +0200

    python: PEP 8: remove trailing semicolons
    
    Remove extra semicolons at the end of single-statement lines.
    
    No behaviour changes.

commit f85e18f62f8f9a6640029162bdd43cde9bd47a27
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed May 4 13:06:11 2016 +0200

    python: PEP 8: adapt empty lines
    
    Add or remove empty lines to match the needed ones around
    blocks/functions/etc.
    
    This is just formatting, no behaviour changes.

commit 6105ee0c71c51ba3a4c797ad88b405def641d947
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed May 4 12:38:44 2016 +0200

    python: PEP 8: adapt whitespaces in lines
    
    Add (after comma) or remove (before opening round bracket, and around
    '=' in arguments) whitespaces according to the PEP 8 specification.
    
    This is just code reformatting, with no behaviour changes; no content
    changed beside whitespaces, so "git diff -w" gives an empty diff.

commit 839a17ff041ccbd6a292ab72cce3d26ad7461050
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 4 16:41:15 2016 +0100

    docs: Document CVE-2015-8869 OCaml code gen bug.

commit 547662d9f6cea869d5edefd7e4612f070fa73143
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 4 13:57:53 2016 +0100

    customize: Improve the error messages when package manager is unknown or unsupported.
    
    For Windows, we now print:
    
    $ virt-customize -a ./test-data/phony-guests/windows.img --install MSSQL
    [   0.0] Examining the guest ...
    [  14.2] Setting a random seed
    virt-customize: warning: random seed could not be set for this type of
    guest
    [  14.2] Installing packages: MSSQL
    virt-customize: error: cannot use '--install' because no package manager
    has been detected for this guest OS.
    
    If this guest OS is a common one with ordinary package management then this
    may have been caused by a failure of libguestfs inspection.
    
    For OSes such as Windows that lack package management, this is not
    possible.  Try using one of the '--firstboot*' flags instead (described in
    the manual).

commit 5470f059c2e45342638a598ac3515013e05aba12
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 4 13:39:01 2016 +0100

    inspection: Set package manager to "unknown" if parsing major version failed (RHBZ#1332025).
    
    In cases where parsing the release file failed and so we have an
    obviously incorrect major version number, don't try to infer the
    package manager from the major version number.
    
    In the bug report, parsing the /etc/redhat-release file of a CentOS
    7.1 guest failed, so major version was set to 0, and the package
    manager was inferred as "up2date".  virt-customize then failed with a
    peculiar error:
    
      virt-customize: sorry, don't know how to use --install with the 'up2date' package manager
    
    Instead this sets it to "unknown" which will cause virt-customize to
    fail with:
    
      virt-customize: --install is not supported for this guest operating system
    
    which is (only very slightly) better.
    
    Problem reported by novegin on IRC.

commit d25e509317a8e06848678c15282dfa359755a6fd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 3 21:25:54 2016 +0100

    Tag versions with "v<VERSION>" instead of just the version number.
    
    This is the normal convention used for tagging git releases.

commit a2ac6b4897b332d8d8ba5295a17234583cffa5c1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 3 23:06:08 2016 +0100

    docs: Fix cross-references in guestfs-security(1).
    
    Fixes commit 15b8b6453dbeaca0283e68ff433191c8211d5f92.

commit c585a5835b0374273e0f58f788ebebec0dc2ae9e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 4 09:56:43 2016 +0100

    p2v: Fix misleading string in error message.

commit 28634ecc2c38914cc91137c53fba9ce6d3349a47
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 3 22:53:41 2016 +0100

    docs: Link to correct building instructions from guestfs-hacking(1).
    
    No longer in the README file.

commit d899a53f2e77174a7d93d4cfbe7b2958299f30a7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 3 22:46:08 2016 +0100

    docs: Improve the internal documentation in guestfs-hacking.
    
    Several mostly cosmetic changes.

commit a8114449fa58cb416d466be3f3a76dbe4214a215
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 3 21:50:35 2016 +0100

    docs: Move internal documentation to guestfs-hacking(1).
    
    All developer documentation should go in guestfs-hacking(1) and the
    "internal documentation" (ie. documentation about internal functions
    and interfaces) belongs here, not in the coincidentally synonymous
    guestfs-internals(1).

commit bbec1b570b8b1edff7f2a39b0b86d625445dbaf2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 3 21:47:11 2016 +0100

    utils: Add a README file describing briefly the purpose of this directory.
    
    .. and where to find the real documentation.
    
    Updates commit 3b581a727c9e906f9d9b10e2f73ed853ab324fd0.

commit 6b48977cb7100e4f214b189052d4f0bf61523d11
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 3 14:49:59 2016 +0100

    Version 1.33.26.

commit b1c945195cfac25786d31350b2a024deaf1610c9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 3 14:37:09 2016 +0100

    po: Use xgettext --from-code=utf-8
    
    Since moving boot-benchmark-range.pl out from under a tests/
    subdirectory, it is now being added to po/POTFILES.  This causes the
    following error:
    
    /usr/bin/xgettext: Non-ASCII string at utils/boot-benchmark/boot-benchmark-range.pl:205.
                       Please specify the source encoding through --from-code.
    
    Add --from-code parameter as instructed.

commit 5bbf8f655d2c49a3840a74cdc2c7ba299dd79055
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 3 14:13:01 2016 +0100

    Version 1.33.25.

commit ae3224cf8ab94c8d38457bfaa2e04f255c220336
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue May 3 13:54:20 2016 +0200

    customize: remove "core" from description of --update
    
    --update invokes a distribution update, updating all the installed
    packages and not just some "core" ones.

commit e77faf7f613375628393d0a907a709c317eadf44
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue May 3 13:20:13 2016 +0200

    mllib: add "internal" to the description of --{short,long}-options
    
    The Arg module of OCaml does not support hiding options from the --help
    output: hence, mark --short-options and --long-options as internal
    options, since we need them only for the bash completion scripts.

commit a3bc0e13f6f7b2fcfc54c3d4994968451fef7908
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 3 13:14:47 2016 +0100

    build: Don't use noinst_MANS.
    
    Automake doesn't run noinst_MANS rules at all, likely a bug.
    
    Use noinst_DATA instead which is always run during the build.

commit 98b28b15c61e871c3b3c5efdf4387e570133c4f9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 3 13:05:54 2016 +0100

    utils/boot-analysis, utils/boot-benchmark: Add manual pages.

commit 3b581a727c9e906f9d9b10e2f73ed853ab324fd0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 3 11:53:57 2016 +0100

    utils: Move tests/qemu/ boot-analysis etc tools to new utils top level directory.
    
    Create a new top level directory called 'utils' and move the
    following programs there:
    
      tests/qemu/boot-analysis -> utils/boot-analysis/
      tests/qemu/boot-benchmark -> utils/boot-benchmark/
      tests/qemu/qemu-boot -> utils/qemu-boot/
      tests/qemu/qemu-speed-test -> utils/qemu-speed-test/
    
    Also we only build the boot-analysis program on x86-64 and aarch64,
    since it requires custom porting to each architecture.

commit c34995c6b3a60c78aefd12ad73f6c453a127a8ad
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 30 12:49:00 2016 +0100

    launch: Add cryptomgr.notests to the appliance command line.
    
    Save 28ms by not running the crypto self-tests when Linux boots.

commit 1f5054daa8d578935c9d152db38abcc87027062a
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Sun Apr 24 15:05:02 2016 +0100

    php: Fix the tests yet again.
    
    Move unsetting of LIBGUESTFS_DEBUG & LIBGUESTFS_TRACE into the
    php-for-tests.sh wrapper.
    
    Fixes commit 0d69eab98f0bd5dd2d218ce5adcafdeb13f9d90d.

commit 915f6e299e885482cf248609d4ef39a6f30b98c9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 3 10:35:37 2016 +0100

    Revert "php: Fix the tests ... again."
    
    This reverts commit 0d69eab98f0bd5dd2d218ce5adcafdeb13f9d90d.

commit 4760d80c93d36184ce441c17b7573d4f5a398913
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue May 3 13:03:45 2016 +0200

    appliance: move btrfs-progs as common package
    
    Recently Debian switched to btrfs-progs, so almost all the distributions
    (except openSUSE) have btrfs-progs which is then moved as common
    package.
    The old btrfs-tools name is left there, to support Debian Jessie and
    older, and Ubuntu Xenial and older.

commit 51cea56d1ce6d6540cf0913a9b7e0c6ff97504db
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 30 17:20:39 2016 +0100

    Version 1.33.24.

commit 9cd00805b06528f99c9a986195cc46b787541d11
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 30 16:41:31 2016 +0100

    tests/qemu: boot-analysis: Display libvirt as distinct source.
    
    Don't display libvirt events as '[library]', but as '[libvirt]'.

commit 2fd05203e461445c8053116b4276beb81b4d95d8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 30 16:02:30 2016 +0100

    tests/qemu: boot-analysis: Dump pass data times in ms, with diffs.
    
    When (in --verbose mode) we dump the pass data, dump the times in
    milliseconds (instead of nanoseconds) so they are consistent with
    other output.  Also dump the time difference from the previous event.
    
    Useful for detailed debugging/analysis of problems.

commit 66447f4e2943c573a3c8f0573c9934e7f4597720
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 30 15:42:57 2016 +0100

    aarch64: Use AAVMF_CODE.verbose.fd when debugging is enabled.
    
    When we are debugging use the verbose (debug messages enabled) version
    of the AAVMF (UEFI) firmware.  This is useful for diagnosing what is
    causing failures to boot and what inside UEFI is causing slow booting.

commit f7381470bb7063a0898a2ec3639731d71c567980
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 30 15:24:17 2016 +0100

    v2v: Add unit tests of the Utils UEFI functions.

commit 5253d2367b924c06c4e4e73b5e5b9855f05c6186
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 30 15:16:04 2016 +0100

    utils: Use struct for UEFI firmware.
    
    Use an array of structs for the UEFI firmware instead of an array of
    strings.
    
    This change is hopefully just refactoring and there is no functional
    difference.

commit 03e2d000360ad4e496e8ce6c1b9b01086a2d2aac
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 30 12:48:42 2016 +0100

    appliance: Add pciutils to the appliance.
    
    This adds the 'lspci' program, useful for debugging
    appliance / qemu problems.

commit d76129aa0cca856994c1a65b55dc18d2a2049d34
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 28 22:37:04 2016 +0100

    launch: Don't initialize all UARTs (serial ports).
    
    This doesn't save very much time, perhaps under 1ms, but it avoids
    some useless scanning.

commit 2b9f58f87b0dc2553061b4d8b301ff8e08121cb7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 28 15:58:05 2016 +0100

    launch: libvirt: Add a /dev/urandom-based virtio-rng device to the appliance.
    
    It is safe to use /dev/urandom to seed the guest.  In libvirt 1.3.4
    this silly restriction has been lifted.
    
    This restores commit b2c845333f66d4d3135d3b6a8d4b992d6160bf0a.
    See also commit 9423c16607259b30985c46d04db9958ec079aa42.
    
    Thanks: Cole Robinson for doing the libvirt implementation.

commit e080e5909e736ef39488e29874e6ff474a2ebf83
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 28 15:57:10 2016 +0100

    launch: libvirt: Add libvirt version to the data struct.
    
    This commit just allows us to make XML features conditional on the
    libvirt version, but has no other functional change.

commit 29cb8d60d25f650b077e631269ee05c3e4441d75
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 28 14:12:23 2016 +0100

    launch: Disable USB in the appliance.
    
    Only saves a tiny amount of time, but as we don't use USB
    we might as well disable it.

commit 1beab198b95eac8121ce0bc73107e30f41d78267
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 27 16:37:57 2016 +0100

    ocaml: Add LDFLAGS to mlguestfs.cma/mlguestfs.cmxa.
    
    Encode the build LDFLAGS into the OCaml library.

commit b2464e07de7a4f21f6451fd40a810830b1adc9b0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 26 12:43:24 2016 +0100

    v2v: Add a slow test to ensure trimming doesn't regress (RHBZ#1264332).

commit 5ec42a62384f87a4de841d202e31d0337c64f5af
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 26 12:27:14 2016 +0100

    v2v: OVF: Better mapping for inspection data to vmtype.
    
    The old mapping code was directly copied from old virt-v2v, translated
    from Perl to OCaml.
    
    The new mapping code does a few things more accurately:
    
     - Use the i_product_variant field (Windows InstallationType) if available.
    
     - Simplify rules, so there is only one special case needed for RHEL 3/4.
    
     - Don't assume Fedora == Desktop.
    
     - Don't assume all later Windows variants are server.
    
     - Works for Windows > 7.

commit 3a6636fc05b7b91375c8fb2d755e8418f80b4d87
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 26 10:41:39 2016 +0100

    v2v: Remove the --vmtype option.
    
    It will now print a warning but is otherwise ignored:
    
      virt-v2v: warning: the --vmtype option has been removed and now does
      nothing
    
    See:
    
      https://www.redhat.com/archives/libguestfs/2016-April/msg00178.html

commit b81e8ef16258f0d2827beead025f78660195cb0a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 26 10:27:41 2016 +0100

    v2v: Remove --no-trim option.
    
    It will now print a warning but is otherwise ignored:
    
      virt-v2v: warning: the --no-trim option has been removed and now does
      nothing
    
    See:
    
      https://www.redhat.com/archives/libguestfs/2016-April/msg00178.html

commit d5c40262fa80cebcc48a73c04a22cf4a635dcb7b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 30 12:45:54 2016 +0100

    tests/qemu: boot-analysis: Port this program to aarch64 (using UEFI).

commit 606f1586064ed5b45b9d25dc9bf2e518dd910ba7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 28 13:33:51 2016 +0100

    tests/qemu: boot-analysis: Add analysis of initcalls before entering userspace.

commit 63915b69f10d4a555bff82eb25aca95a6e8833d9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Apr 24 19:20:56 2016 +0100

    Version 1.33.23.

commit 7f572434f0acc47b5091eb4fd12bd1936198bec8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Apr 24 19:00:03 2016 +0100

    tests: Add tests/qemu/boot-benchmark-range.pl to EXTRA_DIST.
    
    Updates commit 8299d7087a6457828a57ecace54c01b73912a9c7.

commit 90aacea2acf9c1b3bbaee098db47be8093d2f2e3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Apr 24 15:47:53 2016 +0100

    ja: Fix unclosed L<> which breaks POD.
    
    Since commit b23e1497747f1cdfdedfd0567e7748fdc3ae0684, we have been
    strict about POD errors.  An error in the Japanese translation caused
    "L</guestfish" (ie. an unclosed L<>) to appear in the POD.
    
    This commit fixes the problem, but when building you may need to do:
    
      rm po-docs/ja/guestfish.pod
      rm po-docs/podfiles; make -C po-docs update-po
    
    in order to update the broken po-docs/ja/guestfish.pod file.
    
    Unfortunately I have been unable to upload this change back to the
    Zanata servers because of a variety of client problems.

commit 314c5795b0f1a405c904d796d3f9135894dd2c26
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Apr 24 15:35:10 2016 +0100

    podwrapper: Remove output file on failure.
    
    Otherwise we end up generated a bad output file and (in some cases)
    continuing the build.
    
    Updates commit b23e1497747f1cdfdedfd0567e7748fdc3ae0684.

commit 0d69eab98f0bd5dd2d218ce5adcafdeb13f9d90d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Apr 24 15:05:02 2016 +0100

    php: Fix the tests ... again.
    
    PHP (5?) renamed the PHP_EXECUTABLE variable to TEST_PHP_EXECUTABLE.
    As a result of that if you enabled debugging, the tests broke because
    we no longer used our custom PHP wrapper to filter out debugging
    environment variables before running the tests, so debug output was
    mixed with the expected output.
    
    This commit also updates an old comment telling you how to debug PHP
    tests.

commit 672eff4a34a962293e3c3d6ac8b61d5abd28f747
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Apr 24 12:00:10 2016 +0100

    v2v: target_bus_assignment: Assign removables with slot pref first.

commit c1adbe61dfd23ba28e286e0ecaf97bba6de9cdcd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Apr 24 11:36:20 2016 +0100

    v2v: target_bus_assignment: Various refactorings.
    
    No functional change.

commit 6193b2b273f603bbe7b361d858e5b2fca0082ef6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Apr 24 11:33:28 2016 +0100

    v2v: Assert fail if we overwrite an existing disk in a bus slot.
    
    Prevents us from accidentally "losing" a disk during conversion.  I
    believe from code inspection that this assertion is always true for
    the current code, so this should have no effect.

commit 9e3182b4c5fc3abb55e0fe072c5fa3af1ffb0ee3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 23 18:15:19 2016 +0100

    v2v: Move target_bus_assignment to separate module.
    
    This is just code motion.

commit c42557f5e1c9c051cd61ff8162b5d7db5d31e837
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 23 18:15:19 2016 +0100

    v2v: Move inspect_source to separate module.
    
    It's a large feature / function with its own set of nested functions,
    so move the inspect_source function into its own module.  It also lets
    us specify and document the interface explicitly.
    
    Also: Define a root_choice type in Types module.  I turned it into a
    non-polymorphic variant type for extra type safety.
    
    This is just code motion.

commit 0eb8d673c1292decc1a4e8bd0aaa2cc259dd7349
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 23 18:02:31 2016 +0100

    v2v: List SOURCES_MLI in alphabetical order.
    
    Fixes commit 01ede002dbb9333358b336c9cb9c33afce1a19f8.

commit ac9c31eb680201f0b4e9f5e28e183de04677a3ad
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 23 14:26:58 2016 +0100

    v2v: Commenting and refactoring changes.
    
    - Add headings, further documentation to the Types module.
    
    - Move two type definitions in Types module.  Not a functional change.
    
    - Add more comments and clean up comments throughout v2v/v2v.ml.
    
    - Refactor guestcaps / conversion in v2v/v2v.ml.  Not a functional
      change, just hides local variables from the rest of the code.
    
    - In --in-place mode, change inspection message to 'Inspecting the
      source VM'.  This matches the later message 'Closing the source VM'.

commit 9304b70ff68127a7c37cf1fb7aaa57313cdd4c73
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 23 14:48:27 2016 +0100

    v2v: Move 'du' function to Utils module.
    
    Just code motion.

commit 8299d7087a6457828a57ecace54c01b73912a9c7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 22 16:32:24 2016 +0100

    tests: Add boot-benchmark-range script.
    
    Add a script we can use to benchmark performance across a range of
    commits in another project.

commit 45f84601b05aef0408b55011fb02579c147ca853
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 22 14:52:03 2016 +0100

    tests: boot analysis: Add text to describe how to change settings.

commit 874ef2a04f16e379ec954087206d339cfe45de60
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 22 16:37:40 2016 +0100

    docs: Fix use of getopt and pod2usage in make-internal-documentation.pl.
    
    Fixes commit 04229c68d60ce1437b6c1fbee95f23bc12d5cb55.

commit b23e1497747f1cdfdedfd0567e7748fdc3ae0684
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 22 09:03:48 2016 +0100

    podwrapper: Send errors to stderr and die if any errors seen.
    
    Enable a few POD options:
    
     - Don't generate an errata section in the output.
    
     - Send errors and warnings to stderr.
    
     - Die if any errors or warnings are seen while generating the outputs.

commit 71a4ffdd05f3df670c20a768fc8cd8cceb842643
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 21 13:41:52 2016 +0100

    builder: Add Ubuntu 16.04 (Xenial) image.

commit d585aca1d5ec6e44325d5ee338de130b5d7c693c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 21 13:41:00 2016 +0100

    builder: ubuntu: Lock the 'builder' account that we have to add to the template.

commit f56a46d0b5173ea810c62736877f9c5de246ef92
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 21 13:40:37 2016 +0100

    builder: ubuntu: Fix URL of archive.ubuntu.com.
    
    The archive.ubuntu.net address appears to work only intermittently.

commit a1e47c4b47262ade267eb2597f20710a143c67f3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 21 12:50:58 2016 +0100

    tools: Reduce use of _ (wildcard) in match statements.
    
    No functional change, just various improvements to the safety of match
    statements.

commit 234c4091b557d4eb3472c2eacde63341f447590d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 21 12:40:18 2016 +0100

    sparsify: Refactor handling of checks of copying mode / --in-place.
    
    Just refactoring, no change.

commit 906e2e0a96c4b818bdd5bab5a2b3912016ea1071
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 21 12:05:01 2016 +0100

    dib: Rewrite match statement as ordinary if statement.
    
    Just stylistic change, no functional change.

commit cb0818ea860d3fa1ad66a2f9b8c334a78a65ec90
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 20 22:47:09 2016 +0100

    mllib: Add documentation to Common_utils, JSON and Mkdtemp modules.

commit dec30914e8e6eeeb95748b32328fbda3aa4c7e6e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 20 21:55:36 2016 +0100

    mllib: Rename uRI -> URI.
    
    There is no difference in the OCaml module name, which remains 'URI'.

commit 541d07e35fd16509eb53ac486c2296f67fcc7240
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Apr 18 14:43:26 2016 +0200

    launch: direct: specify format for appliance drive
    
    The drive used for the appliance is a raw (sparse) disk: specify that
    explicitly in its -drive qemu command line options, so qemu can skip the
    autodetection of its format and save a tiny bit of time.

commit fb74a275c1438e6e0569b7fea85d2a4841a07a4e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 18 14:40:29 2016 +0100

    p2v: Allow p2v kernel options to override GUI configuration (RHBZ#1327488).
    
    Allow kernel options such as p2v.o=libvirt to override internal
    defaults, even for GUI configuration.
    
    The main change is to split up the kernel conversion into two steps:
    reading the kernel command line configuration, and performing the
    conversion.  The kernel command line can then be read by the main
    program and used to initialize the config structure for either kernel
    conversion or GUI conversion.
    
    A small adjustment is required in the test because p2v.pre no longer
    runs before kernel command line parsing.  (The aim is to have
    p2v.pre/post/fail still only run when doing a kernel conversion, not
    in the GUI case.)

commit f267840aa4c9682cdc9478d16f20a64531bedb55
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Apr 17 09:54:47 2016 +0100

    Version 1.33.22.

commit 9df3daccadc46259ac70340b0008e121664d5bee
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Apr 17 09:49:28 2016 +0100

    valgrind: Ignore another glibc "leak".
    
    See commit 74b604d7e65eb615f15a33e53cf96f6a3349a1dd.

commit 0d9a9ec429b01f498c8244c09a3f91072cee9d81
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 16 19:31:47 2016 +0100

    Version 1.33.21.

commit 0108240364844b8e1dd7e3710ef96679e9794ea0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 16 19:01:11 2016 +0100

    tests: Fix 'make check-slow'.
    
    Since we started to use the parallel tests framework in automake,
    'make check-slow' has been broken.  This is because parallel tests
    doesn't allow you to run 'make check TESTS=...' with a set of test
    scripts which do not also appear in the static list of tests in the
    Makefile.am.  We would like to list and run only "fast" tests in the
    Makefile.am, and have other scripts for slow tests.
    
    The solution is to add the slow tests to Makefile.am, but condition
    those tests on an environment variable SLOW=1 being set.
    
    This commit fixes all the existing slow tests in this way, and updates
    the documentation (guestfs-hacking(1)) to document how slow tests
    should be written in future.

commit 90f6267606decf6ad0699507a98be5a96a881660
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 16 19:21:17 2016 +0100

    v2v: Also check Fedora 23, RHEL 7.2 conversions in check-slow.

commit 74b604d7e65eb615f15a33e53cf96f6a3349a1dd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 15 17:23:19 2016 +0100

    valgrind: Use --run-libc-freeres=no.
    
    Valgrind has a weird hack where it invokes a glibc function called
    __libc_freeres on exit.  See:
    
      http://valgrind.org/docs/manual/faq.html#faq.exit_errors
    
    This is intended to free up memory that glibc won't normally free
    (since glibc doesn't free everything on exit for efficiency reasons).
    
    More importantly, valgrind runs __libc_freeres even if the process
    calls _exit, resulting in this bug:
    
      https://bugs.kde.org/show_bug.cgi?id=361810
    
    (either a bug in valgrind, or in glibc, or in both, depending on your
    point of view).
    
    In any case we don't want this behaviour, so disable it.
    
    Also we have to add suppressions for new "leaks" in glibc found by
    valgrind because __libc_freeres no longer runs.  In fact there is only
    one such suppression needed, for TLS allocation in multithreaded
    tests.

commit 429a0988394c0bbcfe4909def82e75daabf663da
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 15 17:20:52 2016 +0100

    valgrind: Use --trace-children=no --child-silent-after-fork=yes
    
    When we are valgrinding we don't really care about the child
    processes, which might be qemu, libvirtd, etc.  So disable tracing
    into children (at least, as far as is possible with valgrind, which is
    not entirely disabling it, but suppressing it).

commit 6f4de253698c295c227c4b87a941d94aae858f3f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 14 20:31:32 2016 +0100

    Version 1.33.20.

commit 1b4d8ed72eb3cb00bc02cff78148deb13b69464d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 14 20:30:20 2016 +0100

    docs: Add docs/C_SOURCE_FILES to EXTRA_DIST.
    
    Fixes commit 04229c68d60ce1437b6c1fbee95f23bc12d5cb55.

commit e84ceeada7cdd93b6d5d7dad34a175961dc31ad7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 14 19:45:30 2016 +0100

    dist: Make AUTHORS/BUGS/etc rules safe if the output command fails.
    
    Also use $@ instead of target name.

commit 788d2dbbfff83f2bce79db4a0ac8b036842a2ca3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 14 19:42:36 2016 +0100

    dist: Split up dist-hook so we have separate rules for each generated file.
    
    This is convenient because it allows you to do:
    
      rm -f docs/C_SOURCE_FILES
      make docs/C_SOURCE_FILES
    
    if you ever wanted to recreate that file (without doing 'make dist').
    
    Note that the rules depend on configure.ac so that the files get
    updated on each new version (otherwise the files would never get
    updated).

commit d2921ef2707db58b5e61da44c96f1e1c9becacc1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 14 18:22:05 2016 +0100

    Add safe wrapper around waitpid which deals with EINTR correctly.
    
    Thanks: Eric Blake.

commit 1a77e61a41100e6a6fced7c5f0f4705b7f841f37
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 14 18:09:55 2016 +0100

    utils: Allow use of gnulib in this file.
    
    Almost all the tools link to -lgnu, so really this is fine.
    
    Updates commit 768ab2e01dab5a8e7e751c33b72c1341fcaf9dc3
    and commit 83e92b4a972a4dafdcc42388f4a5394e804dd7bf.

commit 64a04a4af001c9cfced7210d53f2e2d4a23cd1e9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 14 16:13:42 2016 +0100

    builder: pxzcat: Remove ineffective POSIX_FADV_WILLNEED.
    
    On Linux this will load the whole file into the page cache.  However
    the output file is empty and zero sized just after it is opened, so
    this has no effect.  Note that the advice is not persistent, so this
    really does nothing.
    
    I considered adding the call back after the file has been written,
    just before the close, but:
    
     - If we do a virt-resize next then we will open and read the file mostly
       sequentially, so readahead will deal with any missing pages.
    
     - If we do a virt-customize next then we will only access a small
       part of the disk image, so loading it all into the page cache adds
       extra work.
    
     - In any case, since we have just written the file it's likely to
       still be in the page cache.

commit 816eb7605f4f12f9385fdaee5e02aecd0427ea47
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 14 16:10:47 2016 +0100

    builder: pxzcat: Close the output file.
    
    After uncompressing the template we didn't close the output file,
    which potentially could cause writes to the output file to be lost.

commit 0b1196ce6c1279f8d1e7d12c3843efe3e2a053c0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 14 16:02:48 2016 +0100

    fadvise: Add guestfs_int_fadvise_normal, document Linux behaviour.
    
    This commit adds guestfs_int_fadvise_normal, but it's not enabled
    since nothing calls it.
    
    It also documents what Linux actually does, which is a bit different
    from what I thought these settings did.  Note this is for Linux 4.6.0rc3
    and may change in future.
    
    This updates commit 83e92b4a972a4dafdcc42388f4a5394e804dd7bf.

commit f23d6d9e68fae21dd559f2d6520dcb8060a69e75
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 14 14:49:55 2016 +0100

    builder: pxzcat: Add further posix_fadvise hints.
    
    Setting POSIX_FADV_RANDOM makes no measurable difference, but at least
    it's the right thing to do.
    
    POSIX_FADV_WILLNEED makes no measurable difference either.
    
    Moving the calls to posix_fadvise to just after the open() makes no
    measurable difference, but does make the code a bit clearer.
    
    Changing POSIX_FADV_NOREUSE on the input file descriptor to
    POSIX_FADV_DONTNEED slows things down by about 10%.

commit 83e92b4a972a4dafdcc42388f4a5394e804dd7bf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 14 13:40:12 2016 +0100

    utils, builder: Add wrappers for posix_fadvise.
    
    Add wrappers around posix_fadvise and use them in places we were
    calling posix_fadvise directly before.
    
    Also in virt-builder we were doing this (and ignoring the result):
    
      posix_fadvise (fd, 0, 0, POSIX_FADV_RANDOM|POSIX_FADV_DONTNEED);
    
    However the POSIX_FADV_* flags are _not_ bitmasks!  In fact
    POSIX_FADV_RANDOM|POSIX_FADV_DONTNEED == POSIX_FADV_NOREUSE so we were
    giving a completely different hint from what we thought we were
    giving.

commit eeacb4ef60ac112983a25571254786a05bc00221
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 13 22:28:31 2016 +0100

    launch: Implement a safer getumask.
    
    The current implementation of getumask involves writing a file with
    mode 0777 and then testing what mode was created by the kernel.  This
    doesn't work properly if the user set a per-mount umask (or fmask/
    dmask).
    
    This alternative method was suggested by Josh Stone.  By forking, we
    can use the thread-unsafe method (calling umask) and pass the result
    back over a pipe.
    
    This change also fixes another problem: mode_t is unsigned, so cannot
    be used to return an error indication (ie. -1).  Return a plain int
    instead.
    
    Thanks: Josh Stone, Jiri Jaburek, Eric Blake.

commit f5821fe6b798b3fc14db4ad82b5af52f9fd13e69
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Apr 14 15:25:52 2016 +0200

    customize: cast value to intptr_t for pointer usage
    
    Cast a Int64 OCaml value to intptr_t before casting it to a pointer, so
    this avoids warnings about casting an int to pointer.
    
    Fixes commit 80a13b7216340b2bee437c39db2375b61804e133.

commit 3cc039bf17c7603bacb87c51d0fdc5167f4ea3f5
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Apr 14 13:12:31 2016 +0200

    docs: exclude more generated sources from C_SOURCE_FILES
    
    Exclude more files from the documented sources in C_SOURCE_FILES:
    - sources generated by XDR definitions
    - sources generated by gperf
    - errnostring.c (generated by the generator, and copied around from src
      to daemon during build)
    
    Also update C_SOURCE_FILES as well, so libguestfs builds again from
    scratch.

commit 47aa64aec9e587932b134f512ac362e503b0a4b5
Author: Roman Kagan <rkagan@virtuozzo.com>
Date:   Tue Apr 12 18:14:08 2016 +0300

    v2v: add support for virtio-scsi
    
    Virtio-SCSI offers a number of advantages over virtio-blk, in
    particular, it supports SCSI UNMAP (aka trim) which is crucial for
    keeping the virtual drive from wasting host disk space.
    
    This patch adds support for virtio-scsi as the virtual disk connection
    type both on input and on output of v2v.
    
    Virtio-blk remains the default, so for now virtio-scsi-based guests can
    only be produced in --in-place mode.
    
    Signed-off-by: Roman Kagan <rkagan@virtuozzo.com>
    Reviewed-by: "Richard W.M. Jones" <rjones@redhat.com>

commit 01f98a250046ca40a5236ec7264aaa1ea2239adb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 13 13:47:50 2016 +0100

    docs: Convert more ordinary comments to internal documentation comments.

commit 63e9293b3587f2c5f7f52fb263c442d06c2c7c19
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 12 21:24:01 2016 +0100

    docs: Add internal documentation for a few virt-df functions.

commit 24e5b591e48288fddf5bf6d130fbdbe48ca87980
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 12 21:10:53 2016 +0100

    docs: Add internal documentation for a few guestfish functions.

commit 82aa5bd25ec71979997f7b07a3d1f41abc4081bc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 12 20:59:40 2016 +0100

    docs: Add internal documentation for a few daemon functions.

commit 4d55b046e30fc3f47e75f7226b316a32027d1df8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 12 16:10:20 2016 +0100

    docs: Add internal documentation for many core internal functions.

commit 5977fe9d2b451d53d0dacb8026b1bf9922932fa3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 12 19:14:35 2016 +0100

    docs, po: Only update C_SOURCE_FILES, POTFILES, etc when doing 'make dist'.
    
    There's no particular reason that we have to update these files in
    every 'make'.  It's slow, and it doesn't really matter if a single
    file is accidentally omitted from translations on a developer's build
    machine.
    
    On the other hand generating it from 'make dist' has advantages:
    
     - We only do it once per release.
    
     - The maintainer can check the changes carefully.
    
     - If a developer adds some random files in their local build tree,
       these won't be picked up accidentally.
    
     - Changes to POTFILES etc won't leak into general commits.

commit dd85d4f06d2e539ef083ba686f76d981f1fd295d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 12 19:09:23 2016 +0100

    docs: Add list of C source files instead of calculating it using 'find'.
    
    Add the real list of C source files to the Makefile, instead of trying
    to calculate it.  This (will, in the next commit) fix a problem with
    the build on Koji where we created a subdirectory (for python3/) but
    the find command picked up files from that directory for the
    documentation (and then failed).
    
    This fixes commit 04229c68d60ce1437b6c1fbee95f23bc12d5cb55.

commit d13f438850aded0109cb779ae0edea5641ab7c6a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 12 15:20:18 2016 +0100

    docs: Ignore gnulib files when producing internal documentation.
    
    This fixes commit 04229c68d60ce1437b6c1fbee95f23bc12d5cb55.

commit 557b6ce35c63818767326232d7d4774acb84d3c2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 12 13:52:55 2016 +0100

    Version 1.33.19.

commit 04229c68d60ce1437b6c1fbee95f23bc12d5cb55
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 12 08:38:13 2016 +0100

    Add internal documentation to C files.
    
    As in libvirt, allow internal documentation comments in C files.
    These are marked using '/**' comments.  Unlike libvirt which has an
    ill-defined and inconsistent markup, the markup we use is Perl POD.
    
    These comments are added to guestfs-internals(1), but are most likely
    to be read in-place.
    
    This commit changes some existing comments in src/launch.c to
    demonstrate how this can be used.

commit e07459d994fc4a72c6114c57570b2c1056aafb13
Author: Roman Kagan <rkagan@virtuozzo.com>
Date:   Wed Apr 6 16:20:40 2016 +0300

    v2v: win: factor out common bits in registry patching
    
    Refactor registry patching to share common parts between Win <= 7 and
    Win >= 8.  Also branch between the two based on the presence of the
    DriverDatabase subtree rather than on the OS version, which allows not
    to pass the inspect handle into the functions.
    
    OTOH make the patching functions accept the driver name and device PCI
    id as arguments; this will allow to easily expand the code to support
    other drivers (e.g. vioscsi) later on.
    
    Signed-off-by: Roman Kagan <rkagan@virtuozzo.com>
    Reviewed-by: "Richard W.M. Jones" <rjones@redhat.com>

commit 9a441b0317800646664ad15fbc0254ec65f724cb
Author: Roman Kagan <rkagan@virtuozzo.com>
Date:   Wed Apr 6 16:20:40 2016 +0300

    v2v: win >= 8: simplify registry patching
    
    It turned out (by trial and error) that for Windows >= 8 / 2012, even
    though the PnP system uses names related to the original driver's .inf
    file for certain entries under DriverDatabase registry subtree, this
    doesn't have to hold for the storage driver to make it boot.
    
    So use our own artificial names there and simplify the surrounding code.
    This will also make sure the added entries don't confilct with those
    generated by PnP proper once the driver is installed, and that the
    entries are easy to look up in the eventual registry.
    
    The name chosen to refer to the driver -- "guestor" -- is intentionally
    different from the original "viostor" both to avoid collisions and to
    naturally expand to other relevant drivers (e.g. "vioscsi") later on.
    
    Tested on
    
    Win 8 x32
    Win 8 x64
    Win 8.1 x32
    Win 8.1 x64
    Win 2012R2 x64
    Win 10 x64
    
    Signed-off-by: Roman Kagan <rkagan@virtuozzo.com>
    Reviewed-by: "Richard W.M. Jones" <rjones@redhat.com>

commit f0dce2452cc88c3ad1b1019a293bd43c9a11ce47
Author: Roman Kagan <rkagan@virtuozzo.com>
Date:   Wed Apr 6 16:20:40 2016 +0300

    v2v: win >= 8: reduce registry patch
    
    The patch to the Windows registry allowing it to boot off a virtio-blk
    drive was initially conceived by comparing the state with virtio-blk
    driver properly installed, to that without.
    
    However, we don't want to replicate the Windows PnP system; rather we
    need to apply just enough edits to make the system boot, and then let
    the Windows PnP manager figure out the rest.
    
    It turned out (by trial and error) that for Windows >= 8 / 2012 the
    "just enough" set includes only the service entry for the driver, and a
    few entries under DriverDatabase.
    
    Tested on
    
    Win 8 x32
    Win 8 x64
    Win 8.1 x32
    Win 8.1 x64
    Win 2012R2 x64
    Win 10 x64
    
    Signed-off-by: Roman Kagan <rkagan@virtuozzo.com>
    Reviewed-by: "Richard W.M. Jones" <rjones@redhat.com>

commit 1f24364367a295961993e115b905c0af9c1c522c
Author: Roman Kagan <rkagan@virtuozzo.com>
Date:   Wed Apr 6 16:20:40 2016 +0300

    v2v: win <= 7: reduce registry patch
    
    The patch to the Windows registry allowing it to boot off a virtio-blk
    drive was initially conceived by comparing the state with virtio-blk
    driver properly installed, to that without.
    
    However, we don't want to replicate the Windows PnP system; rather we
    need to apply just enough edits to make the system boot, and then let
    the Windows PnP manager figure out the rest.
    
    It turned out that for Windows <= 7 / 2008R2 the "just enough" set
    includes only the service entry for the driver, and a
    CriticalDeviceDatabase entry matching the PCI id of the device and
    pointing at that service entry.
    
    While at this, also drop CriticalDeviceDatabase entries for older and
    no longer relevant PCI ids of the virtio-blk device.
    
    Tested on
    
    Win XP SP3 x32
    Win XP SP2 x64
    Win 2003R2 SP2 x32
    Win 2003R2 SP2 x63
    Win Vista SP2 x32
    Win Vista SP2 x64
    Win 2008 SP2 x32
    Win 2008R2 SP1 x64
    Win 7 SP1 x32
    Win 7 SP1 x64
    
    Signed-off-by: Roman Kagan <rkagan@virtuozzo.com>
    Reviewed-by: "Richard W.M. Jones" <rjones@redhat.com>

commit 80a13b7216340b2bee437c39db2375b61804e133
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 11 22:04:18 2016 +0100

    customize/perl_edit-c.c: Don't use internal APIs.
    
    We can now use the Guestfs.c_pointer method to access the underlying
    guestfs_h *.  So no need to use internal APIs for this.

commit fc4936661d7a5150208f8fb9ba0c31ae218c38b5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 12 08:35:29 2016 +0100

    v2v: Don't allow -oa option to be specified more than once on the command line.

commit 7bc0ea7d241cd2ca8a3f1efbf732cfb1dddd41a2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 11 14:04:31 2016 +0100

    v2v: Reject duplicate -b/-n parameters on the command line (RHBZ#1325825).

commit 57467ca88b3b438ae56a0f0cdd3df159235219a2
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Apr 11 17:10:20 2016 +0200

    php: support PHP 7
    
    Adapt to the API changes in the newer versions of the Zend framework, in
    particular regarding:
    - strings handling
    - resources handling (used for the guestfs_h pointer)
    - iterating in hash maps
    - data types for function arguments
    
    Introduce helper macros to reduce greatly the amount of #if's all around
    the generated C code.

commit 4a337cd33b1e1f1fced4a630f3541226af8dd7e9
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Apr 11 17:06:50 2016 +0200

    fish: improve formatting of help text of generated commands
    
    In the generated description of the guestfish commands, wrap and indent
    the help text, so it is a multiline string instead of a very long single
    one.
    
    This has no behaviour changes, only makes cmds.c more readable (and
    easier to diff when the description of actions change).

commit ea175fb244b9b6a6c7104d263a39ba034c4facaf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 9 21:17:26 2016 +0100

    ruby: Document that rubygem-rdoc is required for the Ruby bindings.

commit ea300d8ffe196873a768774e402824b7497e9296
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 9 21:10:11 2016 +0100

    docs: Refresh documentation for the ./run script.

commit eb364b15ebd5f6576d3b1392eafb5aa523fccced
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 9 21:05:33 2016 +0100

    build: ./run is documented in guestfs-building(1), not README.

commit f24753ebb01ac96c092ee11aaa3f08df40d7ca00
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 6 17:44:49 2016 +0100

    tests/qemu: boot-analysis: (Don't) set LIBVIRT_LOG_FILTERS.
    
    Setting LIBVIRT_LOG_FILTERS is supposed to be better than setting
    LIBVIRT_DEBUG, but I couldn't get it to work.
    
    This updates commit b332d91bc9685e8992ede2c8a10655f26fd0395e.

commit b332d91bc9685e8992ede2c8a10655f26fd0395e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 6 10:43:00 2016 +0100

    tests/qemu: boot-analysis: Add support for logging libvirt events.

commit 0008d794cf00b07842bc5403b53684e2bad5053a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 6 10:42:21 2016 +0100

    tests/qemu: Don't leak backend variable in boot-analysis/boot-benchmark programs.

commit 171c84788e3f821dca0ba34bd3299ed51b146b18
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 5 21:32:08 2016 +0100

    v2v: DOM: Add documentation for the obscure 'e' function.
    
    No functional change, just comment.

commit 1dd3da54f1e2900677aebb9cf7735d6dce5743db
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 5 21:20:26 2016 +0100

    v2v: Add documentation to Convert_windows and Convert_linux modules.
    
    No functional change, just add comments / documentation.

commit c8cf4dc0a1add86f418949bafbd6807f1026621a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 5 15:15:21 2016 +0100

    Version 1.33.18.

commit b2c845333f66d4d3135d3b6a8d4b992d6160bf0a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 5 15:02:20 2016 +0100

    launch: libvirt: Disable virtio-rng in libvirt backend until we can use /dev/urandom.
    
    This updates commit 9423c16607259b30985c46d04db9958ec079aa42.

commit dc94de5bee89b57b53134c3cb53befb9b8e8bccc
Author: Cédric Bosdonnat <cbosdonnat@suse.com>
Date:   Tue Apr 5 13:47:28 2016 +0200

    v2v: extract controller offset discovery as a function
    
    This function is needed for other drivers, move the code in order to
    help sharing it later.

commit 19dc728c486ce03ea3c92600a8b962e44ae51eca
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 5 12:09:22 2016 +0100

    Version 1.33.17.

commit 91c72738997646dcf291c94d027f6ff46574fce7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 5 12:07:13 2016 +0100

    builder: Add ubuntu-ppc64le.sh to EXTRA_DIST.
    
    Fixes commit f756002b54792b34b287d44af2908f60e21e0374.

commit 1ecd0b00586fd93c232a1a28ae81d497cf55439a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 5 12:06:23 2016 +0100

    Add python/t/README to EXTRA_DIST.
    
    Fixes commit aae74c9e4e062d5b311977f34edbf6d654e5db12.

commit a04b04c5c1d9182b59ba18b6fd627d7e10be230a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 5 11:58:35 2016 +0100

    Remove .x-sc (syntax check) files from EXTRA_DIST.
    
    Fixes commit 821db657d1484f7cc23d66321122b39259df0370.
    Updates commit 017f1c67296ee6fa9a566f853ea896e39d2e9bf0.

commit c48e04d9d2b285268826dcd40254c79dc3109065
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 4 16:57:10 2016 +0100

    align/scan: Remove stray comment that confuses clang-format.

commit 821db657d1484f7cc23d66321122b39259df0370
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 4 14:04:58 2016 +0100

    Further remove mention of 'make syntax-check'.
    
    Updates commit 017f1c67296ee6fa9a566f853ea896e39d2e9bf0.

commit fdfedcb4efec5ce67f973011c84e55c34b66a082
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 4 11:31:00 2016 +0100

    Use 'error' function for fprintf followed by exit.
    
    Like with the previous commit, this replaces instances of:
    
      if (something_bad) {
        fprintf (stderr, "%s: error message\n", guestfs_int_program_name);
        exit (EXIT_FAILURE);
      }
    
    with:
    
      if (something_bad)
        error (EXIT_FAILURE, 0, "error message");
    
    (except in a few cases were errno was incorrectly being ignored, in
    which case I have fixed that).
    
    It's slightly more complex than the previous commit because we must be
    careful to:
    
     - Remove the program name (since error(3) prints it).
    
     - Remove any trailing \n character from the message.
    
    Candidates for replacement were found using:
    
      pcregrep --buffer-size 10M -M '\bfprintf\b.*\n.*\bexit\b' `git ls-files`

commit 129e4938baa4a0aea133d87b69d3ccdc2e228df3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Apr 3 21:21:37 2016 +0100

    Use 'error' function consistently throughout.
    
    Wherever we had code which did:
    
      if (something_bad) {
        perror (...);
        exit (EXIT_FAILURE);
      }
    
    replace this with use of the error(3) function:
    
      if (something_bad)
        error (EXIT_FAILURE, errno, ...);
    
    The error(3) function is supplied by glibc, or by gnulib on platforms
    which don't have it, and is much more flexible than perror(3).  Since
    we already use error(3), there seems to be no downside to mandating it
    everywhere.
    
    Note there is one nasty catch with error(3): error (EXIT_SUCCESS, ...)
    does *not* exit!  This is also the reason why error(3) cannot be
    marked as __attribute__((noreturn)).
    
    Because the examples can't use gnulib, I did not change them.
    
    To search for multiline patterns of the above form, pcregrep -M turns
    out to be very useful:
    
      pcregrep --buffer-size 10M -M '\bperror\b.*\n.*\bexit\b' `git ls-files`

commit 03b68d436c61e9e0baac7c4fb305b62f41185173
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 2 11:03:33 2016 +0100

    tests/qemu: boot-analysis: Don't force backend direct.
    
    Current libvirt overhead is 220ms.  That didn't matter when our launch
    time was 4000ms.  Now we're launching in 900ms, it really does.

commit 014b7c0ced2dc57ca2dda0c43873359497f8672b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 2 11:01:30 2016 +0100

    tests/qemu: Standardize test info printed by boot-* tests.
    
    It now looks like:
    
    test version: libguestfs 1.33.16
     test passes: 5
    host version: Linux moo 4.4.4-301.fc23.x86_64 #1 SMP Fri Mar 4 17:42:42 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux
        host CPU: Intel(R) Core(TM) i7-5600U CPU @ 2.60GHz
         backend: direct
            qemu: /home/rjones/d/qemu/x86_64-softmmu/qemu-system-x86_64
    qemu version: QEMU emulator version 2.5.90, Copyright (c) 2003-2008 Fabrice Bellard
             smp: 1
         memsize: 500
          append: guestfs_boot_analysis=1 ignore_loglevel initcall_debug

commit d470480b3564b45301a79047f919051b4e2e58b4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 2 10:42:12 2016 +0100

    tests/qemu: boot-analysis: Display all times in ms.
    
    It was confusing to have a mix of seconds and milliseconds.  For all
    upstream testing (eg. with SeaBIOS) we are discussing everything in
    milliseconds, so use those exclusively.

commit 96ce2f9afedc6a7ecb2f7781958c3940255f453b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 1 19:19:51 2016 +0100

    tests/qemu: Add boot-benchmark.
    
    Add a new test program called 'boot-benchmark'.  This is similar to
    'boot-analysis' but it simply boots and shuts down the appliance
    several times in a row and measures how long it takes, calculating
    mean and standard deviation.

commit 2e04be377a71e9e76d7c8483889a717e9d4f8ec9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 1 17:46:53 2016 +0100

    docs: Link to boot-analysis program from guestfs-performance(1).

commit 7ecec1ee55bff30b2d67a61179807befd2a38d23
Author: Matteo Cafasso <noxdafox@gmail.com>
Date:   Fri Apr 1 18:59:39 2016 +0300

    python: Fix bug in code generator
    
    When a struct containing FChar fields is defined
    in generator/structs.ml, the Python code generator will generate
    code referencing a dirent struct instead of the correct one
    thus breaking at compile time.
    
    This bug was left unnoticed because the dirent struct is the only
    one using FChar fields. Yet it prevents any other struct
    from using such fields.
    
    Signed-off-by: Matteo Cafasso <noxdafox@gmail.com>

commit 2cc8a4c1ff2bca9df39db3401ffefaf1b603954c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 1 12:28:18 2016 +0100

    launch: Add a comment about why acpi=off (because it's slow).

commit 6c99a17dc56ab0479b439dece549c89960b21ccc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 1 10:05:59 2016 +0100

    launch: Only use sgabios when verbose is enabled.
    
    The sgabios option ROM is slow.  Only use it when we're debugging.
    
    Thanks: Paolo Bonzini.

commit 77e1ac5a9737d2bc6fc963baa2c2c8f1b8f1b92d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 1 10:01:32 2016 +0100

    launch: direct: Add a comment about use of -display none.
    
    No functional change.

commit 68fc25e1d54bfeff8d7a7d40ae9b061f800406d7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 31 14:03:56 2016 +0100

    v2v: Document how to use 'cinder manage' for importing directly to Cinder.
    
    Thanks: Tom Barron.

commit b2f42a8dce46fc08e361aeae9593532a42e4c0c2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 30 11:24:50 2016 +0100

    builder: Update Fedora 23 (i686) image.
    
    Contains a fix for RHBZ#1317843 and another dnf bug.

commit d2e81b42e77edfb25c8cfd1db88fc2e4320da01b
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Mar 31 11:38:00 2016 +0200

    inspect: use os-release for CoreOS
    
    Look for /lib/os-release in the /usr partition and try to use it, if
    present, before using lsb-release later on.  This should not change the
    final result of the inspection, while using the os-release detection
    method also for CoreOS.
    
    Update the phony CoreOS image to use os-release instead, uploading the
    version found in the current stable version.

commit 5fd0819ebca5db112f09295b477158985f8dd339
Author: Matteo Cafasso <noxdafox@gmail.com>
Date:   Wed Mar 30 22:18:08 2016 +0300

    Rename icat command in download_inode
    
    The "icat" name comes from the employed command line tool which might be
    replaced at any time with a different implementation.
    
    The command name is a bit confusing because it's similar to "cat" but
    act as "download".
    
    download_inode is more clear and descriptive.
    
    Signed-off-by: Matteo Cafasso <noxdafox@gmail.com>

commit ca4516d94ca413f931536029efddcb76e7cbf10d
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Mar 30 15:49:16 2016 +0200

    inspect: os-release: fix single-number version parsing (RHBZ#1321620)
    
    Use the proper length modifier for asprintf, instead of a padding
    modifier.  This fixes the parsing of versions in VERSION_ID which are a
    single number (i.e. "X" and not "X.Y", etc).
    
    Bug introduced with commit 32d19e3289bc259901f77398703f16cf6eabd510, but
    uncovered recently with the switch away from VLAs, i.e.
    commit 07c496c53c7835c0db882ef6761309db4952ebf6.

commit 88d5186eb447525d77133e200be2f723a2e532a3
Author: Matteo Cafasso <noxdafox@gmail.com>
Date:   Tue Mar 29 22:56:29 2016 +0300

    renamed daemon/tsk.c to daemon/sleuthkit.c
    
    In order to support the new features I am renaming the file with a better name.
    
    The file sleuthkit.c will contain the code depending on the sleuthkit package.
    
    The original tsk.c file will contain the logic built using libtsk
    which is the sleuthkit core library.
    
    Signed-off-by: Matteo Cafasso <noxdafox@gmail.com>

commit c67bab9c5d3e5bfd13c95930aad08be5924730b1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 30 11:24:50 2016 +0100

    builder: Update Fedora 23 image.
    
    Contains a fix for RHBZ#1317843 and another dnf bug.

commit 807433bc230987270680ad28643e9c1741790c29
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Mar 30 10:15:49 2016 +0200

    appliance: init: generate /etc/machine-id
    
    Some of the systemd-tmpfiles snippets need the machine ID of the running
    system; the current lack of this file produces warning messages during
    the appliance boot like:
    
    [/usr/lib/tmpfiles.d/systemd.conf:26] Failed to replace specifiers: /run/log/journal/%m
    [/usr/lib/tmpfiles.d/systemd.conf:28] Failed to replace specifiers: /run/log/journal/%m
    [/usr/lib/tmpfiles.d/systemd.conf:29] Failed to replace specifiers: /run/log/journal/%m
    
    Thus create a new randomly-generated /etc/machine-id on boot.

commit da7e22b648ce470980c17943efcc0c5c255c33bf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 29 11:59:36 2016 +0100

    boot-analysis: Add --memsize, --smp and --append options.
    
    These options allow you to control the appliance memory size, number
    of vCPUs, and extra kernel options respectively.
    
    Note that using --smp is not usually a good idea.  Not only does it
    slow down the appliance, but it tends to break the boot analysis
    program because it makes runs (more) non-deterministic.

commit de669819173ee1beb629f60e83e5976564e154e2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 25 17:13:58 2016 +0000

    v2v: Don't use List.sort_uniq, add util function for this instead (RHBZ#1321338).
    
    List.sort_uniq was added in OCaml 4.02, so this breaks compilation on
    earlier versions of OCaml.
    
    Thanks: Jean-Christophe Manciot

commit f756002b54792b34b287d44af2908f60e21e0374
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 24 18:41:20 2016 +0000

    builder: Add ubuntu ppc64le script.
    
    Thanks: Gustavo Romero

commit c6512ead4584cf5423f1674d2b9d36686c69d573
Author: Lars Kellogg-Stedman <lars@redhat.com>
Date:   Thu Mar 24 15:21:45 2016 -0400

    document behavior of --selinux-relabel
    
    the description of the --selinux-relabel option suggests that it
    perform an immediate relabel, when in fact it may (and probably will)
    instead simply touch /.autorelabel on the image, which schedules a
    relabel operation for the next time the image boots.  This can be
    surprising because it results both in an extended initial boot time
    *and* results in an automatic reboot (on some distributions).

commit 6cdd20716c372d120af38c831c97e9ee17391850
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 24 18:24:41 2016 +0000

    Version 1.33.16.

commit c3fb5deab693c0e193a684f7aba21785a8795828
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 24 17:58:42 2016 +0000

    rescue: Fix test to deal with new --suggest output.
    
    Fixed commit 72fd0531ab8446dc00d565cf2f526f5c9bcee968.

commit aae74c9e4e062d5b311977f34edbf6d654e5db12
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 24 14:46:09 2016 +0000

    python: Add README documenting how to run a single test.

commit a5507a16c68b6ee56258d44087b4e4529290934a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 24 10:48:03 2016 +0000

    rescue: Print chroot suggestion for Linux guests.

commit 72fd0531ab8446dc00d565cf2f526f5c9bcee968
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 24 10:46:31 2016 +0000

    rescue: Suggest using recursive bind mounts.
    
    Since /dev and other directories contain sub-mounts, suggest using
    --rbind instead of --bind.  This also allows us to remove the /dev/pts
    line.

commit 0024e5a13e7d6b7d4db819c5fba8b4c5fd050617
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 24 13:52:28 2016 +0000

    python: Misspelling in tests, libirt -> libvirt.

commit db982654d1a17aec56d4bf0be9be53febc588584
Author: Roman Kagan <rkagan@virtuozzo.com>
Date:   Fri Mar 18 19:15:39 2016 +0300

    v2v: better explain --in-place
    
    It seems that the documentation for --in-place mode of v2v wasn't clear
    enough, so try to explain it better.
    
    Signed-off-by: Roman Kagan <rkagan@virtuozzo.com>
    Signed-off-by: "Richard W.M. Jones" <rjones@redhat.com>

commit fb73d8261d0822159d9833d039f0e71c546f8776
Author: Roman Kagan <rkagan@virtuozzo.com>
Date:   Tue Feb 9 17:02:37 2016 +0300

    v2v: in-place: request caps based on source config
    
    In in-place mode, the decisions on which interfaces to use are made and
    the source VM configuration is created by the outside entity.  So in
    that case v2v needs to look it up in the source configuraion, and try to
    follow.
    
    For that, the source VM configuration is used to populate requested caps
    object which is then passed to the convert routine.
    
    It's assumed that the configuration has exactly one type of storage
    devices and no more than one type of network and video adapters;
    anything else is rejected.
    
    Signed-off-by: Roman Kagan <rkagan@virtuozzo.com>
    Signed-off-by: "Richard W.M. Jones" <rjones@redhat.com>

commit ee0219148352695ddf1102a426dcfe4e3be55fba
Author: Roman Kagan <rkagan@virtuozzo.com>
Date:   Tue Feb 9 16:48:26 2016 +0300

    v2v: take requested caps into account when converting
    
    Give the caller certain control over what kind of interface to use for
    virtual disks, network and video cards upon conversion.
    
    For that, make convert functions accept additional rcaps parameter
    containing an object with optional capabilities similar to the ones
    produced on output, with None indicating that the decision is left to
    the convert function itself.
    
    To facilicate review, this patch unconditionally passes rcaps with no
    preferences; populating it with more sensible values is done in a
    followup patch.
    
    Signed-off-by: Roman Kagan <rkagan@virtuozzo.com>
    Signed-off-by: "Richard W.M. Jones" <rjones@redhat.com>

commit 94c83c016516bba9dae0b8c01c9fea9e7159a8b6
Author: Roman Kagan <rkagan@virtuozzo.com>
Date:   Fri Feb 5 16:54:07 2016 +0300

    v2v: introduce requested guestcaps type
    
    Introduce a type to contain the guestcaps that are to be put in effect
    in the converted VM: options of the block type, net type, and video.
    
    It'll be populated by the caller and passed into convert function to
    affect its choice of devices and drivers.
    
    Signed-off-by: Roman Kagan <rkagan@virtuozzo.com>
    Signed-off-by: "Richard W.M. Jones" <rjones@redhat.com>

commit ad5bb4f6bdcd07f27d89be89d05c0ce96da4064c
Author: Roman Kagan <rkagan@virtuozzo.com>
Date:   Tue Feb 9 16:26:05 2016 +0300

    v2v: collect source network and video adapter types
    
    Those will be useful when making decisions about what configuration to
    set on output.
    
    The data is also included in --print-source so the tests are adjusted
    accordingly.
    
    Signed-off-by: Roman Kagan <rkagan@virtuozzo.com>
    Signed-off-by: "Richard W.M. Jones" <rjones@redhat.com>

commit 0ba59db611fc2620bf47b50c6d0a71242a0800d7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 18 18:00:51 2016 +0000

    tests/qemu: Add program for tracing and analyzing boot times.

commit cd578510197eb87abf996a3a050779806682e83f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Mar 20 15:50:31 2016 +0000

    conn: Pretend to be a serial terminal, so sgabios doesn't hang.
    
    This tedious workaround avoids a 0.26 second pause when using sgabios
    (the Serial Graphics Adapter).  It's basically a workaround for buggy
    code in sgabios, but much easier than fixing the assembler.

commit f36ba3888654b55a25158edd23a40fd0e28545a8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 19 20:13:49 2016 +0000

    appliance: init: Don't run hwclock command.
    
    This command alone took 0.3 seconds which is about 10% of the current
    launch time.  It appears to be unnecessary.
    
    This reverts commit 508f1ee87e816bf6b6fc8e629ccbb2d61a971169.

commit 705b721b4224f43149e52d8741d2aa5c4a67b735
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 23 12:13:03 2016 +0000

    appliance: init: Mount selinuxfs along with other special filesystems.
    
    Move this earlier.

commit cb8f69e95929e512fcb8882ffb647dc72fc4a865
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 19 18:27:07 2016 +0000

    appliance: init: Move cmdline parsing earlier.
    
    Since commit bb5d30ab2af5720775c63179afdec3ad9efd510d, we don't
    require any external programs like grep to parse the command line.  We
    only use bash intrinsics.
    
    Therefore we can do it early (but after /proc is mounted).
    
    This allows verbose mode to enable set -x early on, so we can trace
    most things that the init script does.

commit d368fa08955a17feed39baaab990dae361fede13
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 19 18:26:39 2016 +0000

    appliance: When using verbose mode, 'set -x' in the appliance init script.

commit 9423c16607259b30985c46d04db9958ec079aa42
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 22 14:51:19 2016 +0000

    launch: Add a virtio-rng device to the guest.

commit e94e61f76f5b0dcdcb0d1b7c74e53c7e3d7da5b2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 19 21:27:32 2016 +0000

    launch: Remove guestfs_int_print_timestamped_message function.
    
    This function was kind of like debug(), except that it didn't check
    the g->verbose flag and it only worked in the library (it would crash
    if used after fork).
    
    It also wasn't very useful.  The sort of boot analysis done by
    [forthcoming program] tests/qemu/boot-analysis.c means that
    timestamping (some) messages is even less interesting than before.
    
    Remove it and replace calls with debug() instead.

commit b7b34119766349522528fdfe56237bede0794b6a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 22 14:04:26 2016 +0000

    launch: direct: Don't run qemu -version.
    
    Dr. David Gilbert pointed out to me that the first line of the
    qemu -help output includes the qemu version, so we don't need
    to run qemu -version at all.
    
    This saves about 0.04s on the launch time when using the direct
    backend.

commit b3e843e5b471b1e6e72901a98b3aa39820edaa6a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 22 09:43:50 2016 +0000

    launch: Factor out earlyprintk from the command line.
    
    Just code motion.
    
    In theory we could also add earlyprintk=ttyS0,115200 on x86, but I
    cannot get it to work.

commit b652cc419d5f2857a48acf6ce91878e5aad4f888
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 19 21:19:21 2016 +0000

    launch: direct: Remove dead code promising we were going to use virtio-console.
    
    We're never going to use virtio-console since, although it is faster,
    it's not available during early boot, and that is more important for
    debugging.

commit bb5d30ab2af5720775c63179afdec3ad9efd510d
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Mar 22 15:48:53 2016 +0100

    appliance: use bash features for string matching in files
    
    Read the content of /proc/cmdline using bash features, and use its
    [[ ... ]] expression to find texts in a variable.
    
    This shaves off 5 grep invocations.

commit e2457d0773e39e54936db0727bbaef1c4d450327
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Mar 22 13:41:56 2016 +0100

    Reduce GUESTFS_PRIVATE usage
    
    Remove the GUESTFS_PRIVATE=1 define for some tools and tests which don't
    really use any private API.

commit 40017ba7f3d72d8efd4df1ad8103eaf9558d72c4
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Mar 18 16:06:45 2016 +0100

    build: improve GUESTFS_FIND_DB_TOOL macro
    
    - find the unversioned name just once
    - add 5.3 and 5.2 as versions
    - add db_$TOOL-X and db_$TOOL-X.Y as patterns (found on FreeBSD)

commit 5f24d45ab541d2d99303051244438a0ade1071a8
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Mar 18 15:37:10 2016 +0100

    build: check the path of true, and use it in tests
    
    Check for the full path of true, and use it instead of hardcoding
    /bin/true (which is still left as fallback).

commit 76a01fe41d9b30b82dac3584c768271204ac4dea
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Mar 18 15:35:51 2016 +0100

    php: pass $(MAKE) to run-php-tests.sh
    
    Instead of hardcoding "make" in run-php-tests.sh, pass the actual name
    of make from the Makefile; the default is still "make", mostly to use
    the script without having to set $MAKE.

commit 39772344ad0a2eaaa9905d9440b10a26692b1a56
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Mar 18 15:09:23 2016 +0100

    v2v: tests: use guestfs-hashsums.sh for MD5
    
    Use the common helper for MD5 checksum, instead of assuming md5sum(1).

commit 8aee5726d3576b10daa59483a24ca7d7cf59a4cf
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Mar 18 15:03:22 2016 +0100

    v2v: tests: isolate SHA1 calculation in an own shared function
    
    sha1sum(1) does not exist everywhere, so wrap it in an own function so
    the right implementation can be chosen on each OS.  Also, wrapping it
    avoid using awk everytime.

commit 41795a1c987082d14026d5f493278572a9f4fe43
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Mar 18 14:45:54 2016 +0100

    tests: move guestfs-md5.sh to test-data
    
    Move it to the test-data directory, giving it a more generic name so it
    can be used also for more than just md5; adjust qemu tests accordingly.
    
    This is just code motion, no behaviour change.

commit 7e970fcdb34815f20c610defcc4cf7c9ffe058e9
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Mar 18 11:37:32 2016 +0100

    build: check the path of fuser, and use it in FUSE code
    
    Check for the full path of fuser, and use it instead of hardcoding
    /sbin/fuser (which is still left as fallback).

commit 5897b3bbad8c234be2b20685c7714628ea5ec5a0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 17 10:05:00 2016 +0000

    appliance: Quiet some warnings about missing files.
    
    Try to make the appliance script as quiet as possible along
    the fast path.

commit 23028cb30d77fe0912e465042222740db0b82899
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 17 10:04:25 2016 +0000

    appliance: Make it clear that the init script is a bash script.
    
    We have used /bin/sh here since 2009.  However this is a bash
    script and probably won't work well with other shells.

commit ed739e71f634b363c3cf6a0a4eca559eaae7f7b3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 17 08:35:54 2016 +0000

    appliance: Pass "quiet" option to kernel when !verbose.
    
    The quiet option suppresses kernel messages.  On my laptop it improves
    appliance boot times by about 40% (3.5s -> 2.5s).
    
    The emulated UART is slow and has a fixed, small FIFO (16 bytes).  But
    it has the advantage of being a simple ISA device which is available
    very early in boot, thus enabling us to diagnose early boot problems.
    So the aim is to reduce our usage of this UART on fast paths.
    
    Of course when we are in verbose mode, we should not add this flag
    because we want to see all the messages.
    
    This change is not entirely invisible:
    
    (1) Progress messages use the "Linux version ..." string from kernel
    output in order to determine part of where we are in the boot process.
    This string will no longer be detected.  We should probably use a BIOS
    message or maybe drop this altogether.  I have added a comment to the
    code.
    
    (2) It is possible for programs to be listening for
    GUESTFS_EVENT_APPLIANCE events, and they will see fewer messages now
    (although what kernel messages programs see is never defined).

commit 1df34fd8d131dc577344550350077431f56e8bdc
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Mar 17 11:52:34 2016 +0100

    inspect: improve UsrMove detection (RHBZ#1186935)
    
    In case /usr is a symlink to /usr/bin, then we cannot rely on /usr/bin
    to exist, since /usr might be in a different partition.  Thus, in case
    /bin is a symlink, check it points to "usr/bin".

commit b0be4c113045c4259067e76983e725cbedc33877
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Mar 17 15:25:00 2016 +0100

    inspector: define more multichoice tags in the RELAX NG schema
    
    Provide new <define> for the following elements: "distro",
    "package_format", "package_management", and "format", adding all the
    values so far possible for each.

commit 9775777a55278549f8c6543c5685bf402a728abe
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Mar 17 10:39:11 2016 +0100

    builder: fedora: ensure images are up-to-date
    
    Update the system at the end of the installation, so the generated image
    is up-to-date.  This also removes the need to manually update dnf on
    i686 and x86_64.

commit a5bf0e7e6429bfe4edb7f4eb04db9833391ed3ea
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 16 15:17:12 2016 +0000

    Version 1.33.15.

commit 180b853658a42c149b78c4aca8d9e3db0be97b5f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 16 15:16:39 2016 +0000

    fish: Link with LIBTINFO_LIBS.
    
    Required on Gentoo.
    
    Thanks: Mark Pictor

commit 1129cbba3d961631183dadb68d4b9436096220d1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 15 18:57:18 2016 +0000

    docs: Fix cross-reference to fixed appliance section.
    
    The fixed appliance documentation moved from guestfs(3) to
    guestfs-internals(1).
    
    Thanks: Mark Pictor (mark999 on IRC)

commit ffeea7995b4912d4db19d8293ff1dd01f4e2e960
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 9 15:05:43 2016 +0000

    Revert "configure: Move version and date together."
    
    You can't use AC_SUBST before AC_INIT.  It resulted in the
    RELEASE_DATE being an empty string.
    
    This reverts commit d53fd558ae00021f0f091d1685832b6c1e32b0a1.

commit d314d10e1ffd6964fd198010c5e06e62572d9c73
Author: Matteo Cafasso <noxdafox@gmail.com>
Date:   Tue Mar 8 20:14:16 2016 +0200

    sleuthkit availability check renamed
    
    >From 'available icat' to 'available sleuthkit'.
    
    Signed-off-by: Matteo Cafasso <noxdafox@gmail.com>

commit f0d71e148ca61eed6318c3f1dfe828c39ade7205
Author: Cédric Bosdonnat <cbosdonnat@suse.com>
Date:   Tue Mar 8 16:04:20 2016 +0100

    configure: handle older version of ncurses
    
    ncurses didn't have pkg-config files in not-that-old versions. If those
    couldn't be found, then try the ncurses6-config and ncurses5-config tools.

commit 1c30c23a1995b0a471ceb0f89e8add79e18028a3
Author: Cédric Bosdonnat <cbosdonnat@suse.com>
Date:   Tue Mar 8 16:04:22 2016 +0100

    fish: fix btrfs subvolumes display in error case
    
    The list of filesystems that is printed when there was an error prints
    the internal mountable string even for the btrfs subvolumes. Let's
    printing a valid -m option value instead.

commit f5a9cdff2a25bce4d6d4850091c68fa14f985b90
Author: Cédric Bosdonnat <cbosdonnat@suse.com>
Date:   Tue Mar 8 16:04:21 2016 +0100

    api: add mountable_device and mountable_subvolume
    
    These two functions allow the user to split the mountable strings
    into a device and a subvolume if any. See this thread on the mailing
    list for the rationale:
    
    https://www.redhat.com/archives/libguestfs/2016-February/msg00247.html

commit 43dd545e466ffe127fc020997a50178c0470aaed
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Mar 8 09:47:30 2016 +0100

    appliance: pick sleuthkit on all the distros
    
    It looks like it has the same name everywhere, so move it in the common
    packages section.
    
    This updates commit 3bb65458ff078be4815c1b92d0e96acc80ee3b57.

commit d3b68d90c8d115b3545f668b55ca0e2d47541e58
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Mar 7 19:33:34 2016 +0100

    inspector: extend the OS "name" in the RELAX NG schema
    
    Put the definition of "name" in an own <define>, and add the missing
    operating systems so far known to libguestfs.

commit 709e5306552f19f0fae51f48ff87122edcf6e18f
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Mar 7 19:31:30 2016 +0100

    inspector: add --no-applications and --no-icon
    
    Add command line options to optionally disable the output of the
    installed application, and the guest icon.
    
    This makes the inspection slightly faster, producing a smaller XML to
    parse/process in case there is no interest in these details.

commit 31e9be7696ce84f2ad339a698b6395609ce6a3c8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 7 20:11:02 2016 +0000

    Version 1.33.14.

commit ac0d2adf56afd4870c9f2a346dc1b2c1f14f39cc
Author: Matteo Cafasso <noxdafox@gmail.com>
Date:   Mon Mar 7 21:22:20 2016 +0200

    added icat API tests
    
    Signed-off-by: Matteo Cafasso <noxdafox@gmail.com>

commit acd3f235ae71c69cdf3bbbab933168db4539c5c8
Author: Matteo Cafasso <noxdafox@gmail.com>
Date:   Mon Mar 7 21:22:19 2016 +0200

    added icat API to retrieve deleted or inaccessible files
    
    Signed-off-by: Matteo Cafasso <noxdafox@gmail.com>

commit 3bb65458ff078be4815c1b92d0e96acc80ee3b57
Author: Matteo Cafasso <noxdafox@gmail.com>
Date:   Mon Mar 7 21:22:18 2016 +0200

    added The Sleuth Kit package to the appliance
    
    Signed-off-by: Matteo Cafasso <noxdafox@gmail.com>

commit 07c496c53c7835c0db882ef6761309db4952ebf6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Mar 6 18:37:40 2016 +0000

    Use less stack.
    
    GCC has two warnings related to large stack frames.  We were already
    using the -Wframe-larger-than warning, but this reduces the threshold
    from 10000 to 5000 bytes.
    
    However that warning only covers the static part of frames (not
    alloca).  So this change also enables -Wstack-usage=10000 which covers
    both the static and dynamic usage (alloca and variable length arrays).
    
    Multiple changes are made throughout the code to reduce frames to fit
    within these new limits.
    
    Note that stack allocation of large strings can be a security issue.
    For example, we had code like:
    
     size_t len = strlen (fs->windows_systemroot) + 64;
     char software[len];
     snprintf (software, len, "%s/system32/config/software",
               fs->windows_systemroot);
    
    where fs->windows_systemroot is guest controlled.  It's not clear what
    the effects might be of allowing the guest to allocate potentially
    very large stack frames, but at best it allows the guest to cause
    libguestfs to segfault.  It turns out we are very lucky that
    fs->windows_systemroot cannot be set arbitrarily large (see checks in
    is_systemroot).
    
    This commit changes those to large heap allocations instead.

commit 8ed6435f045d37b452a6c2b429284ccd081c3496
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Mar 7 17:25:21 2016 +0100

    inspect: list applications with APK
    
    Implement the helper function for guestfs_inspect_list_applications2 to
    be able to parse the list of installed applications with the APK package
    manager (used on Alpine Linux).

commit b07f8793d072f25163f6a7dd6fb626a084d90dab
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Mar 7 16:17:32 2016 +0100

    build: fix reading of the java version
    
    Update the check for the first line (the one containing the version) to
    match also the message with OpenJDK; switch to awk so it is easier to
    extract the version inside the double quotes.

commit a51b136584aa0635c5d6ed2cbbfa3424a43bccf4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Mar 6 18:58:52 2016 +0000

    inspect: windows: Make is_systemroot check code more robust.
    
    We rely on this function for security to ensure the caller cannot set
    windows_systemroot to a very long or bogus value.

commit af4cd5347ece17c3c29e9905784b645ea35b88f5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Mar 6 18:34:14 2016 +0000

    lib: inspect: gpt_prefix is a constant string.

commit 7b17447ac4e8880f5164eb50e6292b81e222f92a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Mar 6 18:23:26 2016 +0000

    lib: Minor whitespace rearrangement.

commit e7666da22401800be2e64c6235ab1a1406ad506b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Mar 6 18:22:30 2016 +0000

    lib: Fix incorrect comment in utils.
    
    The string is not freed by the caller.  A fixed buffer is provided
    by the caller.

commit c30363d4af880c36e1dc2fe7b1fb93363ca25c5b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Mar 6 15:50:47 2016 +0000

    v2v: linux: Fix small typo in comment.

commit d5b3aa0ccae87bff311e0eb0b19e02e186353383
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 4 10:20:06 2016 +0000

    v2v: Fix incorrect calculation of lc_basename.
    
    We should be using the lowercase path.  Prior to this patch
    lc_basename was not actually lowercase.
    
    Fixes commit f7249a0bccc43d5b5e11703ff432b0361b03292b.

commit f33e127d874aad113acd12b9d4bcb3c84afea3b3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 3 15:41:14 2016 +0000

    v2v: Describe workaround for Windows >= 8 Fast Startup.
    
    Thanks: Nisim Simsolo

commit 82b0d25bb24c9ee88b4ecabdac90d4bafefc7dba
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Mar 3 14:20:46 2016 +0100

    mllib: factor out mounting of guest root
    
    Introduce and use a new inspect_mount_root function to mount all the
    mountpoints of a root in the guest, replacing the same code doing that
    in different tools.
    
    inspect_mount_root_ro is inspect_mount_root with readonly mount option.

commit d53fd558ae00021f0f091d1685832b6c1e32b0a1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 3 11:08:56 2016 +0000

    configure: Move version and date together.
    
    I keep forgetting to update the date field when releasing.

commit e8408fe3c32f65e31e5eaf020478265543e5e981
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Mar 2 14:42:02 2016 +0100

    daemon: do not fail list-disk-labels w/o labels set
    
    If there are no labels set for the disks, the directory with the
    symlinks will not even exists, causing list-disk-labels to fail with
    ENOENT.  In this situation, act as if the directory was there, but
    empty.

commit 4d4f16067e56175188d369d76687052950308a3a
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Mar 2 11:14:19 2016 +0100

    daemon: ntfs: switch away from asprintf_nowarn in ntfsclone-in
    
    No custom formats (eg %Q, %R) are used.

commit acbc5dee4f4268db23fde56e7973e6537c53f980
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Mar 2 11:02:08 2016 +0100

    make-fs: print error message on mkfs failure
    
    This makes a bit easier to diagnose failures on mkfs, without the need
    to restart the filesystem creation with verbose output (which will
    produce a lot more output).

commit c9b186ae6398f0c0313a9846ca71b3892ebd1baa
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Mar 2 10:55:14 2016 +0100

    daemon: ntfs: fix format strings
    
    Use PRIi64 as format string for int64_t, so it builds and works fine
    also on 32bit.  Also switch from asprintf_nowarn to asprintf, since no
    custom formats (eg %Q, %R) are used.

commit 1d5af46a44395123ada04c3999c53ae9ad729c03
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Mar 1 14:20:46 2016 +0100

    tests: move ntfs tests in a single directory
    
    Move test-ntfscat.sh and test-ntfsclone.sh in a single ntfs directory,
    much like the tests for other filesystems.

commit a7ea3b577f9bde78ca7d120017de68c8f55b88eb
Author: Matteo Cafasso <noxdafox@gmail.com>
Date:   Tue Mar 1 00:05:37 2016 +0200

    tests: Added test for ntfscat_i.
    
    Test is based on file signature, it checks whether the extracted file
    is the $MFT.
    
    Signed-off-by: Matteo Cafasso <noxdafox@gmail.com>

commit 61b0317c12b6f10d668f3b3b3fd7749269f8396c
Author: Matteo Cafasso <noxdafox@gmail.com>
Date:   Tue Mar 1 00:05:36 2016 +0200

    New API: ntfscat_i
    
    Adding ntfscat_i command for downloading files based on their inode number.
    
    This allows the dowload of files unaccessible otherwise from a NTFS guest disk image.
    
    Signed-off-by: Matteo Cafasso <noxdafox@gmail.com>

commit 49dea6c79fde7a8fa7519b1ad8a0c4db48e05e52
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Feb 28 16:10:41 2016 +0000

    docs: building: Document using clean-supermin-appliance rule.

commit b2877dc34f31632a8f9755bb7f8c35c83d77ba77
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Feb 28 15:55:27 2016 +0000

    appliance: Add comment and clean-supermin-appliance rule.
    
    Add a comment to appliance/Makefile.am describing the purpose of this
    directory.
    
    Add a 'make clean-supermin-appliance' rule which forces the supermin
    appliance to be reprepared from scratch.  See the discussion here:
    https://www.redhat.com/archives/libguestfs/2016-February/msg00264.html

commit ac76081f5acf80e0a43ec8ede12ba86f313a2aaa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 27 14:57:52 2016 +0000

    builder: Add Fedora 23 (armv7l) image.

commit 9ff2c3ef180cca036661b811745c4243d1ef4aad
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 27 13:42:57 2016 +0000

    builder: armv7l: Specify virt-install --arch explicitly.
    
    Allow us to run this script on x86_64 by specifying the --arch option
    to virt-install, and removing the --cpu option.

commit 6b501cb6f20ae46fecbc632cb5ce33fb6f6f3e9a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 27 13:42:02 2016 +0000

    builder: armv7l: Use latest available os-variant.

commit fdc201a30c913adf35ffcacadeff37b00ad444e9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 27 13:41:03 2016 +0000

    builder: armv7l: Use --vcpus=1 because TCG is not yet multithreaded.

commit 1225bb194e5313dc4da17bd3802fa6595b5ec12d
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Feb 26 17:59:59 2016 +0100

    java: drop empty lines at end of pod-generated text
    
    They are converted as additional empty paragraphs but adding nothing to
    the generated API documentation.  Also avoids warnings about them by
    javadoc.

commit 3b427b90ac9d2f6412dc6fd739df06b7cc8c234e
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Feb 26 17:41:49 2016 +0100

    doc: add info on per-function needed feature
    
    Document which feature, if any, is needed for a function; this should
    help users in properly checking feature availability when using certain
    functions.

commit 9b1f826202d79d5f1014f95050a04bb12baf7c5f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 26 11:45:47 2016 +0000

    Version 1.33.13.

commit 660246dcbc4cf4d333853fbd0b39f4f857029f45
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 26 10:05:21 2016 +0000

    v2v: -o libvirt: Preserve source <graphics> type (RHBZ#1312254).
    
    Old virt-v2v changed the <graphics> to VNC if the guest was using the
    Cirrus hardware and Spice if the guest used QXL.
    
    In commit 3d1cb74b3eee51c5d015032ad964892be914ea9c I got the logic
    backwards, using Spice if the guest used Cirrus and VNC if the guest
    used QXL, which obviously makes no sense.
    
    In this commit, I preserve the original <graphics> type from the
    source guest.  This has the advantage that the user can use the same
    method to access the guest after conversion.  If the source guest had
    no <graphics> element, then we force VNC (a safe choice), and if the
    source guest is a local disk that we use SDL, but this should only be
    used for testing.
    
    Thanks: Xiaodai Wang for the original bug report here:
    https://bugzilla.redhat.com/show_bug.cgi?id=1225789#c10

commit 534dfcf84ebd89d4c008e4f296a92b4b278087fe
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 26 09:53:53 2016 +0000

    v2v: -o libvirt: Refactor video and graphics elements.
    
    This is just a refactoring and doesn't change the meaning of the code.

commit fadce8d3e7cffd4eadc982e330285a93a3486368
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 25 11:37:16 2016 +0000

    fish: Set program name correctly for virt-{copy,tar}-{in,out} programs.
    
    Set the (libguestfs handle) program name correctly when running
    programs like virt-copy-in, so the program name is not "guestfish" but
    "virt-copy-in".
    
    Note this feature cannot be tested using the ./run script, since
    libtool (buggily) resets the program name to "lt-guestfish".  However
    I tested it on the installed copy and it worked there.

commit 7b11fb16ec82236cb47f7c38fb05b7a915294575
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 25 08:48:50 2016 +0000

    perl: Don't embed API number in Sys::Guestfs.
    
    It means you have to rerun `make -C perl clean ; make' every time you
    add an API, and is useless anyway.

commit d9169fc37101f3eea378b2c938ab213a10b1a037
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Feb 25 17:42:57 2016 +0100

    listfs: ignore the default btrfs subvolume
    
    When listing the subvolumes of a btrfs filesystem, ignore the default
    subvolume: we get the content of it when mounting the whole device
    (without specifying any particular subvolume), so avoid listing it
    twice.

commit 20efe3658233810cf343ab1f9dc1349e97e96231
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Feb 24 13:33:16 2016 +0100

    src: print contents of structs and struct lists on tracing
    
    It eases the debugging, instead of getting just the name of the struct
    returned.

commit e58e603a71badf251374ba0f7dc1b33c9edb6873
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Feb 24 12:40:23 2016 +0100

    fish: use the new structs-print.c to print structs
    
    Use of the new code to print structs, making sure the layout is the same
    as before.

commit 2c0d16e82e2b2a514b54458488e910f86583199a
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Feb 24 12:29:27 2016 +0100

    src: generate code for printing contents of structs
    
    Extend the generator to generate a source (and the header for it) with
    functions that print the content of a guestfs struct.  The code is
    modelled after the code for it in fish.ml, although made a bit more
    generic (destination FILE*, line separator) so it can be used also in
    the library, when tracing.
    
    This just introduces the new code and builds it as part of the helper
    libutils.la.

commit c0c91f96d7b125c15c768fc2ff963fddaf1db851
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 23 09:15:14 2016 +0000

    daemon: btrfs: Use COMPILE_REGEXP macro to compile regular expressions.

commit 4752c42c2126c9ed8e7b8e03104e50606ef75afe
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 23 09:13:58 2016 +0000

    lib: Allow the COMPILE_REGEXP macro to be used everywhere.
    
    Since the daemon links to pcre and use regular expressions, and since
    the COMPILE_REGEXP macro doesn't depend on any aspects of the
    library-side code (eg. the guestfs_h handle etc), we can allow the
    daemon to use the COMPILE_REGEXP macro.  Move the macro to
    "guestfs-internal-all.h" to permit this.

commit b1ae32416e83648cf5b29f0310a720c4de7b4ffa
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Feb 23 10:57:28 2016 +0100

    ruby: tests: use more asserts instead of manual checks
    
    Make more use of assert_equal/refute_equal instead of manually checking
    values and raising errors.

commit 3c2bc20250dd07d735eedb932f49bbde403b2201
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Feb 23 10:43:36 2016 +0100

    Revert "ruby: Run tests one at a time, instead of in parallel."
    
    It seems the default behaviour of rake is to run tests sequentially, and
    not in parallel (there are separate gems to achieve that behaviour).
    
    Hence just invoke "rake test" to run all the available tests at once.
    
    This reverts commit 8f30c3c3f8c063f7c5ff8c6154d881e07a820251.

commit ae3c051567e5cbc36e76a1800efb0c5f527a0f47
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 22 22:07:11 2016 +0000

    generator: Declare which input file(s) generate each output file.

commit 52b5ddf23e14a2ff71bc5859a392f9fc237a88cf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 22 21:53:43 2016 +0000

    generator: Make the 'this file is generated' warning clearer.
    
    Also rename the ~extra_inputs parameter as plain ~inputs.  We will use
    ~inputs more widely in following commit.

commit 9eb26a174868359fa37f59ea75b9663516b6b72c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 22 22:45:28 2016 +0000

    generator: gobject: Remove parameters which are not used.
    
    Revealed by adding typed interfaces in the previous commit.

commit 30d2a308c0ca8e1c1daf745ef0ad4b64d488c6b6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 22 22:06:29 2016 +0000

    generator: Add interfaces to all modules.
    
    Be explicit about what is exported from each module in the generator.

commit b9a97718f7508f145bc6f02bdad1934f56d64ad3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 22 12:52:55 2016 +0000

    tests: Use LOG_COMPILER to run valgrind.

commit dd7be596f539f4a38e53c61374bbe8aa1137d8d1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 22 12:34:28 2016 +0000

    tests: Remove bogus use of $(VG).

commit 085815ce102e45bceefe8ea290dcf2efcd2dc74b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 22 12:30:37 2016 +0000

    build: Describe how to set up check-valgrind rules correctly.
    
    Since we enabled parallel tests, you can no longer run tests
    under valgrind merely by doing:
    
      TESTS_ENVIRONMENT = $(top_builddir)/run --test $(VG)
      check-valgrind:
          $(MAKE) check VG="@VG@"
    
    The reason is that the parallel tests framework doesn't run
    ``$(TESTS_ENVIRONMENT) <test>''.  It inserts some other processes in
    between the environment and the test, so you end up valgrinding some
    unrelated process (currently the 'env' program).
    
    In run.in, remove out of date documentation for using $(VG).
    In guestfs-hacking(1), document how to do it properly.

commit 789d256645c4c4e4da088550628a9afef2137212
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Feb 22 17:13:38 2016 +0100

    python: tests: fix long/int mismatch in test090RetValues.py
    
    Cast the value to the "int_type" representing the "long" value for
    test_rint64, so the test works again with Python 3.

commit 519c9bc8dfadaa80e8f84d38b2cd8a219c7a22a1
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Feb 22 16:57:57 2016 +0100

    python: tests: move the 'int' type in tests_helper
    
    This way it can be used in other tests as well.
    
    Simple code motion.

commit 977661530138e08a530c9ad03391333767db8709
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Feb 22 16:57:15 2016 +0100

    python: tests: refactor to use unittest's discovery
    
    Instead of running all the tests manually, the unittest module has a
    'discovery' mode to run tests by importing them from a directory: this
    requires the tests to have different filenames, since they need to be
    imported as modules now (hence an empty __init__.py is added), and the
    current naming does not match the convention.
    
    Using unittest as loader/runner brings another change: tests skipped as
    whole cannot be done anymore with exit(77), since they are not run but
    imported: thus introduce an helper module with decorators applied to the
    test classes to skip them according to the current checks.  This also
    gets us nicer recordings in the unittest log.
    
    Due to the relative imports (needed for the helper code), it is no more
    possible to execute tests anymore by invoking them manually; although
    it is possible to run single tests, still using unittest's runner:
    
      $ cd python
      python$ ../run python -m unittest discover -v t test010Load.py
    
    This does not change anything in what the tests do/check.

commit 961721b64b962c1a1797e45768d4007f84988c59
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 22 10:17:41 2016 +0000

    FAQ: Link to posting about compiling libguestfs from source.

commit 34e7b6961281ba8bd8a36fa798b735c670ad31a9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 22 09:54:10 2016 +0000

    FAQ: cache=none, not cache=unsafe, prevents qemu from caching.
    
    Thanks: kaze on IRC.

commit 3fa03a30b3ee766d0c09a79802f326b09f6b66a7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 19 12:46:22 2016 +0000

    build: installcheck: Ensure libguestfs.so is copied.
    
    If you ran 'make installcheck' when libguestfs-devel was not
    installed, then the installcheck would fail in many places with:
    
      gcc: error: ../../src/.libs/libguestfs.so: No such file or directory
    
    We should stop the installcheck script immediately if the .so file was
    not found.
    
    Also this commit ensures that src/.libs/libguestfs.so* not existing
    before installcheck is not fatal.

commit 2e87face9e0a1b2d9e426bb3a6dfbb07228be7d5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 19 08:57:15 2016 +0000

    v2v: windows: Change wording of warning about basic VGA display driver (RHBZ#1309619).

commit 9854ea913ab7c9d1e043213789111c51828a271a
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Feb 19 09:47:37 2016 +0100

    gobject: ship also run-tests-retvalues
    
    Fixes commit f7765ea6e437755e9c624a510d43210fbf4d4544 and
    commit 3787ebace472042c1c5b28014e3bc4266e81c1f5.

commit cbf0714e0745af18a27d8ac2dc72689a8cb296e4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 18 14:41:43 2016 +0000

    v2v: RHEV: Treat Windows 8.1 x86 client as Windows 8 (RHBZ#1213324).

commit 7bf820b0d9cc94c6291525c45b359177a11170d7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 18 14:41:43 2016 +0000

    v2v: RHEV: Treat Windows 8.1 client as Windows 8 (RHBZ#1309580).

commit 5431eda3a61849ab8f0e3e2d3f78643b593d4d27
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 18 14:00:09 2016 +0000

    v2v: Make the error message actionable when cannot find libvirt pool.
    
    Make this error message useful and actionable by suggesting commands
    that the end user can run to find available pools, etc.
    
    I also had to extend the fixed size buffer we use for messages since
    the message got truncated.

commit ba839f553b3d3a582f8d463abd9dec8ce6631d4e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 18 10:06:27 2016 +0000

    v2v: OVF: In warning, display inspect.i_arch field.
    
    See: https://bugzilla.redhat.com/show_bug.cgi?id=1213324#c11

commit d87c6fd6f206d4749f32ebcb821bbe3e423895ff
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 18 10:00:45 2016 +0000

    v2v: Add Windows 10 to OVF.
    
    See https://github.com/oVirt/ovirt-engine/blob/master/packaging/conf/osinfo-defaults.properties

commit 6200ae7204f4db3b93707acf7356083e121f854f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 16 12:30:00 2016 +0000

    v2v: glance: Allow Glance backend to import multiple disks (RHBZ#1308769).

commit bae3d92e88b7e74af11a5d0905710cf00f2504e3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 16 12:29:41 2016 +0000

    v2v: glance: Add "OUTPUT TO GLANCE" section to the documentation.

commit 3787ebace472042c1c5b28014e3bc4266e81c1f5
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Feb 17 10:26:35 2016 +0100

    gobject: ship correct .js file
    
    Fixes commit f7765ea6e437755e9c624a510d43210fbf4d4544.

commit 967e887e43cea3ffb6572b24cc995a0bb893e80f
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Feb 16 14:42:44 2016 +0100

    v2v: update URL with glance metadata

commit f7765ea6e437755e9c624a510d43210fbf4d4544
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Feb 15 18:32:07 2016 +0100

    Start adding return values tests for bindings
    
    Introduce a new kind of bindings tests, 090-retvalues, to check all the
    possible return values in bindings; start implementing them for
    scripting languages such as GObject introspection, Perl, PHP, Python,
    and Ruby, reusing existing implementations where existing.

commit 938f48f08a37791e8ebd6245d19b53f9660b30d2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 15 10:40:11 2016 +0000

    v2v: Fix CompatibleIDs for Windows > 7 conversions.
    
    Thanks Joshua Pincus for finding the bug.
    
    I checked back with the original W2K8R2 guest which I had used for
    getting these registry entries, and there was a transcription error
    with two of the CompatibleIDs.

commit 2a2a5404363b42144f6632fb467f2edc3ce4c663
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Feb 12 17:57:58 2016 +0100

    python: tests: use more targeted assert*() functions/checks
    
    - use assertIsInstance, assertNotEqual, and assertIsNotNone as more
      specific checks (will produce better logging)
    - use assertRaises when expecting exceptions being thrown
    - when testing internal_test_rhashtable, instead of checking type and
      elements of the return values just check the return value as a whole
      (easier and already getting all the work needed by unittest)

commit 6629cb0d91b24c2bc4e36863ecd1082bb95f53fb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 12 15:57:51 2016 +0000

    Version 1.33.12.

commit 85b1815e7be07d27b21692b6677b66817b3ea88b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 12 14:10:07 2016 +0000

    tests: Make '080' be an official test of the guestfs_version API.
    
    Useful because it tests returning a single structure.

commit b647dd8b52a9ae0fe5ecf48c484b1befd551525b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 12 15:07:51 2016 +0000

    python: tests: Use the 'unittest' module to run the test suite.

commit 2e16e3e99324112845446c82b6a6e8b3e652e10d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 12 13:41:26 2016 +0000

    daemon: lvm: Ignore LVs with the activationskip flag set (RHBZ#1306666).
    
    When listing logical volumes, ignore the ones which don't get
    activated automatically.  No /dev/VG/LV device node is created for
    these ones which confuses APIs that attempt to do 'guestfs_lvs'
    followed by opening the device node.  Note that 'guestfs_lvs_full' is
    unaffected by this change.

commit 7a598a0c02201394c6c0a5da7ab62a97d4271ed1
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Feb 12 15:10:07 2016 +0100

    php: restructure and expand tests
    
    Rename the existing tests according to the naming/numbering described in
    guestfs-hacking(1), and improve the current ones:
    - guestfs_php_001.phpt: rename to guestfs_020_create.phpt
    - guestfs_php_003.phpt: rename to guestfs_070_optargs.phpt
    - guestfs_php_bindtests.phpt: rename to guestfs_090_bindtests.phpt
    - guestfs_090_version.phpt: new, checks taken from the former
      guestfs_php_002.phpt
    - guestfs_100_launch.phpt: new, modelled after the equivalent in e.g.
      OCaml/Perl/Python
    - guestfs_php_002.phpt: remove, as what it did is now covered by
      090_version and 100_launch

commit 97539868191a76c77d655e96c85ccd3a3060b453
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Feb 11 18:40:04 2016 +0100

    fish, sysprep: run FUSE-related tests only when FUSE is available
    
    They will fail anyway in that case, so run them only when the FUSE
    support is built in.

commit 18fa1912508fa069a5bb068bbffda12e58615df9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 10 14:44:35 2016 +0000

    v2v: Small documentation fix in permissions section.
    
    In vCenter 5.5 at least, it's 'Sessions', not 'Session'.

commit eae73a5aa9743626c0543ebdedaa166feed592ed
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 10 14:43:09 2016 +0000

    Revert "v2v: Document that vCenter etc permissions must be set to "OK"."
    
    On further examining the incredibly confusing VMware dialogs, I don't
    believe this is true after all.
    
    This reverts commit e76128a20b65999073f1cc78a222526878632aa6.

commit e76128a20b65999073f1cc78a222526878632aa6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 10 13:17:52 2016 +0000

    v2v: Document that vCenter etc permissions must be set to "OK".
    
    And that READ_ONLY access is insufficient.  I believe this is a bug in
    libvirt, but it requires further investigation.  If it is resolved in
    libvirt then we can update this documentation again.
    
    Thanks: Ulhas Surse

commit 2f461b7cb8fa01eb8edd66bbb11bcc6b00f00295
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Feb 10 14:15:05 2016 +0100

    Update zanata.xml
    
    Update the Zanata configuration based on what Zanata itself proposes as
    project configuration.

commit f9686217b57b061d41f96ef2f75e378e6dd20e5e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 10 11:03:53 2016 +0000

    docs: Add recipe for FUSE-mounting a Windows guest with drive letters.
    
    Thanks: Pino Toscano, Hilko Bengen.

commit 3a9643834c540c7a762743fc34d9878933a597b2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 10 10:43:09 2016 +0000

    docs: Alphabetize headings in guestfs-recipes(1).
    
    No change, just reorder a section so they are in alphabetical order.

commit 92ea4ed5f78fa4233f494144fcd4e1f69a243a0a
Author: Roman Kagan <rkagan@virtuozzo.com>
Date:   Tue Feb 9 17:42:00 2016 +0300

    v2v: move virtio_win to windows_virtio
    
    Now that all the stuff related to Windows virtio drivers has been moved
    into a dedicated module, it makes sense to move the definition of
    virtio_win there, too, and stop passing it around as a parameter.
    
    Signed-off-by: Roman Kagan <rkagan@virtuozzo.com>

commit 511280c07650710f2a238e638921f70ef85776a3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 9 13:03:43 2016 +0000

    Version 1.33.11.

commit 41afeb266ddd46e1b2a0700facfa202dae2386ae
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Feb 9 14:18:15 2016 +0100

    tmpdirs: fix typo in variable name
    
    On mkdtemp error, free tmppath and not tmpdir (which is CLEANUP_FREE).
    
    Fixes commit 673a7a959c15e9a389a13620f3a10cb12a9537d0.

commit 15d28b09c0cb755289c07926a69fbe6d632d25de
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Feb 9 14:15:06 2016 +0100

    tmpdirs: centralize permissions handling
    
    Move to lazy_make_tmpdir the logic for making world-readable (but only
    for root) newly-created temporary directories, removing the non-fatal
    code doing that in guestfs_impl_launch.
    
    Followup of commit 772f649e595d202bdb67f05aeb62157c1104be89.

commit 772f649e595d202bdb67f05aeb62157c1104be89
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Feb 9 11:36:23 2016 +0100

    lib: fix sockdir for root
    
    When running as root libvirt will launch qemu as qemu.qemu, which will
    not be able to read inside the socket directory in case it is set as
    XDG_RUNTIME_DIR under /run/user/0.
    
    Since normal users don't need particular extra access permissions for
    their sockdirs, restrict /tmp as only possible sockdir for root,
    changing the permissions only for this user (and making this operation
    fatal).
    
    Fixes commit 55202a4d49a101392148d79cb2e1591428db2681 and
    commit 7453952d2456272624f154082e4fc4244af8e507.

commit d5c0f85c6e3979f54938584bb06b752efc8bb816
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 8 17:52:29 2016 +0000

    Version 1.33.10.

commit fcf1884932536d87c927c3b58a3f1b4512500bf0
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Feb 8 16:55:19 2016 +0100

    tests: reduce sizes of scratch disks to 2 GB
    
    1 GB should be enough to create a btrfs filesystem, even with 64K page
    size; hence, make the /dev/sda and /dev/sdb test devices smaller so
    there is less space taken during the test run.
    
    Followup of commit 8ffad75e5b610274a664a00f1f1186070b602e18 and
    commit 9e9b648770f9b8dbe8f280e4b5d1f80c4d689130.

commit 7453952d2456272624f154082e4fc4244af8e507
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 8 17:09:48 2016 +0000

    launch: Set sockdir mode to 0755.
    
    https://bugzilla.redhat.com/show_bug.cgi?id=610880
    
    Fixes commit 55202a4d49a101392148d79cb2e1591428db2681.

commit 7fd17fa99d838f5a3b8586f900de4784dd6205a8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 8 17:09:48 2016 +0000

    launch: libvirt: Debug sockdir not tmpdir.
    
    Fixes commit 55202a4d49a101392148d79cb2e1591428db2681.

commit 7cb28488a6b974c86a9dd0264d892cd01739c36e
Author: Dawid Zamirski <dzamirski@datto.com>
Date:   Sat Feb 6 11:50:05 2016 -0500

    inspect: get windows drive letters for GPT disks.
    
    This patch updates the guestfs_inspect_get_drive_mappings API call to
    also return drive letters for GPT paritions. Previously this worked
    only for MBR partitions. This is achieved by matching the GPT partition
    GUID with the info stored in the blob from
    HKLM\SYSTEM\MountedDevices\DosDevices keys. For GPT partions this blob
    contains a "DMIO:ID:" prefix followed by a 16 byte binary GUID.

commit 985a69325109b36e448ec87ec55ca4e9e5e4d510
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 5 19:11:47 2016 +0000

    Version 1.33.9.

commit 8cba70c038dc803056b0da32ad79f2c546da5c93
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 5 13:16:36 2016 +0000

    lib: Stop exporting the safe_malloc, etc. functions.
    
    As was forewarned in the comment, stop exporting these functions
    outside the library.

commit 32cd056ff88993ef123db5437a6e75535fb6c248
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 5 14:08:30 2016 +0000

    ruby: Stop using the safe_malloc, etc. functions.

commit 4b96331ad5b017206198f4565c78f19a42d6b8c4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 5 13:35:29 2016 +0000

    perl: Stop using the safe_malloc, etc. functions.

commit 2a48a6591fc7f4f3d8bc46d628c43d5ab126215f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 5 13:16:22 2016 +0000

    java: Stop using the safe_malloc, etc. functions.

commit ae750fcfe0e5c134c99b29b0e273a932fcca8002
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 5 13:15:59 2016 +0000

    python: Stop using the safe_malloc, etc. functions.

commit 0445284dfba134f589b57c0039baf0b3912a4484
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 5 13:15:48 2016 +0000

    ocaml: Stop using the safe_malloc, etc. functions.

commit 0b1046577258f6f1697c9e956989a1d368084357
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 5 13:04:57 2016 +0000

    java: Fix documentation of @throws.
    
    The javadoc @throws directive requires a string documenting
    when the exception is thrown.

commit 7ac9127bf4b4dd7d6f6b9ac9769003a0616dc97d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 5 09:16:52 2016 +0000

    v2v: Move the other OVMF paths into the core library.
    
    Refactoring change, continuing the theme from the previous commit.

commit 4ac6ff6b47a4106091e4cf33b2ab6ca2f231bf9f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 4 18:22:10 2016 +0000

    aarch64: Use a common table of AAVMF paths.
    
    Previously the code had two places where an identical set of AAVMF
    paths were stored.  Put this information into one place.
    
    This is just refactoring.

commit 13c3698358a4de82179dba3c8855f56746525aa7
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Feb 4 10:49:31 2016 +0100

    customize: add globbing for --delete
    
    Support globbing in paths passed to --delete, telling glob to not
    return directories with leading slash.
    
    This re-adds back globbing for --delete in virt-sysprep, which was
    available before the integration with common code from virt-customize.

commit 01f46e4e3128b8d8ab009ca198de440e776c2cd6
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Feb 4 10:45:20 2016 +0100

    daemon: glob: add optarg to control trailing slash for dirs
    
    Add a new optional bool "directoryslash" to indicate whether the caller
    wants trailing slashes in names of directories, defaulting to true (the
    current behaviour); this helps with interoperability with other tools
    (such as rm).
    
    Related to RHBZ#1293271.

commit 14b8e67f0b3d898f19fc0764a20e7b60568a1e4f
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Feb 3 18:09:56 2016 +0100

    sysprep, get-kernel: explicit the Guestfs parameter
    
    Help the OCaml compiler by expliciting Guestfs.guestfs as type for 'g'
    in some functions.

commit fe7fceba6e82cb436acd1ba3b6080f53190983e7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 3 21:35:48 2016 +0000

    v2v: Replace "=" by "_" in OVF .meta DESCRIPTION field.
    
    The current VDSM .meta file parser is incorrect:
    
      https://code.engineering.redhat.com/gerrit/gitweb?p=vdsm.git;a=blob;f=vdsm/storage/fileVolume.py;h=20573bd2a3fe6909a8474bd7c53c8d0fea79091c;hb=c1289fd70edcde0a0b3bc8e37ecad1e2a5babe1a#l285
    
    When parsing the key=value fields in the .meta file, it uses the
    Python expression:
    
      key, value = l.split("=")
    
    which throws an exception "ValueError: too many values to unpack" if
    the value part also contains an "=" character (because split returns
    an n-tuple with n > 2).  The correct way to split the string in this
    situation is to use l.split("=", 1).
    
    In commit 399e031c25a5385a3f918d0a604e2751bd34242f I changed the
    DESCRIPTION field in .meta so that in RHEL it would look like this:
    
      DESCRIPTION=generated by libguestfs 1.32.2rhel=7,release=1.el7,libvirt
    
    thus containing an "=" character in the value and throwing an
    exception in VDSM.
    
    Although this is a bug in VDSM which needs to be fixed separately,
    change any occurrence of "=" in the value to "_" to avoid this
    problem.
    
    Thanks: Derrick Ornelas for helping to diagnose this bug and finding
    the offending code in VDSM.

commit 9e9b648770f9b8dbe8f280e4b5d1f80c4d689130
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 3 17:10:15 2016 +0000

    tests: btrfs: Use a 2000 MB partition for btrfs test (instead of 200 MB).
    
    One of the mkfs-btrfs tests used two 200 MB partitions.  That isn't
    enough to create a btrfs filesystem on aarch64 (with 64K page size).
    Since we now have a 10 GB disk, we can make the test partition 10
    times larger.

commit 5238c4ee0a07d3b97bfe5fcc23c1f70a6d008066
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 3 17:08:09 2016 +0000

    tests: btrfs: Don't test --leafsize, and use --nodesize 64K.
    
    In btrfs-progs 4.4, the --leafsize parameter is deprecated.  It's now
    just an alias for --nodesize.
    
    On aarch64, --nodesize 4096 does not work because it's smaller than
    the page size (64K).  Luckily we can test a 64K nodesize on any
    platform, so use that instead.

commit 8ffad75e5b610274a664a00f1f1186070b602e18
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 3 16:53:17 2016 +0000

    tests: Increase the size of the /dev/sda and /dev/sdb test devices.
    
    Previously these were rather small - just 500 MB.  This is too small
    to create a btrfs device on aarch64 (where page size may be 64K), and
    barely enough even on x86-64.  This change makes both these devices
    10 GB, and adjusts a few tests so they continue to pass.

commit c055f842d721ef57ddd7bfd44c5c28058995e380
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 3 13:32:05 2016 +0000

    Version 1.33.8.

commit f88e9318667981d8ea7e0f699fde305ca064cbb5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 2 12:08:35 2016 +0000

    resize: Use sparse copy for extended partitions unless --no-sparse.
    
    Thanks: Maxim Perevedentsev

commit d3502bdc32629c63e6d8b9e313a0c968d7b1e5b7
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Feb 3 13:24:37 2016 +0100

    generator: simplify generated code for always-available features
    
    Just refer to the dummy function directly, instead of using #define's.

commit 55202a4d49a101392148d79cb2e1591428db2681
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Feb 3 13:15:29 2016 +0100

    New API: get-sockdir
    
    Introduce a new read-only API to get a path where to store temporary
    sockets: this is different from tmpdir, as we need short paths for
    sockets (due to sockaddr_un::sun_path), and it is either
    XDG_RUNTIME_DIR if set, or /tmp; adapt guestfs_int_create_socketname
    to create sockets in that location.
    
    Furthermore, print sockdir and XDG_RUNTIME_DIR in test-tool for
    debugging.

commit 4f7251f8969d11d3b78cf05c0171ffbadd0024f8
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Feb 3 12:51:26 2016 +0100

    launch: add internal helper for socket paths creation
    
    Introduce an internal helper to create paths for sockets -- will be
    useful for changing later the logic for placing sockets.
    Futhermore, check that the length of sockets won't overflow the buffer
    for their filenames.

commit 673a7a959c15e9a389a13620f3a10cb12a9537d0
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Feb 2 12:44:13 2016 +0100

    lib: extract lazy tmpdir creation helper
    
    Extract the bit of code for lazy creation of a temporary directory, so
    it can be used for more directories as well.
    
    This is just code motion, with no behaviour changes.

commit dbad317120663d43fec2530420372d06e63a2f6b
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Jan 29 17:56:22 2016 +0100

    launch: libvirt: cleanup sockets on shutdown
    
    Unlink the sockets in the shutdown callback, instead of right before
    creating a new ones.  This makes sure we are unlinking the right
    sockets.

commit e31e3ccd8f3d42583227c77c811d0aeb8eff5269
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Jan 29 17:50:42 2016 +0100

    launch: libvirt: move socket path variables
    
    Move the paths of the sockets used, from the libvirt_xml_params struct
    to backend_libvirt_data; this way, they will be usable also outside the
    launch callback.
    
    Simply code motion.

commit cfedf73b3da51b1dba9be900a4f51201ed660629
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Jan 29 16:19:01 2016 +0100

    launch: direct: cleanup daemon socket on shutdown
    
    Unlink the daemon socket in the shutdown callback, instead of right
    before creating a new one.  This makes sure we are unlinking the right
    socket.

commit 0f6a3b13a5dfcc834619cec4c9e018a1a58418c7
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Jan 29 16:03:06 2016 +0100

    launch: direct: save the path of the daemon socket
    
    Save the path of the socket passed to qemu for communication with
    guestfsd; we will need it to clean it correctly.

commit 79b2f19fe7ba1843146e89e2267f066ed6eeeb5b
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Jan 29 16:01:21 2016 +0100

    launch: unix: check for length of sockets
    
    Error out early if the path to the socket will not fit into
    sockaddr_un::sun_path, as we will not be able to connect to it.

commit e8ce35b007d52c8c3aac0da085b24c1fb4e750f4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jan 31 16:00:00 2016 +0000

    FAQ: Add answer about unsupported use of NTFS in RHEL 7.2.

commit 19f3689e5dcd06a0967ba88b5516a7ce70203576
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jan 31 14:22:14 2016 +0000

    v2v: Split with_hive into with_hive_readonly, with_hive_write.
    
    I find the code slightly easier to read if we get rid of the ~write
    flag, and instead split the with_hive function into two functions, one
    for readonly access, and one for write access.
    
    This is just code refactoring.

commit 53cc0370b26e1d260e31f471409c7d903a1e9c22
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jan 31 14:14:37 2016 +0000

    mllib: Add 'protect' function (like try/finally).
    
    Use the function in the virt-v2v [Windows] module.
    
    This is just refactoring.  There is no visible change in
    functionality.

commit db3e2023ebf83d291725a6c086359d8025153079
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jan 31 13:58:57 2016 +0000

    mllib: Move the maybe type (like Haskell Either) to common library.
    
    Just code motion.

commit 14d80452dc50e873f76d181758b64582353dc6c9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 29 20:57:49 2016 +0000

    arm: Disable -Wcast-align warning.
    
    Any modern system can handle unaligned memory access.  On armv7 it's
    slightly slower, that's all.

commit 8a910136e4e33fe5398069c198b105527b011d21
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 29 12:50:12 2016 +0000

    v2v: windows: Remove unused code left over by previous commit.
    
    As this code wasn't exported in the module interface, it cannot have
    been used anywhere.
    
    Fixes commit b76f27142560d47648cc3cba1a19f753a78bafcb.

commit b6a7aaf0d0bc34946f4885c87c09952342c3e17d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 29 12:39:05 2016 +0000

    v2v: Remove items from TODO which have been implemented already.

commit 825ff5d04dc139baf6fb7370cd57dd61d8fc2756
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 29 10:26:27 2016 +0000

    Version 1.33.7.

commit b76f27142560d47648cc3cba1a19f753a78bafcb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 29 09:46:48 2016 +0000

    v2v: windows: Move all virtio driver installation code to common module.
    
    Add a common module `Windows_virtio' and move all the code related to
    finding and installing Windows virtio drivers to this module.
    
    This is just code motion and code refactoring, there is no change in
    functionality.

commit 0ac8894f6234c9d04ebab6854eb7957bcbfd735e
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Jan 28 18:23:55 2016 +0100

    inotify_add_watch: pass IN_ALL_EVENTS as mask for test
    
    Instead of pass 0x3fffffff as mask value, pass a simplier 0xfff, which
    is the value of the IN_ALL_EVENTS define.  This will still catch all
    the inotify events, and avoid a EINVAL error with Linux 4.4.

commit 6db3c4099f78a438f3f6af571b6c010c9cbe47c3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 29 08:56:10 2016 +0000

    v2v: windows: Update comment about device number key.
    
    Thanks: Vadim Rozenfeld for finding the TechNet documentation
    related to this key.

commit b2a10de6db4f3185d3be1e403404f06742fa81d1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 29 08:52:09 2016 +0000

    v2v: Add location of SUSE UEFI binaries.
    
    Thanks: Jim Fehlig

commit 52e7085d183ddf44eb7b92770a15363ea5f06610
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 28 22:03:32 2016 +0000

    ruby: Rename internal C functions with more consistent naming.

commit f9259c7ba4b91fc7dbe8d0b2d99f629a64c2ad74
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 28 21:53:38 2016 +0000

    lua: Rename 'guestfs_lua_' functions to 'guestfs_int_lua_'.
    
    Actually these are all static functions, so they don't really need the
    'guestfs_' prefix at all, but using a prefix avoids any possibility of
    a collision with a standard C function.
    
    This is a mechanical refactoring.

commit 1a9312c7439c94ebc17d0b4984af8130df6b03a7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 28 21:49:47 2016 +0000

    python: Rename 'py_guestfs_' functions to 'guestfs_int_py_'.
    
    Purely mechanical change, done by a Perl script (hah!)

commit 14cd9a031a898814895faed78f5e3a777b17fbcf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 28 21:38:18 2016 +0000

    java: Rename internal C function without guestfs_ prefix.

commit 53403fbdef1aa5ebfa7ec2fa4fa9191f19fe899b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 28 21:25:18 2016 +0000

    ocaml, virt tools: More consistent naming for C functions.
    
    For functions linked to virt tools, make sure the name of the function
    actually matches the virt tool.  Because of the history of moving
    functions across tools, some names no longer matched.
    
    For mllib, use `guestfs_int_mllib_' prefix.
    
    For OCaml bindings, use `guestfs_int_ocaml_' prefix.
    
    This commit is by no means complete.  There are many other C functions
    in other language bindings which could do with being more consistently
    named.
    
    There is no functional change, this is just refactoring.

commit e32a14ceecbd706052ab4b0282ff33db1ea6db1e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 28 21:03:22 2016 +0000

    docs: Remove reference to double underscore, which is no longer used in internal identifiers.

commit 41251816817f9780f93521fa011a6370b011fbc4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 28 21:00:54 2016 +0000

    docs: Rework headings in guestfs-hacking(1) manual page.

commit 98332e8c85d768d7c07457a1217fd58107cd1477
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 28 20:58:08 2016 +0000

    docs: Move section about local* files to guestfs-building(1).
    
    Since it is part of the instructions for building libguestfs, it goes
    better in the guestfs-building(1) man page.

commit f9e8f3b2d2cf1acdf9573faceb844b8d50bae69d
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Jan 28 15:38:11 2016 +0100

    lvm: support lvm2 older than 2.02.107
    
    lvm2 2.02.107 adds the -S/--select option used in lvs to filter out only
    public LVs (see RHBZ#1278878).  To make this work again with versions
    of lvm2 older than that, only on old versions filter out thin layouts
    and compose the resulting device strings ourselves.
    
    The filtering done is much simplier than what "-S lv_role=public" will
    do, but should be good enough for our need.

commit 569ad259b4726fbdabf380bdca34da00ca262e1e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 28 13:55:20 2016 +0000

    v2v: linux: Find dracut if it is located in /usr/bin.
    
    In Fedora 23, dracut moved to /usr/bin.  However we only looked for
    /sbin/dracut, so we didn't find it.  You would have seen a failure
    like this:
    
      virt-v2v: error: unable to rebuild initrd
      (/boot/initramfs-4.2.3-300.fc23.x86_64.img) because mkinitrd or dracut was
      not found in the guest
    
    Look for dracut in /usr/bin as well.
    
    Thanks: Arnaud Bougeard.

commit 2bccaa30473d3f638e48486906fbff94f30ee0ed
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Jan 28 14:23:02 2016 +0100

    python: stop using parens-less print in tests
    
    print "" is no more available in Python 3, and print(...) is available
    since Python 2.7; as one of the tests was using print(), use this form
    everywhere so the tests can run fine with Python 3.

commit a6c7b39530ace55b98ac7288a5fa4f0723332a54
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 28 13:00:28 2016 +0000

    v2v: windows: Don't hard code "oem1.inf" string.
    
    Find the next free "oem%d.inf" string.
    
    Thanks: Vadim Rozenfeld for clarifying what we should be doing
    in this case.

commit 58ce08f36f4a83c74bef1329f6dabb78708f8a6e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 28 13:00:16 2016 +0000

    v2v: Abbreviate a couple of comments.
    
    No functional change.

commit b12f0a809f7d1aef9215d25bda2f0a2fd955d0f8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 28 12:37:33 2016 +0000

    GCC 6: Avoid warning about logical OR of "equal" expressions.
    
    The warning (see below) is fairly useless.  This modification to the
    code avoids it.
    
    inotify.c: In function 'do_inotify_read':
    inotify.c:219:32: error: logical 'or' of equal expressions [-Werror=logical-op]
           if (errno == EWOULDBLOCK || errno == EAGAIN) /* End of list. */
                                    ^~

commit b1b15dc77dd12605dd21021b146bd842c069aa54
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 27 17:36:03 2016 +0000

    Version 1.33.6.

commit c323bb7db73a28f05d70fa774c702d48bd631bfa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 27 12:03:23 2016 +0000

    p2v: tests: Don't supply os-version in test.

commit c355b748ce4684a0b5a5d5ff24362b01b7900460
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Jan 27 14:23:48 2016 +0100

    actions: mark btrfs test case of vfs_minimum_size as TestRunOrUnsupported
    
    The btrfs implementation of vfs_minimum_size requires
    btrfs-progs >= 4.2, erroring with ENOTSUP otherwise; thus mark the btrfs
    test case of the vfs_minimum_size tests as TestRunOrUnsupported, so it
    will not cause failures if the available btrfs-progs is not enough.

commit ceefa701c6b650a2c5cb7a2faef7c4c261bd25ab
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Jan 27 14:17:22 2016 +0100

    generator: add TestRunOrUnsupported test type
    
    Create a new TestRunOrUnsupported test type, which represents a test
    sequence where a failure with ENOTSUP in the last command only marks the
    test as skipped.  To be used mainly when testing features available only
    with some versions of helper tools used in the appliance, for example.

commit 474e3051c7c503341f0546b837cacdaf422d4e84
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Jan 27 14:09:16 2016 +0100

    btrfs: also check return value of sysroot_path in btrfs_minimum_size
    
    Followup of commit 79ac68030f82ade1e686484e4f77d8e05a38c41b.

commit 79ac68030f82ade1e686484e4f77d8e05a38c41b
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Jan 27 13:45:24 2016 +0100

    btrfs: fix leak in btrfs_minimum_size
    
    Make sure the result of sysroot_path is properly free'd.

commit fa262e254061ddd637a62d37f4ff10c99554d020
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Jan 27 13:29:16 2016 +0100

    btrfs: fix wrapping in message in btrfs_minimum_size

commit 3aaa4c9419d539dada31004b47121bbaac5241c6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 27 11:48:53 2016 +0000

    p2v: virt-p2v-make-disk: Make os-version parameter optional.
    
    Having to choose the os-version of the virt-p2v disk was confusing.
    Users thought it had something to do with the physical machine being
    converted.
    
    In some cases, virt-p2v-make-disk can now choose a suitable os-version
    for the user.  Usually it's the latest numeric version of Fedora or
    Debian, depending on the host distro.  If we don't recognize the host
    distro, we bail and ask the user to choose, but this is still an
    improvement.

commit 42f8c6e3bdf56ba556329d59473146dc5bdf1cac
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 27 11:48:17 2016 +0000

    p2v: Use $program consistently in virt-p2v-make-disk script.

commit c3ad944555f7d942fbeae2b60902d4ab5e0c523e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 27 11:38:09 2016 +0000

    p2v: Fix typo in virt-p2v-make-disk manual page.

commit 683dd5cbab506572e2f0d2c9becf2c6404b8b46b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 26 22:18:42 2016 +0000

    docs: Refresh the guestfs-testing(1) man page.
    
    Require libguestfs >= 1.22.  Testing ancient versions isn't useful.
    
    Add a virt-builder test section.

commit 09e29a70e7ac68e71b9a4c6d535021d2111133ba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 26 21:49:04 2016 +0000

    docs: Fix headings in guestfs-security(1).

commit e96df6e7766d73c3ab313932c5ecc81ad2efcc84
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 26 21:45:17 2016 +0000

    docs: Add security contact information.

commit 1b4de75cb04204c8a68eaae414f8458b05038889
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 26 21:38:12 2016 +0000

    docs: Refactor list of manual pages in guestfs(3).

commit 1b3d3a3589fd6ec1a9e047ec9f14533f1007ba53
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 26 21:24:33 2016 +0000

    customize: Remove "useless" sprintf.
    
    Actually the OCaml compiler rewrites all printf functions at compile
    time to a series of primitive string operations, so the use of sprintf
    here doesn't really matter.  Still, it's a bit tidier not to use
    sprintf where it's not needed.
    
    Also this commit contains some code reformatting.
    
    This is just refactoring.

commit 81ff8c5d23642667569833cd820e84814157580b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 26 15:34:09 2016 +0000

    p2v: User can click on an interface name to identify the physical interface.
    
    When the user clicks on the second column of the list of network
    interfaces, run 'ethtool --identify <if_name> 10', which (on supported
    cards) flashes a light on the physical interface for 10 seconds,
    allowing it to be identified by the operator.

commit 4470f0483bc820cf2c29c017aadbf01b5d266314
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 26 16:01:02 2016 +0000

    customize: Add support for the APK (Alpine Linux) package manager.

commit 7adb8ffa612a3b2f948492a4ac80cc3cc37223de
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jan 26 18:49:55 2016 +0100

    inspect: resolve symlinks when detecting architecture
    
    Resolve the paths of the binaries we are looking in the guest to
    identify the architecture. This way we can identify also busybox-based
    guests such as Alpine Linux, where all the "base" binaries in /bin are
    symlinks to busybox.

commit 302bba4f3f84b5f411d180021ae23ed609ba5074
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 26 14:04:38 2016 +0000

    Version 1.33.5.

commit 5aa26e76eaba805bcf549c5520187d1bca24d77c
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jan 26 11:25:54 2016 +0100

    daemon: fold xfs_admin stdout to stderr
    
    Apparent newer versions of that report everything on stdout, including
    error messages; since we only print something on failure, fold stdout to
    stderr so we can see everything on failure.

commit 1d0bd79c08db525c5bda41d5a29f2ce9a823c10d
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jan 26 11:23:25 2016 +0100

    xfs_admin: do not set lazycounter in tests not checking that
    
    This flag cannot be disabled (yet) in V5 xfs filesystems; since 2 out
    of the current 3 tests of xfs_admin check other results than that flag,
    avoid setting it when not needed.

commit d2a36f8cbeb468fa01674050fce35571b399e385
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jan 26 11:21:46 2016 +0100

    daemon: improve debugging for "stdout on stderr" flag
    
    When the COMMAND_FLAG_FOLD_STDOUT_ON_STDERR flag is passed to
    command*(), indicate that as stdout=e in debugging message.

commit c22dea9871c1d112e1eed66efa128e1751c4d3d3
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Jan 25 19:53:42 2016 +0100

    btrfs_subvolume_show: fix root/toplevel check w/ btrfs-progs >= 4.4
    
    In trfs-progs 4.4 the error message has been changed, and our check did
    not work anymore.  Yes, parsing user messages really sucks...

commit 08bf961d68ccb800d568af8c59122fefdb1f8b56
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Jan 25 19:08:14 2016 +0100

    actions: expand partitions for btrfs_image test
    
    Apparently with newer btrfs-progs (seen with 4.4) 100M are not enough
    for a btrfs filesystem; hence double the size of the partitions
    created in the test of btrfs_image, so now 200M are enough for btrfs.

commit f2e201033a36d8a1770b055c9bc17ad48a2a0136
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jan 24 15:11:49 2016 +0000

    p2v: Use new miniexpect methods to access the handle fields.

commit 38edddb8e853046794ac51a7756e06ecb56b992d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jan 24 15:06:35 2016 +0000

    p2v: Resynch miniexpect with upstream.
    
    Upstream miniexpect commit 3df4c0d3e4192cb6bb8e9ed7126346ab6aa98043.

commit 86ec266f22849e17ef076e7255fda8609fa0e4ce
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jan 24 15:05:43 2016 +0000

    p2v: Handle mexp_close returning -1 correctly.
    
    If a system call fails, this function returns -1 and sets errno.  This
    case was not handled correctly.

commit b564e3682b5c1000ab35c1e5e80450a0369a7e31
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 22 22:19:22 2016 +0000

    arm: Remove all DTB (device tree) code.
    
    In commit af762e43424382d895d3a10aa6632adc601fdbad (2015-03-05)
    I stopped libguestfs from using the supermin -dtb parameter when
    building appliances.
    
    It has not been necessary for quite a long time to specify a DTB,
    since qemu itself creates a device tree structure in the guest
    (appliance) memory from the devices presented to the guest.  Qemu does
    this on the fly each time the guest starts.
    
    As I promised in the commit mentioned above I would remove this code,
    and this commit does that (for libguestfs only).

commit 1477c95da4f00577e281463e4c44b6cd2a5cf637
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 22 21:51:18 2016 +0000

    launch: libvirt: Reword an SELinux debug message.

commit bf469bca13340518c5211f86b16690579cbf3938
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 22 21:47:48 2016 +0000

    launch: libvirt: Refactor destroy_domain function.
    
    Small rewrite of commit 7e2f2b0b2410587b81fd42bf741e3a36a5e75f6f.  No
    functional change.

commit 2b9fda2f92be0fcb556286b81bf52483d538fd47
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 22 15:43:53 2016 +0000

    docs: Tested clang, and userspace probes now work.

commit e3ff6507e9fef3a3d3aa242f336e5218d316d2a6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 22 13:16:03 2016 +0000

    Version 1.33.4.

commit e23b44e2de9afe6dcd3f0b3c6fb7757af6f20e34
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 22 13:08:24 2016 +0000

    daemon: Link with cleanups.c.
    
    And remove the cleanup_* functions from guestfsd.c.
    
    This fixes commit d94860d7e8357b70d2a301f381fc41aca49c4369.

commit 2cb8e5ddb8a3d28c2076254ccc2ef2f53d0815d3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 22 12:52:33 2016 +0000

    Minor fixes to "daemon: Split out command* functions and CLEANUP_* macros."
    
    This updates commit d94860d7e8357b70d2a301f381fc41aca49c4369.
    
    Thanks: Pino Toscano.

commit ac5fe225a92f9cad28272a17739c204e899e8000
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 22 12:42:57 2016 +0000

    Version 1.33.3.

commit d94860d7e8357b70d2a301f381fc41aca49c4369
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 4 16:28:08 2015 +0000

    daemon: Split out command* functions and CLEANUP_* macros.
    
    This allows the command* functions and CLEANUP_* macros to be used
    independently from the daemon.

commit b5066c67e085ff7e7db7bc84903f9c11ccd38e57
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 4 16:19:43 2015 +0000

    daemon: Rename daemon/command.c -> daemon/sh.c.
    
    Simply a file rename, no other change.

commit 550fdefc3c550c4533cec780bdecf7030ecb0c9f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 21 13:37:19 2016 +0000

    p2v: Display architecture in the About dialog.

commit 6d25ad48e535b0b3adffba66e5f3974a5f9c0950
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 18 12:12:58 2016 +0000

    p2v: virt-p2v-make-disk: Allow --arch parameter to be supplied.
    
    This allows you to build a 32 bit virt-p2v USB key, even on a 64 bit
    host.
    
    Because of problems with the Fedora build system it's unfortunately
    not easy to build a 32 bit virt-p2v binary, so this patch punts on
    this issue and assumes that the user can supply the binary themselves.

commit d5222a3ab997b6bbf4c4e179fb2a9b9ff8a2680c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 21 12:35:42 2016 +0000

    p2v: Fix paths to data files in documentation.

commit e834b7413a9422280b540c467ff5a83b9e1ae924
Author: Maxim Perevedentsev <mperevedentsev@virtuozzo.com>
Date:   Wed Jan 20 13:02:11 2016 +0300

    New API: part_expand_gpt.
    
    This action moves second(backup) GPT header to the end of the disk.
    It is usable in in-place image expanding, since free space after
    second GPT header is unusable. To use additional space, we have
    to move second header. This is what sgdisk -e does.
    
    However, sgdisk -e may perform additional actions if the partition
    table has unexpected params (e.g. if we call sgdisk -e /dev/sda1,
    it may fix partition table thus destroying the filesystem).
    To prevent such cases, we do a dry-run at first and fail if
    additional actions are scheduled.

commit 390c68441a49aa4b983548dcfd9a41e717f6f5c9
Author: Roman Kagan <rkagan@virtuozzo.com>
Date:   Wed Jan 20 11:39:43 2016 +0300

    convert_windows: uninstall Parallels Tools on first boot
    
    If present, Parallels Tools may stand in the way of proper running the
    windows guests in non-Parallels hypervisors, so we're better off
    uninstalling them on the first boot into the new environment.
    
    With this patch, the uninstall records for Parallels Tools are looked up
    in the registry and, if found, corresponding firstboot actions are
    registered, taking special care that those actions are run fully
    unattended.
    
    Signed-off-by: Roman Kagan <rkagan@virtuozzo.com>

commit e40acef864ee9d628ad9b06cb44d2cd606d439be
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 20 17:25:09 2016 +0000

    Version 1.33.2.

commit 4a0905ac3638d441f2cf68d1bd125fbdf6745e82
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 20 17:05:53 2016 +0000

    tests: regressions: Allow test-big-heap to work on machines with less memory.
    
    This test would fail on machines with around 4 GB of free memory.
    Adjust the test so it would now work on such machines (it will however
    still fail on a machine with around 2 GB of free memory).

commit ce5607895f67e09e5b85bf5baeee661b3b0fe726
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 20 16:34:34 2016 +0000

    docs: Add requirement on ncurses.
    
    Previously missing from the requirements list.

commit 9310fabd26da1d00ddb2a3c0707b780614307a7d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 20 12:17:12 2016 +0000

    docs: Add guestfs-building(1) man page.
    
    This contains instructions for building libguestfs from source.

commit 50f838de316eefabb36dd429ff82cc04c4f0ff4b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 20 12:02:22 2016 +0000

    p2v, v2v: Move HACKING documentation to guestfs-hacking(1) manual page.

commit dce3b4649deefc2fb5e1d069f084661b0cb62a0a
Author: Maxim Perevedentsev <mperevedentsev@virtuozzo.com>
Date:   Tue Jan 19 15:03:01 2016 +0300

    resize: preserve GPT disk GUID.
    
    Changed disk GUID makes some OSes fail to boot.
    To enable virt-resize to support such OSes we
    have to preserve disk GUID.

commit 1af51b9b0296c7efa113817a5bc16bc74e89f667
Author: Maxim Perevedentsev <mperevedentsev@virtuozzo.com>
Date:   Tue Jan 19 15:03:00 2016 +0300

    New API: part_set_disk_guid_random.
    
    Provides a way to set a new randomly-generated GUID to disk.

commit 035936a0387c9d9b5890360109672032202f7cab
Author: Maxim Perevedentsev <mperevedentsev@virtuozzo.com>
Date:   Tue Jan 19 15:02:59 2016 +0300

    New API: part_get_disk_guid and part_set_disk_guid.
    
    Some OSes (e.g. Windows Server 2012 R2) fail to boot if the disk
    GPT GUID has changed. To preserve disk guid e.g. during virt-resize,
    we need a way to get/set disk GUIDs.

commit 7e2f2b0b2410587b81fd42bf741e3a36a5e75f6f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 19 14:09:33 2016 +0000

    lib: Handle slow USB devices more gracefully.
    
    Libvirt has a fixed 15 second timeout for qemu to exit.  If qemu is
    writing to a slow USB key, it can hang (in D state) for much longer
    than this - many minutes usually.
    
    The solution is to check specifically for the libvirt EBUSY error when
    this happens, and retry the virDomainDestroyFlags operation
    (indefinitely).
    
    See also the description here:
    https://www.redhat.com/archives/libvir-list/2016-January/msg00767.html
    
    Similar to the following OpenStack Nova commit:
    http://git.openstack.org/cgit/openstack/nova/commit/?id=3907867
    
    Thanks: Kashyap Chamarthy and Daniel Berrange.

commit c3ebc0a83761c552e6c19163b6d87044ae1ca635
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 19 16:01:46 2016 +0000

    launch: libvirt: In error messages, display err->int1, don't display domain.
    
    The err->domain field is essentially random from the point of view
    of libguestfs.
    
    The err->int1 field has some useful information in some circumstances:
    it has the errno value from the failed system call.

commit d029fa0507502dac77343a3a0131c23a1353938e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 19 12:58:06 2016 +0000

    Revert "p2v: virt-p2v-make-disk: Allow --arch parameter to be supplied."
    
    This won't work unless we also build a 32 bit virt-p2v binary.
    
    This reverts commit d723b352f8c10fb5244f17889cf68e13dd85c037.

commit 40b5698388689b54cf8b213a0adc72b35d6014b2
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Jan 15 11:27:48 2016 +0100

    daemon: resolve paths for ll and llz
    
    Resolve in the guest the given path, so absolute symlinks can be listed
    using appliance tools without resolution errors.
    Also remove the note about the possibility to escape the sysroot using
    ll and llz, since realpath won't return paths outside sysroot.
    
    Fixes part of RHBZ#1293276.

commit 3f376fa5137d73df681cc5eaaa9b5e4206d57fce
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 18 17:06:36 2016 +0000

    p2v: virt-p2v-make-disk: Use a more robust way to get the latest kernel version.
    
    Fedora/i686 does not have a package called 'kernel', so the command
    'rpm -q kernel' fails.  In any case the method used wasn't exactly
    very robust.
    
    The new method is based on how febootstrap used to do this.
    
    This updates commit d723b352f8c10fb5244f17889cf68e13dd85c037.

commit 4a7b32a7e2ce0ea4070a3753f3cc28ca33db4992
Author: Maxim Perevedentsev <mperevedentsev@virtuozzo.com>
Date:   Mon Jan 18 18:09:05 2016 +0300

    Add -f option to resize2fs -P in vfs_minimum_size.
    
    Sometimes the user wants to know minimum size
    for dirty (e.g. mounted) filesystems. In this case,
    resize2fs -P will require calling e2fsck -f, while
    "in general, it is not safe to run e2fsck on mounted filesystems".
    
    Since resize2fs -P does not modify filesystem, we force it
    to display (probably approximate) minimum size.

commit d723b352f8c10fb5244f17889cf68e13dd85c037
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 18 12:12:58 2016 +0000

    p2v: virt-p2v-make-disk: Allow --arch parameter to be supplied.
    
    This allows you to easily build a 32 bit virt-p2v USB key, even on a
    64 bit host.

commit 727ac63dea41115f6e1c70bd2067c448ee04dca5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 14 17:04:50 2016 +0000

    Update gnulib.
    
    The version we picked just before 1.32 was released suffers from:
    
      test-mbrtowc.c:49: assertion 'ret == (size_t)(-2)' failed
    
    on RHEL 7.  See this thread for details:
    
      http://comments.gmane.org/gmane.comp.lib.gnulib.bugs/35567

commit 0687bb8e076553ea76cf0fe2fc1a18349f6019b4
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Jan 14 12:40:31 2016 +0100

    builder: allow a specific template for --list
    
    Allow the user to specify a template in --list mode, which will be the
    only result in the resulting output (instead of all the available
    templates).
    
    This makes it easier to find out the details of a specific template.

commit 0a84c67bd60e4d630e18b801a921eddcfc1aaa56
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Jan 14 11:51:13 2016 +0100

    builder: move os-version search in own function
    
    Simple code motion, no behaviour changes.

commit 7bccd0593f1c841a8390cd2d6ea3ec6b4a1e834b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 15 12:52:48 2015 +0000

    tests/mountable: Allow test to be skipped.

commit c1799541d3f295a54f682aab4a407f5b032738eb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 11 14:06:42 2016 +0000

    Version 1.33.1.

commit 446f7794e0231ae3f6bc724cdbc18235a32bca42
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 4 14:48:59 2016 +0000

    podwrapper: Add --warning flag for manual pages of CLI tools (RHBZ#1293527).
    
    This doesn't add --warning flags to the translated pages,
    which is a bug to be fixed at some point.

commit bb27fc1c0afd23c805a8db474b4cfe97c072fdd6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 4 14:21:11 2016 +0000

    podwrapper: Generate consistent WARNING sections (RHBZ#1293527).

commit 6fa4d983a3b7df682fac0801bb89b477e2db4b71
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 4 14:20:20 2016 +0000

    podwrapper: Enforce that every manual page must have a DESCRIPTION section.
    
    For every user command line tool (eg. guestfish or virt-cat) require
    that the manual page has a DESCRIPTION section.  This doesn't apply to
    non-CLI man pages (eg. guestfs-perl, guestfs-faq).

commit 3b8322e18ca0f4a59a7f7a07643c521818cb8e8d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 2 21:14:57 2016 +0000

    customize: Document missing command line parameters in the synopsis.
    
    I noticed that the --attach option was not covered in the synopsis.
    This commit documents all of the missing command line parameters in
    the synopsis.

commit b527ff0dfc569917b75a42fc8e7fa416202ff5fc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 9 18:00:28 2016 +0000

    build: Require qemu >= 1.3.0 and yajl.
    
    Require qemu >= 1.3.0, the first version that supported
    `qemu-img --output=json'.
    
    This means we require yajl (for parsing the JSON output of qemu-img),
    and that in turn has consequences elsewhere.

commit 64af88a1b766edddeb1dcf845019f1ed01202d0b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 11 13:38:36 2016 +0000

    v2v: Unquote path when removing VirtualBox Guest Additions (RHBZ#1296606).

commit 2e728ed0dc740a239291de15fd8cb876ed348d5c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 8 12:34:34 2016 +0000

    p2v: Break long lines when displaying virt-v2v output in GUI.

commit abd41320e10bd3092df9a8feab81311883addba5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 6 17:05:28 2016 +0000

    tests: Allow test-disk-create.sh to be skipped.

commit 980dc9deafdceeac46f1b3009e4fec051b407604
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 6 16:04:46 2016 +0000

    regressions: test-big-heap: Allow this test to be skipped.

commit de94d01692b006d90226bed9745abfe3bc2f8f1a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 6 16:04:23 2016 +0000

    regressions: test-big-heap: Add comment about a failure of this test.

commit 6afde4fd34395258c6fb395dd3c8e2ce4027f4b3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 6 11:45:27 2016 +0000

    Version 1.33.0.

commit f67452065156149797dae00aefeb05e2772e486f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 6 11:35:34 2016 +0000

    hacking: Fix git push command for pushing stable branch.
    
    This fixes commit 5218f54a544cd147cb72640506ce8be845116bd2.

commit 88ba55c553e99f2209e232e7b2fb0bc2f25dda9f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 6 11:29:26 2016 +0000

    Version 1.32.0.

commit bc9faf843b49b9ea88aeb9fdf085b07336198c30
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 6 11:13:18 2016 +0000

    website: Prepare website for 1.32 release.

commit 5218f54a544cd147cb72640506ce8be845116bd2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 6 11:18:20 2016 +0000

    hacking: Document simpler way to create stable branch in git.
    
    I will try this method for the 1.32 release.

commit acde5a6f95e2834d2de9c62b73957a4dc38e31c4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 6 10:46:43 2016 +0000

    Finalize release notes for libguestfs 1.32.

commit 07d1baebae03c61dc608ee62e65e249934f1a037
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 6 10:53:24 2016 +0000

    Update PO files from Zanata.

commit 1007b2555c71f8cb93cbda1604ce221a4101027d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 4 15:33:45 2016 +0000

    daemon: Fix ext2 labels error message (RHBZ#1294956).

commit 307c83177cbe17f470d6befca449f7557df18ab4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 2 21:17:34 2016 +0000

    Update copyright dates for 2016.
    
    Run the following command over the source:
    
      perl -pi.bak -e 's/(20[01][0-9])-2015/$1-2016/g' `git ls-files`

commit 9958dffc08e550911f5b6eb5fcccbbb523ae2f2f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 19 21:30:50 2015 +0000

    builder: Update Fedora 23 ppc64le image which was broken.
    
    This updates commit d92758d8bbfe50dd063451050104ca0d58f8d4d0.

commit d92758d8bbfe50dd063451050104ca0d58f8d4d0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 19 13:32:25 2015 +0000

    builder: Add Fedora 23 ppc64/ppc64le images.

commit eed0e7a2e0a16a540f90da55ea3ccae7d558c471
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 19 09:57:36 2015 +0000

    builder: Fix Fedora ppc64/ppc64le build scripts to use correct version.

commit d7753a8eb94814af8ba228930213356ff9b45f6f
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Dec 18 17:10:25 2015 +0100

    tests: add a couple of iSCSI-related test cases

commit 079984a8b88604655248123b348cc438988c2a00
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Dec 1 14:52:35 2015 +0100

    drives: allow authentication for iSCSI
    
    Now that both the direct and libvirt backends handle authentication with
    iSCSI correctly, we can allow this in the library.

commit b2598ce8901c60995598534436550c7902b51d1f
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Dec 1 14:28:36 2015 +0100

    launch: direct: manually compose iscsi:// URIs
    
    Move the creation of iscsi URIs away from make_uri, composing them
    manually: this is needed because libxml assumes colons (':') to separate
    user and password for the authority part, while with iscsi URIs the
    separator is percentage ('%'), which would be percent-encoded by libxml.

commit 7ecad8d4f77053dd5c42e69ead9c3a3729f66f97
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 17 11:18:02 2015 +0000

    daemon: Improve debug information from command*.
    
    Do some fake quoting so people don't get worried that we aren't
    quoting the commands we run.  See:
    https://www.redhat.com/archives/libguestfs/2015-December/msg00080.html

commit 6d90cf5eb2f135cf603de166468f4293d05c2d5d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 17 11:15:14 2015 +0000

    daemon: Make command*f flags parameter unsigned.
    
    It's a bitmask, so unsigned is the right choice.  eg. We can more
    easily print it using %x.
    
    This patch changes the size of the fd mask and the values of the
    COMMAND_FLAG_* constants, but since these are internal definitions
    that doesn't matter.

commit 346a8aa303e066ceb387d1ef72b34b90dab1cec7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 16 13:26:45 2015 +0000

    Version 1.31.30.

commit 8e5a431a59a43caa1828075dff87218520a8ffff
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 16 13:23:51 2015 +0000

    po: Add pt_BR to list of linguas.
    
    Commit e6f7d237820fc554dfdffd8a6fee903aabd3e69f added new po files for
    pt_BR to po/ and po-docs/ (they are only very minimal).  However they
    were not added to the list of linguas, so amongst other things the
    files were not included in EXTRA_DIST automatically.

commit cbe698b9c9000164787615087aff658e805399a8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 16 13:19:13 2015 +0000

    po: Fix two faults in the uk.po file.
    
    ./uk.po:1049: 'msgid' and 'msgstr' entries do not both end with '\n'
    ./uk.po:9638: format specifications in 'msgid' and 'msgstr' for argument 2 are not the same
    
    This updates commit e6f7d237820fc554dfdffd8a6fee903aabd3e69f.

commit adfe577ee9d127362ed62c436df4e2c5fa8bda11
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 16 12:44:51 2015 +0000

    hacking: index.html.in is now stored in git under website/ directory.

commit e44de65ec9a4b59e3cff5d0097975f2b52168b3d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 15 18:40:36 2015 +0000

    builder: Add CentOS 7.2 image.

commit e69e9c1ecec677ab0bfb5ed5a72422e750ce81e3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 15 18:20:04 2015 +0000

    builder: website: Update comment in centos.sh script.

commit 43e0d25f8ddd4f76926a49f34d7920f8fe5f6070
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 15 16:59:06 2015 +0000

    fish: tests: Don't open phony fedora.img for write in parallel.
    
    Two tests opened the phony Fedora image in parallel without the
    readonly flag.  This occasionally resulted in strange errors
    (especially observed in test-inspect.sh).  Add the --readonly flag to
    avoid this.

commit 8ec4ebb95253448080312c2fa80038dfacceea27
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 15 15:57:11 2015 +0000

    Update release notes.

commit 7e8ff2971076048a174e340fcc148e15d48a00b2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 15 14:31:22 2015 +0000

    Update gnulib to latest.

commit e6f7d237820fc554dfdffd8a6fee903aabd3e69f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 15 12:04:54 2015 +0000

    Add latest translations pulled from Zanata.

commit ddd9d479cc7caae6cd25c0bb23b6df97839b8736
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 15 11:12:40 2015 +0000

    Update translations and send to Zanata.

commit 5c02ad337580c34eff9900e36a5c90e1dd19fc5a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 15 11:12:27 2015 +0000

    Update BUGS.

commit 9c3b4f6ad87a9fb10c74226d08ff1988328f00ab
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Dec 15 15:00:11 2015 +0100

    daemon: improve internal commandrvf
    
    - add a flag to request chroot for the process, which is done only as
      very last (before chdir) operation before exec'ing the process in the
      child: this avoids using CHROOT_IN & CHROOT_OUT around command*
      invocations, and reduces the code spent in chroot mode
    - add failure checks for dup2, open, and chdir done in child, not
      proceeding to executing the process if they fail
    - open /dev/null without O_CLOEXEC, so it stays available for the
      exec'ed process, and thus we don't need to provide an own fd for stdin
    
    Followup of commit fd2f175ee79d29df101d353e2f380db27b19553a, thanks also
    to the notes and hints provided by Mateusz Guzik.

commit 6c6c3ea67596afd1947f71d4f3f1252f1cc0f2d6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 14 22:38:52 2015 +0000

    build: Disable -Wstack-protector warning.
    
    Fires with gcc 5.3.1 (on Fedora 23).  It's a completely useless
    warning since it just tells you that a function couldn't use the stack
    protector.

commit b314f6700a2d20bb3e5976ed96f0dd9880b50990
Author: Kashyap Chamarthy <kchamart@redhat.com>
Date:   Mon Dec 14 19:49:00 2015 +0100

    guestfs.pod: Update reference to libguestfs internals

commit cc717138a96a221e040f96c50d2d176d9e5cdd21
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 11 15:48:05 2015 +0000

    customize: Capitalize the first character in --sm-credentials help text.
    
    Prior to this commit:
    
    $ virt-builder --help
    [...]
      --sm-attach SELECTOR         Attach to a subscription-manager pool
      --sm-credentials SELECTOR    credentials for subscription-manager
      --sm-register                Register using subscription-manager
    
    Really the generator ought to check this.

commit 4be1587b3332ba0073feedb6e89d635d87010f1e
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Dec 10 14:00:26 2015 +0100

    inspect: recognize the PLD Linux distribution
    
    Just basic identification, with name and version read from
    /etc/os-release.

commit 545fc8477567542f39871acb91de59a133e277a2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 6 16:23:34 2015 +0000

    perl: Add missing backslash in CLEANFILES rule.
    
    This fixes commit a2edda266e891a4771870f89e87c886318ef80d6.
    
    Thanks: Jean-Christophe Manciot.

commit f48361ed04ebccdccd09edfb2d8c503ddf9eebd8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 5 23:45:07 2015 +0000

    Version 1.31.29.

commit 0339b3d7a5c7707abbf4b6e4b714733fc8c52a79
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 5 23:40:20 2015 +0000

    builder: Add Fedora 23 i686 image (RHBZ#1288733).
    
    This includes the DNF fix, see
    commit 59ea51d358e4e4d8c8ef6535760fcfc9bfe0a3a3.

commit a090a48f44e8d0c6e3410855b087cc936b1ee1ad
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Dec 4 11:02:51 2015 +0100

    builder: create temporary images in the cachedir (RHBZ#1288201)
    
    Temporary images can be quite big, more than the space available in
    $TMPDIR when it's on a tmpfs; hence, place them in our cachedir
    instead.

commit 5c7c4666e418c36798b737ef3af8441d6033e53f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 27 09:52:49 2015 +0000

    resize: Add a regression test for RHBZ#1285847.

commit b3bc670c71a49985ba2e6e71fd6b097c928d15de
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 27 10:25:17 2015 +0000

    resize: Work around regression in sfdisk (RHBZ#1285847).
    
    'sfdisk --part-type' used to merely set the MBR ID byte in the
    partition.  However since sfdisk was rewritten, it now "helpfully"
    corrupts the first sector of the partition if you change the type byte
    from an ordinary partition to an extended partition.
    
    So we need to change the order in which we sets the partition type
    byte, to do it before copying the partition content.
    
    This fixes a major regression in the way that virt-resize handles any
    guest with logical partitions (specifically Ubuntu guests).

commit 8eb9ad0fb2be400ceb189341e94ac7b18efca43d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 27 15:11:44 2015 +0000

    POTFILES: Escape dot in regular expression.

commit 59ea51d358e4e4d8c8ef6535760fcfc9bfe0a3a3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 1 13:02:00 2015 +0000

    builder: Rebuild Fedora 23 image with new DNF (RHBZ#1280029, RHBZ#1278382).
    
    We also need to add a small hack to the build script to ensure the
    latest dnf is really included.

commit 4085acc67f909877e62ac289888b670e931c9b27
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 27 09:00:01 2015 +0000

    builder: pxzcat: If write fails, display correct error message.
    
    If uncompressing a template to a filesystem which is nearly full,
    virt-builder displays an error which points to the wrong (source) file:
    
    $ virt-builder fedora-22
    [   1.2] Downloading: http://libguestfs.org/download/builder/fedora-22.xz
    [   1.7] Planning how to build this image
    [   1.7] Uncompressing
    /home/rjones/.cache/virt-builder/fedora-22.x86_64.1: No space left on device
    /home/rjones/.cache/virt-builder/fedora-22.x86_64.1: No space left on device
    /home/rjones/.cache/virt-builder/fedora-22.x86_64.1: No space left on device
    /home/rjones/.cache/virt-builder/fedora-22.x86_64.1: No space left on device
    
    (The error message is usually printed once by each thread, so it is
    printed several times.)
    
    Change the error message to point to the output file, which might be a
    temporary or the final file depending on the build plan:
    
    $ virt-builder fedora-22
    [   1.1] Downloading: http://libguestfs.org/download/builder/fedora-22.xz
    [   1.6] Planning how to build this image
    [   1.6] Uncompressing
    fedora-22.img: No space left on device
    fedora-22.img: No space left on device
    fedora-22.img: No space left on device
    fedora-22.img: No space left on device

commit 8120c6c903c8d64d6333875ca54f9f095107bde7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 24 22:59:36 2015 +0000

    Version 1.31.28.

commit 2ee2003d564e9c39f62b436690a98721ab640ef0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 7 12:20:23 2015 +0000

    daemon: Allow --channel fd:N
    
    In this case, the daemon has been passed an open file descriptor which
    it uses directly for the channel.

commit 49ad09bae351fde6491b11a6cd359582bf2e06c0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 24 13:35:26 2015 -0500

    launch: direct: aarch64: Add gic-version=host to -M option.
    
    On ARM machines with vGICv3, we need to use the extra -M
    parameter gic-version=3 (or gic-version=2 for the old vGIC).
    
    qemu can detect this feature for us if we pass gic-version=host,
    so add that to the -M option.  Unfortunately we cannot detect if
    qemu itself supports this parameter, but this change only affects
    aarch64.
    
    Thanks: Wei Huang

commit 6e15468337fb347b1318218c38d0caf5c560f167
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 24 15:40:43 2015 +0000

    builder: rhel: Fix path in rhel-aarch64.sh.

commit 51362c96387c6cd722badf4ab2f154dbd3cd065f
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Nov 23 17:09:14 2015 +0100

    fuse: fix return value of guestunmount for unmounted paths
    
    Exit with 3 as return value when fusermount fails, because the specified
    mount point is not considered mounted for the user.  This is in line
    with what the guestunmount documentation says.
    
    Adapt the test-guestunmount-fd test to the updated return value.
    
    Thanks to: Maxim Perevedentsev.

commit e49680bdd6dfd4a2adf14b5919d466be553280c6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 24 11:14:37 2015 +0000

    fish: ps_restore is only used when HAVE_LIBREADLINE is defined.
    
    Thanks: Keresztes Péter-Zoltán

commit fd2f175ee79d29df101d353e2f380db27b19553a
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Nov 19 17:34:11 2015 +0100

    daemon: always provide stdin when running chroot commands (RHBZ#1280029)
    
    When running commands in the mounted guest (using the "command" API, and
    APIs based on it), provide the /dev/null from the appliance as open fd
    for stdin.  Commands usually assume stdin is open if they didn't close
    it explicitly, so this should avoid crashes or misbehavings due to that.

commit 0799ac4bf465ab3af88629cac4a38fca59864e7e
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Nov 19 11:09:31 2015 +0100

    build: disable -Winline
    
    Older GCC versions (e.g. < 4.9) may complain about inline functions that
    cannot be inlined (growing the generated code). It is not really a
    problem for us, so just suppress again the warning.
    
    Followup of commit c37c554fc56151b709882b382bb5fa26d9083449.

commit 37e145140b08aa62d1ad59029548a74ba93cc8b1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 20 10:27:53 2015 +0000

    v2v: Add full stop after multi-line error message.

commit 6faa0bb33122ab6d769ff25e9b46a103cdd89c92
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 20 09:41:09 2015 +0000

    v2v: Clean up the documentation for virt-v2v-copy-to-local.
    
    Don't duplicate the instructions in two different man pages.
    Put the conversion steps into virt-v2v(1) only.
    
    This updates commit 87adc301634034473013b341de5e6cf0a1eb3994.

commit 0721b8d7f3f61da28bda17ab4909556e31946288
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 20 08:22:01 2015 +0000

    v2v: Fix valgrind of virt-v2v-copy-to-local.
    
    This fixes commit 87adc301634034473013b341de5e6cf0a1eb3994.

commit b1939085142b06c4933f395105c7151f0258e1ba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 19 22:53:18 2015 +0000

    build: Add virt-v2v-copy-to-local to installcheck.
    
    This updates commit 87adc301634034473013b341de5e6cf0a1eb3994.

commit 9fbb956b149cbad8d55bff415b257fd1c3ffaaa0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 19 22:51:17 2015 +0000

    Version 1.31.27.

commit 87adc301634034473013b341de5e6cf0a1eb3994
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 19 14:26:43 2015 +0000

    v2v: Add a new tool virt-v2v-copy-to-local.
    
    This allows certain guests which virt-v2v cannot access to be copied
    off the remote hypervisor and converted.  Essentially this just
    automates the process of copying the guest's disks and adjusting the
    libvirt XML.
    
    This also adds a test of the new tool.

commit 05a80e6088ead3c09a16c9d83cadde00da210707
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 19 19:10:33 2015 +0000

    v2v: xml: Add a binding for XmlUnsetProp.

commit 7a9edee22ca80537b8e900521c0563101c68b217
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 19 17:18:39 2015 +0000

    v2v: vcenter: Split out map_source_to_https from map_source_to_uri.
    
    Split the map_source_to_uri function up so that we can get at just the
    https://... URI.
    
    This is almost refactoring.  It doesn't quite handle the case where we
    are passed a source path from the libvirt VMware driver that doesn't
    match the expected "[datastore] path" format, but probably if we hit
    that case it's a bug anyway.

commit 2ea771e4f843f781d2cbc4ecde691cf4e140768e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 19 13:08:26 2015 +0000

    v2v: Detect conversions where the source disk has zero size (RHBZ#1283588).
    
    If you try to convert a guest that has a zero-sized disk, it
    will currently fail in a rather strange way.  Usually you will
    see errors in the debug output:
    
      [    0.562714] sd 2:0:0:0: [sda] Read Capacity(16) failed: Result: hostbyte=DID_OK driverbyte=DRIVER_SENSE
      [    0.563884] sd 2:0:0:0: [sda] Sense Key : Not Ready [current]
      [    0.564587] sd 2:0:0:0: [sda] Add. Sense: Logical unit not ready, manual intervention required
    
    followed by virt-v2v failing with:
    
      libguestfs: trace: v2v: inspect_os = []
      virt-v2v: error: inspection could not detect the source guest (or physical
      machine).
    
    Additionally, because of a problem with the ssh driver in qemu (or
    perhaps, with sftp-server on the remote side) it is not possible to
    use the ssh driver to open a block device path on the remote server.
    The drive will appear as zero-sized, triggering the above error.
    
    Therefore detect this situation, and emit an error (see below).  Also
    add a section to the manual describing the workaround required for
    converting RHEL 5 Xen guests which are located on block devices.
    
      virt-v2v: error: guest disk sda appears to be zero bytes in size.
    
      There could be several reasons for this:
    
      Check that the guest doesn't really have a zero-sized disk.  virt-v2v
      cannot convert such a guest.
    
      If you are converting a guest from an ssh source and the guest has a disk
      on a block device (eg. on a host partition or host LVM LV), then
      conversions of this type are not supported.  See "XEN OR SSH CONVERSIONS
      FROM BLOCK DEVICES" in the virt-v2v(1) manual for a workaround.

commit 9c85bbbc423382572ed786ad23c8a7cda9a560d5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 16 22:11:05 2015 +0000

    p2v: Cancel conversion if user closes the running dialog.
    
    If the user tries to close the running dialog during a running
    conversion, act as if the cancel button was pressed (cancelling the
    conversion).
    
    If the conversion has finished/been cancelled, then this closes the
    dialog and exits virt-p2v, as now.
    
    Cancelling the conversion in this way ensures that qemu-nbd and ssh
    subprocesses are cleaned up.

commit 046a625846f880dde8c1ed3f221acff727f3a001
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 16 22:29:50 2015 +0000

    p2v: Add a conversion_is_running() function.
    
    This thread-safe function can be used to determine if the conversion
    is running (maybe in another thread).

commit 62b8a09b36aeb0770348b6662b34edc72cfe14ec
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 16 22:24:38 2015 +0000

    p2v: Make cancel_conversion() properly thread safe.
    
    Rename 'stop' variable as cancel_requested, and defend it with a
    mutex.

commit 05d08b8d190e58c8a2ef92b35c391d600217f511
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 16 21:41:21 2015 +0000

    p2v: Tidy up in man page.

commit 7406c76bcfb0fecda1a5597601ff99f52978ec6c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 16 11:34:00 2015 +0000

    p2v: Send physical server 'dmesg' output to debug dir on conversion server.
    
    If the virt-p2v ISO doesn't contain the correct drivers for the
    hardware on the physical server, that can cause peculiar conversion
    problems.  This was hard to diagnose because we could not see the
    'dmesg' output from the physical server.
    
    Upload 'dmesg' output from the physical server (more precisely: from
    the virt-p2v ISO's kernel running on the physical server) to the
    virt-v2v conversion server debugging directory, so that this
    information is available for debugging later.
    
    Unfortunately this involves yet another copy of the 'read_whole_file'
    function.

commit 399e031c25a5385a3f918d0a604e2751bd34242f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Nov 15 22:42:36 2015 +0000

    v2v: OVF: Use common generated_by string.
    
    Instead of creating a special 'Exported by ...' string just for this
    module, use the Common_utils.generated_by string.  Since the string is
    just descriptive, this should make no difference.

commit ab37d92ab92fffcd625b58da4e497be7dd6ecb89
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Nov 15 22:18:36 2015 +0000

    v2v: Move mpstat struct into Types module.
    
    Strangely the Types module already defined mpstat, but it was not used
    and redefined in v2v.ml.  Apart from that, this change is just
    refactoring.

commit fa1f770498f93f33c1007e57cb5a92b4579099a2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Nov 15 21:52:57 2015 +0000

    v2v: windows: Fix a few comments.

commit d2ea61bd1c85a334accdd0737c843a985d2cfa8f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Nov 15 21:51:30 2015 +0000

    v2v: Add comment.

commit f3e6b3565ce6024557f75791b3e3e9f7248abe2c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Nov 15 21:45:04 2015 +0000

    v2v: Move the get_node function to the Windows module.
    
    Just refactoring - however this does make the function safer by having
    it return an option type instead of throwing a [Not_found] exception.

commit 9ad4ce77b6ba39d0cf2985d789d525c44817d5a2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Nov 15 21:29:50 2015 +0000

    v2v: Refactor some uses of Windows.with_hive.
    
    This changes:
    
      let f root = .. in
      Windows.with_hive ... f
    
    to:
    
      Windows.with_hive ... ( fun root -> .. )
    
    No functional change, just refactoring.

commit 40701b715c413856a84ffce9ec91e2784ab8f73f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Nov 15 21:22:53 2015 +0000

    v2v: Move the with_hive function to the Windows module.
    
    Just refactoring.

commit 8cb6600eee4074b5b7f2327513eeaee030606235
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 13 19:14:43 2015 +0000

    Version 1.31.26.

commit 9dc4717bb914094b23c2cbd631de07ecd508f8c1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 13 19:10:35 2015 +0000

    build: Remove ChangeLog from make distclean.
    
    Adding this causes 'make dist' to fail with:
    
      make[1]: *** No rule to make target 'ChangeLog', needed by 'distdir'.  Stop.
    
    This updates commit a2edda266e891a4771870f89e87c886318ef80d6.

commit c2d216d1668a0ebff4c356f232c01fb0851be897
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 13 11:46:20 2015 +0000

    inspection: Fix detection of the kernel version of Windows ≥ 10 (RHBZ#1281578).
    
    See the description in the bug report:
    
    https://bugzilla.redhat.com/show_bug.cgi?id=1281578
    
    Thanks: Richard Tollerton for alerting me to this change in the way
    that Windows version numbers are stored in the Registry starting with
    Windows ≥ 10.

commit b91b39e06ab7eb9b9b06c8b4dfef2ef9f381ab19
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 10 12:23:18 2015 +0000

    daemon: lvm: Change the separator character to ':'.
    
    The separator character (currently comma) was picked arbitrarily to
    allow us to parse the output of commands like 'lvs' for APIs such as
    'lvs-full'.  Unfortunately the choice of comma conflicts with the 'lvs
    -o modules' column, since the list of modules is separated by commas,
    breaking our parser.
    
    Change the separator to another arbitrary character (colon) which
    hopefully is not used by any column.
    
    See also:
    https://bugzilla.redhat.com/show_bug.cgi?id=1278878#c11

commit fccd4ee5e846083096554a41fae831240fc72b1d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 10 12:03:39 2015 +0000

    daemon: lvm: Only return public LVs from guestfs_lvs API (RHBZ#1278878).
    
    When a disk image uses LVM thinp (thin provisioning), the guestfs_lvs
    API would return the thinp pools.  This confused other APIs because
    thinp pools don't have corresponding /dev/VG/LV device nodes.
    
    Filter the LVs that are returned using "lv_role=public".
    
    Thanks: Fabian Deutsch

commit c37c554fc56151b709882b382bb5fa26d9083449
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Nov 8 22:10:38 2015 +0000

    build: Enable some more warnings.
    
    After fixing some warnings (see prior commits), we can now enable
    them in configure.ac.

commit 52e517c570f2e9a682e620deb5b4eedcb331d7b6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Nov 8 21:53:28 2015 +0000

    Avoid "function 'asprintf_nowarn' can never be inlined because it uses variable argument lists".
    
    Move this to a separate translation unit and don't inline it.

commit 120b658ccc698e8af300f36ca8ef18a4b62ac738
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Nov 8 21:49:24 2015 +0000

    Avoid various "declaration of <var> shadows a previous local"
    
    I enabled the -Wshadow warning temporarily in order to do these fixes,
    but had to disable it again afterwards.  The reason is that this warns
    about shadowing globals, which is sort of a good thing, but because we
    have a global called "verbose" just about everywhere, and at the same
    time we baked a function argument called "verbose" into several
    unchangable APIs, well, we're stuck without being able to use this
    warning.

commit 4dc53f0fbabf0c216eb3161edf7468e08ab02660
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Nov 8 21:42:51 2015 +0000

    Avoid gcc warnings about infinite loop.
    
    This seemingly redundant change avoids a gcc warning/error:
    
      error: cannot optimize possibly infinite loops
    
    See https://gcc.gnu.org/bugzilla/show_bug.cgi?id=34114#c3 and
    following for an explanation.
    
    Of course gcc is completely wrong and stupid here, because there's no
    possibility on current or future hardware that an array of size
    SSIZE_MAX could be allocated since it would by definition occupy at
    least all addressible memory (if it was an array of bytes, which this
    isn't), leaving no room for the code that is being compiled.

commit 573c0a26fb4230cc80461f2fe83f35f9b4b307e2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Nov 8 22:10:03 2015 +0000

    gobject: Ignore gobject/docs/guestfs-scan.c.
    
    I'm not sure what/why this file has suddenly appeared.  It may
    be something to do with updating gtk-doc.
    
    Whatever - ignore it.

commit 4e32737c40db6a1b9a80bb622b66a510c37e43f4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 10 20:34:46 2015 +0000

    sparsify: Make the interface between cmdline.ml and sparsify.ml explicit.
    
    We could go a bit further here and push the cmdline struct
    into Copying.run and In_place.run.

commit 995ce5f6481c72cb4bd12a74c7c6fa19810c5fa9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 11 16:10:13 2015 +0000

    dib: Turn a few progress messages into info messages.

commit f8287387c24d1854038fd113ced8f0e92ecc264f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 10 20:34:46 2015 +0000

    dib: Make the interface between cmdline.ml and dib.ml explicit.

commit a4c981e7bb54061a365a1e39282315f5641f99a3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 10 19:52:21 2015 +0000

    builder: Make the interface between cmdline.ml and builder.ml explicit.

commit 6f38aff2622a72236cebef5be71af1e564764a3d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 12 22:38:59 2015 +0000

    inspector: --xpath: Copy node to new document (RHBZ#1281577).
    
    'virt-inspector --xpath' can segfault.
    
    When run under valgrind, it shows this error:
    
    ==2254== Invalid free() / delete / delete[] / realloc()
    ==2254==    at 0x4C29D6A: free (in /usr/lib64/valgrind/vgpreload_memcheck-amd64-linux.so)
    ==2254==    by 0x53BA198: xmlFreeNodeList (tree.c:3690)
    ==2254==    by 0x53B9F65: xmlFreeDoc (tree.c:1247)
    ==2254==    by 0x405BFA: do_xpath (inspector.c:808)
    ==2254==    by 0x405BFA: main (inspector.c:250)
    ==2254==  Address 0x1030a037 is 311 bytes inside a block of size 1,048 alloc'd
    ==2254==    at 0x4C28C50: malloc (in /usr/lib64/valgrind/vgpreload_memcheck-amd64-linux.so)
    ==2254==    by 0x545DE86: xmlDictAddString.isra.0 (dict.c:270)
    ==2254==    by 0x545E961: xmlDictLookup (dict.c:923)
    ==2254==    by 0x539C6DC: xmlDetectSAX2 (parser.c:1067)
    ==2254==    by 0x53B0B92: xmlParseDocument (parser.c:10725)
    ==2254==    by 0x53B1276: xmlDoRead (parser.c:15295)
    ==2254==    by 0x40587D: do_xpath (inspector.c:772)
    ==2254==    by 0x40587D: main (inspector.c:250)
    
    The cause appears to be that when copying the matching node(s) found
    by the xpath expression, we have to copy them into the new document
    (using xmlDocCopyNode instead of xmlCopyNode).
    
    This bug has existed since this functionality was originally added in
    commit d1ee71782ace98a11c5aabaf1f9fd5f601e08367.

commit ab48601afd6365861ba7e29c34028efbf41ba00b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 12 22:13:36 2015 +0000

    inspector: Whitespace changes.
    
    Just break up a few long source lines.

commit 7747723aa0c91f2ae4dd5b3d0d2252dc68e7d956
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 12 18:12:04 2015 +0000

    builder: Add Fedora 23 aarch64 image.

commit c15b8773100929e38ac62f15c4d30c2a712427a1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 12 16:41:36 2015 +0000

    builder: fedora-aarch64.sh: Switch to using Gerd's edk2.

commit be1b9315ac79e866c4638b60997a48960959ff15
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 10 20:34:46 2015 +0000

    customize, dib, resize, sysprep: Use 'may' pattern in various places.

commit 905d98c127a145a8dbc490eb3c2e93705889ef2a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 10 20:10:44 2015 +0000

    mllib, v2v: Allow open_guestfs to set the handle identifier.
    
    Extend open_guestfs to take an optional ?identifier parameter.
    
    Use this parameter in virt-v2v which is currently the only place where
    we use the handle identifier.

commit b91286c372645f0b9f1740193ea8b9520687a31f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 10 20:21:15 2015 +0000

    v2v: Use the 'may' pattern in the Changeuid module.

commit 9307087bb5c51cb85aa69491067e534279e8ca87
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 10 20:16:08 2015 +0000

    builder: Use the 'may' pattern in a few places.

commit 9a2c5b7c4d367aae665ab66f85e463f9d244e465
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 10 20:07:56 2015 +0000

    mllib: Add Common_utils 'may' function.
    
    This higher order function encapsulates the following pattern:
    
      match x with
      | None -> ()
      | Some x -> f x
    
    (replaced with: `may f x`)
    
    This is taken from OCaml lablgtk (Gtk bindings) where this pattern is
    used frequently.
    
    See also: https://ocaml.org/learn/tutorials/labels.html

commit c09be9334bf89b94aaa9664b5c76a6916fe2c395
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 10 19:52:21 2015 +0000

    v2v: Make the interface between cmdline.ml and v2v.ml explicit.

commit 6d46eb33bffbd48c75539cca59c554d184cb5c05
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 10 08:50:17 2015 +0000

    v2v: Add --compressed option to produce compressed qcow2 files (RHBZ#1279273).

commit 4cc98d8f6e9669a63af1760ca08e5aa4409c1904
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Nov 10 11:38:40 2015 +0100

    OCaml tools: use open_guestfs everywhere
    
    Instead of creating Guestfs handles and manually apply common options
    (e.g. debug and trace), use the open_guestfs in Common_utils.
    This also applies the common options to handles which didn't set them
    before, so we can inspect also their messages if needed.

commit a7f3f48dd14fc99d6ebf7adc5d16cdeec0aa0a57
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Nov 9 18:33:52 2015 +0100

    customize: allow editing symlinked files
    
    Resolve also symlinks when checking whether a path passed to --edit is a
    file: the file editing code supports symlinks anyway (properly changes
    the target file, instead of overwrite the symlink with a real file), so
    it is safe to allow this operation in customize/builder.

commit 6e41fc5a7f4fc56514dc1f2754db8c2c6eec9417
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Nov 9 18:26:05 2015 +0100

    customize: check for file existence with --edit (RHBZ#1275806)
    
    Check that a path provided to --edit exists already; while the is_file
    call later will fail for non-existing files, with an explicit check a
    better error message can be provided.

commit 78db05a05c1034f95619b958e4a3ce1253ac855a
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Nov 9 16:42:32 2015 +0100

    v2v: test-v2v-i-ova-two-disks.sh: fix sha1 filename
    
    Run sha1sum on the compressed filename (with .gz extension, after the
    gzip run), and reference that file in the .mf file.

commit 39a8e12d90843814d30bceb130039c9bec6dcfc7
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Nov 9 11:38:49 2015 +0100

    lib: do not manually include libvirt.h in .c files
    
    guestfs-internal.h includes it already, so rely on that.

commit 3b54869dad77283834a9be4779a6a9187d39765d
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Nov 9 11:29:49 2015 +0100

    lib: enable the libvirt code consistently everywhere
    
    With commit bc2b41778405cc6a376a670703ce63e3678bf1fb
    HAVE_LIBVIRT_BACKEND is defined based on the libvirt version (using its
    version macro), although libvirt.h is included only after that check:
    because of this, variables in the guestfs_h struct after the
    HAVE_LIBVIRT_BACKEND block would be used wrongly if libvirt.h was not
    included before guestfs-internal.h, like in the recently added
    available.c (all the other places using libvirt features in the handle
    already happened to do so).
    
    Considering guestfs-internal.h already includes libvirt.h, move its
    inclusion up, right before the libvirt version check.

commit cbeb127a5d08bb24b23fa6c5fc05cd4ed038f428
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Nov 8 20:36:47 2015 +0000

    todo: Remove virt-p2v --inject-ssh-identity as it has been implemented.

commit 3bf676be929db42ca82f207b6f0e4b2915451bc1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 6 22:24:39 2015 +0000

    lib: find_or_cache_feature function can return a const pointer.
    
    This updates commit 38598e2ba54f80182221faa6b517349e85ad133a.

commit 2497b4921eb987b3140a11bc0f5a7595d7aee501
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 6 21:38:28 2015 +0000

    lib: Fix whitespace in src/available.c
    
    This updates commit 38598e2ba54f80182221faa6b517349e85ad133a.

commit dc9d14ebd3ea2c1995b298a23c8eb8f93d8ae839
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 6 17:30:53 2015 +0000

    Version 1.31.25.

commit 7b74d05758652963c1822288aadff2225347c273
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Nov 6 17:13:34 2015 +0100

    tests: rhbz1232192.sh: fix VIRT_TOOLS_DATA_DIR
    
    Followup of commit f933a3c9c7a764270a5fa7f9bc9d7e0f37282302.

commit af3511c7a97acc63d7b832242997581cd0a06f83
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Nov 6 16:14:22 2015 +0100

    tests: replace run-xml-to-junit.* with automake2junit.ml
    
    Replace the custom XSLT + script to turn output from $RUN_OUTPUT_FILE
    (from previous run.in versions) with a OCaml script to analyze .trs and
    .log files of the automake test framework.
    
    The final result should be the same, just with classname= for each test
    set to the "path" (subdirectories) to that test.

commit 18c730e7f67f1d8a5bd3ab96aeb0db9cba07b058
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Nov 6 16:10:04 2015 +0100

    build: use a custom test driver
    
    Use a custom test driver for running the tests: based on the test-driver
    provided by automake, it adds the running time of the test in each .trs
    file.

commit c0a781ed9a54dbb548c11bbfd2496d91bd2549bf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 6 14:29:33 2015 +0000

    build: Drop serial_tests.
    
    Use (implicitly) parallel tests on new enough automake.  The tests run
    a bit quicker with this change.  On my laptop, I measured 27 mins down
    to 18 mins.
    
    Change the ./run function so that ./run --test no longer spools the
    test output to a file.  That is not necessary when using parallel
    tests, since the test harness does the same thing.
    
    Note: This commit removes the $RUN_OUTPUT_FILE functionality.  We will
    change the CI integration in a future commit so it uses the .trs and
    .log files.

commit 7964e48b5e4c0d0cc2bcf2c2bc027c65fa855d62
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 6 12:12:53 2015 +0000

    inspect: windows: Fail hard if we cannot detect Windows architecture (RHBZ#1278371).
    
    The user did not have the 'file' command installed, and when they
    attempted to do a v2v conversion of a Windows guest, inspection
    succeeded, but the Types.i_arch field was found to contain "unknown".
    virt-v2v conversion failed to locate the correct virtio drivers as a
    result.
    
    The 'file' command is required, and there's no other reason we should
    not be able to detect the architecture of any Windows guest, so fail
    hard in this situation.

commit 32368f25f1640e6af470dd7d5cd3eca5703d8bf9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 6 12:09:15 2015 +0000

    generator: Another minor indentation fix in src/actions-*.c files.

commit 22c97bcb3f38b62d3aa3048082c0459e4b73b6fa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 6 09:41:06 2015 +0000

    v2v: tests: No QXL drivers on the ISO.
    
    There are no QXL drivers on the ISO, so don't expect the QXL driver to
    be installed.
    
    This fixes commit 8c735a84c7a50e1ed85542e589c02af3e9ff8534.

commit c5237e28c5c82a27ea587540baa9c6d58411c4fb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 5 15:56:31 2015 +0000

    test-data: Copy DriverVer from real *.inf files to fake *.inf files.
    
    We want to test if virt-v2v can find drivers using the *.inf files.
    For this to work, one field is important:
    
      [Version]
      DriverVer = 07/17/2013,6.1.0.10018
    
    Copy the [Version] section header and DriverVer field from the real
    *.inf files to our fake *.inf files, which is enough for testing.
    
    See also:
    https://www.redhat.com/archives/libguestfs/2015-October/msg00352.html
    
    Note that the fields are case insensitive and may or may not contain
    spaces.

commit 8c735a84c7a50e1ed85542e589c02af3e9ff8534
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 5 15:43:43 2015 +0000

    test-data: Make fake virtio-win ISO.
    
    The virtio-win ISO has a different layout and superset of drivers
    compared to the virtio-win RPM directory.  Previously we simply put
    all the RPM files into the fake ISO.  Instead create a fake ISO which
    has the same layout and (fake) drivers as the real ISO.

commit b99a57a63129e75833abf15cf2a1c56b35476a41
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 5 15:37:00 2015 +0000

    test-data: Add further (all fake) virtio-win driver files.

commit f933a3c9c7a764270a5fa7f9bc9d7e0f37282302
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 5 14:56:40 2015 +0000

    v2v: Move fake-virtio-win and fake-virt-tools under test-data.
    
    There is no change, this just moves the test files.

commit 38598e2ba54f80182221faa6b517349e85ad133a
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Nov 5 16:07:12 2015 +0100

    actions: refactor available & feature_available
    
    Refactor the internal_feature_available to return the result for just
    one group, so it is easier to know on the library side what was the
    actual error, and which group refers to; drop internal_available, as no
    more needed after this.
    
    On the library side, implement in available and feature_available the
    real logic to iterate through the requested group, and error out or
    return whether the groups are available. This also introduces caching
    for the features, so each needs to be queried just once in each
    appliance run.
    
    The result of this is that there should be much less communication with
    the daemon to know about available features; the downside is that
    queries for more than one group at once, not already cached, will be
    cause more queries to the daemon.

commit 2e79edb4a3c6a929e1e3dec168a3f0774c8deff8
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Nov 5 13:46:52 2015 +0100

    actions: turn available & feature_available as non-daemon
    
    Rename the current available and feature_available into internal daemon
    functions, and provide non-daemon functions wrapping them at library
    side.  This will make it possible to e.g. add caching for them.
    
    Should be only refactoring, no actual behaviour change.

commit 18fbdaaf14ad341c8067d9645df2387093e3f94d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 5 13:58:12 2015 +0000

    v2v: Improve the error when virt-v2v is run on a blank disk.
    
    The error messages changes from:
    
      $ virt-v2v -i disk /tmp/blank.img -o null
      [...]
      [  14.6] Inspecting the overlay
      virt-v2v: error: no root device found in this operating system image.
    
    to:
    
      $ virt-v2v -i disk /tmp/blank.img -o null
      [...]
      [  15.2] Inspecting the overlay
      virt-v2v: error: inspection could not detect the source guest (or physical
      machine).
    
      Assuming that you are running virt-v2v/virt-p2v on a source which is
      supported (and not, for example, a blank disk), then this should not
      happen.  You should run 'virt-v2v -v -x ... >& log' and attach the complete
      log to a new bug report (see http://libguestfs.org).
    
      No root device found in this operating system image.

commit b20d36aa1bcabfe1e5eefcf47b727280a6474be8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 5 13:48:38 2015 +0000

    tests: Change more conflicting temporary output file names.
    
    Various tests cannot be run in parallel just because they happen to
    use conflicting names for temporary output files (eg. "test.out").
    
    Change these tests to use unique temporary names, so the tests could
    be run in parallel.

commit 8a72616bf7bc686ad4d033482541fcd73c148b53
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 4 21:25:32 2015 +0000

    test-data: phony-guests: Don't use *.tmp.* temporary files.

commit 458d7c09b72e16e41c79081455030d4ca5363328
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 5 13:44:07 2015 +0000

    v2v: Check if i_type, i_distro or i_arch contains "unknown".
    
    That indicates that inspection failed, so we should error out early.

commit fff2797578dc9e80ce6daff55e3c0d6476699e59
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 5 08:59:29 2015 +0000

    v2v: vCenter: Document additional permission needed for conversions (RHBZ#1277274).
    
    This updates commit 4e2433862505762b926d9eaf2201ddf666fa73a5.
    
    Thanks: Alessandro on https://bugzilla.redhat.com/show_bug.cgi?id=1277274#c6

commit b933b17a2ac29ed42d1a7ac2ab0d666b0d3d7243
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Nov 4 19:01:50 2015 +0100

    actions: set features for vfs_minimum_size tests
    
    Limit the scope of two tests of vfs_minimum_size to the features they
    require (btrfs and xfs).

commit c12c7d0df0bbbdce8705fb07dfd4acf3d2ba86e6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 4 17:45:28 2015 +0000

    Version 1.31.24.

commit 8e3920a334d8d2b3c0a2be8ca84f8f935c41b106
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 3 15:26:34 2015 +0000

    sparsify: Let --in-place capture ^C and shut down gracefully (RHBZ#1277122).
    
    When virt-sparsify receives a user quit signal (eg from ^C) it
    currently kills virt-sparsify and qemu instantly, meaning any mount +
    fstrim in progress is uncleanly stopped.  The (minor) side effect of
    this is that the guest filesystem may require a journal replay or fsck
    on boot.
    
    Let virt-sparsify capture the user quit signal and shut down
    gracefully.
    
    It is not thought that the previous behaviour could cause guest
    corruption; see
    https://lists.nongnu.org/archive/html/qemu-devel/2015-11/threads.html#00402
    for discussion.

commit 4e2433862505762b926d9eaf2201ddf666fa73a5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 4 16:21:35 2015 +0000

    v2v: vCenter: Document the minimum set of permissions needed for conversions (RHBZ#1277274).
    
    Thanks: Alessandro on https://bugzilla.redhat.com/show_bug.cgi?id=1277274#c2

commit 9d8ffd966a3d487f80b3335de4e864987715601d
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Nov 4 14:52:29 2015 +0100

    lib: include few more headers
    
    - include <sys/un.h> for sockaddr_un, on any OS (removing the Mac OS X
      blocks)
    - include <fcntl.h> for O_* flags
    
    This commits reverts a couple of changes in these files done in
    commit 3b17152ec399acb35b23331d2c3b4f424a68824a.

commit a13e95783def65dc994e1c7f7591bc063ac20ed9
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Nov 4 13:35:30 2015 +0100

    Revert "launch: add missing headers on Darwin"
    
    This reverts commit 3ce4e95c5a21c92f943c5731c3fa7e522d20ba56.

commit 226848762b698ab39a3cc570e003fee5a6e09408
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 4 13:03:17 2015 +0000

    builder: Add fedora-23 image.

commit 3ce4e95c5a21c92f943c5731c3fa7e522d20ba56
Author: Margaret Lewicka <margaret@meaningless.name>
Date:   Wed Nov 4 12:05:31 2015 +0000

    launch: add missing headers on Darwin
    
    Including sys/un.h for sockaddr_un and sys/fcntl.h for
    O_CLOEXEC/O_NONBLOCK.

commit 0c879fcd15990f7b46ea373db85a750319d6e5e8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 4 09:47:12 2015 +0000

    sparsify: Don't mark virt-sparsify --in-place as "experimental".
    
    Thanks: Gil Klein.

commit 9f70d71d4af6b2aaf69873a9ab144c8e2d6ae5c4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 3 15:36:45 2015 +0000

    builder: Document using 'qemu-img amend' for RHEL 6 compat (RHBZ#1204131).

commit a2edda266e891a4771870f89e87c886318ef80d6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 31 23:41:56 2015 +0000

    build: Make 'make clean' remove more files.
    
    Remove man pages and other pages which 'make clean' did not remove
    before.
    
    To evaluate which pages could be removed, I did a full build and
    check, and then ran 'make clean' followed by 'git clean -xdf'.  By
    examining the output of the git clean command I could see which files
    were being missed.
    
    Files that are _not_ removed by make clean or make distclean:
    
     - generator-built files
    
     - Makefile, Makefile.in, .deps, .depend
    
     - any ./configure output files (maybe they should be?)

commit 6221d54445ab81d0438b1d9b3ae93bf8a85afa4f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 31 23:29:08 2015 +0000

    build: Remove unused intltool-* files.
    
    None of these files have been touched since the initial intltoolize
    command (commit 29204fe10d6ad46bace50e82557cb95e8a0f3529, May 2009).

commit c192d99c0903c81174a820fdba4b4f00fa85f22a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 2 23:30:07 2015 +0000

    p2v: Don't present the vdsm output driver to the user (RHBZ#1277074).
    
    Thanks: Ming Xie.

commit f45c4619f56c3f1db8d9d5138627f0978a66590c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 31 22:59:28 2015 +0000

    tests: Remove fuzz testing of inspection.
    
    It's a nice idea, but has never actually found a problem.  After using
    afl to find bugs in qemu-img, it's pretty clear to me that no
    successful approach could be run in the short time demanded by the
    libguestfs test suite.  Afl tests run for days, weeks or even months.
    
    A better approach may be to use a proven fuzz tester (such as afl) on
    the inspection code; or to run this code for days on end on a separate
    testing machine.
    
    This reverts commit c2dcd1096424e6ff37a2e634c364f27b193376e7.

commit 2c62de52b73f2c3676799342a0e13690463f523b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 31 22:53:14 2015 +0000

    df: Close parenthesis in comment.

commit 88c506767a36c5596b9c5fbdfad7a9b706657e30
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 31 22:08:06 2015 +0000

    build: Make 'make clean' remove a few backup files.

commit 61902266714f275519ed498f8097489b8e50f4bf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 31 16:51:07 2015 +0000

    website: Add guestfs-hacking, guestfs-internals, guestfs-security to website.
    
    Also move guestfs-performance to the right place on the website.
    
    This updates commit 2eb01004bf4b2918139f36107e0a671aa7a87a19
    and commit d07515b947c152fb311f9bef2f8238da1cca38e8
    and commit 74fba6e6924cb25404921ca63345388aeaa659c5
    and commit 15b8b6453dbeaca0283e68ff433191c8211d5f92.

commit 47b095b92861e9ebea66c39488de77b7fcefbba6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 31 16:22:19 2015 +0000

    website: Put website into a separate directory.
    
    Move the random set of HTML files we build from html/ into
    the website/ directory.
    
    Also in the website/ directory, put the index.html file from
    http://libguestfs.org, which was previously not under version control.
    It is generated from index.html.in so we can automatically add the
    current version and release date.
    
    Also in the website/ directory, put various CSS file, images, etc.
    which are required by the website and were also previously not under
    version control.
    
    Change the 'make website' rule to 'make maintainer-upload-website'.
    As the name suggests, it is only useful for the maintainer, and will
    fail with an error for anyone else.

commit de819d17e424ccf144b1eb5a97eec1ff1d9a3e0f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 31 11:08:14 2015 +0000

    Version 1.31.23.

commit 7dcfc9eb03fbb5491dcadcce6f44ee72bd6f7e39
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 30 23:02:54 2015 +0000

    docs: Minor fix to description of 'test-data' subdirectory.
    
    Fixes commit dc1d0880b02525d26d12d2356e627419bdcffbaa.

commit 2eb01004bf4b2918139f36107e0a671aa7a87a19
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 30 22:49:50 2015 +0000

    website: Copy guestfs-hacking, guestfs-internals, guestfs-security to website.
    
    Make sure the three new man pages are copied over to the website.
    
    This updates commit d07515b947c152fb311f9bef2f8238da1cca38e8
    and commit 74fba6e6924cb25404921ca63345388aeaa659c5
    and commit 15b8b6453dbeaca0283e68ff433191c8211d5f92.

commit 877c69bef779c40cb1e4412cad5c2ffe0ce36ff9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 30 21:42:54 2015 +0000

    build: Reorder build sequence.
    
    When I conceived commit dc1d0880b02525d26d12d2356e627419bdcffbaa, I
    thought it would be a good idea to build test-data files, including
    the phony guest images, during the 'make' phase.  Previously these
    were built early in the 'make check' phase.
    
    However this has two disadvantages: (a) We run the appliance
    unnecessarily during builds.  For example, it is not necessary to
    build the phony guests if we are going to do an 'installcheck'.
    (b) Even if we are testing, the critical first time we run the
    appliance is not in 'quickcheck' or 'tests/qemu', but some random
    guest build.
    
    Reorder the build sequence to fix this, and also a few other things.
    
    This updates commit dc1d0880b02525d26d12d2356e627419bdcffbaa.

commit dd5f5ffb485d6efe7f907c050f578ad61688e526
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 30 21:39:54 2015 +0000

    test-data: Remove bogus comment.
    
    The way we now build the blank guest images is safe to be run in
    parallel.

commit cd6f7f6ee07402d88c489e72f4bddf5b24374069
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 30 18:50:18 2015 +0000

    tests/regressions: Fix rhbz1174551.sh so it works when debugging is enabled.
    
    This test failed during release testing.  It turned out to be because
    the tests are run with LIBGUESTFS_DEBUG=1 LIBGUESTFS_TRACE=1 which
    causes other messages to be printed.
    
    Updates commit b5a6f899cdf383e07871952dd7378b0787c43687.

commit c078486041edce70aae7122897fc110a5c0221da
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 30 16:28:28 2015 +0000

    Version 1.31.22.

commit dc1d0880b02525d26d12d2356e627419bdcffbaa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 30 13:08:45 2015 +0000

    tests: Move the tests/data and tests/guests directories to test-data.
    
    Create a new top-level directory called test-data, which will carry
    all the test data which is large and/or shared between multiple tests.
    
    There are actually several new subdirectories created:
    
    test-data/binaries: The pre-built binary and library files for random
    architectures that we use to test various architecture detection
    features (was part of tests/data).
    
    test-data/blank-disks: The blank disks which are used for disk format
    detection (was part of tests/data).
    
    test-data/files: Other miscellaneous test files from tests/data that
    are not included in the above.
    
    test-data/phony-guests: The phony guests (was tests/guests).
    
    test-data: The top-level directory builds the 'test.iso' image file
    that is used for testing the C API and in miscellaneous other tests.

commit 7efde6589ceb087ddcce2e7a2947197b7c2b7067
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 30 15:09:37 2015 +0000

    tests/regressions: Display errors in rhbz1174551.sh.
    
    Updates commit b5a6f899cdf383e07871952dd7378b0787c43687.

commit 93214205ccf124f91695b7eb5d5af37284d30453
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 30 10:52:30 2015 +0000

    Version 1.31.21.

commit 6b2ff3377c817701aaf78853341694c074901fb7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 30 10:26:20 2015 +0000

    v2v: windows: Create Windows module, and move functions around.
    
    Create a Windows module, analogous to the Linux module we already
    have.  Move utility functions related to Windows into this module.
    
    In particular:
    
     - detect_antivirus function moves here, and the Detect_antivirus
       module goes away entirely
    
     - copy_virtio_drivers / virtio_iso_path_matches_guest_os moves here,
       and the virtio_iso_path_matches_guest_os can now be hidden
    
    This is just refactoring, but allows us to make deeper changes to
    copy_virtio_drivers.

commit b00a2151ab3d994e6e75b47bea0000a0766a0f26
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 29 21:08:52 2015 +0000

    v2v: utils: Refactor xpath_* functions.
    
    No change, just refactoring.

commit bd65e346d81f3a9240c8b0d1ff8043a526df9ad7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 29 19:06:32 2015 +0000

    v2v: utils: Add a utils.mli file defining the interface.

commit 6a688c51196f27d06e3ff0895abd1c2e514a0dd8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 29 19:06:19 2015 +0000

    v2v: utils: Remove unused function compare_app2_version_min.

commit e9bd10897d5ef0fefd0a4efca2c198dda4b2fe05
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 29 19:06:04 2015 +0000

    v2v: utils: Comment fix.

commit 7f19420cfe1c625a2e08ddbdc269a11e62739716
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 29 19:04:55 2015 +0000

    v2v: utils: Move three utility functions to where they are used.
    
    The three utility functions xml_quote_attr, xml_quote_pcdata and
    uri_escape were only used in a single module.  Move them close to
    where they are used.
    
    This is just code refactoring.

commit e7f8c064cf4b0f1bd3262eae3450448ec603c139
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 29 18:34:36 2015 +0000

    v2v: utils: Don't open Types module.

commit 0dffbb7d9497ef3de267a006a2e9bde9ef219fe1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 29 18:35:35 2015 +0000

    v2v: Move the open_guestfs function into Common_utils.
    
    Removes the somewhat ugly inclusion of this function in Types.  Also
    means we can use this function elsewhere.

commit 63952d966655a545f90a7051386d9814af94e6cb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 29 18:42:08 2015 +0000

    ocaml: Rename Config module as Guestfs_config.
    
    Unfortunately Coccinelle places a Config module in the ocaml libdir,
    and this confuses ocamlfind (only when Coccinelle is installed).
    Since this is a private module that only libguestfs tools use
    internally, just rename it from Config -> Guestfs_config.

commit f4783fcc0d42f1403425f8119c18cdd0d736aead
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 29 14:55:56 2015 +0000

    docs: Group guestfs(3) 'SEE ALSO' into sections.

commit 15b8b6453dbeaca0283e68ff433191c8211d5f92
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 29 14:04:57 2015 +0000

    docs: Move security documentation to guestfs-security(1).

commit 74fba6e6924cb25404921ca63345388aeaa659c5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 29 14:04:57 2015 +0000

    docs: Move architecture and internals documentation to guestfs-internals(1).

commit d07515b947c152fb311f9bef2f8238da1cca38e8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 29 14:04:57 2015 +0000

    docs: Move 'extending libguestfs' documentation to guestfs-hacking(1).
    
    Start to split the huge, monolithic guestfs(3) manual page.

commit a87218c2717d0c7332df873d5e374a1afc600dfe
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 29 12:58:19 2015 +0000

    configure: Move FUSE checks to separate file.
    
    This is moved earlier because it's now part of the C library.

commit cdcd1e7c981ffbed7d0b31e27411996ec62059b5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 29 12:58:19 2015 +0000

    configure: Move misc. library checks to separate file.

commit 34304f5e3d6f978764cff166c70690a03657ec57
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 29 12:58:19 2015 +0000

    configure: Move appliance checks to separate file.

commit dfa9dee775acff445de0f626dc54088775e2150e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 29 12:58:19 2015 +0000

    configure: Move daemon checks to separate file.

commit 56884b6543e397ccdaf4c76839fa38ba6301ec0a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 29 12:58:19 2015 +0000

    configure: Move C library checks to separate file.

commit 4a67b4be93e2bf70ec90a7402c14ea458ff0a8be
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 29 12:58:19 2015 +0000

    configure: Move basic C compiler environment checks to separate file.
    
    Also gnulib stuff.

commit 1d73d93130a48fbc81d8e67cdb9ad58e14f7f07d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 29 12:42:22 2015 +0000

    configure: Move detection of external programs to a separate file.
    
    Do this early since these tests generally don't depend on anything
    else (the external program is either there or its not), and because
    other things depend on some of these tests.

commit 671525bfddf3d2a0ba7ee4a17c14cd6da245a60e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 29 12:34:52 2015 +0000

    configure: Move qemu detection to separate file.

commit 7adf7e26de392596c76104adcac57ffa380a41fc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 29 12:27:24 2015 +0000

    configure: Move bash completion detection to separate file.

commit 3683b5f57fc3a20e3123b29cc134294c941585e7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 29 12:26:01 2015 +0000

    configure: Move Perl program / man page detection into m4/guestfs_perl.m4.

commit 51811c80a1093a14735effe617914baa27c06f59
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 29 12:26:01 2015 +0000

    configure: Move (old, Perl) tools detection into m4/guestfs_perl.m4.

commit 21d41daec0e500ba3a8974bab44133570316e909
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 27 21:53:09 2015 +0000

    configure: Move language binding detection to separate files.
    
    The extra files don't have to be added to EXTRA_DIST, as it appears
    that autotools already knows that it has to add them.

commit db5ebecd8a0a762c73de22b67b63f23572a585e2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 30 09:39:28 2015 +0000

    Revert "resize: add function find_partitions"
    
    This reverts commit 5aa7e99cb9bba7eb7ab0d826fe76b29d9b1c9b2e.

commit 3258695162f4fa1bbf8499bf604d8d5e51460d93
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 30 09:17:30 2015 +0000

    Revert "resize: add function calculate_target_partitions"
    
    This reverts commit 21677c5b46468609d393a724ea629d948c87aec7.

commit 8ad069c402a451fb40a9c03fe9045f7ef9cc1e69
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 30 09:13:01 2015 +0000

    Revert "resize: add function mbr_part_type"
    
    This reverts commit fc34e2d16c2d13d6ae7a381ba931e345ab5ae56d.

commit b1a7903fd12f86f64aac8e3829757a2bf949ec6c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 30 09:10:15 2015 +0000

    Revert "resize: add p_mbr_p_type as member of type partition"
    
    This reverts commit 6e989fd709fea37430398cbb7c01c52cd44bd1ac.

commit 20ae8bd9ec9fdc3c8ffe939185017fb6ae11f8c1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 30 08:50:10 2015 +0000

    v2v: windows: Don't do NTFS heads fix if i_root is not a partition (RHBZ#1276540).
    
    The error was:
    
    libguestfs: trace: pread_device = "NTFS    "
    libguestfs: trace: part_to_dev "/dev/sda"
    guestfsd: main_loop: new request, len 0x34
    guestfsd: error: device name is not a partition
    guestfsd: main_loop: proc 272 (part_to_dev) took 0.00 seconds
    libguestfs: trace: part_to_dev = NULL (error)
    virt-v2v: error: libguestfs error: part_to_dev: device name is not a
    partition

commit 25fee09a4472e9f11377efe6f5a3b782a5f9d59d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 27 18:00:45 2015 +0000

    builder: Add Debian 7 sparc64 image.

commit f5caa421d1bb826559ec7a6d98c1a6b6b1f0a629
Author: Maxim Perevedentsev <mperevedentsev@virtuozzo.com>
Date:   Tue Oct 27 18:20:45 2015 +0300

    Added xfs support to vfs_minimum_size.

commit a4da3f74c97302711156f2f95ca713e64f00096b
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Oct 23 18:27:04 2015 +0200

    builder: run virt-resize with --unknown-filesystems=error
    
    This way, we can make sure that if a template needs to be expanded, the
    result will have all the filesystems correctly expanded, fitting into
    the new sizes of their partitions.

commit 4f97f6866cabcabb750ea2077502a23f3f68dc79
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Oct 23 18:16:47 2015 +0200

    resize: add --unknown-filesystems
    
    Introduce a new option to control how virt-resize behaves when asking to
    expand a filesystem, either unknown to libguestfs or that virt-resize
    cannot expand. The default keeps the current behaviour, i.e. just warn.

commit 858a9de29722742e6d9fb59fccb8b47050fd30be
Author: Maxim Perevedentsev <mperevedentsev@virtuozzo.com>
Date:   Tue Oct 27 17:55:40 2015 +0300

    Added btrfs support to vfs_minimum_size.

commit 3734d76f1ab559d93016a1945044a0c472be1814
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Oct 26 13:07:28 2015 +0100

    build: look for Module::Build instead of ExtUtils::MakeMaker
    
    Module::Build is now used for building the Perl bindings, so look for it
    instead of the old module.
    
    Followup of commit f98e0f115b661c3e5d38a7d4d19fc2968867aaf0.

commit 638761e6dfd44643cc635e9d88b1f546106b273c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Oct 25 17:07:01 2015 +0000

    Version 1.31.20.

commit 31c42e9c118668cb744bfea2c53836308e5753c5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Oct 25 17:01:10 2015 +0000

    perl: Fix location of generator_build Guestfs.xs.
    
    Also add MANIFEST to EXTRA_DIST.
    
    This fixes commit f98e0f115b661c3e5d38a7d4d19fc2968867aaf0.

commit f98e0f115b661c3e5d38a7d4d19fc2968867aaf0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 23 14:11:21 2015 +0100

    perl: Switch to using Module::Build.
    
    Replace ExtUtils::MakeMaker with Module::Build.
    
    'perllocal.pod' and 'bindtests.pl' are no longer incorrectly
    installed.
    
    This change also removes the following phony deps: appliance src_deps
    test_images.  No other language binding needs explicit dependencies
    for their tests, they just rely on the top level build order being
    correct (ie. SUBDIRS in /Makefile.am).

commit 1c506aa960f51ae0a059d19cfcd6dec26aa79487
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 24 12:34:24 2015 +0100

    ocaml: Allow 'make install' to be run twice.
    
    'ocamlfind install' doesn't like to install the same package if it is
    already installed.  It will give errors like:
    
      ocamlfind: Package guestfs is already installed
    
    or:
    
      ocamlfind: Conflict with file: /usr/lib64/ocaml/guestfs/mlguestfs.cmxa
    
    Fix this by removing the old installed files before running
    'ocamlfind install'.  An alternative would be to use
    'ocamlfind uninstall', but this seems more direct.

commit 905a9c54e615e591fad2b9cf269bfd9742e3a95d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 24 12:31:31 2015 +0100

    builder: Allow 'make install' to be run twice.
    
    The error is:
    
    ln -s xdg/virt-builder /tmp/p/etc/virt-builder
    ln: failed to create symbolic link '/etc/virt-builder/virt-builder': File exists
    
    There is no 'LN_SF' macro, but according to the documentation at
    least, it should be safe to add a '-f' flag since it will work for
    both the 'ln' and 'cp' variants of the macro.

commit 474f6525c8e99c1fb78005db23dd6f254e540313
Author: Maxim Perevedentsev <mperevedentsev@virtuozzo.com>
Date:   Thu Oct 22 20:04:32 2015 +0300

    Bugfix in number parsing in vfs_min_size.

commit a1b7540b780b0855145cd7407963cd2714d03da4
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Oct 22 14:39:03 2015 +0200

    v2v: -o libvirt: dump XML for libvirt if verbose
    
    When running in verbose mode, dump the XML we created for libvirt:
    this way it is easier to debug mismatches between what we want to setup
    in libvirt, and what actually gets defined.

commit f56031d5493af36e46de7a97f150a8724b6007fa
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Oct 22 14:10:16 2015 +0200

    v2v: -o libvirt: fix <video> element (RHBZ#1225789)
    
    Create the correct tags for <video> in the libvirtxml, so all the
    attributes are in a <model> child of <video> instead of <video> itself.
    
    Adapt the XML of test-v2v-i-ova to the different expected XML.

commit d8f248ffb44ee6cf34304799604302bcf66fb421
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Oct 22 11:20:35 2015 +0200

    po-docs: generate virt-dib and virt-get-kernel docs

commit 0f0426300099aab712f846974cb0d6af5508f066
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Oct 22 11:13:48 2015 +0200

    build: isolate common po-docs logic
    
    Move most of the content of either po-docs/ja/Makefile.am or
    po-docs/uk/Makefile.am to po-docs/language.mk, and use it exclusively
    instead of the former contents of the languange-specific Makefile.am.
    This way, either adding a new documentation or enabling a new language
    will not require copying over the same make code.

commit 8d8fa9cf4adeedacf8c3f2cce076d2d48541e380
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Oct 21 15:52:31 2015 +0200

    v2v: fix identifier
    
    Set the "virtio_win" identifier to the right Guestfs handle.
    
    Fixes commit f7249a0bccc43d5b5e11703ff432b0361b03292b.

commit 6aea0e21adb4dd0816b807802f8dd3ea28a45423
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Oct 21 15:50:00 2015 +0200

    v2v: use open_guestfs everywhere
    
    Use the common open_guestfs to open Guestfs handles, so we get
    debugging, tracing, and other common options set.

commit 8a9d056163290e74ad01f74942589d1998c4bfce
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Oct 21 15:39:21 2015 +0200

    v2v: move open_guestfs to Types
    
    Move most of open_guestfs to Types, so a common function to open a
    Guestfs handle is available.  Since it does not do all the things the
    old open_guestfs did, the two operations have been moved to the only
    place requiring them.
    
    This function has been placed in Types and not Utils, as will be needed
    by other functions in Types; Utils uses Types, so this avoids a circular
    dependency.

commit 9ecfd8a94f40256b0935d85d7f0369eb9cf7b936
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 21 15:45:27 2015 +0100

    p2v: Set the virt-p2v ISO timeout to 60 seconds (not 6 seconds).
    
    Thanks: Dennis Gilmore.

commit 34d1b2678b04ad506092ee0f5a7bd2f87fe7cbd0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 21 15:20:06 2015 +0100

    p2v: Add dracut-live to the kickstart (RHBZ#1168223).
    
    Thanks: Dennis Gilmore for working out what was missing.

commit b5a6f899cdf383e07871952dd7378b0787c43687
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Oct 21 11:18:32 2015 +0200

    actions: turn some params into FilenameList (RHBZ#1174551).
    
    Use FilenameList as type for lists of file names, as used in some
    listing-alike APIs.  This way we can ensure anything different than just
    file names in those lists is rejected outright.
    
    As a consequence, test-big-dirs.pl does not need to prepend the
    directory name anymore before calling listing-alike APIs: previously
    they didn't fail, but the returned lists contained only invalid
    elements (and only their size was checked).
    
    Furthermore, add a new regression test for it.

commit 7c10cda26650bd0076817b07134c893c28e0adf9
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Oct 21 11:04:50 2015 +0200

    generator: add a FilenameList parameter type
    
    Mostly like StringList (so it can used in current StringList
    parameters), but checking client- and daemon-side that the elements are
    file names.

commit 64cb0f5dad7096282d740d65d1980ce886dc3f3c
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Oct 21 10:51:05 2015 +0200

    tests: use fake-virt-tools also in tests outside v2v
    
    We have phony tools for v2v tests, introduced with
    commit c1af1ba32f126b7be275bcc8cd4ea4e5af27a88e; make use of it also in
    tests related to v2v outside the v2v directory.

commit 2b50bad5680e699721d1b3fbdd550cb656b5f02a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 21 11:23:30 2015 +0100

    docs: Move guestfs-release-notes(1) to docs/ subdirectory.
    
    I have also removed the text equivalent of this file.  Originally I
    added this because it was thought good to have the release notes
    available in a format that doesn't require any special tools to read.
    But:
    
     - POD files are basically text.
    
     - Debian tooling generates the text file in a slightly different way
       from Fedora tooling, resulting in git marking the file as being
       updated when it isn't really.
    
     - github can format and display POD files.

commit 6219e61cbac8f35138c213c4ad744646e97f2c82
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 21 11:12:23 2015 +0100

    Move miscellaneous documentation from examples/ to docs/.
    
    Wasn't very logical putting these doc files in the examples directory.

commit eb36df827bcb87753b3487dea95981e1c43e1bb4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 21 10:36:07 2015 +0100

    guestfs-performance: Add a note about Xen dom0.

commit 0294b1f9b2456f4452f7db8f57b79c5b83ded9c4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 21 10:35:03 2015 +0100

    guestfs-performance: Use lowercase in =head2 sections.
    
    Makes it easier to read.

commit a86a7d0f07f726c59c508eadf7cf809dddcdd170
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 20 23:53:21 2015 +0100

    Version 1.31.19.

commit 8296933ade3c0f663a3d9d19b1dfbf68ec4e2a39
Author: Maxim Perevedentsev <mperevedentsev@virtuozzo.com>
Date:   Tue Oct 20 18:45:56 2015 +0300

    Include resize2fs_P into vfs_minimum_size.

commit b8d4ca686b8ed6ef0863f317a5a80995c87aface
Author: Maxim Perevedentsev <mperevedentsev@virtuozzo.com>
Date:   Tue Oct 20 18:45:55 2015 +0300

    New API: vfs_minimum_size
    
    This call provides the way to get minimum size of filesystem.
    This is needed for shrinking. The return units are bytes.

commit e9b32e1bad2f6e5b79b00ee0098e7d9b773d7d28
Author: Roman Kagan <rkagan@virtuozzo.com>
Date:   Tue Oct 20 19:07:36 2015 +0300

    v2v: add test for --in-place
    
    Signed-off-by: Roman Kagan <rkagan@virtuozzo.com>

commit 3c3873bc9a4bf8f8ebddaaddb39b33b2fddacbc7
Author: Roman Kagan <rkagan@virtuozzo.com>
Date:   Tue Oct 20 19:07:35 2015 +0300

    v2v: document --in-place
    
    Signed-off-by: Roman Kagan <rkagan@virtuozzo.com>

commit d0069559a939e47e5f29973ed9a69a13f0b58301
Author: Roman Kagan <rkagan@virtuozzo.com>
Date:   Tue Oct 20 19:07:34 2015 +0300

    v2v: add --in-place mode
    
    In this mode, converting of the VM configuration, setting up the
    rollback path for error cases, transforming the VM storage and so on is
    taken care of by a third-party toolset, and virt-v2v is only supposed to
    tune up the guest OS directly inside the source VM, to enable it to boot
    and run under the input hypervisor.
    
    Signed-off-by: Roman Kagan <rkagan@virtuozzo.com>

commit fe62f4727f6cdaf82c110ac72e66feb1514c065f
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Oct 19 15:17:46 2015 +0200

    Add a regression test for RHBZ#1011907 / RHBZ#1165785
    
    Test case adapted from Hu Zhang's RHBZ#1242853, thanks.

commit 44889b7d5367bc2b6537b0adcf8bb375a78529cf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 20 16:56:00 2015 +0100

    Version 1.31.18.

commit fa40934aad9b9b2ae80438397277940ddd166a4f
Author: Roman Kagan <rkagan@virtuozzo.com>
Date:   Tue Oct 20 16:08:18 2015 +0300

    v2v: factor out opening and populating guestfs handle
    
    Signed-off-by: Roman Kagan <rkagan@virtuozzo.com>

commit 7ad0c1eee99bd5fe235439278c900c35ef87972a
Author: Roman Kagan <rkagan@virtuozzo.com>
Date:   Tue Oct 20 16:08:16 2015 +0300

    v2v: factor out preserving overlays for debugging
    
    Signed-off-by: Roman Kagan <rkagan@virtuozzo.com>

commit 5c1e068e60517517e54bb91af60fc5757b1ba251
Author: Roman Kagan <rkagan@virtuozzo.com>
Date:   Tue Oct 20 16:08:15 2015 +0300

    v2v: factor out copying of output data
    
    Factor out copying the overlays to final disk images into a separate
    function.
    
    Signed-off-by: Roman Kagan <rkagan@virtuozzo.com>

commit 48345d0d8311f4821cc852d7122fc7d7d2747f25
Author: Roman Kagan <rkagan@virtuozzo.com>
Date:   Tue Oct 20 16:08:14 2015 +0300

    v2v: factor out determining the guest firmware
    
    Signed-off-by: Roman Kagan <rkagan@virtuozzo.com>

commit 030c6fb63e1bcef9c37d01a80f0bac440246d29b
Author: Roman Kagan <rkagan@virtuozzo.com>
Date:   Tue Oct 20 16:08:13 2015 +0300

    v2v: factor out actual guest transformation
    
    Factor out perfoming the actual convertion of the guest, which includes
    determinig the appropriate guest os specific conversion module and
    running its conversion routine.
    
    Signed-off-by: Roman Kagan <rkagan@virtuozzo.com>

commit 5dae9ca23dab90dfb890f6663aa4bacf1df31ced
Author: Roman Kagan <rkagan@virtuozzo.com>
Date:   Tue Oct 20 16:08:12 2015 +0300

    v2v: factor out size checks
    
    Factor the size checks out to separate functions.
    
    Signed-off-by: Roman Kagan <rkagan@virtuozzo.com>

commit a61f14818674b7864712ff881c790f9118118348
Author: Roman Kagan <rkagan@virtuozzo.com>
Date:   Tue Oct 20 16:08:11 2015 +0300

    v2v: factor out populating targets list
    
    Besides, it doesn't need guestfs handle open so move this step earlier
    in the process.
    
    Signed-off-by: Roman Kagan <rkagan@virtuozzo.com>

commit d59a43aa658e5e0e7010a54d9a7a5468ca94cd9a
Author: Roman Kagan <rkagan@virtuozzo.com>
Date:   Tue Oct 20 16:08:10 2015 +0300

    v2v: factor out overlay creation
    
    Iterating over source disks and creating temporary overlays for easy
    rollback fits nicely into a separate function.  In addition, determining
    their size doesn't need to wait until the guestfs is launched: the size
    can be obtained via disk_virtual_size() method.
    
    Signed-off-by: Roman Kagan <rkagan@virtuozzo.com>

commit 3ca8c04273a297daaffd9d90e55c1fd3a1af56dc
Author: Roman Kagan <rkagan@virtuozzo.com>
Date:   Tue Oct 20 16:08:09 2015 +0300

    v2v: factor out opening input VM
    
    Opening the source VM and amending the properties in its internal
    representation in accordance with command-line options fit nicely into
    two isolated functions.
    
    Signed-off-by: Roman Kagan <rkagan@virtuozzo.com>

commit 754a43142c6a132c1146238b9cdff955dc37b81b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 16 10:22:00 2015 +0100

    inspect: Include more information for augeas parse errors (RHBZ#1229119)
    
    If Augeas fails to parse a file, more information is available in at
    least these fields:
    
    ><fs> aug-ls /augeas/files/etc/fstab/error
    /augeas/files/etc/fstab/error/char
    /augeas/files/etc/fstab/error/lens
    /augeas/files/etc/fstab/error/line
    /augeas/files/etc/fstab/error/message
    /augeas/files/etc/fstab/error/pos
    
    Pull out some of these fields and add them to the error message.
    The new error message looks like this:
    
      virt-v2v: error: libguestfs error: /etc/fstab:17:4: augeas parse failure:
      Iterated lens matched less than it should
    
    This updates commit 279addeb7dd4f5f2446a3995eb7704980c08b5ff.

commit bc2b41778405cc6a376a670703ce63e3678bf1fb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 15 22:34:13 2015 +0100

    lib: Define HAVE_LIBVIRT_BACKEND where you have too old libvirt to run the backend.
    
    In the case where libvirt was installed, but is too old to run the
    backend, the libvirt backend would be compiled out but still
    referenced by the library.
    
    Fix this by splitting the definition of HAVE_LIBVIRT (libvirt is
    installed at all) and HAVE_LIBVIRT_BACKEND (libvirt is new enough to
    run the libvirt backend).
    
    Reported by: Efstratios Skleparis.

commit 279addeb7dd4f5f2446a3995eb7704980c08b5ff
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Oct 15 18:14:49 2015 +0200

    inspect: check for errors in files parsed with augeas (RHBZ#1229119)
    
    During the inspection phase, check for errors after aug_load: if any of
    the errors happened in any of the requested files, then report the error
    straight away; ignoring the error means that information would be
    silently lost.  For example, a malformed /etc/fstab would have caused
    the inspection to not handle any of the additional mount points, giving
    cryptic errors later on when trying to access files in any of the mount
    points.
    
    Now guests with invalid files such as /etc/fstab, /etc/mdadm.conf, and
    /etc/sysconfig/network will cause the inspection to fail, instead of
    being reported with a single mount point ('/').

commit 45bb7c8bcbb92c47b85538e00ff6bdaa316b92a8
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Oct 15 16:24:25 2015 +0200

    mllib: move is_regular_file there
    
    Move the is_regular_file function, implemented in virt-dib and virt-v2v,
    to Common_utils.

commit 42c60abfbdddb0f70d67ba5ba640dfcb93fec8f6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 15 14:32:02 2015 +0100

    v2v: Curry Changeuid.func.

commit 01ede002dbb9333358b336c9cb9c33afce1a19f8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 15 14:31:24 2015 +0100

    v2v: Rename Kvmuid module to Changeuid.
    
    It has nothing to do with KVM.

commit 2587db8f18b6709c26981bd19d2ad67d7e8f3412
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 15 14:24:10 2015 +0100

    Version 1.31.17.

commit b50f341576d24c9618e18051fe59c0cca6aa070f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 15 13:23:29 2015 +0100

    v2v: Add unit test for virtio_iso_path_matches_guest_os.

commit 6b02513bb25b6ec84efb8c78af557bc2dc2d417f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 15 12:25:01 2015 +0100

    v2v: Rename match_vio_path_with_os -> virtio_iso_path_matches_guest_os.
    
    Just refactoring.  Having the function name begin with 'match' was a
    bit confusing because it can look similar to a match statement.

commit 2cb86bc4dcc49915588f5ba1bef8cb5c2714cd66
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 14 16:44:52 2015 +0100

    lib: Add comment and regression test for case where main process has large heap.
    
    Thanks: Dan Berrangé for identifying the problem.

commit 25bde98cb1fd485a435593e2f9b7a5d7a2fc87fb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 14 16:25:56 2015 +0100

    lib: info: Move common code for setting child rlimits.
    
    This is almost just refactoring, but I also set the memory
    limit to really 1 GB, and not 1×10⁹.

commit 169bc884a5f115ee6e10140eaf2d45f3faf2b9d2
Author: Roman Kagan <rkagan@virtuozzo.com>
Date:   Wed Oct 14 19:55:44 2015 +0300

    v2v: drop useless forced gc
    
    Now that virtio driver copying is localized in a single function and the
    auxiliary guestfs handle doesn't leak outside of it (and thus an extra
    qemu instance doesn't survive beyond that function's runtime) there's no
    need in the forced GC which used to trigger closing of that handle and
    termination of that qemu instance.
    
    Signed-off-by: Roman Kagan <rkagan@virtuozzo.com>

commit f7249a0bccc43d5b5e11703ff432b0361b03292b
Author: Roman Kagan <rkagan@virtuozzo.com>
Date:   Wed Oct 14 19:55:43 2015 +0300

    v2v: copy virtio drivers without guestfs handle leak
    
    Refactor copying of virtio windows drivers into the guest so that the
    matching of the drivers to the guest os flavor and copying the files
    happens one next to the other in a single function, and no guestfs
    handle (nor any other irrelevant info) is leaked outside.
    
    Signed-off-by: Roman Kagan <rkagan@virtuozzo.com>

commit 4ff0bfc3369a26d2035e5cae787c9fb34361f1c9
Author: Roman Kagan <rkagan@virtuozzo.com>
Date:   Wed Oct 14 19:55:42 2015 +0300

    v2v: consolidate virtio-win file copying
    
    Copy the appropriate driver files from the virtio-win storage into
    %SYSTEMROOT%\Drivers\VirtIO once they are discovered, and stick to using
    those copies later on.
    
    This way the knowledge of where the drivers come from originally is
    consolidated in one place, so the lifetime of the associated entities
    becomes easier to control (to be implemented in followup patches).
    
    Signed-off-by: Roman Kagan <rkagan@virtuozzo.com>

commit a5e7823c9238df403406681205db7ed33ef668e9
Author: Maxim Perevedentsev <mperevedentsev@virtuozzo.com>
Date:   Wed Oct 14 18:13:29 2015 +0300

    New API: resize2fs_P
    
    Added support for getting ext2/3/4 filesystem minimum size.
    This is needed primarily for shrinking images.

commit 3bf70226f64205f7324f755af64ab927cff0bd5a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 14 14:45:48 2015 +0100

    v2v: test harness: Suggest using make check -k.

commit b486ae16310f03c89c2d37b317efd7f4ce71ac55
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 14 14:45:29 2015 +0100

    v2v: test harness: Use I<> quoting around command line parameter.

commit 753bf99f5c6ba6bdf904968d34ce6537d79e7869
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Oct 12 16:38:50 2015 +0200

    builder: fix conversion of double to OCaml (RHBZ#1270011).
    
    Create the OCaml value for double using caml_copy_double, which is
    the correct way, simplier, and works.

commit 1f23a2c3a9c77f22e27ff4bae828a19ef3d36fe0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 9 17:55:19 2015 +0100

    Version 1.31.16.

commit 9090408ea181595239bff2128edd6eca3c55e71a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 9 17:46:36 2015 +0100

    v2v: -i libvirt: Fix comment.

commit 5cdff50d8a9b6c1e2777b2264fa0ea04c027f124
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 9 12:45:02 2015 +0100

    v2v: Refactor the map_source_to_uri function.
    
    Move this function to the VCenter module.  This is easier since it
    doesn't have to do dcPath calculation (see previous commit).
    
    The readhead parameter is no longer labelled.

commit ffea9f97926efc45c894a113b65b2ff467d91b04
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 9 12:22:52 2015 +0100

    v2v: Use libvirt-supplied <vmware:datacenterpath> if available.
    
    In libvirt >= 1.2.20, the VMware libvirt driver supplies the correct
    dcPath to use via <vmware:datacenterpath> in the libvirt XML.  If
    libvirt passes us this element, use it.
    
    This code still allows the user to override dcPath using the --dcPath
    option on the command line, but that's mainly for safety so we can fix
    any problems in virt-v2v or libvirt in the field.  As we get more
    confident in libvirt and as libvirt 1.2.20 is more widely adopted, we
    will be able to deprecate this parameter entirely.
    
    Thanks: Matthias Bolte for adding the <vmware:datacenterpath> element
    to libvirt in
    https://libvirt.org/git/?p=libvirt.git;a=commit;h=636a99058758a0447482f3baad94de8de3ab1151

commit a8c725071d85e009fd61775b08866f770e7b3b8d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 9 11:53:02 2015 +0100

    v2v: Move VCenter functions to library module.
    
    This refactors useful VCenter functions out of the large
    'input_libvirt_vcenter_https.ml' file.

commit d4431886c76bccb2b7d3886080f45a287f1980ba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 9 11:38:19 2015 +0100

    v2v: Move curl functions to library module.
    
    This refactors the curl functions used to talk to vCenter into a
    library module.

commit 6fb4428358c3a210792c285bb33263b8404d33ee
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 9 13:20:57 2015 +0100

    v2v: Fix bogus comment.

commit 63342614975bc222027a60d0ae2cbc3a8a9ada7a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 9 12:32:48 2015 +0100

    inspect: Don't free uninitialized string.
    
    libguestfs: trace: v2v: read_lines "/etc/os-release"
    [...]
    libguestfs: trace: v2v: read_lines = ["NAME=Fedora", "VERSION="20 (Heisenbug)"", "ID=fedora", "VERSION_ID=20", "PRETTY_NAME="Fedora 20 (Heisenbug)"", "ANSI_COLOR="0;34"", "CPE_NAME="cpe:/o:fedoraproject:fedora:20"", "HOME_URL="https://fedoraproject.org/"", "BUG_REPORT_URL="https://bugzilla.redhat.com/"", "REDHAT_BUGZILLA_PRODUCT="Fedora"", "REDHAT_BUGZILLA_PRODUCT_VERSION=20", "REDHAT_SUPPORT_PRODUCT="Fedora"", "REDHAT_SUPPORT_PRODUCT_VERSION=20"]
    
    At this point libguestfs segfaulted.
    
    It seems as if 'major' is not used here, so don't try to free it.
    
    This fixes commit 32d19e3289bc259901f77398703f16cf6eabd510.

commit 4f9899dd0136f9fde05e03fd4da80313ed2f5663
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 8 22:05:19 2015 +0100

    Version 1.31.15.

commit 48ae2d1dd1337470d2aaf06d5b04ef9cb64e821f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 8 21:49:37 2015 +0100

    handle: Free g->identifier on close.
    
    This fixes commit f6e13aeb65b37ae7fd4222bf16dfb2f9b03d188d.

commit 108c8173fa7648d3f8567a69979a5aca3b989df9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 8 20:09:03 2015 +0100

    v2v: Add xpath_int64 functions, and use them to read memory values.
    
    On 32 bit platforms, reading the memory values can cause some numbers
    to be read as negative numbers.  Fix this by treating memory values as
    64 bit integers throughout the parsing and calculation.

commit 37360159bf2c3b75b06c9ebc6e4c47369e5720e2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 8 19:51:43 2015 +0100

    Version 1.31.14.

commit e5fd9b54dd7b4753f25a36184bb73e6ed514b018
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 8 16:44:47 2015 +0100

    test/qemu: Fix free/close of log file.
    
    The log file was not being closed at the right time, resulting in the
    process running out of open files.  Also the log filename buffer was
    not freed.
    
    This fixes commit 7bbf5cab2884c27987b590d75f6577a8f9dabf73.

commit bd0b52d08e1fbffc947eae9274ae30cf3a17737e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 8 16:49:44 2015 +0100

    v2v: Use handle identifier in a few places.
    
    Set the handle identifier of the main handle to "v2v".
    
    Whenever we open a second handle for any substantial operation, set
    the handle identifier for that handle too.
    
    This should make traces clearer.

commit a94019f52fc7e8d17b6469da498223d6babb2326
Author: Roman Kagan <rkagan@virtuozzo.com>
Date:   Thu Oct 8 16:50:36 2015 +0300

    v2v: add test for v2v with virtio-win drivers on iso
    
    For that, add autofoo machinery to generate the iso out of the fake
    virtio-win drivers introduced in the previous patches, and pass the
    resulting image in $VIRTIO_WIN to v2v in a new test otherwise similar to
    test-v2v-windows-conversion.sh.
    
    Signed-off-by: Roman Kagan <rkagan@virtuozzo.com>

commit 3c26dbf30936dcf4a8babaac4fb1f8515442f758
Author: Roman Kagan <rkagan@virtuozzo.com>
Date:   Thu Oct 8 16:50:35 2015 +0300

    v2v:tests: use fake virtio-win drivers
    
    In order to test the copying of virtio-win drivers into the guest during
    v2v, create a set of fake virtio-win drivers and make use of them in the
    corresponding v2v tests.
    
    Signed-off-by: Roman Kagan <rkagan@virtuozzo.com>

commit 7bbf5cab2884c27987b590d75f6577a8f9dabf73
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 8 15:19:26 2015 +0100

    tests/qemu: Add qemu-boot --log option.
    
    This option can be used to direct output from each individual
    boot test to a different file.  Usual usage is:
    
      qemu-boot --log /tmp/output.% -v -x -n 1000

commit f291411f76352df47f7741e2e135403ecba1f2ea
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 7 18:01:09 2015 +0100

    Add the thread identifier to various multi-threaded programs and tests.

commit f6e13aeb65b37ae7fd4222bf16dfb2f9b03d188d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 7 17:53:58 2015 +0100

    New APIs: set-identifier, get-identifier
    
    Add a per-handle identifier.  The main effect of this is to change
    trace output from:
    
      libguestfs: trace: foo
    
    to:
    
      libguestfs: trace: ID: foo
    
    which makes it simpler to follow traces from multi-threaded programs.

commit 5f352f6eea70ebd25dff988656739abb0c475485
Author: Roman Kagan <rkagan@virtuozzo.com>
Date:   Thu Oct 8 16:50:34 2015 +0300

    v2v:test:win: actually check the eventual layout
    
    v2v/test-v2v-windows-conversion.sh used to query if the expected
    directories and files were present in the VM upon conversion; however it
    would ignore the results of that query.
    
    That lead to the test passing even though the checks failed.
    
    To fix it, parse the output of guestfish and verify that all is-file and
    is-dir commands report the expected "true".
    
    The approach taken is slightly more elaborate than what is being used in
    other components, but it allows to generate comprehensible reports in
    case of test failure, and facilitates future expansion of the set of
    checks including negative ones.
    
    Signed-off-by: Roman Kagan <rkagan@virtuozzo.com>

commit 2fabb89fee8f3b5284d4b1cf6e573587f71e1317
Author: Roman Kagan <rkagan@virtuozzo.com>
Date:   Thu Oct 8 16:50:33 2015 +0300

    v2v: add fake rhev-apt.exe
    
    Without rhev-apt.exe the code path where firstboot scripts are created
    isn't taken, so it isn't tested and v2v/test-v2v-windows-conversion.sh
    is supposed to fail (it actually doesn't but for another reason,
    addressed in a followup patch).
    
    Signed-off-by: Roman Kagan <rkagan@virtuozzo.com>

commit c1af1ba32f126b7be275bcc8cd4ea4e5af27a88e
Author: Roman Kagan <rkagan@virtuozzo.com>
Date:   Thu Oct 8 16:50:32 2015 +0300

    v2v:tests: use fake rhsrvany.exe
    
    The tests that depend on rhsrvany.exe being available, actually don't
    need it to be the real one: all they want is the file being present.
    
    So, instead of skipping the tests if the real rhsrvany.exe is not found,
    store a fake one in the repository, and point $VIRT_TOOLS_DATA_DIR at
    its location.
    
    Signed-off-by: Roman Kagan <rkagan@virtuozzo.com>

commit 0f414edd11fe5dc57f997e844e6d032638abca8b
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Oct 8 16:31:54 2015 +0200

    build: use libintl where needed
    
    Followup of commit a5426cce5faa0fde0de1b62c8646cb8a9992ef2b.

commit 4d3466af6861511e74937369dca803e3273863ce
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Oct 8 13:34:03 2015 +0200

    fuse: test-fuse: close files even on errors
    
    Make sure to close the open files even when test_fuse() returns earlier
    because of failures, otherwise the mountpoint is still in use by open
    files when later guestunmount is called on it.

commit 411e8e30e7bdbf814df3920dd2a0787bed66b2ce
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 7 17:26:01 2015 +0100

    v2v: Skip test-v2v-o-libvirt.sh on !x86_64.

commit 95fe361215e492f017d13f8a5012ee6f444464b2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 7 14:24:37 2015 +0100

    Version 1.31.13.

commit b1f11ef75b3e38078ca908d4ece34690310f6ed8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 7 14:16:00 2015 +0100

    ocaml/examples: Fix use of event_callback in debug_logging.ml.
    
    This fixes commit 8bbc5e73cb5b56b5cfbe979ac0e1c14d1701a0d8.

commit a332e23dde6f3c0405a6df638184053174cd7fc0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 7 14:15:05 2015 +0100

    ocaml/examples: Remove all programs in 'make clean'.
    
    Previously the debug_logging program was not being deleted.

commit 9c97cc720b3e2375399b233d67052e6252585324
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 7 14:02:56 2015 +0100

    Version 1.31.12.

commit 63d1a8050a465ec11d4407784ec118a279d68751
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 7 13:25:32 2015 +0100

    configure: Check that OCaml version >= 3.11.

commit 585a7e1f3e6551945f919e8c7be5956dd5d6f6fc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 6 14:53:43 2015 +0100

    ocaml: Add regression test for failure of implicit close.

commit 8bbc5e73cb5b56b5cfbe979ac0e1c14d1701a0d8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 6 15:42:39 2015 +0100

    ocaml: Allow Guestfs.t handle to be garbage collected.
    
    ** NB: This is an API break for OCaml programs using Guestfs.event_callback. **
    
    Because of the way I implemented Guestfs.event_callback which had the
    Guestfs.t handle as the first parameter, we had to store the (OCaml)
    Guestfs.t handle in the C handle's private data area.  To do that, we
    had to create a global root pointing to the handle.
    
    This of course meant that the handle could not be garbage collected
    (thanks Roman Kagan for spotting this).
    
    This changes the API of Guestfs.event_callback so that a handle is no
    longer passed.  The OCaml handle can now be garbage collected again.
    
    For programs that need the Guestfs.t handle in the callback function
    (which turns out to be *none* of the OCaml programs we have written),
    you can do:
    
      g#set_event_callback (callback_fn g) [Guestfs.EVENT_FOO];
    
    In this case, since the closure passed to Guestfs.set_event_callback
    is still registered as a global root, that will capture a reference to
    the handle, so the handle won't be able to be garbage collected until
    you delete the callback.

commit 3858db9d5878162a3fbefd8b2f070f098c564f18
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 6 15:00:00 2015 +0100

    ocaml: Use generational global roots.
    
    These are considerably more efficient than ordinary global roots, but
    with the caveat that the program is not allowed to modify them without
    calling a special function.  We don't modify them, so this change is
    safe.
    
    This requires OCaml >= 3.11, but we have that on RHEL 6
    (since we dropped support for RHEL 5).
    
    See also:
    http://caml.inria.fr/pub/ml-archives/caml-list/2008/03/c3bf86990088236ceeb9a0f0f4c35390.en.html

commit 0944acf90c4515d921b4752dff99d11441d00b12
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 6 13:26:04 2015 +0100

    mllib: Replace various ad hoc string_* functions with String.*
    
    This is just a straight refactoring.  Various ad hoc string_*
    functions that appeared in Common_utils have been renamed and placed
    in the String.* namespace.  The old vs "new" functions are:
    
    string_prefix  -> String.is_prefix
    string_suffix  -> String.is_suffix
    string_find    -> String.find
    replace_str    -> String.replace
    string_nsplit  -> String.nsplit
    string_split   -> String.split
    string_lines_split -> String.lines_split
    string_random8 -> String.random8

commit 47892b580b1f2ca73191fc9077d6e0b48fbbecb2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 6 12:36:05 2015 +0100

    mllib: Hide unsafe lower/uppercase functions.
    
    The ones in the OCaml stdlib assume ISO-8859-1 bytes and strings, and
    so can end up corrupting UTF-8 strings.

commit 932e5ad0891684fecb0b45728bb6e5c374386d23
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 6 12:46:16 2015 +0100

    mllib: Add (Char|String).(lower|upper)case_ascii functions.
    
    These functions come from upstream OCaml (4.03) where they were
    written by Gabriel Scherer under a compatible license.
    
    See also:
    http://caml.inria.fr/mantis/view.php?id=6694
    http://caml.inria.fr/mantis/view.php?id=6695

commit 672920f3e94bc3e72a2a6d644a0816bb66461189
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 6 12:30:43 2015 +0100

    mllib: Override Char and String modules from stdlib.
    
    In Common_utils, override the Char and String modules from stdlib.
    This hides the original (stdlib) modules, and means that whenever you
    use Char.foo or String.foo you are in fact calling the
    Common_utils.Char.foo or Common_utils.String.foo function.
    
    As it stands, this change does nothing, but it will allow us to drop
    unsafe functions (like String.lowercase) and add extra functions.

commit 7d7a1aeeac0064ed56639c3129e08a70766248e1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 6 12:23:21 2015 +0100

    mllib: Don't alias G = Guestfs in Common_utils module.

commit bdedb47cf0cc42c7bce3bdba0f699168c4d6c2f1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 6 11:47:08 2015 +0100

    tests: Don't leave a libguestfs tmpdir lying around after running test-launch-race.pl.
    
    Calling _exit(2) in the child process has the side effect that
    tmp/libguestfsXXXXXX is not cleaned up.  Clean it up by ensuring the
    handle is properly closed before _exit.

commit 3b5600158333919b4eedbd802b649b55ebc8c01f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 6 11:35:54 2015 +0100

    tests: Fix test-launch-race.
    
    This test has been broken for a while.  It is meant to test that when
    the appliance cachedir is empty, two simultaneous runs of libguestfs
    (both rebuilding the full appliance) will not cause conflicts, because
    (eg) the locking in either supermin or libguestfs is not working.
    
    However the test only set $TMPDIR, but the ./run script sets
    $LIBGUESTFS_CACHEDIR which overrides $TMPDIR, so it was simply reusing
    the existing appliance, and hence not testing anything.
    
    Fix this by clearing $LIBGUESTFS_CACHEDIR.
    
    Note the test now takes a lot longer to run since it does a full
    appliance rebuild.

commit cab3d5d2f6c02765368450008e1e77c5e29cb04c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 6 11:22:21 2015 +0100

    builder: Remove duplicate planner transition.
    
    Seems to be a copy and paste bug in
    commit 62cc7d3361127b4e007f8e23028213852be09124.

commit 540ce6a4e52464843db6c8852307689ddd98e251
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 5 22:00:13 2015 +0100

    clean: Remove null.* and sockets from builddir tmp/ subdirectory.

commit fe4630e0332fecec4482061054063f217daef265
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 5 20:39:21 2015 +0100

    Update translations from Zanata.
    
    However I reverted the Catalan file since it did not appear to be
    newer than the version provided in
    commit 6404114515f23660516013f4aa132dc32fdcba71.

commit dd1dbc5191e07bcf87ac91c2327097b0a2342d49
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 5 17:13:18 2015 +0100

    Version 1.31.11.

commit 7c1bb1b40c2a93f8d33ffa3d4d421837c379b8ed
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Oct 5 14:39:33 2015 +0200

    p2v: fix mode for gtk_label_set_line_wrap_mode
    
    Accoding to its documentation [1], it takes as second parameter a
    PangoWrapMode and not a GtkWrapMode.  While the change should reflect
    the actual value intended, it should slightly change the label wrap
    mode: GTK_WRAP_WORD is 2, which corresponds (as int value) to
    PANGO_WRAP_WORD_CHAR.
    
    [1] https://developer.gnome.org/gtk2/stable/GtkLabel.html#gtk-label-set-line-wrap-mode

commit 29e6368f4c54316857946b10321aa9e547e27a7f
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Oct 5 14:37:32 2015 +0200

    daemon: use str_udevadm in udev_settle
    
    There is GUESTFSD_EXT_CMD defining a string for udevadm (so it is marked
    as "used tool" in the appliance), but it is not actually used when
    starting udevadm.
    
    There should be no behaviour change.

commit d98c9c0e0b4d259f49825fc360bc7e6cafbdd644
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Oct 5 14:05:52 2015 +0200

    Fix shebang in perl scripts
    
    Instead of hardcoding the location of perl (assuming it is installed in
    /usr), use /usr/bin/env to run it, and thus picking it from $PATH.
    This makes it possible to run these scripts also on installations with
    perl in a different prefix than /usr.
    
    Also, given that we want enable warnings on scripts, turn the -w
    previously in shebang to explicit "use warnings;" in scripts which
    didn't have it before.

commit 1e0cbe66814b22fe3394394b0b37b230219969b1
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Oct 5 13:43:00 2015 +0200

    lib: include <sys/socket.h> for accept4
    
    Apparently implicitly pulled by something else on Linux, it is not when
    building on e.g. FreeBSD.
    
    This reverts the change to this file of
    commit 3b17152ec399acb35b23331d2c3b4f424a68824a.

commit b530bc764ea75ad586ce99827c924577203303ce
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Oct 5 13:28:32 2015 +0200

    Revert "lib: Don't need to include <rpc/types.h>."
    
    The include is not needed with GNU libc, where rpc/xdr.h includes it
    [1].  But this does not happen on other libc's, for example the
    FreeBSD [2] and Mac OS X [3] ones.
    
    Hence put it back, with an extra comment about this.
    
    [1] http://linux.die.net/man/3/xdr
    [2] http://www.freebsd.org/cgi/man.cgi?query=xdr&sektion=3&apropos=0&manpath=freebsd
    [3] https://developer.apple.com/library/mac/documentation/Darwin/Reference/ManPages/man3/xdr.3.html
    
    This reverts commit ada85d15669886f0456ffecf1b13fc7a7df38e5c.

commit 8554dbbc031ae770847a6d2658e0d2c501274b65
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 5 13:35:40 2015 +0100

    Remove multiple hacks that only apply to RHEL 5.
    
    We don't support RHEL 5 upstream (see the 'oldlinux' branch for a
    version that works with RHEL 5).  Therefore remove a bunch of hacks
    that were only needed on RHEL 5.

commit 677c721e85380fc54ae6d0bebe885101360a6028
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 5 11:40:16 2015 +0100

    Fix whitespace.
    
    Because of previous automated commits, such as changing 'guestfs___'
    -> 'guestfs_int_', several function calls no longer lined up with
    their parameters, and some lines were too long.
    
    The bulk of this commit was done using emacs batch mode and the
    technique described here:
    
      http://www.cslab.pepperdine.edu/warford/BatchIndentationEmacs.html
    
    The changes suggested by emacs were then reviewed by hand.

commit d07b32e14fe28a6a9a5b05ee3069e06060a38590
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 5 11:55:31 2015 +0100

    Change 'fprintf (stdout,...)' -> printf.
    
    Result of earlier copy and paste.

commit 82763c0444df88e6edb2ecb3f4c5a1cafc1b0a34
Author: Roman Kagan <rkagan@virtuozzo.com>
Date:   Mon Oct 5 15:40:05 2015 +0300

    v2v:utils: ignore files w/o extension
    
    When searching for virtio drivers, it makes no sense to fail if we
    encounter a file without extension.
    
    Ignore such files instead, just like we do for the files whose extension
    doesn't match that of a driver-related file.
    
    Signed-off-by: Roman Kagan <rkagan@virtuozzo.com>

commit 1f47ba92f20b812c8fe2fd6359b648863a8bcac4
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Oct 5 11:41:03 2015 +0200

    actions: fix documented limit for btrfs labels
    
    Our documentation of set-label says that labels for btrfs are limited
    to 256 characters, while btrfs-filesystem(1) says:
    
      Note
      the maximum allowable length shall be less than 256 chars
    
    which is indeed true, as trying to set a label with 256 characters
    fails. Hence, fix our documentation to say that the limit is actually
    255 characters.
    
    Related to RHBZ#1164708.

commit 67bd4f37a1f6a55543ad8de3e995145808ea98b1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Oct 4 20:03:46 2015 +0100

    Version 1.31.10.

commit 5d2ebb707655a770e50ad52edc9908e3d74f5869
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 2 15:22:19 2015 +0100

    launch: direct: Use a single -machine [type, ]accel=... option.
    
    Previously we used (on arm): -M virt -machine accel=...
    
    After this change, we use: -machine virt,accel=...
    On x86 there is no change.
    
    The -M option is an abbreviation for -machine, and we can combine the
    two options together.  (Qemu combines the two options internally, but
    it's more predictable if we do it ourselves).
    
    Upstream qemu has supported the -machine option for over 5 years, and
    in fact we implicitly relied on it (despite what the comment in the
    code said).

commit 45cc5489b238d9abe2c08e3fcf222700b9287b28
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 2 15:22:20 2015 +0100

    launch: Change comment.
    
    Making -machine configurable would be a really bad idea.

commit bc8e1ff9ae17f623c8518847b8011c0262ca30cb
Author: Cédric Bosdonnat <cbosdonnat@suse.com>
Date:   Fri Oct 2 18:16:48 2015 +0200

    customize: remove zypper's gpg keys auto-import
    
    This option was considered unsecure, found a fix on the generated
    opensuse images instead.

commit 9c836e86694a819f244adf661418bea97c40bba8
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Oct 2 14:52:14 2015 +0200

    ruby: improve rdoc markup
    
    - fix the syntax of hyperlinks
    - replace the deprecation text with a simplier named list item, so it's
      more visible
    - use a named list item for the pointer to the C documentation of each
      API
    - add a named list item for the version of each API

commit 6404114515f23660516013f4aa132dc32fdcba71
Author: Robert Antoni Buj Gelonch <rbuj@fedoraproject.org>
Date:   Thu Oct 1 20:06:31 2015 +0200

    add Catalan in po/Makefile.am

commit 7bc6fb245183c040bbda222b92fab495cc951052
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 23 14:46:15 2015 +0100

    build: Remove ./configure --enable-valgrind-daemon.
    
    If you've ever tried to use this option, you'll know that it didn't
    work well.  It broke random things (probably RHBZ#1020216, definitely
    RHBZ#1023630), and caused random failures generally, while often not
    actually failing when valgrind itself found problems.

commit 4414de775ad11624a6263bdbaa200fe5695caebb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 1 14:17:52 2015 +0100

    ocaml: Conditionally remove bindtests.* when doing 'make install'.
    
    Commit f6a790b67d7c8f79532f61d20d11ec8d3a4e003b changed the Makefile
    so it only builds the tests when you run 'make check'.
    
    If you didn't run 'make check' then (in particular) bindtests won't be
    built, and so when you install it cannot be removed.
    
    The simple fix for this is to make the removal of bindtests.*
    conditional.
    
    This fixes commit f6a790b67d7c8f79532f61d20d11ec8d3a4e003b.

commit 2c519cf055cd2f5eb5de2b680e6571a5754e9b8e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 1 14:11:40 2015 +0100

    Add missing generated files to generator_built and EXTRA_DIST.
    
    Use the generator_built variable to list any files which are built by
    the generator.  This ensures they get automatically rebuilt.
    
    Three files were missing from EXTRA_DIST, so they were not included in
    the tarball, meaning you would have needed OCaml to build from the
    tarball.  You would have seen this when building:
    
      cd .. && /builddir/build/BUILD/libguestfs-1.31.9/generator/generator
      written gobject/docs/guestfs-title.sgml
      written customize/customize-synopsis.pod
      written customize/customize-options.pod
      generated 476921 lines of code

commit 3b4f83e0b2ae637dab1691ec349a5b57dbc3abc1
Author: Cédric Bosdonnat <cbosdonnat@suse.com>
Date:   Thu Oct 1 13:59:10 2015 +0200

    customize: sles password defaults.

commit 24d2230831a6b0ada205598419f91e5a22ac4ac7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 30 17:30:47 2015 +0100

    Version 1.31.9.

commit d0aa7a032c302c986dbc9f3c9a1e98fccde86517
Author: Cédric Bosdonnat <cbosdonnat@suse.com>
Date:   Wed Sep 30 17:01:54 2015 +0200

    Add opensuse.gpg to the dist tarball
    
    Adding missing opensuse.gpg to EXTRA_DIST.

commit 3f3d9353a3aa998e046e8fce4ea6493a451e0938
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 30 10:15:55 2015 +0100

    ocaml: Improve ocamldoc.
    
    Miscellaneous improvements to the ocamldoc:
    
     - Generate more sub-headings.
    
     - Document the object-oriented API.
    
     - Use a common function to generate the doc for module and OO APIs.

commit b482593a07a120e81f3a76e200d77ee56aeaffa9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 30 10:01:00 2015 +0100

    ocaml: Use ocamlfind to run ocamldoc.
    
    Using 'ocamlfind ocamldoc' is much faster than running 'ocamldoc'
    directly, because ocamlfind will run the native code program
    'ocamldoc.opt' if it is available.
    
    This change approximately halves the time taken to compile the ocaml
    bindings.

commit 84598ef6f5024349033d03695f56d9737ce6ddc8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 30 12:06:50 2015 +0100

    daemon: Compile stubs.c first.
    
    This shaves about 20% off the compile time for the daemon subdirectory.
    
    See also:
    https://rwmj.wordpress.com/2015/09/30/make-and-queuing-theory/#content

commit 538c5d5eb735b39a754f4d27989e5996c8e0cf48
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 29 22:39:23 2015 +0100

    java: Only build the tests when running 'make check'.
    
    Make the tests 'check_DATA' so they only get built when running the
    tests.

commit f6a790b67d7c8f79532f61d20d11ec8d3a4e003b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 29 22:28:28 2015 +0100

    ocaml: Only build the tests when running 'make check'.
    
    Make the tests 'check_DATA' so they only get built when running the
    tests.  This saves a couple of seconds on the build time.

commit 3b17152ec399acb35b23331d2c3b4f424a68824a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 29 21:58:41 2015 +0100

    lib: Remove unused header files.
    
    I used ESR's deheader program to look for unused includes.  I then
    examined each instance by hand, and also test-compiled (on Linux).

commit ada85d15669886f0456ffecf1b13fc7a7df38e5c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 29 19:56:21 2015 +0100

    lib: Don't need to include <rpc/types.h>.
    
    It is already included by <rpc/xdr.h>.

commit c938202bc8a41116b16a29c1e60fd35f73a16271
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 29 19:53:12 2015 +0100

    lib: Move <libintl.h> -> files that use it.
    
    Don't include <libintl.h> (for gettext etc) in <guestfs-internal.h>.
    Include include it only in files that use internationalized strings.

commit 2ff115a73636c5e6646cb78a8c427038cb3e1312
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Sep 30 10:09:36 2015 +0200

    copy-in: error out early if the localpath does not exist

commit 4bb4c0f4f7326221da963245ce38b3fcc65a29d9
Author: Cédric Bosdonnat <cbosdonnat@suse.com>
Date:   Tue Sep 29 15:59:34 2015 +0200

    builder: add opensuse images sources

commit 8571c1298abb0edf09cee7914fe934c28cbc8e4f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 29 22:44:24 2015 +0100

    haskell: Remove whitespace in Makefile.am.

commit 491b3d4f4446028ace03915dc7c1acebfd9fad53
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 29 19:02:33 2015 +0100

    Version 1.31.8.

commit 66efad41724c6819f88efb47562c8715c3718df9
Author: Cédric Bosdonnat <cbosdonnat@suse.com>
Date:   Tue Sep 29 15:59:35 2015 +0200

    customize: get zypper to eat licenses and gpg keys
    
    Without these flags --install will most likely fail as the GPG key
    may no be imported in the guest image.

commit bbc4a649b4d45f098acb1aab2bc7df75a85e8906
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 29 12:16:17 2015 +0100

    copy-in/copy-out: Capture errors from tar subprocess (RHBZ#1267032).
    
    Modify the copy-in/copy-out APIs to use the new guestfs_int_cmd_pipe
    internal API.
    
    This new API allows us to capture the stderr from the tar subprocess
    if it fails, fixing RHBZ#1267032.  The user will now see errors like
    this:
    
    $ guestfish -N fs -m /dev/sda1 copy-in '/tmp/d/*' / : ll /
    libguestfs: error: tar subprocess failed: tar: *: Cannot stat: No such file or directory
    tar: Exiting with failure status due to previous errors

commit e98bb8692929a037f3452686719504aea31f311d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 29 12:10:36 2015 +0100

    cmd: New internal API for read/writing to a subprocess via a pipe.
    
    Roughly equivalent to popen(...,"r"|"w") the new internal API allows
    you to run a subprocess and either read its stdout, or write to its
    stdin.

commit 2fc1e1462576125c7c315a11b220d541702dc11b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 29 11:34:19 2015 +0100

    cmd: Move all the common processing code for running the child into a subfunction.
    
    Anything that doesn't involve pipes [parent-child communication] is
    moved into the run_child function, so we can reuse the same code when
    writing the new pipe APIs (see following commit).  Anything involving
    setting up pipes stays in the existing run_command function.
    
    This is just refactoring.

commit 60aa4238c40519512cc4767f394201699042bf66
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 29 12:10:02 2015 +0100

    lib: Move read_whole_file function into separate library.
    
    Allow this useful function to be called from elsewhere.
    
    This commit is almost, but not completely refactoring.  I made a minor
    change to the function so that it \0-terminates the returned data,
    which is convenient for some callers.

commit 73928e9e3566faedc5f63718ca1bcd1c81628592
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 29 11:16:38 2015 +0100

    lib: Whitespace cleanups.

commit 1b6f0daa9ae7fcc94e389232d0c397816cda973d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 29 11:06:10 2015 +0100

    Revert "cmd: add a way to run (and wait) asynchronously commands"
    
    This reverts commit c5d3d198dcbceac928f430e2a9450ca58d6c0890.

commit 3c27f3d91e1566854747bbe844186783fc84f3a8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 29 11:05:07 2015 +0100

    Revert "cmd: add the possibility to get a fd to the process stdin"
    
    This reverts commit db055262d4a859cf5d38fef235a117e1fd0b7aff.

commit 578619171845a7ef536d34e74fd4e4933000c179
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 25 20:24:21 2015 +0100

    v2v: Further information on using ovftool to create OVA files.
    
    https://github.com/libguestfs/libguestfs/commit/c9291a91b05a7cae02b09a7891f195d15e4672d9#commitcomment-13440884
    
    Thanks: GitHub user https://github.com/angystardust

commit f37d363f1861301a0fee38785e1c7be3f75c3807
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 25 13:41:27 2015 +0100

    v2v: Update /etc/sysconfig/kernel DEFAULTKERNEL (RHBZ#1176801).

commit c9291a91b05a7cae02b09a7891f195d15e4672d9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 25 10:36:36 2015 +0100

    v2v: Mention ovftool in the man page as a way to create OVA files.

commit 2d1d485265e9fa8a12d4681d4a16eae99927ee8e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 22 14:16:54 2015 +0100

    installcheck: Use 'make check -k' option.
    
    Run all the tests, even if some of them fail, so you can easily see
    the complete list of failures.  This still exits with an error if any
    test fails.

commit cc1c010aa0a6b40f0f6934b6ecd8df09002a42ef
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Sep 20 15:26:15 2015 +0100

    Version 1.31.7.

commit 3fa674df5f613e851138133a01e865731bc713bf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 18 17:31:21 2015 +0100

    Remove make-check-on-installed.pl from EXTRA_DIST.
    
    Removed in commit f2540d68e4e62c8cf90ac501b378a4e9a2ba89e5.

commit dd61872582a03cfba36d0093596fd935965e30f1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 18 14:59:09 2015 +0100

    configure: Require OCaml and findlib if we need to run the generator.
    
    When building from git, you need OCaml to compile the generator to
    build the generated files.  Previously configure didn't detect that
    situation, resulting in failed builds.  This commit causes the
    configure script to error out if the generated files are not present
    and OCaml is not installed.
    
    Note that you can still build without OCaml, if you get the generated
    files from somewhere else.  The source tarballs distributed on the
    website contain the generated files.

commit bc0ea5958731adb5ec526d2b2211b417cb25c22e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 18 14:10:00 2015 +0100

    v2v: documentation: Add link to import-to-ovirt.pl script.

commit dda1a7c37c51029c445977e80df99d5b9fa7979f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 16 16:26:34 2015 +0100

    v2v: documentation: Add 'OTHER TOOLS' section.
    
    This currently contains just a link to rhevm-image-uploader.

commit 38be2da9bec9311c268d48c385cafa6049f67434
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Sep 13 13:45:32 2015 +0100

    python: Set program name to the true name instead of 'python'.
    
    As in commit e102bcf3cfcbcb2b47ad88334f03d5abf636f1e5 (for Perl), any
    Python program has the handle program name field set to 'python'.  Set
    it to the true name (derived from sys.argv[0]).

commit bb7d088edaa2ea3a664ae703e002f6297dd1844f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 15 14:51:09 2015 +0100

    python: Allow bindings to be compiled with different version of libguestfs (RHBZ#1262983).
    
    When compiling the libguestfs bindings as a pip module, it's helpful
    if you can compile the bindings with a different version of libguestfs
    (eg. installed 1.28, pip module 1.30).
    
    That broke the previous assumption that we were always compiling
    against precisely the same version of libguestfs (which made sense
    because the python bindings are part of the libguestfs source tree).
    
    Python distutils has no way to check a C library to find out if
    functions are defined.  Therefore we have to rely on GUESTFS_HAVE_*
    macros from <guestfs.h>.

commit ac5b3a050dbbf85b1430ba81a6e44ad6c08efa1f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 15 14:41:04 2015 +0100

    header: Define GUESTFS_HAVE_STRUCT_* for each struct defined in the header.

commit a17627cdd2f06a65d69889fa0289531caf3b9d23
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 15 14:36:48 2015 +0100

    header: Define GUESTFS_HAVE_* for every function.
    
    Previously we only defined GUESTFS_HAVE_* macros for functions that
    were not deprecated, test or debug functions.  The reasoning for that
    is given in this commit message [note that 'LIBGUESTFS_HAVE_' is the
    old/deprecated macro]:
    
      commit 2d8fd7dacd77361bc385be42112289faafb5c60d
      Author: Richard Jones <rjones@redhat.com>
      Date:   Thu Sep 2 22:45:54 2010 +0100
    
        Define LIBGUESTFS_HAVE_<shortname> for C API functions.
    
        The actions each have a corresponding define, eg:
    
          #define LIBGUESTFS_HAVE_VGUUID 1
          extern char *guestfs_vguuid (guestfs_h *g, const char *vgname);
    
        However functions which are for testing, debugging or deprecated do
        not have the corresponding define.  Also a few functions are so
        basic (eg. guestfs_create) that there is no point defining a symbol
        for them.
    
    This wasn't in fact carried through very consistently, since when we
    replaced s/LIBGUESTFS_HAVE_/GUESTFS_HAVE_/, we kept the old
    LIBGUESTFS_HAVE_* macros, but defined them for every function.  Oops.
    
    This commit defines GUESTFS_HAVE_* for every function in <guestfs.h>,
    making it easier to write the Python language bindings (see following
    commits).

commit f2540d68e4e62c8cf90ac501b378a4e9a2ba89e5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 15 12:26:49 2015 +0100

    Add 'make installcheck' rule to test installed packages.
    
    Allow the tests to be run on the installed libguestfs.so library and
    on installed programs (but not installed language bindings, yet).
    
    To run the tests, you have to have a copy of the libguestfs source
    tree with exactly the same version as the installed libguestfs.  You
    have to build the libguestfs source tree.  Then you do:
    
      make installcheck
    
    I investigated making automake 'make installcheck' work, but it's
    basically broken (no surprise there).
    
    This is derived from the old 'make-check-on-installed.pl'
    script (which is also removed in this patch).

commit 59a9101e44f727aef0ffdd11d3270031113baa11
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Sep 15 10:19:58 2015 +0200

    daemon: initrd: print return value from failing process
    
    If either zcat or cpio fails when spawned in initrd-list, pclose will
    return the actual return value of it, but reply_with_perror still uses
    errno regardless; thus, the reported error is:
    
      libguestfs: error: initrd_list: pclose: Success
    
    which is not much helpful.
    
    Instead, when pclose returns > 0, extract the actual return value of the
    subprocess, and print that. Thus now we get for example:
    
      libguestfs: error: initrd_list: pclose: command failed with return code 1

commit e102bcf3cfcbcb2b47ad88334f03d5abf636f1e5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Sep 13 13:45:32 2015 +0100

    perl: Set program name to the true name instead of 'perl'.
    
    Currently any Perl program has the handle program name field set
    to 'perl'.  Set it to the true name (derived from $0).

commit 1b856a20bae3b3322e66bb74b60e4b360112dad5
Author: Shahar Lev <shahar@stratoscale.com>
Date:   Sat Sep 12 17:52:55 2015 +0300

    v2v: fix provides list whitespace trim
    
    Tabs should not be doubly-escaped in regexp.
    
    Signed-off-by: Shahar Lev <shahar@stratoscale.com>

commit 7fb21afff6730cb057f5fb83cafa9de48479f40f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 11 15:28:39 2015 +0100

    Version 1.31.6.

commit edcd02a965ae6675c0ee9ecd8d98a1a641c6ef60
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 10 23:06:20 2015 +0100

    launch: libvirt: Better error when bridge / virbr0 doesn't exist (RHBZ#1262127).
    
    The current diagnostic is terrible.  This one tells the user how to
    diagnose and fix the problem.

commit 0ed38550981fdde0a5fa5393b42b35c4131eea6f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 10 12:07:31 2015 +0100

    v2v: Add --dcpath parameter to allow dcPath to be overridden (RHBZ#1256823).
    
    It's currently impossible to correctly predict the dcPath parameter
    from the data that libvirt gives us.  So allow the user to override
    --dcpath themselves.
    
    Eventually we will get better support in libvirt for this, and this
    option will no longer be needed:
    
      https://www.redhat.com/archives/libvir-list/2015-September/thread.html#00201
    
    This enhances commit 51bc573d0c4e78104a682e7c42d63d701aedd093
    and commit 20f1eb400b13be8733b6586769c4845b99a70722.

commit 1b8dd2150be5ed5aa3695684a88cf3ab5cac6b76
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Sep 10 11:12:53 2015 +0200

    builder: fix prototype virt_builder_yajl_tree_parse
    
    Declare the prototype depending whether libyajl is available, and if it
    isn't add also the noreturn attribute.
    
    Fixes commit 87a42174f93c0f2621f3598c43327e5d071ade9a.

commit 32d19e3289bc259901f77398703f16cf6eabd510
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Sep 9 16:17:59 2015 +0200

    inspect: try to use /etc/os-release on Linux guests
    
    If a Linux guest has /etc/os-release (mandatory for systemd, so all the
    recent Linux distributions have it), try to parse it for the distro, its
    version, and its product name.  If we cannot get all of them, the
    detection as done so far continues.
    
    Other than changes in the product_name string (which is free-form
    anyway, and already documented to not be parseable), there should be no
    regressions in the detected distro and version.

commit e3aee9c14d093d010349567b2f035defceef57df
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 9 13:47:19 2015 +0100

    v2v: -o rhev, -o vdsm: Set DefaultDisplayType back to 1 (RHBZ#1260590).
    
    In commit c4bc8116d9d586085f96da2e5558c9b366e84925, the DefaultDisplayType
    was changed from 1 -> 2.  However this is in fact wrong.  See
    https://bugzilla.redhat.com/show_bug.cgi?id=1260590#c17 for details.
    
    This reverts the code back to what it was in
    commit 829e3fe7a6ed834939a7a79e453ab873d3328ae1.
    
    Thanks: Omer Frenkel

commit d68be534eab585916ec829424d072f3ace5a4060
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 9 13:12:16 2015 +0100

    v2v: Detect AVG Technologies as AV software (RHBZ#1261436).
    
    Thanks: Junqin Zhou

commit 6734fce8c8a1da083cc259d98e088fe78076dd24
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 9 13:11:42 2015 +0100

    v2v: Move anti-virus (AV) detection code to a separate module.
    
    This is just code refactoring of earlier
    commit 8e28d6b18860f8ff4e02489317749a723fa145ab.

commit 27becc7e2fda11087d4658fe6c054bcdfcac8fee
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Sep 9 13:19:57 2015 +0200

    builder: handle output filenames with ':'
    
    Use qemu_input_filename for the output file in the qemu-img convert
    invocation.
    
    See also commit 1709263613ac97cb1f37333e1a429c34f6b79f26 for
    virt-sparsify.

commit 87a42174f93c0f2621f3598c43327e5d071ade9a
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Sep 9 10:50:01 2015 +0200

    builder: add noreturn for yajl functions without libyajl
    
    caml_invalid_argument will not return, and GCC warns (or errors out with
    -Werror) when the function is not marked as such.

commit 1b4c1d74d36c942417ea946a561a1964b20a1191
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Sep 8 19:07:23 2015 +0200

    customize: password: use SHA-512 on openSUSE >= 11.0
    
    openSUSE 11.0 has glibc 2.8, which supports the SHA-512 method.
    Fallback to an explicit MD5 for older versions.

commit f788b3c48d012fe4361b748885de4b4545e3d015
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Sep 8 19:05:49 2015 +0200

    inspect: recognize the Frugalware distribution
    
    Just basic identification, name and version.

commit 6c3bc24f9029d624c815c006e481f510137ba41a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 8 14:20:28 2015 +0100

    Version 1.31.5.

commit 6d08da07dc31c620342b028892497c13c6e65876
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Sep 8 11:52:44 2015 +0200

    build: improve maintainer-check-extra-dist target
    
    Filter out from the git ls-files output the files we don't care they
    appeared (gnulib and intltools stuff), and use comm to only show the
    remaining added files (i.e. files not being distributed).
    
    The output of comm is redirected to file and then printed, so we can
    check it is empty (failing the target if not).

commit fb9c17c8d43c6e08b9858ca477230cd367db33a9
Author: Cédric Bosdonnat <cbosdonnat@suse.com>
Date:   Tue Sep 8 09:40:22 2015 +0200

    Allow curl to follow redirects.
    
    download.opensuse.org uses redirects to point to the relevant mirror.
    Adding -L --max-redirs 5 to curl options will get us the requested
    images.

commit 268de62db605507158d87e73532cce2bacddb78e
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Sep 8 11:51:00 2015 +0200

    builder: distribute simplestreams test files
    
    Fixes commit b024aef6fb2d7219782c6cd00e6c703e161f839d.

commit c8436df4a2265ef4b7a7262db5d8d47ed4c2b520
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Sep 8 11:48:25 2015 +0200

    builder: replace colons in simplestreams test files
    
    Colons won't be handled by make at all, so replace them with underscore
    to be able to distribute them.

commit c4bc8116d9d586085f96da2e5558c9b366e84925
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 8 09:11:36 2015 +0100

    v2v: -o rhev, -o vdsm: Use correct DefaultDisplayType for qxl (RHBZ#1260590).
    
    This fixes commit 829e3fe7a6ed834939a7a79e453ab873d3328ae1.

commit 5ed4388ecd5fdb7639622ee4fba317c276547257
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 7 22:01:34 2015 +0100

    customize: Create .ssh as 0700 and .ssh/authorized_keys as 0600 (RHBZ#1260778).
    
    Both ssh-copy-id and ssh create .ssh as 0700.  ssh-copy-id creates
    .ssh/authorized_keys as 0600.
    
    Thanks: Ryan Sawhill for finding the bug.

commit b024aef6fb2d7219782c6cd00e6c703e161f839d
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Sep 7 14:30:35 2015 +0200

    builder: support Simple Streams v1.0 as index metadata
    
    Add a new "simplestreams" repository type, and a simple parser for
    fetching and reading the JSON indexes of the Simple Streams v1.0
    format.
    
    Read only datatype=image-downloads contents, and only the latest
    versions of each content available as disk image (disk.img or
    disk1.img).
    
    Add a simple test, using the "released" images from the CirrOS project.

commit 13eac43e28800294fc2b0b67f61fcb23276db22e
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Sep 7 14:29:47 2015 +0200

    build: expose HAVE_YAJL to automake
    
    This way it can be used in automake conditionals.

commit 23d17191050e0f1614cead73631cf9c8db8b5937
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Aug 13 10:21:27 2015 +0200

    builder: add simple libyajl binding
    
    Only yajl_val and yajl_tree_parse are exposed for now.

commit 7dfbb1f11c4ab7b4ffc012a5170ef3ea9102fe86
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Aug 11 11:04:00 2015 +0200

    builder: add non-int revisions
    
    Add support for non-integer revisions of entries, comparing them as
    integer when possible.

commit 8e28d6b18860f8ff4e02489317749a723fa145ab
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 7 17:18:41 2015 +0100

    v2v: windows: Warn if Group Policy or AV software may result in 7B boot failure (RHBZ#1260689).
    
    Check if the Windows guest has Group Policy Objects installed, or one
    of several popular pieces of anti-virus software.  If we are
    installing a virtio block driver, then experience has shown this may
    cause a 7B boot failure.
    
    Print a warning when this combination happens.
    
    The warnings look like this:
    
    [  19.9] Converting Windows Server 2008 R2 Enterprise to run on KVM
    virt-v2v: warning: this guest has Windows Group Policy Objects (GPO) and a
    new virtio block device driver was installed.  In some circumstances, Group
    Policy may prevent new drivers from working (resulting in a 7B boot error).
     If this happens, try disabling Group Policy before doing the conversion.
    virt-v2v: warning: this guest has Anti-Virus (AV) software and a new virtio
    block device driver was installed.  In some circumstances, AV may prevent
    new drivers from working (resulting in a 7B boot error).  If this happens,
    try disabling AV before doing the conversion.
    virt-v2v: This guest has virtio drivers installed.

commit 8f889f0c3e65908299d68376b79fbda4fceb2fbe
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 7 17:16:24 2015 +0100

    v2v: windows: Refactor Xen uninstaller detection code.
    
    No change, just refactoring.

commit 4335088d74fd0fd3708bd4384a4adf9b5081c759
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 7 16:53:17 2015 +0100

    dib: Move 'isdigit' utility function to common code.
    
    No change, just simple refactoring.

commit 4ded4430bf457b57272430103ae86d152bf65c20
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 7 15:00:01 2015 +0100

    v2v: -o rhev, -o vdsm: Add sound card to OVF output.
    
    For the two sound card types that RHEV can emulate, add
    them to the output.

commit 829e3fe7a6ed834939a7a79e453ab873d3328ae1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 7 13:30:04 2015 +0100

    v2v: -o rhev, -o vdsm: Review XML based on oVirt description of format.
    
    After reviewing http://www.ovirt.org/images/8/86/Ovirt_ovf_format.odt
    this commit makes some small revisions to the OVF that we generate.
    
    Possible fix for https://bugzilla.redhat.com/show_bug.cgi?id=1260590

commit e27199274645dad962670bb75f87cc7472d36c4d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 7 12:10:09 2015 +0100

    v2v: Error if certain options appear twice on the command line.
    
    Change the handling of -ic, -if, -oc, -of, -on, -os, --password-file,
    --vdsm-vm-uuid, --vdsm-ovf-output, --vmtype options, so that if any
    appear multiple times on the command line we error out:
    
    $ virt-v2v -i disk /tmp/centos-6.img -o null -of qcow2 -of raw
    virt-v2v: error: -of option used more than once on the command line
    
    Thanks: Juquin Zhou for finding the bug.

commit 0afe4773d08a7c2a60562129309674c9dc8381b3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 3 21:49:56 2015 +0100

    Version 1.31.4.

commit 7e63d3680f373cd0c61412a30b009edfb2d9104f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 3 12:20:10 2015 +0100

    v2v: test-harness: Allow test boot at fixed dates in the past.
    
    Turns out that some of the Windows guests in the test suite try to
    reactivate if the date is more than some time delta (maybe 1 year?)
    after the previous activation.  Just disabling the network wasn't
    enough to prevent this.
    
    qemu allows us to boot guests with the clock set to a particular date
    in the past, and libvirt exposes this (albeit very clumsily):
    
    https://docs.fedoraproject.org/en-US/Fedora/18/html/Virtualization_Administration_Guide/sect-Virtualization-Tips_and_tricks-Libvirt_Managed_Timers.html
    
    Allow guests to be booted with the date set to a particular past date,
    by setting the test_plan.guest_clock field.
    
    This required adding some more libxml2 bindings.

commit 6246bebf82e2bd097aa476dad101416faf03240f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 3 16:12:22 2015 +0100

    p2v: Clear previous version and driver information when testing connection (RHBZ#1227609).
    
    When calling test_connection to test the connection to a conversion
    server, we also query for the remote server's version and driver
    information (using 'virt-v2v --version' and
    'virt-v2v --machine-readable').
    
    However we didn't clear the existing information from previous runs.
    
    One consequence of this was that if you used the back button in the
    GUI, the list of output drivers would be repopulated two or more
    times.  https://bugzilla.redhat.com/show_bug.cgi?id=1227609
    
    Another is that connecting to a different server could confuse
    test_connection into thinking the connection was successful (because
    of data from the previous run) when in fact it was not.
    
    Thanks: Tingting Zheng for finding the original bug.

commit 302ea2aa5b666d254d2d562210a98825886e1b08
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 3 16:06:59 2015 +0100

    p2v: Use gtk_list_store_clear instead of loop.
    
    The model implements GtkListStore, so an easier way to clear the list
    is simply to call the clear method.

commit 314713c3b0412713e5d7af4e5bbe2c8613166c04
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 3 15:56:19 2015 +0100

    p2v: Use GtkComboBoxText instead of deprecated gtk_combo_box_new_text.
    
    Requires Gtk >= 2.24, which is the same version that RHEL 6 has.

commit cf3d93c82627279e8c57c0877469f16fc2272ec0
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Sep 1 18:03:12 2015 +0200

    get-kernel: respect -q
    
    Now that virt-get-kernel has -q/--quiet, support it by printing the
    download messages only if not specified.

commit 45f6cfe1a1e73adcc9c423ee396abb7dcb3a7488
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Sep 1 17:47:06 2015 +0200

    get-kernel: refactor list and download code
    
    Split in an own function the code dong the mounting, the inspection of
    the kernel files, and the downloading, including a per-OS function for
    the actual kernel files.  This gives few advantages:
    - the download phease is not repeated for all the files to fetch
    - it is easier to eventually support multi-root disk images
    - it is possible to support OSes different than Linux; virt-get-kernel
      now will just report the unsupported OS, instead of a generic
      "no kernel found" message
    
    This is mostly code refactoring, with (on Linux) no actual behaviour
    change.

commit 997c59139e11fcdde44ef32f6314d0c3d0f3c18b
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Sep 1 16:55:13 2015 +0200

    get-kernel: split command line handling in own function
    
    Simple refactoring, no actual behaviour changes.

commit b360e99ff65b5d4fa2c725e90aa12bc33bf3f2a4
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Sep 1 16:28:03 2015 +0200

    builder, dib, get-kernel: document new -q/--quiet options
    
    Provided as common options for all the OCaml-based tools.

commit 2ec0332e5e10d9c03edb11b982d86a05cb6c069f
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Sep 1 16:07:55 2015 +0200

    mllib: move -q/--quiet as common option
    
    Most of the OCaml-based tools had it already, except from virt-dib and
    virt-get-kernel.

commit 875f46fddce873b55a20b26c67da70dcc0ecf1b9
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Sep 1 15:40:25 2015 +0200

    mllib: make few command line options stuff private
    
    Make print_version_and_exit, long_options, display_short_options, and
    display_long_options private, as set_standard_options now takes care of
    handling the job for the common command line options.

commit 51bc573d0c4e78104a682e7c42d63d701aedd093
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 1 14:56:10 2015 +0100

    v2v: Fix handling of extra slashes in dcPath calculation (RHBZ#1258342).
    
    This updates commit 20f1eb400b13be8733b6586769c4845b99a70722.
    
    Thanks: Tingting Zheng

commit 4cc3cc3fbd5f8f2478368a8fbf83716f18d95ea8
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Aug 31 18:34:37 2015 +0200

    mllib: set --debug-gc as common option
    
    Move --debug-gc as common option for all the OCaml-based tools, even a
    couple of them which didn't have it previously.
    
    As implementation note, make set_debug_gc private to
    set_standard_options, as it needed to be moved otherwise, and it is no
    more required as public function.

commit 2af6e48ba3658e0c0c912f1a1441ac49698318de
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Aug 31 18:25:48 2015 +0200

    mllib: add and use set_standard_options
    
    Introduce a new common helper to add the common options for libguestfs
    tools (short/long options, version, verbose, trace), and sort them.
    All the OCaml-based tools had these options already, so there are no
    functional changes in the interface they provide.
    
    The only difference is that now the options are always sorted, while
    some tools didn't had them like that previously: because of this, a
    couple of ditto markers (as descriptions) don't match what's above them
    anymore, and thus their full description is put instead.

commit 7bdb3e0df93ef9cdee11b40a85056e609de45414
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Aug 31 11:17:45 2015 +0200

    customize: fix running commands on the same architecture
    
    Wrap the command around an heredoc only if setarch needs to be used;
    otherwise the heredoc will not be run at all.
    
    Fix commit d875346ad441d4762455ea1b41d57ad6174d9b63.

commit 2596b78bcbf79e53ecf7a7202d540b6a81182c1b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 28 19:34:15 2015 +0100

    Version 1.31.3.

commit 95233a8eee813c653b1a4d7aa10ad60ad3be3f9e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 28 19:32:15 2015 +0100

    p2v: Add test-virt-p2v-pxe.sshd_config.in to EXTRA_DIST.
    
    Fixes commit afe3c77014bf54fbbfebc4ed43a58b9f85cd8622.

commit d875346ad441d4762455ea1b41d57ad6174d9b63
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 27 17:14:49 2015 +0100

    customize: Use setarch when running commands on i686 guest (RHBZ#1256405).
    
    When running (eg) dnf on a 32 bit i686 guest when the host is 64 bit
    x86_64, dnf believes it is running on a 64 bit machine and so tries to
    install x86_64 packages.  We can 'trick' dnf into believing it's a 32
    bit machine using the setarch program.
    
    $ virt-builder fedora-22 --arch i686 --install 'gperf'
    ...
    [  27.4] Installing packages: gperf
    ...
    Running transaction test
    Error: Transaction check error:
      package libgcc-5.1.1-4.fc22.x86_64 is intended for a different architecture
    ...
    
    The use of a heredoc to solve quoting issues comes from:
    http://stackoverflow.com/a/3435460
    
    Thanks: Jan Sedlák for finding the solution.

commit 18b019e3dd808393cda510b6d80212ff5bdbed76
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 28 13:57:37 2015 +0100

    v2v: -i libvirtxml: Map empty network or bridge name to default (RHBZ#1257895).
    
    As with the -i ova driver, if an unnamed network is found, map it to
    "eth0", "eth1" etc.

commit 261d05749fb75e60d56d3c2d92589de9dca7ca09
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 28 13:53:24 2015 +0100

    v2v: Convert xpath_to_* to use xpath convenience functions.
    
    In -i libvirtxml, -i ova and -o libvirt drivers, replace the ad hoc
    xpath_to_* functions with use of the new xpath convenience functions
    introduced in the previous commit.
    
    This is not entirely refactoring because I fixed a few bugs found by
    type safety.

commit 00e1260d343e1f70d6541347ba61ecb072fef799
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 28 13:52:49 2015 +0100

    v2v: Add convenience functions for parsing xpath expressions.

commit 20f1eb400b13be8733b6586769c4845b99a70722
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 28 12:20:45 2015 +0100

    v2v: vcenter: Calculate dcPath correctly (RHBZ#1256823).
    
    Previously given a path such as:
    
      vpx://vcenter/Folder/Datacenter/esxi
    
    we calculated dcPath=Folder.  However this is obviously wrong.  We
    should chop the path at the final (esxi) element to give
    dcPath=Folder/Datacenter.

commit 1585bb5beeff8325a950eea6331e42b5df64226d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 28 12:05:12 2015 +0100

    v2v: vcenter: Change function get_datacenter -> get_dcPath.
    
    In vCenter, the datacenter is identified by a path, and the parameter
    used for this is called 'dcPath'.  Rename the function to avoid any
    confusion about what we're getting here.
    
    This is just renaming function/variable names and has no other effect.

commit a628fb65fa977e185fb4c414ea65ba4a6f5207b7
Author: Roman Kagan <rkagan@virtuozzo.com>
Date:   Fri Aug 28 17:56:04 2015 +0300

    handle --debug-gc universally via at_exit hook
    
    Several tools handle --debug-gc command-line option, by explicitly
    forcing GC on every exit path.  This is tedious and prone to forgetting
    some of the exit paths.
    
    Instead, add a generic handler for --debug-gc, which installs an at_exit
    hook to do the GC consistency check, and which can be called right in
    the command-line parser.  Also adjust all users of --debug-gc to use
    that handler.
    
    Signed-off-by: Roman Kagan <rkagan@virtuozzo.com>

commit afe3c77014bf54fbbfebc4ed43a58b9f85cd8622
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 24 16:05:05 2015 +0100

    p2v: Add a test for the PXE boot path (RHBZ#1256222).
    
    Build the P2V disk image and boot it.  We don't actually use PXE
    specifically, but we do test the whole PXE / kernel command line path
    much more thoroughly.
    
    This is a 'check-slow' test because it takes ages to run.

commit ca4725e1c76d3b216c63175182c6343220e98622
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 25 10:56:02 2015 +0100

    p2v: Add SSH Identity URL.
    
    Allow SSH identities (ie. secret keys) to be used for authentication
    instead of passwords.

commit 3c30fb4a79ecac6eef3c4c8aefb43ab78f860488
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 25 09:17:00 2015 +0100

    Revert "p2v: Add tip about the root password of the virt-v2v conversion server appliance."
    
    This reverts commit 35efaf820870e7498aacc5d4aaa8c952c635b0e0.

commit 4c34d240a1f152ec257a75f148a8e4a1d91a67c5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 24 14:56:30 2015 +0100

    p2v: Wait for network to come online before testing connection (RHBZ#1256222).
    
    When using the virt-p2v ISO in command line mode, we did not wait for
    the network to come online before starting virt-p2v.  Therefore
    virt-p2v could exit with an error when testing the ssh connection (or
    on the other hand, it might work randomly).  If the user logs in and
    runs 'launch-virt-p2v' by hand, then it would usually work because the
    network had been brought online in the meantime.
    
    Fix this by waiting for NetworkManager to bring the connection online
    before calling test_connection().  Note that the obvious way to fix
    this (changing the systemd service to wait for network-online.target)
    does *not* work - I added a comment to the service about this.
    
    Thanks: Tingting Zheng

commit c1e1e232854def491be762cc09d3bb8f9e816f8e
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Aug 25 17:39:26 2015 +0200

    osinfo: add altlinux and mageia distributions

commit 70579d08cd41c4a2b328aa7fd876e539c884bdc0
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Aug 25 16:17:59 2015 +0200

    inspect: recognize the ALT Linux distribution
    
    Check its presence ahead of /etc/redhat-release, as the distro provides
    it and thus previously it was recognized as "redhat-based".

commit 74f0b45ddf35f1cb1684702e9d3318d77fc3b520
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Aug 24 18:25:10 2015 +0200

    v2v: ignore missing kernels from grub (RHBZ#1230412)
    
    Raise a warning for each kernel specified in grub which does not
    actually exist, keep going on with the conversion using the remaining
    (existing) kernels.

commit baa4ec6e4536be971d482af76f7dca89e74573a7
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Aug 24 18:11:18 2015 +0200

    ocaml: Add handling for errno ENOENT.

commit 649f439cb78f12bb04ef90d83b81e1fa23495852
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Aug 24 17:57:10 2015 +0200

    ocaml: dynamically generate the content of Guestfs.Errno
    
    Put in a list the errnos to expose, filling the content of the
    Guestfs.Errno submodule from that.
    Also, generate a separate guestfs-c-errnos.c with the implementations of
    the functions returning the errno codes.
    
    Only code motion and refactoring, no actual changes on the content of
    the ocaml Guestfs module.

commit 0dcb862943b3adbe54756acf0e30b4d96f5229ff
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Aug 20 17:25:34 2015 +0200

    configure: look for "java" as directory for Java in lib64 too
    
    On 64-bit openSUSE versions, /usr/lib64/jvm/java provides the symlink to
    the default Java version.

commit e6dd9b5d6b66b8eba1c62730c8d5707a7109df27
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Aug 19 14:46:39 2015 +0200

    appliance: explicitly add libyajl on Mageia
    
    It seems yajl was bringing it, but seems not on Mageia 5.  Leave yajl
    for older versions.

commit 97bd64f588c7354f659952dcd0664b47a28425c6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 13 22:54:30 2015 +0100

    FAQ: the -> and in previous commit.
    
    This fixes commit 571fca8e71901bb3f1e68d51defb29fac920ffbb.

commit 571fca8e71901bb3f1e68d51defb29fac920ffbb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 13 22:51:43 2015 +0100

    FAQ: Further improve debugging section.

commit 88280056918658e9ab74267fcbd6da9d335af783
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 13 16:46:08 2015 +0100

    Version 1.31.2.

commit 08b57ae1f4a3df2181b29b6fc8bda9766e90b959
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 13 16:45:30 2015 +0100

    builder/website: Fix EXTRA_DIST.
    
    This fixes commit 190a9f4534eadc720494cfecd758f9dc80026c95 and
    commit 864ca489ac7bddbc9043dfa52d61dc1d816f1f61.

commit c9ad61b37b1efc5e496295117ad5d1614c3862f1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 13 10:01:47 2015 -0400

    p2v: Modify some partial match regexps to work with pcre 7.8.
    
    pcre < 8 has limitations on the types of partial matching
    possible.  As noted in the pcrepartial(3) man page, these can
    be worked around by adding non-capturing parentheses around
    various subexpressions, as I have done here.

commit 92e155dbddaafe0cd9f0be13fc0b723522735eff
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 13 09:43:07 2015 -0400

    p2v: For pcre < 8 (RHEL 6), abort if partial matching cannot be used on a regexp.

commit 1d082d127e017d91bc493807a4a488dfa045a79c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 13 14:13:49 2015 +0100

    p2v: Print an error if gtk_init_check fails.
    
    Apparently gtk_init_check doesn't (always?) print an error message
    when it returns false, so virt-p2v just exits without any message.
    
    This was observed on RHEL 6 when $DISPLAY was not set.

commit 2bfb9ff9ea7316cfa6a62879f77f6600c91789d9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 13 08:40:29 2015 -0400

    p2v: Call g_thread_init with old glib2 as used by RHEL 6.

commit 00bceec4216da7757acf0aa7174a99fb0b6deeb5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 13 08:19:17 2015 -0400

    v2v: Help RHEL 6 OCaml to determine type of class.
    
    File input_libvirt_other.ml, line 1, characters 0-1:
    Error: The implementation input_libvirt_other.ml
           does not match the interface input_libvirt_other.cmi:
           Class declarations do not match:
             class virtual input_libvirt :
               'a ->
               string option ->
               string ->
               object
                 method adjust_overlay_parameters : Types.overlay -> unit
                 method as_options : string
                 method virtual source : unit -> Types.source
               end
           does not match
             class virtual input_libvirt :
               string option ->
               string option ->
               string ->
               object
                 method adjust_overlay_parameters : Types.overlay -> unit
                 method as_options : string
                 method virtual source : unit -> Types.source
               end
           A parameter has type 'a but is expected to have type string option

commit b0cd6917cac7d314e971d90747e053907b48b2f7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 13 08:18:13 2015 -0400

    v2v: Hide StringMap functions we're not actually using.
    
    In RHEL 6 OCaml, some of these functions were not part of the Map
    class, giving an error.  Hide the ones we aren't using.

commit 437cb7b6ffcb21a43a7368d4402228f043a62a9c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 13 08:16:50 2015 -0400

    handle: Move #pragma out of functions.
    
    RHEL 6 gcc did not support #pragma within functions.

commit 06e92bffd4b1924bf9b076e44e59d03ea7146db8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 13 08:15:07 2015 -0400

    p2v: Add replacement for xmlBufferDetach function not available in RHEL 6.

commit 42b6bb12dcbc5103044a9099d71f17a82009e7de
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 12 16:47:22 2015 +0100

    v2v: -oa preallocated for qcow2 output now fully allocates the file (RHBZ#1251909).
    
    When the output format is qcow2 and -oa preallocated is used,
    previously it would only allocate the metadata.  That was a regression
    over previous behaviour of virt-v2v 0.9.  Change it so it allocates
    the full file size in this case.

commit 66daad38f37c8975c4b6bcb760094cf4490fef14
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 12 16:34:16 2015 +0100

    disk-create: Allow preallocation off/metadata/full.
    
    For raw, this allows "off" as a synonym for "sparse" (to make it
    consistent with qcow2).
    
    For qcow2, this allows "sparse" as a synonym for "off".
    
    It also adds qcow2 "full" preallocation, which is actually mapped to
    the qemu option "falloc" (see arguments about this on the qemu-devel
    mailing list, which we lost).
    
    This also updates the test.

commit d78f685c0ea7edbbe1ffdebda95bd86d041d9304
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Aug 11 15:35:01 2015 +0200

    builder: normalize architectures
    
    Normalize the target architecture, and also each architecture when
    checking for a compatible image.
    
    This sort of reverts the effects of
    commit 8864c47b94cf44ac2d0d8d4b5019073ad1da121b, but at least it is
    possible to build e.g. Debian-based amd64 images on any x86_64 system
    without being considered as foreign architecture.

commit 0bbb903f42dacbdb796e5181b9536c1e44fefa6c
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Aug 11 15:32:05 2015 +0200

    mllib: add normalize_arch helper
    
    Small helper to normalize an architecture string, so it is easier to
    compare them and check for compatibilities.
    
    Make use of it in guest_arch_compatible, simplifying it.

commit 90b459a5dbf07e42f3e792064a168149afcd0ee0
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Aug 12 18:21:08 2015 +0200

    dib: expand doc on external dependencies for appliance

commit c2bb87e8f26e75e7ce71748785380b76b6e63658
Author: John Eckersberg <jeckersb@redhat.com>
Date:   Wed Aug 12 11:14:21 2015 -0400

    dib: handle unsetting functions in environment
    
    If a function name, with its trailing parentheses, is in the
    environment , trying to unset it will error out with a message of "not
    a valid identifier".  Handle this as a special case, and unset it with
    the -f option which can handle the parentheses in the supplied
    identifier.

commit 70d020f074918cf84b226f7ee53bfab34cb8f53b
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Aug 12 12:45:25 2015 +0200

    inspect: support the APK package manager and its format
    
    Associate the Alpine Linux distribution with it.

commit 120f06a8a1a8c8632611d9432a8b82a3fe387f99
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Aug 12 12:10:26 2015 +0200

    inspect: recognize the Alpine Linux distribution
    
    Just basic identification, name and version.

commit 190a9f4534eadc720494cfecd758f9dc80026c95
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 12 14:00:09 2015 +0100

    builder: Add script for building RHEL for aarch64.

commit f3a7cf994b5c7350c32fd6011c4224d81f7ee86a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 12 10:42:57 2015 +0100

    customize: firstboot: Place firstboot.service file in systemd unit directory (RHBZ#1250955).
    
    It turns out that -- some of the time -- systemd ignores unit files
    which are not placed in one of the official unit directories.  This
    caused the service to be timed out and killed when the systemd daemon
    was reloaded, as could happen for long-running package installs at
    first boot.
    
    Thanks: Marius Vollmer for diagnosing the problem and finding the
    solution.

commit 75006fc27ce23531860e1578892b86d139d07a1c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 11 16:27:49 2015 +0100

    p2v: Add mesa-dri-drivers.
    
    Requires on Fedora 22 to work around:
    https://bugzilla.redhat.com/show_bug.cgi?id=1242195

commit bfd151b8bfc7d236aac72ef04f62efbd6e6547d7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 11 15:49:28 2015 +0100

    p2v: Add tar to the kickstart.
    
    Work around https://bugzilla.redhat.com/show_bug.cgi?id=1182362

commit 6f74d8044b9a41a35b0fca126013034f35006bef
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 11 15:38:07 2015 +0100

    p2v: Add a note about building a 32- or 64-bit virt-p2v ISO.

commit 864ca489ac7bddbc9043dfa52d61dc1d816f1f61
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 11 13:34:55 2015 +0100

    builder: Add script for building Fedora i686 (32 bit) images.

commit 8cb82aec121f6ecd18630864d807437629a7bf8c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 11 13:34:27 2015 +0100

    builder: fedora: Use os variant fedora22.

commit 4e5d9962cebb96270ac4875a41c56e6b65f588fc
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Aug 10 13:22:27 2015 +0200

    builder: improve "converting" message on unknown format
    
    If the format of the disk image of the template is not specified in the
    index, virt-builder would print
      Converting auto to qcow2
    when asking to generate a qcow2 image.  Instead, in this case print only
    the destination format, like
      Converting to qcow2

commit 068443843db8a08d2d4a3e0f4e393f7e223311ae
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 6 17:29:56 2015 +0100

    v2v: vCenter: Suggest using %20 to escape spaces in Datacenter paths (RHBZ#1250715).

commit fc70ea696bbdc29a4c328cc867cc9b95b31921aa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 6 16:41:09 2015 +0100

    docs: Document CVE-2015-5745 qemu vulnerability.

commit f8a81d6bae9e5b025884947f6e2cce534087c186
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 6 15:02:02 2015 +0100

    update-bugs.sh: Remove comment.

commit 1c43c0800f7429c410d5794232b51a12449c273d
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Aug 6 15:15:40 2015 +0200

    get-kernel: remove extra progname from error messages
    
    error() prints it already

commit 16e6378a5b4b29662f5a7c1ca45e598345960a96
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 4 22:25:26 2015 +0100

    customize: Make dnf upgrade to the latest versions of packages.
    
    I discovered that 'dnf upgrade' doesn't actually upgrade to the latest
    versions of packages unless you also supply the '--best' flag.
    
    This also changes update -> upgrade, since apparently 'dnf update'
    is deprecated.

commit 91c06391c1392d74ea11e7e65dded29122893075
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 4 19:54:02 2015 +0100

    automake: Admit defeat and use 'subdir-objects'.
    
    Because this 'feature' is broken (since 2013):
    
      https://debbugs.gnu.org/cgi/bugreport.cgi?bug=13928
    
    we have to replace all instances of $(top_srcdir) in *_SOURCES lines
    with a relative path.  According to what I read, this shouldn't break
    split builds, but I didn't test it.
    
    The only things automake moans about now are:
    
    * Unescaped left brace in regex is deprecated, passed through in regex; marked by <-- HERE in m/\${ <-- HERE ([^ \t=:+{}]+)}/ at /usr/bin/automake line 3936.
    
      - This is another bug in automake
    
    * autoreconf: configure.ac: AM_GNU_GETTEXT is used, but not AM_GNU_GETTEXT_VERSION
    
      - This is a feature, not a bug.

commit f3ed65525c1b0255463a85e3d459debabfbfcfa9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 5 12:55:42 2015 +0100

    p2v: Display full package version (including extra string) in p2v.ks file.

commit da8776040704b2afb9e044aa44f731d42281cc0f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 5 12:39:58 2015 +0100

    p2v: Allow 'virt-p2v-make-kickstart rhel-7.1' to set up RHEL repos.

commit 007004a536c2893d31cf8e2ba3def629dc002203
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 5 12:39:10 2015 +0100

    p2v: Disable ssh service in the ISO (RHBZ#1248678).
    
    We don't want people to be able to ssh into the p2v ISO while it is
    running, with a simple, known root password.

commit d9c63708311f9b5c309dd1a17b25329f99bac710
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Aug 2 17:33:07 2015 +0100

    sysprep: Allow test-virt-sysprep.sh to be skipped.
    
    It fails in Fedora Rawhide because LVM is broken (RHBZ#1237136).

commit 12898a8862aeb98fe99561ed0fdd895621d89c39
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 31 08:29:18 2015 +0100

    dib: Fix typo in documentation.
    
    Thanks: Yuri Chornoivan

commit 3e71e8ee933c2a27d34cb18c67673de5d2dda5aa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 30 14:50:11 2015 +0100

    Version 1.31.1.

commit 380002b1330d4e4a9a2b69ab0e0da970e4c4636e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 30 14:45:21 2015 +0100

    README: Add the dnf builddep command (for Fedora >= 22).

commit 2d2a65504dca732a398d237565b9778f8ca828b5
Author: Cédric Bosdonnat <cbosdonnat@suse.com>
Date:   Wed Jul 29 10:35:00 2015 +0200

    appliance init: find NIC name for dhcpcd
    
    dhcpcd requires an interface name as parameter to work. We are now
    getting it from /proc/sys/net/ipv4/conf/ folder children. dhclient
    on Debian also has the problem, thus use the guessed interface name
    for it too.

commit 37a03785567b90b59f5191d523cf34eab2a758ef
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Jul 29 13:47:08 2015 +0200

    sysprep: machine_id: handle /var/lib/dbus/machine-id
    
    Another machine-id file, used by D-Bus.

commit bc598ff52af415d8acc923402bd6dcfd462f2e4d
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Jul 29 13:36:23 2015 +0200

    sysprep: machine_id: simplify implementation
    
    Instead of rm + touch, just truncate the file if existing.
    In case there was no file previously, now nothing is created, as most
    probably the system was fine even without it.
    
    Also, turn the single path into a list, so more machine-id files can be
    handled at once.

commit dbbf4b8afe305a284963675cf640e3f2ac523d98
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 27 13:29:40 2015 +0100

    customize: Combine separate -a and -d option synopses (RHBZ#1246882)

commit ae9954e0b452e9653ff9d94171e689d2a729c4cb
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jul 28 10:57:11 2015 +0200

    builder: add Sigchecker.verify_and_remove_signature
    
    New helper to remove the signature from a file, returning a temporary
    file without the signature.

commit 51d40267d7fda73cc375ecaaf669dafb1db588ef
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jul 28 10:55:23 2015 +0200

    builder: expose Sigchecker.verifying_signatures
    
    Useful to know whether a Sigchecker instance is verifying signatures,
    hence it is possible to decide whether download signed content or not.

commit 3b44b7d878cb5858728804442ab197e27ec448b9
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Jul 27 18:45:03 2015 +0200

    builder: split Index_parser.index in an own module
    
    Move the index and entry definitions in an own Index module, together
    with the (previously internal to Index_parser) print_entry debugging
    function.

commit 6a86a3d8ffc94a01ebe61af753164f9a73c72313
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Jul 27 18:15:42 2015 +0200

    builder: allow signatures from subkeys
    
    When importing a key, read the list of the valid subkeys of it, and use
    it to check whether a signature was done by one of them.
    This allows index provides to sign them using a subkey instead of the
    main key.

commit 63175fb3c3b966c163fdf4bcb39e25e347c9bf0c
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Jul 27 10:55:26 2015 +0200

    builder: internally use a list of checksums for indexes
    
    Extend Index_parser.entry to hold a list of checksums to validate, and
    validate all of them.
    
    This does change nothing currently, as only sha512 is read, while still
    allowing us to fetch more checksums if needed.

commit 43499579bf8c19f941acc06a5d466c10129fcacc
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Jul 27 10:31:22 2015 +0200

    builder: add SHA256 support in Checksums

commit 7056af81bda12f450ca6b110bfd16d360dfe3b24
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Jul 27 10:26:13 2015 +0200

    builder: create and use a new Checksums module
    
    Introduce a new Checksums module to handle the check of checksums,
    moving part of the Sigchecker code to it.
    
    Adapt the rest of virt-builder to this new module.

commit a1a1e8e508093963b4ae8aa890abadc965675c70
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Jul 22 18:25:47 2015 +0200

    builder: add format=FMT in repository .conf files
    
    First step in allow different formats for indexes of images, aside the
    current one.
    
    The only accepted value is "native".

commit 6c9ea0471e5c2de4ad360f668ec8079e136cc278
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Jul 24 16:40:11 2015 +0200

    customize: password: improve unknown default crypto message
    
    When warning that there is no known default password encryption for the
    current guest, print also its minor version (help debugging unsupported
    guests).
    
    Also, fix wrapping (and indentation) of the message.

commit 563b388b8e41a5d51a03e0cc9cdd4bacdaadeafc
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Jul 24 15:13:00 2015 +0200

    customize: random_seed: add CirrOS location
    
    CirrOS has its random-seed file in /etc.

commit 7eed43da6c99ed48eac71f29941947ff0e43de0a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 23 16:41:06 2015 +0100

    appliance: Exclude /usr/lib/modules as well as /lib/modules.
    
    It normally makes no difference to the final size of the appliance,
    because 'supermin --build' will copy back the host kernel modules.

commit 0c7b957c1342db210602eea7951f53a44a50e45b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 23 15:10:00 2015 +0100

    appliance: exclude /lib/firmware
    
    Brings the size of the appliance down to 95 MB [xz-compressed], which
    is the same as for libguestfs 1.28.

commit 46600019b13320d1b8c71427716f38298cd4f04a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 23 14:33:52 2015 +0100

    appliance: exclude /usr/share/fonts and /usr/share/icons.
    
    I also sorted the list.
    
    Between libguestfs 1.28 and 1.30, the appliance grew from 95MB to 213MB.
    
    Using guestmount and filelight (see link below) I could see that the
    main contributor was these two directories, which should not be
    necessary.
    
    With this change, the size goes down to 119MB.
    
    See also:
    https://rwmj.wordpress.com/2015/07/23/why-has-the-libguestfs-appliance-grown-by-118-mb/

commit c60cd11e73c98ec58d599d0237c0b152722d1dd3
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jul 21 18:03:22 2015 +0200

    actions: tar_in: add xattrs, selinux, and acls optargs
    
    Add additional arguments for tar, so extended attributes and/or SELinux
    contexts and/or POSIX ACLs can be restored from input tars.

commit afb5db7837d042e4c2f33b54f0559c8d3824ff90
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jul 21 17:41:00 2015 +0200

    actions: tar_out: add xattrs, selinux, and acl optargs
    
    Add additional arguments for tar, so extended attributes and/or SELinux
    contexts and/or POSIX ACLs can be saved in output tars.

commit 499678a8a663dccca90f135f797486895d429610
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 21 17:00:00 2015 +0100

    build: Add virt-dib.1.html and virt-get-kernel.1.html to HTMLFILES.

commit a6433aff70495ef66b8de66b29e58b17aa62076e
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jul 21 16:56:00 2015 +0200

    tests/nbd: pass --format to qemu-nbd if possible
    
    Run `qemu-nbd --help` to know whether it supports --format, and if so
    pass it explicitly.  This avoids warnings with newer qemu versions,
    where they really recommends to explicit the format of disk images being
    specified on command line.

commit 42ff22a90919ca7070850e5bbdb3637ac105ab3d
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jul 21 16:54:29 2015 +0200

    tests/syslinux: add /usr/lib/SYSLINUX as directory for mbr.bin
    
    Yet another new location (found on recent Debian/sid) for mbr.bin.

commit 1a9e06b228d7c12202c94290335fdca46c5ee9df
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 21 13:34:04 2015 +0100

    docs: Finish off release notes for 1.30.

commit 8ac2c4da9fe569abe12013f9ab6dccbe6e9745d6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 21 13:30:40 2015 +0100

    Version 1.31.0.

commit 251c608e481e6e1af6873fcbf404d45581f52503
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 21 13:13:38 2015 +0100

    Version 1.30.0.

commit 95fde969eab57b7290c98031b52cf8aed57e47ce
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 21 12:19:13 2015 +0100

    Pull translations from Zanata.

commit 5a28634bdc4e4833a3aca83d0383faec8cc9f986
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 21 11:55:01 2015 +0100

    Update gnulib to latest.

commit 83a0b4b37cc438196621a5a2c05383631e6e1399
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 21 10:48:36 2015 +0100

    p2v: tests: Don't fail when test machine has only a single hard disk.
    
    virt-p2v looks in /sys/block to find disks, and ignores the hard disk
    containing the root device.  This is correct when virt-p2v runs off
    the ISO, but when running the tests on a machine that has a single
    hard disk, all_disks would be NULL, resulting in a test failure.
    
    Fix this by allowing all_disks to be NULL, but adding an extra check
    later so that we don't perform the conversion with no hard disks (the
    gui.c path already has this check, so it is only needed in the
    kernel.c path).

commit 7c470c11799edbe5a1c7c79309fd31ef83c24b54
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jul 21 11:13:45 2015 +0200

    tests: fix string comparison
    
    Use 'eq' for comparing strings instead of '=='.

commit 19020ea3f80c11884784feab09b72301fd242abe
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jul 21 09:38:11 2015 +0200

    appliance: adding qemu-img and which dependencies for more distros
    
    In particular, add them for Archlinux, openSUSE, Frugalware, and Mageia.

commit 44f71d0782ce9a16d414842608ec02d835061680
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Jul 17 15:28:18 2015 +0200

    customize: add basic subscription-manager operations
    
    Add simple operations for RHEL guests using subscription-manager, so it
    is possible to e.g. install software on them.

commit b357553cd656894e0b20e00abb76738f55a14b72
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Jul 17 15:04:27 2015 +0200

    mllib: add and use read_first_line_from_file
    
    Move the read_password_from_file helper in Password to mllib with a more
    generic name, and use it in place of the former.
    
    Also, use it in v2v instead of reading the whole file contaning a
    password: given that the documentation says that the whole content is
    used, there will not be newlines in the password file, so the behaviour
    will be preserved. The oly difference is that newline is no more an
    acceptable character for passwords, but that is a really unlikely
    (if not impossible at all) situation.

commit d29337605aa7f461cb14595dab43430013e2e2b5
Author: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>
Date:   Fri Jul 17 17:24:22 2015 +0800

    daemon: add a space after func/macro to fit code-style
    
    more daemon codes covered
    
    Signed-off-by: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>

commit 9d3447ad7ae20d96262b431fcb98ca7da61b4cad
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jul 14 11:11:29 2015 +0200

    dib: handle --name with path
    
    Make sure to write in the directory of the specified image name, using
    just the basename where needed (e.g. for $IMAGE_NAME).

commit c3edd076b9c0a735f80bae5dcc5613a09d4cfa02
Author: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>
Date:   Mon Jul 13 11:08:38 2015 +0800

    daemon: add a space after func name to fit code-style
    
    Signed-off-by: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>

commit 08bfad986a4288defd4b994f8f2c74da3193e3a2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 13 10:11:35 2015 +0100

    v2v: windows: Set gcaps_video correctly (RHBZ#1233093).
    
    Depending on whether we found a QXL driver and installed it in the
    guest, set gcaps_video to either Cirrus or QXL.

commit b7fcfb59ef583df46d6033c0538c7dfea83dd42f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 13 10:11:14 2015 +0100

    v2v: OVF: Add a comment about always using QXL.

commit ad4067a5088627bb1754e5c08822039e0b42426c
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Jul 10 14:41:08 2015 +0200

    Improvements to the 1.30 release notes

commit e6404be6eea4ef102fbb9e1a554b5ed1ee108598
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 9 18:31:47 2015 +0100

    Version 1.29.50.

commit 42cee8f8fccf853183040c3bf6ae1839cadaf3ee
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 9 17:55:23 2015 +0100

    docs: When making a stable release, run ./configure --without-libvirt.

commit 6561c96fb7b383cd239c6b1f638510514557c549
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 9 17:53:39 2015 +0100

    v2v: domainxml: Fix missing functions in the !HAVE_LIBVIRT case.
    
    This also uses a C macro to simplify the error functions in this case.
    
    This fixes commit badfc2e9b2a56fd5bac849a6edca4fec823abeea.

commit ae5844cc54b38666ef51c6d8dc94025592fd9d51
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 9 13:12:33 2015 +0100

    Draft release notes for 1.30 release.

commit 350dfe1fa26015fb0631abc3d3dc01b78dee8ead
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 9 15:35:32 2015 +0100

    v2v: Remove RHEL 7 conversion server.
    
    We are no longer planning to ship virt-v2v as an appliance.  In RHEL 7.2
    it will be included in the base RHEL Server product.
    
    This reverts commit 4e4ece53647fba810eeb45086b46d02f54e02fe2.

commit 95bb1916eb1b2f6f9e9575cf4bf92501292bf545
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 9 13:18:47 2015 +0100

    appliance: Exclude more log files (RHBZ#1239154).
    
    This removes further possible log files from the appliance, but
    without removing any subdirectories.

commit 2080f4b0dd307e842dbb0f7e891993f32f30d7f5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 9 13:11:15 2015 +0100

    appliance: Remove typo $@ at beginning of line.
    
    This fixes commit 82b486a9086f84447324d68b3c0cae300e0334f7.

commit c238a9caa1b45a87d41daa0b6ecfb31d1488fe4e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 9 13:07:59 2015 +0100

    appliance: Rebuild appliance if excludefiles changes.

commit 85fe0abdd01981e075353b12f8d0f76d087b5f43
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Jul 9 14:55:43 2015 +0200

    New tool: virt-dib
    
    virt-dib is a new tool to run the elements of diskimage-builder using
    libguestfs.

commit 46be6934fc86a5117fb0d36ff50123752e4390a1
Author: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>
Date:   Wed Jul 8 17:34:45 2015 +0800

    labels: return ENOTSUP if could not set label for specific fs
    
    Signed-off-by: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>

commit d9b53a27527f8a91d3f2ef821908a674341eeb52
Author: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>
Date:   Wed Jul 8 17:34:44 2015 +0800

    labels: use existing do_xfs_admin for xfslabel
    
    Signed-off-by: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>

commit 5c6be8846f1627f432882e96e2dcc10a0c9cb787
Author: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>
Date:   Wed Jul 8 17:34:43 2015 +0800

    labels: move ntfslabel to ntfs.c
    
    Signed-off-by: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>

commit d5a60f21489fd264bbcaa0f17cc7f730d08a0e61
Author: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>
Date:   Wed Jul 8 17:34:42 2015 +0800

    labels: move e2label to ext2.c and call it directly
    
    ext2 should not call function in labels
    
    Signed-off-by: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>

commit 16232ffd580fc3d700ce01e5a5e9b33c11956caa
Author: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>
Date:   Wed Jul 8 11:07:47 2015 +0800

    labels: move btrfslabel to btrfs.c
    
    Signed-off-by: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>

commit de93c690a14b201ed87d3d2a88673d4c530d59e8
Author: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>
Date:   Mon Jul 6 17:13:51 2015 +0800

    doc: add missing ms-dos fs section in set_label
    
    Signed-off-by: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>

commit 105fa8bf31fe1af09bbade1949eb28d622b25b21
Author: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>
Date:   Mon Jul 6 13:34:06 2015 +0800

    uuids: return ENOTSUP if could not set UUID for specific fs
    
    Signed-off-by: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>

commit b04f39bf10e4f760d880d1077e6ffb68d028c0ae
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 6 12:37:23 2015 +0100

    v2v: Add a check before copying that UEFI is supported (RHBZ#1184690).
    
    If UEFI is required by the guest, but not supported by the host, then
    you wouldn't see an error message until after copying.
    
    Add an additional method to the output object so we can check this
    before copying, to avoid a long wait.
    
    Thanks: Junqin Zhou
    https://bugzilla.redhat.com/show_bug.cgi?id=1184690#c22

commit 74e87a970b39864b8f38c9a8b0ddab61b9d9a76e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 6 12:20:48 2015 +0100

    v2v: -o libvirt: Add readonly=yes to UEFI <loader> attribute (RHBZ#1184690).
    
    Thanks: Junqin Zhou for diagnosing the bug and finding the correct
    solution.  https://bugzilla.redhat.com/show_bug.cgi?id=1184690#c22
    
    This fixes commit 40558450dd87190c9dc2649cadbf284ae0a21606.

commit 659d56db3cc4333e7410cac6720c20b3b7fa66ad
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 6 10:47:45 2015 +0100

    v2v: Catch real exception thrown by failing aug_get (RHBZ#1239053).
    
    When converting the old Perl virt-v2v code, I made a silly mistake
    with the exception that aug_get throws when it doesn't find any node.
    It throws a 'Guestfs.Error' exception, not 'Not_found'.
    
    As a result of this, the exception was escaping and the proper error
    message was not displayed.  With a malformed grub configuration you
    would see this error:
    
      $ virt-v2v -i disk centos-6.img -o null
      [...]
      virt-v2v: error: libguestfs error: aug_get: no matching node
    
    After applying this patch:
    
      $ virt-v2v -i disk centos-6.img -o null
      [...]
      virt-v2v: error: no kernels were found in the grub configuration.
    
      This probably indicates that virt-v2v was unable to parse the grub
      configuration of this guest.
    
    which is the correct error message.

commit a477e282dbd20b3eb1adfebe28d2c2bcdbfde8ff
Author: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>
Date:   Thu Jul 2 19:52:37 2015 +0800

    New API: set_uuid_random
    
    Signed-off-by: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>

commit db9bd6158503f65c5f953bfae0fcb5b092b9bbfa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 2 18:06:15 2015 +0100

    Version 1.29.49.

commit ccdbbc7fe43e313c16a00dd30c57a04134e60b2c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 2 15:36:04 2015 +0100

    Fix various -Wformat problems.
    
    Updating gnulib has caused -Wformat-signedness to be enabled.  This
    has revealed many problems in C format strings.  The fixes here fall
    into the following main categories:
    
     - Using %d with an unsigned parameter.
    
     - %x and %o expect an unsigned argument.
    
     - uid_t and gid_t are unsigned on Linux.  The safe way to print these
       is to cast them to uintmax_t and then print them using the %ju
       modifier (see http://stackoverflow.com/a/1401581).
    
     - Using %d to print an enum.  Since enums may be either char or int,
       I fixed this by casting the enum to int.
    
     - strtol_error & lzma_ret are both unsigned types.

commit b263035c1adaffb4d7bf7e6b3f19eec8b8de1e5a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 2 14:52:39 2015 +0100

    Update gnulib to latest.

commit fba82456a990c689ccd38f40509ed86ed882b353
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 2 14:49:37 2015 +0100

    Pull latest translations from Zanata.

commit f5698c3793ade4d97f0232e537abb782457a9c81
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 2 14:14:29 2015 +0100

    v2v: TODO: Add note about -i ova / -o rhev and removable device slots.

commit afd80a27ef761556b53d7a64be5364b5ee231545
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 2 14:14:26 2015 +0100

    v2v: Remove some items from TODO file which we've implemented.

commit b7166e1a9e092b5c2e16ce42a6ee025283d6b520
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 1 13:53:50 2015 +0100

    v2v: Add a regression test for RHBZ#1238053.

commit 309e14189fa1c470977f3a4bccc5456b390d4cce
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 1 18:04:46 2015 +0100

    v2v: Pass target_buses to output object (RHBZ#1238053).
    
    Pass the target_buses assignment to the output#create_metadata method.
    
    Now output modes have a choice: they can either ignore the new
    parameter and continue to use the flat list of targets.  This is
    suitable for output modes that cannot model multiple buses (eg.
    -o glance) or can model it but don't bother (currently -o rhev).
    
    Or they can ignore the flat targets parameter and use the new
    target_buses parameter, translating that into the appropriate list of
    devices.  This is implemented in this commit for these modes:
    
     -o libvirt
     -o local
     -o qemu

commit ce83f2751bea272b96107482aeb37af2358214dc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 1 17:33:28 2015 +0100

    v2v: Introduce the concept of target buses.
    
    The target VM will have several buses to which disks can be attached.
    Commonly it will have an IDE bus, and possibly a virtio-blk "bus" (not
    really a bus) and/or a SCSI bus.
    
    Virt-v2v does not model this at the moment.  Disks are just added to
    the output XML in the order that we write them, and so they can move
    around with respect to the target VM.
    
    This commit introduces the idea that we should model the target disk
    buses, and we should try to assign fixed and removable disks to slots
    on each of those buses.  In this commit, the modelling is not used by
    any output mode, but that will be fixed in the next commit.

commit 847c303a159d9066cd0d96ae90bb30e88d2ed781
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 1 15:15:33 2015 +0100

    v2v: -i libvirt and -i ova: Record the slot number of removable drives.
    
    When we see libvirt source XML for a removable drive like this:
    
       <disk type='file' device='cdrom'>
         <driver name='qemu' type='raw'/>
         <target dev='hdc' bus='ide'/>
       </disk>
    
    as well as recording the bus (s_removable_controller) as we do at the
    moment, also record the slot number (eg. hdc == 2 in the example
    above).
    
    Do the same for OVA input files.

commit 4ef80f28c819605f415a71a2337ae90b9b7888bc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 1 15:14:58 2015 +0100

    v2v: Add a binding for guestfs_int_drive_index and a unit test.

commit 36e22d1e8ec7a82b12624539d43467de759838e7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 1 15:14:49 2015 +0100

    v2v: Add unit test of Utils.drive_name function.

commit c8a9e4b92871b8c37ef031778e5de3f4190d5e62
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 1 15:13:49 2015 +0100

    v2v: Refactor ~printer parameter in unit tests.
    
    Simple refactoring, no functional change.

commit a54fef132a66a56c7287b7bc8876438d84c8ed84
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 1 14:27:53 2015 +0100

    utils: Add guestfs_int_drive_index and unit test.
    
    Add guestfs_int_drive_index which does basically the opposite of
    guestfs_int_drive_name.  This commit also includes a unit test.

commit 625eae504dfe44381e9e1041c9f9846e0f5aeeb7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 1 14:27:36 2015 +0100

    utils: Add a test of the guestfs_int_drive_name function.
    
    This function didn't have a unit test before.

commit d9fc0656b27fd26a6574407c2e620ab729d951cb
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Jul 2 11:25:06 2015 +0200

    tests: do not init a partition for btrfs-image tests
    
    They create an own partition layout, so don't do that over the
    testing-created layout.
    
    At least for me, this fixes parted issues when creating the new
    partition layout and the old one is still reported as in use.
    
    Followup/fix for commit 52d1b0c593e87cb5d696dcc9d96ad6489c9bed00.

commit 4e8ef1ae37d1517a08409b80af337b511770f38f
Author: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>
Date:   Wed Jul 1 17:21:13 2015 +0800

    uuid: use newly introduced swap_set_uuid
    
    Signed-off-by: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>

commit 80cf46e110d9cff2862f3e98b561bae34d29bf52
Author: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>
Date:   Wed Jul 1 17:21:12 2015 +0800

    uuid: add support to change uuid of btrfs partition
    
    btrfs-progs v4.1 add support to change uuid of btrfs fs.
    
    Signed-off-by: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>

commit 261be1f952aa984b460ff8d88d962c490df4ffcf
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Jul 1 14:53:31 2015 +0200

    sysprep: rework and fix cron-spool operation (RHBZ#1229305)
    
    When cleaning the directories with cron/at jobs, remove only files
    there, as subdirectories might be used by other systems; for example
    in Debian under /var/spool/cron/ there is the atjobs subdirectory with
    the actual at queue.
    
    Make sure to not remove .SEQ files anymore, as they represent the at job
    counter which is needed by the at daemon. Instead, reset these files to
    0.
    
    Furthermore, add also the path to the .SEQ location in Debian-based
    systems.

commit a614f3451d1e2cc4f29b1bc7f0d88519c432b2c8
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Jul 1 14:35:31 2015 +0200

    mllib: add and use last_part_of
    
    Collect this small snippet to get the part of a string after the last
    occurrency of a character; replace with it the current snippets doing
    the same.
    
    Should be just code motion.

commit 775e68c4613fabaa3b48ea3dc8d45ac74b93682b
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jun 30 20:59:31 2015 +0200

    mllib: add an optional filter for rm_rf_only_files
    
    This way it is possible to use rm_rf_only_files, but not removing
    specific files.

commit 9f0036a0265417bc7fd6e6d2010f185a4a92d225
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 1 11:14:23 2015 +0100

    v2v: Match any non-"Client" variant, instead of just "Server" (RHBZ#1234351, RHBZ#1237869).
    
    When checking if a Windows variant is a server variant, assume it is a
    server variant unless the i_product_variant field is "Client".
    
    Windows 2008 and Windows 2008R2 does not have an InstallationType key
    in the registry at all, so for these the product variant is returned
    as "unknown".
    
    Windows "Core" would have, according to the reference below,
    "Server Core".
    
    https://msdn.microsoft.com/en-us/library/ee391629%28v=vs.85%29.aspx
    
    This fixes commit 47b5f245bec908f803f0a89c3b1e3166cfe33aad.

commit a324ae2ad72f2a2188eb0d4398c9e6548c499c5a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 1 11:01:43 2015 +0100

    v2v: Fix detection of Win2008R2 drivers (RHBZ#1234351).
    
    This fixes commit 47b5f245bec908f803f0a89c3b1e3166cfe33aad.

commit e1e4d8648d5f93c2e153832e175b7af3b5f379af
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jun 30 16:42:52 2015 +0200

    tests: add/expand UUID and label tests for swap and xfs

commit d0c067df8709206b494bb7ea0b2548671d50b0a9
Author: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>
Date:   Tue Jun 30 19:23:12 2015 +0800

    daemon: add get_random_uuid
    
    Signed-off-by: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>

commit 516638891472441710c4df912b28229ffd52918e
Author: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>
Date:   Tue Jun 30 19:23:10 2015 +0800

    uuid: use newly introduced xfs_set_uuid of xfs
    
    Signed-off-by: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>

commit ad21fb8acf449b251460528a9244cc5567838799
Author: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>
Date:   Tue Jun 30 19:23:09 2015 +0800

    uuid: use existing function of ext2
    
    Signed-off-by: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>

commit 98e1e9bcc2a490d983ba3f54e85ae82ecc70543b
Author: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>
Date:   Tue Jun 30 17:45:14 2015 +0800

    tests: fix two minor warnings
    
    "my" variable $output masks earlier declaration in same scope at /home/libguestfs/tests/daemon/test-btrfs.pl line 66.
    "my" variable @r masks earlier declaration in same scope at /home/libguestfs/tests/daemon/test-btrfs.pl line 72.
    
    Signed-off-by: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>

commit 2b67342bdae68cb20f593a79b4b6d5af74f4de04
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 23:20:54 2015 +0100

    Version 1.29.48.

commit 93cf45cadf51576ee275fd440267af1373db26fc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 23 22:56:55 2015 +0100

    tests: Add a test of btrfs-qgroup-show using the captive daemon.

commit 336b8f6b1620d23a5aed9d2d9327e51b62f9b1ac
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 23 22:56:55 2015 +0100

    tests: Add a test of btrfs-subvolume-list using the captive daemon.

commit f2438b75a2402af0c51f89d4cd993a4ab7ef4a8c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 24 12:43:32 2015 +0100

    tests: daemon: Cleanly shut down the daemon on exit.
    
    This refines the previous commit by shutting down the daemon cleanly
    at the end of the test (assuming the test was successful).  It
    repurposes the 'internal_exit' API for this, which was previously used
    by the now defunct --enable-valgrind-daemon functionality.

commit 9f85477cbac1427b8d4d314c8b7de7f703821891
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 23 18:21:50 2015 +0100

    tests: Add tests using a captive daemon process.
    
    This allows us to test the daemon running as a host process, allowing
    us to meaningfully test it using valgrind.
    
    This commit only adds a single test that check that the daemon starts
    up, can be pinged, and exits.

commit 8cb1a35d75bfc5ed2e3cb0febfd3168b52281fb4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 25 15:08:52 2015 +0100

    daemon: Move all the kernel command line parsing to the init script.
    
    Instead of parsing /proc/cmdline from the daemon, move all of that
    parsing into the init script, and pass the argument via the daemon
    command line.
    
    For example, previously the daemon and init script both looked for
    guestfs_network=1 in /proc/cmdline.  Now the init script still looks
    for it, and if found it runs `guestfsd --network'.

commit 64ff631127bd682e7311ae20328fdafb2ca1d4da
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 23 15:29:15 2015 +0100

    daemon: Add -l / --listen flag.
    
    This option, used for testing, causes the daemon to create the Unix
    domain socket (from guestfs_channel), listen on it, and accept a
    single connection.

commit 9e0e2247ff8bca67f791775d3ea0b2998e5bc2fe
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 23 15:26:31 2015 +0100

    daemon: Add undocumented --test / -t option to enable test mode.
    
    This is a catch-all mode for turning off daemon features which
    interfere with our testing of the daemon.

commit 4b721a1e0b443a2a56408994c85b92a8d4911580
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 23 22:49:11 2015 +0100

    configure: Remove test for valgrind --vgdb option.
    
    We'll now just require that valgrind is new enough.
    
    As best as I can tell from the valgrind subversion(!) repository, this
    option was added to valgrind in around 2011.

commit 3888582da89c757d0740d11c3a62433d748c85aa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 25 18:00:02 2015 +0100

    v2v: Free XML objects in the correct order.
    
    If you free an xmlDocPtr before any xmlXPathObjectPtrs that reference
    the doc, you'll get valgrind errors like this:
    
      ==7390== Invalid read of size 4
      ==7390==    at 0x4EB8BC6: xmlXPathFreeNodeSet (xpath.c:4185)
      ==7390==    by 0x4EB8CC5: xmlXPathFreeObject (xpath.c:5492)
      ==7390==    by 0x400A56: main (in /tmp/test)
      ==7390==  Address 0x60c0928 is 8 bytes inside a block of size 120 free'd
      ==7390==    at 0x4C29D2A: free (in /usr/lib64/valgrind/vgpreload_memcheck-amd64-linux.so)
      ==7390==    by 0x4E8784F: xmlFreeNodeList (tree.c:3683)
      ==7390==    by 0x4E87605: xmlFreeDoc (tree.c:1242)
      ==7390==    by 0x400A4A: main (in /tmp/test)
    
    The following simple test program demonstrates the problem:
    
      #include <stdio.h>
      #include <stdlib.h>
      #include <assert.h>
      #include <libxml/xpath.h>
    
      int
      main (int argc, char *argv[])
      {
        xmlDocPtr doc;
        xmlXPathContextPtr xpathctx;
        xmlXPathObjectPtr xpathobj;
    
        doc = xmlReadMemory ("<test/>", 7, NULL, NULL, XML_PARSE_NONET);
        assert (doc);
        xpathctx = xmlXPathNewContext (doc);
        assert (xpathctx);
        xpathobj = xmlXPathEvalExpression (BAD_CAST "/test", xpathctx);
        assert (xpathobj);
        xmlFreeDoc (doc);
        xmlXPathFreeObject (xpathobj);
        xmlXPathFreeContext (xpathctx);
        exit (EXIT_SUCCESS);
      }
    
    In virt-v2v we were not freeing up objects in the correct order,
    because we didn't express the dependency between objects at the C
    level into the OCaml, where the OCaml garbage collector could see
    those dependencies.  For example code like:
    
      let doc = ... in
      let xpathctx = xpath_new_context doc in
      let xpathobj = xpath_eval_expression xpathctx "/foo" in
    
    might end up freeing the 'doc' (xmlDocPtr) if, say, there were no
    further references to it in the code, even though the 'xpathobj'
    (xmlXPathObjectPtr) remains live.
    
    To avoid this, we change the OCaml-level representation of objects
    like xpathobj so they contain a reference back to the higher-level
    objects (xpathctx & doc).  Therefore holding an xpathobj means that
    the doc cannot be freed.
    
    However that alone is not quite sufficient.  There is a further
    problem when the program calls Gc.full_major, Gc.compact etc., or even
    just when xpathctx & doc happen to be freed at the same time.  The GC
    won't necessarily free them in the right order as it knows both need
    to be freed but doesn't know that one must be freed before the other.
    
    To solve this we have to move the finalisers into OCaml code, since
    the OCaml Gc.finalise function comes with an explicit ordering
    guarantee (that finalisers are always called in reverse order that
    they were created), which the C-level finaliser does not.

commit 36a197e2cc119f6d2691b110af5b292ba794162b
Author: Cao jin <caoj.fnst@cn.fujitsu.com>
Date:   Wed Jun 24 10:08:42 2015 +0800

    New API: btrfs_replace
    
    Signed-off-by: Cao jin <caoj.fnst@cn.fujitsu.com>

commit 52ca4d5dd4c909a4eac8c6f3a58f8800a444a611
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 10:41:10 2015 +0100

    v2v: OVF: If actual_size field is estimated, add a comment to the output.
    
    The 'note:' comment is added, as below:
    
      <Section xsi:type='ovf:DiskSection_Type'>
        <Info>List of Virtual Disks</Info>
        <!-- note: actual_size field is estimated -->
        <Disk ovf:actual_size='7' [...]/>
      </Section>

commit 801832e6764097466c1156a9be2d829f8401c6d9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 25 20:54:06 2015 +0100

    v2v: Increase the timeout of VMware curl connections (RHBZ#1146007).
    
    On certain webservers these appear to go beyond even 600 seconds (10
    minutes).

commit 800e501e1e1058ed0a3b26f2d79e2511641649d6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 25 21:22:00 2015 +0100

    v2v: test-harness: Build dependencies correctly.

commit 1d58cd4e1d4dbce15fc27f57ddfb8c4b290642b6
Author: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>
Date:   Thu Jun 18 17:39:39 2015 +0800

    do_btrfs_subvolume_list: fix a bad return value
    
    don't return a value which is to be freed.
    
    Signed-off-by: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>

commit 268c425791e831e9ba2a6b5e33942ba36e5dae3c
Author: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>
Date:   Thu Jun 18 17:39:38 2015 +0800

    do_btrfs_qgroup_show: fix a bad return value
    
    We should not use temporary lines buffer as return value,
    for lines buffer will be freed.
    
    Signed-off-by: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>

commit 445d20c1176b0ae53cec03fccce3ead779fe1575
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 23 13:24:23 2015 +0100

    lib: Add optional 'append' parameter to copy-(device|file)-to-file APIs.
    
    This allows you to append one file to another:
    
      copy-file-to-file /input.txt /output.txt append:true
    
    will append the contents of /input.txt to /output.txt.

commit 47b5f245bec908f803f0a89c3b1e3166cfe33aad
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 22 15:13:36 2015 +0100

    v2v: Support loading virtio-win drivers from virtio-win.iso (RHBZ#1234351).
    
    This makes several changes to the handling of virtio-win drivers:
    
    The VIRTIO_WIN_DIR environment variable has been renamed
    VIRTIO_WIN (but you can still use the old name).
    
    You can point the VIRTIO_WIN either at a RHEL virtio-win directory
    (ie. /usr/share/virtio-win), OR at a loopback-mounted virtio-win ISO,
    OR at the virtio-win.iso file itself.  In the latter case, libguestfs
    is used to open the ISO file and read drivers from it.
    
    The code is more flexible about the pathnames of drivers, because the
    paths in the ISO are completely different from the paths in RHEL
    /usr/share/virtio-win.

commit 57ae2a5cc3a95dbae0e1dc1c55213bd158e4a385
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 23 14:33:44 2015 +0100

    daemon: Rewrite prog_exists so it uses the actual PATH, not hard-coded list.

commit 68ed6dd88ab30b482b70854452b41ee2768ce03e
Author: Cao jin <caoj.fnst@cn.fujitsu.com>
Date:   Tue Jun 23 18:38:19 2015 +0800

    Modify the function: analyze_line, make it more flexible
    
    Modify the function from a fixed delimiter to a variable. So,
    it can be used in more APIs later. Also modified the existing
    callers
    
    Signed-off-by: Cao jin <caoj.fnst@cn.fujitsu.com>

commit 35710595c136bf24c9a4b77788c5dd93a7c72b2d
Author: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>
Date:   Tue Jun 23 16:01:10 2015 +0800

    btrfs: remove redundant whitespace
    
    s/  =/ =
    
    Signed-off-by: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>

commit a1f34045164f40207d1545b0a12dcea96bbaeab7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 22 18:48:47 2015 +0100

    v2v: test-harness: Add Config module to library.
    
    Missing dependency.

commit 158204529fa26654d8ac6afa518675f97de2ba82
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 22 18:08:29 2015 +0100

    appliance: Make uefi_firmware variable static.
    
    It is not used outside the compilation unit.
    
    This fixes commit 544a7314824654d89ba3c70e3e93383a05d54218.

commit 029fc60ee509f53548f53e75ab571ff3fc6a4459
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 19 19:49:41 2015 +0100

    launch: Refactor guestfs_int_get_cpu_model code.
    
    Shorter and does the same thing.

commit 544a7314824654d89ba3c70e3e93383a05d54218
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 20 14:49:19 2015 +0100

    aarch64: appliance: Use kraxel's edk2.git repo if available.
    
    Gerd is making EDK2 builds available here:
    
    https://www.kraxel.org/repos/
    
    These are convenient for Fedora/aarch64 users, so use this firmware if
    available.
    
    This commit also refactors the UEFI searching code.

commit 74f5bb17a1fc5d42a228967a3516418432c67e8d
Author: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>
Date:   Fri Jun 19 10:26:52 2015 +0800

    btrfs: fix leak in btrfs_balance_status
    
    Signed-off-by: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>

commit abf0df6884c01acdd5423212034d9dee02a6ad56
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Jun 18 15:46:21 2015 +0200

    v2v: remove unused sources and libraries

commit 9f683fbf0f07da9c498915f503d5cc94db30389f
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Jun 18 13:34:12 2015 +0200

    btrfs: fix leak in btrfs_scrub_status
    
    Properly free the output buffer.

commit d8ab90cdd628eacee7cdd9583499918022bcb870
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 18 12:59:53 2015 +0100

    Version 1.29.47.

commit c4f8d1d1a31f9b7e04886079174af507799f0ad2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 18 09:52:54 2015 +0100

    v2v: Improve handling when one of the input disks is blank (RHBZ#1232192).
    
    In commit 4c73d1d4f142c6f6211c963beea68773e11fd3ef, I changed the
    behaviour of virt-v2v so it ignores all errors from the
    g#part_get_parttype method.  However that would ignore I/O errors and
    similar.
    
    Only ignore the "unrecognised disk label" error from parted, by
    testing if the return code is EINVAL.
    
    This fixes commit 4c73d1d4f142c6f6211c963beea68773e11fd3ef.

commit 94ea635fb1334b92c4c137ae042e972db416ee19
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 18 09:52:16 2015 +0100

    ocaml: Add handling for errno EINVAL.

commit b467afb621b054e4c1e9a2f1e8814e91a395ffb7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 17 10:51:40 2015 +0100

    daemon: parted: Always use -s option even with -m.
    
    See: https://bugzilla.redhat.com/show_bug.cgi?id=1232241#c3
    
    However adding the -s parameter changes the error code returned by
    parted when it processes a blank disk (or other unrecognized partition
    table).  Without -s it prints an error but returns a non-error exit
    code (0).  With -s it prints an error and returns an error exit code.
    
    Because it's useful to be able to catch this case in user code, turn
    "unrecognised disk label" into EINVAL.
    
    Change virt-alignment-scan to catch this error and ignore it.

commit 3ae5f72743c548820d7bf16234830bfbe6269868
Author: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>
Date:   Thu Jun 18 16:35:56 2015 +0800

    error log: keep more calloc and its error messages match
    
    Signed-off-by: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>

commit 6118e2239c8cd255e2b9aa76c6929b05a7eace98
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Jun 17 13:04:59 2015 +0200

    daemon: add split_lines_sb
    
    Mold split_lines_sb from split_lines, so it returns the strings buffer
    with the result of the split. This way, we can have the number of lines
    in the array, with no need to count them again later.
    
    split_lines is rewritten to take the ownership of the result of
    split_lines_sb.

commit 23ac997d06e5d2a852d1ae0789d726778104def7
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Jun 17 12:52:54 2015 +0200

    daemon: add take_stringsbuf

commit fd6a66fde485f4445a947c218fdd00bc3bd68034
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Jun 17 12:25:32 2015 +0200

    daemon: add CLEANUP_FREE_STRINGSBUF

commit 26a0ccdb4ea7cb9239f8ce1ffeefc925ed49f341
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Jun 17 12:23:06 2015 +0200

    daemon: introduce free_stringsbuf
    
    Simple shortcut to easily cleanup a stringsbuf.

commit 596b8f85a909be13409fff3193e84d1f38a29456
Author: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>
Date:   Wed Jun 17 16:19:33 2015 +0800

    btrfs: use CLEANUP_FREE_STRING_LIST for list free
    
    Signed-off-by: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>

commit 9c24314f6f874e0ecb2d0c3f31bf9fdfbb9f555f
Author: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>
Date:   Wed Jun 17 10:44:09 2015 +0800

    btrfs: keep calloc and its error message match
    
    Signed-off-by: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>

commit 3f4ba2e98d21746723d291939ccc2e1f1526aa6d
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jun 16 17:31:43 2015 +0200

    btrfs: use calloc instead of malloc+memset
    
    Small optimization, and eases the code.

commit 9574e793e2c141892da07794a433d45a1706614a
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jun 16 17:07:47 2015 +0200

    btrfs: remove unused 'out' variables
    
    If we are not interested in output of a command being run, then there's
    no need to still capture it in a (automatically freed, but still)
    variable.
    
    If any of those outputs is needed, a variable for it can be easily added
    back.

commit 993140219c951e9e2dbfd820f0e6227836d6ed5d
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jun 16 09:31:25 2015 +0200

    Improve fixed appliance documentation
    
    Move the "FIXED APPLIANCE" section from
    libguestfs-make-fixed-appliance(1) to the "INTERNALS" section of
    guestfs(3), so it's more visible and less hidden in the documentation
    of a rarely-used tool.  Also slightly improve it.
    
    Expand the FAQ question about libguestfs without supermin, mentioning
    the build options needed and pointing to the aforementioned new section.

commit d11857aa87b926331a1daf49548c918402e2f451
Author: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>
Date:   Tue Jun 16 18:24:49 2015 +0800

    guestfs.pod: fix a typo
    
    s/caling/calling
    
    Signed-off-by: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>

commit 4c73d1d4f142c6f6211c963beea68773e11fd3ef
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 16 12:15:29 2015 +0100

    v2v: Don't fail if one of the input disks is blank (RHBZ#1232192).
    
    This also adds a regression test since it is probably easy to break
    this in future.
    
    Thanks: Junqin Zhou

commit 99dc53bba773d083b52d3f4005b16b8edaf615cb
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Jun 15 15:53:14 2015 +0200

    resize: make available expand method warnings more prominent
    
    When hitting a filesystem which we cannot or don't know how to expand,
    instead of print a warning in verbose mode only, print it always when
    showing the summary of the changes.
    
    In the virt-resize documentation, add a paragraph about this warning.
    
    Thanks to: Luigi Toscano.

commit 54c7d3f61e469422c8b23847a924474803e8dc7b
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Jun 12 10:59:58 2015 +0200

    get-kernel: add --prefix
    
    New --prefix option to specify a prefix for the extracted file names.

commit cdb1e6eecae2f7836b9ff6e15e7414fa1647ab75
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Jun 12 10:28:16 2015 +0200

    get-kernel: add --unversioned-names
    
    New --unversioned-names option to save extracted files just with their
    base name (i.e. "vmlinux", "initrd.img").

commit 1183809f4d9e3177752970074ec1dbbed551a3e9
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Jun 11 18:07:32 2015 +0200

    (Almost) new tool: virt-get-kernel
    
    Extract the guest kernel/ramdisk extraction from virt-builder into a
    separate utility, so it can be used and improved without cluttering
    virt-builder.
    
    Currently it does what virt-builder --get-kernel did, adding also the
    options for remote disks and libvirt access, much like other libguestfs
    tools.
    
    virt-builder --get-kernel now just spawns virt-get-kernel.

commit 533901409e09797c5baab9d02f02e89e9970e5f1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jun 14 12:37:49 2015 +0100

    pod: Use F<> for filenames instead of C<>.
    
    Done using a sequence of regular expressions like this:
    
      perl -pi.bak -e 's{C</}{F</}g' `git ls-files \*.pod` generator/actions.ml
      perl -pi.bak -e 's{C<C:\\}{F<C:\\}g' `git ls-files \*.pod` generator/actions.ml
      [etc]
    
    and then tediously checking every change by hand.

commit 47e9a3d739f072b3c1db87ffad5b937e6c3f3356
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jun 14 16:35:21 2015 +0100

    FAQ: Add sections about libguestfs NTFS & XFS support.
    
    Both popular questions.

commit dafb4bf28378707c1f1f224d2a895e3e80bbe382
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 13 22:21:28 2015 +0100

    v2v: Document 7B boot problems with Windows Group Policy.

commit 54fe6d369d18680e53d3f60be3dbdb42356bd94f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 10 14:06:03 2015 +0100

    p2v: Add proper test for command line parsing.
    
    This also adds a couple of deliberately undocumented (and unsupported)
    command line parameters to make testing simpler:
    
    p2v.skip_test_connection  - don't try to test the connection
    p2v.dump_config_and_exit  - after parsing command line, print it and exit
    
    This updates commit 716244c33718c866edce9e7ee8f21ee612f53337.

commit a716adac3589a339a3064bcf5e5cf33390309a14
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 10 14:04:49 2015 +0100

    p2v: Make sure command is printed before running it.
    
    This updates commit b45f6a04359b4b64256b7b21a04416fa772c9423.

commit 4c8bbc45bedce9d9eab1b95c1ec4c3b3082fddd9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 10 14:03:43 2015 +0100

    p2v: Refactor code that dumps the configuration for debugging.
    
    This is just code motion.

commit bb5b23c1519a3901909a5ed51ce2f88e0904cb85
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 10 13:38:11 2015 +0100

    p2v: Fix parsing of p2v.memory parameter (RHBZ#1229262).
    
    The sscanf call always failed because we checked for the wrong return
    code.
    
    We don't need to allocate two characters for the mem_code field since
    sscanf doesn't append a nul byte.
    
    This commit also allows you to use lowercase 'm' or 'g' as a memory
    unit.
    
    Also clarify the documentation: the memory unit must be given.

commit b45f6a04359b4b64256b7b21a04416fa772c9423
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 9 17:06:33 2015 +0100

    p2v: Add p2v.pre, p2v.post, p2v.fail commands (RHBZ#1229385).
    
    The default p2v.post command, when run from the ISO, is to poweroff
    the machine after successful conversion.

commit 716244c33718c866edce9e7ee8f21ee612f53337
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 9 17:53:05 2015 +0100

    p2v: Correct parsing of /proc/cmdline, including quoting.
    
    Fix the parsing of /proc/cmdline, including allowing double quoting of
    parameters.
    
    This allows you to pass parameters to p2v on the command line which
    include spaces.

commit 154251b3f0312864c460533ae28a09483fb70051
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 9 15:27:25 2015 +0100

    p2v: Modify /etc/issue with clearer instructions.

commit cca4343203f18367033a56139231ff2518ad6655
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 8 14:41:46 2015 +0100

    p2v: Update documentation.
    
    - How to configure virt-p2v for PXE boot.
    
    - How to test PXE boot using qemu.

commit fc554d422a95f0cef21073a3a8ba0b2d8ddbab45
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 9 14:09:55 2015 +0100

    p2v: Chomp kernel command line (fix) (RHBZ#1229340).
    
    Calculate the length of the string, not the length of the buffer.
    
    This fixes commit 6114c10df05cdb1662ac22930010fd45714f9c40.

commit aa50d02f36015f1367974dfe4ed0a239cf5a374b
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jun 9 11:57:13 2015 +0200

    builder: add a doc snippet about firstboot scripts
    
    Document basic information about them for Linux and Windows guests.

commit d8f1962bd20068abef0f23c48f90e2f36e628af7
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jun 9 10:54:13 2015 +0200

    podwrapper: simplify external references pointing to self
    
    When convering a POD documentation, possibily combining various
    sub-documents together, simplify the L<> links that explicitly point to
    the very same documentation being generated.
    
    For example, when generating the virt-builder documentation, links like
      L<virt-builder(1)/SECTION>
    will be turned into
      L</SECTION>
    thus not making Pod::Simple parse them as external reference.
    
    While it is a slightly crude hack, it seems there's no easy way to
    process the link parsing with Pod::Simple subclasses.

commit 6114c10df05cdb1662ac22930010fd45714f9c40
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 8 14:40:20 2015 +0100

    p2v: Chomp kernel command line (RHBZ#1229340).
    
    When using the kernel command line to configure virt-p2v, if any p2v.*
    parameter appeared right at the end of the kernel command line, then a
    bogus \n would be appended.  Remove this.
    
    This is essentially the same fix as:
    https://github.com/libguestfs/supermin/commit/4819655b3c96e836e46d0d679f84b10f8e9abcf5

commit 9b9be6d1c6495abb159fe0fd76535f7e6ab6fc09
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 6 18:34:15 2015 +0100

    Version 1.29.46.

commit 61ac4233b51c6867eb9381550ca6057d5d1e2069
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 6 18:32:38 2015 +0100

    Update translations from Zanata.

commit 4f020682ee185d510c3994dcac25be3cceba7aa8
Author: Nikos Skalkotos <skalkoto@grnet.gr>
Date:   Thu Jun 4 11:56:02 2015 +0300

    Use safe_realloc() in favor of realloc overall.

commit 7429b6b261496c4aafe5ce9015ddc8f5c28f8cc2
Author: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>
Date:   Fri Jun 5 06:02:20 2015 -0400

    sysprep_operation: fix a typo
    
    s/rathern/rather
    
    Signed-off-by: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>

commit 47a15da2e7046e287de003715b858f47233885c1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 5 14:27:58 2015 +0100

    lib: command: Fix leak in the per-child-process rlimit structures.
    
    This fixes commit 9db0f807a917ec00d24297d5bf63c19065f930cf.
    
    Bug found by valgrind.

commit 8b1b3a10b3a365fceb04038ddafced0071f9cf9d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 5 11:15:35 2015 +0100

    fuse: Use SKIP_TEST_FUSE_SH consistently.
    
    This fixes commit 96a02f08648f81a741269a34de0352ff3fcb140a.

commit 4ce94cede6a70379c787eb5c149b5d88c4a11045
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 4 18:02:33 2015 +0100

    proto: Don't set g->last_errnum directly.
    
    I'm trying to think if there was any reason why we would have set
    g->last_errnum directly instead of using the proper function
    (guestfs_int_error_errno), but I cannot think of one.
    
    Since error (g, ...) is just a macro that calls
    guestfs_int_error_errno (g, 0, ...), this code is equivalent.

commit 34439a04f1921c4e5ece1077570b0f036a64c7ee
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 3 18:56:31 2015 +0100

    appliance: Make sure /tmp and /var/tmp are real directories.
    
    Currently if /tmp (on the host) is a symlink, then the symlink is
    copied into the appliance, probably pointing to a non-existent
    directory, and everything goes downhill from there.
    
    Avoid this by making sure that /tmp and /var/tmp are real directories.

commit ee87fdaf8f1472efa34819db8ff06f952e1ac798
Author: Nikos Skalkotos <skalkoto@grnet.gr>
Date:   Wed Jun 3 15:22:38 2015 +0300

    inspector: tests: Enable the Arch Linux test

commit fa80f88c9cfe83c1c46c36fbda00c568c5a06363
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Jun 3 16:13:43 2015 +0200

    mllib: use Unix.gettimeofday instead of Unix.time
    
    Unix.gettimeofday returns a finer resolution than seconds, which is what
    we need since deciseconds of timestamps are printed.

commit 14a8461a5c3deac5f29b354c5e02201173a39879
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 2 17:38:46 2015 +0100

    Version 1.29.45.

commit 1ff463e8692aae4313bd5b42bb6f09932bb63392
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri May 29 16:01:26 2015 +0200

    inspection: fix CentOS 7 detection
    
    In newer CentOS 7 versions /etc/redhat-release says that the distro is
    derived from RHEL, so we need to look at /etc/centos-release for
    actually identifying it as CentOS.
    
    The old code is needed as sub-case of /etc/redhat-release, as on
    CentOS < 7 that file is a symlink to /etc/centos-release.

commit a50af9e14875a6e8d447c4e7f75447c31f00bd0c
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri May 29 16:01:25 2015 +0200

    inspection: lift size limit for RHEL icons
    
    In RHEL-based distros, the provided icons have (obviously) different
    sizes than the RHEL ones, used in icon_rhel as reference.
    
    Since 100K should be a reasonable threshold for avoid keeping a
    per-distro list of limits, just use it as only size limit.

commit 25ca08f490190bc26ada00047c2d84759a8be018
Author: Nikos Skalkotos <skalkoto@grnet.gr>
Date:   Tue Jun 2 19:25:17 2015 +0300

    Add tests for CoreOS
    
    Signed-off-by: Nikos Skalkotos <skalkoto@grnet.gr>

commit 8cc36215f971fab3b768e028af882b30bdab5b84
Author: Nikos Skalkotos <skalkoto@grnet.gr>
Date:   Tue Jun 2 19:24:59 2015 +0300

    inspection: Add support for CoreOS
    
    * Implement coreos distro
    * Detect CoreOS images
    
    Signed-off-by: Nikos Skalkotos <skalkoto@grnet.gr>

commit 721cd0d66e3918bbb81bfff6b163babe58d04755
Author: Nikos Skalkotos <skalkoto@grnet.gr>
Date:   Tue Jun 2 19:24:27 2015 +0300

    inspection: Add func for merging fs inspections
    
    Add a new guestfs_int_merge_fs_inspections() function that merges the OS
    inspection information of two inspect_fs instances into one. This
    function is useful if the inspection information for an OS are gathered
    by inspecting multiple filesystems.
    
    Signed-off-by: Nikos Skalkotos <skalkoto@grnet.gr>

commit 467cd4b76014ef3e21c14a2a04c2c0e735425096
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 2 16:27:13 2015 +0100

    p2v: Introduce a common file to store virt-p2v ISO dependencies.
    
    Instead of having virt-p2v-make-disk and virt-p2v-make-kickstart
    separately contain a list of the virt-p2v ISO dependencies, combine
    the dependencies into a single file ('p2v/dependencies.m4') and use
    that to generate the respective dependencies in each script.

commit 3e9a0fac148f7ce48db2bac2ba6f99e81fd603c7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 2 13:51:47 2015 +0100

    p2v: Set status to "Conversion cancelled by user" when user cancels (RHBZ#1226794).
    
    Thanks: Tingting Zheng.

commit 2dc88ba8cb5c772ef071cf94855018d912fbed88
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 1 11:58:22 2015 +0100

    FAQ: Document using libguestfs to access live guest disk images.
    
    Gets asked on the mailing list several times a year.

commit 0bf4be64ee2174b286de0d266a75892b9890f8b2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun May 31 22:30:18 2015 +0100

    v2v: -o libvirt: Remove unnecessary comment.

commit 2e2f016ce9a808cc116e80c6125e52f38f19b4b0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun May 31 22:16:44 2015 +0100

    v2v: Add a <!-- generated by .. --> comment in output XML files.

commit 284d2200911b469dccff7db6e6e704e0592871ac
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun May 31 21:49:49 2015 +0100

    v2v: OVF: Add comment that 'IsInitilized' is not a typo.

commit 98e40a0cc8637febac738d39c68465b4cb31bb66
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 29 15:05:02 2015 +0100

    perl: XML::XPath and XML::XPath::XMLParser are not required.

commit c31c077aa53d4b894cb9abe061fb290e906ca918
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu May 28 16:39:48 2015 +0200

    java: doc: add the version (if available) of APIs

commit db1b0bc5085cde09032e8783d28f22b7e502c233
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu May 28 15:41:41 2015 +0200

    ocaml: doc: add the version (if available) of APIs
    
    Make sure to not add more newline's than needed.

commit 0a18465c2351056d40548c9f9d882096359465c4
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu May 28 15:05:34 2015 +0200

    gobject: doc: add the version (if available) of APIs

commit fc1f6deab119bbef5879d840412f9911f1f4718a
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu May 28 13:30:37 2015 +0200

    generator: move api_version to a common version_added
    
    This way the version string of each API can be used also in other
    generator modules.
    
    Mostly code motion, no actual behaviour changes.

commit 33d2b4a7341830efeddb1f258ac77f67a8004d30
Author: Maros Zatko <mzatko@redhat.com>
Date:   Fri May 22 17:10:14 2015 +0200

    inspector: recognize ppc64 and ppc64le archs (RHBZ#1211996)

commit 0645cd365567a6552d6414bc0bc131970133a313
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 27 21:26:01 2015 +0100

    builder: Add Fedora 22 (armv7l) image.

commit c0e7bb5ef29153059555b0ecdf1e32b69c7d79f2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 26 20:20:54 2015 +0100

    builder: armv7l: Fix build script for Fedora 22 release.
    
    (The same change as was made in
    commit c4a54e00a333479ee31f492726a08767a8b61e46).

commit 54f54697b98c98e295d53be257c2022c1dd0c52c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 26 21:13:32 2015 +0100

    Version 1.29.44.

commit 41ce78f02eb9f2a8c54e5d6cbed93b6a93d3e797
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 26 21:05:55 2015 +0100

    builder: Add Fedora 22 aarch64 image.

commit 9db0f807a917ec00d24297d5bf63c19065f930cf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 26 13:21:19 2015 +0100

    lib: Limit space and time used by 'qemu-img info' subprocess.
    
    After fuzzing 'qemu-img info' I found that certain files can cause the
    command to use lots of memory and time.  Modify the command
    mini-library to allow us to place resource limits on subprocesses, and
    use these to limit the amount of space and time used by 'qemu-img info'.

commit 9c773962c5e52ed4775fe8f12ce4183442a68ec5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 26 11:32:08 2015 +0100

    Remove src/api-support and generate this information from actions added field.

commit b59c81d9e8deb70c9925a2dc0eaf8f30c89276da
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 26 09:10:32 2015 +0100

    generator: Check 'added' field is set for each API.

commit 8816f06cdca32d1b58ed58b7980ad7d832bfaa4c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 26 11:20:54 2015 +0100

    generator: Move version first added to generator.
    
    This change was generated automatically using the following Perl
    script, with a few hand corrections afterwards.
    
    use strict;
    my %map;
    open ADDED, "src/api-support/added" or die "added: $!";
    while (<ADDED>) {
        chomp;
        if (/^guestfs_(.*)_(argv|va|opts) /) {
            # ignore _argv, _va, _opts entries.
        }
        elsif (/^guestfs_(compare|copy)_/) {
            # ignore guestfs_compare_*, guestfs_copy_* struct functions.
        }
        elsif (/^guestfs_(.*) [01]\.(\d+)\.(\d+)$/) {
            $map{$1} = [1, $2, $3];
        }
        elsif (/^guestfs_(.*) 0\.(\d+)$/) {
            $map{$1} = [0, 0, $2];
        }
        else {
            die "cannot parse line: `$_'\n"
        }
    }
    close ADDED;
    open ACTIONS, "generator/actions.ml" or die "actions.ml: $!";
    open ACTIONS_OUT, ">generator/actions.ml.out" or die "actions.ml.out: $!";
    while (<ACTIONS>) {
        chomp;
        if (/name = "(.*)";$/ && exists $map{$1}) {
            my @v = @{$map{$1}};
            $_ .= sprintf (" added = (%d, %d, %d);", $v[0], $v[1], $v[2]) ;
            delete $map{$1};
        }
        print ACTIONS_OUT "$_\n";
    }
    close ACTIONS_OUT;
    close ACTIONS;

commit d0d492def23229f1a802f8f799e0cab782ca7de7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 26 09:10:16 2015 +0100

    generator: Add 'added' (version when added) field.

commit 41cf78f36b1b8ce3a5542b43f9e9ffe320adaf15
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 26 08:55:49 2015 +0100

    Update API support.

commit a59fc8ee325dde64c753791106756048ca684f8a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 26 09:09:25 2015 +0100

    api-support: Ignore guestfs_impl_* symbols.

commit c919f6f75c8eb44098e6329d57cbecb3e697cf1c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 26 08:33:15 2015 +0100

    api: Don't truncate /dev/stdout or /dev/stderr when used as FileOut.
    
    In APIs such as guestfs_download, when the FileOut parameter exactly
    matches "/dev/stdout" or "/dev/stderr", don't reopen the possibly
    redirected output file with O_TRUNC (truncate).  Instead dup the file
    descriptor.
    
    This magic behaviour doesn't happen for /dev/fd/* (or any other output
    file) allowing callers the choice of using /dev/stderr or /dev/fd/2
    depending on whether or not they want truncation.
    
    This works around an annoying virt-builder bug.  If you do:
    
      $ virt-builder fedora-21 --install no_such_package -v -x >& /tmp/log
    
    then when the `--install' command fails, virt-builder will download
    the log file using `guestfs_download (g, log, "/dev/stderr")'.  Since
    this truncates the redirected /dev/stderr, the final log file is
    truncated and corrupted.
    
    With this patch the log file is no longer corrupted.

commit c4a54e00a333479ee31f492726a08767a8b61e46
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 26 20:20:54 2015 +0100

    builder: aarch64: Fix build script for Fedora 22 release.

commit aa4dee7b7cf2e54020f5c65ba9cec66bd4b69db0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 26 15:50:37 2015 +0100

    builder: Add Fedora 22 image.

commit aa7fa1cf00608215edf4309512f7863957bd23c9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 21 21:52:16 2015 +0100

    v2v: RHEL 7 virt-v2v conversion server requires virtio-win.

commit 3a63ee2aafe8099fdf2b4e228a62d86c83739d3e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 20 07:40:22 2015 -0400

    v2v: Fix confusion over rhel-7 virt-v2v conversion server / appliance.
    
    This fixes commit 4c7fb62f4a301cf26a7cf1ca3a5ed0d47406fa55
    and updates commit 4e4ece53647fba810eeb45086b46d02f54e02fe2.

commit 10cb9b9545424d98687a46c23abdc0e3ff77de76
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 19 16:36:42 2015 +0100

    p2v: Force systemd default target to be multi-user (text mode).

commit f6dd8a3221cfa7b5aa6434cddcd0d636dd64e02b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 19 16:37:22 2015 +0100

    p2v: Explicitly depend on nm-connection-editor.
    
    Previously it was only being pulled in implicitly.  However virt-p2v
    runs this binary from the "Configure Network" button.
    
    This fixes commit e464774a79ff9eeedcdb3fd53efd5a7898ca036e.

commit 63cd28974e363e9f4b1ea56b39661ad3218a8f13
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 19 14:44:32 2015 +0100

    p2v: kickstart: Try harder to stop systemd from renaming network devices.

commit 0fbe8fb3e0e2adb0ee56a8af13e98c3c98fd4d20
Author: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>
Date:   Mon May 18 06:30:07 2015 -0400

    resize: add sector size in debug_partition
    
    This patch will add fields of sector size for:
      - partition sector data size
      - target partition sector data size
    
    Signed-off-by: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>

commit ce9f059dce2d6d04b3a5b4219a152f82e4f37c54
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 15 21:16:38 2015 +0100

    Version 1.29.43.

commit 58c24a6bf841ea993ef7f5f7b8738bdde48e66e6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 15 20:34:06 2015 +0100

    builder: sigchecker: Fix error message.
    
    Error messages are automatically wrapped, and don't require a newline
    at the end.

commit ef4f0fc8f9f835179c25e9ae9762e9c9ebc6a958
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 15 20:22:05 2015 +0100

    sparsify: Use message function instead of printf.

commit f2aa9261a877da151815bff1268641f5cc1b6c5e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 15 19:10:28 2015 +0100

    ocaml tools: Translate a few messages which were not internationalized.

commit 59228c39b1a4a6cf89fc767075415a5b6ed1ec86
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 15 10:31:26 2015 +0100

    ocaml tools: Use global variable to store quiet (--quiet) flag.
    
    Don't pass this flag to dozens of functions.
    
    This change is analogous to the change made in
    commit 79fc6074a7e60b4b59efca7d5d58bb2a6768e4bb for the -v & -x flags.

commit 71854a56c17191d6087f444ebe69457b9b265e66
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 15 15:26:11 2015 +0100

    builder: Remove a few unnecessary 'virt-builder' strings from error messages.

commit a43e8405ef83786f72f507f1aea31977b2f4de91
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 15 10:03:42 2015 +0100

    customize: Allow --selinux-relabel flag to work on cross-architecture builds (RHBZ#1212807).

commit 8864c47b94cf44ac2d0d8d4b5019073ad1da121b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 15 10:02:28 2015 +0100

    customize: Give a clear error message if host_cpu not compatible with guest arch.
    
    In cases where we are asked to run commands in the guest (eg.  options
    such as --run-command or --install), give a clear error in the cases
    where the guest arch is not compatible with the host arch.
    
    Similar code existed in virt-builder, but I have removed that.  Users
    will still get an error message, it will just happen a bit later on.
    
    There is a slight change in semantics here, in that architectures are
    no longer normalized when matching, but that's probably fine since
    `virt-builder -l' prints the exact arch string that people should use.

commit ab7197476de1cb3c8727caf4da429f6293ca4227
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 15 11:01:03 2015 +0100

    ocaml tools: Only tell people to use -v -x if they're not already set (RHBZ#1167623).
    
    When you get an error in tools, it will print a message like:
    
      If reporting bugs, run virt-v2v with debugging enabled and include the
      complete output:
    
        virt-v2v -v -x [...]
    
    Only print this message if -v or -x were not already specified on the
    command line.

commit 79fc6074a7e60b4b59efca7d5d58bb2a6768e4bb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 15 10:31:26 2015 +0100

    ocaml tools: Use global variables to store trace (-x) and verbose (-v) flags.
    
    Don't pass these flags to dozens of functions.

commit e35605ad8d0ce921d5a9db76c9bd21275c73101c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 14 17:35:24 2015 +0100

    ocaml tools: Define Common_utils.prog and don't pass it to every function.
    
    This large commit is just code refactoring.  Instead of having
    every OCaml tool define 'prog' the same way, always as:
    
      let prog = Filename.basename Sys.executable_name
    
    move that into a single place, Common_utils.prog.  Then we can use
    that global value everywhere else, instead of having to pass it as a
    parameter into a dozen different functions.

commit a255e283d02505f572f6ee32a66cab78c248ff12
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 14 17:37:46 2015 +0100

    resize: Remove unnecessary 'prog' from error message.
    
    The common error function already prints the program name, so
    we don't need to print it twice.
    
    Before:
    
      $ virt-resize --expand ""
      virt-resize: error: virt-resize: empty --expand option
    
    After:
    
      $ virt-resize --expand ""
      virt-resize: error: empty --expand option

commit 7800fbda1939d869338e5005ff7215a2826a845c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 15 09:51:27 2015 +0100

    builder: Fix expand partition for fedora-21 armv7l image.
    
    Thanks: d.marlin

commit 0833c192b68e87bb10fecf8352a355474c3915bf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 14 13:57:41 2015 +0100

    p2v: Display network card MAC address and vendor in conversion dialog (RHBZ#855059).
    
    This displays the MAC address and vendor next to each network
    interface, aiding users in determining which network cards they want
    to transfer to the virtualized machine.

commit 5bf7f770b6829c9454e6ae0d778154a4711c601c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 14 13:22:00 2015 +0100

    When calling getline first time, initialize length to zero.
    
    The man page for getline says:
    
       ssize_t getline(char **lineptr, size_t *n, FILE *stream);
     [...]
       If  *lineptr  is set to NULL and *n is set 0 before the call, then get‐
       line() will allocate a buffer for storing the line.  This buffer should
       be freed by the user program even if getline() failed.
    
    which seems to indicate that we must initialize both line and len to 0
    before the first call to getline.
    
    In several places we were not initializing len.  The program still
    worked fine, but it seems better to initialize the length anyway.

commit 7eb1ed8cb4c686f24809dd7904227b5e33d02f9d
Author: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>
Date:   Thu May 14 01:19:36 2015 -0400

    resize: show sector infor in debug_partition
    
    Show partition sector data and target partition sector data
    in debug_partition.
    Also, if --verbose, call debug_partition again before
    parted partitions.
    
    Signed-off-by: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>
    
    RWMJ: Changed ~sectsize:sectsize => ~sectsize

commit 6574134feb23b6261ea2bf05effe5664307e6bd1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 14 10:49:53 2015 +0100

    Version 1.29.42.

commit 82cc8a8f8f7e291904b80465cfa8b6805d540c93
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 14 10:49:24 2015 +0100

    build: Add ocaml-link.sh to EXTRA_DIST.
    
    This fixes commit 13dd6323015c44a6b98a72661363d53118962ccd.

commit fd85a2a22bd9bb4e65cefe9347de7fd4d670ea02
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed May 13 16:45:41 2015 +0200

    mllib: link tests with automake
    
    Add a dummy C source, otherwise automake tries to look for e.g.
    common_utils_tests.c.
    
    Also, set check_PROGRAMS properly with them.

commit 13dd6323015c44a6b98a72661363d53118962ccd
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed May 13 15:30:39 2015 +0200

    build: factor out the OCaml link.sh scripts
    
    Create a single ocaml-link.sh script, which supports a -cclib parameter
    so it can be used instead of the per-project link.sh scripts.
    As result, the libraries for each OCaml application can be moved back to
    each Makefile.am.

commit 0e5ccabd839087ced4c57258ea8c898ec8f08426
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue May 12 15:17:24 2015 +0200

    configure: simplify check for oUnit v2
    
    Instead of parsing the version, try to look for the OUnit2 module within
    the oUnit package.
    
    Followup of commit 46bc79109bb51cfb656863da3635f1c8da5f6412.

commit 85347e32e02a412b8b17100b7eb5d39d1e83b66d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 12 22:19:08 2015 +0100

    v2v: Close libvirt connection after fetching libvirt capabilities.
    
    Memory leak found by valgrind.
    
    This fixes commit e7833a5eea350ca3579d1f9e6702e116b45572fc.

commit 96a02f08648f81a741269a34de0352ff3fcb140a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 12 11:48:44 2015 +0100

    fuse: Add more consistent SKIP_* environment variables.
    
    The new behaviour is as follows:
    
    Skip all of the fuse tests:
    
      SKIP_TEST_FUSE_SH=1
    
    Individual tests can be skipped by setting:
    
      SKIP_TEST_FUSE_UMOUNT_RACE_SH=1
      SKIP_TEST_GUESTMOUNT_FD=1
      SKIP_TEST_GUESTUNMOUNT_FD=1
      SKIP_TEST_GUESTUNMOUNT_NOT_MOUNTED_SH=1

commit 41df8a2c4605de019a01a004a83fbad3521f5423
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon May 11 19:12:43 2015 +0200

    builder: enable batch mode when validating non-verbose (RHBZ#1180170)
    
    When running gpg to validate a signature, use also --batch in
    non-verbose mode to avoid the extra "Good signature" messages that are
    printed by gpg2 even in quiet mode.
    We are parsing the status output anyway to check the validation result,
    so this should be harmless (and the full gpg output is printed in
    verbose mode anyway).

commit 6442bcb7eb13f0a91d9933ef5f3468ac950b7a7a
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon May 11 19:06:03 2015 +0200

    builder: trust the imported keys
    
    In every SigChecker, trust by default the keys imported.
    This should make gpg happier when using the keys later, used only when
    validating the signatures of index files.

commit a1a165e3c43d7743aa48ca18a97540b726cb0bf3
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon May 11 18:42:29 2015 +0200

    builder: move gpg status parsing within import_keyfile
    
    Parse the gpg status output directly within import_keyfile, returning
    just the key fingerprint.
    
    Just code motion, no actual behaviour changes.

commit 46bc79109bb51cfb656863da3635f1c8da5f6412
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 11 20:44:22 2015 +0100

    configure: Ensure oUnit version >= 2 before using it.
    
    This fixes commit e12c0dfe1f0cbbc01f8f913ac2a402b37b086029.

commit e9ea21b27d8c10c285a421d3559ff7995c7f02bb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 11 13:22:24 2015 +0100

    Version 1.29.41.

commit 43e3a4e37fc2fcab50f089722b31a8f3b4b874ba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 11 13:21:56 2015 +0100

    v2v: Add v2v_unit_tests.ml to EXTRA_DIST.
    
    This fixes commit e12c0dfe1f0cbbc01f8f913ac2a402b37b086029.

commit e12c0dfe1f0cbbc01f8f913ac2a402b37b086029
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 11 10:34:57 2015 +0100

    v2v: OVF: Add unit tests for modified OVF.get_ostype function.
    
    This adds unit tests for commit 6f9d5dce47f8502bee5d7285faf7695b22b5300b.

commit 936ddfbb381eff58bc3a5f487e5292f55fd8a600
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 11 10:26:53 2015 +0100

    mllib: Require OUnit2 for tests.
    
    OUnit2 has an OUnit (v1) compatibility module.  Unfortunately it
    is rather gravely broken:
    https://forge.ocamlcore.org/tracker/?func=detail&aid=1392&group_id=162&atid=730
    
    Since there is no new release fixing this, it's easier to switch to
    using OUnit2 for unit tests.

commit 6f9d5dce47f8502bee5d7285faf7695b22b5300b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun May 10 16:12:33 2015 +0100

    v2v: OVF: Fix list of operating system variants for RHEV >= 3.3 (RHBZ#1219857).
    
    Since RHEV 3.3, OS variant names like "RHEL6x64" were deprecated and
    replaced by names like "rhel_6x64".  "RHEL7x64" was never valid, and
    we should have used "rhel_7x64".  "Windows2012R2x64" was also never
    valid and should have been "windows_2012R2x64".
    
    For backwards compatibility, RHEV still understands the old names, and
    we still pass them for compatiblity with old RHEV.
    
    However for the new OS variants supported by virt-v2v in RHEL 7.2, use
    the new names.
    
    This commit also adds support for SLES and ppc64.
    
    This updates commit 3c51302d691cc204e4d43f4ab9837095d424bf3b
    and also RHBZ#1213324.

commit 61a021713e8a93faeadc093e5c2d5064ba86059c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 9 17:59:26 2015 +0100

    p2v: Update documentation for Configure network button.
    
    This updates commit e464774a79ff9eeedcdb3fd53efd5a7898ca036e.

commit 35efaf820870e7498aacc5d4aaa8c952c635b0e0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 9 17:53:57 2015 +0100

    p2v: Add tip about the root password of the virt-v2v conversion server appliance.

commit a3edef9295e628d1ed69f06ffed5523438f97df1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 9 17:41:57 2015 +0100

    v2v: Remove obsolete README.RHEV-M file.

commit 4c7fb62f4a301cf26a7cf1ca3a5ed0d47406fa55
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 9 17:40:42 2015 +0100

    v2v: Rename virt-v2v appliance to "conversion server".
    
    This is for consistency with the rest of the documentation.
    
    This commit also adds the files to EXTRA_DIST so they are shipped in
    the tarball.
    
    This updates commit 4e4ece53647fba810eeb45086b46d02f54e02fe2.

commit 4e4ece53647fba810eeb45086b46d02f54e02fe2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 8 15:46:11 2015 +0100

    v2v: Add scripts for building RHEL 7 virt-v2v appliance.

commit 4f489b28fec699dd80615bd702d94f804a02efdd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 7 22:19:13 2015 +0100

    Try to discourage people from using 'make install' because it causes
    endless support troubles.

commit dcd382d9d4ad8b063c73fd35c9ffd8d609ee98b8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 6 17:10:07 2015 +0100

    Version 1.29.40.

commit e464774a79ff9eeedcdb3fd53efd5a7898ca036e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 6 10:50:21 2015 +0100

    p2v: Add Configure Network button (RHBZ#1167921).
    
    The old version of virt-p2v had a whole custom-written dialog which
    interacted with NetworkManager over dbus.  After trying that approach,
    it's really complex to get right.
    
    Instead this button simply opens NetworkManager's connection editor.
    
    This also adds nm-applet to the disk and starts it.  However nm-applet
    does not display any visible indication -- probably because we are
    lacking a system tray.

commit 9b2ca08ab543e2779a3a0da5f05b7ba4a5bc7b7d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 6 15:11:34 2015 +0100

    p2v: Switch from matchbox-window-manager to metacity.
    
    Matchbox only supports a single window on screen.  This worked fine
    until we added the NetworkManager connection dialog -- which tries to
    open in a new top level window, and of course fails.
    
    Metacity supports multiple top-level windows so doesn't suffer this
    problem.
    
    Apart from that it's hard to tell the difference between the two.

commit d5305c9672054d03d0c2ccdbc532643027c63775
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 5 20:56:38 2015 +0100

    p2v: Use "About virt-p2v [VERSION]" on the about button.
    
    This makes it clearer what the button does.
    
    This updates commit a743f57cb8e74adaccae3a6f3b3da0c6961dc5ba.

commit badfc2e9b2a56fd5bac849a6edca4fec823abeea
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 5 16:11:46 2015 +0100

    v2v: -o libvirt: Check if the domain exists on the target (RHBZ#889082).

commit e7833a5eea350ca3579d1f9e6702e116b45572fc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 5 15:55:53 2015 +0100

    v2v: Add a C function to fetch libvirt hypervisor capabilities.
    
    Instead of having to run external 'virsh capabilities' command and
    parsing the output.

commit 1189d5919e4b3edceaa6a58b914ae29123754074
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 5 15:10:27 2015 +0100

    p2v: Warn if vcpus or memory would be larger than supported by RHEL (RHBZ#823758).
    
    Display a warning if the number of vCPUs or memory selected in the GUI
    would be larger than the limits currently supported on RHEL 6 and RHEL 7.
    
    This is just a warning -- the user is free to ignore it and continue
    anyway.
    
    This warning does not apply if the selections were made through the
    kernel command line, because there is no place to display the warning
    for automated conversions.

commit b1336f26e6a4a643eefd7422e8cd2d4520b1a565
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 5 15:09:13 2015 +0100

    p2v: Factor out code for parsing vcpus & memory from conversion dialog.
    
    No functional change, just code refactoring.

commit ed19af781fdd59c0dc4e6166ad12d2fc36222262
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun May 3 14:58:59 2015 +0100

    tests/data: Add IA64 (Intel Itanium II) test binaries.

commit f1b7e1b58b74829bdd5dfff88636d6823e4b17ec
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 2 09:21:47 2015 +0100

    Version 1.29.39.

commit 4f414c72993fd806725ccb16ec2ab2346ad2ed26
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 1 22:19:58 2015 +0100

    v2v: docs: General updates to the manual.

commit 9246d75eeba6a7979715a730eef7bca53b01d022
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 1 21:55:15 2015 +0100

    v2v: docs: Replace "VMware ESX" with more accurate VMware vCenter/ESXi.
    
    "VMware ESX" is no longer a VMware product.  The hypervisor is
    called VMware ESXi and the management software is VMware vCenter.

commit 1b74e90de813f8d8f952ee3272f6c717094d5863
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 1 14:30:46 2015 +0100

    tests/data: Add ppc64/ppc64le binaries to the test ISO.
    
    This fixes commit 58bbb93a2514d4c40ea969aaad6b2ecf9a505b34.

commit ac049393093a8f2cbd1830467e3544f4bfaf0757
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 1 14:29:23 2015 +0100

    tests/data: Add mipsel (32 bit MIPS little endian) test binaries.

commit 40558450dd87190c9dc2649cadbf284ae0a21606
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 30 15:24:15 2015 +0100

    v2v: efi: Support output of UEFI guests, for some output drivers (RHBZ#1184690).
    
    Add the Types.target_firmware type, which stores our final decision
    for whether the guest requires BIOS or UEFI on the target.
    
    Not all output modes support UEFI.  In order to fail as early as
    possible if conversion isn't going to be possible, there is an
    output#supported_firmware method which returns the list of supported
    target_firmware.
    
    Add the target_firmware parameter to output#create_metadata so it can
    select the correct firmware in the final metadata.

commit 086f71c7d86b0321ebbf36e1fb77644e783a7491
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 30 14:26:30 2015 +0100

    v2v: Dump inspect and guestcaps structs when running in verbose mode.
    
    This helps with debugging.

commit 6a76d6d780a8a833c9762195a79515bbc65704a0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 30 14:09:46 2015 +0100

    v2v: efi: Detect if the guest could boot with UEFI.
    
    Use a heuristic to detect if the guest could boot with UEFI.
    
    This is only used where we have missing metadata (in the
    source.s_firmware == UnknownFirmware case).  Currently that only
    applies for `-i disk' and `-i libvirt/libvirtxml'.
    
    Eventually we'll be able to get this information from the libvirt
    metadata (RHBZ#1217444), so it'll only be used for `-i disk'.

commit ef77725081331b0a1b84ca32f6cb38a91873989f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 30 13:44:35 2015 +0100

    v2v: efi: Model firmware in source metadata.
    
    Also modify the input_* drivers so they pull out the firmware from the
    metadata.  Currently this is only possible for `-i ova', since libvirt
    does not expose it (RHBZ#1217444).

commit 9a45508f23451761fb3df825b17f2e32beb258d7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 30 16:23:26 2015 +0100

    v2v: efi: linux: Add support for grub2-efi.

commit 051f1f1a3fadcc18786c83066fba611ffe2a7995
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 30 13:24:40 2015 +0100

    v2v: efi: linux: Remove EFI hacks.
    
    Old virt-v2v had a bunch of code for removing EFI configuration from a
    Linux guest, and replacing it with grub.  I copied this code to new
    virt-v2v but it was never tested.
    
    Now that OVMF exists, we can simply boot EFI guests directly on KVM.
    
    Thus these hacks can finally be removed.

commit 06e93bf3ea7e7f8e717463c75e44ea0eda543db2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 30 11:19:53 2015 +0100

    mips: Ignore missing prototypes in flex-generated code.

commit 1f514f3466138b317028d5225ee53fe9cabfb9d7
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Apr 29 14:57:22 2015 +0200

    inspector: fix formatting of xpath result (RHBZ#1212680)
    
    Discard blank nodes when reading the XML from stdin, while enabling
    formatting in output nodes.

commit 22686d2cfd1793a4f2baa477650445fe2b5b4524
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Apr 28 15:22:45 2015 +0200

    customize: add a "touch" operation (RHBZ#1212808)

commit 63e0045926d336ad07feb40f7d5af8ab5b234e5d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 28 10:01:42 2015 +0100

    builder: Fix release notes for Debian 8.
    
    Editing inittab is not required for this version since it
    uses systemd.
    
    This fixes commit be81fbb3238abe0454f2d72e57dba5f22dbc3c8f.

commit be81fbb3238abe0454f2d72e57dba5f22dbc3c8f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 28 08:59:00 2015 +0100

    builder: Add Jessie (Debian 8).

commit 21764ec7c292d333fec8c8dabba3890351dbbd31
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 27 20:29:37 2015 +0100

    Version 1.29.38.

commit b70aec11c649b3c5ff22bc0f6a64e794ca3e7515
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 27 20:28:26 2015 +0100

    random_seed: Don't try to create random seed if no parent directory.
    
    Partial fix for https://bugzilla.redhat.com/show_bug.cgi?id=1215803

commit 2841400721a577dffc8940fd7ef17a536f4fb0f6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 27 15:05:15 2015 +0100

    firstboot: Don't create very long filenames for --firstboot-command (RHBZ#1212152).

commit aa8d66e7559bb8b0d7112c863ed85f02319e92e5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 27 15:02:30 2015 +0100

    firstboot: Factor out regular expression constant.
    
    Don't need to evaluate this every time we call the function.

commit 8c26ef91f95a9de68cea4c2341e00c938586f950
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Apr 27 10:16:40 2015 +0200

    v2v: convert old-style libvirt listen configuration (RHBZ#1174073)
    
    Use the listen configuration from the "listen" attribute of <graphics>,
    in case <listen> is missing.
    
    Followup of commit 9360675dc244a8762e07a8a4289e7a30ca3e1eef.

commit 2dd01c5d2de2a2abdd2c8ac82a8758aef301e3bb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 25 22:27:50 2015 +0100

    v2v: Remove warning when compiling --without-libvirt.

commit e3443a7549ce2643e50109de14148eeb0cfd0ce3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 25 22:03:54 2015 +0100

    v2v: -o libvirt: Minor refactoring of arch sanity check.

commit 4546d3f21dc6c6ab73dc8acdab778e26a5fde30a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 25 21:45:14 2015 +0100

    v2v: Replace polymorphic variant source_hypervisor with ordinary variant.
    
    See commit 3a080c3fbffa5846f71528c6fd978be7853b33b8.

commit 946d49cbbcfb47b5bb344ee24957e1c8e39f78e3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 25 21:40:49 2015 +0100

    v2v: Remove further uses of polymorphic variants.
    
    See commit 3a080c3fbffa5846f71528c6fd978be7853b33b8.

commit ce630dfc33cc1f44c8d38eb712624b3b79365176
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 24 09:04:38 2015 +0100

    valgrind: Add suppression for libvirt memory leak.
    
    Related to RHBZ#1215042.

commit e9910b488777fcd06d2d7c3eb05aed874797c7e0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 23 19:57:56 2015 +0100

    Version 1.29.37.

commit 578c7c086833cb44a1398ba91a5c997b6278b694
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 23 19:57:06 2015 +0100

    builder: Add rhel-ppc64.sh & rhel-ppc64le.sh to EXTRA_DIST.
    
    This fixes commit c5f0d39c64a379cc71fc0508bdcfdaec13d0c9d9.

commit b02980d5af264a436e0efed4f8c7296b9368de4a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 23 19:03:36 2015 +0100

    fuse: tests: Add some debugging to test-fuse-umount-race.sh.
    
    This test fails on recent kernels, sometimes.
    
    Apparently calling 'fusermount -u mp' can exit with an EBUSY error,
    but still unmount the filesystem.  Or possibly guestmount crashes
    coincidentally.  It's impossible to debug because debugging tools like
    strace prevent fuse from working at all.

commit 6dee5a4152a1e8a1b82f18c1f393dfc4ec89739e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 23 19:02:41 2015 +0100

    fuse: guestunmount: Make the -v (verbose) option do something useful.
    
    guestunmount had a -v / --verbose option, but it didn't change the
    behaviour of the program in any way.
    
    Make it print the invocations of the underlying fusermount program.

commit 0e4c351bb44d700faf10c3a035925c7bf13dd1cb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 23 17:56:03 2015 +0100

    mllib: Link config.ml to the test program.
    
    This fixes commit a1646fa65c6cd544e287f25051a88c4a572ebb3e.

commit 4f021006e9e85b0cc284d8c1cd3dcee416d75d51
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 23 10:52:08 2015 +0100

    v2v: When debugging, dump OVF to stderr.
    
    Useful for debugging problems like RHBZ#1213701.

commit c5f0d39c64a379cc71fc0508bdcfdaec13d0c9d9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 22 16:37:01 2015 +0100

    builder: Add scripts for generating RHEL 7 ppc64 & ppc64le images.

commit 2b0c6e8565977c3a53e3a834f3518cce2128aaec
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 20 17:35:44 2015 +0100

    v2v: Pass sound card information from the source to the target (RHBZ#1176493).
    
    Collect sound card information from the source, and where possible,
    create a compatible sound card on the target.
    
    Notes:
    
    * VMware's libvirt driver, and also OVF files, do not appear to
      contain any sound card information, so it cannot be collected from
      VMware sources.
    
    * Xen does emulate sound cards and makes that information available
      through libvirt XML.
    
    * There are no paravirt drivers for sound that I'm aware of.
      Therefore we can just copy the same sound model to the target (so
      the sound device does not appear to change).  If the target, KVM,
      does not support the device, it is dropped.  But ...
    
    * ... Unfortunately we cannot easily tell which sound cards are
      supported by KVM on the target.  This is especially a problem for
      RHEL, where many sound drivers have been removed.  There is a
      convenience function, `Utils.qemu_supports_sound_card', which can be
      modified by packagers to hard code the list of supported sound
      cards.
    
    * If a sound card is dubious / not supported by the target / has any
      other problem, then we drop it, since it is more important that the
      guest boots on the target than that sound works.

commit 3834a1064f866eef4c34440e6dd5023cc47ff7e1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 20 21:06:15 2015 +0100

    v2v: tests: Don't need to generate test-v2v-networks-and-bridges.xml.
    
    virt-v2v understands relative paths in libvirt XML (even though they
    are not legal and libvirt itself wouldn't generate it).  We don't need
    to generate this file.

commit a1646fa65c6cd544e287f25051a88c4a572ebb3e
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Apr 20 14:15:51 2015 +0200

    build: create and use a full version string
    
    Create a version string that includes the "extra" string as well, and
    make use of it in print_version_and_exit (which can avoid creating a new
    Guestfs handle).
    
    Folloup of commit 478a552ab431762dd2a724ade0c3fd84a21b7cab.

commit 4268865a78500fd654c0df91197918e924531a1c
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Apr 20 14:14:00 2015 +0200

    build: require Config before Common_utils
    
    Build the Config mllib module before Common_utils, as the latter will
    soon make use of the former.

commit 0576fdd0b6bafaeaa3d69bf6fc6fef0d0a1254d1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 20 13:12:08 2015 +0100

    v2v: Only emit fstrim warning when debugging (RHBZ#1168144).
    
    fstrim is an optimization.  If it fails, it's not fatal (although
    virt-v2v will run a lot more slowly).
    
    We also expect that it will fail for non-aligned NTFS partitions found
    on old versions of Windows, and in that case there's nothing that can
    be done about it.
    
    Therefore only emit the warning when we are debugging.

commit 3c51302d691cc204e4d43f4ab9837095d424bf3b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 20 12:05:29 2015 +0100

    v2v: OVF: Add more Windows operating system variants (RHBZ#1213324).
    
    When generating OVF (eg. for -o rhev, -o vdsm) we have to put the
    operating system type into a particular field of the output, in a
    format that oVirt/RHEV will understand.  Add further Windows OS
    variants to this list.  The variants are derived by examining
    ovirt-engine sources.
    
    Thanks: Tingting Zheng for testing Windows conversions to RHEV and
    finding this bug.

commit 86a91d6c65d6fe5da45bd827287cd9800ece721e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 20 08:55:03 2015 +0100

    p2v: Make --version output consistent with other tools (RHBZ#1213247).

commit 3b3f06d2247562cbdb7ed70868ffb3f9c18e8a32
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 20 08:51:13 2015 +0100

    virt-win-reg: Make output of --version flag consistent (RHBZ#1213247).

commit 478a552ab431762dd2a724ade0c3fd84a21b7cab
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 20 08:48:08 2015 +0100

    Common function to implement --version flag in all OCaml tools (RHBZ#1213247).
    
    Add a common function print_version_and_exit ~prog () and use this
    function to display the version in all OCaml tools, to ensure
    consistent output.

commit 921a3b8be2ecefc422d74b566a1bc46064a213dc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 20 08:47:45 2015 +0100

    fish: Whitespace changes.

commit 1d78b312bf1e74066e496538a48ca1bb373333ee
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 18 11:26:03 2015 +0100

    builder: Add CentOS 7.1 image.

commit 58bbb93a2514d4c40ea969aaad6b2ecf9a505b34
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 17 20:46:13 2015 +0100

    tests/data: Add ppc64 & ppc64le test binaries.

commit b2fbd88d9f5301ba32dc175de9d8fca6866f34d6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 17 16:11:18 2015 +0100

    builder: As TCG is single threaded, use 1 vCPU for Fedora ppc64 guests.

commit 0debc0b3a7189a6853652f9df4a06fd1c53d2487
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 17 11:28:43 2015 +0100

    builder: Set expand=/dev/sda3 for Fedora 21 ppc64 images.

commit 0e73a97ef42dc3f612f5a84993ba1aa18d2bd9e2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 17 11:17:01 2015 +0100

    builder: Fedora 21 ppc64 images are now raw not qcow2.
    
    Fixes commit f2109068e5161a178a4413e223e7ccfe61ed07c3.

commit f2109068e5161a178a4413e223e7ccfe61ed07c3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 17 09:56:10 2015 +0100

    builder: Upload new ppc64/ppc64le images which try to resolve console and partitioning problems.

commit 8670c784db56350fdb16c4be68a501877662f4ea
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 16 14:04:04 2015 +0100

    Version 1.29.36.

commit 49867a22babfed9d274294aabb1f93941793a7de
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 16 09:09:03 2015 +0100

    filearch: Fix memory leak.
    
    Found by 'make check-valgrind'.
    
    This fixes commit 20acc1f124a3f3af365c27b7654bead5beb1ef4c.

commit 0f4ad9cd84df3f176b48c819440f0a758eaa5f63
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 15 17:53:43 2015 +0100

    builder: Use console=hvc0 for serial console in ppc64 guests, and change partitioning type to LVM.

commit b4be660ed623fa7f64a54a9c7d60718ce1d077f8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 15 22:30:52 2015 +0100

    Version 1.29.35.

commit cc44a5b511475e2fe905cad4946d667c4403ca1e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 15 22:30:25 2015 +0100

    builder: Add fedora-ppc64le.sh script to EXTRA_DIST.

commit 8f5503096598ac38bb5da8efab517d5cf36cb760
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Apr 15 15:27:11 2015 +0200

    v2v: test-v2v-i-ova-formats.sh: test ova as tar.gz and tar.xz
    
    Extend test-v2v-i-ova-formats.sh to test for tarballs compressed as gzip
    or xz; followup of commit 3c582cfb8d62013a935953e919c79009452254f9.

commit 454220ab43403ad97f02edcb2b5f71c5d21c0c25
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Apr 15 15:24:12 2015 +0200

    v2v: generalize test-v2v-i-ova-zip.sh
    
    Rename test-v2v-i-ova-zip.sh (and associated data) to
    test-v2v-i-ova-formats, and generalize it a bit so it can test different
    compression types for the ova "envelope".

commit eab054a574fc83546c04607bcd75bf6f3796a193
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 15 13:32:45 2015 +0100

    builder: website: Set format=qcow2 for Fedora 21 ppc64 images.
    
    Since I created these with virt-builder without specifying the format,
    they have format=qcow2 (not raw).  Instead of tediously recreating or
    reuploading these images, just change the metadata.

commit f358d3d1edd38b5196fd04758a721520550bb1d1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 15 13:31:23 2015 +0100

    builder: In new virt-install, you must specify the format when creating disk images.
    
    New virt-install defaults to qcow2 format unless specified.
    Previously it defaulted to raw.  Specify the format explicitly.

commit 11450a2d36fd05bd0dc9baff97c2afd08b4c9b07
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Apr 15 14:28:05 2015 +0200

    v2v: tests: add port='-1' to test-v2v-i-ova.xml reference
    
    Followup of commit 1db249a0cc21c65e0d3192567b6016745cea7e58, as it
    outputs a new port attribute.

commit 8049474636d1a56cb259af6e527fb6b0a42e43e1
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Apr 15 13:22:13 2015 +0200

    v2v: use .ovf and .mf files anywhere within ova files
    
    Do not rely on .ovf and .mf files being in the top-level of the ova
    archive, but search them anywhere within the content of the ova.
    
    This also changes the result of the search of the .ovf file: previously,
    one (random) file was picked in case there were more than one, while now
    this situation triggers an error.
    
    Related to RHBZ#1186800.

commit 3c582cfb8d62013a935953e919c79009452254f9
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Apr 15 11:21:57 2015 +0200

    v2v: support tar.gz and tar.xz ova files
    
    When dealing with a ova detected as gzip of xz, uncompress few bytes of
    it to check whether it is a compressed tarball, and if so untar it.
    
    Related to RHBZ#1186800.

commit 05f5d069bafc0845593f188f01e9739ec46770de
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 15 12:43:56 2015 +0100

    builder: Upload second revision of ppc64/ppc64le templates.
    
    The serial console should be fixes in these versions.

commit 08b1ba35cfaa526982911fe9f355ed9c168d942d
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Apr 14 16:59:57 2015 +0200

    v2v: start importing "volume" disk types (RHBZ#1146832)
    
    Import disks stored as "file"-type volumes.
    
    Side effect: a guest converted to libvirt using virt-v2v can be
    converted again using virt-v2v.

commit f7529522ab74d824c550d62953f0b8ecf1e61466
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Apr 14 16:37:55 2015 +0200

    v2v: pass libvirt connection URI to parse_libvirt_xml
    
    This makes it possible to connect to the right libvirt.

commit 5da2ed95c11af6be6bee27f5b3dce8a6f3a29d74
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Apr 14 16:35:51 2015 +0200

    v2v: domainxml: add vol_dumpxml
    
    Add a new vol_dumpxml to get the XML dump of a pool's volume.

commit 9001f61a402dc1820fd4c441e5cc78197c39b73b
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Apr 14 15:16:01 2015 +0200

    v2v: domainxml: factor out connect and pool loading
    
    Factor out the connection and pool loading out of v2v_pool_dumpxml, so
    it can be used in later implementations requiring a pool.
    
    Should be just code motion.

commit eee28390ffd89344edd0d822012a5e4df398b2af
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 14 18:16:53 2015 +0100

    builder: Add Fedora 21 ppc64 & ppc64le images.
    
    This also corrects the size= field on all Fedora images.  It should
    be 6GB but was 4GB.

commit c65bba313d848d5d6a700df2c803bd89caadd2c6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 14 18:09:29 2015 +0100

    builder: Add fedora-ppc64le script and build ppc64le template.

commit c5b5442315f8c34b0988a1e0acfa4891e843be47
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 14 18:06:11 2015 +0100

    builder: Update fedora-ppc64 script and build ppc64 big endian template.

commit 1db249a0cc21c65e0d3192567b6016745cea7e58
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Apr 14 13:22:10 2015 +0200

    v2v: convert libvirt display port configuration
    
    Read the port configuration from the XML of libvirt domains, restoring
    it when writing new libvirt XMLs instead of always setting the
    "autoport" option.

commit 7291b226d1b08c762ae2f2715a2ac9ed7b8d5d14
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Apr 14 11:07:57 2015 +0200

    filearch: support gzip/xz-compressed files
    
    Extract them to find out the architecture of the data they hold.
    Useful to detect the architecture of e.g. compressed Linux modules.
    
    Provide in the test.iso two samples (compressing existing test data) of
    binaries compressed with gzip and xz.

commit 9360675dc244a8762e07a8a4289e7a30ca3e1eef
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Apr 14 10:38:54 2015 +0200

    v2v: convert libvirt display listen configuration (RHBZ#1174073)
    
    Read the listen configuration from the XML of libvirt domains, restoring
    it when writing new libvirt XMLs.

commit 20acc1f124a3f3af365c27b7654bead5beb1ef4c
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Apr 13 11:18:46 2015 +0200

    filearch: move libmagic code in an own function
    
    Also use a cleanup attribue to ease the close of the magic_t handle.
    
    This is mostly code motion, hopefully with no actual behaviour changes.

commit e062093881d66b56c4935054ad409ecf2531880b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 13 12:01:22 2015 +0100

    v2v: Add a man page section on importing from OVA files.

commit abf23ece49972111e19147087664e7442d84fdfd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 13 11:46:29 2015 +0100

    v2v: Document that vCenter >= 5.0 is required (RHBZ#1174200).
    
    vCenter 5.0 was released in 2011.  We have not tested against any
    earlier versions, but it was reported that it does not work with
    vCenter 4.
    
    Thanks: Sokratis

commit 80fcbe6eee209c8c94dc99f137e965432da99dd5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 11 16:38:59 2015 +0100

    v2v: Document that Windows up to 8.1 / 2012R2 now supported.
    
    Commit 2817824bd34e30fe6a2eeb65105067bd058f1fac added support for
    converting more recent versions of Windows, but neglected to document
    it.

commit d23134c5b83caad8f2484ded26c72adef47b2725
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 10 13:55:07 2015 +0100

    php: Clean up more intermediate files.

commit 2e6b14e0466bd63423fbd2c729e1ba0bf6764e8d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 10 13:48:02 2015 +0100

    Version 1.29.34.

commit 3f98018b4392e87593e19fb0aa69c31bd4aef354
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 10 13:10:13 2015 +0100

    v2v: test-harness: Describe how to get the test harness.
    
    I don't think it's worth building the test harness as a separate
    Fedora package.  It just means the harness gets out of date
    quickly and is hard to install.  Instead the test cases can now
    be configured to use the libguestfs source directory to get the
    test harness.

commit 2817824bd34e30fe6a2eeb65105067bd058f1fac
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 7 17:01:18 2015 +0100

    v2v: Support conversion of Windows >= 8 (RHBZ#1190669).
    
    Tested on:
    
    - Windows 8.1 Pro 64 bit
    - Windows Server 2012 R2 64 bit

commit 7260b0fc089c4fc61ac6ad0a816ca0f025aa5107
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 10 09:43:41 2015 +0100

    v2v: test-harness: Don't send key to wake up guest from blank unless the display is black.
    
    Grub2 in RHEL 6 responds to any key including shift keys by entering
    the grub menu (and thus waiting for the 'user' to press Enter).  This
    means our previous strategy of always hitting the shift key before
    taking a screenshot didn't work well.
    
    Instead, take a screenshot, if it's all (or mostly) black, hit a shift
    key and take another screenshot.

commit 12be9f831e0135eb94be2c87b3f0b35d51e14285
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 9 19:17:59 2015 +0100

    v2v: test-harness: Match on subimages instead of screenshots.
    
    Previously we fuzzy-matched on screenshots of the entire display.
    
    There were several problems:
    
     - dates/times in images required fuzzy matching, but it's not clear
       how much fuzz to use (Windows 8.1/2012R2 timestamp is huge,
       requiring an enormous amount of fuzz)
    
    - cannot cope with Windows 7 irregular placement of windows on
      the desktop
    
    It's better to match on subimages.
    
    This requires some changes to the test data, using gimp to clip the
    images and remove any changing elements (dates/times/etc) but in the
    long run it's more flexible than fuzzy matching on the whole display.
    
    Note that because of peculiarities in 'compare' we still need to have
    a little bit of fuzz in the matching.  Seemingly bit-for-bit identical
    images still have a similarity > 0.

commit ddeec8b5045125a4134fadc8b3975f985672e9d8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 9 17:40:16 2015 +0100

    v2v: test-harness: Improve boot loop.
    
    Take screenshots each time around the loop (every 10 seconds).  These
    are very useful for debugging.
    
    Check for the final screenshot on every iteration.  If the final
    screenshot is encountered then the guest is terminated immediately.
    
    Reverse a few loop tests to try to make the code more readable.

commit 1fabb99f11976034fffe01e67e1f49f375aa2d37
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 9 17:39:20 2015 +0100

    v2v: test-harness: Rearrange 'in' in function definition.
    
    Just a whitespace change.

commit 6c27ce649b9d4a25625b0c934856da9085d11cb4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 9 13:34:46 2015 +0100

    v2v: test-harness: Use xzcat instead of unxz --keep.
    
    unxz --keep fails on the symlinks used by git-annex with this
    rather unnecessary error:
    
      unxz --keep 'rhel_511_x86_64_pv.img.xz'
      unxz: rhel_511_x86_64_pv.img.xz: Is a symbolic link, skipping
    
    Use xzcat instead.

commit a23f82a5acf11d1b345f96d770ec74dae73602c7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 9 13:34:21 2015 +0100

    v2v: test-harness: New repository URLs, and details of using git-annex.

commit 4fd70eab4ff7d9a8e49db2938a80dcef45db150c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 7 16:58:40 2015 +0100

    v2v: Add support for REG_MULTI_SZ (multiple strings) to registry editor.

commit e264317b048987f725e6e63f4dd1bc1c21fca35f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 1 13:04:32 2015 +0100

    v2v: test-harness: Update the man page.

commit 3034f9a658a39783cf7c99d0b00b3c7b39b061f8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 1 13:24:42 2015 +0100

    v2v: test-harness: Send different shift keys to wake up guests from screen blank.
    
    See:
    https://rwmj.wordpress.com/2015/03/30/tip-wake-up-a-guest-from-screen-blank/

commit 3cb2b9da250be9fc891f8b10d96eaee87cec2e3a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 1 10:06:46 2015 +0100

    Version 1.29.33.

commit b8cb5c0d69e7ab8cd8598c0c49f0d65a1366cd62
Author: Roman Kagan <rkagan@parallels.com>
Date:   Tue Mar 31 16:26:38 2015 +0300

    v2v: allow configurable location for virtio drivers
    
    Make the location of the Windows virtio drivers overridable with the
    environment variable VIRTIO_WIN_DIR, in the same vein as is done for
    virt-tools.
    
    Signed-off-by: Roman Kagan <rkagan@parallels.com>

commit 26b913445022c3c1067e104c1871e7fbe0edb2f0
Author: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>
Date:   Mon Mar 30 22:15:20 2015 -0400

    actions.ml: fix a typo
    
    s/inclding/including
    
    Signed-off-by: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>

commit 6e989fd709fea37430398cbb7c01c52cd44bd1ac
Author: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>
Date:   Mon Mar 30 05:39:39 2015 -0400

    resize: add p_mbr_p_type as member of type partition
    
    Add p_mbr_p_type as member of type partition
    to describe mbr partition type.
    
    Currently we use:
    List.filter (fun p -> parttype <> MBR || p.G.part_num <= 4_l)
    to filter out logical partitions.
    
    Commit 0c396a4bce578486dfc4a38e1f8c47fd5c2836ea
    introduce API part_get_mbr_part_type,
    we could use this to know the part_type.
    Furthermore, we could also use p_mbr_p_type for resizing
    logical partitions.
    
    Signed-off-by: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>

commit 309f7062e8adbc9ec7240e21d00a384d789c69bf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 30 13:25:37 2015 +0100

    v2v: test-harness: Don't need to use Unix. prefix, since module is opened.

commit 6f53c6c026deaf7d65d411854bd129892ba53801
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 30 13:25:01 2015 +0100

    v2v: test-harness: Send shift key to wake up screen from blank before taking screenshots.

commit 453db7e210673cbd361a4d380e07e607ea833b9c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 30 13:23:10 2015 +0100

    v2v: RHEL 4: You have to update lvm2, device-mapper to get virtio support.
    
    Also include the updated selinux policy that goes with RHEL 4.8.
    
    Also mention that policycoreutils should be updated - see previous
    commit.

commit d4ab702dad39fe1f609ee17661f6bfa3a11dee31
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 30 13:22:58 2015 +0100

    v2v: Add note about RHEL 4 conversions hanging during SELinux relabelling.

commit f3c17ab0d8d19dcde036e1bec499de8503be4169
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 30 09:43:34 2015 +0100

    builder: Fix arch= field in previous commit.
    
    Fixes commit 8ddc56473025ef2f294562b5317c5f3f8684864f.

commit 8ddc56473025ef2f294562b5317c5f3f8684864f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 30 09:09:22 2015 +0100

    builder: Update index for new armv7 Fedora guest.

commit 2cb691e46eb36f1a31a43a943d31182ea33b56b5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 28 23:20:13 2015 +0000

    builder: Add script for building Fedora armv7l (32 bit ARM) guests.

commit 5c65b9108d2eabee9d885dcc61df5862bd3115fe
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 28 18:08:21 2015 +0000

    ruby: Only rebuild rdoc when absolutely necessary.
    
    Rebuilding the ruby documentation takes 51 seconds on my laptop, and
    that's a significant fraction of the entire build.  Make sure we only
    rebuild the documentation when necessary.

commit e86df90e52120258baf56cf0155a5f6e3fae1577
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 28 17:53:35 2015 +0000

    guestfs-performance: Suggest using 'ts' instead of annotate.
    
    'ts' allows incremental timings which is a lot more useful.

commit f1007fc26d58a62b3692f64a6d8219ad9221510f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 28 10:15:57 2015 +0000

    lib: Fix static linking by forcing launch-*.o objects to be always linked.
    
    Because the launch-*.o objects only contain statically scoped
    declarations, the linker doesn't need to link them in.  This causes a
    problem when static linking as they will be left out of the final
    binary, and so no backends will be available.
    
    This is essentially the same problem as described here:
    
    https://stackoverflow.com/questions/1202494/why-doesnt-attribute-constructor-work-in-a-static-library

commit 7906c34a0f24ecd15f9d4d42ebf120a325db5395
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 27 22:42:03 2015 +0000

    build: Fix ./configure --without-libvirt option.

commit c370ca75c8affa6e0ab7c6e0a9b4172454e01c85
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 27 22:44:07 2015 +0000

    lib: Remove bogus visibility declaration (GUESTFS_DLL_PUBLIC) from internal function.

commit a1a42d00024043a959766cb047b18542d3837b3a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 27 11:02:18 2015 +0000

    Version 1.29.32.

commit 403e32df23cf44d82bb92bd3cfd55d16d32acafd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 27 10:59:57 2015 +0000

    fuse: Add a note about preserving inode numbers using -o use_ino.
    
    Thanks: David Juran

commit e6dadd6aca139792863cd3d274270095ec49a34e
Author: Maros Zatko <mzatko@redhat.com>
Date:   Thu Mar 26 16:47:58 2015 +0100

    customize: fix --upload to FAT partition (RHBZ#1196101)
    
    Some filesystems, such as FAT doesn't support file
    ownership, so show warning instead of error on EPERM.

commit d308d0f70346a5140de3f1320825573d92279c7d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 26 11:19:47 2015 +0000

    builder: Fix rhel 5 repository location.
    
    RHEL 5 was unusual in having separate sub-repositories (Server, VT,
    Cluster etc) within the main RHEL-5-Server directory.  Thankfully no
    other version of RHEL does this.  Previously we set up the repository
    baseurl incorrectly so it didn't include .../Server in the path.
    
    In commit 1a1cb1ec3cdc24262db4de2f8bf12d3479096882, I tried to fix the
    RHEL 5 repo location to include .../Server.  However that broke the
    virt-install --location parameter.
    
    Use a separate baseurl path, which should fix both problems.
    
    This fixes commit 1a1cb1ec3cdc24262db4de2f8bf12d3479096882 and
    commit 3bc9ba6c8447cde07db057aea76d0d72f5d833df.

commit 6f7c1663c1c180b9f25b25490307f52dfe32afc2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 26 11:18:16 2015 +0000

    Revert "builder: Fix RHEL 5 download location."
    
    This reverts commit 1a1cb1ec3cdc24262db4de2f8bf12d3479096882.

commit 6c5451b34fb3026950711e275befabd530804aee
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 26 09:42:52 2015 +0000

    v2v: test-harness: Rebuild v2v_test_harness.cmi if OCaml API changes.
    
    The error you would have seen before was:
    
    File "v2v_test_harness.ml", line 1:
    Error: The files ../../ocaml/guestfs.cmi and v2v_test_harness.cmi
           make inconsistent assumptions over interface Guestfs

commit 6297534091666ccb7a5192763b53a4350cb550e3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 26 09:16:44 2015 +0000

    ocaml: Add Guestfs.Errno.errno_EPERM.

commit 0c396a4bce578486dfc4a38e1f8c47fd5c2836ea
Author: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>
Date:   Tue Mar 24 07:20:17 2015 -0400

    New API: part_get_mbr_part_type for showing partition type
    
    This patch will add support for getting partition type
    of a partiton numbered device.
    
    Signed-off-by: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>

commit af9aa2eb0582bfced4e16ade73c19c321b91ceb9
Author: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>
Date:   Tue Mar 24 07:20:16 2015 -0400

    parted: introduce enum for whether parted has option -m
    
    Signed-off-by: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>
    
    RWMJ: Use enum consistently, don't assign the result to int.

commit 52d1b0c593e87cb5d696dcc9d96ad6489c9bed00
Author: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>
Date:   Mon Mar 23 22:51:48 2015 -0400

    New API: btrfs-image
    
    Signed-off-by: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>

commit ea6d4e553598d7df5c54a0ebe8c7416286fa4ecb
Author: Maros Zatko <hacxman@gmail.com>
Date:   Mon Mar 23 19:47:25 2015 +0100

    customize: add --move (RHBZ#1203817).
    
    This adds --move SOURCE:DEST, equivalent of calling g#mv src dst.
    
    RFE: RHBZ#1203817

commit 943fec0399ca2fc6c06fcc3d45ab74efae3188db
Author: Maros Zatko <hacxman@gmail.com>
Date:   Mon Mar 23 19:46:33 2015 +0100

    customize: add --copy (RHBZ#1203817).
    
    This adds --copy SOURCE:DEST, equivalent of calling g#cp_a src dst.
    
    RFE: RHBZ#1203817

commit c227cbcc14b903a86d37369596e365d93293734e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 23 14:03:14 2015 +0000

    Version 1.29.31.

commit d48615577c18d57c5b0d7fc812ba7e193119e854
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 23 13:59:00 2015 +0000

    builder: Add test-virt-index-validate-good-3 to EXTRA_DIST
    
    Fixes commit fc6c16af0b765e39793554db0f55bd75f53fce9f.

commit 039ba9cf19b69f9c16efc831d4a4180cc04172a4
Author: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>
Date:   Mon Mar 16 05:44:19 2015 -0400

    btrfs-qgroup-show: add check for "--raw"
    
    btrfs-prog commit:
    58a39524619f38d193b8adc3d57888ec07b612aa
    change the default output to binary prefix,
    and introduced a new option '--raw'
    to keep the traditional behaviour.
    
    This patch will add a check function to determine
    whether to add '--raw' option to 'btrfs show qgroup'.
    
    Signed-off-by: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>

commit fc6c16af0b765e39793554db0f55bd75f53fce9f
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Mar 13 15:02:58 2015 +0100

    builder: handle empty lines in indexes before first section (RHBZ#1201526)
    
    Properly skip empty lines before the first section, otherwise they will
    trigger a syntax error in parsing.
    
    Add a simple test for it, so it doesn't regress.

commit 09e239a726228922366107c5fcfd0542ee25503b
Author: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>
Date:   Fri Mar 13 05:59:38 2015 -0400

    tests: add test case of set-label and vfs-label for btrfs
    
    Signed-off-by: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>

commit 017f1c67296ee6fa9a566f853ea896e39d2e9bf0
Author: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>
Date:   Fri Mar 13 01:32:59 2015 -0400

    guestfs.pod: don't encourage 'make syntax-check'
    
    Signed-off-by: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>

commit 7e8ed7cb218c4104753fa5aae9d945d5a84054e9
Author: Maros Zatko <mzatko@redhat.com>
Date:   Thu Mar 5 16:42:45 2015 +0100

    customize: add --truncate-recursive option
    
    Allows user to recursively truncate files in PATH. e.g.:
    virt-builder --truncate-recursive /var/log
    
    Relates to RHBZ#119673

commit ce144c4d7af5bcae1646a84e70362655e0572081
Author: Maros Zatko <mzatko@redhat.com>
Date:   Fri Feb 6 14:11:13 2015 +0100

    virt-copy, virt-tar: show help for --help

commit 5a445c2e407c7364ceb81b47c99e56810b9dcc39
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 23 12:14:59 2015 +0000

    docs: You normally need to set SUPERMIN_KERNEL_VERSION as well.

commit 762c0bdab914964515b0e11605e28c690c664b0a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 23 12:12:23 2015 +0000

    docs: Remove some rogue references to 'febootstrap'.

commit 5ac87b975fef867663402743d79e1b693d485bb8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 20 12:14:42 2015 +0000

    v2v: test-harness: Add support for OVA.
    
    This makes VMware testing easier, since it means you don't need to
    test against a live server.

commit 04f1f1b741ace41f8c36ae3059690084c7a2dc9c
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Mar 12 17:31:57 2015 +0100

    generator: small optimization of pod2text cache memoization
    
    Instead of save every time there's a new element in the cache, batch the
    saving to disk every 100 changes, saving the unsaved remainder at the
    exit.
    
    While not a big optimization, this reduces a bit the disk usage during
    generator run.

commit 078bd8ad065046b7fe8c133ce12b97c12949cccf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 12 15:02:59 2015 +0000

    v2v: test harness: Add list of FILES to the manual page.

commit c3fa537aebfb86202b2fa4848cd0438246c6a694
Author: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>
Date:   Thu Mar 12 03:00:47 2015 -0400

    guestfs.pod: fix a typo
    
    s/applicance/appliance
    
    Signed-off-by: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>

commit 32e5056f4a758f4a5553fe023d603c4708fa2efb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 11 17:24:59 2015 +0000

    Revert "launch: libvirt: In debug messages use ls --lcontext instead of ls -Z."
    
    The --lcontext option was removed from coreutils ls (in 2007, cough).
    
    Fedora carried a patch re-adding these options [I believe
    unintentionally], but that patch was dropped in Fedora 23, so the
    --lcontext option is gone for good.
    
    This reverts commit f9c5b4aa2a6e8890eb20e15165bbe6820e6011b5.

commit ffa858469957a0cdfcedb27701c909c1765d06d3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 11 15:08:30 2015 +0000

    tests: mount-local: Print some more debugging along error paths.
    
    Trying to track down a memory leak somewhere.

commit 0827b006e4943a670dbe193dd8b522d7cc3b4bf5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 11 15:05:13 2015 +0000

    v2v: test-harness: Fix boot loop so it detects disk inactivity properly.

commit a3beda8b77363e13f652104b06efaee33ecfe67c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 11 15:02:58 2015 +0000

    v2v: test-harness: Measure similarity between images when comparing screenshots.
    
    Since wallclock time differs between boots, we cannot just compare two
    screenshots by checking if they are identical -- if the screenshot
    contains any time information, then that will be different, and it
    turns out that VMs print the current time at boot.
    
    Therefore parse out and use the "similarity" metric printed by the
    ImageMagick "compare" command when it compares the screenshots, and
    allow a small epsilon for the case where a few oixels are different.

commit f052270039d8954c89457cab3f8af079853bc98e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 10 21:47:15 2015 +0000

    Version 1.29.30.

commit ccb3894915eea83c110038549de93aa2cedc6b03
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 10 14:58:08 2015 +0000

    v2v: Add the test-harness used by external tests.
    
    See the new man page virt-v2v-test-harness(1) added in this commit for
    details of this library/harness, and also how to get the external
    tests.

commit 35916e700b8818516be5dfefa2eadc6a5f8d84e5
Author: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>
Date:   Tue Mar 10 06:05:43 2015 -0400

    gui: fix a syntax-check issue of bindtextdomain
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>
    Signed-off-by: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>

commit 8873c51475b46bfb7cb78367432e5dde1667bd9b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 10 16:50:32 2015 +0000

    po-docs: Update list of manual pages to be translated.
    
    There should be an automatic way to keep this list updated, but while
    there isn't, keep it updated by hand ...

commit 1fba1d1edc8e91d602975fe48821fab66148a9d2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 10 10:15:42 2015 +0000

    builder: Fix path to RHEL source RPMs in internal repo.
    
    Thanks: Jan Scotka

commit ce56c7d30e4d95d83fa85b1eca73aeddbebccbec
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 9 17:49:21 2015 +0000

    FAQ: Don't refer to RHEL 7 in future tense.
    
    Thanks: orc_emacs on IRC.

commit 3053785db82c3aaf935c582146fd863d3618910f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 9 13:13:16 2015 +0000

    builder: Fix comparison between signed/unsigned in parallel xzcat.
    
    block.header_size is uint32_t so cannot be compared directly with n (ssize_t).
    
    pxzcat-c.c: In function 'worker_thread':
    pxzcat-c.c:602:21: error: comparison between signed and unsigned integer expressions [-Werror=sign-compare]
         if (n >= 0 && n != block.header_size-1) {
                         ^

commit c807546619cee0faeedc5ae491f7d6623509b75a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 6 17:05:50 2015 +0000

    v2v: xml: Add some more bindings to libxml2.
    
    These are not used by libguestfs, but are used by the external
    virt-v2v tests.

commit ce5a51a34c2667ed89d0e184d770f96d0283c001
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 6 17:02:58 2015 +0000

    v2v: xml: Remove dependency on libguestfs internals.
    
    This is just so I can share the code with the virt-v2v external tests.

commit 4ee6e4ddc8dd039a7670220ba0fe4079f302016a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 5 13:42:20 2015 +0000

    Version 1.29.29.

commit 025f1d2bc76ebb6205393cc234004c1dcd1b0a67
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 5 13:41:21 2015 +0000

    bugs: Ignore bugs in RELEASE_PENDING state.
    
    It's effectively the same as CLOSED.

commit 4592caedd42546c6c153b18fa5b764f29d97c7ad
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 5 13:39:21 2015 +0000

    builder: Add fedora-ppc64.sh script to EXTRA_DIST.
    
    This updates commit 7867abc5c2f3d25c4bd681b85ac8216de7a9121d.

commit 1d93cb9e4b29ad60056eb684b0744c242bfdcab4
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Mar 3 15:39:13 2015 +0100

    actions: improve man page links
    
    Switch from C<> to L<> for links to man pages, where wasn't done before.

commit 7867abc5c2f3d25c4bd681b85ac8216de7a9121d
Author: Maros Zatko <mzatko@redhat.com>
Date:   Thu Mar 5 01:20:07 2015 +0100

    builder: add build script for PPC64 Fedora

commit a084758e83eddb0c5b57ce904856218240011419
Author: Maros Zatko <mzatko@redhat.com>
Date:   Thu Mar 5 01:03:54 2015 +0100

    customize: add --truncate option (RHBZ#119673)

commit e51420c61f1374cecc0bd2bb651525d45fd55749
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 5 12:18:23 2015 +0000

    arm: Ignore -Wpointer-to-int-cast in c-pointer API.
    
    This API converts the C guestfs_h pointer to a 64 bit integer,
    which should always be possible on reasonable architectures.
    Therefore silence a GCC warning (which only occurs on 32 bit ARM).

commit af762e43424382d895d3a10aa6632adc601fdbad
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 5 10:25:46 2015 +0000

    arm: Use -M virt on 32 bit ARM, don't pass -dtb parameter.
    
    Note this means all the dtb code in libguestfs & supermin is
    obsolete/unused, and may be deleted at some point in future.

commit 7fb85dcde393059b75a757cf6b6f39c5d76f5e10
Author: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>
Date:   Tue Mar 3 02:31:55 2015 -0500

    actions.ml: fix a typo
    
    s/tto/to
    
    Signed-off-by: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>

commit e6445e982a5fdd886f71208a734f053a59122d3e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 2 17:41:37 2015 +0000

    ocaml: Don't run check-valgrind on run-bindtests (bash script).
    
    Fix the 'make check-valgrind' rule in the ocaml subdirectory so it
    doesn't run '$VG run-bindtests', effectively running valgrind on bash.
    
    Bash in Fedora Rawhide has added a new memory leak, resulting in a
    failure, but we don't want to test bash anyway.

commit 1cdb5a103ab33623077940633d93e575f69c8918
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 2 13:54:13 2015 +0000

    Version 1.29.28.

commit 064628632bbb7b2d263c0da42bde677e691a8b80
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 2 13:53:12 2015 +0000

    build: Fix 'maintainer-check-extra-dist' to only list relevant files.

commit 250db12c24e85e04db2e36a024470647f7148801
Author: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>
Date:   Sun Mar 1 02:20:49 2015 -0500

    New API: btrfstune_enable_skinny_metadata_extent_refs
    
    Signed-off-by: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>

commit aa702095586e1101772516a5e6dd3c7bcb962df3
Author: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>
Date:   Sun Mar 1 02:20:48 2015 -0500

    New API: btrfstune_enable_extended_inode_refs
    
    Signed-off-by: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>

commit fa14c3d6bc81bcdd4b70659dd4a946ea1b96c1d1
Author: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>
Date:   Sun Mar 1 02:20:47 2015 -0500

    New API: btrfstune_seeding
    
    Use btrfstune_seeding to enable or disable seeding.
    
    Signed-off-by: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>

commit 78e1a1472c3b15b9530cecf3fe65fe0fde9665a8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 2 09:11:47 2015 +0000

    builder: Fix 'os-version' in man page examples.

commit e4944043fb1b9ea3e74ef716595c71828e91ca2f
Author: Michael Scherer <misc@zarb.org>
Date:   Sun Mar 1 01:12:49 2015 +0100

    Use a debian distribution for the apt example

commit 4e9bda459844c8be1448ea6d33de1fb02cf0b021
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 28 11:10:31 2015 +0000

    appliance: Create /etc/mtab in init script to work around util-linux nuttiness.

commit 41d4d606e53d1574352aec6452aafddbdfd21116
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 27 14:38:07 2015 +0000

    Version 1.29.27.

commit ecbbfc9ddd6dc1df2efd3e84d8d2a025bb464794
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 27 14:37:07 2015 +0000

    po-docs: Ship some untranslated PO files.
    
    Add untranslated PO files to EXTRA_DIST.

commit 6c7823b9a9da72a9443fdb01caef65c4efed1a1d
Author: Roman Kagan <rkagan@parallels.com>
Date:   Fri Feb 27 15:20:18 2015 +0300

    convert_windows: split firstboot into steps
    
    Instead of doing all firstboot actions in a single script, take the
    advantage of the firstboot infrastructure and store and run unrelated
    actions as individual steps.
    
    This facilitates troubleshooting and fault recovery; besides it makes
    adding more actions easier.
    
    Signed-off-by: Roman Kagan <rkagan@parallels.com>

commit 58eb977c0d5bf25c03e701f39fa570e83a82d573
Author: Roman Kagan <rkagan@parallels.com>
Date:   Fri Feb 27 15:20:17 2015 +0300

    firstboot: make script naming descriptive
    
    The firstboot infrastructure used to give the firstboot scripts some
    cryptic names which were impossible to relate to the actions they were
    supposed to take.
    
    This patch reworks the scheme such that the caller registering a
    firstboot script has to provide a descriptive name for the action.  That
    name, with non-alphanumeric characters replaced with dashes, prefixed by
    the serial number, is then used as the name of the script, e.g.
    
      0004-install-gcc
    
    or
    
      0002-msiexec--i-foo-msi.bat
    
    OTOH the numbering becomes internal to the API, i.e. the scripts are
    numbered and executed in the order they are registered.
    
    This greatly facilitates debugging and troubleshooting in case when
    there are multiple firstboot scripts.
    
    Signed-off-by: Roman Kagan <rkagan@parallels.com>

commit 7aa9d6367478402556e5185a7b2f241c38de9c39
Author: Roman Kagan <rkagan@parallels.com>
Date:   Fri Feb 27 15:20:16 2015 +0300

    firstboot: enhance firstboot driver script for Windows
    
    This patch is an attempt to enhance the firstboot driver script for
    Windows, and make it somewhat closer in functionality to what is done
    for Linux guests.
    
    Specifically, for every firstboot script it now will log its exit
    status, and, if the script reported success, move it to -done directory.
    
    Signed-off-by: Roman Kagan <rkagan@parallels.com>

commit 3edd770b09bf3f58cf22bf00acba58e7ba656038
Author: Roman Kagan <rkagan@parallels.com>
Date:   Fri Feb 27 15:20:15 2015 +0300

    firstboot: consolidate line ending conversion
    
    This patch moves line ending conversion for windows scripts into a
    separate helper function.
    
    This simplifies code a bit, and fixes the problem that actual firstboot
    scripts used to remain with unix-style line endings.
    
    Signed-off-by: Roman Kagan <rkagan@parallels.com>

commit be79bdfd3acb25018feb2a808aa1343c2cc8b95c
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Feb 26 10:01:14 2015 +0100

    builder: handle -v and -x flags like in other tools (RHBZ#1196100)
    
    Make sure that -x enables tracing and -v enables verbose mode, just like
    other tools do.
    
    Kind of followup of commit b6b9b90dd74c7b9204bdf218aa9360e117308e78.

commit 652af7a33ac769b063cadddc41786dc69bbe2792
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Feb 23 14:08:02 2015 +0100

    builder: use mkdir_p to create the cachedir (RHBZ#1195204)

commit d54132f94d92e09b4cf936db23803ac26ef37648
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Feb 23 14:04:00 2015 +0100

    mllib: add helper mkdir_p
    
    Small function to create in OCaml-based code a directory and its
    parents, much like `mkdir -p`.

commit ef992c2b071513c98a3561ced3320f336876457d
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Feb 23 10:58:58 2015 +0100

    build: fix distfiles for zanata
    
    Followup of commit c328ac9e0473197dd563cfc123c417a5261fb39e.

commit 2acf98c7841d900aa667d4c790482a2c7f597e68
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Feb 22 14:33:14 2015 +0000

    Update translations from Zanata.
    
    I added the new linguas for the po/ directory.  But not for the
    po-docs/ directory, since the new po files hardly contain any
    translations there.

commit c328ac9e0473197dd563cfc123c417a5261fb39e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 18 14:42:54 2015 +0000

    Move upstream translations from Tranifex to Zanata.
    
    This is at the request of the Fedora localization team.
    For further information see:
    
    https://www.redhat.com/archives/libguestfs/2015-February/msg00168.html

commit 6200abf92efe4db03c87a4cc284470a28531570d
Author: Nikos Skalkotos <skalkoto@grnet.gr>
Date:   Wed Feb 18 15:59:48 2015 +0200

    Fix a bug in e2fsck execution code
    
    Use commandrvf() instead of commandvf() to execute e2fsck. A non-zero
    exit status does not always indicate a failure.
    
    Signed-off-by: Nikos Skalkotos <skalkoto@grnet.gr>

commit 869b9fcf97d1084e06c16ec25df60d3bc58bfb0f
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Feb 17 16:24:12 2015 +0100

    builder: when not checking sigs, ignore --fingerprint args (RHBZ#1193237)
    
    When the user chooses to not verify the signatures on the indexes
    (using --no-check-signature), there is no point in requiring as many
    --fingerprint as --source (or even just one), as they will not be used
    anyway.
    
    In this case just ignore all the values of the specified --fingerprint
    arguments.

commit 17dabd57c78c021f17169fe69643a35c6c3b7ef9
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Feb 17 15:48:22 2015 +0100

    builder: process --source sources before
    
    Process the sources specified via the --source command line arguments
    before sources read from repositories, so the former have a chance to
    "override" the latter.
    
    Related to RHBZ#1193238.

commit fa36b70b20e9f3bcf5cd3a553e73274e4999e0d5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 17 12:11:41 2015 +0000

    Version 1.29.26.

commit c7de22b0d3afc89c046ff3efb0bef8654de3f618
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 17 12:11:12 2015 +0000

    aarch64: Add fedora-aarch64.sh builder script to EXTRA_DIST.
    
    This fixes commit 5809a5a802f4999d759e247eec5bbdf664835e80.

commit 568a33d7ef2faa0e5fd5be4afebc74e796033573
Author: Maros Zatko <mzatko@redhat.com>
Date:   Fri Feb 13 13:05:43 2015 +0100

    inspector: add /reactos as systemroot
    
    Fixes RHBZ#709326
    Related bug RHBZ#709327 seems to be already fixed in ReactOS 0.4.

commit f2653718683bbdb3aaea64e034ac5dec12327813
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Sun Feb 15 20:45:18 2015 +0800

    New API: btfs_scrub_status
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>
    Signed-off-by: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>

commit 88dbae4cbfe89da88f60dacd63b347fa13fddb3d
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Sun Feb 15 20:45:17 2015 +0800

    New API: btrfs_balance_status
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>
    Signed-off-by: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>

commit 6c6ce85f94c36803fe2db35a98db436bff0c14b0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 20 17:46:53 2014 +0000

    v2v: -o libvirt: Prevent possible XPath injection.
    
    Ensure the arch string is sane before using it in the following XPath
    expression.  Since the arch string can be derived from untrusted guest
    data [see src/filearch.c], this prevents a possible XPath injection
    vulnerability.

commit c3566da409ab686330be3be51964183b2b510f15
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 14 17:21:48 2015 +0000

    python: Call PyErr_Clear() on non-error paths out of the Python bindings.
    
    We also need to be more careful about PyString_FromString and similar
    functions returning NULL on failure.  Currently we don't check this
    every time.  This commit adds more checks, but is still not complete.

commit 0f029a5f5831df518c317fca3ec78fedc37f4a74
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 14 16:35:25 2015 +0000

    Whitespace changes arising from the previous two commits.

commit 1efd8aa8f1b5148ba8091e0df8be0b4afd6a596a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 14 15:26:15 2015 +0000

    Change guestfs__* to guestfs_impl_*
    
    libguestfs has used double and triple underscores in identifiers.
    These aren't valid for global names in C++.
    
    The second step is to replace all guestfs__* (2 underscores) with
    guestfs_impl_*.
    
    These functions are used where a libguestfs API call is implemented on
    the library side.  The generator creates a wrapper function which
    calls guestfs_impl_* to do the work.  (Libguestfs APIs which are
    passed directly by the daemon work differently and don't require a
    guestfs_impl_* function).
    
    This is an entirely mechanical change done using:
      git ls-files | xargs perl -pi.bak -e 's/guestfs___/guestfs_impl_/g'
    
    Reference: http://stackoverflow.com/a/228797

commit bfbcc01403ef99599568881aa9b3995d83859f05
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 14 15:14:48 2015 +0000

    Change guestfs___* to guestfs_int_*
    
    libguestfs has used double and triple underscores in identifiers.
    These aren't valid for global names in C++.
    
    The first step is to replace all guestfs___* (3 underscores) with
    guestfs_int_*.  We've used guestfs_int_* elsewhere already as a prefix
    for internal identifiers.
    
    This is an entirely mechanical change done using:
      git ls-files | xargs perl -pi.bak -e 's/guestfs___/guestfs_int_/g'
    
    Reference: http://stackoverflow.com/a/228797

commit 46010912efe0910a942ed44ad706efb4a7e9b4e2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 14 17:39:51 2015 +0000

    Update gnulib to latest.

commit 98aa470bc6d45bc6ee61bc4db9b779e1100b0ce1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 14 17:08:05 2015 +0000

    Update TODO.
    
    Remove some things which have been implemented already.

commit 5f67d23cf549dbd036a50bdea5ac883f274fe0c4
Author: Margaret Lewicka <margaret@meaningless.name>
Date:   Fri Feb 13 21:26:14 2015 +0000

    fuse: Alternatives for Linux-specific commands
    
    * fusermount is Linux-only; on BSD and OS X umount should be used
    * fuser has no -v flag on BSD/OSX, and -c is the
      POSIX-compatible equivalent of -m
    * Does not solve the lack of pretty output of fuser -v, but does make it
      work on Mac OS X.

commit 88d16e6fb98ecaabd06da42b603a36b7623c33e0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 13 14:46:28 2015 +0000

    aarch64: builder: Fix metadata so virt-builder --size works.
    
    The wrong partition was being expanded.
    
    This fixes commit 5809a5a802f4999d759e247eec5bbdf664835e80.

commit f71168497d7a19116bd7e6c1c142520aec16ab62
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Feb 13 14:37:46 2015 +0100

    php: skip bindtests on 32bit platforms
    
    bindtests checks also 64bit int values, which won't work when the
    underlying platform has sizeof(long) < 8 (like on 32bit architectures).

commit a34416091e9f79defa14cafd91f9e7ecd3ee6853
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 13 10:47:19 2015 +0000

    daemon: btrfs: Remove full stop from end of error message.
    
    This fixes commit 56732ed6a08af7e3f7f1f17e89e8dc62cf3d4f4a.

commit cae7909f5ed848ecfcb5ffe999f1290f7448ef26
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 13 09:36:47 2015 +0000

    ./run: Use 'prepend' function to build paths.
    
    Add a bash function 'prepend' for intelligently prepending elements to
    paths.  eg:
    
      prepend PYTHONPATH "/foo"
    
    would set PYTHONPATH to "/foo" or "/foo:<previous-contents-of-PYTHONPATH>"
    
    Tested by:
    
    (1) Building and testing libguestfs twice: first without libguestfs
    installed as a system library, and then with it installed.
    
    (2) Examining the output of './run printenv' by hand and comparing
    environment variables to the expected values.

commit 928430f1118c5ff23cb7c4bd741e580b1b72581b
Author: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>
Date:   Fri Feb 13 17:00:11 2015 +0800

    actions.ml: fix a typo
    
    s/scannning/scanning
    
    Signed-off-by: Chen Hanxiao <chenhanxiao@cn.fujitsu.com>

commit b969be72cd315e5c12c28ffc8d98822e4b96c571
Author: Margaret Lewicka <margaret@meaningless.name>
Date:   Thu Feb 12 22:37:07 2015 +0000

    lib: Check if crypt() comes from a separate library
    
    Mac OS X includes crypt() in libc.

commit cc4baac81552ef07b98eb904a752bdd2b1a319fb
Author: Margaret Lewicka <margaret@meaningless.name>
Date:   Thu Feb 12 22:37:06 2015 +0000

    run: Set DYLD_LIBRARY_PATH along with LD_LIBRARY_PATH
    
    Mac OS X uses DYLD_LIBRARY_PATH rather than LD_LIBRARY_PATH.

commit 5fc07e87bbd9f0472a1af8b0a52f40948ebcd2e1
Author: Margaret Lewicka <margaret@meaningless.name>
Date:   Thu Feb 12 17:28:46 2015 +0000

    macosx: Includes/defines for byteswap operations

commit e39ab27deaf1e124c4078db18fe883ad339c865b
Author: Margaret Lewicka <margaret@meaningless.name>
Date:   Thu Feb 12 17:28:48 2015 +0000

    lib: Add third, zero parameter to xdrproc_t
    
    As advised by Daniel P. Berrange, the third parameter can be passed on all
    platforms rather than specifically Mac.
    
    Quoting a libvirt commit rationale after Daniel:
    
     commit 9fa3a8ab6fd82ad2f5a14b490696085061418718
     Author: Doug Goldstein <cardoe@cardoe.com>
     Date:   Wed Oct 30 11:22:58 2013 -0500
    
       MacOS: Handle changes to xdrproc_t definition
    
       With Mac OS X 10.9, xdrproc_t is no longer defined as:
    
       typedef bool_t (*xdrproc_t)(XDR *, ...);
    
       but instead as:
    
       typedef bool_t (*xdrproc_t)(XDR *, void *, unsigned int);
    
       For reference, Linux systems typically define it as:
    
       typedef bool_t (*xdrproc_t)(XDR *, void *, ...);
    
       The rationale explained in the header is that using a vararg is
       incorrect and has a potential to change the ABI slightly do to compiler
       optimizations taken and the undefined behavior. They decided
       to specify the exact number of parameters and for compatibility with old
       code decided to make the signature require 3 arguments. The third
       argument is ignored for cases that its not used and its recommended to
       supply a 0.

commit bbc8c20a2daf7c1febf970ab8c4a66fff51727c5
Author: Margaret Lewicka <margaret@meaningless.name>
Date:   Thu Feb 12 17:28:47 2015 +0000

    builder: Check HAVE_POSIX_FADVISE before using it

commit 5809a5a802f4999d759e247eec5bbdf664835e80
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 12 16:35:46 2015 +0000

    aarch64: builder: Add script for building Fedora aarch64 images.

commit a0892aa29e92bc906a011faca84befe58f0265bc
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Feb 12 15:07:58 2015 +0100

    ocaml: hide internal methods from apidocs

commit 3dff1582d46866b153545f980e3273f4565077a2
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Feb 12 13:53:10 2015 +0100

    actions: fix a couple of docs references

commit 8c91a68b804f8385b6f26a3b0343d6e351447cd6
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Feb 12 10:32:25 2015 +0100

    gobject: generate deprecation markers
    
    Generate proper deprecation markers for API documentation and
    introspection annotations.

commit ab8a442952b53a32bf5a953b945fc7036320064a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 11 17:03:05 2015 +0000

    Version 1.29.25.

commit fb24d7405a3b86a21e007c471f1a9abf520265c1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 11 15:30:55 2015 +0000

    tests/charsets: Fix bogus comparison of STRNEQ() == -1.
    
    gcc 5 rightly flags this code as bogus.

commit e15722606442f6e3e960026bcc64f62081fe48f3
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Feb 11 15:46:19 2015 +0100

    java: further <p> fixes
    
    javadoc's HTML parser seems more limited, so just close <p> blocks
    before opening <pre> or <ol>.
    
    Followup of commit f4186a7a492f94661cf367684af3c54e21700afc.

commit 3b8d56d491d657e5c1377329d1212188e77fa2a2
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Feb 10 17:28:01 2015 +0100

    php: add a simple bindtests test
    
    Generate a simple bindtests test for the PHP binding, so it is possible
    to easily test all the argument types.
    
    Unlike the bindtests for other languages, optional arguments are not
    tested, due to the limitations of optional arguments in PHP (or maybe
    they way we implement them).

commit 2b06c27fd76eb2d18a3c1287ed5dfaa80aab4816
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Feb 10 16:09:57 2015 +0100

    php: fix memory leak in OStringList optargs
    
    Make sure to free the char** created to convert the arguments.

commit 8e4bf5cf9e5ab5ec5d9b129450e7dd5cfa2a4117
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Feb 10 15:39:14 2015 +0100

    php: fix invalid memory access with stringlist params
    
    Make sure to copy the strings we add to the char** array, otherwise they
    are stale pointers which we'll try to free later.
    
    Also, properly destruct the temporary zval.

commit ee65fabd973d50f983f22c794e69e4204ed44d7d
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Feb 10 16:04:06 2015 +0100

    php: move common code in helper functions
    
    Simple code motion.

commit 4debb44a44db5a2be6b110a1a6df2002a70bc4bf
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Feb 10 15:32:59 2015 +0100

    php: fix invalid memory access with OptString
    
    OptString maps to a "s!" argument, which makes zend_parse_parameters not
    touch the variables (char* and length) when NULL is passed as parameter.
    Hence, set both to NULL/0, and check for non-NULL char* variable before
    checking its length.

commit 85b6b5e589bea56046b85a5b0143a364e20dacd1
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Feb 10 15:10:34 2015 +0100

    java: add @Deprecated annotation for deprecated methods

commit f4186a7a492f94661cf367684af3c54e21700afc
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Feb 10 14:58:20 2015 +0100

    java: fix/improve slightly the javadoc
    
    - use <p>..</p> for text paragraphs, instead of just using <p> to
      separate them
    - slightly improve the metadata in eventToString and set_event_callback
    - fix the textual @see in set_event_callback, so it is accepted also in
      JDK 8
    - escape the doc text, so &, <, and > will not be considered as HTML
      tags but actual text
    - use the @deprecated tag instead of adding the customary deprecation
      note to the doc text

commit 8b268bd8970e183d765850fac09386cc2d32dadc
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Feb 10 14:22:14 2015 +0100

    generator: add a simple HTML escaping function

commit 4905d6eb95643c34ac29dfeb09876280f6dabf8d
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Feb 11 15:02:09 2015 +0100

    Revert "java: Turn off doclint to prevent errors on JDK 8"
    
    The errors will be fixed for good, together will other small javadoc
    improvements.
    
    This reverts commit 8940b03658e9e68adfea03dfd1044addd64d3d7a.

commit 28462caacc07cb10fe0afb3ec5c511b5f8aa98ec
Author: Margaret Lewicka <margaret@meaningless.name>
Date:   Mon Feb 9 11:06:18 2015 +0000

    macosx/bsd: Use getprogname() where available

commit 8940b03658e9e68adfea03dfd1044addd64d3d7a
Author: Margaret Lewicka <margaret@meaningless.name>
Date:   Mon Feb 9 11:06:17 2015 +0000

    java: Turn off doclint to prevent errors on JDK 8
    
    On JDK 8, doclint is enabled by default with strict validation of HTML
    tags, which causes the build to fail. See
    http://blog.joda.org/2014/02/turning-off-doclint-in-jdk-8-javadoc.html

commit 668c4784a999a9625debeb854e479a60d7228d68
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Feb 5 18:18:30 2015 +0100

    perl: tests: reenable set_path tests
    
    guestfs_set_path now does a copy of the passed string, so bindings don't
    need to take care of the lifetime of strings parameters for it.

commit 5cafedaa45d5993c54bf1827426171d9e23d77ae
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 7 16:27:03 2015 +0000

    lib: Change 'program_name' macro to avoid conflict with gnulib.
    
    The gnulib 'error' module uses 'program_name'.  On some platforms --
    but not Linux / glibc -- it references it as:
    
      extern char *program_name;
    
    This means when you compile libguestfs on non-glibc (eg. Mac OS X)
    gnulib requires 'program_name' as an external string reference, which
    we don't provide.
    
    This change doesn't define this string reference for gnulib, but it
    does change the name of the macro we use to avoid conflicts if we
    eventually need to export 'program_name' as a string.
    
    Thanks: Margaret Lewicka

commit 7ddf6bcbfdc66855b594afaaacdc4998177f2286
Author: Margaret Lewicka <margaret@meaningless.name>
Date:   Fri Feb 6 10:01:28 2015 +0000

    macosx: Include <sys/un.h> and define SOCK_* for Mac OS X.

commit eaae0b614c59f799885ee940117c4fb507a1f2d3
Author: Margaret Lewicka <margaret@meaningless.name>
Date:   Fri Feb 6 09:53:45 2015 +0000

    macosx: ruby: Use correct dllib extension instead of assuming '.so'.

commit f630677c14c7d5528e1ab39e4f805e0957b2ee3e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 5 08:13:05 2015 +0000

    resize: Preserve GPT GUID so we don't break EFI bootloaders (RHBZ#1189284).
    
    When copying disks that use EFI, we created a new partition table,
    randomizing the GPT GUID of the first partition.  Since EFI may store
    the GUID in its NVRAM variables, this could make the guest unbootable.

commit 40c133b2c81666f6dde43704e66bf59206d5c111
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 5 08:08:06 2015 +0000

    New APIs: part-set-gpt-guid and part-get-gpt-guid
    
    In GPT, each partition has a GUID assigned randomly.  Allow this GUID
    to be written and read.
    
    Note this is different from the GUID type code which is used to
    identify the type of the partition.

commit b3e3750b13a96fb6d1b79f7c0dabb4eeb37de5ef
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 5 08:01:48 2015 +0000

    daemon: Fix whitespace.

commit ff1cf989fd49cfb82db428e66034c7b2d6bebe8a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 4 13:17:40 2015 +0000

    builder: Fix large performance regression in pxzcat (RHBZ#1188866).
    
    Commit 9135129b0f6e8eb171131ea0f7d729a960b74cb3 changed
    two stack buffers to pointers:
    
    -  uint8_t buf[BUFFER_SIZE];
    -  unsigned char outbuf[BUFFER_SIZE];
    +  CLEANUP_FREE uint8_t *buf = NULL;
    +  CLEANUP_FREE uint8_t *outbuf = NULL;
    
    but we were still using sizeof buf to calculate the size of the
    buffer.  sizeof buf == 8 so the original code which used large buffers
    for reading/writing the file changed to using 8 byte buffers.

commit 5f663c2082446f2b9722c3cb0fcac6c5778978e8
Author: Cédric Bosdonnat <cbosdonnat@suse.com>
Date:   Tue Feb 3 14:38:02 2015 +0000

    customize: Invoke zypper correctly.

commit 8fd42310514166d287b9149bc8747e6a058433bf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 3 08:53:43 2015 +0000

    btrfs: Proper error when output of 'btrfs qgroup show' command cannot be parsed.
    
    sscanf doesn't set errno in these cases so it's wrong to call perror
    here.
    
    This fixes commit 2b7f7810ed801edf811c5ba43fefe6cf350def7f.

commit 725d95422bbd12cd59c860286ee84cf30d402a55
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 2 20:01:45 2015 +0000

    Version 1.29.24.

commit 573fe962b986e90584afa71aa3e9d9d4448190da
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Feb 2 15:44:43 2015 +0100

    customize: add copy-in operation (RHBZ#1135585).
    
    Add the copy-in operation to virt-customize/builder/sysprep, so it is
    possible to easily copy directories at once in the guest.

commit 5efce8c56d29f3c85d25396eba09fec39a86b708
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Feb 2 15:44:42 2015 +0100

    fish: use copy-in and copy-out
    
    Simply the copy-in & copy-out commands of guestfish using the new
    implementations of copy-in & copy-out in the library.

commit fb9bc908f87c82d4dedb339c1292f7a2ee816630
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Feb 2 15:44:41 2015 +0100

    New APIs: copy-in and copy-out
    
    Currently implemented as guestfish commands, provide them instead as
    single source -> destination functions for the library, so they can be
    used also in other places.
    
    These functions are not added to guestfish, since guestfish has its own
    implementation (which will soon switch to call copy-in and copy-out for
    multiple paths).

commit 8aadde50b362ce5e2287c0ffe98f3033229f2846
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Feb 2 15:44:40 2015 +0100

    generator: add VPublicNoFish visibility type
    
    Usable to have public functions, i.e. like VPublic, but do not showing
    them in guestfish.

commit db055262d4a859cf5d38fef235a117e1fd0b7aff
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Feb 2 15:44:39 2015 +0100

    cmd: add the possibility to get a fd to the process stdin
    
    Add the possibility to forward to the stdin of the process, and get the
    fd for it; only in async mode for now.

commit 449fab3ed1a3c126a7208eb0743e077f478f0a9b
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Feb 2 15:44:38 2015 +0100

    cmd: add a child-setup callback
    
    Easy way to do pre-exec setup in the child process.

commit c5d3d198dcbceac928f430e2a9450ca58d6c0890
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Feb 2 15:44:37 2015 +0100

    cmd: add a way to run (and wait) asynchronously commands

commit 4bb3c44a286beb0dd8cdf337d64d8ce71e361dd6
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Feb 2 15:02:31 2015 +0100

    sparsify: ignore read-only devices
    
    In copy mode, make sure to not zero-free-space devices mounted as
    read-only, as we cannot write to them.
    
    Related to RHBZ#1079625.

commit 864c2ee371f65388b18e737136663986cfc9eb08
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Feb 2 14:50:52 2015 +0100

    sparsify: ignore read-only btrfs snapshots (RHBZ#1079625)
    
    In copy mode, make sure to not zero-free-space read-only btrfs
    snapshots, as we cannot write to them.

commit 8d83f57799c5e542e7295d1b03a36ebb9737d90a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 28 14:19:19 2015 +0000

    sparsify: Ignore read-only LVs (RHBZ#1185561).

commit 7d784fb9c90038e94761d9ea928b1c12d62625e9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 28 14:18:48 2015 +0000

    mllib: Add function for comparing LVM2 UUIDs, ignoring '-' characters.

commit ab950f8290b681e5ca53c4fa9377b18f50b9b86e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 28 14:17:51 2015 +0000

    mllib: Add a better List.assoc function.
    
    You can specify what comparison function is used; and instead of
    having it raise 'Not_found', it returns a ~default value.

commit 83eea0b197aed3b303fb7e986af7f4270e6cecde
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Jan 29 12:00:32 2015 +0100

    tests: don't add test-dlopen twice
    
    test-dlopen needs to be added only when libdl is available, and it is
    like that already (within if HAVE_LIBDL); hence don't unconditionally
    add it as well.

commit e57ed7cd3468b1c099571eae20ba27c35cdc911a
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Jan 29 12:00:01 2015 +0100

    build: use libintl where needed
    
    Followup of commit a5426cce5faa0fde0de1b62c8646cb8a9992ef2b.

commit 2313f28895274b0ebea4b76c75473530edd3a77e
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Jan 28 14:37:14 2015 +0100

    daemon: parted: use --part-type with recent sfdisk
    
    Check whether --part-type is supported (in the rewritten sfdisk in
    util-linux >= 2.26), and use it instead of --print-id & --change-id.
    
    The actual result should be the same, just not using a (recently)
    deprecated command line API.

commit 6a195d0f9565ad0e6e46f3e9904a6dea129e59f4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 28 13:28:37 2015 +0000

    v2v: -i ova: Make error message "unsupported file format" clearer.
    
    Thanks: Moran Goldboim

commit 282a13167779c74feac6ad4bb69fbdbd3449a4ae
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jan 27 18:35:58 2015 +0100

    customize: handle Arg.Set parameters in commands file
    
    When reading commands from a file, handle also Arg.Set parameters, so
    they can be enabled as well.

commit d0cecca27217c970cb11ec140cb56a34f4328f0c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 26 17:15:30 2015 +0000

    Version 1.29.23.

commit d6cfd24feb08ec9a2f8aa14736724f8330c5480d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 26 17:14:53 2015 +0000

    .gitignore: Ignore mllib/oUnit-anon.cache file from oUnit.
    
    This updates commit d19eb31060e49d5631a7deb40bebf3886836b0a9.

commit d0a2ba40c8f8aa610dc4a30ee0b2cdde0187682f
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Jan 26 16:34:59 2015 +0100

    mllib: fix JSON_tests
    
    Properly write int64 values, so they are handled correctly also on 32bit
    architectures.

commit 889e55516869d1eadcdeae15e38dd8d3bbca8d20
Author: Shahar Havivi <shaharh@redhat.com>
Date:   Mon Jan 26 12:13:49 2015 +0200

    v2v: -o vdsm should assume data domain at -os path
    
    Unlike -o rhev which have only one data domin, -o vdsm can and usually
    does have multiple data domain.
    The path to vdsm is pre mounted so no need to assume nfs path with -os
    Example:
    -o vdsm -os /rhev/data-center/<data-center-uuid>/<data-domain-uuid>
    
    Bug-Url: https://bugzilla.redhat.com/1176591
    Signed-off-by: Shahar Havivi <shaharh@redhat.com>

commit c24f242521e882380c28d0952007d8462040d998
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 24 15:40:05 2015 +0000

    aarch64: Increase default appliance memory size on aarch64.
    
    Kernel 3.19 has problems uncompressing the RAM disk with <= 500 MB.
    (This is likely to be a kernel bug)
    
    64 KB pages are common on aarch64, so treat this case the same as ppc,
    and use a larger default appliance memory size.
    
    Thanks: Laszlo Ersek for help and reproducing the bug.

commit 987273ebd019dbc63a87922db2807feb5743290b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 24 08:47:00 2015 +0000

    launch: libvirt: When debugging the appliance dir, use 'ls -R'.
    
    Since libguestfs >= 1.26 / supermin 5, the appliance has lived in a
    subdirectory of $TMPDIR/.guestfs-$UID.  As a result using 'ls -l'
    didn't display any information about the files in the appliance.
    
    Using '-R' causes this information to be displayed again.

commit f9c5b4aa2a6e8890eb20e15165bbe6820e6011b5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 24 08:45:48 2015 +0000

    launch: libvirt: In debug messages use ls --lcontext instead of ls -Z.
    
    ls -Z stops ls from displaying the size field.  --lcontext uses longer
    lines but has the advantage of still displaying the size field as well
    as the SELinux context.

commit b6cd5c3a2b5c35512599a63b420069bf5d9667fb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 23 13:29:25 2015 +0000

    p2v: Add NetworkManager in the hope of getting working network.
    
    I know "working network" and "NetworkManager" are oxymorons, but
    sometimes we have to live in hope.

commit 9638b13ba00aa088e2bd56143b145fe689c99bef
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 23 12:16:31 2015 +0000

    p2v: Set root password of virt-p2v ISO to 'p2v'.
    
    It is documented as 'p2v', but in fact this was not implemented
    so there is no way to log in as root on the console.
    
    On RHEL we also have to add the 'passwd' package, else you get:
    
      Error creating Live CD : Unable to set unencrypted password due to lack of /usr/bin/passwd

commit 515c3e3e73f7961d1d21b209d14b7fd7067a3b06
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Jan 23 14:15:09 2015 +0100

    mllib: do not show --short-options among the long options
    
    --long-options is ignored because it is only meant as aid for shell
    completers, so --short-options should be too for the same reason.

commit 6bc9976886df1269173b4001844e781cd87309a0
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Jan 23 11:23:35 2015 +0100

    mllib: add simple tests for the JSON module

commit 6f14cae1ba932fe7c583a05b82d1dfe534909c8a
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Jan 23 11:08:27 2015 +0100

    mllib: tests: add tests for string_lines_split

commit d19eb31060e49d5631a7deb40bebf3886836b0a9
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Jan 22 18:33:07 2015 +0100

    mllib: convert common_utils_tests to oUnit
    
    Covert common_utils_tests to use oUnit as testing framework, replacing
    the hand-made assert in favour of structured unit tests and better
    error reporting.
    
    common_utils_tests is now built only when the oUnit module has been
    found.

commit 1f5e525533f1f2d8c6f1f5cfe21271c0885dc6b5
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Jan 22 17:39:23 2015 +0100

    configure: look for the oUnit OCaml module
    
    It will be used for the OCaml unit tests.

commit eda41268689f824901d6c209ffd91c27ce9695b9
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Jan 22 17:07:02 2015 +0100

    customize: add --commands-from-file
    
    Pass to --commands-from-file the name of a file containing customization
    commands in each line, as if they were specified as command line
    arguments.
    
    This eases the reuse of commands among different
    builder/customize/sysprep invocations.

commit 09f76fd2a9a699df5f72f3a8b1955b158b574e56
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Jan 22 17:05:30 2015 +0100

    mllib: add string_lines_split
    
    Introduce an helper function to split a text into lines, keeping into
    accout continuation lines (i.e. with \ at the end).

commit 145db4f62995b3366cde58d58ed49ed491c3ccc3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 22 10:44:32 2015 +0000

    test: fuse: Add debugging of commands run in the test.

commit 34b118a25a726e30efddee94947e84d2b5a5c26c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 21 20:45:17 2015 +0000

    Version 1.29.22.

commit d4c8433e6e6525c9b83e28878c412c17c7b2aece
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Fri Jan 16 10:23:47 2015 +0800

    New API: add btrfs_rescue_super_recover
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit 15c75eaace30d6c8786532482eb040071a3f28ec
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Fri Jan 16 10:23:46 2015 +0800

    New API: add btrfs_rescue_chunk_recover
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit e32b59c926eb480913140a57e1ec501cf44726b5
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Fri Jan 16 10:23:45 2015 +0800

    New API: add btrfs_filesystem_defragment
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit fd7df408d16a484f9d2607e1404aaccc44408fbb
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Fri Jan 16 10:23:42 2015 +0800

    New API: btrfs_balance_resume
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit a72204bde771fdd1016fb00b4be59af559cf2d02
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Fri Jan 16 10:23:41 2015 +0800

    New API: btrfs_balance_cancel
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit 9f11ddd29e6291445a8994d5bd89139c0e75ad78
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Fri Jan 16 10:23:40 2015 +0800

    New API: btrfs_balance_pause
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit 47f0336e09faf49ec68cdd389fc1a07907b43211
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Fri Jan 16 10:23:39 2015 +0800

    btrfs: replace "btrfs filesystem balance" with "btrfs balance"
    
    "btrfs filesystem balance" is deprecated in favor of "btrfs balance".
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit 9e6122265edc287f70217dc159362b17af7f6d71
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Fri Jan 16 10:23:38 2015 +0800

    New API: btrfs_scrub_resume
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit 55bfd127d4ef6a83e042db58369075e12ee668ef
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Fri Jan 16 10:23:37 2015 +0800

    New API: btrfs_scrub_cancel
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit a4d6cc525a1406d76873e9e4605ae37f21a11b56
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Fri Jan 16 10:23:36 2015 +0800

    New API: btrfs_scrub
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit 7e4b7a346a4558a02aeb58f82d518509ce6e5d03
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 21 05:37:56 2015 -0500

    aarch64: launch: libvirt: As a workaround, pass -cpu parameter to qemu.
    
    When libguestfs is running using TCG on aarch64, we need to pass the
    -cpu cortex-a57 parameter to qemu.  Libvirt doesn't let us do this,
    complaining "Unable to find CPU definition".
    
    As a temporary workaround only, use <qemu:commandline> to pass this
    argument directly to qemu.  When libvirt is fixed we can remove this
    hack.
    
    This is a workaround for libvirt bug RHBZ#1184411.
    
    See:
    https://www.redhat.com/archives/libvirt-users/2014-August/msg00043.html
    https://bugzilla.redhat.com/show_bug.cgi?id=1184411

commit 7dc837c7be84936690f4f613fea82dba4787ceec
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 21 05:10:37 2015 -0500

    aarch64: appliance: Use AAVMF (UEFI) if available for running the appliance.
    
    AAVMF is an open source UEFI implementation for aarch64 based on OVMF.
    As aarch64 is heading for requiring UEFI even inside guests, if the
    AAVMF firmware is installed on the host, use it as a hint that we
    should boot the guest using AAVMF instead of the default "empty
    machine".
    
    Note this requires very recent AAVMF, libvirt, qemu.  However that's
    OK since it's only applicable to aarch64.  On non-aarch64, this patch
    does nothing.
    
    Thanks: Laszlo Ersek for a lot of help getting this right.

commit cb0c2c33576aa601e308c6bf53b9d989dc6f62fc
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jan 20 16:23:12 2015 +0100

    launch: libvirt: do not leak the backend string on error
    
    Make sure to free the backend string after using it.

commit bff99cec4df3916f2fc33e628223cdd3df2c3829
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jan 20 14:35:36 2015 +0100

    fish: remove extra "prompt" checks
    
    The code is already within a "if (prompt) {...}" block, so checking for
    "prompt" again is redundant.

commit 7618e41d33e731f6392d783510705492cbf82eef
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jan 20 14:09:36 2015 +0100

    daemon: readdir: fix invalid memory access on error
    
    If "strdup (d->d_name)" fails with "i" > 0, then both "p" and
    "ret->guestfs_int_dirent_list_val" are non-null pointers, but the latter
    is no more valid (since "p" is the new realloc'ed buffer). Hence, trying
    to free both will access to invalid memory.
    
    Make sure to free only one of them, "p" if not null or
    "ret->guestfs_int_dirent_list_val" otherwise.

commit 0eedddad2f02d687c58d5875d258ace1417885f1
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jan 20 16:08:38 2015 +0100

    fuse: test-fuse: free "acl_text"
    
    Make sure to free the buffer returned by acl_to_any_text.

commit 91c34ff8ff59a45accf179394257e36cff6a30e9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 20 09:42:12 2015 +0000

    p2v: Fix wait_qemu_nbd to use getaddrinfo.
    
    wait_qemu_nbd would fail in Rawhide where /etc/hosts contains:
    
      127.0.0.1   localhost [...]
      ::1         localhost [...]
    
    This peculiar mapping caused qemu-nbd to always select an IPv6
    address.  However since we used the obsolete inet_pton function and
    forced AF_INET, we were always trying to connect to the IPv4
    localhost.
    
    As this was never going to work anyway, fix the code to use
    getaddrinfo to resolve "localhost", and use a loop to connect to all
    possible addresses.
    
    Also: Add a short sleep in the reconnection loop so that we don't
    hammer the qemu-nbd server while it is starting up.

commit 0b54e111e42a4433064a4167f29081d870cb0ad7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 20 07:58:34 2015 +0000

    p2v: Move debug message earlier.
    
    This ensures we can see the port numbers even when the
    connection fails.

commit 3ca0ce45af50da5322087b4d4faf5b7c5a7773c7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 20 07:45:18 2015 +0000

    p2v: Correct garbled comments in test script.

commit f45b6928c5339321dc99ef66ca9fe93e10e1580d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 20 07:35:11 2015 +0000

    aarch64: python: Skip test that requires IDE.
    
    This test launches a dummy guest using IDE.  Aarch64 doesn't support
    IDE, and because it also doesn't support PCI (virtio-mmio instead)
    it's hard to formulate libvirt XML that will work on both x86 and
    virtio-mmio.
    
    Since this bug is not architecture specific (RHBZ#912499), skip it on
    non-x86.  The test will print:
    
      skipping test: arch is not x86 and does not support IDE

commit 9bf6f7f0561507e9d90fe95c2f37e9227e0bcea6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 19 19:19:12 2015 +0000

    Version 1.29.21.

commit cfc142399f78200f520768b111a1fa7178aee305
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Jan 19 16:20:44 2015 +0100

    gobject: fix printf conversion specifier
    
    Use PRIu64 to correctly handle uint64_t.

commit 52528729f6484897c42c899f5ab4fd6cbcd1eabe
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 19 16:05:41 2015 +0000

    gcc5: test-tool: Initialize local variable.
    
    gcc 5 cannot prove that the variable is always initialized
    and therefore prints a warning.

commit fceab826471e352fcfea17ac5bf6cdd60435e510
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Jan 19 15:58:36 2015 +0100

    build: check for single libsystemd before libsystemd-journal
    
    Since systemd 209, all the functionalities of the former libsystemd-*
    (including libsystemd-journal) have been merged into a single
    libsystemd, with the former libraries left as compatibility ones.
    
    Thus, first look for libsystemd, and if not found try again with the
    libsystemd-journal as used before.

commit 1709263613ac97cb1f37333e1a429c34f6b79f26
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Jan 16 19:25:26 2015 +0100

    sparsify: handle output filenames with ':'
    
    With commit a594b7f90a682e2a9327b142138edb76ad8ba8ff the checks for
    input and output files with ':' were removed; while the input file is
    handled correctly by the disk_create API, an output filename with ':'
    could still be handled as specifying a transport, failing the last
    "qemu-img convert" call.
    
    Use the new qemu_input_filename helper to handle the output filename
    correctly.

commit c796280a8ee45c223a184b956423c55e3af68d81
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Jan 16 19:19:16 2015 +0100

    mllib: add simple qemu filename sanitizing function
    
    It mimics a bit in OCaml the logic used in
    commit a95214b1985e694946e3426120a6fdc13a3f081f (for the main library)
    and commit 588af1953e5f7ab74009b9175cc5d3efb8bb651a (in disk-create),
    so in OCaml tools direct calls to qemu/qemu-img with filenames provided
    by the user can properly handle filenames with e.g. ':'.

commit 8b9ca28e111e38eafe8db7265e7fe18c5f31b460
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Jan 15 14:40:17 2015 +0100

    mknod: filter modes in mkfifo, mknod_b, mknod_c (RHBZ#1182463).
    
    Since mkfifo, mknod_b, and mknod_c add the correct file type to the
    modes of the resulting file, make sure the specified mode contains only
    permissions bits.

commit 8ad667f1983e98347f4d292c07f971d5362ff052
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Jan 14 18:59:57 2015 +0100

    daemon: use ntfslabel(1) to get ntfs labels
    
    blkid(1) (or actually, libblkid) seems to handle filesystem labels up
    to 127 characters. Considering that btrfs labels can be up to 128
    characters, this means long labels are not read correctly (i.e. get
    truncated) by blkid.  Furthermore, ntfs labels are actually unicode,
    and libblkid seems to not decode them correctly.
    
    Hence, if ntfsprogs is available invoke `ntfslabel` to get the label
    of ntfs filesystems.
    
    Related to RHBZ#1164708.

commit 6db3c100e7c18820ff9ecc22415940eb5fedc64e
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Jan 14 18:55:13 2015 +0100

    daemon: use btrfs(1) to get btrfs labels
    
    blkid(1) (or actually, libblkid) seems to handle filesystem labels up
    to 127 characters. Considering that btrfs labels can be up to 255
    characters, this means long labels are not read correctly (i.e. get
    truncated) by blkid.
    
    Get the filesystem type, and if btrfs is available invoke
    `btrfs filesystem` to get the label of btrfs filesystems.
    
    Related to RHBZ#1164708.

commit d7abf5c8f2b9c0895faaa3166eb3a3f72ede17a2
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Jan 9 18:57:24 2015 +0100

    format, make-fs: specify the label on mkfs
    
    If specified, pass the label for the new filesystem directly to the
    mkfs (or mkfs_btrfs) call.
    
    This saves one set_label call, mostly.

commit 7723614a91ad0179c190613fbb277f1c71dc88fd
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Jan 9 18:56:28 2015 +0100

    mkfs: add 'label' optional argument
    
    Add the 'label' optional argument to the mkfs action, so it is possible
    to set a filesystem label direct when creating it. There may be
    filesystems not supporting changing the label of existing filesystems
    but only setting it at creation time, so this new optarg will help.
    
    Implement it for the most common filesystems (ext*, fat, ntfs, btrfs,
    xfs), giving an error for all the others, just like set_label does.

commit 19c09bcdee62f86f78c6338de0ccddc3bce4d955
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 19 15:00:57 2015 +0000

    tests/lvm: Remove use of deprecated sfdiskM API.
    
    See: https://bugzilla.redhat.com/show_bug.cgi?id=1183236
    for the sorry tale.

commit eb85ac6a0def18cd7dd5c3bda97c5775c0ba34a8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 19 13:03:24 2015 +0000

    valgrind: Remove suppression for fixed memory leak in libselinux.
    
    This memory leak has been fixed since libselinux 2.1.13.
    
    Thanks: Daniel Walsh

commit 4f3c288a1bac741fbcc9a8cd790d30618093a03e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jan 18 07:38:58 2015 +0000

    lua: Define luaL_checkint which was deprecated in lua 5.3.

commit 5ab3a75e1dba7cacd45ff9a094bf27c517edd117
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 17 14:24:35 2015 +0000

    tests/lvm: Allow test-lvm-mapping.pl to be skipped.

commit 9d9ef2960cf4da913277c6bf5f8443f661112186
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 17 09:02:37 2015 +0000

    Version 1.29.20.

commit c5800dc97d7e197ed187d3c5bb4d9a1f49ecf6ef
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 17 09:08:08 2015 +0000

    Update copyright dates for 2015.

commit 378ed3be5e8fffbd45df785fee68b6862eb55398
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 1 06:11:39 2015 +0000

    ocaml: Convert debug_logging example from C to OCaml.
    
    Continue gradual conversion of C examples to other languages.

commit 4bd0d1704756ab0bb8438078229b1a6848d2bad6
Author: Kashyap Chamarthy <kchamart@redhat.com>
Date:   Tue Jan 13 19:31:09 2015 +0100

    virt-buider: doc: Use osinfo-query to get OS variants
    
    Upstream dropped[1] support for '--os-variant list' in favor of using
    `osinfo-query` tool provided by the libosinfo project.
    
    To get a list of all accepted operating systems, invoke:
    
      osinfo-query os
    
    [1] https://git.fedorahosted.org/cgit/virt-manager.git/commit/?id=bcb60f0

commit ea761df6875b2fa7fd9fcd3bc4c5b43812a426dd
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Jan 9 11:14:35 2015 +0100

    builder: export the "osinfo" attribute to json
    
    Thanks to: Federico Simoncelli.

commit 4f51519c9feaba5a0da9e43886415bb32dcc2049
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Jan 7 15:07:07 2015 +0100

    ocaml: findlib is required when building from git
    
    Update README according to the current requirement.
    
    Thanks to: Gabriele Cerami.

commit e6f77d23453ffe3cb0b215c88d83082ba2df8986
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Sun Dec 28 08:33:30 2014 +0100

    Fix out-of-tree build: Don't create empty .y file in builddir

commit 14d11916faf68afb672d1626348931f2b90afd08
Author: Shahar Havivi <shaharh@redhat.com>
Date:   Thu Dec 25 11:57:12 2014 +0200

    v2v: adding --vdsm-ovf-output option
    
    This option is needed by vdsm for writing the ovf to a specific directory.
    The default is current directory.
    
    Bug-Url: https://bugzilla.redhat.com/show_bug.cgi?id=1176598
    Signed-off-by: Shahar Havivi <shaharh@redhat.com>

commit 3a080c3fbffa5846f71528c6fd978be7853b33b8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 24 18:10:37 2014 +0000

    v2v: Reduce use of polymorphic variants.
    
    Ordinary variants prevent coding errors.

commit 70c28f3d5e9cb90a7d1124b5cf61e72809d327b3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 24 17:46:08 2014 +0000

    v2v: -i libvirtxml: Only handle NBD source with host 'localhost', for virt-p2v.
    
    We only care/support virt-p2v for network disks.  Give a warning about
    anything else.
    
    This avoids a potential quoting issue.

commit 45bd4f604d461e5acd753d485ea02fa8813da37e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 24 17:05:39 2014 +0000

    v2v: Update TODO.

commit c5e11785afd03bc3d9f9f23ab4590e4a08ede9d2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 24 16:51:15 2014 +0000

    v2v: DOM: Fix quoting of XML comments.
    
    We need to quote at least & and > in XML comments.

commit 86a08d860af4b0f914cc18d6308891ab0bb26106
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 24 13:34:26 2014 +0000

    v2v: Hide implementation of 'element'.
    
    Following the previous commit, the implementation of 'element'
    does not need to be public.

commit 47b54a7ba5a49af33a08d47b284c664695c523ea
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 24 13:32:18 2014 +0000

    v2v: Move append_* functions to DOM module.
    
    Just code motion.

commit 791db53b104da3a5c8c28ca4ef57db1aa7ee2f50
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 23 15:25:26 2014 +0000

    Version 1.29.19.

commit 29df51d9bc24eaae9e42c3794b7dac9c78d8b3bd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 23 15:29:26 2014 +0000

    v2v: Add a note about escaping username like DOMAIN\user.
    
    Thanks: Ben Hooper.

commit 91b5863a7d4d0001d864b46045e6e2958ee159d4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 23 06:27:18 2014 -0500

    aarch64: builder: Silence gcc warnings from flex-generated code.

commit fdf6221f33f40e3cc702ddb5f5d2557ffedd03bf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 21 18:47:30 2014 +0000

    fish: c-pointer: Print the pointer in hexadecimal.
    
    $ guestfish
    ><fs> c-pointer
    0x1fb4f80
    
    This updates commit d8c43d556b45f4c9676fdbfce0e9fe07b709635a.

commit 92575d0eabadd77a39a38d272c5e759cd6c61be3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 19 19:38:37 2014 +0000

    errors: Even clearer error message.
    
    Obviously no one reads the FAQ, so make the error message
    even clearer.
    
    The new error messages are variation on this:
    
    libguestfs: error: /bin/false exited with error status 1.
    To see full error messages you may need to enable debugging.
    Do:
      export LIBGUESTFS_DEBUG=1 LIBGUESTFS_TRACE=1
    and run the command again.  For further information, read:
      http://libguestfs.org/guestfs-faq.1.html#debugging-libguestfs
    You can also run 'libguestfs-test-tool' and post the *complete* output
    into a bug report or message to the libguestfs mailing list.

commit f6e74ecd73d9aeeb4c9ef0044d7112645b09172f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 18 10:59:15 2014 +0000

    ping-daemon: Fix error in the description of this API (RHBZ#1175676).
    
    Thanks: Lingfei Kong

commit 47d909808aa8cd285f46cab5ea08c7971f8f2f85
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 18 08:30:18 2014 +0000

    v2v: -o libvirt: Replace List.mapi with mapi.
    
    Don't depend on OCaml >= 4.00.
    
    https://bugs.gentoo.org/show_bug.cgi?id=532698
    
    Thanks: Fabian Ohler

commit 045dcfbd1848cb1c591dafe962d9bed45c1a9879
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 15 14:51:57 2014 +0000

    v2v: Treat "oraclelinux" as if it was plain RHEL (RHBZ#1174280).

commit f1ecd6af808f22af913a589754ae11dc1e35b658
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 17 13:02:06 2014 +0000

    fish: Add regression test for RHBZ#1175196.

commit 5f6677ebd0fd6f6712de808ca27eab4468f966bc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 17 12:52:46 2014 +0000

    environment: Use guestfs___is_true when parsing various boolean environment variables (RHBZ#1175196).
    
    You can now use LIBGUESTFS_DEBUG=true (etc.)
    
    You can disable debugging/tracing by setting LIBGUESTFS_DEBUG=0 (etc.)

commit bdcd2fabe9a5ba6f61e662986fcd92e352f203c0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 17 12:34:53 2014 +0000

    fish: Move 'is_true' function to library utilities.
    
    The 'is_true' function can be useful elsewhere, not just for parsing
    guestfish command parameters.
    
    This is just code motion.

commit d375b7818a506e011b5f61c9a42c801180636201
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 17 14:37:55 2014 +0000

    v2v: -o qemu: Replace List.iteri with iteri.
    
    So we don't have to depend on OCaml >= 4.00 which is when this
    function was added to the stdlib.
    
    https://bugs.gentoo.org/show_bug.cgi?id=532698

commit abf51ec70b3edfcb5048ef209a1a3b1837aa06e5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 17 10:25:57 2014 +0000

    is-blockdev: Clarify documentation (RHBZ#1175035).

commit 1f7db85b30d27ccdbb674dc9ee111db6756b59ae
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Dec 16 15:52:32 2014 +0100

    builder: recommend use of --selinux-relabel
    
    Add a small documentation paragraph in the "SELINUX" section
    recommending the usage of --selinux-relabel for guests using SELinux.

commit 6264c255d461b2c84a9693c09a807d18cdf0b348
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 16 13:25:35 2014 +0000

    Version 1.29.18.

commit 8e0fc5fb469cdb67eb82e61036749f7d114e2c6f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 16 13:16:07 2014 +0000

    python: Fix regression test so it works when KVM is not available.
    
    The test assumed (for no particular reason) that it could always run a
    KVM guest.  When run on a machine without KVM, or in a VM without
    nested KVM, you get this error:
    
    libvirt: Domain Config error : internal error: no supported architecture for os type 'hvm'
    Traceback (most recent call last):
      File "./t/820-rhbz912499.py", line 77, in <module>
        dom = conn.createXML (xml, libvirt.VIR_DOMAIN_START_AUTODESTROY)
      File "/usr/lib64/python2.7/site-packages/libvirt.py", line 3523, in createXML
        if ret is None:raise libvirtError('virDomainCreateXML() failed', conn=self)
    libvirt.libvirtError: internal error: no supported architecture for os type 'hvm'
    FAIL: ./t/820-rhbz912499.py
    
    Use a qemu guest instead, which should have a better chance of working
    on all hosts.

commit 974216f612256b19ce3918e0544120aa5fcef16c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 16 11:06:43 2014 +0000

    p2v: Document that virt-p2v-make-kickstart copies the virt-p2v binary into the kickstart.

commit 54f85f8482c2aef209da64da49cbd96c3140ec32
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 16 11:06:15 2014 +0000

    p2v: virt-p2v-make-kickstart(1): Fix various typos in the man page.

commit cf979dd7969032612b5bb05acb2211a6c0093cca
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 16 09:45:29 2014 +0000

    p2v: virt-p2v-make-kickstart: Add URL example to the man page.
    
    It turns out this is required for Fedora 21 (or perhaps livecd-creator
    is broken yet again, who knows).

commit 2912fa7a43b8f7fdc3f13b4e77041833413232f3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 15 22:45:35 2014 +0000

    Version 1.29.17.

commit 2162d09b2c9e138779d95f1fc7c3409765a5a40c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 15 22:26:51 2014 +0000

    Use -fno-strict-overflow throughout the build.
    
    Builds of bison-generated files currently fail with:
    
    index-parse.y: In function 'yyparse':
    index-parse.c:1256:6: error: assuming pointer wraparound does not occur when comparing P +- C1 with P +- C2 [-Werror=strict-overflow]
         if (yyss + yystacksize - 1 <= yyssp)
            ^
    
    This error only occurred on one machine, and it was unclear why.  It
    turned out to be because the other build machines I use had:
    
      CFLAGS="-Wall" ./configure ...
    
    whereas on the failing machine I was just using ./configure w/o CFLAGS.
    
    This caused the compile flags of index-parse.c to be changed from:
    
      gcc -Wstrict-overflow ... index-parse.c
    
    to:
    
      gcc -Wstrict-overflow -Wall ... index-parse.c
    
    but since -Wstrict-overflow is short for -Wstrict-overflow=2, and
    -Wall is short for -Wstrict-overflow=1, and since the error only
    occurs at level >= 2, using CFLAGS="-Wall" was effectively turned off
    the warning.
    
    Anyway, I believe the optimizations that GCC does when
    -fstrict-overflow is enabled to be dubious, frequently dangerous, and
    useless.  They are only done because we want C99 to work on
    architectures that don't exist in reality (and which even if they did
    exist, libguestfs would probably not support).
    
    The Linux kernel uses -fno-strict-overflow, and we should too, for the
    same reasons.

commit 8a33d534e55f9cb9c49d99a0104ecbf9dfd0bc99
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 15 18:29:00 2014 +0000

    Version 1.29.16.

commit 5a4fd83176a93d0190b7584d799c3236f5c2ba48
Author: Gabriele Cerami <gcerami@redhat.com>
Date:   Mon Dec 15 19:19:39 2014 +0100

    diff/diff.c: diff output to show correct file handles and presence symbol

commit 09080a28878a17b991c812e2b93a8d8394383d04
Author: John Eckersberg <jeckersb@redhat.com>
Date:   Mon Dec 15 13:19:06 2014 -0500

    p2v: avoid connecting to ourself while probing qemu-nbd (RHBZ#1167774)

commit f843abe400bc4e6fbcbee5f6cda2f3e9da33909a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 15 17:28:30 2014 +0000

    tests: Fix memory leaks in test-add-libvirt-dom.
    
    Found by valgrind.
    
    This fixes commit df9782ec3a12ac46e1b8ffa31630c7a1e64162fe
    and commit 96158d42f5cb9b6c472b4630f2c97edae600f6d3.

commit e74bd45111c94d5506f9f35792bff340e2ce1a29
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Fri Dec 12 15:03:33 2014 +0800

    New API: btrfs_qgroup_remove
    
    btrfs_qgroup_remove removes a qgroup from its parent qgroup.
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit bd4a114272d589335be92782bfb283d2ccad3433
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Fri Dec 12 15:03:32 2014 +0800

    New API: btrfs_qgroup_assign
    
    btrfs_qgroup_assign adds a qgroup to a parent qgroup.
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit 2b7f7810ed801edf811c5ba43fefe6cf350def7f
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Fri Dec 12 15:03:31 2014 +0800

    New API: btrfs_qgroup_show
    
    btrfs_qgroup_show shows all qgroups on a btrfs filesystem.
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit 3617938b4803f0871c8811b42f8a0b4c1969a424
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Fri Dec 12 15:03:30 2014 +0800

    New API: btrfs_qgroup_destroy
    
    btrfs_qgroup_destroy destroys a qgroup.
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit 1144c692dc8bca6bd51900a78e2e7f66b644a716
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Fri Dec 12 15:03:29 2014 +0800

    New API: btrfs_qgroup_create
    
    btrfs_qgroup_create creates a new qgroup.
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit a325f887b35618c141ea79b826b4bf9f64a644e2
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Fri Dec 12 15:03:28 2014 +0800

    New API: btrfs_qgroup_limit
    
    btrfs_qgroup_limit limits the size of a qgroup.
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit 4e145bb44d5d58a70fc4cc8b0c199c6c29e6482e
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Fri Dec 12 15:03:27 2014 +0800

    New API: btrfs_quota_rescan
    
    btrfs_quota_rescan trashs all qgroup numbers and scans the metadata
    again with the current config.
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit 29812b8fd6aca26b4a8601f40e8fd011830d134e
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Fri Dec 12 15:03:26 2014 +0800

    New API: btrfs_quota_enable
    
    btrfs_quota_enable enables or disables quota for btrfs filesystems.
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit 7a25a6d14115207d8c93cfbd7fe7f487b3c18d9d
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Fri Dec 12 15:03:25 2014 +0800

    New API: btrfs_subvolume_show
    
    btrfs_subvolume_show shows the detailed information of a subvolume or
    snapshot.
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit 56732ed6a08af7e3f7f1f17e89e8dc62cf3d4f4a
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Fri Dec 12 15:03:24 2014 +0800

    New API: btrfs_subvolume_get_default
    
    btrfs_subvolume_get_default is for getting the default subvolume of
    a btrfs filesystem.
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit 152d17ddbf7e6db4b3b23224083780fb979f28b5
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Fri Dec 12 15:03:23 2014 +0800

    daemon: btrfs: add helper functions mount and umount
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit d3e93e1011fa4bf0099c3c0538022bfd9c2473f2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 15 14:29:51 2014 +0000

    inspection: Recognise 'dnf' as the package manager in Fedora 22.
    
    Also fix virt-sysprep and virt-customize so they can work with dnf.
    
    I also sorted some of the lists alphabetically.

commit 7a218cbdf635af543479256593e448100406ea1e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 15 13:43:34 2014 +0000

    v2v: Password attr in domain XML should be 'passwd=' (RHBZ#1174123).

commit dfded7c94118e8888dec38f11c2af62d8156a59e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 15 08:55:12 2014 +0000

    v2v: Get passwords in domain XML (RHBZ#1174123).
    
    Thanks: Tingting Zheng

commit 9c4af17add53b50ce0b6756c6216380862f10631
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 15 08:54:59 2014 +0000

    v2v: Whitespace change.

commit da34797987296ffc3e365902c8eb4d9b8024e8af
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 13 19:34:29 2014 +0000

    p2v: Add more authors.

commit 5a964144b27cab4a4a8d220dba6ad53f4655fd5e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 13 19:30:00 2014 +0000

    p2v: Rename authors.c, copying.c -> about-* to avoid confusion.
    
    Just file renaming, no other change.

commit f9e0aee1497028c79619325e0bf105dbcc2f004b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 12 22:25:47 2014 +0000

    sysprep: Use automake to build the library.
    
    Normally this requires the program to have at least one C source file.
    virt-sysprep doesn't have this, but it uses C sources from other
    directories, and therefore we can make it work.

commit 604bb7fd7b7087d8002cfbf5392a546819278943
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 12 22:25:47 2014 +0000

    mllib: Use automake to build the library.

commit ccb1f2a4a02da2f56649b5452f6b9c0356f91798
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 13 14:49:32 2014 +0000

    recipes: Tidy up section about hex-dumping and hex-editing sectors.

commit 603d0fbd95fecebed75ebd02f5b1cd4d1b729571
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 12 17:41:47 2014 +0000

    p2v: Test two disk guest.
    
    Make the test harder (evil grin).

commit 402bba35059056fdea83689e408806071c478e44
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 12 17:13:51 2014 +0000

    Version 1.29.15.

commit f4b846445e222315060eb579d86ada5870c0174a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 12 15:58:05 2014 +0000

    builder: Try again to fix the infinitely recursive index-parse.h rule.
    
    I ran 'make clean && make' hundreds of times in the builder
    subdirectory and it didn't fail.

commit b547b627895c137d96bdc06401415be643fee490
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 12 15:11:57 2014 +0000

    v2v: C files are located in srcdir, not builddir.

commit 9d3a02792ff0a5502dbeda42db4c28651a3688b0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 12 15:11:37 2014 +0000

    sparsify: C files are located in srcdir, not builddir.

commit d8c43d556b45f4c9676fdbfce0e9fe07b709635a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 12 14:44:54 2014 +0000

    New API: guestfs_c_pointer
    
    This returns the C pointer to the guestfs_h handle (ie. guestfs_h *).
    
    The purpose of this API is to interwork with other non-C libraries.
    See RHBZ#1075164 for the rationale when applied to another library.

commit 1e7a6d9f10008a922ae63e2893d76e44bd61b5b0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 12 14:32:11 2014 +0000

    perl: Implement Pointer ("virDomainPtr", _).
    
    This allows the Perl binding of guestfs_add_libvirt_dom to work.
    
    This relies on the internal Perl representation of virDomainPtr, but
    Dan assures me this isn't going to change.

commit df9782ec3a12ac46e1b8ffa31630c7a1e64162fe
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 12 13:31:08 2014 +0000

    tests: Enable and fix test-add-libvirt-dom test.
    
    Commit 96158d42f5cb9b6c472b4630f2c97edae600f6d3 enabled the previously
    private guestfs_add_libvirt_dom API.  It also tried to enable the
    existing test for this API, but failed to do that correctly.  Also the
    test was broken.  Fix all of this.
    
    This fixes commit 96158d42f5cb9b6c472b4630f2c97edae600f6d3.

commit 741403d7186c238c89780b1f3cee0a30641830b3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 12 13:23:58 2014 +0000

    v2v: Replace .. with $(top_builddir)
    
    No functional change.

commit 85b664dacd4284ff8127d09ba541590cfc8e9785
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 12 12:50:16 2014 +0000

    builder: index-parse: Remove unused destructor.
    
      YACC     index-parse.c
    index-parse.y:97.34-41: warning: type <fields> is used, but is not associated to any symbol [-Wother]
     %destructor { field_free ($$); } <fields>
                                      ^^^^^^^^
    index-parse.y:95.36-45: warning: type <sections> is used, but is not associated to any symbol [-Wother]
     %destructor { section_free ($$); } <sections>
                                        ^^^^^^^^^^

commit 9135129b0f6e8eb171131ea0f7d729a960b74cb3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 12 09:43:52 2014 +0000

    builder: Use automake to build the binary.
    
    As this has the side effect of enabling warnings in the C code, I had
    to fix a lot of C problems in this commit too.

commit e87df1d58140b52f0cf48c9adb287655bc76e5a1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 12 09:43:52 2014 +0000

    customize: Use automake to build the binary.

commit bd74c6f09a5b5a0211accd689c88471589fec0f4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 12 09:43:52 2014 +0000

    resize: Use automake to build the binary.

commit 5a1204594c5691d58ed2032f95df0b3492bc8e18
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 11 16:29:29 2014 +0000

    Version 1.29.14.

commit 90e9ad7ff963571718935ff22f96582515b55763
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 11 14:32:46 2014 +0000

    python: Add a regression test for disk labelling.

commit 39f7eaea80c103d9b1cdf1826c4bc70c304c860e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 11 14:05:47 2014 +0000

    launch: libvirt: Fix labelling of overlay files.
    
    We had code (added for RHBZ#912499) which labels overlay files
    correctly so that libvirt can read them.  Unfortunately this code was
    broken by subsequent commits: the new backend setting for the
    imagelabel is only copied to the 'data' struct during launch, but the
    create_cow_overlay callback is called before launch (when adding
    drives).
    
    The fix is easy: ensure create_cow_overlay_libvirt checks for the
    backend setting and initializes the 'data' struct.
    
    This change also means we need to free (data->selinux_imagelabel)
    before setting it in launch (and we do the same for
    data->selinux_label, although that's not strictly necessary).
    
    For background on this, see:
    https://bugzilla.redhat.com/show_bug.cgi?id=912499#c10

commit f4b4dcc03aa06a4afdb02d81b56806f8a9c6dd78
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 11 13:47:01 2014 +0000

    debug: add-domain: Dump XML of original domain.
    
    Useful for debugging labelling issues.

commit 2c9f6da03464279db9a2baa24c32e2a9b64f713a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 10 20:53:27 2014 +0000

    python: Implement Pointer ("virDomainPtr", _) (RHBZ#1075164).
    
    This allows the Python binding of guestfs_add_libvirt_dom to work.
    
    There is a regression test to ensure this keeps working.
    
    Note this requires a patched libvirt-python, supporting the
    c_pointer() method.

commit db1c8a6436c12b4a7f2e29bd4b926c5b064048b7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 10 21:33:24 2014 +0000

    python: Improve harness for running Python tests.
    
    It now understands exit code 77 == skip, amongst other improvements.

commit 96158d42f5cb9b6c472b4630f2c97edae600f6d3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 10 17:11:31 2014 +0000

    New(ish) API: guestfs_add_libvirt_dom.
    
    This API already existed (as guestfs___add_libvirt_dom), and was used
    by a few tools.
    
    This commit changes it to a public API.
    
    Note that for reasons outlined in the previous commit message, it is
    impossible to call this from guestfish or from non-C language
    bindings.

commit fd9ac7f47d769e8319ec597ae6688d4e2bfa55a6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 10 17:04:38 2014 +0000

    generator: Implement Pointer arguments.
    
    This implements Pointer arguments properly, at least for certain
    limited definitions of "implements" and "properly".
    
    'Pointer' as an argument type is meant to indicate a pointer passed to
    an API.  The canonical example is the following proposed API:
    
      int guestfs_add_libvirt_dom (guestfs_h *g, virDomainPtr dom, ...);
    
    where 'dom' is described in the generator as:
    
      Pointer ("virDomainPtr", "dom")
    
    Pointer existed already in the generator, but the implementation was
    broken.  It is not used by any existing API.
    
    There are two basic difficulties of implementing Pointer:
    
    (1) In language bindings there is no portable way to turn (eg.) a Perl
    Sys::Virt 'dom' object into a C virDomainPtr.
    
    (2) We can't rely on <libvirt/libvirt.h> being included (since it's an
    optional dependency).
    
    In this commit, we solve (2) by using a 'void *'.
    
    We don't solve (1), really.  Instead we have a macro
    POINTER_NOT_IMPLEMENTED which is used by currently all the non-C
    language bindings.  It complains loudly and passes a NULL to the
    underlying function.  The underlying function detects the NULL and
    safely returns an error.  It is to be hoped that people will
    contribute patches to make each language binding work, although in
    some bindings it will always remain impossible to implement.

commit 841aa0faf3b1495fd167e32b8105b0bc6faaea60
Author: John Eckersberg <jeckersb@redhat.com>
Date:   Thu Dec 11 08:38:49 2014 -0500

    p2v: show error dialog if virt-v2v fails (RHBZ#1167601)
    
    Ensure the control connection exits with the same status code as
    virt-v2v, and return an error from start_conversion if virt-v2v
    failed.

commit 3d7ea11272dad32ef7ba4bf7c75f0231c5543cc7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 10 13:28:35 2014 +0000

    lib: Don't mention whitelist in guestfs_modprobe documentation.
    
    There is no such whitelist any longer.  All modules are copied into
    the appliance.

commit e1fd9615cc4a9ceb68f4a47a289712fc31a0af5e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 10 13:03:55 2014 +0000

    v2v: linux: Fix modifications to default kernel for legacy grub.
    
    This didn't work at all because the regular expression did not match
    the returned Augeas path.
    
    In future if the regular expression doesn't match, this will give an
    internal error instead of continuing with a bogus value.
    
    Thanks: Junqin Zhou for providing the test case and debug information.

commit 7a34855265d66321ff1f7ee7a2bb4c4d69056a20
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 9 19:16:57 2014 +0000

    builder: Add Fedora 21 image, remove RHEL 7 RC image.

commit 6468b9d60172bcef76b36c14b72f9a1913d94954
Author: Kashyap Chamarthy <kchamart@redhat.com>
Date:   Tue Dec 9 16:58:11 2014 +0000

    arm: Use -cpu host on KVM.

commit bdf772db3286487adefa56b966435f2dd638e0a8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 9 14:06:18 2014 +0000

    inspection: Not an installer if there are multiple partitions (RHBZ#1171666).
    
    Regular EFI disks have /EFI on the first (VFAT) partition, but they
    are not installers.
    
    Fix this by only considering something to be an installer if it has a
    single partition (or whole disks like ISOs).
    
    Implementing this is quite complex since when checking a filesystem,
    we don't have information about whether we are even looking at a
    partition, nor about whether it's the first partition out of how many.
    The majority of the commit is changing the code to collect that
    information.

commit 9d6f0b6a86d68438b27a3d783677c63f39ec6627
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Mon Dec 8 11:20:54 2014 +0800

    resize: fix 'No space left on device' problem when copying to an extended partition (RHBZ#1169015)
    
    Because of the size of an extended partition reported by Linux is always 1024
    bytes, so it will always fail to copy to an extended partition.
    
    This patch fixes this problem by copying to the offset of an extended
    partition in the destination disk.
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit 33098d23020bd3824a2954823a0dbaff751c814d
Author: John Eckersberg <jeckersb@redhat.com>
Date:   Fri Dec 5 16:58:13 2014 -0500

    p2v: wait for qemu-nbd before starting conversion (RHBZ#1167774)
    
    Wait up to 10 seconds for qemu-nbd to start up and respond to clients.
    Otherwise the conversion server may attempt to connect before qemu-nbd
    is ready to serve it.

commit ee57b5f45a71ebf82ca87d7c40d2e803b78ff252
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 5 16:15:57 2014 +0000

    Version 1.29.13.

commit d4ffaad98390141f1830c1aa41425e79c23ecb02
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Dec 5 15:23:28 2014 +0100

    sysprep: user-account: mark "changed file" if users were removed
    
    Removing an user causes /etc/passwd, /etc/shadow, and /etc/group to
    change, so mark the side effects as such if any user has been removed.

commit acb6e8f344c547ebbca5cf0a8ee2303d65a538cf
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Dec 5 15:20:37 2014 +0100

    sysprep: add a "changed file" side effect

commit 1ea9b684b2571775834c382de62592ed26c04e3b
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Dec 5 15:14:17 2014 +0100

    customize, sysprep: add a short SELinux note
    
    Add a short paragraph about SELinux, mostly to point to the
    documentation about it provided in the documentation of virt-builder.

commit be73b1750f3ce52ea137014083ed51d3b64f53a5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 5 15:04:03 2014 +0000

    v2v: Add documentation about what to do about BSOD 0x0000007B (RHBZ#1161333).
    
    After a very long and trying episode with a Windows guest that refused
    to boot after conversion, we managed to successfully boot it by
    disabling Windows Group Policy.  It appears that Group Policy
    prevented the virtio driver from being used.
    
    Document this in the manual.

commit a5423897677ff813baf708e28a53347ecfda33d2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 5 14:29:26 2014 +0000

    v2v: Remove documentation about Windows Recovery Console not supported.
    
    We have now successfully converted guests using WRC, so this statement
    is no longer necessary.

commit 1bd779c983d62f36bf50ad613928cf209f98fbce
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 5 13:52:25 2014 +0000

    v2v: Fix missing loop device which breaks conversion of RHEL 3 guests (RHBZ#1171130).

commit 205a8c7ca1ed1d66bef56d75c3c244e726e3bbbf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 5 13:09:10 2014 +0000

    v2v: Don't use epoch prefix on RPM command line for RHEL <= 4 (RHBZ#1170685).
    
    See the explanation here:
    https://bugzilla.redhat.com/show_bug.cgi?id=1170685#c7

commit eddc8862e06728bcceb675f4c705c4078a962eb0
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Thu Dec 4 16:40:58 2014 +0800

    fish: fix build warning when readline-devel is missing
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit 212660f70f2377a2c8dface018bb7ea4cf980864
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 5 09:00:11 2014 +0000

    builder: Add support for RHEL 3, RHEL 4.

commit 20098d45343276036c76c79ce5cb571aadf90031
Author: Nikos Skalkotos <skalkoto@grnet.gr>
Date:   Wed Dec 3 16:13:12 2014 +0200

    Add freebsd and netbsd distros
    
    Prior to this commit the distro for a FreeBSD or a NetBSD system, in
    conjuction to what happened for OpenBSD, was shown as 'unknown'.
    *BSDs are complete OSes, not a kernel like Linux, but theoritically you
    could have FreeBSD as ostype and PC-BSD as distro.
    
    Signed-off-by: Nikos Skalkotos <skalkoto@grnet.gr>

commit b58022eca783cbc8662c6c393727aa7748e42f5f
Author: Nikos Skalkotos <skalkoto@grnet.gr>
Date:   Wed Dec 3 16:12:22 2014 +0200

    Fix fstab block device resolution for FreeBSD
    
    Take into granted that partition 'c' has a special purpose. It has
    always the same size as the enclosing slice and is not mapped under
    Linux.
    
    This is a best effort try. The mapping will be incorrect if there is a
    gap in the disklabel partitions sequence, e.g. 'b' (swap) partition is
    missing but 'd' partition is defined.
    
    Signed-off-by: Nikos Skalkotos <skalkoto@grnet.gr>

commit af6ea8fa8f42a36f6c96c3c189ca0144630db3d5
Author: Nikos Skalkotos <skalkoto@grnet.gr>
Date:   Wed Dec 3 16:11:33 2014 +0200

    Support fstab block device resolution for NetBSD
    
    Make a best effort try to map NetBSD disklabel partitions to Linux
    partitions. The mapping will be incorrect if there is a gap in the
    disklabel partitions sequence, e.g. 'b' (swap) partition is missing but
    'e' partition is defined.
    
    Signed-off-by: Nikos Skalkotos <skalkoto@grnet.gr>

commit 7adbf72f1bcc1d39d6a5c7c125e5abb51c62ef00
Author: Nikos Skalkotos <skalkoto@grnet.gr>
Date:   Wed Dec 3 16:10:48 2014 +0200

    inspect_os: Add support for detecting OpenBSD
    
    Signed-off-by: Nikos Skalkotos <skalkoto@grnet.gr>

commit 0c2e676f6c92efce890006903585dabd1f72f3b1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 4 09:13:23 2014 +0000

    v2v: When picking a default kernel, favour non-debug kernels over debug kernels (RHBZ#1170073).

commit c712f880db640163a0ce913e42115ecf4f6aa0c2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 4 22:00:35 2014 +0000

    mllib: Add Common_utils.string_suffix function and extend test coverage.

commit 39d64121ec809076703b109053e12a3c91b9c2ea
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 4 09:12:27 2014 +0000

    v2v: Disable autoreboot when converting Windows guests.
    
    This allows users to see stop errors, so we can get an accurate report
    when things go wrong.

commit 1033847f0005470b5f2845fd548d81bc7a2f559b
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Dec 4 17:09:32 2014 +0100

    gobject: link against uninstalled libraries
    
    Make sure to link the gobject library and the gir using the in-tree
    built libguestfs, so a system library won't be used accidentally.

commit 7c7755eb608e91658445be0adb312121f7438edf
Author: Nikos Skalkotos <skalkoto@grnet.gr>
Date:   Tue Dec 2 19:11:55 2014 +0200

    Remove extra space in inspect-fs-unix.c
    
    Signed-off-by: Nikos Skalkotos <skalkoto@grnet.gr>

commit de0b7c4e66ca97b97cebd842226eacd66a0633a4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 2 09:50:02 2014 +0000

    build: Map host CPU 'powerpc64le' to qemu-system-ppc64.
    
    Make the corresponding change in libguestfs-test-tool as well.
    
    Thanks: Dan Horák

commit a21ab21b1a2a9311b3e5f6783bfb4a1a91b104ee
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Mon Dec 1 18:26:12 2014 +0800

    fish: show synopsis if command syntax is wrong
    
    This patch lets guestfish show command synopsis if the syntax of command issued
    by user is wrong, rather than telling user that the number of parameters is wrong.
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit 391d90d9e7b86890c3de3cd5fc200375fb8c6b0a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 29 18:20:52 2014 +0000

    p2v: Refer to virt-v2v resource requirements in virt-p2v man page.

commit 1b52139339caaf8cdc347f05b559128b08fcee39
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 29 18:20:00 2014 +0000

    p2v: Mention sshd_config setting in the manual page.
    
    The precise sshd configuration has confused some users of virt-p2v.
    Only one setting (AllowTcpForwarding=yes) is required, so document it.

commit 4d9a14fc751979caa9e62bb1f9183ba9d884eedb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 29 12:01:48 2014 +0000

    configure: Require yajl >= 2.0.4 (RHBZ#1169045).
    
    Earlier versions fail to parse integers from 'qemu-img info' output
    correctly, resulting in bugs like
    https://bugzilla.redhat.com/show_bug.cgi?id=1169045
    
    Thanks: muued @ IRC

commit 2990db8d1a4f8afab3087de00de4ddad6baec91c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 28 22:26:57 2014 +0000

    tests/c-api: Test that the library can really be loaded with dlopen.
    
    Answer is yes, but it was good to know.

commit 3a5613eb22bd9d10818fb0ee98c388b904638aad
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 28 19:51:47 2014 +0000

    Version 1.29.12.

commit 4a63cddae4a597dd6d34d9d817ab85a70e84a548
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 28 19:50:56 2014 +0000

    Add HACKING file to EXTRA_DIST.
    
    Updates commit 3d3694610fc353ae28c9cf88ff105a04da108c4a.

commit d0a676c91c842d2226660b51ebbecd5c4835167e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 28 14:43:11 2014 +0000

    lib: Add COMPILE_REGEXP macro to hide regexp constructors/destructors.

commit 282132c58bc81216a391fc62c28fc6f01b8c8fb6
Author: Nikos Skalkotos <skalkoto@grnet.gr>
Date:   Thu Nov 27 18:30:33 2014 +0200

    inspect: Fix a bug in the *BSD root detection
    
    The assumption that Linux will map the MBR partition to /dev/sda1
    and the BSD 'a' partition to /dev/sda5 is not always correct.
    
    Signed-off-by: Nikos Skalkotos <skalkoto@grnet.gr>

commit b53ba64a26af802413463b089b2cb3365a12b772
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Fri Nov 28 15:58:07 2014 +0800

    uuid: make alias get-uuid for vfs_uuid
    
    Because get-uuid looks more like a counterpart to set-uuid, and is
    more likely come to mind if one knows set-uuid.
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit 45266e3d49d347d596dd92c5542ffd6fad2c8fd5
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Fri Nov 28 15:58:06 2014 +0800

    uuid: cannot change btrfs filesystem's UUID
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit 95644f33cd51e37467ba32086e7b1ee01bd21dfe
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Fri Nov 28 15:58:05 2014 +0800

    uuid: add support to change uuid of swap partition
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit 196813ea7466c54d26f71ff1760b433bdc29c081
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 27 17:40:52 2014 +0000

    v2v: Fix command line --help output for --no-trim option.

commit 6faa7b4c844df0357f27326d88e50a3f15bbee48
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Nov 26 11:28:24 2014 +0100

    bash: add a completion module for virt-v2v

commit e3834188a9c7a4e91025ef93e5246894c10b4c2c
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Nov 25 20:08:46 2014 +0100

    bash: complete some params for resize, sparsify, and builder
    
    Hardcode the list of fixed arguments for some of the parameters of these
    tools.

commit 1784cd26330481814916e3bd961f9d66030aac46
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Nov 25 18:36:14 2014 +0100

    bash: complete also short options
    
    Propose both short and long options when trying to complete a single
    dash ("-").

commit 4b792354f068b80a01782f85b71a471e3aa6f031
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Nov 25 18:15:37 2014 +0100

    bash: execute --long-options only when needed
    
    Delay the execution of $tool --long-options only when really using its
    output.

commit b00adf3b78f47a5839842735f5031eccaaa309e1
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Nov 25 16:47:34 2014 +0100

    tools: implement --short-options
    
    Just like --long-options, it makes it possible to know which short
    options are supported by each tool; this can help improving the bash
    completion, for example.

commit 3d3694610fc353ae28c9cf88ff105a04da108c4a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 27 14:39:31 2014 +0000

    p2v: Add HACKING file.

commit 7ee6977f7ea6f8c6b710b2b41ac61eaf8b069677
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 26 16:15:40 2014 +0000

    Version 1.29.11.

commit 5e81c838e82922fc3c6b4781c8fe2d425194b34f
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Nov 26 15:09:33 2014 +0100

    Update gobject/Makefile.inc and POTFILES
    
    Followup of commit a120449c979993f4b5bd458ece00fadb339546d3.

commit 1622e3d21816d8baf3c7e2798a43b3b8471785aa
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Wed Nov 26 17:04:06 2014 +0800

    btrfs: add optional parameter `qgroupid' to btrfs_subvolume_create
    
    Parameter `qgroupid' is for adding the created subvolume to a qgroup.
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit 9e7b9ef97f3cd67ef2cdf214e2557205f9629942
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Wed Nov 26 17:04:05 2014 +0800

    btrfs: add optional parameter `qgroupid' to btrfs_subvolume_snapshot
    
    Parameter `qgroupid' is for adding the created snapshot to a qgroup.
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit 5f608f0735a737075ea1cc52795fe897693da0bc
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Nov 26 14:51:33 2014 +0100

    Update gobject/Makefile.inc and POTFILES
    
    Followup of commit 0b3c1762965f339915fd080884a61dbb36545204.

commit b349076aeee7c83e5270f3e36cafb22258bd076c
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Wed Nov 26 17:04:04 2014 +0800

    btrfs: add optional parameter `ro' to btrfs_subvolume_snapshot
    
    Parameter `ro' is for creating readonly btrfs snapshot.
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit 8cd2620448779a0c2740d3f4b2c777e6a9915ae6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Nov 23 14:32:46 2014 +0000

    Add debug APIs: bmap-file, bmap-device, bmap.
    
    Add *interim* support for a block mapping API, used by the 'virt-bmap'
    tool.  These are debug APIs so they will eventually be replaced by
    real APIs along the lines described here:
    
    https://www.redhat.com/archives/libguestfs/2014-November/msg00197.html

commit dc1f15aa3e1e9be57334b36c95600a3c3e0c2c62
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Wed Nov 26 18:10:07 2014 +0800

    typo fix: commmand -> command
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit b6f6454678d8d4ae567259985e079feac56384ea
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Wed Nov 26 18:10:06 2014 +0800

    typo fix: preceeding -> preceding
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit 55f6dc7f3d5e4c05f4dd179b21741768c89f4cd0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 25 19:38:44 2014 +0000

    Version 1.29.10.

commit f3dbf340b87e4b82a10336ad8e1ecef050481541
Author: Nikos Skalkotos <skalkoto@gmail.com>
Date:   Fri Nov 21 21:47:12 2014 +0000

    Add tests for Arch Linux
    
    Signed-off-by: Nikos Skalkotos <skalkoto@gmail.com>

commit 7ce73d898025b07c391d6d66a7aa13314cbc453f
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Nov 25 11:53:11 2014 +0100

    mllib: check the right out channel for tty
    
    Make sure to check whether the given output channel is a tty before
    sending ANSI terminal codes to it, instead of always check what stdout
    is.

commit b2b65bcefbb8e93c0e3af4bfbee66622837644a7
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Nov 25 11:46:02 2014 +0100

    mllib: remove the TTY module
    
    The only function provided is isatty_stdout, which is no more used now
    in favour of Unix.isatty.

commit 8a56fc8e08e4b3080ea96abf928ce280f4440d90
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Nov 25 11:40:04 2014 +0100

    mllib: use Unix.isatty
    
    Make use of Unix.isatty instead of our TTY.isatty_stdout, as the
    supported OCaml provides the former already.

commit bd61f25625da9a9090ee5e1b0bc8aa2f834b2c3a
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Tue Nov 25 13:10:43 2014 +0800

    generator: force longdesc to begin with uppercase
    
    As contrast to shortdesc which is forced to begin with lowercase, this
    patch forces longdesc to begin with uppercase.
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit 7030635e51050514b8a597911c9b1f9077d89a56
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 25 14:33:55 2014 +0000

    v2v: -i ova: Small correction to warning message.
    
    Thanks: Pino Toscano

commit 350b6eec4d36884bf927bf0790c2044daec5c688
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Nov 23 14:31:43 2014 +0000

    New API: guestfs_blockdev_setra: Adjust readahead for filesystems and devices.
    
    This adds a binding for 'blockdev --setra', allowing you to adjust the
    readahead parameter for filesystems and devices.

commit dbdfa79d91f23d6fa12217961cf2633fc560eadb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 25 14:31:42 2014 +0000

    daemon: blockdev: Allow extraarg to be 0.
    
    No change, since extraarg is not actually used.

commit 79fb3debc42b02a7104041f3279ab81bfff03b90
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 24 15:59:36 2014 +0000

    v2v: -i ova: Remove incorrect warning for disks that have no parent controller (RHBZ#1167302).
    
    Don't assume every disk <Item> has a <Parent> field.  For floppy disks
    this is not the case.
    
    Thanks: Junqin Zhou

commit dc845c9a6694dc7f06894e0df137176a4da73c66
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 24 10:56:57 2014 +0000

    ntfsresize: Capture errors sent to stdout (RHBZ#1166618).
    
    ntfsresize sends error messages to stdout.  Capture those error
    messages.

commit e90ab1530e1f1683a3b1559199ee34922aeb0fa3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Nov 23 14:28:46 2014 +0000

    lib: guestfs_disk_create: Allow vmdk as a valid backingformat.
    
    Commit 588af1953e5f7ab74009b9175cc5d3efb8bb651a started with a very
    conservative list of permitted backing formats (just "raw" or
    "qcow2").  We can allow almost any format permitted by qemu, but this
    commit just adds "vmdk" to this whitelist.

commit 5a84407f574be6a0b22781272156c25cf5a75413
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Fri Nov 21 13:17:55 2014 +0800

    btrfs: correct words about subvolume and snapshot
    
    btrfs_subvolume_create creates only subvolumes. btrfs_subvolume_delete
    deletes subvolumes or snapshots.
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit 99263616cafc29852be4d76909bb35e1f7770022
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Nov 21 16:10:33 2014 +0100

    src: inspect: move read_package within the -Wno-cast-align block
    
    Starting from commit e260460a8f608cb30093d7512b12f6ee11841456 be32toh is
    used, which means possible "unaligned cast" warnings (already covered in
    get_rpm_header_tag).

commit 2305fe3fc642020108e755246f03d95640eb8adb
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Nov 21 16:08:50 2014 +0100

    build: mllib: put $(LIBTINFO_LIBS) within '...'
    
    This helps when $(LIBTINFO_LIBS) contains spaces (i.e. more than one
    "word").

commit c64467a4c1a31de1134084a15a4acb841557140f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 20 22:22:49 2014 +0000

    p2v: Include version and md5sum in kickstart.
    
    Include the version of virt-p2v and its MD5 checksum in the source
    kickstart.  This is useful for working out which version of virt-p2v
    the kickstart corresponds to.

commit ac1b4bcd7d3aadc1ae56f4be7e442371c00bc3b4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 20 21:49:03 2014 +0000

    Version 1.29.9.

commit 25b979a0c4a5942aaf62fcbe0e48d7526bd5e9b0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 20 16:08:43 2014 +0000

    p2v: Make the "Cancel Conversion" button work (RHBZ#1165569).
    
    This relies on the remote to keep sending us data.  If it hangs, then
    the cancel button won't work.  This could also be fixed by introducing
    a timeout to the read syscall.

commit 98dd01728f61bd810f6c65a6b9e52d78365b96bd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 20 16:01:09 2014 +0000

    p2v: Disable "Cancel Conversion" button after the conversion (RHBZ#1165569).
    
    Actually this bug does nothing and remains cancelled all the
    way through.  The next commit makes it function.

commit 141832e2b22267f8369693d5f4afb27747668889
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 20 15:59:50 2014 +0000

    p2v: Add 'Reboot' button to the GUI (RHBZ#1165564).

commit 5d695d37a56a01b8f72a086eaa3bc9de94f6fe3c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 20 15:37:44 2014 +0000

    p2v: gui: Get the correct button for cancel_button.
    
    I was fetching cancel_button from the wrong dialog (conv_dlg, not
    run_dlg), and therefore getting the wrong button.
    
    This explains why the back button on the conversion dialog was always
    insensitive.  It's because cancel_button was assigned to this button,
    and then I was setting cancel_button to insensitive.

commit 11347db5762441cd97791367d3cdf7e0c5a0ddc5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 20 16:10:08 2014 +0000

    p2v: Remove --fullscreen option.
    
    It did nothing and was left over from an earlier attempt to add
    fullscreen mode.  That is not needed any longer since we now run
    virt-p2v under the matchbox window manager.

commit 3dabc7a7bae709e884b56e297e7ece222e653d0c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 20 13:05:26 2014 +0000

    appliance: When running systemd-tmpfiles, pass --boot option (RHBZ#1165785).
    
    This causes all tmpfiles to be created.

commit 8e78a830671897376c3d7585f23ce3fba684f7f1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 20 13:04:45 2014 +0000

    appliance: Create tmpfiles before running udev.
    
    This is the same order as systemd would run them.

commit 63d67ac8ac6ae609514c995704a4dbd6f5ff5647
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 20 11:22:32 2014 +0000

    v2v: linux: Delete the LVM cache which may reference old devices (RHBZ#1164853).
    
    Thanks: Bryn M. Reeves

commit 7b8c6e762e10033b174f8554145d48489718b8b5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 20 10:08:51 2014 +0000

    v2v: linux: Remap device names in /boot/grub2/device.map (RHBZ#1165975).
    
    Thanks: Junquin Zhou

commit 171e6383a217b9f575316929047300d5c8ab4948
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 19 13:20:13 2014 +0000

    v2v: linux: In verbose mode, add dracut --verbose parameter.
    
    So we can see exactly what dracut is doing in the debug output.

commit 6aaff1fffaa7d62bf75d55cd99ed291d7a143ed3
Author: Nikos Skalkotos <skalkoto@gmail.com>
Date:   Mon Nov 17 22:48:01 2014 +0000

    inspection: deb: Seperate epoch field from version
    
    Return it in the app2_epoch field of the guestfs_application2 struct
    
    Signed-off-by: Nikos Skalkotos <skalkoto@gmail.com>

commit 28f2cb7e3a3be4232f1403136b1e235ddfec417b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 18 16:55:21 2014 +0000

    Version 1.29.8.

commit 467bbf72f74527ca00678cfea80b1785868cd842
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 18 14:17:35 2014 +0000

    v2v: linux: Refactor device replacement code.
    
    No functional change.  This should be equivalent to previously.

commit b1053150a2da121b3cb8ddc197d0d8e49d930130
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 18 14:16:39 2014 +0000

    v2v: linux: Always match partition number in regexp.
    
    Change the rex_device_p regular expression to always include a
    partition number.
    
    There should be no functional change here.

commit e25f68c47efaab886ada330b7ab596681705b02b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 18 13:53:13 2014 +0000

    v2v: linux: Print block device map in verbose mode.
    
    Very useful for debugging device mapping problems.

commit 4c7026fb7a7514838a01771abb4c7e62a4e4485f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 18 13:37:21 2014 +0000

    v2v: Don't change Augeas device entries unless the value has changed.
    
    When remapping block devices, don't change an entry unless its value
    has changed.  This avoids unnecessary Augeas writes.

commit 9ebc12572317efe5c1ae83fcb61c7767dec40203
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 18 13:07:42 2014 +0000

    v2v: Don't use <target dev> attribute, use <target bus> instead.
    
    The <target dev> attribute in libvirt isn't very informative.  What we
    really want to know is whether the source disk used IDE or SCSI, as
    that allows us to remap block devices accurately during conversion.
    For example, if the source was IDE and RHEL 5, and after conversion
    virtio will be supported, then we know that we need to remap
    "/dev/hda" to "/dev/vda".
    
    Drop the s_target_dev and s_removable_target_dev fields and replace
    them with s_controller and s_removable_controller.
    
    For -i libvirt, use the <target bus> attribute to get this information.
    
    For -i ova, use the OVF disk controller's ResourceType.
    (http://blogs.vmware.com/vapp/2009/11/virtual-hardware-in-ovf-part-1.html)

commit 78f6d3aff59ab0a539b8f2a90b88a2b6f7c994f6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 18 12:35:38 2014 +0000

    v2v: -i ova: XML is case-sensitive, so replace 'InstanceId' with 'InstanceID'.

commit 01bdfe7d81b56e385c3f47c9dc6c007fe91ea41b
Author: Nikos Skalkotos <skalkoto@gmail.com>
Date:   Mon Nov 17 19:24:03 2014 +0000

    list-applications: Add support for pacman
    
    Extend the guestfs_inspect_list_applications2 API call to work on Arch
    Linux guest images.
    
    Signed-off-by: Nikos Skalkotos <skalkoto@gmail.com>

commit e260460a8f608cb30093d7512b12f6ee11841456
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 17 13:11:38 2014 +0000

    inspection: rpm: Return Epoch field of RPMs in application data.
    
    Bug found by: Nikos Skalkotos

commit 42391913287d935e582b0c67571a17e657aa8e2e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 17 10:33:35 2014 +0000

    inspection: Allow /etc/favicon.png to be a symbolic link (RHBZ#1164619).
    
    If /etc/favicon.png is a symbolic link, follow it.
    
    Unfortunately RHEL 7 and Fedora have crappy 16x16 /etc/favicon.png
    symlinks in the base distro.  It would be nice to ignore this symlink,
    but it's almost impossible to determine if the symlink is part of the
    base distro or was added by the user.  (This is a bug in those
    distros.)  virt-inspector and virt-mananger both ignore favicons.

commit c8a608ecf8576bb754749db982714fa35cedfbe4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 17 10:25:33 2014 +0000

    inspection: Get icons from RHEL and CentOS 7 (RHBZ#1164619).

commit 6dd371f913332a840b34ad00d52e9fa52711fb0e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 17 10:07:28 2014 +0000

    Fix description of 'set_append' and 'get_append' APIs (RHBZ#1164732).
    
    These should refer to the libguestfs appliance kernel command
    line, not the guest kernel command line.
    
    Thanks: Lingfei Kong

commit 88f2bc1a7bf769424fc219dae925a70a04b19294
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 17 09:31:55 2014 +0000

    Fix minor typo in release notes (RHBZ#1164697).

commit 40cd76eb79cb64ff412847cd43b1b2f1f5427429
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 17 08:58:08 2014 +0000

    v2v: Simplify calculation of Mbps in verbose output.

commit e02b261e48863191f755be4ff65bc54d5ba1c874
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 17 08:57:34 2014 +0000

    v2v: Comment change.

commit a5bb1a4ccbe82ab4939b5d240877009d1762d49c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 15 18:26:54 2014 +0000

    v2v: Make source s.hypervisor field type-safe.

commit 5920f7a56879d8d4ae2f13ba1978fb5235213a8b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 15 17:42:19 2014 +0000

    v2v: Rename source field 's_dom_type' to 's_hypervisor'.
    
    Also the source hypervisor cannot be "kvm".  Choose another example
    for the comment.
    
    For disks, set the source hypervisor string to "unknown".

commit f421c7cae8bf574bc43c1c185be7d638a0502e04
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 15 17:38:00 2014 +0000

    ocaml: Remove *.annot files when doing 'make clean'.
    
    Commit fd70cdc3c58a9f240ef8dbbef73ed13054917220 passes the -annot flag
    to the compiler, generating *.annot files (containing type information
    used by emacs and IDEs).  Remove these files when doing 'make clean'.

commit 52dfb831dbb6a7e85ddfd022678be8e72ad86e35
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 15 17:09:59 2014 +0000

    Version 1.29.7.

commit 643162a61a65483f7c6d21a1b1db220ae468b3c3
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Nov 14 18:04:12 2014 +0100

    appliance: explicitly add libyajl2 on openSUSE
    
    While it has always been needed, it has been implicitly pulled in by
    some other package. Hence, make it sure to always have it.

commit 891959cf7f82fac89aed3997532e2bee22ae2720
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 13 15:30:52 2014 +0000

    df: Allow policykit and SASL authentication when reading list of domains.
    
    Use virConnectOpenAuth instead of virConnectOpenReadOnly.
    
    See also:
    https://www.redhat.com/archives/libguestfs/2014-November/thread.html#00035

commit 57547dcdcfb27bdd988d8a561dc2178ea1d23517
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Nov 12 09:50:59 2014 +0100

    daemon: check xfs label lengths (RHBZ#1162966).
    
    Similar to commit 52f9cd4882135910ea06e1e50ac6441d455c9ab1, but for xfs
    filesystems.

commit e698daabbcb3c9d7e08e571fbd661369d4d52194
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Nov 10 14:53:07 2014 +0100

    configure: simplify the qemu cpu mapping
    
    Use AS_CASE to properly map from the host cpu to the qemu cpu suffix;
    this avoids doing multiple string replacements using sed, and it is
    possible to use case-like syntax.

commit 34d685157459c9a649179ae4b313f8b3576696f4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 13 13:22:21 2014 +0000

    Rename LIBNCURSES* to LIBTINFO*.
    
    We actually depend on libtinfo or libtermcap, not curses, so
    rename the variable.
    
    This updates commit 96add4d5b34daabbae5a2766f564ae98b48cf576.

commit 96add4d5b34daabbae5a2766f564ae98b48cf576
Author: Mike Frysinger <vapier@gentoo.org>
Date:   Mon Nov 10 22:47:51 2014 -0500

    use pkg-config to look up ncurses
    
    Hardcoding -ltinfo breaks on distros that do not build the sep library
    (which is the default ncurses behavior).  Use pkg-config to look up the
    right libraries regardless of how the distro built things.

commit 7407c0ae14c382e11e93afe94c0fc37d16df6ae9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 7 11:25:06 2014 +0000

    v2v: -o glance: Fix metadata for disk type and NIC (RHBZ#1161575).
    
    The labels 'hw_disk_bus' and 'hw_vif_model' were swapped.  This
    happened to work for virtio guests.  For non-virtio guests you ended
    up with absurdities like requiring an rtl8139 driver for the disk.
    
    Thanks: Junquin Zhou

commit 75b37b758986d6885c399b17d07329deb326546d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 6 22:07:26 2014 +0000

    Version 1.29.6.

commit 4a187b7faf119cb2bb4a761bd59618bd2af77ef9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 6 18:49:46 2014 +0000

    v2v: Warn if a kernel-* package is found containing no files.

commit 377bc302f11db3da4263f894c76a7d280fb25dbd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 6 18:47:34 2014 +0000

    v2v: Fix kernel detection when multiple kernels are installed (RHBZ#1161250).
    
    Previously we used to try to find the 'vmlinuz' file by running 'rpm
    -ql kernel' and looking for any file called 'vmlinuz-*'.
    
    If there were multiple 'kernel' packages installed, the rpm command
    would list files from all of them, resulting in a random 'vmlinuz-*'
    being chosen, not necessarily the one corresponding to the kernel
    package we were looking at.
    
    Use 'rpm -ql kernel-<VERSION>-<RELEASE>' instead so that we only look
    for files in the right kernel package.
    
    Thanks: James Mighion

commit bd589a1d53c5192daf40da0cc7f5809c7e4fa0ca
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 6 15:15:39 2014 +0000

    test-tool: Map powerpc64 -> ppc64 when searching for qemu.
    
    Consequence of the previous commit.
    
    This also adjusts the whitespace to make the generated script
    a bit nicer.

commit a550ecb5f198ff7179df097ffc7847ff576115ee
Author: David Sommerseth <davids@redhat.com>
Date:   Thu Nov 6 15:14:04 2014 +0000

    configure: Map powerpc64 -> ppc64.

commit 5de06a3571d20d0fd483d26099cc49bc0f08ecf0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 6 09:52:32 2014 +0000

    v2v: Document minimum free filesystem space requirements.

commit 918dd3705d3d34f28eb3cf30cd79d16358d525e3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 6 09:47:21 2014 +0000

    v2v: Ignore small filesystems when checking for sufficient free space.

commit ea04bcbc84f5727ded8eb2aaecfea3b3275c146e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 5 21:34:58 2014 +0000

    Use -ltinfo instead of -lncurses.
    
    In tools except guestfish, we don't use ncurses, or even curses, just
    2 termcap functions and a global variable.  These are provided by
    libtinfo, so just link to that.
    
    In guestfish we use readline which needs ncurses.  Leave that alone.

commit 8c2f27518a6f5068c1111b3f41bcfa6971646063
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 5 15:41:32 2014 +0000

    Version 1.29.5.

commit f27e2426491efab7904c2863a8a443416babc571
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 5 14:33:39 2014 +0000

    daemon: strings: Use -a option to avoid using BFD to parse files.
    
    Avoids hitting CVE-2014-8484 and CVE-2014-8485 and similar problems
    with BFD parsing on untrusted files.

commit a5426cce5faa0fde0de1b62c8646cb8a9992ef2b
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Nov 4 18:02:56 2014 +0100

    build: check for libintl, and use it
    
    Look for libint/gettext and link to it; this properly detects whether
    libint is part of libc.

commit c58d335952194b9556db78abde75637921ab4eca
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 4 21:21:20 2014 +0000

    v2v: -i libvirt vcenter: Change 'esx:' to 'vcenter:' in errors/warnings.
    
    'esx' is inaccurate.

commit 1fab78c7b249b230ce0d667fe4416505c19bbc74
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Nov 4 09:59:41 2014 +0100

    tests/qemu: isolate MD5 calculation in an own shared function
    
    md5sum(1) does not exist everywhere, so wrap it in an own function so
    the right implementation can be chosen on each OS.  Also, wrapping it
    avoid using awk everytime.

commit 3d02e53c48266669675cc237f61ae2c4e1816e66
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Nov 3 16:49:59 2014 +0100

    ruby: fix detection of ruby library
    
    Query RbConfig::CONFIG for "libdir", and use that when trying to link to
    the ruby library.  This fixes the libruby detection when it is installed
    in a non-standard library directory.

commit 9deafea8462b72779a85570b7dd0412d5e7c10bc
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Nov 4 18:02:04 2014 +0100

    test-charset-fidelity: use and link against gnulib
    
    It uses error() which is specific to GNU libc, but supplied by gnulib if
    not available.

commit a293ac1e911052c52e3110800a5b7b2c5f1bd37d
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Oct 30 14:52:28 2014 +0100

    build: isolate the libdb tools search in an own autoconf macro
    
    Create an autoconf macro to deal with the possible combinations of names
    and versions of the libdb tools. This also eases the addition of a libdb
    version, or a new pattern for the names of tools.
    
    There is no functional change.

commit aba82825a329f9f99438fec161f1b0fb2098bdc9
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Oct 29 18:53:07 2014 +0100

    builder: fix inclusion of <config.h> in lex-generated source
    
    Use a %top block for including <config.h>, so it is included prior to
    any other include, even for system ones. This makes sure its definitions
    are properly used in gnulib replacement headers.

commit d1634799e396f2003e2abd36b042a1133bb6d928
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Oct 27 13:08:34 2014 +0100

    src: launch: cast the sockaddr args to sockaddr*
    
    This matches what generally done for passing socket addresses to e.g.
    socket and bind, and already done in other parts of libguestfs.

commit 8c8e089ad1644a0f43586b43eb476ad6574c7c18
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Oct 27 10:59:43 2014 +0100

    build: check for UNIX_PATH_MAX, and properly define it if not
    
    Do a configure check to see whether UNIX_PATH_MAX is defined; if it is
    not defined, provide it with the size of sun_path in the struct
    sockaddr_un, thus with the proper size for any libc.

commit 65a54c6c92371286db7020b2f188a7ab3ad329cb
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Nov 4 10:49:01 2014 +0100

    bash: fix build/clean when srcdir==builddir
    
    Use CLEANFILES to remove the generated symlinks, and just ignore the
    errors when copying the scripts in srcdir!=builddir situations.
    
    Followup of commit 40ac54829d4e71b1bac76343872a2674a40c7ac0.

commit 40ac54829d4e71b1bac76343872a2674a40c7ac0
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Fri Oct 31 20:03:22 2014 +0100

    Fix, simplify out-of-tree build/install for bash completions

commit 25cad1e62fa73e9cfd9a0e3d1d330165b19339ec
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Nov 4 09:16:17 2014 +0100

    customize: firstboot: fix Linux log output
    
    Pass -a to each tee invocation, otherwise just the last one (so only for
    the last script executed) will appear in the log file.

commit f8ed15462fbb03c5b19972361f2a2e6fed4c5f02
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Nov 3 21:15:59 2014 +0100

    customize: firstboot: make sure to run Linux scripts only once
    
    If a script does not finish, hangs, etc, it would be executed again at
    the next boot, since the injected firstboot.sh helper removes it only
    after it finished.
    
    Before executing a script, move it to another internal subdirectory
    (scripts-done) and execute it from there, so it is not run again by
    firstboot.sh.  The downside is that now scripts are executed only once
    at all, so if a script fails it will not be attempted at the next boot.
    
    Also, remove all the files found in scripts-done, as they have been run
    (or at least attempted) in a previous boot.
    
    This fixes RHBZ#1159651.

commit 3d6c2af450f54babb6c3df5903d46769cacacc89
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Nov 3 19:30:54 2014 +0100

    customize: Add --ssh-inject option for injecting SSH keys.
    
    This adds a customize option:
    
      virt-customize --ssh-inject USER
      virt-customize --ssh-inject USER:string:KEY_STRING
      virt-customize --ssh-inject USER:file:FILENAME
    
    (ditto for virt-builder and virt-sysprep)
    
    In each case this injects into the guest user USER
    a) the current (host) user's ssh pubkey
    b) the key specified as KEY_STRING
    c) the key in FILENAME
    adding it to ~USER/.ssh/authorized_keys in the guest.
    
    For example:
    
      virt-builder fedora-20 --ssh-inject root
    
    will add the local user's ssh pubkey into the root account of the
    newly created guest.  Or:
    
      virt-customize -a disk.img \
         --ssh-inject 'mary:string:ssh-rsa AAAA.... mary@localhost'
    
    adds the given ssh pubkey to mary's account in the guest.
    
    This doesn't set the SELinux labels correctly on newly created files
    and directories, so you have to use --selinux-relabel (probably we
    should fix this as part of the general effort to fix SELinux
    relabelling).  However it should preserve the labels if the
    ~/.ssh/authorized_keys file already exists.
    
    Most of this work is based on a patch sent to the mailing list by
    Richard W.M. Jones <rjones@redhat.com>:
    https://www.redhat.com/archives/libguestfs/2014-November/msg00000.html

commit 39f524d79b10a3654ee4879951a3ef8dcc99a46f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 3 19:38:12 2014 +0000

    v2v: Ensure --bridge and --network args are documented correctly in --help output.

commit 0121f4fd56770de4efd454b058a28ea39bf41807
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 1 21:08:53 2014 +0000

    generator: customize: Insert whitespace between entries.
    
    Just a whitespace change.

commit 0701b24e5c9934c502e2ecd698d60d884604552a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 31 18:30:36 2014 +0000

    daemon: No longer needs its own copy of gnulib.
    
    Since the daemon has long since used the same build system as the rest
    of libguestfs, it no longer needs its own gnulib.
    
    This arcane bit of code was left over from
    commit e05ddc70f1fa6d1e8253d69c5d17e69bfad2be90 (added 2009-08-03 !)

commit a6b39437830dd49c55e0b2ca7c9b05e446462e59
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 31 17:47:18 2014 +0000

    Version 1.29.4.

commit 6d6644d52d8092dd4f4add859ebda06bea4b5b56
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 31 11:02:33 2014 +0000

    launch: libvirt: Implement drive secrets (RHBZ#1159016).
    
    Implement the GUESTFS_ADD_DRIVE_OPTS_SECRET argument of
    guestfs_add_drive_opts.  For libvirt we have to save the secret in
    libvirtd first, get a UUID, and then pass the UUID back through the
    domain XML.

commit 68dc488a4476caf742d5342307258dd72d0e2256
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 31 14:16:36 2014 +0000

    v2v: -o libvirt: Get the <features/> right in the output XML (RHBZ#1159258).
    
    Implement what old virt-v2v did (from
    lib/Sys/VirtConvert/Connection/LibVirtTarget.pm)
    
    Thanks: Tingting Zheng, Matthew Booth

commit 7ba102dc4cd4b7c80f7486a54bf8535dd964f436
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Oct 31 17:45:04 2014 +0100

    fish: complete symlink properly
    
    When an entry is a symlink, check whether it points to a directory, so
    the entry for it can be completed correctly.

commit a8b95a5535480c7b382fab82dcaf18eb67e5278a
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Oct 31 17:37:22 2014 +0100

    fish: fix dir completion on filesystems w/o dirent.d_type (RHBZ#1153844).
    
    On filesystems whose dirent.d_type is DT_UNKNOWN or some unknown value,
    manually check whether an entry is a directory, thus completing in the
    proper way.

commit d082cd6ae573956d1973e43e29edb819edb21e6e
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Oct 31 16:11:01 2014 +0100

    builder: pass Sources.source objects directly
    
    Instead of passing the (uri, key, proxy) tuple around, pass the whole
    Sources.source record; this requires creating proper Sources.source also
    for uri+fingerprint passed via command line.
    
    No functional changes.

commit 56bd781b76471cdce2602b34971f2f32b1ac1285
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Oct 31 15:17:51 2014 +0100

    builder: use gpgkey_type for the gpgkey field in sources

commit 3987bbcd91fd134d04d92406859486d51c90af40
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Oct 31 15:05:32 2014 +0100

    builder: move the gpgkey_type type from Sigchecker to Utils
    
    No functional change, just code motion.

commit 1470be7f3b36b9ba6862fd04aa66446e89b108a7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 31 15:57:45 2014 +0000

    v2v: Add bounds check to Xml.xpathobj_node function.
    
    I accidentally called it with an out-of-bounds index, and it caused a
    core dump.  Add a bounds check to stop this from happening in
    production.

commit c085a0ba73858769fba1f88855cff59dea29afcf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 31 13:44:57 2014 +0000

    builder: Updated CentOS image to 6.6.

commit 847465a79422d30509dc2829578c059db78366bd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 31 10:50:20 2014 +0000

    src/info.c: Remove incorrect comment.

commit 3e4024a1ea3dc7f14798d8c76a568e86dbf99a48
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 30 22:21:47 2014 +0000

    Version 1.29.3.

commit 65abc4420325c1226b002f2304709b2040160877
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 30 13:34:12 2014 +0000

    v2v: Add --password-file parameter (RHBZ#1158526).
    
    This allows you to send passwords to virt-v2v input modes without
    being interactive.

commit b35b84684c845ceefd3c0ec519caf80366a798ea
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 30 09:02:00 2014 +0000

    v2v: vmware: Use 'curl --config' to pass arguments securely to curl.
    
    Instead of making up an ordinary curl command line, write a temporary
    config file and use 'curl --config tmpfile' to pass the arguments.
    
    The advantage is that it's more secure if we want to supply passwords
    to curl, since a '--user username:password' parameter on the command
    line could be read (eg. by 'ps ax'), but the temporary file has mode
    0600 and cannot be read by other users.
    
    This is mostly code motion, but it also passes the '-q' option to curl
    to stop it from reading default configuration files.

commit d82c5fb5a0c86345891ee191ae7d820361978643
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 30 13:47:23 2014 +0000

    v2v: Remove useless parentheses around expression.

commit 8efbe49df6d53666bd5a6031f45f45ceb1408fb8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 28 11:21:08 2014 +0000

    p2v: kickstart: Add rpm to list of packages.
    
    Avoids RHBZ#1089566.

commit 26952db56ffab1bc93c7f57c43e785f62d44854f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 28 11:20:30 2014 +0000

    p2v: kickstart: Remove 'install' line.
    
    'install' is the default operation, it doesn't have to be specified.

commit c48114cd24d630ac66bd683c3593c33d43f712a6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 28 09:00:29 2014 +0000

    p2v: kickstart: Add firewalld to the ISO to allow firewall to be enabled.

commit 439bf5e42ac5396eed8911e2d2698ceb4603f0a8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 28 08:55:46 2014 +0000

    p2v: kickstart: Name the ISO 'virt-p2v'.

commit a03bffa15a5357d5d0244595caf99607be1ec3ab
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 29 18:01:52 2014 +0000

    v2v: Add a support matrix to the manual page.
    
    This explains what does and doesn't work.

commit 6d338ae4e64ef7c41bba74f66809b63158e49311
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 28 22:48:57 2014 +0000

    builder: Document that --edit option can be split across lines.

commit cb291d7e4642547da5551f8686bbc46a911377af
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 28 08:51:06 2014 +0000

    p2v: Ensure we are using virt-v2v >= 1.28.
    
    Must NOT use:
    
    - One of the interim versions of virt-v2v (1.27.x) that we published
      during development.
    
    - Old virt-v2v (0.9.x).
    
    Also use the --version option (instead of -V) since old virt-v2v
    required it:
    
      $ virt-v2v -V
      Option v is ambiguous (version, vmtype)
      Usage:
      [...]
      $ virt-v2v --version
      0.9.1

commit d0eba7f26035db10dcaa062e1c90e63f6d446f9f
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Tue Oct 28 15:51:24 2014 +0800

    sysprep: remove /var/spool/mail/username
    
    remove /var/spool/mail/username if --enable user-account.
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit 7f7c15334722b975722e43ccd5308fc74a4ad453
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 27 17:50:58 2014 +0000

    Document three (fixed) security problems in the main manual page.
    
    Previously these were only covered in the release notes, but not in
    the "SECURITY" section of guestfs(3).

commit 777e2175abe5d8ab6687d11d817827080ae6f7ff
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 27 17:44:54 2014 +0000

    Add warnings about using guestfs_strings* APIs because of CVE-2014-8484 and CVE-2014-8485.

commit b09b60c987ff113bc4520ab994142da912ffa3d6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 27 15:42:02 2014 +0000

    p2v: Add usb-storage module and rebuild initrd (RHBZ#1157679).
    
    Include the usb-storage kernel module, to permit booting from USB
    keys.
    
    Rerun dracut to rebuild the initramfs.  This is complicated because by
    default dracut will try to build an initramfs for the running
    (ie. appliance) kernel, which is completely useless.  We need to find
    the latest installed kernel and rebuild the initramfs for that
    instead, which is hairy.
    
    This also does a small refactoring of the distro-specific code,
    removing the $selinux_relabel variable and replacing it with a generic
    $extra_args variable.
    
    I only added this to the virt-builder script, since one assumes that
    livecd-creator/whatever should make the kickstart ISO bootable by
    installing whatever drivers and modules are necessary.

commit 4c31cae279aeb66f424d983cbf472b08daf6a762
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 27 16:10:28 2014 +0000

    Revert "p2v: Add usb-storage dracut module to allow boot from USB key (RHBZ#1157679)."
    
    Running 'dracut -f' installs a dracut for the running kernel (of the
    appliance) not the installed kernel.  Stupid stupid stupid.
    
    This reverts commit 7a6d44ebfe23f28f46f6af1fd48ea8371473529b.

commit 7a6d44ebfe23f28f46f6af1fd48ea8371473529b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 27 15:42:02 2014 +0000

    p2v: Add usb-storage dracut module to allow boot from USB key (RHBZ#1157679).
    
    I only added this to the virt-builder script, since one assumes that
    livecd-creator/whatever should make the kickstart ISO bootable by
    installing whatever drivers and modules are necessary.

commit 91788cd76f23227c102293a5dc5eef1c30cf7858
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 27 13:41:49 2014 +0000

    p2v: Add "Hardware Support" group to the P2V images (RHBZ#1157679).
    
    Thanks: Chris Adams

commit fab95a52bd307e6be699681de67134788687bf13
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Oct 26 19:35:36 2014 +0000

    p2v: Explain in the man page why the virt-p2v ISO is used.

commit 5862a4391db34732d45403f594ecc050fe77383f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 25 17:56:45 2014 +0100

    Version 1.29.2.

commit 09584a8bc6d92887e8c6eb4bcd5c777d6ec6d97f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 25 15:35:49 2014 +0100

    sparsify: Add Utils module and use common error/warning/info functions.
    
    This program needs quite a lot more work, in particular to make the
    regular messages use 'make_message_function' instead of 'printf'.

commit b01582623d0828355e8c218ac62e6a36a2c6c1e3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 25 11:36:15 2014 +0100

    resize: Tidy up messages.
    
    Add common error/warning/info functions.
    
    Examine every existing call to printf/eprintf and change where
    necessary so that:
    
     - error is used instead of eprintf + exit 1
    
     - warning no longer needs ~prog argument (it is added by Utils module)
    
     - any verbose output should go to stdout, not stderr
    
     - info is used to print general informational messages
    
    Also, don't indent summary of changes.

commit 6049fbdddb8c28a48632af2a7f894c93ffd8ac63
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 25 15:13:27 2014 +0100

    sysprep: Use common error/warning/info functions.

commit 7c9293fff02c9d71833c6914ad7a8d00c3b47bb1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 25 15:06:08 2014 +0100

    v2v: Add Utils.warning and Utils.info that don't require ~prog parameter.

commit f7664b7f76bc7e997e1d714a894ea6e696b168e8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 25 11:36:15 2014 +0100

    customize: Add Customize_utils module and use common error/warning/info functions.
    
    Add a Customize_utils module.  This contains common error/warning/info
    functions, and also quote = Filename.quote.
    
    Examine every existing call to printf/eprintf and change where
    necessary so that:
    
     - error is used instead of eprintf + exit 1
    
     - warning no longer needs ~prog argument (it is added by Utils module)
    
     - any verbose output should go to stdout, not stderr
    
     - info is used to print general informational messages
    
    Also, don't pass ~prog parameter around.  Instead we just get it from
    the executable name.

commit b99983480ac3d75e2cb62dacf6042b3cd4cdf65e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 25 11:36:15 2014 +0100

    builder: Add Utils module and use common error/warning/info functions.
    
    Add a Utils module.  This contains common error/warning/info functions,
    and also quote = Filename.quote.
    
    Examine every existing call to printf/eprintf and change where
    necessary so that:
    
     - error is used instead of eprintf + exit 1
    
     - warning no longer needs ~prog argument (it is added by Utils module)
    
     - any verbose output should go to stdout, not stderr
    
     - info is used to print general informational messages

commit 4ff6ba35502736a2aed1f17eda67728f624c3390
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 24 16:55:36 2014 +0100

    test-tool: Handle mapping other architectures to qemu-system-* binaries.

commit 5018e001290a585ed303bc311cdeeca6b5c11e98
Author: Menanteau Guy <menantea@linux.vnet.ibm.com>
Date:   Fri Oct 24 16:51:02 2014 +0100

    ppc64le: test-tool: Use correct qemu-system-ppc64 binary when creating qemu wrapper.

commit a61d190ed3c7eb0d9389abcd69c44c78dd2be3ad
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 24 14:40:57 2014 +0100

    ppc64le: configure: Look for qemu-system-ppc64 binary (RHBZ#1156449).

commit 62c84c6a551cccd2dfe6b1ca393504c5fea4b435
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 24 09:53:21 2014 +0100

    inspector: Document that -a option can take a URI for remote storage (RHBZ#1156301).

commit a5a0c2f3b047ebb064d54d5029b1d1e475375668
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 24 09:13:25 2014 +0100

    bash-completion: Install symbolic links instead of copies of files (RHBZ#1156298).

commit 68ac0afc8d578bede4a80ebaab07bc54a535a4ef
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 24 09:12:56 2014 +0100

    bash-completion: Replace 'ln -sf' commands with rm; $(LN_S).

commit 46f9dd5290668edca2832164349f6f325826d2cd
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Oct 22 19:23:18 2014 +0200

    configure: map also amd64 as host_cpu to x86_64 qemu

commit 7fcac5f59f80f4deca8a55d77a1d9842dc6b5449
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Oct 22 18:13:49 2014 +0200

    tests: switch from get_current_dir_name to getcwd(0, NULL)
    
    get_current_dir_name exists on GNU libc only, so not portable.
    On the other hand, while POSIX leaves a null buffer argument for getcwd
    as unspecified behaviour, basically the most used/important Unix
    implementations (GNU libc, FreeBSD's libc, etc) allow such value,
    returning a new allocated buffer with the current directory.
    
    In any case, the change just affects two tests, so even if it hits a
    libc not implementing this behaviour for getcwd, only tests are
    affected.

commit 3784a42d03857eae1e06c2a00bef7490793d395f
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Oct 22 10:20:01 2014 +0200

    customize, mllib: use the libvirt CFLAGS
    
    uri-c.c and perl_edit-c.c end up (directly or indirectly) including
    guestfs-internal-frontend.h, which in turns includes libvirt/libvirt.h;
    hence, make sure to use the libvirt CFLAGS.

commit 0a2534c4f1e9c905c79b45f2bc774edc0638a07a
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Oct 20 18:11:00 2014 +0200

    actions: mark as IfNotCrossAppliance tests of command and command_lines
    
    All these tests copy to the appliance a tool built on the host, and run
    it.

commit 349536bf70d8f546c209b08d1b31446cde242785
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Oct 20 17:59:56 2014 +0200

    tests/c-api: add a way to skip test when host and appliance differ
    
    Add a IfNotCrossAppliance prereq for tests, so a test using it can only
    be run when the appliance is a copy of the running host system; this can
    help marking tests which run stuff (usually built in the host) inside
    the appliance.

commit 3de9fa7ba9090f3a279bae08faaa5447dda92d6d
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Oct 20 16:32:01 2014 +0200

    build: use $(SED) instead of sed when possible
    
    Make use of the sed executable set at configure time.

commit ea9b225480cb2ea9c6c3bb5fd0363648fb2ccbce
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Oct 20 12:28:46 2014 +0200

    Include stdint.h where needed
    
    Required for using int64_t, etc. Apparently implicitly pulled so far.

commit abd93812ca0cd845b4e1133126391b429ec944ce
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Oct 20 10:39:03 2014 +0200

    tests: isolate iso_system_id baseline string
    
    Move the reference iso_system_id for the isoinfo_device test to an own
    define for Linux, with an error for unknown OSes.

commit d2c853f41435c6ac7507f4c152efef7ba7d0ec7c
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Oct 17 14:46:40 2014 +0200

    builder: rename "program_name" into "progname"
    
    "program_name" is already used as shorthand define for
    program_invocation_short_name.

commit 57512e778558c5b93cfa360c83836c2cf8fc5908
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Oct 17 13:53:50 2014 +0200

    normalize iconv handling
    
    Since the signature of iconv() changes between implementations (the
    constness of the second parameter, in particular), make use of the iconv
    module of gnulib to handle these potential differences, including an
    external (out of libc) iconv implementation.

commit b44bf2170248d5a832aa4ace9722eb81fe0519d0
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Oct 16 15:16:28 2014 +0200

    p2v: remove unused variable

commit 471ed473cf8d20020f1df90e86ff142072d198f6
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Oct 16 11:55:33 2014 +0200

    fuse: test-fuse: enclose acl vars within HAVE_ACL
    
    Enclose the acl-related variables within a #ifdef HAVE_ACL block, so
    when building without acl support and -Werror it can build.

commit c1ad89170d19312311699f1d36990ab504542e5c
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Oct 16 10:42:05 2014 +0200

    build: look for and use sys/endian.h
    
    Some OSes have sys/endian.h instead of glibc's endian.h.

commit b7d2226926694827e04cdc0fd0887c7b81c32c86
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Oct 16 10:29:24 2014 +0200

    Include sys/wait.h where needed
    
    Required for using WIFEXITED, WEXITSTATUS, etc. Apparently implicitly
    pulled so far.

commit 78b27cc0b64a3e7b72602fc05102968b34fe529d
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Oct 16 09:29:45 2014 +0200

    Include string.h where needed
    
    Required for using strlen, memcpy, etc. Apparently implicitly pulled so
    far.

commit 65f830b84ca9573db51dc4e0d3a3a9ee1fd5f12f
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Oct 16 09:28:33 2014 +0200

    build: use the ptsname_r gnulib module
    
    virt-p2v uses ptsname_r, which is not portable but implemented by
    gnulib.

commit fd70cdc3c58a9f240ef8dbbef73ed13054917220
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 23 15:43:25 2014 +0100

    ocaml: Pass -annot flag to compiler.
    
    This generates .annot files that contain type information.
    In emacs + tuareg mode, using C-c C-t displays the type of the
    underlying expression.

commit 90dc8942bf34a6b42ca3e8b58ed2bb15ebbd7918
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 23 15:41:49 2014 +0100

    ocaml: Factor out flags into configure script.
    
    No change, just refactoring.

commit fdaaa005136bf041e54a2e04006718641074221c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 22 14:40:02 2014 +0100

    Version 1.29.1.

commit ad78d1492b02eaf5d810e2f9d012a5fed4f4124b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 22 12:00:36 2014 +0100

    v2v: -i libvirtxml: Fix handling of nbd sources (RHBZ#1153589).
    
    Previously I modified the parse_libvirt_xml function to get rid of the
    awkward 'map_source*' functions, and have the callers map over and
    modify the source disks afterwards.  However this broke the case where
    an "nbd:..." URL was returned by parse_libvirt_xml, since the callers
    might try to map this URL (eg. turning it into an absolute path).
    This broke virt-p2v specifically.
    
    This commit changes parse_libvirt_xml to return a list of tuples
    containing disk information, giving the callers more information with
    which to do the mapping.
    
    This fixes commit 3596165282ccf2c5896894ec4e9a71c6da788463.

commit dbe35729a3fbb7150275584dd0c5aa7d86c8e03e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 22 12:35:53 2014 +0100

    v2v: Add some assertions to check the source was created correctly.

commit e1eccae2da3a670c1ef7626c8779b71fb1877f7d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 21 13:36:55 2014 +0100

    v2v: -i ova: Don't fail when given a relative path to an OVA directory (RHBZ#1155121).

commit 496d0c45bc5e8c361d2cccb20b0f3a64443b05ab
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 20 21:48:08 2014 +0100

    v2v: vcenter: Hoist readahead configurables to top of file.
    
    No change, just code motion.

commit b8f826b7ac1e7f90f670f474c3582b56063cdef6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 20 20:41:29 2014 +0100

    v2v: Inline and simplify Xen and vCenter input methods.
    
    Take the opportunity presented by the refactoring in the previous
    commit to inline and simplify functions in these input subclasses.
    
    This finally removes the map_source* functions.

commit a468fde01687914de501f0a95cd5a40986daec29
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 20 19:35:23 2014 +0100

    v2v: Refactor Xen and vCenter code.
    
    This refactors the code into more logical units, based on the previous
    commits.  So Xen + the input_libvirt Xen code is grouped and moved
    into a new module called Input_libvirt_xen_ssh.  Similarly VCenter +
    input_libvirt vCenter code is moved to Input_libvirt_vcenter_https.
    
    There is no change here, purely code motion.

commit 9281dc7d44b7b02c6470a61425aa177e6525ee88
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 20 18:34:48 2014 +0100

    v2v: vCenter: Adjust readahead parameter between conversion and copying phases (RHBZ#1151033) (RHBZ#1153589).
    
    Previously we fixed RHBZ#1151033 by increasing the cURL readahead
    parameter to a large value.  Unfortunately this is too large -- and
    hence slow -- for the conversion phase, which broke on slow vCenter
    servers (RHBZ#1153589).
    
    What we do now is to perform the conversion phase with the default
    readahead (2MB) to ensure stability, since performance of the
    conversion phase is not critical.  Then before copying we change the
    readahead to the larger value (64MB) to ensure efficient copying.

commit 0084736f5fe75f62f72f0014333b32ab753b1554
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 20 18:21:38 2014 +0100

    v2v: Add input#adjust_overlay_parameters method.
    
    This is called before the copying phase to allow the input method to
    adjust overlay/backing parameters.
    
    The default implementation does nothing, so this commit has no effect.

commit 63387fd8d0d77f7fdaaad14e5053b86ae51cbd6e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 20 18:18:54 2014 +0100

    v2v: Add a unique number to source disks.
    
    Note that it doesn't matter what the number is, as long as it's
    different for each disk.
    
    The unique number lets us store extra data in input objects which is
    associated with each disk.

commit 3596165282ccf2c5896894ec4e9a71c6da788463
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 20 18:02:57 2014 +0100

    v2v: -i libvirt: Refactor map_source* functions.
    
    Get rid of the awkward map_source* functions, and replace it with
    equivalent code which modifies the source disks objects coming back
    from Input_libvirtxml.parse_libvirt_xml.
    
    This is just code refactoring.  Apart from the order in which certain
    tests are done, this should be equivalent to the previous code.

commit 9596fc44ff522f5f993a3c5ef9bb24a9a1b4a996
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 20 17:37:04 2014 +0100

    v2v: -i libvirt: Create three specialized subclasses for handling vCenter/Xen/other.
    
    Previously we had one class ('input_libvirt') which handled all three
    cases.  Now we have one superclass ('input_libvirt') and three
    subclasses of that ('input_libvirt_vcenter_https',
    'input_libvirt_xen_ssh', 'input_libvirt_other') which handle the three
    cases separately.
    
    This is just code motion, and should be functionally equivalent to
    what was here before.

commit 9ddfbad814e55553d9d1cea08134311c12923cfe
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 20 14:03:13 2014 +0100

    v2v: Increase vCenter https timeout to 10 minutes.

commit 0b49defc2b4307e1f9159b862637978129aaed29
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 20 14:01:25 2014 +0100

    appliance: Set udev.event-timeout to override default too low udev setting.
    
    Unfortunately udev removed the udevtimeout setting on the kernel
    command line.  This means the default timeout was being set back to 30
    seconds, which is way too low for remote disks.
    
    However it was re-added (2014-07-29) as udev.event-timeout.  Set both
    to be sure.
    
    Note this requires systemd >= 216.

commit 3276845df1847d037fc4a5bed24966e0f9a0d564
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Oct 14 11:10:22 2014 +0200

    diff: do not pad uid/gid in CSV mode

commit 87941d183f4a96b4d936c2e94a79a60288f0dc74
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Oct 13 16:49:59 2014 +0200

    cat, diff: avoid double slashes in paths (RHBZ#1151910).
    
    In full_path, skip the trailing slash in the base directory when
    different than "/", as the slash will eventually be added when building
    the resulting path.

commit e5befcacc5f7c1a6bd67fcdb92afede1a82d50eb
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Oct 13 15:51:34 2014 +0200

    ls: in CSV mode, always have a checksum field (RHBZ#1151900).
    
    Make sure to output the field for checksum even for non-regular files,
    as empty, in CSV output mode. This ensures each line has the same number
    of fields, regardless of the file type.

commit 9019c4eb0621397163f0092c5c00ebb969d14152
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 18 21:57:10 2014 +0100

    v2v: -i ova: Add a test for *.vmdk.gz compressed files (RHBZ#1152998).

commit f27a582b6dd85a2810351cf7c2d2c98dc5ea6e9a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 18 21:45:10 2014 +0100

    v2v: -i ova: Add a test for ZIP as a container (RHBZ#1152998).

commit ede39a7591122abe29fc6de29aaa717ee9f8bb55
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 18 18:54:12 2014 +0100

    v2v: Handle *.vmdk.gz compressed files (RHBZ#1152998).
    
    The OVA spec allows the disk images to be gzipped within the OVA
    container.

commit 60405e5aa1b89ce4ad8b27efb992e82e38d6dbeb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 18 18:41:43 2014 +0100

    v2v: -i ova: Allow directories and ZIP files to be used as input (RHBZ#1152998).
    
    OVA is not a particularly well-specified format.  The specification
    allows a directory to be an OVA, so enable that.  The spec doesn't
    mention that ZIP can be used in place of tar, but since we have seen
    these in the wild, allow that too.

commit d8e26d0e4dc3de649cf81584e8c060becd2e4531
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 18 18:41:01 2014 +0100

    mllib: Enhance and rename 'detect_compression' function so it can detect a few more file types.

commit a7a5a223d4ca17b09a1e489fb3f147a2102f98d7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 18 13:53:19 2014 +0100

    v2v: Change --help text URLs so they don't reference esx as main server.

commit 1f97a5df7673aa3a6e4208a421a87fd14369675c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 18 10:27:23 2014 +0100

    p2v: Test did not recognize '1.XX.0' as a valid version number.
    
    Thus breaking when we changed the version number to 1.28.0.

commit cbad8e6d5114798bd3fdd279c801e1b97c648692
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 18 09:45:04 2014 +0100

    Version 1.29.0.

commit 305f0050eb7844919de24409a3cb919827f7e0db
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 18 09:26:37 2014 +0100

    Version 1.28.0.

commit 3b3b507a1ee3125e61ecdd1dfd9153d710db25fb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 18 09:02:41 2014 +0100

    Update translations from Transifex.

commit d57660d5d657ffbdb4011dd6f20a3cc39673c96d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 18 09:02:18 2014 +0100

    Update release notes for 1.28 release.

commit d3548012e90251c03f50b83e582ea92ddba0ac79
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 18 09:12:03 2014 +0100

    Update API support for 1.28 release.

commit 6e5039d1ef69acf38b2cdbd3d4b634887ae00979
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 17 17:38:07 2014 +0100

    Version 1.27.64.

commit 288bc73bb02fcf69b952a80fc4efe89337bfab4b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 17 17:37:37 2014 +0100

    v2v: Add test files to EXTRA_DIST.
    
    This fixes commit 852f2e8e3c3228be4b9cd2be5b1d5da10a41fe32.

commit 97c96ed6702cb7b4dfcc5acd08a29cb6f2b70b54
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 17 17:18:25 2014 +0100

    v2v: Windows: Add &REV_00 variant, which is used by W2K8R2.

commit 4f6033c3f4428f2c0033dfc256e71f05db17c3c2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 17 17:14:52 2014 +0100

    v2v: Windows: Fix quoting and type of viostor ImagePath parameter.
    
    The way to fix these bugs -- for future reference -- is as follows:
    
    (1) Install the corresponnding Windows version with virtio enabled.
    See:
    
    https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/7/html/Virtualization_Deployment_and_Administration_Guide/chap-KVM_Para_virtualized_virtio_Drivers.html
    
    (the ".vfd" method)
    
    (2) Download the SYSTEM and SOFTWARE registries from the
    virtio-enabled guest.
    
    (3) Examine each registry using 'hivexsh', especially the keys which
    we modify during virt-v2v (see v2v/convert_windows.ml).  Remember to
    use both the 'ls' and 'lsval' commands in hivexsh.
    
    (4) Download the SYSTEM and SOFTWARE registries from the guest that
    fails to boot.
    
    (5) Examine the same registry keys from each registry using 'hivexsh'.
    
    (6) Work out what the differences are, paying particular attention to
    quoting and the type of each key (eg. str(1), str(2), etc).
    
    Thanks: Matthew Booth.

commit ca6d7d9c34dacf83dc8611c74f66cfe208fcdc0b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 17 13:44:35 2014 +0100

    v2v: Print version of virt-v2v in debug output.
    
    Easier than asking users to send us this information, which they often don't.

commit e2e17055742c3de6145406033b16716f259949f2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 16 18:02:46 2014 +0100

    v2v: Add new section on resource requirements of virt-v2v to the manual.

commit 852f2e8e3c3228be4b9cd2be5b1d5da10a41fe32
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 16 14:08:17 2014 +0200

    tests: v2v: Test -i ova with two input disks.

commit d8849fadbdb88d1afa03174ab36057afba7a0fc7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 16 15:58:41 2014 +0100

    v2v: -i ova: Fix it so it actually verifies SHA-1 hashes from manifest files.
    
    There were two large bugs before: (1) It only found one manifest file
    (meaning that multi-volume OVAs would be broken).  (2) The regular
    expression didn't work so it wouldn't check the hash.  Bugs (1) + (2)
    combined so that the check just didn't do anything at all, which is
    why we didn't notice the multi-volume problem.
    
    Actually I suspect we shouldn't be doing this check at all, since I
    bet there are OVAs out there with broken SHA-1's.

commit 249aae0c2ffa685008c03f5d06e05c2989b1ec99
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 16 08:36:33 2014 +0200

    handle: Process empty LIBGUESTFS_* environment variables correctly (RHBZ#1153515).
    
    Ignore an environment variable:
    
     - if an environment variable is an empty string, AND
    
     - if an empty string would have no meaning for that environment
       variable (eg. LIBGUESTFS_BACKEND can only take on certain values,
       and an empty string is not one of them).
    
    Note that LIBGUESTFS_BACKEND_SETTINGS is meaningful as an empty
    string, and for this case I have removed the STRNEQ (str, "") test.
    
    Previously:
    
    $ LIBGUESTFS_BACKEND="" guestfish -a /dev/null run
    libguestfs: error: invalid backend:
    
    After this commit:
    
    $ LIBGUESTFS_BACKEND="" guestfish -a /dev/null run
    
    (no error message is printed)

commit 93c2769e2bb6a19b216d78216d062e4d99f43dbf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 15 22:19:19 2014 +0200

    Version 1.27.63.

commit 4511137c054416f407ff4e05c82ca6b9abc62d8a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 15 21:23:33 2014 +0200

    tests: v2v: Check -i ova generates the same XML each time.

commit 717c73d22b57dc2c06a80ca516b83591c64caafa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 15 21:18:21 2014 +0200

    v2v: -i ova: Try hard to preserve the order of floppies and CDROMs from the original OVF.
    
    Remove the common 'add_resource' function.
    
    Duplicate that function into code for adding disks, and separate code
    for adding removables (floppies & CDROMs).
    
    The removables code should look for all removable devices
    (ResourceType 14, 15, 16) in a single query, so that the order doesn't
    depend on the order in which we do the queries.

commit 59015939abc63de27fc6e8329a23f3087fd3f91a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 15 21:04:33 2014 +0200

    v2v: -i ova: Preserve the order of disks/removable/NICs from the source OVF.
    
    Because we built the lists up backwards, we ought to reverse them
    before passing them out of the module.

commit 516a95824a9a5408c353dc9843492b5092fbe0fc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 15 21:00:21 2014 +0200

    v2v: -i ova: Mainly whitespace and formatting changes.
    
    Mainly tidy up the indentation and comments to match the "house
    style".  No significant functional change.

commit 94f2eb8b26cef7faa42eba7c9cbe39d6a25858bd
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Oct 13 15:06:30 2014 +0200

    bash: add virt-log completion entry (RHBZ#1151766).
    
    Thanks: Lingfei Kong

commit 88a482dd9f6f1b842350edd0437dfe621ebcf510
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 13 13:07:43 2014 +0200

    v2v: Add 'exit' choice to --root ask.
    
    If the user does ^C then this leaves temporary overlay files around
    (possibly a bug?).  Offer an 'exit' choice to the user which exits
    cleanly.
    
    The new message looks like this:
    
      Dual- or multi-boot operating system detected.  Choose the root filesystem
      that contains the main operating system from the list below:
    
       [1] /dev/sda3 (Fedora release 20 (Heisenbug))
       [2] /dev/sdb3
    
      Enter a number between 1 and 2, or 'exit': exit

commit 04de9d3df064ab32ea31a0b803f29466cc0fc0d9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 13 11:40:00 2014 +0200

    v2v: When choosing a root from several, print an info message.

commit 2ba45489a1e296b89d3c32ef80e57efc13f32a88
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 13 11:39:24 2014 +0200

    v2v: Add an 'info' function for info messages, and use it for virtio message.

commit 2b4ba9d692d1dfa08b19459305477fd22b6066d8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 13 11:36:15 2014 +0200

    v2v: --root ask: Number the guests in the list correctly.
    
    Thanks: Junqin Zhou

commit 145a188f7056d4414adef472e95cad5640d79511
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Oct 13 11:02:14 2014 +0200

    edit: fix --format documentation (RHBZ#1151738).
    
    Use only --format=FMT as a way to specify a format, as the version
    without the equal sign will not work for that.

commit e3722252295921d095fc124bbb2f7698a510fafe
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 10 16:58:48 2014 +0100

    Version 1.27.62.

commit 5c7cb0ac7c8b0516ae56966b037fba36c1518b6a
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Oct 10 17:03:59 2014 +0200

    builder: use the JSON module
    
    Switch to the JSON OCaml module for JSON output.
    
    The resulting output is the same, except from an indentation level more
    within lists.

commit 901de75ff42f169880f5c2356483d30c1e1b04eb
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Oct 10 16:55:47 2014 +0200

    mllib: improve JSON: more types, indented output style
    
    Improve the homebrew JSON writer:
    - add more types (including also nested dictionaries and lists)
    - format in a compact way (single line), or indented (multilines)

commit bb0d7edfa017ed39f9a4f95b785bd50761cdb8ae
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Oct 10 15:10:20 2014 +0200

    Move JSON to mllib
    
    Move the simple OCaml JSON writer to mllib, so that can be enhanced and
    used also outside v2v.

commit 75b45143f0fe3df2449d1e6b523b63e2380c89aa
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Oct 10 15:09:27 2014 +0200

    appliance: remove few duplicates from Mageia's list

commit 7893a2cfb1b2e2e8fba9ceab35b498025fbe535a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 10 11:47:26 2014 +0100

    FAQ: Add a section on debugging libvirtd.

commit 632803856701bd664f8f482a5bfcaed6715cd36e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 9 18:07:33 2014 +0100

    v2v: Rename some modules to remove lib_ prefix.
    
    v2v/lib_ovf.ml -> v2v/OVF.ml
    v2v/lib_ovf.mli -> v2v/OVF.mli
    v2v/lib_linux.ml -> v2v/linux.ml
    v2v/lib_linux.mli -> v2v/linux.mli
    v2v/lib_esx.ml -> v2v/vCenter.ml
    v2v/lib_esx.mli -> v2v/vCenter.mli
    v2v/lib_xen.ml -> v2v/xen.ml
    v2v/lib_xen.mli -> v2v/xen.mli

commit 88a381b2a065e0447281eb3ca7a215b3855c98b0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 9 16:04:01 2014 +0100

    v2v: Increase readahead window for vCenter transfers (RHBZ#1151033).

commit 8f3a2ca5358d5601be7a9247b6d08193c4e2da46
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Oct 9 14:53:53 2014 +0200

    appliance: add dhcp-client on Mageia
    
    dhcp-client replaces the non-existing dhclient.

commit 979e7a49147f4ef1387337db262bf7ea12f627e3
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Oct 9 14:53:10 2014 +0200

    appliance: add dhcpcd and gptfdisk on Archlinux
    
    dhcpcd replaces the non-existing dhclient.

commit e21a4e5a90ccc5dce49d4fac5f3f4750e3fee182
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 9 10:30:01 2014 +0100

    Version 1.27.61.

commit 626d85d80be994065951b5f17706ca33ca5fc152
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 9 10:15:55 2014 +0100

    v2v: -i libvirt/libvirtxml: Give a better warning for local displays (RHBZ#1150880).

commit 4d4cada65a09dd40940aa021ba7a52b5fbf266be
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 9 09:34:11 2014 +0100

    daemon: copy-file-to-file: Unlink destination file on failure (RHBZ#1150867).
    
    When copying from file to file, don't leave the destination file
    around if the copy fails.
    
    However in the same code don't try unlinking the destination device on
    failure.

commit fbbcc6c6298dc7084891703bdb5af97541c29bdc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 9 09:29:31 2014 +0100

    sparsify: Fix documentation of --check-tmpdir option (RHBZ#1150858).

commit 9d6efb4966c4d0c9f528af8eb901acde65ce4825
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 9 09:21:06 2014 +0100

    diff: Remove copy and paste mistake from the documentation (RHBZ#1150815).
    
    Originated from copying this section out of the virt-ls man page.

commit f8f6250612a44ef56dc8ee8574058a7fdf30ee8f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 8 22:32:03 2014 +0100

    v2v: Allow -b/-n as alias for --bridge/--network.
    
    This was permitted by old virt-v2v too.

commit e66138fbe71c24df3a282e1b23d8ed5c80f7b8c7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 8 21:17:43 2014 +0100

    v2v: Enable trimming of data disks and non-mountpoints (RHBZ#1150701).
    
    This also modifies the --no-trim option so you can specify a device
    name, since this is necessary if fstrim can apply to non-mountpoints.

commit 69fe3945b7641811c99c3c03e05e73d2347e8a42
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 8 21:16:48 2014 +0100

    v2v: Fix the --no-trim option so it works.
    
    We never updated the no_trim variable in the case where this option
    was supplied, so it never did anything, proving once again that unless
    you have a test case, the feature won't work.

commit 36ce0e65f693b21a1557086f10fd49be40da720d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 8 20:21:36 2014 +0100

    v2v: Print virtual and real copying rates.
    
    Useful to diagnose speed issues in the qemu block drivers.

commit 7b8ed81560874a4992c249848dd49a4815b1d79d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 8 20:21:06 2014 +0100

    v2v: Print mountpoint stats in debugging output.
    
    Useful for debugging speed / fstrim issues.

commit 1e9b707e9bbcdba22caa262b33cc79c863c26c34
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 8 15:44:01 2014 +0100

    Version 1.27.60.

commit 6d0f46bacbace13b7c74c092dd7c9356dc4bd41f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 8 15:41:44 2014 +0100

    v2v: Add README.RHEV-M to EXTRA_DIST.
    
    This fixes commit 8adc32cae8898817bfa2ed7669eda1f6c4aa3dae.

commit c4bad9deaf04b4329d0ecb38c007017d6330391c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 8 15:00:25 2014 +0100

    v2v: -o rhev, -o vdsm: Fix export with multiple disks (RHBZ#1150475).
    
    When translating the original virt-v2v code, I misunderstood how image
    directories are created.  There is one directory under images/ per
    disk image, not one for all the disks in a single guest.
    
    Note this requires that -o vdsm uses multiple --vdsm-image-uuid
    options, one per disk image of the guest.
    
    Reported by: Alain Vondra
    Thanks: Tingting Zheng

commit 43e150c212c311aa9dbf535faa756b34bf7f580a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 8 14:59:52 2014 +0100

    mllib: Add 'combine3' function.

commit 8adc32cae8898817bfa2ed7669eda1f6c4aa3dae
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 8 14:39:40 2014 +0100

    v2v: Add notes about layout of Export Storage Domain for multi-disk guests.

commit 2de1602b707ba33676c2d6fdb98a0591aca08b6e
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Oct 8 13:44:25 2014 +0200

    log: tests: switch to a temporary file for outputs
    
    Using a pipe to redirect the output of virt-log will lose his return
    value, so use a temporary file to collect the virt-log output.

commit 371744bc59a25feeafa308b1aa9b9c9c0d2a0099
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 8 12:40:32 2014 +0100

    Revert "log: tests: fix appending the virt-log output"
    
    This reverts commit cfe2daabb2c146c96b1c291a97f08e58cfcdfd2a.
    
    The pipe hides the return code from virt-log or valgrind.

commit 7c97b01f2754ffb76f94b68497eb5829ffa92390
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 8 12:37:51 2014 +0100

    v2v: Add missing disk <rasd:Caption>.
    
    Possible fix for RHBZ#1150475.

commit cfe2daabb2c146c96b1c291a97f08e58cfcdfd2a
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Oct 8 11:14:28 2014 +0200

    log: tests: fix appending the virt-log output
    
    virt-log uses /dev/stdout as output file for guestfs_download, which
    will open the output file in truncate mode, truncating the output of
    test-virt-log.sh.
    
    Make sure to redirect the output of virt-log so it does not clobber the
    test output.
    
    Thanks to Richard for the hint.

commit aa42bcf54d83df326683b5bb9db68003396dfc6e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 7 15:29:12 2014 +0100

    Version 1.27.59.

commit fd421ebf88653455d8547f546e887cf5c5bfb890
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 7 15:29:39 2014 +0100

    p2v: Fix virt-p2v-make-kickstart so it won't fail when using a custom repo.
    
    Because of `set -e', using the `((i++))' expression causes bash to
    fail, unless we tell it to ignore the error code on that line.

commit b81256581b4cea83ebc9f472df1adcd89ac550ce
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 7 15:04:26 2014 +0100

    Update API support.

commit a97b3b6ae4ff2fd5a31e82a2ab35c559e17cf946
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 7 13:54:50 2014 +0100

    Update gnulib to latest upstream.

commit 09384e8164c795fff03a43b69499f782087c5b0a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 7 13:31:47 2014 +0100

    Update translations from Transifex.

commit 6e204f6ccccee1e6ebe27d940760cc7ea746126c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 7 13:31:36 2014 +0100

    Update BUGS.

commit 8ddae163e49a1ac459fbd3d1ff3a2546af9f75a6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 7 13:20:12 2014 +0100

    Update release notes.

commit a48ade569d485a114d29da358e4a2c36429b7ebb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 7 12:40:41 2014 +0100

    v2v: Further documentation fixes.
    
    Replace more instances of 'esx.example.com' with
    'vcenter.example.com', and rearrange command line arguments
    semantically.

commit f796435628cea8b037d5fc786934583019707c6e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 7 10:17:33 2014 +0100

    FAQ: Need to set SUPERMIN_KERNEL_VERSION in recent supermin.

commit 0f023a080b6612ba3ffba53eb557443adca0a88d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 7 09:27:09 2014 +0100

    v2v: Improve VMware import documentation.
    
    Additional information about URIs, which may contain cluster and/or
    folder names (thanks: James Mighion).
    
    Replace esx.example.com with vcenter.example.com to reduce confusion
    about vCenter vs ESXi.

commit c92734b209e4504e84a051e433c81d4d5449d660
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Oct 6 18:05:53 2014 +0200

    log: tests: skip fedora.img if journal is not available

commit cb1b7cbdd5f92ee41ba70915d74dfa845d2365ae
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Oct 6 16:10:44 2014 +0200

    tools: fix free -m invocation
    
    Since procps 3.3.10, free does not output the "-/+ buffers/cache" line
    anymore. On the other hand, the data from it can be calculated from the
    memory values, so just do the calculation manually (with awk).

commit c4bc416820005d6bc4956b32d9c6e0f83382702d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 6 13:09:58 2014 +0100

    lib: Enable detection of ARM (32 bit).
    
    This includes some empty binaries to use for detection testing.

commit 07f87a7c91736a0a2389c3100d7e3ef83ed55a35
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 6 13:09:46 2014 +0100

    lib: Document output of 'file-architecture' API for aarch64 binaries.

commit 56cfb8a9262c508169fd69ea4ca8a8db4b5a5a35
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Oct 3 14:24:48 2014 +0200

    sysprep: remove more logs
    
    - remove firewalld, grubby, and proftpd logs
    - extend the cups log removal also to its timestamped rotated logs
    - remove also the libvirt/libxl logs

commit 0823416925aa10d6f03b7227214df24dd3b2a823
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 2 17:02:21 2014 +0100

    tests: Fix SKIP_ environment variable in a couple of scripts.
    
    I checked and bug 690819 has nothing to do with either of these
    tests.  It was just a copy and paste error.

commit 7ff5d51815cf7f3beb936512dcc5c95c9d36ee1f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 2 15:55:51 2014 +0100

    Version 1.27.58.

commit 432390757522ec9dc575d4cc4a56f35e42ea301f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 2 15:30:02 2014 +0100

    tests: Disable UML tests in 'check-release'.
    
    This effectively demotes UML to unsupported status.  This has happened
    because UML has regressed quite a lot upstream.  There are multiple
    grave bugs revealed by running the test suite and I don't have the
    inclination to fix them.

commit 765dc6237ce7b93dd2f33d99be53eae92e048a7a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 1 20:12:41 2014 +0100

    tests: rsync: Skip this test when the backend is libvirt.
    
    It would work, except if you have a host firewall which will block
    inbound connections on virbr0 to non-standard ports.

commit 07c0926b588db5c86214917b609c2f477c817c0e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 1 20:12:04 2014 +0100

    appliance: Change example ping lines to ping 8.8.8.8.
    
    This are commented out (still) so this change does nothing.

commit 224de20b9a8d5ea56f6337f19b4ca237bb88eca0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 30 16:44:05 2014 +0100

    launch: libvirt: Use qemu-bridge-helper to implement a full network (RHBZ#1148012).
    
    When using the libvirt backend, don't use the SLIRP.  Use
    qemu-bridge-helper via libvirt to give us a full network connection.
    
    One consequence of this is that 'ping' works in
    'virt-builder --run-command'.
    
    A less useful consequence is that the host firewall will prevent
    connections on non-standard ports to the host.  So you can't (eg)
    connect to a rsync daemon on the host listening on an arbitrary port,
    which worked before.
    
    The default bridge is 'virbr0', but you can override this by setting
    LIBGUESTFS_BACKEND_SETTINGS=network_bridge=<some_bridge>
    
    Note: this does not fix virt-rescue (since it overrides the default
    backend and uses 'direct' for various reasons).

commit 67e6f32a240c7c234e6af637c1cd324b36a82cd3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 30 16:44:04 2014 +0100

    appliance: Use dhclient or dhcpcd instead of hard-coding IP address of appliance.
    
    qemu in SLIRP mode offers DHCP services to the appliance.  We don't
    use them, but use a fixed IP address intead.  This changes the
    appliance to get its IP address using DHCP.
    
    Note: This is only used when the network is enabled.  dhclient is
    somewhat slower, but the penalty (a few seconds) is only paid for
    network users.
    
    On SuSE or other distros, dhcpcd could be used if available.

commit 9018a23828b5c65b677a4ab1d21b776c6d225c73
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 2 13:19:03 2014 +0100

    mllib: Coloured messages, errors, warnings.
    
    Uses ANSI terminal codes to colour the output.

commit 25274b4f75196f77c891d8e858644ad0df1ad6f0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 2 13:01:12 2014 +0100

    v2v: Print the difference between our disk size estimate and actual size.

commit ae19e8f29f43db8514c18009e736e643ad9b25f9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 2 13:00:13 2014 +0100

    v2v: 'du -b' doesn't show real (sparse) size.
    
    This caused the actual size to be wrong (in OVF output).
    Use --block-size=1 instead.

commit 62159d5d48441d5df9706c0a19bc0f416b1e9e46
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 1 16:49:57 2014 +0100

    Version 1.27.57.

commit f23759c330fc8f4a6faba83fc2636d0f6dbf453b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 1 13:40:54 2014 +0100

    v2v: Copy post-conversion tasks section from old virt-v2v documentation.
    
    Copied verbatim, apart from some minor reformatting.

commit d0110a4e239a978326b51dd79ca2b9abe30c1cb5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 1 13:36:47 2014 +0100

    v2v: Copy -o rhev information from old virt-v2v manual page.

commit 886c566756d02f8568c20585a0936c387105b061
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 1 12:11:50 2014 +0100

    lib: Avoid rewriting LV names when creating canonical device name (RHBZ#1148355).
    
    Thanks: Timothée Ravier

commit c9c65e08eb595f92168dfd0e284aa8ba5525c1a7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 1 10:07:08 2014 +0100

    v2v: Add note to man page about removing VMware tools before conversion.
    
    Thanks: Matthew Booth.

commit d39744a030d075cdff82f1ca4c80ec40bdcfb699
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Oct 1 10:12:38 2014 +0200

    sysprep: add no-op --no-selinux-relabel (RHBZ#1148072)
    
    Add a no-op --no-selinux-relabel option, to be compatible with
    virt-sysprep < 1.26.

commit 011b5da6f5db32d22d176f3750e3417a6ad9d553
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 30 13:28:31 2014 +0100

    p2v: Fix reference to virt-v2v(1) in manual page.

commit 7357dcd8789be73952ba3a294f1c34eb18ec2e31
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 30 11:27:35 2014 +0100

    resize: Don't test MBR extended partitions while virt-resize handling is broken.
    
    The intention is to fix virt-resize and then revert this commit.

commit 6f196df4145847659b81c91b7314fe7e0775ad94
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 29 14:45:13 2014 +0100

    resize: Rewrite the tests to use a stochastic testing method.
    
    The previous tests were very limited, and ran the same two tests
    on every run.
    
    Randomly test:
     - MBR vs GPT
     - Primary, extended partitions
     - Expanding vs shrinking
     - Use of multiple --resize parameters
     - Source and target raw vs qcow2 formats
     - Resizing various different filesystem types
     - LV expand
     - extra partition or no extra partition
    
    To run the test over and over again (useful for finding regressions in
    virt-resize), do:
    
      while (cd resize; LIBGUESTFS_TRACE=1 ../run ./test-virt-resize.pl) >&/tmp/log ; do echo -n .; done
    
    If it fails, you can see the failure in /tmp/log.
    
    To rerun a specific test, search for the 'seed:' in the output of the
    original test, and specify it on the command line:
    
      (cd resize; ../run ./test-virt-resize.pl --seed=<SEED>)

commit 225257b67a921c9baa46c6d6d99b6c3ffe732290
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Sep 30 13:51:16 2014 +0200

    inspect: document also MINIX as OS
    
    Followup of commit 5b65d05d5a31415aaa6f284f73da745e0ee0408a.

commit 23d4cec345dfd587a07b73cdbfba43516e63a883
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 29 16:06:06 2014 +0100

    Version 1.27.56.

commit 42775561aa6d937bd8b8f1368c47de32bf310670
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 29 16:19:31 2014 +0100

    v2v: Add v2v/HACKING file to EXTRA_DIST.
    
    This updates commit ce814c6b6cdf939c95e70741c84c1757c72edf60.

commit 6495b07cc00ce1e21da2741d112c6d8c17b6271f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 29 14:49:11 2014 +0100

    resize: docs: --expand is above, not below, the current point.

commit a0dad3621f362ecdd2cbd6494243207d3dbd6df9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 29 14:48:41 2014 +0100

    resize: Using qemu-img create -c doesn't create a compressed qcow2 file.
    
    Remove inaccuracy from the manual page.

commit 35daabed8f6da1b6039c4fd32848dcff6347e0dd
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Sep 29 13:49:09 2014 +0200

    customize: fix attributes of /etc/shadow (RHBZ#1146275)
    
    When saving a configuration file, Augeas creates a new file and
    replaces the old one with it; this creates a /etc/shadow file without
    the SELinux xattrs, since they are missing.
    
    Thus, create a temporary file with all the attributes of /etc/shadow, so
    all the attributes of it (permissions and xattrs, among others) can be
    restored properly on the new /etc/shadow.
    
    As side effect, if a guest is already properly SELinux-labelled, then
    there should be no more need to relabel it to make sure /etc/shadow
    still has the right SELinux xattrs.

commit 5f9437ca4bb842b1e8ae91ffbf3c73820780c5a6
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Sep 29 13:48:10 2014 +0200

    builder, customize: disable SELinux
    
    Having SELinux enabled (even if not enforcing) in the appliance causes
    troubles to applications/libraries that read/write SELinux attributes.

commit 49ee9a21333adec00f3f943eaf1712a8ef3273bd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 29 12:07:19 2014 +0100

    resize: Simplify if-conditional in mbr_part_type function.
    
    This should be equivalent to the previous code, but it makes it easier
    for the compiler to pick up errors (eg. missing cases).
    
    This updates commit fc34e2d16c2d13d6ae7a381ba931e345ab5ae56d.

commit fc34e2d16c2d13d6ae7a381ba931e345ab5ae56d
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Fri Sep 26 11:04:07 2014 +0800

    resize: add function mbr_part_type
    
    Function mbr_part_type returns one of "primary", "extended" and
    "logical". The type is used by parted when adding partitions.
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit 80bd9082b5396d1e23751566e8e530fe3b2809cd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 29 12:04:32 2014 +0100

    resize: Fix whitespace in calculate_target_partitions function.
    
    This updates commit 21677c5b46468609d393a724ea629d948c87aec7.

commit 21677c5b46468609d393a724ea629d948c87aec7
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Fri Sep 26 11:04:06 2014 +0800

    resize: add function calculate_target_partitions
    
    And introduce parameter create_surplus to indicate whether to
    create surplus partition or not. Later this parameter will be
    used by when calculating positions for target logical partitions.
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit 5aa7e99cb9bba7eb7ab0d826fe76b29d9b1c9b2e
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Fri Sep 26 11:04:05 2014 +0800

    resize: add function find_partitions
    
    find_partitions can find partitions of given type.
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit cbb54a38493b8ee8b1c7db948f2030f014bfc21e
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Sep 29 11:18:56 2014 +0200

    diff: flatten also atime nanoseconds
    
    When not considering atime changes, flatten also the nanoseconds.
    
    Followup of commit 8664337cc39c8575ccb60abb8c6e30f92828ea51.

commit bdbe2f42aed589ea6319ce872304fe0998e30623
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Sep 28 21:13:34 2014 +0100

    v2v: Document when you need to run virt-v2v as root, and how to avoid it.

commit ca71b7c169dc233d4c4ce670b0fb3badc89abd19
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Sep 28 21:13:12 2014 +0100

    v2v: Use Glance (capitalized) consistently in documentation.

commit 5be7263760461ddb55662020373f39927499ba0a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 27 19:35:13 2014 +0100

    p2v: docs: Change boilerplate in description to reflect reality of hypervisors we support (continued).

commit e5fcb6e5db5b2586f5b69ccaf6fe9b871565415a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 27 21:51:22 2014 +0100

    p2v: Fix documentation for p2v.of kernel command line option.
    
    Copy and paste errors.

commit ae8b283038959d99a64a0268d536357f7c6a4a3b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 27 21:21:57 2014 +0100

    p2v: Revise virt-p2v(1) manual page.

commit b8130786bd1012fc68bcfc16478b923dc511e1c9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 27 19:35:55 2014 +0100

    p2v: Use "panel" consistently through documentation.

commit 4456d64e8fae28e6c8c1e88d4d846e1cdec8484a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 27 19:35:13 2014 +0100

    p2v, v2v: docs: Change boilerplate in description to reflect reality of hypervisors we support.

commit 2ae0e32da655e257d017c27d47fdd33d401842e7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 27 18:39:48 2014 +0100

    p2v: Document the virt-p2v GUI dialogs.

commit c9f2e4e7f152e89ed3b4b19d38151b119d27631d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 27 17:11:51 2014 +0100

    p2v: Rename guest.xml -> physical.xml.

commit ce814c6b6cdf939c95e70741c84c1757c72edf60
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 27 16:49:28 2014 +0100

    p2v, v2v: Document how it works for hackers.

commit 4c1ca9f880a55f1016114c4b4f607b4cedbaa2b1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 26 20:09:44 2014 +0100

    Fix update-bugs.sh script so it doesn't write an empty BUGS file.

commit 5498d021d012522c695ddcaa8ade9cb0ede2a024
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 26 19:30:57 2014 +0100

    v2v: Don't warn about being unable to rewrite /dev/cdrom (RHBZ#1146815).
    
    Old virt-v2v probably emitted the same warning.
    
    However it seems unlikely that /dev/cdrom needs to be remapped, as
    udev or the user should be able to supply a suitable symlink from
    /dev/cdrom to the removable device.  Therefore suppress this warning.

commit b03c2a971ae66e6bfb66090b2860cfee89241f93
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 26 19:26:14 2014 +0100

    v2v: Generate qemu-0.10 compatible qcow2 files for RHEV-M.
    
    RHEV nodes running on RHEL 6 cannot read the new qcow2 compat=1.1
    (a.k.a qcow2 v3) format.
    
    Thanks: Junqin Zhou, Tingting Zheng

commit 159d246b1dc4aae69ea04bbaeebaf3edd1fbcf23
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 26 19:14:57 2014 +0100

    v2v: Add documentation for diagnosing RHEV-M import problems.

commit 7ebab447935a3b4045470eff8bc880d34d584f03
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 26 17:14:19 2014 +0100

    Version 1.27.55.

commit dc6bba83387c460145aa3ea87f1b8f00b59a8334
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 26 14:06:48 2014 +0100

    v2v: -o qemu: Add a display to the shell script.

commit f7cd8b4d1069e4b58b4e4391ef84bddd6a3e2735
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 26 14:06:22 2014 +0100

    v2v: -o qemu: Only add a serial console to Linux guests.
    
    Makes no sense for Windows guests.

commit 630ab4c22afb91c69e1cc3ee0b6dba6f39a47dbe
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 26 14:03:21 2014 +0100

    v2v: -o qemu: Refactor end of line handling.

commit 2365c2dbccd84ff68919dd131624861da293bf44
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 26 14:01:37 2014 +0100

    v2v: Add a source 'window' display type.
    
    This maps to SDL/GTK, ie. qemu opening a window on the desktop.
    We only use it for -i disk -o qemu to help with debugging.

commit ea015319b06acb76a5bd89961b16c2bc82aff74e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 26 12:42:08 2014 +0100

    v2v: Add --no-trim option, allowing fstrim to be suppressed.
    
    Mainly useful for testing whether fstrim is responsible for various
    unexplained boot failures.  We can also suggest it in the field.

commit ad300fcd5e497c401589d54efd9d80334ff41b1b
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Sep 26 14:27:04 2014 +0200

    fuse: test-fuse: use acl_to_any_text
    
    Switch from acl_to_text to acl_to_any_text, so it is possible to specify
    options, like forcing the numeric IDs for users/groups. This ensure the
    resulting string has always numberic IDs, so the comparison can always
    succeed.
    
    Adapt the comparison string to the lack of final endline now.

commit 0db22ee7a70cc51f85b80af180f1d8f55cef5f0c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 26 10:21:07 2014 +0100

    v2v: windows: Sort files before uploading.
    
    This makes it easier to compare the trace output from different runs
    of virt-v2v.

commit 03ef91aa46e036b84a687a7c891720aeea651a17
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 26 10:06:00 2014 +0100

    v2v: Add --debug-overlays option.
    
    You can use this to accelerate testing:
    
      $ virt-v2v --no-copy --debug-overlays [etc]
      [...]
      [  82.0] Converting Windows 7 Ultimate to run on KVM
      This guest has virtio drivers installed.
      [  86.0] Closing the overlay
      [  91.0] Creating output metadata
      Overlay saved as /var/tmp/win7-test-sda.qcow2 [--debug-overlays]
      [  91.0] Finishing off
    
    No disk format conversion/copying is done, so it's very fast.
    
    The overlay file is preserved and can be tested directly (it uses the
    source file as backing).

commit dbff48de392717e36dd040a241d67462fdc68a14
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 26 10:05:30 2014 +0100

    v2v: Don't use Unix.unlink since Unix module is open in this file.
    
    Minor code refactor.

commit 35634e20e73c326d715560dd0e47c893ab16a5fa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 25 17:35:02 2014 +0100

    v2v: Disable extended debugging of hivex_open.
    
    It's not really necessary: we have never needed this for debugging
    inspection for example, and if hive open failures did occur we would
    ask the user to send us the hive files.  And it causes huge amounts of
    debugging messages to be printed which fills up the log.

commit 9a9d10d2a0388f84ace3454c56071c544a3b923f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 25 14:30:37 2014 +0100

    v2v: Put overlay on LIBGUESTFS_CACHEDIR, not /tmp (RHBZ#1146017).
    
    Since the overlay could grow very large (because of copy-on-read) it
    is not suitable for /tmp.

commit 401ee58ae1c47877358819ac0b1fb4f069e1fde6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 24 23:47:40 2014 +0100

    v2v: windows: Print product variant in virtio drivers warning message.
    
    The inspection product variant field is used to determine which
    drivers to install, so print it in case we couldn't find any drivers.

commit df77553f4e9394d17c3c2eae91a6918f2f5105f2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 24 23:44:19 2014 +0100

    v2v: windows: Rearrange the order of virtio drivers match clause.
    
    No functional change.

commit fc56757d39923903dcb662b759c43bcef794cc59
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 24 19:03:42 2014 +0100

    Version 1.27.54.

commit f6e40498a90ac6f082bede202d15d5a8fbb80fa3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 24 18:18:40 2014 +0100

    v2v: windows: Give a better message when Fast Restart is found (RHBZ#1145995).
    
    Thanks: Tingting Zheng

commit 4cc0677da74e847f1112303cbc4413697f7f7345
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 24 18:11:40 2014 +0100

    v2v: Failure to mount the root partition is a hard error.
    
    For other partitions, it is a warning.

commit 0ba0692fda5d866eb3ae57e9aa3c6d95de79c961
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 24 17:51:43 2014 +0100

    v2v: Update list of virtio-win drivers to latest (RHBZ#1145908).
    
    Update with latest list from:
    - virtio-win-1.7.2-1.el7.noarch
    - https://en.wikipedia.org/wiki/List_of_Microsoft_Windows_versions

commit 97b96af54c5fc47bca2ea8f87d179a8b4d9e5242
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 24 17:27:18 2014 +0100

    v2v: windows: Set filename correctly when uploading virtio drivers (RHBZ#1145916).
    
    Thanks: Jeff Forbes, Alain Vondra, Junqin Zhou

commit e1407b36906d978a01c2e3dc19d7b4e1a124cc9f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 24 18:29:27 2014 +0100

    v2v: tests: Don't care about the <model> XML when testing network and bridge mapping.

commit 7806e8667b172775a1a9763c495d68c9531e754a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 24 17:55:27 2014 +0100

    tests: Add drivers directory to phony Windows image.
    
    Allows virt-v2v to upload drivers.

commit 6e9dd6752fab0c8cdc67e7ba9745050093444295
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 23 22:16:24 2014 +0100

    v2v: Remap device in /etc/sysconfig/grub boot= entry.
    
    Old virt-v2v did not remap this device, so after conversion from Xen
    the file would have something like:
    
      boot=/dev/xvda
    
    Although this does not appear to affect anything, better to remap it.

commit 79501d1a55551bd51940844e769f589d76ad75ce
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 23 16:54:26 2014 +0100

    Version 1.27.53.

commit 8e0ae6560e6629f6e435147557f8e0e42ec7986c
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Tue Sep 23 17:20:34 2014 +0800

    syntax-check: fix prohibit_getopt_without_use check
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit 21e2b29e60d48e3a62848ac3c47041f1c4c69be5
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Tue Sep 23 17:20:32 2014 +0800

    syntax-check: fix prohibit_dirent_without_use check
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit 54c95ed332e015f0382fec8575a200631fdedd53
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Tue Sep 23 17:20:31 2014 +0800

    syntax-check: fix prohibit_c_ctype_without_use check
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit dfa9efce4b36f41403051a8ee3e27021188d79b2
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Tue Sep 23 17:20:30 2014 +0800

    syntax-check: fix prohibit_assert_without_use check
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit c9fdfe021cc13a7e3507adc65d23a84ef215e75c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 23 15:42:05 2014 +0100

    v2v: -o rhev: chmod the image so we will definitely be able to write to it.
    
    NFS sucks.

commit 0f4044b58fdc0693ce6db5925992386e3c453f23
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 23 15:36:12 2014 +0100

    v2v: -o rhev: On failure path, use forking wrapper to clean up images dir.
    
    Otherwise you get lots of errors like:
    
    rm: cannot remove ‘/var/tmp/mm/42f5e571-21af-44bd-8164-3ebe6bbc9f5a/images/7b28b0e6-79ce-4d78-a6cb-769760a3d373/31e2b06b-85cb-46ed-aac3-8bcef93dc704.meta’: Permission denied
    rm: cannot remove ‘/var/tmp/mm/42f5e571-21af-44bd-8164-3ebe6bbc9f5a/images/7b28b0e6-79ce-4d78-a6cb-769760a3d373/31e2b06b-85cb-46ed-aac3-8bcef93dc704’: Permission denied
    
    because the code is running as root.

commit 06b04e5676eff7af7d0d667eab2f84288cb28755
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 23 15:28:28 2014 +0100

    v2v: -o rhev: Use a random name when testing UID:GID mapping.
    
    Using a fixed name is risky if there are multiple parallel virt-v2v
    processes running.

commit ebb5de6a1f94086ccc6f21a78afebecc360dcd9d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 23 15:26:03 2014 +0100

    v2v: -o rhev/vdsm: Remove the test that the storage domain is writable.
    
    For '-o rhev' this is likely to fail (although for obscure reasons it
    *doesn't* fail on a real RHEV server, I don't quite understand why).
    The reason is because virt-v2v may be running as root, and with root
    squashing we don't have permissions to write into the storage domain
    directory.
    
    For '-o vdsm', VDSM is supposed to make sure we are running as the
    correct user, so there's no reason to doubt things will work.

commit 44e523d9cb8f357d1c60fa530cc90fa7d89ef6c1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 23 13:49:03 2014 +0100

    valgrind: Add suppression for another libvirt/selinux leak.

commit 02c220a6f189de0d901f16a2f09778c47aeff3ea
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 23 12:47:40 2014 +0100

    v2v: Disable valgrind tests that are confused by -o rhev forking.
    
    This updates commit 0dfa96c043cee4ce82c0a45c3ad09b0a61798b79.

commit d1145f20cbba96dab728b04e50a4cb074193ee89
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 23 12:22:26 2014 +0100

    v2v: Add -o qemu output mode and --qemu-boot flag.
    
    This lets you write a shell script that runs the guest under qemu.
    Specifying the --qemu-boot flag also boots the guest after conversion.

commit 91c1f58e21fd61dcf38e6d30bf4c59d27432f11d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 23 11:52:00 2014 +0100

    v2v: docs: Change examples so -i input comes before -o options.
    
    Make the input/output ordering of command line arguments clearer by
    changing:
    
     virt-v2v -i disk -o local -os /var/tmp disk.img
    
    to:
    
     virt-v2v -i disk disk.img -o local -os /var/tmp

commit 8cb30d1027435c47e2c762dc997897c3b2e2cac2
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Sep 23 15:03:55 2014 +0200

    configure: switch from "java-default-runtime" to "default"
    
    Archlinux switched to "default" as directory for the default JDK
    version.

commit 316c91c140c9994d47fd7950de742afeef162f95
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Sep 23 15:01:53 2014 +0200

    inspect: map Hurd devices, and enable fstab introspection
    
    Add a mapping for the Hurd device names, so it is possible to enable the
    inspection of /etc/fstab.

commit 5b65d05d5a31415aaa6f284f73da745e0ee0408a
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Sep 22 19:48:41 2014 +0200

    inspect: basic Minix support
    
    Add a basic support for identifying Minix, extracting its version and
    hostname.
    
    Related to RHBZ#1144137.

commit 0035a57dd196e99db9e40582df8f1a39af9fa143
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 22 22:41:33 2014 +0100

    Version 1.27.52.

commit 0dfa96c043cee4ce82c0a45c3ad09b0a61798b79
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 22 21:57:57 2014 +0100

    v2v: -o rhev: Write files and directories as user:group 36:36 (RHBZ#1143887).
    
    We need to write files and directories as user:group 36:36, else
    RHEV-M cannot import the VM.  Doing this in the presence of NFS is
    difficult.  See v2v/kvmuid.mli for how it is done in this commit.

commit c9c5353223b09d0010bae503383cd0ed8c07fc43
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 22 22:10:44 2014 +0100

    v2v: Allow the output mode to override disk_create.
    
    Also we allow the output mode to actually create the disk image.  This
    lets the output mode set ownership and permissions correctly if
    required.
    
    The default method just calls Guestfs#disk_create, so there is no
    actual change in this commit.

commit 15556b614d5125cedb55d79a793e027a01e5fe67
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 22 19:31:37 2014 +0100

    v2v: lib_ovf: Change create_meta_files so it doesn't write the files.
    
    Change Lib_ovf.create_meta_files so that instead of writing the
    .meta files, it just returns the content.  Output_rhev and
    Output_vdsm are correspondingly changed so that they write the
    content to the .meta files.
    
    This is just code refactoring, there is no functional change.

commit 6d09ff3600019617ccece59597c4d7d75ef84c4f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 22 18:28:07 2014 +0100

    Version 1.27.51.

commit 7b428603e3a6dc43c48e276b192fda05a4a50a13
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 22 18:25:51 2014 +0100

    v2v: Windows: Uploading viostor driver needs upload method, not copy.
    
    Thanks: Jeff Forbes

commit 1b12c6d46b7315f668da320db93c407a32ee8049
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 22 18:25:26 2014 +0100

    fuse: Remove test-fuse.sh (rewritten script) from EXTRA_DIST.
    
    This fixes commit aca076e2e2b3e03f4cf5b09cf7766925f97e4b68.

commit 1b9b4af7246c98c426801310bc61457c8872a8e9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 22 18:13:34 2014 +0100

    Revert "v2v: -o rhev: Chown the image files and metadata after the upload."
    
    This reverts commit dd58cde929ade2dd6bc216aac21658ed3b3f51aa.

commit 2e3e254e959f97ef967c6d3f89b1952f6282d034
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 22 18:13:22 2014 +0100

    Revert "v2v: -o rhev: Use chown --reference instead of 36.36 (RHBZ#1143887)."
    
    This reverts commit 70444670acc60c5700bcd07ea7440d186eb4b60c.

commit cd86bc510006fce668fe212b35ee19b5c3fdcb68
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Mon Sep 22 15:47:35 2014 +0800

    resize: simplify the code to filter parts
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit cee9a4993d4435b57aa233b7b678a9b7cc5c1d53
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 22 16:44:19 2014 +0100

    v2v: For grub legacy, edit grub config file instead of using grubby (RHBZ#1141145).
    
    The old virt-v2v code would either edit the grub config file (grub
    legacy) or use grubby --set-default (grub2).
    
    When translating this code, I figured we could use grubby in both
    cases, since grubby exists for grub legacy guests.
    
    However it doesn't appear to work for grub legacy guests.  Use the
    configuration file editing method for these, same as old virt-v2v.
    
    Thanks: Tingting Zheng

commit 58eaf258c143c0b8321d8b7cbc9b96e73e82536f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 22 13:57:02 2014 +0100

    fuse: Enable futimens test (RHBZ#1144766).

commit 8664337cc39c8575ccb60abb8c6e30f92828ea51
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 22 10:27:21 2014 +0100

    New APIs: Implement stat calls that return nanosecond timestamps (RHBZ#1144891).
    
    The existing APIs guestfs_stat, guestfs_lstat and guestfs_lstatlist
    return a stat structure that contains atime, mtime and ctime fields
    that store only the timestamp in seconds.
    
    Modern filesystems can store timestamps down to nanosecond
    granularity, and the ordinary glibc stat(2) wrapper will return these
    in "hidden" stat fields:
    
      struct timespec st_atim;            /* Time of last access.  */
      struct timespec st_mtim;            /* Time of last modification.  */
      struct timespec st_ctim;            /* Time of last status change.  */
    
    with the following macros defined for backwards compatibility:
    
      #define st_atime st_atim.tv_sec
      #define st_mtime st_mtim.tv_sec
      #define st_ctime st_ctim.tv_sec
    
    It is not possible to redefine guestfs_stat to return a longer struct
    guestfs_stat with room for the extra nanosecond fields, because that
    would break the ABI of guestfs_lstatlist as it returns an array
    containing consecutive stat structs (not pointers).  Changing the
    return type of guestfs_stat would break API.  Changing the generator
    to support symbol versioning is judged to be too intrusive.
    
    Therefore this adds a new struct (guestfs_statns) and new APIs:
    
      guestfs_statns
      guestfs_lstatns
      guestfs_lstatnslist
    
    which return the new struct (or array of structs in the last case).
    
    The old APIs may of course still be used, forever, but are deprecated
    and shouldn't be used in new programs.
    
    Because virt tools are compiled with -DGUESTFS_WARN_DEPRECATED=1, I
    have updated all the places calling the deprecated functions.  This
    has revealed some areas for improvement: in particular virt-diff and
    virt-ls could be changed to print the nanosecond fields.
    
    FUSE now returns nanoseconds in stat calls where available, fixing
    https://bugzilla.redhat.com/show_bug.cgi?id=1144891
    
    Notes about the implementation:
    
    - guestfs_internal_lstatlist has been removed and replaced by
      guestfs_internal_lstatnslist.  As the former was an internal API no
      one should have been calling it, or indeed can call it unless they
      start defining their own header files.
    
    - guestfs_stat and guestfs_lstat have been changed into library-side
      functions.  They, along with guestfs_lstatlist, are now implemented
      as wrappers around the new functions which just throw away the
      nanosecond fields.

commit aca076e2e2b3e03f4cf5b09cf7766925f97e4b68
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Sep 21 21:40:13 2014 +0100

    fuse: Rewrite test-fuse.sh in C.
    
    This gives us finer control over how system calls are done,
    and also potentially lets us test more.
    
    Currently two tests are disabled:
    
     - utimens because of https://bugzilla.redhat.com/show_bug.cgi?id=1144766
    
     - utimes because our stat call does not return the nanosecond fields

commit 5bb26dcd3c6be56b432c6bdc545968d8722af486
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 20 14:48:17 2014 +0100

    tests/data: Remove abssymlink.
    
    This file causes the test ISO to be rebuilt every time.
    
    Instead of including it as a Makefile dependency, create it just
    before making the ISO, which has the same effect.
    
    A test in fish/ also used this file.  Change it so it doesn't need it.

commit 5fa568f686e802e91b939cb53699c5bf568ee71a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 20 13:10:19 2014 +0100

    tests/guests: Don't calculate checksums of generated images.
    
    Turns out not to be useful, and takes a long time.
    
    This reverts commit 0c605eb94f20cb08e4a858988e0da121af6f66cb.

commit cd9c0fc9a4b0069528b9f157b589acccba931e1e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 20 11:38:39 2014 +0100

    v2v: Move mpstat type definition.
    
    It's only used by the core v2v.ml code, so move it to that file.
    
    This is just code motion.

commit eed49ac8971e1bbf95e089203e14b6fb7c6a731a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 20 10:11:25 2014 +0100

    v2v: Move target actual size computation into core v2v.ml code.
    
    This was only calculated for RHEV, but might benefit other output
    modes in future, and is generic code, so move it into the core code.

commit c1a32f5c11bd3c5b43c700927f40e5f4b1aeabb5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 20 10:13:13 2014 +0100

    v2v: Clarify description of ov_sd field in comment.

commit 0869f579fd4373f9270128cebc9f35777f7022da
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 20 09:03:36 2014 +0100

    aarch64: Add support to file_architecture API.
    
    Add support for aarch64 to the file_architecture API, so we can
    detect aarch64 guests correctly.
    
    Add a test binary and library.  These were generated on an aarch64
    machine by doing:
    
      echo 'main(){}' > bin.c
      gcc bin.c -o bin-aarch64-dynamic
      strip --strip-all bin-aarch64-dynamic
      echo '' > lib.c
      gcc -shared lib.c -o lib-aarch64.so
      strip --strip-all lib-aarch64.so

commit f61832b17aba2b9bf52899cf79b1a602f65a2968
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 20 08:53:38 2014 +0100

    v2v: Remove source.s_arch field and find architecture through inspection.
    
    Previously we required that the source hypervisor knew the
    architecture of the guest, and passed that through to KVM.
    
    However this was error-prone for several reasons:
    
     - OVF (-i ova) doesn't define the architecture
    
     - Disk images (-i disk) don't have an associated architecture
    
     - Libvirt XML sometimes lacks the <type arch=...> field, especially
       for RHEL 5-era libvirt.
    
     - It might not be set correctly for the guest.
    
    We know the real architecture from inspection of the guest, so use
    that instead.

commit 95b7e716ca4aa3e4cc6c33c11c722ad026712413
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 20 08:12:41 2014 +0100

    v2v: Fix typo in comment.

commit a36dde98899ea160a49c9af65a883383496cd331
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Fri Sep 19 18:55:50 2014 +0200

    appliance: Add libsystemd0 (and systemd as an alternative for sysvinit) on Debian-based systems

commit b2a1d4ce45a5a8a2a857de699b407413591ce875
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 19 14:52:16 2014 +0100

    Version 1.27.50.

commit 1e6dd6d2a31e21dc47cad26d0b06370e3894078b
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Fri Sep 19 15:39:13 2014 +0800

    resize: add function expand_partition_content
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit b9063b7c2f0ee94bef46c79d1bc50b018c22c686
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Fri Sep 19 15:39:12 2014 +0800

    resize: add function set_partition_bootable_and_id
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit 51f67a9c81baf746dc9da1774521e53bb14c4853
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Fri Sep 19 15:39:11 2014 +0800

    resize: add function copy_partition
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit 4e6526c0763037e3906ec0d2128ec8873cee2137
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Fri Sep 19 15:39:08 2014 +0800

    resize: add function print_summmary
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit d9f8746ea5a5f22ac71ac494c9d93e59354b4d10
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Fri Sep 19 15:39:04 2014 +0800

    add function div_roundup64
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit b05b9ba8bfb6db4fbb0f7325e8ff326978c46d1e
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Fri Sep 19 15:39:03 2014 +0800

    resize: convert sectsize to int64
    
    Because sectsize is used as int64 everywhere.
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit 816d7cf9413ceb70fba48c069e3d2c39c6b67f49
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 19 13:18:45 2014 +0100

    fish: Restore text to default when exiting (RHBZ#1144201).
    
    The escape sequence \e[0;30m sets the colour to black.  This is fine
    if you use a black-on-white terminal, but fails rather badly if you
    use a white-on-black terminal.
    
    Instead use the escape sequence \e[0m which restores the terminal to
    the defaults, and works in both cases.

commit 4aa38bba2ca77cf0ff7271a8f419182c57f59f7a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 19 12:14:21 2014 +0100

    v2v: Clean the RPM database early on (RHBZ#1143866).
    
    If the RPM database in the source guest is corrupt, then subsequent
    operations will fail randomly.
    
    Old virt-v2v appears to have avoided this by cleaning the RPM database
    very early on.  When translating the code I inadvertantly moved this
    cleanup to a later stage -- in particular, after inspection of kernels
    was done which requires running rpm commands.  Move this back to the
    start.

commit 6db2ff52f9557bc3644700386320dc7a3fa54830
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 19 12:13:41 2014 +0100

    v2v: Move initialization of Augeas after inspection housekeeping.
    
    Just cleanup, it should have no effect on the way that the
    conversion works.

commit 7d9db86cab909a97bd51788b60f7f66dd55d38de
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Sep 19 13:33:21 2014 +0200

    appliance: move e2fsprogs as common for all distros
    
    All distro-specific sections have it, so just make it really common.

commit 70768239fde98eeed3b278aa9bb9ca1003343b5e
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Sep 19 13:26:37 2014 +0200

    appliance: remove duplicate packages in OpenSUSE, Frugalware, Mageia
    
    From some lists of distro-specific packages, remove the ones that
    appear already in the common list.

commit 95729079564edf83128186c4f9d2e6b494928270
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 18 18:08:43 2014 +0100

    Version 1.27.49.

commit c573feb4d1dcae0da85963237ef57312bb02e288
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 18 17:45:12 2014 +0100

    v2v: Print a message if the guest is virtio-capable after conversion.

commit 70444670acc60c5700bcd07ea7440d186eb4b60c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 18 15:07:32 2014 +0100

    v2v: -o rhev: Use chown --reference instead of 36.36 (RHBZ#1143887).
    
    When chowning the final directories, instead of chowning them to 36.36
    (ie. hard-coding those UID/GIDs), use a --reference chown so it should
    take the ownership from the parent directory.
    
    Unfortunately chowning is very complex because of:
    
     - NFSv3 vs NFSv4
    
     - root squash
    
     - idmap
    
    which creates approximately 8 different ways for this to fail.

commit 035f47cdde4052e77613c77d2e5e0f24dbab082f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 18 14:43:12 2014 +0100

    v2v: Fix code for editing grub2 console=... parameter (RHBZ#1143883).
    
    When presented with a RHEL 7 guest, virt-v2v would print the following
    warning message:
    
      virt-v2v: warning: could not update grub2 console: aug_get: no matching
      node (ignored)
    
    This happened because on RHEL 7, /etc/sysconfig/grub is a symlink to
    /etc/default/grub, and the Augeas grub2 lens returns entries under
    /files/etc/default/grub/*, but the code was checking for
    /files/etc/sysconfig/grub/*.
    
    The fix is to check all the possible Augeas paths until one matches.
    (Only the first match gets updated however).
    
    Also, don't rebuild the grub2 config unless we've actually changed it.
    This avoids doing a potentially failure-prone operation when it's not
    necessary.
    
    I suspect that the old virt-v2v code did not work correctly for RHEL 7
    guests, but old virt-v2v didn't print a warning here, it just failed
    to update silently.

commit e5dd3b08de331b14aee4f86eef373e3c900d8b61
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 18 13:56:58 2014 +0100

    customize: Make usage of --password-crypto option clearer (RHBZ#1143949).

commit c68b510be2c58b729143b5940be6dfbb56a94182
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 18 13:35:03 2014 +0100

    Update release notes.

commit 32736857b3590554c4707cfe33eebed0ccc04abe
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 17 21:34:10 2014 +0100

    v2v: Document the input: output: and convert: features in --machine-readable output.

commit 3562a816832d525b5948b41780bff05aa8dec027
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 15 18:44:51 2014 +0100

    generator: Change type of 'tests' to 'c_api_tests'.
    
    Just a code refactoring, has no functional effect.

commit e85a976c5a474d751c6e8352370047a3177a7c45
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 15 15:17:47 2014 +0100

    tests: Don't use relative paths to binaries in tests.
    
    All tests run under the ./run binary.  For a long time the ./run
    binary has set the $PATH environment variable to contain all of the
    directories with binaries in them.
    
    Therefore there is no reason to use ../fish/guestfish instead of just
    plain guestfish (and the same applies to other built binaries).

commit bced8f52897d3e588e88cde3774e1e3666492db4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 17 16:33:55 2014 +0100

    FAQ: Note that update-guestfs-appliance is not needed with libguestfs >= 1.26.

commit 58a285b5b3d60508779d83f5ffa1de349c4baa78
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 17 15:51:30 2014 +0100

    Version 1.27.48.

commit 0fabe1a2ed82ff1df9feda459ae139bcca5a3338
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 17 15:36:15 2014 +0100

    daemon: parted: Fix error message when part-get-name is called on non-GPT (RHBZ#1142416).
    
    The error message was bogus, fix it.
    
    This fixes commit 0316d247706aab7ce7c2225472feeb51fa8b1664.
    
    Found by: Lingfei Kong

commit 5fcc584c344e7894e2da15071050b6eb5f882f55
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 17 15:34:03 2014 +0100

    daemon: parted: Don't crash if part-get-name called on non-partitioned device (RHBZ#1142158).
    
    If do_part_get_parttype returns NULL, then return from the function
    instead of dereferencing the NULL pointer and crashing.  Note that
    do_part_get_parttype has already called reply_with_error in this case.
    
    This fixes commit 0316d247706aab7ce7c2225472feeb51fa8b1664.
    
    Found by: Lingfei Kong

commit 071051073292df15a19259bedc95cedf9a76b1f5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 17 15:13:33 2014 +0100

    v2v: Reconfigure /etc/modprobe.conf (RHBZ#1141145).
    
    More code that was omitted during the translation of old virt-v2v.

commit f982ce27032371c43e167609e0631bc792382da7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 17 15:13:21 2014 +0100

    v2v: Rebuild initrd last.
    
    Old virt-v2v rebuilt the initrd late.  Currently we rebuild the initrd
    right after choosing a kernel, but it's best to update the initrd
    at the end since mkinitrd may depend on other configuration files
    that we are changing (especially see next commit).

commit 5fed8dfae114367c347af170dcef0b5d6183f8c0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 17 13:59:39 2014 +0100

    v2v: -o rhev: Don't quote 'root' in error message.

commit dd58cde929ade2dd6bc216aac21658ed3b3f51aa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 17 13:40:10 2014 +0100

    v2v: -o rhev: Chown the image files and metadata after the upload.

commit d5001304e4952450851ab429416c96cc4c8e2331
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 17 12:56:53 2014 +0100

    v2v: Fix OVF VmType field, which should be 0 or 1 (RHBZ#1142008).
    
    Thanks: Shahar Havivi.

commit 05f665166c05519b8b5d4cd26fbe5e912cc63ba8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 17 12:55:06 2014 +0100

    v2v: Fix capitalization of ovf:volume-type (RHBZ#1142008).
    
    Thanks: Shahar Havivi.

commit fe36b2ce950d214aa198daf86188e8fdbe41f43f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 17 12:49:00 2014 +0100

    v2v: -o rhev/vdsm: Fix ovf:size and ovf:actual_size fields (RHBZ#1142008).
    
    These are integers in gigabytes (2^30).
    
    Thanks: Shahar Havivi.

commit 7739a6d3570efa2fee32b7210de40c73eca5b988
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 17 12:13:42 2014 +0100

    v2v: If virtio is enabled, map device names to vd* (RHBZ#1142004).
    
    The old virt-v2v code had:
    
        my $prefix;
        if ($virtio) {
            $prefix = 'vd';
        } elsif ($libata) {
            $prefix = 'sd';
        } else {
            $prefix = 'hd'
        }
    
    The translated code dropped the test for virtio by accident, which
    meant that device names would be mapped to sd* or hd* even if the
    virtio-blk driver was enabled for the guest.
    
    Thanks: Tingting Zheng

commit 4178bdc9b4c94e44f5b8520d6dbeeda92a6ae0cd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 17 11:51:54 2014 +0100

    sysprep: Clarify the documentation for 'flag-reconfiguration'.
    
    It was quite obscure what this actually did.  Make it clear
    in the documentation.

commit f722571c73d427530a357b7a864a5432cc7db461
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 16 16:46:34 2014 +0100

    sysprep: Clarify when --mount-options is used and what it does (RHBZ#1142186).

commit 9aeaace779e7ce9718208367f5079b4667f8468b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 16 16:43:28 2014 +0100

    Version 1.27.47.

commit 01b25d7fc6ea1dee80d104118436980b7d504af0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 16 16:20:15 2014 +0100

    v2v: Add xvda -> sda etc mappings (RHBZ#1142004).
    
    For Xen guests, a device can be presented twice as (eg) xvda and sda,
    and therefore we should map any otherwise unmapped xvdX.
    
    For non-Xen guests, this should have no effect.

commit d86016da8e5d9afd01c75067198aecad15d402c9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 16 15:49:34 2014 +0100

    v2v: Fix for 'grubby: bad argument --set-kernel: unknown option' (RHBZ#1141145).
    
    I made a mistake while translating the Perl conversion code and
    transcribed --set-default as --set-kernel.  grubby has no --set-kernel
    option so it failed.
    
    Thanks: Tingting Zheng

commit a7147ce9ffa93cd1cc0c9b568fe00cc81071a777
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 15 15:36:23 2014 +0100

    run: Add p2v to the PATH.

commit 8856fadadb4f10b89f13068d01d40643e31c488d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 16 08:36:38 2014 +0100

    v2v: Prevent conversion of "blocked" and "paused" domains also.
    
    Previously only "running" domains were blocked from conversion.
    However "blocked" is essentially the same as running (on Xen it just
    means the domain is running but waiting on an I/O resource).  And
    "paused" domains probably shouldn't be converted either since their
    disks are only crash-consistent.

commit 77b371b18b6a7ad37105a595931514f542a04396
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 15 11:31:55 2014 +0100

    v2v: Clarify the missing input format error message (RHBZ#1141723).

commit 21c6c70378b0a48528911bd93ce7b528c809805f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 15 11:03:35 2014 +0100

    Version 1.27.46.

commit 1dd485e500a2ee810802e2f6421dde104b2116ab
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 15 10:17:01 2014 +0100

    v2v: Allow pool UUID to be used in -os parameter (RHBZ#1141631).
    
    Thanks: Zhou Junqin.

commit 47251a3599b1477d7c3749912b404c756e613be6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 15 10:15:10 2014 +0100

    v2v: Allow domain UUID to be used in place of libvirt guest name (RHBZ#1141680).
    
    Thanks: Zhou Junqin.

commit a417287e0abe09f00bd9160f5b4336d493d0924c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 15 10:13:09 2014 +0100

    v2v: domainxml: Rework libvirt error handling.
    
    Don't rely on libvirt's implicit print-to-stderr.  Instead make sure
    that libvirt error messages are raised in the exception message.
    
    Also allow error strings to be translated.

commit be1385d2cbf198606c1d11c0302de6b11176d785
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 15 09:46:30 2014 +0100

    Revert "v2v: -i libvirtxml: Give an error if local disks are not readable (RHBZ#1140946)."
    
    This commit breaks remote disks.  See:
    https://bugzilla.redhat.com/show_bug.cgi?id=1141654
    
    This reverts commit 73c1f1cf7e1c4aa4e70407feff49ba847f7ebb63.

commit 7039d0e7f661e04ddec79eb8faabc50da5096451
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Sun Sep 14 21:21:25 2014 +0200

    Generate *.cmx targets only if a native OCaml compiler exists

commit 50d5d4b723295b35772b64650f4a96f43f7cc9fc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Sep 14 19:03:28 2014 +0100

    v2v: Add stringMap.mli (interface).
    
    Hopefully this should fix the incorrect build problem.  See discussion
    here:
    
    https://www.redhat.com/archives/libguestfs/2014-September/msg00071.html
    
    The interface was generated using 'ocamlc -i'.

commit a18c2aca14e451d54110c44ece4eeed536b3ece2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Sep 14 18:46:49 2014 +0100

    Revert "Use ocamldep -all option."
    
    This reverts commit a3881445efd04d5fe6da29db8b2d62a30088b9d1.
    
    See discussion on the mailing list:
    
    https://www.redhat.com/archives/libguestfs/2014-September/msg00069.html

commit 48604913db4095ab8f6ecc80d9f92b5a04a5285c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Sep 14 14:02:12 2014 +0100

    Version 1.27.45.

commit 4515413217c7d4a6fe026254bffa6f82746047c4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 19 13:54:50 2012 +0000

    daemon: Run udev_settle after pwrite-device finishes (RHBZ#1141451).
    
    When you call close on any block device, udev kicks off a rule which
    runs blkid to reexamine the device.  We need to wait for this rule to
    finish running since it holds the device open and can cause other
    operations to fail, notably mkfs.
    
    (cherry picked from commit a9c8123c72db47bcab8dd738e8d5256a9ae87f11)

commit 974c4cd015e82b9b2013b27bdbcd51406a997136
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Sep 14 12:22:11 2014 +0100

    appliance: Add comment with udev debugging option.

commit 88dea548031db0eaccc08b63c4ee1e3644cd0e83
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 13 16:44:47 2014 +0100

    v2v: -o rhev/vdsm: In --no-copy case, use estimate for ovf:actual_size (RHBZ#1140156).

commit 3e2f89a74fcc75a0f6b10945d2d4b0273cc21b03
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 13 16:44:17 2014 +0100

    v2v: Fix variable name usage_mb -> usage_gb.
    
    It's actually storing usage in gigabytes, not megabytes.

commit 5a620137bf48251c3deab93492e8b7156eb9e282
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 13 16:18:16 2014 +0100

    v2v: Estimate the amount of space required on the target.
    
    Estimate the amount of space required on the target by each source
    disk after conversion.  The estimate is approximately a ceiling on
    this, and actual use should be considerably lower.
    
    Provide an extra output method (#check_target_free_space) which output
    modules may use to check that there is sufficient free space to
    proceed, before conversion starts.  None of the output modules
    actually implement this at the moment.

commit f084fec3817a8f53c16056d50dd080a62d000af6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 13 14:54:39 2014 +0100

    v2v: Introduce Types.mpstats struct storing mountpoint statistics.
    
    This is just code refactoring.

commit b7bdb63d8967762a5b234049c4dda911150cc199
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 13 09:45:59 2014 +0100

    tools: Check for dangling --format parameters (RHBZ#1140894).
    
    In most C tools, virt-sysprep and virt-customize, you have to put the
    --format parameter before the corresponding -a parameter.  ie.  The
    following is correct:
    
      guestfish --format qcow2 -a disk1 -a disk2
    
    But the following is incorrect.  The --format parameter is dangling
    and prior to this commit would have been silently ignored:
    
      guestfish -a disk1 -a disk2 --format qcow2
    
    After this change, dangling --format parameters now lead to an error:
    
      guestfish: --format parameter must appear before -a parameter
    
    In virt-customize, also check that --attach-format parameter appears
    before --attach parameter.
    
    Thanks: Lingfei Kong

commit 7845bcc20f66eaa1f0e1df85f9f0dbe9da6037e6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 12 22:44:07 2014 +0100

    Version 1.27.44.

commit 764cbd5f695c6acbc39bd0b2b70746bfc9131e98
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 12 22:29:49 2014 +0100

    sysprep: Use 'error' function consistently throughout the program.

commit f1390d3d7a68580fcdceba7ffb26cb7d242d1505
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 12 22:19:42 2014 +0100

    sysprep: Ensure error handler surrounds all the code so we catch and print all errors.

commit 7bd7dabbd71583737e8d48536bb742be03988102
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 12 22:06:06 2014 +0100

    v2v: esx: Clarify that username can be specified in vpx:// URI (RHBZ#1141113).
    
    If there is an authentication error when getting the session cookie,
    emphasize in the error message that the username can be specified in
    the URI.
    
    Unfortunately libvirt asks for the username previously, but we cannot
    access that.

commit 7836aa523bbcd223e3ebb23b3d174197b614b30f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 12 20:06:49 2014 +0100

    v2v: Add -o null mode.
    
    In theory this discards the output.  Unfortunately in practice we have
    to write the output to a temporary file and delete it (because of
    limitations in qemu-img convert).

commit 73c1f1cf7e1c4aa4e70407feff49ba847f7ebb63
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 12 19:37:03 2014 +0100

    v2v: -i libvirtxml: Give an error if local disks are not readable (RHBZ#1140946).

commit 3729bc1fe1726abda7576fdd6243a47ac96de5fe
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 12 16:39:55 2014 +0100

    sysprep: Check --{keep,remove}-user-accounts parameters are not used when operation is disabled (RHBZ#1141157).
    
    You will see an error like this:
    
    $ virt-sysprep --remove-user-accounts foo,bar -a /dev/null
    virt-sysprep: error: user-accounts: --remove-user-accounts parameter was
    used, but the "user-account" operation is not enabled

commit 5066fde8f25fbcfa75bfa0c8e94b1b15eed3899a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 12 16:34:58 2014 +0100

    sysprep: Add an optional method for checking if unused arguments were passed to disabled operations.

commit 0513a91d2edd5089cd2db151b0605d6649c8a1bf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 12 16:21:11 2014 +0100

    sysprep: Replace --user-accounts option with --{remove,keep}-user-accounts.
    
    The --user-accounts option, with its double-negative '-' prefix on
    user names, is confusing.  Replace it with '--remove-user-accounts'
    and '--keep-user-accounts' options.
    
    This updates commit 128d474095bfabc2d724d0181155e364f1afbabf.

commit e1ed66e2b1c6b94bdfe10616667fdbc299ecb800
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 12 15:47:07 2014 +0100

    v2v: If non-Xen and Xen initrds match a kernel, take shortest name (RHBZ#1141145).
    
    Thanks: Tingting Zheng.

commit 44907763a6ee739f9fdd3b0a0e4b3d83ae4148d5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 12 12:41:26 2014 +0100

    v2v: Fix --help documentation of -o glance option.
    
    Thanks: Junqin Zhou

commit 8f1ce3a72f5d05fe7b80904ab51803a2e137aebb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 11 19:38:10 2014 +0100

    Version 1.27.43.

commit b67da2524fd8a95e217db8ef764ad1ca34b91a82
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 11 16:55:15 2014 +0100

    v2v: Split off -o vdsm mode from -o rhev (RHBZ#1140156).
    
    -o rhev: This is "traditional" output to a RHEV-M Export Storage Domain.
    It requires no cooperation from RHEV itself, and in all other respects
    works the same way as old virt-v2v did.
    
    -o vdsm: This is the new mode which requires VDSM cooperation.  VDSM
    manages the conversion, creating the directories, suggesting UUIDs,
    and cleaning up on failure.  This allows direct import into a Data
    Domain.
    
    The --rhev* command arguments now only apply to -o vdsm, and therefore
    have been renamed to --vdsm*
    
    The --vmtype command line argument may be used with -o rhev or -o vdsm.

commit 4c25f48bbad353ac6b0cc32f4174d2b4923d1f28
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 11 16:21:16 2014 +0100

    v2v: Move some utility functions into Lib_ovf module.
    
    This is just code refactoring and has no functional effect.

commit 694dc695b8ea79f78cdd73739512bfc229d7129e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 11 16:14:51 2014 +0100

    v2v: Remove unused struct (Types.output_rhev_params).

commit 04206fb3c036ae676fa6c50af26f40fa74cdd24a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 11 16:14:06 2014 +0100

    v2v: Rename module Output_RHEV to Output_rhev.
    
    This is just code refactoring, and has no functional change to the
    program.

commit de3614e0ff67f5a85625946f35af296080cbb6b8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 11 10:11:09 2014 +0100

    builder: Fix documentation of --list --list-format option (RHBZ#1140547).
    
    Also give an error if users use the incorrect one:
    
    $ virt-builder --list --format json
    virt-builder: virt-builder --list: use '--list-format', not '--format'.

commit b047feafa99a6b63b1caa1023db60eca7138c14a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 10 22:31:06 2014 +0100

    Update BUGS file.

commit 4fb3009a42b06f7b716b215de962343c05fd3cd4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 10 22:11:01 2014 +0100

    Version 1.27.42.

commit c862dc3d2018550146b02740c4f0737cd715f207
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Sep 10 11:39:55 2014 +0200

    fish: fix small memory leak in completion
    
    Do not leak the small memory buffer with the path.

commit 55f70c13e3064cc1132deaf5dadcd53387d0987e
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Sep 10 11:16:23 2014 +0200

    resize: print FSes which cannot be expanded
    
    Should ease a bit the discovery of a filesystem which cannot be
    expanded.

commit a67845bfa0f5ca5242ea6a965fe73169de830fbc
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Sep 10 11:01:34 2014 +0200

    test-charset-fidelity: set iocharset in vfat/msdos FSes
    
    The default charset for these filesystems depends on how the kernel was
    configured with, so explicitly set the default one (as specified in
    Linux sources), eventually setting later a new one for the tests.

commit c49d35a919284f54a8e98a8a17c2543e7973b583
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 10 17:01:10 2014 +0100

    v2v: Clearer error message if ssh-agent authentication is not set up (RHBZ#1139973).

commit 516faa1bcb64a95b25ec7f3b2be0d2d1f6c0c60d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 10 16:29:28 2014 +0100

    v2v: Fall back to virDomainGetInfo if remote libvirtd does not support virDomainGetState (RHBZ#1138586).
    
    RHEL 5 Xen doesn't support the relatively new virDomainGetState API.
    Instead you will see a warning message on stderr:
    
      libvirt: Remote Driver error : unknown procedure: 212
    
    If we detect that virDomainGetState is not supported, then fall back
    to calling virDomainGetInfo instead, which works everywhere.
    
    This updates commit 096c05a750b8b525e48149c0c6522769c92ab07c.
    
    See also:
    https://bugzilla.redhat.com/show_bug.cgi?id=1139973#c2
    https://bugzilla.redhat.com/show_bug.cgi?id=1138586

commit b6099f4aee3e14a04f6b8c8d62246d337f2a1582
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 10 11:20:56 2014 +0100

    v2v: Report error when multiple conflicting command line options are used (RHBZ#1140050).
    
    $ virt-v2v -i disk -i libvirt
    virt-v2v: error: -i option used more than once on the command line

commit a6279f5c7b4a7794eec32c650590790251aeb220
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 10 00:03:20 2014 +0100

    v2v: List convert modules in --machine-readable output.
    
    $ virt-v2v --machine-readable
    [...]
    convert:enterprise-linux
    convert:windows

commit 3d2e2bb44556a218ad4cc4d4d4e6b90cd43d60cf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 9 23:58:17 2014 +0100

    v2v: Abstract Convert_* modules from core v2v code.
    
    Previously the core virt-v2v code had to know which Convert_* module
    to call for each guest type (based on inspection).  After this change
    the core code doesn't need to know that, but instead Convert_* modules
    register their interest in particular guest types.

commit 102e9a8c057bb2670ed430feb5de082bd1a97d7a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 9 23:27:51 2014 +0100

    sysprep: Don't use --option=arg in documentation.
    
    Fedora patches OCaml's Arg module to support --option=arg.  Since this
    won't work on other distros or upstream OCaml, don't include such
    examples in the documentation.

commit c22d86870c9099935c8b92471ba4eb711c0b7018
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 9 23:08:24 2014 +0100

    v2v: Allow -o local as an alias for -o disk.
    
    This is symmetrical with -i disk / -i local.

commit 49fa6912ed16d6946da2a603fdb1fc24fdee530b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 9 23:06:54 2014 +0100

    v2v: Sort the -i options alphabetically in the man page.

commit 68e58e5814e74dc3ea8bf930b98eedf421ac5309
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 9 23:02:21 2014 +0100

    v2v: Update documentation credits.
    
    Shahar Havivi and Tingting Zheng for development & testing respectively.

commit 334dee64a2c90c4c57de33fd78ffc529f49ebb35
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 9 20:27:33 2014 +0100

    FAQ: Repeat advice to use ./run.
    
    The two adjacent sections can be read separately, and the second
    section doesn't mention not using make install / using ./run, so
    repeat it a second time.

commit 163eb3b7a1921fe675f5a85d5dc28692d5e03bda
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 9 17:04:47 2014 +0100

    resize: Support for expanding XFS filesystems.

commit aebe00e5c6f3087370fe86873cb715f32dc8233b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 9 16:02:44 2014 +0100

    Version 1.27.41.

commit a2107981a621168603dd91ad9f9f2c9948be0f3e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 9 14:20:43 2014 +0100

    daemon: Run 'udevadm settle' with debugging and warn if the command fails.

commit 6b379ab598a3885352d39bf5c084b3abb029abac
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 9 15:42:05 2014 +0100

    Version 1.27.40.

commit 59136518f13cb489cc17a411267d54444d7c8ac6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 9 15:04:24 2014 +0100

    v2v: Calculate dracut/mkinitrd kernel version correctly (RHBZ#1138182).
    
    Thanks: Tingting Zheng.

commit e89ab6dde47d8a54d7be42ea88c7dca84e335a0e
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Sep 9 15:10:33 2014 +0200

    tests: sysprep: slightly improve output
    
    Add minor spacing changes, and report the image being sysprep'ed, so it
    is easier to spot which image caused some warning message.

commit be1c6965006dec258b915c9561ac66c8cb36dfe6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 9 10:46:55 2014 +0100

    v2v: Check if there is sufficient free space for conversion (RHBZ#1139543).
    
    Before trying to perform the conversion, estimate if there is
    sufficient free space on the guest filesystem(s) for the conversion to
    be successful.
    
    If not, you will see an error similar to this one:
    
    [   6.0] Checking for sufficient free disk space in the guest
    virt-v2v: error: not enough free space for conversion on filesystem '/'.
    4354048 bytes free < 20000000 bytes needed

commit 4fc333d0eff19e82b6f41957af091ecf4806670e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 8 13:13:01 2014 +0100

    p2v: Use matchbox (window manager) in the virt-p2v ISO.
    
    virt-p2v can run without a window manager.  However it then sits in
    the top left corner of the screen.  Add a lightweight window manager
    to the ISO so that position and geometry hints work.

commit e52ec0a3dfb504e71db105405746dc2f36e07444
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 8 11:07:03 2014 +0100

    p2v: Whitespace change in options list.

commit a12745a48196c2de9fa67e7974c40be63491b0d5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 6 20:06:50 2014 +0100

    Version 1.27.39.

commit 0866d2238138ffd14ec2cadd75332adf549a3035
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 6 10:05:18 2014 +0100

    p2v: Add scripts to make disk or kickstart-based P2V ISO.
    
    Two scripts are added, replacing the make targets from the
    previous commit:
    
    virt-p2v-make-disk: Builds a virt-p2v disk or USB key using
    virt-builder.
    
    virt-p2v-make-kickstart: Builds a kickstart file (only) which can be
    fed to livecd-creator or similar tools on Red Hat-derived distros.
    
    Kickstart generation is slightly different: Instead of requiring the
    downstream 'libguestfs-pvhelper' package, the kickstart now embeds the
    virt-p2v binary(!) making it self-contained and downstream packaging
    simpler.
    
    In addition there are documentation changes.

commit 8e6478dc7d9f4bcfc76182f556dbcea457ecc110
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 6 09:41:15 2014 +0100

    p2v: Remove p2v-iso directory.
    
    As part of reworking the scripts that are used to build the P2V ISO,
    first remove the separate p2v-iso directory.  Similar scripts and
    documentation will be introduced back into the p2v/ directory in
    following commits.

commit e1ee037096a212beca8654a9f277be564066d9b1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 6 19:49:16 2014 +0100

    p2v: Temporarily remove Configure Network button.
    
    We will ship 1.28 without the capability of configuring the network
    (ie. DHCP will always be used).

commit a743f57cb8e74adaccae3a6f3b3da0c6961dc5ba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 6 19:47:15 2014 +0100

    p2v: Ensure the current version of virt-p2v is always displayed.
    
    This will help with debugging customer problems.

commit d7edde6b6dffb61dfd75edc1483eb6ed8ab56e2d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 6 13:49:13 2014 +0100

    p2v: Success message should have info logo, not error logo.

commit d82cf08ce12ffd86e9f1588881dbe3f0ffd12294
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 5 20:05:40 2014 +0100

    daemon: Check return value of end_stringsbuf.
    
    Found by Coverity.

commit 255ec57875221b9d7c620de4ddf038ac97743514
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 5 15:12:53 2014 +0100

    Version 1.27.38.

commit d85c38155a5c36ce9fc53a5318ab452921c0915d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 5 15:18:54 2014 +0100

    appliance: Add guestfs_shadow.aug to EXTRA_DIST.
    
    Fixes commit 61917136f5ad5efe30502f46f1adf60c20f15c97.

commit 553677398b8bfba60b3870a53d2f5174bac82147
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Sep 4 16:16:06 2014 +0200

    customize: use augeas to change passwords
    
    Make use of augeas to load and edit /etc/shadow, now that we have
    (either from upstream or by ourselves) a lens handling it.

commit a0cf4b3407ea86276633ca36389d0ec964e7d0d5
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Sep 4 16:14:42 2014 +0200

    sysprep: remove comment and notes about /etc/shadow lens
    
    We are either using the upstream lens, or our copy of it, to handle
    /etc/shadow, so now removing entries from it works.

commit 61917136f5ad5efe30502f46f1adf60c20f15c97
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Sep 4 15:27:37 2014 +0200

    appliance: daemon: import and use upstream shadow lens
    
    Import the upstream lens for the shadow file, just with a different
    identifier and not matching /etc/shadow by default. Instead, apply a
    transformation to have it match /etc/shadow only if the version of
    augeas is at least 1.2.1 [1].
    
    [1] While the last upstream version is 1.2.0, all the development seems
    to happen in master, so whatever the next version is going to be
    numbered (e.g. 1.2.1 or 1.3.0), the check will be fine anyway.

commit d01fbe86662860b3e7fef8b76a8ba9579669c8af
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Sep 5 14:47:22 2014 +0200

    daemon: add a way to check for the version of augeas
    
    Query augeas for its version when required, i.e. only once when using
    the new augeas_is_version function.

commit 54e32eb8e2e10369de4df0ab4481d1fbcf7ecfb9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 5 14:44:48 2014 +0100

    v2v: -i libvirt, -i libvirtxml: Print libvirt XML when debugging.

commit 35d49cd9de8f07ae281b276bad852ad33875a9b8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 5 14:13:28 2014 +0100

    v2v: When locating initramfs, ignore kdump initramfs images (RHBZ#1138184).
    
    Thanks: Tingting Zheng.

commit 096c05a750b8b525e48149c0c6522769c92ab07c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 5 13:36:01 2014 +0100

    v2v: -i libvirt: Check the domain is not running (RHBZ#1138586).
    
    It will print an error like this:
    
      virt-v2v: error: internal error: invalid argument: libvirt domain 'windows'
      is running, it must be shut down in order to perform virt-v2v conversion
    
    This only works for libvirt domains, and is explicitly disabled for
    test:/// URIs since these domains are always "running", but we use
    these URIs for testing.

commit de93b9060d88a3cda71eb1840d04c49fc94b404f
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Sep 3 17:38:32 2014 +0200

    daemon: make aug_close cleanup available for all
    
    Just code motion, no behaviour changes.

commit a935db30e5f27ab3f355ad77cabba01a82c53186
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Sep 5 11:29:57 2014 +0200

    v2v: R_OK is in Unix module

commit 922da70651a81c24f0fefc9f3885e1cda3250b5a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 5 09:54:32 2014 +0100

    v2v: -i disk: Add a clearer error message if the disk doesn't exist or is not readable.

commit d12f1ee99c42fe800567d82a5e99f1f31dd6760d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 5 09:49:39 2014 +0100

    v2v: -i disk: Don't fail if filename has no extension.
    
    Unhelpfully, Filename.chop_extension throws an exception if the
    filename has no extension (instead of just returning the filename).
    Therefore the -i disk option would fail if you passed any filename
    that didn't have an extension.

commit 54995514cb62b4adc066d178eabb7fded4b16196
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 4 15:21:17 2014 +0100

    Update gnulib to latest.

commit 0fc7cbe99b59484ac285da8825e4f351ca019d6d
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Sep 4 16:52:36 2014 +0200

    v2v: skip test-v2v-i-ova.sh if rhsrvany.exe is not installed

commit 03c9834cf3de504c9e2724894e7d9c222fd5e116
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 4 14:58:04 2014 +0100

    Version 1.27.37.

commit c3b3f683973813c008b5175726b68caa7fc6d4e8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 4 14:57:35 2014 +0100

    v2v: Add test OVF file to EXTRA_DIST.
    
    This fixes commit 90b1e9845fa0a25de12587749f259d0da8d70a01.

commit ba65af34357eb79e37480758416cdc4e184689aa
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Sep 4 13:42:20 2014 +0200

    customize: fix locking accounts with passwords
    
    When setting the password for a locked account, make sure to still write
    the password after the "!!" marker, otherwise the account will have no
    password.

commit 5edb78d1ae916e7d76be2ba0c4b86b3f82e8f9e1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 4 12:55:40 2014 +0100

    v2v: docs: Clarify how ESX & Xen imports happen through libvirt.

commit f243418d2300bf2bb7fdb64045544f6420ba90a3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 4 11:32:33 2014 +0100

    v2v: Add support for access to remote RHEL 5 Xen hosts over ssh.

commit 0c295c8e23a90d3a3f5efcfa0452ecde7317e122
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 4 12:37:12 2014 +0100

    v2v: -i libvirtxml: Detect disk format using any <driver type=...> field.
    
    Previously we only looked for <driver name=qemu type=...>.  However
    for Xen imports, the name field could be name=tap (or other values in
    fact).  Since there can only be one <driver/> element under <disk/>,
    look for any <driver type=...> in order to get the disk format.
    
    A further complication for Xen is that type=aio means "raw" (for
    obscure historical reasons), so map that.
    
    Thanks: Dan Berrangé.

commit 27a5ef9131317e4a715d1dfb62b155ee081c2888
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 4 12:07:36 2014 +0100

    v2v: Move json-generating code into separate module.
    
    Just code motion so we can reuse the same code for making
    `json:' remote SSH URLs.

commit d5662fe035be28f59e1f4ea9f3fd391aa93a591e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 4 11:19:24 2014 +0100

    -i ova: Tidy up the description in the manual page.
    
    This updates commit 90b1e9845fa0a25de12587749f259d0da8d70a01.

commit 90b1e9845fa0a25de12587749f259d0da8d70a01
Author: Shahar Havivi <shaharh@redhat.com>
Date:   Thu Sep 4 11:51:02 2014 +0300

    v2v: adding input -i ova
    
    Adding ability for v2v to get Vmware ova file as an input.
    
    Signed-off-by: Shahar Havivi <shaharh@redhat.com>

commit 44ca9d563a93126bd744a819dde7237d371fe1fd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 3 14:01:20 2014 +0100

    launch: libvirt / p2v: Fix empty_element macro.
    
    The empty_element macro was not safe when used in a "naked" if
    statement such as:
    
      if (config->flags & FLAG_ACPI) empty_element ("acpi");
    
    Fix the macro so it uses do { ... } while (0) to make it safe here.

commit 579119764226d040bec928d7944055b592437d7b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 3 12:25:37 2014 +0100

    v2v: Don't hard-code list of -i and -o options in help output.
    
    We can now get it from Modules_list.

commit 82b73852920685e1294f0349815daf3178ac2e20
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 3 12:15:27 2014 +0100

    v2v: Update TODO.

commit 941ebaa5e44cbf41e0dd94f811329d59f18c2868
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 3 12:15:00 2014 +0100

    mllib: error: Clearer message about how to enable debugging.

commit 711c32b0d9d31dc554b78f471be4b529eab4dbba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 3 12:14:27 2014 +0100

    mllib: Wrap errors at column 76 instead of column 72.
    
    Allows for slightly wider, better looking error messages.

commit bb362f687840cd9fcf68bea08fd34fe8e4ddc64c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 3 12:13:42 2014 +0100

    OCaml virt-* tools: Handle pretty printing of exceptions through a common library function.

commit e52742e6d35ae33e55e6fd7a0228e55ec63102d3
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Sep 3 11:13:54 2014 +0200

    sysprep: user-account: remove the correct home
    
    Query using augeas for the home directory of an user, instead of
    hardcoding /home/<username>.

commit ee5470d083f106f0843d65229c521d4f997674e8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 2 23:40:28 2014 +0100

    v2v: Clarify documentation for -o local.

commit 11b1e2862b0b37d33152faef737854920d75a2b9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 2 22:40:13 2014 +0100

    v2v: Update TODO.

commit e0506486b0b2ac0be0f975c299bd7ca442718b8f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 2 19:36:25 2014 +0100

    v2v: Review 3-X comments in TODO file and remove any which are not short-term goals to fix.

commit 03ed5a790b571db2ff5f96f58bdbc01af4646cb2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 2 19:34:09 2014 +0100

    p2v/v2v: List output drivers in `virt-v2v --machine-readable', and use that in virt-p2v.
    
    The new output of virt-v2v --machine-readable now lists the input and
    output drivers available in the binary:
    
      $ virt-v2v --machine-readable
      virt-v2v
      libguestfs-rewrite
      input:disk
      input:libvirt
      input:libvirtxml
      output:glance
      output:libvirt
      output:local
      output:rhev
    
    With this information, we can now pre-populate the virt-p2v GUI
    combo box.

commit 03d848ab68a1de7cbee49a6a00963f91e8f53696
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 2 17:06:45 2014 +0100

    Version 1.27.36.

commit 10f6206202b70f1f92807f5d5fed768a3f9e524c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 2 16:49:25 2014 +0100

    p2v: Support for interface to network map.
    
    Instead of having all interfaces connect to the "default" network on
    the hypervisor target, you can now create a map of interface to target
    network, either on the kernel command line, eg:
    
      p2v.network=em1:rhevm
      p2v.network=em1:rhevm,em2:management,other
    
    or through the GUI.

commit 1ce65eeaefa2ce203db50a455c537b647d885230
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 2 16:22:52 2014 +0100

    p2v: Print config->output_connection field in conversion debug.
    
    This fixes commit 81d3aee0713faddc320cd1db5ac125891d07a0f0.

commit 128d474095bfabc2d724d0181155e364f1afbabf
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Sep 2 15:55:33 2014 +0200

    sysprep: user-account: select which users to remove or keep
    
    Enhance the user-account sysprep operation, so it is possible to select
    which user accounts should be removed only (instead of all), or which to
    eventually keep.

commit c902ede1cd345258d6c388ab804fbf6a92b24ffd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 2 14:25:16 2014 +0100

    p2v: Use libxml2 to write the libvirt XML document instead of printfs.
    
    Solves quoting issues.  This is just code reorganization, there is no
    substantive change in the output.

commit fc52f98c76d37273d8a420a99fefb2e5d71dcd50
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 2 13:29:53 2014 +0100

    v2v: Update TODO file.

commit f0e1f580b17a84fbc914acb50975d0e43ed1f2df
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 2 13:19:24 2014 +0100

    p2v: Add some spacing on the conversion dialog.

commit 750e8190348a88a7daf861e1162e5812faead059
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 2 08:53:31 2014 +0100

    p2v: Add GUI controls for -o, -oc etc options on virt-v2v command line.

commit 81d3aee0713faddc320cd1db5ac125891d07a0f0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 2 08:58:46 2014 +0100

    p2v: Change p2v.output -> p2v.o etc and add p2v.oc
    
    Name these the same as the virt-v2v options, so for example
    '-oa' -> 'p2v.oa'.
    
    Also add the missing p2v.oc (-oc) option.
    
    This updates commit c516d2d07dd0d1e4429ec84d2e9ebe02a951c5b5.

commit 379f335059f31338e207d8d2b2c17d55334bcafe
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 2 14:32:54 2014 +0100

    v2v: Give a reasonable, early failure if output format is not raw or qcow2.
    
    See comment in the code for reasoning.
    
    Thanks: Shahar Havivi for discovering this.

commit c004e4648d2091eb217026b15eed7e041557b635
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Sep 2 11:36:29 2014 +0200

    appliance: exclude a lvm2 rule on Ubuntu (RHBZ#1111662).
    
    On Ubuntu, exclude the Ubuntu-only 85-lvm2.rules since it causes the
    automatic activation of volume groups on addition or change. This
    interferes with libguestfs, as vgs which are disables suddently get
    enabled.

commit 65822315109cdb1e0079d687ce0d59fdfd6d83f2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 2 09:05:12 2014 +0100

    generator: Don't use ocamldep -all option in this directory.
    
    ocamldep -all (introduced in commit a3881445efd0) creates a dependency
    rule
    
      optgroups.cmi ... : utils.cmx ...
    
    Because we never build a native code version of the generator,
    utils.cmx can never be remade, and so this results in optgroups.cmi
    being always rebuilt and hence rebuilding the whole directory.
    
    It's unclear how to fix this, but reverting the ocamldep -all change
    in this directory works around it.
    
    Partially reverts commit a3881445efd04d5fe6da29db8b2d62a30088b9d1.

commit a3881445efd04d5fe6da29db8b2d62a30088b9d1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 1 22:24:14 2014 +0100

    Use ocamldep -all option.
    
    In v2v, 'stringMap.ml' has no corresponding *.mli file.  ocamldep does
    not generate a *.cmi dependency for such modules, and this can result
    in parallel builds failing rarely because:
    
     (1) stringMap.ml is built (which has the side-effect of generating
         stringMap.cmi)
    
     (2) at the same time, types.mli is compiled.  types.mli depends on
         stringMap.cmi, but it is half way through being created by (1).
    
    There is no dependency to serialize (1) and (2).
    
    The resulting error is:
    
      File "types.mli", line 1:
      Error: Corrupted compiled interface
      stringMap.cmi
    
    Using 'ocamldep -all' generates extra deps for the *.cmi files, and
    otherwise appears to be safe, so use it.
    
    There are currently a few upstream OCaml bugs with dependencies and
    parallel builds:
    
    http://caml.inria.fr/mantis/view.php?id=3190
    http://caml.inria.fr/mantis/view.php?id=4991
    http://caml.inria.fr/mantis/view.php?id=5000
    
    It's not clear which of these apply here.

commit c435053b3476094cd7e05c50c2e7713fcb646d5c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 1 21:29:13 2014 +0100

    Improve diagrams on various manual pages using Unicode box drawing characters.

commit 3c1b81d2af5c61863ac59e28f2a8509ed7a3e7ce
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 1 17:40:56 2014 +0100

    Version 1.27.35.

commit 22a556099a41ca4cbbfb746b1e620348b41b5049
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 1 14:10:49 2014 +0100

    p2v: Add a test of virt-p2v.

commit c516d2d07dd0d1e4429ec84d2e9ebe02a951c5b5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 1 17:16:52 2014 +0100

    p2v: Add p2v.output* controls so we can control where the output ends up.
    
    This still needs to be implemented through the GUI.

commit b16e98ba140d55a3341fcd4a0bca946bca6d3643
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 1 17:14:17 2014 +0100

    p2v: Fix p2v.disks (etc) parsing on kernel command line.
    
    The parsing of p2v.disks, p2v.removable and p2v.interfaces did not
    correctly end at the first space, and therefore any other parameters
    that happened to be on the command line afterwards would be consumed
    as a list of disks or interfaces.

commit 0136f50f064bbcea303298e6f22935ee1afffb46
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 1 16:07:04 2014 +0100

    p2v: Add a status message for when we detect the control connection has been closed.

commit 04740c5a35654688183c50863c80b9a427019922
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 1 16:06:05 2014 +0100

    p2v: Send SIGHUP (not SIGTERM) to kill child process.
    
    One reason is that when testing the child process will be bash (not
    ssh), and bash is documented to ignore SIGTERM when it is running
    interactively.

commit b1125a9db71b51b9208571485e75774adee10017
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 1 15:55:56 2014 +0100

    p2v: Allow -EIO error when reading pty to mean the writer has closed the connection.
    
    This is apparently normal behaviour for ptys.

commit 8e5233741f64efb7c8a0cae51f1434fb3497038d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 1 13:06:09 2014 +0100

    v2v: Update TODO file.

commit 9fb2b82dbe32463858c7116d129d48c528729088
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 1 12:21:51 2014 +0100

    v2v: Add some defensive code to test for the broken qcow2 overlay bug.
    
    In commit 53e0d3ea5fc703066f0eb92a49eaf8be18961e7e I fixed a cause of
    disk corruption in the overlay file during conversion.
    
    To ensure this doesn't occur again unexpectedly, add a simple test to
    the virt-v2v code and to the tests.

commit 431cdfd983bc9864d6a44a456a97b72455bb17cd
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Sep 1 11:46:57 2014 +0200

    fish: edit: write to the real file name
    
    When saving, resolve the path of the file being edited and use that as
    real target to write to. Otherwise, if the file name is a symlink then
    it will be replaced by a regular file with the new content, leaving the
    old file untouched.
    
    Extend test-edit.sh to check for this situation.

commit ca9930ef164286df5075cac890f558974efe0893
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Sep 1 10:28:00 2014 +0200

    test-tool: stop printing the FEBOOTSTRAP_* envvars
    
    Stop printing the FEBOOTSTRAP_* environment variables, since they are
    not used anymore.

commit 356fe582b8d64163fb84f662b37f534633b9c2a7
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Aug 29 16:38:04 2014 +0200

    fish: edit: centralize the EDITOR handling
    
    Allow null as value for the editor parameter of edit_file_editor, which
    will then get it from the EDITOR envvar (falling back on vi).
    
    This is basically code motion from the two edit_file_editor users to it.

commit b1a648887547c10818e64b45aa983e8287b034d4
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Aug 29 14:58:31 2014 +0200

    fish: edit: factor out download and reupload phases
    
    Share some code between edit_file_editor and edit_file_perl; mostly code
    motion, with no actual behaviour change.

commit 510329939bf675a20f782939f8857ac433acec5c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Aug 31 14:09:51 2014 +0100

    v2v: -o glance: Write potentially huge temporary images to /var/tmp by default.
    
    Instead of /tmp.  This can be controlled by setting
    $LIBGUESTFS_CACHEDIR or $TMPDIR.

commit 705e4bfd11274b09cdc2e821f281e3faed28268b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Aug 31 13:37:51 2014 +0100

    builder: Add test of the --edit option.

commit 1fb19fcad3c2aa572951bddcecd01a93b8c469b2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Aug 31 13:35:33 2014 +0100

    customize: perl_edit: Type of Guestfs_val() param is a Guestfs.t not the object wrapper.
    
    This fixes commit c6b7e6cddac850d6d2caf2e2f3060467c38397fe.

commit 94cffee541a329de081fbec78c96d1e753bef6fa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Aug 31 11:35:58 2014 +0100

    -o glance: Multiple fixes.
    
    Now tested and working on a glance server.
    
    This fixes commit f01f641fbb1a29b5727c0443f3700b1c871ccfc9.

commit 5c487541beceb634997822030039ef4ddc6f3b63
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 29 22:43:10 2014 +0100

    Version 1.27.34.

commit 0d2f4c507455c8bd54c53770d1df047adb462808
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 29 21:14:24 2014 +0100

    v2v: Minor correction to -o glance documentation.
    
    This fixes commit f01f641fbb1a29b5727c0443f3700b1c871ccfc9.

commit f01f641fbb1a29b5727c0443f3700b1c871ccfc9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 29 18:27:20 2014 +0100

    v2v: Output to OpenStack Glance (-o glance option).

commit 1ce930ed2749b50bed52910f6d9067f37d3d1a84
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 29 18:22:20 2014 +0100

    v2v: Use copy_on_read in the overlays.
    
    To speed up conversions by storing everything we read during
    conversion in the overlay instead of having to reread it from the
    remote server during copying.
    
    Thanks: Matthew Booth.

commit 180e3c30dee577dd44b3f1ae5bb16de2459b1d23
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 29 18:19:13 2014 +0100

    Add support for qemu copy_on_read feature.
    
    When drives are added with this flag, reads from the backing file are
    copied into the overlay, improving performance of reads to the same
    area of disk (at the expense of local storage).  This is excellent for
    reading remote / slow sources like HTTP.

commit 6a3147a5a0259ab72c7e92e2ff00859f2fa8a09e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 29 16:26:45 2014 +0100

    v2v: esx: Add note to documentation about being asked for the password twice.

commit 8aea6d8fac809c00280a5738257ef4134357141e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 29 10:05:47 2014 +0100

    v2v: More esx:// -> vpx:// changes.
    
    This updates commit 155a6f0482e5eeb6a763d4d31354edc5f48a1f43.

commit c6b7e6cddac850d6d2caf2e2f3060467c38397fe
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Aug 28 15:06:39 2014 +0200

    customize: use the common perl file editing code
    
    Wrap edit_file_perl to OCaml, and use it instead of the OCaml version
    of it.

commit 57b3a35764a959e3f0995a1b38a129e75bd03f82
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Aug 28 14:23:46 2014 +0200

    fish: edit: add verbose parameter

commit 2d217eb00e38176767a50dadbbb80356e7362492
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Aug 28 11:33:14 2014 +0200

    edit: switch to common editing functions
    
    Switch virt-edit to the common edit_file_editor and edit_file_perl.

commit b53126efb0205b4722897c7d79acf6dbc810caf7
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Aug 28 11:21:12 2014 +0200

    fish: edit: add perl file editing
    
    Add the perl file editing, mostly based in the virt-edit implementation.
    
    This introduces a mild code duplication with edit_file_editor; will deal
    with it in a later commit.

commit f1c6d5d7f2b852c1d2ccee409c6ac58c02d2bfd2
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Aug 28 11:02:53 2014 +0200

    fish: edit: bring the fast-time-edit protection
    
    Bring from virt-edit the small hack of putting the ctime of the
    temporary file few seconds back to notice file changes also on fast
    editing.

commit c9b6c8dac1bc0fd7ece202d2d7acccb8279d053e
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Aug 28 10:45:28 2014 +0200

    fish: edit: return 1 for unchanged file
    
    Change the return value of edit_file_editor to 1, in case the editor did
    not change the (temporary) file.

commit f79ee54722aee530a4f0a0b61cfe1cba3035fc86
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Aug 28 10:44:55 2014 +0200

    fish: edit: bring backup extension to file editing w/ editor
    
    Bring the backup extension feature from the perl-like file mode
    implementation, although currently not making use of it.

commit 511275acb1e27b85034eb7b767dd4e93491f74a8
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Aug 28 10:29:55 2014 +0200

    fish: edit: improve the editor execution
    
    Dynamically allocate the buffer for the command, and check also its exit
    status.
    
    Improvements taken from the current implementation in virt-edit.

commit 7b9f0cf777c08b89195ef496f74bb35fe528e1d2
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Aug 28 10:19:09 2014 +0200

    fish: isolate file editing (w/ editor) code in own file
    
    Move the implementation of file editing using editor to an own file, so
    that can be shared by different tools.
    
    Mostly code motion.

commit 582a8fcd84e50ef3ef09c527d84f3d679044c243
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Aug 27 16:51:05 2014 +0200

    cat: use the common Windows path handling code

commit 73ed3171be20a25cbb13fc209d6126943e66d90c
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Aug 27 16:44:27 2014 +0200

    fish, edit: move the exit-on-case-sensitive-error behaviour to virt-edit
    
    Do not unconditionally exit if guestfs_case_sensitive_path, but let
    windows_path still return null. Make virt-edit then check for that, and
    eventually exit on its own.

commit de6258352997e4e7990862a9809d4fbbc875b978
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Aug 27 16:41:35 2014 +0200

    fish, edit: specifies whether mount Windows as readonly

commit 7523e308fa866efa9dec2ab170b473245903e09d
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Aug 27 16:18:47 2014 +0200

    edit: move windows path code to common file
    
    Move the code handling Windows paths from virt-edit to a common file,
    so that can be shared by various tools.
    
    Mostly code motion, with a minimum touch (the additional guestfs_h*
    parameter in mount_drive_letter) to make it build and work.

commit 2ab7906f7c695835c642e3dec9012090dcbe5d5c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 29 09:50:40 2014 +0100

    Version 1.27.33.

commit ed6173f6104e2b9f01f8b0de209935687df2bc8f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 29 09:41:33 2014 +0100

    v2v: Fix real conversions test by setting architecture in libvirt XML.

commit 591911f4bf0c328b207f8984c78fb6ede450f692
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 29 09:09:32 2014 +0100

    Add suppression for memory leak in libvirt testDomainGenerateIfnames.
    
    See: https://bugzilla.redhat.com/show_bug.cgi?id=1135388

commit 620d20c4bb314e6543a4901880845d01ee7d2ef9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 28 22:00:33 2014 +0100

    Version 1.27.32.

commit d8e04d454a756946516416df8c7df60289c68cdf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 28 21:49:48 2014 +0100

    v2v: Fix bugs in conversion when uninstalling VMware drivers.
    
     - Don't uninstall open-vm-tools (the old virt-v2v didn't).
    
     - Do fix the library replacement code so it works the same way as
       old virt-v2v.

commit 155a6f0482e5eeb6a763d4d31354edc5f48a1f43
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 26 19:34:37 2014 +0100

    v2v: esx: Add / fix ability to import guests from vCenter Server.
    
    See additional information in the manual page for details.

commit 3fa4fff9b485d8d8b92d5d925b4e047358e63175
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 28 15:05:17 2014 +0100

    v2v: -i libvirt: Allow map_source* functions to map the format as well as the path.
    
    For ESX we need to map the format (which is usually unspecified) to raw.

commit 04121c40a164072227de34289f5662f1701fe12e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 28 14:59:45 2014 +0100

    v2v: -i libvirt: Add whitespace to make the code clearer.

commit abbb636e759bcfc87260cbef780fda1bed815ea0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 27 20:39:35 2014 +0100

    v2v: Display a %-done progress bar when copying the disk image to the target.
    
    This isn't quite the progress bar we have in mind, but it's sufficient
    for now.
    
    When --quiet is used, the progress bar is not displayed.

commit e3a02c4153f3064dd9427c4044849cf77b3a3421
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 27 20:16:06 2014 +0100

    sparsify: Remove obsolete comment.
    
    We don't need to use compat=1.1 with modern qemu, and
    lazy_refcounts may be dangerous.

commit 53e0d3ea5fc703066f0eb92a49eaf8be18961e7e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 27 20:28:15 2014 +0100

    v2v: Remove lazy_refcounts option.
    
    This seems* to cause disk corruption in the overlay files.  A
    manifestation of this is that the qcow2 header is not written back
    correctly to disk, resulting in the backing file of the overlay
    "disappearing" and hence hardly any data being copied over to the
    target.
    
    * Note this could be for a variety of reasons and doesn't necessarily
    indicate a fault in qemu or qcow2.

commit 7aced6ffb20c27af725040abc4faecf3ddc61010
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 27 14:42:44 2014 +0100

    v2v: -i libvirt/libvirtxml: Check that domain type, name, arch are not missing.
    
    This can lead to incorrect output.

commit e112e9a7b2eaa9d75acc6e722e73f3ae377ab9f0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 27 14:35:08 2014 +0100

    v2v: -o libvirt: Fix <features> XML in output.
    
    It was writing each feature as PCData (ie. text), not as a separate
    element, resulting in corrupt <features> output.

commit 4132680aea6b564c7fd668b859b262c58773a4dd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 27 09:42:50 2014 +0100

    v2v: -i libvirt: Don't access remote -ic URIs during object creation.
    
    Previously if you used `-i libvirt -ic [a remote URI]' then the remote
    URI would be opened during object creation, which occurs during
    command line parsing.  The practical effect was that virt-v2v could
    appear to hang or give an error (eg if the remote URI is inaccessible)
    before printing any log messages.  This could be very confusing for
    the user.
    
    Split out -i libvirtxml into a separate module, containing the libvirt
    XML to source parsing code as a function called
    Input_libvirtxml.parse_libvirt_xml.
    
    Modify -i libvirt so it does all initialization and calls the helper
    function during the #source method, and not at object creation time.

commit f54aff9e9ffa55a50d4e7a15586931035e5884f4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 26 22:56:31 2014 +0100

    v2v: utils: Permit more safe/unquoted characters in url_quote function.

commit a18629ce40457ef429dc6dbbd10cd89eb8cc4cf7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 26 19:34:22 2014 +0100

    v2v: utils: Don't need to use module name (Common_utils.) here.

commit 715020e264a87e167595557670c46bab0b4db5a8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 26 22:49:05 2014 +0100

    v2v: Remove bogus %systemroot%\Drivers path.
    
    This was based an incorrect translation of what the old virt-v2v was
    doing.  %systemroot%\Drivers is not expected to exist already, and
    indeed does not exist in a real Windows 7 guest.

commit f527c22b009e2a7005b186db8889e553b935e9e6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 26 17:48:02 2014 +0100

    v2v: Implement binding for `virsh pool-dumpxml'.
    
    Add a mini-binding to libvirt virStoragePoolGetXMLDesc to get the pool
    XML directly using the libvirt API.  Change existing external calls to
    `virsh pool-dumpxml' to use this API instead.

commit 8dc45325a6b7790896a43f41db5aca376aee2bfc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 26 17:31:08 2014 +0100

    v2v: Work around buggy `virsh dumpxml'.
    
    The `virsh dumpxml' command doesn't work properly when the libvirt
    source requires authentication.  This is because the authentication
    prompts are sent to stdout, but stdout is also the place where we are
    reading the output XML from.
    
    Add a mini-binding to libvirt virDomainGetXMLDesc which avoids this,
    getting the XML directly using the libvirt API.  Change existing
    external calls to `virsh dumpxml' to use this API instead.

commit 53999bddf44539f70164a8aa8f2abb011cf33264
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 26 17:34:57 2014 +0100

    v2v: -o libvirt: Mistakenly we were calling `virsh dumpxml' instead of `virsh pool-dumpxml'.

commit c916ea5b680776f70f21ecb224e0e2ca7031c0f4
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Aug 26 16:12:24 2014 +0200

    daemon: lvm-filter: use augeas for setting the filter
    
    The way to set the filter for lvm devices was to open lvm.conf, look
    for uncommented "filter =" lines and replace the configuration there.
    This had the issue that if there is no uncommented filter line, then the
    filter cannot be changed at all; considering newer lvm2 releases ship a
    sample configuration with no uncommented filter lines, then the old way
    became wrong and not sufficient.
    
    Instead, take a copy of the upstream lvm.aug lens, with a simple change
    to allow parsing also negative values in configuration, and install it
    in the daemon. When asking to change the lvm filter, use augeas making
    sure to use this custom lens for the lvm.conf copy used within the
    appliance.

commit abb0b47e3f1b8b86d2d39c2a91782ac5ed4b134e
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Aug 26 14:39:28 2014 +0200

    daemon: move AUGEAS_ERROR to the common header
    
    Other than for current aug_* API, it will be useful for further code
    using augeas directly.

commit 9b501fa5c6365958de362ecaf0f4e90c147978a2
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Aug 26 14:31:05 2014 +0200

    daemon: add add_sprintf
    
    Bring the add_sprintf function for stringsbuf from the library.

commit b56b90bf6ed5812400e02daea54621834dab96ef
Author: Shahar Havivi <shaharh@redhat.com>
Date:   Tue Aug 26 17:19:36 2014 +0300

    v2v: add xmlXPathRegisterNs for libxml2 binding
    
    Signed-off-by: Shahar Havivi <shaharh@redhat.com>

commit 3f315f54e80f449d9fd7b05eafa1c23996775d02
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 26 16:01:39 2014 +0100

    Enable warnings in C code linked to virt-sparsify and virt-v2v.
    
    The C code didn't have -Werror enabled (when configured) and didn't
    enable the full set of warnings we would want.
    
    However OCaml-C bindings commonly declare functions which are
    called directly from OCaml, eg:
    
      external parse_memory : string -> doc = "v2v_xml_parse_memory"
    
      value v2v_xml_parse_memory (value xmlv)
    
    These do not require prototypes as no other C code will call them, so
    we have to switch off the GCC -Werror=missing-prototypes flag for
    these files.
    
    Also fixes some confusion between _CPPFLAGS and _CFLAGS.

commit 880bf5f2ef036186f820034b87febdd6ee87e9f0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 26 15:45:11 2014 +0100

    v2v: -i libvirtxml: Add example libvirt XML.

commit 8e7cf61a409c4303e6088116f213aad726770f36
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 26 15:43:52 2014 +0100

    v2v: -o local: Use /var/tmp instead of /tmp for examples.
    
    In case people are suffering from broken tmp-on-tmpfs setups.

commit 97f634e5fbc57620172fee55c8e5aff5edc9b597
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 25 22:13:34 2014 +0100

    v2v: Split Types.overlay into Types.target and Types.overlay structures.
    
    Move the fields from Types.overlay which were related to the target
    file out.  Now Types.overlay is only concerned with the actual qcow2
    overlay files, not with a mixture of both files.
    
    For every guest disk, there is one chain which looks like this:
    
       source_disk         overlay                 target
      +------------+      +----------------+      +---------------+
      | s_qemu_uri |<------ ov_source      |<------ target_overlay|
      | etc        |      | ov_overlay_file|      | target_file   |
      +------------+      | ov_sd          |      | target_format |
                          | ov_virtual_size|      +---------------+
                          +----------------+
    
       describes source    describes temp.         describes target
       disk file           overlay (qcow2)         file
    
    This is just refactoring.

commit 29b8fb6c15f31fdbd56a52e4472e259edc24e936
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 25 21:42:15 2014 +0100

    v2v: types.mli: Fix typo in comment.

commit 4d30b82ea3c6a231193203cf608f5537693c0679
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 25 21:36:28 2014 +0100

    v2v: Change "Trimming the filesystems" message to something less scary.
    
    Avoid copying unused and blank areas.  Avoid alarm and support calls too.

commit 93943a0f779cdda7d5df3225efeab9adbc68123a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 25 21:31:05 2014 +0100

    v2v: Simplify conversion dispatch code.
    
    Refactoring, no functional change.

commit 0f2b503394e1c3bf38d196859970c057be7806a8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 25 20:35:55 2014 +0100

    v2v: Update TODO.

commit 862a27c92d495975cc12925599333e108f16b20d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 25 20:29:31 2014 +0100

    v2v: Inline the initialize_target function.
    
    This function had got smaller and smaller until now we might as well
    just inline it.  Having it after the main function just obscured the
    order that the code runs.
    
    No functional change, just refactoring.

commit 5800d96e7a5fce47187dcf74a7d43fa9c385b8b5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 25 20:27:44 2014 +0100

    v2v: Remove the Types.overlay ov_source_format field.
    
    Not used by anything and unlikely to be useful.

commit 938fe047d087f6a8e0bd79f7e275948a60eb1508
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 25 20:22:19 2014 +0100

    v2v: Remove Types.overlay ov_preallocation field.
    
    The ov_preallocation field was essentially an implementation detail of
    the V2v module.  There was no need to carry it around in the overlay
    struct, and nothing else used it.  This also allows us to simplify
    other code.

commit 4c492e21ac61769c28cfd6ceb0b869cfcedd59a6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 25 20:15:53 2014 +0100

    v2v: Add comments to DOM module.

commit 613ae49319245189c085136371957cf110b9224e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 25 20:08:56 2014 +0100

    v2v: -o rhev: Move inspection functions.
    
    This is pure refactoring, no functional change.

commit 86a1f5581065704fc90e11225abe4c9169af7125
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 25 15:45:31 2014 +0100

    v2v: Trivial fix to documentation in internal interface to libxml2.

commit ce59aa8c845cfa4918cb9a0cec0b9056e28c1d4b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Aug 24 21:21:10 2014 +0100

    Version 1.27.31.

commit 066eb6962521015cf82c5e7e773911e3288d2c79
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 22 09:47:09 2014 +0100

    v2v: int64 -> int fix for previous commit.
    
    This fixes commit 318a1b17a6be2e20245ca05a68448b5dcd048884
    (thanks Pino Toscano).

commit 318a1b17a6be2e20245ca05a68448b5dcd048884
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 21 23:38:34 2014 +0100

    v2v: -i libvirt: Select sensible defaults if <memory> or <vcpu> is missing from input XML.
    
    If the <memory> or <vcpu> elements was missing from the source
    metadata then we would choose useless defaults, resulting in (for
    example) <vcpu>0</vcpu> being written to the output.
    
    Choose sensible defaults for these integer values.

commit 78f725ffd5d06557c401b3618dc4b73722655e00
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 21 23:25:44 2014 +0100

    v2v: Store original vnet, and add comment to output metadata when mapping it.
    
    When we map the network or bridge names (using --network or --bridge
    command line options), this commit keeps the original name and adds it
    as a comment to the output metadata.
    
    The comment will look something like this:
    
        <interface type='bridge'>
          <!-- bridge mapped from "VM Network" to "bridge1" -->
          <source bridge='bridge1'/>
          <model type='rtl8139'/>
        </interface>

commit d629b5252bbc26a5ffa88e235f6090f260bd436b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 21 23:24:39 2014 +0100

    v2v: DOM: Add XML comments (<!-- .. -->) to the model.
    
    This allows us to insert comments into the output libvirt XML or OVF.

commit 6e1e9604b6da2ef8eeca2acb945bde6becad038e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 21 21:47:22 2014 +0100

    v2v: Add a test of --network and --bridge command line options.
    
    This enhances commit aaf84abca9e19e6a358516b60cc8a49d0905aef5.

commit 02b653496db36666c8f36e4a1ec6a0daad3de146
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 21 22:36:44 2014 +0100

    v2v: -o rhev: Improve the error message when you pass a bogus -os parameter.

commit 9fa27d4f79673d3898f36fde974eb3ad30690032
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 21 22:23:55 2014 +0100

    v2v: -o libvirt: <source file=...> must always be an absolute path.

commit 53e788890d868d2a98c2dcfd48de02dcfca698aa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 21 22:22:04 2014 +0100

    v2v: DOM: Produce pretty-printed XML.

commit 1e1605d937a4e1dfa08aa577d6a8b9bf7213c401
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 21 22:21:54 2014 +0100

    mllib: Export output_spaces function.
    
    This was already in Common_utils, but was only used internally
    not exported.

commit b9e591f7f08c8ba5373e9c940599109f492695c9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 21 21:46:45 2014 +0100

    v2v: Tests can use guests.xml not guests-all-good.xml.

commit 350e3285f35862251165db8233d1d70aac9a73cd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 21 21:25:33 2014 +0100

    v2v: Update documentation for input & output classes.

commit f71d62fa7853c81332275f96db5ee90c9767c0ec
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 21 19:38:27 2014 +0100

    Version 1.27.30.

commit 4389702e5c96a894fe0d97666fc16c92c775d8d2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 21 19:28:41 2014 +0100

    v2v: Remove build path which inadvertently appeared in test data.

commit 1e1ceb52730d22cf06a0fa098f9382a7071c7ca1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 21 17:08:35 2014 +0100

    Version 1.27.29.

commit 1d0ef02b3665822ae89ddd2bd39a79c728075cf3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 21 17:06:53 2014 +0100

    v2v: Fix check-valgrind on --print-source option.
    
    This updates commit 3a6dc32342cd6a545d66e9b773bab8450f533fa5.

commit f5fda273b18380f44d399dae230ec622335e9f23
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 21 15:00:53 2014 +0100

    v2v: Remove ov_vol_uuid hack.
    
    Now that we're using classes for outputs, we can hide the RHEV volume
    UUIDs in the output_rhev class.

commit 3903f97cb38dfb0beaf26e37fb4f4a7a45850a74
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 21 14:49:43 2014 +0100

    v2v: Replace strings with variants for extra type safety.
    
    No functional change.

commit c3dda31492c1d5f53b47278ae383c7d4ce8d86b3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 21 13:35:59 2014 +0100

    v2v: Pass verbose flag into every input and output subclass.

commit d1c8240b76d4c900ddb61e4a9c3e0e8d9f4907b3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 21 13:27:09 2014 +0100

    v2v: Print log message when opening the source.

commit ca05d757b00359e05536b3fb01484c0b61cd0934
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 21 12:25:43 2014 +0100

    v2v: Change input and output variants into classes.
    
    Previously Types.input and Types.output were variants, resulting in
    the main v2v.ml code having to have knowledge of all the input and
    output types.  So you would end up with code in v2v.ml like:
    
      match output with
      | OutputLibvirt -> (* call some libvirt-specific code *)
      | OutputRHEV -> (* call some RHEV-specific code *)
    
    This changes these types to be abstract superclasses, with specific
    implementations provided by (and hidden inside) each input/output
    module.  The above code in v2v.ml now becomes:
    
      output#call ... (* no backend-specific knowledge needed *)
    
    Although this commit is very large, it is just refactoring.  There is
    no functional change in the code.

commit c7e56a530690e649a8ab33c1e40137900fb6927c
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Aug 21 13:20:25 2014 +0200

    appliance: add glibc-locale on OpenSUSE
    
    Provides the gconv modules, needed for iconv to work.

commit 640109e1e506a66111ce45ce82c9321e7da05887
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 21 11:02:37 2014 +0100

    v2v: Reorder sections in the manual more logically.

commit 3a6dc32342cd6a545d66e9b773bab8450f533fa5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 21 10:21:19 2014 +0100

    v2v: Add --print-source option.

commit aaf84abca9e19e6a358516b60cc8a49d0905aef5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 21 10:07:46 2014 +0100

    v2v: Add --network and --bridge options to perform network name mapping.

commit e787c7f213f67cc53e41774f2f6b363b517fe7c1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 21 09:12:04 2014 +0100

    v2v: Let source.s_name be the renamed guest name (in case we use -on option).
    
    The original guest name is saved in s_orig_name, although I checked
    all uses of s_name and nothing needs it at the moment.

commit cf714fc08d455bc4524d97ca7b575bf3cc50b7be
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 20 11:44:49 2014 +0100

    v2v: Update TODO.

commit ccb47f93ff52a4f80498072cf679e502b782f655
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 20 21:16:57 2014 +0100

    v2v: Add support for remote ESX connections.
    
    This allows `-ic esx://...' to work because we map the strange source
    URI used by ESX to a remote HTTPS connection.
    
    Example disk section that this handles:
    
        <disk type='file' device='disk'>
          <source file='[datastore1] Windows/Windows.vmdk'/>
          <target dev='sda' bus='scsi'/>
          <address type='drive' controller='0' bus='0' target='0' unit='0'/>
        </disk>

commit 0539c2044c69f892c0a31fdb490e44403853fa57
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 20 20:00:59 2014 +0100

    v2v: VMware returns MAC all zeroes.  Map this to None.

commit bc037d9dedc862c26f6fb9281b5798dd1678cb90
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 20 12:21:05 2014 +0100

    v2v: source_libvirt: Replace create_xml ?dir parameter hack.
    
    Instead of the ?dir parameter which was essentially a hack, allow
    callers of create_xml to provide functions that map
    <source file="..."> or <source dev="..."> to qemu URIs.
    
    The default for these mappings is the identity function.
    
    For -i libvirtxml we replace the old absolute_path_of_disk function
    with a source file mapping function which does the same thing.
    
    There is no functional change in this patch.

commit 2fc9fdda98dac8f665f204c5c9baf13541f49014
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 20 12:14:26 2014 +0100

    v2v: Don't attempt to make block device paths absolute.
    
    <source dev=...> in the libvirt XML should always refer to a block
    device, eg. /dev/sda1.  Don't attempt to make these paths absolute
    (they should already be absolute paths, and if they are not it's wrong
    to try to make them).

commit 7800150d06a6ec73194def6d05f90273aa40205e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 20 12:04:32 2014 +0100

    v2v: Add binding for libxml2 xmlParseURI.
    
    There is already a partial binding for this in fish/uri.c &
    mllib/uri-c.c.  However it is specialized to parsing the -a parameter
    on the command line and we want access to the full underlying
    functionality of xmlParseURI.

commit c5c3a23294dafc2352644e58b79c21fe0cd5ae99
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Aug 20 18:56:39 2014 +0200

    appliance: add mkisofs on OpenSUSE
    
    Needed for isoinfo.

commit 3ceff73915839f49686e6f55018929215c889782
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Aug 20 16:57:06 2014 +0200

    appliance: add cdrkit-isotools and mtools for Mageia
    
    - cdrkit-isotools provides isoinfo, used by the daemon
    - mtools is used by syslinux without being a dependency

commit b6ba84499228bf9ee52d319f1b34631409f3a3f4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 19 22:24:45 2014 +0100

    v2v: Add some examples to the manual page.

commit bcce760166f3a377376c030fba0a5e7d86e4f005
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 19 19:46:24 2014 +0100

    Version 1.27.28.

commit 3d1cb74b3eee51c5d015032ad964892be914ea9c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 19 13:34:55 2014 +0100

    v2v: Add display, removable disks, and network interfaces.
    
    These are now collected from the source metadata and (where
    possible) passed through to the destination.
    
    For reference, see the metadata structure of the old virt-v2v (roughly
    equivalent to Types.source in the new code):
    
    https://git.fedorahosted.org/cgit/virt-v2v.git/tree/metadata-format.txt
    
    As you can see the new code now covers all the metadata features of
    the old code.

commit df471095ef39e7b8e87300ed8599a35a581f3d05
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 19 13:34:35 2014 +0100

    v2v: Update TODO file.

commit 8b3b7cc0daf424249d49fbd7bca2d3a80d1af556
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 19 12:16:04 2014 +0100

    daemon: Fix echo-daemon so it doesn't fail on empty array input.

commit 0ed91a7399c9c58cc29c1320df0d70c9f1d49229
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Aug 19 15:48:05 2014 +0200

    appliance: initial packagelist for OpenSUSE
    
    Mostly complete and making most of the features work.
    
    The notable lack is ntfsprogs and ntfs-3g, which due to the way
    mount.ntfs is handled (i.e. using alternatives) do not work properly.

commit 4a4256b8075c69aa6da4b0139e0e3cc2a1291762
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Aug 19 14:25:49 2014 +0200

    tests: make the scratch disk used for scratch much larger
    
    50M can be not enough when uploading various copies of unstripped
    static binaries from the system, which can fill up such a small disk.

commit 6b2bf2c7ace9a1e619fe33b13c06fad49e0731a3
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Aug 19 14:22:07 2014 +0200

    builder: do not use xz --block-size for the test images
    
    Do not use the --block-size parameter of xz when compressing the test
    images, as that option does not exist in xz < 5.1.

commit 0fd95e2b9fb9e49cf455b30cd4b85b7d7c354988
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 19 12:11:06 2014 +0100

    drives: Add comments about fragile string handling.
    
    GC FTW.

commit b53286a6432b8b381769cd8e8a0c235ce13d58cf
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Aug 18 14:56:08 2014 +0200

    drives: fix deletion of servers on error
    
    Make sure to not skip any of the created server, and to always free
    the "server" array.

commit 06aa1bff0f865fda7d64411977bca992d97fa748
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Aug 18 11:18:23 2014 +0200

    daemon: zfile: call pclose instead of fclose
    
    fp was opened with popen, so close it properly.

commit 54887a3eeabb52e27a3a1a571cfd40a351223030
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 15 20:02:50 2014 +0100

    v2v: Update instructions for uploading a volume.
    
    The previous instructions didn't include the need to change
    <disk type='file' ...> to  <disk type='volume' ...>

commit 1866fc47a2561ca23997ab742cdb96b6f55400a6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 15 19:58:10 2014 +0100

    v2v: Add some more man pages that may be relevant to "SEE ALSO" section.

commit c5b0e59dcc29c749999c056cb2747f58b07deba7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 15 19:57:52 2014 +0100

    v2v: Fix formatting of --vmtype option in the man page.

commit 0327036b2ff1e10538424ceb8e4d10f2121d753e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 15 19:51:09 2014 +0100

    v2v: Fix typo in manual page.
    
    This fixes commit 7c7caae7c1872c317712c373217362172a46abd6.

commit 25b33344b970c73c2dfaff44bcd410407e1e783e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 15 19:50:43 2014 +0100

    v2v: Make -i local be an alias for -i disk.
    
    Analogous to -o local.

commit 7c7caae7c1872c317712c373217362172a46abd6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 15 18:07:02 2014 +0100

    v2v: Add new -i disk to allow direct import of disk images with no metadata.
    
    This is simpler to use and more convenient than -i libvirtxml, because
    users don't need to bother with writing libvirt XML.  However it is
    less expressive because many source capabilities such as memory and
    number of vCPUs cannot be specified this way.

commit eaadf5c130ae4b248e1b83825b2d9ea6f83bc8dd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 15 18:16:51 2014 +0100

    v2v: Rename -o (target) tests.
    
    No functional change.

commit cca6f25de9d022b0408677a87fa32360b4312b47
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 15 16:39:14 2014 +0100

    Version 1.27.27.

commit a5e2485426b6d3afd953216afeeecb3950e66ecf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 15 16:38:48 2014 +0100

    website: Add virt-p2v(1) and guestfs-p2v-iso(1) to the website.

commit 787c42d6eb4ae350789752016e862490fcbd78e8
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Aug 15 12:49:00 2014 +0200

    tests/syslinux: add /usr/lib/syslinux/bios as directory for mbr.bin
    
    On Archlinux that is the location of mbr.bin.

commit df88e30ff1af1dd70a80e12991c5a40ffe611189
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Aug 15 12:48:59 2014 +0200

    appliance: add mtools to Archlinux' packagelist
    
    It is an optional dependency but syslinux uses it, so pull it always in
    the appliance.

commit 3243da393b2630997c4e10b39a5f6fa2585b7e10
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 15 14:37:04 2014 +0100

    v2v: Add a test of -o libvirt target.

commit e2fcc2304c160d20abfee1e5fe6c77f12979d2bf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 15 13:19:53 2014 +0100

    v2v: Add -o libvirt target (creates guest directly in libvirt).

commit 8ba605cad0700a7907ec6ba98a6740c071e74b43
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 15 14:35:14 2014 +0100

    v2v: Display message when intializing the target.
    
    As initializing the target (-o ...) is a distinct operation, which can
    fail if the user supplied the wrong command line arguments, make sure
    we display an explicit message before we perform this step.
    
    It prints something like this:
    
      [   5.0] Initializing the target -o libvirt -os default

commit e95a1c75d8a5bb2ef230cd9f13bbe979e2a7457a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 15 10:08:29 2014 +0100

    v2v: Move libvirt XML generation into common module, and use DOM module.
    
    Since `-o local' and `-o libvirt' both need to generate libvirt XML
    they should share the same code to generate it.
    
    Also generate it using the DOM module instead of printing the XML
    directly.  This is cleaner and avoids quoting issues.
    
    No functional change here.

commit 7ab495b458c2a93335266de2a24bc827785d18ca
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 15 10:07:27 2014 +0100

    v2v: When outputting XML, write "<element/>" for nodes with no children.

commit 5e872dbd2e50222c68aa7c10e88709a5c7a0687f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 15 08:51:59 2014 +0100

    v2v: Pass acpi, apic, pae features through to libvirt XML output.
    
    Notes:
    
     - Drop the acpi feature for RHEL 3.  Old virt-v2v says there is
       a problem presenting ACPI to RHEL 3 guests although it is not
       specific about what this is.
    
     - Old virt-v2v does not pass features through to OVF at all.

commit 991c4e36dd52fccc1883a3b7a8aca071f9d20901
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 14 17:32:27 2014 +0100

    p2v: Find ACPI, APIC and PAE flags and add them to target libvirt XML.

commit 9fa9d39d71af63fe96a95ea5668c14b73555c348
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 14 17:34:39 2014 +0100

    utils: Add new CLEANUP_PCLOSE cleanup.  It calls pclose(3).

commit 93c7842367fc5c99147b0ff4ab64dc52a476c7b8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 14 16:58:22 2014 +0100

    p2v: Rewrite /proc/cmdline reading code to use getline.

commit 483b4b7bbdedbd59884865d3221b2d0dca02a687
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 14 17:35:14 2014 +0100

    v2v: Update TODO.

commit ddfe82e823ff1112e4f75436ece439adc34b2ac9
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Aug 14 19:06:20 2014 +0200

    configure: look for "java-default-runtime" as directory for Java
    
    This seems to be the new way [1] in Archlinux to specify, as symlink,
    the default version of Java.
    
    Thanks to Peter Wu for the notice about it.
    
    [1] https://wiki.archlinux.org/index.php/Java

commit 1d9388b80066529f58b873bc601eab92ebd3c8a6
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Aug 14 16:46:12 2014 +0200

    configure: add java-8-openjdk and java-7-openjdk as locations for java
    
    This helps some distros (e.g. Archlinux) where openjdk is installed in
    java-MAJOR-openjdk directories, without any "default version" symlink.

commit 9609521734c661ec70c34a68f6201a2601190fa6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 14 15:16:06 2014 +0100

    launch: direct: Only issue Debian /dev/kvm group warning if /dev/kvm wasn't openable (RHBZ#1130189).
    
    This warning was meant for the case where /dev/kvm is inaccessible and
    the user must add themselves to a special group.
    
    However we didn't take into account whether /dev/kvm was openable in
    this test.  If it's openable, no point issuing the warning.
    
    Move the is_openable ("/dev/kvm") test earlier, and don't issue the
    warning if that was successful.

commit c21176386080029d285ffdf672e293c62e986640
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Aug 14 14:00:35 2014 +0200

    appliance: add libc-bin to Debian's packagelist
    
    It provides libc binaries like ldconfig and its configuration.

commit d9a4c481c940e0c83b8133ce21225c3820a40c28
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Aug 14 13:46:18 2014 +0200

    appliance: update distros in comments
    
    Update the list of recognized names of distributions in the comments.
    
    No functional changes.

commit 6f045f8401a856d748ebbde08bd5efc0857721f8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 14 10:02:33 2014 +0100

    v2v: Skip virt-v2v tests if rhsrvany.exe is not installed.

commit 6ae0e9641bdf516c3e14d004ffb7bd5127fd5d9d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 13 22:10:22 2014 +0100

    Version 1.27.26.

commit 8a23c1d79e878599a17c70bfc0737159acd5b61d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 13 22:18:44 2014 +0100

    lib: Missing include of <locale.h>.
    
    Required by setlocale.  For some reason you only see the error
    when compiling with -O0.

commit d1e56118dd68b624af3f25c2612687521b431842
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 13 10:46:27 2014 +0100

    Add a separate TODO file for virt-v2v and virt-p2v.

commit ef10da8b3a62e3bf0df649f1e725e5150135b003
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 13 12:17:57 2014 +0100

    v2v: Add tests.
    
    The virt-v2v tests here are not meant to be thorough tests of guest
    conversion.  There is a test suite used to test conversion which is
    kept outside libguestfs because it contains lots of proprietary
    unredistributable guests like Windows.
    
    The tests here instead are testing:
    
    - virt-v2v command line arguments
    - virt-v2v reads and writes files to the correct places
    - valgrind & memory leaks
    - any conversion properties that can be tested using just the
      phony guests (but we don't go out of our way here)
    - that up to date guests don't crash virt-v2v

commit 7beb9f2cb5dcc2c88dc548d1de9acb03852388b7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 13 16:50:51 2014 +0100

    tests/guests: Add Windows/Drivers directory to phony Windows guest.
    
    Allows virt-v2v to complete.

commit 5b6a2e68b8ef8c05577379e19ab0bbf3f66ca216
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 13 13:07:28 2014 +0100

    tests/guests: Fix RPM database in phony Fedora guest.
    
    Fix the Name and Packages database so it looks enough like a modern
    RPM database to fool inspection.  I'm not sure whether or not the old
    version ever worked, but it doesn't work now.
    
    The format is not documented, but in brief:
    
    The Name database contains (Name, link) pairs.  The link is an
    arbitrary 32 bit integer.
    
    The Packages database contains (link, RPM-blob) pairs.
    
    The RPM-blob is a binary blob formatted like this:
    
     * Number of fields               4 bytes, big endian
     * Size in bytes of the store     4 bytes, big endian
     * Field descriptions:
         list of (RPMTAG, 0, offset in store, 0)
                                      4 * 4 * nr_fields bytes, big endian
     * The store                      binary data containing ASCIIZ strings
    
    For the values of RPMTAG_* that we understand, see src/inspect-apps.c.

commit f0b71818a6bfb3a9a4c40f26604ee1e7dec67926
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 13 12:37:48 2014 +0100

    v2v: Add fedora to "RHEL family".
    
    The calling code allows Fedora guests to be used when calling
    Convert_linux.  However Convert_linux itself would fail with an
    assertion error when you did this.

commit b743fe2c3ea27ad82eba04256242df7960bfd051
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 13 12:33:41 2014 +0100

    tests/guests: Define the disk format of our test guests in the test XML.

commit 89417216b9a151829ecf108630af1195e5fe0b9f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 13 12:34:12 2014 +0100

    v2v: Fix libvirt source to parse the format of a disk properly.
    
    Missing '@' means it wasn't looking for the attribute.

commit cec3b42ad6f72195f4ffae80757b34e046bbc2f6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 12 21:53:57 2014 +0100

    v2v: Add --no-copy option.
    
    This option allows callers to generate the metadata without copying
    the disks.

commit bfcda1ba6a21906d2f82c19cf43bcd475bb4f5d8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 12 17:44:51 2014 +0100

    v2v: Nothing uses ov_target_file_tmp, remove this.
    
    Previous virt-v2v would write to a temporary destination file then
    atomically rename everything at the end.
    
    However this appears to be unnecessary since we write the OVF file
    after copying the disks, so (I assume) RHEV-M won't see the disks
    before then.
    
    In any case nothing used ov_target_file_tmp so we can remove this
    feature to simplify the code.

commit 295086e93491db2edb0c4f6d4364118f5f0267dc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 12 16:35:05 2014 +0100

    v2v: Allow RHEV UUIDs to be specified on the command line.
    
    Currently various UUIDs used by `-o rhev' are generated randomly.
    This means they are different on every run of the program.
    
    Allow some of them to be specified on the command line.  (If not
    specified they are still generated randomly).
    
    This allows RHEV-M to run virt-v2v several times (eg to examine the
    OVF output) while having paths to files and OVF be stable across runs.

commit ba63916960d8ddb318b1a15872d2f142e0e719b6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 12 15:26:38 2014 +0100

    v2v: Combine miscellaneous RHEV command line options into a single structure.
    
    At the moment there is just one "miscellaneous RHEV command line
    option" (--vmtype), but we may add more in future.  Put them in a
    single struct for convenience.
    
    This is just code motion.

commit 83c314d5c016ce055a8500a9f8f9d8aa694349bd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 12 15:06:21 2014 +0100

    v2v: -o rhev: Fix error message.

commit 3f53dc46803edd40ff42db11024c5764b914508a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 12 15:04:15 2014 +0100

    v2v: `-o ovirt' is an alias for `-o rhev', document it.

commit 0a816c020c00e1b44dba3c4809eca91f70422a13
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 13 14:38:34 2014 +0100

    v2v: Don't disable trace/debug set by environment variables.
    
    If the environment variables LIBGUESTFS_TRACE=1 or LIBGUESTFS_DEBUG=1
    were set, then the current code would end up disabling trace/debug if
    the command line arguments did not contain -x/-v.
    
    Fix this so the effect of enabling trace/debug is cumulative.

commit 5d89c0fd14448f4a907b5fd7fb80afcf62562b80
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 12 15:00:23 2014 +0100

    p2v: Clean up and fix the code for excluding the root device.

commit 67da00d540fbb8c463e9496864b243d780340d9a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 12 12:40:58 2014 +0100

    p2v: Call the remote libvirt XML file 'guest.xml'.
    
    Previously it was called 'libvirt.conf' which is more than a little
    bit confusing.
    
    This is only an internal name, so there is no visible change in
    functionality.

commit 40fbd447ee2393d43549722f240fe356de31f210
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Aug 13 16:43:19 2014 +0200

    build: manually drop flex-/bison-generated files from dist
    
    It seems that Automake cannot handle properly the files generated by
    flex and bison, leaving them in the dist tarball.
    
    For now, add a dist-hook to manually prune them from distdir.

commit 577ec51a4ca6b1a7c331a0e3da31295d578a5303
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Aug 13 15:16:17 2014 +0200

    fish: add test-invalid-params.sh to EXTRA_DIST
    
    Followup of commit 7912759fc331f6e8a0f7c87731f6bfe8c6e96c1f.

commit 6a51ae503c372b2548c91639e8c23c8bbeac3c44
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 13 13:50:36 2014 +0100

    builder: Missing include of <locale.h>.
    
    Required by setlocale.  For some reason you only see the error
    when compiling with -O0.

commit 34feb37879ea3d3a9adbb5de5baa62882f7c6a9d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 13 13:07:07 2014 +0100

    lib: Typo in comment.

commit 841b20c39cfd53bd7097d2e3f81fd36f8135cc75
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Aug 12 10:16:18 2014 +0200

    python: fix possible free on uninit memory with OStringList optargs
    
    When using optional arguments of type OStringList, the code free'ing
    the member in the optargs_s struct corresponding to that optional
    argument would just check for a non-PyNone PyObject for that argument.
    If before that optional argument there are other arguments which can
    cause an earlier error return from that binding function, the free'ing
    code will then act on garbage values.
    
    Enhance the check by also checking whether the optargs struct has the
    bitmask with the element for that argument, meaning that the
    corresponding struct member was initialized.

commit abbbc832d50dafd2872d0f5fee94e62faa978e82
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Aug 11 15:15:16 2014 +0200

    p2v: check results of strndup and sscanf

commit bbae6136abe6432648be94decedc6c96cbe63328
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 11 14:51:37 2014 +0100

    p2v: Move libutils before libxml2 in the list of libraries (RHBZ#1102447).
    
    The error is:
    
    ../src/.libs/libutils.a(
    libutils_la-cleanup.o): In function `guestfs___cleanup_xmlBufferFree':
    cleanup.c:(.text+0x79): undefined reference to `xmlBufferFree'
    ../src/.libs/libutils.a(libutils_la-cleanup.o): In function
    `guestfs___cleanup_xmlFreeDoc':
    cleanup.c:(.text+0x99): undefined reference to `xmlFreeDoc'
    [etc.]
    
    Thanks: Arnaud Gaboury

commit a26a9e68819dab5f9c8eed821d8a686fffabbc5b
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Aug 8 17:13:02 2014 +0200

    df: unlock retire_mutex on early exit
    
    If pthread_cond_wait fails and the thread worker ends, make sure to
    unlock retire_mutex, which has been locked for the condition.
    
    The return value of pthread_mutex_unlock is ignored, as there's nothing
    that can be done with it at that point.

commit bb124552155667c082c075cb09267b12a7a567c1
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Aug 8 15:35:02 2014 +0200

    daemon: use CLEANUP_CLOSE

commit 4249ddd8bbd0d38f7e63890b999c6199b54af5b3
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Aug 8 15:34:07 2014 +0200

    daemon: add CLEANUP_CLOSE
    
    Just call close on the specified fd, if valid.

commit ad4ba5997be030ee4b67614d9e6004107482bbc3
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Aug 8 14:58:08 2014 +0200

    daemon: blkid: fix memory issues in "no -p/-i" mode
    
    Fix the memory issues in the implementation that uses no -p nor -i:
    - use add_string_nodup to add results from get_blkid_tag (which returns
      new strings), so those strings are not leaked
    - use free_stringslen to clean the hash on error, as in such case the
      stringbuf will not be terminated with a null entry, thus causing
      free_strings to crash

commit fef0881b3a31adebf66e0374fed3eb41f9d1471d
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Aug 8 14:56:27 2014 +0200

    tests: c-api: do not crash w/ missing hash entry
    
    If an hash does not have the requested key, just error out cleanly
    instead of crashing when trying to compare a null string.

commit 8d23fb31f11019b7b8c4834166748143cec84c0c
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Aug 8 13:49:59 2014 +0200

    daemon: initialize memory when handling DeviceList params
    
    When dealing with DeviceList parameters, the generator produces code
    similar to the following:
    
      CLEANUP_FREE_STRING_LIST char **devices = NULL;
      [...]
      devices = malloc (sizeof (char *) * (args.devices.devices_len+1));
      {
        size_t i;
        for (i = 0; i < args.devices.devices_len; ++i)
          RESOLVE_DEVICE (args.devices.devices_val[i], devices[i],
                          , goto done);
        devices[i] = NULL;
      }
    
    The block hidden within the RESOLVE_DEVICE macro is supposed to
    assign something to devices[i]; on the other hand, the code in
    RESOLVE_DEVICE can cause to just end (with an error) the current RPC,
    which would cause the cleanup of the "devices" array... whose members
    from the i-th to the (args.devices.devices_len-1)-th would be garbage
    pointers, causing random memory to be free'd (and thus crashing the
    daemon).
    
    Avoid the access to garbage memory just by having a cleaned "devices"
    array, so there will be always a NULL element after the initialized
    members.
    
    Add a test for vgcreate which passes a wrong device path causing the
    situation above, to test that vgcreate would fail gracefully.

commit d1f580550b32e8552ee64f12872b0fa10147957f
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Aug 8 10:23:37 2014 +0200

    rescue: fix sscanf placeholders for --smp and --memsize
    
    Use %d to parse them as int (since the variables for them as int)
    instead of %u, even if they both need to be at least > 0; the library
    will check for the validity of them anyway.

commit 7912759fc331f6e8a0f7c87731f6bfe8c6e96c1f
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Aug 8 10:15:32 2014 +0200

    src: always check value passed to set_memsize
    
    Move the minimum memory check from the environment parsing to
    set_memsize, so the limit is actually enforced also when using the API.
    
    Adapt the rhbz557655.sh test to the invalid memsize values being
    rejected now, and add a new test for checking invalid parameters
    explicitly.

commit 5fddd932054b1e4213807c545f85f5c0b3d698f7
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Aug 7 19:26:46 2014 +0200

    lua: always return luaL_error in actions
    
    Even if luaL_error is a "no return" function for the Lua runtime, adopt
    also in action functions the "return" idiom recommeded for it.
    
    This also helps code analyzers in not thinking that "g" might still be
    null after the null check followed by luaL_error.

commit 5ce123400745469a8dc3a931547c581d69b3bd8e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 7 12:25:13 2014 +0100

    aarch64: Add common function for getting the CPU model.
    
    And force a 64 bit CPU model when running on aarch64 with TCG.

commit f5c74637e36b6c8eb1281f93f7fe26f9016e405c
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Aug 7 10:45:04 2014 +0200

    daemon: add and use a reply_with_unavailable_feature macro
    
    Handy macro to reply the right way for an unavailable feature.
    While generally used so far in generated code, it can shorten that a
    bit, and avoid copy&paste when wanting to do manual feature checking.

commit 59584e1814205f62e36692ad3df26adcaeddcfc8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 5 18:06:22 2014 +0100

    Version 1.27.25.

commit 40cecb4b9cb4354902149f68918fe1d24a534c41
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 4 17:20:41 2014 +0100

    v2v: Add RHEV target.
    
    Use:
    
      virt-v2v [..] -o rhev -os nfs:/export
    
    or:
    
      virt-v2v [..] -o rhev -os /mountpoint
    
    to write to a RHEV-M / oVirt Export Storage Domain.

commit 95c3b78f081c2d861fb1517ccfd6b5eb1e1be224
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 4 22:20:56 2014 +0100

    v2v: Keep more inspection data in the inspect struct.
    
    Just code motion, no functional change.

commit e82c0c5e55c727e7ad416ad5cf103b056bd157c2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 4 16:24:42 2014 +0100

    v2v: Fix bytecode build.

commit b6cb67d958f5f9ac96b885c8e792beca2d6cac18
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 4 14:51:30 2014 +0100

    ./run: chcon the tmp directory in the builddir.
    
    Not just some random tmp directory which happens to be in the
    local directory.

commit e1c508c29f929134bfcb0f83b402a02e8ff94caa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 25 14:03:54 2014 +0100

    launch: Close file descriptors after fork (RHBZ#1123007).
    
    This refactors existing code to close file descriptors in the recovery
    process, and also adds code to close file descriptors between the
    fork() and exec() of QEMU or User-Mode Linux.
    
    The reason is to avoid leaking main process file descriptors where the
    main process (or other libraries in the main process) are not setting
    O_CLOEXEC at all or not setting it atomically.  Python is a particular
    culprit.
    
    See also this OpenStack Nova bug report:
    https://bugs.launchpad.net/nova/+bug/1313477
    
    Thanks: Qin Zhao for identifying and characterizing the problem in Nova.
    
    This is version 2 of this commit.  This commit is identical to the
    reverted commit 115fcc34325f965ac3723683e4462fc667dcd254 except that
    we don't close stderr.

commit e0ba7855f48284efa27efcae1fa69fb5f3354cf9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jul 27 11:18:55 2014 +0100

    html: Don't build HTMLFILES for disabled features.

commit 286f116691c8aad4ac8bf0d044e9f6ca8d5b3356
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 29 22:20:37 2014 +0100

    Revert "launch: Close file descriptors after fork (RHBZ#1123007)."
    
    This attempted fix for RHBZ#1123007 causes the qemu command line to be
    lost when verbose mode is enabled.  Since this is essential for
    debugging many problems, I am reverting the patch.
    
    This reverts commit 115fcc34325f965ac3723683e4462fc667dcd254.

commit 1d596eb7e68623beece1b5ad6d0c3eb94eb0b6ce
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 29 20:27:53 2014 +0100

    tests: qemu-speed-test: Allow test time to be adjusted with -t option.
    
    This is useful when analysing with `perf' since it allows us to
    increase the amount of time in the test versus the amount of time
    spent starting the appliance.

commit 1c7da06327701a5fba92fd1aac19606da70c6fd5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 29 11:51:13 2014 +0100

    tests: qemu-speed-test: Allow tests to be run selectively.

commit f342cfc69df2e55b2c0e79595d2a085396475af0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 29 11:50:41 2014 +0100

    tests: qemu-boot: Error if extra command line arguments are given.

commit 043cf4fbe30894af481c242095ed4cd436e136ea
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Jul 28 19:29:14 2014 +0200

    launch: direct: check for null paths in make_uri
    
    Some protocols may pass a null path to make_uri, so make sure to handle
    that gracefully.

commit 8ea6b3e03c8cccdd18a7910e9e5da75ee1e27807
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Jul 28 17:27:30 2014 +0200

    make-fs: do not leak the fd from mkstemp

commit 2fe93bda9f8744553da19882043f11da5348dc35
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Jul 28 17:24:02 2014 +0200

    make-fs: respect libguestfs' temporary dir
    
    Do not hardcode /tmp.

commit 50e3ef3357fe97028e958268eac7d63ec4e64408
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 26 21:37:59 2014 +0100

    Version 1.27.24.

commit 1b925a0efb9be0020002a9796164209ad6f4d9d2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 26 21:27:16 2014 +0100

    build: Add `maintainer-commit' rule to create a new version commit.

commit 08bfd9e41b08aed72fa2de1df71e166b8204c958
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Jul 25 17:36:17 2014 +0200

    p2v: close the mexp handle if mexp_spawnv fails

commit 9c3ce6535c34da761148204d5efe014598b1c0a1
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Jul 25 17:36:16 2014 +0200

    make-fs: use CLEANUP_FCLOSE

commit 9e7f5300c93c77f899d2bf543858e94608e6286f
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Jul 25 17:36:15 2014 +0200

    cleanups: add CLEANUP_FCLOSE (fclose on FILE*)

commit d8b9ce65c281cf9cd9ecea8229c83fad3cb64a9b
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Jul 25 17:36:14 2014 +0200

    p2v: properly call va_end

commit 7378edb9faf22f1a5a7b9e9f74621509da0e223a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 25 17:12:19 2014 +0100

    Add qemu-speed-test program to test speed of qemu.
    
    Currently it tests the upload and download speed of virtio-serial and
    the read and write speed of the block device (eg. virtio-scsi).

commit 115fcc34325f965ac3723683e4462fc667dcd254
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 25 14:03:54 2014 +0100

    launch: Close file descriptors after fork (RHBZ#1123007).
    
    This refactors existing code to close file descriptors in the recovery
    process, and also adds code to close file descriptors between the
    fork() and exec() of QEMU or User-Mode Linux.
    
    The reason is to avoid leaking main process file descriptors where the
    main process (or other libraries in the main process) are not setting
    O_CLOEXEC at all or not setting it atomically.  Python is a particular
    culprit.
    
    See also this OpenStack Nova bug report:
    https://bugs.launchpad.net/nova/+bug/1313477
    
    Thanks: Qin Zhao for identifying and characterizing the problem in Nova.

commit f18464995f63095d32431202fa2bedc5b60d7a88
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 25 16:06:46 2014 +0100

    tests: builder: Allow test to be skipped.

commit 81cafdcfd5932c0adddf22a06b3a770063526133
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 25 16:04:18 2014 +0100

    virt-resize: Unmount filesystem after testing size.
    
    We were mounting different filesystems on top of each other.  In fact
    this is not a problem, but it's nicer to unmount each filesystem
    properly after examining it.

commit fc7da04ccd2871a64447dff531ca332decb4bc0d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 25 16:03:09 2014 +0100

    daemon: Add extra debugging to umount_all command.
    
    No functional change, just prints some more debug messages.

commit 146cc78b7d1a5482db95e65e426138d8a9eff872
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 25 15:26:26 2014 +0100

    aarch64: Use a smaller test file for test-cancellation-upload-daemoncancels.sh
    
    This test worked by uploading a 100MB file into a 100MB container and
    seeing the inevitable crash.  Unfortunately virtio-mmio (used on
    aarch64) is quite slow.  Since this test is not testing the speed of
    virtio-mmio, use a smaller test file so the test finishes in a
    reasonable time.

commit d268de93949c2954fda8f0a1387b740903893481
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 25 14:42:38 2014 +0100

    tests: hotplug: Allow tests to be skipped.
    
    They don't work on aarch64.

commit 64498034bbc7bce2692597fb8bfbb721e8180543
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 25 10:04:44 2014 +0100

    tests: lvm: Allow test to be skipped.

commit 7f826e1296c85be7f4418830c8b5c992a80e9747
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 23 17:40:16 2014 +0100

    Version 1.27.23.

commit d682dad1864ef3b3353f1521098466459df97ca3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 23 13:08:49 2014 +0100

    aarch64: Add comment about efi-rtc=noprobe option.
    
    This updates commit 5326689d50cc82e9108c83511e666be6d081d9dd.

commit bcdbe6405c10ecb7374ae47eee6385be17dbd49e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 8 16:33:45 2014 +0100

    v2v: Add support for converting Windows guests.
    
    This completes commit f296d34f3b30c82309b22b54bf5a2c133992bd93.

commit f4698575cced4c45136635daa31821e6d55e7c77
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 8 21:31:06 2014 +0100

    customize: Add the ability to use --firstboot for Windows guests.
    
    This allows you to add potentially multiple --firstboot
    scripts to a Windows guest.

commit 199fa269508ac9ae2de32927e04996834af149d4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 8 21:41:58 2014 +0100

    mllib: Add regedit mini-library.
    
    This library replaces Win::Hivex::Regedit, or at least enough for us
    to be able to make the simple Registry modifications needed for
    installing firstboot scripts.

commit 9c49590d42642940acf5de06d978ba1e2d71e8d1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 8 20:57:59 2014 +0100

    customize: firstboot: Move Linux-specific functions into Linux submodule.
    
    No functional change.

commit 12b54ef5e3aecd55d228a96dfb0a9ab5c8acdf4a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 23 15:01:44 2014 +0100

    sparsify: Relax requirement that output device cannot be block device (RHBZ#1122557).
    
    To fix RHBZ#1056290, I prevented virt-sparsify being used if the
    output device is a block device.
    
    I have now retested this scenario and it does work (in both copying
    and in-place mode), and does not delete the output device, and
    therefore we can relax this restriction so only char devices are
    banned.
    
    This is useful for oVirt which uses a qcow2 formatted block device to
    store virtual machines.

commit 897b136aa8012bba26e61e0eb0851a6a4b0cdf5a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 22 19:10:04 2014 +0100

    Update translations from Transifex.

commit e7ae071f60846e0d91a1a1728b5614df912815f6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 21 14:36:43 2014 +0100

    Version 1.27.22.

commit 5326689d50cc82e9108c83511e666be6d081d9dd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 18 15:05:55 2014 +0000

    aarch64: efi-rtc=noprobe is needed to fix boot of upstream kernel on VM.

commit f4026d779e9736b5446f80d5b4d68eaa13fd07bd
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Jul 17 16:24:52 2014 +0200

    configure: look for "default-java" as directory for Java
    
    In Debian-based systems, /usr/lib/jvm/default-java is a symlink
    pointing to the location of the default Java version.

commit de5924a2294a6aeb09e4b41b55f06d2f3ea5e0ec
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 17 20:32:24 2014 +0000

    tests: Add test program to run qemu/appliance repeatedly.
    
    For example:
    
      $ time ./run ./tests/qemu/qemu-boot -n 100
      real 1m19.794s
      user 0m10.001s
      sys  0m5.928s
    
    will run 100 appliance start/stops, from multiple threads.

commit 83790960d63b78b1c2264777a4d87559d11f3b12
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 17 11:38:20 2014 +0100

    valgrind: Tweak the suppression matching OCaml leak in caml_search_in_path.
    
    In OCaml 4.02 this still leaks, but the stack trace is slightly
    different so the old suppression didn't match it.

commit 333ddf208b878441e3ef3ea6b65726f758310315
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 17 09:58:07 2014 +0100

    tests: Add a protocol regression test for long error messages.

commit 4106c97934ec5461ae854939185bfa574374bca2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 17 09:57:42 2014 +0100

    daemon: Truncate long error messages so XDR encoding doesn't fail.

commit 4d3953f09217e15212d18f53e1cf040d54156f72
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 16 22:05:39 2014 +0100

    Warn about large stack frames, and fix a few places with excessive stack usage.

commit 00c94d808b0abc825c379ea1f0f2d44827ad120a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 17 09:43:45 2014 +0100

    tests: Remove tests/protocol/test-qemudie-launchfail.sh
    
    This test has not been run since 2012 as it depends on specifics of
    how supermin and new-style appliances work (see
    commit 2d89aef897e633bffba1dffd600b122eacd88fc8).
    
    This commit removes the test entirely.

commit fa3d6e55b2e3a2be811038914ece3c5bdf57c4a2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 16 12:39:26 2014 +0000

    tests: qemu: Fix TCG test.
    
    $guestfish was not defined, so the UML test/skip did not do anything.

commit 9cdaaeee40384af47bb581c83407efac39090cb1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 15 18:22:05 2014 +0000

    tests: regressions: Allow non-exec stack test to be skipped.
    
    Currently fails on aarch64 because of a buggy GCC.

commit 9e01541e4814a81a1911d83d07f61aa8b4139ca2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 15 17:56:57 2014 +0000

    tests: 9p: aarch64 also uses virtio-mmio (instead of virtio-pci).

commit 2d01e06fc9983a3981062d96252dc6b4e3a5f326
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 15 17:55:18 2014 +0000

    tests: regressions: Skip test on aarch64 which also does not support IDE.

commit fe9d3f7a903741311cfd0ef0b82607be8ab923df
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 15 16:41:18 2014 +0000

    ocaml: Ignore Warning 3: deprecated feature: String.* functions.
    
    In OCaml 4.02, the 'string' type can be made immutable.  All String.*
    functions that are concerned with creating or mutating strings now
    give a warning like this:
    
      Warning 3: deprecated feature: String.unsafe_set
    
    Disable this warning since we don't want to turn on immutable strings
    yet.

commit d71ec218eaffe0caf07b44e349383ef1d9398feb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 12 14:50:15 2014 +0000

    aarch64: Add some earlyprintk debugging.

commit 57c7417f89b2e39f625e9b3276a5ef470fcd5b6a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 12 14:49:23 2014 +0000

    aarch64: Use console=ttyAMA0 instead of console=ttyS0.
    
    This still only prints early console messages.  Output stops
    after:
    
      bootconsole [earlycon0] disabled
    
    but I have not found any way to get later kernel messages.

commit 9d8ede1ae4b8b926a00c16d0f6ba52d8a6defbd7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 10 17:32:39 2014 +0100

    sysprep: Standard exception handling, taken from virt-builder & virt-v2v.

commit f913ca5ebcaacbd94a31ed8fac935833447cc0a7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 8 20:51:22 2014 +0100

    customize: Use Common_utils.error function instead of failwith.
    
    This is just code refactoring.

commit 82cf3c9d68237a3294f6e83f2b38de4f1414ca7f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 8 20:52:17 2014 +0100

    customize: Update copyright messages.
    
    No functional change.

commit f955fec7601309ca3b33080cb6d49ea916be452e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 8 23:01:05 2014 +0100

    docs: Remove useless "SHELL QUOTING" section from manual pages.

commit 9b47a53a4b5c34095efb297b12867b42752786d4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 11 10:21:39 2014 +0100

    sparsify: Add --tmp prebuilt:file option.
    
    This option allows oVirt to pass a prebuilt qcow2 file to use as the
    temporary overlay.  The file must be qcow2, and must have indisk as a
    backing file - the code does minimal checks to ensure this is correct.
    
    Example usage:
    
      qemu-img create -f qcow2 -b indisk overlay.qcow2
      virt-sparsify indisk --tmp prebuilt:overlay.qcow2 outdisk
    
    Note this only applies in copying mode.

commit 66aa98265dd215dcd4c717e7ef6845fbac859e54
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jul 15 11:06:32 2014 +0200

    appliance: init: run ldconfig
    
    Run ldconfig early in the init script, so libraries outside standard
    library paths but with a proper ld.so configuration file pointing at
    them can be found.

commit a791e081638025b64d1229d23d1181d96cc2a607
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 11 10:38:53 2014 +0100

    RHEL 6: p2v: Add fix for older PCRE.
    
    RHEL 6 pcre did not define PCRE_PARTIAL_SOFT.  However PCRE_PARTIAL is
    a synonym so use that.

commit 17bf3ce21cb28840987caaa79babd006458ad2d2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 8 13:55:31 2014 +0100

    Version 1.27.21.

commit f296d34f3b30c82309b22b54bf5a2c133992bd93
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 30 18:00:01 2014 +0100

    v2v: Add partial support for converting Windows guests.
    
    This is not yet complete.

commit 2ee1fb6472dfcde9cb649a5c2eb4eaffa12f5e2a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 8 09:02:46 2014 +0100

    builder: CentOS 7.0

commit 71ac957d4aedf9560a6b0c75629fea16a32d20c3
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Jul 7 19:33:44 2014 +0200

    Use Mkdtemp.temp_dir instead of Mkdtemp.mkdtemp

commit c8f3e99302e65a0c10bc82df49789d159bf17e5c
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Jul 7 19:30:29 2014 +0200

    mllib: introduce Mkdtemp.temp_dir
    
    Add a simple function to ease the usage of Mkdtemp.mkdtemp.

commit 3fc6983b1666a32ea6c1b44d88f140e3c84e7201
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Jul 7 11:40:19 2014 +0200

    inspect: ignore /etc/fstab with no entries (RHBZ#1113156).
    
    Just like no /etc/fstab is not an error, having one with no entries
    shouldn't be an issue either.
    
    With systemd, this could be a valid setup, with mount points set its own
    way.

commit 3f2e18efdeb4697bf175aae46fb18d0183292445
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 4 15:48:36 2014 +0100

    valgrind: Add suppress for libvirt memory leak in virFileFindResourceFull.
    
    https://bugzilla.redhat.com/show_bug.cgi?id=1116427

commit 2fe74642f4b2971ea279374a72ddedde733f5e44
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 3 11:48:49 2014 +0100

    launch: direct: Use -cpu host when using KVM on x86.
    
    This is the same as what the libvirt backend does.

commit fc9647bb4d82d7209ee54c26711c178c2396329d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 2 23:09:22 2014 +0100

    mllib: Remove trailing whitespace.
    
    This fixes commit b24b0b17a8ab5854c020cb1172597d805b911c73.

commit bf47ed1b6ab94f54737b914e15e5a35a148c1b7c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 2 18:18:39 2014 +0100

    tests: qemu: Test force_tcg setting is effective.

commit 2369e9c2d660e1b9010b5c0afc599b769efd08b2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 2 16:24:59 2014 +0100

    log: Pass correct parameter to localtime_r on 32 bit platforms.
    
    We were passing an int64_t which happens to be the same as time_t, but
    only on 64 bit.  This didn't work on 32 bit (or rather, it works on
    little endian, but only by accident).
    
    This fixes commit fb546eaee064b14ad192a4f0390325ba1b4c766a.

commit a2747578ebfc92d19ca615d8fd462d9b826eafb5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 2 16:17:05 2014 +0100

    journal: Fix binding of sd_journal_get_realtime_usec on 32 bit machines.
    
    sd_journal_get_realtime_usec is defined as:
    
        int sd_journal_get_realtime_usec(sd_journal* j, uint64_t* usec);
    
    Unfortunately we passed size_t* as the second argument.  This happened
    to work on 64 bit machines because size_t is 64 bit there, but failed
    on 32 bit machines, where we didn't pass a sufficiently large result
    buffer.
    
    This fixes commit 2d996df66c8d67e11a91a89c074c91a233356494.

commit 1e1d7cf6af45d9334e9cf24f771c47159d9a4fca
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 2 14:24:14 2014 +0100

    excludefiles: Exclude various common log files when building the appliance.
    
    These log files can get pretty big, and that causes problems
    like this one:
    
    http://linuxforum.ru/viewtopic.php?id=35381
    
    and this one:
    
    https://bugzilla.redhat.com/show_bug.cgi?id=1099172
    
    In both cases the problem was /var/log/lastlog which is apparently a
    large sparse file.  Supermin cannot cope with sparseness, so it copies
    the whole file non-sparse.  But since this could affect other log
    files this commit covers various common log file names and patterns.
    
    Thanks: semperN

commit f40e11ace4f7c3799549c9f746408b9ab444efef
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 2 13:54:16 2014 +0100

    Version 1.27.20.

commit 5d48f7a7921d57bd12bc5ddc60127c551d39fbef
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 2 13:22:18 2014 +0100

    Update gnulib to latest version.

commit 144a86ac8c4935c1ef5fdedba10144873ac70920
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 1 12:01:28 2014 +0100

    v2v: Change fstrim message to warning.
    
    This also ensures it is flushed and translated.

commit dbe0b69f24421f258da2fb420b58fc1530a9cd03
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 30 16:24:03 2014 +0100

    v2v: Remap block device names in grub & /etc/fstab.
    
    eg. Change /dev/hda to /dev/vda

commit 120d61cf56f7ad76be32b454df5d628c4e7f5501
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 30 14:14:08 2014 +0100

    v2v: Kill kudzu dead.

commit 838dce6557991f695296b5859db939146e56e527
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 30 14:13:32 2014 +0100

    v2v: When converting Linux guests, rebuild the initrd.
    
    It probably needs to be rebuilt to add virtio drivers.

commit a32d92e4205a2d6766cd138671a1ec62fbe811f5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 30 14:12:26 2014 +0100

    v2v: When inspecting Linux guests, collect kernel version & location of initrd file too.

commit 5cf5c3f1c79d66238de5ebe6dae57b5ff93cbe21
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 30 14:08:43 2014 +0100

    v2v: Change source disk into a struct.
    
    Simple code refactoring, allowing us to collect the target/@dev
    attribute in this (now) structure.

commit 544b087d4b4ee92239d26211effe192da4f71d38
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 1 16:12:32 2014 +0100

    generator: Sort the structs.
    
    Sort the structs when generating code.  Since the structs are
    logically indepedent of each other, this should have no effect except
    to make generated files list the structs in a different order.
    
    However this also fixes the following build problem:
    
      File "convert_linux.ml", line 322, characters 43-50:
      Error: This expression has type G.stat = Guestfs.stat
        but an expression was expected of type G.dirent = Guestfs.dirent
    
    It turns out the OCaml bindings don't like the fact that we have
    two structs with a common field name (dirent.ino and stat.ino).
    
    In OCaml < 4.01, this means that any attempt to reference stat.ino
    would fail because dirent.ino appears second in the file, overriding
    stat.ino.
    
    Sorting the structs has the side effect of making stat.ino appear
    second, thus resolving the build failure above.
    
    In OCaml >= 4.01 the compiler now uses some disambiguation rules based
    on the known types to resolve this problem, so accessing either field
    would work no matter what order they are listed in.
    
    See:
    
    http://ocaml.org/releases/4.01.0.html
    http://www.lexifi.com/blog/type-based-selection-label-and-constructors
    http://www.lexifi.com/blog/ocaml-extensions-lexifi-overidding-record-labels-and-constructors

commit 16e817456cf7e5162ba053c92f1a4df24a4160d5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 23 15:17:02 2014 +0100

    v2v: Modify conversion step to first do proper inspection and data
    gathering about the guest.

commit b6b9b90dd74c7b9204bdf218aa9360e117308e78
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 24 16:49:28 2014 +0100

    Use -v and -x flags consistently across OCaml virt-* tools.
    
    virt-customize:
    virt-sparsify:
    virt-sysprep:
    virt-v2v:
      - These tools consistently used -v to mean verbose/debugging
        and -x to mean enable libguestfs tracing.
    
    virt-builder:
    virt-resize:
      - These two tools did not recognize -x at all, and used -v
        to enable libguestfs tracing and general debugging.
      - This commit changes these two tools to consume -v/-x
        consistently with the other tools.
    
    Unfortunately this has a cascade of effects through the code.

commit 5d3ec4474c955672c761ac11a178f29581985cd2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 24 16:18:36 2014 +0100

    mllib: Rewrite text wrapping function so it can handle newlines within the text.

commit 9aa0969d8d6f9d8d20b2e9912e8ad7128fcad50d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 24 12:24:04 2014 +0100

    virt-cat, virt-ls, virt-edit: Fix typo in documentation.
    
    This fixes the following:
     commit aad3c467fb47d3aa0720624c20561cd8eb34072b
     commit de5e7331afbb83ffac509e899851e791191922b3
     commit 86706907af1adea96820ec2c5aa4222fcc4065b0

commit e46bbb45d1ea7432a21b8e7b1b8b1dd2efa79c12
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 24 08:28:28 2014 +0100

    Version 1.27.19.

commit 77a963886fc803de8f776ad0ba8d30634ebb9a95
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 23 17:10:50 2014 +0100

    v2v: Refactor common code for listing files in packages.
    
    At some point we should make these into real libguestfs inspection
    APIs.  However they are fairly hard to implement, at least for RPM.

commit 7a68afed14ff9623f5c643e185ab49af6f1505c7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 23 15:27:37 2014 +0100

    v2v: Move app2_version comparison functions to utils.
    
    Refactoring.

commit 5b29d9a1a8b22006e8ecfc18a0c1fa545ccb5132
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 23 15:08:11 2014 +0100

    v2v: Create apps_map when doing inspection step.

commit 6705be2379aaf88bf3c8c25ab3ab7ac8fe2da716
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 23 15:02:51 2014 +0100

    v2v: Create a shared StringMap module.

commit 9975bf8eb3dd34a88544e49e736ff4e3825602e1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 23 14:15:28 2014 +0100

    v2v: Rename Convert_linux_enterprise -> Convert_linux.
    
    Just module rename.

commit 76bf3f7289c6d43e9b240299e37079bb03afc4f4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 23 14:12:42 2014 +0100

    v2v: Rename Convert_linux_common -> Lib_linux.
    
    Just library name refactor.

commit 6f73266363af412004b31ade1812be06a916c402
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 23 11:57:48 2014 +0100

    mllib: Add a common 'warning' utility function.
    
    This commit changes many places in OCaml utilities that print
    warnings to use the warning function instead.

commit b24b0b17a8ab5854c020cb1172597d805b911c73
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 23 11:49:10 2014 +0100

    mllib: Add an interface for Common_utils library.
    
    It turned out that Common_utils was exporting the 'G' module (an alias
    for Guestfs).  We want any code that uses G as a shortcut to declare:
    
      module G = Guestfs
    
    at the top, since that avoids confusion for newbie (or experienced)
    OCaml programmers.

commit 273f3464654ebb10de9d53e3c1f225e8f3aade6e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 20 13:34:54 2014 +0100

    v2v: Warn only if virtio packages are missing from the guest.
    
    In this version of virt-v2v you have to install a virtio
    capable kernel before doing the conversion.

commit 8ed27e7865e6ce0dd85697fe133fdf3bf486080b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 20 13:22:59 2014 +0100

    v2v: In convert function, add a hash of app name -> app structure.
    
    For quicker lookups than searching the linear list.

commit 7b89f657c46357eff87878638289f7d1b3258c1d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 19 15:32:29 2014 +0100

    mllib: Move common code for comparing version strings to library.

commit 90bf3422c5333b3bb295d6fc466d4cf429b8301e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 19 13:29:15 2014 +0100

    v2v: When parsing input libvirt XML, get correct disk image format.
    
    Old Xen PV guests had:
    
          <driver name='tap' type='aio'/>
    
    The previous xpath expression matched any driver type attribute in
    order to pick up the format.  However we only want to match:
    
          <driver name='qemu' type='raw'/>
    
    so we need to check the name attribute as well.

commit af31670d03b83df424cfa540cc6020cce1a8340d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 19 13:28:22 2014 +0100

    v2v: Avoid segfault if xpath expression doesn't match any nodes.
    
    I'm not sure if this indicates that the xpath expression is wrong, but
    in any case it can be that xpathobj->nodesetval is NULL.  In this
    case, return 0 from xpathobj_nr_nodes instead of segfaulting.

commit 877583a6f4e1a09abc24633d4e68198a2f7d6f59
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 19 12:13:43 2014 +0100

    v2v: In -o local mode, name disks <name>-sda instead of disk-sda.
    
    This allows us to use the same shared output directory for multiple
    parallel tests.

commit 8ad5698d0297a4c52515593a102d03c2a7dbe3c8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 18 14:37:34 2014 +0100

    v2v: Print \n after warnings.
    
    Using eprintf so this is not implicit (unlike 'error' function).

commit beef28fe9687c962ea095776288c6a90ffef92cf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 18 14:18:41 2014 +0100

    v2v: Dump out 'source' structure when debugging.

commit 2f616342150c4fed21a443df23625367cfec886e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 18 14:18:21 2014 +0100

    v2v: string_of_overlay already has trailing \n, don't need to add one.

commit 437e387c4d7f00892c01d7b149390b0e125e9805
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 18 14:17:48 2014 +0100

    v2v: Print qemu-img source overlay command when using -v.

commit c62dbb8afd5995e6221df48db0e4f058ebc56c40
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 18 14:08:14 2014 +0100

    run: Add v2v/ subdirectory to $PATH.

commit 27e1b6ca8b39eace5fb7162af4e4ba16c05d0b34
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 18 14:06:50 2014 +0100

    v2v: Allow relative paths to appear in -i libvirtxml input.
    
    When writing libvirt XML by hand, or for tests, this is
    immensely useful.

commit c3c659e996b18a8b7ccdf8e2df673bbaa99aa7a7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 23 21:38:33 2014 +0100

    rescue: Use guestfs_add_drive_scratch to implement the --scratch option.

commit bb3ba0c43a515ecb1444f7f3d97e6f30b3b9a610
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 23 21:26:23 2014 +0100

    options: Compile out part of union which cannot be used when not compiling guestfish.

commit 86706907af1adea96820ec2c5aa4222fcc4065b0
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Jun 23 15:56:15 2014 +0200

    edit: add -m option
    
    Implement the -m/--mount as available in guestfish to override the
    automatic introspection and specify which partitions to mount instead.

commit de5e7331afbb83ffac509e899851e791191922b3
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Jun 23 15:54:00 2014 +0200

    cat: add -m option
    
    Implement the -m/--mount as available in guestfish to override the
    automatic introspection and specify which partitions to mount instead.

commit aad3c467fb47d3aa0720624c20561cd8eb34072b
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Jun 23 12:54:33 2014 +0200

    ls: add -m option
    
    Implement the -m/--mount as available in guestfish to override the
    automatic introspection and specify which partitions to mount instead.

commit 54c77f99cc0dada27a3e13e22a6afd4a69a98576
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 20 11:06:23 2014 +0100

    builder: Update centos.sh to add CentOS 7 QA.

commit 8d6cbd05cae7420385709a5bbd0e79d35ef6df5d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 17 17:40:48 2014 +0100

    website: Install HTML version of the virt-log(1) man page on the website.

commit cd111bd0e3f4052e256b9e0b823b8af943aac9f5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 17 17:40:00 2014 +0100

    virt-v2v: Remove text from README, moved into test data repo.
    
    There is (will be) a new repository containing the large/proprietary
    test images.  Move the README related to this to the new repo.

commit e6a067e183cda42e1ab3596536ab850986c25516
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 16 12:49:02 2014 +0100

    Version 1.27.18.

commit 98a1392849da06c0579c2506a30e5c7d52a93b52
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 16 12:25:05 2014 +0100

    virt-log: Fix memory leak because of wrong type of CLEANUP_* function.
    
    This fixes commit a3475cf9bbbbd3514b117d5edd75d9c0e239d43a.

commit cd15b2ead6b25554ad6c13ee5c1463c06f0895b2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 16 10:53:59 2014 +0100

    Version 1.27.17.

commit c1dd8e80ba687a88a9ee84033f331df0bebc78e7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 16 10:50:58 2014 +0100

    tests/guests: Add new file debian-syslog to EXTRA_DIST.
    
    This fixes commit 026342a7ee20cd31d4de6c212e848791f7099d5e.

commit 0c38cd4d25eb32187341d3642be51053577d7ceb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 16 10:14:06 2014 +0100

    virt-log: Add support for displaying the Windows Event Log.
    
    Uses the external program python-evtx, and this only works
    for Windows >= Vista.

commit d167da86d922d1c9341848117f7ce140a92dd951
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 16 10:31:29 2014 +0100

    virt-log: do_log_journal: return instead of exiting immediately.
    
    This cleans up commit a3475cf9bbbbd3514b117d5edd75d9c0e239d43a.

commit fb546eaee064b14ad192a4f0390325ba1b4c766a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 14 10:50:36 2014 +0100

    New tool: virt-log: It lists log files from within the guest.
    
    See 'TODO' file for suggested future improvements.

commit 026342a7ee20cd31d4de6c212e848791f7099d5e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 14 11:52:01 2014 +0100

    tests: guests: Add a text syslog file to the phony Debian guest.

commit 2d996df66c8d67e11a91a89c074c91a233356494
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 14 13:27:02 2014 +0100

    New API: journal_get_realtime_usec
    
    This adds a binding for sd_journal_get_realtime_usec(3).

commit e5276e4455f74ca3ad76d93a6ca41a7175038c0f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 13 22:48:18 2014 +0100

    Version 1.27.16.

commit 31c07bc9d8128f838671a68884613a512282ea5a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 13 22:42:42 2014 +0100

    podwrapper: Put =encoding line before first POD directive.
    
    =head isn't always the first POD directive.
    
    This fixes commit 1148bd91ce2c0bebc65f9855368fd026aaf9f603.

commit 1148bd91ce2c0bebc65f9855368fd026aaf9f603
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 13 14:22:50 2014 +0100

    podwrapper: Put the =encoding line at the correct place in the input (RHBZ#1109174).
    
    Commit c4dc70f8c43a7faae2a8698027a4ed23d316dfa0 broke the man pages
    for the Perl scripts in the tools/ directory.
    
    It inserted the =encoding line at the top of the file, instead of in
    front of the first =head1 entry, and this meant that the #!/usr/bin/perl
    and the prologue became a part of the POD, which was not intended.

commit 870c17e99acd038daed9b4004c66d401679475ab
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 13 13:34:38 2014 +0100

    sparsify: Add --tmp option to allow specifying temp directory or block device.
    
    Add the virt-sparsify --tmp option.
    
    This works in two ways.  Either you can specify a temporary directory,
    in which case it's just the same as setting $TMPDIR before:
    
      virt-sparsify indisk outdisk --tmp /var/tmp
    
    Or, as a new feature, you can specify a block device which is directly
    used (and OVERWRITTEN):
    
      virt-sparsify indisk outdisk --tmp /dev/sdX
    
    This is useful for oVirt nodes, where there is limited temporary
    space, but a block device can be assigned to the node.
    
    In both cases it is only used in copying mode.  In-place
    sparsification doesn't require large amounts of temporary space.

commit 893bfe2e36f5a766e822b14fe5e7e4fc9b2b3f75
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 13 13:34:01 2014 +0100

    mllib: Create a common utility function is_directory.
    
    This is a wrapper around Sys.is_directory which doesn't throw
    exceptions.

commit 9b5cdc874784437d7a59bd024043c2abd930b6c3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 12 13:28:03 2014 +0100

    fuse: UID 0 should override all permissions checks (RHBZ#1106548).
    
    Previously if you were root, and you tried to change directory into a
    directory which was not owned by you and not readable (eg. 0700
    bin:bin), it would fail.
    
    This doesn't fail on regular directories because when you are root the
    kernel just ignores permissions.
    
    Although libguestfs in general tries not to duplicate kernel code, in
    the case where we emulate the FUSE access(2) system call,
    unfortunately we have to do it by stat-ing the object and performing
    some (half-arsed) heuristics.
    
    This commit modifies the FUSE access(2) system call, so root is now
    able to chdir to any directory.
    
    It also adds some debugging so we can debug these complex permissions
    checks in the field if some other problem arises in future.

commit 87ac1c186eee81165003bb4d0196e147611527ba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 12 22:18:02 2014 +0100

    builder: Don't copy *.xz files to WEBSITEDIR.

commit bacc7fd0a3aa7cfe9ecd1a3740f9f7891cd90196
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 12 22:13:25 2014 +0100

    builder: Rebuild Fedora 19 disk image with Xen drivers.

commit 005316b7d869c505df0d8d39a96861e918351f3d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 12 15:42:33 2014 +0100

    builder: Get rid of remaining disk image signatures.
    
    These were deprecated and replaced in virt-builder 1.24.1.

commit 58ea77e79becc14e5ddacc0f37f41fac3a3f14e3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 12 15:38:52 2014 +0100

    builder: Update Fedora 20 image, with Xen drivers.
    
    This commit also removes the disk image signature.  These have not
    been needed since virt-builder 1.24.1.  No one should be running that
    version of virt-builder since there are newer 1.24 branch versions.

commit 0fa52e4e45d80874bc5ea5f112f74be1d3f3472f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 12 13:49:43 2014 +0100

    builder: Fedora: Enable Xen driver support.
    
    See:
    https://www.redhat.com/archives/libguestfs/2014-June/thread.html#00045
    
    Notes:
    
    (1) Edit dracut configuration to make sure the change is permanent, in
    case kickstart, virt-builder or something else installs a kernel or
    runs dracut.
    
    (2) We need to run dracut on the just-installed kernel, not on the
    running kernel.  The snippet to do this was copied from the Fedora
    cloud kickstart.
    
    Thanks: Olaf Hering, George Dunlap, Dario Faggioli.

commit d4d6540b24ac82fd7344db10e96270cc0a28aa68
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 12 13:49:09 2014 +0100

    builder: virt-install now requires '--serial pty' parameter.
    
    This updates commit 73ebaa30668ce7d9e3e413c3abf67a74829dfe5d.

commit 73ebaa30668ce7d9e3e413c3abf67a74829dfe5d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 11 12:43:03 2014 +0100

    builder: virt-install now seems to require '--serial pty' option.

commit 99472ab2e925a43e9ba51e62ee66145e92209b8f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 11 12:42:08 2014 +0100

    builder: Further updates to RHEL 7 GA script.
    
    The location of the trees have moved ... again.

commit 24800d2e96b668252e30977f3af81aa3b2195eef
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 11 08:21:34 2014 +0100

    builder: Update rhel.sh script for RHEL 7 GA.
    
    Set the rootfs for RHEL 7.x to xfs.  (/boot is ext4)
    
    Remove old RHEL 7 beta & rc releases.

commit 0dbdc470ed7a6fe7251929ee6f4dfeb8ddc01625
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 10 21:10:27 2014 +0100

    Version 1.27.15.

commit 7faa602e8f86702418e11572603badbfbb14f6b7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 10 19:31:06 2014 +0100

    launch: libvirt: Only use serial BIOS (sgabios) on x86.
    
    This device is not present at least on ARM.  Unfortunately libvirt
    doesn't give us any way to query when the device is present.
    
    This fixes commit bed592498d791c5ce6ad722f41dcbfbe243b0a7a.

commit e6a858907fd7851148440dcfc7cbabc5cee75a71
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jun 10 15:18:38 2014 +0200

    appliance: init: properly set PS1 and TERM for virt-rescue (RHBZ#812970).
    
    Setting environment variables such as PS1 for bash before starting it
    might not be effective when the startup scripts provided by the
    distribution unconditionally change it.
    Hence, set PS1 and TERM in a ~/.bashrc, which will be source'd last and
    thus be able to set them the way we want.

commit 844066597dc9ed92c0685c136f613c06276c6132
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jun 10 15:18:37 2014 +0200

    daemon: grub: show grub-install's output on error if verbose

commit 45db96b00dde2eb9429efbdc2f57bb1bbafafc03
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jun 10 15:18:36 2014 +0200

    daemon: print parameters for vgchange in error messages

commit 134ac97d22065224e200d6cd72231d116b45f054
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jun 3 14:48:51 2014 +0200

    daemon: retire the augeas feature
    
    Augeas has been a mandatory dependency of libguestfs for quite some
    time, so the aug_* functions could have been always called (without even
    checking the augeas feature). Thus retire the feature, marking it as
    always available with no more functions depending on it.

commit b28ef8791a21751b1def9f84108fec14ea73ffa9
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jun 3 14:37:41 2014 +0200

    builder: handle duplicated images (RHBZ#1092753).
    
    Filter the available images, removing the versions with an older
    revisions, and duplicates.

commit aeb879247456c619040d3a01a47a08ffa14c03f7
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jun 3 10:14:21 2014 +0200

    inspect: tighten NetBSD detection
    
    It seems recent (?) NetBSD versions have their kernel as /netbsd, so
    also check for it to detect NetBSD installations.
    
    The current detection so far basically relied on generic files and
    directories which can potentially be in every UNIX system, misdetecting
    them if a /etc/release file is present in them.

commit 5efbc8922ff3f338deb17b42bc7b63cc1545fcc0
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Jun 2 21:24:35 2014 +0200

    fish: list also aliases in the guestfish help (RHBZ#1103877).
    
    Output also the aliases (telling which function they refer to) in
    `guestfish -h`, together with non-alias functions.

commit 6577f34a687f339304f20ac703a2e468865a4297
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Jun 9 09:59:20 2014 +0200

    appliance: remove extra comma in Mageia's list
    
    Followup of commit 00d94d95c805ee027a9ef9e67f3979f1faada4a7.
    
    Thanks Thierry Vignaud for the notice.

commit 0196724330117232868b83bce709559ba3784952
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 30 18:08:26 2014 +0100

    Version 1.27.14.

commit 4d8ecb0d30b8e0c49ddb750b5102a2cb67fdd2b5
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu May 29 10:32:15 2014 +0200

    generator: fix daemon functions with optional params but no mandatory params
    
    The
      struct guestfs_$function_args args;
    declaration was not emitted in that case, leading to build failure.

commit 00d94d95c805ee027a9ef9e67f3979f1faada4a7
Author: Joseph Wang <joequant@gmail.com>
Date:   Thu May 29 08:46:20 2014 +0100

    appliance: Update packagelist for Mageia (RHBZ#1102448).

commit ef49b297cc56668da01efa637fb80007a76d23dd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 27 11:48:44 2014 +0100

    appliance: Increase udev timeout to 6000s (RHBZ#1096579).
    
    If the image is located on NFS, and the NFS mount is performing a
    large copy, then all other NFS operations stop.  This delay can be
    large enough that we hit the current 10 minute timeout in udev.
    
    Increasing this to 100 minutes is reported to cure the problem (in
    reality we want udev to wait indefinitely).

commit 917ca11a76863075b4fcb13fe0eec0c2a6a08892
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue May 27 11:02:58 2014 +0200

    ruby: add :nodoc: comment for internal methods
    
    This way they are ignored by rdoc.

commit e4005bd530aab62a8d86cfc7cb5db1c69ae873dd
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue May 27 10:57:13 2014 +0200

    builder: support aliases for images (RHBZ#1098718).

commit bed592498d791c5ce6ad722f41dcbfbe243b0a7a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 26 12:20:10 2014 +0100

    launch: libvirt: Add -device sga (sgabios).
    
    This feature was added to libvirt in 2011-07-08 so we can assume it
    exists.
    
    Thanks: Jiri Jaburek

commit 1fbf0a88f6c4e5648af8ec64e3933683078f4a94
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun May 25 22:34:51 2014 +0100

    fuse: Make all the skip messages consistent in this test.

commit f32aef2971497872c179cb16dd1a1d922c46587e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun May 25 22:34:04 2014 +0100

    fuse: Skip test-fuse-umount-race.sh if backing file does not exist.

commit 068455f21005aa7cf7ea9c0a82e01f2cf58659e1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun May 25 22:28:27 2014 +0100

    fuse: Skip guestmount --fd test if /dev/fuse does not exist.
    
    When we run guestmount (eg. in Koji) it will fail anyway, so don't run
    the test.

commit 2c460ac52f3df25897d93266aac717c3f1147797
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 24 19:17:46 2014 +0100

    Version 1.27.13.

commit 32f5d998731e1c0deed6ec80f5c873697986147e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 23 11:46:43 2014 +0100

    fuse: Add a test of guestmount --fd option (RHBZ#1100498).

commit 145c7ed5eeaaa491f91a8e31ff655df4177b1a5e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 23 11:27:37 2014 +0100

    fuse: Add guestmount --fd option (RHBZ#1100498).
    
    This implements the guestmount --fd option to allow you to run
    guestmount captive under another process (typically using
    `guestmount --fd=<FD> --no-fork').
    
    See: https://bugzilla.redhat.com/show_bug.cgi?id=1100498

commit a60212ee99de88591d060a95b30aa0e0cece5832
Author: Hilko Bengen <bengen@debian.org>
Date:   Thu Dec 12 21:06:22 2013 +0100

    golang: Fix for out-of-tree builds
    
    RWMJ:
    
    This is half of a downstream Debian patch to fix out-of-tree builds
    for golang.

commit ee9981714fbb266ff58450b8dd4c3568b284df77
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 23 11:04:20 2014 +0100

    Version 1.27.12.

commit 5d5e66ce334bf61bcc2e672d17d84dd0dd0dd364
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed May 21 15:03:17 2014 +0200

    daemon: scrub-file: resolve the path before calling scrub (RHBZ#1099490).
    
    Resolve the given path within the chroot, so scrub can be invoked
    outside the chroot on an already-resolved path.
    
    Add few tests in scrub-file for this and other similar issues.

commit d7aec9c0d31c14b97c0bb93595d492fdd3741143
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed May 21 15:01:50 2014 +0200

    daemon: add sysroot_realpath
    
    Similar to sysroot_path, but first resolves (using realpath) the given
    path within sysroot.

commit 05f84f4c214f9b91862ba63398a2e248e0e7d92d
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed May 21 14:58:40 2014 +0200

    Make realpath mandatory
    
    commit a86eb0e0d2c67e2153139c681632edc72162b8ed made it an optional
    feature, as on Windows it was not available; on the other hand, realpath
    has been used unconditionally already for quite some time, so having
    just the "realpath" command conditional on the presence of it does not
    make much sense.
    
    Drop the configure/build system handling of it, make the "realpath"
    command no more optional, and keep the "realpath" feature as
    unconditionally available now.

commit 50ed922a02c7316749d94dcaf81752d239124030
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed May 21 14:39:30 2014 +0200

    generator: add always-available optgroups
    
    Support the possibility to have optional groups always enabled (e.g.
    because they were present in the past, and they need to be kept for
    users).
    Add and use few helper optgroups-related functions to deal also with
    them.

commit 865f64006e9bab5c1c5efdfd9e8ceee140c8d998
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 21 09:36:34 2014 +0100

    ppc64: Use console=hvc0 console=ttyS0.
    
    console=ttyS0 used to work.  Now it's broken again, and the correct
    setting appears to be console=hvc0.  Since we can pass multiple
    console settings, do that to try and catch the right console.

commit 84189b370a0db5670e2a2d7a5b3d79cffdb67ed5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 20 13:13:39 2014 +0100

    Update guestfs-release-notes.txt.
    
    This updates commit a21dfc483c5102334d8c490a50077ec201ffe2e4.

commit 697b0d46782e1c4eb4bc927e54012e0ff8205b2d
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue May 20 13:31:07 2014 +0200

    fish: simplify output of 'supported'
    
    Print each line at once, making use of the padding features of printf
    instead of doing it manually.

commit a21dfc483c5102334d8c490a50077ec201ffe2e4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 20 10:45:33 2014 +0100

    Fix some spelling mistakes and typos in documentation (RHBZ#1099284).

commit e014ef33ab80de10df0bcdd73ff774310af3910a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 20 10:40:17 2014 +0100

    Update BUGS.

commit f49e003a875ce5703b7e8d4109a145ebe673129d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 17 11:15:54 2014 +0100

    p2v-iso: Add a kickstart target.
    
    This also changes the old p2v-iso/README file into a POD file
    which is installed as a manual page.

commit 1939cd4849ff3e52e76ddb91d9acd30bca3a0495
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 17 10:58:00 2014 +0100

    p2v-iso: unset CDPATH, set -e at the top of the virt-builder-target script.

commit c65fbeebb8482fede853445d639ddb6642fd3c1b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 17 11:44:46 2014 +0100

    configure: Move --with-default-backend test later in configure.ac.
    
    For some reason this test was right at the top of the script.

commit c5106511e004c90a0e538a6d39e3c32fbfea108e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 17 11:35:31 2014 +0100

    build: Use AC_PROG_AWK to define the right awk to call.
    
    We actually call plain 'awk' in many different scripts, but this
    commit does not change all of those.

commit 044ecdb9036d338a32e66a71745f9f946931e4f6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 17 10:38:59 2014 +0100

    builder: Make the summary printed at the end easier to read.
    
    This is just a whitespace change.  The new output looks like this:
    
                       Output file: fedora-20.img
                       Output size: 4.0G
                     Output format: raw
                Total usable space: 5.2G
                        Free space: 4.5G (86%)

commit 467bddd3b72fd62bae9695f644182b5dcc5cbd5b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 16 12:54:46 2014 +0100

    p2v-iso: Use xorg-x11-drivers meta-package to install Xorg drivers.
    
    Thanks: Andrew Price.

commit 8e6ddbdf708282324acbe0367a5961768cb4747e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 16 11:10:06 2014 +0100

    Version 1.27.11.

commit a09146386ce14e8899b8816894afe83f78604480
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 16 08:45:47 2014 +0100

    virt-p2v: Install the binary in libexecdir.
    
    Previously it wasn't installed at all.  However it makes sense to
    install it somewhere so that it can be placed in a package (a
    requirement if we're going to create a kickstart).  By placing it in
    libexecdir it is hopefully clear that it should not be used.
    
    Note on Red Hat distros, libexecdir is usually /usr/libexec.  On
    Debian it is usually /usr/lib/libguestfs.

commit 45971ab95222204a1b8d9a311a739c453308cade
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri May 16 11:05:40 2014 +0200

    build: bump the libsystemd-journal needed version to 196
    
    Bump to >= v196 the minimum version of libsystemd-journal needed for the
    journal integration, since that version provides
    sd_journal_get_data_threshold and sd_journal_set_data_threshold.

commit 77166308fad1ca970c5cdba785db4c36e44ea971
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 15 23:00:46 2014 +0100

    Version 1.27.10.

commit 047b6d3050a8e7b07f21df62044673380c6f897a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 15 13:43:18 2014 +0100

    Add p2v-iso directory containing scripts for building the virt-p2v ISO.
    
    It is not possible to have the ISO be built automatically when the
    user runs 'make'.  The README file describes how you should go about
    building the ISO or disk image.

commit fd82bb12fd5fc8233955b8ffd4a42c3d6f8d748b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 23 21:27:52 2014 +0100

    New tool: virt-p2v.
    
    This is a graphical standalone front-end to virt-v2v which can be run
    on physical machines (usually linked into a ISO or PXE boot image) to
    convert the physical machine to a virtual machine.

commit 0131d6f666d93dd353c4e4092fd945861646d319
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 1 14:41:30 2014 +0100

    New tool: virt-v2v.
    
    This is a rewrite of the original virt-v2v tool.  The original was
    written by Matt Booth et al in Perl between 2009 and 2013.

commit 40d9609b29b462b80821e9e6acc5dc5a9e4f01d8
Author: Maros Zatko <mzatko@redhat.com>
Date:   Thu May 15 14:44:36 2014 +0100

    generator: Change link to OCaml tutorials.

commit 1a1cb1ec3cdc24262db4de2f8bf12d3479096882
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 12 22:19:08 2014 +0100

    builder: Fix RHEL 5 download location.
    
    This fixes commit 3bc9ba6c8447cde07db057aea76d0d72f5d833df.

commit d2bfe2cb24a53f6968b1a4b54cfc7299e33cfeaf
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed May 14 17:59:31 2014 +0200

    builder: respect the proxy also when downloading images (RHBZ#1096465).
    
    Missing from commit 87d79c2ee259ce51595ad3a924fd216f882dc477.

commit b6c8afaee63e26de42695244eacbeb81b06171a9
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed May 14 17:28:13 2014 +0200

    builder: save the proxy for each entry
    
    Copy the information about the proxy of a source in all the entries of
    that source; this way it is possible to use it later when accessing to
    the actual image of an entry.

commit 3bc9ba6c8447cde07db057aea76d0d72f5d833df
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 10 17:18:39 2014 +0100

    builder: Fix RHEL script for RHEL 5.
    
    Root partition is on /dev/sda2:
    
    $ virt-filesystems -a rhel-5.10 --all --long -h
    Name       Type        VFS   Label      MBR  Size  Parent
    /dev/sda1  filesystem  ext2  /boot      -    510M  -
    /dev/sda2  filesystem  ext4  /          -    4.5G  -
    /dev/sda3  filesystem  swap  SWAP-hda3  -    1.0G  -
    /dev/sda1  partition   -     -          83   510M  /dev/sda
    /dev/sda2  partition   -     -          83   4.5G  /dev/sda
    /dev/sda3  partition   -     -          82   1.0G  /dev/sda
    /dev/sda   device      -     -          -    6.0G  -
    
    It would be better if we could mount by label in guestfish ...
    
    There is another problem with RHEL 5 guests in that the
    yum URL is slightly wrong.

commit 75022489c81242a6717e579ff6c5f8dc8ec6cbf6
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Fri May 9 11:14:55 2014 +0200

    appliance: update Debian-specific package list

commit 944a601020aeb4acc0646958aac7b65d2a3ed2e6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 10 12:11:11 2014 +0100

    builder: Add Ubuntu 14.04 disk image.
    
    Also remove the Ubuntu 13.10 image, since it's not an LTS image.

commit a1fcd2ca5f24d4646b40408bbbaffb74fb20d9e6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 10 10:45:15 2014 +0100

    builder: ubuntu: Allow virt-install --os-variant to be specified on the command line.
    
    Current virt-builder in F20 does not know about --os-variant=ubuntutrusty
    so to build that you can now do:
    
      ./ubuntu.sh 14.04 trusty ubuntusaucy

commit c7888ac61846aa1d21f0ff5dd19b046590b83072
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri May 9 15:06:50 2014 +0200

    configure: always add the extra warnings
    
    Get rid of --enable-gcc-warnings and just add all the warnings in any
    case; they are tested anyway, so only warnings supported by the compiler
    will be used.
    
    Regarding -Werror, add a new --enable-werror which enables its use.

commit a880bc1eb00909e64093f06a4373942a9b264616
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri May 9 12:20:33 2014 +0200

    tests/syslinux: add new syslinux 6+ path of mbr.bin
    
    Reported in https://bugs.debian.org/746748.

commit f46d53be18f586daa6e3e8ed4975da26c940b203
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri May 9 12:19:47 2014 +0200

    tests/syslinux: factorize search for mbr.bin

commit 5e574bb3049dac4a8f1f9b4a1cccbbbc3c15dc9e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 7 14:42:03 2014 +0100

    Version 1.27.9.

commit a651990fb12e2cc972e8a984378ec3d57bdce27c
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed May 7 15:45:07 2014 +0200

    test-charset-fidelity: allow to skip testing specific FSes
    
    Allow to skip testing the filesystem "foo" if the environment variable
    SKIP_TEST_CHARSET_FIDELITY_foo=1 is set. This way it possible to not
    test one or more filesystems without disabling the test altogether.

commit 3633109ff35f1d0f6bc72ed129911db6c4ae5c8e
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Apr 30 18:10:32 2014 +0200

    Fix handling of passwords in URLs
    
    So far, passwords in URLs (eg http://user:password@host..) have been
    handled as part of the username, and thus passing
      add-drive path username:username:password ...
    instead of
      add-drive path username:username secret:password ...
    
    Fix the parsing of URLs to handle passwords as separate elements,
    properly passing it as "secret" parameter for add-drive, and properly
    readd it when building URLs in the direct backend.
    
    Furthmore, to keep curl- and ssh-based qemu drivers working with
    authenticated resources, make sure they can accept secrets.
    
    Reported in comment #1 of RHBZ#1092583.

commit c24ce0811df8a3f1bf1cff5ccd3e89b948f696d0
Author: Nikos Skalkotos <skalkoto@grnet.gr>
Date:   Mon May 5 17:24:04 2014 +0300

    inspect: Add support for Oracle Linux
    
    Prior to this patch the library would return "rhel" instead of
    "oraclelinux" for Oracle Linux OSes.

commit 9e829363932c0db12f38e64763348f65380752f9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 3 16:47:48 2014 +0100

    New API: cpio-out converts a directory to cpio format.
    
    This is useful for generating Linux initramfses from other types of
    filesystems.  For example:
    
     guestfish --ro -a disk.img -i cpio-out / - | gzip -9 > initrd.img

commit c67e16734ce41b1ec8ec146531bcec20573fec7f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 7 09:04:23 2014 +0100

    sparsify: Add a note about qcow2 internal snapshots not being copied (RHBZ#1094746).

commit 2bd75a1ea1e606780915eeba5048f4bf8af84de9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 5 15:54:30 2014 +0100

    customize: random-seed file has moved again.
    
    Thanks, systemd.

commit 845daded5fddc70fc5e822769bc1e2a8cbead7ca
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue May 6 19:22:14 2014 +0200

    lib: xmlParse{File,Memory} -> xmlRead{File,Memory}
    
    Switch from xmlParse* to xmlRead* so we can explicitly specify parsing
    flags, including no network usage and no entity resolution.
    The two behaviours mentioned above were not done before either, so this
    should not introduce behaviour changes in libguestfs.

commit 4dc42693f23bd38393de001e8c45f22aac9e8292
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun May 4 20:57:33 2014 +0100

    guestfs-recipes: Fix language.

commit be874d7f509bd0ae9098cd2ac8d060865a57891b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 2 11:25:21 2014 +0100

    Version 1.27.8.

commit c2488b6ed832ce6899ed083530f4cfc68d5f2e97
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 2 11:24:45 2014 +0100

    builder: Add RHEL 7 signature to EXTRA_DIST.
    
    This fixes commit fea553778a1f38b8c0dc3bf76a67725f0cee9094.

commit 0c1a4b1781447d5b485b38e06fe3dcf486ab009d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 2 10:55:21 2014 +0100

    launch: direct: Turn gdb into a backend setting.
    
    You can now use LIBGUESTFS_BACKEND_SETTINGS=gdb in order to enable gdb
    debugging of the appliance.  This only works with the direct backend.

commit c4a91a1866ddba3a52a2b9f2be7d66f519d958ba
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Tue Apr 29 23:18:01 2014 +0200

    launch: direct: Supply -M option when testing qemu for devices.
    
    qemu-system-arm 2.0 as currently available through Debian/unstable
    doesn't want to tell us anything about available devices unless we
    specify a machine type.

commit 1550a80d6c639cb1bd2a29bba8203a2b8cbb80ae
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Apr 30 15:52:49 2014 +0200

    daemon: xattr: factorize do_getxattr and do_lgetxattr
    
    Move all the common code to a new _getxattr function, much like done for
    other xattrs operations.
    
    Mostly code motion, no functional changes.

commit fea553778a1f38b8c0dc3bf76a67725f0cee9094
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 29 23:00:40 2014 +0100

    builder: Add RHEL 7RC disk image.

commit df5bd5741b37da9cf97d7a76ac2805557aa630db
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 29 15:43:20 2014 +0100

    builder: Fix parallel builds of index-parse.o.
    
    When parallel builds are enabled it was possible for index-parse.c to
    be compiled before the file had been completely written by bison.  The
    usual symptom was that the 'do_parse' symbol was missing -- this
    simply happened because that symbol is defined at the end of this
    file, and the compiler compiled the file before the end part was
    written out.  But you could also see other strange & random compile
    failures as you would expect.
    
    This was tested by running this script on an 8 core server:
    
     cd builder/
     export MAKEFLAGS=-j9
     while make clean >/dev/null; make all V=1 >& /tmp/log; do echo -n . ; done
    
    Previously it would fail after <= 5 iterations.  With this change it
    runs for at least 100 iterations.

commit 50b207ca459a205efeec613ab04ff4c39dc6bee2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 28 09:14:34 2014 +0100

    Add a regression test for RHBZ#1091803.

commit efd159a063410b3d9d13814222abed231ec42f90
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 28 09:51:00 2014 +0100

    tar-in: Fix places where we didn't cancel the receive (FileIn) correctly along error paths (RHBZ#1091803).
    
    Thanks: Bo Fan.

commit 8df792d4a76eb188fcbc68b38c8bc1e757a6f6ff
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 23 19:50:37 2014 +0100

    Version 1.27.7.

commit ae891bc5f59f44d575912a087bd09d16e2d60a6b
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Apr 23 10:39:51 2014 +0200

    builder: isolate all the cache handling to a new Cache module
    
    While there is not that much in it, it groups together the small
    scattered-around bits handling the cache directory.

commit 101d728e80cce73b882aac7af457013491d03311
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 22 22:21:57 2014 -0400

    configure: Make sure grep matches qemu 2.x version string.

commit 4f5dc4afdc56483a29044d9d5498b5c764bcbc6a
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Apr 22 17:58:27 2014 +0200

    builder: add "[ignored]" to parsing errors for .conf files
    
    Parsing sources .conf files is not a fatal error (that file would just
    be ignored), so explicitly state that such parsing errors are ignored.
    
    This should address the last bit in RHBZ#1077817.

commit e7c746854b27754807d3a61902c25325b18d525d
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Apr 22 17:57:05 2014 +0200

    builder: add an optional suffix string for INI parsing errors

commit 3f4903e53ab8ccb8b199e17f65d5d4c32ed626ad
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 22 14:14:12 2014 +0100

    Version 1.27.6.

commit b176bde942b2ee046383884eb6fa919c3fe68145
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 22 13:25:12 2014 +0100

    FAQ: Describe better how to compile libguestfs from source using alternate qemu/supermin/kernel.

commit 2f5e9066db817f75b245f256abc0c64dd1ae54eb
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Apr 18 11:39:21 2014 +0200

    ruby: tests: convert from Test::Unit to MiniTest (RHBZ#1085029)
    
    Convert the tests to the MiniTest test framework, but keeping the usage
    of the old Test::Unit as fallback in case MiniTest is not available.
    In the latter case, use a bit of "glue" to make the old API look like
    the new API, so we can just rely on the newer MiniTest API.

commit fbae7f3e69ce598c52af71ec204f8dbd0a9ce5e5
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Apr 18 11:27:11 2014 +0200

    ruby: tests: isolate boilerplate in common file
    
    Isolate in a common file all the standard boilerplate in tests, i.e. the
    import of the test framework and the guestfs module (including the
    import path hack needed for the latter).
    
    Thanks to Vít Ondruch for the precious hints and suggestions.

commit 0316d247706aab7ce7c2225472feeb51fa8b1664
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Apr 17 11:32:50 2014 +0200

    daemon: parted: part-get-name: switch from sgdisk to parted (RHBZ#1088424).
    
    Use parted to get the name of partitions in GPT layouts instead of
    sgdisk, to reduce the possible discrepancy between output of tools.
    
    The actual case here is that recent parted versions fixed/improved their
    UTF-16 handling of partition names in GPT, and sgdisk seems to not be
    properly handling them, returning also unicode control bytes.
    Since parted can provide partition names already, just make use of it.
    
    Since sgdisk is no more needed for part_get_name, the function is no
    more optional on it.

commit 909c10d758887958c9e077732fe9beead55ec4e4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 16 21:12:30 2014 +0100

    sparsify: If using -v (verbose), ensure #disk_create runs verbose too.

commit e1a82bb13064db97c2918485a0d9c52329677e62
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 16 21:12:30 2014 +0100

    builder: If using -v (verbose), ensure #disk_create runs verbose too.

commit 9515345bbdd81d9c8eb72f09207a4c090ea56d2c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 16 20:09:39 2014 +0100

    builder: Suggest using virt-install --os-variant option in virt-builder man page.

commit 27355c9b0b49fb988181c6ad70375aa6f490c558
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 16 11:43:23 2014 +0100

    disk-create: Fix this API so it works correctly with block devices (RHBZ#1088262).
    
    When you call guestfs_disk_create on a block device with format=raw
    then it will try to discard the blocks on the device.

commit 1898d457bdd138a90dd859cd14658ab48020a7b2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 15 23:29:03 2014 +0100

    Version 1.27.5.

commit 3c260f23d4a4256e892955d38116c91e7bd189af
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 15 18:03:53 2014 -0400

    configure: Fix tests of qemu on ARM.
    
    qemu-system-arm now requires that you pass '-machine virt' (or some
    -machine type) explicitly.
    
    Change the configure test so it works on upstream ARM.

commit 87d79c2ee259ce51595ad3a924fd216f882dc477
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Apr 15 14:15:14 2014 +0200

    builder: add per-repository proxy configuration
    
    Add the possibility to configure the proxy in each repository .conf
    file, specifying whether use no proxy at all, follow the system
    configuration or use a specific proxy.

commit 040694ab79c3dfa86df41ae9e76e13d287413c66
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 15 14:23:34 2014 +0100

    Version 1.27.4.

commit 8ae2a8a9365bdcb0474042d4ad654d46807c7bfa
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Apr 14 14:18:41 2014 +0200

    sysprep: remove also hidden files/dirs in temporary dirs
    
    List manually and remove the content left (hidden files/directories) in
    temporary directories after the glob listing & removal.

commit 8f3959e581fdbebce95637408f8f44388abc60f4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 14 11:42:33 2014 +0100

    sparsify: Fix automake build.
    
    Previous commit 97c57a8887e04742c58c3956385a5366c6df02c3 added a
    potential bug in the sparsify build.  If virt-sparsify had used a
    *.mli file then it would have tried to run a command like:
    
     ocamlc mlguestfs.cmxa -c foo.mli -o foo.cmi
    
    This would fail because ocamlc doesn't know about native code
    libraries (*.cmxa).  In fact virt-sparsify was not affected by this
    because it doesn't use any *.mli files.
    
    Fix this by adjusting the automake variables.

commit c78b932199096d061364db2fb1d6a679922664c9
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Apr 11 16:15:13 2014 +0200

    builder: set an empty XDG_CONFIG_HOME in tests
    
    This way they are affected less by the environment.

commit 47ec61e9af19f8a750750ad498adc10fa7ae0521
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 21 15:24:01 2014 +0000

    listfs: If LDM not available, don't inhibit partition detection (RHBZ#1079182).
    
    If a disk has type 0x42 partition (which would indicate LDM), but LDM
    is not available then try parsing the partition anyway.  It might be
    parseable as plain old NTFS.

commit 97c57a8887e04742c58c3956385a5366c6df02c3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 8 21:17:39 2014 +0100

    sparsify: Use automake to build and link virt-sparsify binary.
    
    There are two observations which make this possible: (1) virt-sparsify
    contains at least one C unit, so automake thinks it is compiling a C
    program.  (2) Automake lets us add a *_LINK rule to override linking.
    
    We list the C sources of virt-sparsify as virt_sparsify_SOURCES, so
    automake thinks it is building a C program as normal.
    
    We override virt_sparsify_LINK to make it actually link an OCaml
    program.
    
    We add virt_sparsify_DEPENDENCIES listing the OCaml objects so that
    they get built before linking.
    
    We need a small linker script (link.sh) which adds some options at the
    end of the linker command line which are impossible to add using pure
    automake.
    
    Inspired by the same idea in supermin:
    https://github.com/libguestfs/supermin/blob/master/src/Makefile.am

commit 65b8edda0a65f9a5cc35039712d246147ac02238
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Apr 9 13:56:16 2014 +0200

    sysprep: remove ConsoleKit logs

commit 54d1f6e6110c686f774befd4c16feccf718dd431
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Apr 9 13:42:22 2014 +0200

    sysprep: remove the exim logs

commit f7d2738902367ef7a02c1f0fb9ef9221b41faca8
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Apr 9 13:38:50 2014 +0200

    sysprep: remove apt and aptitude logs

commit d413c94fa6c302b948fcf5de560a184895a75142
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Apr 9 13:29:39 2014 +0200

    sysprep: remove debug, syslog and faillog logs

commit ccf84d7b80948ba807ef8ce0216f55f756c894ed
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Apr 9 12:00:00 2014 +0200

    sysprep: remove debian-installer files

commit b08955e76af958f96e3c8d807284e1c379c4f532
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Apr 9 11:38:47 2014 +0200

    sysprep: remove the lightdm logs

commit fc9a4221ba2020685643ac839ee324b9545aea50
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Apr 9 11:31:11 2014 +0200

    sysprep: remove more anaconda configs/logs

commit 0c35c3adddbd50d3dfeea356a49e23c711c18b06
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Apr 9 11:22:53 2014 +0200

    sysprep: remove systemd journals

commit ffffe71c16d8e0cc8537bbaa4d8cc9908f528eb7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 9 10:19:37 2014 +0100

    build: Remove code coverage and code profiling options.
    
    This reverts commit 5a2e320ec9390b2146feea6d7b3b8c36a34d0a90.

commit 595bd5022a251a396050c247003ac60328a7facf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 8 10:05:34 2014 +0100

    sparsify: Relax test constraint (RHBZ#1079210).
    
    As long as over ~300MB is recovered, declare sparsification to be
    successful in this test.
    
    It looks as if the journal or other metadata takes up a variable
    amount of space after sparsification.

commit 466885b226821d8099e47cf7a869a00f70c3e5a4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 7 13:17:38 2014 +0100

    configure: Add message about GNUlib tests.
    
    Output was:
    
      yes
    
    Now the output is:
    
      checking if we should run the GNUlib tests... yes

commit f63d82781924b2e399a97f0024c7816bd3cd61e9
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Apr 4 16:09:51 2014 +0200

    customize: add the chmod command
    
    Add the chmod customize command to change the permissions of files.

commit df0d1978120b3e3e3c07b5677c00f00027efbe2b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Apr 6 16:19:33 2014 +0100

    Version 1.27.3.

commit 71738831545a51e0bd462fe72c7674581aabd160
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 3 20:27:18 2014 +0100

    recipes: Update the section on installing packages.
    
    Libguestfs >= 1.26 makes this easy.

commit 55437e459b80f3805925d42c5ab6ae0f63386360
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 3 12:23:37 2014 +0100

    mllib: utils: Add mapi function.
    
    This is List.mapi from the stdlib.  RHEL 6 did not have this function.

commit 82b486a9086f84447324d68b3c0cae300e0334f7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 3 16:05:00 2014 +0100

    appliance: Avoid touching appliance/supermin.d directory.
    
    We must avoid touching appliance/supermin.d unless it is necessary, so
    that we avoid unnecessary rebuilds of the full appliance.
    Unfortunately since we created temporary files there, even if we
    didn't decide to keep those temporary files they would still end up
    touching supermin.d.  To stop this, move the temporary files out.

commit b7ad029536b415b38c2fcc359acf123bae020e65
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Apr 3 15:26:26 2014 +0200

    appliance: exclude pkg-config, doc-base, and reportbug stuff
    
    Exclude the arch-independent pkg-config files (no pkg-config available
    in the appliance).
    
    Exclude also the doc-base and reportbug files, typically found in Debian
    systems.

commit d268cfd13ef8e8dff3313c951e4d415fd183cf89
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 3 08:58:46 2014 +0100

    builder: Add test of virt-index-validate.

commit 358c6571d0a70ec40ff8750885854d3ad6bb28ca
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 3 08:45:31 2014 +0100

    builder: Rearrange EXTRA_DIST in alphabetical order.
    
    No functional change.

commit 795a162cee3765cce19cf7c52128ec27a9482aa2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 3 08:44:24 2014 +0100

    builder: Don't use configure to generate test-index file.
    
    The file contained no replacement patterns so generating it
    with configure did nothing.

commit 9cbb619db205da435e022884c694ff4bfd687943
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Apr 2 18:13:59 2014 +0200

    builder: better handle some index parsing errors
    
    Add a new lexer token, unused in the grammar, for the unknown lines in
    index files; this should allow to better handle such kind of parsing
    errors, removing the need to exit() directly (and leave things in an
    unclean state).

commit 3fa5096f484087cd3415f7eb5dda98dfed11e7ed
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 2 17:33:37 2014 +0100

    customize: Add a "finishing" message at the end.
    
    Useful, mainly because it tells you the total time spent running.

commit 8c46a644bc664de32835541883123fbabe6991fe
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 2 14:06:03 2014 +0100

    customize: Add customize/*.ml files for translation.

commit 84f646a41a7571937a7b3f71f12338dfb60776b2
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Apr 1 18:01:19 2014 +0200

    src/launch: improve the addition of the no-hpet option
    
    Since HPET is specific to x86, we can safely add it its option only on
    x86 and x86_64 when creating the libvirt XML (no more hitting the
    launching failures due to that on other architectures).
    
    Regarding the direct qemu launch, since qemu 1.1 (which is our current
    minimum) "-ho-hpet" appears in the help only where actually supported,
    so we could just checking for it and adding it only if present. This
    should fix the architecture issues on this backend as well.

commit b03b3f6f463c80be90ca32d241a56123d4122ed6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 1 14:56:32 2014 +0100

    sparsify: Reorder external programs in SEE ALSO section.

commit 07dff756a7e86154a3ee4f951764eb1fd1f5ed0f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 1 14:55:20 2014 +0100

    sparsify: Remove duplicate "EXIT STATUS" sections from man page.

commit c58bef5125ff6d5d4a06c607707cdcbf61cdb25d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 31 18:07:08 2014 +0100

    Version 1.27.2.

commit 7c1d95cca0599ac63e5d82adde62bd9a0cbbde7e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 31 18:00:07 2014 +0100

    rescue: Fix the --suggest regression test so it works when using UML backend.
    
    The boot partition name is /dev/ubda1 in this case, so use a small sed
    script to canonicalize it for the test comparison.
    
    This fixes commit f6a37740f2ba6668bee4952fdd35c46cb6d79cba.

commit cf316569238194e5483d525c3ad618687a055656
Author: Lee Yarwood <lyarwood@redhat.com>
Date:   Mon Mar 31 16:52:31 2014 +0100

    Add the now mandatory arch=ARCH field to the index file examples.
    
    61323fa introduced a mandatory arch field within index files to
    identify the architecture of the OS installed within a given template.
    This change simply documents the requirement within the relevant
    section of the virt-builder man page.
    
    Signed-off-by: Lee Yarwood <lyarwood@redhat.com>

commit 4916806bdfd3ec158b03080ae2a7aacde18a4b84
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 31 15:09:34 2014 +0100

    Version 1.27.1.

commit 957afde13ba3c8fd6db07c7bb27751c2c009a9ee
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 31 15:13:09 2014 +0100

    python: Add README.txt to EXTRA_DIST.

commit 0d9a61a91ddca03fd5652441caa2a8c9123639ee
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 31 13:59:08 2014 +0100

    src: Fix test-utils.c to test the validate_guid function again.
    
    This fixes commit 768ab2e01dab5a8e7e751c33b72c1341fcaf9dc3.

commit 7e39cd46005d0547cb8ba77c915557efb588ed9a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 31 12:56:28 2014 +0100

    Remove internal libvirt_setlinux* APIs and use backend settings instead.
    
    This removes the internal APIs internal_set_libvirt_selinux_label and
    internal_set_libvirt_selinux_norelabel_disks.  The communication
    between the libvirt domain and the backend now uses the backend
    settings.

commit 5d4e4e7ecaafee6ad8c445f069b3b4c606ba013c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 31 14:20:28 2014 +0100

    ocaml: Add ESRCH to Guestfs.Errno module.

commit d137ad52c52f8b448d3413660a18c636b6f9ae65
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 31 12:53:25 2014 +0100

    New APIs: set-backend-setting, get-backend-setting, clear-backend-setting.
    
    Currently the backend settings are treated as a list of strings.  You
    can set the whole list (clearing any strings there previously), but
    you cannot search for an individual string or replace an individual
    string.
    
    This adds further APIs allowing you to do that.  We treat the backend
    settings as a list of environment-like strings (ie.  name=value), and
    add the following functions:
    
     - set-backend-setting (name, value)
    
       Set name=value.  Any previous settings of name are cleared.
    
     - get-backend-setting (name)
    
       Search for name or name=value and return the value.
    
     - clear-backend-setting (name)
    
       Remove any name or name=value settings.
    
    This also adds a regression test.

commit 1893eaded0cf7be68bc30eb3a9fbde814cb42316
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 31 13:33:10 2014 +0100

    handle: Free g->backend_settings.
    
    This was not being freed, resulting in a memory leak if you used
    LIBGUESTFS_BACKEND_SETTINGS.
    
    Found by valgrind.

commit 6af2306730b7e4e372e60b6435f87722972c504b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 29 18:52:32 2014 +0000

    python: Remove unnecessary library dependencies.
    
    We can remove the deps on libxml2, libvirt and gnulib, by only linking
    with utils.o (instead of utils.a).

commit fcbfc4775fa2a44020974073594a745ca420d614
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 29 16:07:21 2014 +0000

    python: Add a Python setup.py script.
    
    This is not used by libguestfs right now, but it does allow you to
    build a python "distribution" of libguestfs, like this:
    
      make -C python sdist
    
    The distribution tarball will be in python/dist/
    
    You can copy the distribution tarball somewhere, unpack it, and use
    regular 'python setup.py' commands such as:
    
      python setup.py build
      python setup.py install [--prefix=...]
      python setup.py --name
    
    In future we hope to be able to upload the distribution tarball to
    PyPi, but licensing issues prevent this at present.

commit 768ab2e01dab5a8e7e751c33b72c1341fcaf9dc3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 29 16:57:59 2014 +0000

    utils: Move guestfs___validate_guid out of utils.c.
    
    guestfs___validate_guid was a new function added to utils.c in
    commit beef77403cd9d634b6ff6daa9f33d292e2d320a7.
    
    However utils.c should not include <guestfs-internal.h> since the
    other functions in this file can be used by all front-end code, not
    just libguestfs.so.
    
    This function is only needed in libguestfs.so, so move it to another
    source file, and remove include of <guestfs-internal.h> from utils.c.
    
    Also: use 'size_t' for counting, not 'int'.
    
    This fixes commit beef77403cd9d634b6ff6daa9f33d292e2d320a7.

commit bc1a4157941f482efebce19529dbad01537a0051
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 29 17:12:07 2014 +0000

    utils: Remove for-loop variable decl.
    
    Breaks Python distutils which doesn't use C99:
    
    utils.c: In function ‘guestfs___copy_string_list’:
    utils.c:79:7: error: ‘for’ loop initial declarations are only allowed in C99 mode
           for (size_t j = 0; j < i; ++j)
           ^
    utils.c:79:7: note: use option -std=c99 or -std=gnu99 to compile your code

commit ebda77b647282c672bd76a021f52c9dc972ce34e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 29 15:07:54 2014 +0000

    virt-builder: Add --machine-readable option, as in virt-resize and virt-sparsify.
    
    This makes it easier to query the virt-builder binary capabilities,
    from external programs.

commit 30bdadf032d1c210bae6e2785277afe030d9baf4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 29 14:55:01 2014 +0000

    builder: Disable internal parallel xzcat on RHEL 6.

commit eff7aed6cfc24c1d605578f738a0d76112d9966b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 29 14:47:25 2014 +0000

    builder: Remove recursive include of index-parse.h.
    
    This breaks on Bison < 2.7, and seems unnecessary in any case since
    the same file is included earlier.

commit f6a37740f2ba6668bee4952fdd35c46cb6d79cba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 28 14:37:45 2014 +0000

    rescue: Add a regression test for virt-rescue --suggest option.

commit c8657535fd6c937a4ce9ebee647b03b8b6f76916
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 28 14:25:42 2014 +0000

    rescue: Don't leak various variables when using --suggest option with multi-boot guests.
    
    This fixes a leak which was introduced in
    commit 4255db65e58a86148ec291a7416a1148c453d926.
    
    Found by Coverity.

commit 15b06d6100ceed0974d52d1aeffa67e9e34fc7da
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 28 14:01:19 2014 +0000

    make-fs: Close FILE* along error path.
    
    Found by Coverity.

commit 410aae4b6f646e1fc20b82d24486c68f0c09916c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 28 13:59:56 2014 +0000

    make-fs: Check for error return from guestfs_statvfs.
    
    Found by Coverity.

commit 4cea94a958d72e6f3411ba0caaccf9c27543d15c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 28 12:35:25 2014 +0000

    daemon: parted: part-get-name: Don't leak partition type string.
    
    Found by './configure --enable-valgrind-daemon'.
    
    This fixes commit 820b87016794116c783bd224f2e776cfdf65108e.

commit a7a239f7ab8abe8e81861c06abea4dd21dc4cd3d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 28 09:57:07 2014 +0000

    builder: Use libgnu.la instead of -lgnu.
    
    This updates commit effcb99f838da1c4830b4a6b0cc4394b904376f2.

commit effcb99f838da1c4830b4a6b0cc4394b904376f2
Author: Olaf Hering <olaf@aepfle.de>
Date:   Fri Mar 28 10:44:16 2014 +0100

    builder: Link virt-index-validate with gnulib.
    
    [Gnulib tries to replace getopt because of the bug shown below.
    However because -lgnu was not used in the Makefile, the replacement
    failed. -- RWMJ]
    
    from config.log:
    
                 /* This code dumps core on glibc 2.14.  */
                 {
                   static char program[] = "program";
                   static char w[] = "-W";
                   static char dummy[] = "dummy";
                   char *argv[] = { program, w, dummy, NULL };
                   optind = opterr = 1;
                   if (getopt (3, argv, "W;") != 'W')
                     result |= 64;
                 }
    
    gdb --quiet --readnow ./conftest -ex r -ex bt -ex detach -ex q
    Reading symbols from /usr/src/packages/BUILD/libguestfs-1.26.0/conftest...expanding to full symbols...done.
    Starting program: /usr/src/packages/BUILD/libguestfs-1.26.0/conftest
    Missing separate debuginfo for /lib64/ld-linux-x86-64.so.2
    Try: zypper install -C "debuginfo(build-id)=5d1a12e6f0e95331cc4e39df74ecbd5adb76a1f7"
    Missing separate debuginfo for /lib64/libc.so.6
    Try: zypper install -C "debuginfo(build-id)=a06caa12df8f953a453befa827c3145adaf6269a"
    main(323) result 0
    main(344) result 0
    main(357) result 0
    main(370) result 0
    
    Program received signal SIGSEGV, Segmentation fault.
    0x00007ffff7b2dbf8 in _getopt_internal_r () from /lib64/libc.so.6
    Detaching from program: /usr/src/packages/BUILD/libguestfs-1.26.0/conftest, process 31042
    
    This change actually fixes build for me on sles11sp3 and 11.4.

commit a78cd210c3b659fdbf3e5344ca5882fb505d2cd5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 27 15:47:16 2014 +0000

    Version 1.27.0.

commit 996eca5da7adae60e726b9837a9cc8e94373de02
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 27 11:57:09 2014 +0000

    Version 1.26.0.
    
    New stable version.

commit a20e368fea11fec1a2927670bbe3035ad0bcf4c1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 27 11:34:37 2014 +0000

    fish: Check return values from a couple of API calls.
    
    Found by Coverity.

commit be250948bc3e10b370244476debb7ee90d8d8703
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 27 11:33:40 2014 +0000

    fish: Ignore return value from guestfs_user_cancel.
    
    As we are in a signal handler, there's nothing else we can do.
    
    Found by Coverity.

commit 40998806437eb74b60fddff466a8318f76551818
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 26 20:25:05 2014 +0000

    examples: Check return value from guestfs_list_filesystems.
    
    Found by Coverity.

commit 7792278e0534e0e91ddc160aee46f1623a5769a1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 26 20:23:19 2014 +0000

    virt-diff: Free memory along error path.
    
    Found by Coverity.

commit 8da50e5a3f83fffa2ed3508a57c787ee73af3d97
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 26 20:08:36 2014 +0000

    daemon: md: Whitespace fix.

commit 4caa2ea5ffa15719030e1528956163130020417f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 26 20:07:43 2014 +0000

    daemon: ldm: Initialize glob_t struct before passing to glob.
    
    Some implementations of glob might use fields in the struct, although
    not glibc as far as I know.
    
    Issue identified by Coverity.

commit fe97d5ed9cd32bac999a93fe1212538363f8a020
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 26 20:03:15 2014 +0000

    builder: pxzcat: Ignore return value from posix_fadvise.
    
    Quiets warning from Coverity.

commit 21390bc4aa8b9c5cd32df3e68f2d21fb196dcbc2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 26 16:53:37 2014 +0000

    Pull latest translations from Transifex.

commit f566f176c6fe502e9c765438551fb787a0cef8d9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 26 16:47:26 2014 +0000

    Remove the ROADMAP file.
    
    I don't think it provides any value now.  There is a list of bugs in
    'BUGS' and a set of ideas in 'TODO'.

commit 0febb59afa3d2fb711d2782ecdd51a656623a807
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 26 13:35:05 2014 +0000

    Final updates to release notes for 1.26.

commit a9b62321b6f6629580d9ada28b149019dd6174f5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 26 10:28:36 2014 +0000

    Version 1.25.49.

commit 90973755b2f891f3814e9d9d22f739aeb6fa494a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 26 10:21:38 2014 +0000

    customize: Use --no-network flag so test works under UML.

commit 63f0ee9c57a24a6f53becd7534c2a218212291f7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 26 00:05:45 2014 +0000

    Version 1.25.48.

commit 218ac6996be19b84d92f654633d8ad53d1937a02
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 25 23:52:51 2014 +0000

    Further updates to the release notes, for 1.26.

commit 36f4f105810a2b027e4164a73db8ae9789e849a5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 25 19:15:06 2014 +0000

    Further updates to release notes, for 1.26.

commit cec31436f8b87d84887a50fd6eeba853ccef1581
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 25 22:41:19 2014 +0000

    customize: Rename main.ml to customize_main.ml.
    
    The OCaml compiler isn't happy when two modules have the same name in
    different directories.  Since customize/ contains a library of modules
    used in other directories, and since those directories may have
    main.ml files too, we need to rename 'customize/main.ml' to
    'customize/customize_main.ml'.

commit 1a4709147a4e6cbebd394ce1a157a14e4c55db6b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 25 22:09:34 2014 +0000

    customize: Add various options from virt-builder.
    
    This adds the following options to virt-customize:
    
      --attach
      --attach-format
      -m / --memsize
      --network / --no-network
      --smp
    
    This fixes commit 2b208d84db080659badbb70044497aae040592e7.

commit 87fcb4df0340309d1858ea43ce242985225ab649
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 25 22:09:14 2014 +0000

    Add customize subdirectory to ./run script.
    
    This fixes commit 2b208d84db080659badbb70044497aae040592e7.

commit 36f179fdfa548965d0aa57335d12c4cc29e4cf0e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 25 16:06:25 2014 +0000

    Begin working on release notes for libguestfs 1.26 release.

commit a70dd85a1734ecf3e1a6bda57b382a451ffb936d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 25 09:50:32 2014 -0500

    aarch64: Use -M virt to specify virtual machine type.
    
    Thanks: Paolo Bonzini

commit d6072de4ffe19ea57fe94caedbb39f1f7517182b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 24 17:34:45 2014 -0500

    arm: Replace #ifdef with #if defined, etc.
    
    No functional change.

commit afb74f104dd4b1c27f3bb1254f51342ffa6702b9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 24 17:34:15 2014 -0500

    aarch64: Cannot emulate IDE, like all non-PC.

commit 219c2ddf1b186f2afeda698e0d93ba6b1559eaf8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 24 17:33:51 2014 -0500

    aarch64: This has no working hpet emulation, like ARM 32 bit.

commit f8c83e801afc26dd61a8108188ab4de9e4a4b0ec
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 24 17:33:10 2014 -0500

    aarch64: This has no PCI, like ARM 32 bit.

commit d396ccb47063e2a3d177e50cc2299b40788f2b75
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 25 13:00:22 2014 +0000

    Open release notes for 1.26 release.

commit 40cac10b62509bc1ad12fe9c10a89ad83ca0fb84
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 25 13:00:17 2014 +0000

    Update TODO with Python bindings suggestion.

commit 3d79c51a2853cc3347a31d67a04ce140cbe8d683
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 25 13:11:23 2014 +0000

    Update API support.

commit 7ad1683daef031c3a1f4ca1fb5e75553ec6c4234
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 25 12:51:25 2014 +0000

    Version 1.25.47.

commit 2b208d84db080659badbb70044497aae040592e7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 25 10:46:08 2014 +0000

    Add virt-customize standalone tool.
    
    This includes some simple tests and a manual page.

commit aa3bc8b65d56c6d9708b72286d61e459967eb33c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 21 13:41:31 2014 +0000

    sysprep: Remove the --autorelabel (and related) options.
    
    The customize module includes an --selinux-label option which can run
    'fixfiles restore' (on most SELinux guests) or set /.autorelabel (on
    some older ones).
    
    Commit 49014f81f350484da725f5ee2bc62bb24268a334 renamed the old
    --selinux-label option to --autorelabel, but note this was not
    included in a stable version of libguestfs.
    
    Note this change leaves a bunch of now redundant code for detecting if
    we created a new file in the guest.

commit ae6f726ecc3bc1b67fd76e51a7b1e1a33d4dcfc0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 19 15:14:06 2014 +0000

    sysprep: Use customize module for customizing the guest after sysprepping.
    
    Note this removes the following modules (all replaced by 'customize'):
    
     - delete       [--delete, --scrub]
     - firstboot    [--firstboot]
     - hostname     [--hostname]
     - password     [--password, --password-crypto, --root-password]
     - random-seed
     - timezone     [--timezone]

commit 51834ad2192b1c90b74894421c2633c831ca1f4e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 19 13:16:53 2014 +0000

    customize: Add a --password option for setting user passwords.

commit 4b0b3589e854f0ed9174250490dc9c6ade94292f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 17 15:34:31 2014 +0000

    customize: Move virt-customize-related code to a separate directory.
    
    Split virt-builder into build and customize steps, so that we can spin
    off a separate tool called 'virt-customize'.  This commit does not in
    fact create such a tool, but it moves all the common code into a
    library, in the customize/ subdirectory of the source.
    
    Although this is mostly refactoring, it does change the order in which
    virt-builder command line arguments are processed, so they are now
    processed in the order they appear, not the inflexible fixed order
    used before.

commit 8e386fc1beedc2b203231175c156151a1cc49c83
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 21 13:24:38 2014 +0000

    sysprep: Pass debug and quiet flags to all modules.
    
    Also use the Common_utils.make_message_function function to print
    messages (same as virt-builder).

commit 1edfdcbd58381ff0935891c451b448ccdd4af4f0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 21 10:54:11 2014 +0000

    sysprep: Allow order of operations to be specified by modules.

commit f450fb41060c8e0d8a14dc869a54b8981b8fc99c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 21 10:47:51 2014 +0000

    sysprep: Perform operations in alphabetical order.
    
    Previously we ran them in essentially a random order, although it
    might have looked alphabetical in some cases because the modules are
    loaded in order.

commit 4a9581668c74222d5e780507c81ffb9480c68701
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Tue Mar 25 12:00:41 2014 +0100

    appliance: Not all of Grub is needed, only grub-install

commit 0116a482fc98645e6e71848d5fe46e40571f3f3e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 25 10:47:53 2014 +0000

    Update gnulib to latest.
    
    Includes a fix for the missing 'git-log-fix' file.
    https://lists.gnu.org/archive/html/bug-gnulib/2014-03/threads.html#00019

commit f80fc724bc1d4410303459439b3c7bac51ad7520
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Mar 24 16:23:38 2014 +0100

    php: raise the per-test timeout to 300 secs
    
    Some tests might spawn an appliance, which will take time on slower
    architectures and on some virtualized environments.
    Hence raise the per-test timeout from the default of 60s to 300s (which
    should be hopefully enough for now).

commit 483f0e30962ef6a662478dc6f0b13a1852733d4d
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Mar 24 16:59:20 2014 +0100

    virt-sparsify --in-place: remove image if discard is not supported
    
    No point leaving it around if the test has been skipped.

commit 08234a1c48a9b9e69d1ab8790f9b754fc5ab8952
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 24 14:18:34 2014 +0000

    po-docs: Do not translate "__AVAILABILITY__" placeholder.
    
    This fixes commit da122e382f3d6d05c5981a3e5f4e3b806e3e37e3.

commit ad2c6a13b3b541ccc70fe18b4290a06e85b8fc06
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Mar 24 15:13:13 2014 +0100

    docs: remove customize-related files
    
    The work on them has not been committed yet.

commit da5b8b6d61d07514d3c74de1bdff7d23108e6849
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Mar 23 21:56:29 2014 +0000

    appliance: Fix quoting so that DEBIAN isn't always defined.
    
    Because of incorrect quoting previously, the DEBIAN symbol
    was always defined.

commit 07bf7402381bbbb4c69373ed150675ef313c2b85
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Mar 23 19:40:44 2014 +0000

    Update gnulib to latest version.

commit 26599da373c549034a1bc01923e5920f61f16abe
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Mar 23 16:31:10 2014 +0000

    ocaml: Enable parallel builds.
    
    Commit f75142c577255b30f2a8e1d27baa5fd185594197 disabled parallel
    builds in the ocaml subdirectory (which was the correct thing to do).
    This made building the OCaml tests in particular very slow.  Therefore
    fix things so that parallel builds can be used again.
    
    See also discussion here about different approaches:
    
    https://www.redhat.com/archives/libguestfs/2014-March/thread.html#00223
    
    This reintroduces commit dce94f3e266ed3f1fc634a1ef6953f2db1510963.

commit da122e382f3d6d05c5981a3e5f4e3b806e3e37e3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Mar 23 12:59:18 2014 +0000

    Update Ukrainian translations.
    
    Contributed by: Yuri Chornoivan (via Transifex)

commit f42769f94b20898452884091ac57d73a95f280c0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Mar 23 12:09:01 2014 +0000

    virt-make-fs: Fix typo in error string.
    
    Thanks: Yuri Chornoivan

commit 20f412637eb0a12642f780df80cd43f0a090652f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 22 14:08:08 2014 +0000

    builder: Fix typo in string.
    
    Thanks: Yuri Chornoivan

commit e589b6e82336dec3abb6e2b1aea31313b7ec5172
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Mar 20 16:57:29 2014 +0100

    builder: do not parse the same repository file name twice
    
    When parsing the repository configuration files, track the file names
    parsed, and in case of same file name in multiple location consider only
    the one in the directory coming before others in the prioritised list of
    paths.
    
    This way it is possible to "shadow" a configuration file in a system
    path with one with the same name in a local directory, for example.

commit 603ad40c5ac034f22f3f2f682755a871d9e84267
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Mar 20 16:35:15 2014 +0100

    builder: allow the index parser to parse files with no sections
    
    Gracefully handle files with no sections; extend the validate.sh test
    to try to validate an empty file.

commit fa0fed8a2deacc29524518fbaa1e51516edce872
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Mar 20 16:23:43 2014 +0100

    builder: allow to run website tests under valgrind

commit 37ed019f53959936daf784af87e772088675aaa9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 20 15:28:57 2014 +0000

    Version 1.25.46.

commit 4edf659aa0d06aff2c8490751596cb8db6d66743
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 20 15:24:34 2014 +0000

    php: Include new location of tests in EXTRA_DIST.
    
    This fixes commit 251a1934c9bcfe9727b011a4d8bfc4b769b3b744.

commit 62875c88be1cc88e05d41dfec13383ce1dbbbbbe
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Mar 20 14:47:04 2014 +0100

    builder: clean the parsing structs on error

commit c6c27620d0688f573c638711b6bcdb94204432cd
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Mar 20 14:43:57 2014 +0100

    builder: rename and make public the section/field free functions
    
    They will be needed also elsewhere.

commit 87ed6365e47fea2112d62a32f234f63eab8a6b19
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Mar 20 12:40:16 2014 +0100

    builder/virt-index-validate: try to cleanup in any occasion
    
    Always close the file (ignoring its result) after a parsing, and cleanup
    the parse_context object before any exit().
    
    This eases the debugging of memory issues in the actual parser.

commit c7639495d7af7a6c406d4413530fd6af9429a75d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 20 14:34:58 2014 +0000

    Revert "appliance: Remove genisoimage from packagelist."
    
    This reverts commit cd996642e04ef3293e1d8de2df7222b4e8fe8bc1.
    
    The daemon uses 'isoinfo' which is part of this package.
    
    Thanks: Pino Toscano.

commit cd996642e04ef3293e1d8de2df7222b4e8fe8bc1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 20 13:49:19 2014 +0000

    appliance: Remove genisoimage from packagelist.
    
    It is not used by the daemon as far as I can tell.

commit c4dc70f8c43a7faae2a8698027a4ed23d316dfa0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 18 15:30:03 2014 +0000

    podwrapper: Remove =encoding from input files and add it back in podwrapper.
    
    This changes podwrapper so that the input (POD) files should not
    contain an =encoding directive.  However they must be UTF-8.
    Podwrapper then adds the '=encoding utf8' directive back during final
    generation.
    
    This in particular avoids problems with nested =encoding directives in
    fragments.  These break POD, and are undesirable anyway.

commit ad33a5434cf80c567286d5598875aa23f544eeaa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 18 15:19:37 2014 +0000

    po-docs: Filter the po4a warning and =encoding line.

commit 420d324555111a0d60caf7bd451dbbd12f3153ea
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 18 15:06:44 2014 +0000

    po-docs: There are no *.pl files in the po-docs subdirectories any longer.

commit 01548fd5b7fcde221a7079cad7fab5f502f91e7a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 18 12:49:45 2014 +0000

    generator: Generate copyright notice in generated POD fragments.
    
    Using =begin comment ... =end comment.

commit d4129988c19a49c916c7b5f8ebb66e3e5761c145
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 18 12:43:34 2014 +0000

    podwrapper: Give an error if an --insert or --verbatim pattern is not found in the input.

commit 121c2894bc4d089142acb1652f30913b36807895
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Mar 19 18:30:58 2014 +0100

    tests/run-xml-to-junit.xsl: allow to define a different classname
    
    Read and use the classname attribute in each test if present, falling
    back to "TestSuite" (used so far).

commit 7c70429e2ed8652e865b6e4cc0cb77d54b775295
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Mar 19 16:48:20 2014 +0100

    builder: show the application name in errors of the index parser

commit 15f04f21b9acb6ab5b48bceb0898d5c5955647a5
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Mar 19 16:14:34 2014 +0100

    builder: show the file name in errors of the index parser

commit c871ed6b50e8e7fbfc2bd6cab2ceeaacd8449d71
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Mar 19 15:42:45 2014 +0100

    builder: make the C index parser reentrant
    
    Switch the lex/yacc parser into reentrant mode, to ease the handling of
    parsing-specific data; introduce a new parser_context struct for that,
    which is added as extra data to the parser.
    
    This should cause no behaviour changes in the parsing, just no more
    global variables used for getting data in/out the parser.

commit 251a1934c9bcfe9727b011a4d8bfc4b769b3b744
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Mar 18 15:12:26 2014 +0100

    php: move tests under a tests subdirectory
    
    This eases fixes the classname in the junit output of run-tests.php,
    which now can be properly handled by junit XML consumers.

commit 7fb823e4277148f61222b7174399e209b9cd576c
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Mar 18 14:38:02 2014 +0100

    php: make the test suite failures fatal
    
    So far the failure of some test would have not reported a non-zero
    return value by run-tests.php. Since now all the PHP tests pass, we can
    ask for failures to be fatal, by exporting REPORT_EXIT_STATUS=1 for
    run-tests.php.

commit d521f7c2e3d6ed8cbc47da36a376bb61f0b0c390
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 17 21:05:18 2014 +0000

    build: Disable a couple more ineffective warnings.

commit 19dcc0de1fd4988ff53d152297480462453e196b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 17 19:54:16 2014 +0000

    Annual scavange to find mixed declarations and statements.
    
    Hopefully this is just code motion.

commit 6035c764e67b9c142034848db7b3dd6390233420
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 17 18:56:57 2014 +0000

    build: Remove -Wno-declaration-after-statement.
    
    We have generally forbidden declaration-after-statement in our code
    (although there are plenty of places that do it).  In any case this
    warning is not in the default set, so we don't need to turn off the
    warning.

commit 931aec5b8846ce63b0e2b6beba5861a019b5f694
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 17 12:02:58 2014 +0000

    virt-sparsify --in-place: Exit with code 3 if discard is not supported.
    
    Also skip the test in this case instead of failing.

commit 5e1fc4640dc369221e5e37013c9f9c7c065bbb8b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 17 12:21:39 2014 +0000

    mllib: Allow exit code to be specified when calling 'error' function.

commit 6e99530ea850d5fdd7d008b63ca518016cb9fe57
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 17 12:02:28 2014 +0000

    launch: Return errno == ENOTSUP if discard is not supported.

commit 0563405d2e3f3d81581cccfecdfd41f2bdd08a47
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 17 12:10:15 2014 +0000

    ocaml: Add Guestfs.Errno submodule exposing useful raw errno numbers.
    
    For use when calling G.last_errno.

commit 996c0a286820cd131c7d53e208816665380b87a2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Mar 16 22:55:52 2014 +0000

    Version 1.25.45.

commit 455ccc15c3c9f71b1001fa45788a53d39c359aa6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Mar 16 22:55:24 2014 +0000

    Add tests/run-xml-to-junit.* to EXTRA_DIST.

commit 7fe365eee68b49972a1c528ddd78101215e1defd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Mar 16 22:44:03 2014 +0000

    tests/regressions/rhbz895904.sh: Rewrite without multi-line expression.
    
    RHEL 6-era bash cannot handle the multi-line $(...) expression in the
    original code.  Rewrite the test so it is semantically the same but
    doesn't have the expression that old bash can't handle.

commit 93335b5c4aa55eeba01625459b3c9c8c0df96059
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 15 15:46:54 2014 +0000

    appliance: init: Remove unnecessary comment, whitespace changes.

commit bae2134aefdfdad5c9955c69a0c9f0772c90e95e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 14 13:20:22 2014 +0000

    tests/discard: sync before close isn't necessary.
    
    However we should be calling shutdown, since we're writing to the disk
    and need to catch qemu errors.

commit d46ceea6014006ab19b6f795e2e28a7360d90b2c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 14 13:14:24 2014 +0000

    tests: fstrim: Sync before running fstrim.
    
    This makes fstrim work.  It's not clear why exactly.
    
    Thanks: Paolo Bonzini.

commit 55730f6118aa947a8e81d36cd6a9cb28ce0bb7dd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 14 13:00:43 2014 +0000

    Revert "tests: fstrim: Remount the disk."
    
    This reverts commit accf1b66aa835714690a2979e990c49243875dab.

commit 56efdb29bf5a2aad1e5326c9a378155858fc579e
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Mar 14 11:24:22 2014 +0100

    tests: skip the output of test-virt-rescue.pl from RUN_OUTPUT_FILE
    
    The output of test-virt-rescue.pl contains non-ASCII chars which give
    troubles when being XSLT-transformed, so just avoid its output to leave
    the rest of the resulting XML well-formed.

commit 38fbda9d37ab1bf57d6c4c0c6be51aa44f110ff5
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Mar 14 10:37:36 2014 +0100

    tests: provide a simple way to extract the tests data from run
    
    If the RUN_OUTPUT_FILE environment variable is set, "run" will output
    to the file indicated by that snippets of XML with the results and
    outputs of the tests run.
    
    Together with the run-xml-to-junit.sh (and its associated
    run-xml-to-junit.xsl style sheet) it is possible to convert that output
    file to a jUnit-like XML file, which could be used in CI systems.

commit accf1b66aa835714690a2979e990c49243875dab
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 14 10:09:47 2014 +0000

    tests: fstrim: Remount the disk.
    
    This makes fstrim work.  It's not clear why exactly.

commit 9b883d3c3ec0ff93bbea776572afb54d2a9b3524
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 14 09:15:49 2014 +0000

    tests/discard: Ensure a significant number of blocks are freed up on the host.
    
    It's reasonable to expect megabytes will be freed up and given back to
    the host.  Previously we just tested that at least 1 block was
    released.  This test checks that at least 1000 blocks are released
    (since stat(2) returns blocks of 512 bytes: 512 bytes * 1000 = approx 0.5 MB).

commit 8584c8cadf4fdf9067457e07529aa74c715e03fa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 13 13:50:23 2014 +0000

    gobject: Don't ignore old generated files.
    
    This was ignoring an old generated file (gobject/guestfs-gobject.h)
    which, if still around, would break the build.

commit b96dfa60d3e7a4409fc2de9134f7bf828f34fa57
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 13 13:01:14 2014 +0000

    gitignore: appliance: Don't ignore some files which are now obsolete and should be removed.

commit bd226af94bd63e28c303a588c12f78b27cb15698
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 13 10:56:29 2014 +0000

    Version 1.25.44.

commit 083203c635d9b4c9852e46caf9135817cac3c29f
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Mar 13 10:24:04 2014 +0100

    php: fix crash with OStringList optional arguments
    
    Properly initialize the variables for them to NULL, so there is no crash
    because of trying to use rubbish pointers.
    
    Kind of followup of commit 289fd29f0bfbb94566d9780dd8ac3fe15e55541d.

commit e411cf8269b1c8b1334500ebd80e5348fc0b0c8c
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Mar 12 19:29:56 2014 +0100

    php: remove the custom "env" loading in tests
    
    Other than being too late for changing environment variables like
    LD_LIBRARY_PATH, now it is no more needed.

commit 5fbbfe7440009aff3a6a8f584a1cea777ef2b5dc
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Mar 12 19:24:39 2014 +0100

    php: add a custom PHP runner for tests
    
    Since the default PHP test runner ignores a good number of environment
    variables to potentially tampering the test suite execution, create a
    custom php-for-tests.sh script which does nothing more than sourcing the
    custom environment that our run-php-tests.sh outputs and running the
    actual "php" executable (the one found by configure).
    
    This fixes the loading of the guestfs_php.so module in the test suite,
    as the libguestfs.so.0 library can be found by that module.

commit 04aaa6ddfce98870b0c0a71f7cd27e629a81fcda
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 13 09:13:04 2014 +0000

    appliance: Fix 'make clean' in appliance subdirectory.
    
    Commit 71dfd73042db24217329d815bf5eab26f413d97f broke 'make clean' in
    the appliance subdirectory, so it would remove all the supermin.d/*
    files, but without removing stamp-supermin so you couldn't rebuild
    supermin.d/ with a 'make' afterwards.
    
    In any case, 'make clean' is not supposed to delete the appliance
    (which is expensive to rebuild).
    
    Fix this so that 'make clean' doesn't remove supermin.d/* files.
    'make distclean' can be used to delete this, and since it also removes
    stamp-supermin, it will be recreated properly by 'make'.

commit a13109c2608dd1984eeb57013cf1dacdf4338210
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 12 21:41:08 2014 +0000

    FAQ: Make issues which will be fixed in libguestfs >= 1.26 / supermin >= 5.

commit 8df1c472697d1a1227dd6d8d9bfbba0bcfee5b82
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 12 21:40:16 2014 +0000

    FAQ: Remove section that only applied to obsolete Fedora & RHEL releases.
    
    Since this is fixed in all currently supported versions of Fedora
    & RHEL, there's no need to document the problem in the FAQ.

commit 80d77e934ffc10413f1b100a461e6ddfd23fc384
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 12 21:39:18 2014 +0000

    FAQ: Document virt-sparsify >= 1.26 can do in-place sparsification.

commit b7cec3e8f46a727c3c8d83e5b54be7469f2e4f1d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 11 19:10:52 2014 +0000

    sparsify: Add a test of the virt-sparsify --in-place option.

commit e3a32f95d03cd29bf713f790994deca34e79bafc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 11 18:28:49 2014 +0000

    sparsify: Add virt-sparsify --in-place mode.

commit b48e8850047f240dc67e1610757229e096ed9e25
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 11 14:29:38 2014 +0000

    sysprep: Add disks with discard = "besteffort".
    
    Since virt-sysprep tends to delete a lot of files, adding discard
    support to it makes some sense.
    
    Note that this probably won't have any effect for most filesystems
    since:
    
    (a) ext4 mounts also need to use -o discard,
    
    (b) ext4, and maybe others, require you to call fstrim explicitly,
    they don't discard automatically (except for userspace tools like
    mkfs.ext4 but that doesn't apply in this case).

commit fb3afdff475db07fa904548ea2eeca29243a29c2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 11 14:20:53 2014 +0000

    virt-format: Discard the data on the disks.
    
    If possible, this means that the host will be able to reclaim most of
    the space used by formatted disks.

commit 93f1bfcad74946824c6a12a456dbd01cee9a0571
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 11 14:40:38 2014 +0000

    Pass discard parameter from add-domain to add-drive.
    
    Allow callers to specify that all the disks from a domain are added
    with a specific discard mode (instead of always having discard
    disabled).

commit 3106789d81cea27f0860ff78d7e15f71b7007949
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 11 14:40:38 2014 +0000

    Pass cachemode parameter from add-domain to add-drive.
    
    Allow callers to specify that all the disks from a domain are added
    with a specific cachemode (instead of always having to use the
    default, writeback).

commit a9fc09366aa69d6f371b93ad948c4a2c70166fd1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 10 14:17:49 2014 +0000

    tests: Add tests of discard support.
    
    Test that blkdiscard, -o discard, and fstrim work in reality, end-to-end.

commit b408419791c2fc895f6d1168f53cd92729c037fd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 11 19:01:35 2014 +0000

    New API: blkdiscardzeroes - do discarded blocks read back as zeroes?

commit 452b228b46834a49744459cfb6b872903abe60ef
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 11 13:14:23 2014 +0000

    New API: blkdiscard - discard all blocks on a block device.

commit 499b9ee416d15f1713558b63b2e975343afcc88f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Mar 9 15:24:31 2014 +0000

    New API parameter: Add discard parameter to guestfs_add_drive_opts.
    
    This adds a discard parameter to guestfs_add_drive_opts which
    approximately maps to the discard=ignore|unmap parameter supported by
    qemu.
    
    If discard is set to "enable" then we force discard=unmap (and try to
    fail if it is not possible).  If discard is set to the more useful
    "besteffort" option, then we enable discard if possible.  The default
    is "disable".

commit 53afa03af9175f127c77c221ea27b2a4a12d1fea
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Mar 12 16:07:55 2014 +0100

    builder: fix typo in comment
    
    Followup of commit b1cf6246f3c80762cf27dbdb24168589a34daf00.

commit 2489692067a51c9ba39ae8992ee19975f41a55ba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 11 18:03:13 2014 +0000

    sparsify: Move copying-mode code to a separate file.
    
    This is just code motion.

commit a665a570a3dd574a90c3d75c70ddb698c46f5a68
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 11 16:00:40 2014 +0000

    sparsify: Refactor command line parsing to pass back a mode.
    
    This is just code motion, but sets the ground-work for adding a second
    mode (in-place image modification).

commit 63e836881ec15a7380ad7db54615a4d595377c0f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 11 15:40:17 2014 +0000

    sparsify: Move command line parsing code to separate file.
    
    This is just code motion.

commit d263a301bfe082fc78f4548566a6644b48bf51ae
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 11 15:39:57 2014 +0000

    sparsify: Remove unused 'open' directive.

commit 8df13884dfc028021ac94de8006cf30100b2968e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 11 15:32:35 2014 +0000

    sparsify: Capture any exceptions and display nicer error messages.
    
    This is just code motion, there is no functional change.

commit 073f90e681c87238d54b94ebcfd8889a6af7a8a4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 11 15:32:04 2014 +0000

    sparsify: Remove unused variable definition.

commit 2b4baf34782107bd6b4436737242f3156f57448c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Mar 9 19:18:52 2014 +0000

    launch: libvirt: Move the is_kvm flag (derived from libvirt capabilities) to backend data struct.
    
    This is just rearranging the data between structs.  There should be no
    functional change.

commit 5e105e06be4cc6c88b5d3fc5cf79acb48947e197
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 12 13:41:39 2014 +0000

    daemon: fstrim: Fix fstrim so it trims the correct filesystem.
    
    We didn't call sysroot_path, so it was trimming the appliance instead
    of the guest filesystem.

commit 46e30c1f7c90f8f24d1261a9bc37e05f9ef2a552
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 11 21:54:13 2014 +0000

    daemon: fstrim: When debugging, capture and print fstrim -v output.

commit b1cf6246f3c80762cf27dbdb24168589a34daf00
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Mar 12 15:06:55 2014 +0100

    builder: complete architecture handling
    
    Add the possibility to choose which architecture use to build the wanted
    image (--arch). Since this implies that running commands on the guest is
    usually not possible when the architecture is different than the host
    one, virt-builder will nevertheless try to check whether the host is
    compatible with the guest, allowing to run commands only in that case.
    
    The caching scheme is adapted to account for the architecture (with
    --print-cache showing the architecture as well).

commit cc495247f2f274d24086862d38af6047c380939d
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Mar 12 15:05:24 2014 +0100

    builder: show the architecture in the short --list output
    
    Just like the other --list output formats provide the architecture, show
    them also in the short format.

commit 7942cbf537ac50ec29b45f30bc5f0deff510c8fe
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Mar 12 14:50:15 2014 +0100

    drivers: group drive creation params in an own struct
    
    Group together all the various parameters (except the guestfs handle)
    passed to the create_drive_*, to avoid passing all of them at every
    function call.
    
    This is mostly an internal refatoring with no behaviour change.

commit 013ed9f94bf6f572d9622ad0dfbd211729451e92
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 11 22:11:32 2014 +0000

    appliance: Cosmetic rearrangement of supermin.d/* targets.
    
    No functional change.

commit 71dfd73042db24217329d815bf5eab26f413d97f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 11 22:10:43 2014 +0000

    appliance: Don't rebuild everything if just the daemon changes.

commit 72d1a6335e6a7071e87566d464b5f804f9e760ee
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Mar 11 15:57:35 2014 +0100

    builder: add languages.ml to POTFILES-ml
    
    Followup of commit 3cffc28834d40d1debe8ebb826b8a5564ce8479b.

commit 6379c85d1f2bbf0e1c7e8165ddeda8efa18f8344
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Mar 11 14:25:39 2014 +0100

    builder: output translated notes also in --notes

commit 3cffc28834d40d1debe8ebb826b8a5564ce8479b
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Mar 11 14:20:22 2014 +0100

    builder: move some language-related code into a Languages module
    
    Mostly code motion, no behaviour changes.

commit 8ba31e69dc359f2b22e47bfeb5230e72ba95699b
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Mar 10 13:42:16 2014 +0100

    builder: use Filename.check_suffix
    
    ... instead of manually extracting and checking the suffix by ourselves

commit 596955c1b52d8dd6a095254f7878da451a4bbb91
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 8 12:57:23 2014 +0000

    Version 1.25.43.

commit 29440e2fbcdee45d64eb6c5d5eb0cffca4a8ac23
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 8 12:41:20 2014 +0000

    java: Complete test suite.

commit 6fa9e5dac7c2381fc91c87152dc15c49ba38d377
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 8 12:29:00 2014 +0000

    java: Document how to compile and run Java programs.

commit 2b3131cf4053b7e39c5185c85ebaef78ce4d586e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 8 12:13:46 2014 +0000

    java: Document how to use optional parameters in the guestfs-java(3) man page.

commit 1ba2e3e14aa6d58bff26646a1328969fda44610f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 7 15:04:13 2014 +0000

    java: Add regression test for RStruct/RStructList (RHBZ#1073906).

commit ebf8a3654ac4a691d48199adb8e92e182012a8c2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 7 15:04:47 2014 +0000

    bindtests: Fill in all fields in dummy lvm_pv struct.
    
    Used for testing RStruct/RStructList return values, but only
    in GObject and Java bindings.

commit dff35285e491d1905d38c90d83fed98932cbc3b3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 7 14:34:55 2014 +0000

    java: Use correct Set*Field JNI accessors to set fields of the appropriate type.
    
    Using the wrong accessors (somehow - I have no idea how) caused other
    fields in the struct to contain incorrect values.

commit 7a0e71f7331540809db5f539d1a9fe2af050c56a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 7 14:25:14 2014 +0000

    java: Factor out common field code in RStructList.
    
    No functional change.

commit 8c219636a272c4288f22392ff27b9c04580aecb4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 7 14:01:28 2014 +0000

    java: Split long lines in generated output, and add other whitespace.
    
    No functional change.

commit d00840d727e4040a7958ecc613599d6ec2851e53
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 7 13:49:52 2014 +0000

    java: Fix bogus construction of all RStructList returned values (RHBZ#1073906).
    
    Thanks Maarten on IRC for spotting the problem.

commit 6aa64ee3a3f1c990b5f9ce537f2b840273c3c1ba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 7 13:26:16 2014 +0000

    java: run: Add java/.libs to LD_LIBRARY_PATH so JVM finds the right JNI file.

commit 16954981e2fa9b8a6d8553ac622dd3777e5d02ef
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Sat Jun 1 15:12:27 2013 +0200

    Allow gnulib tests to be disabled.
    
    RWMJ:
    
     - Patch taken from Debian downstream package.
    
     - The default in the original patch was to disable the tests.  I have
       changed this to default to enable them instead.
    
     - Removed AC_SUBST as the variable was not being used.

commit 96f6a8f57ce2d452efa35588a734fc170346b975
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 6 15:59:35 2014 +0000

    Version 1.25.42.

commit e1fdc43539c303101394b7bbddaaada4587637f5
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Tue Mar 4 22:24:52 2014 +0100

    Remove two more files that are generated by configure

commit 5213d7b960d77844673436806e0526acb3e95ffa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 5 16:12:53 2014 +0000

    tests/md: Remove bogus test skip which tried to appliance hostfiles.
    
    This file no longer exists since supermin >= 5.
    
    Bug identified by Pino Toscano.

commit bdcc37b888146d1e56238dec698bbc8f0fdfc607
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Tue Mar 4 19:17:40 2014 +0100

    Debian: Add systemd-related libraries (for guestfsd) to packagelist

commit 7c21e129c9bc6bc145ac1cc81b53cfa289951496
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Tue Mar 4 18:56:07 2014 +0100

    Do not ship test-qemu-drive-libvirt.xml with tarball as it is generated by configure

commit b30e2cf12269b6fc18a03f74a201eb10a2d92e7f
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Tue Mar 4 00:00:02 2014 +0100

    Fix out-of-tree build: Do not accidentally build mllib components in srcdir

commit d7e3aea7bcee93bc0c3918d8ed06847d575775b4
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Mon Mar 3 23:58:57 2014 +0100

    Fixes for various tests in out-of-tree builds

commit 0048b5dc32fc7f07c0a34c88364a9d591c25f069
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Sun Mar 2 19:18:18 2014 +0100

    Fix out-of-tree appliance build

commit 876983365a508ad0aac7cddab8c5badfb1da2988
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Fri Feb 28 19:58:04 2014 +0100

    More fixes for situations where ocamlopt is not available
    
    - run bindtests.opt only if available
    - use ocamlc -custom
    - Don't try to install native code if it hasn't been built (Thanks to Olaf Hering)

commit 0b285e07a01329bfb8d27f086c939a2ba552a342
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 3 22:06:58 2014 +0000

    Version 1.25.41.

commit e87e377cfb1e5bf506cc51d4b535fab8cc1a2533
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 3 21:58:42 2014 +0000

    appliance: Ensure that supermin.d directory is installed properly.
    
    Commit 0a966727abc83550d2026886eac2440c99e6cb5e had a missing
    backslash in the list of files, so that 'make install' didn't install
    all the files.

commit 3acb4343eaf14c7286e1d762bce4fb0ef535ceb4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 3 17:20:43 2014 +0000

    Version 1.25.40.

commit d37dd9b055142607a353269f8ea80581bc03fc96
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 3 17:21:55 2014 +0000

    Add new logo to EXTRA_DIST.
    
    This fixes commit d73531a0aa691ff961366afee4db2c99a40510b6.

commit 0a966727abc83550d2026886eac2440c99e6cb5e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 3 13:43:35 2014 +0000

    appliance: Remove conditionals in appliance/Makefile.am.
    
    If appliance is disabled, the whole appliance/ subdirectory is
    skipped.
    
    If appliance is enabled, we can assume that the daemon is enabled too
    (see previous commit) so we don't need the conditional code.  That
    conditional code didn't work since the supermin 5 rewrite.

commit a6d72be984498e07f455c643e07a51b977603fc2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 3 13:41:59 2014 +0000

    build: Don't allow --disable-daemon and --enable-appliance together.
    
    This makes no sense, since the daemon is contained in the appliance so
    you cannot build a (meaningful) appliance without having a daemon.

commit 631c7d9241febcc7889d0fcb88aa07858174dbe1
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Mar 3 16:28:14 2014 +0100

    builder: install a $sysconfdir/virt-builder -> xdg-virt-builder symlink
    
    This way "virt-builder" appears directly in the sysconfdir.

commit 6a5052a4092912684d4934716fd543038ce7e758
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Mar 3 14:25:12 2014 +0100

    run: add the builddir of inspector to $PATH

commit 31b16a9dda6d66b54a0965a987f9af5ad95fbf58
Author: Hilko Bengen <bengen@debian.org>
Date:   Sat Feb 22 12:26:40 2014 +0100

    Debian: Strip Lintian overrides, initramfs-related stuff from appliance

commit 7adc60d955260dab7bbc4242a4140041a2bd2870
Author: Bastien ROUCARIÈS <roucaries.bastien@gmail.com>
Date:   Fri May 17 10:11:37 2013 +0200

    remove last trace of ntfsprogs

commit 2b4e2eb97d8e60758a8b944927ec7cb278e8dd87
Author: Hilko Bengen <bengen@debian.org>
Date:   Thu Aug 11 00:24:11 2011 +0200

    Fix for systemd-based Debian systems

commit e0124b9a91b49dbb34b121f09cfc1789305c1362
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 3 12:08:21 2014 +0000

    logo: Make the 5 years text larger and more readable for website.
    
    This fixes commit d73531a0aa691ff961366afee4db2c99a40510b6.

commit d73531a0aa691ff961366afee4db2c99a40510b6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 3 11:55:01 2014 +0000

    logo: Add fish logo with 5 years star.

commit b88f98849a43761f38702de9e2a4da7fb69a75b7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Mar 2 19:30:28 2014 +0000

    appliance: Cosmetic change to the order of command line arguments of 'supermin'.

commit 49209b3f965f65da8041fa70a30ae3df5b892535
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 1 16:26:12 2014 +0000

    Version 1.25.39.

commit 0c4fae7cb31243c49fa319f0102dbe61b97b7601
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 1 15:49:54 2014 +0000

    configure: supermin should be listed as AC_PATH_PROG, since it is used at run time.
    
    See top of configure.ac:
    
     > # NB: AC_CHECK_PROG(S) or AC_PATH_PROG(S)?
     > # Use AC_CHECK_PROG(S) for programs which are only used during build.
     > # Use AC_PATH_PROG(S) for program names which are compiled into the
     > # binary and used at run time.  The reason is so that we know which
     > # programs the binary actually uses.

commit 01a018a9de1db36f01d70cb6892b21e804d93673
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 28 22:48:20 2014 +0000

    mageia: Add distro setting and extra packages needed by Mageia.

commit 962837650cfb95e50d3c44578cbf47f7ec625271
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Feb 28 14:20:08 2014 +0100

    builder: add libguestfs.gpg to EXTRA_DIST
    
    It needs to be in EXTRA_DIST, otherwise it is not put in the dist.

commit 12bdd94f7e2916830bed109dd503910f96fa3f2b
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Feb 28 13:14:33 2014 +0100

    tests/luks: disable if luks is not available

commit f75142c577255b30f2a8e1d27baa5fd185594197
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Fri Feb 28 14:35:56 2014 +0100

    Fix building on architectures where ocamlopt is not available

commit a4be4231cc0c27eb9daa6adbce24e11844fe23a0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 28 13:36:05 2014 +0000

    launch: libvirt: Fix unused variable when libselinux is not installed.

commit 7c8af234305f0fe2cb5a9042bd58fe3735e8cd73
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 27 12:36:13 2014 +0000

    appliance: init: Don't write to /proc/sys/kernel/hotplug when starting udev (RHBZ#1020806).
    
    /proc/sys/kernel/hotplug is an obsolete interface for processing
    hotplug events.  It is not used by modern kernels, which should set
    this path to the empty string (because they have
    CONFIG_UEVENT_HELPER_PATH="").
    
    Unfortunately our udev initialization code did:
    
      echo -e '\000\000\000\000' > /proc/sys/kernel/hotplug
    
    which was intended to set this file to \0 bytes.  However on Debian,
    where /bin/sh is "dash", not "bash", this writes "-e" to this file,
    which breaks udev events.
    
    Thanks: Peter Rajnoha for solving this.
    
    https://bugzilla.redhat.com/show_bug.cgi?id=1020806#c10

commit 963b0341e26ddc4ddc0e0f0fa13deacecdd5ab0f
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Feb 25 17:29:13 2014 +0100

    builder: update documentation
    
    Update the documentation according to the new .conf files structure, the
    drop of VIRT_BUILDER_SOURCE and VIRT_BUILDER_FINGERPRINT, the drop of
    hardcoded source and its key, etc.

commit 47538865f2e6d82f7fff6e0ef0f48cba48acfc64
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Feb 25 17:29:12 2014 +0100

    builder: remove the default fingerprint/pubkey
    
    Sigchecker can still import keys from the user's keyring, so there is no
    need to hardcode fingerprint and key of the index hosted on
    libguestfs.org (which is now pointed to using a .conf file).

commit 573cae45c3490ddbd04a39aaf63dbe0cd0518cb1
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Feb 25 17:29:11 2014 +0100

    builder: remove VIRT_BUILDER_SOURCE and VIRT_BUILDER_FINGERPRINT
    
    Drop these two environment variables, and the implicit hardcoded source
    hosted at libguestfs.org.
    This means all the sources must be provided as .conf files, or at each
    invocation with --source.

commit f4990bef1c2cffb878f472023b01895ee326e4b3
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Feb 25 17:29:10 2014 +0100

    builder: switch sources to .conf files
    
    Introduce and use simple .conf files to configure the sources of indexes
    for virt-builder. The location of these files is in XDG_CONFIG_DIRS /
    XDG_CONFIG_HOME, so it can be easily overridden.
    
    There are three .conf(.in) files shipped with this commit:
    - "test-index.conf.in" (in "test-config"), which points to the
      "test-index" index (used in tests only); the tests are adapted to
      point to the hierarchy containing this .conf
    - "libguestfs.conf.in" (in "test-website"), which points to the local
      "index.asc" (i.e. the offline copy of the libguestfs.org index);
      run(.in) will point to the hierarchy providing this .conf
    - "libguestfs.conf.in" (directly among the other sources), which points
      to the online "index.asc" and it is installed in sysconfdir, along
      with the key of this repository
    
    The tests are adapted, other than to the different way to pick sources,
    to the different output of --list, as "test-index" is not signed.

commit a3f1ac9a2dacd96003688e8125dae7d012d3b942
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Feb 25 17:29:09 2014 +0100

    builder: extract the default key to file
    
    This is basically default_pubkey from sigchecker.ml, just extracted as
    file. Not used right now, but will be in the future.

commit a21da3c8013e2658b41de962c4fb98df3c8896e4
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Feb 25 17:29:08 2014 +0100

    builder: add functions to read XDG_CONFIG_DIRS and XDG_CONFIG_PATH

commit ad38e68c34d3d15fb02901e3fbdd68bfe9887ebf
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Feb 25 17:29:07 2014 +0100

    builder: use Sigchecker.gpgkey_type for the fingerprint
    
    Use Sigchecker.gpgkey_type instead of just string as type in the
    sources list; adapt the listing code (and its expected output) to that.
    
    No behaviour change which eases a bit the addition of new sources with
    other key types.

commit c09f5bbc708bbed772570ba63a706efcedf68cac
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Feb 25 17:29:06 2014 +0100

    builder: allow "no key" as key in Sigchecker
    
    Additional way to distinguish no actual key available for signature
    checking; make sure to not allow signing in such situation.

commit fbe4dad2dedd89d1dae76df0393147398cfa1440
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 27 09:58:47 2014 +0000

    appliance: init: Initialize LVM in the same way as done on physical machines.
    
    Running vgscan appears to be unnecessary.
    
    The -aa option of vgchange activates LVs.
    
    The --sysinit option disables locking.

commit 06011270eca5b4a3149143b8c2c15cd8d9c9c7c0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 26 19:41:07 2014 +0000

    Version 1.25.38.

commit eb81df93d0b01211014132d196d95a88c762a399
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 26 10:10:20 2014 -0500

    appliance: Initialize local variables because gcc cannot track that they are not used uninitialized.

commit b13c22668d956df4cb8e82aaf1d0d3941581b715
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 25 16:08:13 2014 +0000

    appliance: Use supermin >= 5.
    
    This requires the new version of supermin (5.1.0).

commit d353b4a3c84fd828dc8e226a17d0daa69d85683c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 24 20:13:41 2014 +0000

    builder: Add arch= entry for Cirros.
    
    Thanks: Pino Toscano.

commit 9124730df27fa9e0709637dfe9271e01e11466b0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 24 15:43:13 2014 +0000

    builder: Add arch=x86_64 entries.

commit 0f3898b2f5587c9cdd9b26d51dac44b5c3f36055
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Feb 24 15:40:29 2014 +0100

    sysprep: use Mkdtemp to create the temporary directory
    
    Use the safer mkdtemp instead of manually creating a path.

commit 8ed905c7e6a837887a758417bdfd1822b86a214f
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Feb 24 15:08:03 2014 +0100

    builder: split INI C <-> OCaml glue code in own module
    
    Move in an own module the code which calls the C
    virt_builder_parse_index and does the array -> list conversion of the
    result. This way this code can be easily called also in places different
    than Index_parser without the need to copy the types mapping, etc.
    
    Just code motion, no actual behaviour changes.

commit 61323fabafdcab10abaf6b7002e5e1bb38ddbc5e
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Feb 24 11:31:35 2014 +0100

    builder: add a mandatory 'arch' key in index files
    
    Introduce a mandatory arch= key in all the entries of index files, to
    identify which architecture is each. Adapt the long and JSON list
    outputs to print also this new field.
    
    This introduces an incompatibility with index files created with
    virt-builder < 1.26, as they will be rejected until entries will have
    the arch= key added (which is ignored by older virt-builder, so adding
    it will not create backward-compatibility issues).

commit 838a3c997c664d8a28e6563baf7119480c1f0bd3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 21 16:46:14 2014 +0000

    Version 1.25.37.

commit 35e53c0381acc51908211fc6058c552029371e3e
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Feb 21 15:21:08 2014 +0100

    builder: allow Sigchecker to import keys from file
    
    Extend Sigchecker so it allows both fingerprints (to be imported from
    user's keyring, as before) and keys stored in files. To simplify this
    process (and have the fingerprint always around), the key is imported
    on Sigchecker.create time, instead of lazily at the first verification.

commit dd03d38be39fdf195ae3e4943b53921a28cc4536
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Feb 21 14:39:57 2014 +0100

    builder: use a disposable GPG keyring for every Sigchecker
    
    Create a temporary directory and tell gpg to use it as homedir, so
    imported keys do not get into the user's keyring. This also avoid
    importing the default key  when a different one is needed to check the
    signature.
    
    The only exception is when a non-default fingerprint is used: in this
    case, that key is read from the user's keyring, since it is where it is.

commit c79c62a3b0f007d5952a75b1cae3f793bd63132f
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Feb 21 14:34:36 2014 +0100

    mllib: add a binding for mkdtemp
    
    It seems OCaml has no way to safely create a temporary directory, so add
    a new binding to C's mkdtemp which does that.

commit 7794d9a187b47799055f8206fa18608c5247823f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 21 08:31:34 2014 +0000

    builder: Add ScientificLinux 6.5.

commit 7f77f4fb28ca3320fd63c157537a332ef97533ac
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Feb 20 11:37:49 2014 +0100

    mllib: add an hook to cleanup directories on exit
    
    Much similar to unlink_on_exit, but recursively cleaning directories.

commit 4c5a6afc848b556999fee1c0ebd246496cdb023b
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Feb 19 16:40:00 2014 +0100

    builder: accept also '_' in group names

commit 482fefa5d846f63e39e2ef64c419ab32e12e3b05
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 18 17:43:06 2014 +0000

    ppc64: Don't add -no-hpet with the direct backend either.
    
    Related changes in commit 479665e4fc31b94cd9372394bb9c97e8f87b6ab5
    and commit 62cb3a606d4b349d45f2d178945a998a90d1e130.

commit 479665e4fc31b94cd9372394bb9c97e8f87b6ab5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 18 15:12:13 2014 +0000

    ppc64: Disable hpet fragment in libvirt XML.
    
    Related change in commit 62cb3a606d4b349d45f2d178945a998a90d1e130.

commit bb35e725035d3d8e73604a95a8b055cc1073416a
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Feb 18 12:54:23 2014 +0100

    builder: move the XDG path handling in an own file
    
    Just code motion and renaming, no actual behaviour changes.

commit 8b1f1c15f5dfdeea122784d8c4d97e75b335989a
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Feb 18 10:44:49 2014 +0100

    fish: use XDG paths for the config file
    
    Read the configuration file from XDG paths for both global and
    user-local locations, keeping the old paths as fallback.

commit 62cb3a606d4b349d45f2d178945a998a90d1e130
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 17 15:17:27 2014 -0500

    launch: libvirt: Don't include hpet XML fragment on ARM.
    
    See comment and https://bugzilla.redhat.com/show_bug.cgi?id=1066145
    for explanation.

commit 8577aded9851731ae146643631eda0002bac1e20
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Feb 17 16:24:41 2014 +0100

    fish: change order of config files being read
    
    First read the global configuration and then the local one in user's
    HOME, so the latter can really override system settings.

commit 5d2b0d1366fc72a79b842ee4bccaa99a16cab754
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Feb 17 16:21:18 2014 +0100

    fish: small refactor of config reading code
    
    Even though so far there is just one possible setting to read, isolate
    in an own function the code to parse a configuration file and read the
    settings out of it.
    
    Now there's a new config_t handle used every time, but since config_read
    would reset an handle completely, there is no behaviour change.

commit 6b71b81a5f4b1bfbf9fb4efa576fe7e7ae2368a8
Author: Or Goshen <oberonc@gmail.com>
Date:   Mon Feb 17 14:51:56 2014 +0000

    appliance: Use configurable separator character for LIBGUESTFS_PATH.
    
    On Windows, the path separator character will be ';' instead.

commit 22f6c79b32ab281e1f025f6b20fbf1b4407ef08a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 17 10:08:38 2014 +0000

    Version 1.25.36.

commit 360abeebda97e9940a4045a331ce181d1a370719
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 17 09:13:42 2014 +0000

    builder: Fix dependencies which are not generated correctly by automake.
    
    See the error messages here:
    https://www.redhat.com/archives/libguestfs/2014-February/msg00148.html
    
    This fixes commit e2cc8b6465a400024fe2f0fcce0d0ff5f7e7719c.

commit 8f767f4caadbd5e964e4136a8361bcb32f2f63ea
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Feb 16 22:34:56 2014 +0000

    Version 1.25.35.

commit b987be513a919e91b79a045095f9b84db625165f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Feb 16 19:20:40 2014 +0000

    FAQ: Remove obsolete entry about libguestfs <= 1.13 and slow writes.
    
    Long since not a problem.

commit 728ba9b33fa6002de7da72629ff59a7ea99807b5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Feb 16 19:09:33 2014 +0000

    FAQ: Add several common problems with opening disk images.

commit c16d5d3de49e3cddce07f161a3316873304adc9c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Feb 16 13:30:25 2014 +0000

    FAQ: Create new section about problems opening disk images.
    
    Move the stuff about encoding problems here, because these are not
    really common problems.

commit 6594e88d80cbd49f798e393cad207d989adf7bc9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Feb 16 19:15:29 2014 +0000

    FAQ: Remove old RHEL 6.5 section.

commit 6cc521dc4533d10659214cc660f31239de9e28e7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 15 20:27:12 2014 +0000

    generator: Sort most output.
    
    Look for use of external_functions and fish_functions and replace with
    use of external_functions_sorted and fish_functions_sorted where
    possible.  This ensures that the output of the generator is sorted as
    far as possible.
    
    I also checked for uses of internal_functions and documented_functions
    but those are not used.  The *_sorted versions are always used
    instead.

commit bbfb9f9480baf3bbf62c6a07252bad9030bdc4a1
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Fri Feb 14 09:09:47 2014 +0100

    podwrapper: Recognize git-style dates in ChangeLog

commit bf8d75590c3924c3ebe343bf354e93ec7e84ccf9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 13 21:45:47 2014 +0000

    test: Use = instead of == for testing string equality in bash script.
    
    Found by make syntax-check.

commit d56b8bcb2c6509b5644fb4d79abb3a4211191388
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 13 21:45:31 2014 +0000

    Remove some unused header files.
    
    Found by make syntax-check.

commit f5de589966ae7f22a83d6ef6be6140ae68551a7b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 13 21:41:12 2014 +0000

    src/drives.c: Remove useless if-before-free.
    
    Found by make syntax-check.

commit 9018356a67eb644126814e4ef41555c56e884a79
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 13 21:39:50 2014 +0000

    Use bindtextdomain in some programs where it was missing.
    
    Found by make syntax-check.

commit e3d23cccf4099680a4335db97fe2ccf2d3c950f4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 13 21:38:42 2014 +0000

    builder: Suppress warning about unused yyunput.
    
      CC       virt_index_validate-index-validate.o
    index-scan.c:1270:17: warning: 'yyunput' defined but not used [-Wunused-function]
         static void yyunput (int c, register char * yy_bp )
                     ^
      CCLD     virt-index-validate
    
    By using %option nounput we can prevent this from being generated in
    the first place.

commit 9df9c871477d31ebd12c851069ba29ace352c584
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 13 21:07:40 2014 +0000

    configure: Move ocaml-gettext writing boilerplate to separate m4 module.
    
    This is just code motion.
    
    NOTE that after this commit you have to do:
    
      aclocal -I m4
      autoconf
    
    as 'make' may not do this automatically.

commit e4fe09c5ae28ee34d87bceecf58f72cc43af6249
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 13 17:48:06 2014 +0000

    builder: pxzcat: Fix char * signedness warning.

commit f8bac1329e845734333bf9ab13909a5364a1fa53
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 13 17:47:26 2014 +0000

    mllib/uri-c.c: Remove unused variable.

commit 72713825c44b0aa2587a96cf9e1bf089e3227660
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 13 17:39:58 2014 +0000

    gobject: Remove some more warnings from session.c code.

commit e74c957a2b2a293290b54e23fb5a7b16f845917b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 13 15:24:57 2014 +0000

    gobject: Clean up some warnings about unused variables.

commit 23d6d53633fa9cd1c5cd03fbed3aa954d5da2661
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 13 15:01:51 2014 +0000

    gobject: Don't direct error messages to /dev/null.
    
    We might want to see them.

commit 99ce50e0a0f9aa8b2c7459cc38e7d4e8760b19d2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 13 14:34:56 2014 +0000

    gobject: Use spaces between function name and call parameters.
    
    This is just a whitespace change.
    
    This was done by running the following command and then fixing a
    couple of places where it got it wrong:
    
    perl -pi.bak -e 'unless (m/#define/) { s/([a-zA-Z0-9])\(/$1 (/g }' \
      generator/gobject.ml

commit cd9f7411741290add87910d531a9cd8685b3be91
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 13 13:37:55 2014 +0000

    fish/uri: Initialize some variables to avoid a warning.
    
    The warning only appears when we set CFLAGS to be the same as used by
    RPM, which you can do by setting:
    
      CFLAGS="$(rpm --eval '%{__global_cflags}')"
    
    before running ./configure.
    
    FWIW the current value of that RPM expression (in Fedora 20) is:
    
      -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector-strong --param=ssp-buffer-size=4 -grecord-gcc-switches
    
    It is not clear which option precisely enables the warning.

commit 2954541fdd6bd419c43e861c187f4f384996b54d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 13 13:16:39 2014 +0000

    java: Avoid warnings in the tests and examples.
    
    Avoid warnings about missing serial version, and fix a warning about
    raw types.

commit ab2df2e6598d421067d600f89a3d225162424d9b
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Feb 13 14:52:50 2014 +0100

    mllib: hostname: on Debian replace it also in /etc/hosts (RHBZ#953907).
    
    In Debian/Ubuntu systems, read the previous hostname from /etc/hostname
    before replacing it, and replace it in /etc/hosts with the new hostname.

commit 4ca4eef0cc6877a595c3d71c09d3dc18a803b638
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Feb 13 10:57:31 2014 +0100

    sysprep: remove RH subscription manager files
    
    Add a new operation for it, which should do what
    `subscription-manager clean` does.
    
    Part of RHBZ#1063374.

commit f78877c77e502ac829ccbc11207b807bb1688420
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Feb 13 10:50:15 2014 +0100

    sysprep: remove RH subscription manager log files
    
    Part of RHBZ#1063374.

commit dcd5edd5d40757acd5515b57113a34555dfb52e3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 12 22:47:53 2014 +0000

    Version 1.25.34.

commit 3d4cc3cf576c5bf6105f5693eda87e5c6f775f5e
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Feb 12 15:12:19 2014 +0100

    mllib: hostname: add a newline in /etc/hostname
    
    /etc/hostname usually has an ending newline, so add it when changing it.

commit 82a4a8f02c5706979d961ad6c4ac767a37a3a7c9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 12 09:32:08 2014 +0000

    FAQ: Another common problem is permission denied errors when running as root.

commit 37aead588efc258472ebb923abb7804257d5ce0d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 12 09:30:39 2014 +0000

    FAQ: Add another common Ubuntu appliance problem.

commit d70ceb4cbea165c960710576efac5a5716055486
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 11 20:08:43 2014 +0000

    list-filesystems: Do not segfault if guestfs_btrfs_subvolume_list returns an error (RHBZ#1064008).
    
    If calling guestfs_list_filesystems with a disk image containing a
    corrupt btrfs volume, the library would segfault.  There was a missing
    check for a NULL return from guestfs_btrfs_subvolume_list.
    
    This adds a check, returning the real error up through the stack and
    out of guestfs_list_filesystems.
    
    This is potentially a denial of service if processing disk images from
    untrusted sources, but is not exploitable.
    
    Thanks: Jeff Bastian for reporting the bug.

commit 76e3e15d031df77db71b11ac1c40199eff80fa4d
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Feb 11 12:52:10 2014 +0100

    builder: do a copy when downloading local files
    
    Instead of spawning curl even to "download" file:// URIs, just copy
    them.

commit ba3569704cf5f381c618b6b07c8b001bac88e18a
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Feb 11 12:39:56 2014 +0100

    builder: prepare for different per-protocol download actions
    
    Small refactor of Downloader.download_to to allow different download
    actions depending on the protocol of the URI (which is now parsed).
    
    No actual behaviour changes, just mostly code motion.

commit c66cec6ffac2af400487b7fb4ff437eddc6e7aa7
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Feb 11 10:40:31 2014 +0100

    builder: isolate C libraries in an own OCAMLCLIBS
    
    Just moving stuff within Makefile.am, no functional changes.

commit a948389ce9c76bf7e8997bb27f3daac06cb20c50
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Feb 10 11:00:09 2014 +0100

    actions/part_set_gpt_type: set type of "guid" parameter as "GUID" (RHBZ#1008417).
    
    Switch the type of the "guid" parameter from "String" to "GUID"; this
    adds the validation of the GUID as such, rejecting straight away invalid
    GUIDs which otherwise could be handled badly by low-level tools (such as
    sgdisk).
    
    Add a couple of easy tests (taken from RHBZ#1008417) to
    part_set_gpt_type about this.

commit 775cad63a3f2156b38e7d8360b88ed11615779e8
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Feb 6 20:02:51 2014 +0100

    generator: generate code for parameter validation
    
    Implemented only in the C output, since every binding uses it anyway,
    and just for the "GUID" type (since its format is well-known).

commit b10dd601fb07eb3d8bf76b5f9fcac1c7fe59d4d5
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Feb 6 17:43:04 2014 +0100

    generator: add a GUID parameter type
    
    At the moment it is basically the change as String, and it is mapped as
    if it was such.

commit beef77403cd9d634b6ff6daa9f33d292e2d320a7
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Feb 6 15:57:09 2014 +0100

    utils: add a function to validate a GUID string

commit ed912a54d6d356e3c22617fd20e3595dd81a7b50
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 5 19:39:28 2014 +0000

    libguestfs-make-fixed-appliance: All supported versions of libguestfs should work.
    
    We're not supporting anything < 1.20 now.

commit 758d021b41bd23700ec6ee00b8c2cdd94d894fe3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 5 15:18:49 2014 +0000

    Version 1.25.33.

commit 798b539a1f95465391f5ab8781ada1e5e63c4355
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Feb 5 11:42:17 2014 +0100

    appliance/init: provide a symlink /var/lock
    
    Provide /var/lock as symlink to /run/lock, as it might be used by
    applications.

commit 59eb9bff87895a2cd779890de73652cb2a0ce503
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Feb 4 15:49:13 2014 +0100

    resize: preserve GPT partition names (RHBZ#1060404).
    
    Save the partition names/labels of the source partitions, and restore
    them after the partition copy.

commit 820b87016794116c783bd224f2e776cfdf65108e
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Feb 4 14:48:14 2014 +0100

    New API: part-get-name (RHBZ#593511).
    
    Counterpart of part-set-name, it uses sgdisk (hence needs the "gdisk"
    feature) to query for the label/name of a partition in a GPT layout.

commit 78c21ce912a9c251ade8e35b63e82e97c96236cd
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Feb 4 13:49:37 2014 +0100

    daemon: parted: refactor sgdisk info parsing code
    
    Isolate in an own function the code that runs sgdisk and parse a field
    of it (using an extraction function passed as parameter), using it for
    the GUID type.
    
    This is just code motion, no actual behaviour changes.

commit 170b64337de32b930b992a0cd584745fb22569ad
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 4 13:27:34 2014 +0000

    resize: Try to remove a few more _ -> .. cases.
    
    This allows the compiler to catch missing cases more effectively,
    especially if we update the types with more cases in future.

commit ef7ac043a640c0dc82260e97fb7ce1f438f7ee2d
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Feb 4 13:32:28 2014 +0100

    resize: properly restore GPT partition types
    
    If there is a GPT partition layout, then what should be read and
    restored for each partition is the GPT type and not the MBR ID.
    
    Related to RHBZ#1060404.

commit eab810f7786d7d3a500a912c74ea85468825f0f8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 4 08:50:43 2014 +0000

    Version 1.25.32.

commit d5b540153fa91230524133c09c879199b8e2d902
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 3 13:56:13 2014 +0000

    Remove bogus license file from daemon subdirectory.
    
    It was left over from when the daemon was a separate autoconf
    directory, and in any case the daemon has never been GPLv3 (it is
    GPLv2+).

commit d93e3c50eb3062263792b0be5022abe8504604d9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 3 09:08:12 2014 +0100

    fish: Additional GUESTFISH_* environment variables to control the prompt.
    
    This adds:
    
     - GUESTFISH_INIT
     - GUESTFISH_OUTPUT
     - GUESTFISH_RESTORE
    
    which along with existing GUESTFISH_PS1 allow you to fine control the
    colour of the output.

commit bed8a168c0ed76e784adcc046256432f615e3314
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Jan 30 17:06:42 2014 +0100

    builder: remove unused variables
    
    Leftovers of the list_entries_short+list_entries_long split done in
    commit 91aae893c70b3877b31803800ba77836fd7a45e8.

commit 07ef60c63f5fd635306d199622d36f9089c75ecc
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Jan 30 17:05:34 2014 +0100

    builder: output translated notes
    
    Output all the translations available for the notes in the "verbose"
    output and the JSON output, while trying to match the system langauge in
    the "show notes" output.
    
    The JSON output is slightly changed to handle translations, with the
    "untranslated" notes being matched as "C". The version is not bumped
    though, since there have been no stable releases with the former output
    yet.

commit 49014f81f350484da725f5ee2bc62bb24268a334
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 29 14:50:55 2014 +0000

    sysprep: Deprecate --selinux-relabel in favour of --autorelabel.
    
    virt-builder added a --selinux-relabel option with a slightly
    different meaning.
    
    This commit keeps the old --selinux-relabel / --no-selinux-relabel
    options in virt-sysprep, but deprecates them and replaces them with
    --autorelabel and --no-autorelabel.

commit fc6d3e6a9a920446fecc347a0521a1e3eda183d8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 29 14:46:05 2014 +0000

    sysprep: Add a reference to virt-builder from the manual page.
    
    The whole "COPYING AND CLONING" section really needs to be overhauled
    too, but first we need to make virt-builder work properly for
    customizing templates.

commit 5db1a28461cc42f09532e8b98150e716040d3aa0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 29 14:38:50 2014 +0000

    sysprep: Add --scrub option.
    
    This works like the option in virt-builder with the same name.

commit 2595fa5069383522741ffea3afbe99253e3899b2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 29 14:03:45 2014 +0000

    builder: Move Perl_edit module into common code.
    
    There is no functional change.

commit c841d08d7084db69e81614d54423686cf0566ad6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 29 09:31:24 2014 +0000

    appliance: Create checksum file with mode 0644 instead of 0755.
    
    Initial commit 4beb2844091310012b5e28971707397d1d51d833 used mode 0755
    for no reason.  It seems to have been a mistake.

commit f0f95bd0385874de976e58875aefc1279814d0bc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 29 08:45:19 2014 +0000

    perl: Data::Dumper and String::ShellQuote modules are no longer required.
    
    They used to be used by old Perl virt-make-fs.  Nothing else uses
    them.
    
    This updates commit d3512deb6728dffbb3a958c7168b81dbde56d748.

commit 32cbd7ca0d90d0013f92f64c3c5755ebed2fb960
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 29 08:19:32 2014 +0000

    make-fs: Remove warning from man page about lone --partition argument.
    
    C's getopt_long has no problem with this.

commit a8a655a85900297f0ddb3d599a09b80b9be8581a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 29 08:18:05 2014 +0000

    make-fs: Ensure --partition (on its own) creates an MBR partition.
    
    This fixes commit d3512deb6728dffbb3a958c7168b81dbde56d748.

commit 90d33787783c8bf383003ca99ba58068b2935a6c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 29 08:11:37 2014 +0000

    make-fs: Refactor debug stats code.
    
    Code motion, no functional change.

commit 5bf8c81d7d5bf438b13f3866750362d002847129
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 29 08:08:33 2014 +0000

    make-fs: Use an anonymous pipe instead of a named pipe.
    
    The previous translation from Perl slavishly followed the Perl code a
    bit too much and used a named pipe to communicate between the
    uncompressing subprocess and libguestfs tar-in.  From C we can use an
    anonymous pipe instead.
    
    This updates commit d3512deb6728dffbb3a958c7168b81dbde56d748.

commit c86fcc0fd4dde908bce41f9a5ca90b5fcd89f7e9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 29 08:00:55 2014 +0000

    make-fs: Make check-valgrind do something.

commit f5bc913434e5f895c52037231e1b018c57f01949
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 29 08:00:30 2014 +0000

    make-fs: Run virt-make-fs in test from builddir, not srcdir.

commit 59fce974e29110ca2831c22191456af0cc4b8f8f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 28 22:17:12 2014 +0000

    pod: Remove stray +x (executable) mode on various POD files.
    
    find -name '*.pod' -perm /0111 -exec chmod -x {} \;

commit 1771e1f2b2dc4b06896c13adf919b0ddb39e47c9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 28 22:10:25 2014 +0000

    Version 1.25.31.

commit 233d5410e5539c638ea186b81d43cf114c2ce217
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 28 21:56:18 2014 +0000

    sysprep: Add script4.sh (test script) to EXTRA_DIST.
    
    This fixes commit ce9d4d335b0c13f3ea75048666ccf5b63de29f8e.

commit dc91bf723174c486c3568d0098cf990482ef97fa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 28 21:01:48 2014 +0000

    Version 1.25.30.

commit 642cf4c5dc9af340173ff9aee2c432d6e69f480a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 28 20:26:42 2014 +0000

    tests: Test --label and other options in virt-make-fs.

commit d3512deb6728dffbb3a958c7168b81dbde56d748
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 27 13:29:54 2014 +0000

    Rewrite virt-make-fs in C (originally Perl).
    
    It should be very compatible with the Perl version.

commit 40512c66af562886311b5eff50a505b95c5fbadd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 28 18:53:25 2014 +0000

    daemon: Always pass -F option to mkfs.ntfs.
    
    Otherwise it moans about:
    
      mkfs: ntfs: /dev/sda: /dev/sda is entire device, not just one partition.
      Refusing to make a filesystem here!
    
    This has been happening for a while, so I don't know why we didn't
    notice it before.  It even happens on RHEL 6.
    
    A simple reproducer is:
    
      virt-make-fs -t ntfs any-tarball.tar.gz test.img

commit 9015d5ac1491a7a1fa662deab007f3fee7e4e53e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 28 15:08:16 2014 +0000

    virt-make-fs: Use disk-create API instead of calling qemu-img create.
    
    Strictly speaking this reduces the number of formats that virt-make-fs
    can output to, but it's likely that no one cares and if they do we can
    add new formats in future.

commit a594b7f90a682e2a9327b142138edb76ad8ba8ff
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 28 15:07:33 2014 +0000

    sparsify: Use new disk-create API instead of calling qemu-img.
    
    disk-create doesn't support the lazy_refcounts option.

commit 40261e4adcdef7b209954d003e2a1b0774e800b0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 28 15:07:26 2014 +0000

    rescue: Note that we're not using add-drive-scratch here, and maybe we should be.

commit f02fddc26bedd28d7b7e35e4c3a2e86d78c7b9ae
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 28 15:06:39 2014 +0000

    tests: Update miscellaneous tests to use disk-create API.
    
    Instead of calling out to qemu-img / truncate.

commit bd12e784e78ec041b3c984620168269d716312d3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 28 15:05:58 2014 +0000

    builder: Use disk-create API instead of calling qemu-img create.

commit d60e6a23a6c8996a23336a33d120fcbee56010f7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 28 15:04:59 2014 +0000

    examples: Update various examples to use new disk-create API.

commit 2794eac7390f8d7eb7b76cb0c374b4b2266d98a9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 28 15:04:09 2014 +0000

    fish: Use disk-create API to implement guestfish 'alloc' and 'sparse' commands.

commit 1e5eb0aebb80c2a37dfca018f589f0d84ee6e6ea
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 28 15:03:09 2014 +0000

    lib: Use disk-create API instead of qemu-img/truncate inside the library.

commit 588af1953e5f7ab74009b9175cc5d3efb8bb651a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 28 13:09:06 2014 +0000

    New API: disk-create for creating blank disks.
    
    This is a wrapper around either 'qemu-img create' or calls to open,
    truncate and posix_fallocate which litter and complicate existing
    code.

commit 65fc841ea68f0739ad1cd40c213b55200df6ceb8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 28 13:08:38 2014 +0000

    src/Makefile.am: Reorder SOURCES into alphabetical order.

commit e3f72805d108c601280b889692c47d7d825e6079
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 27 21:58:42 2014 +0000

    run: Actually use timeout --foreground option (RHBZ#1025269).
    
    The following commit managed to not actually add the --foreground
    option to the timeout command, just test for it.  Add it this time.
    
      commit 681488877456b83f039dc518861f29ab4e1857f0
      Author: Richard W.M. Jones <rjones@redhat.com>
      Date:   Thu Dec 19 08:21:53 2013 +0000
    
        run: Use timeout --foreground option.
    
        If timeout doesn't have this option (RHEL 6) don't use timeout at all.
    
        Attempt to fix RHBZ#1025269.

commit d9cd2dc9b0e847fda3831c9ff13def616ca5043d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 27 21:20:32 2014 +0000

    daemon: Add a note about how 'mount --rbind' doesn't work.

commit 9df50877f8b61106248acd2375d011acc209c6b5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 27 20:22:23 2014 +0000

    daemon: If /selinux exists in the guest, bind-mount /sys/fs/selinux to there.
    
    Commit 72afcf450a78b7e58f65b4a7aaf94d71cd25fca5 was partially
    incorrect.  If the guest userspace is expecting /selinux to exist,
    then we should bind-mount /sys/fs/selinux from the appliance kernel
    there.

commit ce9d4d335b0c13f3ea75048666ccf5b63de29f8e
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jan 28 15:04:38 2014 +0100

    builder, sysprep: initialise the random generator
    
    virt-builder and virt-sysprep may make use of
    Common_utils.string_random8 (which uses Random.int) for constructing
    temporary paths; not initialising the random generator means that every
    invocation will reuse the same name used previously (!).
    Thus just call Random.self_init, just like virt-sparsify already does.
    
    Expand the test-virt-sysprep-script.sh test to ensure that virt-sysprep
    is not affected again by this issue.

commit 95f8144cb605b70d4cb9ab3ca0976c1e1428b3d0
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Jan 27 17:25:55 2014 +0100

    tests/regressions: remove C part of rhbz1044014
    
    All it did was checking for a libvirt version, which is what
    libvirt-is-version now does; hence remove the C part, and use guestfish,
    ignoring the launch failure (as the C test did).

commit 4310f8f1753dc923ba5012f243014f54709f30fb
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Jan 27 16:33:22 2014 +0100

    tests/disks: skip test-qemu-drive-libvirt.sh if libvirt is < 1.1.3
    
    This test relies on the <test:runstate> element in the domain XML, which
    has been introduced in libvirt 1.1.3.

commit c01fb37839d28678dd8f5e33ec7fa376b03e8d71
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Jan 27 16:31:32 2014 +0100

    tests: add a a simple libvirt-is-version test tool
    
    libvirt-is-version returns successfully in case the available version of
    libvirt is greater or equal than the specified major/minor/release
    values.

commit f66d6a85b633f0e79d14c311db4020e22709117a
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Jan 27 14:25:47 2014 +0100

    tests/mountable: add missing space in test-mountable-inspect.sh
    
    No actual behaviour, other than getting rid of a bash warning.

commit de7a8336cd7c8806231e22e12c29b93463308065
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 25 12:04:37 2014 +0000

    Version 1.25.29.

commit 4e18712562fe69cae8901e9534dbbcf0d4d87192
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 25 11:56:40 2014 +0000

    tests/disks/test-qemu-drive-libvirt: Include test data.
    
    This was inadvertantly deleted.
    
    This fixes commit 01d27033bdd12974f850ff7a8e5de8f6b790379d.

commit 24e61492cc2db3aeb2943da84e4c07acfbcce2a0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 25 10:59:03 2014 +0000

    Version 1.25.28.

commit 080300dfec1dd603da2f7d53e72dd3e056317fb8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 24 19:43:05 2014 +0000

    builder: Add documentation for enabling Puppet (agent) in a guest.

commit 90e23b4e566f88595ac697b45d2531de851be6df
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 24 19:38:26 2014 +0000

    builder: Add --selinux-relabel option to perform SELinux relabelling.
    
    This adds the --selinux-relabel option which enables selinux in the
    appliance and runs:
    
      if load_policy && fixfiles restore; then
        rm -f /.autorelabel
      else
        touch /.autorelabel
      fi
    
    at the end of installation.
    
    When possible this fixes SELinux labels in the guest and makes the
    autorelabel step unnecessary.
    
    Notes:
    
     - The previous commit is required so that load_policy works.
    
     - During the build, SELinux is enabled but no policy is loaded.  This
       works because SELinux is in permissive mode.
    
     - This flag does not work if the appliance kernel and the guest have
       greatly differing versions, eg. a RHEL 6 guest with a Fedora 20
       appliance.  This is because SELinux changes the policy format and
       breaks backwards compatibility.  You would see errors like this:
    
       libsepol.policydb_write: policy version 15 cannot support MLS
       libsepol.policydb_to_image: could not compute policy length
       libsepol.policydb_to_image: could not create policy image
       SELinux:  Could not downgrade policy file /etc/selinux/targeted/policy/policy.24, searching for an older version.
       SELinux:  Could not open policy file <= /etc/selinux/targeted/policy/policy.24:  No such file or directory
    
       These errors are ignored (they go to the log file) and relabelling
       is done at boot instead.
    
     - It's not clear if loading guest policy is safe.  You should trust
       the virt-builder templates and to use libguestfs confinement for
       additional protection.

commit ab33653ef312e18042be08854aa0dec2c7254fc2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 24 19:36:33 2014 +0000

    daemon: Bind-mount /sys/fs/selinux into sysroot when running commands.
    
    Even though we are already bind-mounting /sys, it is necessary to also
    bind-mount /sys/fs/selinux in order for SELinux commands (in
    particular, 'load_policy') to work.
    
    This fixes/reverts commit 7367729ec7a5d016878dd00b32cce45cec372931.

commit 0e2489974b91e4728d544fe2aa08c2a1c9deb365
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 24 10:20:14 2014 +0000

    fuse: In mount-local-run, test if root filesystem has been mounted (RHBZ#1057504).
    
    It is never normally valid to use the mount-local* APIs when you
    haven't mounted some filesystems in the libguestfs namespace.
    
    If you try it, it results in some odd errors.  The mount-local-run
    call is successful, but subsequent operations fail:
    
    $ mkdir -p /tmp/mnt
    $ guestfish -x -N fs mount-local /tmp/mnt : mount-local-run
    libguestfs: error: lstat: lstat_stub: you must call 'mount' first to mount the root filesystem
    libguestfs: error: lstat: lstat_stub: you must call 'mount' first to mount the root filesystem
    
    With this commit, the mount-local-run call gives an error:
    
    libguestfs: error: you must call 'guestfs_mount' first to mount a filesystem on '/'.
    Note: '/tmp/mnt' is still mounted.  Use 'guestunmount /tmp/mnt' to clean up.
    
    The error is implemented by calling guestfs_exists (g, "/") which has
    the side effect of running the NEED_ROOT macro in the daemon.  (There
    is no simple equivalent of NEED_ROOT on the library side.)

commit 01d27033bdd12974f850ff7a8e5de8f6b790379d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 23 21:49:16 2014 +0000

    lib, fish: Handle Gluster, NBD, iSCSI and Sheepdog paths properly.
    
    This fixes the handling of paths for the protocols named above, with
    respect to leading '/' (or not) on the volume/export name.
    
    See previous commits which did the same fixes for Ceph:
    commit 53a3ff9c005fd69e773fdb18461a635c2502df1b
    commit 992a6b297023711862229aabe4e23b6a1c94c1cc

commit 870f076bddbc540b793670990dc504ef36fb2f41
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 23 19:35:23 2014 +0000

    Version 1.25.27.

commit 3331db84bc0e720abec0dfbc82bba15ccae00b6e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 23 14:14:26 2014 +0000

    resize: Don't truncate libguestfs error messages.
    
    If we rely on OCaml's internal exception printing, then it will
    truncate error messages like this:
    
      Fatal error: exception Guestfs.Error("could not create appliance
      through libvirt.
    
      Try running qemu directly without libvirt using this environment
      variable: export LIBGUESTFS_BACKEND=direct
    
      Original error from libvirt: unable to set security context
      'unconfined_u:object_r:svi
    note the truncation here ^^^^^^^
    
    Instead of using the internal exception printing, wrap the whole
    program in a 'main ()' function and add an exception handler.
    
    This large change is non-functional apart from the addition of the
    exception handlers at the end.

commit e8c10670213076b10bad2d0aac181637acd150b0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 23 13:31:11 2014 +0000

    launch: direct: Stop using deprecated -no-kvm-pit-reinjection if qemu is new enough (RHBZ#1053847).

commit 1d6ba35e6f57b3424b01bb0fe0debe57808b5abd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 23 10:48:57 2014 +0000

    tests: Add a test of libvirt domain XML to qemu command line (RHBZ#1026688).
    
    This tests that libvirt domain XML (ie. guestfish -d option) is parsed
    correctly and results in the correct qemu command line when using the
    direct backend.
    
    This is a good end-to-end test of various layers.

commit 1ed0ce3ef8877012d0909c5ae2ef5c29c61cf123
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 23 11:40:27 2014 +0000

    libvirt domain: Allow network drives with no <source name="..."> attr.
    
    This is valid for some network drives, for example:
    
      <source protocol='nbd'>
        <host name='foo' port='1234'/>
      </source>
    
    We pass an empty string as path to the guestfs_add_drive_opts API in
    this case.

commit 1d2e74414b04d69ed48984a7a4e809be502c7999
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 23 11:31:40 2014 +0000

    libvirt-domain: Remove unnecessary and wrongly indented parens.

commit 58ada01783ccac13e4ad86b71210d44e7084b8a5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 23 11:05:01 2014 +0000

    libvirt domain: Allow network drives with no <host> elements.
    
    This is valid for some network drives:
    
    <source protocol='rbd' name='abc-def/ghi-jkl'/>
    
    instead of this:
    
    <source protocol='rbd' name='abc-def/ghi-jkl'>
      <host name='foo' port='1234'/>
    </source>
    
    Allow both forms.

commit 992a6b297023711862229aabe4e23b6a1c94c1cc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 23 08:30:12 2014 +0000

    fish: Handle Ceph/rbd URIs and convert them to paths properly (RHBZ#1026688).
    
    The path at the API level (for guestfs_add_drive_opts) is:
    
      pool/disk
    
    The URI syntax is either rbd:///pool/disk or rbd://server:port/pool/disk.
    Because of the way URI parsing works we may need to remove a leading
    '/' character before passing the path down to the API.

commit 53a3ff9c005fd69e773fdb18461a635c2502df1b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 23 08:28:09 2014 +0000

    lib: Handle Ceph/rbd paths properly (RHBZ#1026688).
    
    The path at the protocol level is:
    
      pool/disk
    
    (with no leading '/' character).  This is now what you have to pass to
    guestfs_add_drive_opts.
    
    Also Ceph can be called with no explicit servers (it uses the contents
    of /etc/ceph/ceph.conf instead).  So allow zero servers to be used.

commit b93a1d50ad1dfe44e6ad2434dbc3f0c71fda7141
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 23 08:27:30 2014 +0000

    fish/uri: Tidy up error messages.

commit b7cd63fc1dc031914e110a46de3faa431387d959
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Jan 23 15:36:15 2014 +0100

    builder: read all the available notes from the index
    
    Switch the internal storage for the notes of each entry to a sorted list
    with all the subkeys available (which should represent the translations
    to various languages).
    The current outputs are the same (i.e. still the untranslated notes), so
    this is just internal refactoring/preparation.

commit 958e84d69960faf5b321bdec92283a0b37abd858
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Jan 22 23:13:24 2014 +0100

    builder: small code simplification
    
    No actual behaviour changes, just remove extra match statements.

commit 2541563a18309f0adf4c2e48bd16ccc39d4b76b9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 22 18:01:17 2014 +0000

    Version 1.25.26.

commit 629cb87b6d3cdf1d2d80754c5cd4241c7781bcf4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 22 17:13:00 2014 +0000

    tests/regressions: Don't include binaries in EXTRA_DIST.
    
    Because EXTRA_DIST simply used $(TESTS), and because the list of tests
    includes C binaries, these were included in the tarball (actually not
    binaries, but libtool scripts, but it's still undesirable).

commit 7d8d065feee46337a2c4a3b4736f57878de84928
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 22 17:00:43 2014 +0000

    tests: Add a regression test for RHBZ#1054761.

commit aa2ca8ba703254267939dfcd8d276cbd6f651858
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 22 17:10:09 2014 +0000

    daemon: lvm2: Ignore "unknown device" output when a PV is missing (RHBZ#1054761).

commit 49c3d819c184f71ac98cd436fb9435f5b3bbddda
Author: Colin Walters <walters@verbum.org>
Date:   Wed Jan 22 15:45:08 2014 +0000

    generator/set-uuid: Fix two typos in documentation

commit 9e4357ca54282c1ab053dd5a8ebd64a323830cf4
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Jan 22 15:34:22 2014 +0100

    builder: fix small regression in subkey parsing
    
    Introduced in 5cbdf35d651b6c730d62d9af4876039faa122efc, it caused the
    first character of the value to be skipped if the key has a subkey.

commit 13bca32e4ec9213e69ea55e837dea846719fb67e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 22 13:10:08 2014 +0000

    sparsify: Prevent overwriting block or char output devices (RHBZ#1056290).
    
    virt-sparsify doesn't work if the output is a block device, and cannot
    possibly work if the output is a char device.  Currently if you try
    this it actually overwrites (deletes) the output device which is not
    exactly desirable.  Therefore throw an error and exit.

commit c6ec6cde27ef87480b9b38f13b08b39eb1400f4b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 22 12:55:52 2014 +0000

    builder: Add -monitor none to example command line.

commit 873051e108eddfdd79205d0c8daf2654ad40e5d6
Author: Dan Lipsitt <danlipsitt@gmail.com>
Date:   Tue Jan 21 11:26:27 2014 -0800

    remove non-portable chmod
    
    'chmod --reference' is not available on Mac OS X.
    
    Keeping the original file and directing edits into it preserves permissions and removes the need to chmod.
    
    (Tried 'sed -i' for inplace editing but unfortunately it isn't portable either.)

commit ebb04b64a2c630089f7d6e8261f4cb2b93e12724
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 21 18:37:26 2014 +0000

    Version 1.25.25.

commit 5cbdf35d651b6c730d62d9af4876039faa122efc
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jan 21 18:52:42 2014 +0100

    builder: proper consider subkeys in index files
    
    The index files already allowed the 'key[subkey]=...' syntax for keys,
    but considering such string as whole key. Proper split the parsing and
    the handling of the subkeys, so they can be searched a bit easier.
    
    This causes no actual behaviour changes, it is just internal
    micro-refactoring. (Thanks Rich for the hints, too.)

commit 20a4bfde9628cfeb8bea441cab7dcc94843b34e3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 21 17:15:11 2014 +0000

    builder: Add tip for how to relabel SELinux guest at build time.
    
    Thanks: purpleidea/James.

commit 88094f3da44eb9871d67a1a015362b7ae20e00dd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 21 17:13:35 2014 +0000

    builder: Clearer note in man page about SELinux and where /.autorelabel file comes from.
    
    It's not added by virt-builder.  It is present in the templates (added
    by virt-sysprep in fact).

commit be5fd2fd349af5e306c7e139a23548c351701015
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 21 17:13:18 2014 +0000

    builder: Add note about cloning to man page.

commit 3e3e7cf02990ba00e6c9b622248da26e2c790af2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 21 11:46:17 2014 +0000

    sysprep: Replace flags list with side_effects object.
    
    Previously callbacks would return a list of flags, such as []
    or [`Created_files].
    
    In this commit we introduce two new objects, filesystem_side_effects
    and device_side_effects (the latter is not used yet).
    
    The callbacks that create files now need to call
    
      side_effects#created_file ()
    
    instead of returning flags.
    
    There is no functional change in this patch.

commit 11b4fc88fb6c567a7384fc36ecef526ed71f6f42
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 21 11:16:21 2014 +0000

    sysprep: Update comments.

commit 4505f61979a9737da53cdad419ae6d22538780d5
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jan 21 17:54:23 2014 +0100

    builder: allow more empty lines in index files
    
    Improve the index grammar to allow more than one empty line between
    sections, and to allow any number of empty lines at the end of the file
    (after the last section).

commit e2cc8b6465a400024fe2f0fcce0d0ff5f7e7719c
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jan 21 10:54:19 2014 +0100

    builder: add index-struct.h as dependency for index-parser-c.c
    
    Just like with index-parse.h, also index-struct.h is a dependency of
    index-parser-c.c which automake cannot generate correctly.
    Thus, add it manually.

commit 10b20b79384e2446277b3196f12a9736af7ff13b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 21 11:07:03 2014 +0000

    test-tool: Rearrange output into alphabetical order.

commit ffe1eaa11c68009ab8ac43317203a69489282f6a
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Jan 20 16:04:48 2014 +0100

    Revert "Minimum libvirt version is >= 1.1.1."
    
    0.10.2+ is still available on some recent-ish stable distros (like
    Fedora 19, Ubuntu 13.04), and should work fine for guestfs.
    
    This reverts commit 6b3e05e8da490fc11a2f07f0cc9022216a744ac7.

commit a7b5be067ee01e520de7a0384d79163e1e6f8ce6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 20 14:34:03 2014 +0000

    dist: Run 'git log' instead of custom script.
    
    It's useful to see the complete SHA1's since that is how we refer to
    fixes in Bugzilla.

commit ee90a36521e97fdceb9ef3169c25499cee46d0db
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 20 12:09:29 2014 +0000

    tests: Add regression test for get-attach-method == "appliance".
    
    This updates commit ecd31806a491c735878e9e54540a5c11ca1adce9.

commit ecd31806a491c735878e9e54540a5c11ca1adce9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 20 10:13:18 2014 +0000

    tests: Add a regression test for parsing LIBGUESTFS_BACKEND/LIBGUESTFS_ATTACH_METHOD (RHBZ#1055452).

commit 69267d8762b586deab6b930131e1d677ba85df8d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 20 10:21:26 2014 +0000

    launch: Allow backend = "appliance" for backwards compatibility (RHBZ#1055452).
    
    This fixes a regression which was introduced in
    commit 0f26218905816ca86b6ec57070eed802515f4853.

commit d0c5450c451acde4357ebcb4a5f9d4a74332a864
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jan 19 20:28:35 2014 +0000

    daemon: Use wipefs_has_force_option to decide whether to add wipefs --force option.

commit d87cfefcdd22939a9a0c86e3e8fcb467f4181b2a
Author: Olaf Hering <olaf@aepfle.de>
Date:   Sun Jan 19 20:22:49 2014 +0100

    daemon: add missing GUESTFSD_EXT_CMD usage
    
    Signed-off-by: Olaf Hering <olaf@aepfle.de>

commit badc4ffad555dc95770598cb040469e48a02d56a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 18 21:38:11 2014 +0000

    Version 1.25.24.

commit a1eacea5729b209d1187981d704193723004d6b1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 18 16:55:09 2014 +0000

    init: Display clocksource (only when debugging is enabled).

commit 012b01a0fb875bc8aade5a57adbb86599bc2c86c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 18 16:52:58 2014 +0000

    launch: direct: Make sure we pass lpj= parameter when using TCG.
    
    I have verified that 'refined-jiffies' is the clock source when using
    TCG (ie. not kvm-clock which seems only to be used for KVM).

commit 26f7fb237b713c798e23a336a3c4973513f83551
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 18 16:36:14 2014 +0000

    launch: libvirt: Add force_tcg backend setting.
    
    By using:
    
      export LIBGUESTFS_BACKEND_SETTINGS=force_tcg
    
    you can force the libvirt backend to use TCG (software emulation)
    instead of KVM (hardware accelerated virtualization).

commit 11ac9f702440fff5c8dad1f9756f24ca6867712c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 18 16:28:58 2014 +0000

    launch: direct: Add force_tcg backend setting.
    
    By using:
    
      export LIBGUESTFS_BACKEND=direct
      export LIBGUESTFS_BACKEND_SETTINGS=force_tcg
    
    you can force the direct backend to use TCG (software emulation)
    instead of KVM (hardware accelerated virtualization).
    
    This is sometimes useful, especially if you are trying to use
    nested KVM on Intel.

commit 1e4663858bef9fa6d50526f675f6c572d9fde78f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 18 15:33:10 2014 +0000

    New API: set-backend-settings, get-backend-settings.
    
    Allow settings (an arbitrary list of strings) to be passed to the
    current backend.  This will allow us to tweak how the backend works,
    eg. by forcing TCG.

commit 815e739d1230ce067b6a09d644257dac031c0ddc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 18 15:56:25 2014 +0000

    utils: Add regression test for C utility functions.

commit 89a617c07d83ac4517d62810c1eb597fa54a5d60
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 18 15:25:26 2014 +0000

    utils: Add utility function to split string into list of strings.

commit 693a21513b8bf4c61aad76f1860d68f44d5e5e73
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 18 15:25:07 2014 +0000

    utils: Add utility function to copy string lists.

commit 20514fec2507b22e06721c690d050173d097a1fc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 18 16:11:56 2014 +0000

    test-tool: Use size_t instead of int for array index.

commit 3858eeb5171c0d6824c424e03a523e5686a98dfd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 18 14:20:43 2014 +0000

    tests/nbd: Move wait for qemu-nbd to start up earlier.
    
    tests/nbd/test-nbd.pl contains a hack (a call to sleep) to wait
    for qemu-nbd to start up in another process.
    
    This sleep was previously located before the call to $g->launch()
    since that is where (previous to commit 4a0f5ed382) the backend would
    have connected to the NBD server.
    
    However in the new code, an initial NBD connection test is done when
    the drive is added (ie. $g->add_drive (..., protocol=>"nbd")), which
    duly failed intermittently because the qemu-nbd server had not opened
    its socket yet.
    
    Move the wait earlier -- just after the fork -- to avoid this.
    
    This updates commit 4a0f5ed38233393e75ea69ff0595936aed0e8abb.

commit b6ff6421686e6fd7e5f7db8eed24419c7bd09688
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 18 11:55:27 2014 +0000

    Use recommended timer settings for KVM (RHBZ#1053847).
    
    See: https://bugzilla.redhat.com/show_bug.cgi?id=1053847#c0
    
    Thanks: Cole Robinson, and several QEMU developers.

commit 937c0313a070ab9e9b7d75ffd8e509412ca7d755
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 18 11:40:30 2014 +0000

    launch: libvirt: Slightly simplify the XML generation code further.
    
    This updates commit 96737fc5b7a0c9f92896f4a7d0f738a66c56d3b0.

commit e5190e09325f857c777474f793c1874e1e971ee9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 17 19:32:05 2014 +0000

    Version 1.25.23.

commit c537b26f209513abb0bd48f46f300ecf6728618a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 17 19:23:27 2014 +0000

    uml: Fix rule which disables relative-paths test on UML.
    
    This fixes commit e22bd2dcd26ffe822a68c23852bbafe4767d98f0.

commit 716f6e4275fc490bffff96e713ad9dbf230aff97
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 17 15:48:22 2014 +0000

    Version 1.25.22.

commit e22bd2dcd26ffe822a68c23852bbafe4767d98f0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 17 15:07:55 2014 +0000

    tests: Add a test of relative paths, to make sure we don't break them.
    
    In some places we turn relative paths passed by the caller into
    absolute paths: for example in the libvirt backend, all relative paths
    to disk images have to be turned into absolute paths (by calling
    realpath) because otherwise libvirt doesn't work.
    
    This has the potential to break things, especially considering that
    qemu uses the path passed to it in order to resolve the relative paths
    of backing files.
    
    For example consider the case where 'overlay' is a symbolic link to
    /dev/dm-1, but /dev/dm-1 contains a qcow2 which references './backing'
    as its backing file.  If we rewrote 'overlay' to '/dev/dm-1', then
    qemu would try to look up '/dev/backing' for the backing file and
    fail.
    
    See also:
    
    https://bugzilla.redhat.com/show_bug.cgi?id=1053684
    https://www.redhat.com/archives/libguestfs/2014-January/thread.html#00087

commit 96737fc5b7a0c9f92896f4a7d0f738a66c56d3b0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 17 09:37:30 2014 +0000

    launch: libvirt: Use C macros to simplify XML generation.
    
    This commit implements some hairy C macros to simplify
    XML generation.
    
    Given the target XML:
    
      <cpu mode="host-passthrough">
        <model fallback="allow"/>
      </cpu>
    
    The old code would have looked like this:
    
       XMLERROR (-1, xmlTextWriterStartElement (xo, BAD_CAST "cpu"));
       XMLERROR (-1,
                xmlTextWriterWriteAttribute (xo, BAD_CAST "mode",
                                             BAD_CAST "host-passthrough"));
       XMLERROR (-1, xmlTextWriterStartElement (xo, BAD_CAST "model"));
       XMLERROR (-1,
                xmlTextWriterWriteAttribute (xo, BAD_CAST "fallback",
                                             BAD_CAST "allow"));
       XMLERROR (-1, xmlTextWriterEndElement (xo));
       XMLERROR (-1, xmlTextWriterEndElement (xo));
    
    The new code looks like this:
    
       start_element ("cpu") {
         attribute ("mode", "host-passthrough");
         start_element ("model") {
           attribute ("fallback", "allow");
         } end_element ();
       } end_element ();

commit f106b30c41996a9dedd699c1301f0c3eea1ee6b8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 17 12:14:38 2014 +0000

    drives: Avoid double-free along error path.
    
    This fixes commit 4a0f5ed38233393e75ea69ff0595936aed0e8abb.
    
    A simple test of this:
    
      guestfish <<EOF
      add-drive "" readonly:1 format:raw protocol:nbd server:localhost:10000
      EOF
    
    which would core dump.

commit 6b3e05e8da490fc11a2f07f0cc9022216a744ac7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 16 20:00:03 2014 +0000

    Minimum libvirt version is >= 1.1.1.
    
    Note this is the version in RHEL 7.

commit 4a0f5ed38233393e75ea69ff0595936aed0e8abb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 16 13:40:02 2014 +0000

    drives: Centrally create overlays for read-only drives.
    
    qemu has broken snapshot=on ... again.
    
    Change the way that drives are created so that the backend no longer
    has to use snapshot=on, <transient/> (which never worked), or UML's
    corresponding COW-creation feature (also broken).
    
    Instead of that, the src/drives.c code will create overlays when
    required by calling into a new backend operation 'create_cow_overlay'.
    This operation runs 'qemu-img create -b' or 'uml_mkcow' as determined
    by the backend, and returns the name of the overlay.
    
    The format of the overlay is still backend-specific because qemu needs
    to use qcow2 and UML needs to use COW.
    
    This patch also includes some factorization of the libvirt XML code.
    
    This also drops the drv->priv (private per-drive data) field, since it
    is no longer used by any backend.
    
    This also moves the guestfs___drive_source_qemu_param utility
    function, used & shared by the direct & libvirt backends only, into
    src/launch-direct.c (from src/drives.c).

commit 07e47513dfe77c0c038cc24e714a32fe096bc68f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 16 15:03:04 2014 +0000

    fish: Fix tests that specified qcow2 format, but passed a raw format disk.
    
    In some tests we were specifying qcow2 as the image format when adding
    a disk, but actually passing a raw format image.
    
    Libguestfs previously did not detect this until guestfs_launch, but it
    was still a bug to pass an incorrect format to guestfs_add_drive_opts.
    
    It only worked because these tests never call guestfs_launch.
    
    A later commit in this series will cause this to be detected
    (sometimes) during guestfs_add_drive_opts.

commit b3cf877e58cbcc4f6fd5d228028e19c1b294b1ac
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 16 18:01:20 2014 +0000

    builder: Fix unterminated I<...> in man page.
    
    Thanks: Lukas Zapletal.

commit 5b42351294f4d0ace6960b9f31215f3f97c5259d
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Jan 16 14:58:25 2014 +0100

    builder: add a JSON output for --list
    
    Simple JSON output for sources and templates, to be able to query them
    with no need to parse unstructured outputs like the "--list-format long"
    one.

commit e45bfe0d36c9f50143b13921a498f00ee06ca27d
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Jan 16 12:34:48 2014 +0100

    builder: add --list-format
    
    Add a --list-format which allows to choose which in format should be the
    output of --list.

commit 91aae893c70b3877b31803800ba77836fd7a45e8
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Jan 16 11:49:05 2014 +0100

    builder: small refactor of the list output
    
    Switch from a boolean for the short/long list output to labels for the
    actual format. Also, split the output of each list format to an own
    function for easier maintaineance.

commit 99d6e2c84ef490feb6ff2e37e4b0684f34bac554
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Jan 15 18:51:18 2014 +0100

    fuse: clear stat structs (RHBZ#660687).
    
    Not all the fields of struct stat are actually filled by us. This caused
    rubbish to appear in the microseconds fields, which were then used as
    base when changing atime/ctime (with e.g. touch), triggering EINVAL by
    futimens/utimensat when those rubbish values were out of the range
    allowed for microseconds.

commit 8bbd22d373e5189301c06c6f9e2dd1ae8b848b82
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Jan 15 14:02:24 2014 +0100

    fuse: remove extra trailing \n in debug messages
    
    debug() adds it already.

commit 7c431d703005f7e08567be82caf035feca9b931f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 14 17:30:40 2014 +0000

    builder: Add documentation for how to import images into OpenStack.

commit 775c6daf22884edad8ede4b0916024d3d7c04585
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jan 14 13:30:19 2014 +0100

    builder: test-virt-builder: check some results
    
    Check at least some basic modifications in the image created with
    virt-builder.

commit b7bb1f6cee19da143996c13e6cc019a039f3ee4f
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jan 14 11:08:25 2014 +0100

    builder, edit, fish: use copy-attributes
    
    Make use of the new copy-attributes command to properly copy all file
    attributes from a file to the new version of it.

commit 4c4480de28aa2c6f614e627b3fd8de69e2905b32
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 13 22:09:26 2014 +0000

    Version 1.25.21.

commit aba64a0327094b6a82686411c4dfa7a30d64ecee
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 13 22:10:39 2014 +0000

    fish: Add test-file-attrs.sh to EXTRA_DIST.
    
    This fixes commit efb5f1841524ec75d765368b447270b8a3aff8ac.

commit e664739a578f31c3f97073e713f9f33d4eb62d8d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 13 20:58:08 2014 +0000

    builder: planner: Whitespace change.

commit 69d9c8515c32dcc67e4ce752215e18eb811f8029
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 13 20:42:48 2014 +0000

    builder: For performance, recommend using the --no-sync option.

commit 5136de98e7f4bd7a967da5b3ede72c729aa7805e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 13 20:29:50 2014 +0000

    builder: Add --no-delete-on-failure option to aid debugging.
    
    This lets you debug failures in virt-builder, especially when scripts
    or installing packages fails.

commit 6879fdf98961bf7ef1610e5d131f1b494892bcdf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 13 20:16:27 2014 +0000

    builder: Minor documentation fix to manual page.

commit e68baf1954f9b68a228c9ae99a738f2d750418c1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 13 19:26:01 2014 +0000

    Update generated files for new copy-attributes API.
    
    This updates commit efb5f1841524ec75d765368b447270b8a3aff8ac.

commit 5fa55389d4a84a942010f8a77d305bc134deacf2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 13 19:25:34 2014 +0000

    builder: Fix documentation for --attach option.

commit d885d6f6a97ee119fe1751df6f7d04844bfbf6be
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 13 16:19:51 2014 +0000

    builder: Document how to set Japanese in Debian 7.

commit efb5f1841524ec75d765368b447270b8a3aff8ac
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Jan 13 14:41:28 2014 +0100

    New API: copy-attributes.
    
    This allows one to copy attributes (like permissions, xattrs,
    ownership) from a file to another.

commit 418c064bc11950b0fa164ef6ba43ac9d628d223f
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Jan 13 14:33:35 2014 +0100

    sysprep: add --operations
    
    Add a new --operation parameter which, similarly to --enable, can be
    used to enable operations, but also to remove them, and to add/remove
    the default operations and all the available ones.

commit 0d1c00211b35e2cf00197293706b89154a526019
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jan 12 18:07:21 2014 +0000

    Version 1.25.20.

commit ed43cc12c4492510e38eee9c7f8a5076956e4066
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jan 12 18:06:26 2014 +0000

    builder/website: Add CirrOS signature file to EXTRA_DIST.
    
    This fixes commit 40b88fdbc76515fd21b33f54587c7f4f7b6e9715.

commit 7500ae3f75f4650c18f2a8433c6b5edcca6e88a6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jan 12 17:49:48 2014 +0000

    builder: Fix virt-builder test.
    
    Add Europe/London timezone to phony Fedora guest.
    
    This fixes commit dd1bfea513658368afd3728e0c5bf8ab6041cd1f.

commit fcdea83c6b9dc94a565a819a9f42e0c4721166e8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jan 12 17:06:02 2014 +0000

    builder: Document how to set Japanese language support in Fedora 20.
    
    This updates/fixes commit 7e8ad13e863a5c87e3da47288bcecdb88ca0e4cb.

commit a8c9aedd51a88b3e08d6cc2580053d44b11f716b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 10 21:17:09 2014 +0000

    builder: Document that SELinux guests will reboot for autorelabel.

commit f40e44c2f97a7fa17e6078d958ae2779b7ca83c7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 10 19:49:02 2014 +0000

    builder: Document how to set up local mirrors for performance and reliability.

commit 7e8ad13e863a5c87e3da47288bcecdb88ca0e4cb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 10 19:48:28 2014 +0000

    builder: Document how to change the language/locale of a new guest.

commit 6d4ac696e54902baf7d76de527b3df3d66c7dfa1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 10 21:18:07 2014 +0000

    builder: Add --link option for creating symbolic links.
    
    This is useful for configuring systemd services.

commit 39bc959c5b3a972e9a12921e002f27aaab2cd5ff
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 10 17:04:28 2014 +0000

    builder: List --install packages in the same order as on the command line.
    
    Previously the list was reversed.  Note this doesn't have any effect
    on how the packages are installed since the guest package manager
    doesn't care about the order.

commit 8ae6b6c9ff855f5eaf3f16188b1bcb4ddba095c5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 10 14:21:17 2014 +0000

    builder: Document how to change keyboard layout.
    
    This is too complex to implement directly in virt-builder.
    
    Instead we just document how to do it for some common Linux distros
    using --run-command, --edit etc.

commit 1e1b027c1b7c592ae8f04bcef8ffe93b7f2841d4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 10 13:47:05 2014 +0000

    builder: docs: Remove confusing reference to timezone.

commit dd1bfea513658368afd3728e0c5bf8ab6041cd1f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 10 12:12:30 2014 +0000

    sysprep, builder: Add --timezone option to set timezone of guest.
    
    You can use it like this:
    
      virt-sysprep --timezone Europe/London ...
      virt-builder --timezone Europe/London ...

commit cea270de3be3ca3c2b2e6555418c4b4eb8da7509
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 10 21:19:43 2014 +0000

    daemon: xattr: Remove unused variable.
    
    Revealed by using ./configure --enable-gcc-warnings.

commit 59d8cf62cb67688cea42a985029adea874f0b7a2
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Jan 10 15:10:03 2014 +0100

    daemon: xattr: move the listxattrs code in an own function
    
    Move in an own function the code that does the (l)listxattrs allocating
    the buffer of the right legth, as it will be useful later.
    
    No functional changes, just code motion.

commit 7630a7bbbdceee8e6aad08511e752f5fcb273416
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Jan 9 18:59:19 2014 +0100

    daemon: xattr: simplify the enabling of the linuxxattrs features
    
    Instead of enable them when having one of the two headers for it but
    still checking for the HAVE_* availability of each *xattr() function
    used, just enable the linuxxattrs as a whole when having any of the
    needed headers (like before) and all the needed functions.
    
    This might cause the linuxxattrs to not be available anymore on systems
    without the whole set of *xattr() functions implemented, but OTOH it
    simplifies the xattr.c implementations.

commit 746a0b1f19667606ee63c8d3ab6a75531a8bd71c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 8 20:22:21 2014 +0000

    tests: Add a regression test for libvirt authentication (RHBZ#1044014).
    
    This tests the virConnectAuthPtrDefault wrapper path.

commit 873db60c0e52893a38c374d867d0a305e5419d6a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 8 19:36:00 2014 +0000

    tests: Add a regression test of libvirt authentication events.
    
    This requires a change to libvirt (in libvirt >= 1.2.1), see:
    
    https://www.redhat.com/archives/libvir-list/2014-January/msg00378.html

commit 4125064554c8cb1b96680e24e49d74ee6024f761
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 2 12:20:18 2014 +0000

    libvirt-auth: Provide a friendlier wrapper around virConnectAuthPtrDefault (RHBZ#1044014).

commit 06f7bea14883c4903c58077757179341c0e1471a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 7 17:32:04 2014 +0000

    builder: Fix handling of --size parameter.
    
    It now matches the documentation:
    
      "Select the size of the output disk, [...]
    
      Virt-builder will resize filesystems inside the disk image
      automatically.
    
      If the size is not specified, then one of two things happens.  If
      the output is a file, then the size is the same as the template.  If
      the output is a device, partition, etc then the size of that device
      is used."
    
    This also adds checks to make sure that users don't try to shrink a
    disk (which is not possible), and they don't try to resize larger than
    the output block device.

commit a403febb8c43bf573c2354c39df22a29cf8863d8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 7 17:30:57 2014 +0000

    mllib: Add library function to run external command and slurp up the output.
    
    This also changes a couple of functions to use this new library
    function.

commit 3e802605b52dccd2574353d5aff220de8d8eb3b8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 7 17:30:20 2014 +0000

    builder: Pass ~prog global (program name) around.

commit ac41f616db35921074a4909524b9bc1a2bd2406d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 7 14:52:08 2014 +0000

    builder: Note in man page how to specify size in bytes.

commit 40b88fdbc76515fd21b33f54587c7f4f7b6e9715
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 4 12:37:40 2014 +0000

    builder: Add CirrOS 0.3.1 disk image.

commit 169a4a34e557271a848447611658901f1dc57a39
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 2 17:06:10 2014 +0000

    Version 1.25.19.

commit 6c971faecffd54f324a63b3c815925471b42d6bb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 2 16:53:34 2014 +0000

    Update copyright dates for 2014.

commit 883208284b6a49ccf86a2179e3a63220d2a73ad0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 1 16:32:56 2014 +0000

    Allow ./configure --without-qemu.
    
    This means there will be no default hypervisor, and effectively the
    user will always have to specify one (eg. by setting LIBGUESTFS_HV or
    calling guestfs_set_hv).
    
    This is useful on platforms where qemu doesn't work, or where qemu is
    not needed (eg. if you want to use UML, or you just want to compile
    libguestfs without using/testing it).

commit ee4ce2a0298d012bd8c500c35dc50e1f53e88c8b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 27 09:45:49 2013 +0000

    ruby: Fix .new method (RHBZ#1046509).
    
    The .new method was unintentionally broken in
    commit 9466060201600db47016133d80af22eb38091a49.
    
    This fixes the .new method and allows it to be called with multiple
    parameters, so you can use:
    
      Guestfs::Guestfs.new
      Guestfs::Guestfs.new()
      Guestfs::Guestfs.new(:close_on_exit => false)
      etc.
    
    For backwards compatibility, Guestfs::create may still be used.
    
    This commit also adds regression tests:
    
     - Use .new method in regular tests.  (Because this was not done
       before, we didn't catch the breakage.)
    
     - Test that ::create still works.
    
     - Test that args can be passed to .new method.

commit 480bd3a6d8a56b37936b08c94eb99f0921fe65de
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 27 13:21:38 2013 +0000

    RHEL 6: ruby: Fix fallback to rake/rdoctask for old rake.

commit c16f2ea53d502c1874f10fca0767ba5d05208985
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 27 12:56:51 2013 +0000

    RHEL 6: builder: Use iteri instead of List.iteri.
    
    RHEL 6 OCaml did not have List.iteri, so use the version from
    Common_utils instead.

commit ac1d5ba77bd98c3e1fb061458254340bbdb823f2
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Dec 23 16:35:53 2013 +0100

    tests/mountable: skip if btrfs is not available
    
    This test uses btrfs, so skip it if either the "btrfs" feature or the
    btrfs filesystem is not available.

commit d20289186d257105f304a4fa0c3e6d26a5fb0807
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Dec 20 15:00:09 2013 +0100

    inspect: fix detection of newer CirrOS versions (RHBZ#1045450).
    
    Add an own case for CirrOS, based on the /etc/cirros/version file
    provided in newer version instead of the Buildroot-generated
    /etc/br-version.

commit 1580d965cd2b994205aeef44f8c873aea2c91d5f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 15 10:13:10 2013 +0000

    builder: Add support for RHEL 7.0 beta 1 (public beta) to the script.

commit a13696e99cfba8735fcfed3e3a63008764943365
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Dec 20 11:38:52 2013 +0100

    Re-add regression tests for rh#563450
    
    Added in 2392fae6803b9de4a4761509007c160339d57f50 and removed in
    be025369ad622867ecf08d5c9170e8e59d2d6294; now they should work with any
    backend, as the device names are normalised and not change the guestfish
    output depending on the used backend.
    
    Thanks Richard for the hints.

commit 8acb91a58487eba2f3598457a97afe3e559c52af
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 19 18:38:57 2013 +0000

    launch: libvirt: Clearer message when libvirt screws up.
    
    Instead of:
    
    libguestfs: error: could not create appliance through libvirt.
    Try using the direct backend to run qemu directly without libvirt,
    by setting the LIBGUESTFS_BACKEND=direct environment variable.: internal error: process exited while connecting to monitor: qemu-system-x86_64: -drive file=/tmp/libguestfs3RnJSd/snapshot2,if=none,id=drive-scsi0-0-0-0,format=qcow2,cache=writeback: could not open disk image /tmp/libguestfs3RnJSd/snapshot2: Could not open backing file: Could not open '/home/lsm5/fimagebuilder/fedora-imagebuilder/fedora-imagebuilder-sda.qcow2': Permission denied
    
    it will now say:
    
    libguestfs: error: could not create appliance through libvirt.
    
    Try running qemu directly without libvirt using this environment variable:
    export LIBGUESTFS_BACKEND=direct
    
    Original error from libvirt: internal error: process exited while connecting to monitor: qemu-system-x86_64: -drive file=/tmp/libguestfs3RnJSd/snapshot2,if=none,id=drive-scsi0-0-0-0,format=qcow2,cache=writeback: could not open disk image /tmp/libguestfs3RnJSd/snapshot2: Could not open backing file: Could not open '/home/lsm5/fimagebuilder/fedora-imagebuilder/fedora-imagebuilder-sda.qcow2': Permission denied

commit d16db5a6180305543658f3a50657c70bbdf81b40
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 19 14:22:26 2013 +0000

    launch: libvirt: Don't default to using NULL for libvirt connection URI (RHBZ#1045033).
    
    NULL means that libvirt gets to guess what connection URI we meant.
    Currently it guesses qemu:///session for non-root and qemu:///system
    for root.  Except if LIBVIRT_DEFAULT_URI is set in which case this is
    used even if it's not appropriate.  Except if Xen is installed in
    which case it guesses xen:/// which is not helpful at all.
    
    Instead use qemu:///session (or qemu:///system for root -- that's
    likely to be wrong, but we can't help that).
    
    If the user really wants to use NULL and let libvirt guess, then they
    can now specify the libvirt:null backend.
    
    See:
    
    https://bugzilla.redhat.com/show_bug.cgi?id=1045033
    https://bugzilla.redhat.com/show_bug.cgi?id=886915
    
    A good way to test this is:
    
    LIBVIRT_DEFAULT_URI=iambroken libguestfs-test-tool
    
    The libguestfs libvirt backend should (after this commit) ignore
    LIBVIRT_DEFAULT_URI.  However other parts of libguestfs will still use
    it, eg. guestfs_add_drive_opts, guestfish '-d' option.

commit b46a5511b3a98c0d811353b1bc0c7745fa972dc6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 19 11:17:43 2013 +0000

    builder: Add --update option to update template/core packages.

commit 681488877456b83f039dc518861f29ab4e1857f0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 19 08:21:53 2013 +0000

    run: Use timeout --foreground option.
    
    If timeout doesn't have this option (RHEL 6) don't use timeout at all.
    
    Attempt to fix RHBZ#1025269.

commit 05b3aefb8bfd74d769719a62208b391018626f59
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 18 20:42:41 2013 +0000

    Version 1.25.18.

commit be025369ad622867ecf08d5c9170e8e59d2d6294
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 18 20:40:54 2013 +0000

    tests/regressions: Remove regression tests rhbz563450*.
    
    These two tests failed 'make check-release' (particularly the
    UML tests).
    
    This partially reverts commit 2392fae6803b9de4a4761509007c160339d57f50.

commit 80d267778499fc80c82552d6685703278d705f92
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 18 18:38:40 2013 +0000

    Version 1.25.17.

commit 70db54974b87c6b4384dbf8b839e0335e70189ae
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 18 18:37:50 2013 +0000

    fish: Fix memory leak in inspect/-i code (detected by valgrind).
    
    This only manifested in the new virt-diff tool.

commit d08efbec839515c7e1a46d2e06d3fafac74221b0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 18 17:38:26 2013 +0000

    Version 1.25.16.

commit 34cbde5b884b9debb2d314763c2f5f914bea012c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 18 17:37:56 2013 +0000

    builder: Change how EXTRA_DIST is generated.
    
    So that we don't need to change this every time we upload
    a new operating system signature.

commit 308292e4fb4f57ec814c998761e2c1361660500b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 18 16:16:15 2013 +0000

    Update to latest gnulib.

commit 1fcea09ee2e89d2e727e39df80dc595f5d0ba363
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 18 16:03:43 2013 +0000

    appliance: Create an /etc/resolv.conf file referring to qemu user network nameserver (RHBZ#1044585).

commit 1ee879f3e5baa398edc76dc02492662412faf2d7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 16 14:45:29 2013 +0000

    New tool: virt-diff.
    
    This tool can be used to show the differences between two
    disk images.

commit c7a2dce6075ce47e6776d4c9560f18821b80106d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 17 19:32:42 2013 +0000

    daemon: Sort extended attributes when returning them.
    
    A single file can have multiple xattrs.  Previously these were
    returned in the same order as the kernel returns them.  However it is
    more useful if they are sorted by attribute name.

commit 937ea7f16fbaf07c1ca374cc5be93b447bdc1fa2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 17 20:56:11 2013 +0000

    virt-ls: visit: Fix a bug with handling of extended attributes.
    
    The wrong pointer was passed to the visitor_function, resulting in it
    seeing the placeholder xattr entry (the one which stores the length of
    the list of xattrs - see
    http://libguestfs.org/guestfs.3.html#guestfs_lxattrlist ).
    
    virt-ls doesn't list xattrs at the moment, hence this bug was not seen
    before.

commit 276ef546c4674698d57a0e28f5f51c27a9d2d269
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 17 16:06:19 2013 +0000

    virt-ls: visit: Add an opaque pointer to the visitor function.
    
    Useful for passing around data, but not used by virt-ls.  It
    will be used by virt-diff.

commit a93d418c3e12490adcfe2cf15ba919ef447c6965
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 17 09:11:19 2013 +0000

    virt-ls: Move visit and other functions to common code library.
    
    This will allow us to reuse these functions in virt-diff.

commit 2b674ccdd368b89c15221c33ee5b13dda1d61209
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 17 10:26:30 2013 +0000

    fish: options: Add alternate add_drives_handle and inspect_mount_handle.
    
    These functions don't use the implicit 'g' global variable, but
    take a handle argument instead.

commit c513d3a6e57a4c7e0c0307d38360a7116fc34528
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 17 09:57:23 2013 +0000

    fish: Add option parsing for -A and -D options.
    
    Same as -a and -d except these add the drives to a second list
    of drives (drvs2).

commit 28adf7cea6d4416e25ac65f930b4568c0460eb7f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 16 15:09:58 2013 +0000

    fish: Move -d option parsing to common function.
    
    This is essentially just code motion, except:
    
    (1) It cleans up a few variable declarations which were implicitly
    used by the old macro that aren't needed any more.
    
    (2) The options are reordered alphabetically.

commit d9826467c2bf90b7db7adfd8b0ae8cbbfbb5f04f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 16 15:06:32 2013 +0000

    fish: Deprecate the -D option (prefer --no-dest-paths instead).
    
    This option will now print a warning:
    guestfish: warning: -D option is deprecated, use --no-dest-paths instead

commit 78b9229bc823d08d5a83adcba02da4030335f674
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 17 21:56:00 2013 +0000

    lib: Export guestfs_compare_* functions for comparing structs and lists of structs.

commit 3d398687be20bd1dd9aec7da41cb3bd1319371de
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 17 15:20:50 2013 +0000

    lib: Export guestfs_copy_* functions for copying structs and lists of structs.
    
    These complement the guestfs_free_* functions.

commit 0f3489ba6b80cfdd90230d66f58a49c9738b8fad
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 17 21:28:49 2013 +0000

    lib: Rename cleanup-structs.c -> structs-cleanup.c and free-structs.c -> structs-free.c.
    
    Just renaming generated files, no other effects.

commit 193b81a633501ccf6155935a50523cd802858410
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 17 22:09:21 2013 +0000

    daemon: Improve error message for readlink call.

commit 882b91cb480811333627583dff3eca596281a3a9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 17 13:57:10 2013 +0000

    generator: Fix bug in documentation of guestfs_free_* functions.
    
    These appeared in the documentation as:
    
     void guestfs_free_int_bool (struct guestfs_free_int_bool *);
                                                ^^^^
    
    which is obviously wrong.

commit d39b4dc606bb725b0790c24934dc936daf2c18d4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 17 10:20:53 2013 +0000

    fish: Ensure print_inspect_prompt can only be called by guestfish.
    
    Code clean-up.

commit a4f4f9c075fd5788e9176436a4a356c957a6d6b5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 17 10:19:26 2013 +0000

    inspector: Ensure low-level inspection functions can only be called by virt-inspector.
    
    Code clean-up.

commit d6e4709f5bcc7dd465151fa357530445cf23acdd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 17 10:11:53 2013 +0000

    fish: options: Fix incorrect comment.

commit 076d73696e2f2fdd275863fe1b88ca9d2088b675
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 16 14:37:12 2013 +0000

    virt-cat, virt-filesystems, virt-ls don't use libconfig.
    
    So it doesn't need to be linked in.

commit 685a28eb2cbcbe30420413c30780d2d729580931
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 18 13:19:44 2013 +0000

    tests: guests: Add /etc/motd test file to Fedora test image.

commit c4646290d61934cbec30f6e5c0d6226e7bfeb5c9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 18 15:05:36 2013 +0000

    builder: no_proxy environment variable should be passed to the appliance.

commit 6f3ca3699d067f0d00c71a2bcf3c2fc981eccc40
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 17 15:48:47 2013 +0000

    builder: Add Fedora 20 image.

commit c4fdb4023eed45dbf905526da4a91b846792079d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 16 14:14:01 2013 +0000

    builder: Remove blank line.

commit 2392fae6803b9de4a4761509007c160339d57f50
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Dec 16 14:54:27 2013 +0100

    drives: add CD-ROM disk images as read-only drives (RHBZ#563450).
    
    The current add_cdrom way basically appends a new raw "-cdrom /path"
    parameter to the qemu invocation (even when using libvirt as backend),
    hence such images are seen as "CD-ROM drives" inside the appliance.
    However, there is no need for such particular behaviour, as they need to
    be handled as normal (read-only) drives.
    
    Adding CD-ROM disk images as drives also changes the device names used
    for them inside the appliance from /dev/srN to the usual e.g. /dev/sdX.
    
    These changes fix different issues:
    - it is possible to start guestfish without adding disks with -a, then
      just add-cdrom and run
    - list-devices does not cause guestfsd to crash when sorting the list
      of devices (exposed by the test case in RHBZ#563450)
    - the result of list-devices now reflects the order images were added
      (RHBZ#563450)
    
    add_cdrom is still deprecated, but now in favour of add_drive_ro
    (instead of add_drive), with its documentation reflecting that.
    
    Add two small regression tests for the fixes described above.

commit 3cf5a25e3f63ea6832b96468a94cdb13dbd26e92
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 14 18:54:56 2013 +0000

    builder: Refuse to write to a char device or /dev/null.
    
    virt-builder --output /dev/null is tempting, but not possible, and
    might result in /dev/null being deleted(!)  Check for this case and
    prevent it happening.

commit 0037820ee003bfbc71bf35b18fb3a066cbf298f8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 14 18:53:20 2013 +0000

    builder: Only use virt-resize --no-sparse when writing to a block device.
    
    Previously we would use the virt-resize --no-sparse option if the
    final output file was a block device.  This is safe, but unnecessary
    for example if virt-resize was used as an intermediate step.  So only
    use this option if virt-resize is actually writing to the block
    device.

commit 0cdc8645880b3103ad4aa5d192db609270e51a8e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 14 17:32:40 2013 +0000

    Version 1.25.15.

commit d5d1dac3ac1e3027dc507b1343022f6bcea20822
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 14 16:43:40 2013 +0000

    builder: Add a link to blog posting about the planner.
    
    http://rwmj.wordpress.com/2013/12/14/writing-a-planner-to-solve-a-tricky-programming-optimization-problem/
    should help people to understand how this code works.

commit 6901cd2250fc25c1761f191fb02db74fecf4703d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 14 16:18:50 2013 +0000

    builder: tests: Add test-virt-builder-planner.sh to EXTRA_DIST.
    
    This fixes commit a27963b67ba1140c29c145a1ce14dbfc05f8d7da.

commit 3f433d90f208da8e2b7ea397485dfd8d415726a0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 14 16:18:23 2013 +0000

    builder: tests: Fix virt-builder --list output.
    
    This fixes commit a27963b67ba1140c29c145a1ce14dbfc05f8d7da.

commit a27963b67ba1140c29c145a1ce14dbfc05f8d7da
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 14 15:50:37 2013 +0000

    builder: Add a test of the planner.
    
    This tries out many combinations of size/format and ensures
    that the planner can deal with them.

commit 7af9cabadeb1da329de4411d7eaea2e347496446
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 14 15:50:04 2013 +0000

    builder: Flush debug info after printing it.

commit 0af1e55e68c7cdaecc0af22e8bc41b8cff197e44
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 14 15:49:25 2013 +0000

    builder: planner: Handle no format= in source case correctly.

commit 62cc7d3361127b4e007f8e23028213852be09124
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 13 13:18:47 2013 +0000

    builder: Use a planner to work out how to convert the template to the final image.
    
    The original template might be, say, xz-compressed raw of a certain
    size.  We need to work out how to convert it to, say, qcow2 with a
    larger size, in as few operations as possible.
    
    Instead of using a nasty aggregation of special cases to do this, use
    a breadth-first search over all possible trees to try to find an
    optimal plan.
    
    (Actually the current implementation isn't optimal, but it's fine for
    virt-builder.)

commit 81b4e5d5cd68f65aa950251e22332b3fa477fecb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 14 13:18:48 2013 +0000

    builder: Move is_block_device function into common utilities.
    
    This is just code motion.

commit d98fbf2071f363d8738992d2999c2f24737e875b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 14 13:15:32 2013 +0000

    resize: Move roundup64 function into common utilities.
    
    This is just code motion.

commit d57d8f22dec36f6cc80c2cd4ac4e936f0c0d0e49
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Thu Dec 12 23:59:53 2013 +0100

    golang: Don't run launch test if appliance has not been built.

commit 30936f499e08919a351d3d46c7e26a30dea697ea
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Dec 13 11:04:30 2013 +0100

    sysprep: remove some Pegasus files, like certs (RHBZ#1041552).

commit 3ae829d752fedec43dffedeec958c8084a68a919
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 13 08:46:04 2013 +0000

    golang: Add note about difficulty of parsing go version numbers.

commit 29cfb10bd43f2e3d0543e08f1da20c4dfb83003e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 12 16:18:37 2013 +0000

    Version 1.25.14.

commit 1877c106030361821cf36c8873455d0c3d7134d3
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Dec 12 16:23:50 2013 +0100

    fuse: provide a stub "flush" implementation (RHBZ#660687).
    
    It seems that FUSE can invoke flush to make sure the pending changes
    (e.g. to the attributes) of a file are set. Since a missing flush
    implementation is handled as if it were returning ENOSYS, this can cause
    issues later.
    
    To overcome this, just provide a stub implementation which does nothing,
    since we have nothing to do and don't want to have FUSE error out.
    
    Furthermore, uncomment the timestamp checks in test-fuse.sh, since now
    they should be working fine.

commit 7775c121f782342e0d70351855bd6da3ebfb189e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 11 19:22:12 2013 +0000

    recipes: Use new style -a/-d options in virt-edit example.

commit 0c0caaddb00a5b25ab920e9f83bafbeca3ee9b7e
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Mon Dec 9 20:51:37 2013 +0100

    po: Create empty files to be edited by xgettext
    
    This avoids:
    
        xgettext: error while opening "libguestfs.pot-t" for reading: No such file or directory
    
    which I observed with xgettext (GNU gettext-tools) 0.18.3

commit dabc7a4a5623b28f7fd2b333564eee6c0214695b
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Mon Dec 9 20:50:21 2013 +0100

    Fix builder/website test in out-of-tree builds

commit cbc0e79d38c125c7f436055c88fa1dbd5425827c
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Mon Dec 9 20:49:41 2013 +0100

    Fix manpage generation in out-of-tree builds

commit b1210152217b35f52f204a1d92ee988ca713949c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 10 13:45:07 2013 +0000

    daemon: mkfs: Use -I option to force mkfs.fat to write a filesystem over a whole device (RHBZ#1039995).
    
    If you use virt-make-fs to create a partitionless FAT-formatted disk
    image then currently you will get an error:
    
    $ virt-make-fs --type=fat . /tmp/test.img
    'mkfs' (create filesystem) operation failed.
    Instead of 'fat', try 'vfat' (long filenames) or 'msdos' (short filenames).
    mkfs: fat: /dev/sda: mkfs.fat: Device partition expected, not making filesystem on entire device '/dev/sda' (use -I to override) at /usr/bin/virt-make-fs line 508, <PIPE> line 1.
          ...propagated at /usr/bin/virt-make-fs line 518, <PIPE> line 1.
    
    With this patch, the error goes away and partitionless disks can be
    created.

commit 1f0e75213bcb041083a87b46b3ec7bf1be054142
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 10 08:50:55 2013 +0000

    proto: Remove another error message which hides earlier error.
    
    When receive_file_data calls guestfs___recv_from_daemon, and that
    function returns -1, it adds the following error to the handle:
    
      receive_file_data: parse error in reply callback
    
    However this hides a more specific error message which was already
    added by guestfs___recv_from_daemon.

commit 78df80d64970ba6b62bb59888069dd9f0343a804
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 10 08:48:04 2013 +0000

    proto: Remove error message which hides earlier error.
    
    When chunked encoding fails, the following error is added to
    the handle:
    
      [filename]: error in chunked encoding
    
    However all paths returning -1 from receive_file_data already set a
    more specific error, which this error hides.

commit 41729c6556bbab7d5532a9a699848aa254b77d27
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Dec 10 10:32:12 2013 +0100

    lib: fix newline in error output (RHBZ#923355).

commit 1472fbd903befb179112a1de673c376ec5bf9b2f
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Dec 9 19:37:51 2013 +0100

    sysprep: mention globbing in help for --delete
    
    Followup of ed4bcb119cb908e98ecc1107dcd8b740ee2f484f.

commit ed4bcb119cb908e98ecc1107dcd8b740ee2f484f
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Dec 9 16:19:12 2013 +0100

    sysprep: allow to specify globbing for --delete
    
    Adapt the globbing part from the old --remote-path work previously
    proposed for sysprep [1], allowing --delete to perform globbing when
    deleting paths.
    
    [1] https://www.redhat.com/archives/libguestfs/2013-October/msg00045.html

commit 7a41f5c1263d97d7656d41c56fd2237ba72975c7
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Dec 9 16:19:11 2013 +0100

    launch: switch from -nographic to -display none
    
    The latter is a better way to disable the qemu display output as we
    need to, without enabling extra devices (which are disabled already,
    anyway).
    
    Also, related to the change above, ban the -display parameter from the
    ones that can be supplied by the user.

commit c89ffbc15291e9418e36540e5e78311b6f39011b
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Dec 9 16:19:10 2013 +0100

    sysprep: remove more anaconda and tuned logs (RHBZ#1039540).

commit a0c642c15610245d2c6b5f2bcd42a06b2d43f921
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 8 12:43:02 2013 +0000

    Version 1.25.13.

commit 3f44e09cb55d14e956a919d70325cde747c5404b
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Sat Dec 7 19:13:34 2013 +0100

    Fix virt-builder tests for out-of-tree build

commit 38410afc5a99c222f3880342a441fbc8d28fbb3b
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Sat Dec 7 19:12:51 2013 +0100

    Fix installing man-pages from out-of-tree build

commit f631770974770ba4a31f90d8a8315113c895dc0c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 7 10:30:14 2013 +0000

    Add CentOS 6.5 image.

commit 5c76af3a954b54246ebc3ecbad748e75d2057424
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 6 18:58:17 2013 +0000

    recipes: Add a recipe for masking a systemd service.

commit 023128a0eb29163288eb923b2f9dc81aa919f1d9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 6 15:02:36 2013 +0000

    Revert half of "builder: translate more user-visible strings"
    
    Don't change "os-version" to "OS version".  It's intended to be the
    same as the virt-builder man page, which consistently calls this the
    "os-version" string.
    
    This partially reverts commit ee0e56f43e55307fefa1d04505ed6477d604d220.

commit 915908fcdd6ebc2f20f760e21a7ca6c9a3848cc9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 5 22:37:48 2013 +0000

    launch: direct: Pass -enable-fips option if qemu supports it.

commit 178bc878e1d5b3b1d8636348245c06881c537a38
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Dec 5 16:30:05 2013 +0100

    po: fix dependencies for libguestfs.pot extraction
    
    Fix the dependencies of the libguestfs.pot target: other than using the
    right make variables holding the contents of the POTFILES, depend also
    on the POTFILES themselves.

commit c60dc40fe44f7db401d22a85bf382a02ca73b24f
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Dec 5 16:30:06 2013 +0100

    fish: improve the command error messages
    
    - when a command needs no parameters, tell that explicitly instead of
      "command should have 0 parameters"
    - use gettext's plural form when printing the number of required
      arguments
    - improve the error message for a variable number of parameters limited
      only in the maximum number of them, using also a plural form

commit 1a9a8ab48fb4e1427eb5ded27540fb76f8c5795b
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Dec 5 16:30:04 2013 +0100

    po: fix broken message extraction
    
    Extracting separately the pot for the various languages and then
    creating manually the global pot (by manually joining the above ones
    after having stripped their headers) is wrong, since other than being
    an hack it can create an invalid pot when the same message appears in
    sources written in different languages.
    
    Instead, a cleaner and safer solution is to first let ocaml-gettext
    (if available) extract the messages for the ml files, and then use
    xgettext to extract the messages for the other languages, joining the
    new messages to the existing (or not) pot file.

commit ee0e56f43e55307fefa1d04505ed6477d604d220
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Dec 4 15:34:46 2013 +0100

    builder: translate more user-visible strings
    
    Translate also the "OS version" and "Notes" strings that appear in the
    --long output.

commit 6739073757158bc22826d60ebc6ce9460d562a13
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 2 13:40:56 2013 +0000

    Version 1.25.12.

commit 7af3602f5fe63956a1a4bfa18c3ff48124d95352
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Nov 28 15:49:14 2013 +0100

    inspect: improve detection of FreeBSD install discs (RHBZ#1033207).
    
    Check for /boot/loader.rc as "install disc" detection, using it to mark
    FreeBSD install discs.
    Also, check for /mfsroot.gz to see whether such disc is also a live one.
    
    See also RHBZ#1033207.

commit e754add14c8bffb76060e0f4d8ce1c98731de098
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Nov 28 14:48:37 2013 +0100

    inspect: ignore special CD devices on FreeBSD install discs
    
    /etc/fstab in installation discs of FreeBSD can have an entry pointing
    to the mounted CD itself; skip it as it is done with other CD devices in
    check_fstab.

commit 75bf5cfebf8833bc951254550c5855c4b0013542
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Nov 28 14:48:36 2013 +0100

    inspect: recognise Debian live images as such
    
    Check for filesystem.squashfs also in /live, since it is where
    live-build places it.

commit 04769ad507e1c84c8a04bf5fe9029ae20cc67600
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 26 18:32:01 2013 +0000

    launch: direct: Whitespace fix.

commit e7fa7f4d1691bc5e34b163509645c535ac6d8767
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 25 23:25:12 2013 +0000

    launch: Print program and version as part of standard debug output when launching the handle.
    
    There are a lot of cases where people post debugging output, but we're
    not sure precisely which version they are using.

commit 97ea81eb21e1be849b0e6b8fcdd2a9cda4edcb51
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 25 22:49:53 2013 +0000

    tests: Test that network drives are mapped to correct qemu -drive parameters.
    
    Although this test only specifically tests the direct backend, the
    same code is shared with the libvirt backend in some circumstances
    (eg. creating readonly drives).  So this is testing a bit of both.

commit 45afcdb30788d6cb9bdba14fe554b3b12a0d8479
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 25 20:07:27 2013 +0000

    ocaml: Remove unused function prototype.

commit 1ea1646e6f224dbc5b3922bb3c65aab4d71a9cb9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 25 17:02:29 2013 +0000

    po-docs: If *.pod files are missing, tell user to run 'make update-po'.
    
    I'm now fairly convinced it's not possible to do this automatically.
    However we should at least tell the user what needs to be done.

commit d81c577eff2519cd4ef7fb45ad33e711f5baacc8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 23 09:46:44 2013 +0000

    Version 1.25.11.

commit 53e45c82804dd52eca16867a287d025c3a63ed9d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 23 09:37:17 2013 +0000

    sysprep: Fix broken test when backend is UML.
    
    This fixes commit cc1888a4977eb4942254ea5ac15c1d0a47458317.

commit 78d452e9a65b407af3259d5dfaf7236b7ea8aebf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 22 17:16:11 2013 +0000

    Version 1.25.10.

commit 5ee193433a46d205e181bc51080e15f696bbda1a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 22 17:15:20 2013 +0000

    lua: Don't redefine lua_objlen if already defined.
    
    lua 5.2.2 seems to define this symbol already.

commit c90b0eff981858ab187516455f59744f1ce2d064
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 22 16:39:46 2013 +0000

    Version 1.25.9.

commit cc1888a4977eb4942254ea5ac15c1d0a47458317
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 22 14:40:18 2013 +0000

    sysprep: Add a test suite for the --password option.

commit 3712249f9659121277a0d2ca0549e02bc38e0cad
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 21 17:13:22 2013 +0000

    builder/sysprep: Allow accounts to be locked (RHBZ#1028660).
    
    This allows you to select both locked accounts and disabled
    passwords.  The two are subtly different concepts.
    
    A locked account [cf. passwd -l] puts "!!" at the beginning of the
    shadow password field.  Locking is reversible, because the "!!"  can
    be removed, restoring the original password.  Therefore "locked"
    acts as a flag in front of an existing selector.
    
    A disabled account has "*" in the password field.  Therefore it has no
    password.
    
    Note that an account may be both locked and disabled, although this is
    probably not useful.  The shadow password field will contain "!!*".

commit 02b5f00b2bf563d87134ad5f90ec06dbb9535bea
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 21 17:34:44 2013 +0000

    builder/sysprep: Allow 'random' as a password selector.
    
    This chooses a random password.

commit 91450b5f9a2bf0603971d7cdf3271f390ed0c2c4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 21 17:24:58 2013 +0000

    mllib: password: Replace password string with password_selector type.
    
    This is just code motion, there is no functional change.

commit 9186438937f5451ddfdaa33c9dcb9ffe27b2a098
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 21 13:57:07 2013 +0000

    builder/sysprep: Describe --password/--root-password option as "selector".
    
    It now appears in the respective man pages as:
    
      --root-password selector
    
    or:
    
      --password selector
    
    This avoids confusion from people who think these command line options
    take the password directly.

commit c7b0457c32b25fb289e9e1de3f960b12cebe4adf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 21 14:30:11 2013 +0000

    ls: Note that you can use virt-cat or guestfish to show file differences.

commit 90245512453bb404f50e54cddf052bce63385073
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 21 14:29:29 2013 +0000

    ls: In image diff example, don't use --time-t.
    
    It shows differences in file access times (atime) which is not
    actually that useful for most people.

commit 2d9f69db614c8fecdd11c879d00fca366850e720
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 19 17:49:45 2013 +0000

    FAQ: "execl: /init: Permission denied" error also caused by /init not being executable.
    
    This updates commit 98cd329323d35ab54efd976e095ae9cbf18ad338.

commit 98cd329323d35ab54efd976e095ae9cbf18ad338
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 19 16:59:34 2013 +0000

    FAQ: Attempt to explain "execl: /init: Permission denied" error.

commit acce28e8874e08acce0a6cd7a6703043a1e4ec25
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 19 09:09:02 2013 +0000

    lib: Make sure -lselinux is used when linking libguestfs.so.
    
    If libselinux was detected, it was not added to the linker command
    line.  This still worked (at least on Fedora) because some other
    library pulls in the dependency implicitly, possibly libvirt.  However
    this broke on Arch:
    
    https://aur.archlinux.org/packages/libguestfs/
    
    Reported by and thanks: Antoni Segura Puimedon.

commit 59596810b009744316941da8ef18b7e75b503b9f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 15 09:05:43 2013 +0000

    daemon: btrfs: Upstream 'btrfs device add' command now needs '--force' option to work.
    
    However earlier versions didn't have the --force option, so we
    have to detect it.

commit 64f93b36de5ae334c4e3eb82c0501285eec35d5a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 14 17:01:12 2013 +0000

    Version 1.25.8.

commit 793a5677cbd6f80ae0f4fbc3cdf478e7f84edadb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 14 15:50:03 2013 +0000

    virt-win-reg: Allow URIs (RHBZ#912193).

commit c032130226bdca539b8ac34ce622e5cd9a71c152
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 14 15:45:23 2013 +0000

    perl: Give error instead of crashing if optarg is not an array reference.
    
      $g->add_drive ("", server => 1);
    
    would segfault.  Now it gives a nice error instead:
    
      array reference expected for 'server' argument at [line]

commit 6a1061663fa467d43777a8ed98f4f07750125012
Author: Török Edwin <edwin@etorok.net>
Date:   Thu Nov 14 11:13:50 2013 +0200

    Avoid modulo bias in random password generation
    
    Char.code (input_char chan) mod nr_chars has modulo bias because
    the original interval is not a multiple of the destination interval,
    i.e. 256 mod nr_chars != 0.
    
    One way to fix this is to keep generating random numbers until they fall outside
    the interval where modulo bias occurs, that is accept only c=[256 % nr_chars, 256).
    That interval maps back to [0, nr_chars), and has a length of
    (256 - 256 % nr_chars), which is a multiple of nr_chars.
    
    RWMJ:
     - Modify the code so it goes into a utility library.
     - Use the same code across virt-builder and virt-sysprep.

commit f013b15fa1daf623cbf39007182c44c734e9bc79
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 14 10:09:52 2013 +0000

    mllib: Add a utility function for safely reading from /dev/urandom.
    
    OCaml's buffered 'in_channel' has a 64k buffer, so using it to read a
    few bytes from /dev/urandom removes a lot of the system's entropy (for
    example /proc/sys/kernel/random/entropy_avail goes from ~3000 to 128).
    
    This patch was originally by Edwin Török for builder.ml.  I
    generalized it because there are two other places where we did
    over-sized reads from /dev/urandom.

commit 544d6b25e345e2317b1f2e92684af6c08e1c58ba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 12 19:57:29 2013 +0000

    builder: Clarify architecture section of the documentation.
    
    I have checked and cross architecture builds work fine:
    
    http://rwmj.wordpress.com/2013/11/09/virt-builder-running-on-arm/#content

commit fb41ce252f551e818d86d6f8c70b9caa10a05bcb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 12 08:49:45 2013 +0000

    Change supermin man pages section 8 to section 1.
    
    Corresponding change in upstream supermin:
    https://github.com/libguestfs/supermin/commit/cb3f9e8bbaf5e612fdf97caf9f47a4cd839c3438

commit edacd479faf7175eb2ddb10dd8c7ab4c90db5d0b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 11 18:34:49 2013 +0000

    podwrapper: virt-install is not a libguestfs page.
    
    This now redirect to http://man.he.net/man1/virt-install, but this is
    unfortunately a 404.
    
    Incomplete fix for RHBZ#1029134.
    
    Thanks: Paul Maunders.

commit 4b2e9c9264dcebd3c5945050b7f1d1b4cb4d3dae
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 11 12:29:35 2013 +0000

    builder: debian: Remove bogus proxy from apt configuration.
    
    Thanks: Daniel Miranda

commit 50aca447eabaa8c47f7b6adf57db48a225bf589e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 11 13:15:19 2013 +0000

    builder: After building a template, print fields for index file.

commit 299e3153eefc4eabfcaada55efd34380bf48d42b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 8 16:14:41 2013 +0000

    Version 1.25.7.

commit 300b357eb98445926a096927655763a8d2150271
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 8 16:13:35 2013 +0000

    builder/website: Add some missing files to EXTRA_DIST.

commit 63ec023f19f2b397dfa629a8674bb9fbed752c71
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 7 15:30:13 2013 +0000

    builder: Allow /tmp or /Temp to be symlinks to a directory.

commit 7a8addb48553c90cf34cea5804d9d139e1c81b85
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 7 15:29:51 2013 +0000

    builder: Allow upload to directory when target is a symlink to a directory.

commit e982c0a2f56a5324d41b90b7a8f2715412f7e899
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 7 14:05:45 2013 +0000

    Update TODO: Remove some things that we've done.

commit 55795e652ebeb8f1860e8204d738b4af94a9975f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 6 19:16:00 2013 +0000

    builder/website: Add support for RHEL 5 releases to internal RHEL script.

commit 133ae6a34b5bdf8c831b0ee967eb1f7798062943
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 6 19:15:42 2013 +0000

    builder/website: Don't use http_proxy in internal RHEL script.

commit e906d30c62fcca597fa4ddb4d620ea1f9b83b8b2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 6 21:39:52 2013 +0000

    builder: After compressing the template, calculate the SHA-512 hash.

commit f459fe47f899e2e93a455a1338860a2b11165c9e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 6 21:39:34 2013 +0000

    builder: Add a Scientific Linux 6 image.

commit 7147d415645d2c66b459c4bf366b6288ddbf2584
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 6 19:19:20 2013 +0000

    builder: Old OCaml didn't have List.iteri, so add a utility function.

commit e9294668b4cd5cfa10ab4d936bccb271107f138b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 6 16:54:08 2013 +0000

    builder: Add script for making Red Hat Enterprise Linux instances.
    
    This uses some internal Red Hat repositories so it's not generally
    useful, but could be easily adapted by users.

commit b3a106cefc5dcb356ffb66ef53eba19452ebb60e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 6 15:08:08 2013 +0000

    builder: Fail if lex is not installed.
    
    This completes the fix for commit a4800e2d4fc50f372a8b626333c4fbb9b8ca9633.

commit 4dd6e4328ca57020e8e415e99925eab73b2fe95e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 6 13:42:58 2013 +0000

    builder: Use common code to sysprep, sparsify and compress images.

commit c76912cd778281f70490b05a276c140eacf8c647
Author: Adam Huffman <adam.huffman@gmail.com>
Date:   Wed Nov 6 13:32:32 2013 +0000

    builder: Add script for making Scientific Linux instances.
    
    RWMJ:
     - Renamed the script from sl.sh -> scientificlinux.sh
     - The output file is called scientificlinux-$version
     - I fixed some whitespace issues so it's now similar to the CentOS script.

commit f526fe1766471b51b92cad74af0103d1889db83a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 5 22:25:59 2013 +0000

    builder: Fail if bison is not installed.
    
    This partially fixes commit a4800e2d4fc50f372a8b626333c4fbb9b8ca9633.

commit 4339b55d105eab6eba2756bffff42a1c34f9f656
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 5 17:40:20 2013 +0000

    builder: Add dependencies which automake doesn't generate correctly.
    
    This is a further attempt, earlier commits:
    commit e3ac293e869a4c69225e3d954b812e9bf21588a1
    commit dfe97b352d6b398c3cb3ddb1c9984767722e514b

commit d669db7ff0a2f8216ae8287d4c74314c5d9e2f13
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 5 16:54:37 2013 +0000

    Update to latest gnulib to get hash relicensing change (thanks Jim Meyering).

commit 663012c5ffecc6f89ad164d292fc0f970338f824
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 5 16:51:08 2013 +0000

    builder: Fix centos script - output filename was wrong.
    
    This fixes commit 2f3fb2420e7f2ccc19fdc863ecc7b7ce29dd6aa1.

commit 6db81dc72e043c2d498a30d4326748089501497f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 5 16:13:17 2013 +0000

    Version 1.25.6.

commit e3ac293e869a4c69225e3d954b812e9bf21588a1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 5 15:56:34 2013 +0000

    builder: Add dependency from index-parse.h to index-validate.
    
    For some reason automake doesn't get this dependency right,
    resulting in occasional build failures if yacc races the
    rest of the build.

commit 01551e546293bbbd094d4d4acfdaf421f7758251
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 5 15:43:24 2013 +0000

    builder: Add some generated files to CLEANFILES.
    
    This updates commit a4800e2d4fc50f372a8b626333c4fbb9b8ca9633.

commit dfe97b352d6b398c3cb3ddb1c9984767722e514b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 5 15:42:05 2013 +0000

    builder: Add missing dependency.
    
    index-parser-c.c depends on index-parse.h being created first.
    However without an explicit dependency, this is not done (and implicit
    deps don't work because automake doesn't sufficiently understand OCaml
    programs).
    
    This fixes commit a4800e2d4fc50f372a8b626333c4fbb9b8ca9633.

commit 96eab7cc003a9b5457fed311cec27852ce22344c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 5 15:19:08 2013 +0000

    Version 1.25.5.

commit ab801c2657354639ae7bad1cd60ad387592249f4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 5 15:16:55 2013 +0000

    Don't include email addresses in AUTHORS file.
    
    Some authors had duplicate entries because they had multiple
    email addresses.

commit 92206e8d09455b3ec63d44e4b55d5eef415681af
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 5 15:15:17 2013 +0000

    builder/website: Add validate.sh test script to EXTRA_DIST.
    
    This fixes commit 154bfb7dd46e7998eed1d40ead95923590763739.

commit 2f3fb2420e7f2ccc19fdc863ecc7b7ce29dd6aa1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 5 14:08:01 2013 +0000

    builder: Replace centos-6.sh with a single script.
    
    Just use:
    
      ./centos.sh 6
    
    Note that you don't need to be root.

commit af9e9299bf0f422d7e07ccfe9a59e664b49c2dfe
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 5 14:08:01 2013 +0000

    builder: Replace debian-<NN>.sh with a single script.
    
    Just use:
    
      ./debian.sh 6 squeeze
    
    Note that you don't need to be root.

commit 91b5e7fb37751719304573882c521071aa811e36
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 5 14:08:01 2013 +0000

    builder: Replace ubuntu-<NN>.sh with a single script.
    
    Just use:
    
      ./ubuntu.sh 10.04 lucid
    
    Note that you don't need to be root.

commit ade0f1a97d6371f5d5a538da9d41263146cc58d6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 5 13:59:55 2013 +0000

    builder: Replace fedora-<NN> shell & kickstart with a single script.
    
    Just use:
    
      ./fedora.sh 18
    
    Note that you don't need to be root.

commit 681c88ef5d69b1dec4b929ff3451c45968023e5a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 5 10:21:32 2013 +0000

    builder: Internal implementation of parallel xzcat (pxzcat).
    
    Instead of calling out to the pxzcat program, use an internal
    implementation.  This requires liblzma to be available at build time.
    If it's not available, fall back to using regular xzcat.
    
    It is intended that eventually this code will go away when regular
    xzcat / unxz is able to use threads.

commit 7e2576a74a93474bc04525adc398cdc4144f389d
Author: Nikos Skalkotos <skalkoto@grnet.gr>
Date:   Tue Nov 5 12:15:47 2013 +0200

    Fix fstab block device resolution for FreeBSD
    
    The device name prefix for IDE hard drives used to be `ad' but now
    is `ada' (http://www.freebsd.org/doc/handbook/disks-naming.html).
    For virtio hard drives it is `vtbd'.
    
    Under an MBR partition table a slice will be used, so the name of
    the first partitions will be either `ada0s1a' or `vtbd0s1a'. Under a
    GPT partition table, where no slice is needed, the name of the first
    partition will be either `ada0p1' or `vtbd0p1'.
    
    Signed-off-by: Nikos Skalkotos <skalkoto@grnet.gr>

commit 154bfb7dd46e7998eed1d40ead95923590763739
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 5 07:25:46 2013 +0000

    builder/website: Add index validation test script.

commit cd10f6f4db32689b2552b52a4875795be8b35694
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 5 07:20:37 2013 +0000

    builder: Add an extra Makefile.am to builder/website.

commit 2035a75d66676c5fb2cc047a36c174dd953cd1b9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 5 07:15:19 2013 +0000

    builder: Fix missing files in EXTRA_DIST.
    
    This fixes commit a4800e2d4fc50f372a8b626333c4fbb9b8ca9633.

commit 004bf7c3db8fd87e8a041d97f06f8dcedd4ee8ff
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 4 22:33:48 2013 +0000

    Version 1.25.4.

commit 2dca9d719434f6783e11976699e45a98128ca913
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 4 22:13:23 2013 +0000

    builder: Fix 'check-valgrind' so it does something in this directory.

commit a4800e2d4fc50f372a8b626333c4fbb9b8ca9633
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 4 14:53:41 2013 +0000

    builder: Add a real scanner/parser for index files.
    
    This adds a tool called virt-index-validate to validate index files.

commit 3ffdddbedf176fa5f12172fb2e3c6bd4b2690f9e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 4 21:35:48 2013 +0000

    builder: Don't use git tree / libguestfs.git to refer to the source.
    
    git is just a VCS.

commit 50486232db08ccad4b38f5addfcef92b0f4faef3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 2 08:31:27 2013 +0000

    df: Allow parallel test to be skipped.
    
    It currently fails because of
    https://bugzilla.redhat.com/show_bug.cgi?id=1025942

commit 5280e3031be9d1f72d03510483fa22634b5d9af5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 1 16:47:20 2013 +0000

    builder: Only warn about unknown fields in the index if -v option is used.
    
    Allows us to add new fields in future without having pointless
    warnings from old versions of virt-builder.

commit 8d14abb0df1e216682fa9c35bda3d4ecdb9b4dd2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 1 16:45:52 2013 +0000

    builder: Allow checksum= as an alias for checksum[sha512]=.
    
    This is for backwards compatibility with virt-builder 1.24.0 which
    could not parse a key that contains square brackets and numbers.
    
    This updates commit 4b73e0be29302da0ae8c5c79a51e770cbe6ed7cf.

commit 5b9ac57d4e4eb6a9f190f734c8aaa98fd24a4816
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 1 15:10:11 2013 +0000

    builder: Update TODO file with some more ideas.

commit 20ad6becd87d281fa237748ef7e7c2df6c5ee3d8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 1 14:44:36 2013 +0000

    Version 1.25.3.

commit e9d908929fd87ef8adb6f95f35da35e39876f148
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 1 14:45:39 2013 +0000

    builder: Add missing files to EXTRA_DIST.

commit 7113aee0b439b411602d8d7d4b03bf02bc91b800
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 1 14:33:25 2013 +0000

    ./run: Disable timeouts in tests on RHEL 6.
    
    Workaround for https://bugzilla.redhat.com/show_bug.cgi?id=1025269

commit bb4e882d61b49045aabd35912ae7e3a18cd6028b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 1 14:16:34 2013 +0000

    builder: Allow multiple source paths to be specified.
    
    Users can now specify multiple source paths, eg:
    
      virt-builder --source http://example.com/foo \
        --source http://example.com/bar
    
    to get templates from multiple places.
    
    There is still only one built-in path, but we can add more later.

commit b25e8da6d60875d1b7416558ecb24fe3e161654d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 1 13:48:30 2013 +0000

    builder: When debugging, print curl command before running it.

commit 4b73e0be29302da0ae8c5c79a51e770cbe6ed7cf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 29 21:03:15 2013 +0000

    builder: index: Add checksum[sha512]=... option and deprecate template sigs.
    
    We don't need to sign individual templates, provided the signed index
    file contains the cryptographically secure checksums of the templates.
    Since the index file cannot be interfered with and the checksums
    cannot be spoofed, this is sufficient to ensure the integrity of the
    templates.
    
    Note the template signatures are now deprecated and will be removed in
    libguestfs 1.26.  To avoid any backwards compatibility issues, I will
    backport the relevant changes to the stable-1.24 branch.
    
    Thanks Dennis Gilmore for pointing out that we could do this.

commit 3b746ee796770302893e9aee20d077c1f67e0c01
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 1 08:21:23 2013 +0000

    ./run: Fix massive thinko in $PATH setting.
    
    This fixes commit 76c20d761b24195b3cd7a620524ae84ed0ab6ab3.

commit 984b024c5a74dd47b99dee128f8709dd36e56fb1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 29 21:03:01 2013 +0000

    builder: Whitespace change in error message.

commit 124f20a1ca49749af40f1052bb9506ec9a8b7046
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 29 21:02:39 2013 +0000

    builder: Be more careful about deleting temporary files on exit.

commit 9ac076c269f3396a01c699fb71ccb32c00bed6ca
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 29 21:01:54 2013 +0000

    builder: Whitespace fix in Index_parser module.

commit 2191b9ae4008c3352413dbb8c5394739c8a23574
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 29 19:45:23 2013 +0000

    Version 1.25.2.

commit e4c9212a8e9fe9c2a75ce5035a4c3bce53261018
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Tue Oct 22 16:17:25 2013 +0800

    sysprep: add feature of deleting specified paths
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>
    Signed-off-by: Richard W.M. Jones <rjones@redhat.com>

commit 42e445f98692c6344baafaab1da10e821288ac0a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 29 19:23:33 2013 +0000

    builder: Add -m/--memsize and --smp command line options.

commit eb4e356bc3bc96be040763def8c274eee82cafcd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 13 15:45:38 2013 +0100

    launch: direct: Add some code to enable qemu / gdb debugging.
    
    See the comment for details.
    
    Note this is disabled by default.  Developers can only enable it by
    changing #if 0 -> #if 1.

commit 12e0e3fb0948d9e2975f2bfa596d068d83b717fa
Author: Matthew Booth <mbooth@redhat.com>
Date:   Tue Oct 29 13:27:30 2013 +0000

    docs: guestfs_case_sensitive_path returns error on non-existent path

commit 2f85affefbd505a7582e8188d4483108b3aa10e6
Author: Daniel Exner <dex@dragonslave.de>
Date:   Tue Oct 22 20:44:43 2013 +0200

    Initial FrugalWare support.

commit 276cde033c454e084e38c36af693c3fcad86281f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Oct 27 18:50:07 2013 +0000

    builder: Add CentOS 6.4 guest.

commit 2937c035958f84986e84c47df49f79d19c4b5b59
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Oct 27 14:59:39 2013 +0000

    builder: Add a section on performance to the manual.

commit 76c20d761b24195b3cd7a620524ae84ed0ab6ab3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 26 20:23:22 2013 +0100

    ./run: Adjust $PATH to include all libguestfs binaries.
    
    Instead of typing:
    
      ./run ./fish/guestfish ...
    
    you can now use:
    
      ./run guestfish ...
    
    This is shorter, but there are also two good reasons for this change:
    It never made any sense to run the system-installed guestfish (or
    other) binary.  It would be unlikely to work.  Also binaries in
    libguestfs should be able to call other binaries freely without adding
    special exceptions (which we had before this change).

commit f114e28cc80eabdcf47c97e7e3895065cdfe4886
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 26 17:09:06 2013 +0100

    firstboot: Send the output to the console as well as to the log file.
    
    For systemd:
    Currently stdout+stderr go to the journal (these are effectively
    empty unless there are gross errors).  The output of the commands
    goes to the log file.
    
    With this change, the output goes to the journal, the console and
    the log file.
    
    For SysV-init:
    Currently stdout+stderr go to the console (but these are effectively
    empty).  The output of the commands goes to the log file.
    
    With this change, the output goes to the console and the log file.

commit 8b34855684fb660823a2801a4a5e8be32a6cc40f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 26 14:45:30 2013 +0100

    builder: Document how to boot VMs directly in qemu or KVM.

commit 0520aa3c42fbb174be37ef75b19390855d225897
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 26 11:40:48 2013 +0100

    builder: Add --write option to write a literal file.

commit 10c849ed1cb4375c5ef811197fa0a3206d365b86
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 26 11:27:06 2013 +0100

    builder: Allow --upload to a directory.
    
    Also set the owner and permissions on the destination file correctly.

commit cede5316b06fbaa8448ef1a109666edc55acb71e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 26 11:01:51 2013 +0100

    Version 1.25.1.

commit 2add5c9295c704738fbe183463243d4b65392bab
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 25 14:11:43 2013 +0100

    builder: Don't fail if ~/.cache doesn't exist (RHBZ#1022431).

commit dd5959cd8875496594df0fdbb8a00cbe6618c9ee
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 25 13:36:19 2013 +0100

    builder: Copy-editing on documentation.
    
    Plus some ideas added to TODO file.

commit 99840550d5508b228ee4b2533ad94da517873f76
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 25 13:35:51 2013 +0100

    builder: Add --mkdir option to create directories.

commit b3ab3b452ac9654ec9460e0eb881839432a38928
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 23 11:37:11 2013 +0100

    builder: Fix two problems in --help output.

commit 3f46a92ed5737bb8d75630a39729f95bc96417f6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 22 22:28:27 2013 +0100

    builder: Add --no-sync option to avoid sync on exit.

commit f59a404568c3076feeeaef7836dbd5cbf68720a2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 22 17:56:11 2013 +0100

    Revert "java: Remove version number from the jar file (RHBZ#1022184)."
    
    This reverts commit 7330ccd288a001d33866308ff8d679a884230d83.
    
    See comment in https://bugzilla.redhat.com/1022184

commit 7330ccd288a001d33866308ff8d679a884230d83
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 22 17:44:33 2013 +0100

    java: Remove version number from the jar file (RHBZ#1022184).

commit d4450c6590744ab96c7e0c3b21325d1eff666f29
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 22 14:22:46 2013 +0100

    builder: Use pxzcat (optionally) to speed up xzcat step.

commit 0e18bccb648f8c96366ae53746d83bd009f924f7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 22 14:09:20 2013 +0100

    builder: Make xzcat binary configurable and use AC_PATH_PROG.

commit 2f3a3e308af8012501437f723471a66537ecbf64
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 22 13:52:25 2013 +0100

    builder: Don't run virt-resize when not necessary.
    
    If:
     - the output is a regular file
     - the output format is raw
     - the user didn't specify the --size option
    then we don't need to run virt-resize.  Simply uncompress
    the template directly to the output file.

commit 2a76aa22c7105aa165d8fee6360ca6dbaf4027c3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 22 13:58:33 2013 +0100

    build: xz is required.
    
    It is needed for libguestfs-make-fixed-appliance and many other places.

commit 5b89dd4aa1e918890c5958b96857a6c249203dbc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 22 13:48:41 2013 +0100

    mllib: Create config.ml from configure and use it for --version options.
    
    Also don't internationalize the output of the --version option, as
    that isn't useful.

commit d6e5a6546afeb1554e676e5a4197002559f6cde7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 19 22:27:52 2013 +0100

    configure: Use AC_PATH_PROG{,S} for external programs used by the library.

commit a29777c111102e0b2419993b66f4124fa93286ea
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 18 17:55:45 2013 +0100

    Version 1.25.0.

commit 356e6a6504644768203e9ed611cfa920c3e3d070
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 18 17:38:46 2013 +0100

    Version 1.24.0.
    
    New stable branch.

commit 3b69792cd511faad22545e80beb3d15103f0e5ae
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 18 11:46:16 2013 +0100

    appliance: When valgrinding daemon + error path, sleep so valgrind messages are seen.

commit dfaf417fefbf979ffc47cf4723ebd306fac88130
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 18 11:45:53 2013 +0100

    appliance: Add comments to init script.

commit 1e24b8827054a2c7907439322c4eda25dd8580a8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 18 13:17:30 2013 +0100

    resize, builder: Improve speed by using cache=unsafe on newly created files.
    
    However because qemu might open these files immediately afterwards
    using cache=none, we have to sync the file before exiting.

commit 9a4bfb386ee05d3889269d1d41701793f97b2486
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 18 13:16:40 2013 +0100

    resize: Rearrange objects.
    
    This is just build refactoring.

commit 18c93ac61f8f5a0059d8ceda37f963ad4c06d19d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 18 09:09:59 2013 +0100

    RHEL 5: Don't use 'truncate' command in tests.
    
    Use 'guestfish sparse' instead, which is roughly equivalent.
    
    See commit ef1514aa1e0a099d71cbb7d2c5f24f9f32e1939d
    and commit 39df80dcc0e485e69048bddbf33c259ce532e50d.

commit b68a99b8e272267dc78694c0356e137f58c976f0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 17 16:03:08 2013 +0100

    Finalize release notes for libguestfs 1.24 release.

commit 6611d45ab7b2b0ca2656d11f7740eaf7d4100140
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 17 15:49:13 2013 +0100

    Update PO files from Transifex.

commit bbac0beab9f2fdb5c57b0e0db636c18662d99c2a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 17 15:48:44 2013 +0100

    Update ROADMAP.

commit feaf8718569b44529885dca6afba063ee3565c70
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 17 15:47:56 2013 +0100

    API support: Fix website directory for new location.

commit ad82de35b7e504e3638b3c1f8561df3c02313832
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 17 15:47:52 2013 +0100

    Update API support.

commit 3cce894f1ba4b1f08bbfe260105508df680273ee
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 17 15:42:38 2013 +0100

    Update TODO.

commit 24a315507d1293a0ec097b57d15efb3dae784489
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 17 15:12:19 2013 +0100

    Add man page for /etc/libguestfs-tools.conf (RHBZ#1019889).
    
    Add a man page to document this configuration file.  This is
    required by some distros, eg. Debian and RHEL.

commit 13b79aacca952974d5bac4b77a18d29a32b34593
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 17 15:03:37 2013 +0100

    Use qemu-img -o preallocation=metadata where possible.
    
    When format is qcow2 and we're *not* using a backing disk, we can use
    preallocation=metadata for better performance.

commit 54fb09e052d8cad50397f1085c1bdd346a13e659
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 9 12:08:10 2013 +0100

    fish: CVE-2013-4419: Fix insecure temporary directory handling for remote guestfish (RHBZ#1016960).
    
    When using the guestfish --remote or guestfish --listen options,
    guestfish would create a socket in a known location
    (/tmp/.guestfish-$UID/socket-$PID).
    
    The location has to be a known one in order for both ends to
    communicate.  However no checking was done that the containing
    directory (/tmp/.guestfish-$UID) is owned by the user.  Thus another
    user could create this directory and potentially modify sockets owned
    by another user's guestfish client or server.
    
    This commit fixes the issue by creating the directory unconditionally,
    and then checking that the directory has the correct owner and
    permissions, thus preventing another user from creating the directory
    first.
    
    If guestfish sees a suspicious socket directory it will print an error
    like this and exit with an error status:
    
      guestfish: '/tmp/.guestfish-1000' is not a directory or has insecure owner or permissions
    
    Thanks: Michael Scherer for discovering this issue.
    
    Version 2:
     - Add assigned CVE number.
     - Update documentation.
    
    Signed-off-by: Richard W.M. Jones <rjones@redhat.com>

commit 34da8850bb414e87f0ffd830506da77a7c0406b9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 16 16:32:06 2013 +0100

    builder: When doing maintainer test for new guests, test adding a user account.

commit 61306130f851ba0f3b8560e44b8f16881bcf8679
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 17 10:39:21 2013 +0100

    launch: libvirt: Add guestfs-<random> name to the handle.
    
    This is so we can display the random name in debug messages.

commit fc733cf9434b196b57ff3b00c790734a8063b0b7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 16 10:48:07 2013 +0100

    FAQ: useradd -> usermod.
    
    This fixes commit dd554d94ad2f381c37c4a5229502963058c2c9f4.

commit cb49299c13a15de9beae255d14f6bde04e788282
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 15 20:41:07 2013 +0100

    Version 1.23.33.

commit f08ef9778bca2646f72e3ea2116cbaf5f1899996
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 15 15:18:18 2013 +0100

    builder: Add maintainer test for new guests.
    
    This is not part of the automated test suite.  It's a manual test run
    by the maintainer which must be run on each new guest to ensure that
    all the virt-builder features work on the new guest.

commit b816f29adaab29c7c62ddb90d05715aa8f9e175b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 15 17:31:52 2013 +0100

    firstboot: Ensure firstboot scripts run in command line order.
    
    Previously they ran in effectively random order.

commit a3e5bc7bfa4146e2176e93cafaad19a555104062
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 15 17:30:08 2013 +0100

    sysprep: firstboot: Don't set `Created_files flag unless files are created.

commit 356a749bba464260434823dfde14d0ed2aae958d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 15 16:10:28 2013 +0100

    firstboot: Add some debugging to the control script.
    
    For reasons unknown, firstboot does not work on Debian 6 & 7.
    https://bugzilla.redhat.com/show_bug.cgi?id=1019388

commit 49e6ba51e3a75a84fc8da867fb5d3ef40c7c4665
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 15 16:19:43 2013 +0100

    sysprep: random seed: Try much harder to create a random seed file.
    
    Since this is essential for security, be much more proactive about
    trying to create a random seed file, even for guests which have buggy
    installers that don't create this file during installation.

commit 862da5dd79f66ca8df620e94170352f8bcd8bff7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 15 15:32:34 2013 +0100

    builder: Really force apt not to ask questions.
    
    This fixes commit b812a0d45992e729a85f10483ae26b82b8e2da90.

commit 8b977d152a02e8be273fbdbfcdde5625e0e62cb2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 15 14:46:40 2013 +0100

    builder: Remove capital O and lower case L from random root password.
    
    They look too much like 0 and 1.

commit 70e660a157dd57f0c3edcd27dafd2ff915711e0c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 15 14:37:48 2013 +0100

    builder: Wrap program in an exception handler which pretty-prints common exceptions.
    
    This looks like a large change, but is mainly just reindenting
    everything into a 'main ()' function.

commit fd63d896445260ce83f88e58c0219606f97dca9e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 15 14:19:53 2013 +0100

    builder: Remove nbdkit-xz-plugin support (it was disabled anyway).
    
    We can re-add this later if libvirt gets fixed, but for now simplify
    the code and concentrate on the one code path.

commit d8499c428a9234c816c2a0c1c3109df89d563e47
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 15 14:08:39 2013 +0100

    builder: Move command line argument processing to separate source file.
    
    This is just code motion.

commit 2bc223b6b28982e6fdb9f8810e81ec4aa7ea83f4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 15 09:53:08 2013 +0100

    firstboot: Fix test for installing sysvinit scripts.
    
    This fixes commit 9aa13e057497a91ce9037f18a51ea6f35b4f2aa5.

commit b812a0d45992e729a85f10483ae26b82b8e2da90
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 14 23:25:31 2013 +0100

    builder: Try really hard to make apt non-interactive.

commit ec6f9ee542e0e9ad0109a7522e83ea07b2f8a002
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 14 14:55:53 2013 -0400

    appliance: Remove cruft and run udevd directly.
    
    This commit removes a lot of cruft from old RHEL which was required to
    start udev.  Instead we run the daemon directly.
    
    Also it removes the fallback path which created some device nodes in
    /dev by hand.  This likely did not work.  This also removes the
    dependency on MAKEDEV which is long gone from most distros.
    
    This is required for Ubuntu, since the /etc/init.d/udev script didn't
    actually work.  The most common symptom was that /dev/virtio-ports/*
    was not created because udev didn't process the cold start events.

commit c9f98011fc34cba89c270732289854d75704ba31
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 14 18:07:22 2013 +0100

    Version 1.23.32.

commit d9008e141ca7e4308165486d0505df162edd1de9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 14 18:21:32 2013 +0100

    build: Add missing EXTRA_DIST files.

commit ec0d0e0f624f1c1fa94f8cfc6f191b3d52bc7c91
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 14 18:20:21 2013 +0100

    build: Add maintainer-check-extra-dist rule.
    
    This is used by the maintainer to check for missing files
    in EXTRA_DIST.

commit 56928b53810ae35f9b4d0e2fb24bdf7b3974721c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 14 18:20:55 2013 +0100

    build: Don't hard-code list of virt-builder templates in top level directory.
    
    It's troublesome for maintenance.  Use a wildcard here.

commit 9c7497a1eb549c11295a7711f18b2e8e4de0d1e0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 14 15:51:47 2013 +0100

    Update to latest gnulib.

commit 9aa13e057497a91ce9037f18a51ea6f35b4f2aa5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 14 14:56:56 2013 +0100

    firstboot: Install both systemd and SysV init scripts.
    
    This should be safe, and avoids the whole issue of whether a guest
    uses systemd or not.  Also it is possible to switch init systems
    (eg. by specifying init= on the command line) so it's not even clear
    if a guest "is" systemd.
    
    Thanks: Tom Gundersen on #systemd.
    
    This updates/fixes commit 596de56a436d56886616f5cc213bb72a4f6f5561.

commit cff95392f58a00654df3ffd2d9b09f58ae5e4e32
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 14 14:56:13 2013 +0100

    firstboot: Start service after network only.
    
    Not necessary to wait for syslog since (a) we do our own logging
    to a file and (b) syslog might not be installed.

commit 596de56a436d56886616f5cc213bb72a4f6f5561
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 14 14:05:27 2013 +0100

    firstboot: Fix firstboot scripts so they work on Ubuntu.
    
    Ubuntu 13.10 has /etc/systemd but uses Upstart.  This confuses the
    script because it assumed that if you have /etc/systemd then you are
    using systemd.  Ubuntu includes systemd services (inherited from
    Debian) but they just don't run.

commit 234c3801280a95fe8f2dc3e2523bee9e03f7f407
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 14 13:45:10 2013 +0100

    builder: Add --notes option.
    
    This displays the release notes.

commit d0b62bd500caf2c034e65b52c72368a006e135dd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 14 13:44:41 2013 +0100

    builder: Add short synopsis in --help output.

commit cc15877f079bbc13371794af5273035fc8e51520
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 14 13:44:06 2013 +0100

    builder: Tidy up release notes for operating systems.

commit 7e7017957ec067eb4e3f78d52003362a22f5d552
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 14 13:40:57 2013 +0100

    builder: debian/ubuntu: Add notes about running dpkg-reconfigure.
    
    Required to regenerate SSH host keys.

commit 6238cc84f6e539570792010881c98daae57bd946
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 14 13:27:07 2013 +0100

    builder: Fix typo in man page.

commit 22d182dbcb45595d170891857300d5fdc470dd63
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 14 12:33:06 2013 +0100

    builder: Fix output to block devices.
    
    If the output is a block device:
    
    - Detect the size of the output device.
    
    - Don't attempt to delete the output device on failure.
    
    - Turn off sparse copying in virt-resize.

commit fb4dd1b55a47b3bcfcd76a22b52ff3c99ded60e4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 14 12:32:29 2013 +0100

    resize: Add --no-sparse flag to let you turn off sparse copying.
    
    Useful when the target is a block device containing old data.

commit ceaa1ef0b8bc1ed7d86da0e126a9134699ebd066
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 14 13:15:04 2013 +0100

    builder: Run 'apt-get update' before trying to install packages.

commit dd554d94ad2f381c37c4a5229502963058c2c9f4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 14 12:32:04 2013 +0100

    FAQ: Clearer instructions for Debian and Ubuntu users.

commit b08d8e15bb5c758ce9ea1dbc934e47d16c7cec66
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Oct 13 18:12:02 2013 +0100

    builder: Kill any daemons started by installed packages.
    
    Some --install requests may pull in packages that start daemons (dbus
    being a favourite daemon apparently).  These daemons will prevent the
    disks from being unmounted and everything being cleaned up at the end.
    Add some experimental code to kill these daemons.

commit e8e0d98ef8cb5834d8dfb213fbfb5c9d69ea8b78
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Oct 13 17:51:12 2013 +0100

    builder: Add more templates to the list which is copied to the website.

commit 5d22ee8760d87072fabae072103bbe2ea9b65ffa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Oct 13 17:50:16 2013 +0100

    builder: Add the logo to the HTML manual page.
    
    Unfortunately:
    
     - It appears below the TOC.  This is unavoidable because of the
       flow of the current HTML.
    
     - The logo is now duplicated in git.

commit 2224372016f4a4fd62e9aa265800c447b3886cf9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 12 21:55:18 2013 +0100

    Version 1.23.31.

commit 6e77422800a6086a4c505afe71f5cc57422c33be
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 12 21:51:47 2013 +0100

    po: builder: Hack to remove duplicate message definition.
    
    Because we're not running msgmerge but concatenating the PO files, you
    can get duplicate messages (in this case "no"), resulting in this
    error:
    
    libguestfs.pot:6142: duplicate message definition...
    libguestfs.pot:3285: ...this is the location of the first definition
    
    Just work around this for now.

commit f3484ff3b4a06cfa0ef80894b9d53c32d9212142
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 12 21:28:44 2013 +0100

    builder: Document how to enable virtual consoles on Debian guests.

commit 1df6905c805d807bfeb86d0d687e05c3209123e3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 12 20:25:52 2013 +0100

    builder: Add --edit option.
    
    This allows you to use Perl to edit files in the guest.
    
    This works very similarly to the 'virt-edit -e' (non-interactive
    editing) function.

commit c80dcc2da62f0c265b205716f84fa37b14849882
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 12 20:31:39 2013 +0100

    builder: Small copy-edit to the manual.

commit 04041f23d01094b5c811c039810c19c45ff6e7ca
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 12 20:22:10 2013 +0100

    edit: Add virt-edit --edit as an alias for virt-edit -e.
    
    This just adds the alias and does nothing else.

commit a010ab51473dd27416c98628d5358859c62b4ee9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 12 20:24:26 2013 +0100

    builder: Upcase --delete and --scrub option arguments in man page.
    
    For consistency with other options.
    
    This updates commit 7820aaf1f3f1402811c1c3c8b2239aec0e12cf5e.

commit f7ca38b728a5bf1d567f74acdd6d2112cbd2a3da
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 12 20:10:34 2013 +0100

    appliance: Disable LD_PRELOAD libSegFault in virt-rescue shell.
    
    Commit c598e14052399f19d36d7874d7133cba779bd3c2 exports
    LD_PRELOAD=/lib64/libSegFault.so so that guestfsd and processes that
    it runs will produce descriptive stack traces.
    
    However it exports it to everything including the virt-rescue shell.
    But if we are chrooting into a guest which doesn't have this file (or
    indeed any guest) we should not use LD_PRELOAD.
    
    Therefore unset LD_PRELOAD in the rescue shell.
    
    See also related commit 21e5fc811ea3708ef0c768467ffe53368bc435e9.

commit 5b49f8de27735015b21cd6d2a186a8332edee684
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 12 19:03:09 2013 +0100

    builder: Add Debian 6 (Squeeze) guest template.

commit c64214f2a42eab698bd4764a09d064bc4f96032c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 12 17:19:52 2013 +0100

    builder: With -v option, dump out the log file.
    
    Useful for debugging install errors.

commit aec2e2edbf3f53ebe156a25d396c171e1aef30ee
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 12 17:14:58 2013 +0100

    builder: Add comment about download /dev/stderr truncating redirection files.

commit a43f5e57a872bed2bba14f60110ffbcefb1a0bab
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 12 16:37:57 2013 +0100

    builder: '@' (not '+') is used to install groups of packages in Fedora.

commit 17c2698617977e3b6c5556c5c0f361da0e23bdbf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 12 16:36:01 2013 +0100

    builder: Print some stats about the generated image at the end.
    
    It will print stats at the end like this:
    
      Output: fedora-18.img (8.0G)
      Free space: 3.2G (39%)

commit 7820aaf1f3f1402811c1c3c8b2239aec0e12cf5e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 12 15:45:48 2013 +0100

    builder: Add --delete and --scrub options for deleting guest files.

commit dc0ec4db2140b32bb7c8f7517f4d0f50609d5e7b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 12 15:33:48 2013 +0100

    builder: In documentation, use 'scrub log file' instead of 'wipe'.
    
    Since we really do try to scrub the data.

commit 11f116f21e8f7db023a62dd0629d13005eead02c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 12 15:13:42 2013 +0100

    builder: Advice on setting environment variables to maximize caching.

commit 4bea0548c701858f368a402f2866b93217b91f6f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 12 15:13:26 2013 +0100

    builder: Add --cache-all-templates option.

commit fdd4d75b85b49778542923d565c89a7fcddf63bb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 12 14:57:34 2013 +0100

    builder: Make --delete-cache obey the --cache option.
    
    Previously a command such as:
    
      virt-builder --cache /tmp/cache --delete-cache
    
    would delete ~/.cache/virt-builder (the default cachedir).
    
    It's obviously meant to delete /tmp/cache, which this commit fixes.

commit 2eeaea6423ed11b5bb35a5fb03a92b2ff8716118
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 12 14:52:27 2013 +0100

    builder: Add --print-cache option.

commit ff76d1abdb163f85c647c76d059dfb344222136c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 12 12:58:49 2013 +0100

    recipes: More recipes for virt-builder, syslinux, Xen partitionless guest conversion.

commit da85de8a42a3f0c28a8cd48c34d93801afb7aa23
Author: John Eckersberg <jeckersb@redhat.com>
Date:   Fri Oct 11 22:26:07 2013 -0400

    btrfs: Fix improper memmove usage in do_btrfs_subvolume_list (RHBZ#1018149).
    
    The third parameter (number of bytes to copy) was given as an offset
    relative to dest, when it should be relative to src.  This fixes some
    valgrind warnings I happened across.

commit 7d0d159bedd9c2e3460a08c072464998f8accb8a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 11 15:47:16 2013 +0100

    Version 1.23.30.

commit ff738d1480a488db4d77841dfbfde2e7adb91d18
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 11 13:24:59 2013 +0100

    debian: Warn if /dev/kvm is 0660 and user is not in the KVM group.
    
    On Debian, /dev/kvm is mode 0660 and group kvm, so users need to add
    themselves to the kvm group otherwise things are going to be very slow
    (this is Debian bug 640328).

commit 92e18649136157e90442f4bbc7616e2168d2e12c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 11 14:35:12 2013 +0100

    events: Add a warning event and direct all warning messages through it.
    
    This also causes warnings to be printed even in non-verbose mode,
    which is useful.

commit aada08a91cb697328c05c49992968b30ff044c09
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 11 13:28:58 2013 +0100

    launch: libvirt: Suggest using the direct backend if libvirt fails.

commit b4fea7592f1bd5d921b329fb8c396bdb240d539d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 11 12:43:39 2013 +0100

    builder: Avoid parallel cache downloads from stomping on each other.
    
    This should let you run virt-builder instances in parallel.

commit 802c7f7376ce7c11e1da29e69cd70ba746699dc7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 11 11:48:27 2013 +0100

    daemon: Don't leak 'device' string in parse_btrfsvol.
    
    Since 'device' is assigned repeatedly, and because
    device_name_translation allocates a new string each time, we have to
    free it in the loop and along error paths.
    
    Found by ./configure --enable-valgrind-daemon.

commit d8a8894cb24baab2a98ee3bd3a15dae12c76b9e7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 11 11:51:13 2013 +0100

    daemon: xattr: Fix scope of cleanup buf to avoid memory leaks.
    
    Found by ./configure --enable-valgrind-daemon.

commit 46304e93898321848e33ac4c35c71f632d42bca8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 11 11:13:18 2013 +0100

    daemon: Fix macro definition.
    
    Defined a bogus macro along an unused code path.

commit c245b55707d7495c7ad39e9ead76de670ecf4dfd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 11 11:12:57 2013 +0100

    daemon: parted: Fix memory leak of list of strings.
    
    Found by ./configure --enable-valgrind-daemon.

commit db0307b7e31bc09c4ce8d966c8b1554754b58532
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 11 11:12:27 2013 +0100

    daemon: Fix scope of cleanup functions to avoid memory leaks.
    
    Found by ./configure --enable-valgrind-daemon.

commit 237e1d41d777b3439b7660bfac294e3a096ef243
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 11 11:11:43 2013 +0100

    daemon: Ignore memory leak in aug_setm.
    
    (Found by ./configure --enable-valgrind-daemon)

commit 494c18802b17c9c91774a806c513a27a8ba60671
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 10 22:24:01 2013 +0100

    daemon: When valgrinding the daemon, take steps to cleanly exit daemon.
    
    This adds a new internal API: internal_exit
    
    Only when valgrinding the daemon, have the library call internal_exit
    along the close path, and close the sockets first.  This ensures we
    will see normal valgrind messages (we were only seeing valgrind aborts
    before).
    
    Note this is not used in production builds.

commit 34a3ad9e2dc34e8718a812c5e5555414cb90ee39
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 10 14:19:25 2013 +0100

    Version 1.23.29.

commit 0f8db6185f8b37023ecb901100444c9637aad0ed
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 10 15:50:01 2013 +0100

    inspector: Allow the test to be skipped by setting an environment variable.

commit 9f1bcbca55661632176dea4e1dadc4dea0ca7f21
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 9 12:07:39 2013 +0100

    fish: Use UNIX_PATH_MAX instead of hard-coded value for max length of socket buf.

commit 29003cf67fa6ff44c16ed743a58819a60bdc99fd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 9 20:55:28 2013 +0100

    sparsify: Use Filename.temp_dir_name instead of Filename.get_temp_dir_name ().
    
    The latter function is only available in OCaml >= 4.00 whereas
    Filename.temp_dir_name has been around since OCaml 3.09.1.  In this
    case it doesn't make any difference which one we use.

commit b2baaa0029b8eac3abefa6d8c752c0cf7a5bfafb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 9 20:42:47 2013 +0100

    generator: Change handling of C 'function(void)' to be simpler.
    
    This also fixes an obscure case in daemon/optgroups.h.
    
    The only difference in the generated output is:
    
    --- daemon/optgroups.h.orig          2013-10-09 20:42:02.479681861 +0100
    +++ daemon/optgroups.h               2013-10-09 20:42:10.563681858 +0100
    @@ -149,7 +149,7 @@
       int optgroup_inotify_available (void) { return 0; }
    
     #define OPTGROUP_JOURNAL_NOT_AVAILABLE \
    -  int __attribute__((noreturn)) do_internal_journal_get () { abort (); } \
    +  int __attribute__((noreturn)) do_internal_journal_get (void) { abort (); } \
       int __attribute__((noreturn)) do_journal_close (void) { abort (); } \
       int64_t __attribute__((noreturn)) do_journal_get_data_threshold (void) { abort (); } \
       int __attribute__((noreturn)) do_journal_next (void) { abort (); } \

commit b3d979c349c131bc1e695bfdace586675d391b2a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 8 18:39:18 2013 +0100

    build: WEBSITEDIR has moved.

commit 57956ce790cba7db20d91a42fa5c02df836aee22
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 8 12:34:33 2013 +0100

    Update TODO with more ideas.

commit ae897e055a5bb09a7948a6f152fae9b972b9221e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 8 12:32:41 2013 +0100

    builder: Upload /etc/resolv.conf from the host when the network is enabled.
    
    When the user has enabled the network (not the default) we upload
    /etc/resolv.conf from the host to the appliance /etc/resolv.conf
    so that programs in the appliance can contact nameservers.
    
    Commit 9521422ce60578f7196cc8b7977d998159238c19 previously changed the
    behaviour to copy /etc/resolv.conf into the sysroot when running
    commands.

commit 74d9fdf56f1bb01e5e447986a49d3dbdb49a3f3d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 8 12:15:52 2013 +0100

    df: parallel: Add a debug message when work function returns an error.
    
    Further attempts to find out why this hangs under Koji.

commit 5c53b3266968110629c339aada309753300e4c21
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 8 12:12:22 2013 +0100

    launch: If launch takes longer than 20 minutes, time out.
    
    Add a constant fixed timeout for launch (currently 20 minutes, we'll
    make it configurable if needed in the future).  If the appliance takes
    longer than this to connect back, we time out assuming that the kernel
    has hung during boot.

commit 89b65b9779dc19fd3f67c853de66efa9241c288b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 8 11:58:26 2013 +0100

    launch: libvirt: Clarify comment.

commit 4fc44a0157a1bcd4c618e0eb8afd7c553ed0f31d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 8 10:00:33 2013 +0100

    blockdev: Deprecate blockdev_setbsz and make it do nothing (RHBZ#624334).
    
    This call never did anything.  Don't use it.  Also I have submitted a
    patch upstream to remove the corresponding option from blockdev.
    
    See RHBZ#1002825 for an explanation of why this call was always
    useless.
    
    Thanks: Masayoshi Mizuma

commit f5ba136359b484f7d9a4fc9b9384b5dde6580328
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 8 09:09:49 2013 +0100

    Version 1.23.28.

commit 9521422ce60578f7196cc8b7977d998159238c19
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 7 19:55:00 2013 +0100

    daemon: command: Copy appliance /etc/resolv.conf in before running commands.
    
    When you try to run commands for an Ubuntu guest, they fail because in
    Ubuntu /etc/resolv.conf is a symlink to /run/...  and this turns out
    to be a dangling symlink when the Ubuntu guest is mounted up under the
    appliance.
    
    Therefore even if the network is enabled, any command which tries to
    do name resolution will fail.
    
    Ideally we would like to bind-mount the appliance /etc/resolv.conf
    into the sysroot.  However this is not possible because mount is buggy
    (see comment).  So instead we use a complex hack to achieve the same
    ends.
    
    Note this is only done if the network is enabled and if /etc in the
    guest actually exists.  The original /etc/resolv.conf is restored
    as soon as the command has run.

commit b8b1b0296b0af8d072f329828ecf004116bfc7d3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 7 19:53:54 2013 +0100

    daemon: Refactor bind-mount code.
    
    This is just code motion.

commit 93793db049ef82c956588fa1eced32b483af2875
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 7 17:04:26 2013 +0100

    daemon: 'exists' API should not follow broken symlinks.
    
    Using guestfs_exists on a symlink which existed but pointed to a
    non-existent file was returning false.  However exists obviously
    should not be following the symlink in the first place.

commit 894488c442740a34b96ce0edab7c48e48d94f91e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 7 15:59:37 2013 +0100

    sysprep: ubuntu: Use secure SHA-512 crypt back to Ubuntu 10.04.

commit 5a71a2ddaff35921f80c923ee1724adf2abb581a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 7 13:54:25 2013 +0100

    builder: Add Ubuntu 10.04LTS, 12.04LTS and 13.10 templates.

commit 22fc66f6b2bf5074ff7b276e1fe08bac5d726c99
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 7 14:27:25 2013 +0100

    sysprep: Fix documentation for --mount-options.

commit dfa52c63b1efcfeba3303cc6b37f71c2826fdf6e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 7 14:18:02 2013 +0100

    sysprep: Don't remove /var/cache/apt/archives/partial directory.
    
    Removing this directory breaks Ubuntu guests.
    
    This change adds a utility function which removes only files from a
    directory.  This is a safer way to clean cache directories etc.

commit c8080e53ea24bc91c305983509c8d463ca9e6f9f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 7 10:51:23 2013 +0100

    builder: network: Note that only outgoing connections are allowed.

commit 7dfc67cb12d29baa1729b534dc50fb3b5e5079c4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 7 10:02:57 2013 +0100

    builder: Add section on debugging and other documentation fixes.

commit 10a821553e0cbeeb4cfe7b614e44a4425296ad64
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 5 22:34:46 2013 +0100

    Version 1.23.27.

commit e79c99f58c962b17d38f3cc167faa08cbe814aca
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 5 22:26:28 2013 +0100

    perl: valgrind: Renamed function requires different valgrind suppression.
    
    Seems to be a difference in Perl 5.18.

commit d746d01b81c09a8d0b6bff880896df5ff8f9407d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 5 20:11:33 2013 +0100

    builder: logo: Small adjustments.

commit e9e6f60ef1f3a64a7e518b5f043e011701f8dd6e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 5 18:13:27 2013 +0100

    builder: Document how to import disk images to other tools.
    
    Thanks: Kashyap Chamarthy

commit 424549c23ffa01766959d23e7f67745b972f6a31
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 5 18:12:49 2013 +0100

    builder: Display the output filename.
    
    Thanks: Kashyap Chamarthy

commit 3d5ed2584c8abe652d561fcfa84897aa19b95a97
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 5 17:48:58 2013 +0100

    Version 1.23.26.

commit 80da8b19e0d9745df8774e9cf78e087abbda6064
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 5 16:00:21 2013 +0100

    builder: Use progress bar for large template downloads that are not in the cache.

commit 7b825803520a5ba08eac5fe5d05b691cd33438b9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 5 15:00:54 2013 +0100

    builder: Create an install log file, and dump the full log on error.
    
    This should make debugging much simpler, and also provides a
    build log in the guest once it's built.

commit cc37490e05d323c0393261bbfba87c2ccef3b40f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 5 15:00:36 2013 +0100

    builder: Tidy up error messages.

commit f93968d6faedef85b185eba65b85601ae3df3803
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 5 14:25:07 2013 +0100

    builder: Clean up messaging.
    
    Ensure every significant action gets a message.

commit d55edbd8fba1e0c512a30e49ee32532105b56dd4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 5 12:58:31 2013 +0100

    Add virt-builder logo.

commit bdd5a9a894134a533b06c01071e76fb74b80193b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 5 11:53:06 2013 +0100

    Update release notes with dependency changes since 1.22.

commit f532ca96dc7112774dcbda8a677258d3de2b54c3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 5 11:43:17 2013 +0100

    todo: Some items to do in virt-builder.

commit 39ee0d13db92266bcc7d2d62d83c21fbf4a67153
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 4 13:59:59 2013 +0100

    builder: docs: Minor copy-edits of the man page.

commit be8ccedaf10e921bf727221ad60b2b60df63d555
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 4 13:44:39 2013 +0100

    Update release notes.

commit 05e8410e0ebe7907e5732714b2a0f280d6b1ec44
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 4 13:44:23 2013 +0100

    Update API support.

commit d6f87fe6be5e09c0c462f92455171581a7120000
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 4 12:01:18 2013 +0100

    Version 1.23.25.

commit 8f5dd4ed02e320e42f6dd4d6443996054871b9dd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 4 11:43:31 2013 +0100

    builder: docs: Add sections on architecture, security, UML.

commit 64bef381f63d5dcad47095cbee72dba856e1b145
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 4 08:48:26 2013 +0100

    uml: Fix virt-builder test.
    
    Note comment in the test about networks.

commit fe7f88a35ddeeb53c5f86b20d7097b41c6277d53
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 4 08:33:52 2013 +0100

    builder: Fix --format/--output-format arguments to virt-resize subcommand.
    
    The 'virt-builder --format' option translates to the
    'virt-resize --output-format' option, because it specifies the output
    format.
    
    On the contrary, the 'virt-resize --format' option (the input format)
    is always 'raw'.

commit dd410e1165bbe6c049183176fc1bd8736b9e525b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 4 08:31:53 2013 +0100

    builder: Add -v option to test so we get all debugging output.

commit a914889b1d467b03eee5f26517c58433e856bbed
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 4 08:26:00 2013 +0100

    tests/nbd: Avoid warning when tests are skipped.
    
    Since END{} clause is always called,  might not be defined if
    we exit early.  Move the whole clause to the top.

commit e9f35e26c5e452bd1c752c339a45c8959d1a8c56
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 4 08:25:14 2013 +0100

    builder: Add test *.xz files to CLEANFILES.

commit 0373f4ce68ce8327fb154606e06bfe197803a89a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 3 21:58:35 2013 +0100

    Version 1.23.24.

commit 967668f7a80d1182729cbad6677c9568bdd608ef
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 3 21:46:35 2013 +0100

    website: Make the rule install builder files to website.

commit a80f0f40b1177ac594ac1f847afefa1ac71b46a1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 3 21:46:27 2013 +0100

    website: Add HTMLSUPPORTFILES to rule.

commit a0d73b7e21dcb382e282cb7ab4efda5cadebb1a7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 3 19:20:28 2013 +0100

    builder: Add Debian 7 template + scripts used to create it.

commit c975d9e53bfb2ea7038ec623747952c583713099
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 3 15:03:10 2013 +0100

    builder: Implement --hostname (set hostname of guest).
    
    This also makes a minor rearrangement so that the random seed, root
    password, hostname setting all happen before package installation.
    This keeps these configuration changes together and means that the
    packages that are installed can act differently based on hostname
    (which is conceivable).

commit 08b7c902284b3acf59a7c3a4687f4407a3af8b83
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 3 14:53:22 2013 +0100

    sysprep: Refactor hostname code into a common library.

commit 7e824a10155de2a8eea884bb142284714d4a1027
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 3 12:55:57 2013 +0100

    builder: Add tests.

commit 9ba6717e944b6a0d3a1a44ce1637e56fe0595409
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 24 14:00:37 2013 +0100

    New tool: virt-builder: For quickly building virtual machine images.
    
    On baremetal you can build and customize a new guest in under 2
    minutes.  For example:
    
    $ virt-builder fedora-19 \
        --root-password password:test \
        --install minicom \
        --firstboot-command 'yum -y update' \
        --firstboot-command 'useradd -m -p "" rjones ; chage -d 0 rjones'
    [     0.0] Downloading: file:///home/rjones/d/libguestfs/builder/website/fedora-19.xz
    [     1.0] Uncompressing: file:///home/rjones/d/libguestfs/builder/website/fedora-19.xz
    [    24.0] Running virt-resize to expand the disk to 4.2G
    [    77.0] Opening the new disk
    [    81.0] Installing packages: minicom
    [    94.0] Installing firstboot command: [001] yum -y update
    [    94.0] Installing firstboot command: [002] useradd -m -p "" rjones ; chage -d 0 rjones
    [    94.0] Finishing off

commit 6203c50479c0c693c3fbdca222d28e98f4e094e5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 2 17:57:08 2013 +0100

    sysprep: Refactor setting random seed code into a common library.
    
    This is just code motion.

commit da1d0da429336c13fa09956c8b12fd2e39c7395f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 1 23:49:54 2013 +0100

    firstboot: Invoke firstboot.sh script with 'start' parameter.
    
    .. else the systemd script does not run.

commit 147b4ee87eca03b8d418984a0b8cfbc67738f65a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 1 23:20:55 2013 +0100

    sysprep: Refactor firstboot code into a common library.

commit ff9bc90e639799caf3dc562a74a7036e9e676ccf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 27 20:30:10 2013 +0100

    resize: Don't add mllib/* sources to 'SOURCES'.
    
    This was a mistake in commit 2a6ce793200e2cc6793a0242ec9ea3f90ad452b8.

commit e8a092ae87ea9d317107b4e091e15f9673b55a76
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 27 14:25:23 2013 +0100

    sysprep: Refactor password handling code into a common library.
    
    Also the crypt binding is moved to mllib because this is a dependency
    of the password library.
    
    This is just code motion.

commit 748ab339696a4b5b32b1f6682fc7998f76cc715c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 27 15:22:08 2013 +0100

    mllib: Rename parse_size to parse_resize.
    
    This is just code motion, but it reduces a source of confusion.

commit 98d56bb10225538bb27bdb9044275f2f7938dfa1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 27 15:20:31 2013 +0100

    mllib: error function has ~prog parameter, instead of assuming virt-resize.
    
      $ virt-sparsify a a
      virt-resize: error: you cannot use the same disk image for input and
      output
      If reporting bugs, run virt-resize with the '-d' option and include the
      complete output.
    
    Note (a) it assumes the program is called "virt-resize" which it
    isn't, and (b) it assumes the program has a debug option -d which it
    doesn't.
    
    This commit changes the error message and adds a -v option to
    virt-resize.

commit e1d7fb406bca9d49488b748e540a8fe1fca19be7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 27 13:57:02 2013 +0100

    resize, sparsify: Small argument parser refactoring.
    
    Factor out a common string.

commit 21e5fc811ea3708ef0c768467ffe53368bc435e9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 3 21:38:18 2013 +0100

    daemon: Don't set LD_PRELOAD for guestfsd children.
    
    Commit c598e14052399f19d36d7874d7133cba779bd3c2 exports
    LD_PRELOAD=/lib64/libSegFault.so so that guestfsd and processes that
    it runs will produce descriptive stack traces.
    
    However if we chroot into /sysroot (ie. CHROOT_IN/CHROOT_OUT) and if
    the libSegFault.so library does not exist inside the chroot (as is the
    case on Debian guests) then we cannot run any processes.  In any case
    we *don't* want to necessarily run this library from the guest.
    
    The proper way to fix this is to confine all chrooting to a
    subprocess, but that's a big change to guestfsd which we'll have to do
    one day.  For now, unset LD_PRELOAD once guestfsd starts up.

commit 8abd0a83b3a94e4adbd0926df818686be982cdb8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 3 18:17:39 2013 +0100

    daemon: Fix xfs_info parser because of new format.
    
    The old parser had several problems: firstly it called the error path
    sometimes without calling reply_with_error causing a protocol hang.
    More seriously it had hard-coded line numbers, and since Fedora 21 the
    output of xfs_info has changed, moving lines around.
    
    Change the parser to be more robust against added fields by using the
    first name on the line as the section name, thus 'bsize=' is
    interpreted differently depending on whether it appears in the "data"
    section or the "naming" section.
    
    Ensure also that we don't call the error path without calling
    reply_with_error, which is a side-effect of the above change.

commit 216cb004aef8ad6cb554ecdb9d7c4eb7634fe678
Author: Cole Robinson <crobinso@redhat.com>
Date:   Thu Oct 3 15:06:03 2013 +0100

    launch: libvirt: Set attribute present=yes to enable kvmclock.

commit 0fbd645cb9bc35748f8cf9b68c11e1ce840aeb1c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 27 17:14:31 2013 +0100

    Version 1.23.23.

commit a2a7ba50516ce7482d013d948039570490a24aeb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 26 22:11:01 2013 +0100

    Update BUGS file.

commit dc0052381e3102231a16f53796f00f9a7977aca8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 26 21:33:04 2013 +0100

    Update PO files.

commit 93dbeb6b6c5ac161043d6d9dd7576f85548a055d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 26 21:30:56 2013 +0100

    tools: Generate a special POTFILES-pl and dump symlink hack in tools directory.

commit e2895b19bb2be67c01172cdd0634553c21923605
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 26 10:47:17 2013 +0100

    appliance: Create /dev/loop-control and similar devices.
    
    When 'mount -o loop' and similar commands are used, the loop module is
    loaded automatically by the kernel when /dev/loop-control is accessed.
    
    /dev/loop-control is created semi-statically by an unholy and
    overcomplex combination of kmod static-nodes and systemd-tmpfiles
    (instead of using, say, just udev or even just a simple series of
    mknod commands).

commit d0ef2ff9b654fb966a294beeab7992d61970c108
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 25 16:00:38 2013 +0100

    appliance: If --enable-valgrind-daemon then increase minimum memory to 768 MB.
    
    tests/c-api would fail from time to time if --enable-valgrind-daemon
    was configured.  There was no obvious memory leak.  It looks as if the
    overhead of valgrind was sufficient to break long-running tests such
    as this one.

commit 2f4f7726e8c81cc56befcb7caa78c01174354d76
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 25 12:20:37 2013 +0100

    launch: libvirt: Use host-passthrough instead of host-model.
    
    <cpu model="host-passthrough"> really passes -cpu host to qemu, which
    is what we want since we don't care about live migration or ABI
    stability.
    
    This should avoid http://bugzilla.redhat.com/870071 .
    
    Note this "taints" the libvirt domain.  We don't particularly care
    about that, and the reason for the tainting doesn't seem to make much
    sense anyway.
    
    This updates commit 6f76fdb41eb6bd124fbc3d084f5c2a3371b37d9b.

commit ae2dd1a9e77b06ae9e7fc8ff47d8b5ea7331e0a9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 24 13:54:08 2013 +0100

    sparsify: Fix incorrect reference to documentation from tool.

commit 48b0d1574969ccf59e30b6f9bfea4e1331f806c4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 24 13:48:47 2013 +0100

    mllib: Ensure that mllib is included in POTFILES-ml.
    
    This updates commit 2a6ce793200e2cc6793a0242ec9ea3f90ad452b8.

commit 09a4f42861177655b74968c1dc3be44f3d9944eb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 24 12:45:19 2013 +0100

    uri: Fix two compiler warnings.
    
    We have to include the right header so that guestfs___free_string_list
    is declared.  Unfortunately that means ensuring -I src is passed to
    the compiler in every tool subdirectory.
    
    Also fix (bogus) compiler warning about incorrect type of the
    parameter to caml_copy_string_array.

commit 2a6ce793200e2cc6793a0242ec9ea3f90ad452b8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 24 12:32:11 2013 +0100

    tools: Move shared OCaml code to mllib/ directory.
    
    Previously a lot of shared code lived in the resize/ directory for no
    particular reason.
    
    This is just code motion.

commit dbbdaebe227222bacc3731ef380f12abf62ba507
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 23 13:50:05 2013 +0100

    resize: Allow the input file to be a URI.
    
    This lets you use nbd as a source for resizing, eg:
    
      virt-resize nbd://example.com outfile

commit 4cdb5bcc5ea211daaab24adda23dbb5e71ba172e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 23 13:49:21 2013 +0100

    sysprep: Fix option quoting in manual page.
    
    This fixes commit b65c1c667b26313abf312a7ab51f8bf947243d07.

commit 5971fb2a70daf739dc73fe7d3525295011625cd9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 12 09:16:31 2013 +0100

    virt-df: parallel: Send debugging messages to stderr.
    
    Not stdout (ordinary program output) since that gets eaten by
    the tests.
    
    This fixes commit 67b9469754684bc0c79fffab7bbca9f6ffee84f0.

commit 54f1492615ab145296548310e8b793a62cacc1f4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 11 14:26:07 2013 +0100

    arm: Drop kernel_irqchip=off hack.
    
    Was only required because of the previous use of vexpress-a9.  With
    vexpress-a15 should no longer be needed.

commit f4b3f84409956df493f4a21b02a655adfef67828
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 11 14:24:54 2013 +0100

    arm: Switch to using Versatile Express A15 machine.
    
    This is the machine which qemu actually emulates these days.

commit 577330d5e538baea467a22861664f7cc264bdcc6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 11 14:42:45 2013 +0100

    Remove incorrect comment.
    
    qemu does in fact fix up the device tree with the correct memory size
    supplied by -m <ramsize> so the comment was incorrect.
    
    This updates commit 8d273a27156813593fe7f6bb657fcf04eb325b59.

commit 8d273a27156813593fe7f6bb657fcf04eb325b59
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 11 14:22:05 2013 +0100

    arm: Pass mem= parameter on Linux command line.
    
    It is thought that qemu-system-arm -m <ramsize> could conflict with
    the actual memory that Linux thinks is available (from the device tree).
    
    Thanks: Marc Zyngier

commit 27cfd77df94d70e0963ddce0976c238d4b0ddc31
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 11 11:57:40 2013 +0100

    arm: Don't bother supplying guest architecture.
    
    libvirt seems to do the right thing without this.

commit c3f8b441fdf48caf29c41a2b0a9034b067460b64
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 11 11:53:18 2013 +0100

    arm: Add notes about machine types.
    
    Thanks: Marc Zyngier from ARM, Andre Przywara from Linaro for
    patiently explaining this to me.

commit 2913c499cf708a6216baf87abc3178b050f388dc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 11 10:52:24 2013 +0100

    launch: Centrally define machine type and DTB wildcard.
    
    This avoids a bit of arch-specific #ifdef.

commit 4d955be4fb9fe304d5ab4222f0e9592f5fc1ef5b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 11 10:44:08 2013 +0100

    Version 1.23.22.

commit ccc9a891df8f8d0af1732bb5bc00b20f39ba24e6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 10 23:31:58 2013 +0100

    docs: Remove misleading / outdated section about other arches from README.

commit aee6fc4863c170d08e572dbdcfcb6f328edfc013
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 10 22:37:18 2013 +0100

    ppc: inspection: Use iconv "UTF-16LE" instead of "UTF-16".
    
    See commit message:
    https://github.com/libguestfs/hivex/commit/8e31fd84cb1c7edcd897ddaaea407774de459b2e

commit bae6d5cc63763fe012c8876408e40d8dec2976e4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 10 11:44:14 2013 +0100

    inspection: Don't print a warning if \Windows\explorer.exe does not exist.
    
    guestfs_case_sensitive_path does not test for file existence.  We have
    to test for it explicitly.
    
    This updates commit 9ea6e9701461e594033999150f930cc4fafec4d2.  See the
    description of that commit for more details.

commit 74938b895c1ad05378a74f0384dfe90cca70471f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 10 10:41:37 2013 +0100

    ppc: Disallow ide interface.
    
    qemu-system-ppc64 lets you add the IDE interface to the appliance, but
    the appliance kernel ignores it (and consequently can't find the
    appliance disk so it all goes wrong).  Best to just disallow this.
    
    Also skip tests that try using iface = 'ide'.

commit aee17de30a5379f5160616805c90299b17fc3823
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 10 10:09:01 2013 +0100

    ppc: Use a larger default memory size on ppc64.
    
    Without this, test-max-disks fails when creating device nodes.

commit 7f90aa099847563114cbcca9893b1f3f8cb4430a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 9 22:54:09 2013 +0100

    ppc: launch: direct: Use -M pseries.

commit 2bf082d908b0b6627ff3bf4b79ec42e883fb08da
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 9 12:23:26 2013 +0100

    arm: launch: direct: Use correct device name for virtio-scsi when detecting.

commit 415d74d0b8cd7d08a655041396e75841d59b90a4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 9 11:58:06 2013 +0100

    tests: Add a regression test that ensure the network can be added.
    
    This was only tested before (implicitly) by the rsync test in
    tests/rsync.  It's better to have an explicit test of this
    functionality.

commit c6dc813420b969cf828ae98e32bf97916a410603
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 9 11:57:20 2013 +0100

    arm: launch: libvirt: Use virtio-net-{pci,device} instead of hard-coding virtio-net-pci.
    
    This is so it works on virtio-mmio platforms such as ARM.

commit f8d89bc42fbd930c61e4f6a81d9a9dc3465f2924
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 9 09:02:59 2013 +0100

    arm: launch: libvirt: Set kernel_irqchip=off for KVM to work around buggy qemu/kernel.

commit 37e1e0da5acb34c902d55cde13c58cf580304bca
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Sep 8 23:23:11 2013 +0100

    arm: launch: libvirt: Force <emulator>.
    
    This is a temporary hack, because otherwise libvirt tries to use
    /usr/bin/qemu-kvm even though this is ARM.

commit 06e43a3359e8139241c69b5cc430b2f4c06f7fd8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Sep 8 23:22:34 2013 +0100

    arm: launch: libvirt: Use vexpress-a9 machine type.

commit cd16380a8337c4da7752774bb99c76b91475a15a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Sep 8 23:21:30 2013 +0100

    arm: launch: libvirt: Don't try setting a cpu model on ARM.
    
    One day we may be able to make this work, but presently libvirt says:
    
      CPU specification not supported by hypervisor

commit bb616a42d2541ae40d484d0c1159519dca43c8c3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Sep 8 23:09:34 2013 +0100

    launch: libvirt: 'is_custom_hv' instead of 'is_custom_qemu'.
    
    Just code motion related to the changed from LIBGUESTFS_QEMU
    to LIBGUESTFS_HV.
    
    This updates commit 78dbd08dd2115efcc488e8fbcaf9705697eb075b.

commit 1cfdb4d9a717988ec2594693068c4a9a01663e87
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Sep 8 20:50:54 2013 +0100

    arm: tests: 9p: Modify name of virtio-9p-pci device when using virtio-mmio.
    
    It's called virtio-9p-device on virtio-mmio.

commit 9d97b86ee8867637815ab75ca85a4a5248e3d919
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Sep 8 16:21:17 2013 +0100

    arm: Error if iface=ide and skip tests that use iface=ide.
    
    ARM doesn't support IDE.  (Well, that's not entirely true as I found a
    reference to one extremely obscure ARM board that had IDE disks, but
    qemu-system-arm doesn't appear to support them).

commit 25cce50a2ba11a9581abfa896785252f2f5e7151
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Sep 8 16:19:24 2013 +0100

    launch: direct: Handle iface=virtio using virtio-blk path.
    
    iface=virtio means use (old) virtio-blk.  Since there's an existing
    path for using virtio-blk, use that instead of adding if=virtio (which
    will fail on ARM).

commit 6e498461f6400c14406319594f3b0577d64cb8a2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 7 08:18:55 2013 -0400

    arm: launch: direct: Add kernel_irqchip=off to make ARM KVM work.
    
    See:
    https://lists.fedoraproject.org/pipermail/arm/2013-September/006758.html

commit af229ebd627b3a76224c15c630d0fbc76694298c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 7 13:06:21 2013 +0100

    Version 1.23.21.

commit 3f9f6235ec0e268a2c8b5472797f9072dcc020bb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 6 13:17:52 2013 -0400

    arm: appliance: Add support for device trees (dtb's).
    
    If supermin-helper >= 4.1.5 is found, use the new-style syntax and if
    the architecture requires it (only ARM for now) implement device
    trees.
    
    This means we pass a supermin-helper --dtb option to find the right
    device tree (currently Versatile Express A9, since that's what we pass
    to qemu in the -M option).  This makes supermin-helper find a
    compatible device tree file.
    
    Also that we pass the corresponding dtb file to qemu via the qemu -dtb
    option, or to libvirt via the <dtb> element.

commit 284fdfe2c54da36d62232e0a8533c1880ee8138a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 6 09:09:34 2013 +0100

    sysprep: Update POTFILES-ml.
    
    This updates commit ea7088b5cab30158149b07bd208e54631b86b8eb.

commit ea7088b5cab30158149b07bd208e54631b86b8eb
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Fri Sep 6 15:52:38 2013 +0800

    sysprep: remove tmp files
    
    This removes tmp files under /tmp and /var/tmp.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 2550971d726820753df9d36700f2dd67dfddee7d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 5 18:41:56 2013 -0400

    launch: direct: Set QEMU_AUDIO_DRV=none to stop qemu opening audio devices.
    
    Libvirt does the same thing, and it definitely has an effect
    on ARM at least.

commit 52cbb0a32351b8a3072defd1cdb4b19cffd65a3b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 5 18:02:33 2013 -0400

    arm: launch: direct: Use virtio-net-device instead of virtio-net-pci on ARM.
    
    This updates commit 92749924112b21e01d7cdbbb4cc07627168a705f.

commit 92749924112b21e01d7cdbbb4cc07627168a705f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 5 14:18:33 2013 -0400

    arm: launch: direct: Use virtio-mmio devices on ARM.
    
    Devices such as virtio-blk are (implicitly) PCI devices.  They don't
    work on ARM.  You have to use the alternate names like
    'virtio-blk-device' instead.

commit b46291a74c985297cc47451eaff0776fa66c55e1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 5 14:14:53 2013 -0400

    arm: launch: direct: Specify a -M (machine type).
    
    Currently this uses the Versatile Express A9 (vexpress-a9) machine
    type, which is not ideal long-term.  However it includes such things
    as virtio-mmio and so virtio things should work.
    
    Note that -M vexpress-a15 does not work with qemu (from git on
    2013-09-05 + Fedora kernel 3.11.0).  There are no boot messages.

commit f3710a43d4187cf6602f3880b7a7ce78898bdc82
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 5 13:50:08 2013 -0400

    arm: launch: direct: Don't use -cpu flag.
    
    We have no idea what the right choice is, so don't choose anything at all.

commit 931182598dae62be5214455bb600f1bc3724bb18
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 5 11:05:26 2013 -0400

    arm: configure: Search correctly for qemu-system-arm binary.

commit a6f2efe9b94f990598965f6614f6b89f24916574
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 5 18:47:00 2013 +0100

    launch: direct: Always use -drive ...,iface=none.
    
    For virtio-scsi, this is the same as always:
    
      -drive ...,iface=none -device scsi-hd
    
    For virtio-blk, this now uses:
    
      -drive ...,iface=none -device virtio-blk

commit 011c9639267f5f1bfac41e664b2c57cc12deabf8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 5 18:45:24 2013 +0100

    launch: direct: Always use cache=unsafe for the appliance.
    
    The code to select writeback was redundant, because current
    qemu always supports cache=unsafe.

commit 30c045797856b67f61ae213716f31a6099879f1f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 5 18:39:46 2013 +0100

    launch: direct: Refactor -drive parameter for virtio-blk/virtio-scsi.
    
    This is a straightforward refactoring of the code for generating
    -drive and/or -device parameters for virtio-blk and virtio-scsi.

commit bbd936d32b9ef8973709a7b80f6f892daf64bfb6
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Thu Sep 5 19:13:22 2013 +0800

    sysprep: remove firewall rules
    
    If we do not want to keep the original firewall rules, enable
    this operation to remove these rules automatically.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>
    
    RWMJ:
    
     - Updated po-file.
    
     - Change documentation to note that it's disabled by default
       and in theory could make the guest exploitable.

commit 475f5ce6a426d026927f31c045bd25160bf7a2f7
Author: Martin Kletzander <mkletzan@redhat.com>
Date:   Wed Sep 4 13:42:40 2013 +0200

    Get rid of gnulib error
    
    Even though this doesn't stop the compile phase, I find it a bit
    distracting that this is what I get with bootstrap:
    
    ../.gnulib/gnulib-tool: *** cannot find ./configure.ac - make sure you
    run gnulib-tool from within your package's directory
    ../.gnulib/gnulib-tool: *** Stop.
    
    Signed-off-by: Martin Kletzander <mkletzan@redhat.com>

commit 012d8ebf02e0de672de3b2bcbf192aa2510e5caa
Author: Martin Kletzander <mkletzan@redhat.com>
Date:   Wed Sep 4 13:42:39 2013 +0200

    Don't redefine _FORTIFY_SOURCE
    
    The macro _FORTIFY_SOURCE might be already defined by environment in
    which case it shouldn't be overriden (might be if it has lower value).
    
    Signed-off-by: Martin Kletzander <mkletzan@redhat.com>

commit efcf474d42ebf65a6307822f6a7d8fe674442210
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Thu Sep 5 14:57:33 2013 +0800

    sysprep: remove log file of ntp
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit c76dabf9eca03284683587e530a09cca99d45681
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Thu Sep 5 14:57:32 2013 +0800

    sysprep: remove log file of gdm
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 1baf716a7e3c5c9632418035b84fec947d9350c1
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Thu Sep 5 14:57:31 2013 +0800

    sysprep: remove log file of sysstat
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit e02c4e519ea1f504b1fe869a5547e75a80ba49e7
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Thu Sep 5 14:57:30 2013 +0800

    sysprep: remove /var/log/audit/audit.log
    
    audit.log is already included in /var/log/audit/*.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 67b9469754684bc0c79fffab7bbca9f6ffee84f0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 3 12:44:25 2013 +0100

    virt-df: parallel: Compile debugging messages in always.
    
    Enable debugging messages whenever LIBGUESTFS_DEBUG=1 / -v option, so
    that we can track down possible race condition seen in Koji.

commit 091eb0780349dade778d1ad3412ffacc7ffec9ec
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 2 19:37:57 2013 +0100

    daemon: augeas: Don't test if AUG_NO_ERR_CLOSE is defined.
    
    It's an enum, not a macro, and in any case it has been present in
    augeas.h since 0.10.0, and the minimum version that libguestfs
    requires is 1.0.0.
    
    This fixes commit 3d132f29204e8c5c77f08841b5288dfe3013f4f0.

commit 3d132f29204e8c5c77f08841b5288dfe3013f4f0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 2 19:19:26 2013 +0100

    daemon: augeas: Enhance error reporting for aug_init failures.
    
    Thanks: Dominic Cleal.

commit e690b737fe27efac4ae47dfcf8066da9c92dca7a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Sep 1 16:36:25 2013 +0100

    Version 1.23.20.

commit 912943034e21f6fd15b3c835a8130ae91ac724df
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Sep 1 11:11:55 2013 +0100

    drives: Don't need to call free_drive_servers since preceding code checks servers == NULL.

commit 3f0748f1fc64e42517c0d4535c27b1f32da86023
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 31 22:48:04 2013 +0100

    rescue: Use cachemode "unsafe" for the virt-rescue --scratch option.

commit f3a9c9f867bed178d1aabf9675955f633bf3069a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 31 22:47:44 2013 +0100

    sparsify: Use cachemode "unsafe" for the overlay disk.

commit 96cd7fcecb031bfe6baa49addfb026ae988fb7c1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 31 22:38:03 2013 +0100

    drives: Ensure all scratch drives use cachemode "unsafe".
    
    They are _scratch_ drives so any data on them doesn't matter and can
    be reconstructed in the event of a host system crash.

commit 749e947bb0103f19feda0f29b6cbbf3cbfa350da
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 31 22:24:40 2013 +0100

    add_drive: Introduce 'cachemode' parameter to control drive caching.
    
    This commit adds an optional 'cachemode' parameter to the 'add_drive'
    API to control caching.  This corresponds approximately to the
    '-drive ...,cache=' parameter in qemu, but the choices are much more
    restrictive, just 'writeback' or 'unsafe', for reasons outlined below.
    
    The caching modes supported by recent QEMU are:
    
      writeback:
       - Reports data writes completed when data is present in the host
         page cache.
         Only safe provided guest correctly issues flush operations.
    
      writethrough:
       - Reports data writes completed only when each write has been
         flushed to disk.  Performance is reported as not good.
    
      none:
       - Uses O_DIRECT (avoids all interaction with host cache), but does
         not ensure every write is flushed to disk.
         Only safe provided guest correctly issues flush operations.
    
      directsync:
       - Uses O_DIRECT (avoids all interaction with host cache), and
         ensures every write has been flushed to disk.
    
      unsafe:
       - No special handling.
    
    Since the libguestfs appliance kernel always issues flush operations
    (eg. for filesystem journalling and for sync) the following modes can
    be ignored: 'directsync', 'writethrough'.
    
    That leaves 'writeback', 'none' and 'unsafe'.  However 'none' is both
    a constant source of pain (RHBZ#994517), is inefficient because it
    doesn't use the host cache, and does not give us any safety guarantees
    over and above 'writeback'.  Therefore we should ignore 'none'.
    
    This leaves 'writeback' (safe) and 'unsafe' (fast, useful for scratch
    disks), which is what we implement in this patch.
    
    Note that the previous behaviour was to use 'none' if possible, else
    to use 'writeback'.  The new behaviour is to use 'writeback' only
    which is (in safety terms) equivalent to 'none', and also faster and
    less painful (RHBZ#994517).
    
    This patch also allows you to specify a cache mode for network drives
    which also previously defaulted to 'writeback'.
    
    There is a considerable performance benefit to using unsafe (for
    scratch disks only, of course).  The C API tests only use scratch
    disks (since they are just tests, the final state of the disk doesn't
    matter), and this decreases total run time from 202 seconds to 163
    seconds, about 25% faster.

commit 6e84861179cc735c8c9ea5215ce2a73ab1989928
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 31 18:26:33 2013 +0100

    sparsify: Test for qcow2 features instead of keying off qemu-img version.
    
    Test whether qcow2 features are possible in qemu-img instead of
    assuming they are by keying off the version.
    
    Also use the 'lazy_refcounts' flag, if available.  It may make writing
    to the overlay file marginally faster (however I tested it and there
    was no measurable difference).

commit 13f3b4a83d6c0abac140d05089ae604bfeef31ef
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 31 18:17:05 2013 +0100

    sparsify: Fix signal handling.
    
    If you don't have a ^C (SIGINT) signal handler at all, then at_exit
    handlers are not called so you end up leaving the large temporary
    overlay file lying around.  That was fixed, incorrectly, by
    commit 7283a5a2765c0670e9dceec70e626a49a30d269c.
    
    However the code now would delete the overlay file in the SIGINT
    handler but otherwise continue running until basically it tries to
    read the overlay file (now deleted) and fails.  So it kind of worked,
    by accident.
    
    Fix this so that the signal handler calls exit, thus ensuring both
    that the exit handler is called (to delete the file) and that the
    program actually exits as soon as possible.
    
    This also refactors the unlink_on_exit function into a utility.

commit 950afbb70584528b5a8b6f8ff9ce3d44c53b6934
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 31 18:13:04 2013 +0100

    daemon: Add comment about how zero_free_space would be better if we could do cancellation.

commit a1f9fb88aedcf141871a5955523ca032b4b6d5b0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 30 13:50:25 2013 +0100

    configure: Fix stupid typo which caused compressed images to always be used.
    
    Libguestfs won't work if you try to use it with supermin < 4.1.4
    because the logic for detecting if compressed images can be used was
    wrong (it was always enabled, instead of disabled for supermin < 4.1.4).

commit 72b0831ffa67383020fa94a6b534bf29af593cff
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 29 21:19:58 2013 +0100

    Rename virt-{cat,edit,filesystems,inspector,ls,rescue}.c to *.c.
    
    This is just renaming of files.

commit 5fd5cf7fdbc6762cb95e946a0f076c23fc640001
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 29 18:32:12 2013 +0100

    Version 1.23.19.

commit 6e9440ced8dcc9b040eb7970017ea3f457e68142
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 29 17:26:59 2013 +0100

    uml: Skip tests/md/test-inspect-fstab-md.sh
    
    Hangs at various places during the test, eg. running mdadm, mounting
    MD filesystem.  Seems to be a bug in UML/MD.

commit 1c8986e45c3f1a7e2391bde2848667332495e3aa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 29 13:59:14 2013 +0100

    mke2fs: Document that too small blockscount will result in ext2 filesystem (RHBZ#1002032).

commit c04fbbda3e1d2bf98e241a95e069ac1fe202c14f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 29 13:49:26 2013 +0100

    rsync: Document use of glob + rsync-out in guestfish (RHBZ#1001876).

commit 1b34d6171bb4aaa1134a9d867918d7163cc7e069
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 29 13:36:56 2013 +0100

    Add a regression test of tar-out excludes option (RHBZ#1001875).

commit 91c162586cc2170ea224016307016153f3d081b5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 29 13:26:51 2013 +0100

    daemon: tar: Use a temporary file to pass excludes to tar command (RHBZ#1001875).
    
    Use tar -X option instead of tar --exclude=... option.

commit a75ca610b80614253f8a9d9828a97dc61d919b8a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 29 11:41:46 2013 +0100

    daemon: Allow labels to be set on DOS filesystems using 'dosfslabel'.
    
    You can now use virt-format or virt-make-fs --label option to set a
    label for a DOS filesystem:
    
    $ ./run ./format/virt-format -a /tmp/test.img --filesystem=vfat --label=BOOT
    $ ./run ./cat/virt-filesystems -a /tmp/test.img --all --long -h
    Name       Type        VFS   Label  MBR  Size  Parent
    /dev/sda1  filesystem  vfat  BOOT   -    1.0G  -
    /dev/sda1  partition   -     -      0b   1.0G  /dev/sda
    /dev/sda   device      -     -      -    1.0G  -
    
    This also contains a small code refactoring.
    
    Thanks: Gerd Hoffmann (kraxel)

commit e17cd73fb7e3d7ce5e28f51c8451033f48a39153
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 29 11:37:06 2013 +0100

    virt-make-fs: Add --label option for setting filesystem label.
    
    $ ./run ./tools/virt-make-fs /tmp/supermin-4.1.4.tar.gz /tmp/test.img
    $ ./run ./cat/virt-filesystems -a /tmp/test.img --all --long -h
    Name      Type        VFS   Label  MBR  Size  Parent
    /dev/sda  filesystem  ext2  -      -    3.7M  -
    /dev/sda  device      -     -      -    3.7M  -
    
    $ ./run ./tools/virt-make-fs /tmp/supermin-4.1.4.tar.gz /tmp/test.img --label=BOOT
    $ ./run ./cat/virt-filesystems -a /tmp/test.img --all --long -h
    Name      Type        VFS   Label  MBR  Size  Parent
    /dev/sda  filesystem  ext2  BOOT   -    3.7M  -
    /dev/sda  device      -     -      -    3.7M  -
    
    Thanks: Gerd Hoffmann (kraxel)

commit c46e41cb3c41f6283e0350cac6ef0b9178ed3941
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 29 11:32:05 2013 +0100

    format: Add --label option for setting filesystem label.
    
    $ ./run ./format/virt-format -a /tmp/test.img --filesystem=ext2 --label=BOOT
    $ ./run ./cat/virt-filesystems -a /tmp/test.img --all --long -h
    Name       Type        VFS   Label  MBR  Size  Parent
    /dev/sda1  filesystem  ext2  BOOT   -    1.0G  -
    /dev/sda1  partition   -     -      83   1.0G  /dev/sda
    /dev/sda   device      -     -      -    1.0G  -
    
    Thanks: Gerd Hoffmann (kraxel)

commit d432ab2b5a965110bab542bfd397785eee9753dd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 29 11:24:00 2013 +0100

    format: Set MBR partition type byte appropriately (RHBZ#1000428).
    
    Windows won't see a filesystem unless the MBR partition type
    byte is set correctly.
    
    $ ./run ./format/virt-format -a /tmp/test.img
    $ ./run ./cat/virt-filesystems -a /tmp/test.img --all --long -h
    Name       Type        VFS      Label  MBR  Size  Parent
    /dev/sda1  filesystem  unknown  -      -    1.0G  -
    /dev/sda1  partition   -        -      83   1.0G  /dev/sda
    /dev/sda   device      -        -      -    1.0G  -
    
    $ ./run ./format/virt-format -a /tmp/test.img --filesystem=ntfs
    $ ./run ./cat/virt-filesystems -a /tmp/test.img --all --long -h
    Name       Type        VFS   Label  MBR  Size  Parent
    /dev/sda1  filesystem  ntfs  -      -    1.0G  -
    /dev/sda1  partition   -     -      07   1.0G  /dev/sda
    /dev/sda   device      -     -      -    1.0G  -
    
    $ ./run ./format/virt-format -a /tmp/test.img --filesystem=vfat
    $ ./run ./cat/virt-filesystems -a /tmp/test.img --all --long -h
    Name       Type        VFS   Label  MBR  Size  Parent
    /dev/sda1  filesystem  vfat  -      -    1.0G  -
    /dev/sda1  partition   -     -      0b   1.0G  /dev/sda
    /dev/sda   device      -     -      -    1.0G  -
    
    $ ./run ./format/virt-format -a /tmp/test.img --lvm --filesystem=vfat
    $ ./run ./cat/virt-filesystems -a /tmp/test.img --all --long -h
    Name        Type        VFS   Label  MBR  Size   Parent
    /dev/VG/LV  filesystem  vfat  -      -    1020M  -
    /dev/VG/LV  lv          -     -      -    1020M  /dev/VG
    /dev/VG     vg          -     -      -    1020M  /dev/sda1
    /dev/sda1   pv          -     -      -    1020M  -
    /dev/sda1   partition   -     -      8e   1.0G   /dev/sda
    /dev/sda    device      -     -      -    1.0G   -
    
    Thanks: Gerd Hoffmann (kraxel)

commit ca4b4089689c0c908ee56a8021d65a79d39d803e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 28 22:35:42 2013 +0100

    appliance: Use gzip-compressed cpio files if supermin-helper supports it.
    
    supermin-helper >= 4.1.4 has new support for compressed cpio files
    (not hostfiles).  Detect if this is supported, and use it.

commit 532117de297ecedb121f20fdc122ad83482e9b48
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 28 18:45:14 2013 +0100

    javadoc: Install javadoc in $(datadir)/javadoc/libguestfs (without -java-$(version)).
    
    Apparently this is the normal place for javadoc, and not
    where we installed it before.

commit b1919066ca3d83f11b72d38d64f25739bd0ff67e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 22 19:48:05 2013 +0100

    Initialize CLEANUP_* stack variables with NULL in various places.
    
    Code like:
    
      CLEANUP_FREE char *buf;
      /* some code which might return early */
      buf = malloc (10);
    
    is a potential bug because the free (*buf) might be called when buf is
    an uninitialized pointer.  Initialize buf = NULL to avoid this.
    
    Several of these are bugs, most are not bugs (because there is no
    early return statement before the variable gets initialized).
    
    However the compiler can elide the initialization, and even if it does
    not the performance "penalty" is miniscule, and correctness is better.

commit fc2947b1125aa34b5f04efd2d39cb82b2ebba586
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 22 19:38:54 2013 +0100

    daemon: sh: Fix missing initializer which caused segfault (RHBZ#1000121).
    
    Thanks: Olaf Hering.

commit 4fdf05e19903442aff65993c124a062c82b54e1c
Author: Olaf Hering <olaf@aepfle.de>
Date:   Tue Aug 20 16:33:01 2013 +0200

    lib: avoid pragma usage in journal.c
    
    journal.c: In function 'guestfs__journal_get':
    journal.c:120:9: error: #pragma GCC diagnostic not allowed inside functions
    journal.c:121:9: error: #pragma GCC diagnostic not allowed inside functions
    journal.c:123:9: error: #pragma GCC diagnostic not allowed inside functions
    make[3]: *** [libguestfs_la-journal.lo] Error 1
    
    Signed-off-by: Olaf Hering <olaf@aepfle.de>

commit d188594b11f2a16fe72b963a55edf41d4aa2e3aa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 20 18:28:25 2013 +0100

    daemon: hivex: Define empty hivex_finalize function in case !HAVE_HIVEX.
    
    Thanks: Olaf Hering (see previous commit).

commit 8590ec9b56fe491c97ea4a8b9df37b044dd92e59
Author: Olaf Hering <olaf@aepfle.de>
Date:   Tue Aug 20 15:48:51 2013 +0200

    daemon: fix build without systemd-journal
    
    Fix typo in OPTGROUP_JOURNAL_NOT_AVAILABLE
    Define empty journal_finalize, called by mount.c
    
    Signed-off-by: Olaf Hering <olaf@aepfle.de>

commit c2232321b6bcc403e8870b98cdcb0677009c71a4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 20 11:42:18 2013 +0100

    daemon: Document guestfs_verbose=1 and guestfs_channel=<PATH> in man page.

commit cb7b1c56b7cf447dd9f2ea4dde5cf65e9f9f8cf8
Author: Olaf Hering <olaf@aepfle.de>
Date:   Mon Aug 19 19:28:18 2013 +0200

    tests: change noinst to check
    
    This change avoids the hard requirement for qemu-tools during package
    build.
    
    Signed-off-by: Olaf Hering <olaf@aepfle.de>

commit d408931bba8be101613fb6d293be42fd577a1bdd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 19 15:46:20 2013 +0100

    Version 1.23.18.

commit 835e11c892c191d81716643ed738501c7852d0e9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 19 15:45:35 2013 +0100

    uml: Remove unused function is_numeric.
    
    This fixes commit b607f8628876f4779921047ad29aa9a623e3bde2.

commit 7e396954611d827dc236a114ed22a781687c002d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 19 14:17:55 2013 +0100

    fish: Document that guestfish --remote --add won't work as expected (RHBZ#998513).

commit a843b5e5e32c151e7b0c74bb4f7be1030f9ac85b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 19 13:50:29 2013 +0100

    launch: direct: Don't try to wait for qemu if parent process forked (RHBZ#998482).
    
    When using guestfish --remote, libguestfs is not the parent of qemu,
    so waitpid is expected to return -ECHILD.  And indeed guestfish --remote
    would print a bogus error message in this case:
    
      libguestfs: error: waitpid (qemu): No child processes
    
    If the parent process forked into the background, then it should have
    called 'set_recovery_proc 0' so we can use this to determine if we
    need to wait for qemu.
    
    Thanks: Kazuya Saito for reporting and identifying the issue.

commit b607f8628876f4779921047ad29aa9a623e3bde2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 19 10:34:39 2013 +0100

    uml: Remove kill_vmlinux subprocess, problem fixed upstream.
    
    Note you need to apply these patches to the Linux kernel to get
    User-Mode Linux to work with libguestfs:
    
    http://marc.info/?l=user-mode-linux-devel&m=137682544009451&w=2
    http://marc.info/?l=user-mode-linux-devel&m=137682543809449&w=2
    http://marc.info/?l=user-mode-linux-devel&m=137682544209452&w=2
    http://marc.info/?l=user-mode-linux-devel&m=137682543809448&w=2

commit 7cdd96323ce52c3d74d1fa2a535bb5b2d5529983
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 19 10:31:27 2013 +0100

    uml: Exit status 1 is a normal exit code for vmlinux subprocess.
    
    Note you need to apply these patches to the Linux kernel
    to get User-Mode Linux to work with libguestfs:
    
    http://marc.info/?l=user-mode-linux-devel&m=137682544009451&w=2
    http://marc.info/?l=user-mode-linux-devel&m=137682543809449&w=2
    http://marc.info/?l=user-mode-linux-devel&m=137682544209452&w=2
    http://marc.info/?l=user-mode-linux-devel&m=137682543809448&w=2

commit 18b40a88925df737d3552fa646d35a185feb6c62
Author: Or Goshen <oberonc@gmail.com>
Date:   Mon Aug 19 10:08:34 2013 +0100

    Fix to src/proto.c in libguestfs so it will compile with portablexdr under mingw.

commit f33343a5c16baeab6ffc45f36e0dadd7c956f402
Author: Nikita Menkovich <n.menkovich@sprinthost.ru>
Date:   Fri Aug 16 17:14:28 2013 +0100

    sysprep: added --mount-options option to mount selected partitions with options.

commit abc59d776a12fb96de6ff927054f3db2a9ed4fc4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 16 13:35:12 2013 +0100

    FAQ: Replace the debugging section (again) with a checklist of information we need to start to fix bugs.

commit 0a484e868f5f0b7f6245a80f67e09c8210721dac
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 16 13:24:19 2013 +0100

    FAQ: Move #debug anchor back to the right place.
    
    This was accidentally moved by this commit:
    
      commit b8b5ed65c26dd19a0bc9f8282a50c6dff90c456a
      Author: Richard W.M. Jones <rjones@redhat.com>
      Date:   Wed May 23 11:46:23 2012 +0100
    
        FAQ: Add section about using libguestfs in closed source programs.

commit 937a9a35320edb781721de5537d750c004872c98
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 16 12:00:06 2013 +0100

    FAQ: Delete section about Ubuntu 10.04.
    
    The link was broken, and we don't support Ubuntu 10.04 (maybe the
    'oldlinux' branch does).

commit f68d5ee16c88df4a3fe2233ba948fb4780fa2a09
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 16 09:13:59 2013 +0100

    cleanups: Use correct types for some cleanup functions.

commit bcd7e6d879fae159a1214552e5ea377dc38600c0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 15 22:30:21 2013 +0100

    uml: Add uml_mkcow requirement to README.
    
    This fixes commit 858d6e7176d7b18bc29c8503bbc2887a3b74a272.

commit 0875592763de96c0173abc021bd1328a59fcc860
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 15 16:57:04 2013 +0100

    launch: Create the direct & uml command lines safely.
    
    Refactor the direct & uml backends to safely create the qemu & vmlinux
    command lines.
    
    Don't do malloc-after-fork, which is not safe.  Do all the allocation
    in the main process before the fork.
    
    Use stringsbuf to simplify the code.

commit 0f26218905816ca86b6ec57070eed802515f4853
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 15 13:52:13 2013 +0100

    Refactor backends so they are modular.
    
    Instead of hard-coding the list of backends into the core of
    libguestfs in many places, make each backend into a true module which
    registers itself with the core when the library is loaded.
    
    This is a step towards making backends into loadable modules, but it
    doesn't actually do that.
    
    This is just code motion.

commit 9b720899fc971e47a066d8d8720d30c58b193d23
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 15 12:34:47 2013 +0100

    launch: libvirt: Move internal_set_libvirt_selinux_* APIs to common launch code.
    
    This is just code motion, but means the libvirt backend no longer has
    to export those two internal APIs.

commit d2ae632d3bc0a4fcdbf4150a33406d7646f8cdf9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 15 21:59:48 2013 +0100

    lib: Use stringsbuf at various places in the library to simplify the code.
    
    This is just code refactoring.

commit 35278e4c186badb9e243628771da4cbd068ffaa0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 15 22:01:36 2013 +0100

    lib: Add stringsbuf mini-library for constructing lists of strings.
    
    This is modelled on similar code in the daemon that we have used
    successfully for a long time.

commit f1d2934216d3fca0501946c8ae0e5c7cd370e6b6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 15 21:48:50 2013 +0100

    list-filesystems: Don't fail if there are no filesystems found (RHBZ#995711).
    
    list-filesystems was returning NULL (but not setting an error) if no
    filesystems were found.  Instead return an empty list.

commit d0a205778698ea3b70623ad73302e739cf631d3c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 15 18:43:08 2013 +0100

    cmd: Better type checking in CLEANUP_CMD_CLOSE macro.

commit 00cbb5c1854a52a5b4742aa7ca9601a9aaaab529
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 15 11:33:55 2013 +0100

    utils: Move guestfs___drive_name function to the utilities library.
    
    For some historical reason, it was stuck in src/launch-direct.c and
    the comment referred to launch-appliance.c!

commit bd30d3a61ce9d14f2f744870a5d4ed8167d609e2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 15 09:12:44 2013 +0100

    podwrapper: guestunmount is a libguestfs page, don't link it to he.net.

commit d63325f6a1489c12e949ed2def271aea5d490750
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 14 23:30:30 2013 +0100

    Version 1.23.17.

commit b1a8733511836591bcf8931f25f0fb5cec7924ff
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 14 23:28:11 2013 +0100

    Remove contrib file from EXTRA_DIST.
    
    This fixes commit 36d29700dcef01d681d41f0b593a16e7814e3ee1.

commit 55ee0329c5cd73797a35ae3a66b38445e35b43a2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 14 17:40:24 2013 +0100

    guestfs-performance: Add a section on the performance of UML.

commit 78dbd08dd2115efcc488e8fbcaf9705697eb075b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 13 22:28:28 2013 +0100

    Rename 'qemu' as 'hv', 'LIBGUESTFS_QEMU' as 'LIBGUESTFS_HV'.

commit 46763bcc0b9d04ada367f29ca07bd3e11e264a8e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 14 15:25:17 2013 +0100

    launch: libvirt: Don't enable <cpu mode="host-model"> on TCG.
    
    It's fairly pointless to do this with TCG, since all we would be doing
    is emulating a more complicated processor slowly.  Also it may be the
    cause of subtle problems we see during testing.
    
    This updates commit 6f76fdb41eb6bd124fbc3d084f5c2a3371b37d9b.

commit c53b459fdd7fc340f48a76496b7e7e18256a2d64
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 14 15:08:04 2013 +0100

    launch: direct: Don't use -cpu host on TCG.
    
    qemu -cpu \? documents this as:
    
    host  KVM processor with all supported host features (only available in KVM mode)
    
    And indeed if you try it with TCG you'll get this error:
    
    Unable to find CPU definition: host
    
    This fixes commit 038ed0a08eaed33e62a27c9f91780a25de0bc08c.

commit 08f605c0732e9a9131f7d0975ec3daf5461ad54f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 14 12:52:48 2013 +0100

    tests: Add a test that console log messages make it up to events.
    
    In Rawhide, the console was briefly broken although it "fixed itself"
    when libvirtd was restarted.

commit 36d29700dcef01d681d41f0b593a16e7814e3ee1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 13 21:45:29 2013 +0100

    Remove contrib/guestfsd-in-wine.sh.
    
    Added in 2009, unlikely it still works since I doubt it has been
    compiled since then.

commit 4a873ee96671c20d4b124703275190d43ac5a08c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 13 21:31:12 2013 +0100

    uml: Change (temporary) path to UML binary.

commit 0a9f1fe8d66cb28ef08726b9feaa3acb66645161
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 13 15:46:02 2013 +0100

    Version 1.23.16.

commit 5094b421974b042386716ec25d96b5804f9d114b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 12 22:47:25 2013 +0100

    uml: Add check-uml and check-valgrind-uml to release tests.

commit 23ad2c607112e43fc4acec40b77d913709f039aa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 12 16:19:28 2013 +0100

    uml: tests: Add 'make check-uml' and 'make check-valgrind-uml' rules.
    
    These run the test suite using User-Mode Linux.  Currently you have to
    set LIBGUESTFS_QEMU to point to the vmlinux binary, but perhaps we
    can solve that in future.

commit b922f6521ea4448194f5f9fd6dc924d98b3d1890
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 13 13:50:36 2013 +0100

    uml: virt-make-fs: Modify test so it doesn't use qcow2 under UML.
    
    Modify the test so it doesn't try to test qcow2 format when the
    backend is User-Mode Linux which doesn't support qcow2.

commit 003e854b984c03a675e629499ab40b28d3af2ee7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 13 13:49:42 2013 +0100

    uml: sparsify: Skip test since it needs qcow2.

commit 2d758d548bc6d6e86eabb0214a5ff79787d94be1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 13 13:49:31 2013 +0100

    uml: resize: Skip test since it needs qcow2.

commit ca5ecf2e761bde4c813b1f2c0b3a7d337655f1bf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 13 13:49:16 2013 +0100

    uml: fuse: Skip test since it needs qcow2.

commit 574a7ad04c797cea72639259a3a381c4fa7fc4ba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 12 22:50:19 2013 +0100

    uml: tests: edit: Skip test since it needs qcow2.

commit d25732f85262d9fe74937c99a6fe123ac59e298a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 12 22:21:38 2013 +0100

    uml: tests/qemu: Fix tests so they work without support for qcow2.

commit 1d20770d4120f45f8f591e356ee7cc0b109a7fbc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 12 22:06:10 2013 +0100

    uml: tests/md: Skip test-inspect-fstab.sh since it needs qcow2.

commit e9d2508694b466d580b18885fd9bcc6c2365d756
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 12 21:57:00 2013 +0100

    uml: tests/md: Fix test to cope with /dev/ubd* device names.

commit 73e959e1ee5eef1a47b7c261932afcc7adc82a7d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 12 16:56:47 2013 +0100

    uml: tests/luks: Fix assumption that broke /dev/ubd* device names.

commit 9c3d1efcaac1be87fb89142a6046650a373b30d2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 12 16:43:50 2013 +0100

    uml: tests/lvm: Fix assumption that broke /dev/ubd* device names.

commit f622d854a75c6a86b0061b364ec2486330c976bc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 12 16:40:57 2013 +0100

    uml: tests/mountable: Skip tests that need qcow2.

commit 4d64dbfe48ed19f837f8d86fb2cf026adcc9c6d1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 12 16:34:27 2013 +0100

    uml: tests/disks: Fix test so it can cope with /dev/ubd* device names.

commit 8d5a0d77fbed365211ec0e52dd848c7c1b93d950
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 12 16:19:11 2013 +0100

    uml: tests: Skip some tests which cannot work with the UML backend.

commit 4c66cbc3beee3132a01d5861e9c9465e0b997158
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 12 21:23:44 2013 +0100

    uml: Fix race when multiple handles are used in parallel.
    
    See comment for explanation.

commit 3e4d55a6f98aee0490c8dc6c5c4eb8d08e524afc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 12 16:31:24 2013 +0100

    uml: Fix maximum number of disks.

commit ed3c98434f5942e30af48f50e5b7ccf223e0eea6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 12 18:44:41 2013 +0100

    uml: Fix guestfs_canonical_device_name API to understand /dev/ubd* paths.

commit 42754046269806a6b6385fee0b72115c73461221
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 13 13:50:43 2013 +0100

    virt-list-filesystems: Fix to use $g->canonical_device_name instead of homebrew function.
    
    The homebrew function didn't recognize /dev/ubd* device names, and in
    any case using the API function is shorter and clearer.

commit 90cafed4c2dab142a5c76a6ee879de27d48d8dc9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 12 21:49:55 2013 +0100

    daemon: list-md-devices: Check if a /dev/md<X> device is valid before returning it.
    
    For reasons not fully understood, if md is linked into the kernel (and
    not a module), a /dev/md0 device node is created.  However this is not
    a real RAID device.  For example running mdadm --detail /dev/md0 will
    fail on it.
    
    Check the /dev/md<X> devices are real RAID devices before returning
    them from the list-md-devices API.

commit 52188f1ea308225ab948141b1f23e0b47f7dcf4f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 12 21:28:58 2013 +0100

    daemon: md: Whitespace fixes.

commit 8ad634877cf315288497a8580fb4afc7658deae9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 12 19:25:11 2013 +0100

    daemon: If /proc/modules doesn't exist, linuxmodules optgroup is disabled.
    
    It likely means the kernel was compiled without modules support.

commit 071d7fb6d703a1184af93ff2e9ee1812606bd16e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 12 19:24:35 2013 +0100

    tests/regressions: Allow regression test for bug 914931 to be skipped.

commit 42abbf096932bd1e6c9c1bef64f602a67107d088
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 12 17:48:08 2013 +0100

    tests/md: Fix error path to display the correct output.

commit 4cc99ea2e99c90263aaeeefc8ed952596865abfc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 12 16:00:59 2013 +0100

    docs: The old make check-with-appliance/etc rules were renamed.
    
    This fixes commit 68990840b64491b39ab8da5f1e46367ae5f01594.

commit 8b43767b7cbf029c6e4c3974958d00f188c50aa0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 12 13:42:26 2013 +0100

    tests: c-api: Fix device name comparison when using User-Mode Linux.
    
    This updates commit 858d6e7176d7b18bc29c8503bbc2887a3b74a272.

commit ab797f7e47133635012d8cde04b0176cb783c41e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 12 13:41:53 2013 +0100

    docs: Clearer documentation for User-Mode Linux.
    
    This updates commit 858d6e7176d7b18bc29c8503bbc2887a3b74a272.

commit 19ee64303e65766b4a1b1ac55adbbb646a1c3500
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 12 13:41:24 2013 +0100

    launch: direct: Print \n after printing qemu command line.
    
    This makes it easier to see error messages printed by qemu.

commit e037f0d26b79df4a1df3c77adb5bba326bfd92d3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 12 13:40:24 2013 +0100

    daemon: compare_device_names: Fix typo in this function.
    
    This would have broken the function if we were comparing mixed
    /dev/sda and /dev/ubda (ie different length) strings.  Which we never
    normally do, luckily.

commit c09a2b5faf81cb97f4e3b88dd5c19607ff2265dc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Aug 11 23:06:37 2013 +0100

    Version 1.23.15.

commit 29d86583112bde951e7ba5a13a4c10b792fd831b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Aug 11 23:37:17 2013 +0100

    daemon: Ensure CLEANUP_FREE* variables are initialized with NULL.
    
    Otherwise an early exit from the function will cause an uninitialized
    pointer to be freed.
    
    This fixes commit 1d7c3a27822717398415940bde1d4476441e9c1a.

commit 858d6e7176d7b18bc29c8503bbc2887a3b74a272
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 9 22:46:39 2013 +0100

    Add experimental User-Mode Linux backend.

commit 9a6cc3c92796b730bba354eceadbb62d8ab1b7b9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 10 12:41:03 2013 +0100

    daemon: Recognize /dev/ubd[a-] as a valid device name.

commit f55a1a1fe78d2ba926e4c93ec3cfe9e40c3f7951
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 9 22:45:37 2013 +0100

    daemon: Allow guestfs_channel to override the virtio-serial channel.
    
    Also if /dev/ttyS* is specified, make sure the serial port is set to
    raw mode.

commit 236415e33939803565ae88a9222d3bae56ea16f9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 9 16:08:26 2013 +0100

    conn: Make sure we display all log messages when qemu goes away.
    
    If qemu goes away it is (more in theory than in reality) possible for
    log messages to be lost in the kernel's socket buffer.
    
    This turns out to matter more for User-Mode Linux.

commit 3620ca13398d007945906f620f934e627097411f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 9 16:09:39 2013 +0100

    appliance/init: Allow guestfs_noreboot=1 flag to avoid reboot at end of /init script.

commit e5285cc4210683887a5a4a853fe4e6a72c23e74d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Aug 11 19:45:12 2013 +0100

    lib: Turn 'random_chars' function used by libvirt backend into utility function.

commit 467fd96e7e7537a5aa706dd5ca2edb513aa833e9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Aug 11 19:47:44 2013 +0100

    utils: Remove duplicate inclusion of <string.h>.

commit 2089f7a21a307402c3efa43e5d10ee8d5ff554fb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 10 12:39:40 2013 +0100

    daemon: ldm: Don't return an error if /dev/mapper doesn't exist.

commit 1d7c3a27822717398415940bde1d4476441e9c1a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 10 16:35:30 2013 +0100

    daemon: Device name translation now allocates a new string.
    
    Previously device name translation worked on the string in-place.
    
    This worked fine because the device strings always come from XDR where
    they are dynamically allocated.  However it wouldn't work if the
    translated name had to be longer than the original, specifically for
    /dev/sd -> /dev/ubd (for User Mode Linux).
    
    Therefore this commit changes the generator so that
    device_name_translation and parse_btrfsvol (which depends on it)
    allocate the new device name instead of overwriting it.

commit 89cf1c1163f5c01f2335b7c030bb884be3310394
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 10 13:34:58 2013 +0100

    daemon: Move all RESOLVE macros to daemon/stubs.c.
    
    These macros are pretty horrible to use, with unexpected side-effects.
    Move them exclusively into the generated code and rewrite the one
    place in the general C code which used them.
    
    There's no functional change in this code.

commit d9694362059e869da67c1333d62adb66f7d0aa1e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 10 16:47:46 2013 +0100

    tests/mountable: Better error messages.
    
    Better error messages (for diagnosis) when this test fails.  Also this
    fixes the line endings which were broken before.

commit 94872348e852a9bdfa4d170b0f238d796789c73a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Aug 11 17:36:55 2013 +0100

    Fix --enable-valgrind-daemon so it doesn't break valgrind of the library.
    
    Using ./configure --enable-valgrind-daemon breaks valgrinding of the
    library because guestfs_close wouldn't call guestfs_shutdown in that
    case, resulting in some resources owned by the backend being leaked.
    
    After this commit, --enable-valgrind-daemon will shut down the handle
    normally.
    
    This updates commit 55e3b8711f340a2f8bdb8ee8ff99deb40b4e9108.

commit e7b06f7cf84d0a87d0c80d56b06e7e0017e55adc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Aug 11 12:07:38 2013 +0100

    Print an error message if valgrind failure is detected in the daemon.
    
    This updates commit 55e3b8711f340a2f8bdb8ee8ff99deb40b4e9108.

commit 7367729ec7a5d016878dd00b32cce45cec372931
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 10 23:02:42 2013 +0100

    daemon: Remove unnecessary sysroot_path (selinux).
    
    This fixes commit 72afcf450a78b7e58f65b4a7aaf94d71cd25fca5.

commit 55e3b8711f340a2f8bdb8ee8ff99deb40b4e9108
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 10 21:51:27 2013 +0100

    Fix --enable-valgrind-daemon option.
    
    Don't add the "valgrind channel" to the appliance.
    
    Just dump out the valgrind.log to stderr while the daemon is running.
    
    Ensure that if valgrind tests fail in the appliance, that we don't
    exit with success in the library by checking for a canary message in
    the verbose daemon logs.
    
    This allows the option to be used routinely by developers.

commit 26309a1c3a4a8ae4c79cc72ed83dfea4bde5c1a0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 9 22:33:52 2013 +0100

    proto: Fix --enable-packet-dump mode.
    
    This was broken when we rearranged the socket code.

commit 6c2fad11ac9a68dcfd42ee18681dc9a552625be9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 9 17:33:02 2013 +0100

    appliance/init: Display uname -a in debug output.
    
    Useful for debugging kernel / architecture issues.  Note this
    has no effect if debugging is disabled.

commit ce6e5738fc4ca9533e73cfe6b5fe3db872b7ec9d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 7 14:54:10 2013 +0100

    daemon: Close augeas, hivex, journal handles in unmount_all.
    
    This is also called implicitly from internal_autosync, ensuring that
    exit won't fail because of an open handle.
    
    libguestfs: error: internal_autosync: umount: /sysroot: umount: /sysroot: target is busy.
            (In some cases useful info about processes that use
             the device is found by lsof(8) or fuser(1))

commit 7c535c501b1ce131ae98dd948b22fc260d659d1b
Author: Paul Mackerras <paulus@samba.org>
Date:   Wed Aug 7 13:56:26 2013 +1000

    Fix parsing of boot flag in do_part_get_bootable()
    
    The code in do_part_get_bootable() assumes that if a partition has the
    bootable flag set, then that is the only flag.  It compares the entire
    flags field with the string "boot".  However, the boot flag isn't
    always the only flag.  For instance, POWER systems typically have a
    bootable partition of type 0x41 (PPC PReP boot), which parted -m
    displays as:
    
    # parted -m -- f18.img unit b print
    BYT;
    /root/f18.img:16106127360B:file:512:512:msdos::;
    1:1048576B:5242879B:4194304B:::boot, prep;
    
    That is, the flags field contains "boot, prep", and thus libguestfs
    fails to see that this partition is bootable.  Ultimately this causes
    virt-resize to fail to set the bootable flag on the boot partition of
    the destination image, resulting in an image that won't boot.
    
    This patch fixes the problem by searching for the string "boot" within
    the flags field, instead of comparing the whole flags field.

commit 5b278937dfd5177eaafcbc41830450ef5c0a2ab8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 6 18:20:44 2013 +0100

    sparsify: Advertize in --machine-readable that we support --check-tmpdir option.
    
    This lets programs add the --check-tmpdir=[ignore|continue|fail]
    option to avoid interactivity.
    
    This fixes commit 7c463ac477168df5d4e4eb472ba01fa18b89c1a6.

commit 12b740fbe00d40f57c7faa4744726b33d73082c5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 6 16:29:02 2013 +0100

    Version 1.23.14.

commit 1ef79b7f1f914e33abc2bec41e640a75e64d2f89
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 6 14:43:56 2013 +0100

    Pull latest translations from Transifex.

commit 56f613b13003b2ef44b25da360c5dac6eb5b0c71
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 6 14:34:48 2013 +0100

    Update Transifex domain name from .net -> .com.

commit 3197a2687c0b1d9ba5b9b3d32b5f0200e630628f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 6 14:31:48 2013 +0100

    Update gnulib to latest version.

commit 7c463ac477168df5d4e4eb472ba01fa18b89c1a6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 6 13:18:54 2013 +0100

    sparsify: Get free space on TMPDIR and give a warning if we estimate it is too little.

commit f6b2efcdffe8688fc415b3f1cd9d608dd396f253
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 6 12:20:31 2013 +0100

    Update TODO file.

commit c4a3e8112ae7a022973f8658818f4672ed0565cb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 6 11:41:34 2013 +0100

    New APIs: aug-setm and aug-label.
    
    Bindings for the aug_setm and aug_label APIs in Augeas.

commit f26a0407d2a61ed334b4a9d42b1269feb3cab76e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 6 11:41:08 2013 +0100

    augeas: Improve error reporting.
    
    Display all the information from the handle about errors.

commit a709b10bb6f6e5cad81b9333ac7f15458f2e1ce5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 5 16:50:15 2013 +0100

    launch: libvirt: Enable kvmclock.
    
    This enables stable guest clocks.

commit 6f76fdb41eb6bd124fbc3d084f5c2a3371b37d9b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 5 16:42:43 2013 +0100

    launch: libvirt: Enable <cpu mode=host-model>.
    
    This may still cause problems on some CPUs because of a bug
    in libvirt.  See:
    https://bugzilla.redhat.com/show_bug.cgi?id=870071

commit 038ed0a08eaed33e62a27c9f91780a25de0bc08c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 5 16:35:47 2013 +0100

    launch: direct: Specify -cpu host,+kvmclock.
    
    '-cpu host' makes the CPU look like the host CPU.  This is useful
    because it means the appliance can use all the host CPU's features,
    eg. for fast checksumming or MD XORing.
    
    'kvmclock' is the paravirtualized clock for qemu/KVM.  It's much more
    stable than relying on tsc or a virtualized device such as HPET, and
    clock instability is one of the problems we have encountered when
    running libguestfs on a heavily loaded machine, especially in a nested VM.
    
    Note that we require qemu >= 1.2 (and have for a while) which has long
    supported both of these options.

commit 568368cdf524d3ef96fb3905e39cc859c4bb4258
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 5 16:35:15 2013 +0100

    launch: direct: Add drives after machine parameters.
    
    This is just code motion.  It should affect the semantics of the code,
    nor how the appliance VM is created.

commit 8d68f1c5ceb5ac613393654bde58127e50c0f7bf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 5 15:41:39 2013 +0100

    ./run: Omit timeout -k option on RHEL 6.
    
    If timeout doesn't have the -k option, don't use it.

commit 82a656341432ba61d00b38ff4e5413388286fd03
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 3 12:45:55 2013 +0100

    Version 1.23.13.

commit 93f8baeb9a07cbbf9bdaa5d10c98c1c9d6af96f7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 3 10:42:21 2013 +0100

    sysprep: Add "notes" field for notes on shortcomings, bugs, etc.
    
    Instead of keeping this information as comments in the source, put it
    into the virt-sysprep(1) man page.

commit 4cdbae926bb336c8d0dea8e7b6e0dcc3fb219c2d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 3 10:12:42 2013 +0100

    sysprep: Various code refactorings of the operations.
    
     - Use 'op' instead of 'xxx_op' for operation table.
     - Add a 'defaults' for the operation table and remove any default
       values.
    
    This is just code motion and there is no functional change.

commit 67fd809ca3ec711d80e69ab32646899e7ca047eb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 3 10:03:49 2013 +0100

    resize: Mark progress bar functions as "noalloc".
    
    Avoids GC overhead and turns these into simple C calls.  See:
    http://camltastic.blogspot.co.uk/2008/08/tip-calling-c-functions-directly-with.html

commit 3d39549ded3e05df929547bb65ce620e6487a81b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 3 10:01:34 2013 +0100

    resize: Mark isatty function as "noalloc".
    
    This turns it into an ordinary C call without the unnecessary [in this
    case] GC frame overhead.  See:
    http://camltastic.blogspot.co.uk/2008/08/tip-calling-c-functions-directly-with.html

commit 0c512a52bdc2a88296d04900625822b34d567112
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 3 09:20:41 2013 +0100

    FAQ: Tips about using direct backend and fixed appliance on Fedora/RHEL.

commit 9268f1487970eb9884ba674ab75dc99f91adc0a7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 3 09:19:57 2013 +0100

    FAQ: Common problem with Debian is not running update-guestfs-appliance.

commit 44df867382bf642689301c50d0cbb63bb354b987
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 2 15:00:04 2013 +0100

    sysprep: Allow root and non-root passwords to be set.
    
    This adds a virt-sysprep 'password' operation which adds the
    following command line options:
    
      --root-password     Set the guest's root password.
      --password          Set any guest password.

commit 5deea7fce675edb6803cd83a699b80e8ea383488
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 2 15:16:10 2013 +0100

    sysprep: Disable fs-uuids operation by default.
    
    Disable this operation because it is more likely than not to break
    Linux guests.
    
    To fix this properly will involve finding all the places in the guest
    where the UUIDs are used to locate and mount filesystems,
    eg. /etc/fstab and possibly initramfs.
    
    This updates commit 8965368eb89532ac1613fffb0a3a661f005bae81.

commit a89675ee5cf7b1ba255c185ad88487997b935a6d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 31 20:43:43 2013 +0100

    journal: Fix incorrect printf format specifier for 32-bit.
    
    journal.c: In function 'do_journal_skip':
    journal.c:134:5: error: format '%zd' expects argument of type 'signed size_t', but argument 3 has type 'int64_t' [-Werror=format=]
         reply_with_perror_errno (-r, "failed to skip %zd journal entries", skip);
         ^
    
    This fixes commit 5cb7f294f6a5a8b4a68e940c30ca9af0fe0741d5.

commit 6a46bd9a8622050b1b603b15933a068fba4a56a8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 31 20:42:06 2013 +0100

    arm: Avoid cast-align warning.
    
    Note the 64-bit int field really isn't aligned.  We hope that the ARM
    kernel this is running on will do the appropriate fix ups.

commit 94e5ea6b5ef0d4e4f2d30b51cb5dcce175819456
Author: Nicholas Strugnell <nstrug@redhat.com>
Date:   Wed Jul 31 16:24:20 2013 +0100

    sysprep: rhn_systemid: delete osad-auth.conf file in RHN configuration

commit a1e8acc736bbeb5f0703586a3b8781422fd2e2dd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 30 18:16:30 2013 +0100

    Version 1.23.12.

commit 65b4ab11e188ac94a025e1a86a43b84fac64a9e0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 30 16:16:55 2013 +0100

    tests: fish: Add valgrind testing to various existing tests.
    
    This involves running ./guestfish under $VG (== valgrind + options,
    defined only when check-valgrind is run).

commit 23d429ff845f29b345ff76efab669daf92b5ab42
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 30 16:15:04 2013 +0100

    fish: Add a test for -a URI options.

commit e3df223a5aed82b7e502bef327d57dd54d98587b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 30 16:13:24 2013 +0100

    fish: Fix guestfish so it can recognize sheepdog://... as a valid URI.
    
    Because "sheepdog" is 8 characters, it wasn't recognized before.

commit b65c1c667b26313abf312a7ab51f8bf947243d07
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 30 14:49:55 2013 +0100

    sysprep: Allow -a URI options to be used (RHBZ#968875).
    
    This allows you to sysprep a remote guest by doing eg:
    
      virt-sysprep -a ssh://remote.example.com/disk.img

commit 406522d1d2c9108c52f1356cbbb9bb4039d9ce84
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 30 14:34:23 2013 +0100

    resize: Add bindings for the guestfish -a URI parsing mini-library.
    
    This allows -a options to be parsed from OCaml programs, reusing
    the same code that is being used by C.

commit 4d7c14fdbb372d6ad5ef729b6969078b5fdb68da
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 30 12:43:33 2013 +0100

    fish: Split off URI handling (for -a argument) from general options parsing.
    
    This is so we will be able to reuse the same code in the OCaml tools.
    
    This is just code motion.

commit 671be806ae79df5d0a9e864d2f9b3461d08c7733
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 30 12:22:08 2013 +0100

    fish: options: Fix optarg -> arg.
    
    Don't read the global variable optarg.  Read arg instead.
    (In all cases they are the same, so this bug made no difference).

commit a3891430bc9fe408505277701962acaa664fc96a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 30 12:17:22 2013 +0100

    fish: Don't store xmlURIPtr directly in the drive struct.
    
    Original drv_uri fields:
    
          xmlURIPtr uri;        /* URI */
          char *socket;         /* ?socket parameter from URI. */
          const char *format;   /* format (NULL == autodetect) */
    
    New drv_uri fields:
    
          char *path;           /* disk path */
          char *protocol;       /* protocol (eg. "nbd") */
          char **server;        /* server(s) - can be NULL */
          char *username;       /* username - can be NULL */
          const char *format;   /* format (NULL == autodetect) */
          const char *orig_uri; /* original URI (for error messages etc.) */
    
    This is just code motion.

commit 0e1ba00059b5ebbca2e137f2685b2eb65ed33b13
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 30 12:16:38 2013 +0100

    internal: Add CLEANUP_XMLFREEURI (cleanup function for xmlURIPtr).

commit b56990ddf8aa4dc4db3da592783acfe055c05534
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 30 11:44:47 2013 +0100

    resize: Move isatty_stdout function to separate module (TTY.isatty_stdout).
    
    It was jammed into the Progress module just for convenience.

commit c663ab3bb9ab02fb3ca6209333c2d5402081c4de
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 29 14:37:50 2013 +0100

    daemon: cap-get-file: Return empty string if no capability on file (RHBZ#989356).
    
    Return an empty string (instead of an error) if no capabilities are
    set on a file, and document that in the API.

commit fb282e677c015de65627790a02aceb6ed264ed80
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 29 13:52:16 2013 +0100

    resize: Link to information about dracut-modules-growroot.

commit a1236b7251c20dea0db7c5c4fc475ceeda176296
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 29 11:58:48 2013 +0100

    tests/mount-local: Fix test of parallel mount-local.
    
    This fixes commit 14fabcd88e1500368affad86b3cf221f3884a739.
    
    Bug found by Kashyap Chamarthy.

commit 7a6968f1e4cf8cbaf55c51f791cec82fa69bd1bd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 29 08:58:41 2013 +0100

    Version 1.23.11.

commit ebf477107db6bfeff9d0fae56591ebaf3e20109d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jul 28 18:09:42 2013 +0100

    tests: Add tests for the new journal APIs (RHBZ#988100).
    
    This relies on the test data from
    commit b502197ec4f201fa79255243fa09343cf3550ab5.

commit 5cb7f294f6a5a8b4a68e940c30ca9af0fe0741d5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 27 15:28:50 2013 +0100

    New APIs: Add systemd journal support (RHBZ#988100).
    
    This adds simple support for reading the journal files from guests
    that use the systemd journal.
    
    The new APIs are:
    
      journal-open
      journal-close
      journal-next
      journal-skip
      journal-get
      journal-get-data-threshold
      journal-set-data-threshold
      internal-journal-get
    
    More complex journal support (eg. for seeking within the journal,
    support for cursors) could be added later.

commit b502197ec4f201fa79255243fa09343cf3550ab5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 27 17:58:50 2013 +0100

    tests/guests: Add some systemd journal data to the Fedora test images.
    
    The journal data blob comes from a real Fedora 20 (x86-64) machine.

commit 1937108a4a6070750f0d636f7dcc8725441cc4eb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 27 16:34:54 2013 +0100

    src/file.c: Be sure to call guestfs___lazy_make_tmpdir before using g->tmpdir.
    
    Although g->tmpdir is always set after launch, and none of these calls
    should be used before launch, it's always possible that a caller would
    use one of these APIs before launching the handle.
    
    If guestfs___lazy_make_tmpdir is not called, then g->tmpdir is NULL,
    and the constructed filename would look like "(null)/...".
    
    In fact it's possible to observe this error (although it seems to have
    no especially bad effects):
    
      $ strace guestfish ls / |& fgrep '(null)'
      unlink("(null)/ls1")     = -1 ENOENT (No such file or directory)

commit e31c32ce1bc87d164103e79288effc64bb41181f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 27 15:56:13 2013 +0100

    generator: Fix the case where a daemon function has one FileIn/FileOut parameter and no other parameters.
    
    The FileIn/FileOut parameters are not passed through to the daemon.
    Previously we generated incorrect RPC code (an empty 'struct
    guestfs_<fn>_args') because we didn't account for these FileIn/FileOut
    parameters correctly.

commit 559bd48960f795dc59d889e5776f545f2e0d494a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 27 15:48:33 2013 +0100

    generator: Fix whitespace.

commit 44c5026d9e06cf5f01098608ddd0aa4acb7bb6eb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 26 15:42:36 2013 +0100

    sysprep: On RHEL, firstboot script should be called S99... not 99.
    
    Thanks: Nicholas Strugnell

commit 4d2c63a9bc3accd7b852b1c8b2089c6296fee156
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 23 12:23:51 2013 +0100

    Version 1.23.10.

commit 4180abcc1fe25ecc1cc82ee114b037f61cdffd15
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 19 19:36:49 2013 +0100

    tests: Use unique or temporary names for temporary files.
    
    Review every test(!) to ensure that it:
    
     - Doesn't use a generic name (eg. "test1.img", "test.out") for any
       temporary file it needs.
    
     - Does instead use a unique name or a temporary name (eg. a name like
       "name-of-the-test.img", or a scratch disk).
    
     - Does not use 'rm -f' to clean up its temporary files (so we can
       detect errors if the wrong temporary file is created or removed).
    
    This allows tests to be run in parallel, so they don't stomp on each
    other's temporary files.

commit ccd069f859c35c778a4a0cb619dcb6c34a29e247
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 23 09:42:45 2013 +0100

    fish: For -N option, add drive with explicit format = "raw".
    
    Although autodetecting is safe (we always have just created a drive),
    it saves a little bit of time if we don't have to run qemu-img to
    detect the disk format with the libvirt backend.
    
    Note that for prepared drives the format is always raw and we don't
    anticipate creating drives in other formats.

commit 7c8c6e0760d54985d7a4b1fd01bf23c9c8466deb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 22 14:08:20 2013 +0100

    fish: Allow -N filename=type to use 'filename' instead of 'test1.img' (etc.)
    
    So:
    
      guestfish -N fs
    
    is equivalent to:
    
      guestfish -N test1.img=fs

commit 3c94f0245677a61f271163735444526bd37d29fb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 22 15:24:44 2013 +0100

    fish: Split up long line in --help output.

commit a8b03201f0c240d4ef433e349ef7645b90874bb5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 22 13:58:49 2013 +0100

    fish: Clarify documentation.
    
    It's not "the guest" which is launched, but the libguestfs appliance.

commit 8965368eb89532ac1613fffb0a3a661f005bae81
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 22 13:28:28 2013 +0100

    sysprep: Add new fs-uuids operation.
    
    This creates new random UUIDs for all filesystems in a guest.

commit df02c2471f3fe94c691c389c17a5d23d052848dd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 22 13:13:18 2013 +0100

    docs: Document labels and UUIDs in the API overview section.

commit 8580ef7d0f2aac2118fa7b4055f3eb28cd127093
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 22 12:41:47 2013 +0100

    New API: Implement set-uuid for ext2/3/4 and XFS (RHBZ#986877).
    
    Also includes tests.

commit 091d22f49e7fcb53fb3bb23e2ba94ca12eb88eab
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 22 11:29:42 2013 +0100

    daemon: Implement set-label for XFS and fix it for btrfs (RHBZ#986875).
    
    Implement 'set-label' for XFS filesystems.
    
    Fix the call for btrfs.  Previous
    commit d5817537fa6c51a7f851ecc5e4e63e60609e0c03 added some bogus
    documentation implying this call would work for btrfs, but it did
    not.
    
    Add tests.

commit 5724efa69f0192b71350d9c025e815218f112572
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 19 19:32:35 2013 +0100

    tools: 'test.img' is no longer used.
    
    This probably used to be a temporary file used for testing.

commit 14fabcd88e1500368affad86b3cf221f3884a739
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 19 16:42:53 2013 +0100

    tests: Use new guestfs_add_drive_scratch API where possible in tests.
    
    Replaces code such as:
    
      fd = open "test1.img"
      ftruncate fd, size
      close fd
      g.add_drive "test1.img"
    
    with the shorter and simpler:
    
      g.add_drive_scratch size

commit 57064c12aeb4145c2dd119cb98bca16d738dc3f3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 19 15:57:32 2013 +0100

    fish: Link to the new 'scratch' command from the old 'sparse' command.

commit 0d97bcf8ae498b2ad92e523f2a6bd973bde3a9c0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 19 15:57:11 2013 +0100

    tests/lvm: Remove some commented out debugging code.

commit 0f7642674bf948ddba1adce82ff768ed78f0ab16
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 19 15:05:54 2013 +0100

    tests/c-api: Use guestfs_add_drive_scratch API to create scratch drives.
    
    Replaces the old custom code for making and deleting the drives.

commit 1b11a83d5248511abbf86775601eb6e25a36c1ee
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 19 14:09:56 2013 +0100

    New API: add-drive-scratch.
    
    This adds a temporary scratch drive to the handle.

commit ecce45acc493639390972b8033f175a0bec9bef3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 19 14:25:46 2013 +0100

    Revert "tests: Add a regression test for all disk_* info commands (RHBZ#981663)."
    
    This reverts commit 2311fb0632a64cfa2bab8bf65c82ffaa042d619e.
    
    This is no longer needed, since now the disk_* info functions
    are being properly tested by the C API tests.

commit 8a3ecfc04e0561dac74c94ecbafaac8248e302c7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 19 14:23:50 2013 +0100

    tests/c-api: Remove 'GETKEY:' hack since it's no longer used anywhere.

commit 89865011e4ea725c9c69b0d473118ffcd5039ac3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 19 14:22:58 2013 +0100

    tests: Better testing of guestfs_disk_* functions using blank disks from tests/data directory.

commit 48ed7abc21430f0138a37b593e4341ef04db4f95
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 19 14:22:14 2013 +0100

    tests/data: Add some blank disks in various sizes and formats for testing.

commit b1d1a18af99c75ab99c27aa21604814399e572a8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 19 13:19:58 2013 +0100

    ocaml: Rewrite TESTS rule to be compatible with automake 1.13 parallel-tests.
    
    Because of this bug in automake:
    
      https://lists.gnu.org/archive/html/bug-automake/2013-01/threads.html#00103
    
    this requires that we duplicate the lists of bytecode (bc) and native
    code (opt) tests because we cannot use ordinary GNU make macros to
    construct these lists.

commit 7867c7cd8e4f3dd6c764a309136bce3a0f2630f9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 20 16:30:45 2013 +0100

    FAQ: Add section about different packaging strategies for libguestfs.

commit ec4498fec19764818b9b82255a206d57c5c279fc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 19 12:00:03 2013 +0100

    Update API support.

commit 0fbd5703c89504987dbda6fa41be96dd0bd7dc71
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 19 10:06:31 2013 +0100

    Version 1.23.9.

commit 3201e7556424bd305ec39ac49dd84c0471f64544
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 18 14:36:25 2013 +0100

    mkfs: Use -b size=<size> for xfs (RHBZ#981715).

commit 2311fb0632a64cfa2bab8bf65c82ffaa042d619e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 18 13:59:09 2013 +0100

    tests: Add a regression test for all disk_* info commands (RHBZ#981663).

commit 28e08776824dd3152638e647259c2f4701a0a577
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 18 13:07:13 2013 +0100

    info: Fix double-call to error function when qemu-img info command fails (RHBZ#981663).
    
    Previously if the 'qemu-img info --output json' command failed, then
    the stdout callback would be called first with a zero-length buffer.
    Since a zero-length buffer cannot be valid JSON (in this context)
    don't produce a separate error message.
    
    However do catch the case when qemu-img info might produce no output
    and no error (if that were to happen -- it does not happen at the
    moment).

commit d50cb7bbb4cc18f69ea1425e9f5cee9685825f95
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 18 13:04:55 2013 +0100

    info: disk-format et al: Fix error message when no file exists (RHBZ#981663).
    
    $ guestfish disk-format /etc/nosuchfile
    
    Instead of this obscure double error message:
    
      libguestfs: error: qemu-img info: JSON parse error: parse error: premature EOF
                           (right here) ------^
      libguestfs: error: qemu-img info: /etc/nosuchfile: qemu-img info exited with error status 1.
      To see full error messages you may need to enable debugging.
      See http://libguestfs.org/guestfs-faq.1.html#debugging-libguestfs
    
    You will now see this simpler error:
    
      libguestfs: error: disk info: /etc/nosuchfile: No such file or directory
    
    Thanks: Bo Fan.

commit aecb5f4b33107935191099dbd5559113f59ee51c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 18 13:57:39 2013 +0100

    cmd: Allow callers to override file-closing behaviour after fork.
    
    This allows us to send file descriptors directly to child processes,
    eg. using /dev/fd/<N>.

commit 758a2262f5f4033de3400bbe00fac2f85310b4ff
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 18 10:03:13 2013 +0100

    acls: Improve documentation for acl_set_file (RHBZ#985269).
    
    Thanks: Bo Fan.

commit ea817cdc603477ab691ce49b21ecf9f0cca6f944
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 17 16:57:58 2013 +0100

    library: Fix a few direct calls to perror(3).
    
    Mainly in the FUSE code, left over from when this code lived in the
    standalone guestmount program.

commit ed2351e13711ae860f27b35f942e656b31447f96
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 17 12:52:41 2013 +0100

    tests: Improve the testing of acl_set_file function.
    
    See also: https://bugzilla.redhat.com/show_bug.cgi?id=985269

commit a7b9d61cde63020686afe769ca8265a01fce208f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 11 21:05:56 2013 +0100

    ./run: Increase default timeout from 1h -> 4h.
    
    1 hour was not long enough for the C API tests when run in Koji.
    
    This update commit caab9f1e6f7ac0d8d5209c31854d640b807519ce.

commit ae78381287771a781f939f26a414fc8cfdc05fd6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 11 19:09:05 2013 +0100

    launch: appliance: Fix a double-free if kernel linking fails (RHBZ#983218).
    
    This also simplifies the code which takes the building_lock around
    guestfs___build_appliance.
    
    Thanks Attila Fazekas for the detailed bug report.

commit caab9f1e6f7ac0d8d5209c31854d640b807519ce
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 11 12:58:45 2013 +0100

    ./run: Timeout tests after 1 hour.
    
    No single test should run longer than 1 hour even on the slowest of
    hardware.  We are having a problem in Koji where a test hangs and then
    we end up losing the output completely, so a timeout + print the log
    to that point is much better.

commit 745e507c2fd06f9349212efe86f8143a1f0c5a0e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 11 12:53:28 2013 +0100

    ./run: Add a better comment describing --test mode.
    
    This is just code motion, there is no functional change.

commit 7e134f865f4e4e35f27d0c676645fffc16d85e80
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 9 14:32:14 2013 +0100

    Remove more temporary ($builddir/tmp) files when doing 'make clean'.

commit 0bc729e85b11262e5c1a38aff1602c960277c2b4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 9 13:59:52 2013 +0100

    golang: Fix it so it builds if libguestfs is not installed.
    
    It was using the installed copy of libguestfs not the local copy.
    
    We can't encode the paths in guestfs.go, since this source file gets
    copied into the install directory where those paths would not make
    sense.  Instead we have to use CGO_CFLAGS and CGO_LDFLAGS to
    communicate the right flags to go when doing the local build and test.

commit 2624315bf11ad39ee15d698405887e2c6c5fcd0e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 9 11:59:04 2013 +0100

    Version 1.23.8.

commit d457df7dc210178902e9462f5caa4d556753badd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 6 21:05:13 2013 +0100

    tests: Add test for aug_ls.

commit bf838e3333b5002e1094f9b38bc95c15e597ccb1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 6 20:46:19 2013 +0100

    tests: Test aug_insert, aug_clear and aug_save.

commit 48c16e5ef1174aa40a5769b229424e12835bba5c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 6 20:04:53 2013 +0100

    tests: Test aug_set.

commit 535963bac3018dc7a1874f0a2ed6896ffc3b70eb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 6 19:57:43 2013 +0100

    tests: Test result of aug_get properly.
    
    Don't just check aug_get runs, check the resulting string is correct.

commit 86ca8af9f1faf956da96c4e7c51ca6acac7ad40d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 6 19:24:40 2013 +0100

    tests: c-api: Add a cleanup function for tests.
    
    By specifying a cleanup function we can ensure that Augeas and hivex
    functions can be tested.
    
    There is no functional change here, verified by diffing the generated
    file tests/c-api/tests.c before and after.

commit b5a938f464a5f2649473b251f7adce7841b33974
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 6 20:41:34 2013 +0100

    tests: Fix mix up of actual/expected in error messages.

commit 02123b72429ab156512f682301946dfe02780336
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 6 15:08:13 2013 +0100

    FAQ: Fix typo.

commit 4b838a4b28e660cda4569c099784dc2a53dc74de
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 6 15:07:58 2013 +0100

    FAQ: Explain qemu-nbd & libguestfs better.

commit 31ce47fe489d74ac21401624d88739aafdcb21e1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 5 15:07:34 2013 +0100

    tests: Add basic Augeas tests.

commit 8c9a5d623ea79448a3912c22e90c05771d7d1c1f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 5 14:58:26 2013 +0100

    hivex: Add some simple tests of the hivex_* APIs.
    
    These are by no means comprehensive, but cover the basics.
    
    The 'minimal' hive comes from hivex.

commit c8f0a2eb76a39a009e0591f73e5249f3bcfc4ee8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 5 14:25:16 2013 +0100

    daemon: hivex: Check that hivex_commit is passed an absolute path (RHBZ#981683).
    
    You will now get an error like:
    
    libguestfs: error: hivex_commit: do_hivex_commit: path must start with a / character

commit 280dbed9aabcb5aa2ddbed4f0c49a82235df7eae
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 5 13:59:21 2013 +0100

    filesystem-available: Clarify documentation for this test.
    
    See:
    https://bugzilla.redhat.com/show_bug.cgi?id=980358#c1
    
    Thanks Bo Fan.

commit 06f2c1ad709cd5ea0a1e6956da14a56d5b959be7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 4 14:42:26 2013 +0100

    golang: Add examples and guestfs-golang(3) man page.

commit 43121a02e7c42bf4ab31110b22907bb5b9919e59
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 4 15:27:12 2013 +0100

    golang: Don't try to free the result of guestfs_last_error.
    
    The return value is a constant string, part of the handle, and
    it must not be freed by the golang code.

commit bb09c4a4489a0c2f18e1a95f40d12e288d2bc94f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 4 14:42:45 2013 +0100

    golang: tests: Call or defer g.Close().

commit 58b51f5921f7538f9c1dc41bb40820f3217e6883
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 4 13:50:32 2013 +0100

    golang: Add bindtests.

commit d48e4400fc454ce401a8feac9d013e489df6f198
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 4 14:00:56 2013 +0100

    golang: Map OptString to *string, not string (since string is not nullable).

commit 86c1e53ee6f3e499701d61c19d301cb5b148e394
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 4 13:49:01 2013 +0100

    golang: Capitalize fields in OptArgs* structs.
    
    Otherwise those fields aren't accessible outside the package.  We
    didn't catch this because all tests run in the same package.

commit a31926bd75478f8c635b287d34b83d0c247415c1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 4 13:12:00 2013 +0100

    golang: If 'go run' command fails, log the error message in config.log.

commit 8f504539f21647d72ac537fade26a02be004c63d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 4 13:11:45 2013 +0100

    java: Fix typo in comment.

commit 4bb3aa7dde3bb6fd5264c6f2cdb65835e58ee424
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 3 12:39:16 2013 +0100

    Version 1.23.7.

commit b6f01f32606d6f325e47562d97983f8ff69fd3c6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 1 12:45:09 2013 +0100

    Add Go (language) bindings.

commit 667b303c9afad887f7e23082d2d2b09fcd1f9d5c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 1 15:27:06 2013 +0100

    java: Fix comment in test script.

commit cd9f40945d45f2f44d3986f15dc9b82bd03ac7dc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 28 12:57:07 2013 +0100

    configure: python: RHEL 6 doesn't have sysconfig, use distutils.sysconfig instead.
    
    This works on recent Python as well.

commit 7f4048f9d57acd311416d4ceb4a7725ccc9554c8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 26 19:02:16 2013 +0100

    Version 1.23.6.

commit fb0bd82dbe9c3cad40312e89de5b61195f5fd889
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 26 14:37:26 2013 +0100

    daemon: Verify ext2/3/4 filesystem name before passing to mke2fs (RHBZ#978302).
    
    Add a utility function (fstype_is_extfs) to match ext2/3/4 filesystem
    names.  This is used in a couple of places.
    
    When passing the mke2fs -t parameter, verify that the request is for
    an ext2/3/4 filesystem.  Previously we did not check this, and neither
    did mke2fs when the -F flag was also used.

commit dd21bec4009ad6a65be1634b513be50ee668a63a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 24 21:06:58 2013 +0100

    sysprep: New operation to remove RPM database files.
    
    See:
    https://lists.fedoraproject.org/pipermail/devel/2013-June/184389.html

commit a7aa47f4de7c61620c92f95ceb2d6de833152574
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 20 09:13:41 2013 +0100

    virt-resize: Add notes about Windows and disk consistency (RHBZ#975753).
    
    Also group the Windows-related notes together.

commit b730bc0c4685887232daed8fafa491b28f38c300
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 19 19:03:21 2013 +0100

    virt-resize: Take into account large start offset of the first partition when calculating overhead (RHBZ#974904).
    
    Since we don't usually move the first partition, if the first
    partition has an unusually large offset from the start of the disk,
    then the unpartitioned space in front of that partition counts as
    partitioning overhead.  However the previous surplus calculation was
    not taking that into account.
    
    This was a problem for certain Ubuntu images which are partitioned
    with an 8 MB gap before the first partition.
    
    Thanks: David Hart.

commit 07f3e5ae5cba03d29c5b9675c7f137463b29d424
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 19 19:02:48 2013 +0100

    virt-resize: Add some more debugging messages.
    
    These are only printed when using the --debug flag and are
    helpful for diagnosing problems.

commit 7949fd3949c300ec70b85b40d8ac7a9d651cd4af
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 19 19:02:15 2013 +0100

    virt-resize: Fix minor typo in error message.

commit d8a3185823e608dbddbc6185209951140b8f3b33
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 19 13:26:18 2013 +0100

    tests: Add a regression test for iface launch hangs (RHBZ#975797).

commit f7fe7e8db021b13f40aba56722d6ebe58e3777d2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 19 14:40:51 2013 +0100

    launch: direct: Calculate appliance root correctly when iface drives are added (RHBZ#975797).
    
    This also changes guestfs___appliance_command_line to allow
    appliance_dev parameter to be NULL.  Previously a bogus root=
    parameter could be passed.

commit e7f83f2ecc8e5e00e15e49357b37980b68fa7153
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 19 13:21:10 2013 +0100

    tests/regressions: Remove duplicate test skip code.

commit cf0dcb6a0b4b855f9b16bd3849b8d2512ca5b058
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 18 17:43:26 2013 +0100

    Version 1.23.5.

commit d88f6c0ba62d65acf8db074d33109947907ec048
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 18 19:31:21 2013 +0100

    tests: inspection: Add example and test XML to EXTRA_DIST.
    
    This fixes commit a86cb71fcadbed3881e593b6de9706c03ca57149.

commit 0ff0454c59ae79d47fadcc4f2837e3bfca7af105
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 18 18:00:24 2013 +0100

    tests: inspection: Don't complain because NTFS UUID changes between test runs.
    
    This fixes commit a86cb71fcadbed3881e593b6de9706c03ca57149.

commit a86cb71fcadbed3881e593b6de9706c03ca57149
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 18 17:11:21 2013 +0100

    inspector: Add a real test of inspection.
    
    Verify that the output from inspection doesn't change, in order to
    catch regressions such as RHBZ#975412.

commit d7bc1dd92241ed569627b7583a014059afa5fc37
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 18 17:01:53 2013 +0100

    inspection: Replace phony XML with virt-inspector output from real guests.
    
    Also add an example from a real RHEL 6 guest.
    
    Remove rules for building these XML files which are no longer
    relevant.  These files were built by running virt-inspector on real
    guests, and then edited to remove excessive <application> sections.

commit 2343840936c900109b6675cc6e605026443ccf0a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 18 15:13:02 2013 +0100

    inspection: Fix hostname inspection because of faulty Augeas path expression (RHBZ#975412).

commit 2c4e7ad135b0a14021fad2b942f66b78af0041e0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 18 14:39:55 2013 +0100

    Augeas >= 1.0.0 is now required.

commit 2ee4d5e059840b518814dd6ce615627fe0a8391d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 18 15:12:02 2013 +0100

    utils: Add utility functions guestfs___concat_strings and guestfs__join_strings.
    
    These concatenate strings or join them with a separator in between.

commit 3a5b0f1787ed3f92a7ae8cdb0cd172609b9391f1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 14 13:20:26 2013 +0100

    Version 1.23.4.

commit 7f228489d00f526c5e5a4d29cf930150b0f29083
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 14 11:03:24 2013 +0100

    inspection: Fix inspection of Fedora guests (RHBZ#974489).
    
    Commit e71b2c11f59b3f8ae0c4b31c4ab5b0d1bfcdf181 broke inspection of
    Fedora guests because guestfs_is_file returns false for
    /etc/redhat-release (it's a symlink to a file, not a file).
    
    We fix this by using the new followsymlinks flag added in the
    previous commit.  Thus guestfs_is_file becomes
    guestfs_is_file_opts (g, filename, GUESTFS_IS_FILE_OPTS_FOLLOWSYMLINKS, 1, -1)
    which checks if it's a file or a symlink to a file.
    
    This fixes commit e71b2c11f59b3f8ae0c4b31c4ab5b0d1bfcdf181.

commit ef107448e89c10899cefc27f887bd627c1d7e777
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 14 10:53:17 2013 +0100

    Add followsymlinks flag to is-file, is-dir, is-blockdev, is-chardev, is-fifo and is-socket APIs.
    
    This adds an extra optional boolean 'followsymlinks' flag to those 6
    is-* APIs.  If the flag is true, then symlinks are followed, ie. we
    use stat instead of lstat in the test.
    
    For the rationale behind this change, see:
    https://bugzilla.redhat.com/show_bug.cgi?id=974489

commit 3cf442872b963e4e60367d728237569113f7c249
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 11 13:09:09 2013 +0100

    FAQ: Developer questions about committing and forking.

commit 372217c375aea4d1878f55bca36e29c53529435c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 11 13:08:49 2013 +0100

    FAQ: Emphasize that we don't accept github pull requests.

commit d2c05c96cabf63d1c5bf4eaf8452c33180b88e95
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 11 12:55:26 2013 +0100

    FAQ: Put B<> bold section around "Note"s in the text.

commit 0e652c11bec667544f77b1a033f23c3abf0c0022
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 11 12:55:12 2013 +0100

    FAQ: RHEL 6.5 will fix the buildnet problem.

commit 32fe7fd8536a452639a8304e77dde5305d79b209
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 11 12:54:29 2013 +0100

    FAQ: Indent Ubuntu releases in list.

commit 3b109ff20710a1cd2805e7bcc1d20c2713f89ab4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 11 12:53:25 2013 +0100

    FAQ: RHEL 7 is based on libguestfs 1.22.

commit 58519bbe9c456f04bf3cdb261a75351aa94461e5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 11 12:53:08 2013 +0100

    FAQ: Add link to RHEL 6.5 preview repository.

commit b30647cd23eecde5b61161aa678ffce6fd5aa5b4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 10 19:33:53 2013 +0100

    Version 1.23.3.

commit ef4969c2ce2754c6ce535c9ac8d51ee3e7df1ea8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 10 18:09:43 2013 +0100

    build: Fix 'make distclean' (again).
    
    So it doesn't break after the generator has been deleted by
    a previous distclean rule.

commit 546b3f3fce38874239161484b74aa90560a399dc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 10 16:08:05 2013 +0100

    txz-out: Fix this API to produce xz files again (RHBZ#972775).
    
    Commit 864ef706a84c7c87a62f776d4b2e82a6f959ae14 (in Aug 2012) broke
    the deprecated txz-out API.  Because of a thinko during this commit,
    instead of producing xz files it produces bzip2 files.
    
    Fix this API again.
    
    Thanks: Bo Fan / Red Hat QA team.

commit 21f427801c88656ff85467b1bf0acf7c567a59e2
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Jun 7 12:18:51 2013 +0100

    inspect: Fix bogus warning for partitions without /boot.ini
    
    Fix a bogus warning introduced by
    5abb196de869cd27a6fa2377d79b9a267120f48e. If a non-windows partition
    hasn't been detected as something else and falls through to windows
    detection, inspection would display a bogus warning about missing
    /boot.ini.
    
    RWMJ: Test if guestfs_is_file > 0, in case it returns an error.

commit 95850772021d35911b3597159ff50c11043da686
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 5 17:29:43 2013 +0100

    inspection: Reformat is_systemroot declaration.
    
    Just code motion.

commit 5abb196de869cd27a6fa2377d79b9a267120f48e
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Jun 5 16:56:03 2013 +0100

    inspect: Partial support for non-standard windows system root
    
    Support arbitrary windows system root for pre-vista systems where
    boot.ini is on the same partition as the system root.

commit 83b7d0a66e99fb970a0929123f6fc0e810869677
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Jun 5 16:56:02 2013 +0100

    inspect: Add internal match6 function

commit f1385192ad607190b01ccbdb0805eede8a787436
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Jun 5 16:56:01 2013 +0100

    inspection: Refactor windows systemroot detection to allow re-use
    
    This change refactors guestfs___has_windows_systemroot to
    guestfs___get_windows_systemroot. The new function returns a
    dynamically allocated char * which must be freed.
    
    The new function is no less efficient than before, as it returns the
    result of guestfs___case_sensitive_path_silently, which is required
    anyway. The new code is slightly more efficient than before, as it
    re-uses the result of this testing in guestfs___check_windows_root
    rather than running it again.

commit 5add9cbe78582fcf79bb0e1ab1267841a1647b62
Author: Olaf Hering <olaf@aepfle.de>
Date:   Tue Jun 4 16:39:12 2013 +0200

    Set DISTRO to SUSE if /etc/SuSE-release exists
    
    Signed-off-by: Olaf Hering <olaf@aepfle.de>

commit 012a4a5eb5c985e5ce22f3e6991da5369aeaed82
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 4 12:06:29 2013 +0100

    ocaml: Build dependencies for tests too.

commit 49bdaabc7d011e7fb55e457d6fb865c175d1c757
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 4 11:52:18 2013 +0100

    build: Add common-rules.mk, common rules for all Makefiles.
    
    This file is mainly a central place to:
    
     - include localenv if it exists, and
    
     - define the RHEL 5 backwards compatibility macros, instead of
       spreading them over every other file.

commit 76321709d6117383e36a48d5cdd3a1402171944d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 4 11:33:27 2013 +0100

    build: Don't include subdir-rules.mk in top level Makefile.am.
    
    Also there are no generated files at the top level, so no need to
    mention $(generator_built) in this file.

commit 94dbcb107f5a5d8658e76add344cf697a938783c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 4 11:30:09 2013 +0100

    Quote ./configure --help output (options) properly.

commit 44b453d6fb476c57a2ff11c7c8ceaf27fb7ac8c7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 3 23:00:21 2013 +0100

    build: Simplify and speed up expression that generates po/POTFILES.
    
    This has to run on every build, so:
    
    - Use two grep commands instead of lots.
    
    - Remove unnecessary use of sed.
    
    - Remove some obsolete directories that haven't existed for a long time.

commit 074e3b5c6702e3b743f1eaa41b88e040357f7e90
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 3 22:47:03 2013 +0100

    generator: Don't always recurse into the generator directory.
    
    Previously, every subdirectory that contained generated files would
    cause a recursion into the ../generator directory.  This was slow and
    unnecessary.  Only recurse if the generator actually needs to be
    rerun.
    
    Note this changes the semantics slightly: For example if you added a
    new action and just ran `make -C ocaml' then previously the generator
    would be rerun, but now it would not.  However I'm not convinced the
    previous semantics were that useful, particularly considering that
    with this change a simple `make' is much faster.

commit edf9d3c7f0d70488ef0ad6a87e7966d774b9b190
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 3 22:37:51 2013 +0100

    ocamldoc: Depend directly on guestfs.mli, guestfs.ml files, not wildcards.

commit b7cd34eb776a6429e2de536c53390f791dbc8470
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Tue Jun 4 00:31:57 2013 +0200

    python: Build extension with PEP-3149 compliant suffix if defined.

commit 7912e2936b347b1bf3728e9a53b2ccdbb97483a1
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Wed May 29 01:00:25 2013 +0200

    perl: Use symlink hack from hivex

commit cdc4413dacb7a5a7693205408d52da6f4c35da0d
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Wed May 29 00:58:17 2013 +0200

    Revert "perl: Fix build and test to work with separated builds."
    
    This reverts commit 4ea016dae96ed4fc3ca6d057f17fde9697f0e627.

commit 222a7b56f3d717cc4b33ae4ea4789a381db4f18c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 3 13:25:47 2013 +0100

    Version 1.23.2.

commit 731d0e1bf6b2b4b977633a454a697eb61dc1557e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 3 11:50:11 2013 +0100

    docs: Updated release versions which fix CVE-2013-2124.

commit c2dcd1096424e6ff37a2e634c364f27b193376e7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 31 14:14:19 2013 +0100

    inspection: Add a fuzz-test of inspection.

commit e8af0982da9f48cce00d999ec6777c15ab931d80
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jun 2 13:08:08 2013 +0100

    perl: Add rules + environment variables so Perl code can be valgrinded.

commit e71b2c11f59b3f8ae0c4b31c4ab5b0d1bfcdf181
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 31 22:39:16 2013 +0100

    inspection: Use guestfs_is_{dir,file} in preference to guestfs_exists.
    
    Where possible, using this is more accurate, and it helps when
    trying to do fuzz testing.

commit b4d8757dadb67d86d14bd8af854d7ba48e9a55f6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 31 19:42:07 2013 +0100

    events: Avoid event handler limit if program allocates and deallocates handlers.

commit 2019d0e9c7cd4b927cb98fe96d97e945dd4847e0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 31 14:36:08 2013 +0100

    New API: remount: Allow rw flag to be adjusted on mounted filesystem.

commit 697b0f89fed04a4017e033861a9eaaa40b3270d9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jun 2 18:52:44 2013 +0100

    proto: Fix for rare FileIn hangs. (RHBZ#969845).
    
    Yet another protocol bug!
    
    If the daemon cancels, then the library should send a cancellation
    chunk.  It normally does this during the loop where it is uploading a
    file.  However due to an oversight or possibly a regression when we
    modularized the socket code, the library did not send a cancellation
    chunk if the daemon cancelled just before the end of file was sent.
    
    This commit fixes this.

commit 1c9dfd079aa6d7893f72c5fd17656c847f72c8d6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 1 14:11:40 2013 +0100

    inspection: Correct fix for segfault if /etc/SuSE-release is an empty file.
    
    The test was the wrong way round.
    
    See: CVE-2013-2124.
    
    This fixes commit ae8bb84ecd46d7b6ef557a87725923ac8d09dce0.

commit 823628d41f898982979ab7dd53656377bef8ce1d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 31 11:49:22 2013 +0100

    lib: Don't call directly from one guestfs__* function to another.
    
    The public-facing functions like 'guestfs_*' are implemented as
    wrappers around implementation functions like 'guestfs__*' (for
    library-side functions only).
    
    Don't call from one 'guestfs__*' function to another.  It prevents
    ENTER events from being caught, especially where a deprecated function
    calls another implementation.
    
    Most code was not doing this, but there were still some places left
    where it was done.

commit e86459e5014eca637eade0bf0410175e5a4b5305
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 31 11:29:15 2013 +0100

    events: Use bool for flag.

commit 75cf879613899c1beb847b1f7a776df90b565be3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 31 11:28:54 2013 +0100

    events: Refactor code to make the common path clear.

commit ae8bb84ecd46d7b6ef557a87725923ac8d09dce0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 31 08:37:44 2013 +0100

    inspection: Don't segfault if /etc/SuSE-release is an empty file.
    
    Related to CVE-2013-2124.
    
    Thanks: Olaf Hering.

commit 36d6df671e57cd755dc4b0b38acd539615b73936
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 30 12:31:54 2013 +0100

    tests/http: Add a test of HTTP protocol.
    
    Disabled for various reasons.  See comment in Makefile.am.

commit b3e5ed69b5d1540f463413122f2db21b3bbcfd46
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 30 11:48:05 2013 +0100

    release notes: Recompile so that long URLs aren't broken in text output.

commit aab882a3a6f4acf99b7fba6ea9f9f072ed2898ea
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 30 11:45:59 2013 +0100

    podwrapper: Set Text::Wrap::huge property to "overflow".
    
    This stops long URLs from being broken in the text output mode.
    
    See:
    https://www.redhat.com/archives/libguestfs/2013-May/thread.html#00088

commit b0bd0bba933141c4922c9eecd1c721228adccb97
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 29 19:16:20 2013 +0100

    security: Centralize CVE information in one place (in guestfs(3)).

commit ee9f1abe7ffacf4c6000c16721dc9259c51b61a1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 29 19:13:46 2013 +0100

    security: Add documentation for CVE-2013-2124.

commit 1766ff1177f0cd2e918632f2f67183851f0273f5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 29 16:02:26 2013 +0100

    appliance: Add sensible disk optimizations.
    
    The timeout lets us read remote images without timing out.
    
    The noop scheduler lets the host do scheduling.  This generally makes
    sense for mixed workloads because the host has a global view of the
    system, and often has more compute power too.

commit da764805ba42fd940c3fbe4bbdc2312c5f84c38f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 29 15:39:47 2013 +0100

    appliance: Remove dead code which (if not dead) would have set disk scheduler to noop.

commit 52eb691e0b85d5a934db11c5dba042f7ce089b53
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 29 15:37:35 2013 +0100

    appliance: Don't set 'rotational' on virtio-blk devices.
    
    virtio-blk is obsolete so we don't need to bother optimizing it.
    People should use virtio-scsi instead.
    
    Also virtio-blk should choose the optimal settings itself.
    
    This was originally added to fix this bug:
    https://bugzilla.redhat.com/show_bug.cgi?id=509383

commit 9df4e51f65f15f3d217f527127c17da650d9ef48
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 29 16:22:02 2013 +0100

    generator: Set builddir for old RHEL 5 which didn't have this.

commit 1d08ea938f6c7b29160b833fa7b4be8241b4f565
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 29 16:15:24 2013 +0100

    generator: Set abs_srcdir for old RHEL 5 which didn't have this.

commit 06291ce0dd656605d3ada94c56103013d6eeaf3d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 29 14:35:54 2013 +0100

    generator: Set abs_builddir for old RHEL 5 which didn't have this.

commit 809a7012dec57977b6fd283c44c26584c15d6999
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 28 21:38:23 2013 +0100

    tests: Add 'make check-release' rule.
    
    This is a subset of tests which will be required to pass before a
    tarball can be released by the maintainer.

commit 0a60332e1bcff698555d31c8b2524a435a93a3f9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 28 21:33:56 2013 +0100

    tests: Add new 'make check-all' rule.
    
    This runs all of the check* rules.  Since this includes 'make check',
    'make check-all' is not quite equivalent to the old 'make extra-tests'
    which was removed in the previous commit.

commit ffde7b4d714e8602f0a6ac863e1a45ed6c927423
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 28 21:33:26 2013 +0100

    tests: Remove 'make extra-tests' rule.

commit 57e83615f0a5aa0315183b625e395d6b8d1c1726
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 28 17:22:58 2013 +0100

    Version 1.23.1.

commit fa6a76050d82894365dfe32916903ef7fee3ffcd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 28 16:15:59 2013 +0100

    inspection: Fix double-free when certain guest files are empty.
    
    The following commit:
    
      commit 5a3da366268825b26b470cde35658b67c1d11cd4
      Author: Richard W.M. Jones <rjones@redhat.com>
      Date:   Thu Jan 24 17:07:38 2013 +0000
    
          inspect: Use CLEANUP_* macros in inspection code.
    
    can cause a double-free along an error path when certain guest files
    are empty where we expected those files to contain at least one line.
    
    This causes virt-inspector to crash when run on these guests.
    
    The following is a test case which demonstrates the crash.
    `f20rawhidex64' is a Fedora guest, but with small adjustments to the
    test you could use any Linux guest for this test.
    
      $ qemu-img create -f qcow2 -b f20rawhidex64 /tmp/test.qcow2
      Formatting '/tmp/test.qcow2', fmt=qcow2 size=21474836480 backing_file='f20rawhidex64' encryption=off cluster_size=65536 lazy_refcounts=off
      $ guestfish -i -a /tmp/test.qcow2 -- rm /etc/redhat-release : touch /etc/redhat-release
      $ virt-inspector /tmp/test.qcow2
      *** glibc detected *** virt-inspector: double free or corruption (fasttop): 0x00007f18bc9925a0 ***
      ======= Backtrace: =========
      /lib64/libc.so.6(+0x34ecc7ca8e)[0x7f18b8e64a8e]
      /lib64/libguestfs.so.0(+0x3f91898078)[0x7f18ba13c078]
      /lib64/libguestfs.so.0(+0x3f91899761)[0x7f18ba13d761]
      /lib64/libguestfs.so.0(+0x3f91896d12)[0x7f18ba13ad12]
      /lib64/libguestfs.so.0(+0x3f91894140)[0x7f18ba138140]
      /lib64/libguestfs.so.0(guestfs_inspect_os+0x35)[0x7f18ba0bcc35]
      virt-inspector(main+0x547)[0x7f18ba7c57d7]
      /lib64/libc.so.6(__libc_start_main+0xf5)[0x7f18b8e09a05]
      virt-inspector(+0x6665)[0x7f18ba7c7665]
    
    This is a denial of service, but not likely to be exploitable.
    
    (Found by Coverity)

commit 1e7f2b29c428538aa3486c15c72a30c030b276f3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 28 16:04:06 2013 +0100

    rbd: Fix overallocation because of incorrect 'sizeof'.
    
    (Found by Coverity)

commit 9854d1f08d3142324593e953744281fca1940dbf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 28 16:02:24 2013 +0100

    conn-socket: Don't leak 'conn' on error paths.
    
    (Found by Coverity)

commit 0e756842f6e7435ff09c116c1c3edc5316d752a7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 28 15:59:54 2013 +0100

    erlang: Don't leak (some) strings along error paths.
    
    This fixes several string leaks along error paths which
    were found by Coverity.
    
    However this is not a complete fix.

commit e52a6b56f487890f5507b89c3ff6fdf173eab402
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 28 15:48:42 2013 +0100

    fish: Check for out of memory failure.
    
    (Found by Coverity)

commit a9a191d20e6b4ea951b0ef38cb5abad68987c81b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 28 15:48:23 2013 +0100

    inspection: Test for failure from match1 function.
    
    (Found by Coverity)

commit 49cb55146f6933dd1a7a9c38ec884aa5afc12247
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 28 15:41:32 2013 +0100

    drives: Don't call `close (-1)'.
    
    (Found by Coverity)

commit c7531fea6ee20242cd1b36f3416cfe6bf0c238ab
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 28 14:49:17 2013 +0100

    guestfs-testing: Add tests for various new features added since 1.14.
    
    In particular, test remote access using guestfish if they
    have libguestfs >= 1.22.
    
    Also add some diagnosis tips.

commit ada943b949774cdfc60953606f5e7aa9ac0a8638
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 24 14:19:41 2013 +0100

    syntax-check: HAVE_DECL_* macros are always defined.
    
    These macros are always defined to 0|1.  We don't need to
    check if they are defined.

commit 2ed3a383b4fc78966fa37b291c72784cd48100d6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 24 14:19:24 2013 +0100

    syntax-check: Remove trailing whitespace.

commit a787d2565f69e651b39fe08246b7235322db7a49
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 24 14:19:06 2013 +0100

    syntax-check: Use newline before EOF in these text files.

commit 5c80f22b64af2d15623105571cc743beec2f94f6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 24 14:18:32 2013 +0100

    syntax-check: Remove unused ``#includes''.

commit 014bc5f398d05f6474eb690d86f9f944e9e04000
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 24 14:17:06 2013 +0100

    syntax-check: Use exit (EXIT_*) macros instead of hard-coded 0|1.
    
    These are defined in <stdlib.h> which the test program already includes.

commit 77d08060b412775d1a9ab846decd14439980781d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 24 13:48:23 2013 +0100

    syntax-check: Ignore more syntax-check problems.
    
    For some reason maint.mk doesn't process all of these regexps,
    or perhaps the regexps are not well-formed.

commit 2bc1d522dbaea8727cfc7bcc4bb03bbb8a5c212a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 24 14:16:29 2013 +0100

    Ignore various intermediate files left around by 'make syntax-check'.

commit 42e268a2b412cc67c139d2023521de6ea35b3882
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 24 14:16:37 2013 +0100

    make help: Suggest using -j1 -k options with make syntax-check.
    
    This lets you see all the output, not interleaved.

commit afd6512536d27eb97e1ae0f8c4ea0d6807bce377
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 23 12:49:09 2013 +0100

    Version 1.23.0.

commit fca2dc9d0d3733a579a6a6af67d319270fb51459
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 23 12:06:46 2013 +0100

    Version 1.22.0.

commit 9d1c95281e493156ebbadfc75e190d2294123740
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 23 12:09:51 2013 +0100

    build: Set 'stable' or 'development' in commit tag automatically.
    
    This sets two macros: BRANCH_NUMBER and BRANCH_TYPE.

commit 455c277f96309033f12ba6ed843c1894b34cae0f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 23 11:51:46 2013 +0100

    release notes: Get ready for 1.22 release.

commit 3147500f15ca7299a09a48af514459d793d04c1a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 22 14:20:53 2013 +0100

    tests/mountable/test-internal-parse-mountable.c: Hoist variable decls to top.

commit 553ffd7a94ca3993ac5a00ca2ff4e65883f37207
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 22 14:19:57 2013 +0100

    tests/mountable/test-internal-parse-mountable.c: Don't fully allocate 1GB disk.
    
    This test required 1 GB of free space since it used posix_fallocate
    instead of creating a sparse disk.  Use truncate instead.

commit 72afcf450a78b7e58f65b4a7aaf94d71cd25fca5
Author: Hilko Bengen <bengen@debian.org>
Date:   Fri May 17 19:07:48 2013 +0200

    Fix for changed selinux mountpoint
    
    http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=707217

commit 6e20440fb1b53f86d696198806867e06773474b6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 21 18:23:52 2013 +0100

    Version 1.21.40.

commit fb5cc99f9ea733d409ea98fb7485fa8f52968070
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 21 18:12:36 2013 +0100

    release notes: Don't document new internal APIs.

commit 4db269cfe648f772f01966cbfc27ff8a864ae496
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 21 18:12:07 2013 +0100

    appliance: Use 'rm -f' on files which might have been moved so might not exist.
    
    This partially reverts commit fae4a2cfb99bab26f3bd60f52e4a586e39f54f49.

commit cfa0ec55ce5ff9ae777f6f547529af1faf6abd01
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 21 17:13:16 2013 +0100

    Update gnulib to latest version.

commit a53d6a40a76f49dc101dac7ef749711501e4f046
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 21 17:11:23 2013 +0100

    docs: Add notes about how various check-* targets are implemented.

commit 930c3bc91d130bc152eebee802c83656ff69b891
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 21 14:17:54 2013 +0100

    Update translations from Transifex.

commit aa7f953a2e713cda80949b1cf788b47afb3cfe8b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 21 14:12:49 2013 +0100

    Update ROADMAP for 1.24.
    
    That will be the next stable release after 1.22.

commit 69f73cd8f5825d516b33b8cd3d7dd22c9a2edf95
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 21 14:11:23 2013 +0100

    release notes: Update list of bugs.

commit 5a69428f5ec197dfa054e98e80098b758b36d5b9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 21 13:37:55 2013 +0100

    sysprep: Be prepared for CentOS etc. 7 which will act the same way as RHEL 7.

commit d2abdddf61c7bd0c6fc79dd83aa4332e213dc7ba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 21 13:37:03 2013 +0100

    sysprep: Update /etc/machine-info on Fedora 18+, RHEL 7+ (RHBZ#890027).

commit 0daa83cc9116a537cf154088a5a47c5c43ee6444
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 21 13:36:29 2013 +0100

    sysprep: Refactor code, introducing a function to replace a line in a file.

commit 3f0b54395c8338636bd19f8b229c025c4b8b034b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 21 13:26:49 2013 +0100

    Update API support.

commit 87ba073dd539a5440288590e179a96b3ca835ac6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 20 22:20:44 2013 +0100

    guestfs-recipes: Two more recipes from my blog.

commit c74f7f15cbb9bf67447e66ed64356f7346c5effc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 20 21:46:49 2013 +0100

    examples: If user does 'mount-local --help' don't create a disk image called '--help'.

commit 49979931f69ed68709a544fd45d8084c831981a6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 20 21:42:52 2013 +0100

    fuse: Reimplement umount-local using guestunmount.
    
    Instead of repeating the same code calling fusermount -u, retrying, etc.

commit e37de5492986fed8847f78a353d6194c6cfb0035
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 20 15:43:49 2013 +0100

    gluster: Normal port number (assuming 1 brick) is 24007.

commit 0ff8b315f575866e82177a5fb6778b468bcf63bd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 20 15:42:56 2013 +0100

    gluster: Note that client needs to run as root.

commit dcff65722f45d48326fff83db82e926de75fb1ea
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 20 15:27:57 2013 +0100

    gluster: Force exportname to begin with a '/' character.

commit f3bbd1f4ddc26b266d38666c1526549833ceeab7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 20 15:27:36 2013 +0100

    gluster: Don't force gluster port number to be specified.
    
    Gluster can choose its own port number.

commit 40691b7167fec6619385b38693eb65c375f0c7bd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 20 15:13:09 2013 +0100

    launch: libvirt: Allow port to be optional.
    
    Actually if you don't specify the port, currently libvirt gives
    an error:
    
      libguestfs: error: could not create appliance through libvirt: XML
      error: missing port for host [code=27 domain=20]
    
    However I think that is a bug in libvirt:
    
      https://bugzilla.redhat.com/show_bug.cgi?id=965142

commit fae4a2cfb99bab26f3bd60f52e4a586e39f54f49
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 20 09:00:16 2013 +0100

    appliance: Don't use 'rm -f' on files which ought to exist.

commit 40a0e086199780fd3326412f5dd8c27649cb619c
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Sun May 19 18:01:10 2013 +0200

    fish/test-events.sh: ignore "trace get_path" line
    
    The test would fail when LIBGUESTFS_PATH was not set.

commit b862d95c476b069ee91b793e7c3e0db6ce0bb05d
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Fri May 17 22:28:18 2013 +0200

    ./run: Turn error message about missing LIBGUESTFS_PATH into warning; output to STDERR
    
    The previous behavior caused the build to abort when trying to build
    the sysprep documentation -- without much of a hint of what went
    wrong.

commit 95ed4949f240649b0277a3d687cfd8f61cc396f1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun May 19 16:40:19 2013 +0100

    README: Clarify that building from git needs './autogen.sh'.

commit 2147d9d6cd938f0cab280e448f79cdbfc5822484
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 18 07:43:43 2013 +0100

    daemon: Don't install man page for guestfsd(8) if --disable-install-daemon.

commit f9eee0ad8de7a50e769d6f3621329e411b546605
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 17 11:54:07 2013 +0100

    php: Work around buggy PHP returning array as long.
    
    Because OStringList is an optarg, we must specify "a!"  to
    zend_parse_parameters.
    
    However zend_parse_parameters still returns this as a *long* rather
    than a NULL (or empty array) so positively check that it has returned
    an array.

commit 6d87aaefa0d9c4ea9b49bed71bd8975c60fbae8f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 17 11:53:45 2013 +0100

    php: Fix comment in run-php-tests.sh.
    
    This updates commit cd40cf713991569e51b42742177e57f3dca148bc.

commit 2d58c42ab8177c8dadc75a40ac861c9dba3aad22
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 17 11:13:07 2013 +0100

    Update release notes.

commit f7c312ba6bc99a331f2b3996624dc3408a8cc3c0
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu May 16 16:21:42 2013 +0100

    Fix compiler warning when libselinux is not present
    
    static function selinux_warning() isn't used if HAVE_LIBSELINUX isn't
    defined, which results in a warning.

commit e5f0dfb6e3425e8dbaa405847ae98a8dcc421da7
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Thu May 16 22:13:50 2013 +0200

    Use pkg-config for Python
    
    At least libpython2.7-dev and libpython3.3-dev on current
    Debian/unstable ship with pkg-config files. As with the pkg-config
    check for Lua, we check for versioned and an unversioned .pc files.

commit 7865f825376b218746946bf423b359169ed3fc61
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 16 11:11:39 2013 +0100

    appliance: Run lvmetad if it exists.
    
    This daemon is used by newer LVM to interface with udev events.

commit ef199cf66ea544fc52f1bd206de7e141e0dbcc47
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 15 13:00:09 2013 +0100

    Version 1.21.39.

commit e70927a5e56224a64a31192f05f02534e1f18c46
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 13 15:50:49 2013 +0100

    drives: Fix rules for quoting files that contain ':'.
    
    The test was backwards.
    
    This fixes commit a95214b1985e694946e3426120a6fdc13a3f081f.

commit 11774eeb80d1710ea84459708344c15b4cfaae7a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 13 08:40:23 2013 +0100

    faq: Update documentation for Debian Squeeze (thanks Hilko Bengen).

commit dee7ab1b79955372986070f7fab33145cf4cd06d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 11 20:14:26 2013 +0100

    http: Fix typo in documentation.
    
    This fixes commit 83f74f5c564c51a1324b12e5edc4b50356d49dc6.

commit 83f74f5c564c51a1324b12e5edc4b50356d49dc6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 11 18:18:12 2013 +0100

    Add support for qemu's curl driver (ie. FTP, FTPS, HTTP, HTTPS, TFTP).

commit e3c2397165884622e57f9d9b62349f4134bb3e61
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 11 18:07:24 2013 +0100

    iscsi: Document that one server must be passed, and that username may be passed.
    
    This fixes commit 8b271101a1724bab926c65c77436d8128bf1c2df.

commit be05a036e231e562a8ba86ed1a6f4f11cff9d8fb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 11 18:04:25 2013 +0100

    drives: Fix typo in error message.
    
    This fixes commit 0a065c45748ec5efe86f4d02f4864a58ed7dae36.

commit af0f2cc9e51347cbbbd0d08be31def5ac9002ff0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 11 15:51:51 2013 +0100

    Version 1.21.38.

commit 0a1111391baa78025077cfec55aeb4c1145356f9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 11 15:53:59 2013 +0100

    build: Add 'make maintainer-tag' rule for tagging HEAD with current version.

commit ec3d3a809a5dabbdd7784d07d877e647183a523d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 11 15:51:12 2013 +0100

    tests/regressions: Remove bogus comment in test.
    
    This updates commits a95214b1985e694946e3426120a6fdc13a3f081f.

commit a95214b1985e694946e3426120a6fdc13a3f081f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 11 13:36:43 2013 +0100

    drives: Remove check for ':' in filename (RHBZ#811649).
    
    Modern qemu can now handle this properly.  ':' is only special if what
    precedes it looks like a transport, so:
    
      qemu-system-x86_64 -drive foo:bar     .. fails
      qemu-system-x86_64 -drive ./foo:bar   .. works
    
    Thus by adding ./ in front of relative paths that contain ':' we can
    work around this.
    
    In addition, this broke iscsi:// URIs because iSCSI target names
    routinely contain ':' characters.

commit 0a065c45748ec5efe86f4d02f4864a58ed7dae36
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 11 13:33:36 2013 +0100

    drives: ceph/gluster/iscsi/sheepdog/ssh: Force the disk name to begin with a '/'.
    
    This avoids confusion when using URIs in guestfish, since the path
    will always start with a '/', and we don't otherwise know if we should
    remove it or not.  By forcing the '/' to always be there, we deal with
    this problem in the API instead.

commit 914d3e68ec272436f91080f47ddfe4db8f1d8751
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 11 13:23:48 2013 +0100

    drives: Use libxml2 to construct safely quoted URIs for qemu.

commit 8b271101a1724bab926c65c77436d8128bf1c2df
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 10 21:38:14 2013 +0100

    Add support for iSCSI.

commit 7a9ebd757cca0ec22fd730703bed16005ebfb6a4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 10 14:23:08 2013 +0100

    src/inspect-fs.c: Don't segfault if internal_parse_mountable returns NULL (RHBZ#961812).

commit 6a1c76807ec483b7eab4bc62822ef1c4f12e2be6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 9 17:44:44 2013 +0100

    ./run: Don't set LIBGUESTFS_PATH if --disable-appliance.
    
    Thanks Dave Vasilevsky for spotting this problem.

commit 55eae0af3b3b645c78b84278291ec0089e5492b0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 9 15:35:46 2013 +0100

    recipes: Add link to script for converting Windows DVD to bootable USB key.

commit d66145622550ff4f4ce9a5f8aefcdb6e9ae4c33a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 9 15:35:08 2013 +0100

    New API: cp-r
    
    This runs 'cp -rP' and is useful for copying when the target
    doesn't support file owners or permissions (ie. FAT).

commit e7e8a1bfefab19db7512d05a4a00e3ffb37f5dd8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 9 10:22:44 2013 +0100

    Version 1.21.37.

commit 3287f177e01b15aa5c43fcf1640773be259ce965
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 9 08:52:40 2013 +0100

    fish/options.c: Whitespace changes.

commit a820e9e3bd55632d88a2d76581921e1cebd17c62
Author: Dave Vasilevsky <dave@vasilevsky.ca>
Date:   Wed May 8 21:16:51 2013 -0400

    fuse: Document the fstype parameter

commit f83df69bec28fe5414da3896af0ec3b0986beaa4
Author: Dave Vasilevsky <dave@vasilevsky.ca>
Date:   Wed May 8 21:02:21 2013 -0400

    fuse: Allow specifying the fstype of a mount

commit bec7888be3b0b09c794a6ef3d5d00baa22f9c68c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 8 11:50:31 2013 +0100

    rbd: Miscellaneous stylistic changes, no functional change.

commit 51f7c6bb82e3582ed78767d8748eb1abbb0a7d48
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 8 11:50:09 2013 +0100

    Use size_t for loop iterators.

commit 97274c7f7548284697e4af088fb379e27f0393ef
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 8 11:44:36 2013 +0100

    src/libvirt-domain.c: Cast constant strings to avoid warning about signedness.

commit afc870dd76dc409e734b3bd7f7da3d558d79dea1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 8 11:37:13 2013 +0100

    src/drives.c: 'auth' string is const.
    
    This fixes commit f3e01b69e04a0e8321e9d54ca39a4d7ea762f80d.

commit 3e76844bc15bc79edc3f3499da1d6a5d20e03842
Author: Mike Kelly <pioto@pioto.org>
Date:   Tue May 7 10:50:12 2013 -0400

    rbd: Support using a custom secret

commit 75c203facb92cfcc7e058ca2a743e381a97e2466
Author: Mike Kelly <pioto@pioto.org>
Date:   Tue May 7 10:50:11 2013 -0400

    libvirt: extract usernames for network disks

commit f3e01b69e04a0e8321e9d54ca39a4d7ea762f80d
Author: Mike Kelly <pioto@pioto.org>
Date:   Tue May 7 10:50:10 2013 -0400

    rbd: support usernames, for cephx authentication

commit 1806828885cc34257d347c288efea248de255c32
Author: Mike Kelly <pioto@pioto.org>
Date:   Tue May 7 10:50:09 2013 -0400

    libvirt: initial support for networked disks

commit 2ce06ec808ce1c9ca9e6190f3ddc043b43e3b576
Author: Mike Kelly <pioto@pioto.org>
Date:   Tue May 7 10:50:08 2013 -0400

    rbd: send mon_host for rbd drives
    
    This is how the servers are passed to kvm.

commit 13fba490cdbcea2371ca11593767087dbf0c21c3
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Wed May 1 23:15:48 2013 +0200

    Fix rpcgen call for separated builds.

commit 66145799cb1b4b0c7598966a668b7f8a8cb890a9
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Wed May 1 23:14:38 2013 +0200

    perl: Fix install target for separated builds.

commit 34b106c3917fe65c69e0587b2664c38886aa21db
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 2 14:28:00 2013 +0100

    Version 1.21.36.

commit 333337b6a9b1a6d3fd383a99d496771f808e008e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 2 13:18:12 2013 +0100

    debian: Add OCaml .depend files to DISTCLEANFILES.
    
    Otherwise debuild complains that these files have been created after
    it does a 'make distclean'.

commit 5faba45fe1adfaeb316e4616d4e3a4937e57e599
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 1 09:44:47 2013 +0100

    tests/c-api: Various code refactorings.
    
    - Don't use fixed names for the disks.  This will allow us to
      parallelize this test.
    
    - Add a new "GETKEY:<key>" String parameter which can retrieve keys
      from the handle.  The temporary disk names are stored as keys.
    
    - Don't test the close callback.  However this uses the close callback
      mechanism to delete the temporary disks, and in any case close
      callbacks are well tested by the language binding tests.
    
    - The generated code now produces a static array of tests (instead of
      a 'perform_tests' function), making it possible to parallelize.

commit f003c50c520f9515f433b0043a69ebd5154060ed
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 1 09:34:39 2013 +0100

    tests/c-api: Remove global guestfs handle.
    
    This will allow us to parallelize these tests.

commit 76950a0e8de277c7b51645fc36a7dd902852b126
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 1 09:33:51 2013 +0100

    tests/c-api: Warn about deprecated functions in main program.
    
    And replace deprecated guestfs_set_close_callback with
    non-deprecated guestfs_set_event_callback.

commit 9d5236d73cd0ec0c70172fa301c4722bb458db5d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 1 09:09:55 2013 +0100

    tests/c-api: Factor out common init_* into separate functions.

commit 02fbf566e88624f581ab67b1cc818f36e1dfdc33
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 1 08:36:16 2013 +0100

    java: Standardize Java test numbering.

commit ad1e9e7eace04ce92730691be7d0dbd56bb2af9d
Author: Mike Kelly <pioto@pioto.org>
Date:   Tue Apr 30 13:49:10 2013 -0400

    ssh: fix setting the username part
    
    Right now, we'd always be setting a NULL username.

commit 3c43019f8df837f3c0c4325679d46cbb336eced2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 30 17:41:05 2013 +0100

    ruby: Standardize test names and numbering.

commit a24639d7d38bc4ffd5d242611ebe75be8cc1a482
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 30 17:34:22 2013 +0100

    python: Standardize test numbering.

commit 897a69604dd2f3999b829376ae10ff7c6e6b3288
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 30 15:42:31 2013 +0100

    perl: Make the 030-create-flags test same as canonical OCaml version.

commit dc3b783b51a83df1a986c1456b01a1a38dba9d96
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 30 15:41:08 2013 +0100

    ocaml: Set close-on-exit flag to true in this test so handle is cleaned up.
    
    Otherwise the valgrind test fails since the handle resources
    are leaked.

commit a2a6cfba569316372e2b90230ed06094816bf464
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 30 15:08:58 2013 +0100

    Version 1.21.35.

commit 1623f540b113391b2f5b91f0f5a6e31e5bf2bed2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 30 13:25:16 2013 +0100

    erlang: Make separated builds work correctly.
    
    Set ERL_LIBS and also create a phony 'ebin' directory for the
    guestfs.beam (library) so that the tests run against the local copy
    not the installed version, and so that separated builds work.

commit 327403f3acf4654e4259dd66070d473601ee41cd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 30 13:25:01 2013 +0100

    erlang: Add a CLEANFILES rule.

commit d9f5829ebe7b10d6b4193c08c5bee1d2df4fd0c6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 30 12:48:44 2013 +0100

    python: Fix for separated builds.
    
    Ensure that ./run sets PYTHONPATH to include the Python source
    directory (location of guestfs.py).

commit 4ea016dae96ed4fc3ca6d057f17fde9697f0e627
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 30 12:22:54 2013 +0100

    perl: Fix build and test to work with separated builds.
    
    This is inspired largely by Hilko Bengen's equivalent
    hivex patch here:
    
    https://github.com/libguestfs/hivex/commit/887466794a40f57b84ce32524e1a650d6674c7e6

commit 440183b440ae66011e1739f64744c45d8c8c4220
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 30 12:20:53 2013 +0100

    perl: run-bindtests: Don't set PERL5LIB.
    
    This environment variable should already be set properly
    by 'run', there is no need to set it from this test script.

commit 21dd1c50c9a961551c6224f2fc0687cff2057a65
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 30 12:49:32 2013 +0100

    ./run: Set s= (srcdir).  Use absolute paths.

commit 93e64b4448c7afccf4c4751ff5deba3e321e7851
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 29 19:25:14 2013 +0100

    tests/mountable: Fix incorrect use of inspect-os API (RHBZ#957380).

commit 4e5ed8ff7be8c2de6450ffccba184f45abb09ae8
Author: Mike Kelly <pioto@pioto.org>
Date:   Mon Apr 29 12:57:14 2013 -0400

    Make a 1G test image instead, avoiding a size bug
    
    mkfs_btrfs: /dev/vda2: device /dev/vda2 is too small (must be at least
    256 MB) at .../libguestfs/tests/guests/guest-aux/make-fedora-img.pl line
    140.

commit 0da34f968c6d6f75740a83020a57bd0775e53c78
Author: Mike Kelly <pioto@pioto.org>
Date:   Mon Apr 29 12:57:13 2013 -0400

    Refactor image partition sizing

commit 852beefc4c0d44e15596798028b902d325f24882
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 29 16:41:06 2013 +0100

    Version 1.21.34.

commit d02af3a3110dac69ae8a70572a976f8464ce5823
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 29 16:08:47 2013 +0100

    perl: Almost standardize the Perl tests.
    
    This needs more work, but brings them mostly up to the same
    standard form as the OCaml tests and the test documentation.

commit f82a9dbf0fbc66fb099c68cea0d17ac2e4dc67a9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 26 16:49:58 2013 +0100

    ocaml: Standardize the test sequence for all bindings; implement this for OCaml.
    
    The idea behind this change is to have a consistent set of
    tests across all bindings, while at the same time saving time.
    For background see:
    
    https://www.redhat.com/archives/libguestfs/2013-April/thread.html#00069

commit cc93840d31e440e64e27ee13df3afd134ef2e68f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 29 15:22:34 2013 +0100

    tests: Add a regression test for RHBZ#957772.

commit c5f356a60351dd51cbd3a9aabcac2cd40562f36a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 29 15:23:27 2013 +0100

    daemon: Properly quote arguments for tar-out, base64-out commands (RHBZ#957772).
    
    This fixes commit c78ec7e085e99bfddd0509dece72bf6a8d0188ce
    which was an attempt to fix RHBZ#908322.

commit 79688aff7483dfcdc1034564cac6cae9999e4324
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 25 20:08:18 2013 +0100

    ./run: ruby: Set $RAKE and fix Ruby tests.
    
    This wasn't set which caused Ruby tests to silently not run
    without any indication.

commit 0d989d52a615b86aa65477c7719e9c7e49b18873
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 25 20:10:26 2013 +0100

    ruby: Fix segfault in regression test.
    
    This was revealed by the regression test for RHBZ#664558.
    Unfortunately because Ruby tests had been silently disabled,
    this regression test was never run.

commit 2ea9d82a23c7b28f87e89541ba7f455cad9e950e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 25 20:09:28 2013 +0100

    ruby: Fix optargs test.

commit cd4c2c6caa50339c1d8f0f418b8340eb7c7bd5e2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 25 14:59:19 2013 +0100

    Version 1.21.33.

commit a30b41f73560af492cbebecc4f6cd9258db8df0b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 25 13:34:24 2013 +0100

    tools: The programs are located in the source directory.

commit 9e9be1cee717acd5c43c1e4ae9d39029649be962
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 25 13:34:06 2013 +0100

    python: Test programs are located in the source directory.

commit a9c81f1919375519d1e3f1555b480f152fa0ceb0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 25 13:33:46 2013 +0100

    fish: Add $srcdir in several places where test files exist in the source directory.

commit 7af69445f2b64448b8ce2d0b314daacfcd01112e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 25 13:33:24 2013 +0100

    tests/rsync: This test only copies generated files.

commit 5057a8f3442882bb5e350d8124a500cfebda1e94
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 25 13:33:00 2013 +0100

    tests: Add $srcdir in several places for test files located in source directory.

commit 073da79e5bd09a5cdcff7151386d1d02135d4118
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 25 13:26:35 2013 +0100

    tests/xml: Get XML data file from source directory.

commit 423a2d9dde99b102347d3418069aff56a00161e0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 25 13:24:23 2013 +0100

    tests/btrfs: Get data files from source directory.

commit 59b9ee181b25dbcc5bb8660e6bc7538c1805a471
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 25 13:20:48 2013 +0100

    tests/selinux: Pick up run-test.pl script from source directory.

commit 86025d33a8ced775361487073563c3d5fe90b955
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 25 12:44:17 2013 +0100

    tests/guests: Various fixes for separated builds.
    
    This now correctly builds all the phony guests when
    builddir != srcdir.

commit 5d6a08e2c80b3c297e3d9d4d17aef893ea8c87ab
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 25 12:36:55 2013 +0100

    tests/guests: Don't include fake Windows binary hive files in git.
    
    This means that people compiling from git will be required to have the
    'hivexregedit' command (from hivex).

commit c0d1a74023dbac77f6c4e526967d185a1615b977
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 25 12:33:31 2013 +0100

    tests/guests: Ensure hard to generate files are cleaned by 'make distclean'.
    
    This allows us to switch from non-separated to separated builds
    without breaking (the user must do 'make distclean' between the
    switch).

commit c3bf39a1f91792390eef9790b43d059e3161522d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 25 12:20:53 2013 +0100

    perl: Fix 'make check' to find bindtests.pl in source directory.
    
    Despite this change, separated builds are still broken, apparently
    because ExtUtils::MakeMaker doesn't support this sort of
    configuration, or else we're using it wrong.

commit b7da435003c6d6da3b78bbd70f51e22dba07486b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 25 12:02:16 2013 +0100

    tests/c-api: Allow FileIn paths to be prefixed by "$srcdir".
    
    Since tests involving FileIn will often wish to read from local files,
    it makes sense that they would want to open files in $srcdir.
    
    Therefore allow such paths to be prefixed by "$srcdir" which is
    substituted at run time by the same named environment variable (set by
    automake).
    
    This fixes separated builds in tests/c-api directory.

commit a1e51676fd42b8919a22d4c13cdc6a7e0ac091fb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 25 10:40:18 2013 +0100

    Remove many uses of $(builddir).
    
    "$(builddir)" is always "."
    
    Therefore most uses of $(builddir) are suspect and should be
    removed or replaced with "."

commit c1898ee996858a94bdaddc3b8a497784bc5d0cc5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 25 10:39:30 2013 +0100

    appliance: Fix rule for building supermin.d/init.img.
    
    Use a temporary directory instead of copy hack.

commit b426540b7f4b7687f7635cc5ed4901533fecb4d5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 25 10:33:40 2013 +0100

    tests/data: Add a comment noting a bug in the Makefile.
    
    abssymlink is an intentionally dangling symlink, but this confuses
    make which thinks it has to rebuild the rule every time.

commit 71ca0f8ecef2f77af9e6363c48affbed9d26eb62
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 25 10:33:16 2013 +0100

    tests/data: Don't prepend build paths with $(builddir).
    
    It's both unnecessary and confuses make.

commit 618a4372cfc21adf009590b03ca5575533766f79
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 25 10:32:42 2013 +0100

    tests/data: Fix initrd when doing separated builds.
    
    Otherwise the initrd contains paths like '../../tests/data/empty'
    which obviously causes the tests to fail.

commit 0ec2726a522b1f9253378707ce0bd7766b12bfcd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 24 20:35:05 2013 +0100

    php: Disallow separated builds.
    
    As it stands, this will just break.  Until it is fixed, give a
    diagnostic message.

commit 13c0b780a33aabdeb44491dd35dbb62c3d3a7cbd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 24 20:36:15 2013 +0100

    gobject: Fix separated builds.

commit a8b26aaab922fdb15940cb7f8bcb3a095d2a0bae
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 24 20:36:04 2013 +0100

    haskell: Fix separated builds.

commit aab50b9c5051e6014e5598ed0cd31245d942b696
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 24 21:44:17 2013 +0100

    java: Allow source directory to be prepended by make.
    
    Fix for separated builds.

commit 1d252d7149a27fe671f9eee55154828157ebc552
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 24 20:35:37 2013 +0100

    java: Bindtests.java is generated in the source directory.
    
    Fix for separated builds.

commit 5ab516d0684c9181a88449425a68f3ed1317e7c0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 24 20:25:25 2013 +0100

    ocaml: bindtests.ml is generated in the source directory.
    
    This seems to be necessary because separated builds don't recognize
    the *.ml file as being a source file (unlike, for example, *.c files).

commit fdbe6d81f45aa9644de89e62db26b51b84cd68e3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 24 21:43:13 2013 +0100

    generator: Place generator, stamp-generator, build files into builddir.
    
    Previously the generator binary was (deliberately) placed into the
    source directory.  However there was no real reason for this to
    happen.  Always put the build products into the builddir.

commit e72855e4fa02d30da6f697dc17f4f4953ff402de
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 24 21:09:56 2013 +0100

    generator: Make stamp-generator in the Makefile.
    
    Since stamp-generator is a Makefile thing, make it in the Makefile,
    not in the generator itself.
    
    Also this ensures stamp-generator is created in the builddir, not in
    the source directory (fixing separated builds).

commit 88271bab7cbfc3b19521fed580635b3c93f97a32
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 24 20:32:25 2013 +0100

    configure: Make sure that certain build directories exist.
    
    When builddir != srcdir, this ensures that certain build directories
    which might not exist are created by configure.

commit c4255fd0e3d187a48ff5287221467a61b962ec70
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 24 20:34:10 2013 +0100

    tests/data: Ensure all generated image files are removed by 'make clean'.
    
    Otherwise the build breaks if you switch from a non-separated build to
    a separated build.

commit 3f450de0a945c17cabc1ddc5d411748422aa2d12
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 24 18:42:12 2013 +0100

    Fix 'make distclean'.
    
    Because the generator subdirectory is cleaned first, and other
    directories recurse into the generator directory, 'make distclean'
    would fail (because generator/Makefile would be deleted by that
    point).
    
    Change subdirs-rules.mk so it doesn't fail if generator/Makefile has
    been deleted already.

commit 88b59ea92f59569d73d99e23b03b045c2abb612d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 24 18:41:39 2013 +0100

    subdirs-rules: Remove 'appliance' rule.
    
    It was used in only one place (perl/Makefile.am).
    
    If users want to build just the appliance, then they could do 'make -C
    appliance'.

commit 1add24e77471eb88af03d2f7ad41e11a0d4b7cb9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 24 15:22:34 2013 +0100

    configure: Create resize/ subdirectory if building in a different builddir.

commit 6c71ab2208995e46deaefbd8daa0fcdb364c74cf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 23 10:34:57 2013 +0100

    Version 1.21.32.

commit d99e26d2f3c637b52c6cf65502c05d05db2ee5db
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 23 10:59:19 2013 +0100

    tests/guests: Add make-guests-all-good.pl to EXTRA_DIST.
    
    This fixes commit 2ae72dcaf89130647f03ff7c3d0900215a91f59a.

commit 83659caadbb695fd4ccfc5b31104f46b9083d30a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 23 10:37:11 2013 +0100

    release notes: Fix unterminated C<...> sequence in POD.

commit fecc74e080aa89bc1f4f07b815792c1998edf48f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 22 16:11:32 2013 +0100

    tests: sysprep: Specify list of operations explicitly.
    
    This commit makes no functional change on its own, but it allows us to
    filter out failing operations on Ubuntu.

commit 50003c8cba6082308b2a3edb17ef90be8dc0e0f3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 22 13:59:01 2013 +0100

    grub-install: Change test to use /dev/sda instead of /dev/vda.
    
    The previous test for grub-install hard-coded /dev/vda (ie. assuming
    virtio-blk instead of more modern virtio-scsi).
    
    This changes the test to hard-code /dev/sda instead.  However this
    change is still not correct since /dev/sda will be adjusted by block
    device name translation in the call to grub-install, but not what is
    written to /boot/grub/device.map.
    
    Since we no longer support grub-install on Fedora, this won't affect
    things, but Ubuntu still has a 'grub-install' command (although it's
    actually from grub2).

commit 2e6e77fd0225a2f89494356a643919f021b053ef
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 19 16:05:48 2013 +0100

    gobject: Link libguestfs-gobject library with GIO.
    
    So that we get the g_cancellable_* symbols.

commit 1eaf338acdd4ee60cc85ae74417fd055534ff69d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 19 15:52:54 2013 +0100

    gobject: Link libguestfs-gobject library with GOBJECT_LIBS.
    
    There's no such thing as a _LIBS variable in automake, so
    this line was effectively being ignored.

commit 6a5495ea3c085eb557526d5e1431cf3c8bbe4bc4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 19 15:37:40 2013 +0100

    virt-ls: Use string instead of small array.
    
    This works around the following warning:
    
    virt-ls.c: In function 'show_file':
    virt-ls.c:574:1: error: stack protector not protecting function: all local arrays are less than 4 bytes long [-Werror=stack-protector]

commit 2da8d495908a5d716ba505def7794bc25555fca0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 19 15:29:50 2013 +0100

    examples: Don't ignore return value of chdir.
    
    GCC 4.7.3 whinges about this.

commit 2ae72dcaf89130647f03ff7c3d0900215a91f59a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 17 20:06:24 2013 +0100

    tests: guests: Auto-generated guests-all-good.xml.
    
    Only include guests which we successfully created, so for example if
    there's no NTFS support then the Windows guest won't be included.

commit 0c605eb94f20cb08e4a858988e0da121af6f66cb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 17 18:00:18 2013 +0100

    tests: guests: Display some information about each phony guest for debugging.
    
    This adds debugging output like this:
    
      fedora-btrfs.img: file size bytes: 536870912
      fedora-btrfs.img: allocated bytes: 12963840
      fedora-btrfs.img: MD5 hash:        7e8eded44fc832b0f88b0dc5eebf490c

commit b7ccdd7cf38e297325cc05889e349ee29f05766a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 17 17:03:13 2013 +0100

    tests: Mark 'skipped' function with __attribute__((printf)).
    
    With recent GCC, you get this warning:
    
    tests-main.c: In function 'skipped':
    tests-main.c:256:3: error: function might be possible candidate for 'gnu_printf' format attribute [-Werror=suggest-attribute=format]

commit 6af706846fd718b4a26fbb3abaf498d3a36cf6aa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 17 08:55:28 2013 +0100

    Version 1.21.31.

commit 3b0e4328751a5a1319d7164452e295515df1218d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 16 20:22:42 2013 +0100

    fish: options: Allow Unix domain sockets to be specified in --add URIs.
    
    You can now use a URI such as:
    
     guestfish -a nbd://?socket=/tmp/sock
    
    (a NBD connection to Unix domain socket /tmp/sock).

commit 44092e06ce459dce1be5658bba2c8cf4dd438d54
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 16 19:33:54 2013 +0100

    fish: options: Format server name as "tcp:host[:port]".
    
    This is safer, because otherwise a URI could contain some clever
    "unix:..." string as the hostname, tricking qemu into opening a Unix
    domain socket at an uncontrolled location.
    
    This fixes commit 349300af08be9ae9f3d7259e688e2ee5318f2171.

commit 87690b10ffaaf4a23e290ca8ae2421a5b74e143a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 16 19:36:29 2013 +0100

    df: Move variable decl to top of function.
    
    Since this code is no longer conditional, we don't need to have the
    extra { ... } inside the case statement.
    
    This tidies up commit 2f0a4d7c18e622c48e33edc3f80dbd593c6398bc.

commit f5544e8c93d5683010e4f8fb5b799762cd95ebe7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 16 18:41:32 2013 +0100

    Version 1.21.30.

commit 2f0a4d7c18e622c48e33edc3f80dbd593c6398bc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 16 16:39:48 2013 +0100

    Require libxml2.
    
    libxml2 is very commonly available on Linux distros and has also been
    ported (and is widely available) on Mac OS X and Windows.  Therefore
    simply require libxml2, and remove a lot of conditional code.

commit 349300af08be9ae9f3d7259e688e2ee5318f2171
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 16 13:57:38 2013 +0100

    fish: Add -a URI (add remote storage) to options.
    
    Add a remote drive by doing:
    
     guestfish -a ssh://example.com/path/to/disk.img
    
    There are several different protocols supported, as explained in the
    man page.
    
    This affects all virt-* tools that use the common guestfish options
    parsing code.

commit b48e416d27412674b8f11de9cfcef079adf6ccf2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 16 13:57:01 2013 +0100

    fish: options: Whitespace change.

commit cfda2693c608db532c4cc6aecc37c1624af6c0fb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 5 13:01:19 2013 +0100

    Add support for SSH (Secure Shell) block device.

commit ca11cd104dae4a2d301a2d8e9f511b4073bd7c81
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 15 09:51:24 2013 +0100

    FAQ: Add a quick summary to the debugging section of the FAQ.

commit 848db89b7f4aacd7f514f42967193c10460b3493
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 13 10:48:08 2013 +0100

    Version 1.21.29.

commit 288a24eebe88c538a404501fcce5c5b524c390b6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 12 22:16:25 2013 +0100

    tests: Split C API tests into regular C file + generated tests file.

commit 883aea9b1dd69648c0f5bb455955e3165254de7e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 12 22:00:01 2013 +0100

    tests: Replace TestOutputHashtable with TestResult and C test.

commit c43f762257e749178e181a165088b98efe2d0384
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 12 18:21:56 2013 +0100

    tests: Replace TestOutputBuffer with TestResult and C test.

commit 424fe36d32ba762767bd8446f3c7b19b121dff10
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 12 18:11:43 2013 +0100

    tests: Replace TestOutputFileMD5 with TestResult and C test.

commit 0a49838135f9ae1325b69d2853a63267c58fb889
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 12 17:35:06 2013 +0100

    tests: Remove TestOutputLength (not used by any tests).

commit 685c5fb3b10e45bb8c4b60480da805a49cadb9c7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 12 17:19:22 2013 +0100

    tests: Replace TestOutput/TestOutputDevice with TestResult{String,Device}.

commit 45840581d637bde85b235d2a074cb4316db2cdaf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 12 16:17:08 2013 +0100

    tests: Replace TestOutputList{,OfDevices} with TestResult.
    
    This adds helper C functions 'is_string_list' and 'is_device_list'
    allowing these tests to be carried out in generic C code instead of as
    specialized tests.

commit 45599a8895097a836e7296e29c5fa59f40234875
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 12 15:26:22 2013 +0100

    tests: Replace TestOutputStruct with TestResult.

commit 24fdf05d30c15a383c41390ba80579433e67c83a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 12 14:34:51 2013 +0100

    tests: Replace TestOutputInt{,Op} with TestResult.

commit c9ef854f8327e2f79ce3c763de3d8b2ee987621e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 12 14:13:39 2013 +0100

    tests: Replace TestOutputTrue/False with TestResultTrue/False.

commit 008be5dbfa4df03a6ead8a07cf40d170efd21455
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 12 13:27:08 2013 +0100

    tests: More flexible re-implementation of C API tests.
    
    Instead of using the various 'TestOutput', 'TestOutputList' etc
    macros, it makes better sense to let the tests contain fragments of C
    code to perform the checks.
    
    Several new macros are added:
    
    - 'TestResult': This macro takes a C expression which is evaluated to
    test the result of commands.  For example to compare if a string
    result has some value:
    
       TestResult (* command sequence *), "STREQ (ret, \"abcd\")"
    
    The variable "ret" contains the result from the last command in the
    sequence.  But also, variables "ret1", "ret2", etc contain the results
    from the last but one command, the command before that, and so forth,
    allowing much more flexible tests to be written.
    
    - 'TestResultTrue', 'TestResultFalse': Wrappers that test the last
    command for true/false.

commit e327351304d603e8f12b7a95ab277ae480d4edec
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 12 10:10:55 2013 +0100

    tests: 'If' and 'Unless' conditions never used, so remove them.

commit 09b4cc45a3da90e565e502d62137f089b116235d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 12 10:13:19 2013 +0100

    is_lv: Does not need to depend on lvm2.
    
    It only uses 'stat', not any lvm binaries.

commit e4ef9a82817120deee0282ed4ae2a3d255ef54da
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 11 17:58:28 2013 +0100

    valgrind suppressions: Suppress libmagic leaks.

commit a7107854ba67a5d0295e1df9c48342fc3eebd142
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 11 23:21:17 2013 +0100

    debian: packagelist: Add mtools.

commit 3acf6768f0142d71b826b255e00d31276b8982ac
Author: Olaf Hering <olaf@aepfle.de>
Date:   Thu Apr 11 20:41:44 2013 +0200

    add --with-supermin-extra-options configure option
    
    Useful to pass --use-installed and other options to supermin.
    
    Signed-off-by: Olaf Hering <olaf@aepfle.de>

commit c2013308eda5279e4af5f31a1046d3bef9be9ca1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 11 14:41:24 2013 +0100

    Update translations from Transifex.

commit f4d5f3d6a21ac2c602fd2b85e283df3fc7e8f2ae
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 11 14:26:06 2013 +0100

    Update gnulib to latest.

commit 142b874ce8ddc09a06e765df66445a3611d61c29
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 11 13:30:22 2013 +0100

    Remove use of gnulib progname module.
    
    It's simpler to use the glibc 'program_invocation_short_name(3)'
    feature, and fall back to a generic solution.  Also remove risky
    assignments to argv[0].

commit f2b90b374fe7d8e111cd9f4a0e840fa55b91f4f6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 11 12:19:00 2013 +0100

    New APIs: set-program, get-program.
    
    These set or get the program name in the handle.  Most programs
    will never need to call this, since we set this, if possible,
    using the glibc 'program_invocation_short_name(3)' feature.

commit 1a06ac25f574ae3def52a7b5d8fbfe6950d8e4bf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 10 11:57:49 2013 +0100

    fish: Add help for prepared disk images to the man page.
    
    Also the long description for each prepared disk image can now contain
    Perl POD markup.

commit b72daebaf4a859769455a1db70a40603cb5597be
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 10 10:01:17 2013 +0100

    inspection: Don't fail if libosinfo database is not found (RHBZ#948324).

commit 2cf0b5c19b1ecdb7aa8f676a460282bf074d9fd8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 9 23:25:53 2013 +0100

    fish: welcome message: guestfish can edit disk images.

commit abe07ce2ca559db557eaf2c6a456e8b3f71ca516
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 9 23:15:24 2013 +0100

    "guestfish" now means the "guest filesystem shell".
    
    Remove the word "interactive" which implies that guestfish can only
    (or often) be used interactively.

commit 6a7327dfa98adab3ecfeac1cf1297fa835027141
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 9 18:45:15 2013 +0100

    Version 1.21.28.

commit c396d4cd326541e215df5bd4c845ea92c63a81b7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 9 17:30:09 2013 +0100

    examples: Update debug-logging.c example.
    
    This updates commit e3546ad2ce2c0d953e3be2b072bacd48972450af.

commit e3546ad2ce2c0d953e3be2b072bacd48972450af
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 8 20:10:07 2013 +0100

    examples: Add example program showing enabling debugging and capturing log messages.

commit 6582d4ad9fdb15edc346f6420b01c707e40f8541
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 5 10:33:58 2013 +0100

    Update release notes for future 1.22 release.

commit a3de6eddd49c81349dbdb041ba0d4b40f1ef3fd3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 5 10:33:25 2013 +0100

    pod: Fix "wide character in print" warnings by declaring encoding correctly.

commit dfa25a46e35b87ae8a5e548d383e8bf75b4b4b26
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 4 22:14:25 2013 +0100

    Fix typo in extlinux documentation.
    
    This fixes commit dee1dd64c3cd5e67393dec679040eb02e81c84b0.

commit f9f3c7c5acd1b47ff3e263ee3b89d45dd0613a16
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 4 21:04:32 2013 +0100

    Version 1.21.27.

commit dee1dd64c3cd5e67393dec679040eb02e81c84b0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 4 16:06:43 2013 +0100

    New APIs: Add support for syslinux and extlinux (bootloaders).
    
    This also adds tests of SYSLINUX and EXTLINUX which create bootable
    guests.

commit e73cd348c8a2786b5e9874dd1f96cf7bc36412f2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 4 18:21:01 2013 +0100

    Don't delete iconv locale data from the appliance.
    
    - /usr/lib{,64}/gconv/*:
    
    This is the iconv data, required for APIs like iconv_open to work.  In
    particular, the mtools 'mcopy' program fails completely if it cannot
    use iconv.  'mcopy' is used by SYSLINUX to copy files to the disk.
    
    The error you would have seen is:
    
      Error converting to codepage 850 Invalid argument
      Cannot initialize 'S:'
      Bad target s:/ldlinux.sys
    
    - /usr/bin/localedef and /usr/sbin/build-locale-archive:
    
    These are not really needed, but both are simply small binaries so we
    might as well not delete them.

commit 3cdca7616a5f5a550d93e4f088b1b97fd7c9a602
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 4 14:15:44 2013 +0100

    daemon/copy: Ensure errno is preserved along error paths.

commit 33c087ea9c72f74da8cc7cfd86d9fc6ca5c92b6b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 4 13:45:42 2013 +0100

    Add 'sparse' option to copy-{device,file}-to-{device,file} calls.
    
    Setting the 'sparse' optional boolean causes writes to be omitted if
    the block to be written contains all zero bytes.
    
    This should help with sparse backing files (eg. raw, qcow2, dm-thin, etc).
    
    Also, modify virt-resize to use this option by default when copying
    devices.  The savings in virt-resize can be quite startling, eg
    'du -sh' (ie. true size) of a resized disk image:
    
    8.1G      /tmp/f15x32-resized.img    # before this change
    3.2G      /tmp/f15x32-resized.img    # after this change

commit 289fd29f0bfbb94566d9780dd8ac3fe15e55541d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 4 11:49:27 2013 +0100

    php: Fix segfault when function has an OStringList optional argument.
    
    How this PHP/Zend stuff is supposed to work is not documented, but at
    least with these changes it no longer segfaults.

commit ba0199c487feec7f02cfc00ba3e900e6fa5ed4d8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 3 18:58:43 2013 +0100

    python: Let RHashtable be returned as a Python dict.
    
    The initial proposal was suggested by Matt Booth and discussed on the
    mailing list here:
    
    https://www.redhat.com/archives/libguestfs/2013-April/msg00007.html

commit 3dcb572bda87385ee9db4574b888120667aa4ece
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 3 12:33:24 2013 +0100

    Better error messages for FUSE and other things not supported.
    
    The bare message "FUSE not supported" wasn't actionable.

commit d0a8cca9a1a399d43c6e44dfc655eedbe61d22ec
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 2 15:53:37 2013 +0100

    FAQ: In Fedora >= 19, the RPM detects if it can access the network when building.

commit 387b232126cca86ad45f2a608f492d7b89ed714a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 2 15:25:48 2013 +0100

    Version 1.21.26.

commit 667482ca9a4268ef5b3565b274159e39efac0ef2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 2 12:28:27 2013 +0100

    perl: Remove Sys::Guestfs::Lib.
    
    See announcement on the mailing list for more details about this change:
    
    https://www.redhat.com/archives/libguestfs/2013-April/msg00001.html

commit 2287b988ee85fe478c4b3a9aed268d705b879bba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 2 13:11:33 2013 +0100

    perl: Remove use of Sys::Guestfs::Lib::open_guest function.
    
    This obsolete function does all sorts of libvirt/XML things, which can
    now be replaced by using ordinary API calls; especially $g->add_domain.

commit ecda39bed408ebbbe86b757d4a424391944a2572
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 2 13:05:30 2013 +0100

    tests/data: Update README and comments about initrd binary files.
    
    These are used for testing the C, not Perl, file_architecture API.

commit 1cb38ab9244347c78787a1e0832081c6edbfd716
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 2 12:27:34 2013 +0100

    New API: feature-available.
    
    This API is an easier to use version of the existing guestfs_available,
    because the new API returns true/false instead of throwing an error
    when a feature from the list is not available.
    
    In truth we've had this implementation internally in the library
    and several tools and in Sys::Guestfs::Lib for a long time.  This
    change just turns it into a publicly consumable API.

commit 288b2b2d4fa642e7a58728f1900d416ecb1e8328
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 2 10:14:51 2013 +0100

    virt-ls, virt-edit: Remove references to Sys::Guestfs::Lib and other irrelevant Perl libraries.

commit 6fa1177b0a429b13034797e3471da0dbbc4ccac3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 1 20:29:17 2013 +0100

    java: Make test cases depend on jar file.
    
    This fixes parallel builds.  The error you would have seen was:
    
      error: error reading libguestfs-1.21.25.jar; zip file is empty

commit 1a2e03c323cdc28d74d276c5c2a5b02df41d38f7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 1 20:28:16 2013 +0100

    java: 'make clean' should remove whole api/ directory.
    
    This directory (containing HTML documentation) can be removed
    completely when making clean.  CLEANFILES cannot recursively remove a
    directory, so use a clean-local rule instead.

commit ce49e1fdc05ddad306fcf2278429f0433c7f954e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 1 11:57:22 2013 +0100

    build: Change various check rules so they implicitly act like 'make -k'.
    
    Rules such as 'make check-valgrind' are implemented using a for-loop.
    They would always exit after the first error, even if 'make -k' was
    used at the top-level.  Since 'make -k'-style behaviour is generally
    more useful, change these for-loops so they run all the tests, and
    report errors at the end.

commit 599f5d7ddc793189a6ebfd61ccfac3abe6644cec
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 1 13:31:16 2013 +0100

    make clean: Remove *~ (editor backup) files.

commit 5f5ce4f59fe9d27bddef9ad5fe9712fe6bc663dd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 1 11:40:35 2013 +0100

    make clean: Clean contents of tmp directory.

commit b050d7e4bf2cdbd04e980511635687f1114035e0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 1 11:35:26 2013 +0100

    valgrind: Write separate log files in tmp/valgrind-<DATE>-<PID>.log
    
    Current code wrote a single valgrind.log in the top-level directory.
    This was overwritten with each valgrinded program, which wasn't much
    use.  The new version writes multiple separate valgrind-*.log files
    containing the date and PID (so each is unique).
    
    It would nice if valgrind could delete log files that don't contain
    errors, but this doesn't appear to be possible.

commit 68990840b64491b39ab8da5f1e46367ae5f01594
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Mar 31 21:58:46 2013 +0100

    "attach method" is from now on known as "backend".
    
    This large, but mainly mechanical commit, renames "attach method"
    everywhere to "backend".
    
    Backwards compatibility of the API (guestfs_{set,get}_attach_method)
    and environment (LIBGUESTFS_ATTACH_METHOD) is maintained, but in new
    code use guestfs_{set,get}_backend and LIBGUESTFS_BACKEND instead.
    
    The default backend (launching qemu directly) is now called 'direct'
    instead of 'appliance', although you can still use 'appliance' as a
    synonym.

commit f2b1a01e76ba8bd6865c5a2bed3204e222b43a08
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Mar 31 22:54:23 2013 +0100

    build: Clarify output of 'make help'.

commit 72f5a6b004f07910eef2557066a0a8ce45b26087
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 30 22:56:06 2013 +0000

    Version 1.21.25.

commit 75f2fcd68799f54951e9f75528ac7ea66c01ce69
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 30 19:44:39 2013 +0000

    docs: Remove obsolete sections from libguestfs gotchas.
    
    These refer to old behaviour in long-unsupported versions
    of libguestfs.

commit 806289ec66ee2984cbd0840b5ed4e2e61e75a36e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 30 19:43:52 2013 +0000

    docs: Refresh API overview section.

commit b2eef585710ddbff543a74a010ba524da61d78d8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 30 19:28:29 2013 +0000

    docs: Alternate ways to list filesystems through the API.

commit 8e76cb451278676f4ede4d34a32ac15ba2251aae
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 30 19:02:35 2013 +0000

    FAQ: Update distro support section.

commit 02a4e5ac6afb7089b1f878d07c285842df0d7f37
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 30 18:16:51 2013 +0000

    debian: Allow test-virt-alignment-scan-guests.sh test to be skipped.

commit 2a090e0667b303df59f2fd068dcb61a5afe79a96
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 30 16:26:25 2013 +0000

    tests/guests: Add 'guests-all-good.xml{.in}' libvirt test guest set.
    
    This differs from 'guests.xml' in that there are no guests with
    missing disks, etc., so we can use this to test virt-alignment-scan
    accurately.

commit 429ffda3299edb1fe391c7d331ea5d32c2aab75c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 30 12:52:12 2013 +0000

    parallel: Propagate errors from worker threads and exit with error code.
    
    In virt-df and virt-alignment-scan, ensure that errors that happen in
    worker threads are propagated all the way up and result in
    exit(EXIT_FAILURE).
    
    Note that this makes the align/test-virt-alignment-scan-guests.sh test
    fail (for a genuine reason).  This is fixed in the following commit.
    
    This updates commit 8b90f55dc733e358a0892d8e6e5c67fe2cc4e891.

commit 30702c7f548fe21282cae3fe911bf51b6eb925fe
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 29 21:49:12 2013 +0000

    Version 1.21.24.

commit f55a2dbf29fb5c96e74b8ae663f313cc23a8a8b7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 29 22:02:22 2013 +0000

    java: Make bindtests depend on jar file so parallel builds work.
    
    This fixes commit c36ced5e21348f5357fc70b402664c9a5d827b06.

commit 8b90f55dc733e358a0892d8e6e5c67fe2cc4e891
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 29 21:27:56 2013 +0000

    virt-alignment-scan: Don't call exit(3) from this multi-threaded program.
    
    For more information see:
    https://bugzilla.redhat.com/show_bug.cgi?id=790837#c2

commit d6ea2f5911a6c7f3037ae822e872b810ad80ba51
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 29 20:04:11 2013 +0000

    daemon: file: Remove extraneous space after output of 'file' command (RHBZ#928995).

commit a9ad3088bf2506b082262d411c9ffd2d50016777
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 28 23:37:31 2013 +0000

    daemon: parse_btrfsvol: Perform device name translation before trying to stat the device.
    
    If using (eg) virtio-blk, the canonical name won't work unless device
    name translation is done first.
    
    This fixes commit 47b929b7893b3a76ff22760d245cb80720ae6345..

commit bb276e8a2624b122c26010ca6a44993707afaadf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 28 23:28:10 2013 +0000

    daemon: parse_btrfsvol: Move variable decls to top, whitespace fixes.
    
    This fixes commit 47b929b7893b3a76ff22760d245cb80720ae6345.

commit a28a430b1042d581e0611e5f837344485879369c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 28 23:26:15 2013 +0000

    daemon: Fix parse_btrfsvol to use STRPREFIX instead of bogus strncmp.
    
    This fixes commit 47b929b7893b3a76ff22760d245cb80720ae6345.

commit c50cde67cc979d44d8459722ae9dba0700b6d031
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 28 20:24:25 2013 +0000

    java: Format CLEANFILES rule.

commit c36ced5e21348f5357fc70b402664c9a5d827b06
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 28 20:20:09 2013 +0000

    java: Enable parallel builds.
    
    This reverts commit 89404ec0ba9781b55cb3a87689bcc519e7d73ea2.

commit 6185aa4e38ce6e1101bad9b97514a7d15927bba8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 28 20:15:51 2013 +0000

    ocaml tools: Enable parallel builds.
    
    In particular, building virt-sysprep is slow because there are so many
    modules.  Enable parallel builds.  If it breaks, we should fix it, not
    work around it.

commit dce94f3e266ed3f1fc634a1ef6953f2db1510963
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 28 20:13:36 2013 +0000

    ocaml: Fix and enable parallel builds.
    
    We only have to serialize the two calls to ocamlmklib, since both will
    try to create a file called 'libmlguestfs.a'.  Apart from that,
    parallel builds here should be fine.

commit b13c935bbd2e14f3f5654c2e0a5ab69f606b473e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 28 20:12:47 2013 +0000

    ocaml: Break circular dependency of mlguestfs.cma{,x} <-> guestfs.cm{o,x}

commit 3c34db980868057916d6fe2489ad8906660e83d6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 28 17:13:34 2013 +0000

    Use new-style demand-loaded bash-completion scripts.

commit df7f57a19388078c664a2c40300330135f965e4d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 28 15:18:43 2013 +0000

    Version 1.21.23.

commit 924aa44c1fe18386b7ee24551e0b16f0ecc7cc48
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 28 11:40:49 2013 +0000

    bash completion: Extend this script to work with other virt tools.

commit 6c9a7fe5616bda5b17eef2558e52dc1f48e87722
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 28 13:07:22 2013 +0000

    Add --long-options option to most tools.
    
    For example:
    
    $ guestfish --long-options
    --add
    --cmd-help
    --connect
    --csh
    --domain
    --echo-keys
    [etc.]
    
    The idea of this is to make it easier to write a bash completion
    script that accurately expands --<TAB> options for each command.

commit b98de580c98b1e804dbc8b6a55cabcf80a2f6e18
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 28 10:57:48 2013 +0000

    fish: Better tab completion for guestfish.

commit 05ba39372468ccd383bb3808397b2b419a022b80
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 28 13:40:38 2013 +0000

    OCaml tools: Use Common_gettext and Common_utils modules.
    
    Share these modules across all three tools virt-resize, virt-sparsify
    and virt-sysprep.
    
    This is mostly code motion.

commit 69e0f86cabfe132087ef9cda2eafd0d86b18c4a8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 23 18:57:39 2013 +0000

    osinfo: Fix declaration of guestfs___osinfo_map to work when libxml2 is not installed.

commit 186bb67c6e8496d04a6f5646df9b2fb483cdc189
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 19 12:01:24 2013 +0000

    Add support for: Gluster, Ceph (rbd), Sheepdog.
    
    These are not tested at all, and so probably won't work.  However the
    code and infrastructure is in place so we can fix bugs easily as they
    arise.

commit 97be29893e6a760bd1082008645942814a904c63
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 19 12:06:48 2013 +0000

    build: Add 'make check-valgrind-with-appliance'.

commit 62d940d2dd3a152736663ec5318b1b2e240653d6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 19 12:06:24 2013 +0000

    build: Small rearrangement of Makefile.am check-slow rule.

commit 55ce68784f447826c8796e491e8279f0df22f22a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 19 12:03:16 2013 +0000

    build: Fix 'make extra-tests' to call 'check-valgrind' instead of rule that doesn't exist.

commit 71de9ef03909218473d820938fff61665d35a6e7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 19 11:59:57 2013 +0000

    build: Turn off warning about overlength-strings.
    
    ISO apparently specified a limit of 4096 bytes/characters for strings.
    The description of the guestfish command 'add-drive' is now longer
    than this limit, causing this warning.
    
    Turn off this warning, since GCC has no problems with these strings.

commit a535befbeba39c03487c9c277cd09b68e61c3fde
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 18 22:35:43 2013 +0000

    nbd: Update and clarify the documentation for NBD.

commit 66df6ae908dc6e0d2870e04680eff15d39c808e8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 18 22:35:24 2013 +0000

    drives: Make parse_servers return an int (number of servers).
    
    This is just a code refactoring.

commit f8941b09e6756304e5fa1da82824593d1da65a63
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 18 19:46:24 2013 +0000

    Version 1.21.22.

commit dc4c959ce1ddfd2cc82284bfb24f7b5e862e791e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 18 17:30:13 2013 +0000

    nbd: Allow 'unix' transport & socket to be specified.
    
    This allows the server string to contain "unix:/path/to/socket",
    thus using a Unix domain socket to connect to the NBD server.

commit 43b6d75a08f543ab2074885e13c10fb0b80ece2f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 18 16:42:24 2013 +0000

    tests: nbd: Ensure qemu-nbd subprocess is always killed.
    
    Even if the test fails/dies for some other reason.

commit f750c3e72d35fb14abea9806aa2c39a1356872cb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 18 16:35:02 2013 +0000

    drives: Factor out common code for making a file= qemu parameter.

commit 9c32c73afd755cd1b0b5a34d1c6bf3a1dc068fca
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 18 15:48:02 2013 +0000

    drives: Allow multiple servers to be passed to add_drives.
    
    This changes the existing (non-published-in-stable) API for
    add_drives{_opt} so that instead of having separate 'server' and
    'port' parameters, now we have a single 'server' parameter which is a
    list of strings.
    
    This is so we will be able to cope with protocols such as Ceph which
    allows multiple servers, or Sheepdog which can use an implicit local
    server (ie. zero servers specified).
    
    NBD still requires exactly one server.

commit 766393d8542c9824c034016b7238c5e854ed323a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 18 15:47:34 2013 +0000

    inspection: Remove unused #includes.

commit 66417582219dd25ae794dacaaa6df2ea9f1131e1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 18 14:58:50 2013 +0000

    drives: Add a common guestfs___free_drive_source function.
    
    This refactors the code to introduce a common function.

commit 612a3f06b46d5ae651bf855980f30fc817eadc63
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 18 14:58:36 2013 +0000

    drives: Whitespace change.

commit cec0c55a358fb19b583db8bfd0514b3d8b03aee8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 18 12:04:24 2013 +0000

    drives: Change internal struct drive_source.
    
    This is just code refactoring.

commit 856c2f6a47f5230bb88564fd254e1f834ee41e43
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 18 09:55:36 2013 +0000

    nbd: Note that readonly connections are not supported by the appliance attach-method.
    
    This documents the problem and links to the upstream bug.

commit ae3011d5184eb7b9614695f87ba7d16460f558e4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 16 20:18:50 2013 +0000

    lib: Remove -Wswitch-default.
    
    This warning is actively dangerous.  Because it forces you to use a
    'default:' case in every switch statement, it means you can no longer
    detect missing cases in enums.

commit bf1c3196b53293c2f1c3cd37ab14b00b40d6e942
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 16 20:22:26 2013 +0000

    lib: Add missing cases in switch statements.
    
    These were being hidden by misguided use of the dangerous
    -Wswitch-default flag.

commit 2af946b3bf4bf0426ed72f05c653635e157ee4c6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 15 22:41:01 2013 +0000

    Version 1.21.21.

commit af1c53d104180415a8584c48f19fd4ea7df224f5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 15 22:40:06 2013 +0000

    appliance: Make sure cachedir has mode 0755 (RHBZ#921292).
    
    See https://bugzilla.redhat.com/show_bug.cgi?id=921292#c4

commit e7c78881fc539b10374d0507d6ca2c3edae65020
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 15 22:39:45 2013 +0000

    appliance: Use ignore_value() macro instead of casting return to (void).

commit c83221a869c99eb812071f72d326cf8e4525b47d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 15 14:43:50 2013 +0000

    drives: add_drive was only called from one place, so inline it.
    
    This is just code motion.

commit 694a091d3faac78acbd0b5a368856b569c7ba5e2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 14 23:09:56 2013 +0000

    lib: Add direct support for the NBD (Network Block Device) protocol.
    
    You can now add remote NBD drives using:
    
     ><fs> add-drive "" format:raw protocol:nbd server:localhost
    
    (Note that you also need to add port:NNNN if the server is running on
    a non-standard port).
    
    The corresponding qemu-nbd service can be started by doing:
    
     qemu-nbd disk.img -t
    
    This commit also adds a test.

commit e7e2b56569ddba018912193c192210ae50950815
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 14 22:34:56 2013 +0000

    drives: Make drv->readonly flag into a bool.

commit b1df9a9df121e8386222291aacac9f9f8602c620
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 14 22:15:35 2013 +0000

    drives: Refactor code to separate 'struct drive' creation from adding drives.

commit 33ec3eca298c83d5af90a899fa5f22da6bd0a266
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 14 19:11:31 2013 +0000

    launch: Move code concerned with adding drives to 'src/drives.c'.
    
    Apart from adding a few comments, this is entirely code motion.

commit a2b88b8637f1df13540bcf099c965cfc6c7112be
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 14 13:50:49 2013 +0000

    Add ./configure --with-extra-packages="..." option.
    
    This adds extra packages to the appliance.  It's useful for adding
    debugging packages.

commit 85dd52f470f8cb84dbd83c8478b7f9feb3ab7b06
Author: Hilko Bengen <bengen@debian.org>
Date:   Wed Mar 13 21:13:04 2013 +0100

    Mount /run as tmpfs inside appliance (workaround for febootstrap's /init)

commit e29a130d8f3dbf8eab23ae78aabc2d95e7f56470
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 14 12:47:40 2013 +0000

    erlang: Use $(ERLANG_LIB_DIR) to get Erlang libdir.
    
    Instead of previous custom hack which didn't work properly on Debian.
    
    Thanks: Hilko Bengen.

commit 04acc32abf5bea2ce53f695b4030be5f2147a469
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 14 12:20:52 2013 +0000

    README: Discourage general users from doing 'make install'.
    
    It causes plenty of problems with people have multiple parallel
    versions of libguestfs installed, and there's no benefit because you
    can easily run libguestfs and tools from the build directory.

commit 87c9ec881cb695724e01d9f6fc9df996d4c67cb6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 14 12:15:23 2013 +0000

    ruby: Support 'make INSTALLDIRS=vendor install' for Ruby as well as Perl.
    
    As with Perl, you can now set INSTALLDIRS to control where Ruby places
    its files (ie. in the site dir, which is the default, or in the vendor
    dir).
    
    The difference in file layout between 'make install' and
    'make INSTALLDIRS=vendor install' is shown below (for Fedora 18).
    
    --- /tmp/site   2013-03-14 12:14:35.740015694 +0000
    +++ /tmp/vendor 2013-03-14 12:14:13.668093944 +0000
    @@ -119,21 +119,20 @@
     ./usr/lib64/ocaml/guestfs/mlguestfs.cmxa
     ./usr/lib64/ocaml/stublibs/dllmlguestfs.so
     ./usr/lib64/ocaml/stublibs/dllmlguestfs.so.owner
    -./usr/lib64/perl5/auto/Sys/Guestfs/Guestfs.bs
    -./usr/lib64/perl5/auto/Sys/Guestfs/Guestfs.so
    -./usr/lib64/perl5/auto/Sys/Guestfs/.packlist
     ./usr/lib64/perl5/perllocal.pod
    -./usr/lib64/perl5/Sys/bindtests.pl
    -./usr/lib64/perl5/Sys/Guestfs/Lib.pm
    -./usr/lib64/perl5/Sys/Guestfs.pm
    +./usr/lib64/perl5/vendor_perl/auto/Sys/Guestfs/Guestfs.bs
    +./usr/lib64/perl5/vendor_perl/auto/Sys/Guestfs/Guestfs.so
    +./usr/lib64/perl5/vendor_perl/auto/Sys/Guestfs/.packlist
    +./usr/lib64/perl5/vendor_perl/Sys/bindtests.pl
    +./usr/lib64/perl5/vendor_perl/Sys/Guestfs/Lib.pm
    +./usr/lib64/perl5/vendor_perl/Sys/Guestfs.pm
     ./usr/lib64/php/modules/guestfs_php.so
     ./usr/lib64/pkgconfig/libguestfs-gobject-1.0.pc
     ./usr/lib64/pkgconfig/libguestfs.pc
     ./usr/lib64/python2.7/site-packages/guestfs.py
     ./usr/lib64/python2.7/site-packages/libguestfsmod.la
     ./usr/lib64/python2.7/site-packages/libguestfsmod.so
    -./usr/local/lib64/ruby/site_ruby/_guestfs.so
    -./usr/local/share/ruby/site_ruby/guestfs.rb
    +./usr/lib64/ruby/vendor_ruby/_guestfs.so
     ./usr/sbin/libguestfs-make-fixed-appliance
     ./usr/share/doc/libguestfs/example-debian-netinst-cd.xml
     ./usr/share/doc/libguestfs/example-debian.xml
    @@ -406,3 +405,4 @@
     ./usr/share/man/uk/man3/guestfs-perl.3
     ./usr/share/man/uk/man3/guestfs-python.3
     ./usr/share/man/uk/man3/guestfs-ruby.3
    +./usr/share/ruby/vendor_ruby/guestfs.rb
    
    For prompting me to fix this, thanks: Hilko Bengen.

commit 0fd925da77983d6f438f2494d8dd3cd122234f68
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 14 10:47:00 2013 +0000

    launch: Print attach-method, tmpdir, umask, euid when launching.
    
    These are only printed when debugging is enabled, but should help
    debugging hard-to-pin-down permissions problems.

commit df656c9d5a49af97ecfce4147a276d478c78019e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 14 08:56:29 2013 +0000

    tests: Make it easier to grep failures out of the log file.

commit 3e4d3f415cd581361444ac52ee7b27086dff37f4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 13 18:45:30 2013 +0000

    Version 1.21.20.

commit 1b644ad64eb9b9c1d6e97953b98c8c00559bf37d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 13 16:59:23 2013 +0000

    utils: Fix error messages for external commands that fail (RHBZ#921040).
    
    This adds a common utility function (guestfs___exit_status_to_string)
    and a common error function (guestfs___external_command_failed), and
    uses them all over the library and tools when converting exit status
    in error messages etc.

commit 50a3fa5f4275b5b97ac1d9a5121c89caa68cde3e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 13 16:41:29 2013 +0000

    lib: Move common errors to src/errors.c.
    
    This is just code motion.

commit e9d30742949e9e24259927fd0bd5104d6bb9bfff
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 13 17:19:17 2013 +0000

    rescue: Remove dead code.
    
    This pty code was defended by #if 0 ... #endif and was dead code.

commit 368b4c6480057ed090ee5793b6fdf88e138188e7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 13 10:57:36 2013 +0000

    Ignore case when generating AUTHORS file.

commit b17c3a7eb384a32b93acb32597db9e6290b6e22c
Author: infernix <infernix@infernix.net>
Date:   Tue Mar 12 17:37:48 2013 +0000

    launch: appliance: Add custom parameters last.
    
    This allows custom parameters to modify parameters added by
    libguestfs, eg. by doing:
    
      -set drive.hd0.file=rbd:foo/bar
    
    [infernix adds the comment below:]
    
    This works for recent versions of QEMU. The way to use this is:
    
    guestfish
    ><fs> add-drive /dev/null
    ><fs> config -set drive.hd0.file=rbd:pool/volume
    ><fs> run
    
    This will probably work for more types (sheepdog, iscsi et al), but
    with the caveat that the libguestfs layers are bypassed so you'll
    *always* end up directly accessing the disk in rw mode.

commit 0b285cd8a6b6ce351663e9fde248b904734ca4c3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 12 13:19:26 2013 +0000

    docs: Update documentation on attach-methods.
    
    Add better instructions for getting the default attach-method.
    
    Update libguestfs-test-tool(1) to show how to enable and disable
    libvirt.

commit 6e4f9be4929118c4a571f60ea10d370aa35360fb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 12 12:35:17 2013 +0000

    php: Pass all libvirt environment variables down to PHP test scripts.
    
    Including LIBVIRTD_* and VIRTLOCKD_*.
    
    This updates commit cd40cf713991569e51b42742177e57f3dca148bc.

commit 49622ab63b814f32e3b60e31ff12198551f41693
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 11 23:03:38 2013 +0000

    Version 1.21.19.

commit 5e5026b730dfea1e940e961a5b7e516a9c9bda72
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 11 18:33:17 2013 +0000

    qemu-img info: Use --output json and YAJL (JSON parser) to safely parse output (RHBZ#920225).
    
    The old parser is still used if either YAJL is not available or
    qemu-img info doesn't support the --output json option.

commit 2f8960f7844274177185f65a636c9b511980a41e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 11 16:27:13 2013 +0000

    qemu-img info: Prefix parsing functions as old_parser_*.
    
    Prefix functions in this file with old_parser_... to make it clear
    this is the old / slightly unsafe human output parser, which is
    shortly to be replaced by a safer JSON parser.
    
    This is just code motion.

commit cd40cf713991569e51b42742177e57f3dca148bc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 11 16:04:17 2013 +0000

    php: Fix tests.
    
    - Use ./run script to run the tests.
    - Set environment variables correctly, including $PATH.
    - Test the locally built, not installed, copy of libguestfs.

commit becc4fecf42955295d292aa3c7e6525b6a3e0a54
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 11 14:29:13 2013 +0000

    php: Revise README-PHP documentation.

commit c64e99782fa0648e2208ce544d816c77a9f49903
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 11 14:28:40 2013 +0000

    docs: Note that $PATH affects libguestfs.
    
    If $PATH is not set, libguestfs and/or libvirt tend to break.

commit 350c478d7b7517660d7a31e860fe993f52ff5964
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 11 14:27:25 2013 +0000

    launch: libvirt: Unset $PATH can cause libvirt launch to fail.
    
    Note this fact in the error message that is printed in this situation.

commit 02159e9aa8a1d40c8c266aabe835003ad1e32629
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 11 14:05:33 2013 +0000

    launch: libvirt: Print proper dotted libvirt version.

commit fe3798f366bbe581e9058ba03778dc49ee83dc4a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 11 13:44:50 2013 +0000

    php: Print libguestfs error string if test fails.

commit d44752a110e46c1a67ef1b9aae71e2dc0691a178
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 11 13:44:33 2013 +0000

    php: Fix test, /dev/null format must be "raw".

commit 7a968beb4682f4304ac9f17cbb7a4612c28aadb9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 11 12:34:22 2013 +0000

    lib: Give values for each state in 'enum state'.
    
    The values of CONFIG, LAUNCHING and READY and (kind of) exposed
    through the API so shouldn't change.
    
    Use a bad sentinel for NO_HANDLE since that indicates a serious error.

commit 99e5ffd1de7a21a10c33fcddbdf560a8b5808800
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 11 12:24:03 2013 +0000

    lib: Add comment for libguestfs handle.

commit d9efcfb5561a3ad3a6a557c4ec275277a48963d1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 11 11:03:55 2013 +0000

    RHEL 5: tests/xml: Define O_CLOEXEC in LD_PRELOAD library.

commit 1b5b397da8d02421c99ac4ed235cae0ec113f741
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Mar 10 20:08:06 2013 +0000

    RHEL 5: tests: Use gnulib.
    
    Gnulib defines O_CLOEXEC which is missing on RHEL 5.

commit d16bb6b70c8e70285fbc12bc85da5a4cdad9f928
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 9 19:25:33 2013 +0000

    RHEL 5: Replacement for 'Unix.isatty stdout' for old OCaml versions.
    
    Unix.isatty missing on RHEL 5-era OCaml 3.09.3.

commit e73944faf40c0a880ecd66bc0e7ade3f4b8ddc2c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 9 18:36:09 2013 +0000

    RHEL 5: gnulib: Use module mkstemps.
    
    RHEL 5 glibc doesn't have this function.

commit bb0617859fe4b272c6ce0d1ab37db04e6d7fdfb4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 8 20:16:04 2013 +0000

    RHEL 5: inspect: Add macro for be32toh if one is not defined in the header files.

commit 74297e6109b1f97b36a38c15f9bfecd841372ab5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 8 17:03:37 2013 +0000

    Add suppression for memory leak in libmagic.

commit 52c3edd5e008bdd74d06f5b1823d9b6495a74f4d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 8 14:02:19 2013 +0000

    filearch: Use a more logical way to construct the cpio command.

commit 801487f2a74c4ce8d70dd4465443bd4c58719ed0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 8 13:50:42 2013 +0000

    filearch: Don't print errno if cpio command fails, print command status instead.
    
    errno is meaningless here.

commit 22d82d00b4e61010bdbf5fe6bec7688cba7c511b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 8 13:16:37 2013 +0000

    generator: Small fix for OCaml 3.12.1.
    
    OCaml 3.12.1 (unlike 4.00.1) doesn't let you use printf formatters
    in this way:
    
      printf (if foo then "&%s" else "%s") str

commit 0ee24ccf8adb080260a5bb4260593cafe7bc016d
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Thu Mar 7 19:59:26 2013 +0100

    Move Ruby-related checks from autoconf to extconf.rb; add extra check for rb_alloc_func_t
    
    Ruby ships its own config.h which may or may not define the same
    relevant constants as our autoconf-generated config.h. Instead of
    trying to specify the exact path to the wanted header file we may just
    as well simply use Ruby's autoconf-inspired checks and macros.

commit 3a895ba794c1cf6d802c2a7bdecf171ae87f9376
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 7 23:29:21 2013 +0000

    df/parallel.c: Fix if libvirt is not available at compile time.

commit ef33ea359db61f4ddde38b67c1628b0e214499fb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 7 21:53:16 2013 +0000

    Version 1.21.18.

commit 6557d0c0824fd25cba4f96d033b77554b4b787f9
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Thu Mar 7 22:15:23 2013 +0100

    out-of-tree build: Fix link creation

commit a568dec4cf00405002c723c69f2d76d9e38d3c20
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Thu Mar 7 22:15:22 2013 +0100

    Still build the libguestfs-specific parts when --disable-appliance is passed to configure

commit 43b37d02a14827376ad6c5c1449d27a875ff783e
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Thu Mar 7 19:59:28 2013 +0100

    out-of-tree build: Fix localized manpages

commit 0a50e644353658fb7dac97c5efe665ffd20cd3fd
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Thu Mar 7 19:59:25 2013 +0100

    out-of-tree build: don't distribute extconf.rb.in template, use generated exconf.rb
    
    Apparently, the file will only be autogenerated in $(builddir) if it
    is not already present in $(srcdir).

commit bb1f665d7fd59f7f36b8f23540cb36b5fd6a1f74
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 7 18:21:06 2013 +0000

    protocol: Handle log messages from connection layer centrally.
    
    Previously described as a "gross hack and massive layering violation".

commit ed41fcd75c32877198e826aabdb23d553504b1f9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 7 14:55:40 2013 +0000

    protocol: Abstract out socket operations from protocol code.
    
    This creates an abstract layer below the protocol code which handles
    the socket operations.  This will make it easier to introduce libvirt
    virSocketPtr operations in future.
    
    In the handle, g->conn contains the connection to the appliance.
    g->conn is NULL when we're not connected.
    
    poll(2) is used instead of select(2).
    
    All error messages about launch failing or the appliance unexpectedly
    dying are handled by two common error message functions, and these
    contain a better explanation of what to do.

commit 06b39b8098ea314d8dc72e2162c53157a58f8aab
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 7 16:28:08 2013 +0000

    protocol: Remove message_summary code.
    
    Produces lots of output, and not very helpful.

commit 2c8e7ba9b47f70d5222d6c5020a6cdf86e2f8e87
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 7 11:40:44 2013 +0000

    launch: unix: Set g->daemon_sock = -1 after closing it.
    
    This ensures we don't accidentally use the closed fd.

commit 9ae639948ad9d28af53887ef5d7dc8b040fccd82
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 7 11:39:44 2013 +0000

    lib: Rename g->fd to console_sock and g->sock to daemon_sock.
    
    This just renames the fields in the handle to more descriptive names.
    There is no functional change.

commit f9381847f1ef349ec15136e11f07957814408745
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 7 11:12:04 2013 +0000

    launch: appliance: Set FD_CLOEXEC flag on console socket.
    
    The earlier (pipe-based) code never set this flag, but that was a bug,
    potentially allowing the file descriptor to be leaked to subprocesses.
    
    Set the FD_CLOEXEC flag, but also ensure it is cleared in the child
    process just before qemu is exec'd (otherwise qemu would not have a
    console).

commit 6e7cbb09a900fdf9841dd5a0a044d72cc67edfac
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 7 09:50:36 2013 +0000

    launch: appliance: Use socketpair instead of pipe for qemu stdin/stdout.
    
    The libvirt backend already uses a Unix socket for the appliance
    console, and so for the libvirt backend the fields g->fd[0] == g->fd[1].
    
    Change the appliance backend to use a socketpair, so we need just a
    single file descriptor for qemu stdin/stdout (ie. appliance console).
    
    Consequently we can remove the array int fd[2] in the handle and
    replace it with a single file descriptor.

commit 8136ca37194b162af714e2e0328d9171729370f9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 6 21:13:14 2013 +0000

    proto: send_to_daemon is not an exported function.
    
    This function is only used inside src/proto.c, so rename
    it from guestfs___send_to_daemon to just send_to_daemon.

commit 7de25c2bca7a06cbd076d0f025cc62c0d49d8167
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 6 14:30:32 2013 +0000

    valgrind: Add suppression for memory leak found in libselinux.

commit c44c5ee26870584f4f9dfea5305f707b4142c717
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 6 11:18:14 2013 +0000

    debug: Add command to generate lots of debug messages.

commit ba08a51094409811d0bd01a7af5ec596a8640cc1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 5 17:03:21 2013 +0000

    launch: libvirt: When debugging, print permissions of appliance and sockets.
    
    When debugging is enabled, this prints out the permissions (ie.
    ls -laZ) of the appliance and sockets directories.  This should be
    helpful for debugging RHBZ#913774.

commit 59f01c4a7057cb0222fb9289234282b3b9c4ca76
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 5 16:46:53 2013 +0000

    launch: libvirt: Rename 'is_root' as 'current_proc_is_root', and documentation.

commit ed354e8f8b4f3204a244b8b2a345d9f6262122fc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 5 16:44:41 2013 +0000

    launch: libvirt: When root, set socket permissions to 0660 (vs 0775).
    
    Since qemu connects to both, there was no point at all in having these
    sockets be readable by other, nor executable by anyone.
    
    The sockets should now end up as:
    
      srw-rw---- root.qemu

commit a4a2a181c2881d62f5addaa4f6e3836c4e691333
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 5 15:26:41 2013 +0000

    fuse: tests: Set FD_CLOEXEC flag on file descriptor.
    
    This is not required here, but it helps if the test code matches what
    the documentations says you should do.

commit f7789acdabbfb4a825e47c31ad4933fcfb8f60af
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 5 14:06:09 2013 +0000

    Version 1.21.17.

commit 603968934423041757e9e4cf75419b184cec1698
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 5 14:40:18 2013 +0000

    guestmount: Add --no-fork flag.
    
    This prevent guestmount from daemonizing.

commit 0120a087f444d3ebeb16b96696b993684db550db
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 5 14:05:35 2013 +0000

    Add guestunmount.1.html to the website.
    
    This fixes commit 3e9e40aee322789e7f81422f4cfd42915b36eb4c.

commit 3e9e40aee322789e7f81422f4cfd42915b36eb4c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 4 18:47:05 2013 +0000

    fuse: Add guestunmount program to handle unmounting (RHBZ#916780).

commit 09442d058875987f3636982c4a313e05d2709e32
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 4 15:26:07 2013 +0000

    fuse: guestfs_umount_local is not thread-safe.
    
    Despite what the documentation may have said, it certainly was not
    safe to call guestfs_umount_local from another thread.
    
    guestfs_umount_local could generate events, call the error handler, or
    access other fields in the handle, with no locking at all.
    
    We should aim to make guestfs_umount_local thread-safe in future.
    
    See also:
    https://bugzilla.redhat.com/show_bug.cgi?id=917706

commit d08f5ebd9a926f6ecca7498f8f0c2eff9273d313
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 4 13:28:15 2013 +0000

    generator: Generate guestfs_user_cancel.
    
    This function is now generated, so bindings in various languages
    are made automatically.
    
    Note that the function previously returned void, but now it returns
    int (although always 0).  We don't believe that this is an ABI break
    since existing programs will continue to work.

commit ac2f6c4ef218afc8b61e80595ab5647ef70b9cb6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 4 13:22:05 2013 +0000

    generator: Add 'wrapper' flag to control when wrapper is generated.
    
    Non-daemon functions normally have a wrapper function called
    eg. guestfs_name.  The "real" (ie. hand-written) function is called
    eg. guestfs__name.  The wrapper deals with checking parameters and
    doing trace messages.
    
    This commit allows the wrapper function to be omitted.  The reason is
    so that we can handle a few functions that have to be thread-safe
    (currently just: guestfs_user_cancel).  The wrapper is not thread safe
    because it can call events and/or the error handler.

commit 4236929fbbd8943589e9ad2441e3f4393872dc79
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 4 13:16:00 2013 +0000

    generator: Typo in comment: "Checking" -> "Check".

commit 9b7de52d58bb70294e6c5be6fb80b888d42f7ad7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 4 09:55:33 2013 +0000

    threads: Note that even innocent-looking functions need a mutex.
    
    RWMJ was caught out by this one ...

commit 66351f7494954f26e2fcf35f4b02238fcfdb366f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 4 09:53:10 2013 +0000

    trace: Put trace buffer on the stack instead of in the handle.
    
    This makes more sense, and makes the code slightly closer to being
    thread safe (although it's still NOT thread safe).

commit 8e2b920fe67d859399945910f8a55209586865c8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 1 16:25:41 2013 +0000

    FAQ: Add question about running fsck on live filesystems.

commit 7d8b97559b6a6f63507a0dbec9f5da67d3dbd24e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 1 15:55:18 2013 +0000

    Version 1.21.16.

commit 7f5bedd53b3b13d3638be47088d2239470d1dc3e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 1 14:44:51 2013 +0000

    lib: Check calls to xmlXPathEvalExpression for nodesetval == NULL.
    
    libxml2 xmlXPathEvalExpression can return an unusual nodeset:
    
      $1 = {type = XPATH_NODESET, nodesetval = 0x0, boolval = 0, floatval = 0,
        stringval = 0x0, user = 0x0, index = 0, user2 = 0x0, index2 = 0}
    
    Note that the nodeset is non-NULL, but the nodesetval is NULL.
    
    Check every call site and fix those that don't deal with this
    correctly.

commit 3adb0d6d01d17a6bd443ff14a16f673dfb88f577
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 27 22:27:23 2013 +0000

    add-domain: Move 'connect_live' function.
    
    This is just code motion.

commit e78a2c5df3c4ec79e22e03ee4994958537f2e8d8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 27 22:24:16 2013 +0000

    add-domain: Pass SELinux label from guest to appliance (RHBZ#912499).
    
    When adding a domain (ie. guestfs_add_domain), read the SELinux
    <label/> and <imagelabel/> from the guest and use them for the
    appliance.  The appliance is statically labelled the same as the
    guest, so it is able to read its disks.
    
    However tell libvirt not to try relabelling the disks, to prevent
    libvirt from disturbing the existing labels on the disks (in
    particular when the libvirt connection is closed, we don't want
    libvirt to try to restore some other label on the disks).
    
    Updated with feedback from Matthew Booth.

commit 26df366d3bf712a84337c2402f41506f2be6f610
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 27 22:18:15 2013 +0000

    launch: libvirt: Allow the SELinux label to be set on qcow2 overlay files.
    
    When a disk is opened readonly, the libvirt attach-method privately
    creates a qcow2 overlay on top.
    
    This commit lets that overlay get an SELinux label, and sets it to the
    imagelabel specified by guestfs_internal_set_libvirt_selinux_label.
    
    The above only applies to the libvirt attach-method.

commit b9ee8baa49afbf8b6d80a42f3a309b660c7b32a5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 28 15:37:07 2013 +0000

    New internal API: internal_set_libvirt_selinux_norelabel_disks.
    
    If set, this causes <seclabel model=selinux relabel=no> to be added to
    the disk element in the libvirt XML.
    
    It has no effect *except* on the libvirt attach method when SELinux
    and sVirt is being used.

commit 617eb88c5e66247894fde2aae11bd102889eb85c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 27 18:41:12 2013 +0000

    New internal API: internal_set_libvirt_selinux_label
    
    This internal API sets two SELinux labels in the handle (the process
    label and the image label -- they are closely related).
    
    If using the libvirt attach-method with SELinux and sVirt, then this
    will cause the following XML to be added to the appliance definition:
    
    <seclabel type=static model=selinux relabel=yes>
      <label>[LABEL HERE]</label>
      <imagelabel>[IMAGELABEL HERE]</imagelabel>
    </seclabel>
    
    It is ignored by other attach-methods.

commit a6a703253be9e9c590a49a149c0170f2e46a1eb2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 27 22:23:34 2013 +0000

    add-domain: Refactor domain XML parsing code.
    
    This is just code motion.

commit d01ac175598add0de574a4cccfe48d0c5cc4276c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 28 14:54:24 2013 +0000

    test-tool: Give an error if there are extra arguments on the command line.

commit 3f1e7f1078ac40a6736b7721cc248f8ed0614f48
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 27 18:36:22 2013 +0000

    launch: libvirt: Refactor SELinux warning code.
    
    This is just code motion.

commit 93feaa4ae83b72864e7c10e9a388219ad9960123
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 28 13:34:42 2013 +0000

    parallel: Don't access the global handle from multiple threads.
    
    libguestfs handles are not thread safe, and it's not safe even to read
    settings from the handle from multiple threads (eg. guestfs_get_trace).
    Stop doing this in the parallel library.  This caused fairly
    reproducible segfaults when you enabled '-x' and/or '-v'.
    
    This fixes commit 34e77af1bf42a132589901164f29bd992b37589e.

commit ce7cffa85a76f539fcccb0c34321594e96b2a186
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 27 14:07:25 2013 +0000

    libutils: Don't include "guestfs-internal.h".
    
    This mini-library shouldn't access library-internal stuff.  It should
    only use the "guestfs-internal-frontend.h" header.

commit 1ea7752e95a90aa8016d85489c7460b881fc59b0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 27 11:07:16 2013 +0000

    lib: Move 'for_each_disk' function back into libvirt-domain.c.
    
    This function is no longer called from anywhere outside the library,
    or even outside libvirt-domain.c.
    
    This is just code motion, except for the size_t changes which are
    required in order to avoid signed overflow optimization error:
    
      assuming signed overflow does not occur when simplifying conditional
      to constant [-Werror=strict-overflow]

commit 4c5c555eeb37da74d9af902762308a544f4f82d4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 26 22:11:40 2013 +0000

    generator: Line up GUESTFS_EVENT_ALL.

commit c29660588fd7b196f11aa7f92e7d5230534a59e5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 26 22:08:53 2013 +0000

    generator: Remove "deprecated macros for internal functions".
    
    No need for these since these are internal functions that only code
    under our control should have been calling.

commit 1ea73f4bdf7c4e7998c23e4fab2166ca30b6665b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 26 17:48:56 2013 +0000

    Version 1.21.15.

commit db30fe0cb098492a7c49ec8ca03fc11b69da244c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 26 17:24:42 2013 +0000

    lib: Fix memory leak in guestfs_list_filesystems.
    
    This fixes commit 6e7f052ef40fc799605f13e21e1dc4928d274f41.

commit b6cbd980fb2fe8e43de9e716769cba63cd8d721b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 26 17:00:50 2013 +0000

    tests: Add tests of guests to virt-df and virt-alignment-scan.

commit 5ff3845d280515ab623d22666c3f5013f095d32a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 26 16:47:38 2013 +0000

    tests: guests: Add blank disks plus libvirt test:// XML.
    
    You can now run virt-df and virt-alignment-scan on all of the test
    guests by doing:
    
    ./run ./df/virt-df -c test:///path/to/tests/guests/guests.xml
    ./run ./align/virt-alignment-scan -c test:///path/to/tests/guests/guests.xml
    
    which is kinda cool.

commit fe939cf842949f0eda0b6c69cad8d2d6b5b2c3fd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 26 14:50:44 2013 +0000

    lib: Turn guestfs___for_each_disk back into an internal library function.
    
    Since the refactoring of virt-df and virt-alignment-scan, those
    tools no longer use this function.

commit 6e3aab2f0c48280e746e90050abf25947159e294
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 26 14:35:19 2013 +0000

    Partial rewrite of virt-alignment-scan to use parallel threads.
    
    See previous commit (virt-df equivalent change) for the rationale.

commit 34e77af1bf42a132589901164f29bd992b37589e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 25 18:46:40 2013 +0000

    Partial rewrite of virt-df to use parallel threads instead of single appliance.
    
    Previously when you asked virt-df to show stats for all your libvirt
    guests, it used a single appliance and tried to attach as many disks
    as possible to it, even disks from different guests.
    
    However this has been problematic: Not only is the code to do this
    horrendously complex, but it's also insecure, and it doesn't interact
    well with sVirt labels (see RHBZ#912499 comment 7).
    
    In the meantime we discovered that running parallel appliances gives
    you most of the performance of using a single appliance, but with a
    lot less complexity and better guest isolation (see the documentation
    in commit 680450f3b4f8c2da7a0b1d8f0bd8c2232efc4054).
    
    Therefore this is a partial rewrite of virt-df so that in this case it
    now uses parallel appliances.
    
    Notes:
    
    The '--one-per-guest' option is now the default and only way to do
    things; this option now does nothing.
    
    By default, the amount of parallelism to use is controlled by the
    amount of free memory seen when virt-df starts up (subject to some
    minima and maxima).  The user can control this through new command
    line option '-P'.

commit 76266be549c521e3767a94c07e9ae616826a2568
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 26 13:13:59 2013 +0000

    lib: Export guestfs___add_libvirt_dom for use by virt-df and virt-alignment-scan.
    
    See the comment in guestfs-internal-frontend.h in this commit.

commit 556e109765d7b6808045965a1eefcb434294f151
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 26 10:02:18 2013 +0000

    tools: Introduce a mini-library for estimating max threads based on free memory.
    
    This mini-library runs the 'free -m' command and greps the output to
    estimate the max. number of libguestfs appliances we could run in
    parallel in the remaining free memory.

commit f8b92c066805708766d9f1aa925721febed28068
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 26 16:59:57 2013 +0000

    df: Always have TESTS= line even if appliance is disabled.

commit a885dd025d9e8fa9ebaf0ffbeb4f7bd1f9629f4d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 26 16:57:54 2013 +0000

    virt-alignment-scan: Set LANG=C in test.

commit 4a6c8021b599952b991725043bac5c722635b3f6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 26 10:05:23 2013 +0000

    lib: Add a global MIN macro to guestfs-internal-all.h.

commit d02610853d3f732f4527d2dc51b803943e5ece10
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 25 17:39:11 2013 +0000

    Version 1.21.14.

commit ff0269e80fcd2031afa7d48e414b7ca7e1ef4d7a
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Mon Feb 18 22:43:41 2013 +0100

    out-of-tree build: fix test-tool
    
    (Not entirely sure whether using Gnulib to replace standard functions
    is a good idea at all.)
    
    link with libgnu:
      CCLD   libguestfs-test-tool
    libguestfs_test_tool-test-tool.o: In function `main':
    /home/bengen/src/deb/pkg-libvirt/libguestfs/debian/build-default/test-tool/../../../test-tool/test-tool.c:103: undefined reference to `rpl_getopt_long'
    /home/bengen/src/deb/pkg-libvirt/libguestfs/debian/build-default/test-tool/../../../test-tool/test-tool.c:113: undefined reference to `rpl_optarg'
    /home/bengen/src/deb/pkg-libvirt/libguestfs/debian/build-default/test-tool/../../../test-tool/test-tool.c:125: undefined reference to `rpl_optarg'
    /home/bengen/src/deb/pkg-libvirt/libguestfs/debian/build-default/test-tool/../../../test-tool/test-tool.c:126: undefined reference to `rpl_optarg'
    /home/bengen/src/deb/pkg-libvirt/libguestfs/debian/build-default/test-tool/../../../test-tool/test-tool.c:109: undefined reference to `rpl_optarg'
    libguestfs_test_tool-test-tool.o: In function `set_qemu':
    /home/bengen/src/deb/pkg-libvirt/libguestfs/debian/build-default/test-tool/../../../test-tool/test-tool.c:382: undefined reference to `rpl_perror'
    /home/bengen/src/deb/pkg-libvirt/libguestfs/debian/build-default/test-tool/../../../test-tool/test-tool.c:366: undefined reference to `rpl_perror'
    libguestfs_test_tool-test-tool.o: In function `make_files':
    /home/bengen/src/deb/pkg-libvirt/libguestfs/debian/build-default/test-tool/../../../test-tool/test-tool.c:416: undefined reference to `rpl_perror'
    /home/bengen/src/deb/pkg-libvirt/libguestfs/debian/build-default/test-tool/../../../test-tool/test-tool.c:428: undefined reference to `rpl_perror'

commit cd1558b89ea2081528daa8a2833b6291e68bf98a
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Mon Feb 18 22:43:40 2013 +0100

    out-of-tree build: fix daemon
    
      CC     guestfsd-9p.o
    In file included from ../../../daemon/9p.c:32:0:
    ../../../daemon/daemon.h:33:34: fatal error: guestfs-internal-all.h: No such file or directory

commit 680450f3b4f8c2da7a0b1d8f0bd8c2232efc4054
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 23 22:35:48 2013 +0000

    docs: Update guestfs-performance with parallel scaling numbers and test script.

commit ff80a540117945046e4671907f3a6799384fe39b
Author: Olaf Hering <olaf@aepfle.de>
Date:   Mon Feb 25 10:56:47 2013 +0100

    lib: avoid pragma usage in inspect-fs-windows
    
    pragma GCC diagnostic is a gcc 4.6+ feature, compilation fails with
    older compilers:
    
    inspect-fs-windows.c: In function 'map_registry_disk_blob':
    inspect-fs-windows.c:502: error: #pragma GCC diagnostic not allowed inside functions
    inspect-fs-windows.c:503: error: #pragma GCC diagnostic not allowed inside functions
    inspect-fs-windows.c:505: error: #pragma GCC diagnostic not allowed inside functions
    make[3]: *** [libguestfs_la-inspect-fs-windows.lo] Error 1
    
    Use memcpy instead of pragma to fix compile error.
    
    Signed-off-by: Olaf Hering <olaf@aepfle.de>

commit 455d6b1845b54649693d67cdf991a8ac470a395f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 23 20:55:59 2013 +0000

    recipes: Add example converting from one format/filesystem to another.

commit fadec0687f67eb904b8c312d7d922fa7bd97147f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 23 20:32:33 2013 +0000

    daemon: protocol: Fix memory leak when receiving FileIn file (RHBZ#914934).
    
    This fixes commit 950951c67de61da27dceca8ffb2079031c13e43b.

commit 4136850f3ced2c8da6ca4f44c0f80881cb6d1352
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 23 19:59:04 2013 +0000

    tests: Add a regression test for RHBZ#914931.
    
    This involves adding a new test API which crashes the appliance in the
    middle of a simulated upload, then a test which uses that API to test
    for the libguestfs (library-side) crash.

commit 7953128ca66207a7a3ca44e02fec1de48253223e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 23 19:24:49 2013 +0000

    protocol: Don't segfault if appliance crashes during FileIn upload (RHBZ#914931).
    
    Instead of the segfault you now get a more informative error:
    
    *stdin*:0: libguestfs: error: connection to daemon was closed unexpectedly.
    This usually means the libguestfs appliance crashed.  Please enable
    debugging (LIBGUESTFS_DEBUG=1) and rerun the command, then look at the
    debug messages output prior to this error.
    libguestfs: error: /dev/stdout: write: Broken pipe
    libguestfs: error: file receive cancelled by daemon

commit d950e1a3bc582e48839d800aa1522968a795a983
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 23 08:18:27 2013 +0000

    run: Refer to README and correct documentation for linking to script.
    
    Any link works, even a hard link.

commit 1ca842d98b2da7fb3cd09e572c88ddba5b52b673
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 23 08:14:35 2013 +0000

    run: Relicense as LGPLv2+.
    
    To allow reuse in other projects and because of the equivalent change
    made by Eric Blake to the libvirt 'run' script.

commit 37796d70bf5c00d004add2f9b14bef8b3b3cf5db
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 20 23:20:45 2013 +0000

    Update API support.

commit b49eefdb15c5679c3d1dea19ae9ecc1293cd4fa7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 20 21:25:44 2013 +0000

    Version 1.21.13.

commit 9d6aa8b537110ce52ffba6a9d70f9ccf6b392979
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 20 20:03:47 2013 +0000

    Use guestfs___count_strings instead of custom versions in various places.

commit 907fbfff53157b447079aab587cc0f01ed0f000a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 20 20:00:04 2013 +0000

    python: Use guestfs___free_string_list instead of custom version.

commit 4ede94ab7bc09c9dde8445b521387e343537c4ac
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 20 19:45:44 2013 +0000

    ocaml: Use guestfs___free_string_list instead of custom-coded one.
    
    It should be possible to add the guestfs___free_string_list to
    dllmlguestfs.so, but I cannot work out exactly how to do this.  As a
    result we end up using src/utils.c directly.

commit 6ee164d47ae29ad16b6184f8020841f860d93798
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 20 19:55:04 2013 +0000

    ocaml: Missing #include <config.h> in generated file.

commit 27e6347b759fc824f911835e7908f4daf7b3654f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 20 19:45:25 2013 +0000

    lua: Use guestfs___free_string_list instead of custom-coded version.

commit 0b7acf50b69cbc45b740f05115cbf44c232fae08
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 20 19:24:35 2013 +0000

    fish: Use guestfs___{free_string_list,count_strings} utility functions.
    
    Instead of custom-coded versions.

commit e27295c5780c1b42610f56be9082bb81f27f6fcd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 20 19:24:21 2013 +0000

    libutils: Add guestfs___count_strings utility function to common library.

commit 7ef461948ec79608e43166ba897338ea69041c47
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 20 19:11:05 2013 +0000

    erlang: Use guestfs___free_string_list from libutils, instead of custom version.

commit 04723b4dd105d204b5afa7201860c9a81eda05b2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 20 17:06:46 2013 +0000

    lib: Create libutils convenience library.
    
    The libutils convenience library is a place for code shared between
    the main library, language bindings and virt tools.  Note that the
    code is statically linked into both the library, each binding and each
    tool, but this is an improvement because (a) the source is shared and
    (b) libguestfs.so can export fewer private functions.
    
    Currently it contains the cleanup functions, and the functions
    guestfs___free_string_list function and guestfs___for_each_disk.
    
    guestfs___for_each_disk has changed so that it no longer
    unconditionally sets the error in the guestfs handle.  Instead callers
    can control error handling.

commit a4953090e1515fed7a1c0945316435043740f7f2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 20 17:08:53 2013 +0000

    lib: Rename guestfs_error_errno as guestfs___error_errno, etc.
    
    These are internal functions.  Very old versions of libguestfs used to
    export them, but they haven't been (and shouldn't be) exported for a
    long time.
    
    Also remove the unused guestfs_error function.

commit 1a2465c187e53ac26128cfdd9bcaae19475e2d0d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 20 16:05:11 2013 +0000

    build: Remove long and mostly irrelevant comment about libtool versioning.

commit 21013249659931aea326bd2a3f1ed1753b309963
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 20 16:03:14 2013 +0000

    build: Rearrange src/Makefile.am into a more logical order.
    
    This is just code motion.

commit 6566621345a46d5514565b59cc2889c1c4583169
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 20 14:03:24 2013 +0000

    tests: Add valgrind suppression for libvirt 1.0.2 memory leak.
    
    Leak reported as RHBZ#913145.

commit b7ab6de628936868ce676820a3871cbf4d6ac372
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 20 14:19:09 2013 +0000

    tests: Add valgrind suppression variant for new manifestation of an old libvirt memory leak.

commit 61162bdce1a00a921a47eb3e788e8fb9e4bd07ac
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 20 13:50:43 2013 +0000

    lib: Use CLEANUP_* macros to simplify XPath query code.

commit b10a6cfe24a20d59d6eb099454761f71573f478d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 20 11:28:50 2013 +0000

    rescue: Improve error messages in the test script.

commit 175d6ba432d804c835391b52c3362b9bbc3eccae
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 20 10:30:44 2013 +0000

    faq: Add section for developers, including how to send patches and propose features.

commit 065861ce6bd1069b0ae111bcd14057d82cfc3963
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 20 10:00:21 2013 +0000

    docs: Rewrite security section (thanks Dan Berrange).

commit 8671cfa343d24fb5ebe6b2cefdbf9006458c4f2f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 19 17:35:48 2013 +0000

    Version 1.21.12.

commit a1c89bf03dd432f0e4c8c26fe01fd9b2a50df97e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 19 15:37:18 2013 +0000

    build: Only add 'serial-tests' for automake >= 1.12 (thanks Hilko Bengen).
    
    Earlier versions of automake complain if they get a configuration
    parameter which they don't understand.  The error is:
    
    configure.ac:27: error: option 'serial-tests' not recognized
    
    Use some m4 hackery to work around this.

commit c7ba91761c05cce3806b908cba8a7a0bd902c7be
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 18 16:28:14 2013 +0000

    handle: Define DEFAULT_MEMSIZE, MIN_MEMSIZE constants.
    
    This is just code motion.

commit 70514c7f7e34243cc2b9c8ee925bcc243a1001b2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 19 12:59:23 2013 +0000

    ruby: Add binding for guestfs_event_to_string.

commit 0f849029d18cf4095294dfb76a65bd998d763ad5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 19 12:45:37 2013 +0000

    python: Add binding for guestfs_event_to_string.

commit e9d83e94a28d433e40857a9a8ed3fc23e1320932
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 19 12:45:22 2013 +0000

    perl: Add binding for guestfs_event_to_string.

commit 7e71c9fb34fb28c685b631b5403fbb2d3b8e7553
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 19 11:48:02 2013 +0000

    java: Use guestfs_event_to_string instead of generated code.

commit 2a8de9001eae01c0534fe60e72305931adfff4df
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 19 11:32:59 2013 +0000

    fish: Use guestfs_event_to_string instead of guestfish-specific generated functions.

commit 5c513060b17def062dcafdae13ff4fe05f49dbe2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 18 22:55:21 2013 +0000

    ocaml: Add binding for Guestfs.event_to_string and use it in events test.

commit b793fafcb79360e3d42936af788aaa8b3dbdd226
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 18 22:01:04 2013 +0000

    New C only API: guestfs_event_to_string.

commit 6902f093ffd2bfbd21fcc7bc682db8106fd2fd93
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 18 14:02:21 2013 +0000

    handle: Translatable string in guestfs_parse_environment.

commit 0e0eec76d9dca032e3eb45c0bbe024edc7bb16f8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 18 13:02:59 2013 +0000

    generator: Whitespace changes.

commit cbfa394bfc7e980381097b457761ddc42d59d01f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 15 14:41:56 2013 +0000

    lib: Fix memory leak when the 'lpj' setting is read from dmesg.
    
    It was failing to clean up and close the 'struct command' buffer,
    because commit 94d90f03e2bbb595890b01e2a10b63e00e976691 added an
    incomplete patch to use CLEANUP_CMD_CLOSE.
    
    This fixes commit 94d90f03e2bbb595890b01e2a10b63e00e976691.

commit 5c6895bda1053b4cbbcc8c72fe30d8fd17d403d6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 15 14:25:25 2013 +0000

    java: Print a better error message when JVM version is too old.
    
    This fixes commit 87d1f7714f8e1b0f595bad3b7932592f0f85d54b.

commit 87d1f7714f8e1b0f595bad3b7932592f0f85d54b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 15 12:57:19 2013 +0000

    java: Note that JVM >= 1.6 is now required.

commit c598e14052399f19d36d7874d7133cba779bd3c2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 14 22:15:25 2013 +0000

    appliance: Use a glibc trick to try to display a stack trace if a program in the appliance segfaults.

commit 989d3c76918da0468ce853cef8afb6e4e8230885
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 14 15:38:40 2013 +0000

    Version 1.21.11.

commit 9021351c8e5c756689855a4a32bfe0889e6b0965
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 14 16:33:01 2013 +0000

    tests: mountable: Add test-mountable-inspect.sh to EXTRA_DIST.
    
    This fixes commit 7d976657e6f02ca0b61858f668ae792a70327309.

commit 52b7418670f0319e1fbd055c0156be6eb3d16551
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Feb 13 10:38:59 2013 +0000

    Fix API doc errors

commit f0f8d7ce781fdfb4a4292a77e2834c7c3d192052
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Feb 13 10:30:51 2013 +0000

    gobject: Fix doc generation of L<guestfs(3)/CVE-2010-3851>

commit 23f8bd4fac40739de3233f2fb3278a41c68c3f14
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 12 17:09:44 2013 +0000

    daemon: Fix RESOLVE_MOUNTABLE, internal_parse_mountable.
    
    - The mountable->volume field was not being initialized on the
      device path.
    
    - XDR string fields cannot be NULL.
    
    This fixes commit 7d976657e6f02ca0b61858f668ae792a70327309.

commit db554cf2710ff0cc849a9271ce17c6b3fce2882e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 12 17:02:33 2013 +0000

    tests: mountable: Print error message if guestfs_create fails.

commit 4f7d1b3ae768751f469940a203b1e7647033558c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 12 17:01:44 2013 +0000

    tests: Add Fedora btrfs phony guest to target list.
    
    This fixes commit 754e8194382a9ed265c7fa172e438049e4eb8389.

commit 77c57ab8432f0155e4d1a007d2789d4901a9f804
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 12 17:00:10 2013 +0000

    tests: Reorder the tests so test guest is created before it's used by mountable test.
    
    This fixes commit 7d976657e6f02ca0b61858f668ae792a70327309.

commit 1399005d7e1832889c108039291413b5c20b26ca
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 12 15:18:17 2013 +0000

    examples: Ensure each example program is documented.

commit e84d6e6102fcc55eff0044351cb7d8d1a3296e20
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 12 15:02:43 2013 +0000

    examples: Rename example programs, replacing '_' with '-'.

commit 4215d0ca683378e34d8c5f87d7ec85c834e75b78
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Feb 7 15:49:51 2013 +0000

    mountable: Test inspection of fedora image

commit 7ba0e10501f23358c38939930d613bf2393d744d
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Feb 7 14:06:13 2013 +0000

    inspect: Update inspect_os to use mountables
    
    This fixes inspection of guests which use btrfs subvolumes.

commit 7d976657e6f02ca0b61858f668ae792a70327309
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Feb 6 10:32:35 2013 +0000

    New internal API: internal_parse_mountable

commit b0abf10b9f2e07f4002f4d486fcb2c02fd91aac3
Author: Matthew Booth <mbooth@redhat.com>
Date:   Tue Feb 12 14:45:19 2013 +0000

    build: Minor cleanup in daemon/Makefile.am

commit 754e8194382a9ed265c7fa172e438049e4eb8389
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Feb 7 15:36:01 2013 +0000

    btrfs: Make a stub Fedora btrfs guest for inspection testing

commit 6e7f052ef40fc799605f13e21e1dc4928d274f41
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Jan 25 16:13:19 2013 +0000

    mountable: Make list-filesystems return btrfsvols

commit bcb933a0c169b090739a0a7e5c98224dd61aa8ef
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Jan 25 14:49:35 2013 +0000

    btrfs: Update btrfs_subvolume_list to take Mountable_or_Path
    
    btrfs_subvolume_list can now take either the path of a mounted btrfs
    filesystem, or a mountable describing the location of a btrfs
    filesystem, or one of its volumes. In the latter case, the filesystem
    will be automatically mounted outside of /sysroot before running the
    btrfs tool, and unmounted afterwards.

commit 72aaf56fed5c942b2631005edc58f7b8e6f701ae
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Jan 25 14:30:40 2013 +0000

    mount: Add mount_vfs_nochroot
    
    This internal function allows mounting a mountable outside /sysroot.

commit ec6a4de37a94558ecfdeb22c54d5e5c1571a2437
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 12 11:56:42 2013 +0000

    faq: Add common questions about virt-resize/virt-sparsify in place support.

commit 954e315d217af39fb09467f228fb7e03a0530d10
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 12 11:56:16 2013 +0000

    faq: Fix some small typos in section on virt-sparsify.

commit 6c5577e40373f02ff798e8cfc49206b9edd76484
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 12 11:55:45 2013 +0000

    faq: Update RHEL information.

commit cd47df1fe5e854c01756b184e3175bd57f611dbd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 12 10:55:26 2013 +0000

    test-tool: Point to SELinux documentation for further information.

commit 0e79b9dd038b83ebe5d6f2bc1d93379a2e5c7cd7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 11 21:44:39 2013 +0000

    examples: Add all the C examples to the guestfs-examples(3) man page.

commit 09c4f94c9def22dc7413425d419098462227e70a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 11 21:36:27 2013 +0000

    build: Separate out *_CPPFLAGS from *_CFLAGS.
    
    This is pretty pointless.

commit bbb637f96221733d4e492fa73a68cf7981677db9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 11 21:22:25 2013 +0000

    test-tool: Get rid of the "=== Test starts here ===" banner.
    
    It confuses things, because that is not always the start
    of the output.

commit ee61d16e3efa90705f77f6051f639ef1e3c6d094
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 11 21:21:01 2013 +0000

    test-tool: Display SELinux status in output of libguestfs-test-tool.

commit 45b427157924d9b15dc60ba7e9048640ffebb2e4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 11 19:38:55 2013 +0000

    Version 1.21.10.

commit 05444da98351c9269fc8c6278f8bb5c5cfd4bb83
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 11 17:35:11 2013 +0000

    tests: Add a regression test for stack overflow in events (RHBZ#909624).
    
    Note this is a check-slow test since generating 1,000,000 progress
    events take a few minutes.

commit b3cf5d1d9638313a656ee61f1bd5f06bbca21abf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 11 17:55:59 2013 +0000

    proto: Fix stack overflow when there are many progress events (RHBZ#909624).
    
    Thanks: Eric Blake.

commit a43f88b1c5299baf36561bda57531845ea94551a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 11 17:28:10 2013 +0000

    daemon: Allow rate to be specified in 'debug progress'.
    
    There are now two forms of the 'debug progress' command:
    
    (1) debug progress <n> (the original form) generates ordinary
    rate-limited progress messages for <n> seconds.
    
    (2) debug progress <n> <rate> generates progress messages every <rate>
    microseconds for <n> seconds.
    
    The second form omit the usual rate-limiting, and so wouldn't
    be generated like this from an ordinary API call.  However this
    is useful for testing events (see RHBZ#909624).

commit 942e1395624b4a10348b693b656fd9f359dbc1b2
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Jan 25 14:48:05 2013 +0000

    mountable: Implement Mountable_or_Path
    
    A Mountable_or_Path argument is passed as a mountable_t. A new type is
    added to mountable_t to handle already mounted paths.

commit 93d4fddaef909a7863be93cace2a98aba75af7cc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 11 15:49:12 2013 +0000

    lib: Add format attribute for GCC 4.8 in two places.

commit 984431a9ef789c54a3008bd80610b2488f90e61d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 11 15:48:49 2013 +0000

    daemon: Force disable -Wsuggest-attribute=format warning around asprintf_nowarn, for GCC 4.8.

commit f226133c1a8467e85d02b8de634c1ac2a931ba83
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 11 15:59:28 2013 +0000

    lib: Define GUESTFS_GCC_VERSION in the internal header.
    
    Note that you have to use this as follows:
    
    #if defined(__GNUC__) && GUESTFS_GCC_VERSION >= x0y0z /* gcc >= x.y.z */
    
    since GUESTFS_GCC_VERSION is not defined unless it's GCC.

commit ef2276654eae2e1bbcbcdb440a54029c12efccd0
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Jan 24 15:21:14 2013 +0000

    generator: Create Mountable_or_Path, initially identical to Dev_or_Path

commit 47b929b7893b3a76ff22760d245cb80720ae6345
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Jan 24 10:10:13 2013 +0000

    mountable: Implement Mountable support for all apis which take it
    
    A Mountable is passed from the library to the daemon as a string. The daemon
    stub parses it into a mountable_t, which it passes to the implementation.
    
    Update all implementations which now take a mountable_t.

commit d5817537fa6c51a7f851ecc5e4e63e60609e0c03
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Jan 24 09:25:31 2013 +0000

    generator: Convert relevant arguments from Device to Mountable
    
    This change updates the api style of all apis which should take Mountable
    descriptions rather than block devices. It also updates the documentation
    accordingly, but doesn't implement any functional changes.

commit 007c2f236d29e846cfc4829f11562f2dc8f58d6a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 11 14:13:59 2013 +0000

    test-tool: Document how to change SELinux settings.

commit b1a89d3b1ccdcd5aed3619cfc2c47812b288205e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 11 14:05:26 2013 +0000

    test-tool: Document how to run with alternate libvirt.

commit 3877cab3298f65ee118f413f68a2438af8fa58e4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 11 13:41:40 2013 +0000

    test-tool: exec qemu in the wrapper script.
    
    This ensures that libvirt can control qemu directly, eg. being able to
    send it signals.

commit 20fd81147df3796000bc242a0c515f67713fdbdd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 11 13:20:37 2013 +0000

    test-tool: On i386, upstream qemu program is now called 'qemu-system-i386'.
    
    For a while, the upstream qemu i386 emulator has been called
    'qemu-system-i386' (instead of just 'qemu').  Fix test-tool so it
    calls the right program.

commit df983d19946fec697db2c502d7a6bb36ff0d2df5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 11 13:18:26 2013 +0000

    test-tool: Don't call guestfs_set_qemu before guestfs handle is initialized (RHBZ#909836).
    
    Because of evolution of the code, if the user used the --qemu or
    --qemudir options, libguestfs-test-tool would segfault because
    guestfs_set_qemu was being called before the guestfs handle was
    opened.
    
    Change the code so this doesn't happen, and also remove the global 'g'
    variable to make the code a bit more robust.
    
    Bug found by Amit Shah.

commit e4495b24bcd9aa9a238cc35c6a908e16c1efaf3c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 11 12:07:30 2013 +0000

    daemon: link: Remove use of PATH_MAX.
    
    Replace readlink calls with gnulib areadlink function.

commit c3afef3eecf58beac3f22c98a2e383e644d75f2f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 11 11:59:35 2013 +0000

    daemon: xattr: Remove use of PATH_MAX.

commit 09f391373489a30126932f8a4afe0bab69e1322a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 11 11:52:40 2013 +0000

    daemon: realpath: Remove use of both PATH_MAX and NAME_MAX.

commit 9c9ceec6b7726143dfc09306ede3d101be8f1879
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 11 11:37:59 2013 +0000

    daemon: initrd: Remove use of PATH_MAX and other cleanups.
    
    - Move variables to the top.
    - Rearrange comments to make more sense.

commit 1703c6841b397d92c278fcb5bac749b0ab35e33a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 11 08:43:01 2013 +0000

    daemon: find0: Remove use of PATH_MAX.

commit e527aed8958ebfb9ea04520144e3c69848940187
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 11 12:43:48 2013 +0000

    getline: Rename &n parameter as &allocsize.
    
    The second parameter passed into getline(3) is the size of the
    allocated buffer, *NOT* the length of the returned line.  This can be
    confusing, so rename this parameter as 'allocsize' consistently
    throughout the code.
    
    This is just code motion.

commit e0a3a7c1e50107a9304d4f3193453988d6dc35ea
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 9 22:38:24 2013 +0000

    docs: Improve reasons for using libguestfs-make-fixed-appliance.
    
    Thanks: Richard Harman.

commit d6c0ff055dea9fe56d196ccd49b17fcc105d8c42
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 9 21:17:41 2013 +0000

    launch: libvirt: Make it clear that setsockcreatecon debug message is just a warning.
    
    This was disturbing to some users, but other users saw the warning
    when it was really something they should pay attention to.  Make it
    clear that it's a warning, unless people are really using SELinux +
    sVirt.
    
    Thanks: Richard Harman.

commit 8ad8e1075b4f69e87014a033537da9decac35420
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 9 21:02:11 2013 +0000

    Version 1.21.9.

commit d538af8a0a5169e1c0e5f8d4e6222c47cbe237aa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 9 20:52:40 2013 +0000

    rescue: Count the mountable filesystems when displaying the 'suggest' message.

commit 4255db65e58a86148ec291a7416a1148c453d926
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 9 17:34:53 2013 +0000

    tools: Use CLEANUP_* macros in several C tools.

commit 20a562321c20a7902843537c4f3a1e6d58ba4c3b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 9 17:48:30 2013 +0000

    generator: Export libxml2 CLEANUP_* macros unconditionally.
    
    These call abort() if libxml2 is not actually installed, but that
    should never happen inside the library or tools.

commit 94d90f03e2bbb595890b01e2a10b63e00e976691
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 8 18:10:44 2013 +0000

    lib: Define CLEANUP_CMD_CLOSE macro and use it throughout the library.

commit 59b296fecc4d2287cfbac4f07c8f6291d3fcfc41
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 8 14:14:06 2013 +0000

    tools, tests: Use "guestfs-internal-frontend.h" header.
    
    Instead of redefining STREQ, etc.

commit 30029b7ffb7f7bfda474301fd134e773fdf7db7e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 8 14:10:41 2013 +0000

    lib: Use CLEANUP_FREE_<struct>, CLEANUP_FREE_<struct>_LIST macros in a few places in the library.

commit 5f54da6fdf63f8bc9c831fa4e1fb7239c08e3306
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 8 13:39:47 2013 +0000

    lib: Add CLEANUP_FREE_<struct>, CLEANUP_FREE_<struct>_LIST macros for API structs.
    
    For example:
    
     {
       CLEANUP_FREE_STAT struct guestfs_stat *stat = guestfs_stat (g, "/foo");
    
       // stat is freed automatically when we leave the scope.
     }
    
    The new header file "guestfs-internal-frontend-cleanups.h"
    includes definitions for these.  It should not be included
    directly.

commit 5e770c8f6a41257ea828bf765aa07624f139d369
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 8 13:53:33 2013 +0000

    lib: Allow guestfs_free_* functions to be safely called with a NULL pointer.
    
    This is so they work just like 'free'.

commit 7b7cfa62e30b6a0810deadbe442a348f2940dec7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 8 16:00:27 2013 +0000

    lib: Remove explicit defines of _BSD_SOURCE.
    
    An equivalent is defined already in <config.h>.

commit cab1a0c1d94441eef693ce559b6a15363ac973ca
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 8 13:38:37 2013 +0000

    generator: Add #ifndef defense around guestfs-internal-actions.h file.

commit 8fb2306be4e183a402e3eaf9ac277b73924516ae
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Jan 23 13:46:33 2013 +0000

    generator: Add new Mountable argument type
    
    This type is initially identical to Device.

commit 6e7f95b669ef1f8fec6ef22d115b8a34adbe6b43
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Feb 8 14:53:05 2013 +0000

    inspect: Fix improperly ignored error in check_filesystem

commit 7d6b5bb837ab5cdb3e8b1774e28499d368917009
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Feb 7 11:22:46 2013 +0000

    inspect: Don't re-implement list_filesystems in inspect_os

commit dd58db7329063f40223ece984a15df7f3b01ad67
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Feb 7 11:04:38 2013 +0000

    Fix bogus partition number passed to guestfs___check_for_filesystem_on
    
    Partition number was being passed to guestfs___check_for_filesystem_on
    based on an index in list_partition. However, this ignores the
    possibility of multiple block devices.
    
    This change makes guestfs___check_for_filesystem_on examine the
    passed-in device directly to determine if it is a whole device, or
    what its partition number is.

commit a7d7e8176f5d8b612f3f3095013f043fe9be3a41
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Feb 7 10:39:00 2013 +0000

    New API: is_whole_device

commit 3045c0cbafddede553da73f1e0afa139e475ac83
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Feb 7 14:18:02 2013 +0000

    btrfs: Fix btrfs_subvolume_list on F18 (RHBZ#903620).
    
    The output of btrfs subvolume list has changed in F18 to include generation,
    which breaks the parsing in btrfs_subvolume_list. This change replaces sscanf
    with a more robust regular expression. The new regular expression should also
    handle the addition of future unexpected columns.

commit c78ec7e085e99bfddd0509dece72bf6a8d0188ce
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 6 14:27:39 2013 +0000

    daemon: Check parameter of base64-out and tar-out before running external command (RHBZ#908322).
    
    For base64-out, check the filename parameter exists and is not a
    directory.
    
    For tar-out, check the dir parameter exists and is a directory.

commit ca056d53bdfd2967be8a0d6908d658e25571878d
Author: Matthew Booth <mbooth@redhat.com>
Date:   Mon Feb 4 14:11:57 2013 +0000

    generator: Add visibility to action struct
    
    The visibility field in action replaces in_fish, in_docs and internal.
    The defined types are:
    
    VPublic:
      A public API. This is exported and documented in all language
      bindings, and in guestfish.
    
    VStateTest:
      A public API which queries the library state machine. It is exported
      and documented in all language bindings, but not guestfish.
    
    VBindTest:
      An internal API used only for testing language bindings. It is
      guarded by GUESTFS_PRIVATE in the C api, but exported by all other
      language bindings as it is required for testing. If language
      bindings offer any way to guard use of these apis, that mechanism
      should be used. It is not documented anywhere.
    
    VDebug:
      A debugging API. It is exported by all language bindings, and in
      guestfish, but is not documented anywhere.
    
    VInternal:
      An internal-only API. It is guarded by GUESTFS_PRIVATE in the C api,
      and not exported at all in any other language binding. It is not
      documented anywhere.

commit f9bafde5e7f1302ce7c5ea304e51a8d90a323b58
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 6 13:27:26 2013 +0000

    daemon: download: Add extra check that download file is not a directory (RHBZ#908321).

commit f473a173b8c8b825a66297502dee39b11fe3d99c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 6 13:14:07 2013 +0000

    daemon: Add more information to certain calls to perror.
    
    Replace selected calls to 'perror (filename)' with:
    
      fprintf (stderr, "syscall: %s: %m\n", filename);
    
    so that more information is available about precisely which syscall
    failed.
    
    Note this is *not* reply_with_perror.  These messages are only printed
    in verbose output, for the benefit of debugging.

commit f631e84102706a3e826c9d2454fe67dad636830a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 6 12:59:00 2013 +0000

    9p: Missing call to reply_with_perror.

commit c98ef8d089e5607ead7f15033e1bfa291d855eeb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 5 20:27:25 2013 +0000

    Version 1.21.8.

commit a0a4ee5245afdb7961d39b243439b902229dd599
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 5 15:31:05 2013 +0000

    Use 'supermin' and 'supermin-helper' in preference to febootstrap.
    
    Febootstrap has been renamed upstream to 'supermin':
    https://www.redhat.com/archives/libguestfs/2013-February/msg00004.html
    
    This commit changes libguestfs so it can use either program to build
    the supermin appliance.

commit 72dd398679cd0bb803daf306d12558369615ba70
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 4 19:43:25 2013 +0000

    daemon: Call wipefs before mkfs to work around pathological behaviour in btrfs.
    
    See: RHBZ#907554, http://www.spinics.net/lists/linux-btrfs/msg21197.html

commit 7e25e0780eac92701904aa86689e8759da98fb86
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 4 21:47:52 2013 +0000

    FAQ: Update section on sVirt.

commit 4075ed9247ad1061efe5438373b7d82230639c77
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 4 13:12:28 2013 +0000

    build: Add src/guestfs-internal-{all,frontend}.h to EXTRA_DIST.
    
    This fixes commit ec3b75e5ffd1abea1400f6609ae9c61eab0dfa71.

commit 776ffbfaec2a52203272024a5a1ef2bf3ec788e7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 4 13:03:25 2013 +0000

    Version 1.21.7.

commit 4940bd9a9e4771c2c1321b7d072fe1018c3e4a9a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 4 11:49:52 2013 +0000

    fish: Be stricter about boolean values.
    
    Previously I noticed that bfan used this command without any error:
    
    ><fs> hivex-open /WINDOWS/system32/config/software write:ture
                                                       ^^^^^^^^^^
    
    This was because the code allowed any string to be evaluated as a
    boolean.
    
    The new code is stricter.  It allows the following strings only case
    insensitive (everything else is an error):
    
      1
      true
      t
      yes
      y
      on
    
      0
      false
      f
      no
      n
      off

commit d012b729faaa3db73bf198f82ae28d567005b137
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 4 12:17:31 2013 +0000

    ruby: Include "guestfs-internal-frontend.h" in extension.
    
    Also undefine '_' symbol defined by Ruby's internal headers.
    
    This fixes commit ec3b75e5ffd1abea1400f6609ae9c61eab0dfa71.

commit 9e27a1556cc653cb10ed6711a5fb70d623cb93ac
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 4 11:49:04 2013 +0000

    perl: Include "guestfs-internal-frontend.h" in XS file.
    
    Also undefine '_' symbol defined by Perl's internal headers.
    
    This fixes commit ec3b75e5ffd1abea1400f6609ae9c61eab0dfa71.

commit 5e4f03ccf25a9996fc4fadb4ce0e17b4b567cd5c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 2 15:24:23 2013 +0000

    README: Format the list of requirements better.

commit 0d18a8b4075c30d28e2f7346f751445b6156e24b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 2 13:56:19 2013 +0000

    Update copyright dates for 2013.

commit 791ad3e9e600ef528e3e5a8d50be79d56b18129d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 1 16:18:42 2013 +0000

    fish: Use CLEANUP_* macros in a lot of places.

commit 6c1aca5ae28021fac9282d13ee0a51a926e5e566
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 1 15:54:13 2013 +0000

    fish: Use CLEANUP_FREE in parse_config.

commit 4b20a20d330f177415faf4a78e063ab81965e011
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 1 14:39:54 2013 +0000

    Remove TMP_TEMPLATE_ON_STACK macro.

commit 42bffcd00aac31f9f844a2a2e9b91faa4509408c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 1 14:16:51 2013 +0000

    Remove all occurrences of the bad_cast (lowercase) function.
    
    Not to be confused with the libxml2 macro 'BAD_CAST' which converts
    from 'signed char *' to 'unsigned char *'.
    
    The 'bad_cast' function was defined and used all over the place as a
    replacement for a '(char *)' cast.  I think it is better to make these
    casts explicit, instead of hiding them in an obscure function.

commit ec3b75e5ffd1abea1400f6609ae9c61eab0dfa71
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 1 13:43:38 2013 +0000

    Rearrange internal header files.
    
    This commit rearranges the internal header files.
    
    "src/guestfs-internal.h" is just for the library, as before.
    
    "src/guestfs-internal-frontend.h" is for use by all library, bindings,
    tools C code, but NOT the daemon.
    
    "src/guestfs-internal-all.h" is for use by all C code including the
    daemon.
    
    This is just code motion, but it has some important consequences:
    
    (1) We can use the CLEANUP_* macros in bindings and tools code.
    
    (2) We can get rid of TMP_TEMPLATE_ON_STACK.
    
    (3) We will (in future) be able to stop bindings and tools code from
    using the safe_* allocation functions (which are NOT safe to use
    outside the library alone).

commit 63c324e6c4e68d7332bd954571965f941548a297
Author: Cole Robinson <crobinso@redhat.com>
Date:   Wed Jan 30 15:05:13 2013 -0500

    tests: Handle changing QEMUDIR
    
    qemu-wrapper isn't regenerated if QEMUDIR is changed, so just
    delete it and force regeneration.
    
    Additionally we can drop the silent binary check, since
    check-with-upstream-qemu-1 already does a similar test with --version
    that will actually report an error to the user.

commit 27b995c8418657e7b371295ebcb26e985a7a1268
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Jan 30 16:48:43 2013 +0000

    Make internal-only functions and structures private
    
    Certain functions are intended to be internal only, but we currently
    export them anyway. This change moves them into a separate section of
    guestfs.h protected by a GUESTFS_PRIVATE variable. This change also
    enables private structs, but doesn't implement any.
    
    This change only affects the C api. Language bindings aren't affected,
    but probably should be in the future.

commit 1dd9bf73b792e88a8428f46a91dd2a3b35fe9571
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Jan 30 10:34:55 2013 +0000

    build: Fix haskell dependencies and parallel build
    
    Without this change all the tests in the haskell bindings are rebuilt
    every time. The primary motivation for this change is to fix this.
    
    The fix for the above also allows parallel builds to be re-enabled.

commit 63c50c7847575c0b1dd5ee0c9976153bd43612e7
Author: Matthew Booth <mbooth@redhat.com>
Date:   Tue Jan 29 15:23:46 2013 +0000

    build: Add common rule for sources shared between daemon and library

commit be4a3d77c42148731a977b68aab8b454372518d7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 29 10:19:12 2013 +0000

    daemon: hivex: Rewrite filename param of hivex_commit to include sysroot (RHBZ#905341).

commit 908c45567cd9a4d84e44470951eddc159135e6d0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 28 18:42:05 2013 +0000

    Version 1.21.6.

commit 950951c67de61da27dceca8ffb2079031c13e43b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 28 15:06:07 2013 +0000

    daemon: Use the new CLEANUP_* macros to simplify code.

commit 233055974d76f8aa93586c8b3bffe8e4f1068a85
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 28 15:05:23 2013 +0000

    daemon: Add CLEANUP_* macros which automatically free memory when leaving scope.
    
    cf commit 98b64650c852ccc9a8eef8b9691052faeb4873c8

commit 071de5ccfbb743f1b68da84f3264eddc2195e8d5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 28 15:04:11 2013 +0000

    daemon: Allow free_strings (NULL) and free_stringslen (NULL, ..).
    
    Equivalent to free (NULL).

commit 3a8a62c3e4ab466904aceb61cba67be14dd5e99d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 28 14:16:17 2013 +0000

    lib: Further use of CLEANUP_* macros.

commit cd3b626a3334e0c11058687acbeed6f9adc92394
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 25 15:54:40 2013 +0000

    launch: libvirt: Use CLEANUP_* macros.
    
    Also implement macros for cleaning up libxml2 objects.

commit 5a3da366268825b26b470cde35658b67c1d11cd4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 24 17:07:38 2013 +0000

    inspect: Use CLEANUP_* macros in inspection code.

commit 98b64650c852ccc9a8eef8b9691052faeb4873c8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 24 16:19:37 2013 +0000

    lib: Add CLEANUP_* macros which automatically free things when leaving scope.
    
    Use the macro like this to create temporary variables which are
    automatically cleaned up when the scope is exited:
    
      {
        CLEANUP_FREE char *foo = safe_strdup (bar);
        ...
        // no need to call free (foo)!
      }
    
    The following code is also valid.  The initialization of foo as 'NULL'
    prevents any chance of free being called on an uninitialized pointer.
    It may not be required in all cases.
    
      {
        CLEANUP_FREE char *foo = NULL;
        ...
        foo = safe_malloc (100);
        ...
        // no need to call free (foo)!
      }
    
    This is also valid:
    
      {
        CLEANUP_FREE char *foo = ..., *bar = ...;
        ...
        // no need to call free (foo) or free (bar)!
      }
    
    The CLEANUP_FREE_STRING_LIST macro calls guestfs___free_string_list
    on its argument.  The argument may be NULL.
    
    The CLEANUP_HASH_FREE macro calls hash_free on its argument.  The
    argument may be NULL.
    
    Important implementation note:
    ------------------------------
    
    On GCC and LLVM, this is implemented using __attribute__((cleanup(...))).
    
    There is no known way to implement this macro on other C compilers, so
    this construct will cause a resource leak.
    
    Important note about close/fclose:
    ----------------------------------
    
    We did NOT implement 'CLEANUP_CLOSE' or 'CLEANUP_FCLOSE' macros.  The
    reason is that I am not convinced that these can be used safely.  It
    would be OK to use these to collect file handles along failure paths,
    but you would still want a regular call to 'close'/'fclose' since you
    must test for errors, and so you end up having to do:
    
      if (close (fd) == -1) {
        // failure case
        // avoid double-close in cleanup handler:
        fd = -1;
        ...
      }
      // avoid double-close in cleanup handler:
      fd = -1;
      ...

commit acb85dafb1ee4c5cc84efd68b610ac743cad9852
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 25 12:39:28 2013 +0000

    Allow guestfs___free_string_list (NULL).
    
    Equivalent to free (NULL).

commit aab796c60873d169333babd4b77cc2642ea2ba48
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 28 13:08:56 2013 +0000

    perl, python, ruby: Add definition of EVENT_ALL in these languages.

commit 27c81f3175d0c287ec10b8279d768dd14abb49c9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 28 13:05:13 2013 +0000

    generator: Define all_events_bitmask.
    
    In the C bindings, use this more accurate mask instead of 'all bits
    set'.
    
    In the Java bindings, use this instead of open coding.

commit ded72a96f08b8563d7b1a114fb916b051c0040a3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 28 13:08:35 2013 +0000

    header: Minor whitespace fix.

commit f3976de591fbdbb238fe5326a606f9c2177977b2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 28 13:06:11 2013 +0000

    header: Deprecate LIBGUESTFS_HAVE_* in favour of GUESTFS_HAVE_*.

commit d3068a3afffdb7b1e33f3a9c39d3f4830baae3de
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 26 18:27:33 2013 +0000

    header: Link to guestfs-examples(3) man page from header file.

commit a0d874725d6e1eaee1bfc5337385b5910ab5cf1f
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Jan 24 14:58:15 2013 +0000

    Update vim line length to 70
    
    Apparently this makes it the same as emacs or something.

commit abb1d466364f74adfcf3c985b92673285fd32e44
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 24 13:09:16 2013 +0000

    python: Inherit from 'object' base class.
    
    This fixes the following Debian bug:
    http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=698771
    
    For an overview, see this question and the links from there:
    http://stackoverflow.com/questions/4015417/python-class-inherits-object

commit ec8939fd471d440305f666a36754510be8f011c7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 22 14:43:37 2013 +0000

    launch: libvirt: Add 'is_root' flag to the params struct.
    
    This is just code motion, but it allows us to read this flag inside
    the 'construct_libvirt_xml_seclabel' function in future (as a possible
    way to fix RHBZ#890291).

commit 085b86a95a9c6f740847039de1f0dd4c47c64bf1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 22 13:50:57 2013 +0000

    libvirt: Add debugging when opening libvirt handle.
    
    When debugging is enabled, this produces output like below.  This is
    useful when diagnosing what URI libguestfs is using.
    
    libguestfs: opening libvirt handle: URI = NULL, auth = virConnectAuthPtrDefault, flags = 0
    libguestfs: successfully opened libvirt handle: conn = 0xb05580

commit 875dc113646d586c5d8fa269ec18d54446a9b352
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 22 13:45:11 2013 +0000

    launch: libvirt: Refactor seclabel code.
    
    This is just code motion.

commit ed5a083891a51527ce2cde5117a6c14de888ac0c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 21 22:16:07 2013 +0000

    Version 1.21.5.

commit 4d8bdf035717b9dced3bc7fd45d74969758eb686
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 21 16:59:23 2013 +0000

    fuse: Use guestfs_rename to implement rename(2) syscall (RHBZ#895910).

commit 159e8f8c3a0e4df5c0a34c1693192a3679a47322
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 21 16:58:54 2013 +0000

    New API: rename: Rename file within the same filesystem (RHBZ#895910).

commit f956457b5d601ade045aeebdeefc5bf5a16a698e
Author: Matthew Booth <mbooth@redhat.com>
Date:   Mon Jan 21 15:57:23 2013 +0000

    docs: Fix cut/paste error in pread_device

commit 28e34290ff0dc11e9c5d8b8a1e5992cd0cc941fb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 21 14:30:32 2013 +0000

    fuse: If guestfs_last_errno returns 0, don't return no error to FUSE layer.
    
    guestfs_last_errno (g) == 0 doesn't mean "no error".  It means the
    errno was not captured.  In this case we have to substitute some sort
    of errno, so choose EINVAL arbitrarily.

commit 533082e28240522df51e6615d99794d726c8e1f0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 21 13:41:23 2013 +0000

    daemon: Change ln, ln-f (hard-link) APIs to use link(2) instead of external ln (RHBZ#895905).
    
    The reasons to do this are twofold:
    
    (a) It's probably a tiny bit faster.
    
    (b) It lets us capture the real errno if the link(2) syscall fails.
    
    The errno is also passed through guestmount, fixing RHBZ#895905:
    
    + guestmount -a test1.img -m /dev/sda1:/ -m /dev/sda2:/boot /tmp/mnt
    + touch /tmp/mnt/foo
    + cd /tmp/mnt
    + ln foo boot/foo
    ln: failed to create hard link ‘boot/foo’ => ‘foo’: Invalid cross-device link

commit ebc86ae6d76bab3e09484a039ddffcb323a106a3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 21 11:14:14 2013 +0000

    Fix checksums-out command (RHBZ#895904).
    
    This was broken by the earlier
    commit 0306c98d319d189281af3c15101c8d343e400f13.
    
    This commit also adds a regression test.

commit e18e20793f12745e96cc28eedd85e3118f8e20e7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 21 08:15:54 2013 +0000

    tests: virt-make-fs: Allow btrfs to be skipped.

commit 2974b5d66612e9cc6d948d4f8d4648510333aed9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 18 17:23:43 2013 +0000

    tests/qemu: Don't require LVM for these tests.

commit 64b229e8ffdf24ee4817a46d809a4919b4269049
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 18 08:18:24 2013 +0000

    Version 1.21.4.

commit d8f14591d10df847fad2e24f2f430b2543020912
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 18 07:11:13 2013 +0000

    daemon: lvm: Fix various paths relative to new lvm_system_dir.
    
    This fixes commit 9fd41abd40c3ffc10985e862dc34c868360a1b22.

commit 312d02afe46452c2fdf6c0a321a8dfbe7ae06631
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 18 07:12:23 2013 +0000

    tests: Don't construct the guests in parallel.
    
    In automake 1.13, check_DATA is now built in parallel, resulting in it
    trying to build 4 or 5 guests in parallel.

commit aa83e7c7b887f21f25685be163b763958983f2c2
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Thu Jan 17 23:59:22 2013 +0100

    Fix packagelist for current Debian-based systems

commit 111f444d69c766f465b68aa7e574cf83b5c7b1a1
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Thu Jan 17 23:59:21 2013 +0100

    inspector: Fix tests for out-of-tree builds

commit 9637bddc33d314cf7d9d4a63630de75b4e3b5dfd
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Thu Jan 17 23:59:20 2013 +0100

    erlang: fix bindtests for out-of-tree build

commit 24c4178749817639ecf9ad61f7de2b0f90f6ba3b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 18 06:42:13 2013 +0000

    appliance: Add libcap to the appliance (thanks Skippy VonDrake).

commit 2c68aca9d791414e011d31bfc09255158972599b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 17 18:21:20 2013 +0000

    automake: Force serial-tests.
    
    automake 1.13 started to use stupid parallel tests by default,
    breaking everything.

commit 9c8e47247b7958ac378542120d4fc8c22ef9ecf0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 17 18:10:14 2013 +0000

    FAQ: Document "Could not allocate dynamic translator buffer" and how to fix it.

commit c61b589f9b426b71d7498e9398c813bb47940a24
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Jan 4 12:54:18 2013 +0000

    gobject: Add pkg-config for gobject bindings

commit 9fd41abd40c3ffc10985e862dc34c868360a1b22
Author: Olaf Hering <olaf@aepfle.de>
Date:   Wed Jan 2 16:13:06 2013 +0100

    daemon: copy entire lvm directory
    
    cp will fail if /etc/lvm is an empty directory. Copy the entire
    directory and adjust environment variable.
    
    Signed-off-by: Olaf Hering <olaf@aepfle.de>
    
    RWMJ:
     - Fixed a couple of whitespace issues.

commit a710c42f0fa6d22664f21bcdcead83642da0d405
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 17 09:43:59 2013 +0000

    Version 1.21.3.

commit a0e9d310d1a2bd725c762a485f2b72761bac35df
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 16 14:28:10 2013 +0000

    ruby: Use updated package names, but allow fallback to the old names (RHBZ#894545).
    
    Thanks Dominic Cleal.

commit d4763a2e2480ebfc46285c7a67448df540c66b81
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 16 11:30:07 2013 +0000

    daemon: Suppress two false positives from Coverity.
    
    Using // coverity[...] or /* coverity[...] */ comments in the source
    it is possible to suppress specific Coverity errors.  The suppressed
    error should occur in the line following the comment.
    
    In this case I have suppressed two false positives from Coverity:
    
    (a) We deliberately assign to a NULL pointer in order to cause a
    segfault, for testing how the library reacts when this happens.
    Coverity flags this, but it is not an error in this case.
    
    (b) Coverity does not model global variables (a known shortcoming).
    Therefore the code 'errno = posix_memalign (...)' cannot be modelled
    by Coverity, even though the code is correct.  Coverity raises a false
    positive about this.
    
    (Thanks Kamil Dudka, Coverity)

commit ce828c6afcabee255e1f706292e92f76eb81c094
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 10 06:25:30 2013 +0900

    podwrapper: Refresh podwrapper man page.
    
    This also adds a rule so you can do:
    
     make podwrapper.1
    
    if you want to read the documentation as a man page.

commit 0d2d26d8e7edf16d51435f10b7f26f800b2c689b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 4 05:07:16 2013 +0900

    java: Implement the event API.

commit 3f08d50863dc9fe694c363e3c7e2b058fcd84ef5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 8 11:29:31 2013 +0900

    java: Use defined constants for flags in call to guestfs_create_flags.

commit 05a67bcc25cf50c487a4e4191cd50b688aeb48bd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 7 23:41:46 2013 +0900

    java: Change synopsis in man page to show use of add_drive.

commit 7d89baa3e9968e93f46c45ff0d9e07dd23753f17
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 7 06:46:09 2013 +0900

    java: Tidy up javadoc.

commit f58b6c5953151931b18f6671c9e67dd154816863
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 9 12:28:23 2013 +0900

    Refresh README file.

commit 20e23ab2a3aa7daad49d665792b1050bf8001249
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 4 12:33:48 2013 +0900

    Update copyright dates for 2013.
    
    On generated files in git and README.

commit e051b270a2ba68d1a22b705d7839317f643624c5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 29 14:28:47 2012 +0000

    haskell: Use unused bogus data types.

commit bff29314df40385fd5b05e1a53859a270ee9ce1c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 29 13:57:24 2012 +0000

    haskell: Typo in man page, lists -> list.

commit 60d744e32f64dbe8badadbd60d2b5e3d092ec8a2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 29 13:38:13 2012 +0000

    haskell: Implement 'head' and 'tail' by hiding the Prelude functions.

commit 406e372469df3a99d5290b28bc2a9964fbc33694
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 29 13:35:07 2012 +0000

    haskell: Use 'import Guestfs as G' in test code.
    
    The code is equivalent but shorter.

commit 67d59d015306f69da4dfff70d818f0f55855ed68
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 29 12:48:23 2012 +0000

    haskell: Document current state of Haskell bindings.

commit 1881be1e56f36caffeb7cb870bb6e3b9278a0135
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 29 13:13:17 2012 +0000

    haskell: Fix RHashtable in the generator.

commit 3a72944597d553f4d2ce9d2dd780c674907bf71f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 29 13:12:52 2012 +0000

    haskell: Use .NOTPARALLEL in this directory.

commit 7718cb5afe8f014d3ea517882f3a581cece823ed
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 28 21:34:28 2012 +0000

    haskell: Fix RStringList in generator.

commit 5ede0b21b08d74d424f9413668e3e50b9c7d7ee0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 28 20:44:36 2012 +0000

    haskell: Add tests of config functions.

commit c9e0ff8831eb478d99d2246c27aaa23c6b33b0ca
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 28 20:19:20 2012 +0000

    haskell: Allow non-appliance tests to run when !ENABLE_APPLIANCE.

commit 604f9a79dbf3cca4f273e0ba4e0356e884aa82c7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 28 20:17:31 2012 +0000

    haskell: Renumber tests according to Perl scheme.

commit 3e7dcc384a7d8f7295a001701b3b072c1be53ebf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 28 20:11:23 2012 +0000

    haskell: Enable RString, RConstString in generator.

commit beebade8740169dc03422df40571f9553bb8eb76
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 28 19:59:31 2012 +0000

    haskell: Enable RBool in generator.

commit 11e111ec01c8a4bbce2f648cd8fdc609f5e9861d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 28 19:55:01 2012 +0000

    haskell: Replace deprecated INCLUDE directive.
    
    The INCLUDE directive is obsolete.  You must now put the name of the
    include file before the C function name.

commit 9ae248e03f81f3f8173a3f822ae868dfa60f1e68
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 27 20:02:31 2012 +0000

    arm: Recomment vexpress-a15 instead of vexpress-a9.
    
    Neither works (because of lack of PCI) but A15 emulation is probably
    better than A9 emulation.

commit 6c9aaf394f078b924a46a5b2e4ab1b3576d17b72
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 27 20:01:15 2012 +0000

    launch: appliance: Fix parsing of QEMU_OPTIONS.
    
    If there was no quoting character, the options could run off the end
    of the string and into whatever string which happened to be following
    in memory.
    
    This bug was revealed when libguestfs was compiled on arm.

commit bcdaa463135d1904ec496aae7207abfb8bdb8e25
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 27 19:36:33 2012 +0000

    launch: appliance: Small refactoring of virtio-scsi detection code.
    
    This is just code motion.

commit a9d70d1ae463136e738d4ef4c56de1195b7f8e65
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 27 18:52:31 2012 +0000

    Fix whitespace in configure.ac.
    
    Standardize on 4 spaces for indentation in configure.ac file.
    This is just a change of whitespace.

commit 364ee94b8d1c4db4dc942a78e64cc72aa6455cae
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 27 18:05:40 2012 +0000

    arm: Prevent -Wcast-align warnings.
    
    See link below for a general description of the problem:
    
    https://github.com/libguestfs/hivex/commit/f8b62e4cd2f65cd712164c59094e81f2958aa000

commit 5af94b56924b6d0277fe0552f4b35ef83de5f88d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 27 15:56:51 2012 +0000

    arm: Only use -device sga if qemu supports this device.
    
    qemu-system-arm does not have the sgabios device.

commit 741c8606db504a2c1a7e7f0df9063a795604da74
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 27 15:27:16 2012 +0000

    lib: Remove useless cast.
    
    'strings' is declared as char **, so the return type of
    this expression will already be char *.  The cast is both
    useless and potentially hides errors.

commit 4a877452f5bf69b9b967f91eb9a527eb4328fd46
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 24 09:48:41 2012 +0000

    build: Fix ./configure --with-febootstrap-yum-config option.
    
    This fixes commit bfddae7ceefa4a419ff56848122a46c71c4d6a3c.
    
    Also tested that all variants actually work.

commit 4b5d27869f5754114d633d6eade5030f04830716
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 22 22:42:29 2012 +0000

    Version 1.21.2.

commit bfddae7ceefa4a419ff56848122a46c71c4d6a3c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 22 17:26:44 2012 +0000

    build: Change --with-febootstrap-yum-config to --with-febootstrap-packager-config
    
    For the rationale behind this renaming, see:
    https://github.com/libguestfs/febootstrap/commit/b8cbe191d0f03af1f6a42a07795995b16d5a8c24
    
    You can still, for the time being, use
    ./configure --with-febootstrap-yum-config
    but it's preferred to switch to the new option.  The new option is
    identical, just renamed.
    
    Qe still pass the deprecated --yum-config option to febootstrap
    itself, since both old and new febootstrap support this.

commit e73cf67762f7eb7b0850a74b9610c6e18b64352c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 20 15:33:12 2012 +0000

    inspection: Set fs->device field on swap devices.
    
    For some reason the fs->device field was not set for swap devices.
    
    Apparently this did not matter before (this bug has existed since at
    least libguestfs 1.16), but in commit 6ee80b8dac we started to depend
    on the fs->device field being non-NULL.  This resulted in segfaults
    when inspecting any guest which had a swap device, eg:
    
     #0  __strcmp_sse42 () at ../sysdeps/x86_64/multiarch/strcmp-sse42.S:164
     #1  0x00007ffff7d740cb in parent_device_already_probed (g=0x703a70,
                            partition=0x6f79b0 "/dev/vda4") at inspect.c:156
     #2  0x00007ffff7d73e00 in guestfs__inspect_os (g=0x703a70) at inspect.c:83
     #3  0x00007ffff7cee11d in guestfs_inspect_os (g=0x703a70) at actions-1.c:397
    
    This commit sets fs->device to the device name.
    
    (Thanks Matthew Booth for first noticing this problem.)

commit 6628cc7ef60bf61d718c76e668546970a0dfb411
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 20 12:09:49 2012 +0000

    Pass noapic on i686 kernel command line.
    
    qemu 1.2 i686 TCG is buggy and hangs when emulating APIC.
    https://bugzilla.redhat.com/show_bug.cgi?id=857026

commit eca01c3105fc8dc7b19883078facd0b121b6e2dc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 18 20:39:46 2012 +0000

    faq: Suggest 'approx' (apt proxy) to speed up Debian builds.
    
    Thanks Hilko Bengen.

commit d1ad89520e626c7fc03fb9627b8a054abd760a61
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 18 17:29:21 2012 +0000

    tests: Skip windows.img tests if it is zero-sized.
    
    If ntfs-3g is not installed, then tests/guests creates a 'windows.img'
    file which is zero-sized.
    
    This is problematical because other tests which use this image will
    fail at best, or hit RHBZ#847549 (qemu/virtio-scsi bug) at worst.
    
    Change the tests which use windows.img so they skip if 'windows.img'
    has zero size.

commit a34072e25b8504abdb65e0e80b05cffbe6fbd46e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 18 16:26:17 2012 +0000

    build: Add 'make print-subdirs' rule, useful for selectively running tests.
    
    If you want to selectively run tests, or if the test suite fails half
    way through, use:
    
      make print-subdirs
    
    to print the subdirectories, select the ones you want to run / the
    remaining ones, and do:
    
      make check SUBDIRS="..."

commit fa162417ed97218d528b8fa03cd22ad9ce788a56
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 18 11:51:42 2012 +0000

    daemon: Make gdisk into an optional dependency and optgroup.
    
    Also document that gdisk is a dependency at all.
    
    This fixes commit 956e30effa25eee00fb9e8f5303a6a1fe7409037.

commit 2434a86da42eb15205929b77765a0038f7d42a31
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 18 08:55:06 2012 +0000

    lua: tests: If $LUA is not set, set it to 'lua' instead of '/usr/bin/lua'.

commit 3f88f88c801fa8ede4d9555338a7b10f6ccb38f5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 18 08:53:34 2012 +0000

    lua: Fix misapplied patch.
    
    This fixes commit 5b70120293f3702f290fba5023a7016fa5ff1beb.

commit 8be9743e742d60c279d80a1d098d17d8a87851bc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 18 08:43:06 2012 +0000

    ruby: Disable -Wstrict-prototypes warning for Ruby headers.

commit 034d393bb13f54c4a471aace55ab7b1f62d2ff21
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 17 22:36:27 2012 +0000

    docs: Properly document attach methods in the guestfs(3) man page.

commit 62f98d64a51c8076d1a233cef8feeeaa9307a4dc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 17 23:01:11 2012 +0000

    lua: Fix Lua configure test on Fedora.
    
    On Debian, the lua pkg-config file is called "lua5.1.pc" (etc)
    whereas on Fedora it's called "lua.pc" for all versions.

commit 5b70120293f3702f290fba5023a7016fa5ff1beb
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Mon Dec 17 22:24:03 2012 +0100

    lua: Use correct binary for tests

commit f07e89c5f90a1cef8e61428f30916d39ab35541b
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Thu Dec 13 20:44:40 2012 +0100

    lua: Add ifdefs for Lua 5.2 compatibility

commit 05103cc6937b709192438eed8333aa1fbbb6af02
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Thu Dec 13 20:44:38 2012 +0100

    lua: Use pkg-config to determine Lua version, parameters

commit 8237ac89c5b51490f3f3c6f44d35ecaa184dca05
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 17 19:27:12 2012 +0000

    daemon: Use pvcreate --force option (RHBZ#887971).
    
    pvcreate fails if the partition contains a swap space signature.  Use
    more force to stop it from complaining.

commit 4ad6b28d83d0d91374fcc308d651d6b36ad88038
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 17 12:25:03 2012 +0000

    Version 1.21.1.

commit eab324bbbb6e38120f5882f7e0fadb86e322557c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 17 12:37:01 2012 +0000

    list-filesystems: Ignore MBR type 0x42 (Windows dynamic disks) (RHBZ#887520).

commit 6f02e33c6fbf2f14ba11ef07cb078ad6f6b2fea3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 17 12:24:29 2012 +0000

    sparsify: Document that virt-sparsify doesn't work well on multi-disk VMs.
    
    See: http://bugzilla.redhat.com/887826

commit 79339798b398eda0cb24f6f192af1a74c8956792
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 16 21:28:19 2012 +0000

    launch: libvirt: Improve loop invariant from previous commit.
    
    This fixes commit 11b6293d1bf7a6c0133c609e0e8067b4422dc794.

commit 11b6293d1bf7a6c0133c609e0e8067b4422dc794
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 16 20:56:39 2012 +0000

    launch: libvirt: Parse capabilities XML and fail early if qemu/KVM not supported (RHBZ#886915).

commit c4ad2c0ce3eea1fdb6e1123e8d5fcfed2d5a0849
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 16 18:35:31 2012 +0000

    daemon: Fold stdout on stderr when running e2fsck.
    
    User Phill Bandelow noted that virt-resize fails with an e2fsck error
    on a host where the system clock had been accidentally set in the
    past.
    
    Unfortunately this was hard to diagnose because guestfsd 'ate' the
    stdout of the e2fsck program.  I have verified by code inspection that
    e2fsck prints messages on stdout.
    
    Thus this changes the daemon to fold stdout and stderr together so we
    get to see all error messages from e2fsck when it fails.

commit 22fe98ad9f885dec1af04dd748d66c344e056032
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 15 20:20:15 2012 +0000

    build: Improve 'make help' output description of 'make extra-tests'.

commit eca2dd2e8c152ffe8a20960b0973bbd6527a051d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 15 20:15:12 2012 +0000

    build: Better formatting for 'make help' output.
    
    This is just whitespace changes.

commit 486efb002ae6a0011401fb6839a0823615f998e3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 15 20:10:25 2012 +0000

    build: Show 'make -k check' as a possibility in 'make help' output.
    
    Thanks to Cole Robinson for this suggestion.

commit 448a02373df95dafc0d4b3e4db0e77c96a09074d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 15 18:14:05 2012 +0000

    ruby: Enable C compiler warnings.
    
    This has the desirable side effect that the correct CFLAGS get passed
    to the C compiler when building the Ruby extension.

commit 1571aef9cc761ffa88da096fc09bd214f3e372c9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 15 18:06:11 2012 +0000

    python: Enable C compiler warnings.

commit 62e775c350edfddeafd829ca3edcdf3a8065eb00
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 15 17:19:53 2012 +0000

    Change the handling of private functions, safe_malloc etc.
    
    Rename guestfs_safe_malloc et al to guestfs___safe_malloc etc.
    
    To use the private functions, code now has to define
    -DGUESTFS_PRIVATE_FUNCTIONS=1.  This will make it easier for us in
    future to work out which programs are using these functions and to
    minimize both the number of programs and the functions they are
    calling.
    
    Note that the Perl, Python, OCaml, Ruby and Java bindings use
    guestfs_safe_* calls.  None of the other bindings do.  This is a bug
    (in the bindings using those functions): these functions will call the
    out of memory callback on failure.  This function defaults to abort(),
    and since this happens from a language binding, there is no way to
    change this default.

commit 27f6878e2af47f798062ae1a6571cdd13c9e5a88
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 15 17:03:11 2012 +0000

    guestfs.h: Fix use of __attribute__ and GCC < 4.
    
    I guess no one uses GCC 3 any more, because if they did, including
    <guestfs.h> would not work since GUESTFS_DLL_PUBLIC would not have
    been defined.
    
    At the same time, ensure that __attribute__((noreturn)) is only used
    when the compiler is GCC >= 3.1.

commit 95df8a7c0cedb0daf8f5318fbeb931f6a67e6286
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 14 21:54:13 2012 +0000

    inspection: Don't call guestfs_hivex_close if previous guestfs_hivex_open call failed.
    
    (Thanks Skippy VonDrake)

commit a9051eb98ea7c97899b98b6b493f0de45a05c17a
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Dec 14 14:01:08 2012 +0000

    daemon: Add sentinel attribute to commandf and commandrf
    
    Causes a compiler warning to be emitted if you omit the trailing NULL argument.

commit 956e30effa25eee00fb9e8f5303a6a1fe7409037
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Dec 14 15:53:27 2012 +0000

    Add support for getting and setting GPT partition type GUIDs
    
    New APIs:
      part_set_gpt_type
      part_get_gpt_type

commit 2aa731e7c441581f0d72bcd06e9431b92931466a
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Dec 13 15:22:39 2012 +0000

    daemon: Remove redundant fork in commandrvf
    
    Currently the code is doing a redundant fork when passed the
    COMMAND_FLAG_CHROOT_COPY_FILE_TO_STDIN flag. The additional
    sub-process does a chroot() which has no effect because all file
    handles are already open at that point, then simply copies its input
    to its output.
    
    This change simply replaces the above with a dup2 of the passed file
    handle to STDIN of the command process.
    
    RWMJ:
      Don't initialize 'pid' variable.

commit d7a806ca1af9d571b8e313b8247ac46ad6338346
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 13 17:53:36 2012 +0000

    configure: Change minor from .20 to .21 for new development branch.

commit e92f9666defd5db09812c1ebd59f9cc4a957475c
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Dec 13 15:22:38 2012 +0000

    daemon: NFC Use symbolic names in commandrvf
    
    Improve readability of commandrvf() by replacing bare int values for
    file descriptors with their symbolic names STD{IN,OUT,ERR}_FILENO.
    
    Also add PIPE_READ and PIPE_WRITE for referencing relevant ends of a pipe.

commit 52cd07a0ac50205da06c61b55e68feb6b0f1777d
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Dec 13 16:03:32 2012 +0000

    daemon: fix directory outside current root when executing commands
    
    When executing a command, we temporarily chroot, fork and exec the
    command, then chroot back. We intentionally don't chdir in the parent
    process so that we can 'jailbreak' the chroot later. However, this has
    the effect that commands are executed with a current working directory
    which is outside the current root.  This unusual state can cause
    errors in executed commands which don't anticipate it.
    
    This change does a chdir("/") before executing and command. This
    happens inside the fork, so the jailbreak isn't affected in the
    parent.

commit f784c8785980e0e1476f370b53722c42b4cf017f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 13 13:20:49 2012 +0000

    Version 1.20.0.

commit 25652a6d5c0e688a0b6a59548ecf2f30a5760da9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 13 11:47:14 2012 +0000

    proto: Free drives array when qemu subprocess dies abruptly.
    
    Commit ed7fda161e1f3d0beb02a368fcbcf5ed95dcdac1 changed the g->drives
    linked list into an array, and also made a subtle change to the
    (undocumented) semantics of drives in the rare case when qemu is
    relaunched.
    
    Every time we go back to the CONFIG state, we should free the drives
    array.  However there was one place where this was not happening.
    This was caught by the tests of the protocol, but only when using the
    default (appliance) method, not the libvirt method which we were more
    interested in testing in Fedora.
    
    When testing on Debian using the appliance method, we therefore hit
    this bug for the first time.
    
    This relates to or fixes the following commits:
      commit 9df159b34a9e41e6f36c5435869a54396b92a864
      commit 33f49d85c2a82e66f33cedccb2dbd14faa6070dd
      commit ed7fda161e1f3d0beb02a368fcbcf5ed95dcdac1

commit 585dd44e173b5141637ce89717ed0689f0c116e4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 13 11:45:36 2012 +0000

    debian: Allow test-disk-labels test to be skipped.

commit 14c7e9e52aaa87d5ef354abb5f4c7385ba5bb4c6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 13 10:46:22 2012 +0000

    launch: appliance: Disable virtio-scsi if qemu <= 1.1.
    
    Debian Wheezy (7) ships with old qemu 1.1 which claims to support
    virtio-scsi but in reality it's broken.
    
    Disable virtio-scsi in this case.

commit 9508b750fd4c85050acbc7f6735c54afb983f9aa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 13 10:38:45 2012 +0000

    launch: appliance: Parse qemu version.

commit c6558c75dd5fee111804a0ca175295ada5f6363f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 13 08:50:12 2012 +0000

    docs: Add website index.html.in to stable release documentation.

commit 5a293885a3ae8deb83bc0cce080420dec7aa511b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 12 17:36:26 2012 +0000

    release notes: Update bugs list because one more bug was fixed.

commit 903e4864c0c1776f38e0bf686117e4ac4c266287
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 11 22:55:27 2012 +0000

    Update gnulib to latest version for libguestfs 1.20 release.

commit 668683bd3dc3fb745b19b9f882b18200e190cdf5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 11 22:00:19 2012 +0000

    docs: Add gnulib update to stable release documentation.

commit 29cec9e2352143b5ddf841992010810ae327a31a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 11 21:55:58 2012 +0000

    build: Fix 'make help' output.
    
    check-valgrind-local-tests -> check-valgrind-local-guests

commit 1a70df0ba6f2e1c3d97b66a7b5dc55dc9742c1bb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 11 21:21:16 2012 +0000

    Update API support ready for libguestfs 1.20 release.

commit 858bd9ffe07207ab87fdd10e2a84930afb9068cb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 11 10:40:42 2012 +0000

    launch: libvirt: Label sockets with svirt_socket_t (RHBZ#853393).

commit 966ebadb1439fb102a11a6f84afa5851cce6d339
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 11 17:16:13 2012 +0000

    Update AUTHORS and BUGS files.

commit 436593f81fe55df503077bf5d425f54f3cef9036
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 11 17:15:49 2012 +0000

    Push and pull latest translations from Transifex.

commit 557b8c6a0d45f1c4974e28f5398ca1b0e6783c20
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 11 17:02:04 2012 +0000

    Update ROADMAP for libguestfs 1.20 release.

commit aeff59daa891f9d04526d47638c83147623ac4de
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 11 16:29:35 2012 +0000

    Update release notes and get ready for the libguestfs 1.20 release.

commit 0efe61b19d4156748912a9a480cd17a141e07575
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 6 13:42:36 2012 +0000

    Add support for Windows dynamic disks (libldm / ldmtool) (RHBZ#782167).
    
    New APIs:
    
      list-ldm-volumes
      list-ldm-partitions
      ldmtool-create-all
      ldmtool-remove-all
      ldmtool-scan
      ldmtool-scan-devices
      ldmtool-diskgroup-name
      ldmtool-diskgroup-volumes
      ldmtool-diskgroup-disks
      ldmtool-volume-type
      ldmtool-volume-hint
      ldmtool-volume-partitions

commit a93ea649594c8cac2226dea7da62e8ba2613a2ad
Author: Matthew Booth <mbooth@redhat.com>
Date:   Tue Dec 11 15:01:12 2012 +0000

    inspect: Remove unused is_mountable field from filesystem struct

commit 66ada9ed3142f8af84f007bf7b673d80c688b2c9
Author: Matthew Booth <mbooth@redhat.com>
Date:   Tue Dec 11 15:01:11 2012 +0000

    inspect: Remove unused is_swap field from filesystem struct

commit 4fd5b89e3689cd0bd7e85cba285bfc73e304643d
Author: Matthew Booth <mbooth@redhat.com>
Date:   Tue Dec 11 15:01:10 2012 +0000

    inspect: Remove unused content field from filesystem struct
    
    RWMJ: Don't remove entire if-clauses.

commit 91b3233e4a45c970424975260fce23d0a1655ca4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 10 19:58:30 2012 +0000

    docs: Copy-edit documentation of the private data area.

commit b554d7de82a14df4784c7ea6aaa6b2a58109742a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 10 17:23:41 2012 +0000

    guestfs-performance: Some copy-editing.

commit 7d2ae9f30f814116c0db8fecda1eb7d412e8ee58
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 10 16:18:39 2012 +0000

    daemon: Generate the code when libraries are statically not available.
    
    Since we as developers rarely test the case where some library is
    statically not available, that side of the code was hardly tested,
    except by unfortunate users in the field who often hit cases where
    functions were missing or misdeclared.  In fact, when making this
    change I noticed several bugs like that.
    
    Change it so that this code is autogenerated, and therefore always
    correct and up to date.
    
    Previous code which looked like this:
    
      int
      optgroup_acl_available (void)
      {
        return 0;
      }
    
      char * __attribute__((noreturn))
      do_acl_get_file (const char *path, const char *acltype)
      {
        abort ();
      }
    
      /* etc */
    
    is replaced by a single line:
    
      OPTGROUP_ACL_NOT_AVAILABLE

commit 5802b30ae5643517b1d29f21eca965c8de703e58
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 10 16:14:42 2012 +0000

    generator: Change optgroups so second element is a list of functions.
    
    Before this commit it was a list of function names (ie. strings)
    making it hard if you wanted to get back to the original function
    definition.

commit 2a2719d889d4d6cced40845a6d7c40c873ab5506
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 10 16:13:15 2012 +0000

    generate: Simplify generate_prototype ~single_line feature.
    
    This is just code refactoring.

commit 74763eafa7c92cd128689aacedce1d8e48f6dfd8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 10 15:49:48 2012 +0000

    daemon: Make sure *.h files have guards against double-inclusion.
    
    This is just code cleanup.

commit 82344085aa1c0cc19b34d6a1be351b4828486f8f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 10 13:07:07 2012 +0000

    erlang: Add more tests.
    
    Since I made lots of changes to the Erlang bindings (prompted by
    Coverity), I wasn't confident that something didn't break because
    there were no real tests before.

commit bc05e91f0ebacf1a59a3ad2c421fce17bac8f788
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 10 12:41:47 2012 +0000

    ./run: Add Erlang support to run script.

commit cac8c56423acf6d4345f05b9d32fd3910fab7b71
Author: Cole Robinson <crobinso@redhat.com>
Date:   Sat Dec 8 20:51:07 2012 -0500

    tests: Fix qemu-wrapper.sh generation

commit 6ab4d505f1afd1df6b96136b19f6e5a5eba1f02a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 8 16:27:46 2012 +0000

    launch: libvirt: Avoid double-close of console socket on error path (found by Coverity).

commit 98391ab9c68a04cbd922344d2d21c867b26eed9d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 8 16:25:09 2012 +0000

    xfs: Remove potential double-free of 'buf' in multiple places (found by Coverity).

commit ac6f94fb3ef571a20841906342357cfc22035c7e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 8 16:22:13 2012 +0000

    lua: Add comment about unsolved, hard to fix race (found by Coverity).

commit 0c6bc2f42fc1a362cdc6c9fdd5f5698f53b1bd28
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 8 16:03:27 2012 +0000

    erlang: Avoid unintentional sign extension (found by Coverity).
    
    Comment from Coverity:
    
      libguestfs-1.19.66/erlang/erl-guestfs-proto.c:115: sign_extension:
      Suspicious implicit sign extension: "buf[0]" with type "unsigned char"
      (8 bits, unsigned) is promoted in "(buf[0] << 24) | (buf[1] << 16) |
      (buf[2] << 8) | buf[3]" to type "int" (32 bits, signed), then
      sign-extended to type "unsigned long" (64 bits, unsigned).  If
      "(buf[0] << 24) | (buf[1] << 16) | (buf[2] << 8) | buf[3]" is greater
      than 0x7FFFFFFF, the upper bits of the result will all be 1.

commit 96e59eee66a474de95ed2fac5a975d8a3c254d1a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 8 15:50:05 2012 +0000

    lib: 'tmpfile' is never NULL (found by Coverity).

commit 359c8f89026b43ababc9026ba9385dbb75f96207
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 8 15:46:46 2012 +0000

    fish: Close 'sock' in remote control code (found by Coverity).

commit b18a1b4e66c9c3ba8bf5a7dd7af14d9e9eef248b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 8 15:42:26 2012 +0000

    md: Free up 'ret' along error path (found by Coverity).

commit a23d065c49dda1100cead9f719fd80808c5caabe
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 8 15:38:54 2012 +0000

    lib: Free up the right list if guestfs_internal_lstatlist returns an error (found by Coverity).
    
    We were freeing up a list, but not the right list.

commit 6d94de3f204bf01aa74cb06cfa796d54204dd08d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 8 15:32:14 2012 +0000

    fish: Don't leak stdout_saved_fd on error path (found by Coverity).

commit 855f023d2eb33fcc7ee072864b3682e7e674045e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 8 15:27:12 2012 +0000

    lua: Don't leak memory for returned objects (found by Coverity).

commit 9733665bc6bb88aa29e587bd66757044a21d5263
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 8 15:19:32 2012 +0000

    python: Don't leak memory along error paths (found by Coverity).

commit a1e37b7ea57ea39ee66f22663284999bb9602204
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 8 14:48:49 2012 +0000

    perl: Use safe_malloc instead of malloc (found by Coverity).

commit 3fe5f0a971e13733499ab1c947a0bf3940f4d0d8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 8 14:46:53 2012 +0000

    php: Return SUCCESS from PHP_MINIT_FUNCTION (found by Coverity).

commit 489cb059c28825ca50fcdaff2f97cd570748bbcc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 8 14:42:58 2012 +0000

    fish: Don't segfault here is 'words' happens to be NULL (found by Coverity).

commit 40bfce762962c25c986ca76bc6f0daac9a1906eb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 8 14:38:20 2012 +0000

    lib: Avoid segfault if guestfs_internal_readlinklist returns an error (found by Coverity).

commit 42e0cf77f3720600432f4d9e61526222b2c92062
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 8 13:44:57 2012 +0000

    inspect: Remove dead code (found by Coverity).

commit 9df159b34a9e41e6f36c5435869a54396b92a864
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 8 13:42:07 2012 +0000

    launch: appliance: Really add dummy appliance slot (found by Coverity).
    
    In the previous code, appliance was unconditionally set to NULL and so
    we never added the dummy appliance slot to g->drives.  This probably
    doesn't matter, since hotplugging doesn't work for the 'appliance'
    attach-method.  Despite that, it's better to get this right.
    
    This fixes commit ed7fda161e1f3d0beb02a368fcbcf5ed95dcdac1.

commit e9e5a0f94ec42c5600b7813806179ddac5c8667a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 8 13:36:04 2012 +0000

    daemon: Fix error checking in function (found by Coverity).

commit 7941f6785e409ad283b654ca26db9f919bf5f7c7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 8 13:30:14 2012 +0000

    fish: copy-out: Fail on some errors when creating output directory (found by Coverity).
    
    However it's not an error if the output directory already exists.

commit 15d5c94377d97bfd5462db52b060f8a9c06d4ea4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 8 13:28:11 2012 +0000

    daemon: Explicitly ignore return value from modprobe command (found by Coverity).

commit baf5a062243f39ccaf409301c260ed317250ff49
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 8 13:25:15 2012 +0000

    fish: Ignore failure of mkdir (noted by Coverity).

commit 091b98a9eaed6a447876c36f7d15f61641da60f7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 8 13:15:18 2012 +0000

    tmpdirs: Explicitly ignore return value from guestfs___cmd_run to keep Coverity happy.
    
    We don't care if this command fails.

commit aa785c85d9f5f21aff62287a315618b878f3039d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 8 13:12:17 2012 +0000

    lib: Explicitly ignore return value from guestfs_parse_environment in guestfs_create (found by Coverity).
    
    The purpose of adding guestfs_create_flags was so that users could
    check for errors from guestfs_parse_environment if they need to.

commit 59b51274ebfce54ac9d384c05dc8c54b393107c0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 8 13:09:29 2012 +0000

    Check for error from some guestfs_set_* calls (found by Coverity).
    
    For some guestfs_set_* calls, add checks for error, when error might
    possibly occur.  eg. It's plausible that guestfs_set_network might
    fail if the attach-method being used doesn't support it (although this
    doesn't happen at the moment).
    
    In other cases, don't check for errors, eg. if the error doesn't
    matter or there's nothing we could plausibly do about it.

commit 8331d46384bc718a793fd840b75b6ad8fba265ab
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 7 13:29:55 2012 +0000

    virt-rescue: Document a method to capture core dumps from within the rescue environment.

commit bb0de6938aec2764586b55a3da4728b74fc09de4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 7 12:33:18 2012 +0000

    daemon: Fix noreturn error in acl and capabilities code.
    
    This is an improvement over the original fix in
    commit fe4cdb2a477e88cd65d418aa3c3f12cb029f3dde.

commit f5e9e2780bbc128dbb4f6bebcce238561d9a2303
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 7 12:32:49 2012 +0000

    configure.ac: Fix comment.
    
    I spent a lot of time looking at how gnulib "manywarnings" works, and
    this comment reflects my improved understanding.

commit 47511ddbc93c1526a0991dfe1e0cf3c158ecd16e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 7 12:07:10 2012 +0000

    Add NOT_SUPPORTED macro to daemon and library.
    
    This convenience macro returns errno == ENOTSUP.

commit 77e9b1a9e869802fc72e8f1a4ce81d25c12fcfee
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 7 12:05:12 2012 +0000

    appliance: Add (default commented out) section containing debugging tools.

commit 52744cc232641580847d7239d163cf15298f8651
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 4 15:21:49 2012 +0000

    tests: charset: Fix broken Makefile.am escaping.
    
    This fixes commit 5a2e320ec9390b2146feea6d7b3b8c36a34d0a90.

commit 5a2e320ec9390b2146feea6d7b3b8c36a34d0a90
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 4 11:37:15 2012 +0000

    configure: Add --enable-code-profiling and --enable-code-coverage flags.
    
    These configure flags enable code profiling (with gprof) and code
    coverage (with gcov) respectively.
    
    Although this is a nice idea, it's not currently very useful.
    
    Libtool mangles filenames in such a way that gcov cannot locate its
    datafiles.
    
    Profiling is of dubious utility with libguestfs which is not CPU-bound
    and relies extensively on running external programs (oprofile-like
    system profiling that took into account libguestfs + qemu or
    libguestfs + qemu + the appliance + filesystem tools *would* be
    useful).
    
    Also neither flag will help in capturing data from the appliance.

commit f92b4a7d8358f4931f8eb85a8f159ae7dccd2bed
Author: Evaggelos Balaskas <ebalaskas@ebalaskas.gr>
Date:   Mon Dec 3 22:15:39 2012 +0000

    packagelist.in for archlinux
    
    latest archlinux has some small changes:
    
    btrfs-progs-unstable --> btrfs-progs
    genisoimage --> cdrkit
    iproute --> iproute2
    module-init-tools --> kmod
    procps --> procps-ng
    udev --> systemd
    util-linux-ng --> util-linux
    
    and could you plz add the below packages
    
    lrzip
    less
    sed
    
    RWMJ: I took this opportunity to make some general cleanups to the file:
    
    - add 'less' and 'sed' for everyone
    - 'module-init-tools' & 'kmod'[1]
    - 'procps' & 'procps-ng'[1]
    - 'util-linux' & 'util-linux-ng'[1]
    - sort the ArchLinux packages into order
    
    [1] Note that febootstrap is supposed to ignore packages it doesn't
    know about.

commit 57009f0136dd2188f4d0a44dfc32952999f79ae2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 3 18:45:59 2012 +0000

    build: Make 'check-valgrind' fail noisily if valgrind is not installed.
    
    The way the existing configure script worked, @VG@ would be empty, and
    it would run all the way through the check-valgrind rule successfully
    without actually running anything under valgrind.

commit 3cced0950cd3bdde6b3d862fdf88be4c7c81475f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 1 19:01:31 2012 +0000

    docs: Minor copyedits to the release notes.

commit e35045720bb48e4febdcd33d5f05820dda0da5f5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 1 14:56:25 2012 +0000

    Update release notes.

commit 443ea95faff78fe91fdf601cde81b72a4163b83c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 1 13:38:58 2012 +0000

    Version 1.19.66.

commit b57ab59b8e373fa26bf35378c8fb60fb6ee1a028
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 1 13:20:55 2012 +0000

    doc: Document problems with hibernated Windows guests and Windows 8 "fast startup" (RHBZ#882299).

commit 921b716b0b4079a61d1a68e814a3808852f5a318
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 1 11:45:55 2012 +0000

    test-tool: Parse the environment separately.
    
    This lets us report bugs when parsing the environment.

commit e8d6d6f737ec0dce73b34b3ff85943497883b6e0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 1 11:43:33 2012 +0000

    test-tool: Create the handle later.
    
    Although this leads to a small amount of code duplication with the -V
    option, the overall effect is cleaner.
    
    This is just code motion.

commit 6b5f9221b4fa5842c428e4258205c39295203127
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 1 11:33:23 2012 +0000

    tmpdirs: Make relative TMPDIR (etc) absolute, and check it's a directory (RHBZ#882417).
    
    This fixes commit 1efed122c07792f4c66a4083159cfacfb1893212.

commit 575895d8b062697fcdddc773fae0f55f5b50c6e8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 1 11:14:57 2012 +0000

    test-tool: Print tmpdir properly.
    
    It was actually printing cachedir.
    
    This fixes commit f9ab256f0e4c1197b505b0249e66e7614644bd0b.

commit 3d59ed5458575e417e704db58ede43a4e386014d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 1 09:27:40 2012 +0000

    inspection: Get icon for Windows 8 (RHBZ#801117).

commit c08fbc9cb490a5cfaea7ff344c20f7ffcdbf39e3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 1 09:09:56 2012 +0000

    contrib: Useful script to extract all logos/icons from a Windows guest.

commit 160977987f8e3922cebcdaaeb36fa69f92dc7587
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 30 23:00:33 2012 +0000

    inspection: Temporary logo for Windows 8.
    
    See the comment from the code:
    
      NB about Windows 8: No location we've found so far contains a
      suitable icon for Win8.  In particular, explorer.exe definitely
      does *not* contain any Windows logo as a resource (I checked).
      Therefore the "basket icon" that this produces is just a stand-in
      until we have a better idea for solving this problem.
    
    and:
    
      https://bugzilla.redhat.com/show_bug.cgi?id=801117

commit f5ae46dca79511cf2d4762ca4ef07b59bd647309
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 30 12:32:30 2012 +0000

    inspection, virt-sysprep: Use /etc/hostname on F18+, RHEL7+ (RHBZ#881953, RHBZ#858696).

commit fe4cdb2a477e88cd65d418aa3c3f12cb029f3dde
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 30 09:00:08 2012 +0000

    daemon: Avoid gcc warning about noreturn function in acl & cap code.
    
    acl.c: In function 'do_acl_get_file':
    acl.c:158:1: error: function might be candidate for attribute 'noreturn' [-Werror=suggest-attribute=noreturn]

commit a8f6e06b3008d626824d46921e29b524c03757a2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 29 19:39:57 2012 +0000

    Version 1.19.65.

commit 6ee80b8dac508927ff56ba6093bc47755f4880ae
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 29 17:24:30 2012 +0000

    inspection: Don't probe partitions when we've probed the whole device (RHBZ#798979).
    
    So we don't get multiple <operatingsystem> entries, particularly for
    install ISOs.

commit 90e7981082a2685b235724a6dd9b737cb90fe553
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 27 17:38:31 2012 +0000

    inspection: Read libosinfo database in order to inspect OS install CD/DVD/ISOs (RHBZ#803650, RHBZ#805417).

commit 31101db4c706ac0b8a32ee08f2ba19c0f33208f8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 29 16:53:55 2012 +0000

    lib: Indent CFLAGS in Makefile.am.
    
    This is just a whitespace change.

commit 56937996142ea880f0d5e79f1223004c9ae19a1c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 29 16:52:17 2012 +0000

    inspection: Move variable decls to top of function.
    
    This is just code motion.

commit fc6f34d5cd5cbba4f6a55f9ed8d108acaeeeb64a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 29 15:23:28 2012 +0000

    inspection: Implement "openbsd" type and distro.

commit 0e5eef87d0bdbd8690d9a6863a49bee4d6a198da
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 29 17:06:37 2012 +0000

    daemon: isoinfo: Fix parsing of bogus dates.
    
    eg:
    
    $ isoinfo --debug -d -i ubuntu-12.04-desktop-amd64.iso
    CD-ROM is in ISO 9660 format
    System id:
    Volume id: Ubuntu 12.04 LTS amd64
    Volume set id:
    Publisher id:
    [...]
    Creation Date:     2012 04 25 16:13:46.00
    Modification Date: 2012 04 25 16:13:46.00
    Expiration Date:                :  :  .
    Effective Date:                 :  :  .
    [...]

commit 380ce2eeaab5d37e5343aa2ba1fcde755ecefa23
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 29 11:44:50 2012 +0000

    fish: Make type == drv_N field private to guestfish.
    
    The -N option / drv_N type only makes sense when we are compiling
    guestfish, and just serves to complicate non-guestfish code.

commit 9e7daf2ee8f0a619440ca1c55dfe5ddcf61b4460
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 29 11:04:29 2012 +0000

    virt-df: Better output when multiple -a/-d options are specified (RHBZ#880801).
    
    This is very well explained in the bugzilla comments:
    https://bugzilla.redhat.com/show_bug.cgi?id=880801#c1
    
    With this change, the disk name has a one or more plus signs ('+')
    appended to show that there are additional disks:
    
      $ virt-df -a Win7x32TwoDisks-a -a Win7x32TwoDisks-b
      Filesystem                   1K-blocks    Used  Available  Use%
      Win7x32TwoDisks-a+:/dev/sda1    102396   24712      77684   25%
      Win7x32TwoDisks-a+:/dev/sda2  12478460 7403416    5075044   60%
      Win7x32TwoDisks-a+:/dev/sdb1    521212   55728     465484   11%

commit 6255cc834319715165386655014e7c2fb12adafc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 27 08:48:39 2012 +0000

    Add .mailmap to EXTRA_DIST.

commit 36232b0bbe5097454ead7aeb297886450b794462
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Tue Nov 27 16:40:22 2012 +0800

    Add the .mailmap and change the method to generate AUTHORS
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 567747f78e40cd3a18ebb4bfece864806fcdcd04
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 26 09:00:16 2012 +0000

    lib: lpj: Refactor code.
    
    Only run one grep command to grep any number of files.

commit 8243c0c6f66e50aab7593d34d090baae4cfa66db
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 26 08:58:26 2012 +0000

    lib: lpj: Only return first match in read_all function.
    
    If there where several lpj=.. matches then the earlier matches would
    be leaked.  Only return the first one and don't leak memory.

commit d2c75dd0ffc8c468880ad18d83167bbb183928b1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Nov 25 18:11:19 2012 +0000

    lib: Get lpj= from /var/log/boot.msg (thanks Olaf Hering).

commit d7517360f26cb27a2d4b06e2dc1b0a02968fe55e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 24 15:11:28 2012 +0000

    Version 1.19.64.

commit a4c0d7a82a906ed5213740227efc279d3e557165
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 24 14:17:35 2012 +0000

    launch: appliance: Handle non-\0 terminated buffer correctly.
    
    The read_all function is used as a callback for
    
      guestfs___cmd_set_stdout_callback (cmd, read_all, [str],
                                         CMD_STDOUT_FLAG_WHOLE_BUFFER);
    
    As noted in the documentation for CMD_STDOUT_FLAG_WHOLE_BUFFER, the
    buffer returned is not \0-terminated, and so using memdup will create
    an unterminated string, and therefore potentially a memory overrun
    when reading or searching the string.
    
    Use strndup instead so the final string is \0-terminated.

commit aeea803ad0fafe1ed4c7f8e781dfe4fdc150cac0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 24 13:50:27 2012 +0000

    appliance: Pass lpj=... on the appliance command line (thanks Marcelo Tosatti).
    
    Try to get the host's loops_per_jiffy value and pass this on the
    command line to the guest.  In theory this should avoid the appliance
    having to recalculate this value in a VM with TCG (which is generally
    error-prone).  This should avoid timing issues.
    
    We only do this when we are certain that the guest will be TCG.
    Currently we only have enough information to do this from the libvirt
    attach-method.  So mostly this will only affect people using Fedora in
    a VM.
    
    The host loops_per_jiffy value is not exported by the kernel.  It is
    only printed by the kernel early during boot, so if boot messages have
    "scrolled off" the kernel ring buffer, it won't be available.  Some
    operating systems save early kernel messages in /var/log/dmesg but (a)
    Fedora 18+ seem to have abandoned this file and (b) on Ubuntu this
    file is unreadable for spurious "security" reasons.
    
    I have submitted a patch to make lpj available through /proc/cpuinfo.

commit 62895440bc13abe1bc7dbccf9f8b412f16d16a7d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 24 12:51:11 2012 +0000

    launch: libvirt: Refactor parameter passing to construct_libvirt_xml* functions.
    
    This is just code motion.

commit e987c038ead0a2398f13727ab1de518a216a1d50
Author: Olaf Hering <olaf@aepfle.de>
Date:   Fri Nov 23 20:20:13 2012 +0100

    lua: fix build error due to LUA_GLOBALSINDEX usage
    
    lua 5.2 changed API, LUA_GLOBALSINDEX is no longer available.
    http://www.lua.org/manual/5.2/manual.html#8.3
    
    Signed-off-by: Olaf Hering <olaf@aepfle.de>

commit 12acff5f56f5dbd85840d8f7c570f23ff122a7a1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 23 17:33:00 2012 +0000

    Version 1.19.63.

commit 1ef9af9acbd4cfaadb3f96e0e1a5e519fad2da9d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 23 17:17:57 2012 +0000

    daemon: Ignore lvresize error "New size..matches existing size" (RHBZ#834712).
    
    The lvresize command unnecessarily gives an error if you don't
    change the size of the LV.  Suppress this error.

commit dd4038c8a4f7f1326f0399ea83f48c22a3ce6c2a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 23 14:50:54 2012 +0000

    test-tool: Don't print banner when using --help, -V, etc options (RHBZ#879416).

commit 2272cccfd4d78c37ae7fa16369a9893f29533a1a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 23 12:30:21 2012 +0000

    launch: Refactor duplicate code which constructs the appliance command line.
    
    Move this into a common file.

commit a6a0b9ba164f68dd79782f054604102017bc9c15
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 23 12:12:33 2012 +0000

    lib: Fix memory leak and simplify command code.
    
    Fix the following memory leak found by valgrind:
    
    ==13629== 498 (112 direct, 386 indirect) bytes in 1 blocks are definitely lost in loss record 99 of 110
    ==13629==    at 0x4A06B2F: calloc (vg_replace_malloc.c:593)
    ==13629==    by 0x4CA564E: guestfs_safe_calloc (alloc.c:71)
    ==13629==    by 0x4CA9B02: guestfs___new_command (command.c:143)
    ==13629==    by 0x4CA66E9: guestfs___build_appliance (appliance.c:690)
    ==13629==    by 0x4CBD1B9: launch_libvirt (launch-libvirt.c:188)
    ==13629==    by 0x402E7E: main (virt-filesystems.c:349)
    
    Also adjust the command code in several places to make it simpler.  We
    can almost always call guestfs___cmd_close right after
    guestfs___cmd_run, avoiding any need to close the handle along error
    paths.
    
    Tested by running the test suite under valgrind.

commit fae8d7cafb66e0da697cde71f7e9444165c76ff7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 22 14:49:54 2012 +0000

    New APIs: Implement Linux filesystem capabilities.
    
    This adds the following new APIs:
     - cap_get_file
     - cap_set_file

commit 218b39acae324955b089dcfc191b0270b6bafb62
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 22 14:49:54 2012 +0000

    New APIs: Implement POSIX ACLs.
    
    This adds the following new APIs:
     - acl_get_file
     - acl_set_file
     - acl_delete_def_file

commit 784e53287e18c324dda9c4cc93b9aae4790eb909
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 22 09:54:48 2012 +0000

    fish: Fix test-remote-events test.
    
    Because the shell script was missing a space, the final output test
    was failing, although for some reason this didn't cause the whole test
    to fail.
    
    Fixing the missing space also revealed a bug in the test output, which
    is also fixed.

commit 9fb5a3ceaffd88aaf37b5253e540626457319d24
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Wed Nov 21 17:50:58 2012 +0800

    sysprep: remove crash data generated by kexec-tools
    
    Remove the kdump generated kernel crash data.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>
    
    RWMJ:
     - Added /var/log/dump/* path for SLES (thanks Olaf Hering).
     - Update po/POTFILES-ml.

commit 30f202da4388a801fbe17314fd22fcf04431d10f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 20 19:53:18 2012 +0000

    Update API support.

commit 8ae8f1453b1efe69d3f14fcd5eef5b8982104e78
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 20 19:51:45 2012 +0000

    Update PO files from transifex.

commit 20d524f4faad274f06131770096a4321d79c217b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 20 18:31:55 2012 +0000

    Version 1.19.62.

commit d0f89fed85d7f6c07a4d76d2e11f3a6812b63dd4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 20 18:40:15 2012 +0000

    ./run: Ensure all paths are built up cumulatively.

commit 12905a9bbbfc5a39401bfd3b629ac96b9ce93f3e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 20 18:31:45 2012 +0000

    lua: valgrinding Lua code doesn't work.
    
    See comment.

commit 1e321b883b8c7f5b7c072e869db26f5a1a0a152e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 20 18:31:16 2012 +0000

    valgrind: Ignore init_libguestfs symbol.
    
    It's not relevant, since the memory leak begins in libvirt.

commit 0ff561f3324df2841c90e65fb994294d2ddcfca0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 20 17:34:23 2012 +0000

    lua: Replace internal lua_guestfs_* functions with guestfs_lua_*.
    
    This is just code motion.  It just ensures there is no possible
    conflict with lua_* symbols.

commit 1f984509952865632f434b4349f679a2e4a42935
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 20 17:32:37 2012 +0000

    lua: Attach __tostring functions exceptions.
    
    This includes a test.

commit 4749bff379862205dfa6c6ff94984711894c9eb0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 20 16:42:40 2012 +0000

    lua: Fix whitespace.

commit ca488a6d7b6f5701b63249d5a0c73eada09c432c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 20 16:20:12 2012 +0000

    lua: Various fixes to the bindings (thanks Jerome Vuarand).
    
    See http://article.gmane.org/gmane.comp.lang.lua.general/95065
    
    Note that this is incompatible with existing code.  You
    have to do:
    
      local G = require "guestfs"
      local g = G.create ()
    
    ie. give the module your own name ("G" in that example).

commit 8f80f9fdae13a320da978dffa2c9d94e7b68a810
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 20 14:23:35 2012 +0000

    lua: Print the error thrown by callbacks.

commit efb2d07ad642bd227e40ed917332f64f82b2553d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 20 14:15:45 2012 +0000

    lua: Add comment (not fix) for incorrect 'g' argument in callbacks.
    
    Thanks Jerome Vuarand.

commit 7f1f7dd44f4b85c1ce027b2ed194d388518ff452
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 20 13:56:06 2012 +0000

    lua: Add bindtests.

commit b19f007bd2449f635780078e61a174f19838b32d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 20 14:11:34 2012 +0000

    lua: Use lua_rawgeti to read elements from lists of strings.
    
    This is faster, but more importantly it avoids the strange error
    'lua: attempt to index a string value' which appears with (some)
    single element lists.

commit 69c5f3045a7a25ef62f65b47a79c60e3de77fee0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 20 13:55:46 2012 +0000

    lua: Add LuaStyle of commenting to the generator.

commit 74105fdab11385c85d634f5d3ffe3acd165406a4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 20 13:39:38 2012 +0000

    lua: Allow regular int to be passed as a 64 bit integer.

commit 3454cfb73c74b4fd3fba9d834c13685b166d9d3f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 19 15:43:52 2012 +0000

    daemon: wipefs: Use --force option if available.
    
    See https://bugzilla.redhat.com/show_bug.cgi?id=872831
    and https://bugzilla.redhat.com/show_bug.cgi?id=865961

commit b5b475ab827b862cce07ab095e4cb8b4ab1a954a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 20 09:10:15 2012 +0000

    lua: Simplify get_event function.
    
    Use luaL_checkoption which is designed for this purpose.

commit fdfdc883fcac8c8d7e4e9a86572d941421b5ff87
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 19 18:19:29 2012 +0000

    lua: Document Guestfs.event_all.

commit e866ee7c792ab3c5a25737e27038a718b0c5a995
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 19 18:16:08 2012 +0000

    erlang, lua: Fix links in man pages.

commit 556fc92e8adc6c10e1608dafaca89d9cac581fb7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 19 17:13:14 2012 +0000

    lua: Test globals in Guestfs.* namespace.

commit bc03a48c7132c75072003fcdd54930db3b70721e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 19 17:06:21 2012 +0000

    lua: Add global Guestfs.event_all (list of all events).

commit 36e71e0cf45b5515d8447d959d9a1642223f2dc7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 19 14:46:59 2012 +0000

    Version 1.19.61.

commit f77ddb9e114e560724d6548499047ae6894ab59c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 19 13:00:52 2012 +0000

    lua: Various fixes and enhancements:
    
    - add support for events (with test)
    - test progress messages
    - update documentation to describe events
    - refactor handle closing code
    - refactor error code
    - use 'assert' in test code instead of 'if ... then error end'

commit d14557d434de5cb1c9754ae0f3e8e820e0a46694
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 19 09:39:30 2012 +0000

    perl: Add test of multiple independent handles.

commit 6e5916e0f4da885b61350e1edc96e6173a5ea324
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Nov 18 19:24:20 2012 +0000

    lua: examples: Boolean true shouldn't have quotes around it.

commit 6483c506b91d0093af96f361d6756853fac26972
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Nov 18 16:45:44 2012 +0000

    lua: Add another test to prove that the handles are really independent.

commit 6710296b7a597b0741b0559f2cefc3997986de40
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Nov 18 16:45:08 2012 +0000

    lua: Don't use %m since Lua string formatter doesn't understand it.
    
    Use %s + strerror as a replacement.

commit 4ba8b5a00d7336e87e15a854b0534c630f456f7c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 17 21:17:44 2012 +0000

    lua: Add some missing features.
    
    - Remove default error handler.
    - User cancel.
    - Add the errno to the object which is thrown on error.
    
    Still no events.

commit a9c4efdcfd213202c9c9b478e92fe908a700b957
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 17 20:02:25 2012 +0000

    Version 1.19.60.

commit ff8bfd3e92f21955d0a91b481583131f356b8fe4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 17 10:10:13 2012 +0000

    Add Lua bindings.
    
    These are relatively complete, although only lightly tested.  Missing:
    
     - events
     - last_errno
     - user_cancel

commit 4a2e8e89577ad4031aba1b2e5afb65ca58c2c39d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 17 18:14:05 2012 +0000

    perl: Clean up and update the tests.

commit 3d0e937b84b4d028d80b66afb960903b7bc10b97
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 17 17:55:00 2012 +0000

    perl: Small test of create with flags.

commit 43369e1bd4d98acf1cce6eb0216dcdb43d43bf1b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 15 16:37:23 2012 +0000

    sparsify: Better error when user specifies --compress + raw output (RHBZ#852194).

commit 2f321ced219eeff9a2df305fd8a621c03875893f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 15 15:35:25 2012 +0000

    todo: We must implement ACLs and filesystem capabilities for SCAP.
    
    Thanks Steve Grubb.

commit a41629deb965830788d6b531272a0a20767e2ce6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 15 10:08:21 2012 +0000

    daemon: Perform device name translation on mke2fs journaldevice (RHBZ#876579).
    
    Also various fixes:
    
     - remove fixed-size buffer
     - change if (err) free (err) -> free (err).

commit 5d9f10c31297c5f6bfe261717dfc5c841722a4c2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 15 09:01:15 2012 +0000

    recipes: Add sections about hexdumping, hexediting sectors.

commit fd81d3f9b25f9ee8616091c9c3abb7373e185015
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 14 22:34:06 2012 +0000

    recipes: Add recipe for diffing two guests.

commit 5638cd3024f7d891be098ce7f9962213e49b9270
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 13 14:42:49 2012 +0000

    Version 1.19.59.

commit e8ad3efbc4e91e4a48654d65981f5906b462fb96
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 13 15:21:42 2012 +0000

    dist: Add miscellaneous files to the tarball.
    
    Lots of these had been omitted over time.

commit 2d89aef897e633bffba1dffd600b122eacd88fc8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 13 15:19:53 2012 +0000

    tests/protocol: Add test-qemudir-launchfail.sh to tarball (but don't run it).
    
    This file was present in git, but missing from the tarball.
    
    Don't actually run the test: it depends on details of how the
    appliance is constructed which would fail for old-style appliances.

commit 715afda3416080ef9ee961f3ebcff7ef16cfc986
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 13 15:16:49 2012 +0000

    fish: Add test for remote events.
    
    This test was present in git, but not included in the tarball,
    nor in the tests that guestfish actually runs.
    
    This fixes commit 17182af3a6de8e3e94e0a914416c54f09bb74007.

commit 5c44c691f2c288e04571b54c1b6844402f9865e4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 13 14:31:01 2012 +0000

    tests: Add a parallel launch test.
    
    This is designed to reveal libvirt race conditions such as
    bug 875741.
    
    This is a "slow test" so it only runs if you do 'make check-slow'.

commit ee5f18293b72779ea7387414cca5cd8c35230fc8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 13 13:46:47 2012 +0000

    tests: Add 'make check-slow' rule to recursively run slow/long-running tests.

commit cb4284b9e331c5c27351dadf8fe776f137eff318
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 13 12:53:40 2012 +0000

    Add 'make help' rule.
    
    This gives a short overview of the make targets.

commit 3636c5fcff69e7a5a5afa126a597883db4c781bb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 12 17:54:31 2012 +0000

    tests: Replace 'make extra-tests' with individual tests.
    
    'make extra-tests' was a monolithic set of tests that did all sorts of
    things: valgrind, tests over local guests, tests with upstream qemu,
    tests with upstream libvirt, tests with the appliance attach method.
    
    This made it hard to perform individual tests, eg. just valgrind
    testing.  It was also hard to maintain because the tests were not
    located in the same directories as the programs and sometimes
    duplicated tests that were run elsewhere.
    
    This commit splits up 'make extra-tests' into 5 separate targets:
    
     make check-valgrind              # run a subset of tests under valgrind
     make check-valgrind-local-guests # test under valgrind with local guests
     make check-with-appliance        # test with attach-method == appliance
     make check-with-upstream-qemu    # test with an alternate/upstream qemu
     make check-with-upstream-libvirt # test with an alternate/upstream libvirt
    
    (You can also still run 'make extra-tests' which is now simply
    a rule that runs the above 5 targets in order).
    
    This replaces everything that was in the tests/extra directory,
    so that has now gone.

commit c4a3ea066be9823d4572b57fd05940345904b826
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 13 09:01:53 2012 +0000

    extra-tests: Add $(libvirt_ro_uri) substitution to configure.
    
    This is essentially just code motion.

commit 765d14dc0551b2c05d6a846aa6701055b080180c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 12 18:13:37 2012 +0000

    Define whole valgrind command (as @VG@) in the configure script.
    
    This is mostly just code motion, but it also changes the default
    location where valgrind.log is written to be the top build directory
    (instead of tests/extra/valgrind.log).

commit ab360c48d4bf6ddb3f14c0f2434e235dfea3a184
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 12 20:10:55 2012 +0000

    align: Add a test for virt-alignment-scan.

commit ac2ddfd90a7f5f424b19fbfbfb06d4dfff0547fa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 12 18:46:13 2012 +0000

    fish: Add simple tests of starting up, inspection, using the prepared disks.

commit 73631705cfdad72ed4ae8446757dd41c341800dd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 12 18:26:48 2012 +0000

    inspector: Add some real virt-inspector tests.

commit e884abfd06f3f06eab3f8db9843367ab62f7e9e9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 12 15:06:44 2012 +0000

    extra-tests: Move valgrind suppressions file to top source directory.
    
    This is just code motion.

commit b2663be064dd369d96259d2bc2ed54ffe616e595
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 12 13:39:03 2012 +0000

    Various fixes to API support script.
    
    Remove internal structures, fix it so it works with the new
    code layout under src/

commit 02ecd048d3caf7804361bb0f5dca071f97aefaa1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 12 12:56:39 2012 +0000

    lib: Split up huge src/guestfs.c into logical compilation units.
    
    This file had grown by accretion to include:
    
     - code related to handles (now in src/handle.c)
    
     - safe allocation (src/alloc.c)
    
     - debug, errors, warnings (src/errors.c)
    
     - private data (src/private-data.c)
    
     - miscellaneous functions (src/canonical-name.c, src/utils.c)
    
    This commit also removes about a dozen #include files which were
    probably not really used.
    
    This is just code motion.

commit f9ab256f0e4c1197b505b0249e66e7614644bd0b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 10 22:03:25 2012 +0000

    test-tool: Print cachedir and tmpdir.
    
    This fixes commit 1efed122c07792f4c66a4083159cfacfb1893212.

commit 2c9e532566f58d8aca362fdc150bd88d291c396d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 10 14:03:57 2012 +0000

    Update release notes.

commit 17090bd09f25c490bce9a5159d54bcabb7a8ecc2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 10 11:25:26 2012 +0000

    Version 1.19.58.

commit fcf8032cbda2d09c21f31141df8ccc193e13263b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 10 08:55:38 2012 +0000

    lib: Fix memory leak in tmpdir/cachedir code (found by valgrind).
    
    This fixes commit 1efed122c07792f4c66a4083159cfacfb1893212.

commit 99377e27486a8704c5b5171cf1ce83e2b6702c1e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 9 22:38:41 2012 +0000

    tests: Remove double-test for availability.
    
    If you have a function which is in the X optgroup, and also has
    IfAvailable X, then two tests for the optgroup are added to the
    output.
    
    Check for this case and give an error.
    
    This also fixes existing APIs.

commit a74f1681686e534e9c1883e26278cf7e0b74da07
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 9 20:44:12 2012 +0000

    tests: More efficient use of strings in the object code.
    
    No functional change.

commit a270faefefe37752de12622bd072c32ea6042e78
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 9 20:33:24 2012 +0000

    tests: Use guestfs_{push,pop}_error_handler.
    
    Replace the custom error handler with calls to
    guestfs_{push,pop}_error_handler only where necessary.  This
    simplifies the generated code.

commit 2deb235cf4d30e715507f02b02a0391e1d0c3ee9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 9 20:26:05 2012 +0000

    tests: Cleanup code that prints each test name.
    
    This is just code motion.

commit 56c7967cadbd87ca922e02355f142f70744c1330
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 9 20:19:30 2012 +0000

    tests: Change code for printing warnings about untested functions.
    
    Just code cleanup, no functional change.

commit 04a8cffee7d93bd7fc82f7cf9ef16db75933a273
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 9 20:19:08 2012 +0000

    tests: Remove dead code in generated output.

commit 599a1930b0778fb93dcbb4bd679f9263fe650683
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 9 20:18:54 2012 +0000

    tests: Format the generated code properly.
    
    This is just whitespace changes in the output.

commit 25ff0db3b48ef31e90ea3bfe79f435272536aa95
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 9 19:50:13 2012 +0000

    fuse: Use guestfs_{push,pop}_error_handler so we can see errors in shutdown.
    
    In the fork (usual) case, we still won't see any errors since stderr
    has been redirected to /dev/null, but this way is still a little more
    correct.

commit 2d220f5da2cd25e0fda0c98b98ecb384c1fe5c47
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 9 18:03:49 2012 +0100

    tools: Modify existing tools to use guestfs_{push,pop}_error_handler.
    
    This is a shorter and more convenient way to disable errors
    temporarily across calls.

commit b460d9f32eb527bc7aad4894a5f85c4e69366104
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 9 18:47:57 2012 +0100

    lib: Modify library code to use guestfs_{push,pop}_error_handler.
    
    This is less efficient than directly manipulating g->error_cb, but
    easier to maintain.

commit a3b6751863b4e7e620dd1b75b4a8d8187d2069a5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 9 17:47:07 2012 +0100

    lib: Add new C API calls: guestfs_push_error_handler,
    guestfs_pop_error_handler.
    
    The addition of these calls makes it much simpler to temporarily
    disable or ignore errors:
    
     guestfs_push_error_handler (g, NULL, NULL);
     guestfs_mkdir (g, "/foo"); /* We don't care if this fails. */
     guestfs_pop_error_handler (g);
    
    Note these calls are used by the C API only.  They are not necessary
    in other languages, because those map errors to exceptions.
    
    The subsequent commits change existing code to use push/pop instead of
    laboriously saving and restoring the error handler.

commit 2013e005bd02f5706887c8861f10410ffd82084f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 9 18:41:31 2012 +0100

    lib: Break long line in definition of guestfs_set_error_handler.
    
    This is just a whitespace change.

commit 692701f382f8a1c51be0b798b918f2f34e401b54
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 9 18:57:29 2012 +0100

    examples: Copy-editing instructions printed by the mount-local program.

commit dedf10aaa928b16ba27f0756b3d356f65d57c648
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 9 17:15:50 2012 +0100

    header: Define LIBGUESTFS_HAVE_CREATE_FLAGS=1.
    
    This fixes commit 9466060201600db47016133d80af22eb38091a49.

commit 1586bbb9517f31ba493dc8e909d732bc6e04310e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 9 13:34:45 2012 +0000

    fish: Update documentation for environment variables.
    
    This fixes commit 1efed122c07792f4c66a4083159cfacfb1893212.

commit 1efed122c07792f4c66a4083159cfacfb1893212
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 8 11:36:35 2012 +0000

    lib: Rework temporary and cache directory code.
    New APIs: set-tmpdir, get-tmpdir, set-cachedir, get-cachedir.
    
    The current code has evolved over time and has a number of problems:
    
    (a) A single environment variable ($TMPDIR) controls the
    location of several directories.
    
    (b) It's hard for the library user to predict which directory
    libguestfs will use, unless the user simulates the same internal steps
    that libguestfs performs.
    
    This commit fixes these issues.
    
    (a) Now three environment variables control the location of all small
    temporary files, and the appliance cache:
    
      For temporary files: $LIBGUESTFS_TMPDIR or $TMPDIR or /tmp.
    
      For the appliance cache: $LIBGUESTFS_CACHEDIR or $TMPDIR or /var/tmp.
    
    The user can also set these directories explicitly through API calls
    (guestfs_set_tmpdir and guestfs_set_cachedir).
    
    (b) The user can also retrieve the actual directories that libguestfs
    will use, by calling guestfs_get_tmpdir and guestfs_get_cachedir.
    These functions are also used internally.
    
    This commit also:
    
     - reworks the internal tmpdir code
    
     - removes the internal (undocumented) guestfs_tmpdir call (replacing
       it with calls to the documented guestfs_get_tmpdir API instead)
    
     - changes the ./run script to set LIBGUESTFS_TMPDIR and
       LIBGUESTFS_CACHEDIR
    
     - adds a test
    
     - fixes a few places like libguestfs-make-fixed-appliance which
       depended on $TMPDIR

commit e8d937bd739a70394ec72482a8cb1df3b0601dcc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 8 12:49:11 2012 +0100

    lib: When parsing environment, handle LIBGUESTFS_TRACE first.
    
    So that we can trace all the later calls.

commit ebe5ca7771f78a7b0649a209b9aed6be4f5726e0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 7 20:29:59 2012 +0000

    Version 1.19.57.

commit 101fd44fc5ce3055da91a5bf8aa0d89a5d2f3a79
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 6 13:05:15 2012 +0000

    format: Allow virt-format test to be skipped by setting SKIP_TEST_VIRT_FORMAT_SH=1.

commit 3b06bee2fbba75dfdd0cdf2a705f8761bed08ca0
Author: John Eckersberg <jeckersb@redhat.com>
Date:   Mon Nov 5 10:16:36 2012 -0500

    lib: debian support for package arch inspection

commit 6ac943fbef4fa8386da456048f856a387f941fc2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 3 10:10:12 2012 +0000

    tests: wipefs: Don't try to wipe mounted filesystem.
    
    Previously wipefs (the utility) allowed this, but it's obviously a bad
    thing to do and the new wipefs gives an error if you try it:
    
    wipefs: error: /dev/VG/LV: probing initialization failed: Device or resource busy

commit 4bd61ed32213e1f243d6df9ff17edd85dc5e5eb1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 2 22:14:49 2012 +0000

    fish: Fix documentation quit | exit -> separate exit & quit headings.

commit 4f6060b9d9058cee60d5c732706b64366b473fae
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 2 22:13:22 2012 +0000

    fish: Clean up prompt documentation.

commit 46449f6894cddf2bc954ac91c489f72238ce9a84
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 2 22:05:29 2012 +0000

    fish: Use Unicode LOWER ONE QUARTER BLOCK to represent cursor.
    
    'ls' (with no argument) is not a valid command.
    
    This fixes commit bad5c7d5a50e7f340d3a5daff59d7f3c18c0ab8f.

commit 6c539fa0a6fe88cd7184b01259219b5eb5330cfd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 2 14:45:11 2012 +0000

    Version 1.19.56.

commit 9a1a0c67ac6cb4e13d361c116e5e70dfc22d9c17
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 2 12:08:38 2012 +0000

    generator: Split up huge src/actions.c into separate files.
    
    Split the functions according to a simple hash across
    C.nr_actions_files files (this number can be increased later if
    necessary).
    
    This is just code motion.

commit 58720cc968366894366a430842b4bc5151b5f7fd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 2 11:59:25 2012 +0000

    generator: actions: Move variant functions to a separate file.
    
    This is just code motion.

commit 6f34b81321ad61adb2c22655ec68c57febbbe80b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 2 10:38:48 2012 +0000

    generator: actions: Move 3 helper functions to a separate file.
    
    This is just code motion.

commit f56bc8edd5f23c23298bf3f609a98dd6fec5d512
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 2 09:32:52 2012 +0000

    New API: mklost_and_found

commit 4cfc277674f50ed9eff63e2010d3241172e7a30e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 2 09:12:32 2012 +0000

    todo: General updates.

commit f39478424f05110525eb3126185eae5346b0b746
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 2 09:03:27 2012 +0000

    ROADMAP: Remove some completed items.

commit 226457de3d56d810ff08687e3b16996be5f223b0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 1 19:31:17 2012 +0000

    sysprep: Don't fail when trying to remove /var/spool/at/spool (directory).
    
    This fixes commit 1949016e899b2737525fdc9b6dda451ad9ecbd66.

commit dd9bbeb060b55f17f4e2a006601e1ac73bbdb9d9
Author: John Eckersberg <jeckersb@redhat.com>
Date:   Thu Nov 1 13:35:16 2012 -0400

    inspect: Use new inspect_list_applications2 API call
    
    RWMJ:
     - Update virt-inspector.rng.

commit bafd8229149ccc0e05676e031bae5d1489fa74a6
Author: John Eckersberg <jeckersb@redhat.com>
Date:   Thu Nov 1 13:35:15 2012 -0400

    lib: Add inspect_list_applications2 method (RHBZ#859949)
    
    RWMJ:
    - Fix memory leak in guestfs__inspect_list_applications wrapper.
    - Don't document app2_spare* fields.

commit 4c285dd8f6a263ed62802af2c89c4cc75497c1ce
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Thu Nov 1 00:14:52 2012 +0100

    message catalogs don't need to be executable

commit 6871400223e928af3f058edf24e8c974c777689d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 30 14:35:25 2012 +0000

    Version 1.19.55.

commit de129a136355a92aa6a4afe47678aa13160fc806
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 30 13:19:53 2012 +0000

    build: Source 'localenv' in top-level Makefile.
    
    Also document 'local*' files.

commit f5194e6b0a470d6fe05eaa39b57eb9d0770bbe38
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 30 12:56:06 2012 +0000

    tests: Allow more tests to be skipped.
    
    Specifically tests which involve btrfs, because btrfs is
    currently broken upstream (RHBZ#863978).

commit eb185eef2998e7eed1dce6b82e3b4836a3db3ab2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 30 11:23:58 2012 +0000

    generator: Use an OCaml struct to store the structs.
    
    This just makes it simpler to add extra fields to each struct.
    
    This is code motion.

commit 72e19deee75317368a211234950fad11b8d381f1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 30 10:21:47 2012 +0000

    lib: Force visibility default on public actions.
    
    This is currently done implicitly because of the linker script.
    However in order to do symbol versioning, we will have to do
    this explicitly at each definition instead.

commit 8c66ba455d196225767b45706af6702c18cd180c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 30 10:31:17 2012 +0000

    generator: Move struct-freeing functions to a separate source file.
    
    This is just code motion.

commit ccf5c6ae564b30592157219fc048e29c374085ba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 30 08:31:38 2012 +0000

    sysprep: Move a comment.
    
    No change.

commit f491f3a95804a4b34d7c70c6d05aa945e59b3c8e
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Tue Oct 30 15:50:54 2012 +0800

    sysprep: remove man pages cache
    
    Remove the cache files generated by man-db.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 3884bc7d7a3545831f1e3ce8bde1ae5f64776bc4
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Tue Oct 30 15:50:53 2012 +0800

    sysprep: remove fontconfig cache
    
    Remove the cache files generated by fontconfig.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 63a091e21dbb509923eaeeb310707447385c566c
Author: John Eckersberg <jeckersb@redhat.com>
Date:   Mon Oct 29 16:22:00 2012 -0400

    lib: update inspect_list_applications to return all installed RPMs (RHBZ#859885).
    
    Note that because of RHBZ#859949, this will return two identical
    entries for RPMs which differ only by arch.

commit 269460770d9d472e882da7ec80a1e3a1ba4f8c3a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 29 15:40:33 2012 +0000

    build: Remove 'make bindist' rule.
    
    We've not distributed binaries for quite a long time, and possibly
    this is not advisable.

commit e6f8a589ee75764bda21e9045156b2ffa4567fec
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 29 15:13:15 2012 +0000

    Version 1.19.54.

commit dd09744432468c416033ca84dc0ae1a438240de0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 29 15:12:54 2012 +0000

    guestfs-testing: Use L<> around links.

commit bad5c7d5a50e7f340d3a5daff59d7f3c18c0ab8f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 29 12:49:21 2012 +0000

    fish: Add GUESTFISH_PS1 environment variable to control prompt.

commit 9de4dfddc7acf0d6c9d3a32f5d923ffa650cbce1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 27 16:19:53 2012 +0100

    fish: Make progress bars slightly lighter.

commit 3c1d85ae95452cee30029c719aa2523fdb5384c7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 25 21:58:20 2012 +0100

    docs: Review and clarify ERROR HANDLING section of guestfs(3).

commit 7271c9146d57299e4c71b23aaeac5ccef4a84d39
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 25 16:16:17 2012 +0100

    launch: libvirt: Disable CPU host-model.
    
    See the comment in the change.
    
    This "fixes" commit f7a67914c03db6d4c75671793964954640af7892.

commit 835ae2c43ca70a90e33262bb71da1883ab6a4473
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 25 14:23:00 2012 +0100

    gitignore: Ignore config.cache file.

commit f7a67914c03db6d4c75671793964954640af7892
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 25 14:11:01 2012 +0100

    launch: libvirt: Fix <cpu> element.
    
    Use <cpu mode="host-model"> (not model=... which was a typo).
    
    Also set fallback=allow so that libvirt knows it can use another
    CPU model if it wants.
    
    This fixes commit 890a4fbc8740b9b2019885a866aa06bc82566a41.

commit 5c8f073786285303f3bda1c30bd0b1953e0667a7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 25 14:10:43 2012 +0100

    daemon: Mark some functions as attribute((noreturn)).

commit 91c07d2a06fd4ec33db8d7737bfd73f61aa645fc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 24 11:14:56 2012 +0100

    fish: Fix test-events.sh because of new debug message.
    
    Commit 2e90f4312928f332f8997b52be3fe54f20920242 added a debug message
    which isn't filtered out by the set of grep -v's in this test.
    Therefore this test would fail when run with LIBGUESTFS_DEBUG=1.

commit a66fd2fac25d5520b4eb2935dea6a501daed946a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 22 12:18:40 2012 +0100

    resize: Depend explicitly on Unix module.
    
    Commit a0722c7ad846960be54978a31ebe73b76e119203 introduced a
    dependency on the Unix module.  This was not listed in the list of
    '-package's, but as long as you had ocaml-gettext installed it would
    still work because that pulled in Unix implicitly.
    
    Thanks Olaf Hering.

commit 6e63636869b9ea7559a28810437e7fdc43ab6a17
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 19 11:08:08 2012 +0100

    Version 1.19.53.

commit 0e0bea70dd166143670b5d01375fbfe2aebaf23e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 18 13:33:12 2012 +0100

    filearch: Use command mini-library to run external cpio command.

commit af5ec9381ea3b4e54aa7ef3a50d474d827f7ef19
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 18 22:08:52 2012 +0100

    fuse: Use command mini-library to run the fusermount command.

commit 95b83ef9d4cb42688202832ba150d90e61cf435d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 18 20:02:19 2012 +0100

    info: Use command mini-library to run 'qemu-img info' commands.

commit a3598aa257f6f08e8067621ccdbc68c0270e02f9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 18 21:51:20 2012 +0100

    inspect: Use command mini-library to parse the output of db_dump command.

commit 019b840e4758ccd254925181f6fbaf3192c7bde1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 18 10:55:42 2012 +0100

    inspect: Change icon code to use command mini-lib instead of system(3).

commit 7917e55ddb001d284c769faa65fc30c09e703f6b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 18 20:15:31 2012 +0100

    launch: libvirt: Use command mini-library to run qemu-img create command.

commit a0ead23016991717a62b6c136a2683abbd14c151
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 18 18:38:29 2012 +0100

    launch: appliance: Use command mini-library to parse output of qemu -help etc.

commit 8d4f3f85f2bdf38a2868ea785cf66efa65af25f3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 18 15:07:18 2012 +0100

    appliance: Use command mini-library to run febootstrap-supermin-helper (RHBZ#713678)

commit fa209341f834d1ab00e0d9fa767c8221506285e4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 18 14:20:54 2012 +0100

    lib: Change guestfs___remove_tmpdir function to use command mini-library.

commit 2e90f4312928f332f8997b52be3fe54f20920242
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 17 14:31:33 2012 +0100

    lib: Add a new 'command' mini-library for running external commands.
    
    This is a wrapper or mini-library for running external command,
    loosely based on libvirt's virCommand interface.
    
    Amongst the advantages are:
    
     - Can redirect errors into the error log (RHBZ#713678).
     - Can redirect output into a callback function.
     - Handles shell quoting properly.
     - Safely resets signal handlers, closes file descriptors, etc.
     - Single place where we can implement other improvements in future.

commit 2dab72794eef55f941cc61f1f34baa9fc7988298
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 18 17:35:30 2012 +0100

    valgrind: Add suppression for memory leak in libdl:_dl_init function.

commit 773fa611411d457d4b18dcb171b333b7356c20ba
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Sun Oct 14 14:32:36 2012 +0800

    NEW API: mktemp
    
    Used to create temporary directory or file with an optional suffix.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>
    
    RWMJ:
    
     - Split this out into a new file (daemon/mktemp.c).
    
     - I don't see a reason to deprecate the mkdtemp function which
       works fine.  Instead remove complex dir-making code from the
       new function.
    
     - Test and fix the patch (missing close(fd)).

commit 67e483689c086e22e9a3e038ea4e7285d9a0c4d2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 17 10:31:24 2012 +0100

    configure: Add db5.1_dump, db5.1_load for Debian Wheezy.

commit 978d16ec763b6c4c8277ff06fc725c0d98b7cfe0
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Wed Oct 17 15:48:14 2012 +0800

    TODO: remove the already implemented yum cache clean feature
    
    The cleanup of package managers cache is already implemented
    by sprep_operation_package_manager_cache.ml, so remove this
    TODO item.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 25ec619a462548c29fc706e7bb98094b43d94c13
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 16 09:12:18 2012 +0100

    todo: Implement Ruby blocking calls.

commit 99bd15ad0e900ce16fe16d2a58b4d6f8ba38a0fe
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 15 21:35:13 2012 +0100

    generator: Add 'blocking' flag to marking blocking (long-running) functions.
    
    In languages like Python where we release a global lock around
    long-running libguestfs functions, it is also useful to *not* release
    this lock for small, non-blocking functions.
    
    Therefore mark all functions with a 'blocking' boolean flag.  It
    defaults to true, and is true by definition for all daemon functions.
    For non-daemon functions, I have classified them manually.
    
    Only when the blocking flag is set do we generate the code to release
    and reacquire the lock around libguestfs calls.

commit 3d46f7dc038f87e00a27e9f294d4115436f1ff23
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 15 22:38:16 2012 +0100

    ocaml: Get rid of CAMLprim.
    
    It's wrong to use it, and in any case it doesn't do anything on Linux.

commit 8a89c728218ecb1c2226d28f9592604b9c2d96ca
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 15 18:02:06 2012 +0100

    Update release notes.

commit c164cc9bea89aa627dad4338469c26a1a70b61f5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 15 16:35:13 2012 +0100

    lib: Add a test for environment parsing functions.
    
    This updates commit 9466060201600db47016133d80af22eb38091a49.

commit ec1d2398722fbebd6dd3daa205d0dd3ca653fe8d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 15 16:34:23 2012 +0100

    lib: Fix guestfs_create_flags example program in man page.
    
    This fixes commit 9466060201600db47016133d80af22eb38091a49.

commit a0722c7ad846960be54978a31ebe73b76e119203
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 15 15:51:55 2012 +0100

    resize, sparsify: Suppress progress bar when output is not a tty.

commit c9acb029edf7c20ca937a1f6051b5834cdfdddf7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 15 15:51:21 2012 +0100

    sparsify: Fix dependencies so they include resize/progress.*
    
    This fixes commit 91b2238fc8e462c02f697f0c053043a55f43c13d.

commit 471f4e64d3363e25483bba36eab41d41b3eb0206
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 15 15:43:46 2012 +0100

    libvirt: auth: Some clarifications of the API from Dan Berrange.
    
    This updates commit d83d17e9dbfb24496a0841fc2aed436181ca0341.

commit 9466060201600db47016133d80af22eb38091a49
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 15 11:14:59 2012 +0100

    New APIs: guestfs_create_flags, guestfs_parse_environment,
    guestfs_parse_environment_list.
    
    Add a new function for creating a handle:
    
     guestfs_h *guestfs_create_flags (unsigned flags [, ...]);
    
    This variant lets you supply flags and extra arguments, although extra
    arguments are not used at the moment.
    
    Of particular interest is the ability to separate the creation of the
    handle from the parsing of environment variables like
    LIBGUESTFS_DEBUG.  guestfs_create does both together, which prevents
    us from propagating errors from parsing environment variables back to
    the caller (guestfs_create has always printed any errors on stderr and
    then just ignored them).
    
    If you are interested in these errors, you can now write:
    
     g = guestfs_create_flags (GUESTFS_CREATE_NO_ENVIRONMENT);
     if (!g)
       exit (EXIT_FAILURE);
     r = guestfs_parse_environment (g);
     if (!r)
       exit (EXIT_FAILURE);
    
    Also you can *omit* the call to guestfs_parse_environment, which
    creates a handle unaffected by the environment (which was not possible
    before).
    
    This commit also includes new (backwards compatible) changes to the
    OCaml, Perl, Python, Ruby and Java constructors that let you use the
    flags.

commit 389cb608df19b80323214eefad464a7ebfb7f235
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 15 14:51:32 2012 +0100

    ruby: Add RUBYLIB to run script.

commit f65c9bfcf279fd29f927d02159e1f51e6b2db3ae
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Oct 14 13:23:30 2012 +0100

    Version 1.19.52.

commit 1c1630bb23ab0119fd47c167355ba7002635b1c3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Oct 14 13:28:31 2012 +0100

    Update PO files from Transifex.
    
    Also run 'make update-po'.

commit c36456cf0330f134553ffeefff8f3deafc2522fb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Oct 14 13:22:34 2012 +0100

    Update API support.

commit 626ca8e74f97a8c5fbe354211e81132976a21435
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Oct 14 12:54:02 2012 +0100

    valgrind: Fix FUSE memory leak suppression.

commit d83d17e9dbfb24496a0841fc2aed436181ca0341
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 13 12:57:12 2012 +0100

    New APIs: Model libvirt authentication events through the API.
    
    This commit models libvirt authentication events through the API,
    adding one new event (GUESTFS_EVENT_LIBVIRT_AUTH) and several new
    APIs:
    
      guestfs_set_libvirt_supported_credentials
      guestfs_get_libvirt_requested_credentials
      guestfs_get_libvirt_requested_credential_prompt
      guestfs_get_libvirt_requested_credential_challenge
      guestfs_get_libvirt_requested_credential_defresult
      guestfs_set_libvirt_requested_credential
    
    See the documentation and example which shows how to use the new API.
    
    This commit also changes existing calls to virConnectOpen* within the
    library so that the new API is used.
    
    Also included is an example (but not a test, because it's hard to see
    how to automatically test the libvirt API).

commit 07d0546f5d210d1cee048de8d42bdf58302f0d93
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 13 20:52:31 2012 +0100

    configure: Add --without-libvirt option.
    
    Normally we check if libvirt is installed, and the default is still to
    do this.
    
    However having this option makes it simpler to check if a change to
    the code has broken the case where libvirt is not installed.
    
    In fact, this change revealed one such place, which is also fixed in
    this commit.

commit 085bf7c97aae67e8f84fe95f97ee4bfee849d523
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 13 09:29:38 2012 +0100

    docs: Make 'EVENTS' into its own =head1 section.
    
    For some reason it was stuck under "CALLS WITH OPTIONAL ARGUMENTS",
    which made no sense.

commit 96a76c79e40a5d6853c660fc2a980d084b0eaafd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 13 14:20:31 2012 +0100

    launch: libvirt: Make handle data conditional on HAVE_LIBVIRT.
    
    This means that we can use virConnectPtr and virDomainPtr instead of
    using void* types.  In the case where libvirt support is disabled or
    not present, effectively nothing changes.

commit 325d67c615f19da1b679e4d673636cf6d91a4c41
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 13 14:06:46 2012 +0100

    lib: Rename src/libvirtdomain.c -> src/libvirt-domain.c.
    
    No change, just code motion.

commit 64e8e0011c6e961bae010b6008d07f501d53f35d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 13 15:34:01 2012 +0100

    lib: Pointer arg to safe_memdup function should be const.

commit bdfe2216715ff15691ab719ee0e63ccc2e84526c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 12 20:45:19 2012 +0100

    configure: Fix capitalization in configure script.
    
    Just make the output of ./configure --help and the <config.h>
    file consistent.

commit 467fb589b969b2d5a6fbb72c327c6c57cb65fcc3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 12 20:44:56 2012 +0100

    configure: Fix C++ compiler test so it doesn't print random junk.

commit e6e999eac2e58d6126d83d51cd820966912b0c6b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 11 17:12:51 2012 +0100

    Version 1.19.51.

commit 15b9ed3ed2078c034f25bf3ba31298dd89c6cddf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 11 17:12:21 2012 +0100

    daemon: Call udev-settle at the start of the daemon.

commit 67e9572286f98b830bef64cfcae5a072bf3a1882
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 11 15:50:41 2012 +0100

    launch: libvirt: Always set <qemu:env> TMPDIR.
    
    If TMPDIR is not set, we must choose one, because otherwise libvirt
    will use a random TMPDIR: http://bugzilla.redhat.com/865464
    
    The convenient guestfs___persistent_tmpdir function does everything
    needed in this case.

commit 911a16a9fa965ce8defb3307f6bf338f5d2d5c94
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 11 13:51:19 2012 +0000

    fish: progress bar: Send interactive progress bar output to /dev/tty (RHBZ#859875).

commit 91b2238fc8e462c02f697f0c053043a55f43c13d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 11 13:23:24 2012 +0000

    sparsify: Re-use progress bar wrapper code from virt-resize.
    
    The code was identical -- just copied with s/resize/sparsify/.
    Instead of duplicating identical code, cause the Makefile.am to use
    the code from the ../resize/ directory.
    
    Unfortunately because there are two Utils modules (which are
    different), this means we had to rename those modules to Resize_utils
    and Sparsify_utils respectively.  So this is a rather larger change
    than intended.  However it's just code motion.

commit f4a2aecd5ff4904994d75ad92b50a834d40eef17
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 11 13:18:46 2012 +0000

    fish: inspect: Canonicalize paths for printing (RHBZ#859876).

commit c34dcf184ef4eaa35634d1696e0c68d21b811170
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 11 13:12:26 2012 +0000

    fish: inspect: Move variable decls to top of function.
    
    This is just code motion.

commit 77ce157db8bd1e784bf73850b65cfcf60fb5ca66
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 10 21:22:43 2012 +0000

    Version 1.19.50.

commit 316c2a6fc7ac38867e96a4d0d626a7f2dc61ee14
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 10 21:11:17 2012 +0000

    docs: Fix documentation about hotplugging.

commit 2e388e8a3740aa470276b78027f51304a7f0ff92
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 10 21:05:52 2012 +0000

    launch: Add warning not to avoid calling launch twice on the same handle.
    
    For more information on this topic, see:
    https://www.redhat.com/archives/libguestfs/2012-October/msg00045.html

commit 7376811983060f94552d90576aed61955102c68d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 10 13:51:54 2012 +0100

    Revert "btrfs: Add a workaround for btrfs failures seen with kernel 3.7.0."
    Revert "btrfs: Add an extended workaround for btrfs failures seen with kernel 3.7.0."
    
    Reverted these workaround, since we may have found a fix for the btrfs
    bug itself (for details see RHBZ#863978).
    
    This reverts commit d9e5b514aa4ef6d659b267e8caef4ebec8a221b1
    and commit a03f536f0dae3ca20e11b7c2ba41e4a7eb1f28c9.

commit 33f49d85c2a82e66f33cedccb2dbd14faa6070dd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 10 16:38:53 2012 +0000

    tests: Fix test-qemudie-* so they re-adds the disk on second launch.
    
    Commit ed7fda161e1f3d0beb02a368fcbcf5ed95dcdac1 changed the
    way that the drives are handled across appliance shutdowns.
    
    Previously during the following sequence of calls:
    
      create the handle
      add drive(s)
      launch
      kill subprocess
      launch
    
    the added drives are still in the handle at the second launch.
    
    After the above commit, the added drives are removed from the handle,
    which means the second launch happens with no drives (which could be
    an error).
    
    This was never actually defined either way, so in this case fix the
    test to re-add the drive before the second launch.
    
    Since hotplugging was added, it isn't really feasible to return to the
    original semantics, since users might remove drives, in which case we
    have lost information about those drives so we cannot restore them on
    the second launch.
    
    NOTE: PLEASE CALLERS DON'T DO THIS!  Always use a new handle for each
    launch of the appliance.

commit a03f536f0dae3ca20e11b7c2ba41e4a7eb1f28c9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 10 11:15:39 2012 +0100

    btrfs: Add an extended workaround for btrfs failures seen with kernel 3.7.0.
    
    See:
    https://bugzilla.redhat.com/show_bug.cgi?id=863978
    and:
    http://thread.gmane.org/gmane.comp.file-systems.btrfs/20257
    
    This extends the fix in commit d9e5b514aa4ef6d659b267e8caef4ebec8a221b1
    because I missed the case where mkfs.btrfs is called directly.

commit 0032c60336c6f819859d30ec68179373e8943ef6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 9 21:58:21 2012 +0100

    docs: Fully document all subdirectories of the source.

commit b54fa22cd0a6a091324ff1978e0de2c54a0fabde
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 9 21:57:54 2012 +0100

    docs: Add overview to guestfs(3)/EXTENDING LIBGUESTFS.

commit e10647e3349db040cbb9b0956155e12447eefb72
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 9 12:06:03 2012 +0100

    appliance: Add 99-guestfs-serial.rules to EXTRA_DIST.
    
    This fixes commit 7786d56db8c22413949f98ef6b15fe0ea367d195.

commit e4bca563b46286c70dddac5bf9a174039715414d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 9 11:21:17 2012 +0100

    Version 1.19.49.

commit d9e5b514aa4ef6d659b267e8caef4ebec8a221b1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 8 22:25:43 2012 +0100

    btrfs: Add a workaround for btrfs failures seen with kernel 3.7.0.
    
    See:
    https://bugzilla.redhat.com/show_bug.cgi?id=863978
    and:
    http://thread.gmane.org/gmane.comp.file-systems.btrfs/20257

commit 45c9fbd6f50eeed9307892e883b25b8b3b263b3a
Author: Olaf Hering <olaf@aepfle.de>
Date:   Mon Oct 8 20:10:36 2012 +0200

    launch: appliance is optional
    
     # virt-filesystems -v -d 6326ad4e-5805-2ab4-1338-d1dad8c76162 --all
    libguestfs: libvirt version = 10002
    libguestfs: [00000ms] connect to libvirt
    libguestfs: [00001ms] get libvirt capabilities
    libguestfs: [00234ms] build appliance
    libguestfs: [00234ms] create libvirt XML
    libguestfs: error: error constructing libvirt XML at "xmlTextWriterWriteAttribute (xo, BAD_CAST "file", BAD_CAST appliance)": No such file or directory
    libguestfs: closing guestfs handle 0x656270 (state 0)
    
     # ls -lh /usr/lib64/guestfs/*
    -rw-r--r-- 1 root root  13M Oct  8 16:15 /usr/lib64/guestfs/initramfs.x86_64.img
    -rw-r--r-- 1 root root 3.7M Oct  6 09:25 /usr/lib64/guestfs/vmlinuz.x86_64
    
    Signed-off-by: Olaf Hering <olaf@aepfle.de>

commit 0a85fbc946d7838366c35c0425efddb1a91f593c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 8 17:26:53 2012 +0100

    Add support for hotplugging (removing disks).
    New API: remove-drive.
    
    Note because of a bug in fuser, this only works with psmisc >= 22.20.
    
    This also updates the hotplugging tests.

commit 18b7f09f366d518050f467d0944c81c82fd5e39e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 5 14:56:35 2012 +0100

    Add support for hotplugging (adding disks) to the libvirt attach-method.
    
    When libvirt is used, we can allow disks to be hotplugged.
    guestfs_add_drive can be called after launch to hot-add a disk.
    
    When a disk is hot-added, we first ask libvirt to add the disk to the
    appliance, then we make an internal call into the appliance to get it
    to wait for the disk to appear (ie. udev_settle ()).
    
    Hot-added disks are tracked in the g->drives array.
    
    This also adds a test.

commit 7786d56db8c22413949f98ef6b15fe0ea367d195
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 3 10:50:51 2012 +0100

    launch: Add add_drive 'label' option.
    New API: list-disk-labels
    
    Allow the user to pass an optional disk label when adding a drive.
    
    This is passed through to qemu / libvirt using the disk serial field,
    and from there to the appliance which exposes it through udev,
    creating a special alias of the device /dev/disk/guestfs/<label>.
    Partitions are named /dev/disk/guestfs/<label><partnum>.
    
    virtio-blk and virtio-scsi limit the serial field to 20 bytes.  We
    further limit the name to maximum 20 ASCII characters in [a-zA-Z].
    
    list-devices and list-partitions are not changed: these calls still
    return raw block device names.  However a new call, list-disk-labels,
    returns a hash table allowing callers to map between disk labels, and
    block device and partition names.
    
    This commit also includes a test.

commit 3ad44c866042919374e2d840502e53da2ed8aef0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 6 19:27:14 2012 +0100

    launch: libvirt: Create qcow2 overlays for read-only drives and the appliance.
    
    Instead of adding the snapshot=on option via <qemu:arg>, create qcow2
    overlays for any read-only drives and the appliance using 'qemu-img
    create' + a temporary file.
    
    This is a workaround for missing support for <transient/> in libvirt's
    qemu driver.  Also for the unpredictable way that libvirtd handles
    $TMPDIR: we want to control where the temporary disk is created.
    
    Currently it is also much slower, because qemu-img is slow.  However
    we hope to fix qemu upstream.

commit ed7fda161e1f3d0beb02a368fcbcf5ed95dcdac1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 8 14:35:32 2012 +0100

    launch: Make g->drives into an array (was a linked list).
    
    Using an array simplifies the implementation of hotplugging.

commit 8354dc46fdcb2984d809d2864f97691167f04f50
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Oct 7 11:58:36 2012 +0100

    Version 1.19.48.
    
    We need to regenerate the tarball because the previous one
    had the guestfsd man page missing.  Hence bumped version
    number.

commit 62e56876c870c470856d98f01cecb1110e5684eb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Oct 7 11:55:01 2012 +0100

    daemon: Add guestfsd.pod to EXTRA_DIST.
    
    This fixes commit df2469a48f4641bdfe26a4179dd946df190fa970.

commit 63eae6fa6f44f1056cb6cf90d0d6e6f42282a967
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 6 23:35:14 2012 +0100

    Version 1.19.47.

commit 9f24ac2db0ebba436d483e3e0073813f150fb783
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 6 18:48:10 2012 +0100

    launch: Add private data pointer to the struct drive.
    
    This can be used by the attach-method, eg. for libvirt-only data.

commit 6867b0a3fb6491e1d26c747100dad364dbf20c70
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 6 18:44:05 2012 +0100

    launch: add_null_drive: Force null drive to be writable.
    
    Because we create a special file, there is no point forcing qemu
    to create an overlay as well.  Save time by setting readonly = 0.

commit 328510121ad720680b71b65b9b2a60e816ca49f8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 5 15:13:16 2012 +0100

    launch: Rearrange code for adding drives to the g->drives list in the handle.
    
    This is just code motion.

commit 92feed7d662b7d9d1f8c475cf06df203143a3a5f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 3 11:46:07 2012 +0100

    build: Use 'tmp-d' as name of temporary directory instead of 'tmp'.
    
    When building supermin.d/daemon.img, use 'tmp-d' instead of 'tmp'
    as the name of the temporary directory.
    
    This is just code motion.

commit 1467ea00b850bec2722671a400adb2ffda533365
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 5 11:03:03 2012 +0100

    docs: add_drive: Clean up documentation of the 'filename' parameter.
    
    Also, remove duplicate documentation of using '/dev/null' as the
    filename.

commit 013fb91a6974dfcb493fb9ccffb23329788f4976
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 6 21:34:12 2012 +0100

    tests: Fix rhbz690819.sh to skip when attach-method is libvirt.
    
    This sets the iface parameter (implicitly), which is not supported yet
    by the libvirt backend.
    
    This updates commit 8e198dc1c50fcdba6720b23da478ef75cc979733.

commit 9bd3d5bc6d6a3be517da5faf9e7c8a84394ca0f9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 6 17:41:36 2012 +0100

    FAQ: Document debug* and internal* functions in the FAQ.

commit 8e198dc1c50fcdba6720b23da478ef75cc979733
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 3 10:49:20 2012 +0100

    launch: libvirt: The drive 'iface' parameter is not yet supported.
    
    We could add support, but at the moment return an error
    if the user tries to use the iface parameter.

commit 60650da1ed7b6d916ceeee0e397c7bb2fbc282e5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 3 10:30:15 2012 +0100

    docs: Minor cleanup of documentation for add_drive 'name' parameter.

commit 4a4ca0c01da3307b69fc4925c5f2ece1e728d4b3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 3 09:15:37 2012 +0100

    syntax: Use __PATTERNS__ instead of @PATTERNS@ in podwrapper man pages.
    
    It is slightly dangerous to use @PATTERNS@, since these might
    be substituted by autoconf when they appear in Makefile.am files.

commit df2469a48f4641bdfe26a4179dd946df190fa970
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 3 07:47:18 2012 +0100

    docs: Add guestfsd(8) man page.

commit 378e5d672286e18789bc4331705edb45210ac27a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 1 12:57:00 2012 +0100

    Version 1.19.46.

commit 572291c64ed79b4988de6d23c31458d7c3c71b1d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 1 12:57:04 2012 +0100

    configure: Rearrange build options report in ./configure output.
    
    This had accreted over a long period of time, so it wasn't
    arranged very logically.

commit 6f53d49a27fbf7f1b5c22080e2509375e128d5e4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 28 15:00:26 2012 +0100

    daemon: When sorting devices, don't fail on mix of /dev/sd and /dev/vd
    (RHBZ#858128).
    
    If compare_device_names was given two devices with devices with
    different interfaces (eg. /dev/sda and /dev/vda) then it would try to
    compare the partition numbers, and fail when it could parse them.
    
    It's arguable what we should be doing in this case (except for
    strongly discouraging people from using the interface feature), but
    let's at least not cause the daemon to assert-fail.
    
    Found by Red Hat QA, thanks Mohua Li.

commit 9ea6e9701461e594033999150f930cc4fafec4d2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 28 10:15:13 2012 +0100

    inspection: Fix calls to case_sensitive_path (RHBZ#858126).
    
    Don't assume that if guestfs_case_sensitive_path returns NULL, that it
    means the file does not exist.
    
    The (previously undefined) behaviour of case_sensitive_path was that a
    NULL return meant "either the file doesn't exist or some other error".
    However in commit 973581780d8a006f336684fef6762801402d775d this was
    changed so that if the last element of the path didn't exist, it was
    assumed to be a new file and the (non-NULL) path of the new file is
    returned.
    
    This change breaks code (including in libguestfs) which tries to use
    case_sensitive_path as a dual-purpose call to fix-up a path for
    Windows and test if the file exists.  Such code should be rewritten so
    that it explicitly tests for file existence after calling
    case_sensitive_path.
    
    I examined all the calls to case_sensitive_path in libguestfs and
    modified them where necessary.

commit 55b7c4df7895b8c22d737723d857a9a63db69926
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 28 09:57:49 2012 +0100

    virt-edit: If case_sensitive_path returns an error, exit.
    
    The 'windows_path' function was blindly copied from virt-cat.  In
    virt-cat, errors are checked by the caller to 'windows_path'.  But
    virt-edit lacks this check.  Change the function in virt-edit to add a
    check and exit on error.

commit 6cd040fcdf662ff56be08a03eb80918ec10191ec
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 26 21:21:02 2012 +0100

    Version 1.19.45.

commit 8d63edaa9317e957d03beb9834ddac5f30349ef1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 26 21:16:14 2012 +0100

    sysprep: Typo in man page: resets -> reset.

commit 91617069b9903af303187acaf8e83bc7dece2c93
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 26 21:03:37 2012 +0100

    run: Label tmp directory.
    
    There's not really any point just documenting that people
    should label the tmp directory, when we can just label it.
    So change the ./run script so it calls chcon.
    
    However it's not a failure if chcon doesn't work.  If SELinux
    is not installed or is disabled, then labelling will fail.

commit f7e138835a7194135113088767c46df65dbf292a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 26 20:56:44 2012 +0100

    recipes: Add a section about diagnosing hanging guests.

commit 4f3048c6be0663c6c254a765ec5f83a7b40a8808
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 26 12:26:33 2012 +0100

    test-tool: Add prominent warning about including complete output.
    
    Everyone ignores the documentation.  Everyone ignores me even
    when I specifically tell them to include the complete output.
    
    Place a prominent notice at the beginning of the output.

commit ca2e65275d797864d2a5b3b3d0e115460522e5bb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 26 12:26:28 2012 +0100

    test-tool: guestfs_get_path might return NULL.
    
    It would almost certainly indicate a bug if it happens, but
    don't rely on printf not segfaulting if it did happen.

commit b44d82ec8db4146f0851fdf0ef5f5d7492f34953
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 26 12:04:02 2012 +0100

    Revert "test-launch-race: Add SELinux label to $TMPDIR."
    
    Because RHBZ#860235 has been fixed in selinux-policy 3.11.1-25.fc18.
    
    This reverts commit 7fc838cca334ccf3d388c5598ff7fae88dbe4513.

commit 9b7813c5bd91d53e358deee64ab42b00b42c37ba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 26 12:03:16 2012 +0100

    guestfs-testing(1): Start by running libguestfs-test-tool.

commit f7f746a98e8d378ac8934a7f7b82a48b3e2a5aa4
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Wed Sep 26 17:20:27 2012 +0800

    remove the useless "h" option
    
    "h" option is not enabled in virt-cat, remove it.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 19b29c36370beb76fd3f3a1f45289ce34c03e3c3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 25 19:00:50 2012 +0100

    FAQ: Miscellaneous cleanups.
    
    - Use S<...> for non-breaking spaces.
    - Arrange the builds section better.
    - Add a section on enabling sVirt.
    - Other small fixes.

commit d19e557df54f3822d38621b8c2da098bf44b4d53
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 25 18:30:36 2012 +0100

    docs: Link to guestfs-recipes(1) from intro in guestfs(3).

commit a8056050c0f303f66ba2beed3bbe1ade8fca79cf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 25 14:26:38 2012 +0100

    gobject: No need to remove old API files.
    
    In commit 3d84ca76fec491015030daa53e9122b03032ddfd we changed the
    generator so it now automatically removes old API files.

commit 7fc838cca334ccf3d388c5598ff7fae88dbe4513
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 25 12:15:19 2012 +0100

    test-launch-race: Add SELinux label to $TMPDIR.
    
    This is a temporary workaround for
    https://bugzilla.redhat.com/show_bug.cgi?id=860235
    which can be removed once this bug is fixed.

commit b3bf53714b4e783fb7c7565a6be050dece0d3d1a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 24 21:25:31 2012 +0100

    libvirt >= 0.10.2 required for libvirt backend.

commit c9cccb776e0f15d6a28120fe5dbaed3ef6a70486
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 24 17:00:03 2012 +0100

    Version 1.19.44.

commit 45d459f4023a581712c4441acb440c821342bdf6
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Mon Sep 24 16:49:21 2012 +0800

    Fix tests/bigdirs/test-big-dirs.pl to use mke2fs
    
    Let tests/bigdirs/test-big-dirs.pl uses mke2fs to create small
    inode ratio files.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>
    
    RWMJ:
     - Fix invocation of mke2fs with optional arguments.
     - Run the test to check it works.

commit 0c2aab966a9ecde8a23044877cb3123cd238100a
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Mon Sep 24 16:32:51 2012 +0800

    NEW API:ext:mke2fs
    
    New api mke2fs for full configuration of filesystem.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>
    
    RWMJ:
     - Update description.
     - Run and fix the tests.
     - Remove bogus filename from po/POTFILES.

commit a297a9348f2a22dcf057de2ef00389b7d36b0d15
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 24 16:39:41 2012 +0100

    tests/bigdirs: Add empty TESTS= rule.
    
    Without this empty rule, automake doesn't generate the rest of the
    testing infrastructure, so you can't enable the test yourself by doing
    'make check TESTS=test-big-dirs.pl'.

commit 790c1a0c7b141e3e4f37c3f670c19e039873dcbe
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 24 09:45:33 2012 +0100

    generator: xdr: Re-code procedure table.
    
    This is just code motion.

commit db6a8512402f068815f882928662af0d8f5eec83
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 24 09:26:10 2012 +0100

    generator: Tidy up comments in guestfs_protocol.x.

commit a95d4261b8cedc31bfc3c5358be7b346b27d457b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 24 09:24:33 2012 +0100

    generator: Allow an optional emacs-mode at the top of generated files.

commit a3d7f5bc17aa3935a427812a49de60ecc0a345ca
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 24 09:26:45 2012 +0100

    generator: The default input files are 'generator/ *.ml' [sic].
    
    Since generator source files were renamed, the comment at the
    top of each generated file was wrong.
    
    Unfortunately we cannot allow /* to appear within a comment,
    so the space is necessary.

commit 1949016e899b2737525fdc9b6dda451ad9ecbd66
Author: Olaf Hering <olaf@aepfle.de>
Date:   Fri Sep 21 21:04:43 2012 +0200

    sysprep: handle at jobs in cron-spool operation
    
    cron-spool claims to remove at jobs, but it has no code to actually do
    that. Add patterns to remove files in known at spool locations.
    
    Signed-off-by: Olaf Hering <olaf@aepfle.de>

commit 55fef0e4e607b1d447a0a0804acd69481f7613e4
Author: Olaf Hering <olaf@aepfle.de>
Date:   Fri Sep 21 20:00:34 2012 +0200

    sysprep: handle distro specific sysv scripts
    
    Currently firstboot would only work on redhat-based images.
    Handle redhat-based, suse-based and debian guests, error out in case of an
    unknown distro.
    Update firstboot.sh:
     - make sure scripts exists and can be executed
     - add LSB header to avoid insserv warnings later on
     - run script only if called with "start"
    Update functions, pass only required options.
    
    Signed-off-by: Olaf Hering <olaf@aepfle.de>

commit 09c372ea250e8241d62e9fde70eabe7bdca83050
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 22 10:47:11 2012 +0100

    test-launch-race: Add comment.

commit ab0610d7528a4816166e6d2840f8b675c14b2d09
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 21 16:31:05 2012 +0100

    Version 1.19.43.

commit 0e7d3de002de79b3d36e473149cfe9b54ad1b4c3
Author: Olaf Hering <olaf@aepfle.de>
Date:   Fri Sep 21 14:09:10 2012 +0100

    sysprep: handle suse-based in hostname operation
    
    Signed-off-by: Olaf Hering <olaf@aepfle.de>

commit 1b364d74a8d42c956abdf4c5dbbc56cf1e250033
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 21 12:42:53 2012 +0100

    launch: Handle guestfs_config qemu_value == NULL.
    
    The second parameter to 'config' may be NULL.
    
    In commit 52fa23d74f6308daf804c2330b0b27e0b4412594 (refactoring of
    guestfs_config) the code this got lost, and guestfs_config would
    segfault if qemu_value was NULL.
    
    Also this fixes the libvirt method to handle the same case.
    
    I checked libguestfs-1.18 and -1.16 branches, and this problem does
    NOT affect them.

commit 763ec36cf0c6ffa6d359b65ff7f1ee9ab1c7361e
Author: Olaf Hering <olaf@aepfle.de>
Date:   Fri Sep 21 11:00:01 2012 +0200

    Update SuSE Linux detection.
    
    Update SuSE Linux detection. Up to now everything with a
    /etc/SuSE-release file was treated as openSuSE. With this change SLES
    based distributions such as "SUSE Linux Enterprise Server", "SUSE
    Linux Enterprise Desktop" and "Novell Linux Desktop" will show up as
    "sles". The 'opensuse' detection was updated to handle older openSuSE
    releases as well as the well known SuSE Linux releases, starting from
    6.0. Everything else with a /etc/SuSE-release file will show up as
    "suse-based".
    
    Here is a collection of release files:
    
    ==> Dist/6.0/etc/SuSE-release <==
    SuSE Linux 6.0 (i386)
    VERSION = 6.0
    
    ==> Dist/6.1/etc/SuSE-release <==
    SuSE Linux 6.1 (i386)
    VERSION = 6.1
    
    ==> Dist/6.2/etc/SuSE-release <==
    SuSE Linux 6.2 (i386)
    VERSION = 6.2
    
    ==> Dist/6.3/etc/SuSE-release <==
    SuSE Linux 6.3 (i386)
    VERSION = 6.3
    
    ==> Dist/6.4/etc/SuSE-release <==
    SuSE Linux 6.4 (i386)
    VERSION = 6.4
    
    ==> Dist/7.0/etc/SuSE-release <==
    SuSE Linux 7.0 (i386)
    VERSION = 7.0
    
    ==> Dist/7.1/etc/SuSE-release <==
    SuSE Linux 7.1 (i386)
    VERSION = 7.1
    
    ==> Dist/7.2/etc/SuSE-release <==
    SuSE Linux 7.2 (i386)
    VERSION = 7.2
    
    ==> Dist/7.3/etc/SuSE-release <==
    SuSE Linux 7.3 (i386)
    VERSION = 7.3
    
    ==> Dist/8.0/etc/SuSE-release <==
    SuSE Linux 8.0 (i386)
    VERSION = 8.0
    
    ==> Dist/8.1/etc/SuSE-release <==
    SuSE Linux 8.1 (i386)
    VERSION = 8.1
    
    ==> Dist/8.2/etc/SuSE-release <==
    SuSE Linux 8.2 (x86-64)
    VERSION = 8.2
    
    ==> Dist/9.0/etc/SuSE-release <==
    SuSE Linux 9.0 (x86-64)
    VERSION = 9.0
    
    ==> Dist/9.1/etc/SuSE-release <==
    SuSE Linux 9.1 (x86-64)
    VERSION = 9.1
    
    ==> Dist/9.2/etc/SuSE-release <==
    SuSE Linux 9.2 (x86-64)
    VERSION = 9.2
    
    ==> Dist/9.3/etc/SuSE-release <==
    SuSE Linux 9.3 (x86-64)
    VERSION = 9.3
    
    ==> Dist/10.0/etc/SuSE-release <==
    SUSE LINUX 10.0 (X86-64) OSS
    VERSION = 10.0
    
    ==> Dist/10.1-remastered/etc/SuSE-release <==
    SUSE LINUX 10.1 (X86-64)
    VERSION = 10.1
    
    ==> Dist/10.1/etc/SuSE-release <==
    SUSE Linux 10.1 (X86-64) Beta8
    VERSION = 10.1
    
    ==> Dist/10.2/etc/SuSE-release <==
    openSUSE 10.2 (X86-64)
    VERSION = 10.2
    
    ==> Dist/10.3/etc/SuSE-release <==
    openSUSE 10.3 (X86-64)
    VERSION = 10.3
    
    ==> Dist/11.0/etc/SuSE-release <==
    openSUSE 11.0 (X86-64)
    VERSION = 11.0
    
    ==> Dist/11.1/etc/SuSE-release <==
    openSUSE 11.1 (x86_64)
    VERSION = 11.1
    
    ==> Dist/11.2/etc/SuSE-release <==
    openSUSE 11.2 (x86_64)
    VERSION = 11.2
    
    ==> Dist/11.3/etc/SuSE-release <==
    openSUSE 11.3 (x86_64)
    VERSION = 11.3
    
    ==> Dist/11.4/etc/SuSE-release <==
    openSUSE 11.4 (x86_64)
    VERSION = 11.4
    CODENAME = Celadon
    
    ==> Dist/12.1/etc/SuSE-release <==
    openSUSE 12.1 (x86_64)
    VERSION = 12.1
    CODENAME = Asparagus
    
    ==> Dist/12.2/etc/SuSE-release <==
    openSUSE 12.2 (x86_64)
    VERSION = 12.2
    CODENAME = Mantis
    
    ==> Dist/sles8/etc/SuSE-release <==
    SuSE SLES-8 (AMD64)
    VERSION = 8.1
    
    ==> Dist/sles9/etc/SuSE-release <==
    SUSE LINUX Enterprise Server 9 (x86_64)
    VERSION = 9
    
    ==> Dist/sles9sp2/etc/SuSE-release <==
    SUSE LINUX Enterprise Server 9 (x86_64)
    VERSION = 9
    PATCHLEVEL = 2
    
    ==> Dist/sles9sp3/etc/SuSE-release <==
    SUSE LINUX Enterprise Server 9 (x86_64)
    VERSION = 9
    PATCHLEVEL = 3
    
    ==> Dist/sles9sp4/etc/SuSE-release <==
    SUSE LINUX Enterprise Server 9 (x86_64)
    VERSION = 9
    PATCHLEVEL = 4
    ==> Dist/sled10/etc/SuSE-release <==
    SUSE Linux Enterprise Desktop 10 (x86_64)
    VERSION = 10
    
    ==> Dist/sled10sp1/etc/SuSE-release <==
    SUSE Linux Enterprise Desktop 10 (x86_64)
    VERSION = 10
    PATCHLEVEL = 1
    
    ==> Dist/sled10sp2/etc/SuSE-release <==
    SUSE Linux Enterprise Desktop 10 (x86_64)
    VERSION = 10
    PATCHLEVEL = 2
    
    ==> Dist/sled10sp3/etc/SuSE-release <==
    SUSE Linux Enterprise Desktop 10 (x86_64)
    VERSION = 10
    PATCHLEVEL = 3
    
    ==> Dist/sled10sp4/etc/SuSE-release <==
    SUSE Linux Enterprise Desktop 10 (x86_64)
    VERSION = 10
    PATCHLEVEL = 4
    
    ==> Dist/sled11/etc/SuSE-release <==
    SUSE Linux Enterprise Desktop 11 (x86_64)
    VERSION = 11
    PATCHLEVEL = 0
    
    ==> Dist/sled11sp1/etc/SuSE-release <==
    SUSE Linux Enterprise Desktop 11 (x86_64)
    VERSION = 11
    PATCHLEVEL = 1
    
    ==> Dist/sled11sp2/etc/SuSE-release <==
    SUSE Linux Enterprise Desktop 11 (x86_64)
    VERSION = 11
    PATCHLEVEL = 2
    
    ==> Dist/sles10/etc/SuSE-release <==
    SUSE Linux Enterprise Server 10 (x86_64)
    VERSION = 10
    
    ==> Dist/sles10sp1/etc/SuSE-release <==
    SUSE Linux Enterprise Server 10 (x86_64)
    VERSION = 10
    PATCHLEVEL = 1
    
    ==> Dist/sles10sp2/etc/SuSE-release <==
    SUSE Linux Enterprise Server 10 (x86_64)
    VERSION = 10
    PATCHLEVEL = 2
    
    ==> Dist/sles10sp3/etc/SuSE-release <==
    SUSE Linux Enterprise Server 10 (x86_64)
    VERSION = 10
    PATCHLEVEL = 3
    
    ==> Dist/sles10sp4/etc/SuSE-release <==
    SUSE Linux Enterprise Server 10 (x86_64)
    VERSION = 10
    PATCHLEVEL = 4
    
    ==> Dist/sles11/etc/SuSE-release <==
    SUSE Linux Enterprise Server 11 (x86_64)
    VERSION = 11
    PATCHLEVEL = 0
    
    ==> Dist/sles11sp1/etc/SuSE-release <==
    SUSE Linux Enterprise Server 11 (x86_64)
    VERSION = 11
    PATCHLEVEL = 1
    
    ==> Dist/sles11sp2/etc/SuSE-release <==
    SUSE Linux Enterprise Server 11 (x86_64)
    VERSION = 11
    PATCHLEVEL = 2
    
    Signed-off-by: Olaf Hering <olaf@aepfle.de>

commit 71f87d9a8f04212fc0534b3fb423780185181585
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Thu Sep 20 19:36:21 2012 +0200

    ./run: Keep gnome-keyring from disturbing test script output

commit e5d01c21d7aa2683ad4b98cb30960219103c056d
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Thu Sep 20 19:36:20 2012 +0200

    ./run: Make sure that the temporary directory exists so test scripts can produce output files

commit e482f2faf0a1fef41358a8083153b327203505e9
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Thu Sep 20 19:36:03 2012 +0200

    python: PyInt_* no longer exists in python3, replace with PyLong_*

commit b36b44af9e177fe5c9677d430abc7cba0633049c
Author: Olaf Hering <olaf@aepfle.de>
Date:   Thu Sep 20 15:19:43 2012 +0200

    rename local variable to avoid clash with match macro
    
    match will expand to guestfs___match, rename the local variable to avoid clash.
    
    Signed-off-by: Olaf Hering <olaf@aepfle.de>

commit 64cc0dafd03bb23ef1520c8f46fd2dd44a0d8c4e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 20 17:56:40 2012 +0100

    docs: Add links to various guestfs-* man pages from guestfs(3).

commit 8aa8eb205b02e1014e5ed9577f4a9da9fd864aba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 20 17:56:10 2012 +0100

    recipes: Add section about uploading raw filesystem content.

commit 840deea12079b05a9f588016af273843d5d6e1b8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 20 11:41:16 2012 +0100

    launch: Make the "launched failed" message more explanatory.
    
    Since this is the most common error seen by people who have
    installation problems, buggy qemu, etc, and since no one reads the
    FAQ, describe in this error message what resources are available to
    debug launch problems.

commit 181de70feb86840ee9ef761107933414e37ff144
Author: Olaf Hering <olaf@aepfle.de>
Date:   Wed Sep 19 19:37:34 2012 +0200

    sysprep: handle SuSE in random-seed operation
    
    Signed-off-by: Olaf Hering <olaf@aepfle.de>

commit d6c11b0a3d4c1f7911413b19e52ab6a60ed213ad
Author: Olaf Hering <olaf@aepfle.de>
Date:   Wed Sep 19 19:32:35 2012 +0200

    sysprep: add zypper to package-manager-cache operation
    
    libzypp and zypper store their cache files in
    /var/cache/zypp/{packages,raw,solv}/ and /var/cache/zypper/RPMS/
    Add a single pattern to match both cases.
    
    Signed-off-by: Olaf Hering <olaf@aepfle.de>

commit 245608a735027bbafee8306c3ae23c55ee4eeaa1
Author: Olaf Hering <olaf@aepfle.de>
Date:   Wed Sep 19 19:26:39 2012 +0200

    sysprep: remove apache2, audit and ntp in logfile operation
    
    Add more entries to the dump ground of logfile patterns.
    
    Signed-off-by: Olaf Hering <olaf@aepfle.de>

commit ae0f60744b7f20538f8b9945ef99301fa1ecfe45
Author: Olaf Hering <olaf@aepfle.de>
Date:   Wed Sep 19 18:18:29 2012 +0100

    sysprep: handle SuSE in hostname operation
    
    SuSE based installations store the hostname in /etc/HOSTNAME.
    Add code to handle both opensuse and sles. Code to properly detect
    the latter will be added with another patch.
    
    Signed-off-by: Olaf Hering <olaf@aepfle.de>

commit 88c406feba1390f830c20bfb4c11989a4e877b91
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 19 17:34:11 2012 +0100

    sysprep: Create /etc/sysconfig/network file if it doesn't exist (RHBZ#858696).

commit aeb2f76a585afdca07691771ab4d3d50cab2cbd0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 18 12:51:36 2012 +0100

    extra-tests: Re-run the tests against upstream libvirt.

commit 157b5006dbf2db2927e48ce592a83a279513d183
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 18 12:48:36 2012 +0100

    extra-tests: Clean up some comments about the upstream qemu tests.

commit 7e4b197cb6a5071c13e407546a21f9b93fe3798d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 18 12:47:50 2012 +0100

    extra-tests: Add scripts used by these tests to EXTRA_DIST.

commit e4ef926d6f3178b48953c143b8faafc79fd6e095
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 17 23:06:44 2012 +0100

    Version 1.19.42.

commit a3ce00059934a3b72fd72c9d8fc67de99ca9907a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 17 22:52:53 2012 +0100

    tmp: Ignore libguestfsXXXXXX temporary files in tmp dir.

commit 5479b8db587120c1582d755c056ccf26bc095806
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 17 22:41:25 2012 +0100

    ./run: Write temporary file in tmp directory.
    
    We have a new 'tmp' directory under the top level dir for temporary
    files.  Use it for the temporary output from the ./run script.

commit f9f0767e20847734db3747c06b4ff11729a62a07
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 17 16:34:59 2012 +0100

    launch: libvirt: Pass TMPDIR to qemu subprocess.

commit a2dc3dbad0b9e6ee827247ee3ceefca480f5a052
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 17 16:25:53 2012 +0100

    New API: rm-f: remove a file, ignoring errors if it doesn't exist.

commit 74283d58cfb62e6cc73bfe0f62ca142ddc1e8fb2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 17 14:03:28 2012 +0100

    inspect: Fix segfault and error caused by earlier code cleanups.
    
    This fixes commit e128a627fb8f39f4f4c11b782cef895bd79f0282.

commit 2e17d78178eb085bdf54eb170bf036e0d7143c19
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 17 13:38:38 2012 +0100

    launch: libvirt: Disable sVirt if using a custom qemu (ie. setting <emulator>).
    
    See:
    https://bugzilla.redhat.com/show_bug.cgi?id=857659
    especially Dan's comment 4.

commit e128a627fb8f39f4f4c11b782cef895bd79f0282
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 17 13:15:49 2012 +0100

    Fix multiple errors where jump skips variable initialization.
    
    <file>: error: jump skips variable initialization [-Werror=jump-misses-init]
    
    This has only just appeared, possibly related to previous gnulib
    update.  In any case, this is just code motion / cleanup.

commit c387b69cba8f145438188b2b4567abbc9580ade0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 17 13:31:45 2012 +0100

    daemon: stubs: Move all arg decls to top of function.
    
    For some reason, argument declarations were handled
    inconsistently for strings and non-string arguments.
    Non-string arguments were all declared at the top of the
    function stub, where as string arguments were declared
    in place.
    
    Be consistent.
    
    This is just code motion.

commit 176bd182d3f94fe7e774b8af0b56c014f639d6c7
Author: Jim Meyering <jim@meyering.net>
Date:   Mon Sep 17 11:51:05 2012 +0200

    maint: remove a subsumed syntax-check rule
    
    * cfg.mk (sc_prohibit_trailing_blank_lines): Remove rule.  It is now
    subsumed by the much more efficient sc_prohibit_empty_lines_at_EOF
    rule in gnulib's maint.mk.

commit 3988dec9b7bbf3cb8628aff879d1f518a9d52404
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 17 10:15:43 2012 +0100

    syntax: Exclude examples and test program from <config.h> requirement
    (thanks Jim Meyering).

commit 72ab351acef2f2bc6b0e4f36d69e94f8fa064f3c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 17 10:12:20 2012 +0100

    syntax: Allow strncpy in launch-*.c files (thanks Jim Meyering).
    
    We use strncpy, justifiably, to copy the socket name into
    the fixed length Unix domain sun_path buffer.

commit 369709177e47773eaa37f1fdbe8d9967b21d1133
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 17 10:10:17 2012 +0100

    syntax: Exclude examples from strcmp and strncmp checks (thanks Jim Meyering).

commit 552576c7f9ccb1862bcfc9fbd5c301d775aaf90c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 17 10:06:28 2012 +0100

    syntax: Ignore documentation when testing for magic number exit() calls (thanks Jim Meyering).

commit 2100ba14fbfaf3e89059d9112959463506932d74
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 17 09:54:27 2012 +0100

    syntax: Exclude PO files from doubled words test (thanks Jim Meyering).

commit cb13ffe190ac41a9b77fe27521838f495c1a5077
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 17 09:51:01 2012 +0100

    syntax: Remove definitions of O_CLOEXEC, except in examples (thanks Jim Meyering).
    
    The gnulib <fcntl.h> replacement header will now define this symbol if
    it's not defined already.

commit 2337b9ccd729e05b46cf6abb1f4173e6e994c1cb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 17 09:47:15 2012 +0100

    syntax: Exclude period in error message checks from PHP programs (thanks: Jim Meyering).

commit fbdcfe2b77b6c272876143779912d41b0849111f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 17 09:45:38 2012 +0100

    syntax: Disable cast arg to free test (thanks Jim Meyering).

commit b95fff13577cdd3da4300bbd639441cc77cf935a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 17 09:44:11 2012 +0100

    syntax: Exclude certain files from bindtextdomain test (thanks Jim Meyering).

commit e942c02a2eeb4d55606dec5fe943ea7d81f989ba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 17 09:52:31 2012 +0100

    Update to latest gnulib.

commit 946ae89a78995b58a211e1791a81be8d6949802f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Sep 16 13:35:07 2012 +0100

    Version 1.19.41.

commit e6bd0b87eb753fa96b6533b0dbe498697701ad3a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 15 17:10:34 2012 +0100

    extra-tests: Write a qemu wrapper script on the fly.
    
    Passing the $upstream_qemu environment variable is not reliable when
    libvirt is involved: Environment variables are passed to the first
    instance of the session libvirtd, but because libvirt reuses the
    session libvirtd, subsequent environment variable settings are lost
    (this is filed as RHBZ#856619).
    
    Bypass all of this by writing a custom qemu-wrapper.sh which contains
    the hard-coded values we want.

commit 2fd51c28fd5bb3114b4a078d1698732a6e66bfc1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 15 13:52:17 2012 +0100

    extra-tests: Rerun extra tests with regular appliance attach method.
    
    If libvirt is being used as the backend, rerun all the extra-tests
    again using the regular appliance backend.

commit 509dd90c43afed75b861b7d82ebe8739d3500d54
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 15 13:47:39 2012 +0100

    extra-tests: The upstream qemu test now reruns all the extra tests.

commit eeb0c598ec8caa50998336713ed4e62902e0a74d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 15 14:40:28 2012 +0100

    extra-tests: Fix libvirt URI so we can run tests with libvirt attach-method.

commit 2cac8d490e9884a8c7376e49fd1cda2e3d3abec1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 15 13:28:24 2012 +0100

    syntax: Remove trailing whitespace.
    
    Found by 'make syntax-check'.

commit 44a11e955b31f7c0cf463a04d640263cccdd0c4d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 15 13:27:50 2012 +0100

    generator: Remove inaccurate comment.
    
    The correct way to extend functions is documented in generator/README.
    This comment was no longer accurate.

commit 6361810b53be4d5e0513b4f7c11d29cf1d6d3b45
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 15 13:21:55 2012 +0100

    syntax: Replace test == with = or -eq as appropriate.
    
    Found by 'make syntax-check'.

commit d26f40236196eb2cdf81fa62cbfa28ca89623b28
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 15 13:19:12 2012 +0100

    syntax: xfs: Rewrite split_strdup function to avoid use of strncpy.
    
    Found by 'make syntax-check'.

commit b0cefb417d01c6dcb87cc6bafe9c19b98c690c9d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 15 13:11:45 2012 +0100

    syntax: Use STREQ/STRNEQ in place of strcmp.
    
    Found by 'make syntax-check'.

commit 90b7c53b70dda9a131cf13beb5d1e77cc41534f7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 15 13:08:08 2012 +0100

    syntax: Remove include <signal.h> in file that doesn't use it.
    
    Found by 'make syntax-check'.

commit 2383d7a78e8abc308e36b2045087a9785c893f49
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 15 13:01:10 2012 +0100

    syntax: Remove PATH_MAX-sized buffers allocated on the stack.
    
    On Linux PATH_MAX is 4096, but on some platforms it can be much larger
    or even not defined (ie. unlimited).  Therefore using a PATH_MAX-sized
    stack buffer is not a great idea for portable programs.
    
    This change removes use of PATH_MAX-sized stack-allocated buffers.
    
    This change only applies to the library and standalone programs.
    Inside the daemon, memory allocation is much more complicated so I
    have not changed those (yet).
    
    Found by 'make syntax-check'.

commit a67129b0fb45b2f83eb711c6c599569d0f53e580
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 15 12:38:07 2012 +0100

    syntax: Remove gnulib "ignore-value.h" in files that don't use it.
    
    Found by 'make syntax-check'.

commit d6bb49a172c369c3bcc85771af804649c3733ef3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 15 12:35:59 2012 +0100

    syntax: Remove include <dirent.h> in files that don't use it.
    
    Found by 'make syntax-check'.

commit 9fce75aa13de52561ec0f4ae083c4ab0fa4455d1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 15 12:34:41 2012 +0100

    syntax: Remove gnulib c-ctype.h in files that don't use it.
    
    Found by 'make syntax-check'.

commit 6272e49f51a192f2f8ecd8ffbb018f60ca0bac28
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 15 12:32:41 2012 +0100

    syntax: Remove include <assert.h> where assert is not used.
    
    Found by 'make syntax-check'.

commit da75618fb2eecb644d8ec84c9584c402b0bc5339
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 15 12:31:07 2012 +0100

    lib: Rearrange headers.
    
    This is just code motion.

commit 8747ff743216fbb6119606c22966e2283f30a54a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 15 12:30:12 2012 +0100

    lib: Remove unused headers <arpa/inet.h> and <netinet/in.h>
    
    These were used back in the day when we used TCP for the
    communications channel with the guest.

commit dec73f70fc5320faec46a21f27aae6748cea3450
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 15 12:25:28 2012 +0100

    syntax: Remove HAVE_*_H tests which are always true.
    
    Gnulib supplies replacements for these headers, so there
    is no need to test.

commit cd8976a5b52425f9d7c45249e1a593a341d91c52
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 15 12:22:44 2012 +0100

    perl: Add <stdio.h> and <stdlib.h> for printf and malloc.

commit 188b44ee458a666bee8a18ed47cccdec25859aff
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 15 12:21:24 2012 +0100

    perl: Include <inttypes.h> and assume it always defines PRId64 and PRIu64.
    
    If these are not defined in the header files, it's a problem on
    the platform which we should fix with gnulib.  Our replacement
    definitions might be wrong here.

commit 5a46eadd3dcab1b8944eabc0f21097048e0ebe13
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 15 12:15:47 2012 +0100

    lib: These optargs structures are not modified, hence const.

commit ae137124ca143e57f16d103f24cb3f21a3157b09
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 15 11:50:32 2012 +0100

    syntax: Remove test for TAB indentation.
    
    Nothing particularly wrong with using TABs for indentation,
    and this test also has a lot of false positives.

commit 57d089fd6d28ed351ca30259c975fcee6e02fee8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 15 11:33:35 2012 +0100

    syntax: xfs: Remove useless if before free.
    
    Found by running 'make syntax-check'.

commit 6951becfdb0b69b4defff4393f48314e884ad7c1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 15 11:53:44 2012 +0100

    docs: Fix documentation of syntax-check target, add extra-tests.

commit 244e9a2ac40fa8a1494f769740947c8a600ee8d7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 14 23:03:37 2012 +0100

    faq: Make the legal section less unnecessarily legalistic.

commit 19da851610fc14b547ff9e25101921f69edc7f2f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 14 23:02:23 2012 +0100

    faq: Tidy up headings.

commit 2c59af77545c764ddded93af2c0a0611be79376e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 14 22:57:02 2012 +0100

    faq: Add more answers about read-only disks.

commit 6575ac4c61cc41a2e3c662b58fd0e0cee2b6a2e3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 21 16:50:33 2012 +0100

    launch: libvirt: Enable sVirt.

commit 5b02c8d0bcdf815702b069cd69a8790ee41a310f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 14 16:45:43 2012 +0100

    test-9p: Disable this test with libvirt.
    
    This test doesn't work with sVirt if SELinux is enforcing, because
    qemu won't be able to access the 9p-exported directory on the host.

commit 834747a85d80ce02e9deca32be89199c10cd74fd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 14 14:42:24 2012 +0100

    build: Create new 'tmp' directory for tests.
    
    Having a separate directory means:
    
    (1) It's easy to clean up orphaned temporary files, the appliance,
        etc.
    
    (2) You can put an SELinux label on this directory so that qemu can
        write to it when you're using sVirt and SELinux is enforcing:
    
        chcon --reference=/tmp tmp

commit aa9e0057b19e29f76c9a81f9aebeeb1cb5bf1fdb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 14 15:50:38 2012 +0100

    launch: libvirt: Mark appliance disk as <shareable/> (thanks Dan Berrange).
    
    This is a fix for multiprogramming: If two instances of libguestfs
    share the same appliance disk, then libvirt would unlabel the disk
    when one of the instances closes the handle, resulting in the other
    qemu being unable to continue accessing the appliance.
    
    Adding the flag makes libvirt understand that the disk is shared so it
    doesn't do this, and it apparently handles locking correctly too if we
    were using sanlock.

commit 281b155800f2e62b994e59bef418ca200da8e93a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 14 11:34:26 2012 +0100

    test-tool: Print more environment variables.
    
    This prints LIBVIRT_*, LIBVIRTD_*, LD_* and PATH, since these are all
    useful for debugging and could affect libguestfs in some way.

commit 8acdc23622ea95a233ac831d67c143517aa94bba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 13 19:31:51 2012 +0100

    fish: Replace '_' with '-' in deprecation cross-refs (thanks Olaf Hering).

commit d9a98dc1cdcfb185e659c0d02f74ae6739b340db
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 12 21:38:48 2012 +0100

    lib: guestfs_disk_format: Set LC_ALL=C instead of LANG=C.
    
    LC_ALL takes precedence over LANG.  See:
    
    http://pubs.opengroup.org/onlinepubs/7908799/xbd/envvar.html

commit 97a1439d90b819b32177a69c9f318b47040b49d3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 6 12:46:57 2012 +0100

    release-notes: Add 'draft' background image.

commit 81c682f1295a934d18bd4dc9e42b8e843df0c207
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 5 13:56:34 2012 +0100

    extra-tests: Don't use $QEMU as a variable.
    
    Since 'QEMU' is set (overwritten) by the autoconf-generated Makefile,
    this test would always test installed qemu, not upstream qemu,
    making it pretty useless.  Use another name for this variable.

commit 3d84ca76fec491015030daa53e9122b03032ddfd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 5 11:12:52 2012 +0100

    generator: Remove generated and unused files from previous runs of the generator.
    
    If you go back in time in git (eg. git reset, git bisect) then you can
    end up in a situation where a file that was generated by a later
    version is left around unused in the earlier version.
    
    This isn't a problem for most things, but gobject documentation
    generation picks up any file in a directory, even unreferenced ones,
    and breaks.  So the correct thing to do is to remove these files.

commit 169ac913e9930f7e4a27f395e6c06901f7c849c3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 5 11:12:25 2012 +0100

    generator: gobject: Use a more normal way to output files.
    
    The generator output is identical, verified by comparing the
    output files before and after the change.

commit dc8aca2cf92cc4674a8aed401922bced87524e7e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 4 23:16:47 2012 +0100

    Version 1.19.40.

commit 9c4097dfd827d3b647a9799f11b3a91daecc4f6a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 4 22:29:09 2012 +0100

    sparsify: Fix use of closed handle (thanks Olaf Hering).
    
    This fixes commit faaedeb3432253847107ca2c4530f681c6a1e385.
    
    Also contains an update to the test which tests the format
    auto-detect path.

commit bdb5689f58c0db18de28d6a703b3af4f22eded38
Author: Olaf Hering <olaf@aepfle.de>
Date:   Tue Sep 4 17:43:39 2012 +0200

    fix fuse_opt_add_opt_escaped return type
    
    I: Program returns random data in a function
    E: libguestfs no-return-in-nonvoid-function guestmount.c:75
    
    The function fuse_opt_add_opt_escaped has only one caller and a return
    code is not checked.
    
    Signed-off-by: Olaf Hering <olaf@aepfle.de>

commit 853feb971f4d111346d1f65211dbbd75ce1a9aae
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 4 17:10:23 2012 +0100

    Version 1.19.39.

commit c4171ad58f61f72f5f6c6c8e711a7bcc19d20f75
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 4 15:34:35 2012 +0100

    shutdown: Add 'check_for_errors' hint along the shutdown path.
    
    This hint tells the backend whether anyone cares about errors when the
    appliance is shut down.
    
    Currently this only has any effect on the libvirt backend, where it
    controls whether or not we use the VIR_DOMAIN_DESTROY_GRACEFUL flag.

commit cc4b3139d17b98d734d98286bb698bb3b105da05
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 4 15:25:22 2012 +0100

    launch: libvirt: Add VIR_DOMAIN_DESTROY_GRACEFUL flag.
    
    We want libvirt to report failures when destroying the guest.  See:
    
    https://bugzilla.redhat.com/show_bug.cgi?id=853369#c12

commit 05beac65e58ef20899c7a50888a2854c07f83db9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 4 14:02:58 2012 +0100

    rescue: Add an expect-driven test for the virt-rescue command.
    
    This command was not tested at all.  As a result we didn't notice that
    it was broken for a long time (RHBZ#853159).
    
    This adds a test that drives the command through a pty.  It uses the
    perl 'Expect' module, although this is not required.

commit 8248a346d71ed7fc964595f6e973ff6593cdc217
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 4 14:37:44 2012 +0100

    proto: Don't set g->fd[] to /dev/null in direct mode, fixing virt-rescue (RHBZ#853159).
    
    https://bugzilla.redhat.com/show_bug.cgi?id=853159
    
    git bisect pointed to the following commit:
    
      commit ec8e3b6cad170d08ac18b580792dfb137eb171dc
      Author: Richard W.M. Jones <rjones@redhat.com>
      Date:   Fri Jul 20 14:24:10 2012 +0100
    
        launch: Abstract attach method operations.
    
        g->attach_ops points to a structure which contains the
        operations supported by each attach method backend
        (ie. appliance, unix, etc.).
    
    Since that commit was essentially just code motion, it wasn't clear
    why virt-rescue should be affected by it.
    
    In fact the reason is as follows:
    
    (1) In direct mode, we don't need g->fd[] (which would normally be
    connected to the stdin/stdout of qemu).  So we opened them on
    /dev/null so they had some value.
    
    (2) accept_from_daemon / read_log_message_or_eof reads from g->fd[1].
    Since this is connected to /dev/null, it always reads EOF.
    
    (3) This would cause child_cleanup to be called.  This is completely
    unintentional: we don't want to cleanup the child at this point, even
    in direct mode.
    
    (4) Prior to the commit above, child_cleanup first waited for the
    process to exit (ie. waitpid).  This happened to work, since we are
    effectively waiting for the user to exit virt-rescue.
    
    (5) After the commit above, the order of operations was changed so
    that we first killed qemu before waiting for it.  This broke
    virt-rescue.
    
    The fix is to change direct mode so that it leaves g->fd[]'s as -1.
    The rest of the protocol code can deal with this situation -- it
    ignores the log fd instead of trying to read from it.

commit 2e36adf83ce4a9cbccd313d6f3a88b5c5973ce44
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 4 12:04:31 2012 +0100

    rescue: If attach-method is 'libvirt', force it to be 'appliance'.
    
    The libvirt backend currently doesn't support direct mode.  We should
    make that work in future.  As a workaround, force the attach-method to
    be 'appliance' in this case.

commit 6fdf1f40fa85d2e6e7a1118f4cfa532ea9831b89
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 4 11:53:57 2012 +0100

    rescue: If -v / debugging enabled, don't mask error messages.
    
    We set the error handler to NULL in order to mask "normal" error
    messages that we expect to see because of the unusual way that
    virt-rescue runs the appliance.  However if the user selected -v /
    enabled debugging, then it is reasonable to expect they want to see
    every message, so do not mask anything.

commit 77f70a5f7cd908609833a948031544c0befbc874
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 4 11:49:51 2012 +0100

    launch: libvirt: Direct mode flag is not (yet) supported, so give an error in this case.
    
    We definitely intend to support this in future.

commit 381c067d5463b669f82d0601975f5a3f0e6faaba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 4 11:55:13 2012 +0100

    Update release notes (text file).
    
    This updates commit 9e4ac650e4c4d934a91a88d7e4aaf5495845a71b.

commit 9e4ac650e4c4d934a91a88d7e4aaf5495845a71b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 4 11:31:28 2012 +0100

    Update release notes.

commit d03361b1afee09135b0cbd92a2cc180c66c5f84e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 4 09:03:08 2012 +0100

    lib: Add tests to the disk-{format,virtual-size,has-backing-file} APIs.

commit 4ed981bd5f0a158db3cfb87794628806bf00d443
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 4 08:58:21 2012 +0100

    New APIs: disk-virtual-size and disk-has-backing-file.

commit e388c4f3fd26c8756ac33e94b02f8435a0179bc1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 4 08:39:04 2012 +0100

    lib: Reimplement qemu-img info parser for flexibility.
    
    This allows other fields from the output of 'qemu-img info'
    to be parsed out.
    
    This updates commit 20902e7ce02fa375d5d336e6b984f615472ad1b1.

commit 1030e8aba0993b48cc36c4aa78cd6665914ed99c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 4 09:39:25 2012 +0100

    Fix guestfs_disk_image API to work with relative paths.
    
    guestfs_disk_image makes a symbolic link to the real filename in order
    to sanitize the filename.  However this fails if the filename is a
    relative path.  Call realpath(3) to make the filename canonical.
    
    This fixes commit 20902e7ce02fa375d5d336e6b984f615472ad1b1.

commit 26732678c6f23730f28a37694be932c96e3c4e50
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 3 18:35:17 2012 +0100

    Version 1.19.38.

commit 47ddb77fb12233708905f741aa04fca302e37bce
Author: Olaf Hering <olaf@aepfle.de>
Date:   Mon Sep 3 18:01:37 2012 +0200

    daemon: provide list of checksum commands
    
    While adding the list of external commands I missed the
    various checksum tools.
    
    Signed-off-by: Olaf Hering <olaf@aepfle.de>

commit faaedeb3432253847107ca2c4530f681c6a1e385
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 3 16:46:10 2012 +0100

    sparsify: Use guestfs_disk_format to autodetect input format (RHBZ#853762).

commit 9f8ba4e8d16e5c50c3cd657f9beae3518947b6ed
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 3 16:45:48 2012 +0100

    launch: libvirt: Use guestfs_disk_format API to autodetect input format.

commit efdc2bae40b3e74b90a61f82bcb7b18830697272
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 3 11:34:01 2012 +0100

    guestfs(3): Document disk image formats and how to detect them.

commit 20902e7ce02fa375d5d336e6b984f615472ad1b1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 3 15:56:29 2012 +0100

    New API: guestfs_disk_format
    
    Detect the disk image format of a file, in a secure way.

commit b6413f8dbef92c46c4baf9499366716a166f2163
Author: Olaf Hering <olaf@aepfle.de>
Date:   Mon Sep 3 10:58:27 2012 +0200

    daemon: remove call to obsolete udevsettle
    
    udevadm is included in all reasonable recent distributions.
    This avoids 'command not found' errors in verbose mode.
    
    Signed-off-by: Olaf Hering <olaf@aepfle.de>

commit c659cf8ea602755035460ca7ac4a794da19df597
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Mon Sep 3 17:00:11 2012 +0800

    TODO: remove the implemented hostname removing feature
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 98bf41d80d4ecdd65f7974d134d34a3926a39a75
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Mon Sep 3 16:05:37 2012 +0800

    sysprep: remove hostname from ifcfg-*
    
    Remove hostname from network interface configuration.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 3820a2578c120056683a4b152b72021f82b2c821
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 3 08:52:33 2012 +0100

    generator: Test zero args, one optarg; and 63 optargs.
    
    This just generates the code; it's not called.

commit f65dee769d1fc53c5963c381bf8a1bf02654f78c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 3 09:35:56 2012 +0100

    java: Fix >= 32 optargs (thanks Wanlong Gao).

commit d331fd70e2c3ba2815460c8cd93a97eb9a81c6a5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Sep 2 18:26:48 2012 +0100

    generator: Rename 'generator_*' as '*'.
    
    This is a simple renaming of the files/modules.
    
    Note that in OCaml, module names are derived from filenames by
    capitalizing the first letter.  Thus the old module names had the form
    "Generator_api_versions".  The new modules names have the form
    "Api_versions".

commit 11d655ab83211eb6808d32296cbbab31fc023aac
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Sep 2 19:47:26 2012 +0100

    TODO: Suggest removing hostname from ifcfg-eth* files.

commit b799bc58a84e155783afae23f64f27e23ddd06dd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Sep 2 16:26:09 2012 +0100

    recipes: Checksum file/device.  Download to stdout.

commit a1d981edeae120a0523d0974c703f1a956202415
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 31 19:12:27 2012 +0100

    tests: Attach copyright and license (GPLv2+) notices to various test scripts.
    
    For some reason these tests did not have license notices.

commit d754f4a5a30e0473754004c187b919dcc05e8f6f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 31 19:05:51 2012 +0100

    tests/rsync: Allow rsync test to be skipped by setting SKIP_TEST_RSYNC_SH=1.

commit 42b892a8c555c15f1066341faaec359c5126af10
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 31 18:34:24 2012 +0100

    Version 1.19.37.

commit 3ed3e23ed09a765a3275ca2d82518b335ede759f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 31 15:20:25 2012 +0100

    Copy the kernel so that libvirt can add an SELinux label to it. NB. This requires febootstrap >= 3.20 with --copy-kernel flag.

commit 3728c122f1b2c235aaf92da077e307ffd2fb2178
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 31 15:14:51 2012 +0100

    guestfs-internal.h: Organize functions by file.
    
    This is almost just code motion.  While doing this I discovered two
    prototypes for functions which no longer exist:
    
      * guestfs___launch_appliance
      * guestfs___launch_unix
    
    so these prototypes have been removed.  The rest are rearranged more
    logically.

commit b17d1896168bed2dc4c8c82bc368e79e10b14457
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 31 14:30:10 2012 +0100

    tests: Make mkswap and tar tests conditional on linuxfsuuid and xz features.

commit 87cb1549761c9441b0fa7ee9b6a85b8eeb164c5c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 31 10:23:41 2012 +0100

    tests/mount-local: Link test program with gnulib.

commit 4e6bf1ed653540a8954a6a11fe5a0fb424013af9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 31 09:53:44 2012 +0100

    src/dbdump.c: Shouldn't depend on HAVE_HIVEX (thanks Tao Zhou).

commit 0306c98d319d189281af3c15101c8d343e400f13
Author: Olaf Hering <olaf@aepfle.de>
Date:   Thu Aug 30 20:51:27 2012 +0200

    daemon: collect list of called external commands
    
    guestfsd calls many different tools. Keeping track of all of them is
    error prone. This patch introduces a new helper macro to put the command
    string into its own ELF section:
    
    GUESTFSD_EXT_CMD(C_variable, command_name);
    
    This syntax makes it still possible to grep for used command names.
    
    The actual usage of the collected list could be like this:
    
      objcopy -j .guestfsd_ext_cmds -O binary daemon/guestfsd /dev/stdout |
      tr '\0' '\n' | sort -u
    
    The resulting output will be used to tell mkinitrd which programs to
    copy into the initrd.
    
    Signed-off-by: Olaf Hering <olaf@aepfle.de>
    
    RWMJ:
     - Move str_vgchange at request of author.
     - Fix snprintf call in daemon/debug.c

commit 4aa1464d42c62e8cbff4669f01f53f0425c287e3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 30 20:09:16 2012 +0100

    launch: appliance: app.virtio_scsi must not be bool.
    
    This is used to store values 0..3, so it mustn't be a bool.  Ooops.
    
    RHEL 5's gcc revealed this bug.

commit 163e030ee13644ad9efe1e078aff47b879657333
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 30 17:29:36 2012 +0100

    daemon: Remove e2prog hack (only needed for RHEL 5).
    
    Instead this patch will be carried out of tree in the oldlinux branch.

commit 0573c199502f54f07b8de190702ba9fe87a06506
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 30 16:39:48 2012 +0100

    Version 1.19.36.

commit c945609ac9f19ca36ac14093f71dccfc70de2dbe
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 30 15:35:16 2012 +0100

    launch: libvirt: Remove code for creating sockdir.
    
    Create the sockets in g->tmpdir as usual.  It's a bug in libvirt that
    it doesn't label the sockets correctly no matter where they are
    located.

commit a7de51b3c80d03ef8a064d658ed0b96a9eaca4d9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 30 15:20:00 2012 +0100

    launch: libvirt: Avoid memory leak if sockdir is not created (found by valgrind).

commit 8af32b9d5fa0601fabffd9550f1cdc97ac78306a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 30 13:29:49 2012 +0100

    FAQ: Remove link to old RHEL 6.3 preview repo.

commit 7036a3bccfab22eb4ed2e66ef0e69a058264e323
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Thu Aug 30 17:25:47 2012 +0800

    NEW API:xfs:xfs_repair
    
    Add a new api xfs_repair for repairing an XFS filesystem.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>
    
    RWMJ:
      - Fix non-error return path so it doesn't send two replies.
      - Document return code.

commit bcbad66b185048ee49f58c49ae382f6e69d3c666
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 30 10:46:35 2012 +0100

    docs: Add guestfs-release-notes.txt to Makefile deps.

commit 2d6bf3ba70c50996062e90f78af63c4811bf516b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 30 08:58:00 2012 +0100

    tests/big-dirs: Don't run this test by default.

commit 8742713050dd20a1f11d5d32b468ae2beb644a80
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 29 20:59:06 2012 +0100

    run: Make --test flag print the time taken to run the test.
    
    This is useful because it lets us see which tests take
    the longest.

commit 1ac36e4f3692c256159d3e8b9c7d7b04923e02fd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 29 19:00:02 2012 +0100

    Version 1.19.35.

commit 9ef22fa921f440560eb953177d83fae130bbaac4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 29 18:34:47 2012 +0100

    python: Convert OInt64 using PyLong_AsLongLong so 64 bit ints work correctly.
    
    This avoids the following error on 32 bit machines:
    
      OverflowError: Python int too large to convert to C long

commit b2378a81bb7acb94409469e8b19d0c717811a99d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 28 18:54:27 2012 +0100

    Update inspection and example programs to use new hivex* APIs (RHBZ#852394).
    
    I tested this by comparing the output of virt-inspector over Windows
    guests before and after the change, which was identical:
    
    $ md5sum `ls -1 /tmp/*.before /tmp/*.after`
    c292d6629b5a761eccb4a279754399b4  /tmp/Win2003.after
    c292d6629b5a761eccb4a279754399b4  /tmp/Win2003.before
    eb1e1ff29208a9ee46e9c100dfec26b2  /tmp/Win2012.after
    eb1e1ff29208a9ee46e9c100dfec26b2  /tmp/Win2012.before
    d060a95d7ffe5dce6c4e66feb80c2837  /tmp/Win7x32.after
    d060a95d7ffe5dce6c4e66feb80c2837  /tmp/Win7x32.before
    8914eee70ac4f8a0317659e09e00dcdc  /tmp/Win7x32Dynamic.after
    8914eee70ac4f8a0317659e09e00dcdc  /tmp/Win7x32Dynamic.before
    a2dcdfc0f9d64054640875aa791889e0  /tmp/Win7x32TwoDisks.after
    a2dcdfc0f9d64054640875aa791889e0  /tmp/Win7x32TwoDisks.before
    5ed49568a5147dce7517c99de41ebf2e  /tmp/Win8previewx64.after
    5ed49568a5147dce7517c99de41ebf2e  /tmp/Win8previewx64.before
    fdfc7d272b79a665ae3313ae1ae30660  /tmp/WinXP.after
    fdfc7d272b79a665ae3313ae1ae30660  /tmp/WinXP.before
    3c705444be664f1316b21c5d8d3cb0be  /tmp/WinXPRecConsole.after
    3c705444be664f1316b21c5d8d3cb0be  /tmp/WinXPRecConsole.before

commit 288cc74d77fd80e40a442344d9d0ce00162c1fb4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 29 13:01:53 2012 +0100

    New API: guestfs_hivex_value_utf8
    
    A convenience function that reads a value from the registry
    and returns it as UTF-8.

commit 8a723ca62eb4f93f19c5c66beffaf70997afb64c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 28 16:03:50 2012 +0100

    New APIs: hivex_*
    
    Transscribe many hivex(3) APIs into the libguestfs API.
    
    There is one hive handle per libguestfs handle, as with Augeas.
    
    Note that hivex uses iconv_open for some APIs (eg. hivex_value_string).
    But since we delete all the i18n files from the appliance, this
    doesn't work -- iconv_open returns EINVAL.  Therefore hivex APIs which
    require iconv cannot be bound in the daemon.

commit 228d49bb842cda517b414bbfab460e8be429cc5f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 28 19:11:39 2012 +0100

    lib: Remove AUGEAS_CFLAGS, AUGEAS_LIBS.
    
    The library doesn't actually use libaugeas, except indirectly via the
    libguestfs API.  The libguestfs API implements this in the daemon, so
    there's no need for the library to link to augeas at all.

commit 044c5b26d7ed1bde70cbeacb0ffa3f8bcb932092
Author: Olaf Hering <olaf@aepfle.de>
Date:   Wed Aug 29 15:15:12 2012 +0200

    remove ulockmgr from fuse LDFLAGS
    
    libguestfs fails to build with --enable-fuse on openSuSE 11.4 and
    earlier because the included fuse version does not include
    libulockmgr.so. configure already used pkgconfig to retrieve the correct
    CFLAGS, so there is no need to hardcode -lulockmgr.
    With this change the build succeeds again.
    
    Signed-off-by: Olaf Hering <olaf@aepfle.de>

commit 684efb3706795bdd8cb0d4c026067fb4d70e23d1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 29 14:15:39 2012 +0100

    java: Further java/java-home fixes.
    
    In particular the JVM executable is now called $JAVA_EXE.
    
    This fixes commit 40b9c14ca9af3b31ea1cf5336142d63313bbae39.

commit 15cd9dde5e0e4a7d510de71ef8991750971cf6d1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 29 10:31:09 2012 +0100

    perl: bindtests: Fix 64 bit integers on input on 32 bit Perl interpreter.

commit 40b9c14ca9af3b31ea1cf5336142d63313bbae39
Author: Wulf C. Krueger <philantrop@exherbo.org>
Date:   Tue Aug 28 18:02:19 2012 +0200

    Fix Java detection and rename --with-java-home to --with-java.
    
    Without this patch, if JAVAC points to a valid executable, --with-java-home=no
    is not respected but the build simply fails.
    Furthermore, --with{,out}-java is a more common form and more in-line with all
    other options.

commit 9ef36632ca76ea11b5227e977a9fb9db3fad0d01
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 28 17:48:19 2012 +0100

    launch: libvirt: Don't crash if shutdown_libvirt is called early in launch.
    
    The assert (conn != NULL) was being triggered with this
    stack trace:
    
        at launch-libvirt.c:1305
        fd=<optimized out>, error_if_eof=error_if_eof@entry=0) at proto.c:222
        size_rtn=size_rtn@entry=0x7fffffffdb34,
        buf_rtn=buf_rtn@entry=0x7fffffffdb58) at proto.c:548
        libvirt_uri=<optimized out>) at launch-libvirt.c:391

commit cab48ce73cb19b1aa8784e6c6a3cb8f47b0cbc0e
Author: Wulf C. Krueger <philantrop@exherbo.org>
Date:   Mon Aug 27 20:28:48 2012 +0200

    Fix disabling the Perl bindings.
    
    --disable-perl isn't currently respected because $PERL correctly points
    to the perl executable and $missing_perl_modules doesn't prevent the
    perl parts to be installed either. Thus, a check for $enable_perl is
    needed.

commit 81709b5b70f0a3388ba7df80072756855bceaa81
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 28 11:15:13 2012 +0100

    Version 1.19.34.

commit 512f21c965c5d4bf1faf922d6a241c397f703e67
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 28 12:56:38 2012 +0100

    po-docs: Copy all *.1 and *.3 files to the install dir.

commit 67a803e1f28ef0ba7549ef71cd5a094dabf962a7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 28 13:16:51 2012 +0100

    po-docs: Update the list of man pages.

commit ddc67d94f37ca4e942cb385d4e5ec476766fef12
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 28 13:15:29 2012 +0100

    po-docs: Fix podwrapper so it works on translated POD files.
    
    These don't contain literal strings like "AUTHORS" (they have the
    translated versions instead) and so checking for these English strings
    is rather useless.
    
    Also we don't usually have the '--license' parameter conveniently
    around so don't enforce this section.

commit 540fbfcf34089e2baeea9c94a850cdea0c0db903
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 28 12:55:01 2012 +0100

    po-docs: Don't output translated virt-sysprep page as HTML.

commit 23b7fe09e1589c3c9ca5f52a9588ad1c73649b14
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 28 12:45:58 2012 +0100

    tools: Fix podwrapper errors in tools directory.
    
    This also makes the test for license "code" less strict, so it should
    only match POD, not Perl comments.
    
    This fixes commit 2f97bf873b64384835f257f8916bf1ebb2af62b4.

commit 0a275bd090850963f331a115a4fadfbf1dfb1caf
Author: Masami HIRATA <msmhrt@gmail.com>
Date:   Sun Aug 26 19:32:04 2012 +0900

    Mac OS X: Fixed combination of running autogen.sh on Linux and building on Mac OS X
    
    Signed-off-by: Masami HIRATA <msmhrt@gmail.com>

commit d555a68ca6475bbb6f7f60ae1bdcdffa99df351f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 28 04:46:04 2012 -0400

    podwrapper: Ignore $parser->html_charset if it fails (thanks Wulf C. Krueger).
    
    This method was added in Pod::Simple 3.16 so earlier versions of Perl
    won't have it.  It's not the end of the world if we don't set it.

commit f23a5c468e959f86df89e2a4e8aa9160eca532f8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 28 04:00:52 2012 -0400

    Modified API: mkswap now takes optional arguments.
    
    Add optional label and uuid arguments, and deprecate mkswap-L and
    mkswap-U.
    
    This also adds a call to udev_settle after creating the swap device.
    This is an attempt to workaround the following problem seen in Koji
    and Rawhide:
    
    libguestfs: trace: mkswap_L "swapit" "/dev/sda1"
    libguestfs: send_to_daemon: 72 bytes: 00 00 00 44 | 20 00 f5 f5 | 00 00 00 04 | 00 00 00 83 | 00 00 00 00 | ...
    guestfsd: main_loop: proc 210 (part_disk) took 2.28 seconds
    guestfsd: main_loop: new request, len 0x44
    mkswap -f -L swapit /dev/sda1
    libguestfs: recv_from_daemon: 40 bytes: 20 00 f5 f5 | 00 00 00 04 | 00 00 00 83 | 00 00 00 01 | 00 12 37 cf | ...
    libguestfs: trace: mkswap_L = 0
    libguestfs: trace: swapon_label "swapit"
    libguestfs: send_to_daemon: 56 bytes: 00 00 00 34 | 20 00 f5 f5 | 00 00 00 04 | 00 00 00 ae | 00 00 00 00 | ...
    guestfsd: main_loop: proc 131 (mkswap_L) took 0.77 seconds
    guestfsd: main_loop: new request, len 0x34
    swapon -L swapit
    swapon: cannot find the device for swapit
    guestfsd: error: swapit: swapon: cannot find the device for swapit
    libguestfs: recv_from_daemon: 100 bytes: 20 00 f5 f5 | 00 00 00 04 | 00 00 00 ae | 00 00 00 01 | 00 12 37 d0 | ...
    libguestfs: trace: swapon_label = -1 (error)
    swapon_label: swapit: swapon: cannot find the device for swapit
    test_swapon_label_0 FAILED

commit c2ac512f12cc87d27d04f69cb70b2c5e4c4a9bc5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 25 17:28:37 2012 -0400

    docs: Revise README file.

commit 670e4f7f1286f8a6872b3731eb6120f3d48e9dfe
Author: Masami HIRATA <msmhrt@gmail.com>
Date:   Sat Aug 25 22:31:29 2012 +0900

    python: Fixed syntax errors in python/guestfs-py.c
    
    Signed-off-by: Masami HIRATA <msmhrt@gmail.com>

commit c638e1f03d2700560fe32c0889224ac29bd52334
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 21 22:02:21 2012 +0100

    docs: Use man page name as default title in HTML output.

commit 52a60349abda50edc6ff0b1bd61225a55c3dd93d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 21 21:12:47 2012 +0100

    release-notes: Add more visible separation between sections in the source file.

commit 20ba04d83e2acea96d729eac1133df009f10f7df
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 21 20:16:07 2012 +0100

    Update release notes.

commit 2f97bf873b64384835f257f8916bf1ebb2af62b4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 21 20:11:52 2012 +0100

    podwrapper: Add --license parameter, which is required.
    
    This adds standard LICENSE and BUGS sections to all of the man pages
    that are processed by podwrapper.
    
    Modify all the calls to $(PODWRAPPER) to add the right --license
    parameter according to the content.  Note that this relaxes the
    license on some code example pages, making them effectively BSD-style
    licensed.

commit f1d98bbc79496947210ee0305f80440ed8557ec1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 21 20:13:47 2012 +0100

    man pages: Ensure consistent copyright/author sections, remove license
    section.
    
    Ensure each man page contains consistent COPYRIGHT and AUTHOR
    sections.
    
    Remove the LICENSE section.  We will add that back in podwrapper in a
    later commit.

commit e89e180d2b1ee7c3a452a327a336dd3facd2a51f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 21 20:11:15 2012 +0100

    podwrapper: Ensure the input file is printed in some error messages.

commit e1e8b3a1cfdeee34fbd51f79b8724c5a58f25c10
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 21 17:44:42 2012 +0100

    docs: Document null disks.
    
    It's always been possible to use /dev/null as a disk image.
    Document this formally in the API.

commit e3bb1f7c927a9c34195e51c5810606227dc70e3f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 21 16:40:57 2012 +0100

    launch: libvirt: Always create /var/run/libguestfs.
    
    This directory won't necessarily exist (esp. if /var/run is
    really /run).  So create it each time.

commit dcd35cb55c4ee8a9144c05811f51ac32fc0c7c6d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 21 13:56:18 2012 +0100

    Version 1.19.33.

commit 984044043dc423687862fe2058b43786ab4acf1a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 21 13:21:55 2012 +0100

    FAQ: Re-add #backup anchor for section on backups.

commit 52e38c7bdc293cb2f2531eab3dde6d569a05b5e9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 21 13:19:33 2012 +0100

    recipes: Update dumping filesystem content to mention that we now support MD/RAID.

commit 1e4c6e36a6d122b4615dc509ef745dde7e37321d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 21 13:16:18 2012 +0100

    recipes: Refer to virt-format, virt-make-fs for creating disk images.

commit 5f234548ed07b8e41a31462290aae3ea842630c2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 21 13:10:13 2012 +0100

    recipes: Cloning Windows: plans for virt-sysprep.

commit 9fd4d16819ad200814be717732c77664e18132f2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 21 13:09:53 2012 +0100

    recipes: For auditing for setuid files, point to virt-ls examples.

commit 0d2e70b1c71dba01f71a4375eb10b83059a41bb2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 21 12:56:22 2012 +0100

    recipes: For sparsifying guests, point to virt-sparsify.

commit d944a491ac3aa9b9ed1bcdc0ee378519a367276a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 21 12:56:10 2012 +0100

    recipes: For listing files, point to virt-ls.

commit ad6870102fc2c36b5b0949d10b3d2ad8847c4024
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 21 12:55:59 2012 +0100

    recipes: Mention virt-sysprep firstboot feature.

commit 87cf749cde7b9ecdfd95d0b4cac939a2be767fd7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 21 12:55:46 2012 +0100

    recipes: Most guests now use grub2, so change the example.

commit 10d48bef3055e1b7177b4f8df52133c50484a87a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 21 12:55:25 2012 +0100

    recipes: Add a section on deleting a file and other common file operations.

commit 1454751b731ff3a448cc5b5b46f4cbc1fc2f66d0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 21 12:55:09 2012 +0100

    recipes: Update cloning section.

commit 9f59d1162537b296ce3790fa06e8571086ab0828
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 21 12:24:05 2012 +0100

    launch: libvirt: Minimum libvirt version is now 0.10.0.

commit faf548a4bdd36b476ee6838bfc7d0c134435a331
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Mon Aug 20 16:17:01 2012 +0800

    xfs_growfs: drop the unstructed output
    
    Just drop the unstructed output since we can get the structed info
    from xfs_info instead.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 11b78a710729c34c1ef921feb119569b7d580877
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Mon Aug 20 16:17:00 2012 +0800

    New API: xfs: xfs_admin
    
    Add new api xfs_admin to change parameters of an XFS filesystem.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>
    
    RWMJ:
     - Remove printuuid, printlabel, since they don't change any settings.
     - Adjusted the documentation.
     - Fix the tests.

commit 5e6727746367ba3f935dccb80109abf8e34fe74d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 20 16:46:09 2012 +0100

    run: Disable 'memory optimizations' in glib programs, for valgrind (thanks Dan Berrange).

commit cd1627e8041ffa06764ef82b984f4291660edcc9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 18 22:27:17 2012 +0100

    FAQ: virt-sparsify and raw sparse output.

commit d67e6ea75dde6309ce4c6162a4a0429ab8d6709b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 18 22:08:29 2012 +0100

    Replace mount-options with mount where appropriate.
    
    Since our minimum supported version is now 1.16 and mount was fixed in
    1.13.16, it is now safe to replace mount-options + empty options with
    mount wherever it occurs.

commit 781d72f55897b1ed923c795a0132241f53f6c6eb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 18 13:09:27 2012 +0100

    Update API support.

commit 64098f18d0815462ee31e2aee4d9e41a941a990b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 18 12:09:47 2012 +0100

    Version 1.19.32.

commit 8f3c0fd98d30cff1697dbe512432cd873f1af61d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 16 14:49:58 2012 +0100

    sysprep: docs: virt-sysprep can now be used to customize a guest.

commit 99cfc1f36ea88255a2b9497e983d57c1700dcc4c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 16 14:48:54 2012 +0100

    sysprep: Add --firstboot functionality.
    
    This allows you to add scripts that run in the context of
    the guest the first time it boots.

commit 99759da25c29a7376490074da3d2c22602a2acec
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 17 17:28:25 2012 +0100

    docs: Rewrite section on protocol limits again.
    
    This updates commit 92e241440d361e9491a9d96d23ad7a378cb2ab6a.

commit 92e241440d361e9491a9d96d23ad7a378cb2ab6a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 17 10:32:08 2012 +0100

    docs: Update documentation to reflect no 2/4 MB protocol limits.

commit d6e1d82267d935f0635d3374e93bdb676701baa7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 17 15:50:36 2012 +0100

    todo: Suggest full mke2fs API call.

commit 92a0ac50371d038d53a8aa9a8c8fd0b6ef57e88b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 17 14:31:39 2012 +0100

    tests: Add a test for large directories.
    
    This also tests the reimplemented APIs:
     - ls
     - lstatlist
     - lxattrlist
     - readlinklist

commit 07eb7021638140c4dfc2b5b99bbb4c129d21e03f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 17 15:50:51 2012 +0100

    New API: fill-dir: Fill a directory with files (for testing).

commit 6952505694bfd8dda20e4e18b5f8b76b97db82a4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 17 14:21:34 2012 +0100

    guestfs_readdir: Note that this suffers from protocol limits.

commit a69f44f56f20beab7793be428df22104f79500e7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 17 14:11:21 2012 +0100

    guestfs_ls: Reimplement to avoid protocol limits.

commit 1b4d8e2cca7819b4c6e14bb052f40a9fc40205d3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 17 13:57:37 2012 +0100

    New API: ls0 - List files, separated by \0 characters.
    
    This API is not especially useful on its own.  It will be used to
    reimplement guestfs_ls to work without protocol limits.

commit 8ee51907685d6db92031e84d249ea3bb4cdc2d67
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 17 13:10:53 2012 +0100

    guestfs_readlinklist: Reimplement to avoid protocol limits.

commit dc66dd32c214db99467341caea0be517d2dd736f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 17 12:21:37 2012 +0100

    guestfs_lstatlist, guestfs_lxattrlist: Reimplement to avoid protocol limits.
    
    Note that the code to do this was already in virt-ls, so this is
    change is mostly just moving the code into the core library.

commit 118932fbeac606919f8b96c81184f4f3e0910508
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 17 11:47:49 2012 +0100

    guestfs_write, guestfs_write_append: Reimplement to avoid protocol limits.
    
    Note that we keep the old daemon calls, but rename them as
    "internal_write" and "internal_write_append".  This lets us implement
    the new library-side calls more efficiently in the common case when
    the uploaded content is smaller than the message buffer.  In most
    cases the new calls won't end up using a temporary file.

commit 735ce57cda24e2e2f41418d9a9ad34944fefdfb9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 17 11:07:33 2012 +0100

    guestfs_read_lines: Reimplement to avoid protocol limits.
    
    This also makes a larger test suite for this command.

commit 96d3ac28d636290e9478ac27226862e627682025
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 17 10:36:23 2012 +0100

    guestfs_read_file: Reimplement to avoid protocol limits.

commit 9d85eba3c3c169478d1edf0dd7ef9495d4be19ce
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 17 09:47:29 2012 +0100

    guestfs_find: Reimplement to avoid protocol limits.
    
    This also reimplements the virt-ls -R option to use the replacement
    guestfs_find API, which is simpler (though actually less efficient).

commit 294bee38bcdd38542bf26292365ac27aebb06642
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 17 08:15:31 2012 +0100

    guestfs_cat: Reimplement to avoid protocol limits.

commit 50d904c0181d1e714938cc5c702616f5a79c0bd2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 17 12:32:34 2012 +0100

    generator: Fix error message in checks of proc_nr.

commit 0f33a1d90c65f31444e14aef27d489706230939f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 16 12:58:49 2012 +0100

    sysprep: Improve error messages.

commit 6f5447abe34dcddefa0885b006e65419fe84717a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 16 18:20:57 2012 +0100

    Update TODO.

commit e9ef74ebc2c745707660ef3035a2710629fef157
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 15 17:57:40 2012 +0100

    Version 1.19.31.

commit 856e78a2ce025563de5d9e8c416edf054b0db563
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 15 17:39:39 2012 +0100

    subdir-rules.mk: Remove rules that recursively build src/ and daemon/.
    
    These are unnecessary, and slow down the whole build.

commit cc25afcc35ed69ca1c005a1396578675437450e6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 15 17:04:13 2012 +0100

    gobject: Disable bindtests.
    
    - gint64 cannot be reliably sent.  It seems to try to convert it
      via a 32 bit int, and fails if it overflows.
    
    - OStringList is not implemented yet.

commit 5abd7bfc4cd8411efb8c3ad30e8a2b2610a7a1be
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 15 15:44:18 2012 +0100

    launch: For /dev/null drives, create a temporary disk.
    
    This is a workaround for a bug with virtio-scsi in qemu 1.2:
    https://bugzilla.redhat.com/show_bug.cgi?id=847549

commit 7f9f2818651860a15a7142d3761e3168e062c357
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 15 16:08:19 2012 +0100

    test-launch-race: Use /dev/null instead of hand-made zero-length file.
    
    There seems to be no reason why creating a zero-length
    file is necessary for this test.

commit 46cf4a7e875b828c7a97bd85f577721bce386bc3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 15 15:43:30 2012 +0100

    launch: Move code to add a drive to the list to separate add_drive utility function.
    
    This is just code motion / simplification.

commit 4b8ac437295d5420d3186a913bc3740b69a8d342
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 15 15:41:42 2012 +0100

    launch: Add utility function guestfs___lazy_make_tmpdir.
    
    This lets us create g->tmpdir lazily earlier if needed.
    
    This commit is just code motion.

commit 22607a97cdf115caabf05c3dc87c5f154a2e914c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 15 15:41:05 2012 +0100

    lib: Add 'g->unique' to handle, for making unique IDs.

commit 8fd6f1bebef11d1c4eb77ac2b7d95fd5a7e82be9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 15 15:40:29 2012 +0100

    inspect: Clarify comment about uniqueness of cache.

commit ba61236d0d6756f45d8707e96cda00c016cadebe
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 15 15:01:01 2012 +0100

    close: Check if g->tmpdir is non-NULL before removing tmpdir.
    
    This happens, by chance, to work.

commit 16f22d89eb142f1485fc28afaa89026cf8c956d9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 15 14:44:37 2012 +0100

    bindtests: Test sending min and max 64 bit integers.

commit 704e46af9c054fe3571884989c992dfd7d8284e5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 15 14:50:29 2012 +0100

    java: Fix bindtests when passing 64 bit integer literals.

commit 9526f632d80f8d66ecf8a7da5444e1446129fceb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 15 14:49:01 2012 +0100

    ocaml: Fix bindtests when passing negative optional arguments.

commit f6de298d0498d5672d05da839021a41277df8e09
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 15 14:10:38 2012 +0100

    erlang: Add tests.
    
    Add bindtests and general tests for Erlang.

commit bd35b3c055cb4a1bda041faede018dd7d4cfc1ba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 15 14:38:15 2012 +0100

    erlang: Fix 64 bit integers in parameters.

commit e3f356bda1d249a65f5606d5e4729ba6f7e56189
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 15 14:08:43 2012 +0100

    erlang: Fix BufferIn parameters.
    
    These would break if the buffer contained a \0 character.

commit fad0f53dc8a21b61dc5ff011d836f5fd5fdab0c3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 15 14:07:35 2012 +0100

    New internal APIs: internal-test-set-output, internal-test-close-output.
    
    These internal (testing) APIs allow the bindtests output to
    be sent to some other place than stdout.
    
    This is necessary for Erlang, since stdout is used to communicate with
    the Erlang interpreter.

commit 7dd2389359d190e81696f1b2e91e719bdc1822f2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 15 14:05:36 2012 +0100

    python: Fix comment referring to Perl(!)

commit 449bd4b50ff8ecd9128439a39a74ca731a17aa1f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 15 13:01:19 2012 +0100

    generator: Allow permission of output files to be specified.

commit 3234a1f903bb77c66252b38425a4c913f8e7bb8c
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Tue Aug 14 21:52:02 2012 +0200

    Even on Debian, the package containing the diff binary it has been diffutils for two years.
    
    There had been a virtual package "diff" that depended on diffutils, but that's gone in wheezy/sid, too.

commit 42e8c093b74ac578ef75c6f3aefdbea7f46478e1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 15 12:14:39 2012 +0100

    python: Fix optargs so we don't use special sentinel values.
    
    Previously with Python it was impossible to set a boolean or integer
    optarg to -1 because that was used as a special sentinel value to
    indicate that the optarg was not set.
    
    Instead, use None as the sentinel value, since that cannot be a
    boolean or integer type.

commit e990e80c266db84e5c9e4198e44307958a9cd19c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 15 12:14:06 2012 +0100

    python: Before freeing OStringList, cast it to char ** to avoid a compiler warning.
    
    This fixes commit c1a269513c05b44af0ed6e6b7b48f5dd11e01060.

commit 94f133f25bce7e9d354ea4d31c96b5635900d292
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 14 18:21:05 2012 +0100

    Remove unnecessary comment from <guestfs.h>.
    
    Read guestfs(3) for documentation, and don't discourage people from
    doing that by putting these comments into the header file.

commit 5ea795aa488df9becaab3a55a57cd4fb46cb34d4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 14 18:17:40 2012 +0100

    docs: Fix '= head' -> '=head' in back compat entries in guestfs(3).

commit f5208ab8656a402e8de43780f9155056b45ce11f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 14 17:51:24 2012 +0100

    Version 1.19.30.

commit ce35eb90a2c3b745295e38abdaf17a645f1df9ee
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 14 13:58:49 2012 +0100

    tar-out: Add list of excluded patterns (--exclude=...) (RHBZ#847881).

commit c1a269513c05b44af0ed6e6b7b48f5dd11e01060
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 14 13:56:07 2012 +0100

    generator: Add new OStringList optional arg type.
    
    This allows lists of strings to be passed as an optional argument.

commit 637b06ab1384f0c904715ba76fc759dac1b95500
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 14 13:55:00 2012 +0100

    daemon: New utility functions 'join_strings', 'concat_strings'.
    
    Useful functions for concatenating strings together.

commit 690bdaa3927e56d33e241752eef37f887274d73b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 14 11:14:10 2012 +0100

    bindtests: Space before parens in call.

commit d23293db7e69f7c9501ebab2cede0b7cb48c595a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 14 10:01:40 2012 +0100

    todo: Suggestion: Add sh-in, sh-out, debug sh-in, debug sh-out.

commit 4dbae7cc06544fc1e9b622826f613bec84ec6d11
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 14 09:54:31 2012 +0100

    tar-out: Add optional numericowner flag (RHBZ#847880).
    
    This is equivalent to the tar option --numeric-owner.

commit 864ef706a84c7c87a62f776d4b2e82a6f959ae14
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 14 09:04:51 2012 +0100

    Add optional compress flag to tar-in, tar-out APIs.
    
    The compress flag can be used to control compression, one of: (none),
    "compress", "gzip", "bzip2", "xz", "lzop".  Thus these calls can now
    be used instead of tgz-in/tgz-out/txz-in/txz-out, and also support
    more compression types.
    
    Mark these APIs as once_had_no_optargs so that compatibility code is
    generated.

commit 84c897c93a794e4bdab37dfd505618de68bf145d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 13 13:51:29 2012 +0100

    docs: Add a section describing how to use gdb + qemu wrappers to debug the appliance.

commit 22da2cb0ae45c1c50e7ba5618f9944a3d417ec7e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Aug 12 22:51:45 2012 +0100

    docs: Show how to use 'annotate-output' command to collect timings.

commit 769a6f24c60e7a4d55560025554796ba4be19d03
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Aug 12 17:01:44 2012 +0100

    ocaml: Use Store_field macro instead of caml_modify.
    
    Use the safer, higher level Store_field macro when constructing arrays
    of structs to return.
    
    I don't know if it is strictly necessary in this case, but it's safer.

commit 2c046c0d6fb2faccc2b2d5596d0af1c8d043eb76
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 11 20:52:28 2012 +0100

    virt-make-fs: Don't display output of 'qemu-img' except on error path.

commit 2295b09f259ece053f1370f7527d01705976732a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 11 20:51:28 2012 +0100

    virt-make-fs: Remove note about vfat and ownership of tarball files.
    
    This problem has been fixed in
    commit 50780a84f65ec5d76605691cea889392c2730f54.

commit f3b21b4da563faf991f008807df62ea4732747af
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 11 19:08:33 2012 +0100

    Include guestfs-release-notes.txt in the tarball.
    
    This fixes commit 589db4e42ad5e759041521e7673bd7aa2f800736.

commit 32e5bab3ee25d6642dab285b35e2490a74f4f04b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 11 18:35:13 2012 +0100

    tests/9p: Add test to EXTRA_DIST.
    
    This fixes commit 499497fab03716278cb5214a8aa89a35618e06c6.

commit 42d404fa6490790f699505fa0f225e966cec151f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 11 14:18:08 2012 +0100

    Version 1.19.29.

commit 159b1479cc43f22ebcc9e0187efbb8a3eeda1c5d
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Wed Aug 8 17:59:39 2012 +0800

    sysprep: remove the process accounting log files
    
    We just remove the process accounting files previously without
    touch a empty file, this will cause psacct runs error.
    Restart the service can't help us create this file auto.
    
    couldn't open file '/var/account/pacct': No such file or directory
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 9fab546206e0102daac01f835bc546117342f4c7
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Mon Aug 6 16:23:20 2012 +0800

    xfs: fix a possible memory leak
    
    free out when failure.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit b93d004c7ce3bd6c3ae331d57289b02f9ce01af9
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Mon Aug 6 09:17:48 2012 +0800

    Fix typo in release notes.
    
    Fix typo.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 589db4e42ad5e759041521e7673bd7aa2f800736
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 4 19:24:30 2012 +0100

    Convert release notes to a POD file / man page.
    
    Note that we add the text version to git so that it's available for
    people to read without requiring any special tools.

commit 198cc630f0634fa318c6943f8de6706951701250
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 4 14:37:46 2012 +0100

    New APIs: rsync, rsync-in, rsync-out
    
    Implement rsync.

commit a05623cd71fe4f179c9fd61a1a3e327c35290e56
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 4 14:36:55 2012 +0100

    fish: Add --network option.
    
    This enables the libguestfs user network, and is the equivalent of the
    'virt-rescue --network' option.

commit 7d6f76709e71b38e0bc4f018c4d873a32ffe19da
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 10 21:37:46 2012 +0100

    generator: 'delete' is a reserved word (in C++).

commit 04b475b41476b75ef3851fdd093a9868df0c7357
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 11 07:47:25 2012 +0100

    tests/extra: Add workaround for memory leak in libvirt.
    
    See: https://bugzilla.redhat.com/show_bug.cgi?id=847429

commit 1fe6f1f7bbc454472b02d94927d3b4da2814ad53
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 4 17:24:20 2012 +0100

    Update release notes for libguestfs 1.20.

commit 47410e79995f9d8c5fb9739ca4609c78e13218ee
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 4 11:45:15 2012 +0100

    appliance: Add rsync and openssh-client{,s} to the appliance.
    
    This adds ~10M to the appliance (328M -> 338M).
    
    However for virt-rescue these are frequently requested tools.

commit 87602b09ead198bd84c0dac83fde2d1c3dfe55bd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 3 22:38:41 2012 +0100

    fuse: guestmount doesn't let you pass '-- [FUSE options]'.
    
    I don't think it ever did, so the --help text was always
    wrong, and definitely didn't match the real behaviour of
    the program.

commit 083125f709c8ca6ec56abf99df918e70376a99bd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 3 15:38:10 2012 +0100

    ruby: Mark all VALUEs as volatile.

commit 2a87261dfc830cd6bcb44aa1628d955cb6423bd7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 3 12:54:18 2012 +0100

    fish: Fix 'copy-out /' (RHBZ#845522).

commit 7fa67427c6b2725bdcce52c08511f8813b7bd42e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 3 11:53:44 2012 +0100

    Document problems copying long filenames from NTFS to Linux filesystems (RHBZ#845488).

commit 1394d4a69be2ec65ed0b34e34f7a2aee816070fc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 2 17:35:32 2012 +0100

    Version 1.19.28.

commit 863168467f14e33407c4bf9c7f790bcd4911aea3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 2 17:21:47 2012 +0100

    examples: Use add_drive_opts function in examples.
    
    In libguestfs 1.20, you will be able to use 'add_drive'
    instead of 'add_drive_opts' (except in the C bindings).
    
    However until libguestfs 1.20 is the minimum stable version
    people will still be using old versions where you have to use
    'add_drive_opts'.  This makes the examples confusing.
    
    Therefore continue to use 'add_drive_opts' in the examples
    for now.

commit b3d0cc0588845d3cad3fd67943d93e1bd87b1700
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 2 14:05:54 2012 +0100

    grep: Add optargs to grep API and deprecate fgrep etc.
    
    This commit makes grep into an optargs API, with flags for extended,
    fixed, [case-]insensitive and compressed.
    
    At the same time it deprecates: egrep, fgrep, grepi, egrepi, fgrepi,
    zgrep, zegrep, zfgrep, zgrepi, zegrepi and zfgrepi.

commit d40b5028762eeaf9235165301bd76d468b7e251c
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Wed Aug 1 17:02:07 2012 +0800

    xfs: add new api xfs-growfs
    
    New api xfs_growfs for expanding a XFS filesystem.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 9b9c3721146b734fb71721875d80e5f2db1b7b7b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 1 18:44:19 2012 +0100

    Revert "appliance: Add '-drive detect-zero=on' flag if qemu supports it."
    
    This reverts commit fe2253088ff51b51e2586f27a9408a38655170e3.

commit 981c7b731048af39e00181da70bd5fc17d3e04be
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 31 22:55:58 2012 +0100

    Reviewed and revised TODO file.

commit 4efa0f8f38b1d0d35c34b8a05168c06a312e9823
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 31 13:41:51 2012 +0100

    m4: Sort .gitignore with LANG=C.  Also add pipe2.m4 (used by RHEL 6).

commit f21b866f3141bb85ebf93ccf0c906ab0b73960f9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 31 13:21:42 2012 +0100

    build: On x86 search for qemu-system-i386 not qemu-system-i686.
    
    host_cpu can be set to i686.  The qemu binary is called
    qemu-system-i386.  Apply some sed to fix this.

commit 06780a92b3e4ea14c09a169cc1d22c1371621fc3
Author: Eric Blake <eblake@redhat.com>
Date:   Tue Jul 31 13:14:28 2012 +0100

    build: Allow building with new glibc headers and -O0.
    
    This is a patch taken from libvirt.  See:
    
    http://libvirt.org/git/?p=libvirt.git;a=commitdiff;h=2af63b1c349

commit 499497fab03716278cb5214a8aa89a35618e06c6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 30 23:17:49 2012 +0100

    9p: Add a regression test for 9p functionality in qemu.

commit 77326fa4ad757bb255a3c3a07bef8c3ce050a5ac
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 30 23:33:40 2012 +0100

    appliance: Exclude kernel* packages explicitly.
    
    febootstrap >= 3.19 will no longer exclude the kernel package
    by default.

commit 54db02b60a9b588b5eeda588816a31a998fb0b6f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 30 19:27:09 2012 +0100

    Version 1.19.27.

commit 7b2f6bd665bac3890b64eccc77e010e6bf84bda7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 30 17:32:10 2012 +0100

    libguestfs-make-fixed-appliance: Don't reference obsolete development version.

commit b075b4d1feaaaa83272a8821828d9c7ce8843686
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 30 15:16:45 2012 +0100

    New API: utsname
    
    Typical output:
    
    ><fs> utsname
    uts_sysname: Linux
    uts_release: 3.5.0-1.fc18.x86_64
    uts_version: #1 SMP Mon Jul 23 17:43:39 UTC 2012
    uts_machine: x86_64

commit b61a8a50bc8d481df32f929046abf09383c8380e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 28 21:28:23 2012 +0100

    sysprep: Describe more directly how to use qemu-img for snapshotting.

commit dcc0ebc8e0c4a8abd505421a584573272a03f7aa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 26 22:00:07 2012 +0100

    tests: Consistent use of $(top_builddir)/run --test when building test guests.

commit 590774ed9e005dc85ca6851939e76d02da6624c8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 26 21:56:37 2012 +0100

    build: Use $(top_builddir)/run in Makefile.am's.
    
    Not necessary, but this makes all invocations of 'run' consistent.
    There is no functional change.

commit 96d34d883f309ede4c889e852cef68dc5c9e45b9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 26 19:01:28 2012 +0100

    Version 1.19.26.

commit fe2253088ff51b51e2586f27a9408a38655170e3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 26 18:25:06 2012 +0100

    appliance: Add '-drive detect-zero=on' flag if qemu supports it.
    
    NB: The patch to implement this feature in qemu is not upstream, and
    may never make it upstream.  However this is so useful for
    virt-sparsify that I decided to add this to libguestfs while we see
    what qemu decides to do.

commit 0f837ec068783a6318ba6f7490b567566bce2aa4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 26 11:13:39 2012 +0100

    ruby: Allow optional arguments hash to be really optional.
    
    Allow optargs functions to be called as either:
    
      g.mkfs_opts(fs, device)
    
    or:
    
      g.mkfs_opts(fs, device, { optargs hash })
    
    This also preserves backwards compatibility with once_has_no_optargs
    functions such as mkfs.

commit 5f30912d74a553399d2bda055560d4340a15088d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 25 23:38:37 2012 +0100

    ruby: In event wrapper, ignore callback functions which have type T_ZOMBIE.
    
    Note that in old versions of Ruby, T_ZOMBIE was not defined.

commit 7b84b496031fb207cb00c8f314aeb06544a1d7b5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 25 22:56:54 2012 +0100

    ruby: Set LD_LIBRARY_PATH for Ruby libs in run script.
    
    This lets you use './run gdb ruby ...' and get accurate
    debugging information.

commit 208d1c1a09e9d7cbc27207ea7ff1c84ff1f64fbd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 25 16:50:40 2012 +0100

    sparsify: Detect qemu-img version and use qcow2 v3 for overlay if available.
    
    qcow2 v3 is generally more efficient, although unfortunately it
    doesn't support automatically sparsifying zero writes.
    
    Note this *only* uses qcow2 v3 for the intermediate overlay file, not
    for the final output (since we want the output to be broadly
    compatible with old hypervisors).

commit 0b3b5f984c2011632c6d56e5f0ae1194d2c5074b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 25 16:28:12 2012 +0100

    sparsify: Change code that generates qemu-img -o argument.
    
    This is just code motion.

commit 42bf3274e471cdef6a3b89b3f5918040b95a0fb5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 25 10:49:20 2012 +0100

    sysprep: Generate new random UUIDs for LVM2 PVs and VGs (thanks Kazuo Moriwaka).

commit e64bf3fb2945e552d74bde43fb2ff4e1180b976b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 25 10:29:58 2012 +0100

    New APIs: pvchange-uuid, pvchange-uuid-all, vgchange-uuid, vgchange-uuid-all.
    
    These APIs will allow sysprep to change the UUIDs of all PVs and VGs
    in the system.
    
    LVs don't have UUIDs AFAICT, or at least there seems to be no way to
    change them if they do have them.

commit 2b59b5f1d2e36b0ef84b7c7c9ab2c4b602f2ad91
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 25 14:17:42 2012 +0100

    sysprep: Change perform callback to perform_on_filesystems and perform_on_devices.
    
    Operations that need to work directly on guest block devices will fail
    because the block devices are busy.  Therefore add a phase with the
    filesystems unmounted, and allow operations to specify that they need
    to work in this phase.

commit 1fb95e65661f19c050b928694f750f2406eff2ac
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Jul 25 14:17:37 2012 +0100

    fish: Use minimal permissions when initially creating history file

commit b7ff02354d6db6b322629ad1d065d56d5ffca3c3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 25 10:15:47 2012 +0100

    sysprep: Tidy up the Makefile.
    
    This is just code motion.

commit 4fa51f11da26280c703bac150a5f9a86fc853f2e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 25 10:09:28 2012 +0100

    sysprep: operation machine-id: return `Created_files.
    
    This operation can create the /etc/machine-id file, so it may need to
    be relabelled by SELinux.
    
    This fixes commit e68336d72a7d71a44d80f0d13c40ff44653e5c01.

commit e68336d72a7d71a44d80f0d13c40ff44653e5c01
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Wed Jul 25 13:56:16 2012 +0800

    sysprep: remove the local machine ID
    
    remove the local machine ID, leave it empty, let it be generated
    during next booting.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>
    
    RWMJ:
     - Whitespace change.
     - Remove completed items from TODO.

commit a121f1d654be3d7ed053b0c3bc1aa16f5285d348
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Wed Jul 25 13:56:15 2012 +0800

    sysprep: remove the auto generated abrt data
    
    remove the automatically generated abrt data.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>
    
    RWMJ:
     - Remove copy and pasted line.
     - Use C<> in description.

commit d74e7fad28ae7a2f894a12d30807f4b36078bf13
Author: Masami HIRATA <msmhrt@gmail.com>
Date:   Tue Jul 24 23:10:49 2012 +0900

    Mac OS X: Use u_int64_t/uint64_t instead of unsigned hyper in .x file
    
    Signed-off-by: Masami HIRATA <msmhrt@gmail.com>
    
    RWMJ:
      Fixed whitespace in generator_xdr.ml

commit 61c9ea496e0579bb7d1bcf496595d66c3f08cfec
Author: Masami HIRATA <msmhrt@gmail.com>
Date:   Tue Jul 24 23:10:48 2012 +0900

    Mac OS X: Use libtool --mode=execute instead of LD_LIBRARY_PATH
    
    because Mac OS X doesn't support LD_LIBRARY_PATH
    
    Signed-off-by: Masami HIRATA <msmhrt@gmail.com>

commit 7d3f190d90140aa15b1326bdf7756c39559ae3c2
Author: Masami HIRATA <msmhrt@gmail.com>
Date:   Tue Jul 24 23:10:47 2012 +0900

    Mac OS X: Use gnulib stat-time module explicitly.
    
    Signed-off-by: Masami HIRATA <msmhrt@gmail.com>

commit a887dd5109e258936c411c6123c7b16d5445a0aa
Author: Masami HIRATA <msmhrt@gmail.com>
Date:   Tue Jul 24 23:10:46 2012 +0900

    lib: Use <sys/socket.h> and <sys/un.h> for sockaddr_un
    
    Signed-off-by: Masami HIRATA <msmhrt@gmail.com>

commit 399887defd2965449a82f29704a0dcc0f3c699b7
Author: Masami HIRATA <msmhrt@gmail.com>
Date:   Tue Jul 24 23:10:45 2012 +0900

    Mac OS X: Use real files for gtk-doc (not the symlink)
    
    Signed-off-by: Masami HIRATA <msmhrt@gmail.com>

commit 9519c60ce565437c91ce23ceb380f3bfe49ec224
Author: Masami HIRATA <msmhrt@gmail.com>
Date:   Tue Jul 24 23:10:44 2012 +0900

    Mac OS X: don't check glibc-style extended printf formatters unless --enable-daemon
    
    Signed-off-by: Masami HIRATA <msmhrt@gmail.com>
    
    RWMJ:
     - Test was in the wrong place (before --enable-daemon had been
       detected) so I moved it later.

commit 7dab20876530a7ac954b4fe809755ac12a8d8c4d
Author: Masami HIRATA <msmhrt@gmail.com>
Date:   Tue Jul 24 23:10:43 2012 +0900

    Mac OS X: #define UNIX_PATH_MAX 104
    
    See http://developer.apple.com/library/mac/documentation/Darwin/Reference/Manpages/man4/unix.4.html
    
    Signed-off-by: Masami HIRATA <msmhrt@gmail.com>

commit 6e3f8d2511a63bdcfa7c7d0e5414d5643c4ff599
Author: Masami HIRATA <msmhrt@gmail.com>
Date:   Tue Jul 24 23:10:42 2012 +0900

    Mac OS X: Added check of #include <endian.h>
    
    Mac OS X doesn't have endian.h
    
    Signed-off-by: Masami HIRATA <msmhrt@gmail.com>

commit a47fa7a65e89d80ba1362b39cb9686e5022b7dce
Author: Masami HIRATA <msmhrt@gmail.com>
Date:   Tue Jul 24 23:10:41 2012 +0900

    Mac OS X: Use gnulib fstatat module explicitly.
    
    Signed-off-by: Masami HIRATA <msmhrt@gmail.com>

commit d6ef91d7c4b6cfbd9e4d49317dc7ed414900c4d2
Author: Masami HIRATA <msmhrt@gmail.com>
Date:   Tue Jul 24 23:10:40 2012 +0900

    Mac OS X: Use gnulib memmem module explicitly.
    
    m4/.gitignore: Update.
    
    Signed-off-by: Masami HIRATA <msmhrt@gmail.com>

commit ef1a8446a659fe3647d755334703a1020a0f88dc
Author: Masami HIRATA <msmhrt@gmail.com>
Date:   Tue Jul 24 23:10:39 2012 +0900

    configure: Use $(PERL) instead of perl
    
    Signed-off-by: Masami HIRATA <msmhrt@gmail.com>

commit 8f3a839aa86c14666ce06a45c8d28026c302f2e9
Author: Masami HIRATA <msmhrt@gmail.com>
Date:   Tue Jul 24 23:10:38 2012 +0900

    configure: Add -nographic command line option to qemu.
    
    Without this option, configure will fail when there is no display.
    
    Signed-off-by: Masami HIRATA <msmhrt@gmail.com>

commit ebe826f23fc71b1a4e8dbd888ce1548ce4192873
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 24 14:48:39 2012 +0100

    Version 1.19.25.

commit 67e1c90605f82dbc878a309e7315d982fc63f30d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 24 14:26:55 2012 +0100

    launch: libvirt: Suppress printing of libvirt errors to stderr and other cleanups.

commit 493e80ab4e7199bdbb44b16535448d65944eca66
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 24 11:13:52 2012 +0100

    launch: libvirt: Use SELinux-mandated directory for sockets (RHBZ#842307).
    
    Note this does not yet enable sVirt confinement of the appliance.
    That requires at least that SELinux policy goes upstream, plus there
    may still be bugs.

commit 97aeaa86d0e311853534de10367e821445cc655d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 24 13:41:43 2012 +0100

    todo: More suggestions for virt-sysprep (thanks Kazuo Moriwaka).

commit 5d0ef099631e84adfca714b9fa28290778b6e3b7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 24 11:13:21 2012 +0100

    launch: libvirt: Move free to end of function.
    
    This is just code motion.

commit 507aa9ac35e2d7d200ee48f0d3d9dfa0f1644ef1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 24 11:12:46 2012 +0100

    launch: libvirt: Add is_blk utility.
    
    This is just code motion.

commit d8b2c1afee4e23ca864727bebc53a04c490715bc
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Tue Jul 24 16:47:23 2012 +0800

    umount: use Dev_or_Path for the argument type
    
    Use Dev_or_Path instead of String.
    
    Remove the RESOLVE_DEVICE since Dev_or_Path will generate
    REQUIRE_ROOT_OR_RESOLVE_DEVICE instead.
    
    RWMJ:
    Note a change in semantics: this now requires root.  However this is
    OK and still works with mkmountpoint and friends because
    'is_root_mounted' works even if something is mounted below the root.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit c03cdcc25ca9b4d2169f5566ea1470758caef812
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 24 10:21:32 2012 +0100

    launch: libvirt: Set <emulator> in libvirt XML if g->qemu is not the default.

commit 40e5317cfb4eb804129e9dd1eda0e5769a394520
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 24 10:16:31 2012 +0100

    xfs-info: Fix description to refer to 'pathordevice' param.

commit f4094b91d2cdb7635c79269f4534f18a153a4828
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Tue Jul 24 16:47:22 2012 +0800

    xfs_info: resolve device when doing xfs_info on a device
    
    Resolve device first, like do_umount.
    Use Dev_or_Path.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit bda974e64cabddde33227a678a984c37cd135f39
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Mon Jul 23 17:51:31 2012 +0800

    umount: add force umount and lazy umount
    
    Add the option force and lazy for force and lazy umount.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 6bdc4b30ead7cefea0b5e0edc876b5e7f4351db9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 23 21:53:55 2012 +0100

    Version 1.19.24.

commit 2b059535b19125ca082f4354a7ff73f4f5a33822
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 23 21:37:59 2012 +0100

    tests: Skip regression test for 790721 if attach-method is not 'appliance'.

commit 941ec968b8a1d6f891d30631a8ddb1e23e427b99
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 23 21:26:18 2012 +0100

    lib: Initialize libvirt and libxml2 once when the library loads.

commit bf00be0e17c03f46075b3276fade7bd23d380557
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 23 19:03:08 2012 +0100

    launch: Make get-pid and max-disks APIs into virtual methods of the current attach-method.

commit 3614d76b37ee8ef90f5a280e1bb51bccd87eaadb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 23 18:56:20 2012 +0100

    tests: Move debug-drives testing API to launch.c and change the output.
    
    It should work with any attach-method.

commit a6366f5dae0e8332cfdad0894aa6e5c7fc3faa2c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 23 20:16:54 2012 +0100

    python: Set file encoding to utf-8.

commit bc917a0efc03b8c28966c9ab474f525752ebe440
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 23 18:43:38 2012 +0100

    tests/protocol: Skip these tests if default attach-method is not 'appliance'.

commit b6afb98a79248997da1b76b946362742dfcd625a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 23 18:21:22 2012 +0100

    tests: Fix get-attach-method test.
    
    If ./configure --with-default-attach-method is set to something other
    than 'appliance', then this will legitimately return a different
    string.  Simply test that it runs, rather than testing the output.
    
    This fixes commit 20a5b4de7ddc4221544784df65eb472481698dcb.

commit c65ee25a756071deedf49f5f0fcf117984727b64
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 23 18:20:41 2012 +0100

    tests: Remove get-pid test.
    
    If the libvirt attach-method is used, then there is no known PID
    (libvirt hides it).

commit 0a1b2f85e6b551efd39f02f93941bfae333c1c26
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 23 17:10:11 2012 +0100

    launch: libvirt: Use <driver name="qemu" type=[format] />.
    
    We were using format= which was bogus and libvirt was ignoring it and
    forcing raw format instead.
    
    Also in its default configuration libvirt won't do disk format
    autodetection at all, so we must do it instead.

commit f9e484ca4559063de82ec153f742271475916fa8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 23 17:41:23 2012 +0100

    launch: libvirt: You can't set O_CLOEXEC flag using fcntl + F_SETFL.
    
    And in any case there is no point, since proto.c already sets the
    SOCK_CLOEXEC flag (using accept4) on this socket.
    
    The code now matches the code in launch-appliance.c.

commit 793a482015ec670186ac53b2c753f299ed27307c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 23 17:40:55 2012 +0100

    launch: libvirt: Use accept4 to set socket flags correctly.

commit 5fb0f4e07ecaa3e084d3ae173606d6f03df393c3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 23 16:43:14 2012 +0100

    launch: libvirt: Add <on_reboot>destroy</on_reboot> to libvirt XML.
    
    This causes libvirt to add the qemu -no-reboot option, which
    reflects existing behaviour.

commit 20a5b4de7ddc4221544784df65eb472481698dcb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 23 15:24:57 2012 +0100

    launch: Allow default attach-method to be set in environment or configure.
    
    You can now choose the default attach method in two ways:
    
    (1) Set the LIBGUESTFS_ATTACH_METHOD environment variable.
    
    (2)  ./configure --with-default-attach-method=appliance|libvirt|...
    
    Note that (1) overrides (2).

commit 7a691e6665ed5079e6baa000c9c475f32ca78475
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 23 15:24:07 2012 +0100

    java: Set '-encoding utf8' for javac and javadoc commands.

commit 7f519bdc06de978c2460112a88e8bfac5f292dee
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 23 15:18:12 2012 +0100

    java: JAVAC_FLAGS -> EXTRA_JAVAC_FLAGS.
    
    This is just a rename.

commit 99f108b840830a7e967bf75521e4e4bee31ec946
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 23 14:28:03 2012 +0100

    launch: libvirt: Move remaining to-do items to TODO file.

commit 68836022d26fdb3f55596cd12ecf1cf6e54f547c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 23 13:14:16 2012 +0100

    launch: libvirt: Add a hack to detect if KVM is available.
    
    We need to select the <domain type=...> attribute depending on whether
    KVM is detected in the libvirt capabilities.
    
    This is a hack because it doesn't try to parse the libvirt
    capabilities XML.

commit 890a4fbc8740b9b2019885a866aa06bc82566a41
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 23 13:05:46 2012 +0100

    launch: libvirt: Use <cpu model="host-model"/> (thanks Dan Berrange).
    
    This ensures maximum performance of the appliance, particularly for
    things like MD where the guest needs to use optimal SSE instructions.

commit 67f7a30cc995be2aa5474422f708a2df093f5d52
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 23 12:54:08 2012 +0100

    launch: libvirt: Change disk XML according to whether host path is device or file (thanks Dan Berrange).

commit f2d7305091f538644a5ce6ce21ced320db60344d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 23 12:46:37 2012 +0100

    launch: libvirt: Use "guestfs-" prefix on random names (thanks Dan Berrange).

commit ef75c4c568e8e855f133b4a577c6629932aae49a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 23 12:45:31 2012 +0100

    launch: libvirt: Enforce minimum version of libvirt 0.9.13.

commit 524bb29526050e140d0ffb314c78b20d1aaf6078
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 23 12:37:22 2012 +0100

    launch: libvirt: Use snapshot=on instead of <readonly/>.
    
    For compatibility with the appliance backend, devices added readonly
    are in fact added writable with snapshots on top.  This is necessary
    because options like 'mount -o ro' usually require write access to the
    disk (eg. to replay journals).

commit abcd6f0c157c7b689fff8e7dfefb725c752174db
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jul 22 14:40:43 2012 +0100

    Version 1.19.23.

commit aa0efa9eb496d20993a4b2326912562abb843719
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 21 14:25:54 2012 +0100

    launch: Add libvirt backend.
    
    Complete the attach-method libvirt backend.
    
    This backend uses libvirt to create a transient KVM domain to run the
    appliance.
    
    Note that this still will only work with local libvirt URIs since the
    <kernel>, <initrd> and appliance links in the libvirt XML refer to
    local files, and virtio serial only works locally (limitation of
    libvirt).  Remote support will be added later.

commit 42ba2620031d4b52e5319e212c2ea96d80a93b52
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 19 15:32:03 2012 +0100

    Add attach-method "libvirt" or "libvirt:<URI>".
    
    With this commit, you can set the attach method to libvirt,
    but calling launch will give an error.

commit f32b93416a9579feb1af19540c3c04924290f131
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 21 15:47:13 2012 +0100

    launch: Make 'drive_name' into a common function.
    
    This is just code motion.

commit fa3b204f4a672bed859cf9e8ea0b0c8c9e3542d2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 21 13:21:43 2012 +0100

    appliance: Push appliance building lock into guestfs___build_appliance.
    
    Since we will be calling guestfs___build_appliance from the libvirt
    code in future, there's no point having two places where we have to
    acquire the lock.  Push the lock down into this function instead.
    
    Because "glthread/lock.h" includes <errno.h> we have to add this
    header to the file too.

commit a58368b3db4f02b9fd907cec82621be11884d256
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Sat Jul 21 09:11:57 2012 +0800

    fuse:remove the unused macro when fuse is not available
    
    Just make gcc happy when fuse is not available.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit ec8e3b6cad170d08ac18b580792dfb137eb171dc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 20 14:24:10 2012 +0100

    launch: Abstract attach method operations.
    
    g->attach_ops points to a structure which contains the
    operations supported by each attach method backend
    (ie. appliance, unix, etc.).

commit 08cad543492c9624be0659dfb18b7a8b21de8fba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 20 11:57:10 2012 +0100

    launch: Move the command line building code entirely into launch-appliance.c.
    
    Although we still use the handle as convenient temporary
    storage.

commit 52fa23d74f6308daf804c2330b0b27e0b4412594
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 20 12:37:53 2012 +0100

    launch: Move guestfs_config API and build list of qemu parameters in handle.
    
    Move and rewrite guestfs_config so it accumulates a list of qemu
    parameters in the handle.  These are added to the appliance at launch
    time (with attach method == unix:...  you'll now get an error).

commit 4df6beee54ca870faa92bcee346a671e19c80237
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 19 20:24:39 2012 +0100

    launch: Move launch timing / messages code into launch.c.

commit 54fd9a10a6da427f3888e913a9f942375e83c189
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 19 20:14:12 2012 +0100

    lib: Use bool (from <stdbool.h>) for a few fields in the handle.

commit 709e28e6d530655bf314c5b98db6f5d91857d6f7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 19 20:06:40 2012 +0100

    lib: Rearrange fields in guestfs handle.
    
    Arrange the fields more logically.  This is just code motion.

commit a6e0e0d6bf3fdb16a78665cb5b4ee34ac341d1e8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 20 12:19:56 2012 +0100

    add-cdrom: Rewrite description emphasising that this API should not be used.

commit 184b9d7c11f771a74c981f739c28fa0713f3e3e7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 20 08:34:46 2012 +0100

    ocaml: Skip mount-local test if /dev/fuse is not writable.

commit 9d314c7c3f4a22a21d2a2f5b8efe01dd7c43cbe8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 19 19:05:55 2012 +0100

    launch: Remove some dead code from the appliance method.

commit 4c261da5ba8a7679709bf6c8efefc2598c5f5f51
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 19 17:08:51 2012 +0100

    lib: Split launch.c into separate files.
    
    launch-appliance.c contains the code associated with the 'appliance'
    attach-method.  Mostly.  In fact there are a few APIs which don't fit
    so nicely:
    
     - config: deprecated API which fiddles with the qemu command
       line directly
    
     - max-disks: depends on the qemu implementation (virtio-scsi
       or not)
    
     - debug-drives: used for testing only
    
    launch-unix.c contains the code associated with 'unix:<path>'.
    
    launch.c is the common code for launching, along with a few other APIs
    such as guestfs_add_drive_opts.
    
    This commit also reduces the number of headers to just those
    which are required.

commit 80d102c49df440c64b744a14bf1d5f46a1c5b82b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 19 17:09:31 2012 +0100

    Remove debug-cmdline API.
    
    Note that debug* calls are not part of the stable API and can be
    removed or changed at any time.

commit eca544d87d9335123077e30b7547270b6bfe0f2b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 19 16:24:55 2012 +0100

    lib: Use safe_asprintf when constructing attach_method.
    
    Just a small code cleanup / simplification.

commit 2e4089f30007e79bc157c775cfd3b326d22f2992
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 19 15:45:27 2012 +0100

    build: Rename most C files that contain underscore with dash.
    
    This is just code motion.
    
    Some files cannot be renamed.  Notably rpcgen input and output files
    must not contain dash characters, else rpcgen breaks.

commit 6054051a9d8a5eee4141ca4b12aa5b7d1f36f56d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 19 14:28:15 2012 +0100

    fish: Rename fish/virt.c to fish/domain.c
    
    This file handles the -d option for guestfish and other C command line
    utilities.  Renaming this file makes it less confusing.

commit d1d29ab488002dda9e9a1b25fc2dbe4cb844f5ef
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 19 14:24:37 2012 +0100

    build: Rename src/virt.c to src/libvirtdomain.c
    
    This file contains the code implementing guestfs_add_domain
    (for adding a libvirt domain) so this name is less confusing.

commit d88f4ca634685f9aefab1a283f03646e32ba4a25
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 19 13:53:27 2012 +0100

    build: Arrange libguestfs_la_SOURCES in order.

commit a8b4ea1f0c173ab5662a4d0d084f0affb972c94e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 19 15:46:18 2012 +0100

    Remove references to long-obsolete Ocaml_inspector module from .gitignore.

commit f514d462cda5395c8614577930ee69eebafc969d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 19 16:08:45 2012 +0100

    podwrapper: Fix setting of GIT_DIR in git subcommand.
    
    This fixes commit 1e17a32060feb937b3972f61b37f9116ad7d8d9a.

commit 805d6425655abe1450567786ee4b887b23022a3c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 19 14:15:52 2012 +0100

    license: Use latest license files from gnu.org.
    
    COPYING from https://www.gnu.org/licenses/gpl-2.0.txt
    COPYING.LIB from https://www.gnu.org/licenses/lgpl-2.1.txt
    
    (Note this change shouldn't alter the licensing of libguestfs)

commit 719297a2201757be9dfa73de748274d9151e83fb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 19 13:51:16 2012 +0100

    Version 1.19.22.
    
    Includes rebuilt gnulib to work around test problems with
    test-getlogin_r.

commit 6e1b5f0feac50a498cb7319e5051a251877fe682
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 19 12:43:55 2012 +0100

    gnulib: Don't include or run getlogin_r test (thanks Jim Meyering).
    
    See:
    https://lists.gnu.org/archive/html/bug-gnulib/2012-07/msg00194.html

commit fc86db3b3bcd884ee37cef79e22b0324df9fcae6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 19 11:16:35 2012 +0100

    build: Return 77 from skipped tests.

commit 1b94ea204d3ce9b8a114b805d2781ab0f4628d94
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 18 21:51:20 2012 +0100

    Version 1.19.21.

commit a0a517869cf9848ba86209c4792ae63d96278ca2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 18 14:57:41 2012 +0100

    tests: Rewrite parallel mount-local test in C.

commit eef11f33f9f14d3706b681bd4e23e334fcc9b791
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 18 13:45:21 2012 +0100

    ocaml: Test mount-local, without parallel test.
    
    Unfortunately the parallel test keeps hitting this bug:
    https://bugzilla.redhat.com/show_bug.cgi?id=838081
    which could be a bug in the OCaml runtime.
    
    Just test simple mount-local.  We will write a parallel test in C to
    replace this.

commit 50780a84f65ec5d76605691cea889392c2730f54
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 18 12:33:16 2012 +0100

    tar-in: Add --no-same-owner flag to tar command when target filesystem doesn't support chown (RHBZ#840572).
    
    When using tar-in or tools built around it such as virt-make-fs, if
    the target filesystem is vfat then unpacking the tarball would fail
    because tar tries to chown(2) files and fails.
    
    You would see errors such as:
    
    tar: <file>: Cannot change ownership to uid 500, gid 500: Operation not permitted
    
    This change detects whether the target filesystem supports chown(2).
    If not, it adds the --no-same-owner flag to tar to stop it from trying
    to change the ownership of newly created files.

commit 781857a86b3bc8238995a9212ea09aa368fc2fc9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 18 12:32:21 2012 +0100

    daemon: Make 'random_name' into a utility function.
    
    This is mostly code motion, although the precise contract of this
    function changes slightly to make it more generally useful

commit 9c2b9c2df6c3c10b090d71bc808d755dbf625cbe
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 18 11:14:19 2012 +0100

    virt-make-fs: Suggest guestfish for complex layouts in man page.

commit b25aea33fa314857c8094e09af9654f925fb935f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 18 10:03:29 2012 +0100

    build: Change how make.sh, packagelist, excludelist are updated.
    
    Add proper dependencies for these files, but also use 'cmp' to ensure
    they only get overwritten if the new files have actually changed, so
    we don't rebuild the appliance unnecessarily.

commit 87206e4e9e3b0ca813a4ff7b5fac0eccc07a484a
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Wed Jul 18 09:58:43 2012 +0800

    New API: add new api xfs_info
    
    Add xfs_info to show the geometry of the xfs filesystem.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>
    
    RWMJ:
     - Updated po/POTFILES.
     - Use xfs_ prefix for all struct fields.
     - Return uninitialized fields as -1 / empty string.
     - Copyedit the description.

commit 2f89f584c0203023f8a829ff9796dc2c14ddeb68
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Wed Jul 18 09:58:44 2012 +0800

    augeas: make functions as noreturn
    
    Just make gcc happy.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 8e75e21b23f18ec0b0fa4f07f96c31dd56a50f25
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 17 20:04:24 2012 +0100

    podwrapper: Use UTF8 in output, send errors to stderr.
    
    This fixes commit 1e17a32060feb937b3972f61b37f9116ad7d8d9a.

commit d76ea07814b1d1390d1d94f0e579c0fe4e28dca8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 17 15:38:52 2012 +0100

    Version 1.19.20.

commit 973581780d8a006f336684fef6762801402d775d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 17 13:44:45 2012 +0100

    case_sensitive_path: Allow trailing path element to be missing (RHBZ#840115).
    
    case_sensitive_path is undefined when the final path element doesn't
    exist.  Currently it returns an error, but this means that creating a
    new file doesn't work as expected:
    
      $ guestfish --rw -i -d windows touch 'win:c:\blah'
      libguestfs: error: case_sensitive_path: blah no file or directory found with this name
    
    We should allow this case (provided there is no trailing slash) so
    that new files or directories can be created.

commit ac0373bdecfabe6acf99d3662e5117de73fa2aef
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 17 13:31:05 2012 +0100

    case_sensitive_path: Move variables to top of function.
    
    This is just code motion.

commit 4bc110e2bc738bde9b9c09bc602ef13c06b60e90
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 17 12:46:04 2012 +0100

    docs: Use L<...> for links.
    
    Instead of working around bugs, podwrapper has been fixed so that
    links work in all output formats.

commit 182b4a66609ffd5366575d72351cd8174cf68145
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 17 13:16:40 2012 +0100

    podwrapper: Subclass Pod::Man so we can fix the way links are generated.

commit 9967ad3fa13178c70afd5da77f77a4115808733d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 17 13:15:55 2012 +0100

    podwrapper: Define $VERSION in subclass.
    
    The superclass sometimes uses this and will give an undefined
    error if it's missing.

commit 60c42dd2a1a173ec1161502762bc33ae7a1cf190
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 17 12:49:59 2012 +0100

    podwrapper: Tidy up the program name.
    
    Messages now look like this:
    
      podwrapper.pl: wrote guestfs-examples.3
      podwrapper.pl: wrote ../html/guestfs-examples.3.html

commit f6846d74c947bd8b711ef0b29148fa1e90580354
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 17 12:34:51 2012 +0100

    perl: In examples, call $g->shutdown, $g->close.

commit a99ea198b24745c49cdb42645c3497ac3b0e6a2f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 17 12:33:45 2012 +0100

    perl: Use $g instead of $h in documentation.
    
    $g is the "standard" name for libguestfs handles.

commit 8d0baf7b859fbbe40bdb072b2009d77c02cee7c3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 16 23:04:17 2012 +0100

    docs: febootstrap is in section 8 of the manual, not section 1.

commit 1e17a32060feb937b3972f61b37f9116ad7d8d9a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 16 19:41:39 2012 +0100

    Replace podwrapper shell script with custom Perl script.
    
    This uses Pod::Simple so it properly parses the input POD and can
    generate proper custom output as required specifically by libguestfs.
    
    One immediate benefit is that links between and within manual pages
    now work mostly correctly.

commit 0bf1e5b6650e71434430bf119b486a779516886d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 16 21:58:57 2012 +0100

    Fix pod.css for new HTML output from Perl 5.16.
    
    There used to be a <div> around the table of contents, but that
    is no longer present.

commit 3a442e66170518f725b92a1041546d81fde95492
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 16 21:58:34 2012 +0100

    configure: Make generated files read-only.
    
    Some of the generated files anyway.

commit f2ea617e224cd82496e56a41b5878063d6f02e3d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 16 18:56:57 2012 +0100

    build: Change calls to podwrapper.sh to use $(PODWRAPPER).
    
    This will allow us to easily change the location of this
    script in future.

commit c7d342a94a89324be2f568c940ba089fdd5aa0c0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 16 16:47:44 2012 +0100

    virt-make-fs: Add --floppy option to make preconfigured vfd's.

commit 24b7979ea25cbe5f08494cc4580c1341e78e090e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 16 16:26:26 2012 +0100

    virt-make-fs: Recognize "msdos" as a partition or filesystem type.
    
    Set MBR partition type byte accordingly.

commit d69a03e44832d8a8da84696bd4e2aaf3cd5d6cff
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 16 14:01:46 2012 +0100

    Revert "ocaml: Calling Gc.compact before g#mount_local works around RHBZ#838081."
    
    This reverts commit ad7c4498f66f37c4219242c6df04d28e9ee7877f.
    
    Reverted because we still see core dumps.

commit 2bd080fd5a233656d32b2697922881df54bc7a77
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 16 10:16:54 2012 +0100

    Version 1.19.19.

commit 98f2d221cfe184535a493057f5b2b38d8bee34e4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 16 13:29:32 2012 +0100

    run: Update comments.

commit 95d26f02405c090f886fc2c47a9e51ca37f9c09e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 12 16:38:57 2012 +0100

    generator: Rename 'ntfsresize_opts' API to 'ntfsresize'.
    
    By using the once_had_no_optargs flag, this change is backwards
    compatible for callers.

commit e055bf4caba24fd24153984770ffe71b42003f76
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 12 16:38:57 2012 +0100

    generator: Rename 'mkfs_opts' API to 'mkfs'.
    
    By using the once_had_no_optargs flag, this change is backwards
    compatible for callers.

commit 7486fc6f43bdb22a989cc039e361afc4c0658d52
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 14 12:42:24 2012 +0100

    generator: Rename 'add_drive_opts' API to 'add_drive'.
    
    By using the once_had_no_optargs flag, this change is backwards
    compatible for callers (except Haskell, PHP and GObject as discussed
    in earlier commit).

commit b48ae2eadf43315159f2174c8fd35b05ede14c0f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 13 13:42:40 2012 +0100

    generator: In non-C bindings, generate '*_opts' alias.
    
    In C, a function called 'func' which has once_had_no_optargs=true will
    (because of the previous commit) generate 'func_opts' and a
    backwards-compatibility function called 'func'.
    
    This commit changes some of the non-C bindings so that they also
    generate 'func_opts' which is merely a wrapper that calls 'func'.
    
    This avoids incompatibility when we rename 'mkfs_opts' etc back to
    plain 'mkfs', and it also makes it easier to translate between other
    language bindings and C code.
    
    NB: Some bindings do not include aliases:
    
      PHP:     There's no way to easily alias methods in PHP < 5.3, and we
               can't assume everyone has this minimum version.
    
      GObject: Very complex to add aliases, but we should probably do this
               at some point.
    
      Haskell: No support for optargs in these bindings.  Unfortunately
               this means that we can no longer bind 'Guestfs.add_drive'
               (since it will be changed to add optional arguments) making
               the Haskell bindings even less useful than they were already.

commit 98757e151ae8ad8d334f028690abcc85b91c73e5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 12 16:32:47 2012 +0100

    generator: Allow non-optargs functions to gain optargs.
    
    This commit adds a flag (once_had_no_optargs) which can be used to add
    optargs to functions that currently don't have any.
    
    The idea is that if 'func' currently has no optargs, we can safely add
    optargs provided we are backwards compatible for existing callers.
    
    In C that means we leave 'guestfs_func' alone and provide an extra
    function 'guestfs_func_opts' that takes the optargs ('guestfs_func'
    becomes a wrapper that calls 'guestfs_func_opts').
    
    In the C generator this means there are two names for each function
    (although the two names are normally identical).  'c_name' is the name
    that we export publicly (eg. [guestfs_] 'func_opts').  'name' is the
    internal name of the function (eg. 'func') which is used for
    everything apart from the public interface, and also to generate the
    no-optargs compat function.
    
    In other languages that can add optional arguments safely, we simply
    add the arguments to the existing 'func', so for example in Perl:
    
      $g->func (required_args)
      $g->func (required_args, optional_args)
    
    can be used.
    
    Note that this commit does not cause any change to the output of the
    generator.  I verified this by diffing the output before and after.

commit 9eb606045627ff5fdc30eea011c67eb30b7655fa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 13 11:33:49 2012 +0100

    generator: Rearrange some C generator code into sub-functions.
    
    This is just code motion.  I verified this by comparing the
    generator output before and after this commit.

commit 0da2dbef26a9efddbc1f4cd6cbe796b3b5f98d13
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 13 13:59:00 2012 +0100

    java: Generate overloaded non-optargs method for each optargs method.
    
    For example the existing method:
    
      public void mkfs_opts (String fstype, String device, Map<..> optargs);
    
    is now accompanied by this overloaded method which is a simple wrapper:
    
      public void mkfs_opts (String fstype, String device)
        throws LibGuestFSException
      {
        mkfs_opts (fstype, device, null);
      }

commit 60805c92179bc193be2d125504b12d285ff7c74b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 12 16:27:38 2012 +0100

    generator: Add c_optarg_prefix for each action.
    
    This updates commit 9286f556c6a9e6967fcac8aacdae3660821c4c7a.

commit 9286f556c6a9e6967fcac8aacdae3660821c4c7a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 12 12:50:49 2012 +0100

    generator: Add c_function (C function name) to each action struct.
    
    This field, which is generated internally by the generator, is the
    name of the C function corresponding to each action.
    
    For actions that have NO optional arguments, it's just "guestfs_<name>".
    
    For actions that have any optional arguments, it is
    "guestfs_<name>_argv" (since any binding has to construct the optional
    argument struct explicitly).
    
    In a future commit, this mapping may become more complex.
    
    This commit also "fixes" the C# bindings which didn't handle optional
    arguments properly at all.  In fact, it doesn't fix this, it just
    changes it enough that it probably now compiles.  We should either
    compile and test the bindings routinely with Mono, or drop them, since
    they are starting to bit-rot.
    
    In the GObject bindings, I have added a space between the C function
    name and the first paren.
    
    Apart from the C# and GObject changes, this is just code motion.  It
    was verified by diffing the output of the generator before and after.

commit e80f3687322f91642e8d196de38892174f8c648a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 12 11:11:31 2012 +0100

    generator: Change the way that camel-case names are generated.
    
    Store the camel-case name directly in the struct instead
    of generating it on the fly in only the GObject bindings.
    
    This is just code motion.  Tested by verifying that the generator
    output is identical.

commit e452a0b8cacd031ecea158a141ecbc41b3426de2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 11 23:56:10 2012 +0100

    tests: Rename test0* functions as internal_test*.
    
    The internal_* prefix is reserved for internal functions
    such as these tests.

commit 7a0478bed0fe3ccbdf16087552f3d6ea196f29ec
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 11 23:55:11 2012 +0100

    tests: Better way to ensure 'g' is used and return success or error.

commit 39d1a7dbc9c7d4ae8cbb492a39149d1f8e75ff70
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 11 15:07:01 2012 +0100

    generator: Use a struct instead of a tuple to describe each action.
    
    Each action changes from a tuple like this:
    
      ("cat", (RString "content", [Pathname "path"], []), 4,
       [ProtocolLimitWarning],
       [InitISOFS, Always, TestOutput (
          [["cat"; "/known-2"]], "abcdef\n")],
       "list the contents of a file",
       "[...]");
    
    to a slightly longer but more readable struct:
    
      { defaults with
        name = "cat";
        style = RString "content", [Pathname "path"], [];
        proc_nr = Some 4;
        protocol_limit_warning = true;
        tests = [
          InitISOFS, Always, TestOutput (
          [["cat"; "/known-2"]], "abcdef\n")
        ];
        shortdesc = "list the contents of a file";
        longdesc = "[...]" };
    
    ["defaults" is a struct which contains the defaults for every field,
    allowing us to use the "{ defaults with ... }" syntax to just update
    the fields we want to be different from the defaults.]
    
    This is a mechanical change and there is no change to the output of
    the generator.  I checked the output before and after with diff to
    verify this.  There are no changes in the output apart from UUIDs
    which are expected to change with each run.

commit 7b619d47f6931286620bc7c1cb6dcb4e63cc951b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 11 15:05:57 2012 +0100

    todo: Tidy up test0 functions.

commit 196742cd46a8d80f0298f9f58c540482919306a3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 11 10:47:18 2012 +0100

    generator: Add a note in generator/README about safely extending functions.

commit cf0defedb8121a0ff39c1d4c6d9f3eee9fd7ee72
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 11 10:46:56 2012 +0100

    generator: Move note in comment to generator/README file.

commit ec0c7e0a1aafd145309ab53749d910ad837d8745
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 10 18:59:35 2012 +0100

    fuse: Cleaner code and documentation for safe cleanups.

commit f883e4d8d3ea65c5cd4c2dc5d557989c00aafc56
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 10 18:59:04 2012 +0100

    tests/guests: Add temp files to CLEANFILES.

commit 1c8403885cb5ddff7eda975772cb154b375dbaae
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 10 18:44:45 2012 +0100

    Update translations from Transifex.

commit 33bb7408f684bf0d4eff0a0e99c53449fa4923e4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 10 13:46:17 2012 +0100

    podwrapper: Fix shell script.
    
    This fixes commit f9a5e3ed86ee7bcd13619f13b4d4de6ce46ac8c3.

commit f9a5e3ed86ee7bcd13619f13b4d4de6ce46ac8c3
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Tue Jul 10 07:30:11 2012 +0200

    podwrapper.sh: Take date from ChangeLog or from the latest git commit.

commit afb30b1b8a6dc8b256788c26bbb5a9dc22e6972d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 9 18:36:46 2012 +0100

    Version 1.19.18.

commit 8df259496a80bc74edbab4436e3679d0900bd173
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 9 15:56:47 2012 +0100

    fuse: Add regression test for RHBZ#838592.

commit 5546ea6d68532caa69fbede1f29385afe34e7362
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 9 15:56:20 2012 +0100

    fuse: Add guestmount --pid-file option (RHBZ#838592).

commit bfbfe6dd788ee3705383b544c5bc238a7dd5ca53
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 9 15:24:26 2012 +0100

    fuse: Link to mount-local documentation in guestmount man page.

commit 1cde66165aac222f1a07ad4c3873c61d49eabb02
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 9 15:23:52 2012 +0100

    fuse: Document race condition possible with fusermount.
    
    See also:
    https://bugzilla.redhat.com/show_bug.cgi?id=835466#c9

commit b749dc70742e749dbd7c0c20e6e7191fdd199170
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 9 15:23:09 2012 +0100

    fuse: Document Device or resource busy errors from fusermount.

commit bd3e42a8ded1ed7a4177ad03646572eb6155a49c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jul 8 12:55:44 2012 +0100

    Revert "launch: Correction in comment."
    
    This reverts commit 6e5a85bb9b6557bc337625a339728e23f5f2dd94.
    
    It turns out this is a bug in QEMU after all.

commit e6dec159488f589df62c9f59477281f8264a19c8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 7 16:19:55 2012 +0100

    extra-tests: Add a test using upstream qemu.

commit 6e5a85bb9b6557bc337625a339728e23f5f2dd94
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 7 15:49:22 2012 +0100

    launch: Correction in comment.
    
    https://bugs.launchpad.net/qemu/+bug/1021649 is invalid, probably
    caused by a Fedora ROM.
    
    This updates commit 52d188e32fb8addb45bf926df07e34ab35898f85.

commit 1596b6026ddd1e343efc6a74fc23f46e4975868f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 7 12:39:46 2012 +0100

    Update gnulib to latest version.

commit ac25512175fc99860b1cdd4de9969b2d2259d7e6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 6 14:11:38 2012 +0100

    Version 1.19.17.

commit ad7c4498f66f37c4219242c6df04d28e9ee7877f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 6 13:47:07 2012 +0100

    ocaml: Calling Gc.compact before g#mount_local works around RHBZ#838081.

commit 52d188e32fb8addb45bf926df07e34ab35898f85
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 6 10:29:26 2012 +0100

    qemu: Use sgabios by default (thanks Dan Berrange).

commit 1b87f89b5c61f7b840663ddebaa58beb716bb1e9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 4 16:44:26 2012 +0100

    todo: Investigate qemu caching modes.

commit a95fc923880018e5e533d69ba2bef702e0f6dd3c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 3 21:45:07 2012 +0100

    Version 1.19.16.

commit 7996e0882442dc7bac2ab573e2fcac0b488c8cc7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 4 16:16:17 2012 +0100

    qemu or qemu-kvm >= 1.1.0 is required.
    
    Earlier versions of qemu contained a bug in the qcow2 code which
    causes qemu to segfault when shutting down and flushing its internal
    cache, and this can result in data loss.

commit ffbf1475f7ae7c462db289ad4834391469e72edd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 3 13:22:45 2012 +0100

    New API: guestfs_shutdown: Cleanly shutdown the backend.
    
    The new API splits orderly close into a two-step process:
    
      if (guestfs_shutdown (g) == -1) {
        /* handle the error, eg. qemu error */
      }
      guestfs_close (g);
    
    Note that the explicit shutdown step is only necessary in the case
    where you have made changes to the disk image and want to handle write
    errors.  Read the documentation for further information.
    
    This change also:
    
     - deprecates guestfs_kill_subprocess
    
     - turns guestfs_kill_subprocess into the same as guestfs_shutdown
    
     - changes guestfish and other tools to call shutdown + close
       where necessary (not for read-only tools)
    
     - updates documentation
    
     - updates examples

commit bcc4ffb52b9f4b5db7861682905ec32844f4603b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 3 13:09:53 2012 +0100

    close: Warn if qemu exits unsuccessfully.
    
    Currently guestfs_close has no method to return an error indication,
    so this commit simply prints the error on stderr.

commit fc3c6fff4b0a6ffeb75aa78b1d73241a14a03cd1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 3 11:07:13 2012 +0100

    close: Rearrange the order in which the handle is closed and freed.
    
    The order is now:
    
     - remove the handle from the list of handles
     - send close trace message
     - sync and shutdown qemu
     - run user close callback
     - free temporary directory
     - free memory
    
    This commit ought to be no functional change.

commit 27ebf517fae972eee49ae5911a03fabe5f4b6e54
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 3 14:42:10 2012 +0100

    perl, python, ruby: Fix comments on call to close method.
    
    Make the comments consistent.
    
    Also make the Perl example call $g->close explicitly so it is
    consistent with the other examples.

commit 917550a117904ec1a06b77a7870a147014d71adb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 3 14:36:45 2012 +0100

    examples: In create_disk example, don't call set_autosync.
    
    This is now set by default in all supported versions of libguestfs.
    It's just confusing if the examples refer to it.

commit c0a3c9ce70b98171e737e49e6dccc4457963f2ec
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 2 16:38:19 2012 +0100

    daemon: Run fsync on block devices after sync (RHBZ#836710).
    
    On Linux, sync(2) does not actually issue a write barrier, thus it
    doesn't force a flush of the underlying hardware write cache (or
    qemu's disk cache in the virtual case).
    
    This can be a problem, because libguestfs relies on running sync in
    the appliance, followed by killing qemu (using SIGTERM).
    
    In most cases, this is fine, because killing qemu with SIGTERM should
    cause it to flush out the disk cache before it exits.  However we have
    found various bugs in qemu which cause qemu to crash while doing the
    flush, leaving the data unwritten (see RHBZ#836913).
    
    The solution is to issue fsync(2) to the block devices.  This has a
    write barrier, so it ensures that qemu writes out its cache long
    before we get around to killing qemu.

commit cb24ceedd8a8ef7da71cfcce6db10669de47685c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 2 16:30:23 2012 +0100

    daemon: Code tidy up in devsparts.
    
    No functional change.

commit 0437a7905619b8370e25fbae1a3e6388c5277be9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 2 12:47:37 2012 +0100

    Add notes about how qemu cache=none works internally.
    
    This is just a comment and has no functional effect.

commit 1608ca182b094a1dbe22094f39a5e86f18f728b7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 2 12:46:14 2012 +0100

    Rename qemu option cache=off to cache=none.
    
    Note that qemu treats these identically, so this change has
    no functional effect.

commit 906f8e3ae24a084d9a70d33d84c0ce29bdafa79c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 2 12:34:11 2012 +0100

    appliance: Update paths to udevd.
    
    systemd is playing a WTF game with udevd, moving it around and
    renaming it unnecessarily in each release.  Chase all known locations.

commit 100271c7bc00a1f9baacd8c56b43e156b736fc12
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 2 12:33:42 2012 +0100

    appliance: Update comment to note that systemd package now contains udevd.

commit 757b089053137dc9e12be4b69b7c68fa7c70ae08
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 29 20:16:44 2012 +0100

    Version 1.19.15.

commit 5489304c8d2836713ec58051c24514eba22b8c94
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 29 18:03:02 2012 +0100

    tests: Add a test of /dev/disk/by-id paths (RHBZ#627675).

commit 339f3647f889424af2a2256c4fcad0b44982c275
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 29 17:57:00 2012 +0100

    tests: Use qemu-img to create an overlay for testing, instead of copying.
    
    Replace:
    
      cp tests/guests/fedora.img test.img
    
    with the longer but possibly more space-efficient equivalent:
    
      qemu-img create -F raw -b tests/guests/fedora.img -f qcow2 test.qcow2

commit ea8421c5d297698856a87c2cfe4a6b42796175a8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 29 18:20:42 2012 +0100

    inspect: Check partition exists when doing fstab mapping.
    
    If the partition name we're about to return doesn't really exist,
    then don't perform the mapping.

commit 7eaa99994ebd354f4b078d4068695984989a907f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 29 16:45:07 2012 +0100

    inspect: Guess device name from /dev/disk/by-id/*-partN path (RHBZ#627675).
    
    See https://bugzilla.redhat.com/show_bug.cgi?id=836573#c3
    for an explanation.
    
    Useful function 'is_partition' shows how to tell if a device name
    represents a partition.

commit 47b8225b05a7e35411f954f61f3eb3115c5a9f45
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 29 16:43:53 2012 +0100

    inspect: Refactor resolve_fstab_device code into multiple functions.
    
    This is mostly code motion, although it also fixes a memory leak in an
    extremely rare failure case, and it generally tidies up the existing
    code.

commit 152b179a19e43fcb0baec65ea65d394ee1dba891
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 29 19:03:37 2012 +0100

    New API: guestfs_nr_devices
    
    This returns the number of whole block devices added.  It is usually
    simpler to call this than to list the devices and count them, which
    is what we do in some places in the current codebase.

commit cba49169094f04dead9b165b6b5991afa92132ff
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 29 14:54:44 2012 +0100

    ruby: Fix detection of library (thanks Hilko Bengen).
    
    On Debian, the Ruby C extensions library isn't '-lruby', it's
    something like '-lruby1.8' or '-lruby-1.9.1' and these can even be
    parallel-installed.
    
    Fix detection so we use Ruby's own rbconfig.rb file to find the right
    library to use.

commit b07d0968823d008776345a1c724713d2320e1571
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 29 14:54:05 2012 +0100

    ruby: Changing spacing in configure file.
    
    No functional change.

commit b9f858e5eefa0d2abae5ff0a61a39b0d34334bc1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 29 14:18:10 2012 +0100

    ruby: Remove useless AC_SUBST in configure file.

commit a176f508cb96e404fbb8eb7b142fa8b43ea70b00
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 28 17:19:14 2012 +0100

    Update API support from tarballs.

commit 27efd99ddb5fcf16e0c58ecfee8832ec53d3c9ff
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 28 13:49:32 2012 +0100

    tests: Reformat TESTS_ENVIRONMENT so all use a standard format.
    
    No functional change.

commit 2f1a602c4bc8988c538297dbf49e6c9b486e2441
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 28 13:47:35 2012 +0100

    python: Set PYTHON in run script.

commit 04a533ca8c8fcea6d84a14f4ae8a672df94a2e46
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 28 13:46:31 2012 +0100

    ocaml: Set CAML_LD_LIBRARY_PATH in run script.

commit e7d2d3cb8905598b57c4d24a933ef25fdb021b1d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 28 13:41:40 2012 +0100

    ruby: Use run --tests for tests.

commit 8439e97f764872d8bc31c6bcf4c7b44afbc4523a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 28 13:40:33 2012 +0100

    java: Use run --tests for tests.
    
    Java-specific environment variables are set in the run script.

commit 1b56aedc2b68a2db1e98c68d5344247742909e2e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 28 13:34:52 2012 +0100

    gobject: Use run --test for tests, and set GJS in run script.

commit 2d56e5af900662ea0a13e9e8ea4a802609214ecc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 28 13:32:53 2012 +0100

    run: Rearrangement and add comments.
    
    No functional change.

commit 927ef14c584524a16e8be3fb7eff6cd3ee880ce6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 28 13:15:57 2012 +0100

    run: Set MALLOC_PERTURB_ to a random value.
    
    MALLOC_PERTURB_ is a glibc feature which causes malloc to wipe memory
    before and after it is used, allowing both use-after-free and
    uninitialized reads to be detected with relatively little performance
    penalty:
    
      http://udrepper.livejournal.com/11429.html?nojs=1
    
    Modify the ./run script so that it always sets this.
    
    We were already using MALLOC_PERTURB_ in most tests.  Since ./run is
    now setting this, we can remove it from individual Makefiles.  Most
    TESTS_ENVIRONMENT will now simply look like this:
    
      TESTS_ENVIRONMENT = $(top_builddir)/run --test

commit b3df3ba5c824dc5ea15902df2f1ee80254aca22f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 28 08:56:18 2012 +0100

    Version 1.19.14.

commit cadfab1a20f3cfb37e1a4d69fbea001754dcba32
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 27 16:34:23 2012 +0100

    tests: Fix 'run --test' so it cleans up its temporary file.
    
    This fixes commit 05d4e07918bfa9907a1fa66391e8e2e2370c64d4.

commit 1d17a6e9d8f434f952f3c171b5a81ca6b916fa1f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 27 15:49:06 2012 +0100

    Ensure #include <config.h> occurs in every C file.

commit 6777425636d1c04494e52c61dc44f523458d12d3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 27 15:30:56 2012 +0100

    src/actions.c: Include <config.h> in this generated file.
    
    On RHEL 5, because _GNU_SOURCE was not defined, open_memstream was not
    being declared, resulting in miscompilation and a segfault in the
    trace code whenever open_memstream returned a pointer >= 0x80000000
    (which would be truncated to a 32 bit int and then sign-extended).

commit 6afb7336e33dc28c4fd1a4545a8298ee36c10723
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 27 10:54:02 2012 +0100

    gobject: bindtests: gjs exception behaviour changed, fix test.
    
    When libguestfs calls 'error (g, "error")', gjs in F17 throws
    error.message == "Error invoking Guestfs.test0rinterr: error"
    
    In F18, error.message is simply the string "error".
    
    Fix the test so it works for both cases.

commit b3a5403cdad6d3b9c8e4d342538790cfaecbd99c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 26 23:49:00 2012 +0100

    Version 1.19.13.

commit 2eacd4a19157586ffa122318f1d2e2fd94a5e44f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 26 23:34:42 2012 +0100

    fuse: Use the ./run --test script to run tests.

commit 05d4e07918bfa9907a1fa66391e8e2e2370c64d4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 26 22:47:35 2012 +0100

    tests: Add ./run --test option.
    
    This option, when added via
      TESTS_ENVIRONMENT = [...] $(top_builddir)/run --test
    allows us to run the tests and only print the full output (including
    debugging etc) when the test fails.

commit bbb7d75c91450ab029edb794b0486eeb8220e4fd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 26 23:00:29 2012 +0100

    ./run: Fix indenting for shell script.

commit 0977c8408a1119c0582e3d2ab6edef23a1f1f22e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 26 18:38:23 2012 +0100

    ocaml: Allow parallel mount-local test to be skipped.
    
    FUSE is not very reliable on RHEL 5.

commit 8d88b06277c1d6d7a26b9434cc69a7bae9ada7fc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 26 17:46:05 2012 +0100

    FAQ: Add Gentoo (thanks Agostino Sarubbo).

commit eb8eb3b9d52bada636317bbcbf0c94183740c1a6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 26 15:32:36 2012 +0100

    Version 1.19.12.

commit c87956837e962072fff61edef5b18e55ad42d730
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 26 14:39:16 2012 +0100

    launch: Avoid double-close when qemu exits early.
    
    The stdin and stdout of the qemu process are aliased to g->fd:
    
      g->fd[0] = wfd[1];
      g->fd[1] = rfd[0];
    
    However if the child exits early, then child_cleanup closes g->fd[0],
    g->fd[1], AND the code at the cleanup1 label closes wfd[1], rfd[0],
    resulting in a double-close.
    
    Avoid this case by setting wfd[1], rfd[0] to -1.  In the cleanup1
    label, only close wfd[1], rfd[0] if they are not -1, and add the same
    for g->fd[0], g->fd[1].

commit 9e221e55b61e9f1cd0caf292ca609a4ca26f1d4d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 26 13:36:19 2012 +0100

    launch: Ensure errno from test_qemu_cmd is captured and printed.

commit 11317b5d1243f3afc35f7abe8edc646f75813e36
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 26 13:31:58 2012 +0100

    launch: Set g->sock = -1 to avoid double-close.
    
    This fixes commit ef5c02c6ee72eb8e127115923951777a2c2b8480.

commit ef5c02c6ee72eb8e127115923951777a2c2b8480
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 26 11:47:26 2012 +0100

    launch: Log errors from close syscall.

commit 90d0beb3c528d91029349b64d0159836c776189b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 26 09:17:19 2012 +0100

    tests: Add thread IDs to test of bug 790721.

commit 8fc2127975de2f364e348c5a558d78e77988953c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 25 15:19:58 2012 +0100

    sysprep: Don't check for /dev/fuse before running the test.
    
    The program doesn't actually require FUSE when used without
    any --script options.

commit f27770e1412c0dbe652d490791347911aac62b24
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 25 15:19:19 2012 +0100

    fish: Allow mount-local test to be skipped with environment variable.
    
    The test uses FUSE, so we need a way to disable it on RHEL 5.

commit 2afa0eeb9040d90fc020c01caa0b24b00e0556ce
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 25 15:14:46 2012 +0100

    tests: Allow SELinux tests to be skipped with an environment variable.

commit 030e318049b58a1d62f1179dba3a7fb0f015a83c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 25 11:29:16 2012 +0100

    Version 1.19.11.

commit 729bb9c6b5ae0c0e7c68dc802b1617936062f966
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 25 09:03:39 2012 +0100

    launch: Treat /dev/null specially, for old KVM.
    
    Old KVM can't add /dev/null readonly.  Treat /dev/null as a special
    case.
    
    We also fix a few tests where /dev/null was being used with
    format=qcow2.  This was always incorrect behaviour, but qemu appears
    to tolerate it.

commit 78a515ec4a4e8650bd2e1ffc0bfbb97b9568306d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 25 09:02:18 2012 +0100

    lib: Remove obsolete NETWORK, ROUTER definitions in header file.
    
    These haven't been used since we switched over to virtio-serial.

commit a0a86484be86da3085377f874a9de76c94db712b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 22 22:06:30 2012 +0100

    Version 1.19.10.

commit 461455ca7cab93af09445d135483f5705589cc0c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 22 13:02:35 2012 +0100

    tests/xml: Fix compilation of test on RHEL 5 with old libvirt.
    
    Old <libvirt.h> had a conflicting definition of virDomainGetXMLDesc:
    
    fake_libvirt_xml.c:36: error: conflicting types for 'virDomainGetXMLDesc'
    /usr/include/libvirt/libvirt.h:715: error: previous declaration of 'virDomainGetXMLDesc' was here
    
    The difference is not material ('int' vs. 'unsigned int').
    
    Avoid the error by not including <libvirt.h>.

commit 9e7644346dc4303316e59dda13ea5b2f60549626
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 22 12:58:49 2012 +0100

    tests: Add workaround for missing O_CLOEXEC.

commit 35882ba97722ddf9b4c55a332961b08ad8240dd7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 22 12:57:14 2012 +0100

    tests: Fix broken workarounds for missing O_CLOEXEC.

commit ef1514aa1e0a099d71cbb7d2c5f24f9f32e1939d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 22 11:04:31 2012 +0100

    test-virt-resize: Replace truncate with guestfish sparse.
    
    Another instance of 'truncate' command.
    
    See commit 39df80dcc0e485e69048bddbf33c259ce532e50d for an
    explanation.

commit 4d3ec25b47361601604e2f585178393e60f4cd4d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 22 10:54:57 2012 +0100

    part-get-bootable: Fix when partitions are missing or unordered (RHBZ#602997).
    
    The original fix for this in
    commit 511c82df46f5c6f4a7f984fdb81d4691038ed6da was not complete, in
    that it did not fix the case of the old (pre '-m' option) parted.
    This doesn't matter for Fedora, but it matters for RHEL 5 which has
    this ancient parted.

commit 8098d062b4cb70defd4aecba0ba8cd75cf893751
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 22 09:46:39 2012 +0100

    ruby: Add a replacement rb_hash_lookup function for Ruby 1.8.5.
    
    This function was first added to Ruby in 1.8.7.

commit 823ba05ebd8f1a12574a3f154aaf7c8b4f2aeeac
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 22 09:45:06 2012 +0100

    ruby: Fix libruby test.
    
    If -lruby was not available, this used to define HAVE_LIBRUBY=0.
    However this meant that the later test -n "$HAVE_LIBRUBY" would
    be successful, whereas it should fail in this case.

commit 6cb74d46ba5b1c3f1edd3bfb12df9d4da2ec8a8f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 22 08:49:40 2012 +0100

    virt-format: Don't call wipefs unless API is available.
    
    This API is optional.  Don't call it unless it's available
    in the appliance.

commit 145f35badfd9ca4a6d9f54f7732566a5e5114876
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 22 08:41:14 2012 +0100

    tests: Add SKIP_TEST_* variables to allow these tests to be skipped.
    
    By setting these variables, we can skip tests that fail on
    RHEL 5.

commit 6352953ea927819a8ece795d03c4938e657d0a97
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 19 08:31:25 2012 +0100

    FAQ: Mention update-guestfs-appliance (thanks Steven Dake).

commit 489da3ccdf96e995d3f53fe68eced37b16baa1d2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 18 22:21:05 2012 +0100

    build: Workaround for AC_PROG_SED not existing.
    
    This didn't exist on ancient autoconf in RHEL 5.

commit bc7f1a5ef156576c069f47ea33f4977979ac032d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 18 21:42:44 2012 +0100

    build: Define abs_builddir if not defined already.
    
    This is missing on RHEL 5.
    
    This updates commit 50aa9533e4a505e1c64dbedddb30491bfbb755d6.

commit baee3f52ef1c4018f6b19a805a5c9ed01cf8ce73
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 18 16:33:15 2012 +0100

    Version 1.19.9.

commit d7c9c6a0d926982b64d13949a5da580ea4ecc4b6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 18 13:05:35 2012 +0100

    fuse: Skip 'truncate' tests if this command is missing.

commit 39df80dcc0e485e69048bddbf33c259ce532e50d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 18 13:04:46 2012 +0100

    tests: Replace truncate command with 'guestfish sparse'.
    
    RHEL 5 didn't have the truncate command, but we can replace:
    
      truncate -s SIZE FILE
    
    with the roughly equivalent command:
    
      guestfish sparse FILE SIZE

commit 4846b84476015874d569c14c2c30fcd71aa4d54c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 18 10:11:19 2012 +0100

    fuse: Add replacement for fuse_opt_add_opt_escaped.
    
    RHEL 5-era FUSE didn't have this function.
    
    I copied the function out of upstream FUSE, since the license is
    compatible.

commit 50aa9533e4a505e1c64dbedddb30491bfbb755d6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jun 17 22:59:46 2012 +0100

    build: Define builddir and abs_srcdir when they are missing.
    
    RHEL 5-era autoconf did not define these, so define them manually
    when they are missing.
    
    Define builddir as '.'  The scripts require this.  It won't work
    in the srcdir != builddir case, but we don't care about that for
    RHEL 5.
    
    This commit also moves the builddir / abs_srcdir variable setting
    above the include of subdir-rules.mk, in case that include uses
    these variables.
    
    Useful script:
    
      for f in $(find -name Makefile.am | xargs fgrep '$(abs_srcdir)' -l) ; do
        if ! grep -q '^abs_srcdir' $f; then
          echo missing in $f
        fi
      done

commit dd216fedbdacfd641c2da4073ae26d3ccb6098a6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jun 17 23:13:22 2012 +0100

    ocaml: Use OCAMLOPTFLAGS when compiling .cmx (ie. native code) files.

commit 87de36670108a19b832e8f5ded8d413e7b575d70
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 16 10:19:04 2012 +0100

    configure: Look for mkisofs as well as genisoimage.
    
    For our purposes, the two tools are compatible.

commit 60a2f8706b305b4068df020598abee9566022e20
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 14 17:37:11 2012 +0100

    Ignore .gdb_history file.

commit 7b1cd65c4433124ef443d1eea8bca97356e7a40a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 14 17:36:17 2012 +0100

    ppc64: is_openable function needed on all platforms now.
    
    This fixes commit 295d6af48d1d8c5238d1536b0c6a2ece42b0b445.

commit cd6005128d52c01152abe5464f21cfd4f0605c28
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 14 16:21:09 2012 +0100

    Version 1.19.8.

commit 81ee155b9d385f73efa8540faea5725701d1ec5d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 14 12:38:01 2012 +0100

    tests: Add tests for extended attrs and SELinux, direct and via FUSE.
    
    Note that the SELinux + FUSE test is disabled because of:
    
    https://bugzilla.redhat.com/show_bug.cgi?id=811217
    https://bugzilla.redhat.com/show_bug.cgi?id=812798#c42

commit abbace68881b0917919913fe71bd738e45f36df5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 14 14:21:16 2012 +0100

    virtio-scsi: Increase udev timeout.
    
    In Koji, when you've got 200+ disks, udev times out before all the
    udev events have been processed.

commit d43e3d63de1622e98313bb797922dfd7d95ddd11
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 14 12:22:26 2012 +0100

    virt-edit: Document CVE-2012-2690.

commit 199cc2853c586b384a2b45154b06437d3fc38e89
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 14 09:57:28 2012 +0100

    Require febootstrap >= 3.17.

commit 8b15fb3e22cd8bf541ac142c00f15628c2b7bc40
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 13 23:25:50 2012 +0100

    Version 1.19.7.

commit 4c828dc568eef7425db7f4a65cb1482329aad72d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 13 16:24:29 2012 +0100

    tests: Add a test which adds the maximum number of disks and uses them.

commit 8735e92a1dae603f2584684ea802b0f5dc332543
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 13 14:49:06 2012 +0100

    virt-df: Use guestfs_max_disks instead of hard-coding limit of 25.
    
    And comprehensively fix it so it works with > 26 disks.

commit a9d7d044f552855a7ef78d953c0c2672e35bfc80
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 13 22:09:13 2012 +0100

    New API: device-index.
    
    This returns the index of the device, eg. /dev/sdb => 1.
    Or you can think of it as the order that the device was
    added, or the index of the device in guestfs_list_devices.

commit 46ed232dc2ff2f7dff91cd93a13d7ce6f2cec504
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 13 20:36:40 2012 +0100

    New API: guestfs_canonical_device_name.
    
    This API makes device names canonical, eg. /dev/vda1 -> /dev/sda1.

commit 998ebc333dbfe40c5953e36fb42f9610727a7532
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 13 18:28:22 2012 +0100

    lvm-filter: Make it work with > 26 devices.
    
    Thanks Alasdair Kergon.

commit c0a087b8236755e95371d5c352c9d29a3ca992c0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 13 17:27:56 2012 +0100

    daemon: Fix order of devices in guestfs_list_devices when > 26 disks.
    
    Sort the device names correctly, not just treating them as
    strings.  As a result, /dev/sdz < /dev/sdaa.

commit 4165e28b53d7024c38a171586acfb5c5b2c858b7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 13 14:42:21 2012 +0100

    New API: guestfs_max_disks.
    
    Returns the maximum number of disks that may be added to a handle.

commit 919b7e3f6c476c291744b98354208b04b0a670b3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 13 14:34:59 2012 +0100

    Update documentation on maximum number of disks.

commit cef979b2897725b735c68f5b806d332f4cea864d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 13 12:07:54 2012 +0100

    appliance: Add lsscsi to package list.

commit dbd489f95d08e6e6631f39924b0ad154f4ff8377
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 13 17:26:49 2012 +0100

    virtio-scsi: Fix disk name calculation.
    
    This fixes commit 0c0a7d0d868d153adf0600189f771459e1068b0a.

commit 69e2616b6c4965981b3f91396aa0c64a62c607ee
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 13 11:27:50 2012 +0100

    Require febootstrap >= 3.16.

commit 6e981fe5860631d1a996ad1c2961a78934b61a1a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 12 23:04:16 2012 +0100

    Version 1.19.6.

commit 320adf477805f703b0a1c79d86c3fb4078d11700
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 12 19:17:25 2012 +0100

    tests/md: Don't hard code /dev/vda in expected output of tests.
    
    Use a small sed script to canonicalize the device names.

commit 9a5c0d39081f9f40d7ad12fbb55fb6120046679c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 12 19:49:45 2012 +0100

    tests: Fix spelling in comment.

commit 7509cdf18e6d3fd96b10246f4d0417e5285e38f6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 12 18:51:59 2012 +0100

    tests/lvm: Don't hard-code /dev/vda in test.
    
    Hard-coding it breaks virtio-scsi because the devices are called
    /dev/sda etc.

commit 62c5b6db58911a5e51f59965619355437b7a7214
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 12 18:50:22 2012 +0100

    daemon: Always pass -F option to mke2fs.
    
    Apparently e2fsprogs only knows that "/dev/sda" is a whole device, but
    doesn't think that "/dev/vda" is.  On switching the default device
    over to virtio-scsi, that causes mke2fs without -F option to complain
    and ask for an interactive prompt.  Adding -F forces it to go ahead
    anyway.
    
    This caused several less-used APIs to break with virtio-scsi.

commit 0c0a7d0d868d153adf0600189f771459e1068b0a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 12 18:02:55 2012 +0100

    appliance: Add support for virtio-scsi.
    
    This requires febootstrap >= 3.15.

commit e0b5ecc801da55998405df77f5e21a79b2ba7caf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 12 14:52:43 2012 +0100

    Record output of qemu -device '?'.
    
    This allows us to find out what qemu devices are supported
    at runtime.

commit 295d6af48d1d8c5238d1536b0c6a2ece42b0b445
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 12 15:31:35 2012 +0100

    Require QEMU >= 1.0.
    
    QEMU 1.0 was released at the end of 2011.
    
    Remove all the cruft about detecting broken -machine type which
    was only required for QEMU 0.15.
    
    This also reverts commit 30ecbf3ec2ada68f7e125a180553e31b069033b7.
    Even on ARM you can pass -machine accel=kvm:tcg and qemu does the
    right thing, so I'm not sure why we wanted to disable that.

commit 7652b5aece3ac8fba5f34dc630fa772b3b63211f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 12 14:38:28 2012 +0100

    Remove ./configure --with-drive-if and --with-net-if options.
    
    These were used to select the default drive and network interface.
    They both default to 'virtio'.
    
    These were added back in the day when virtio was buggy, so that
    packagers could revert to using ide/ne2k_pci to work around distro
    bugs.  However virtio has been stable in qemu for a very long time, so
    it seems unlikely that any packager would need to use these, and in
    any case it would be better to do this detection at runtime (cf. for
    virtio-scsi).

commit 7590924022066f49d0adc48dbd05a4e8c053a5a4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 12 14:20:34 2012 +0100

    New API: fstrim - allow filesystem trim.

commit 668a0cebdf736a632f23764a927a095446fef1ca
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 9 22:00:46 2012 +0100

    Version 1.19.5.

commit 251b131e0a55cce21f6ee2240315903e34c4ffe1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 9 21:13:09 2012 +0100

    tests: Allow regression test for bug 690819 to be skipped.

commit 42475dd21fbdc551137fe815efadf08a87729642
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 9 20:50:25 2012 +0100

    blockdev_getbsz: Remove test.
    
    The output of this test depends on page size, so on ppc64
    it returns 64K.

commit 20137c8731d142797e2476e35fe724c95a8a7a06
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 9 20:18:09 2012 +0100

    fish: Change test-escapes so test is not endian-sensitive.
    
    The test used the external 'od' command to compare the output of
    guestfish with what it's supposed to be.  Unfortunately by default
    this outputs groups of 2-byte words, with the words' endianness
    affected by the current hardware endianness.  For example:
    
    x86-64$ echo -n ab | od
    0000000 061141
    0000002
    
    ppc64$ echo -n ab | od
    0000000 060542
    0000002
    
    By using 'od -b' instead we can output bytes instead of words, and
    there is no endianness issue, and the output is clearer:
    
    x86-64$ echo -n ab | od -b
    0000000 141 142
    0000002
    
    ppc64$ echo -n ab | od -b
    0000000 141 142
    0000002

commit ac2f9a42fbdacbea4840f9334ed50575f1006089
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 9 14:47:11 2012 +0100

    btrfs: Modify test to correctly detect btrfs availability.

commit 011666ae77b765b1a2b6b8e804d1cc1552f23e41
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 9 14:46:07 2012 +0100

    btrfs: Modify btrfs availability to test if the kernel supports btrfs.
    
    This is closer to the real meaning of "availability of btrfs", since
    just having the btrfs tool doesn't help much if it's not supported by
    the kernel too.

commit 4ba6aa3eaeb112a1468ad9189120d12e1df23709
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 9 13:42:13 2012 +0100

    New API: filesystem-available: tests for filesystem availability.
    
    This also creates an internal filesystem_available function within the
    daemon.

commit 4f671c829e33a218309f332621802d8d6f8d5040
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 8 19:34:53 2012 +0100

    ppc64: Update README with notes about ppc64 support.

commit 6cf15e8841897d3190c3e730e6eeae06fe4b8b1d
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Fri Jun 8 01:23:55 2012 +0200

    out-of-tree build/install fix for translations

commit 52af9a88b83b5d23695b733915dd91f27c67ab43
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 7 14:42:13 2012 +0100

    Version 1.19.4.

commit f90c01a5dc6a01284debdd0a45406f9d4a5e7159
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 7 09:18:12 2012 +0100

    Enhance BUGS script.
    
    Since RHBZ was updated, the old python-bugzilla program broke.  When
    it was fixed, I found the (undocumented) ordering of the results from
    the old tool was no longer true.
    
    This commit adds a small Perl script to sort the output predictably.
    Now bugs are sorted by both bug state and bug number, so the output
    should be more stable than before.
    
    Re-enable creation of the BUGS file in 'make dist'
    (this reverts commit 91f3456244e7843768da659e24ce0aeeb4ebe4b0).
    
    Also the BUGS file has been updated.

commit 4e5d3b06fb2f366c0010ae6aa15f9dee74261917
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 6 23:09:47 2012 +0100

    arm: Use #if defined instead of #ifdef.
    
    No functional change.

commit 1bdfc88eba7f932b2581d55ecf4455d0e70335c2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 6 13:42:17 2012 +0100

    ocaml: Fix parameters to ocaml_guestfs_create.
    
    The first parameter (not used) is a unit, so declare it properly.

commit 450493cf6b563389bd11f02284bd22d7ed90b5da
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 2 10:35:06 2012 +0100

    ppc64: Avoid "defined by not used" warning for is_openable function.

commit bbb21f923a77c0d6dde370688ba745367340ca45
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 31 23:24:22 2012 +0100

    Version 1.19.3.

commit 3893dc0b9436ebb4dd620c6ca9b1d038eacf83a6
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Wed May 23 22:51:31 2012 +0200

    Split off GObject tests that require an appliance

commit 148e8068267bcf9ce8ff3a5062747998f960619d
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Wed May 23 22:49:35 2012 +0200

    Fix out-of-tree build for GObject bindings

commit bcbb6bb760d45b3a640c5e0c9d0e0cf64c2cf0f2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 28 17:55:07 2012 +0100

    xattr: Refuse to set or get oversized extended attributes.
    
    See:
    https://www.redhat.com/archives/libguestfs/2012-May/msg00152.html

commit a7868dd3c940b6cee0894e6033ba611f01a423dd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 28 16:09:15 2012 +0100

    appliance: 'udevd' has been renamed, since it joined systemd.

commit a7e4a6c692554e4207b3bdff65946427e66e9fce
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 28 10:01:45 2012 -0400

    appliance: Move udev (common package name) to the common section.
    
    This should be just code motion.

commit a81165eb004d886cb5efaaecd9dca5cd8b39e66b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun May 27 21:53:21 2012 +0100

    Version 1.19.2.

commit 42dd5fa5b91fd5b27d6d4c8cc56958e17d6f534e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 26 23:07:03 2012 +0100

    Update to latest gnulib.

commit fe68cd77cbda4a8e19cd6e940c07b9afc1527610
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 25 16:52:19 2012 +0100

    Version 1.19.1.

commit 8e8a5764293d1b6bc3dbfb9409722e4c13384aec
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 25 14:03:24 2012 +0100

    tests: Add a test of non-ASCII character fidelity on various filesystem types (RHBZ#823887).
    
    Thanks Laszlo Ersek.

commit 6445bc5952efd47fb1aa0880d9038040551d72ed
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 25 13:09:10 2012 +0100

    doc: Add documentation covering use of utf8 option when mounting vfat (RHBZ#823887).

commit 73071b3163774ff9a514a05bc8e6fb35fa910787
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 25 15:42:02 2012 +0100

    trace: Fix display of non-printing characters.
    
    Previously the code would drop the first character in any sequence of
    non-printing characters that occurred within a string.
    
    Fix for commit e6f18c59d577dd0b443bc6a1d76f699c4e0dde9f.

commit fba81add94cde015afe8a65245cb4e60a1d3e6bf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 25 15:08:27 2012 +0100

    trace: Fix escaping of non-printable signed characters.
    
    Fix for commit e6f18c59d577dd0b443bc6a1d76f699c4e0dde9f.

commit 3936412e33ec268f63b30b6ff5a38e7b8fe4f752
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Fri May 25 14:56:53 2012 +0800

    sysprep: remove the data and log files of puppet
    
    Remove the data(keys) and log files of puppet.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit f00066d22b11bf40d0272f68565a2a27fea15627
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 24 15:40:36 2012 +0100

    inspection: Don't fail if /etc/HOSTNAME or /etc/hostname are empty files (RHBZ#823821).
    
    Change guestfs___first_line_of_file so that if the file is empty this
    returns an empty string instead of an error.  This is consistent with
    the behaviour of this function in the case where the file starts with
    a \n character, where it would previously have returned an empty
    string.
    
    Change all callers so that they handle this case.
    
    Then change the hostname parsing code so that it doesn't give up when
    /etc/HOSTNAME is empty, but falls through to the next alternative, and
    similarly for /etc/hostname.
    
    Thanks Todd Mummert for finding and diagnosing this bug.

commit cffb7fefc88a317f957785f6448fb24183c8c629
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 24 15:38:46 2012 +0100

    inspection: Use parse_release_file to parse ttylinux release file.
    
    parse_release_file should be used to set fs->product_name, instead of
    calling guestfs___first_line_of_file directory, although currently the
    two are equivalent.
    
    This is code motion and fixes
    commit b648b1813fc8e55db790435b5414d9be3ec765d2.

commit ee9ab52bc3e087f63dcc51d3b6ac5c79277425e1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 24 14:50:20 2012 +0100

    fish/mount: Add better error message when -m (mount) fails (RHBZ#824043).

commit 216a6d16abdfbc36a5514df34f59507ef825e33e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 24 14:50:00 2012 +0100

    fish: Remove inaccurate comment from code.

commit d5d9ceee8b56a10761e207ad9970ebf704fc46e8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 24 14:40:52 2012 +0100

    virt-make-fs: When writing vfat, add utf8 option to mount (RHBZ#823885).

commit 975a41db20eff2b5edf510f8a65005c915b21f27
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 24 12:30:50 2012 +0100

    virt-make-fs: Provide a clearer error message when mkfs fails (RHBZ#823883).

commit f904fa822316ff793e71d4d4ff7dc79e608dcb25
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 24 08:48:51 2012 +0100

    appliance: Include 'bzip2' in appliance (RHBZ#824716).
    
    Missing package caused this error in compress-device-out:
    
    libguestfs: error: compress_device_out: compression type bzip2 is not supported
    
    Thanks Mohua Li.

commit b8b5ed65c26dd19a0bc9f8282a50c6dff90c456a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 23 11:46:23 2012 +0100

    FAQ: Add section about using libguestfs in closed source programs.

commit 144d7cd98811472a5541d2c53c487e670657051b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 23 11:19:34 2012 +0100

    FAQ: Add a note about "child process died unexpectedly".
    
    This is a common search term on the main website, and there is no good
    information provided by Google at present.

commit c7d3aa9cd6c065158d43b3c7fe553e814c642d6b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 23 11:08:52 2012 +0100

    FAQ: Update Ubuntu instructions.

commit 0e05e9f6ce696cf2a5172eda3fe054367164106b
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Tue May 22 22:22:20 2012 +0800

    TODO: sysprep todo list clearance
    
    Remove the implemented features from TODO list.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 54028b9b669cfe495089a7652bb8cd06115f4907
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 22 14:53:57 2012 +0100

    java: Remove unnecessary imports from the generated Java code.

commit 87d604f88c44f891a338349e2b012b6deadf7896
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 22 13:50:19 2012 +0100

    debug: Add setenv debugging command.

commit f774f8fd8d107e6d820ce414f9765745ea75dad7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 21 16:27:04 2012 +0100

    Version 1.19.0.

commit 1f3b8b395b5a58b71736841d4ed3cd2c6235639e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 21 16:18:24 2012 +0100

    New stable branch: Version 1.18.0.

commit 91f3456244e7843768da659e24ce0aeeb4ebe4b0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 21 15:24:32 2012 +0100

    build: Temporarily disable generation of 'BUGS' file.
    
    Red Hat Bugzilla is broken: RHBZ#823510.

commit d51631034a84acb7ff68f5d5890e8092b18daffc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 21 14:35:07 2012 +0100

    Update API support.

commit 695b3c9633e3e96a558f80be2d73231bb53dcb0b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 21 14:34:46 2012 +0100

    Update PO files from Transifex.

commit 27b9c1c755724aa0ff5b36f90d8a8a70944b1dbb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 21 14:18:43 2012 +0100

    Update road map for 1.18 branch.

commit d1f6325e1069cdb5705dbdae5f82a765e570679e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 21 13:45:58 2012 +0100

    Update release notes for 1.18 branch.

commit a119e057d177fc3e89206c433efd8463df1a9826
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 18 11:14:34 2012 +0100

    sysprep: Credit Wanlong Gao, Fujitsu under 'AUTHORS' section.

commit f5e0c0e3eec1e85e62167540529664c965d2563e
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Fri May 18 17:20:04 2012 +0800

    sysprep: remove kerberos data in the guest
    
    Remove the generated kerberos data in the guest.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit b6d4c2921287b0e9aa8015d4d79de8d319972791
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Fri May 18 10:49:56 2012 +0800

    sysprep: remove ca certificates in the guest
    
    Remove the ca certificates.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 020e7aa505f6673c1a379ae00dd6d64eea472771
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 17 19:52:03 2012 +0100

    Version 1.17.43.

commit 88a854cf7fd80ce4a6c6c3ded3aaaa3c135a1964
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 17 17:19:09 2012 +0100

    virt-ls: Don't initialize path = NULL.

commit 32765e440cee03bb7b89d1aa58c7dea4f55458c8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 17 17:11:16 2012 +0100

    virt-ls: Fix --checksum option (RHBZ#822490).

commit b9331a2d73f2ce2e424329d35139e68f0fbe8c7a
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Tue May 15 22:29:19 2012 +0800

    NEW API: add new api btrfs-fsck
    
    Add the new API btrfs-fsck to check the btrfs filesystem.
    Btrfs is currently under heavy development, and not suitable for
    any uses other than benchmarking and review. But it'll be useful
    in the near future.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit a84d02e8d8fbb7d31cd124cd0eefe56cddeb3045
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Tue May 15 22:29:20 2012 +0800

    btrfs: change the return value of btrfs-set-seeding
    
    Change the return value from "r" to "0".
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit e9f6ce249230f6c03a96f721b5cab1768dfe839c
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Tue May 15 16:02:08 2012 +0800

    gobject: remove old generated files further
    
    also remove guestfs-gobject.c
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 7fffaf204ef59d6a068baa6b6b94a32eb6172846
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 15 08:38:46 2012 +0100

    gobject: Remove old generated files.

commit 2040a15ac7e54fd27d303f0f710d28b983f1f568
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 14 23:03:54 2012 +0100

    sysprep: Add missing 'utils.mli' to SOURCES.
    
    Consequently this file was also missing from the tarball.

commit 2fd2c85f6a42575749b9d38bd2f1512ae25db760
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 14 17:47:57 2012 +0100

    doc: Add notes on how GPT works on 4k sector disks.
    
    I used scsi_debug to create a 4k sector virtual disk:
    
      modprobe scsi_debug dev_size_mb=128 sector_size=4096
    
    I then used 'gdisk' to create lots of partitions, and used 'hexdump'
    to examine what was written to disk.

commit e8ec521dc64208016b0dc8dcb873324819ed734d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 14 15:32:08 2012 +0100

    todo: Notes about partitioning tools.

commit 18451abdf5b3618750af11da6579db547b266b8d
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Mon May 14 18:38:25 2012 +0800

    New API: add new api btrfs-set-seeding to enable or disable seeding.
    
    Add the new API btrfs-set-seeding to support the seeding-device
    feature for btrfs.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit a75020a06674a4ec77712c1d8000b51eac53f454
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Mon May 14 18:38:24 2012 +0800

    TODO: add note for libblkid
    
    Add the note about compatible in TODO for libblkid.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit b42dcb05dcfe737f631fd60750187d5d7db8ac69
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 14 12:01:24 2012 +0100

    examples: Further fixes to mount-local example program.
    
    * Set PS1 prompt properly for bash shells.
    * Touch a file into the root directory of the new filesystem.
    
    This fixes commit 46b6766156ace142443b36e20e55074c544ae6cc.

commit 2c50a5da4682b713d76c25cb4f2ef1591556367a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 14 10:49:09 2012 +0100

    example: Various fixes to mount-local example program.
    
    * Move MOUNT_OPTIONS to #define at top.
    * Move SIZE_MB to #define at top.
    * Set PS1 in subshell (doesn't work - why?).
    * Hide libguestfs errors from guestfs_mount_local_run.
    
    This fixes commit 46b6766156ace142443b36e20e55074c544ae6cc.

commit a219fede920dce9157f23ed8dec0f3aa18c6df44
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 14 08:22:03 2012 +0100

    debian: examples: Don't break when O_CLOEXEC is not defined.
    
    This affected Debian 6.
    
    This fixes commit 46b6766156ace142443b36e20e55074c544ae6cc.

commit 9cf19466f0b296cb20136c3c38eaf601612fd22b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun May 13 23:18:44 2012 +0100

    Version 1.17.42.

commit 034733e981024f0686dc00a3eb286ac12f256d96
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun May 13 23:01:15 2012 +0100

    examples: Add mount options "acl,user_xattr" to mount-local example.
    
    This fixes commit 46b6766156ace142443b36e20e55074c544ae6cc.

commit 46b6766156ace142443b36e20e55074c544ae6cc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun May 13 22:53:01 2012 +0100

    examples: Add an example of using the mount-local API from C.

commit 7201a48d18d03bf3b16141bcff8c56e842d3b1c1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun May 13 22:20:32 2012 +0100

    examples: Add if HAVE_HIVEX ... endif around virt_dhcp_address example.

commit 157f6fb18b7197f688ea761a4e52cd39287024f2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 12 17:22:36 2012 +0100

    qemu: Move -nodefaults etc logically together.
    
    This is just code motion.

commit eb29a9424ccaa56cc6b2b667a2fdb6a75d6d59af
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 12 14:18:05 2012 +0100

    arm: Add configure flag '--with-qemu-options'.
    
    This flag allows extra QEMU options to be passed on the command line.
    
    This is useful mainly on arm (see the notes in the updated README
    file).

commit 30ecbf3ec2ada68f7e125a180553e31b069033b7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 11 21:32:39 2012 +0100

    arm: Disable -machine, -enable-kvm options except on x86, x86-64.
    
    Presently KVM is only applicable to x86 and x86-64 (although that will
    change in future, and there are rumoured to be implementations for
    some current non-x86 architectures).  In any case having these options
    breaks ARM, so disable them for non-x86 architectures at the moment.

commit 10725acf9666c067df569fbcae86b48d8381ac81
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 11 21:33:50 2012 +0100

    arm: On Linux ARM kernels, the serial console is ttyAMA0.
    
    Cope with unnecessary lack of standardization.

commit 5c5979084536b8d03cd7cc37dd5a8a7a0b01fe56
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 27 11:05:08 2012 -0400

    arm: Disable test for -no-hpet during launch.

commit a3718c6b8be9bcbfd1e753c699f030d1852bc26e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 11 22:39:45 2012 +0100

    arm: Set minimum LIBGUESTFS_MEMSIZE at 128.
    
    For ARM Versatile ("versatilepb") architecture, memsize must be set to
    256 (megabytes) else the appliance is unable to boot.  Previously
    setting LIBGUESTFS_MEMSIZE=256 was not allowed.
    
    Versatile Express has larger limits.

commit 77afc92fcd08677f9a9ae3b4f6c6919eb8ec2b33
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 12 13:40:45 2012 +0100

    configure: Fix valgrind --vgdb test.

commit 0e960614ab0f7d878347d74229ffbb69a4a05540
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 12 13:14:42 2012 +0100

    configure: Add a comment about vmchannel_test.

commit e275786cb2bce728b1a5c8c705cdf76a904be386
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 11 14:20:23 2012 +0100

    Version 1.17.41.

commit a50db3be6072d70a14ea9a586f3f1c62ba20ecdb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 11 13:49:21 2012 +0100

    doc: Add a note about compiling under clang.

commit a1680f03b7d38bf007d29ac23035e5af33736b0e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 11 13:47:29 2012 +0100

    configure: Allow systemtap/DTrace userspace probes to be disabled.
    
    './configure --disable-probes' will disable these probes.  Otherwise
    they are autodetected as before.
    
    The <sys/sdt.h> produces lots of errors when you try to compile with
    these probes enabled under clang, so it is necessary to provide a way
    to disable them for clang users.

commit 042a0b063b22bd02bb72f4a78cf29ffe5553d4d8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 10 22:58:50 2012 +0100

    FAQ: Fix typo in download (thanks badnews@IRC)

commit 1581dbe79f79b44bc10dfe3d0724c8911d6f0778
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Thu May 10 23:18:22 2012 +0800

    sysprep: remove blkid tab in the guest
    
    Remove blkid tab cache in the guest.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 56475678264d90028c508daa488fafeed98b3042
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 9 16:29:39 2012 +0100

    configure: Replace 'echo -n' with 'AS_ECHO_N' macro (thanks Eric Blake).

commit 7b72c124288f7420dea4f5b4eb832f466ba46a47
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 9 16:11:08 2012 +0100

    Update to latest gnulib.

commit 5764ac12cfdecd1f807fb87ae7a2a9783907b42b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 9 16:12:55 2012 +0100

    bootstrap: Remove autopoint, po stuff from bootstrap script.
    
    It's not needed since we no longer use gettextize cruft.

commit d0ec0b4c8c085427896759a1a6e369d2f747fc7b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 8 22:58:05 2012 +0100

    Version 1.17.40.

commit af1439bc9f5c4a536c55df9c07bd1aec023beace
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 8 17:32:49 2012 +0100

    Updated PO files from Transifex.

commit a79b22a613b591432d024d65c549fe8957837f6b
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Mon May 7 22:44:39 2012 +0800

    sysprep: remove pam data
    
    Remove the generated pam data in the guest.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit dd23234f730db7add330bd06f87cab1f08654747
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 5 14:55:03 2012 +0100

    test-tool: Implement -V / --version option.

commit 3ea36903f26d5a235ec5a20219173e4a16c8ca95
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 3 18:05:32 2012 +0100

    Update API support.

commit eaa05ff012ba3f9971cd95d2ea14e34dceb69ec0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 3 16:50:25 2012 +0100

    Version 1.17.39.

commit e0f36898cb62bb1982890a33c18cbd1277d5a186
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 3 15:38:08 2012 +0100

    virt-df: Don't fail immediately if a disk is not accessible (RHBZ#789504).

commit bd91bd76d188e4a7402dd5d3c904f8cc128823b1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 3 15:37:59 2012 +0100

    virt-alignment-scan: Don't fail immediately if a disk is not accessible (RHBZ#789504).

commit 9e2cdd309b709ee1e88269ee3252768515bf56ad
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 3 15:23:14 2012 +0100

    virt-alignment-scan, virt-df: Add newlines after error messages.

commit a2cc317c03aeb4963fce03d9d8be93cdf3c3a475
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 3 14:21:21 2012 +0100

    virt-make-fs: Add a test of btrfs (regression test for RHBZ#816098).

commit c53ea071c690b1760b89a56f2a634bec00d2b554
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 3 13:44:49 2012 +0100

    virt-make-fs: Simplify test code.
    
    This is just code motion.

commit 0cc35251421bc5c4d5a682566e2d71b942bbcc4a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 3 14:31:37 2012 +0100

    virt-make-fs: Fix estimation when making btrfs (RHBZ#816098).
    
    This also disables data and metadata duplication, which is not very
    useful on a constructed filesystem on a virtual disk.

commit 93734c78d8f802fbd80418e6ddb333b21f060fa9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 3 14:30:49 2012 +0100

    virt-make-fs: Use mount instead of mount_options.

commit e60556d92725289a26ccb406c9c94be32b3251c8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 3 14:30:09 2012 +0100

    virt-make-fs: Fix filesystem type check when estimating ntfs.

commit 00202b9c2941c2b4ff514c5ea32818807f42acf4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 3 12:15:27 2012 +0100

    tests: Regression test for RHBZ#701814.
    
    This commit adds a tests/xml directory, and an LD_PRELOAD module which
    can fake arbitrary libvirt XML from an external file (and is therefore
    a much more flexible test than using the libvirt test:// driver
    alone).
    
    Also added is one regression test for:
    https://bugzilla.redhat.com/show_bug.cgi?id=701814
    
    Loading the given libvirt XML using Sys::Guestfs::Lib::open_guest
    used to fail with the error:
    
      format parameter is empty or contains disallowed characters at /home/rjones/d/libguestfs/perl/blib/lib/Sys/Guestfs/Lib.pm line 256.
    
    Thanks to Tom Horsley for supplying the test data.

commit f072a21f3aef6779aaa77329578ae3677a685d85
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 3 12:25:54 2012 +0100

    perl: Don't fail if 'type' (disk format) attribute is missing in libvirt XML (RHBZ#701814).
    
    Old versions of libvirt allowed you to define disks like this:
    
        <disk type='file' device='disk'>
          <driver name='qemu'/>
          ...
    
    Since the <driver> element does not have a 'type' attribute (which
    defines the format), we are supposed to do autodetection, so the
    format should be undefined.
    
    However what actually happened was that the code in
    Sys::Guestfs::Lib::open_guest received format as an empty string from
    the xpath query, causing libguestfs to give an error.
    
    If the xpath query returns the format as an empty string, undefine it.

commit 66a525ce5a4e95fb8576ea183e06e1eb730a135d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 2 16:33:40 2012 +0100

    fish: Add a regression test for the 'glob' command.

commit 620ad8eb1a5df298c5701a7b438b12f9627f06ab
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 2 16:14:41 2012 +0100

    fish: glob command now expands /dev/ patterns (RHBZ#635971).
    
    For example:
    
    ><fs> glob echo /dev/*
    /dev/vda
    /dev/vda1
    /dev/vda2
    /dev/vda3
    ><fs> glob echo /dev/v*/*
    /dev/vg_f16x64/lv_root
    /dev/vg_f16x64/lv_swap

commit 79bf966ceaa3508698f19bdc951ffc51693eb499
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 2 15:34:02 2012 +0100

    fish: Move 'feature_available' function to global.
    
    This is just code motion.

commit 29c5e052e46af9b66af69429b2e8ee5dfc0fadbe
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 2 14:44:54 2012 +0100

    fish: Clean up glob code and make it return error if malloc fails.
    
    This commit tidies up the code for the 'glob' command.  It also makes
    the command return an error if malloc fails (previously it would just
    print a message but not return any error indication).

commit 1304236c6c666ac0ef2174299f0a0270f3dec347
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 2 13:55:18 2012 +0100

    fish: Add --pipe-error flag to allow detection of errors in pipe commands (RHBZ#803533).
    
    For a test case, see:
    https://bugzilla.redhat.com/show_bug.cgi?id=803533
    
    In guestfish, we use the gnulib closeout module which sets up an
    atexit handler to detect if there were any errors on stdout when the
    program exits.  This is so we can fail correctly in out of disk space
    cases like:
    
     guestfish [...] > output
    
    However the atexit handler just checks that there was any error on
    stdout (using ferror).  If a pipe command such as:
    
     ><fs> command_with_lots_of_output | head
    
    ran at any time during the session, the error flag would be set
    (because the underlying writes failed with EPIPE errors).
    
    So the commit first adds a test for ferror (stdout) after each command
    that we issue.  This brings error handling closer to the point of
    failure, and so is generally a good thing.
    
    Secondly we reset the error flag after detecting and dealing with the
    error, so that avoids the redundant 'guestfish: write error' message
    produced by gnulib closeout.
    
    Thirdly we add a --pipe-error flag which causes guestfish commands to
    fail on pipe commands line the one above.  The default is off for
    backwards compatibility reasons.

commit 95a67b1e6ad315af0ea7bedbb5348512635e4834
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 1 19:49:54 2012 +0100

    Update release notes.

commit 500cc67f29b43ebb970f6f276967ee5e9959b140
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 1 14:08:39 2012 +0100

    Version 1.17.38.

commit e6bfb55f65a8248e1d18ac4fd9eb345651a66529
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 1 13:27:45 2012 +0100

    Turn libguestfs FAQ into a man page: guestfs-faq(1).

commit 922052c70fdc66859c78bbc89a7817aad141862a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 1 11:18:57 2012 +0100

    doc: Rewrite description section in man page guestfs(3).
    
    Make the introduction in the man page shorter and punchier, so it
    leads readers directly to other pages of interest.

commit 51f43402f630d73cbfe25e60565878a05e230df5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 1 08:57:41 2012 +0100

    Version 1.17.37.

commit 027fefd517b8a93c54611a6cc4c51a54fea1b9fe
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 30 11:33:19 2012 +0100

    Add gettext support for OCaml tools (virt-resize, virt-sparsify, virt-sysprep).
    
    Note that this support is optional: To enable it, install the
    ocaml-gettext library from
    http://forge.ocamlcore.org/projects/ocaml-gettext .  If this library
    is not installed, then configure detects this and inserts dummy
    gettext functions that do nothing.

commit 75514ab57a06e534f26698fe1725ca29b966c3ad
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 30 16:04:51 2012 +0100

    Remove gettextize.
    
    Replace the sociopathic nonsense in gettextize with a simple
    Makefile.am which does the same ... and is faster.

commit 6aa95e87c1f259589ff9c7812707e4b30b8f6fd7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 30 16:23:05 2012 +0100

    Remove "convenience header" "gettext.h" and use <libintl.h> instead.
    
    gettextize provides a local file called "gettext.h".  Remove this and
    use <libintl.h> from glibc headers instead.
    
    Most of this change is mechanical: #include <libintl.h> in every C
    file which uses any gettext function.  But also we remove the
    gettext.h file, and adjust the "_" macros.
    
    Note that this effectively removes the ./configure --disable-nls
    option, although we don't know if that ever worked.

commit ea74856d953aec39af6ee556221618fda644312f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 30 10:18:37 2012 +0100

    configure: There are now more OCaml tools than just virt-resize.
    
    virt-resize, virt-sparsify, virt-sysprep are all OCaml tools, so
    change what is printed in the report.

commit 79822d46e3d7785ae7b02272e6661f15a61f4b5e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 30 10:12:33 2012 +0100

    configure: Comment fix.

commit bb73cf0941ba9d34eb2ecf82d10ecb5fc5d2362d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 30 15:03:24 2012 +0100

    Move 'libguestfs.pc' (pkgconfig file) to src/ directory.
    
    Since it describes the C library, it's better in the src/ directory.

commit a23e84ee0283ef538f21d201d72176f83f4da4ae
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 30 09:42:36 2012 +0100

    todo: virt-sparsify whitelist option.

commit cc798540370658ecc1bba94c4ab4b64485c9bcc6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 27 15:35:50 2012 +0100

    debug: 'progress' (unsupported debug command) now checks argument is reasonable (RHBZ#816839).
    
    Thanks Yuyu Zhou.

commit d448ae0c2bff2079212734835899e17cac468620
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 27 09:10:43 2012 +0100

    gobject: Fix installation of headers.
    
    RPM build errors:
    error: Installed (but unpackaged) file(s) found:
       /usr/include/optargs-add_domain.h
       /usr/include/optargs-add_drive_opts.h
       /usr/include/optargs-btrfs_filesystem_resize.h
       /usr/include/optargs-compress_device_out.h
       /usr/include/optargs-compress_out.h
       /usr/include/optargs-copy_device_to_device.h
       /usr/include/optargs-copy_device_to_file.h
       /usr/include/optargs-copy_file_to_device.h
       /usr/include/optargs-copy_file_to_file.h
       /usr/include/optargs-e2fsck.h
       /usr/include/optargs-inspect_get_icon.h
       /usr/include/optargs-md_create.h
       /usr/include/optargs-mkfs_btrfs.h
       /usr/include/optargs-mkfs_opts.h
       /usr/include/optargs-mount_9p.h
       /usr/include/optargs-mount_local.h
       /usr/include/optargs-ntfsclone_out.h
       /usr/include/optargs-ntfsfix.h
       /usr/include/optargs-ntfsresize_opts.h
       /usr/include/optargs-set_e2attrs.h
       /usr/include/optargs-test0.h
       /usr/include/optargs-tune2fs.h
       /usr/include/optargs-umount_local.h
       /usr/include/session.h
       /usr/include/struct-application.h
       /usr/include/struct-btrfssubvolume.h
       /usr/include/struct-dirent.h
       /usr/include/struct-inotify_event.h
       /usr/include/struct-int_bool.h
       /usr/include/struct-isoinfo.h
       /usr/include/struct-lvm_lv.h
       /usr/include/struct-lvm_pv.h
       /usr/include/struct-lvm_vg.h
       /usr/include/struct-mdstat.h
       /usr/include/struct-partition.h
       /usr/include/struct-stat.h
       /usr/include/struct-statvfs.h
       /usr/include/struct-version.h
       /usr/include/struct-xattr.h
       /usr/include/tristate.h
    
    We want to put these headers into the subdirectory, but not
    guestfs-gobject.h.  This isn't easy with automake.

commit 1f0964536b7c9a4a165e9b041ef0e5340ead7e1f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 27 09:10:29 2012 +0100

    gobject: Fix whitespace in Makefile.am.

commit 23f8cab1e85fd77b053cc880d31687261c81e357
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Fri Apr 27 14:18:53 2012 +0800

    sysprep: Remove the data of dovecot
    
    Remove the data of dovecot.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit ac75e46c5a4d7c2e6330efd34f4c5a2a0bc71fe5
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Fri Apr 27 14:18:52 2012 +0800

    sysprep: remove the logfiles configured by logrotate
    
    Remove the logfiles configured by /etc/logrotate.d/*.
    Omit the logfile of "samba" and "sssd" which we removed
    them separately .
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit e493884a7600e4c71f31bb4041cca13a44c56236
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 26 18:03:58 2012 +0100

    Version 1.17.36.

commit 819cba54e6a19104de39ad1b153e5116d7028bca
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 26 17:55:54 2012 +0100

    btrfs: Fix btrfs test so it works with btrfs-progs in Rawhide.
    
    See: http://bugzilla.redhat.com/816346

commit a505423e589b4820745e855c49dded60afc04f6a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 26 15:33:12 2012 +0100

    lib: Remove the BUSY state.
    
    Originally this state was intended so that in some way you could find
    out if the appliance was running a command.  However there was never a
    thread-safe way to access the state of the handle, so in effect you
    could never do anything useful safely with this information.
    
    This commit completely removes the BUSY state.
    
    The only visible change is to the guestfs_is_busy API.  Previously you
    could never call this safely from another thread.  If you called it
    from the same thread it would always return false (since the current
    thread can't be running a libguestfs command at that point by
    definition).  Now it always returns false.

commit eafefab93756b980bdb892df86e1ac3e5b88a260
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 26 15:52:23 2012 +0100

    gobject: Use generator_built macro to ensure generated files are rebuilt properly.

commit d58cb029a3a2acd2f4d40a58ea845911cfd003ed
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Apr 26 13:30:31 2012 +0100

    gobject: Move headers into a subdirectory
    
    The gobject bindings generate a large number of header files, which pollute
    /usr/include when installed. This patch moves them all into a guestfs-gobject/
    subdirectory. guestfs-gobject.h remains in the same place.
    
    This change also moves generated source files into src/, because it makes the
    gobject directory a bit tidier.

commit 317ba894b3fb62156654cb50b8dc4ab36970f14e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 26 13:55:30 2012 +0100

    btrfs: Fix docs for btrfs_subvolume_set_default (thanks Matt Booth).
    
    This fixes commit 87ea7a04094d5ed40f3f047ff2b7a613d4d530d4.

commit 8fb67ee66acbdcff805984715567a92a30428aec
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Apr 12 09:29:45 2012 +0100

    gobject: Implement libguestfs events as signals
    
    Implement libguestfs events as GObject signals. Callback arguments are passed in
    a boxed object.
    
    Note that this patch fixes the length of the uint64_t array in the callback
    arguments at 16, whereas it is actually arbitrary length. This is to make it
    introspectable. There is currently no way to pass an arbitrary length array to a
    callback, and have its type introspected.

commit 6c88c3758b60f4c4ec9ec7fcaf89074949dd88a4
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Apr 4 16:49:17 2012 +0100

    gobject: Wrap literal sections in POD in CDATA sections

commit a2dc83cf03c3a040e12a3ac33ab6bc99e0faf5c4
Author: Matthew Booth <mbooth@redhat.com>
Date:   Tue Apr 3 16:28:47 2012 +0100

    gobject: NFC generated code formatting fix

commit 8cb30dc80550da06871b0becc3582b2cdc4948ae
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 26 12:56:34 2012 +0100

    rescue: Add --scratch option.
    
    This lets you create temporary scratch disks.

commit 39d79e677b684dfd49c852ee7ce4c4bf3d5cf56f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 26 12:56:01 2012 +0100

    fish: Add opaque field to the drives list for programs to use.
    
    Not used at present.

commit 2cc4314ecc4ab4f66446cb4ebd65d4f53da75acd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 25 23:08:24 2012 +0100

    Version 1.17.35.

commit beaa5288558fc78304bcd008b9254ae2725017f2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 25 22:58:25 2012 +0100

    appliance: Remove some unnecessary errors.
    
    virt-rescue prints errors such as:
    
      rm: cannot remove `/proc': Is a directory
      mkdir: cannot create directory `/proc': File exists
      rm: cannot remove `/sys': Is a directory
      mkdir: cannot create directory `/sys': File exists
    
    People have reported these errors (which are nothing to worry about)
    as bugs in the past, so avoid them where possible.

commit 2d414112f7439d3f5b1b56b2392ab080c961f90c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 25 19:42:01 2012 +0100

    btrfs: Enhance the btrfs device test.
    
    This enhances commit 87ea7a04094d5ed40f3f047ff2b7a613d4d530d4.

commit 12c5394d4cb379890c9c69c16d1d735674a2e80d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 25 19:26:57 2012 +0100

    tests: Add some more substantial test data.
    
    The two tarballs:
    
      8252 bytes   tests/data/filesanddirs-10M.tar.xz
     41152 bytes   tests/data/filesanddirs-100M.tar.xz
    
    contain, as their names suggest, highly compressed files and
    directories, with unpacked size respectively around 10M and 100M (the
    precise size after unpacking depends on the filesystem).
    
    These can be used for testing purposes.

commit e188eb8268cfba652cc65e09c848da88b6156fad
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 25 19:08:56 2012 +0100

    btrfs-device-delete: Use correct (sysroot-prefixed) path to filesystem.
    
    This fixes commit 87ea7a04094d5ed40f3f047ff2b7a613d4d530d4.

commit 87ea7a04094d5ed40f3f047ff2b7a613d4d530d4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 25 16:35:12 2012 +0100

    New btrfs APIs.
    
    Bind the easy parts of the 'btrfs' program.
    
    The new APIs are:
    
    btrfs-device-add: add devices to a btrfs filesystem
    btrfs-device-delete: remove devices from a btrfs filesystem
    btrfs-filesystem-sync: sync a btrfs filesystem
    btrfs-filesystem-balance: balance a btrfs filesystem
    btrfs-subvolume-create: create a btrfs snapshot
    btrfs-subvolume-delete: delete a btrfs snapshot
    btrfs-subvolume-list: list btrfs snapshots and subvolumes
    btrfs-subvolume-set-default: set default btrfs subvolume
    btrfs-subvolume-snapshot: create a writable btrfs snapshot

commit 3cc9703f901e85a589692b9d0bf5ef7cbf72ed73
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 25 16:33:31 2012 +0100

    btrfs: Modify mkfs-btrfs API so it takes a list of devices.
    
    btrfs filesystems can span multiple filesystems.
    
    Note this changes the API, but this API has not yet been released in a
    stable version of libguestfs.

commit bd1a699c15f8854f366abacb47152212e20675ea
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Wed Apr 25 10:29:52 2012 +0800

    TODO: remove sssd and samba in sysprep
    
    remove the TODO of sssd and samba in sysprep.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 046d6c20e76ac4201af574020330ceb9314531b8
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Wed Apr 25 10:25:11 2012 +0800

    sysprep: fix typo of the object
    
    Fix the typo of the OBJECT.
    I'm sorry for the copy and paste typo.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 303b159134de44f7b43ba90ccfc7be0fead8adfa
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Wed Apr 25 10:25:10 2012 +0800

    sysprep: remove the db and log of samba
    
    Remove the db and log of samba.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 580ae3297a04a1f531eeb5c42e060260626d410f
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Wed Apr 25 10:25:09 2012 +0800

    sysprep: remove the db and log of sssd
    
    Remove the db and log of sssd.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit a98d9f4840e0bad4d68875a772edd74db9285b1b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 24 19:36:33 2012 +0100

    todo: Suggest 'virt-customize' tool.

commit 0e49186814cb516c5f10fdb6606e64aaeacbef3f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 24 19:26:09 2012 +0100

    todo: Debian APT cache is now removed (thanks Wanlong Gao).
    
    This updates commit 7fc7c3aa5b8088abc52b5cc39b682cdaedd1ba84.

commit 5fab4db8def54112f3058307cb96769b794e0feb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 24 19:24:10 2012 +0100

    bugs: Update BUGS file.

commit d16868b9381ea696f7ed5d22b7d0c1a3bb56f0b3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 24 19:24:00 2012 +0100

    bugs: Print count of bugs in each section.

commit 37a3cdbc139167d7b77d84a761f681595ff7fc23
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 24 17:38:45 2012 +0100

    generator: Add explicit types to pod memoization code.
    
    This is just code motion.

commit a2d30626cb80a6546a2904d9a82a9b205f8f1270
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 24 17:17:59 2012 +0100

    Version 1.17.34.

commit 7fc7c3aa5b8088abc52b5cc39b682cdaedd1ba84
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Tue Apr 24 15:23:48 2012 +0800

    sysprep: remove the cache of package manager
    
    Remove the cache of package manager like yum and apt.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>
    
    RWMJ:
    - Small code cleanup.

commit 95515c45762471c4f807ce442e1be85aac0da511
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Mon Apr 23 16:41:51 2012 +0800

    sysprep: flag the system for reconfiguration
    
    Flag the system for reconfiguration by touching /.unconfigured .
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>
    
    RWMJ:
    - Updated so this is disabled by default, since it requires
      user intervention at next boot.

commit 148b51fe0ba8311336e649d089e8da83d5fb8b8c
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Mon Apr 23 08:58:44 2012 +0800

    sysprep: remove user accounts
    
    Remove user accounts from /etc/passwd, /etc/group,
    /etc/shadow, and the home directory of the user,
    except the root user.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>
    
    RWMJ:
    - Updated to use Augeas to delete accounts.
    - Disable this by default, since it is very invasive.

commit 7916f5d43c021ced2f13d2bf707dbc7702ee8f2b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Apr 22 23:22:56 2012 +0100

    Version 1.17.33.

commit 8d41470b6fc81b742896996393812b274514bca2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 21 22:27:39 2012 +0100

    sysprep: Don't enable every option by default.
    
    All current operations are enabled by default.
    
    Also:
    
    * The POD description is split into a heading and the description body.
    
    * An 'enabled_by_default' flag is added to the structure.

commit 97ef9afca77ee81a6c0d1a30cf4d367d7cefa2e3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 21 21:43:32 2012 +0100

    build: Change comment above OCaml tools.

commit 03d321d0225512bdcd136ac7cb086c0b292a9c09
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 21 15:37:43 2012 +0100

    guests: Add /etc/shadow file to fedora.img.
    
    This is used for testing file permissions and SELinux contexts.

commit c844a38d6e6990af00506afb434a6f7b40e5259f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 21 14:39:21 2012 +0100

    tests: Space before parens in perl code.

commit 2152affd3008703974d0d5c65515f5695dafb9ca
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 19 22:46:07 2012 +0100

    Update release notes.

commit 36f1eb922530b254631781bd6475ff6348f511af
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 19 10:50:44 2012 +0100

    configure: Test for tgetent, tputs and 'UP' symbols (from libtinfo).

commit e97b6a1bb15e8cad319dceff53c58f8267e8152f
Author: Jim Meyering <jim@meyering.net>
Date:   Wed Apr 18 11:18:19 2012 +0200

    maint: fix doc typos
    
    Fix typos spotted by http://github.com/lyda/misspell-check.
    * configure.ac: As above.
    * ocaml/examples/guestfs-ocaml.pod: Likewise.
    * fish/guestfish.pod: Likewise.

commit c253c69d0955242e5f23dc194ddbaf34764f79f7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 18 17:29:13 2012 +0100

    Remove obsolete valgrind rule from C API tests.

commit 58a5b5bd944655b028c915a91dad2220176986db
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 18 17:28:47 2012 +0100

    extra-tests: Check if valgrind supports --vgdb=no option.
    
    This option didn't exist in RHEL 6 valgrind.

commit 5d6a323b9358bb01233681b784fa67414a5d2c6d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 18 14:23:57 2012 +0100

    Check library still compiles without libvirt.

commit b0b5fdc69f6ee831f325760f95a164627b499f77
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 18 10:50:32 2012 +0100

    sparsify: Add a note about sparsify on tmpfs.

commit 4542401fee7a141204baea98dcdc9fa557878f85
Author: Matthew Booth <mbooth@redhat.com>
Date:   Tue Apr 17 10:17:58 2012 +0100

    Don't abort inspection if mdadm.conf ARRAY doesn't have a uuid

commit 158479ffc02837230fbff9377242500febf0d472
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 17 18:33:23 2012 +0100

    Version 1.17.32.

commit 255882a3f615c7727d2cc2f18f692513dc0a75e9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 17 17:41:43 2012 +0100

    python: Remove 'del g' from the docs, replace with 'g.close ()'.
    
    'del g' is a trap for the unwary.  If the handle has any other
    references, it does nothing (in fact, it can be actively dangerous if
    the user was expecting the appliance to go away).  In non-CPython it
    can be delayed arbitrarily long.
    
    Using 'g.close()' on the other hand is always safe.

commit 7995c513baf9929a1c5cefc30498a93b45eafd52
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 17 17:41:33 2012 +0100

    todo: Note about -cpu host.

commit 6065f21b109def2f083b5915bd119babffa8fa7a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 17 16:24:27 2012 +0100

    virt-alignment-scan: Fix error code.
    
    This fixes commit fb401ebff837f9df7c06acb8467b2c03d5b8ced0.

commit 84d450210b3ea01de3fe26b2cf1db2b492d77aec
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 17 15:03:02 2012 +0100

    resize, sparsify: Add a simple-minded check to stop indisk = outdisk.

commit 8d3d5a52d2746af91f770608cce5f47462f33aba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 17 14:54:48 2012 +0100

    sparsify: Fix comma/colon and quoting in qemu-img command.
    
    Colon characters are not allowed in qemu/qemu-img filenames.  There's
    no way to quote them.
    
    Comma characters CAN be used.  However they must be quoted (by
    doubling) when used in the '-o' option.
    
    Fix general quoting problems in the external command.

commit fb401ebff837f9df7c06acb8467b2c03d5b8ced0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 17 10:38:07 2012 +0100

    virt-alignment-scan: Add ability to list all domains.
    
    The output looks like this:
    
     F16x64:/dev/sda1      1048576         1024K   ok
     F16x64:/dev/sda2      2097152         2048K   ok
     F16x64:/dev/sda3    526385152         2048K   ok
    
    If the --uuid option is used, then UUIDs are shown instead of names.

commit 5ec0fba56e76409b234b0e0daa8a0edf06104812
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 16 15:53:34 2012 +0100

    gitignore: Move cscope.out to second section.
    
    This fixes commit 3c843e2129d7ce2d6b9bbc6c294cacf7385aa5e3.

commit 3c843e2129d7ce2d6b9bbc6c294cacf7385aa5e3
Author: Matthew Booth <mbooth@redhat.com>
Date:   Mon Apr 16 15:48:16 2012 +0100

    .gitignore: cscope.out isn't always at the top-level

commit 63cb25236b1d9b81f3732eddb5040e475a1e952a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 16 13:30:07 2012 +0100

    fuse: Improve reporting in mount-local when verbose is enabled.

commit 6c2b8340c355d0db7b3282833c84e5ea58bfb643
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Apr 15 21:53:43 2012 +0100

    Version 1.17.31.

commit 8104b2dfab32aea972ecfc4e89bf350b092e1952
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 13 13:13:50 2012 +0100

    New APIs for reading and writing ext2 file attributes and file generation.
    
    The new APIs are:
    
      get-e2attrs: List ext2 file attributes of a file.
      set-e2attrs: Set or clear ext2 file attributes of a file.
      get-e2generation: Get ext2 file generation of a file.
      set-e2generation: Set ext2 file generation of a file.
    
    These are implemented using the lsattr and chattr programs from
    e2fsprogs.

commit 9ccde76f611bf4658180717a41544350b5b4632a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 13 12:41:04 2012 +0100

    todo: Remove obsolete sections from the TODO file.

commit 2a5a5e15e2a6f95ec9ea8a3085db68d520296942
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 13 09:35:08 2012 +0100

    sysprep: Make the tests run quietly.

commit 1f373aa24667fef62378d58ac546ddd2adaf37e9
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Fri Apr 13 15:36:28 2012 +0800

    sysprep: bash_history: fix copyright
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit ecdfd2c8cccbf8aa27b5a90d66437132ebb501b7
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Fri Apr 13 15:36:27 2012 +0800

    sysprep: remove .ssh directory in users' directory
    
    Remove the .ssh directory of user "root" and any other
    users who have a .ssh directory in their home directory.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit b288f21e0c1f7f99d80b72e89a846b9f3b900af9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 13 08:43:37 2012 +0100

    Version 1.17.30.

commit 4b0e525d1dcabe5ffc9b323103ee757be397abb0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 13 08:31:01 2012 +0100

    tests: Fix reference to guestfish in test for RHBZ#811649.
    
    This fixes commit a9bd90abfb3d4519278dfff305b8b7033ae6d76a.

commit e14f545f810a9667a6e50f5667ed709766e6d6e4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 12 21:35:14 2012 +0100

    Version 1.17.29.

commit a9bd90abfb3d4519278dfff305b8b7033ae6d76a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 12 16:49:58 2012 +0100

    Add regression test to test funny filenames (RHBZ#811649).

commit d2183a62aadff11609b561d3f821ec7d6094aa39
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 12 17:07:49 2012 +0100

    lib: Escape , as ,, on qemu command line (RHBZ#811649).

commit 4be630edb31f654068509d470e8b44039580954d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 12 16:57:30 2012 +0100

    lib: Remove check_path function, limitation is colon, not comma (RHBZ#811649).
    
    Remove the bogus check_path function and move the functionality into
    the two places where it was being used.
    
      qemu -cdrom ,
    
    works fine, I tested it.
    
    Colon cannot be used in a block device filename anywhere, since the
    qemu block driver interprets it as a prefix.  There is no known way to
    work around this problem.  I checked this is true with kwolf.
    
    Comma is fine in -drive options, provided it is escaped by doubling it.

commit 4dba0e1e9d7fca190e7877856ce69618d99e85c9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 12 16:52:50 2012 +0100

    Revert "launch: don't add a drive twice"
    
    This reverts commit be47b66c3033105a2b880dbc10bfc2b163b7eafe.

commit a97e9429ea888b4732bbbcfdd85b9368dd6ef96c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 12 18:59:04 2012 +0100

    extra-tests: Add suppression for memory leak in FUSE.

commit 5b414f581f1e40f91e44914776b119ce3ef6594c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 12 18:43:59 2012 +0100

    extra-tests: ocaml: Use a short delay instead of Thread.yield.
    
    On the new faster computer, Thread.yield wasn't yielding, so the
    second thread would block the main test from proceeding (only when run
    under valgrind however).

commit 681377f1b274cba0a4881ad18ccf200b9a014e94
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 12 10:20:58 2012 +0100

    inspector: Update example XML.

commit 96b6504b09461aeb6850bb2e7b870a0a4c2f5edf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 12 10:15:35 2012 +0100

    inspection: Remove spurious warning for Ubuntu 10.04 with encrypted swap (RHBZ#811872).

commit a996f0d370d883374dbe2448f57b72966d20514e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 12 10:20:39 2012 +0100

    inspector: Fix incorrect arch in example-ubuntu.xml.

commit 6c276606d7cd124b2a0fcf50526bfa89142144d5
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Thu Apr 12 16:27:16 2012 +0800

    sysprep: remove the bash history of users
    
    Remove the bash history of users in home directory,
    and history of root.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit ed2a06708ce2527256581abc44ce2e0edaaa3147
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 12 08:22:53 2012 +0100

    website: typo: guestfs-performance.3 -> guestfs-performance.1

commit 292664c3ac496cc3a2473aa65f934c71305240e5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 11 23:00:39 2012 +0100

    Version 1.17.28.

commit 287d5a126e5337d8bedc7a60cf7dddd365f02d85
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Apr 8 16:53:00 2012 +0100

    New man page: guestfs-performance(1).
    
    This contains tips for engineering libguestfs for greatest performance.

commit 307e8bc51a7416fa62ec43568cb8ba1876490a62
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 11 22:02:19 2012 +0100

    docs: Add libguestfs-test-tool(1) and libguestfs-make-fixed-appliance(1) to guestfs(3) man page.
    
    Inexplicably these were not included before.

commit 3e164f15b77230b0961048893d03ec588fc8ab0e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 11 18:37:14 2012 +0100

    po-docs: Allow parallel builds in po-docs directory.
    
    The first time the directory is checked out from git, there are no
    *.pod files.  In a parallel build, the first thread notices this and
    runs the 'make -C .. update-po' rule, but the other threads also try
    to run at the same time and fail.

commit c1fb89e7fcaa806e913bf15ba2b4602583bd2f23
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 11 18:36:24 2012 +0100

    po-docs: No need to touch virt-sysprep.1 output file.

commit de2dc9f71dd284e033e999a4d0541848a7201b02
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 11 18:20:10 2012 +0100

    extra-tests: Add suppression for libvirt/gnutls leak.
    
    https://www.redhat.com/archives/libvir-list/2012-April/msg00322.html

commit b6dd7e72500cbfa4e13379b9f2b1d0ccfa7ebec3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 11 17:53:46 2012 +0100

    python: Add a regression test for RHBZ#811650.

commit 0f7de2279a4af0bb259c9e36fca5e5c3aa835301
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 11 17:43:47 2012 +0100

    launch: Set error when qemu fails early during launch (RHBZ#811650).
    
    This caused the Python bindings (and probably others) to
    segfault because guestfs_last_error(g) would return NULL.

commit f237ae2ad61ad583e5eacf5759b25c32bb7538a1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 11 17:24:55 2012 +0100

    python: Add PYTHONPATH to './run' script.
    
    Also:
    
     - tidy up the script
     - use the ./run script when running Python tests

commit 4ee518508fcc084f6d34c1c213b73a3abf13ddac
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 11 16:21:06 2012 +0100

    sysprep: Sort and align all arguments (thanks Wanlong Gao).

commit 16b2ffa97ea8b2872306bc4400605821440f6589
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 11 16:20:23 2012 +0100

    sysprep: Make a common Utils.compare_command_line_args function.
    
    This isn't quite code motion, since the new function also ignores case
    (which previously we didn't ignore).

commit a3d6629a0b54aca6d7b5b38750399b5396cdbf07
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 11 16:18:29 2012 +0100

    sysprep: Move skip_dashes function into Utils module.
    
    This is mostly code motion, but I also changed the function to use
    String.unsafe_get and raise Invalid_argument on failure.

commit edca57b49e88d179d996652a44f7d6ba5b9ca729
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 11 16:14:57 2012 +0100

    sysprep: Add utils.mli (interface) file.

commit b8fbbcf79147ee88c605726d74b2672b765e4d21
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 11 13:25:36 2012 +0100

    sysprep: Print some logging by default.
    
    It can be disabled using the --quiet option.
    
    The logging looks like:
    
    Examining the guest ...
    Performing "cron-spool" ...
    Performing "dhcp-client-state" ...
    Performing "dhcp-server-state" ...
    Performing "hostname" ...
    Performing "logfiles" ...
    Performing "mail-spool" ...
    Performing "net-hwaddr" ...
    Performing "random-seed" ...
    Performing "rhn-systemid" ...
    Performing "script" ...
    Performing "smolt-uuid" ...
    Performing "ssh-hostkeys" ...
    Performing "udev-persistent-net" ...
    Performing "utmp" ...
    Performing "yum-uuid" ...
    
    Reviewed-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit b10a3d718e4ff8957e8af4afafcd1680c386ad33
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 10 18:14:04 2012 +0100

    extra-tests: Disable valgrind vgdb.
    
    This leaves files called 'vgdb-pipe-*' in .

commit 7fe9905c4bcd29187ce865d16506d4bff0206cd0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 10 14:23:19 2012 +0100

    Version 1.17.27.

commit 5e054f873198b83947de328777d9ced3bfa39ad5
Author: Qin Guan <qguan@redhat.com>
Date:   Tue Apr 10 14:14:21 2012 +0100

    sysprep: Allow hwaddr to be removed on other Red Hat derivatives (RHBZ#811117).

commit 60b87d0a5c97a458cefb6c5d31eeede7709f5a3d
Author: Qin Guan <qguan@redhat.com>
Date:   Tue Apr 10 14:13:40 2012 +0100

    sysprep: Allow hostname to be set on other Red Hat derivatives (RHBZ#811112).

commit 8ae322e5a70e3d39ac9952f4bb15718f800e133a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 9 16:53:04 2012 +0100

    Use posix_fadvise when uploading or downloading files.
    
    But ignore it if the call fails, since the file descriptor could be a
    non-file (eg. /dev/stdout).

commit 669c0bd4075a1b61f61bf3a9dda7c80caca12f72
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 9 15:53:19 2012 +0100

    Fix libguestfs-make-fixed-appliance --help option so it displays usage.
    
    Previously it printed 'Internal error!'

commit 12a56dfc8a140d6cd016b0d783a94b50ccd81878
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 6 20:09:18 2012 +0100

    gobject: Remove guestfs-gobject.c from POTFILES.in.
    
    This file no longer exists after the sources were split across
    multiple files for the benefit of gtk-doc.

commit f2ac7c18a775dc10c3fa502f3de5ad01faa0efea
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 6 18:49:45 2012 +0100

    tests: Fix guest building so parallel 'make -jN check' works.
    
    This means renaming various temporary files (eg. fstab.tmp) that
    several of the scripts were using so they don't conflict
    (eg. fstab.tmp.$$).
    
    Also the rule:
    
      fedora-md1.img fedora-md2.img: guest-aux/make-fedora-img.pl
    
    causes the script to run twice in parallel when using 'make -jN'.
    Replace this with a stamp file so it runs once:
    
      fedora-md1.img fedora-md2.img: stamp-fedora-md.img
      stamp-fedora-md.img: guest-aux/make-fedora-img.pl

commit 418a048215b17dcf1f0c74693831306cbcf0f194
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 6 18:48:58 2012 +0100

    tests: Don't print "4" when running make-windows-img.sh
    
    The return value of the pwrite-device command -- 4 (bytes) -- is
    printed out.  Hide it instead.

commit d9f77f214bb8448139792c5a871dca2dfe9845db
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Apr 4 14:01:22 2012 +0100

    fuse: Add missing #include to guestmount.c
    
    Fix compilation failure on F17

commit 4b86f1ad03f617e60f68be6153ca75baaaedf754
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 4 12:46:40 2012 +0100

    debian: Suggest 'apt-get build-dep' to install dependencies.

commit ec162e7d587fae1a8137fa1b64ec3f45fc0d0e9c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 3 23:10:05 2012 +0100

    Update RELEASE-NOTES file for future 1.18 release.

commit 19494b19888bb63684aaa5b6b0c3e14773156f04
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 3 12:58:24 2012 +0100

    Version 1.17.26.

commit 465c97ebf4421cdf5aadfb6bcb623da8c2d99e8a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 3 10:52:27 2012 +0100

    parallel mount-local test: Don't run more than 12 threads.
    
    On the Koji builder that has lots of memory, this was trying to run
    something like 20 threads.

commit 999aac63eb9652e07a828d801feb691ce6d9d17b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 3 10:48:55 2012 +0100

    Use absolute paths where necessary in .gitignore file.

commit 5c8a241e5cd119f436a050ddbbf7ea73f83ff8e4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 3 10:24:23 2012 +0100

    inspection: Support Fedora 17+ (RHBZ#809361).
    
    Recognize grub2 as a bootloader, and /bin being a symlink to
    /usr/bin (ie. UsrMove feature added in Fedora 17+).

commit 04ddf3cfa2915c811b9a8b72fd3bd17484d26683
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 3 09:54:50 2012 +0100

    sysprep: Add GDM and session preferences to logfiles.

commit 25d156f262bc13ab90369b6703366f4132081d6e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 3 09:47:18 2012 +0100

    sysprep: Remove installation logfiles in /root.

commit a1d88b60e334f29b9e61f64a062e910ab63919d0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 3 09:43:12 2012 +0100

    sysprep: Include logfile glob list in the man page.

commit 817cebe3ad01867a6c8c1358330cdd26e25c6f34
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 2 19:09:52 2012 +0100

    Version 1.17.25.

commit 50009403b3c6663924bd029f8dde1deee8cc7abc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 2 10:12:38 2012 +0100

    New API: mkfs-btrfs for creating btrfs filesystems (RHBZ#807905).
    
    This allows all parameters from btrfs to be accessed.

commit 77ac6b73cde017452d48d53aaf6fa755502b05d5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 2 08:46:23 2012 +0100

    mkfs: Don't allow blocksize to be set on btrfs (RHBZ#807905).

commit f8a88def14f844e60f20d7887e249e32b57e7243
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Apr 1 21:55:09 2012 +0100

    extra-tests: Test virt-sysprep.

commit 95123a9144edc1ddb3ad67d75276ca3af70eddb8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Apr 1 20:02:25 2012 +0100

    sysprep: Add a test of the --script option.

commit 6282d92b1bc4fe57a92f939258d7ccee815fa6ab
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Apr 1 20:01:08 2012 +0100

    sysprep: Simplify and tidy up the test.

commit 9cb976ab5f9c37b90bfaeacbc1296647429b9bcd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Apr 1 20:00:36 2012 +0100

    sysprep: script: Documentation fix.

commit b1f997164ef6c34dbcdefdd7c7ee044255f83333
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Apr 1 20:00:28 2012 +0100

    sysprep: script: Miscellaneous fixes and cleanups to shell script.

commit de656448f7949d2b04e75455d5a2233d0c5856b9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Apr 1 20:00:06 2012 +0100

    sysprep: script: Wait for child process to exit.

commit 6c88ae851f80e766a94576fcea7c701994de05cc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Apr 1 19:59:32 2012 +0100

    sysprep: script: Remove useless check that script is executable.
    
    This check will fail if the script is on the path.  Also document
    that script must be on the path or else the full path to the script
    must be given.

commit 65e20e34dd7eecb234d75bfcb0c4b5aab7972583
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Apr 1 19:57:41 2012 +0100

    sysprep: Add some debug code when performing operations.

commit 64550dcad224cb48021f12de07d638181c6b295c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Apr 1 16:06:54 2012 +0100

    Version 1.17.24.

commit 94e94550ed0905d60173866e0ce1e41f9987c44c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Apr 1 13:17:32 2012 +0100

    sysprep: Add more files to CLEANFILES.

commit 7ed21d9a5c11d6bc8e9da3912cfcfc8a873ddef0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Apr 1 13:15:56 2012 +0100

    sysprep: When generating man pages, use 'run' script.

commit 3a58a00483df9ce02d8814981e4381a5f73c9a8b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Apr 1 09:28:24 2012 +0100

    Add po/remove-potcdate.sin to git and EXTRA_DIST.
    
    This file is produced by gettextize and required by 'make dist'.

commit 3b94cf504615bcbb0ff0cb4c01ba2b577f523733
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 31 23:15:04 2012 +0100

    Version 1.17.23.

commit 6e3de762782b050fe7ad675297089a42026f05c4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 31 23:17:05 2012 +0100

    Ensure that SOURCES are always in EXTRA_DIST, even if OCaml not available.

commit ad43dde9c87a6c3d58c626d2fa42dd68c2e15e01
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 31 21:41:10 2012 +0100

    sysprep: Implement 'script' operation for running general scripts against the guest.

commit 026f616650c41e42b7c3058a8637fe2d76bfb793
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 31 11:44:00 2012 +0100

    Rewrite virt-sysprep.

commit d00596dfbb386333c06744a20c514c0ccc8f2367
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 31 10:28:49 2012 +0100

    fish: Add a regression test for mount-local, mount-local-run commands.

commit e430ce89085dcda3ee9a6074629d38aebbccc53e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 30 18:42:02 2012 +0100

    Update translations from Transifex.

commit dd126109e58d5f5ff0bbfa67033d179dbef4218b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 30 18:27:26 2012 +0100

    Update API support.

commit ed96872bd2e43ac5bbf37023159688e67bf3346d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 29 20:31:54 2012 +0100

    Version 1.17.22.

commit b2cddfe2f5e7ed7ba45d83548ecbc8092bd8fc3a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 27 10:25:17 2012 +0100

    Add test of parallel mount-local calls.

commit c6f09fac0666260587f95bdfee3c20c9166dae94
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 14 08:44:41 2011 +0000

    New APIs: mount-local, mount-local-run, umount-local (FUSE support in the API).
    
    Add FUSE support directly to the API.  Instead of needing to use the
    external 'guestmount' command, you can mount the libguestfs filesystem
    space on a local mountpoint using an API call from any language.
    
    Note that although mount-local-run is marked as Cancellable, the
    current implementation does not support it, but it would be relatively
    simple to add it.

commit 49fdba0ae98b5b6995ccaf0f0ba4f542bfff7ce3
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Mar 29 13:40:49 2012 +0100

    gobject: Ignore generated guestfs-sections.txt

commit 1c5dc612bd3610602eb1a441cb9ad380392cc631
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Mar 29 13:40:22 2012 +0100

    gobject: Add split-out files to POTFILES.in

commit b9cb387a109f4d09cdef84a62194201e78f97cb7
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Mar 29 13:33:26 2012 +0100

    test: Thread function is a candidate for attribute noreturn.
    
    The start_test_thread function never returns, it is always
    cancelled by the main thread.

commit d67da6419ac025db7c48f82054d7153b2c71481d
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Mar 29 09:29:47 2012 +0100

    Partially revert "generator: Fix unescaped '<' and '>' in api descriptions"
    
    Don't escape < and > in verbatim sections.
    
    This partially reverts commit 09a4e7664b59789f90b6674f640f9d688e4f8b43.

commit 0c9361a3568c23581ab43cb926fe138669c4b168
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Wed Mar 28 23:30:59 2012 +0200

    Fix out-of-tree build for GObject bindings
    
    guestfs-gobject.h (in the source directory) was not found.
    
    In file included from <stdin>:4:0:
    /path/to/libguestfs/gobject/guestfs-gobject.h:23:37: fatal error: guestfs-gobject-session.h: No such file or directory
    compilation terminated.
    Error while processing the source.
    make[2]: *** [Guestfs-1.0.gir] Error 1

commit 4db251048bd0aca2b98247109f00e68c2080a71c
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Tue Mar 27 21:57:56 2012 +0200

    Fix out-of-tree build for Java bindings

commit 17c828d99550da31c33cc8a7e0f874dd651ded19
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Tue Mar 27 21:57:22 2012 +0200

    Fix out-of-tree build for appliance

commit 2b9167540fb1f8138519575568afef6dacafb1e1
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Mar 28 17:28:32 2012 +0100

    gobject: Remove gtk-doc from TODO

commit 3b0cb4dfdc5471933a8f0682f368b7486fd1ebec
Author: Matthew Booth <mbooth@redhat.com>
Date:   Tue Mar 27 13:44:55 2012 +0100

    gobject: Split sources into 1 file per class
    
    This greatly improves the usability of the generated gtk-doc.
    
    Although there is a lot of churn in generator_gobject.ml, this is almost
    exclusively code motion.

commit 3311e110c7364be42b90b96894adce628135d8bf
Author: Matthew Booth <mbooth@redhat.com>
Date:   Tue Mar 27 10:01:01 2012 +0100

    gobject: Add gtk-doc for GuestfsSession and GuestfsSessionClass

commit 321748d3c2313c159cbbe5f154e36a073a6a84b1
Author: Matthew Booth <mbooth@redhat.com>
Date:   Tue Mar 27 09:50:42 2012 +0100

    gobject: Add gtk-doc field descriptions for generated structs

commit e49bd34fb7e2c2bd66cf83797af2656b1a2d44b2
Author: Matthew Booth <mbooth@redhat.com>
Date:   Mon Mar 26 17:49:25 2012 +0100

    gobject: Add gtk-doc for optarg wrapper classes

commit 574d104b151db97f4eebc2ba058aba9c09705300
Author: Matthew Booth <mbooth@redhat.com>
Date:   Mon Mar 26 17:22:27 2012 +0100

    gobject: Drop references to Guestfs::<foo> in comments

commit e3758fc4309b8ce32cb255a52c25aa687b5a59da
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Mar 23 16:18:22 2012 +0000

    gobject: Handle various problem content in gtk-doc API descriptions
    
    Produce better gtk-doc for:
    * URLs
    * RHBZ# references
    * CVE references
    * API cross-references
    * Parameter references
    * Escaped characters

commit 6b13952657906b32e7cb60ef1c1be5754016e66b
Author: Matthew Booth <mbooth@redhat.com>
Date:   Mon Mar 26 16:23:45 2012 +0100

    gobject: Add basic gtk-doc for all parameters

commit ed5cc90ed52820d11d9da6e913697465160cbc6b
Author: Matthew Booth <mbooth@redhat.com>
Date:   Mon Mar 26 15:58:53 2012 +0100

    gobject: Add basic gtk-doc for properties

commit 9863dd387f71cc7f1344e7d489a3834bf038ba28
Author: Matthew Booth <mbooth@redhat.com>
Date:   Mon Mar 26 15:58:25 2012 +0100

    gobject: gtk-doc SECTION must be named after a source file

commit 1004b2ec25f5ab874a02652749f3ed304eee3074
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Mar 23 14:49:36 2012 +0000

    gobject: Include explicit types for all parameters

commit b0ebf37a9498320b8876aa0c3d3a432af5639165
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Mar 23 13:04:07 2012 +0000

    gobject: Add infrastructure to build gtk-doc

commit 4d0aa08b000743cb523792d0824f2514e2e45ffa
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Mar 28 19:19:58 2012 +0100

    java: Delete target file before running javah.
    
    javah from old GNU classpath won't overwrite the target *.h file,
    instead leaving the old one which results in a predictable build
    failure.  Delete the target so this won't happen.

commit 5ea27d740eb9a7a2fe666dd9ffa70114c0c42756
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Mar 28 19:06:01 2012 +0100

    fish: Fix compilation when libconfig is not available.

commit 3d174b39bff6118bca3068c20ff874924cbfa1fd
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Mar 28 19:02:58 2012 +0100

    Don't provoke -Wstrict-overflow warning from map_app_md_devices function.
    
    Unclear if this is a real bug or not.

commit f2fae5151f33e933f4d574dc4324b7a8a2ee393c
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Mar 28 19:01:56 2012 +0100

    Work around -Wstrict-overflow warning on gcc 4.5.1.

commit b169b03dd42b82218c7241f33425c27660e4bdae
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Mar 28 18:55:38 2012 +0100

    m4: Update .gitignore for old Fedora.

commit 8111b108d224dda868f257ac0ef23838991b3594
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Mar 28 18:19:54 2012 +0100

    configure: Don't fail if GOBJECT_INTROSPECTION_CHECK is not defined.

commit f35aadcd86a081756b35c1eb4326a9d23e82f21e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 27 17:39:59 2012 +0100

    tests: Don't include internal guestfs header in tests.

commit a33ea716015adf6a9bcf755aaf736294848f7ad2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 27 15:06:56 2012 +0100

    generator: Allow functions with no requires args, and with some optional args.
    
    Previously the generator disallowed such functions.

commit a138063acb32f6fccfef24381a9c61f08d68ea74
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 27 17:26:48 2012 +0100

    Ignore guestfs.pyo.
    
    This fixes commit e8ef35df267de6fd6308d0c49a6bdef41113cf19.

commit e8ef35df267de6fd6308d0c49a6bdef41113cf19
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Mar 23 12:53:31 2012 +0000

    Only ignore guestfs.* at the top level
    
    The guestfs.* rule appears to be for temporary appliance directories, which are
    only at the top level. It was matching more than that.

commit 13e5f1a3b1f6493ea5e576bdd607aedc2c7ddc82
Author: Matthew Booth <mbooth@redhat.com>
Date:   Tue Mar 27 15:38:41 2012 +0100

    generator: Remove doc reference to non-existent guestfs_inotify_watch_all

commit 09a4e7664b59789f90b6674f640f9d688e4f8b43
Author: Matthew Booth <mbooth@redhat.com>
Date:   Tue Mar 27 15:24:50 2012 +0100

    generator: Fix unescaped '<' and '>' in api descriptions

commit f5c31db5ed4225c263e6f508a85f38aa80411c0e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 26 18:28:00 2012 +0100

    fuse: Fix documentation for call to virt-filesystems.
    
    virt-filesystems requires -a/-d option.

commit f1d10672c7da94f8983b3b5d434e64b127da1242
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Mar 25 19:35:43 2012 +0100

    df: Avoid a compilation error if libxml2 is not available.
    
    virt_df-domains.o: In function `add_domain':
    /home/feeliwood/Downloads/libguestfs-1.17.21/df/domains.c:274: undefined reference to `guestfs___for_each_disk'
    
    guestfs___for_each_disk is only available when libvirt _and_ libxml2
    dependencies are available at compile time.
    
    Thanks Tho Huynh.

commit 88b5ee9d952fa3268fab54abb9e62aa3fef42927
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Mar 25 19:20:07 2012 +0100

    Revert "ruby: Replace deprecated rdoc/task and rake/gempackagetask."
    
    This reverts commit fd7a5a8bbdc69b9d2a92f6d05ac555334d0516bf.
    
    This breaks Ruby 1.8.7 in Fedora 16.

commit fc198a3b9aeaa76ee7d6ffc27402d25a4379dbbd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 22 10:05:27 2012 +0000

    Remove references to obsolete directory appliance/debian.
    
    This directory has not existed for a long time.

commit a14021078b6c52c54d84fd4f18ff83302d6c183a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 22 10:00:26 2012 +0000

    Remove debian/ subdirectory.

commit 55c4e7a0d3d6f06b6361dd48d42355eae7a10388
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 21 12:34:01 2012 +0000

    Version 1.17.21.

commit 7d2027295fb394dd5d8cbc1e960ea6a47d420225
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 21 10:55:23 2012 +0000

    filesystems: Implement parents of MD and VG devices (RHBZ#805070).

commit a8f8af950d5b178a77a3b6423fbbd1ba447858f9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 20 19:14:32 2012 +0000

    filesystems: Allow the parents column to contain multiple parents.
    
    A list of parents is passed for this column.
    
    This column is rendered as an (internally) comma-separated list.

commit 3f6cc550ff5dcaca813b19938daaf41baacb1efa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 20 17:17:02 2012 +0000

    New API: md-stat.
    
    This returns information about the underlying devices of an MD
    (software RAID) device.

commit 65ebec4a7a70cd179e4c39d72f539e500931c267
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 20 17:14:56 2012 +0000

    generator: Generate a .gitignore file specifically for java structs.

commit f62db21d8babc14d580f754b0bf4d0cbe3c5bc9d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 20 12:27:14 2012 +0000

    daemon: Set last errno to ENOTSUP when APIs are not available.

commit 7526df547c5bea9a0cb4370ca022e413388dce2e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 20 12:25:40 2012 +0000

    daemon: Add reply_with_error_errno function.
    
    This function allows you to pass an explicit errno back to the
    library.  reply_with_error is redefined as a macro that calls
    reply_with_error_errno with errno == 0.

commit c7dff02ccbb6bbe505c73df5d83bea8afdc188c3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 19 16:32:10 2012 +0000

    inspection: Set last errno to ENOTSUP when inspection APIs are not available.
    
    Previously there was no programmatic way to tell if inspection APIs
    were unavailable because they are not compiled in (because hivex isn't
    around).  This contrasts with daemon APIs where the availability is
    covered by the guestfs_available API.
    
    Change the inspection APIs so that when they are not available, the
    last errno is set to ENOTSUP.  (Note that ENOTSUP must be defined on
    all POSIX platforms).
    
    This allows programs to detect if they are using a version of
    libguestfs that was compiled without support for inspection, without
    having to parse error messages.

commit b8fc61bd9b87f9d55d37cd52f584f7706b2af078
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 20 09:11:16 2012 +0000

    todo: Document proposed attach-method fd:N

commit e1ffb1011566ec68246df33ca42774b44ad5006c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 19 10:20:08 2012 +0000

    po-docs: Rename LINGUAS -> linguas (RHBZ#804464).

commit 752bd8f6327eea4cee0fb77442b8250ec29df0ce
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 17 22:11:32 2012 +0000

    Make HTML from libguestfs-test-tool man page.

commit 7c2ebad357f996d6f88612cbd7fa2fbd95d78480
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 17 20:39:54 2012 +0000

    Version 1.17.20.

commit a4fd393663babbd242f209ed29033b3cb4943749
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 17 14:36:28 2012 +0000

    New API: vgmeta: Download volume group metadata.

commit 05461175c48b9d7ac7c42d0a243971f489578295
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 17 09:26:20 2012 +0000

    appliance: Add a tool to make fixed appliances.

commit fd7a5a8bbdc69b9d2a92f6d05ac555334d0516bf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 16 22:14:44 2012 +0000

    ruby: Replace deprecated rdoc/task and rake/gempackagetask.

commit f9c4fdfeea7d46634e00d0d9d3f22dfe7030a9ca
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 16 18:27:52 2012 +0000

    todo: Suggestion for virt-sysprep.

commit a6f47c285f09f86db67eb619952a0a3f715bb908
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 16 15:18:48 2012 +0000

    Version 1.17.19.

commit 14938b46a74467d0e4b1cd076ffd7fcbf06c26eb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 16 14:42:30 2012 +0000

    generator: Sort camel-case structs.

commit a43f35f5bb7c40b000083cd8be5cb1f28595a3f1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 16 13:28:13 2012 +0000

    New APIs: isoinfo and isoinfo-device.
    
    Get ISO primary volume descriptor information for either ISO devices
    or ISO files.

commit d17218c2107ada5e8e1c011fa51ed88b4873d9ef
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 16 11:05:42 2012 +0000

    appliance: Include genisoimage in the appliance.
    
    This is mainly useful for the 'isoinfo' tool, but 'genisoimage'
    itself may be interesting to have in future.

commit 6bee63beb45678ff937593af59748dfceacdc608
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 16 14:10:40 2012 +0000

    generator: Fix CompareWithString test.
    
    This type of test was not used, and in fact the generated test
    simply didn't work.

commit c8630300b8ab46c668da1c8d5c1cdb9d1e3a4552
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 16 14:10:00 2012 +0000

    generator: Fix FUInt{32,64} struct field types.
    
    We were not using an unsigned type in the XDR.  This doesn't
    affect data integrity or the protocol, but it makes it more
    complicated for the daemon to set these fields.

commit 710ec49bac8bce10bfc0b9ba4b34d877c22f7287
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 16 12:40:16 2012 +0000

    daemon: Don't call reply_with_* after split_lines fails.
    
    split_lines already sets reply_with_*, so calling it again would lose
    protocol synchronization.

commit 974dffc6769b732befe85bcd8f614b9600927631
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 16 10:44:04 2012 +0000

    inspect: Fedora/RHEL CDs are multipart if totaldiscs > 1, not > 0.

commit 553e50c105c9f4c6cacde48dc8ab05f8faa665db
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 16 10:43:40 2012 +0000

    inspect: Parse isolinux menu title from RHEL 6.2 Live CD.

commit 5749de39c2b44644662fb176784731bce851b828
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 16 10:42:46 2012 +0000

    inspect: Add comment documenting findings of RHEL 5, 6 install CDs.

commit 5411f3fd457a46f39ccbb317a2bbb5897731eef6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 15 16:45:37 2012 +0000

    Version 1.17.18.

commit 85a701c10c89a806850ce42450f820d63c482935
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 15 10:50:52 2012 +0000

    todo: Document further virt-sparsify improvements.

commit 98f066e27443287a393dc1fc9f9c0ede4f58be48
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 15 16:07:08 2012 +0000

    sparsify: Implement --zero option.
    
    This unconditionally zeroes the named partition or filesystem.

commit 1c1ecb2c419382f1677501b22cb98a06c7abe9a9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 15 16:01:51 2012 +0000

    sparsify: Add a note about encrypted disks to the man page.

commit 7283a5a2765c0670e9dceec70e626a49a30d269c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 15 15:49:22 2012 +0000

    sparsify: Unlink temporary overlay file if user presses ^C.
    
    Add a signal handler so this potentially large temporary file
    is removed when the user hits ^C.

commit 31c26be91f855d661ccdfc3eeb7d4626f4085a12
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 15 15:25:06 2012 +0000

    sparsify: Support sparsifying Linux swap partitions.

commit 8c9f6a64be9840a955e481e932f13d005c0de0de
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 15 10:32:27 2012 +0000

    sparsify: Use zero-device instead of dd if=/dev/zero to zero device.
    
    zero-device is more efficient in general, and avoids writing to blocks
    which are already zero.

commit b05611d8efbfad10518fe874d53292c6a1b7f2b9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 15 10:30:21 2012 +0000

    Use the new lvcreate-free API to create largest possible LVs.

commit 79c4ecc0f398d4317a3713e0691df873a7d4b663
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 15 10:25:26 2012 +0000

    New API: lvcreate-free: Create logical volume as % of free space.

commit 03d4345c8c8de4df1c9d4446b0817d85ff378aa9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 15 10:07:26 2012 +0000

    sparsify: Use new zero_free_space API.

commit d9bdb9587b4e1cad0c3e9997ea7d2b2a07aed0ad
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 15 09:43:04 2012 +0000

    New API: zero_free_space: zero free space in a filesystem.
    
    Add an API for doing what virt-sparsify was doing: freeing up free
    space in a filesystem.
    
    The current implementation is simple-minded: we create a file, fill it
    with zeroes until we run out of space, then delete the file.  However
    the description leaves it open to do a better implementation, eg.
    using sparsification support that is currently being worked on in ext4
    and qemu.
    
    The implementation also sends progress notifications, which is an
    advantage over the old 'dd' method.

commit 7934ea2395d2a417fbc20efc22573113f7ae9d7a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 15 16:07:28 2012 +0000

    sparsify: Only print qemu-img command if verbose.

commit 91cede3465cd2496a01a89d5c8815df7c326c2ec
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 15 13:53:32 2012 +0000

    inspect: Ignore missing HKLM\SYSTEM\MountedDevices (RHBZ#803664).
    
    When a Windows guest doesn't have a HKLM\SYSTEM\MountedDevices node,
    inspection fails.  However inspection should not completely fail just
    because we cannot get the drive letter mapping from a guest.

commit 2bc922dd8e12bcf05e0aeef8a8b60b6aab9ee915
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 14 23:06:44 2012 +0000

    inspector: Update man page to describe how to access inspection info from other languages and guestfish.

commit c23f3b8e527bde9a83dd7ae24273db6da87a7268
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 14 21:13:43 2012 +0000

    Add guestfsd.suppressions file to EXTRA_DIST.

commit e743eb3984b6d9f75e942fed06e167911b45a4ee
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 14 19:57:36 2012 +0000

    Version 1.17.17.

commit 606732d02e678161ff433040a21d54fc2ea8bb43
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 14 19:30:46 2012 +0000

    Use O_CLOEXEC / SOCK_CLOEXEC for almost all file descriptors.
    
    The presumption is that all file descriptors should be created with
    the close-on-exec flag set.  The only exception are file descriptors
    that we want passed through to exec'd subprocesses (mainly pipes and
    stdin/stdout/stderr).
    
    For open calls, we pass O_CLOEXEC as an extra flag, eg:
    
      fd = open ("foo", O_RDONLY|O_CLOEXEC);
    
    This is a Linux-ism, but using a macro we can easily make it portable.
    
    For sockets, similarly:
    
      sock = socket (..., SOCK_STREAM|SOCK_CLOEXEC, ...);
    
    For accepted sockets, we use the Linux accept4 system call which
    allows flags to be supplied, but we use the Gnulib 'accept4' module to
    make this portable.
    
    For dup, dup2, we use the Linux dup3 system call, and the Gnulib
    modules 'dup3' and 'cloexec'.

commit 13e7a1b400b7e2a5e9335d25205b09e74c89d858
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 14 19:29:52 2012 +0000

    java: Make sure generator is rerun when necessary to rebuild generated files.

commit d042e56f2a21553795c108a5b76a9d5eec219b1b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 14 19:29:11 2012 +0000

    java: Enable -Xlint:all and fix all warnings.

commit 6b233bd39e8cff7be303a5a82eb0cbb06c0573bc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 14 19:28:13 2012 +0000

    todo: More ongoing code cleanups.

commit 302309921a8cde83eb19a7c25b7ee43932b91a05
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 14 16:13:40 2012 +0000

    appliance: Enhance --enable-valgrind-daemon with a suppressions file.
    
    This lets us suppress errors in system libraries.

commit 5da61d30520315a7d5060137a6c109f2109a7631
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 14 16:12:54 2012 +0000

    daemon: When copy subprocess fails, print return code.
    
    Useful for debugging.

commit 9974c42a29d60e6d1364c7d39f8c952604d41012
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 14 12:53:37 2012 +0000

    todo: Document ongoing code cleanups.

commit f8762715215df9f3f81d1d29b1ed25e1e8e9554d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 14 12:52:55 2012 +0000

    daemon: labels: Memory leak in 'set_label'.
    
    This fixes commit d1711dae9dbd7f516469f88807604894c1304228.

commit 7e32d892d76a31f55e2a4151902623b9949e3efa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 13 08:45:49 2012 +0000

    Version 1.17.16.

commit f76a88011a993d059beafe090a21a20be1cb9f4d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 13 08:23:56 2012 +0000

    Replace 'int' with 'size_t' passim.
    
    Analyze all uses of 'int' in the code, and replace with 'size_t' where
    appropriate.

commit 14df5fa5d1731a502332e9d4a41f54ee3d4a4dac
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 13 08:19:11 2012 +0000

    daemon: Implement a growable strings buffer type.
    
    Previously a lot of daemon code used three variables (a string list,
    'int size' and 'int alloc') to track growable strings buffers.  This
    commit implements a simple struct containing the same variables, but
    using size_t instead of int:
    
      struct stringsbuf {
        char **argv;
        size_t size;
        size_t alloc;
      };
    
    Use it like this:
    
      DECLARE_STRINGSBUF (ret);
    //...
      if (add_string (&ret, str) == -1)
        return NULL;
    //...
      if (end_stringsbuf (&ret) == -1)
        return NULL;
      return ret.argv;

commit d66dd2260c724bdfe57a8595aac37c8e9173cee5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 12 16:27:10 2012 +0000

    Fix strict-overflow bugs and reenable this warning.
    
    In two places, we were counting things in an array using an 'int'.  In
    theory, the int could overflow, so gcc determines this to be undefined
    behaviour.
    
    The fix is to use size_t or ssize_t instead.

commit 17182af3a6de8e3e94e0a914416c54f09bb74007
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 12 15:14:54 2012 +0000

    fish: remote: Output from close event now passed over stdout (RHBZ#802389).

commit f7c744bbf819b5984cbd3569d35d82a0451996b3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 12 15:13:29 2012 +0000

    fish: remote: Make sure global cleanups are called for guestfish --listen.
    
    Return to the main program ('fish.c') and perform global cleanups when
    the guestfish remote server exits.

commit b3a9e818686c83caeb5b4fd9763437eac0d32654
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 12 15:11:33 2012 +0000

    fish: remote: Move close_stdout just before accept() call.
    
    This is just code motion.

commit 1f603bfd6d7cd17e88f737a496b7e5ee053750c2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 12 15:09:15 2012 +0000

    fish: Rename tests and make test paths relative.
    
    When these tests were originally in the old regressions/ directory,
    they used to refer to guestfish via the path '../fish/guestfish'.
    Some of the tests were also called 'test-guestfish-*'.
    
    Now that the tests have been moved into the fish/ directory, neither
    of these things make sense.  So change the relative path to
    './guestfish' and rename all 'test-guestfish-*' as 'test-*'.

commit 2c8ead5aa0e6b821bf2d21a89e437e9a6c0ed1ca
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 12 14:10:05 2012 +0000

    tests: Remove/fix unused variables warnings.

commit 100e30763ea6ef3585d807bdecd32658275ae257
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 12 12:04:46 2012 +0000

    Version 1.17.15.

commit 099e3dd9f129e05bff5512855ea89530a7999004
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 12 12:19:59 2012 +0000

    tests: Remove unused variable.

commit 5cad29043fa53ab8f499db276fe1a9a89ab2b21b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 12 11:22:40 2012 +0000

    configure: Enable more warnings, and some cleanup.
    
    However -Wstrict-overflow is still disabled, see:
    http://gcc.gnu.org/bugzilla/show_bug.cgi?id=52560

commit 6292e630da080eb5d3427af6190eb68fe4eb1415
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 12 11:47:21 2012 +0000

    erlang: Remove unused variables.

commit e9e0920c00c55894358559bcdbd89d55cbb66d2a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 12 11:47:09 2012 +0000

    format: Remove unused variables.

commit 13c2db39abff3c0050eade5bcce997afdf04d721
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 12 11:46:49 2012 +0000

    daemon: Remove unused variables.

commit 46d1280100b025de2a448331306e794d688748bd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 12 11:29:06 2012 +0000

    inspect: Move variable decl to top of function.

commit 4bcd0b3c1766e459426e7d4138619790d4dd77d8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 12 11:27:32 2012 +0000

    inspect: Use 1/0 instead of true/false, and fix a bug in UUID parsing.
    
    UUID parsing returned 'false' (ie. 0 == OK) when the UUID contained
    illegal characters.  Now it returns -1 == failure.

commit cd3f2986eee8dbadc8253d4c3462f7e214f1236d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 12 11:26:55 2012 +0000

    lib: Remove some unused variables.

commit 1aa72017ca1efc422d3be13077a3d9c769922c82
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 12 11:26:29 2012 +0000

    lib: Use size_t instead of int for array iterator.

commit 3d279d15c192779a290892e1789fa74360f002ff
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 12 11:25:13 2012 +0000

    inspect: Use uint64_t for maximum file size in bytes.

commit b8cdf6c2b9d12df6acbe295fd75c8c59c8b7eec1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 12 11:24:51 2012 +0000

    lib: Use size_t for allocation size in safe realloc function.

commit 24413ac4d8c8d64b3339f9e61886db8f7fbfed4f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 12 11:23:57 2012 +0000

    bindtests: Use size_t instead of int for array iterators.

commit e6f18c59d577dd0b443bc6a1d76f699c4e0dde9f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Mar 11 20:12:41 2012 +0000

    Coalesce printable characters in debug and trace messages (RHBZ#802109).

commit 5b7b1c43ab85bb75bdb36844cce1cc124d5df4f2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 9 17:26:19 2012 +0000

    Document error message from resize2fs (RHBZ#755729, RHBZ#801640).

commit 2fb545b840745f6d944d89872f1d7372821b30cc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 9 16:53:02 2012 +0000

    resize2fs: Run 'e2fsck -f' automatically if filesystem is not mounted.

commit 4c9218658e4d4b769acaa41d999b4bce437fbc37
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 9 16:52:28 2012 +0000

    e2fsck: Comment, whitespace, error message cleanups.

commit 99923c7cd0e2d729d0205f872a8ae28775b1b8af
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 9 16:15:41 2012 +0000

    Mark e2fsck-f as deprecated, replaced by e2fsck API.

commit dfe30bdfe70f18d61404b41300f274480163c44d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 9 16:13:49 2012 +0000

    Revert "ext2: tweak the error returned message of resize2fs-M(BZ755729)"
    
    This reverts commit 0eaf06e673833bc25673d5c3d2487fffae310285.

commit d0cf52b9118ab18bfffc7e4397531192610a7371
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 9 16:01:17 2012 +0000

    Version 1.17.14.

commit baa5e1ea5167b3a1c3bf9b6400834cbaf2ac3136
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 9 10:37:06 2012 +0000

    example: Copying a directory between two guests using threads.

commit f1f045adf8d00549dd3efa3619e1162f9004b61e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 9 12:05:43 2012 +0000

    Close all file descriptors and remove all signal handlers in the recovery process.
    
    If the parent process uses a pipe (or any fd, but pipes are a
    particular problem), then the recovery process would hold open the
    file descriptor(s) of the pipe, meaning that it could not be fully
    closed in the parent.  Because the recovery process doesn't use
    exec(2), this wasn't avoidable even using FD_CLOEXEC.
    
    Avoid this by closing all file descriptors when starting the recovery
    process.
    
    After discussion with Dan Berrange, he points out that it's also a
    good idea to set signal handlers to the default after forking, so that
    any signal handlers set up in the parent don't affect the child.

commit 99702fe443383707b9d9c1b84570baf3bebf9253
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 8 19:27:37 2012 +0000

    extra-tests: Export LIBVIRT_DEFAULT_URI to pick-guests.pl.
    
    This fixes commit 2912e4e1173226f461517a0008664e01b5d3066d.

commit f8e7a41e678c3bd7ede50a38b1da7f3a5f92ddea
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 8 17:39:11 2012 +0000

    Version 1.17.13.

commit 2912e4e1173226f461517a0008664e01b5d3066d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 8 16:19:20 2012 +0000

    extra-tests: Check that guests are accessible before picking them.

commit 0721464b83915fbfae6d6a9da787f5069b2c6d6a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 8 15:01:55 2012 +0000

    fish: Document that guestfish sets pgroup to true (RHBZ#801273).

commit 270daae52b6a96b4d05cbe03e0b31a0b2e4ac1ae
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 8 14:49:23 2012 +0000

    inspect_apps: Avoid double-close on error path (found by Coverity) (RHBZ#801298).
    
    Error: USE_AFTER_FREE:
    /builddir/build/BUILD/libguestfs-1.16.5/src/inspect_apps.c:392: freed_arg: "fclose" frees "fp".
    /builddir/build/BUILD/libguestfs-1.16.5/src/inspect_apps.c:404: deref_arg: Calling "fclose" dereferences freed pointer "fp".

commit 3f3b08a6bc610ca0886e02972257dfcb633a9d40
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 8 14:36:25 2012 +0000

    dbdump: Avoid double-close on error path (found by Coverity).
    
    Error: USE_AFTER_FREE:
    /builddir/build/BUILD/libguestfs-1.16.5/src/dbdump.c:132: freed_arg: "pclose" frees "pp".
    /builddir/build/BUILD/libguestfs-1.16.5/src/dbdump.c:142: deref_arg: Calling "pclose" dereferences freed pointer "pp".

commit b2c1d8be39d4689267ef7e4188e2cf936b30628f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 8 14:30:10 2012 +0000

    daemon: glob: Initialize glob buffer (quiet Coverity warning).
    
    Error: UNINIT:
    /builddir/build/BUILD/libguestfs-1.16.5/daemon/glob.c:32: var_decl: Declaring variable "buf" without initializer.
    /builddir/build/BUILD/libguestfs-1.16.5/daemon/glob.c:36: uninit_use_in_call: Using uninitialized value "buf.gl_offs" when calling "rpl_glob".
    /builddir/build/BUILD/libguestfs-1.16.5/gnulib/lib/glob.c:557: read_parm_fld: Reading a parameter field.
    /builddir/build/BUILD/libguestfs-1.16.5/daemon/glob.c:36: uninit_use_in_call: Using uninitialized value "buf.gl_pathc" when calling "rpl_glob".
    /builddir/build/BUILD/libguestfs-1.16.5/gnulib/lib/glob.c:557: read_parm_fld: Reading a parameter field.

commit 3345444cccfe2e2fb07d4769d1e764eca59dd6f9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 8 14:11:18 2012 +0000

    comment: Note time-of-check to time-of-use race found by Coverity.

commit ae0f9f149b2b527b924d4532aa38302056d8a6b0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 8 13:53:04 2012 +0000

    daemon: inotify: Check event->len in inotify struct is reasonable.
    
    The Coverity error is this (which I think is wrong):
    
    Error: TAINTED_SCALAR:
    /builddir/build/BUILD/libguestfs-1.16.5/daemon/inotify.c:211: tainted_data_argument: Calling function "read" taints argument "inotify_buf".
    /builddir/build/BUILD/libguestfs-1.16.5/daemon/inotify.c:232: var_assign_var: Assigning: "event" = "(struct inotify_event *)&inotify_buf[n]". Both are now tainted.
    /builddir/build/BUILD/libguestfs-1.16.5/daemon/inotify.c:258: lower_bounds: Checking lower bounds of unsigned scalar "event->len" by "event->len > 0U".
    /builddir/build/BUILD/libguestfs-1.16.5/daemon/inotify.c:272: var_assign_var: Compound assignment involving tainted variable "16UL + event->len" to variable "n" taints "n".
    /builddir/build/BUILD/libguestfs-1.16.5/daemon/inotify.c:228: lower_bounds: Checking lower bounds of unsigned scalar "n" by "n < inotify_posn".
    /builddir/build/BUILD/libguestfs-1.16.5/daemon/inotify.c:281: tainted_data: Using tainted variable "n" as an index into an array "inotify_buf".
    
    Adding a sanity check of event->len is prudent.

commit 3b3d9ca4e1fa0a4f566cb2a8008540ee640b738b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 8 13:23:15 2012 +0000

    daemon: debug: Close fd along error path (found by Coverity).
    
    Error: RESOURCE_LEAK:
    /builddir/build/BUILD/libguestfs-1.16.5/daemon/debug.c:469: open_fn: Calling opening function "open".
    /builddir/build/BUILD/libguestfs-1.16.5/daemon/debug.c:469: var_assign: Assigning: "fd" =  handle returned from "open("/proc/sys/kernel/core_pattern", 1)".
    /builddir/build/BUILD/libguestfs-1.16.5/daemon/debug.c:474: noescape: Variable "fd" is not closed or saved in function "write".
    /builddir/build/BUILD/libguestfs-1.16.5/daemon/debug.c:476: leaked_handle: Handle variable "fd" going out of scope leaks the handle.

commit 4dd26c28a3786f756c20f204488bfbcfc5e75309
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 8 12:21:09 2012 +0000

    fish: Properly free up strings, lists along all error paths (found by Coverity).
    
    This also includes some tidying up of the generated code.
    
    Error: RESOURCE_LEAK:
    /builddir/build/BUILD/libguestfs-1.16.5/fish/cmds.c:13254: alloc_fn: Calling allocation function "parse_string_list".
    /builddir/build/BUILD/libguestfs-1.16.5/fish/fish.c:1386: alloc_fn: Storage is returned from allocation function "realloc".
    /builddir/build/BUILD/libguestfs-1.16.5/fish/fish.c:1386: var_assign: Assigning: "argv_new" = "realloc(argv, 8UL * argv_len)".
    /builddir/build/BUILD/libguestfs-1.16.5/fish/fish.c:1392: var_assign: Assigning: "argv" = "argv_new".
    /builddir/build/BUILD/libguestfs-1.16.5/fish/fish.c:1396: return_alloc: Returning allocated memory "argv".
    /builddir/build/BUILD/libguestfs-1.16.5/fish/cmds.c:13254: var_assign: Assigning: "devices" =  storage returned from "parse_string_list(argv[i++])".
    /builddir/build/BUILD/libguestfs-1.16.5/fish/cmds.c:13271: leaked_storage: Variable "devices" going out of scope leaks the storage it points to.
    /builddir/build/BUILD/libguestfs-1.16.5/fish/cmds.c:13288: leaked_storage: Variable "devices" going out of scope leaks the storage it points to.
    /builddir/build/BUILD/libguestfs-1.16.5/fish/cmds.c:13293: leaked_storage: Variable "devices" going out of scope leaks the storage it points to.
    /builddir/build/BUILD/libguestfs-1.16.5/fish/cmds.c:13311: leaked_storage: Variable "devices" going out of scope leaks the storage it points to.
    /builddir/build/BUILD/libguestfs-1.16.5/fish/cmds.c:13316: leaked_storage: Variable "devices" going out of scope leaks the storage it points to.
    /builddir/build/BUILD/libguestfs-1.16.5/fish/cmds.c:13334: leaked_storage: Variable "devices" going out of scope leaks the storage it points to.
    /builddir/build/BUILD/libguestfs-1.16.5/fish/cmds.c:13349: leaked_storage: Variable "devices" going out of scope leaks the storage it points to.
    /builddir/build/BUILD/libguestfs-1.16.5/fish/cmds.c:13355: leaked_storage: Variable "devices" going out of scope leaks the storage it points to.

commit d0453c02545c825810fec6e5874c55d7ac5ec678
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 8 11:44:31 2012 +0000

    daemon: proto: Close fd along error paths (found by Coverity).
    
    Error: RESOURCE_LEAK:
    /builddir/build/BUILD/libguestfs-1.16.5/src/proto.c:894: open_fn: Calling opening function "open".
    /builddir/build/BUILD/libguestfs-1.16.5/src/proto.c:894: var_assign: Assigning: "fd" =  handle returned from "open(filename, 0)".
    /builddir/build/BUILD/libguestfs-1.16.5/src/proto.c:903: noescape: Variable "fd" is not closed or saved in function "read".
    /builddir/build/BUILD/libguestfs-1.16.5/src/proto.c:911: leaked_handle: Handle variable "fd" going out of scope leaks the handle.
    /builddir/build/BUILD/libguestfs-1.16.5/src/proto.c:918: leaked_handle: Handle variable "fd" going out of scope leaks the handle.

commit fbf10d7f682178a6a71cfa8dbac2acd23f869597
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 8 11:41:13 2012 +0000

    daemon: upload: Close fd along error path (found by Coverity).
    
    Error: RESOURCE_LEAK:
    /builddir/build/BUILD/libguestfs-1.16.5/daemon/upload.c:225: open_fn: Calling opening function "open".
    /builddir/build/BUILD/libguestfs-1.16.5/daemon/upload.c:225: var_assign: Assigning: "fd" =  handle returned from "open(filename, 0)".
    /builddir/build/BUILD/libguestfs-1.16.5/daemon/upload.c:233: noescape: Variable "fd" is not closed or saved in function "lseek".
    /builddir/build/BUILD/libguestfs-1.16.5/daemon/upload.c:235: leaked_handle: Handle variable "fd" going out of scope leaks the handle.

commit cba36e730524525b5fc1c0df2ec3dd878d55ff15
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 8 11:39:50 2012 +0000

    daemon: 9p: Close fd along error paths (found by Coverity).
    
    Error: RESOURCE_LEAK:
    /builddir/build/BUILD/libguestfs-1.16.5/daemon/9p.c:130: open_fn: Calling opening function "open".
    /builddir/build/BUILD/libguestfs-1.16.5/daemon/9p.c:130: var_assign: Assigning: "fd" =  handle returned from "open(filename, 0)".
    /builddir/build/BUILD/libguestfs-1.16.5/daemon/9p.c:142: leaked_handle: Handle variable "fd" going out of scope leaks the handle.
    /builddir/build/BUILD/libguestfs-1.16.5/daemon/9p.c:149: noescape: Variable "fd" is not closed or saved in function "read".
    /builddir/build/BUILD/libguestfs-1.16.5/daemon/9p.c:153: leaked_handle: Handle variable "fd" going out of scope leaks the handle.

commit 855aaf414af3b8c8ca1f722a589fd251cc8317ee
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 8 11:32:43 2012 +0000

    proto: Close file along error and cancel paths (found by Coverity).
    
    Error: RESOURCE_LEAK:
    /builddir/build/BUILD/libguestfs-1.16.5/src/proto.c:1125: open_fn: Calling opening function "open".
    /builddir/build/BUILD/libguestfs-1.16.5/src/proto.c:1125: var_assign: Assigning: "fd" =  handle returned from "open(filename, 833, 438)".
    /builddir/build/BUILD/libguestfs-1.16.5/src/proto.c:1133: noescape: Variable "fd" is not closed or saved in function "xwrite".
    /builddir/build/BUILD/libguestfs-1.16.5/src/proto.c:1146: leaked_handle: Handle variable "fd" going out of scope leaks the handle.
    /builddir/build/BUILD/libguestfs-1.16.5/src/proto.c:1173: leaked_handle: Handle variable "fd" going out of scope leaks the handle.

commit 618954a6b0adc3e0eacda799b88f020c801a0106
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 8 11:17:27 2012 +0000

    Check return values of guestfs_inspect_get_{type,distro} (found by Coverity).
    
    Error: NULL_RETURNS:
    /builddir/build/BUILD/libguestfs-1.16.5/examples/virt-dhcp-address.c:129: var_assigned: Assigning: "guest_distro" = null return value from "guestfs_inspect_get_distro".
    /builddir/build/BUILD/libguestfs-1.16.5/examples/virt-dhcp-address.c:131: dereference: Dereferencing a pointer that might be null "guest_distro" when calling "__coverity_strcmp".
    [...]
    /builddir/build/BUILD/libguestfs-1.16.5/examples/virt-dhcp-address.c:126: var_assigned: Assigning: "guest_type" = null return value from "guestfs_inspect_get_type".
    /builddir/build/BUILD/libguestfs-1.16.5/examples/virt-dhcp-address.c:128: dereference: Dereferencing a pointer that might be null "guest_type" when calling "__coverity_strcmp".

commit 35d5be22b1c09c3a99b445f65453601ec25b9f60
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 8 11:06:46 2012 +0000

    Check return values from calloc (found by Coverity).
    
    Error: NULL_RETURNS:
    /builddir/build/BUILD/libguestfs-1.16.5/src/inspect.c:417: returned_null: Function "calloc" returns null (checked 67 out of 81 times).
    /builddir/build/BUILD/libguestfs-1.16.5/src/inspect.c:417: var_assigned: Assigning: "ret" = null return value from "calloc".
    /builddir/build/BUILD/libguestfs-1.16.5/src/inspect.c:418: dereference: Dereferencing a null pointer "ret".
    [...]
    /builddir/build/BUILD/libguestfs-1.16.5/src/inspect.c:374: returned_null: Function "calloc" returns null (checked 67 out of 81 times).
    /builddir/build/BUILD/libguestfs-1.16.5/src/inspect.c:374: var_assigned: Assigning: "ret" = null return value from "calloc".
    /builddir/build/BUILD/libguestfs-1.16.5/src/inspect.c:375: dereference: Dereferencing a null pointer "ret".

commit 0ffa223a75fe4b5b077e4ec68534155039772c3a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 8 10:53:59 2012 +0000

    Dead code: Remove comma-check in first if-clause (found by Coverity).
    
    Error: DEADCODE:
    /builddir/build/BUILD/libguestfs-1.16.5/fish/event-names.c:65: dead_error_condition: On this path, the condition "comma" cannot be true.
    /builddir/build/BUILD/libguestfs-1.16.5/fish/event-names.c:57: const: After this line, the value of "comma" is equal to 0.
    /builddir/build/BUILD/libguestfs-1.16.5/fish/event-names.c:57: assignment: Assigning: "comma" = "0".
    /builddir/build/BUILD/libguestfs-1.16.5/fish/event-names.c:65: dead_error_line: Execution cannot reach this statement "fputc(44, fp);".

commit 109d3ad34aac8d50a1c02437928a64d9bad9f1a6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 8 10:51:02 2012 +0000

    Dead code: 'lvs' cannot be true here (found by Coverity).
    
    Remove dead code; however only comment it out since if we change the
    preceeding code we may need this line again.
    
    Error: DEADCODE:
    /builddir/build/BUILD/libguestfs-1.16.5/src/listfs.c:107: dead_error_condition: On this path, the condition "lvs" cannot be true.
    /builddir/build/BUILD/libguestfs-1.16.5/src/listfs.c:54: const: After this line, the value of "lvs" is equal to 0.
    /builddir/build/BUILD/libguestfs-1.16.5/src/listfs.c:91: const: After this line, the value of "lvs" is equal to 0.
    /builddir/build/BUILD/libguestfs-1.16.5/src/listfs.c:54: assignment: Assigning: "lvs" = "NULL".
    /builddir/build/BUILD/libguestfs-1.16.5/src/listfs.c:91: new_values: Noticing condition "lvs == NULL".
    /builddir/build/BUILD/libguestfs-1.16.5/src/listfs.c:107: dead_error_line: Execution cannot reach this statement "guestfs___free_string_list(...".

commit 07a8c3c0c25974e0b9496966a7a1354be9ee844f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 8 10:48:21 2012 +0000

    Ignore return values from some functions in guestfs_close (Coverity warning).
    
    Error: CHECKED_RETURN:
    /builddir/build/BUILD/libguestfs-1.16.5/java/com_redhat_et_libguestfs_GuestFS.c:9552: example_assign: Assigning: "r" = return value from "guestfs_internal_autosync(g)".
    /builddir/build/BUILD/libguestfs-1.16.5/java/com_redhat_et_libguestfs_GuestFS.c:9555: example_checked: "r" has its value checked in "r == -1".
    /builddir/build/BUILD/libguestfs-1.16.5/ocaml/guestfs_c_actions.c:5584: example_assign: Assigning: "r" = return value from "guestfs_internal_autosync(g)".
    /builddir/build/BUILD/libguestfs-1.16.5/ocaml/guestfs_c_actions.c:5586: example_checked: "r" has its value checked in "r == -1".
    /builddir/build/BUILD/libguestfs-1.16.5/perl/Guestfs.xs:5990: example_assign: Assigning: "r" = return value from "guestfs_internal_autosync(g)".
    /builddir/build/BUILD/libguestfs-1.16.5/perl/Guestfs.xs:5991: example_checked: "r" has its value checked in "r == -1".
    /builddir/build/BUILD/libguestfs-1.16.5/python/guestfs-py.c:13702: example_assign: Assigning: "r" = return value from "guestfs_internal_autosync(g)".
    /builddir/build/BUILD/libguestfs-1.16.5/python/guestfs-py.c:13707: example_checked: "r" has its value checked in "r == -1".
    /builddir/build/BUILD/libguestfs-1.16.5/ruby/ext/guestfs/_guestfs.c:16000: example_assign: Assigning: "r" = return value from "guestfs_internal_autosync(g)".
    /builddir/build/BUILD/libguestfs-1.16.5/ruby/ext/guestfs/_guestfs.c:16001: example_checked: "r" has its value checked in "r == -1".
    /builddir/build/BUILD/libguestfs-1.16.5/src/guestfs.c:191: check_return: Calling function "guestfs_internal_autosync" without checking return value (as is done elsewhere 5 out of 6 times).
    /builddir/build/BUILD/libguestfs-1.16.5/src/guestfs.c:191: unchecked_value: No check of the return value of "guestfs_internal_autosync(g)".

commit 10f240a07f156493eb0540a95f9a3deba36c6862
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 8 13:13:24 2012 +0000

    tests/md: Number the errors so we can easily see which test fails.

commit 5503d95e1b340de38b77b0d5be639da72b0f88c6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 8 10:46:13 2012 +0000

    Update translations from Transifex.

commit 0fdcc76901807c103845e4ac293df5712e212fe4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 7 22:32:14 2012 +0000

    Update API support.

commit 4504f424f5589f81086f5250674b55708e162e5f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 7 19:21:14 2012 +0000

    dist: Distribute all tests, even when configured with --disable-appliance.

commit 2f126e07bbd81532147cb59a272e11bce3e6d9ed
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 7 17:36:48 2012 +0000

    Version 1.17.12.

commit cfa0f9b381b5e3639e41554e78fcd38d611ef270
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 7 18:11:08 2012 +0000

    inspection: Add detection of FreeDOS install CDs (RHBZ#786188).

commit a9510b7b22663ac27c8d59cee1bbd777468e1cac
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 7 18:09:59 2012 +0000

    inspection: Add detection of FreeDOS (RHBZ#786215).
    
    FreeDOS is returned as type="dos", distro="freedos".  No version or
    application information is returned at present.

commit 518cdb596e3d1e75e30d8df8fff5835aa2842479
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 7 17:30:48 2012 +0000

    Add 'display_icon' example program.
    
    Running this on a disk image displays the guest icon
    (using external 'display' program).

commit 4d8ae8f5a2e309a6a518fdb0b6f65685aa9137e0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 7 17:30:17 2012 +0000

    Comment change.

commit e40f408faeea204417bc46024590a07272eeda92
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 7 17:29:38 2012 +0000

    Hide stderr of bmptopng.
    
    This program is noisy on stderr.  Send that to /dev/null.

commit 2c9c0525ebda105f37e6a6eea2307db4cb2f0a73
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 7 15:07:37 2012 +0000

    build: Make netpbm and icoutils into proper optional dependencies.
    
    Netpbm and icoutils (wrestool) have always been dependencies.  Since
    they are not always present, make these into optional dependencies
    (which they were, sort of, before).
    
    Also document these dependencies in the README file.

commit b9061ddf2d337fcc42cfeae0ac8ec4e329a1a421
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 7 14:11:53 2012 +0000

    Add support for Buildroot and Cirros distributions.

commit b106dda97c9e18563bb27a44a025016fef6dec97
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 7 14:11:38 2012 +0000

    Whitespace change.

commit 3bf5d0d0e4b3fa5f26e58ad803a9e97f71c7ae0b
Author: Matthew Booth <mbooth@redhat.com>
Date:   Tue Mar 6 14:48:41 2012 +0000

    gobject: Update TODO with details of inspect_get_type fix

commit deaae550723eb3725f890256bfa08a35c671d5f0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 5 09:36:34 2012 +0000

    Version 1.17.11.

commit 715f7e28090d08c16bfdd32b0298812972c12b36
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 5 08:58:00 2012 +0000

    Remove ConfigOnly flag from set-autosync.
    
    guestfs_set_autosync sets a flag which affects guestfs_close, and so
    this call can be made at any time before the handle is closed, not
    just in the config state.

commit 705971b509e1c60419444f228825533080c4ae34
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Mar 4 14:41:37 2012 +0000

    Test header file under C++.

commit 49611f121fa10d1497e46ab9aa6a7448cb89cd86
Author: Marcin Gibula <m.gibula@e24cloud.com>
Date:   Sun Mar 4 11:54:19 2012 +0000

    Make "template" a reserved word.
    
    Function guestfs_mkdtemp uses c++ keyword "template" as a parameter
    name. In result, attempt to use guestfs.h header in c++ program
    results in compile error.

commit b11e9f49191c244ddc27ae663505e6fb89dbdcd7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 3 18:41:01 2012 +0000

    Version 1.17.10.

commit 3b78b3a8496cdd66567b6f433206273966858e74
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 3 18:40:42 2012 +0000

    ruby: Use RbConfig instead of Config.
    
    I have checked, and this works with Ruby 1.8 as well.

commit 5e8a4627d9f0d313485f186a63dc2250f6fd5c01
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 3 16:58:48 2012 +0000

    Add a 'fixed' style of appliance.
    
    This is just the 'kernel', 'initrd' and 'root' files, copied from one
    machine to another, along with a 'README.fixed' file which is also
    used for identification.
    
    This allows the appliance to be copied from one machine to another,
    making it easier for us to distribute a starter appliance for people
    who cannot get febootstrap or appliance-building working.

commit 49726b9269490e331e740d55952da87552ca2500
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 3 16:58:05 2012 +0000

    Rebrand 'ordinary appliance' as 'old-style appliance'.
    
    This is just code motion.

commit ba468e9c5ecb32046299dd69a6e045f2aa7ba982
Author: Nikos Skalkotos <skalkoto@gmail.com>
Date:   Thu Mar 1 21:00:36 2012 +0200

    Test fails in arch linux
    
    --20cf303ea4a84a7a7c04ba331375
    Content-Type: text/plain; charset=ISO-8859-1
    
    Hello Richard,
    
    I found what the problem was and the udev symlinks where not created. The
    init script in the appliance uses a full paths for udevadm (/sbin/udevadm)
    which in my case was wrong. In Arch Linux udevadm is hosted under /usr/bin,
    not /sbin. When I fixed this, libguestfs was able to communicate with the
    appliance VM.
    
    Since PATH variable is defined and exported in init, there is no need in
    using full paths for external programs. As far as I've seen this affects
    all the git branches in libguestfs's repository. Please find attached a
    patch for the master branch.
    
    Nikos Skalkotos,
    Athens, Greece
    
    On 24 February 2012 10:25, Richard W.M. Jones <rjones@redhat.com> wrote:
    
    > On Thu, Feb 23, 2012 at 08:50:12PM +0200, Nikos Skalkotos wrote:
    > [...]
    >
    > I don't know specifically why it fails with ArchLinux, but the problem
    > is caused by the /dev/virtio-ports/* symlinks not getting created by
    > udev.
    >
    > /dev/vport0p1 exists:
    >
    > > crw------- 1 root root 252,   1 Feb 23 18:17 vport0p1
    >
    > but udev doesn't make the corresponding /dev/virtio-ports symlink:
    >
    > > /dev/virtio-ports/org.libguestfs.channel.0: No such file or directory
    >
    > The symlink is supposed to be created by this udev rule:
    >
    > /lib/udev/rules.d/50-udev-default.rules:KERNEL=="vport*",
    > ATTR{name}=="?*", SYMLINK+="virtio-ports/$attr{name}"
    >
    > So I'd start by looking to see if that rule exists in the udev rules
    > that Arch is using.  Secondly if it does exist, is the corresponding
    > *.rules being copied into the appliance?  (Check appliance/supermin.d/
    > hostfiles)
    >
    > In an old Ubuntu that has udev that predates having this rule, we add
    > the following patch:
    >
    >
    > http://libguestfs.org/download/binaries/ubuntu1004-packages/0002-ubuntu-10.04-Use-dev-vport0p1.patch
    >
    > Rich.
    >
    > --
    > Richard Jones, Virtualization Group, Red Hat
    > http://people.redhat.com/~rjones
    > virt-p2v converts physical machines to virtual machines.  Boot with a
    > live CD or over the network (PXE) and turn machines into Xen guests.
    > http://et.redhat.com/~rjones/virt-p2v
    >
    
    Hello Richard,<br><br>I found what the problem was and the udev symlinks where not created. The init script in the appliance uses a full paths for udevadm (/sbin/udevadm) which in my case was wrong. In Arch Linux udevadm is hosted under /usr/bin, not /sbin. When I fixed this, libguestfs was able to communicate with the appliance VM.<br>
    <br>Since PATH variable is defined and exported in init, there is no need in using full paths for external programs. As far as I&#39;ve seen this affects all the git branches in libguestfs&#39;s repository. Please find attached a patch for the master branch.<br>
    <br>Nikos Skalkotos,<br>Athens, Greece<br><br><div class="gmail_quote">On 24 February 2012 10:25, Richard W.M. Jones <span dir="ltr">&lt;<a href="mailto:rjones@redhat.com">rjones@redhat.com</a>&gt;</span> wrote:<br><blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex">
    On Thu, Feb 23, 2012 at 08:50:12PM +0200, Nikos Skalkotos wrote:<br>
    [...]<br>
    <br>
    I don&#39;t know specifically why it fails with ArchLinux, but the problem<br>
    is caused by the /dev/virtio-ports/* symlinks not getting created by<br>
    udev.<br>
    <br>
    /dev/vport0p1 exists:<br>
    <div class="im"><br>
    &gt; crw------- 1 root root 252,   1 Feb 23 18:17 vport0p1<br>
    <br>
    </div>but udev doesn&#39;t make the corresponding /dev/virtio-ports symlink:<br>
    <div class="im"><br>
    &gt; /dev/virtio-ports/org.libguestfs.channel.0: No such file or directory<br>
    <br>
    </div>The symlink is supposed to be created by this udev rule:<br>
    <br>
    /lib/udev/rules.d/50-udev-default.rules:KERNEL==&quot;vport*&quot;, ATTR{name}==&quot;?*&quot;, SYMLINK+=&quot;virtio-ports/$attr{name}&quot;<br>
    <br>
    So I&#39;d start by looking to see if that rule exists in the udev rules<br>
    that Arch is using.  Secondly if it does exist, is the corresponding<br>
    *.rules being copied into the appliance?  (Check appliance/supermin.d/<br>
    hostfiles)<br>
    <br>
    In an old Ubuntu that has udev that predates having this rule, we add<br>
    the following patch:<br>
    <br>
    <a href="http://libguestfs.org/download/binaries/ubuntu1004-packages/0002-ubuntu-10.04-Use-dev-vport0p1.patch" target="_blank">http://libguestfs.org/download/binaries/ubuntu1004-packages/0002-ubuntu-10.04-Use-dev-vport0p1.patch</a><br>
    
    <br>
    Rich.<br>
    <span class="HOEnZb"><font color="#888888"><br>
    --<br>
    Richard Jones, Virtualization Group, Red Hat <a href="http://people.redhat.com/%7Erjones%0Avirt-p2v" target="_blank">http://people.redhat.com/~rjones<br>
    virt-p2v</a> converts physical machines to virtual machines.  Boot with a<br>
    live CD or over the network (PXE) and turn machines into Xen guests.<br>
    <a href="http://et.redhat.com/%7Erjones/virt-p2v" target="_blank">http://et.redhat.com/~rjones/virt-p2v</a><br>
    </font></span></blockquote></div><br>

commit d6f736ab1836d84f329b3fa2af8b7685b4b85dde
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Wed Feb 29 14:37:37 2012 +0800

    virt-sysprep: add the hostname and net_hwaddr support for rhel
    
    Add the support for rhel.
    Change the hostname and delete the HWADDR for rhel.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 48a5cb2a2c150ad74203479d3f96a8066241d309
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 28 10:31:23 2012 +0000

    Version 1.17.9.

commit 88ba4da4d6c07762fc95c96ea67019f0ebf4677c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 28 10:25:26 2012 +0000

    resize: Fix --output-format flag (RHBZ#798196).
    
    Update the test to use the --format and --output-format flags.

commit a93d4a9dc1aea6940886c85d4b09f21cbfc80969
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 27 19:39:11 2012 +0000

    resize: Document steps to avoid UNMOUNTABLE_BOOT_VOLUME BSOD (RHBZ#797986).
    
    (Thanks Grant Williamson for finding and fixing this problem)

commit d1711dae9dbd7f516469f88807604894c1304228
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 27 14:05:38 2012 +0000

    New API: set-label, for setting a label on any filesystem.
    
    Currently only ext2/3/4 and (newly) NTFS are supported.
    
    This change also deprecates set-e2label.

commit e567f064e235f23ef709d4ed52834fb2135c6956
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 27 12:00:57 2012 +0000

    New APIs: ntfsclone-in, ntfsclone-out.

commit 51aa51884e8dfa22b489e958743bf8f3ac3785cc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 27 11:13:45 2012 +0000

    New API: ntfsfix for fixing problems on NTFS.
    
    Note this is not a "chkdsk" equivalent tool.

commit 2e788ca45eddc4c6fdb4a3ac5fa6f74c54c98437
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 27 10:51:45 2012 +0000

    Update TODO.

commit b5cc1fa04996b6bde06d78fade52bedefceed782
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Sat Feb 25 10:02:20 2012 +0800

    set-smp: limit the number of cpus below 255
    
    Limit the number of cpus below 255, since qemu can't support.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 9e5c0b39c6b598a733a790d73d27eae491910a22
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Thu Feb 23 23:41:53 2012 +0800

    Add a flag to make some functions called only at CONFIG state (RHBZ#796520).
    
    Add a flag "ConfigOnly" to make sure that some non-daemon functions
    should be called only at CONFIG state (RHBZ#796520).
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit db2cb21a8508e83daa2530df66c06dea0930071c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 15 20:58:47 2012 +0000

    Version 1.17.8.

commit 5fa7aace200a49961173de6316a81e239987c179
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 15 19:25:52 2012 +0000

    sysprep: Try unmounting the filesystem a few times when busy.
    
    tracker-miner-fs jumps into newly mounted filesystems.  This prevents
    the filesystem from being unmounted, so retry a few times.

commit afed7e493dcd594620f19b93e9fb73e58553f60a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 15 16:54:05 2012 +0000

    appliance: Make appliance building thread-safe (RHBZ#790721).
    
    Appliance building can be called from multiple processes, but this is
    only safe if each process holds a lock on the 'checksum' file.
    However threads within a process are not excluded by a file lock, and
    so this strategy completely failed for a multithreaded program calling
    guestfs_launch in parallel.
    
    Since it makes no sense for threads in a single program to race each
    other to try to create the appliance, add a lock around appliance
    building.
    
    This serialises building the appliance, but the rest of guestfs_launch
    (eg. starting up qemu) can run in parallel.

commit c9ea94810e2f7a5fcce2a7136eb07ce795f49c53
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 15 10:40:57 2012 +0000

    tests: Test parallel launch from multiple threads.

commit 6a70cb337cff736831b51bbc9c4331785d756c20
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 15 10:39:50 2012 +0000

    test-user-cancel: Add \n to fprintf error messages.

commit 84a4160fd30c46575b93f87f6ffc7cc556b0af93
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 13 14:44:03 2012 +0000

    Version 1.17.7.

commit cd06ddf4422a31528f4a268dad813938947e1a0d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 13 13:48:02 2012 +0000

    tests: Add a regression test for RHBZ#789960.
    
    Test all the ways that the 'mount' command can fail.  Ensure that none
    of them result in failures or desynchronization.

commit 1b15e543a8efee027451dcfb68743d35eda95dfc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 13 13:46:40 2012 +0000

    regressions: One test is not being run.
    
    rhbz727178.sh exists, but historically was never added to the list of
    tests, so it doesn't run.  Create a special variable for this test and
    ensure it is added to EXTRA_DIST.
    
    Test was originally added in
    commit d7356a2801130907997acd5c7502e8417566e782.

commit 07081591cf9928454148db84828da8a7f39b6c6f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 13 13:44:18 2012 +0000

    daemon: Return error properly when user tries to mount appliance root (RHBZ#789960).
    
    In the case where the caller attempts to mount the "hidden"
    appliance root device (eg. /dev/vdb if /dev/vda is the only
    normal block device added), we were calling reply_with_error
    but not actually returning immediately, resulting in protocol
    desynchronization.
    
    This commit fixes this obvious mistake.

commit ba443ae0486ae30ea597c4e126de63371f8fa7a8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 13 08:58:04 2012 +0000

    daemon: Don't xdr_free uninitialized args struct on error paths.
    
    For stubs of functions that had arguments, code did this:
    
    static void
    mount_stub (XDR *xdr_in)
    {
      int r;
      struct guestfs_mount_args args;
    
      if (optargs_bitmask != 0) {
        //...
        goto done;
      }
      // possibly other tests here
    
      memset (&args, 0, sizeof args);
    
      [...]
    
    done:
      xdr_free ((xdrproc_t) xdr_guestfs_mount_args, (char *) &args);
      return;
    }
    
    This caused xdr_free to be called on uninitialized 'args' struct,
    causing a segfault.
    
    The fix is to add another label, so the code looks like:
    
    static void
    mount_stub (XDR *xdr_in)
    {
      int r;
      struct guestfs_mount_args args;
    
      if (optargs_bitmask != 0) {
        //...
        goto done_no_free;
      }
      // possibly other tests here
    
      memset (&args, 0, sizeof args);
    
      [...]
    
    done:
      xdr_free ((xdrproc_t) xdr_guestfs_mount_args, (char *) &args);
    done_no_free:
      return;
    }
    
    This fixes commit 330fbea5b2d6bd7db84f7ea7afe87cf1bcd438e0
    and commit 0344248af55802bbbd816b349ec1ba9305996f6e.

commit c8a11468c4dc761acdcb9b184d345bafe1b5114d
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Sun Feb 12 12:35:26 2012 +0100

    Do not run test-virt-format.sh if appliance has not been built

commit 9403c5516fed43fabf5ac361eee4fbd622d54989
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 10 09:31:49 2012 +0000

    Version 1.17.6.

commit badf2d6c4d2c2a3e12bad4dcbd5854401156bb5f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 10 10:49:37 2012 +0000

    virt-format: Add a test.

commit 7c21e49c2c83092e9fd5f40c43a03c764a6d3663
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 10 10:32:55 2012 +0000

    fish: edit: Preserve permissions, UID, GID, SELinux context when editing files (RHBZ#788641).

commit ddae5abf80f65fc149eec253f14f073d397b49c2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 10 10:12:45 2012 +0000

    fish: In edit command, upload to a new file.
    
    If the upload fails, this means we don't leave a partially
    written file.
    
    Also add a test for the edit command.

commit ca80e4490463d646de4504fc2bcb4e4a722bedb8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 10 09:31:34 2012 +0000

    fish: Refactor error handling in the 'edit' command.
    
    This is just code motion.

commit ac58ddcd1ab3468134baa1f76df6e044a6d60363
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 10 11:26:54 2012 +0000

    wipefs: Fix documentation.
    
    This fixes commit a2b3e0900ee14e5a49d526c24e22edefc3030f99.

commit 39625b59ee5aeecfb855575abb939934216eeff2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 10 10:06:08 2012 +0000

    ocaml: Ensure bindings are recompiled whenever there is an API change.

commit df3c6acacdedd4e158ae8ca8bb7c175ab4170147
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 10 09:55:51 2012 +0000

    wipefs: Include "optgroups.h".
    
    This fixes commit a2b3e0900ee14e5a49d526c24e22edefc3030f99.

commit 088546af9dd7574ed74d19989b24ddbb2eb122e4
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Fri Feb 10 17:10:03 2012 +0800

    virt-format: erase the filesystem signatures before erase partitions
    
    erase the filesystem signatures on each device, then erase
    the partitions, avoid to list all the partitions here.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit a2b3e0900ee14e5a49d526c24e22edefc3030f99
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Fri Feb 10 17:10:02 2012 +0800

    NEW API: add a new api wipefs
    
    Add the new api wipefs to erase the filesystem signatures
    on a device but now erase any data.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 6ca8a2db6d6f1028a35ece616af44538074483fc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 8 20:54:55 2012 +0000

    docs: Note that JRuby should use the Java bindings.

commit a915d78ef9bccc88a12d63a2c863a3030ee9300e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 8 18:16:19 2012 +0000

    New API: llz: This runs ls -laZ and is useful for showing SELinux contexts.

commit 24d7889eba3eb6ee2f37ed9d384aa8734ebad7b7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 8 18:05:29 2012 +0000

    edit: Preserve file permissions, UID, GID, SELinux context on edited files. (RHBZ#788641)

commit 016ae77e6c2331560a3716ea1ebae82f122b4909
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Thu Feb 2 21:54:10 2012 +0100

    java: Make use of JAR_INSTALL_DIR, JNI_INSTALL_DIR

commit 2cbf5ea543f0b1b23c5b716425f4f984e956a81f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 8 14:03:19 2012 +0000

    Version 1.17.5.

commit f504cb02e1e8ef394287ddbaaad2fb1ec04bc33f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 8 14:34:51 2012 +0000

    findfs: Remove /run/blkid/blkid.tab.
    
    See this util-linux commit:
    https://github.com/karelzak/util-linux/commit/b82590ad46acf9fe8d332b53875e24c3c31e2482

commit 518edc506fbdd66dcdd5a558cd086cfa296585a2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 8 14:02:51 2012 +0000

    extra-tests: Add suppression for uninitialized memory bug in latest glibc.

commit 0559f038ada850f627529ece97f5a4e8721a7ecd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 8 14:02:14 2012 +0000

    extra-tests: libnl moved from /lib64 to /usr/lib64 on Fedora.
    
    Update suppressions file to match.

commit 825b5e65c094396154594fcb31db59fe51867a33
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 7 08:13:50 2012 +0000

    perl: Ignore perl/MYMETA.json

commit 21a9efcad5379cbfcc2404142472ec5efda4aaa0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 6 18:27:51 2012 +0000

    blockdev, parted: Call udev_settle before and after commands. (RHBZ#769304)
    
    See comments in the code for details.
    
    This is an alternate fix to
    commit a9c8123c72db47bcab8dd738e8d5256a9ae87f11.

commit a98170e0e255021481cd428ee12d0858a59a875b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 6 18:24:52 2012 +0000

    Revert "daemon: Run udev_settle after pwrite-device finishes."
    
    This reverts commit a9c8123c72db47bcab8dd738e8d5256a9ae87f11.

commit 3c9ef0e9780443d28a078c49bab80cb13e5608ae
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 6 15:45:45 2012 +0000

    build: Choose a virtual directory for the daemon which is not a symlink.
    
    Check /sbin, /usr/sbin, /bin and /usr/bin to ensure that neither the
    directory nor the parent (eg. /usr) is a symlink, and use this
    directory for the virtual directory used to store guestfsd in the
    appliance.

commit 590d8c3c3732c603cfb1d2180190a02df528e5ed
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 3 20:57:28 2012 +0000

    build: Remove 'run' from EXTRA_DIST.
    
    This file shouldn't be included in the tarball as it contains
    hard-coded paths from the maintainer's machine which cannot be
    relevant to the target machine.

commit b7a7ad1d113e4c7d302d1e06592e268cdb1b59df
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 1 17:36:19 2012 +0000

    Version 1.17.4.

commit 330fbea5b2d6bd7db84f7ea7afe87cf1bcd438e0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 1 12:18:35 2012 +0000

    Clarify the error message when unavailable functions are called (RHBZ#679737).
    
    Callers are supposed to use the availability API to check for
    functions that may not be available in particular builds of
    libguestfs.  If they don't do this, currently they tend to get obscure
    error messages, eg:
    
      libguestfs: error: zerofree: /dev/vda1: zerofree: No such file or directory
    
    This commit changes the error message to explain what callers ought to
    be doing instead:
    
      libguestfs: error: zerofree: feature 'zerofree' is not available in this
      build of libguestfs.  Read 'AVAILABILITY' in the guestfs(3) man page for
      how to check for the availability of features.
    
    This patch makes the stubs check for availability.  The stub code
    changes to:
    
      static void
      zerofree_stub (XDR *xdr_in)
      {
      [...]
    
        /* The caller should have checked before calling this. */
        if (! optgroup_zerofree_available ()) {
          reply_with_error ("feature '%s' is not available in this\n"
                            "build of libguestfs.  Read 'AVAILABILITY' in the guestfs(3) man page for\n"
                            "how to check for the availability of features.",
                            "zerofree");
          goto done;
        }
      [...]

commit 90d6386c13edcb479113889bbd3cedf83c2e6277
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Tue Jan 31 18:19:31 2012 +0800

    examples: code cleanups
    
    do a code cleanup by removing the tailing spaces
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit d60d5c091f46dda8399ce2af1b6e5920bd5fb819
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Mon Jan 30 15:22:53 2012 +0800

    guestmount: use O_ACCMODE instead of hard coding
    
    Change hard code 3 to O_ACCMODE.
    it'll be more sensible.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 0042898880167f93c5e64d76008ab07bd0aa9485
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Mon Jan 30 14:36:05 2012 +0800

    guestmount: remove tailing spaces
    
    just do a cleanup.
    remove the tailing spaces.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit e3f15780c8197a66bfb620b802ba18d0ba0dd2ce
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 30 10:47:47 2012 +0000

    daemon: Fix crash in aug-defnode (RHBZ#785668).

commit 6e703c1316548e42b5133ba508fe0e7d090ac3d0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 28 19:14:57 2012 +0000

    virt-alignment-scan: Fix typo in man page (thanks yurchor).

commit 03684e7a616eab56a81665c8c8859426e50ae429
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 28 17:35:34 2012 +0000

    ocaml: Various fixes for bytecode compilation.
    
    Set LD_LIBRARY_PATH so we link against the just-built library, not
    the installed library.
    
    Use OCAMLCFLAGS instead of OCAMLOPTFLAGS where appropriate.
    
    Remove unnecessary -cclib option for bytecode linking (gcc is not used
    in this case).
    
    This fixes commit eb68a314133c88260cdf4547d7d338446488e698.

commit a3ac2cc788c9c08b13a03799e8d62ebd52be8a57
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 28 10:24:36 2012 +0000

    Version 1.17.3.

commit d33c70fd6417c71b8965a088355dcc9e2ade51f7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 28 10:24:18 2012 +0000

    ocaml: Sort the tests.

commit 8fd5a377b8521d53f56b66136d686a31c7e302b6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 28 10:23:57 2012 +0000

    extra-tests: ocaml: Additional suppressions so we can test bytecode.

commit eb68a314133c88260cdf4547d7d338446488e698
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 27 22:11:53 2012 +0000

    ocaml: Test bytecode and native code bindings.
    
    Compile each test twice, as bytecode and native code, and
    test both.

commit 799852e64691068f3256c27d18870bdb2537c2be
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 27 21:48:35 2012 +0000

    ocaml: Fix bytecode bindings for functions with >= 6 args.

commit 7972b1da8121e3f9c98865f00fc6115d9aff2754
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 27 18:43:07 2012 +0000

    Update to latest gnulib.
    
    This contains a workaround for stdalign bug:
    http://lists.gnu.org/archive/html/bug-gnulib/2012-01/msg00340.html
    http://gcc.gnu.org/bugzilla/show_bug.cgi?id=52023
    
    (Thanks Paul Eggert).

commit 8f564ae7a2fb0f170308bd103a6be0a981583b1c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 27 15:36:31 2012 +0000

    appliance: udev >= 176 now requires /dev to be a devtmpfs.
    
    See this udev commit:
    https://git.kernel.org/?p=linux/hotplug/udev.git;a=commitdiff;h=220893b3cbdbf8932f95c44811b169a8f0d33939

commit d5bc69e54579013dc46c2f16d7bf82a10082a83a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 26 16:03:39 2012 +0000

    Version 1.17.2.

commit 93e443ccad74305c41c925f64063ef451db8fa08
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 26 17:05:25 2012 +0000

    build: Add gobject/TODO.txt to EXTRA_DIST.
    
    This updates commit dd25638fc14ea63cf8e8eb0940173f1c6952447f.

commit de00aa84afcdb72ac096d17a290d6f46fc217e4f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 26 17:04:16 2012 +0000

    build: Add contrib/make-check-on-installed.pl to EXTRA_DIST.
    
    This updates commit 3d0c9f3fc63395083fef798ee31058a0bea8432e.

commit 3d0c9f3fc63395083fef798ee31058a0bea8432e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 26 13:36:05 2012 +0000

    contrib: Add a script for running test suite on installed packages.

commit 0a4d1810634b9c329f7e4d5f0b2116dd479c5fe1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 26 12:24:11 2012 +0000

    contrib: Delete 'removed' sections from the README file.
    
    There is no point in continuing to document removed stuff.

commit 09227c9d664ca21b47b65c2fcd8fa2ddc485b554
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 26 14:55:10 2012 +0000

    fish: Fix 'test-guestfish-escapes.sh' when running an alternate guestfish binary.
    
    The error messages would be prefixed by the path to the
    alternate binary, eg:
    
    ../fish/guestfish: invalid escape sequence in string (starting at offset 0)
    
    Fix this by normalizing the messages further.

commit 9f8e9dcc703759ff1f7413ebf75b90ca20e3acb4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 26 13:48:59 2012 +0000

    ocaml: Don't install bindtests.*.

commit b1ace6738177481276dce05bf1d2597bb67f2a80
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 26 13:35:38 2012 +0000

    ocaml: Don't install libguestfsocaml.a.

commit dd25638fc14ea63cf8e8eb0940173f1c6952447f
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Jan 26 11:55:43 2012 +0000

    gobject: Add a TODO list

commit 8bad4d1c4765fd997511a505cdb2a860148ae16d
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Jan 25 15:10:01 2012 +0000

    gobject: Add an explicit close call
    
    This change binds guestfs_close(). It consequently results in RConstOptString
    being able to throw an error.

commit 6568dd85f4aef705e7cf5c4301bc3b8f7119efd2
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Jan 25 13:17:39 2012 +0000

    gobject: Allow RConstOptString to return an error
    
    RConstOptString cannot return an error in the C api. This makes it a special
    case for the GObject api, as all other return types have a corresponding GError
    **err argument to return an error. This change removes this special case, and
    includes the possibility of an error return in the API. An error is indicated by
    setting *err to a non-NULL value.
    
    This change is in preparation for adding a close api. An attempt to call any
    api, even RConstOptString, on a closed handle must return an error.

commit 501561742b43edb044072ec85048bb35b0b8201a
Author: Jiri Popelka <jpopelka@redhat.com>
Date:   Wed Jan 25 17:16:56 2012 +0000

    appliance: Switch to using 'iproute' ('ip' command) from 'net-tools' (RHBZ#784647).
    
    Change 'ifconfig' and 'netstat' commands to use 'ip' instead.
    
    'iproute' was already included in the appliance, so this reduces the
    size of the appliance accordingly.

commit 8ac53919357eae4b4f891bf2f6cb8635dd905fe3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 24 19:29:08 2012 +0000

    Version 1.17.1.

commit a05ddcd2a719f97ba036e9d6ca4e6491ed8b1fd0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 24 16:42:39 2012 +0000

    daemon: Fix use-after-free in case-insensitive-path (found by valgrind).
    
    This commit tidies up the code by splitting out the path
    element-searching code into a separate function.
    
    Valgrind found that 'closedir' frees the 'struct dirent *', which
    wasn't immediately obvious.  So now we do the 'closedir' after all
    operations which touch 'd->d_name'.

commit 9700708a19a46a61ffe53c6e648206336781477e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 24 16:42:31 2012 +0000

    daemon: Fix leaking error message (found by valgrind).

commit 86f64c37b914645afb345f96af13ad843ec641b1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 24 16:42:13 2012 +0000

    daemon: Close inotify handle on exit.

commit 94a7fb9fc5d04615f23f94c34eb90c35d20ba117
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 24 16:42:05 2012 +0000

    daemon: Close augeas handle on exit.

commit ff2e685828ce6160de34756696069b80e35472e8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 24 16:39:02 2012 +0000

    daemon: Fix leak of strings in md-detail (found by valgrind).

commit 4c2101362edf5f2df5d018c3674b423de2a3538a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 24 16:38:04 2012 +0000

    daemon: md: Whitespace changes, and use size_t for i instead of pointer.
    
    This is just a code clean-up with no functional change.

commit aa978b75ae1df0d3111953114fafe0854c3f222e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 24 15:14:07 2012 +0000

    daemon: Fix leak of strings in blkid (found by valgrind).

commit 43a6974cb35759d4772f610f3c92b0d31f0503ac
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 24 15:13:32 2012 +0000

    daemon: blkid: Whitespace changes, and use size_t for i instead of pointer.
    
    This is just a code clean-up with no functional change.

commit f86c3a45ae19f5bb558ab9ead255ecaf004b24b0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 24 15:12:27 2012 +0000

    daemon: Return value from write syscall is ssize_t, not int.

commit 9f8f1fd8560f2c3e7b625cf6d65a052cd061fd2e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 24 15:12:01 2012 +0000

    daemon: Don't leak 'cmdline' (found by valgrind).

commit f65f653ab1541400afe2f796ab1b20cd721e769d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 24 15:11:21 2012 +0000

    daemon: Length of message is a 32 bit unsigned quantity.

commit 9cf7ecbe4fea5162b86e2c78c1a40cca737bc1da
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 24 15:10:43 2012 +0000

    daemon: Fix use of uninitialized stack data (found by valgrind).
    
    This uninitialized data was also sent over the protocol,
    potentially being a serious information leak.

commit 84242a8d0bf9c37e700cd8a3436607dbc7908f1e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 24 15:09:02 2012 +0000

    daemon: Fix memory leak in 'initrd-cat' (found by valgrind).

commit d08806adfc5d111b4b6c761540ff508d3f25b66e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 24 13:47:25 2012 +0000

    Enable running the daemon under valgrind.
    
    This commit allows you to run the daemon under valgrind.  You have to
    enable it at configure time:
    
      ./configure --enable-valgrind-daemon
    
    This should *not* be done for production builds.
    
    When this feature is enabled, valgrind is added to the appliance and
    the daemon is run under valgrind.  Log messages from valgrind are
    passed back over a virtio-serial channel into a file called
    'valgrind.log.$PID' in the top build directory.
    
    Running 'make check', 'make extra-tests' etc causes many
    valgrind.log.* files to be created which must be examined by hand.

commit b7122eaa58ccd153a8c39bc3b6f890755c5df089
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Mon Jan 23 23:17:37 2012 +0100

    resize, sparsify: find progress mini-library in out-of-tree builds (2)

commit 22224254fa4676735985818d2ff3c8feafe4457c
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Mon Jan 23 23:16:37 2012 +0100

    Fix --{en,dis}able-install-daemon
    
    This fixes...
    
        configure: error: conditional "INSTALL_DAEMON" was never defined.
    
    ... when specifying --disable-daemon

commit 734b1f662f4e563cc8baad3aca8cf751314e0e49
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 23 15:32:30 2012 +0000

    API support: Fix src/api-support/added file.
    
    This fixes commit 37e07db1598b433c12ee643302712d81b2c5415d.

commit 51c199ca6f31711198c6e501cd30411693fa5200
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 23 15:04:10 2012 +0000

    Version 1.17.0.

commit b1f188e24b16d3175c8c5a4264559be1cfdd57ae
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 23 13:42:43 2012 +0000

    Update ROADMAP.

commit 7caa81ab9da1555f6679e7f3f339a2a9c8b41831
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 23 13:34:32 2012 +0000

    Finalize RELEASE NOTES.

commit 61dc072a8b3d4f9e5a32a3a28acc59e2d1864a99
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 23 13:19:22 2012 +0000

    Pull translations from Transifex.

commit fd3e3ca18863650a16c10d4ef5e66b7153c2b08a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 23 12:18:13 2012 +0000

    debian: Debian 6 blkid has -p but not -i.
    
    Fix the existing test to work correctly in this case.
    
    Other cleanups.

commit abc17351adfd5b707098e2ee36dd6104b29622bb
Author: Matthew Booth <mbooth@redhat.com>
Date:   Mon Jan 23 10:42:27 2012 +0000

    gobject: Require minimum gobject library version of 2.26.0
    
    The GObject bindings require G_DEFINE_BOXED_TYPE, which was not added until
    2.25.15. There are probably other dependencies.

commit 6edecdec59336fbf737abce8cdf2f76ee2d7ffb4
Author: Jim Meyering <jim@meyering.net>
Date:   Mon Jan 23 11:35:55 2012 +0100

    maint: use $var notation rather than ${var} when possible
    
    I noticed some uses of ${srcdir} in shell scripts.
    That is almost always better written as $srcdir.
    The patch below converts most such variable references.
    Here are the few remaining candidates:
    
    $ git grep -i -E '\$\{[a-zA-Z_0-9]+\}'|grep -v Makefile.in.in
    configure.ac:        JAR_INSTALL_DIR=\${prefix}/share/java
    configure.ac:        JNI_INSTALL_DIR=\${libdir}
    debian/rules:   for TEST in ${DEBIAN_SKIP_TEST}; do \
    debian/rules:#          mv $${mod} $$(dirname $${mod})/libguestfsmod.so; \
    java/Makefile.am:libguestfs_jar_DATA = libguestfs-${VERSION}.jar
    java/Makefile.am:libguestfs-${VERSION}.jar: $(libguestfs_jar_class_files)
    perl/lib/Sys/Guestfs/Lib.pm:                      "-f", '${Package} ${Version} ${Architecture} ${Status}\n',
    perl/typemap:            croak (\"${Package}::$func_name(): called on a closed handle\");
    perl/typemap:        croak (\"${Package}::$func_name(): $var is not a blessed HV reference\");
    tests/data/Makefile.am:   echo "$${i}abcdefghijklmnopqrstuvwxyz"; \
    
    We could change all of those, too, except the ones in configure.ac
    and Makefile.am, since they refer to Make variables.  Even those
    should be changed, but to use the preferred Makefile notation:
    $(prefix), $(libdir), $(VERSION).
    
    >From a86770ecd45666232a94d76c8725c8f9b1c76e3a Mon Sep 17 00:00:00 2001
    From: Jim Meyering <meyering@redhat.com>
    Date: Mon, 23 Jan 2012 11:15:12 +0100
    Subject: [PATCH libguestfs] maint: use $var notation rather than ${var} when
     possible
    
    The only case to avoid in a shell script is when the byte after the
    "}" is word-constituent, and concatenating it would thus change the
    name of the variable.
    
    These changes were induced by running this command:
      git grep -l -i -E '\$\{(srcdir|md)' \
        |xargs perl -pi -e 's/\$\{(srcdir|md)\}($|\w)/\$$1$2/gi'
    
    The "g" was needed because there was one line with two instances.
    The "i" is to handle ${SRCDIR}.  The ($|\w) ensures that concatenating
    whatever follows the "}" won't change semantics.
    
    * gobject/run-bindtests: Use "$srcdir", not "${srcdir}".
    * haskell/run-bindtests: Likewise.
    * java/run-bindtests: Likewise.
    * ocaml/run-bindtests: Likewise.
    * perl/run-bindtests: Likewise.
    * python/run-bindtests: Likewise.
    * ruby/run-bindtests: Likewise.
    * tests/guests/guest-aux/make-debian-img.sh: Likewise, but $SRCDIR.
    * tests/guests/guest-aux/make-ubuntu-img.sh: Likewise.
    * tests/guests/guest-aux/make-windows-img.sh: Likewise.
    * tests/md/test-mdadm.sh: Likewise, but $md.

commit 37e07db1598b433c12ee643302712d81b2c5415d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 23 10:35:24 2012 +0000

    Update API support.

commit 3a754cc88fca72db8bb2f8e6c83df13491f25ff0
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Mon Jan 23 09:48:37 2012 +0000

    gobject: Run bindtests from srcdir.

commit 70070cf24420bee01770da2897d2ca32e3183181
Author: Jim Meyering <jim@meyering.net>
Date:   Mon Jan 23 10:03:14 2012 +0100

    build: don't use automake-internal variable
    
    Hi Rich,
    
    I realized a day or two late that my suggestion was not quite right.
    Here's the fix:
    
    >From 5294c21cf07c4ec2f094182ba9f32696f3de2751 Mon Sep 17 00:00:00 2001
    From: Jim Meyering <meyering@redhat.com>
    Date: Mon, 23 Jan 2012 10:01:40 +0100
    Subject: [PATCH libguestfs] build: don't use automake-internal variable
    
    * ocaml/Makefile.am (mlguestfs.cma): Use the documented variable form,
    $(libguestfsocaml_a_OBJECTS), not the $(am_libguestfsocaml_a_OBJECTS)
    that I suggested for commit 1.15.16-17-g8b9eaec.

commit 7fbf0cc4993908d143ac9ea1005815863f222062
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Fri Jan 20 08:44:46 2012 +0100

    check for febootstrap etc. even if not building appliance

commit d4f79584875381af0d07d29eba1f9f80603e27ff
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Sat Jan 21 22:32:45 2012 +0100

    fish: Filter out error messages about history file in test script

commit b6e0552ee5359da785bd1c08cadf022190e98720
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Sat Jan 21 22:56:51 2012 +0100

    Do not run appliance-related checks if not building appliance

commit 7004fafc6989efbbb1ef46723e8a91f936f16249
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Sat Jan 21 22:39:59 2012 +0100

    Replace setting of environment variables with usage of local run script
    
    (Includes fix by RWMJ)

commit 5cfd3e7b3e1a7a4031f676d5b65392c7de113164
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jan 22 14:47:43 2012 +0000

    php: function_entry -> zend_function_entry.
    
    function_entry was left over from PHP 3.
    
    See: http://news.php.net/php.pecl.dev/7123

commit 4f868b84d6e7c387e27f50aae54476bc97a70bc2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jan 22 14:38:07 2012 +0000

    php: Enable 'make clean' in extension subdirectory.

commit 71785543325535379d9ab59fb3594ec6fe4e9309
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 21 11:19:29 2012 +0000

    Version 1.15.19.

commit 17a599ef277254775fedad91384480be969e1d8e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jan 22 11:33:01 2012 +0000

    gobject: Include bindtests-manual.js in EXTRA_DIST.
    
    This fixes commit 93b0769ec7929a909678411d75840f81bed55a81.

commit f81499fb64f4f4910dd3989ed297e1a0a143e332
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jan 22 11:01:12 2012 +0000

    gobject: Document these bindings in guestfs(3).

commit 4edd061975217e4eeb09f66b8c9ea0d3fb17edba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jan 22 11:00:58 2012 +0000

    website: Rebuild the HTML manual pages from scratch.

commit de5d416fc7b3213641b035288c1df199346e9020
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 21 11:27:35 2012 +0000

    daemon: Move internal-autosync function to new file internal.c.
    
    This is just code motion.

commit 93b0769ec7929a909678411d75840f81bed55a81
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Jan 19 16:51:01 2012 +0000

    gobject: Add bindtests for return values

commit 02ccef7684b0e0ec7c0e9435393f24b0c6b417f4
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Jan 19 16:43:20 2012 +0000

    bindtests: Test optargs in test0
    
    Note that this change disables compiling and running the haskell bindtests. The
    haskell bindings do not implement optargs, and adding optargs to test0 causes
    that method not to be bound in the haskell bindings. This prevents the haskell
    bindtests from compiling. These should be re-enabled when optargs are
    implemented.

commit e99a6a84834d924095a873514a159304091f2b1f
Author: Matthew Booth <mbooth@redhat.com>
Date:   Tue Jan 17 16:41:07 2012 +0000

    gobject: Add basic bindtests

commit cce1bbb345978ac9e1813745cfee19bb3ce661e7
Author: Matthew Booth <mbooth@redhat.com>
Date:   Tue Jan 17 15:28:01 2012 +0000

    run script: Add support for gobject introspection

commit 5c5babb40b06256d251425b10ca5cfff97907462
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Jan 4 09:42:41 2012 +0000

    gobject: Add GObject bindings

commit eb58fa9978b71448c01348c151cc002c21983c71
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Jan 20 10:55:24 2012 +0000

    generator: Add CamelName flag
    
    We can make a good guess at camel case names for most APIs. For example,
    add_drive_opts can be automatically transformed to AddDriveOpts. However, other
    apis don't produce a satisfactory name when transformed automatically. For
    example, we would want md_create to produce MDCreate rather than MdCreate.
    
    This change adds a CamelName flag which allows a camel case name to be specified
    explicitly when the automatic transformation isn't satisfactory.

commit b8720abfe56391bf5b7b624e003ab7df90f5ceb4
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Fri Jan 20 08:44:47 2012 +0100

    resize, sparsify: find progress mini-library in out-of-tree builds

commit 251c6e994de97d9e87a0ace01144c12366e12c2b
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Fri Jan 20 08:44:44 2012 +0100

    Fixed out-of-tree compilation of OCaml code after .depend files removal

commit 762d1bbda18ffd6c16980009946549384bb95526
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Fri Jan 20 08:44:42 2012 +0100

    fish: Remove hard-coded path from test script

commit 3d80161d9c277c800a3214694ba56a8909e655df
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Jan 18 17:33:42 2012 +0000

    c: Fix prototype generator when last argument is a BufferIn
    
    We were passing the name of the last argument directly to va_start. However, if
    the last argument is a BufferIn it expands to 2 arguments, the latter of which
    is <name>_size.

commit 24f01a581b0452cfc8d7239b6a556e4282b0b964
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Jan 18 16:44:10 2012 +0000

    bindtests: Add a test for RBufferOut
    
    Fixup the existing test, and add an entry in actions so it's actually generated.

commit a20b88be8364fc485d654377819e6daab303ef7a
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Jan 18 16:26:26 2012 +0000

    bindtests: Fix sscanf test in test0rhashtable

commit 7412bb342141bdfe0d44d6526728f4e1fd284fe0
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Jan 18 16:11:14 2012 +0000

    bindtests: Add something non-zero to the RStructList test output

commit 04cb1bb10627e3e3ab139d392887b8afb6a70c08
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 20 12:16:53 2012 +0000

    Update release notes with feedback from Hilko Bengen.

commit 3f6ca541c7b24d4c86688a509582cb41a7e0078c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 20 09:40:35 2012 +0000

    Revert "generator: Add CamelName flag"
    
    This reverts commit 83c20f02dc0e97b098e9de837839a3f4a4416129.

commit 1982779fa31a823f8277343c90d871553dc2450a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 19 18:41:35 2012 +0000

    Version 1.15.18.

commit 72c97e6607ba12ff590e2f27d563910537ac8fc4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 19 16:07:39 2012 +0000

    Update release notes.

commit a9c8123c72db47bcab8dd738e8d5256a9ae87f11
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 19 13:54:50 2012 +0000

    daemon: Run udev_settle after pwrite-device finishes.
    
    When you call close on any block device, udev kicks off a rule which
    runs blkid to reexamine the device.  We need to wait for this rule to
    finish running since it holds the device open and can cause other
    operations to fail, notably BLKRRPART.

commit ea3f16f6d9dd1aedc03c4438d1f01565d634ffda
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 19 13:07:30 2012 +0000

    appliance: Add psmisc package to the appliance.
    
    This allows us to use 'fuser' and other ps tools.

commit 61abcf71c05c07bfaca96666b16a0bc30a6edab4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 19 11:30:23 2012 +0000

    daemon: pwrite/pread: Don't double close on error path.
    
    In Linux, close (fd) closes the file descriptor even if it returns an
    error.

commit 08840bab44c38d0c69b5780c57b2bf370c96d58c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 18 22:05:02 2012 +0000

    Tempus fugit.
    
    Update all copyright dates to 2012.

commit d8a1389df35ddd5b6d9af86dc27c1978ea07348f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 18 21:15:37 2012 +0000

    tools: Mark obsolete tools clearly in the man pages.

commit b9b77e701421033c196d2b80559cdcd721e28570
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 18 16:09:20 2012 +0000

    Version 1.15.17.

commit 535977bff811d996bd61577e3e71af1393646951
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 18 12:48:14 2012 +0000

    lib: Use -fvisibilty=hidden by default; only ABI symbols are now visible.
    
    http://gcc.gnu.org/wiki/Visibility

commit 8b9eaec993e3199ff4ef1056abe2f18cbed1289b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 18 12:30:36 2012 +0000

    ocaml: Use automake to build the C part of the bindings.
    
    By arranging the C part of the bindings into a library, we can get
    automake to build it instead of using $(CC) directly.

commit 607784df926aeb9293dbeb346f45d93907c7ffa2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 18 10:37:47 2012 +0000

    ocaml: Don't include guestfs-internal.h directly.
    
    However since the OCaml bindings use guestfs_safe_strdup and
    guestfs_safe_memdup we need to export those two (in the private
    functions section) from <guestfs.h>.

commit db90770ec5e867cc120a9753bf928f081002c2e7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 18 12:47:49 2012 +0000

    ocaml: Add -Wno-missing-field-initializers to avoid a warning.

commit 6de1a1242e9501f8a7042d3cdd970ab9c7496823
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 17 17:34:24 2012 +0000

    New tool: virt-format: erase and make blank disks.
    
    This tool allows you to easily reformat a disk, creating a blank disk
    with optional partition, LVM and empty filesystem.

commit dd0707be5f9153a78ea0a07ec72f4e1f341a38c9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 17 18:28:44 2012 +0000

    fish options parsing: Allow add_drives to be called multiple times.
    
    Ensure that the drv structure is always zeroed on allocation.
    
    Don't leak old drv->device when add_drives is called multiple times.

commit fd1a6d8003b29eaec5230f838f673df7cd0e9c86
Author: Matthew Booth <mbooth@redhat.com>
Date:   Tue Jan 17 13:44:29 2012 +0000

    c: Allow NULL optargs to be passed to _argv calls
    
    Previously, passing NULL optargs to an _argv call resulted in a segfault. This
    change causes NULL optargs to be interpreted as no optargs, and to be correctly
    handled accordingly.

commit c7119da1306e1e04a1a35c5c2caf407e4b46d173
Author: Matthew Booth <mbooth@redhat.com>
Date:   Tue Jan 17 13:25:21 2012 +0000

    c: NFC Remove redundant parentheses

commit 3b352de1e91e6d0a5190e631159398164f4a8e0d
Author: Matthew Booth <mbooth@redhat.com>
Date:   Mon Jan 16 14:45:03 2012 +0000

    generator: Add an explicit Cancellable flag
    
    Currently any api which takes a FileIn or FileOut parameter is implicitly
    cancellable. This change make cancellable an explicit flag in anticipation of it
    being added to other apis.
    
    Note that a Cancellable function must be able to return an error, which means it
    can't return RConstOptString.

commit 83c20f02dc0e97b098e9de837839a3f4a4416129
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Jan 13 10:00:30 2012 +0000

    generator: Add CamelName flag
    
    We can make a good guess at camel case names for most APIs. For example,
    add_drive_opts can be automatically transformed to AddDriveOpts. However, other
    apis don't produce a satisfactory name when transformed automatically. For
    example, we would want md_create to produce MDCreate rather than MdCreate.
    
    This change adds a CamelName flag which allows a camel case name to be specified
    explicitly when the automatic transformation isn't satisfactory.

commit b1ea8a7808744068fe0d1306d1005e841a570b4c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 16 10:15:02 2012 +0000

    resize2fs-M: fix double-free along error path (thanks Matthew Booth).

commit 3e9f8d050a7709ef3e9ea8c6b5098bac6fc21740
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 16 10:14:38 2012 +0000

    e2fsck: Tidy up the documentation for this API.

commit 4ac5e2d2180f6cbf8c1f14b8b54f97b5a1865318
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Sat Jan 14 00:03:45 2012 +0800

    e2fsck-f: change the internal to use e2fsck
    
    Since we implement the new api e2fsck, just change the
    internal of e2fsck_f to use e2fsck now.
    v1->v2: use optargs_bitmask
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 38a0966da88da6d199eb1da37456b4c33f4901da
Author: Wanlong Gao <wanlong.gao@gmail.com>
Date:   Sat Jan 14 00:22:09 2012 +0800

    NEW API: add a new api e2fsck
    
    m: Wanlong Gao <gaowanlong@cn.fujitsu.com>
    
    Add a new api e2fsck with two options:
    correct: same as '-p' option of e2fsck
    forceall: same as '-y' option of e2fsck
    
    Thanks for Rich's idea.
    v1->v2: use optargs_bitmask
    v2->v3: change the optargs_bitmask check
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 0eaf06e673833bc25673d5c3d2487fffae310285
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Sat Jan 14 00:03:43 2012 +0800

    ext2: tweak the error returned message of resize2fs-M(BZ755729)
    
    Tweak the error message "e2fsck -f" and "e2fsck -fy".
    Indicate the user to use the correct and/or forceall options.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit f6db1ec41050e70580674ebbeb8fac5335df3284
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Jan 11 11:07:34 2012 +0000

    build: Remove .depend files from git
    
    Remove generated .depend files from source control, and don't barf when they
    don't exist while bootstrapping.

commit 9fde0fad08c5807fb442db9616fbfe202fedba8a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 11 14:03:02 2012 +0000

    Update RELEASE-NOTES.

commit 54a7982dc3a6d3cc903c8d6e73be30c46fdf90d4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 10 18:52:53 2012 +0000

    extra-tests: Only test 5 random guests.
    
    If you have a lot of guests, running extra tests takes a lot of time,
    but (arguably) you're not really doing any more detailed testing.
    
    Thus pick up to 5 guests at random to test.  A different random
    selection is done on each run, ensuring that data-driven errors (eg in
    inspection) will still be found eventually.

commit adb0050d86dd069a7ac78d7bc9e7b932b25b8f5b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 10 16:53:17 2012 +0000

    Version 1.15.16.

commit 39a10c9fabcf7646b3dcb183c22ddba577d2a075
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 10 16:51:36 2012 +0000

    Allow /dev/null to be added multiple times.
    
    Change the test for duplicate drives so that you're allowed to
    add /dev/null multiple times.  This corresponds to traditional
    usage.
    
    This amends commit be47b66c3033105a2b880dbc10bfc2b163b7eafe.

commit 01e717b3c141c509a7200b0a6c560f75815c08f2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 9 16:55:49 2012 +0000

    daemon: debug segv correct use of dereferencing NULL.

commit e0c309379556ad50d43a08b4aa4ec0146d2b60d8
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Mon Jan 9 20:53:24 2012 +0800

    launch: move the filename checking to a wrapper
    
    Move the filename's comma character checking to a wrapper.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit be47b66c3033105a2b880dbc10bfc2b163b7eafe
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Mon Jan 9 15:22:43 2012 +0800

    launch: don't add a drive twice
    
    1. Change the g->path to restore a absolute path instead of the mixed.
    2. Check that if the adding drive is duplicated with the added drive.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>
    
    RWMJ:
    
    - Make sure abs_path is NULL before it is assigned, so freeing it
      will work along the error path.
    
    - Fix the test which added /dev/null multiple times.

commit 0a7b734d2f54d4e98882532da9887feb66c9824a
Author: Matthew Booth <mbooth@redhat.com>
Date:   Mon Jan 9 10:16:35 2012 +0000

    generator: Create a separate type for optional arguments
    
    Previously, optional arguments had the same type as regular arguments, but were
    constrained by various runtime tests to be only Bool, Int, Int64 or String. This
    change makes the type of optional arguments stronger by giving them their own
    type.
    
    A convenience function, optargs_to_args is defined to convert optargs in the few
    places where they are genuinely treated identically to mandatory arguments.
    
    It also allows for future changes to optional arguments which do not affect
    mandatory arguments.
    
    RWMJ:
     - removed redundant parens
     - readded the check for > 64 optargs, but changed it to > 63
     - changed the new function to args_of_optargs

commit e24af214fe8f9dccac39ed520b57ce7d458f9fd1
Author: Matthew Booth <mbooth@redhat.com>
Date:   Mon Jan 9 10:16:34 2012 +0000

    generator: Rename java_structs to camel_structs to better reflect their purpose
    
    This map was originally included just for the java bindings, but is generally
    useful to any binding which uses camel case by requirement or convention.

commit 6f6485ec34f29401bbab65dd4275a3b564ed11b3
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Mon Jan 9 15:22:42 2012 +0800

    launch: add a goto label when add_drive error
    
    Code cleanup.
    Add a goto label to simplify the code.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit da13c1c0e6980f4838090be9e775b4d5c35662b7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jan 8 19:12:46 2012 +0000

    Version 1.15.15.

commit 49b894599bf82790c83e2949626b7a8958732b6a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 6 21:08:25 2012 +0000

    debian: Add build-dep erlang-dev.

commit c51caebea20b499ca0f9e652da0d964689969d79
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 6 18:44:41 2012 +0000

    Update to latest gnulib.

commit ebdda911b5dc4e2695413578ed2e0f0b387c0d89
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Jan 4 11:15:24 2012 +0000

    Tempora mutantur, nos et mutamur in illis.

commit c655415dc051b84d6178399e5f7cb76ff7af06c0
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Jan 4 09:56:16 2012 +0000

    build: Fix automake warnings

commit 882408947758fde740efa87b55aff31cd1960983
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 4 10:16:29 2012 +0000

    Sort .gitignore (using sort -d -- dictionary order).

commit 8af6237fd6b84057760e61ffa5fb111e880a56be
Author: Wanlong Gao <wanlong.gao@gmail.com>
Date:   Fri Dec 30 16:10:50 2011 +0800

    gitignore: ignore the git related files
    
    *.eml for email picked patches
    other for orginal git patch related files.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit f49a30eba8bb9f352637c3c24138074bbe3f5555
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Wed Dec 28 17:59:38 2011 +0800

    fish: fix the Ctrl-\ causes guestfish to abort bug(RHBZ#596761)
    
    Handle SIGQUIT by guestfish, so that it can't be terminated.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 10df9d88ab4191c4092f4a88c7343ab3f5f31a70
Author: Wanlong Gao <wanlong.gao@gmail.com>
Date:   Tue Jan 3 23:41:43 2012 +0800

    AUTHORS: add the email address for each authors
    
    Add the email address for authors.
    It would be better.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 49218ae6b451004c8f7b5549d5876c8568a7c1a6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 23 22:30:29 2011 +0000

    fish: mount can be used instead of mount-options with libguestfs >= 1.14

commit 871e1cfe3ae28028eaa4be7d87d7c43f68b4d5ec
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 23 22:30:09 2011 +0000

    fish: Fix --format parameter in man page.

commit 03d052d5782aa1aed07fe8b37a846f8cd69961d3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 23 13:26:31 2011 +0000

    Version 1.15.14.

commit 6032da66819b7ccf99001ba636926100f475cb89
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 23 10:37:04 2011 +0000

    lib: Try harder to remove temporary directory along error paths (RHBZ#769680).

commit 690ff694ca6db586c06ec484ea158261c156aa2f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 23 10:33:25 2011 +0000

    lib: Add guestfs___remove_tmpdir helper function.
    
    This function does 'rm -rf <dir>' for temporary directories, safely
    working if '<dir>' contains shell meta-characters.
    
    Replace existing code for removing directories with this.

commit 486cafd4acf4945bbf3fea541eaa320f5c419406
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Fri Dec 23 14:54:04 2011 +0800

    gitignore: ignore the guestfs.* directory
    
    Let git ignore the guestfs.* directorys.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 87e03fd48ebc9d0fd3a6ba1ed2481f840ffa6db4
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Fri Dec 23 11:46:21 2011 +0800

    extra-tests: add test-guests to prevent test error
    
    extra-tests is depending on tests-guests.
    We need guests/*.img when doing extra-tests.
    
    /work/git/libguestfs/run valgrind --log-file=/work/git/libguestfs/tests/extra/valgrind.log --leak-check=full --error-exitcode=119 --suppressions=/work/git/libguestfs/tests/extra/suppressions ../../cat/virt-cat -a ../guests/fedora.img /etc/fstab >/dev/null
    ../guests/fedora.img: No such file or directory
    make[1]: *** [test-tools-internal] Error 1
    make[1]: Leaving directory `/work/git/libguestfs/tests/extra'
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit b5f90793026832889cae3d4997810cb34777cf9a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 23 08:28:26 2011 +0000

    fish: Fix test-guestfish-events.sh so it works when LIBGUESTFS_DEBUG=1 is set.
    
    Various messages were added and changed when this variable was set
    while tests were running.

commit 2ac869bcc86fbf0dd7e878f10a2b60769a58c962
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Wed Dec 14 17:40:56 2011 +0800

    mkfs: optimization and code cleanup
    
    v1->v2: fix a typo pointed by Matt
    
    Optimizations by reducing the STREQ operations and do some
    code cleanup.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>
    
    RWMJ: Whitespace changes.

commit 6067e1540fab8e8ca85e8c052bbee057882548be
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 22 22:17:17 2011 +0000

    tests/lvm: Contains a Perl test so we must set PERL5LIB.
    
    This fixes commit 498758faee6be7e989869bf7feba5e1026a1bb65.

commit 37aba887d7494a8d970a860e190bd77765d6b440
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 22 19:12:14 2011 +0000

    tests/protocol: Contains a Perl test so we must set PERL5LIB.
    
    This fixes commit 498758faee6be7e989869bf7feba5e1026a1bb65.

commit 76044a5c00fa331a36e2cbce0ef666b88c2988c2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 22 18:34:22 2011 +0000

    Version 1.15.13.

commit 9a5f784d511a8f00a8386f316eab41fe660430db
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 22 17:56:47 2011 +0000

    Security: Mitigate possible privilege escalation via SG_IO ioctl (CVE-2011-4127, RHBZ#757071)
    
    CVE-2011-4127 is a serious qemu & kernel privilege escalation bug
    found by Paolo Bonzini.
    
    http://seclists.org/oss-sec/2011/q4/536
    
    An untrusted guest kernel is able to issue special SG_IO ioctls on
    virtio devices which qemu passes through to the host kernel without
    filtering or sanitizing.  These ioctls allow raw sectors from the
    underlying host device to be read and written.  Significantly, neither
    qemu nor the host kernel checks that the range of sectors is within
    the partition / LV assigned to the guest.  For example, if the guest
    is assigned host partition /dev/sda3, it would be able to read or
    write any part of /dev/sda including other partitions and the boot
    sector.  Exploits through LVs passed to the guest are also possible,
    with some limitations.  File-backed virtual block devices are not
    vulnerable.  Non-virtio block devices are not vulnerable.
    
    This patch mitigates the problem by disabling the SG_IO ioctl
    passthrough in qemu.  Thus if libguestfs is examining an untrusted
    guest and the libguestfs appliance/daemon is compromised (eg. by
    executing guest commands, or through some other compromise), then the
    compromised appliance will not be able to issue the above SG_IO ioctls
    and exploit the host.
    
    Note that this is just mitigation for libguestfs.  Users will still
    want to fully update their host kernel, qemu/KVM and libvirt, in order
    to prevent other (non-libguestfs) routes to compromise.
    
    The following versions of libguestfs (will/have) this patch applied.
    
      libguestfs >= 1.15.13
      libguestfs >= 1.14.8
      libguestfs >= 1.12.11
      libguestfs >= 1.10.12
      libguestfs >= 1.8.16
    
    Earlier versions may be vulnerable unless a downstream packager has
    applied this patch.
    
    Cc: Hilko Bengen <bengen@hilluzination.de>

commit ad5b5f96da53a6f51424e22e26f2d8a325eec681
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Sat Dec 10 22:16:55 2011 +0100

    Fixed checks for libpython features
    
    The python3.1 package shipped with Debian/squeeze does not have the
    'mu' suffix that was assumed before.

commit be1419a442d9936e737fb2ca6f0fdba36a048964
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 22 16:13:08 2011 +0000

    Version 1.15.12.

commit 1fcec724aa565eac6604eae249f674ad47e9f8a5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 22 15:09:19 2011 +0000

    tests: Add a simple liveness tests for qemu.

commit 1edf00d3bdb38241007bc9c789bf9710f6f5c45c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 22 13:12:43 2011 +0000

    tests: Finalize the order we run the tests.

commit d24e088dc3475db4496e5cbd67c143c25ef12b1e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 22 13:05:34 2011 +0000

    tests: Put test-tool and comment into own section.

commit cd077b8229731e292798f34dd56892cbfa6f1e0e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 22 12:15:06 2011 +0000

    tests: Split images -> tests/data + tests/guests

commit c649817586e5b4df53b251d1290422f5ef046045
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 22 12:00:44 2011 +0000

    tests: Rename extratests -> tests/extra.

commit 498758faee6be7e989869bf7feba5e1026a1bb65
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 22 11:35:43 2011 +0000

    tests: Split regressions -> various subdirectories of tests/

commit 5d93d70b4d36b2337104b3dbca07722fa4d47ff5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 22 08:40:30 2011 +0000

    tests: Rename capitests -> tests/c-api.

commit 72f5487be2df82277021d61f01884381ed9efbc5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 22 08:34:57 2011 +0000

    tests: Rename caution -> tests/qemu.

commit c09db4e834ab0efb93588d0427aba110a1f234e8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 22 08:34:08 2011 +0000

    tests: Document new tests/ subdirectory.

commit f5a49bf1cae335889da6be53fd1ca302273be78b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 22 08:33:16 2011 +0000

    docs: Arrange directory names in alphabetical order.

commit a0a8de4253ad545d668977dbf54f90118f601192
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 20 18:26:20 2011 +0000

    extra-tests: Add an extra suppression for OCaml 3.11.2 in RHEL 6.

commit 7123f0cab155c5c25ecae670677683001c1634ad
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 14 08:38:27 2011 +0000

    fish: Allow events to be processed in guestfish.
    
    Add 'event', 'list-events' and 'delete-event' commands so that event
    handlers can be registered, listed and deleted in guestfish.  The
    event handler is a shell script snippet or host command.
    
    Cc: Pádraig Brady <P@draigBrady.com>

commit 3c9dfd1e95fae5c31df1fbcb6bdec2982a69a004
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 14 12:07:31 2011 +0000

    python: Missing () in guestfs-python(1) examples.

commit 0ef30bbb316b50beba511a5eb4bd7174671fa1ca
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 9 17:34:01 2011 +0000

    Version 1.15.11.

commit ae45cee728039d7724fc73e5ffb2550c8054d268
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 9 15:30:23 2011 +0000

    fuse: Return EXIT_FAILURE if fuse_main fails.
    
    fuse_main can return any non-zero value on error.  In particular on
    certain sorts of error such as unsupported -o options it returns 1
    (not -1).
    
    Therefore make sure any non-zero return is turned into EXIT_FAILURE.
    
    (Thanks Pádraig Brady)

commit 54e91da925323642e67b8ce4b95899fe4b7a51c4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 9 09:49:37 2011 +0000

    fish: -i option should fail if / is not mountable, but warn about others.
    
    In particular this stops a problem with guestmount where if the -i
    option half-recognizes the guest OS, it would mount the disk (and
    fail, giving only warnings), leaving the mountpoint unusable.
    
    (Thanks Pádraig Brady)

commit 19e2f5aa4fd4ed70b505661d918b5575616ad441
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 8 11:39:58 2011 +0000

    daemon: Fix utimens so it doesn't hang on named pipes (RHBZ#761460).
    
    This also adds comprehensive tests for utimens on regular files,
    directories (RHBZ#761451), named pipes (RHBZ#761460), symbolic links,
    block and char devices.
    
    Note that there is a small change in the (previously undefined)
    semantics of this call: It now sets the time on a symbolic link
    itself, not on what the symbolic link points to.

commit 31fba8d8033216f8a288e75fe3f575b73b9ef925
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 8 11:15:18 2011 +0000

    daemon: Allow utimens to work for directories (RHBZ#761451).
    
    You don't need to open the file O_WRONLY in order to call futimens on
    the file descriptor.  Opening it O_WRONLY fails for directories.
    Therefore open O_RDONLY instead.

commit 98edfac1ee70bcf15ee7caebc306e11cdbbb0d9a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 7 12:12:35 2011 +0000

    copy-in/copy-out: Wait for the tar subprocess only (RHBZ#760669).

commit 7d3848ddc046f79cc1112809bd9970eea8060018
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 7 11:46:43 2011 +0000

    fish: Improve error messages when no OS / multi-boot OS found with inspection (RHBZ#760775).

commit 41a7a68cf33a174ba950aa29951a07c391a16b4d
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Tue Dec 6 20:42:11 2011 +0100

    let the user explicitly choose ruby and rake programs

commit 2353b9d3b867fb19db4e403b49a93674d8b2682c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 6 15:10:46 2011 +0000

    Version 1.15.10.

commit 43942b08cfbcf91bef29ec532f3d097a8519c982
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Mon Dec 5 18:35:57 2011 +0100

    Fix rpcgen post-processing for out-of-tree builds

commit 2972987d0257d9c3d26b53f961e802d121b436cd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 5 10:36:13 2011 +0000

    ruby: Use RSTRING_PTR, RSTRING_LEN for compat with Ruby 1.9 (RHBZ#760000).

commit 6c5f7c954cfdce16d4883b7244b5bc324c417ddf
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Mon Dec 5 18:06:43 2011 +0800

    blkid: split the RHEL5 which can't support some options
    
    RHEL5 shoult not support '-p', '-i' and '-o export' options.
    But we just split it according to the '-p' option.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit f499d7d42567349a7e45170df95de97f38db5b52
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Mon Dec 5 16:57:22 2011 +0800

    TODO: remove the implemented command blkid
    
    Remove the implemented command blkid from TODO lists.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit e18058a5a56236cbac23f10dc8a91420a3525562
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 4 16:47:37 2011 +0000

    Revert "blkid: Use -c /dev/null because RHEL 5 blkid doesn't have -p option."
    
    This reverts commit 6533491b178d18bfab8240cf093be4ef9b547548.

commit 7f14c042eb6ecab162d599fb182c7d63cebcfb9e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 4 16:47:29 2011 +0000

    Revert "blkid: Fix mistake in previous commit."
    
    This reverts commit c48226a5026816b115ab63b50d3601531aff59dc.

commit c48226a5026816b115ab63b50d3601531aff59dc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 3 23:16:00 2011 +0000

    blkid: Fix mistake in previous commit.
    
    This updates commit 6533491b178d18bfab8240cf093be4ef9b547548.

commit 6533491b178d18bfab8240cf093be4ef9b547548
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 3 22:58:03 2011 +0000

    blkid: Use -c /dev/null because RHEL 5 blkid doesn't have -p option.

commit 615924abaa968398d6529529fa2f31ae23de825b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 3 14:34:52 2011 +0000

    daemon: Use pkg-config to locate Augeas CFLAGS / libraries.
    
    Augeas 0.10 depends on libxml2, so this is now required in the
    appliance (in fact, it was already present).
    
    However this exposed two bugs:
    
    (1) In libguestfs we use a home-brewed recipe for Augeas flags,
    resulting in this error:
    /usr/include/augeas.h:24:25: fatal error: libxml/tree.h: No such file or directory
    
    (2) Augeas's own augeas.pc didn't include the libxml2 flags, so
    it was broken.  This requires a patch to Augeas 0.10, see:
    https://www.redhat.com/archives/augeas-devel/2011-December/msg00008.html
    
    Change to using pkg-config to detect Augeas.  It is still an optional
    library.

commit cd1322e30d6c34d7d9f87d72dfa1660aa5d8af38
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 3 12:59:27 2011 +0000

    Version 1.15.9.

commit fcb975a6424d48d63f03961e34b92ed7c6a27362
Author: Wanlong Gao <wanlong.gao@gmail.com>
Date:   Sat Dec 3 17:07:47 2011 +0800

    NEW API: add blkid command to print the attributes of the device
    
    A NEW API blkid.
    It can print the device attributes.
    Use it after list-devices, we can list ower devices and the attributes
    of each device.
    Use it like:
    blkid <device>
    It's should be a usefull function.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit b7addee24d211014086c44bcef6a0c799e4fb987
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 2 15:03:19 2011 +0000

    extra tests: Test that valgrind and libtool are installed.

commit e72c200e4c16dce72654a57ef6e9a0ad1ca686e1
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Dec 2 14:04:20 2011 +0000

    inspection: Add a test for MD device mapping in fstab
    
    Check that we properly handle fstab entries of the form /dev/md0 and
    /dev/md/foo.
    
    RWMJ: Add a skip to test if the Augeas lens is not available.

commit 922c3623c63b137ce940c574791104744e716c4a
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Dec 2 14:04:19 2011 +0000

    inspection: Handle MD devices in fstab
    
    This patch fixes inspection when fstab contains devices md devices
    specified as /dev/mdN. The appliance creates these devices without reference to
    the guest's mdadm.conf so, for e.g. /dev/md0 in the guest will often be created
    as /dev/md127 in the appliance. With this patch, we match the uuids of detected
    md devices against uuids specified in mdadm.conf, and map them appropriately
    when we encounter them in fstab.

commit 655f8037def7742a608fb272004eec51424ac31d
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Dec 2 14:04:18 2011 +0000

    build: Add more suppressions for valgrind tests

commit 1970a14178b5c53569965d35e54efead6c4c4bdc
Author: Wanlong Gao <wanlong.gao@gmail.com>
Date:   Fri Dec 2 21:47:51 2011 +0800

    mkfs: enable to make xfs filesystems when the device already has a filesystem
    
    Just add the -f option to mkfs.xfs to make sure we can
    make a xfs filesystem when the device already has a
    filesystem on it.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 1a35ca59088e572c11633e85524bb282cb436186
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Thu Dec 1 22:06:30 2011 +0100

    libguestfs: Added gnulib includes from builddir, as suggested by the Gnulib documentation
    
        Since some modules (`getopt', for example) may copy files
        into the build directory, `top_builddir/lib' is needed as well as
        `top_srcdir/lib'. -- GNU Gnulib manual, section 2.2 Initial import

commit f23352aefd96dc873111e5e5d55ea22b30c3e0ad
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 30 17:08:33 2011 +0000

    todo: Suggestion for UUIDs in /etc/fstab (thanks Joshua Daniel Franklin).

commit ce331df0f1857bccebaaddfac79677bc9f527197
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 30 17:08:27 2011 +0000

    ocaml: Fix OCaml dependencies.

commit ece902712bcd54e0cd28b57352c6a4efcf26c4f6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 29 23:31:30 2011 +0000

    Version 1.15.8.

commit e7e3a32edc29e3448b1d7efb3f6b53c5173c4e9c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 29 18:20:05 2011 +0000

    python: Memory leak: Free roots array along handle close path.

commit 00c9755ee3bea98968acea47bac858db94f7fbe2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 29 18:19:54 2011 +0000

    perl: Memory leak: Free roots array along handle close path.

commit eb7ec6170eca278fb910e18ca1f7ca81c6b507c0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 29 17:47:18 2011 +0000

    ruby: Memory leak: Free roots array along handle close path.

commit efef3e3c1205e5476044f41fb88385e3ba07468d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 29 17:51:59 2011 +0000

    extra tests: Add comments about what is not tested here.

commit 27d00960c93b26c68fa1f4068502c32a6e3b5e94
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 29 17:32:19 2011 +0000

    extra tests: Absolute path for 'run' command.

commit cee513112adcf4084d6be9e3b5037b7b54c9f514
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 29 17:22:56 2011 +0000

    extra tests: Split up and reorder tests more logically.

commit 14b1e7b963cd5446ab76a067085b91925dd5d3e3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 29 17:20:11 2011 +0000

    extra tests: Test virt-sparsify.
    
    This adds the virt-sparsify --debug-gc option which causes
    virt-sparsify to call Gc.compact before exiting, allowing
    GC and memory problems to be tested.
    
    Add an extratest which runs virt-sparsify under valgrind.

commit 7708d3e04f6ec3985fd74ee1a44a5615d43065e2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 29 17:14:18 2011 +0000

    extra tests: Test virt-resize.
    
    This adds the virt-resize --debug-gc option which causes
    virt-resize to call Gc.compact before exiting, allowing
    GC and memory problems to be tested.
    
    Add an extratest which runs virt-resize under valgrind.

commit 082a55f76cd61f3590976f6b095552ea65259ced
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 29 17:13:45 2011 +0000

    ocaml: Load test should call Gc.compact to flag memory errors.

commit 6bd0eec12f2e39360847bfe7a9f50628cc89ed8e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 29 17:13:17 2011 +0000

    ocaml: Fix memory leak in bindings for functions that return buffers.
    
    RBufferOut binding didn't free the buffer after copying it onto
    the OCaml heap.
    
    Found by valgrind.

commit bcd2dba76efa4da4edb1b04f6348b0a0dfb109c2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 29 16:11:21 2011 +0000

    Version 1.15.7.

commit e1f395defc6db5bbc82537af6e517d94216b7d4b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 29 13:13:44 2011 +0000

    extra tests: Run C API tests under valgrind.

commit d81c0829ea4a99aadb98df37be9543a973269041
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 29 13:13:06 2011 +0000

    protocol: Memory leak: Free temporary buffer along recv_discard path.

commit aa4eb4cd109dda0dc7dfdd66a5163a18b0be2277
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 29 12:52:15 2011 +0000

    extra tests: Run OCaml tests under valgrind.

commit 6ccae55ddcf0c08cd1b1cdbc07afeed043ad410d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 29 12:51:20 2011 +0000

    extra tests: Split VG variable into VG / RUN_VG.
    
    This is just code motion.

commit c5dbb1e63a8e0c45c7088dd2e58f5abbcfc30620
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 29 12:25:34 2011 +0000

    ocaml: Memory leak: Free roots array along handle close path.

commit 35c8e4fa7f5c90cc8371028e2bfc0562272380e3
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Nov 25 13:16:54 2011 +0000

    inspection: Cleanup iteration over fstab entries in inspect_fs_unix.c
    
    Select non-comment labels using an augeas path to return the correct
    nodes in the first instance, rather than applying a regular expression
    to all results.
    
    There is no functional change to the code.
    
    RWMJ:
     - Rebased to current HEAD.
     - Move variable decls to top of function.
     - Some whitespace changes.
     - Remove check for errors from snprintf since it can never happen.

commit 7c89d9ef6b37314fb55aabd0c389a9d652acdb0f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 28 20:40:01 2011 +0000

    inspection: Add outline support for GNU/Hurd.

commit f5bfc68fdb3e25b9d75c65e3f5e88983584b25ed
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 28 19:12:44 2011 +0000

    fish: When -m option fails, canonicalize device names that are printed.
    
    The error message now looks like this:
    
      guestfish: '/dev/vda6' could not be mounted.  Did you mean one of these?
                /dev/sda1 (ext4)
                /dev/vg_f15x32/lv_root (ext4)
                /dev/vg_f15x32/lv_swap (swap)
    
    Note that '/dev/sda1' has been canonicalized.

commit 450134501c37f1dd1b898dc390591a3f84ec18b4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 28 19:07:30 2011 +0000

    fish: Rearrange code for displaying mountpoints when -m option fails.
    
    This also frees the list returned by guestfs_list_filesystems.

commit 425374ddc84c4f9f74a5218e8d35452bb511d9f3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 25 08:34:59 2011 +0000

    docs: Tidy up documentation for md-stop.
    
    This cleans up commit cbd1c45d95c530c8d94103dcc2c521bf5501ef59.

commit 56c151fe8c6e4c2e9b35506339cabfef0957f824
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 24 20:28:02 2011 +0000

    Version 1.15.6.

commit b5b4816ab006ce09b7a7103dbe87b3129046648d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 24 20:17:57 2011 +0000

    ubuntu: Add extra suppressions for libnl.1 leaks.

commit 56b3b40603a95b09a0f34c2e49143bc7b40cbdfd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 24 19:36:50 2011 +0000

    Update API support.

commit be7cb789069afc93e7c1b0e7a1a9a293dc846d45
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 24 17:47:13 2011 +0000

    extra-tests: Include valgrind suppressions file.
    
    This updates commit c55bad93fbde03a3daa6058913f02098c45e55f5.

commit 3bbcbd5eeadabb1cc5a40b2f8ae586e6aafd39c6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 24 16:54:17 2011 +0000

    regressions: Allow test-launch-race.pl to be skipped.
    
    export SKIP_TEST_LAUNCH_RACE_PL=1
    will cause this test to be skipped.

commit 2d5841133a199619d56d026ad9ea4e97791f4a8f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 24 16:27:36 2011 +0000

    debian: Use mdadm -D --export instead of mdadm -DY.
    
    For compatibility with mdadm on Debian Squeeze.

commit c55bad93fbde03a3daa6058913f02098c45e55f5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 24 14:08:09 2011 +0000

    Add 'make extra-tests' rule and run extra tests.
    
    These tests are optional, and require a special environment and
    tools to run.

commit dd76ce2b4c93dd10d8eca9ab7c77bc831f103d03
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 24 15:50:54 2011 +0000

    lib: Fix memory leak when debugging enabled (found by valgrind).
    
    If you enabled debugging (eg. LIBGUESTFS_DEBUG=1) then every
    debug message printed would be leaked.

commit bfc0a5f58d3cb6faad5a44bed392f33190e62246
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 24 15:49:49 2011 +0000

    test-tool: Fix multiple memory leaks found by valgrind.

commit cd3d28491dd19d25a6c04a8bc6a7ec94bded413b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 24 15:49:27 2011 +0000

    filesystems: Fix memory leak found by valgrind.

commit c4381dba737d5cb8aad8e1b2e2123b0fcaff1d1a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 24 14:39:10 2011 +0000

    part-disk: Change default alignment of this to 64K (128 sectors).
    
    This is the minimum alignment.  1MB would be better.
    
    Note that the exact behaviour is not defined in the API.

commit 7b192f5a672197ad67ac23501e420c674aa2f3a9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 24 14:06:31 2011 +0000

    virt-alignment-scan: Add checks for when API calls return NULL.
    
    In particular, virt-alignment-scan -a /dev/null would segfault
    because of an error returned by parted.

commit cbd1c45d95c530c8d94103dcc2c521bf5501ef59
Author: Wanlong Gao <wanlong.gao@gmail.com>
Date:   Thu Nov 24 21:06:07 2011 +0800

    New API: md-stop for stopping MD devices
    
    This API is used to stop a md device.
    When we want to move a device to another md array, we should
    stop the md device which contained this device first.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 182c25b2a42e9a8f76beba440da328e37f18c9b9
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Nov 24 12:09:03 2011 +0000

    Rename mdadm_ apis to md_
    
    This change renames the following 2 apis:
    * mdadm_create -> md_create
    * mdadm_detail -> md_detail
    
    This is more consistent with list_md_devices, and removes a reference to an
    implementation detail from the api.

commit 373dca7d12a8741e116205b4a3ac67a7d82cc782
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Nov 23 14:00:55 2011 +0000

    NFC: Allow multiple config files in inspect_with_augeas in inspect_fs_unix.c
    
    This change is in support of the addition of MD support to fstab inspection.

commit 011a248381cacd6751deb1d1be122cc9bd6aba09
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Nov 23 14:00:54 2011 +0000

    NFC: Consolidate the error path in check_fstab in inspect_fs_unix.c

commit 454a08380d9de78448927ab77480f833342d214c
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Nov 23 14:00:53 2011 +0000

    md: Inspect MD devices

commit c8cb3d27b62da20be6b2fa06f1ce6b63a722c32b
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Nov 23 14:00:52 2011 +0000

    NFC: Declare and use variables on the same line in inspect.c

commit 34c0542189a443e57f2b09886f31b5bdad404bbf
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Nov 23 14:00:51 2011 +0000

    build: Nothing under images/ should be translated

commit d3458d7bc46d4fa68acd759cf5dc308f76531fe4
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Nov 23 14:00:50 2011 +0000

    build: Create an MD variant of the dummy Fedora image
    
    This change involves rewriting make-fedora-img.sh in perl. This allows the
    flexibility to write mdadm.conf containing whichever uuids where randomly
    generated when the md devices were created.

commit 252ad4aa41c213948e4ee1f01e6c7ff7861f75e3
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Nov 23 16:35:10 2011 +0000

    run script: Don't overwrite LD_LIBRARY_PATH and PERL5LIB
    
    This change allows the run scripts of virt-v2v and libguestfs to be chained.

commit 065b6b5798913c9bb40215944920199ae7d27007
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 22 16:03:37 2011 +0000

    gnulib: Rebase to latest.

commit 9b102aae65449a8d321e8cf44a3993af558291db
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 22 16:40:37 2011 +0000

    Don't rely on implicit promotion of float to double in printf args.

commit 99ec97dcdfaf242ba0683a230ba51e4a87f7458b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 22 16:39:37 2011 +0000

    fish: In generated code, put function names on a new line.
    
    eg:
    
    static void
    run_foo ()
    {
    }

commit 7b3137e664c3f4edf6ac7043a34c4166567e17bd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 22 13:18:32 2011 +0000

    df, testing: Add notes on virt-df numbers (thanks Kashyap Chamarthy).

commit ce6c4eeabe3f2ce96d11d6d55c3ac6aca542d4c8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 22 10:11:10 2011 +0000

    sparsify: Add -o option for passing qemu-img output format options.

commit b83b705959c3c93bff0c343bcad09305399895a5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 22 09:54:52 2011 +0000

    sparsify: Add --compress option.
    
    This adds the -c option to the final qemu-img command.

commit 342b4a55d056734a0344db8b4bcf1a90104a8a59
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 22 09:39:54 2011 +0000

    sparsify: Add auto-detection of .vdi files.
    
    Note that for this to work properly, it requires a patch to
    the 'file' command.  See:
    https://www.redhat.com/archives/libguestfs/2011-November/msg00120.html

commit 0cdd9444744e7ae0d82fe4c94d13e9ddd00e8e2d
Author: Matthew Booth <mbooth@redhat.com>
Date:   Mon Nov 21 15:23:18 2011 +0000

    fish: Add MD devices to guestfish device autocompletion.

commit a7740cb19a6991d21dc9395dffb87d69ee5986b5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 21 13:25:36 2011 +0000

    Version 1.15.5.

commit 6f39cfaeacda146d0eaa35da6f6413fa6ab3d40a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 21 13:09:59 2011 +0000

    guestfs-testing: Link to libguestfs-test-tool.

commit 7828f4dfe3d5ff4d086261218908c8da37bb9d97
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 21 11:45:54 2011 +0000

    contrib: Update introduction to libguestfs.

commit 8bc6e9d6a89672bbe1e7469774abe889354deb67
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Sun Nov 20 23:57:47 2011 +0100

    out-of-tree build: ruby

commit a3b24296810d98e47552c6838dcd6ab6845aba03
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Nov 20 13:38:28 2011 +0000

    Add guestfs-testing(1) man page.
    
    This contains suggested manual tests that users can run.

commit 3e9f4af1e1126b1e1f7a93379172dd095dd1b908
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 17 13:33:57 2011 +0000

    Version 1.15.4.

commit c4bd6bba8d88ecf1ebf4a9c2c80a407d9971aaf7
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Nov 17 12:43:49 2011 +0000

    New API: mdadm-detail.

commit 0c99bb06f4565e053e18e082065bdc739f5130ab
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Nov 17 12:43:23 2011 +0000

    Add custom indentation config for vim.

commit 730fb50780df860474dc1fae16c9891187e99c82
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Tue Nov 15 21:28:22 2011 +0100

    out of tree build: haskell

commit a0509ff0715533e341573e24f6888fd7dcf4ba51
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Tue Nov 15 21:28:21 2011 +0100

    java: out-of-tree build, don't build static library

commit ddb3fac1bf1b0493779c9425b518598473ef106a
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Tue Nov 15 21:28:20 2011 +0100

    out of tree build: erlang

commit b051fffc6f4f6c095a3401f89a47fbb948a71ee1
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Nov 10 17:57:16 2011 +0000

    Update list-filesystems to check md devices.

commit 00a0fab50b3803be8db5b7d9fa0869a70b0da556
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Nov 10 17:56:10 2011 +0000

    New API: list-md-devices.
    
    Return a list of Linux MD devices detected in the guest.
    
    This API complements list_devices, list_partitions, list_lvs and
    list_dm_devices.

commit c11a92751e003b3d4bc3584b598afc9bd9d9e703
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 11 11:01:46 2011 +0000

    New API: mdadm-create for creating MD devices.

commit 47963bc9cc0b47af0541010a4fa14260405acaa5
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Nov 11 20:26:17 2011 +0000

    32 bit: Fix printf off_t.

commit 5d48250224fcb140b7e6e17f36b37deab4e0659b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 11 19:11:02 2011 +0000

    32 bit: Use %td for ptrdiff_t (difference between two pointers).

commit 6e6b3ff35f9baafb22d5459ca13c112b1e00ae1b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 11 13:30:09 2011 +0000

    df: Disable part of virt-df test.
    
    See:
    https://www.redhat.com/archives/libguestfs/2011-November/msg00051.html

commit c81a16a4e2e703d0aaa595151602bcf03430f6ab
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 9 17:54:38 2011 +0000

    New API: Bind the tune2fs command.
    
    Previously we bound the 'tune2fs -l' command so that we could list out
    the tunables of an ext2/3/4 filesystem.  Also commands like
    set_e2label and set_e2uuid used tune2fs.
    
    This commit binds many of the tunables that can be set using tune2fs.
    
    The coverage is not complete, but we can add more later because this
    uses optional parameters so the call is extensible without breaking
    ABI.  The current change gives us enough for using libguestfs within
    OpenStack.

commit 9ba779ea367b2ea7077da7bdd75e813cd06c7eea
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 10 16:34:57 2011 +0000

    tune2fs-l: Add a test.

commit 5f0b75f040b118c4394466438adc99f38144722d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 10 16:33:40 2011 +0000

    generator: Support testing the output of RHashtable functions.
    
    You can use TestOutputHashtable to test the output of RHashtable
    functions.

commit edd502543adbdc2fa5dda0c015ea7c390bb39f64
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 10 15:53:23 2011 +0000

    daemon: Define safe ADD_ARG macro for constructing arg lists on the stack.

commit 1ecc6b149364f3b4b6ed1a4b043821c3b025be98
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 9 22:44:47 2011 +0000

    Version 1.15.3.

commit 29172e7c4878085a680812f7f3b8ad6ea5f1193c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 9 17:48:42 2011 +0000

    ocaml: Fix bindings when a function takes more than 10 parameters.
    
    If any function had more than 10 required + optional parameters, OCaml
    bindings could not be generated.  Currently there are no such
    functions.

commit af2b0378bbb178a4e3db326ac3082d66170fcafc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 9 17:47:23 2011 +0000

    tests: Fix bitmask parameter when testing optional arguments.
    
    The bitmask was being constructed backwards(!)
    
    As a result, any test which tested optional arguments didn't work.
    There are very few such tests and they happened not to be affected by
    this.

commit 271f8e4b70e4acf2db96f6fe6317fda327fa5f2e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 9 21:21:00 2011 +0000

    fish: More informative documentation of optargs.

commit 145ed04e41a3fcd3be87c11cae0085f4551f1da8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 9 17:53:58 2011 +0000

    ocaml: Compile OCaml bindings and tests with -warn-error.

commit 22c72b911e65b93cfd049f42e6bd1b9ad7d55299
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 9 17:50:37 2011 +0000

    ocaml: Catch EVENT_ENTER case in test.
    
    For some reason we are not compiling the tests with -warn-error so
    this problem was not noticed before.
    
    This fixes commit 9420eaf44ec4067c3740b91b0be0fede08a0c515.

commit 04ea1375c55aa67df4e7fc61dbb534111767f3b6
Author: Matthew Booth <mbooth@redhat.com>
Date:   Tue Nov 8 14:27:49 2011 +0000

    Update FSF address.

commit 9c299b64bb24cefafa582fe425bb65b78373d205
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 4 15:55:13 2011 +0000

    daemon: Use a private copy of /etc/lvm so we don't modify the real config.
    
    In the libguestfs live case we need to be careful not to modify the
    real /etc/lvm/lvm.conf file (when setting the filter rule).
    
    When the daemon starts, make a complete copy of /etc/lvm in a
    temporary directory, and adjust LVM_SYSTEM_DIR to point to the copy.
    All changes are made in the temporary copy.

commit 6011b1f803ba7308c6a94b9bf6b7212cfccb9f42
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 4 15:30:12 2011 +0000

    daemon: Don't use files with fixed names in /tmp (thanks Steve Kemp).
    
    Although this doesn't matter for the ordinary (appliance) case, it
    matters for the libguestfs live case.  In that case it could cause the
    guest to be exploited by a tmp/symlink attack.

commit f93e8dbb78794029dcc51e8b0d77b5ed4eadac5e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 3 14:47:26 2011 +0000

    Version 1.15.2.

commit 22998927f91f123e7c35d3ebf49e5744f3d7eafe
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 3 13:09:54 2011 +0000

    virt-sysprep: Don't use xmlstarlet.
    
    Use virt-inspector --xpath option instead.

commit d1ee71782ace98a11c5aabaf1f9fd5f601e08367
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 3 13:06:25 2011 +0000

    Add virt-inspector --xpath to run XPath queries directly.
    
    xmlstarlet is good, but not available in Red Hat Enterprise Linux.
    
    Build a simple but sane XPath query parser into virt-inspector
    directly so that we don't need any external tools.

commit ffbafadcb8dfebcaba529cb8d7e2da52dd032d8a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 3 10:45:58 2011 +0000

    resize: Remove requirement for ocaml Pcre library.
    
    This library is not available in RHEL 6, and in any case removing the
    dependency is a simple change.

commit 63898268101e5ec91c8dac46651dbee5976272ce
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 3 10:32:02 2011 +0000

    resize: Add tests for some Utils functions.

commit 31e5539a14f78d8815d0d930e91023a65b5395e7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 3 09:48:45 2011 +0000

    python: Use sys.version_info[0] instead of sys.version_info.major.
    
    The major/minor fields only exist in Python >= 2.7.  This works for at
    least Python 2.5 and 2.6.
    
    Thanks to Hilko Bengen.
    
    This updates commit 646142f5136da9cfe2b908703a822c53350f70e9.

commit 2116f79cbcd4605b4997931285f14dde1f72a992
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 2 19:43:53 2011 +0000

    python: Fixes for Python 3 (RHBZ#750889).
    
    These fixes allow libguestfs bindings to work with Python 3 (tested
    with Python 3.2)
    
    You can select which Python you compile against by doing:
    
      PYTHON=python ./configure && make && make check
    
    or:
    
      PYTHON=python3 ./configure && make && make check

commit e2249b7ce1dd0a2f8f110e0e47aca397185a6373
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 2 19:42:29 2011 +0000

    python: Pass $PYTHON environment variable to tests.
    
    If the user set PYTHON when configuring, this variable is not passed
    through to the tests, so it is possible the tests will fail because
    they are testing the wrong version of python.  By passing $PYTHON
    through to the tests we ensure that we test against the same version
    of python that we configured with.

commit 25454b83082a4cfed4f1664d2f9cdfcb222ba7c2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 2 18:19:15 2011 +0000

    python: Include <config.h>.
    
    Ooops ...

commit 646142f5136da9cfe2b908703a822c53350f70e9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 2 18:18:14 2011 +0000

    python: Correctly check for Python major/minor.
    
    The manual for sys.version warns that you should not parse the string,
    which we were doing.  It would have failed on python "2.10" or
    similar.
    
    Do it correctly using the sys.version_info struct instead.

commit b4791fd4049d88421b240a17cc6417c0bbf8e795
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 2 13:23:37 2011 +0000

    contrib: Use PNG images as fallback for IE compatibility.

commit acd06dbe326da7cd883f0a7df599d0d173c4bd04
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 1 17:51:00 2011 +0000

    contrib: Update talk.

commit fdcd33a1554c768412061a0448c5ab2044fdae07
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 1 15:11:16 2011 +0000

    Version 1.15.1.

commit fc821f97894926c0dcf4f52f55a2d1a810e27873
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 1 14:10:49 2011 +0000

    contrib: Add all contrib files to EXTRA_DIST.

commit 4ac261b3ee3fbc72614623b4ef630a55393b462f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 1 14:07:59 2011 +0000

    contrib: Add libguestfs talk.
    
    This is a short (10-15 min) talk that I give to introduce the main
    features of libguestfs.  The "slides" are in the form of a complete
    self-contained HTML page with a handful images that can be easily
    distributed before the talk.

commit 0257e27e17214d84f49a51e1138fb46b23d6b024
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 1 09:47:25 2011 +0000

    rescue: Add --suggest option to suggest mount commands.

commit b4da051d54a1597c7d8db8880d21a52265a6172e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 1 09:47:01 2011 +0000

    fish: Use size_t instead of int when counting strings.

commit 4e3a1205ebfec1a5cbc3062d6f73a684090e80b5
Author: Matthew Booth <mbooth@redhat.com>
Date:   Mon Oct 31 16:47:50 2011 +0000

    Fix debug help error message.
    
    When given an invalid debug command, libguestfs responds with the
    error message:
    
      libguestfs: error: debug: use 'debug help' to list the supported commands
    
    However this command does not work, as debug requires two
    arguments. This change updates the message to prompt the user to use
    'debug help 0'.

commit 6f84ef6768e9c625d67f7eb015277b0ec1b2c2af
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 31 16:44:55 2011 +0000

    appliance: Add 'mdadm' package.

commit 365885dab2ae6dcdf0b2c45d0adeb803ade03f63
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 27 17:40:31 2011 +0100

    perl: Add %guestfs_introspection hash with introspection information.
    
    Because this is a useful introspection API, it is a candidate for
    being backported into older stable branches.

commit 477c437ba0e2108413fe2b54a830b36c251242f3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 27 16:06:44 2011 +0100

    Version 1.15.0.

commit 908fd031d31c29f3ca3037a26c2e85070ed381dd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 27 14:26:46 2011 +0100

    Pull latest translations from Transifex.

commit 6edd6cdebadab0117bc602f02e0dc68ea7d1a2ef
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 27 13:45:22 2011 +0100

    generator: Remove DangerWillRobinson.
    
    This warning was applied unevenly.  Potentially any command can be
    dangerous or safe, so it was a needless warning.

commit 7b44f7b3df0b20b2b5e889d89e82a35eed20d43e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 27 13:44:02 2011 +0100

    fuse: Skip guestmount test if setfacl is not installed.
    
    This dependency is optional, don't fail the test if it's not
    installed.

commit 2749d6edfbed3b9185b53e9c9befb8d370965b0c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 27 13:36:15 2011 +0100

    virt-sysprep: Skip test if xmlstarlet is not installed.
    
    This dependency is optional, so don't fail the test if it
    is not installed.

commit 46e08a159a86d993a44830d70da442cd073859c2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 27 13:30:22 2011 +0100

    virt-alignment-scan: Add additional data for 4K sector drives
    (thanks Matt Booth).

commit d9c4b702e75ae565f7a4664e835a6e53c0675763
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 27 12:28:47 2011 +0100

    test-virt-sparsify: Relax size_after constraint (for Debian).
    
    size_after on Debian was 10136K.  The host filesystem was ext3 (vs
    ext4 for Fedora where we did the original testing).  Probably indirect
    blocks (vs more efficient extents on ext4) causes the difference,
    although I did not look at it in detail.

commit e07774344208c9ee4e32d35061ba67591e4c441f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 27 10:55:06 2011 +0100

    Update RELEASE-NOTES for 1.14 release.

commit a08bfe2896c15e1f58bc8514791e0c5ff8a09d62
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 27 10:54:55 2011 +0100

    Update ROADMAP for 1.14 release.

commit 7fef001bd9a2b64ebbf8c936fa75d9c0f8ae76bd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 26 22:22:32 2011 +0100

    Update API support.

commit 19005b2cfc6b077aafd16cb5b97a08180e4e39f8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 26 21:12:18 2011 +0100

    Version 1.13.26.

commit b0eabcca60da8fec55cbeaf83e17320281ed75b8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 26 20:53:30 2011 +0100

    guestmount: Fix --live option (RHBZ#744795).

commit bf7f3170eadb8be5a74a7698a6f7b1dda7a27541
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 26 19:30:23 2011 +0100

    fish and other tools: -d option uses readonlydisk="read" (RHBZ#747290).
    
    Tools like virt-edit would not be able to edit disks marked as
    <readonly/> in the libvirt XML.  It's not clear if this is a bug or a
    feature.

commit b893294dcc948d4b41318a400fc4235a190d306b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 26 19:27:01 2011 +0100

    add-domain: Add readonlydisk optional argument (RHBZ#747290).
    
    This optional argument controls how <readonly/> disks in
    the libvirt XML are handled.  It can be set to one of:
    
      "write" (default) - add them R/W
      "read" - add them R/O
      "error" - throw an error if asked to add them R/W
      "ignore" - ignore these disks
    
    I have added limited regression tests for this feature.  However
    libvirt's test:/// XML does not allow you to specify that a domain
    starts off shut down, so we cannot fully test this.  Instead I tested
    it by hand.

commit 163f7df8452f5d7eb47039a98cd97d498528e4d5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 26 17:47:34 2011 +0100

    libvirt: Detect if a disk has the <readonly/> flag.
    
    This changes the private function guestfs___for_each_disk so that the
    <readonly/> flag on libvirt disks is detected and passed through to
    the callback function.

commit 62909197d120c01cc86095518aacca9d4ad268dd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 26 15:55:29 2011 +0100

    test-user-cancel: Make this test choose smaller cancellation numbers.
    
    Use a Gaussian distribution for random numbers so that smaller numbers
    are chosen more frequently.
    
    This also exposes a bug in this test which only happens when small
    numbers are chosen:
    
    If the test thread starts up quickly, it can get to
    guestfs_user_cancel before the guestfs_upload command has happened in
    the main thread.  This causes the cancel to be ignored (correctly) and
    we end up in the second loop writing data until the disk runs out of
    space.  Fix this by repeatedly asserting the cancel flag in the second
    loop.

commit ced99cf69e55515a58b4651767bda4ab17c82776
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 26 14:09:39 2011 +0100

    Version 1.13.25.

commit d64fca7b848df36f2043a8af72aaa670e3c14c53
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 26 13:56:18 2011 +0100

    virt-resize: Be much more conservative about moving first partition.
    
    Commit 2910413850c7d9e8df753afad179e415f0638d6d caused Windows 7
    resizes to break with the 0xc0000225 boot error.
    
    Change the --align-first auto (default) option so that it is more
    conservative about when it moves the first partition.  In particular
    it doesn't move it if it's already aligned (as it is for Win7), nor if
    there is more than one partition (also Win7).
    
    Tested with: Windows XP, 2003, 7, Ubuntu 10.10 and RHEL 5.

commit 178a6d78a84a82cfddbf17678c8c8c2a9d9d0dd2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 26 13:55:38 2011 +0100

    Flush stdout for progress bars used by guestfish, virt-resize.

commit 119e67a92e74c3e657133c751a4f92d40924d787
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 25 19:03:38 2011 +0100

    virt-resize: Handle extended and logical partitions (RHBZ#642821).

commit f4b3351692c5740242414b6b84588a22094b75bb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 25 14:18:29 2011 +0100

    resize: Get the partition table type of the source disk earlier.
    
    Also we only permit MBR (DOS) and GPT partition tables.  In theory
    previously we allowed other partition table types, but it is unlikely
    that it would have worked in reality.

commit f223dfa29aafeb7b9a07bbedf03d15acddd62e92
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 25 22:49:55 2011 +0100

    New APIs: copy-{file,device}-to-{file,device}.
    
    The four new APIs:
    guestfs_copy_device_to_device,
    guestfs_copy_device_to_file,
    guestfs_copy_file_to_device, and
    guestfs_copy_file_to_file
    let you copy from a source to a destination, between files and
    devices, optionally allowing source and destination offsets and size
    to be specified.

commit 663b99950daeaa2b023520aae756a3a28969c493
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 25 14:14:35 2011 +0100

    ocaml: Make sure virt-resize, virt-sparsify are rebuilt if Guestfs API changes.
    
    Add a dependency so these tools are rebuilt from scratch if the
    Guestfs API changes.  This prevents the error:
    "[...] make inconsistent assumptions over interface Guestfs".
    
    This commit includes the generated changes to .depend files.

commit 51672634fddc20095adc1300e0bfee2c99c604f5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 25 12:47:16 2011 +0100

    virt-filesystems: Add MBR partition type byte to the output.
    
    This adds an extra column containing this information, looking
    like this:
    
    Name       Type        VFS   Label  MBR  Size  Parent
    /dev/sda1  filesystem  ntfs  -      -    6.0G  -
    /dev/sda1  partition   -     -      07   6.0G  /dev/sda
    /dev/sda   device      -     -      -    6.0G  -
    
    In particular you can use this to tell if a partition is an extended
    partition, because the field will contain '05' or '0f'.

commit 47412f137f2b09dbc2b44b78ba84c0b348e3f402
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 25 12:46:05 2011 +0100

    New API: part-to-partnum
    
    This converts a partition device name (eg. /dev/sda1) to a partition
    number (eg. 1).  This is useful in conjunction with the parted APIs
    that mostly take a disk device + partnum.

commit 1e891d900714b84a84f9c9e79c6e033aa56c0fcc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 25 10:55:20 2011 +0100

    virt-cat: Handle Windows paths and drive letters (RHBZ#693359).

commit 639232f2b0e2b6d537c8947ee51837d5509b1339
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 24 17:36:07 2011 +0100

    Version 1.13.24.

commit 3814680423984b3c46c2f99e944c2a71862bde9f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 24 13:24:16 2011 +0100

    Add test for qemu broken -machine option (RHBZ#748266).
    
    Also add this option, if necessary, when testing for virtio-serial
    support.
    
    When the workaround is enabled, we specify machine type 'pc'.

commit 35900223df1d05d0b8f4da79c854bee9899f81be
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 24 15:35:47 2011 +0100

    Revert "out-of-tree build: daemon"
    
    This reverts commit 025dba7f803419f510fd8f085ce693838af82878.
    
    If build and source directories are the same, you get this error:
    
    make[3]: Leaving directory `/home/rjones/d/libguestfs/generator'
    make[2]: Circular guestfs_protocol.c <- guestfs_protocol.c dependency dropped.
    make[2]: Circular guestfs_protocol.h <- guestfs_protocol.h dependency dropped.
    rm -f guestfs_protocol.h
    ln  guestfs_protocol.h
    ln: accessing `guestfs_protocol.h': No such file or directory

commit 21a4cf7ef54a8598126f39023a51ef43415679dc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 22 15:55:48 2011 +0100

    virt-win-reg: Document syntax for deleting keys and values (RHBZ#737944).
    
    NB: This requires hivex >= 1.3.2 before this syntax becomes true.

commit e192035bbd6f80262f60565e0a91588848f2a4e3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 21 22:48:10 2011 +0100

    virt-make-fs: Refresh man page.

commit c214cdc54e955ff1a01c00b99b0d6bd20e8b6bcd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 21 17:31:03 2011 +0100

    Fix ./configure --disable-erlang.

commit e7ea6d06ab4f203c8acb95f9df72ee0035d76941
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Thu Oct 20 14:20:56 2011 +0200

    out-of-tree build: fixed bindtests and inspector

commit aa67ea2b9b800305a00615f3a463cdd46eae9181
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Thu Oct 20 14:20:55 2011 +0200

    out-of-tree build: fix HAVE_OCAML=false case

commit 025dba7f803419f510fd8f085ce693838af82878
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Thu Oct 20 14:20:54 2011 +0200

    out-of-tree build: daemon

commit 31bf0cf313f21bdeb0d166c4c76aad050ad32232
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 21 16:29:20 2011 +0100

    add-drive-opts: Correctly handle unreadable and unwritable files (RHBZ#747287).

commit 0c06d740b77fb9225a0e2bd13dc88b0b88ee87cb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 21 16:02:34 2011 +0100

    virt-make-fs: Set MBR partition type byte correctly (RHBZ#746295).

commit 527079aa0db9b608ee4c25e7b3eccc4058685608
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 21 12:49:18 2011 +0100

    lib: Common code for formatting the qemu -drive parameter.
    
    This is just code refactoring.

commit f5172902bc9d92451c83dc3c1a85b5aeb975b43a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 21 12:28:45 2011 +0100

    Allow compilation without hivex (RHBZ#723474).

commit 9a6e5369b2134a3bd2a6decda48bbf5ac9d7cd41
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 21 12:15:36 2011 +0100

    po-docs: Force make update-po on first build from git.

commit b148df4df9f27162b2e1991c3fbeef070b2c343a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 20 22:18:03 2011 +0100

    Version 1.13.23.

commit fef0ff3d869d2ebdb48eea0c538270fc98f5952d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 20 23:04:41 2011 +0100

    appliance: udev-174 moves udevd to /lib/udev/udevd (instead of /sbin/udevd)

commit 2910413850c7d9e8df753afad179e415f0638d6d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 20 22:06:33 2011 +0100

    resize: Add --align-first auto|never|always option.
    
    The first partition can now be aligned.  We fix the bootloader
    correctly for Windows by adjusting the "Hidden Sectors" field.

commit 37cdd39ada139956f237b55c87c095bed622b5e3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 20 16:49:15 2011 +0100

    resize: Add --alignment flag to allow partition alignment to be picked.

commit 5d8e4102b46158f323fb1f6d76a342edcb997b73
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 20 14:46:11 2011 +0100

    resize: Refactor the code for creating target partitions.
    
    The old code mixed the business of planning the layout of the target
    partitions with the creation of the target partitions.  The
    replacement code separates these into two tasks: firstly we create a
    new 'partitions' list with the target layout, secondly this directly
    drives the creation of the partitions.
    
    As part of this change I have *removed* the old code that was supposed
    to handle extended/logical MBR partitions.  It simply didn't work, and
    didn't have any hope of working, and there is a separate bug open to
    fix it.

commit 9f198956047583e506713a4472117922f8b27b2e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 20 14:53:13 2011 +0100

    resize: Remove p_size field from partitions structure.
    
    This field simply contained a duplicate copy of p_part.part_size.
    
    There is no functional change in this commit.

commit 040b6cb061e510992c2b8f1ab97289f55c363ba2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 20 10:58:21 2011 +0100

    Update RELEASE-NOTES.

commit 41260de67f9fa852eab168a6d36276c5deb02bf7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 19 17:37:25 2011 +0100

    Version 1.13.22.

commit f354f9b4fd488a487f2c4c1e7b3770eba4332aed
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 19 17:12:07 2011 +0100

    Pushed and pulled latest translations from Transifex.
    
    Fixed one bug in the nl PO file:
    
    msgid "security: cached appliance %s is not owned by UID %d"
    msgstr "beveiliging: UID %d is geen eigenaar van toepassing %s in cache"
    
    should be:
    
    msgid "security: cached appliance %s is not owned by UID %d"
    msgstr "beveiliging: UID %2$d is geen eigenaar van toepassing %1$s in cache"

commit c46bedf925cd9c6c9a9cbaee115358fd1dffcbfe
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 19 15:43:37 2011 +0100

    inspection: Return root devices sorted.

commit 6aa3ece129d04a588ceb161c4b203a20664ddcd8
Author: Matthew Booth <mbooth@redhat.com>
Date:   Tue Oct 18 13:42:16 2011 +0100

    inspect: Handle cciss devices in /etc/fstab

commit f5c9f0e9ee1729b1260cef3e51ca91936e1868c4
Author: Matthew Booth <mbooth@redhat.com>
Date:   Tue Oct 18 13:30:40 2011 +0100

    inspect: Don't assume number of captures in match functions
    
    It is possible for the pcre library to return a variable number of captures for
    a single regular expression. e.g.:
    
      ^/dev/(cciss/c\d+d\d+)(?:p(\d+))?$
    
    This will return either 1 or 2 captures depending on whether the device has a
    partition suffix. The current match wrappers don't allow for this, and require
    that a predictable number of matches are returned.
    
    This change updates match, match1, match2, and match3 to ignore the specific
    number of matches returned. Instead, any returned captures are assigned to the
    given arguments, and any remaining arguments are set to NULL.

commit a1df33eac2c0a0a4fbb256871e491e28dd11ce90
Author: Matthew Booth <mbooth@redhat.com>
Date:   Tue Oct 18 11:01:01 2011 +0100

    inspect: Add drive naming hints
    
    We currently use a heuristic to guess how drive names we find
    referenced in the guest map to drive names in the appliance. If this
    heuristic fails it can cause inspection to fail.
    
    This change adds a new 'name' option to add_drive_opts, which allows
    the user to explicitly pass the name of a drive to libguestfs if it is
    known. This change also updates the fstab-parsing inspection code to
    use this information if it is available.

commit 1f615fddaffd33afc75a582021769583c8f4db4e
Author: Matthew Booth <mbooth@redhat.com>
Date:   Mon Oct 17 16:07:31 2011 +0100

    NFC: Remove unnecessary goto

commit f1041e912b72116d66274d2f15e50ce34a9531fd
Author: Matthew Booth <mbooth@redhat.com>
Date:   Mon Oct 17 15:28:47 2011 +0100

    launch: Store drive information in guestfs_h
    
    This is a NFC on its own, but provides a place-holder for drive metadata which
    can be used after launch.
    
    Fixes by RWMJ:
    
     - Fix the tests: this requires a new internal function 'debug-drives'
       that dumps out the g->drives information so it can be checked in
       two of the tests.  Previously these tests used 'debug-cmdline'.
    
     - Test file existence / use_cache_off in the add_drive_opts function,
       not when launching qemu in the child process.
    
     - Call free along error paths.
    
     - Add comments.

commit 472f02d08b077a5c1ee233d9dcef92ac9b09d4ae
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Oct 14 15:00:32 2011 +0100

    inspect: Fix fstab device mapping for >26 disks
    
    The regular expression matching disk name assumed that there was only a single
    letter suffix. This change handles a naming scheme for any number of disks.

commit 138e118d62046b197b715462072256082ecfc0f7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 19 15:20:19 2011 +0100

    launch: Ensure g->cmdline is allocated before assigning g->cmdline[0].

commit 2f6ec8b4da27c550e2c7187fd17df28f1bdd51a7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 19 13:42:59 2011 +0100

    valgrind: guestfish -i: free strings before exit.
    
    This isn't really necessary, but it keeps valgrind happy.

commit 6d7d645cdd4a9c94c4d95fc52de53c37b88847e4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 18 15:22:01 2011 +0100

    Ubuntu 11.10: Create /run and /run/lock if not already.
    
    In real machines these directories are a ramdisk.

commit b288a1b9718d72f2e4ad0e7c2015123f963fcb06
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 17 15:26:43 2011 +0100

    virt-sysprep: Fix link in documentation.

commit cf4cc1143393d607a7fb4cdbee1434544237d5d4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 17 09:59:43 2011 +0100

    Skip guestmount and virt-sysprep tests if no /dev/fuse.

commit 8cf06ddcddf1fda3a189667dbaaa4560ba49df3c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 15 17:51:16 2011 +0100

    virt-sysprep: Fix test to use guestmount and virt-inspector binaries that have been built.

commit af0c123be8cc62acf9e1368b1d00acccdd6d91e9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 14 22:08:20 2011 +0100

    appliance: Fedora cryptsetup-luks renamed to cryptsetup.
    
    Therefore we need both names to be listed in the file.

commit db499d98e7a290ccbfc4fb333f85021b23155e9d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 14 22:08:14 2011 +0100

    roadmap: Fix Bugzilla URL.

commit bd1cc1273105b4f88a6132aafa8a67af7dcccff7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 14 18:22:46 2011 +0100

    More TODO items.

commit 8b2ebe07c2f7a4943e6891d642850c03ba2e6b34
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 14 18:14:59 2011 +0100

    Update RELEASE-NOTES file.

commit 782a2e0299b0c22155f0c115f94903c519040247
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 14 15:14:57 2011 +0100

    Version 1.13.21.

commit 91730ce7fa648bd835f48dc7a8051939ae317613
Author: Erik Nolte <erik_nolte@acm.org>
Date:   Thu Oct 6 15:56:40 2011 -0600

    Use ArchLinux's new kernel package "linux".

commit f25d2300ce0206b3d4ef5e38d0314d86ea20136e
Author: Michael Scherer <misc@zarb.org>
Date:   Fri Oct 14 01:05:05 2011 +0200

    Add basic support for netbsd detection.

commit 8f6eed00da59614184090e56edef6884f187b436
Author: Michael Scherer <misc@zarb.org>
Date:   Fri Oct 14 01:05:07 2011 +0200

    Add support for pkgsrc, default NetBSD package manager.
    
    For now, only detect the tool, but support from reading
    installed package could be added later ( may require either
    a package of pkgsrc, or a smaller tool to read the db ).

commit 05a8359c7cf98fdcf75628299dd3e64401f07ee4
Author: Michael Scherer <misc@zarb.org>
Date:   Fri Oct 14 01:05:06 2011 +0200

    Add support for mounting ufs from NetBSD, and fix FreeBSD detection on Fedora 16
    
    While testing on Fedora 16, I noticed that Linux will mount the disk
    without trouble by using automatically ufstype=old, and yet do not
    let us read the directories. So we should start directly with usftype=ufs2,
    and if it fail, try 44bsd, as used for netbsd and openbsd ( as seen on
    http://wiki-static.aydogan.net/How_to_mount_FFS_partition_under_Linux ).

commit 15d79b5ea95ba28ebf6d8bb7542d86702edc1e8f
Author: Michael Scherer <misc@zarb.org>
Date:   Fri Oct 14 01:05:04 2011 +0200

    Add the Opensuse logo ( thanks to Vincent Untz )
    
    Like Ubuntu one, it may not be always present.

commit 5332515db3ed87716d702ef2b973816a73ab5702
Author: Michael Scherer <misc@zarb.org>
Date:   Fri Oct 14 01:05:03 2011 +0200

    Add Opensuse and zypper detection support
    
    This would also erronously detect SLES as Opensuse.

commit 1d0683964f996b24b8fcf5bce7611a98443344f3
Author: Michael Scherer <misc@zarb.org>
Date:   Fri Oct 14 01:05:02 2011 +0200

    Add support for Ubuntu logo
    
    Ths logo is present on Lucid Lynx, but may not always be installed, like
    in case of a minimal installation ( or server ). While Edubuntu and Kubuntu
    have different logo, I didn't check where it would be placed.

commit 7d4a99db87b9fe9373b482092db88610fb796012
Author: Michael Scherer <misc@zarb.org>
Date:   Fri Oct 14 01:05:01 2011 +0200

    Detect Mageia distribution

commit 787baf1bad89aecf4d01738fb8344e4446eb5ba1
Author: Michael Scherer <misc@zarb.org>
Date:   Fri Oct 14 01:05:00 2011 +0200

    Partially fix --disable-erlang
    
    Without this, configure will always enable erlang, no matter what
    argument are passed. Now, we can disable it, even if configure still
    need the erlang compiler for some obscure reason.

commit c019d073a4f218b538d5176500b014e83dbce84f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 14 08:36:00 2011 +0100

    virt-sysprep: Add cron-spool, mail-spool, utmp.

commit 05c26a9c099fe7616c95daaa3d473ee23f93e1b1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 13 23:30:13 2011 +0100

    virt-sysprep: Use /dev/urandom instead of /dev/random.

commit 248465a6206dd3881adebcd2c17ea0a0c2f59742
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 13 23:29:58 2011 +0100

    virt-sysprep: More clarifications to the man page.

commit 42f3abe42d601c5d0a1521a36db54dea705a03c7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 13 23:24:28 2011 +0100

    virt-sysprep: Clarify docs on enabling operations.

commit dd73c50dc5439c3e16f1322dce69b1f17af485da
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 13 23:20:27 2011 +0100

    virt-sysprep: Add rhn-systemid.

commit 9e382f1ae33ed25f012596b801e9cc4a440cb74b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 13 15:37:56 2011 +0100

    virt-sysprep: Switch to using guestmount, add more features.
    
    This switches virt-sysprep to use guestmount instead of guestfish.
    This makes the script a little bit easier to modify for sysadmins.
    
    This commit also adds:
    
     - dhcp-client-state
     - dhcp-server-state
     - logfiles
     - random-seed
     - smolt-uuid
     - yum-uuid
    
    SELinux relabelling, and a section on security in the manual page.

commit 189c3d6ac1e3fbd4f8ffbaafdc36b8ad00961284
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 13 15:07:41 2011 +0100

    virt-sysprep: Use Augeas for config file manipulation.

commit 17b26be2325348da1c7f6edf28397b8e45e9e499
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 13 14:30:35 2011 +0100

    virt-sysprep: Add prepend_line utility function.

commit 11be7d8eee16e6249ed2868b5bd552f29508ec02
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 13 11:56:52 2011 +0100

    fish: docs: note how to clean up the remote process properly.
    
    Killing it is always a bad idea, because the qemu subprocess will be
    left hanging around.  The best thing is to send the exit command.
    
    This also makes the change to virt-sysprep.

commit baa1618e0f917017c1934b7da41250029c1791ef
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 13 11:54:18 2011 +0100

    fish: Close guestfs handle explicitly before exiting.
    
    NOTE this is just a cleanup.  It is NOT necessary for correctness,
    since libguestfs itself is correctly closing the handle in the exit
    handler.

commit 049116e1810680275a42faba430fb2f798cb17d8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 13 11:34:04 2011 +0100

    virt-sysprep: Trap ERR as well as EXIT.

commit e57c3c37a8648966e19ef33832f353d0f9487a77
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 13 11:13:05 2011 +0100

    guestmount: Add note to man page about 'fuse' group for Debian.

commit f6db819081a47b038d473cc1c1fd9743410c42a9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 13 11:09:31 2011 +0100

    virt-sysprep: Simplify calls to guestfish --remote.

commit 2135ec267eef87532fbdb346e68a4d1570b045e9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 13 10:36:24 2011 +0100

    virt-sysprep: Further TODO items (thanks Nikita Menkovich).

commit a78a3dea887841c03bfa0d40bab8d1882a00b3f8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 13 10:36:24 2011 +0100

    virt-sysprep: Further TODO items (thanks Marko Myllynen, James Antill).

commit 0beebeb6225bd868fe36b28ff8ad15bfb8c6028e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 11 20:59:29 2011 +0100

    Version 1.13.20.

commit fe31f1897b3550d8fab68992aad27de429d1580c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 11 19:20:53 2011 +0100

    virt-sysprep: Update TODO list again.

commit 92dc3748b6c236f09e7c699d4f841459fff4851c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 11 18:04:46 2011 +0100

    virt-sysprep: Update TODO list (thanks Steve Grubb, Dan Berrange).

commit e6ed656c98f4c0781090a7ee4337267923754dbd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 10 15:13:40 2011 +0100

    TODO: More virt-sysprep suggestions (thanks librarian).

commit c155330f04f933d13298d5cddab6b7f3dc9d218f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 10 13:26:15 2011 +0100

    Add systemtap/DTrace probes.
    
    Mainly this is a documentation change.  However a sample of
    DTrace-compatible userspace probes are also added.

commit d6622d7636d592eb1c01fbcb8b8ad52c2b20615b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 10 09:51:03 2011 +0100

    Update TODO file with future plans for virt-sysprep.

commit c49819f9b3a29329da87e2001d8025b3842bb0db
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 8 13:59:13 2011 +0100

    Version 1.13.19.

commit 1e35941f62bddafd6b88270b22b3afe4a5d37baa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 7 19:22:11 2011 +0100

    New tool: virt-sysprep: system preparation for guests.

commit 3a546663655abfcd6399d4fdb7febc6b0d83b822
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 7 19:20:36 2011 +0100

    fish: Add man page section on calling guestfish remote robustly from bash.

commit df711241fff32036acbc3fae10486816cbdd8ef9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 7 13:52:39 2011 +0100

    virt-alignment-scan: Fix SYNOPSIS in manual page.

commit c6be95453d66ea714a9813a21cfb224d8e346d9e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 7 13:42:27 2011 +0100

    Makefile.am: Fix comment.

commit ffe0e11b4d3db16f0b6632add24db89349279e69
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 6 17:37:01 2011 +0100

    virt-alignment-scan: docs: Add link to RHEL Storage Administration Guide.

commit 8daa036857868775f31c08526d2892a0dc200dce
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 6 10:23:38 2011 +0100

    virt-alignment-scan: More information in man page.
    
    Thanks Mike Snitzer.

commit 74e4e86309c837e172e389ca45d10cebf42e215e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 6 10:22:16 2011 +0100

    virt-resize: Align partitions to multiple of 128 sectors (instead of 64).
    
    This gives us effectively 64 KByte alignment, optimal for all current
    types of storage.

commit 36d8bbb8586bbe571739a79de071edd392001963
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 5 19:12:34 2011 +0100

    Update RELEASE-NOTES file.

commit e59e35708b4ad66c99f908c5226cb232931e1791
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 5 18:13:38 2011 +0100

    Version 1.13.18.

commit b4bb49ffd123e36d6319281dcc2080b30e23e447
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 5 15:06:10 2011 +0100

    New tool: virt-alignment-scan to check alignment of partitions.

commit f3341222b37f91d7f7fcdafe30b107ea9da9ad02
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 5 14:38:07 2011 +0100

    docs: Add directory sections for resize/ and sparsify/

commit ca8c2b599663563976d83766182ab8cf0722c755
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 4 22:42:42 2011 +0100

    Update RELEASE-NOTES file.

commit b0605f265be3f501930516ff95deab2910ced3ac
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 4 20:00:42 2011 +0100

    sparsify: Fix --ignore option to work on canonical device names.

commit b3f61a9db39a639b7e462581cb5e177c778de354
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 4 20:00:21 2011 +0100

    docs: Clearer language in virt-sparsify man page.

commit 4abb239dcc7b1d235783bb0b5e417c4b88b00fea
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 4 19:24:42 2011 +0100

    Version 1.13.17.

commit fac15924f59a076c903d453d20305e00e1ae258a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 4 11:02:30 2011 +0100

    New tool: virt-sparsify to make disk images sparse.

commit 293772bf7511dee41a1f3e842424678c1a6bf9e4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 4 10:58:25 2011 +0100

    docs: Add virt-resize to list of links in guestfs(3).

commit b39b3c5c74f1dfb88a6074aac476df877f1bfc4d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 4 10:58:02 2011 +0100

    docs: virt-win-reg is written in Perl, not virt-resize.

commit b57fcc5064ea87a836bcff188bc614f1dc2b619e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 4 10:57:05 2011 +0100

    Update API support documentation.

commit 2628fa96d8ed5e95ac866abc9b849cc183e596f3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 1 14:35:05 2011 +0100

    Version 1.13.16.

commit b1f7b5f911dc65f39e0c3297a4dfa566c1d5b8ba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 1 10:42:05 2011 +0100

    mount: Not deprecated any more.
    
    This updates commit 5c2f1a2d9433eeb5aebeec26f0412c703bbe7269.

commit 5c2f1a2d9433eeb5aebeec26f0412c703bbe7269
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 1 08:20:50 2011 +0100

    mount: No longer implicitly add -o sync,noatime options.

commit 4e9ed018475ff4bd5171ed50a47ffae7abbdda4b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 29 16:08:20 2011 +0100

    daemon: mkswap --help output changed, breaking linuxfsuuid group detection.

commit d020350c3131f5d0e422f502b4810025a6fc0f11
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 28 22:13:27 2011 +0100

    Version 1.13.15.

commit 04fbcc63ebf5718608f199eb6b09061cd32283c3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 28 14:39:31 2011 +0100

    New API: set-smp, get-smp
    
    These calls allow you to change the number of virtual CPUs assigned to
    the appliance.
    
    This also adds a --smp option to virt-rescue.

commit 8403f5a9d8f1451e2c2b029b51bac18724b18ebf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 28 11:14:06 2011 +0100

    New APIs: compress-out, compress-device-out.
    
    These APIs let you copy compressed files or devices out from the disk
    image.
    
    Compression is useful for large images which are mostly zeroes.  We
    cannot currently do sparseness detection, and compression gives us a
    form of zero detection for free.
    
    Example usage:
    
    $ guestfish --ro -a /dev/vg_pin/F16x64 -i \
        compress-out gzip /etc/passwd /tmp/passwd.gz
    $ file -z /tmp/passwd.gz
    /tmp/passwd.gz: ASCII text (gzip compressed data, was "passwd", from
    Unix, last modified: Sun Aug 28 14:40:46 2011)

commit ffc01285ee4289da90983a3320873f27b3d31c4d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 28 14:17:53 2011 +0100

    daemon: Move useful is_zero function to header file.
    
    Code motion.

commit 322106521f546d7c70c5a38255db7d243a456a6b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 26 13:34:12 2011 +0100

    Add no_timer_check to disable faulty test during boot (RHBZ#502058).
    
    See:
    
    https://bugzilla.redhat.com/show_bug.cgi?id=502058#c15
    https://bugzilla.redhat.com/show_bug.cgi?id=698842#c8
    
    This updates commit 79e66f89e2f6c27486476d7857da58feb491bf5c.

commit 3c7b3634b2c86a4c41fec044ccb59a1fe3224e66
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 26 09:58:46 2011 +0100

    docs: Show how to use a qemu wrapper to edit the qemu command line.

commit 67030c6ef2b89ab98ed30d2ddc8a180c28395312
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 24 22:32:46 2011 +0100

    Version 1.13.14.

commit aa88c1bbd2691a0f84bfcce07e8a0906aaf72d39
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 24 18:50:00 2011 +0100

    Update to latest gnulib.

commit fa13b2838fd32854a4b2c6a5fff47e17a72294fb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 22 14:41:46 2011 +0100

    erlang: Use the official autoconf macros.

commit 8324d2fcf00d5f3d6bc0f10ae61bbfd7c1961d93
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 21 22:28:11 2011 +0100

    todo: Suggestion to improve Erlang bindings.

commit 79e66f89e2f6c27486476d7857da58feb491bf5c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 21 19:31:10 2011 +0100

    Enable APIC.
    
    Originally this was disabled to work around RHBZ#502058.  That bug was
    never officially fixed, but it may have fixed itself.
    
    In the meantime, KVM has broken ordinary PIC support (RHBZ#723822).
    Since APIC is the most common way that regular Linux and Windows
    guests run it makes sense to remove this hack.

commit 660daf31e23f2f7c65f29e1d57019af9ea9eba99
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 21 15:12:28 2011 +0100

    Version 1.13.13.

commit 84763d7fca3668c62ee3fe53d0e00a5a672f687b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 20 18:03:58 2011 +0100

    Add Erlang bindings.

commit 917f947590c92318fee2545ba88245d0de012e31
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 16 15:26:20 2011 +0100

    inspection: Handle /dev/root in /etc/fstab.
    
    This means "the device that holds /etc/fstab", so map it correctly.
    
    This fixes support for ttylinux and also some other guests that use
    /dev/root instead of a real device name.

commit b648b1813fc8e55db790435b5414d9be3ec765d2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 16 15:21:26 2011 +0100

    inspection: Add support for ttylinux (a minimal Linux).

commit 99624d29226ece1abbbdd921183b360f5f80de91
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 15 22:02:43 2011 +0100

    Add an optional group ("grub") for the guestfs_grub_install API.
    
    This also improves the documentation for this call, pointing out
    several pitfalls in using it.
    
    This unfortunately breaks existing callers that might use
    guestfs_grub_install without checking for this new group.

commit 8d8ace19da61dd8bae7f2bfa64966c80ddf0cb2d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 14 18:56:38 2011 +0100

    Version 1.13.12.

commit bddde7799b80b8292879634548c3c92a3cc1c044
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 14 13:52:39 2011 +0100

    test-tool: Display TMPDIR.

commit cda7fa973cbdd5fc4ad3974dcc6b5ea02ec6bb44
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 14 13:19:11 2011 +0100

    test-tool: Refresh libguestfs-test-tool man page.

commit 912284b02e28bd63bdf3397ef841b9782adfd2cd
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 14 13:00:34 2011 +0100

    test-tool: Make the default timeout be 600 seconds (10 minutes).
    
    We could sometimes hit the 120 second timeout, eg. if the appliance
    needed to be rebuilt and the machine was very slow and/or under heavy
    I/O load.  10 minutes should be enough for any reasonable situation.

commit 95136b149212b92e87d0c9badb7d6849a084ed4d
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 14 12:58:43 2011 +0100

    test-tool: Document the -t command line option.

commit c7b88da039725ecd0d1d826b112bc69b518d4c78
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 14 12:58:30 2011 +0100

    test-tool: Use B<...> for command line options in man page.

commit 7c521c7211d61a1bac46c155de1f4d3e8b60b3d7
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Sep 12 11:36:00 2011 +0100

    po-docs: Make podfiles sort stable.

commit cbef2ffb0432756822cd2b02a305384f814e9b50
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Sep 12 11:33:19 2011 +0100

    Stable OCaml dependencies.

commit b3f1457fddd19b1e540866fa01c665aeb371cb44
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 7 15:21:37 2011 +0100

    docs: Add a section explaining the appliance boot process.

commit 504b9d95c4afdc83efd5cca6d98cb73111e8c652
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 1 14:55:18 2011 +0100

    Version 1.13.11.

commit 8ab2b85b2a67270b8cc5a91bb62a70c84cd6a02c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 1 13:37:20 2011 +0100

    Remove old regression test that mainly tested a buggy API.
    
    The guestfs_ll command currently lists files in the appliance if you
    prefix filenames with "/..".  However this is a bug, not a feature,
    and we should not be testing it.

commit 8928de32d391e3ad4dd98bb27472c27bb8bc38ac
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 1 13:15:13 2011 +0100

    debian: Missing build dependency on db4.8-util.

commit 73be6db9bf1c0ae96262a5f4fa9328bb4e648637
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 1 12:59:15 2011 +0100

    daemon: Factor out name of virtio serial channel.
    
    This is just code motion.

commit 5b012024c49672cc69635ff01f9b9e4f87de1c65
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 1 12:58:30 2011 +0100

    Create /sys directory if it doesn't exist already.
    
    Ubuntu 10.04 LTS packages don't create /sys.

commit eb209a3664906257b3dc87b6f7b04ff54e0d1288
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Aug 28 17:58:34 2011 +0100

    Version 1.13.10.

commit 085a56690611980f438e8af2eb47ebb411465775
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Aug 28 17:35:34 2011 +0100

    cat: Small documentation correction.

commit baefb8225c8cbde56a1637c17af5c0965a81060e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 27 17:53:03 2011 +0100

    inspector: Use xmlstarlet instead of xpath in examples.

commit f0f3e1621180724e0a907a30ff5dea9695ddead0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 27 17:47:10 2011 +0100

    man pages: Add a standard EXIT STATUS section to most pages.

commit 69abc787dddbf7855c2871f7f1432563a6af92a1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 26 22:55:09 2011 +0100

    Version 1.13.9.

commit ceb3a57f67f33b33c1f6cafdd0ef81808273f0c0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 26 22:40:27 2011 +0100

    progress: Make default UTF-8 progress bar less black.

commit 09a7545649e6cac0de2c4421cb64b659164174ee
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 26 22:34:49 2011 +0100

    resize: Add --machine-readable option for machine friendly output.

commit 75005e48bb54f25dcc99480d659dfe9353382a15
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 26 22:03:47 2011 +0100

    progress: Add machine readable flag.
    
    Machine-readable progress bars look like:
    
    0/100
    1/100
    2/100

commit 2faef37957629e0436308e759211209e5e823ee0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 26 19:21:23 2011 +0100

    resize: Use guestfish progress bar mini-library.
    
    There are two benefits:
    
     - the progress bars look better
     - there is a reasonably accurate estimate of how long each operation
       will take

commit 9420eaf44ec4067c3740b91b0be0fede08a0c515
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 26 20:28:20 2011 +0100

    Add GUESTFS_EVENT_ENTER event.
    
    This event is generated whenever a libguestfs function is called.

commit 6146412f06c2f6f33c3ea7d571f16d4fe71dddb2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 26 18:17:39 2011 +0100

    fish: Make progress bars into a mini library.
    
    This library could now be called from other virt tools.

commit 0bd055316f8581f4da33b039e33d5f61cc00294c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 26 17:39:06 2011 +0100

    fish: clarify comment: shared source files are used by virt tools too.

commit d64ad1a403ca9dbe81856ba6b78a464c5397af45
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 26 11:54:05 2011 +0100

    Version 1.13.8.

commit 1a4f1df77eecee053eaae35d5544f151d37342e2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 25 13:56:09 2011 +0100

    ruby: Check Ruby callback exists before we call it (RHBZ#733297).

commit 675f336319058fdbaf11ee004968b4543a5a9815
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 25 13:25:07 2011 +0100

    ruby: Use a regular C array to pass the arguments through rb_rescue.

commit 0cd5b9ac15c62eb570ec74d19b4aebde4990fd82
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 25 13:11:28 2011 +0100

    ruby: Append newline character after printing exception in callback.

commit 54911bdd325393d1f7f2861f298463c364b45469
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Mon Aug 22 20:42:09 2011 +0200

    python: Newer versions want parentheses around arguments of "print"

commit d36504e1bbe7d1379b7dd7b97ae2fcb0d78d9a83
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Mon Aug 22 20:42:08 2011 +0200

    python: Don't build static library

commit 4e196ad9a374ecef8a39af3ef028fc593d3b1a46
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 23 20:36:52 2011 +0100

    Version 1.13.7.

commit 4fb3b23fb69e4274f434f9258e38f185426298f7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 23 20:21:29 2011 +0100

    php: Fix bug in PHP tests.
    
    We partitioned the disk, and then tried to create a PV on the whole
    disk.  LVM gave the error:
    
      Device /dev/vda not found (or ignored by filtering).
    
    It is unclear how this bug persisted for so long.  It might be due to
    a change in LVM.

commit ce18be33cd5279a8d4120eedd037400c275585c0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 23 19:50:11 2011 +0100

    Coverity: fix memory leak along error path.

commit a31ac8fc32297cc9185fd20a5578d2bc81cc1bce
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 23 19:29:46 2011 +0100

    Coverity: Initialize msg buffer.
    
    msg_flags was not being initialized and would have been passed to
    sendmsg with a random value.

commit c38cb92ec478c4dca83e4d38963720f463d52314
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 23 19:26:35 2011 +0100

    Coverity: fix memory leak in guestfish.

commit b2edcbe1b9c9d161e96cb56d0efd944e84d84526
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 23 19:19:13 2011 +0100

    Coverity: in daemon, free struct in RStruct, RStructList functions.

commit 631faad97171d7c1238b2e413c663cf61476f440
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 23 18:56:12 2011 +0100

    pclose: Fix other places where we only tested pclose == -1.
    
    pclose can return > 0 when the status of the command was non-zero.

commit f15961911316460f7d45342d63c2d784a483f0d1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 23 18:53:38 2011 +0100

    test_qemu: Improve the error message.
    
    Note that errno is probably not set to a useful value here, so there
    is not much point recording it.

commit a24652c7b27e8494268ccb6c9a5a2e5541ba5efd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 23 18:53:00 2011 +0100

    test_qemu: pclose may return any != 0 on error.
    
    In particular pclose returns a status > 0 if the command fails.

commit 2ace9be4cd69e84cd88e5b0fd74de861a4973c91
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 23 18:43:24 2011 +0100

    qemu detection: Free up previous qemu help/version strings if they exist.

commit 08e77ad8cb4e8ac70d4217ebd5d236eba81645b5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 23 18:02:24 2011 +0100

    Coverity: test_qemu: Ensure FILE * is not leaked along error paths.
    
    This refactors the code in test_qemu slightly to ensure that
    FILE *fp is not leaked on error paths.

commit fa44536b0ff12102c72ae0337e51d272f0fc2353
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 23 16:47:18 2011 +0100

    Coverity: Check guestfs_inspect_get_product_name() != NULL before using.

commit 00fef9eed6a53e10a975814beef775483ff0b3dd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 23 16:41:07 2011 +0100

    rescue: Ignore errno after guestfs_launch.
    
    errno is pretty much random on the error path back from guestfs_launch
    so there is nothing useful to be gained by checking it.
    
    We could do with a better way to detect if appliance launch failed.

commit 9bab154d48e367702b65852c3c822341b474ffd2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 23 16:34:06 2011 +0100

    Coverity: Ignore return value from guestfs_launch in virt-rescue.
    
    We expect guestfs_launch to fail in this program.

commit 4c76aaa391d591c5917a06b0277fb9eb7d6d790f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 23 16:12:27 2011 +0100

    Coverity: Check return value from sscanf in bindtests calls.

commit ca727deac186981f4d9784696324c8f3af79f9e5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 20 11:41:10 2011 +0100

    autobuild: Only add last 100 lines of the log file.

commit 6375aede61d57422ad82f4941693493c07b78aa2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 20 10:49:35 2011 +0100

    New autobuild script.
    
    Remove the old top-level autobuild.sh that confused a lot
    of people.
    
    Add an autobuild.sh script that builds from the latest tarball.

commit a4db75521d6026410425187fc2c5c9cb931a69b5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 19 21:48:44 2011 +0100

    configure: Add --with-extra flag to allow setting the extra version string.
    
    Intended use in Fedora and RHEL is to encode the release
    string, eg.
    
      ./configure [...] --with-extra="-%{release}"

commit 7a5f7311d46ac87532e57aa5be9234acd18bdab8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 19 10:38:30 2011 +0100

    Version 1.13.6.

commit e4cba8f2b1a68e7361ce342ff659cccb0490446e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 18 19:13:32 2011 +0100

    protocol: Fix case where download can fail for small files.
    
    There is another case where downloads of small files could fail if the
    library side (writer) fails.  In this case the library would send back
    a cancellation, but it would be received after the daemon had finished
    sending the whole file (because the file is small enough).  The daemon
    would reenter the main loop and immediately get an unexpected cancel
    message, causing the daemon to die.
    
    This commit also makes test-cancellation-download-librarycancels.sh
    more robust.  We use Monte-Carlo testing with a range of file sizes.
    Small file sizes should trigger the error case.

commit 06019bc82e107f7715ebc59e491610e06dad1e39
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 18 17:46:50 2011 +0100

    Escape special/non-printing characters in debug output (RHBZ#731744).
    
    The default event handler in libguestfs was simply writing all debug
    output directly to stderr.  However if the output contains
    non-printable characters such as terminal control codes then these
    would also be sent directly.
    
    With newer SeaBIOS there is a lame attempt to implement a splash
    screen using terminal control codes, thus when libguestfs tries to
    display debugging output it would cause the screen to clear and debug
    output to be lost.
    
    This commit causes all non-printing characters to be escaped.
    (\n and \r characters from the appliance are treated somewhat
    specially).
    
    Furthermore, instead of using write(2), use buffered stderr calls.

commit 635af5be04265f845186b40e9a9fe7b102ad6909
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 18 17:41:09 2011 +0100

    Remove guestfs___print_timestamped_argv.
    
    This function was used to print the qemu and
    febootstrap-supermin-helper command lines.
    
    Unfortunately in the qemu case it was used incorrectly: it called the
    internal debug function (ie. event API callback) from the forked qemu
    subprocess, which meant that higher level event callbacks might have
    been invoked from the child process.
    
    To fix this, convert the qemu case into a new function called
    print_qemu_command line which just prints the command line directly to
    stderr.  This is called after stderr has been redirected into the pipe
    to the main process.  Thus the qemu command line will be marshalled
    into the event API along with other qemu and appliance output.
    
    After fixing this, only one use of guestfs___print_timestamped_argv
    remained, for printing the febootstrap-supermin-helper command line.
    This is converted to a local function print_febootstrap_command_line.
    
    Also print_febootstrap_command_line is now called before we fork
    febootstrap-supermin-helper, so that messages no longer overlap.

commit 70c033998e0e721dc4f9eb2a20348098b259752c
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Thu Aug 18 00:14:46 2011 +0200

    out-of-tree build: generate ./run from template, fix image checks
    
    ./run can now be run in a separate build directory. Since some files
    needed in the image checks are found in the source tree (but not the
    build tree), the source tree location is passed to make-*-img.sh via
    an environment variable.

commit 5d296dfd609fb1aa865109b1040a4d5bf2981e60
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 17 12:21:35 2011 +0100

    Version 1.13.5

commit 85efbc6aa70d522af066a38fd1aae05b790c46d3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 17 12:41:41 2011 +0100

    fish: Add fish-cmds.h to generator_built.
    
    This updates commit 3064277680ad11f887691646d0fa17bb35f38c19.

commit 0938e43a60f9d729d9795cf45498e60217fece0e
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Wed Aug 17 00:42:00 2011 +0200

    out-of-tree build: fix make and make install
    
    $(srcdir) is not needed for guestfs_c.c.
    *.mli only exists in $(srcdir) and isn't found on "make install" otherwise

commit 8876b2d3764b42ebae3c5fdf61b1899095508169
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Wed Aug 17 00:41:59 2011 +0200

    out-of-tree build: fix documentation generation II

commit 4baec012b1b09a888e570fc89dbaa9fbf9944f34
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Wed Aug 17 00:41:58 2011 +0200

    out-of-tree build: remove unneeded explicit paths

commit 5a50c04906828f6e99db6a9be420c84114476d39
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 16 12:39:28 2011 +0100

    Improve zeroing and detection of zeroes.
    
    This code modifies zero, zero-device, is-zero, is-zero-device.
    
    zero and zero-device are modified so that if the blocks of the device
    already contain zeroes, then we don't write zeroes.  The reason for
    this is to avoid unnecessarily making the underlying storage
    non-sparse or (in the qcow2 case) growing it.
    
    is-zero and is-zero-device are modified so that zero detection is
    faster.  This is a nice side effect of making the first change.
    
    Since avoiding unnecessary zeroing involves reading the blocks before
    writing them, whereas before we just blindly wrote, this can be
    slower.  As you can see from the tests below, in the case where the
    disk is sparse, it actually turns out to be faster, because we avoid
    allocating the underlying blocks.
    
    However in the case where the disk is non-sparse and full of existing
    data, it is much slower.  There might be a case for an API flag to
    adjust whether or not we perform the zero check.  I did not add this
    flag because it is unlikely that the caller would have enough
    information to be able to set the flag correctly.
    
                                    (Elapsed time in seconds)
    Format  Test case                 Before     After
    
    Raw     Sparse                    16.4       5.3
    
            Preallocated zero         17.0       18.8
    
            Preallocated random       16.0       41.3
    
    Qcow2   preallocation=off         18.7       5.6
    
            preallocation=metadata    17.4       5.8
    
    The current code uses a fixed block size of 4K for reading and
    writing.  I also tried the same tests with a block size of 64K but it
    didn't make any significant difference.
    
    (Thanks to Federico Simoncelli for suggesting this change)

commit 1fdd0193fd63af71359748915a0326d623a3d6ad
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 15 14:55:10 2011 +0100

    recipes: Remove two C file dependencies which are not actually used in the POD.

commit 0241c753937e577d51a070f7db471260bf931f9c
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Sun Aug 14 10:58:13 2011 +0200

    out-of-tree build: fix building library

commit 900c9626b9d4f567b21aae433493b4b3b1d09f6d
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Sun Aug 14 10:58:12 2011 +0200

    out-of-tree build: Fix up OCaml bindings and generator

commit 36e0f35a5828458ebeaf72999b3461ab66a230d8
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Sun Aug 14 10:58:11 2011 +0200

    out-of-tree build: fix appliance

commit ff101adf7ead7bcdb46bccdb227ef18d844b965f
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Sun Aug 14 10:58:08 2011 +0200

    out-of-tree build: fix documentation generation

commit 44c3a300265ef7bfa5d49d2b9a2a8faccd9db2de
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Aug 14 22:07:54 2011 +0100

    ruby: Fix typo in Ruby bindings file.

commit 7739d7f471f9575828bd32489695d92dde005a9c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 12 11:17:16 2011 +0100

    Note that additional memory may be required to typecheck Augeas lenses (RHBZ#729887).

commit 6cabc1cd02e181063596b48df55c3f6db51a6bb9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 12 11:08:57 2011 +0100

    fish: Document that remote run in cmd substitution context hangs.
    
    This documents bug 592910.

commit 2ecaa1f82dbf0731319fa917821d08f470133829
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 11 22:52:06 2011 +0100

    Version 1.13.4.

commit b9838001015a06a69a08b69d9f013d82f0ea3139
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 11 11:45:25 2011 +0100

    Fix 'unknown filesystem' warnings in old inspection code (RHBZ#678231 RHBZ#666578).
    
    This is a comprehensive fix for the warnings from the old (and
    obsolete) Perl inspection code.  For a full description and
    reproducer, see:
    
    https://bugzilla.redhat.com/show_bug.cgi?id=678231#c5

commit 2c57305f72cd6181d1849ae6e1b892aa01c7f844
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 8 18:52:23 2011 +0100

    inspection: Better checking for Windows root disks (RHBZ#729075).
    
    Previously any disk that had /autoexec.bat or /boot.ini or /ntldr
    would be picked up as a candidate for a Windows root disk.  If further
    checking could not find any systemroot (eg. /windows) then this would
    result in complete failure of inspection.
    
    In particular, this got confused by Hp_recovery partitions which have
    /autoexec.bat, but don't have a systemroot in one of the usual places
    (they have /MiniNT instead).
    
    What we do now is to properly investigate all possible systemroot
    places before deciding this is a Windows systemroot, so the subsequent
    failure cannot occur.
    
    (Thanks to lorimar for reporting this bug).

commit f7d18c84dde596699ffc5100fec2cf7b0d582450
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 8 12:41:54 2011 +0100

    build: Set TMPDIR for local testing.
    
    This avoids conflicts with the globally installed libguestfs
    appliance, or lets us build in multiple local directories at the same
    time without conflicts.

commit 54ea124b160eda705c96dfc664b4056848887856
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Aug 7 23:11:37 2011 +0100

    Version 1.13.3.

commit f133f1bb9da2268af2b198d82e2ca191375d5f11
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Aug 7 23:10:50 2011 +0100

    daemon: Don't include .gitignore in EXTRA_DIST.
    
    This updates commit 60d5a50f4d3d9e2c2f5a7d42a6859de709bda3f6.

commit 23793d768096427e9e2658689373efcfa0c2dc54
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Aug 7 21:05:13 2011 +0100

    fish: Add setenv and unsetenv commands.
    
    These commands allow you to manipulate the environment within
    guestfish.

commit 3064277680ad11f887691646d0fa17bb35f38c19
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Aug 7 21:04:00 2011 +0100

    fish: Declare run_* functions in a generated header file.
    
    Calls to these functions are generated, so there is no need to declare
    the functions by hand.

commit 18ee38e1eac132b91706771285d1764641179804
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 6 16:04:36 2011 +0100

    docs: Move deprecation notice up to the top in C man page.

commit f351a144d72ba3c86d49a259a89cea64f9639875
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 6 16:00:01 2011 +0100

    docs: Emphasize deprecation notice in man pages.

commit 60adf092a8900323c048c94f3f0934be416a3eb6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 6 15:57:21 2011 +0100

    docs: Fix function names in deprecation notices.

commit 70f44cc0ea0bcdd025ed657461e07f6778be44ba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 6 15:53:15 2011 +0100

    docs: guestfs_set_out_of_memory_handler returns void, not int.
    
    It always has done.  The documentation was wrong.

commit 1bf3941b9ccabef122cc6479004d18ddcb935eef
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 6 15:49:55 2011 +0100

    docs: Clarify error handler example.

commit 4bd1a5060bc95d8d933efa52f8d4aa26ecc118f5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 5 16:39:43 2011 +0100

    fish: Fix regression tests for new guestfish line numbers.
    
    This updates commit 319e946b92e175c05cdd1fdcb85c9b86f5631011.

commit 319e946b92e175c05cdd1fdcb85c9b86f5631011
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 5 14:58:30 2011 +0100

    fish: Print input file and line number in error messages.
    
    eg:
    *stdin*:37: libguestfs: error: luks_close: Device lukstest is busy.

commit 75cc0fc72c190353dd36f1badf6b142ee4bec079
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 5 14:03:18 2011 +0100

    gnulib: Add all other libs when linking libguestfs.so.
    
    This updates the previous two commits.

commit f45b40029d1e21e3b426218dd3c4123d8d0d1c70
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 5 13:52:42 2011 +0100

    gnulib: Add $(LIB_CLOCK_GETTIME) when linking libguestfs.so.
    
    We don't use this library (it is only used in the daemon),
    but we need to add this to make the linker happy.

commit 60d5a50f4d3d9e2c2f5a7d42a6859de709bda3f6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 5 10:54:19 2011 +0100

    daemon: Remove separate configure of daemon subdirectory.
    
    Combine the two Gnulib instances together.
    
    Add checks from old daemon/configure.ac into configure.ac.
    
    Fix daemon/Makefile.am so it is like a normal subdirectory
    Makefile.am.
    
    Because we are now using the replacement strerror_r function from
    Gnulib (instead of the one from glibc directly), this requires a small
    change to src/guestfs.c.

commit 0d13b052635c24919b1a42d00f20154526c25e96
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 5 12:34:02 2011 +0100

    Update TODO.

commit 6a98ed953b1e3b0d3251385f0ca2dd1dee80b63d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 5 10:49:45 2011 +0100

    debian: bash is required to run libtool replacement script.
    
    This was failing on Debian where $(SHELL) is the minimal dash shell.

commit e1c6d1738a2b9123dd08fb4ecff8176daf558f35
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 5 10:31:03 2011 +0100

    configure: Fix info about virt-resize when OCaml bindings are disabled.

commit 36f662c58fcda43829bcef166e600855960fd223
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 5 10:18:02 2011 +0100

    python: Don't name extension with .so.0.0 and symlinks (thanks Dan Berrange).

commit c515cbdf31e80d9f2dd137c8c4d64c035fad778c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 2 12:30:32 2011 +0100

    Version 1.13.2.

commit d7356a2801130907997acd5c7502e8417566e782
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 2 10:56:41 2011 +0100

    Add regression test to catch missing libraries in the appliance.
    
    Related to RHBZ#727178.

commit 5f9c168d9135fa81ee2f3a15461467fe04c26888
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 2 11:03:50 2011 +0100

    debian: Add gawk to packagelist.
    
    It's already included, but implicitly.

commit 995b3fecb9af7a8bd52b238bad2a631a1193c83a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 1 15:13:08 2011 +0100

    virt-tar test: Stable ordering of test output.
    
    The files could be listed in any order, resulting in the test failing
    for no reason.  Sort the output of tar.

commit 3cf31c2fe0b356ea5c04117c5235b0a3cfe34971
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 1 10:35:18 2011 +0100

    Change link, since PostgreSQL switched to using git.

commit 1d134301fc4d05338d09517abc978d0a90d82e09
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jul 31 20:48:00 2011 +0100

    debian: Build libguestfs-ocaml and libguestfs-ocaml-dev subpackages.

commit bad3f4b54a959685f3c0697238fc5753096834fb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 29 17:38:43 2011 +0100

    Don't fail if HOSTNAME field is missing on Red Hat guests (RHBZ#726739).

commit c70532ab4b3d977ed7484e473107808b22d90a2a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 27 15:43:12 2011 +0100

    perl: Fix another place where qw() was used as parentheses.
    
    This is a fix for Perl 5.14.
    
    See previous commit 5c3c7e8825341e18c9449976f8a321a04cc78d79.

commit 2b8b3f9794ceb43eabd3083e225c669896d8b186
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 26 18:57:19 2011 +0100

    ocaml: Fix locking in event callbacks.
    
    We weren't acquiring the GC lock around some allocations, resulting in
    segfaults when an event callback ran at the same time as a main thread
    allocation or garbage collection.
    
    In particular this fixes a noticable crash in guestfs-browser.

commit b5bdd0f8004af4c6c74a05031cb340b98ae03088
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 26 14:17:19 2011 +0100

    Version 1.13.1.

commit 01f6bce19dbfaf42fa4908683f3cc8785585d023
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 26 12:39:54 2011 +0100

    virt-df: Re-add documentation for --csv option.
    
    The documentation for the --csv option disappeared between 1.6 and 1.8
    when we rewrote virt-df in C.  Re-add it from 1.6 sources.

commit 15289d4b726d7c38702794df23c61ae40879a46c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 25 11:21:48 2011 +0100

    test-tool: Print FEBOOTSTRAP_* environment variables (RHBZ#671082).

commit deb95471fbd229605d9916ff90b2ff7cf92633eb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 25 11:16:24 2011 +0100

    test-tool: Display state of pgroup flag from the handle.
    
    This updates commit f173543fd207bdc254a5eb75180d82ef25eacae9.

commit 5d7dc0dfb65f367dab3560ee23e404fe21373f45
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 25 11:12:48 2011 +0100

    launch: Add qemu_supports_re function.
    
    This function is like qemu_supports, but allows us to grep
    the help text using regular expressions.
    
    Note the function is not used yet.

commit 41cd0e302d6554facd6b9f7daaa78304361efaef
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 25 10:56:52 2011 +0100

    Require PCRE library.
    
    This library is widely available in distros.

commit 316817b5ad98e294a9d2498a4403e82911a75b4a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 22 16:17:06 2011 +0100

    docs: Document FEBOOTSTRAP_KERNEL, FEBOOTSTRAP_MODULES (RHBZ#671082).

commit 8386a57458aceb768f0e59aa090a15a544f7466e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 22 11:12:52 2011 +0100

    perl: Fix CCFLAGS for Perl 5.14.
    
    A change to ExtUtils::CBuilder in Perl 5.14 causes CCFLAGS to
    completely replace, rather than appending, the C flags.
    
    The unfortunate consequence of this is that vital flags such as
    -D_FILE_OFFSET_BITS=64 are missing.  For 32 bit code, this means you
    get binary-incompatible code that completely fails to load.
    
    For further analysis see:
    
    http://www.nntp.perl.org/group/perl.perl5.porters/2011/04/msg171535.html
    
    This commit changes CCFLAGS so that it appends to the existing
    $Config{ccflags} instead of replacing it.  On earlier versions of Perl
    this means we get two copies of the flags, which is unfortunate but
    should be safe.

commit 71eb0bf45649eefa1f0cd4b1372cfc2653c8e7a5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 21 17:59:34 2011 +0100

    build: Redirect ./configure errors in general to config.log.

commit 610642491a4846f45c7b233060ffde46f6ca09f0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 21 17:00:48 2011 +0100

    build: Send failed Perl test configure output to config.log.

commit 806b6e01506dea4eae68ac3e468d9398d63cafcb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 21 10:50:40 2011 +0100

    build: Allow 'make quickcheck' test-tool args to be overridden.
    
    A typical use for this is for packagers who want to increase
    the default timeout:
    
      make quickcheck QUICKCHECK_TEST_TOOL_ARGS="-t 300"

commit 43ab6dfdf38fdafa040b9e9c1665295765f1486c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 20 18:28:07 2011 +0100

    Update version number to 1.13.0.
    
    There is no build or tarball for this, since it is identical
    to 1.12.0.

commit 0b7de697a4273dbcce175085aef45ef62e964fcc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 20 16:37:37 2011 +0100

    Version 1.12.0.

commit 02f3b53863871a8c37f41f691feb6f5ce7b3c2fc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 20 16:37:19 2011 +0100

    Finalize release notes for 1.12 release.

commit 1d0f398d8e3c74ce6a70cbbb8d9b8ae07c6d7ef6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 20 14:41:39 2011 +0100

    blkid: Use -c /dev/null option to kill the cache.
    
    On recent Debian, /etc/blkid.tab is now a symlink to /dev/.blkid.tab.
    Rather than chasing the cache file around (it may move to /run in future)
    use the -c /dev/null option to stop blkid from reading the cache.

commit 168fd4ad5d1e5da93e11388095d41aaa8f804ceb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 20 14:25:32 2011 +0100

    blkid: Detect when value not found and return empty string.
    
    If the blkid command returns 2, that means the value was not found.
    
    Note that this changes the output of the vfs-type API when the
    filesystem has no type (eg when it is empty).  Previously this would
    return an error.  Now it returns empty string "".
    
    We did not document this either way.  Making it return empty string is
    consistent with vfs-label and vfs-uuid.
    
    This change broke list-filesystems, since that code was assuming that
    vfs-type could only return a filesystem type or an error.

commit 764e4e2aa289b645b64feff454d376a86486d219
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 20 13:49:16 2011 +0100

    docs: Update stable release instructions.

commit 422678073bbd55053f020bc6743617792bb99d6b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 20 13:33:47 2011 +0100

    configure: Remove -Wmissing-noreturn warning.

commit 408f07ed3c34b2bad4885b3c000e998e4d350668
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 20 13:20:10 2011 +0100

    po-docs: Fix generation of 'podfiles'.

commit 8b2e60ce4b46e86da093ee64d4e0b0ae3c998d55
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 20 12:07:30 2011 +0100

    appliance: Capture stderr from qemu to the event system.

commit 70daccfe4e9939078436c2830928d8e53432dd84
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 20 12:05:40 2011 +0100

    appliance: Document pipe fds.

commit 5dec7842655dd872bb0fd9fe07f6a9eab6b13bfd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 20 11:45:02 2011 +0100

    Partially revert d82438431c1551610eb7d9945fa76d6387534582.
    
    It appears qemu-kvm does *not* require -machine accel=tcg option.
    That problem disappeared after upgrading seabios(!)  However leave the
    test for qemu -help option, since that's useful to determine if qemu
    is completely broken or not.

commit d82438431c1551610eb7d9945fa76d6387534582
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 19 19:55:24 2011 +0100

    build: Fix virtio-serial test for qemu 0.15.
    
    Now qemu 0.15 won't even start up unless the -machine accel=... option
    is specified.  Essentially this is a regression in qemu.

commit a6f99dd9326c2da66f6b7e49d94901fffdddd6ea
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 19 19:07:50 2011 +0100

    Version 1.11.20.

commit 1c0f75c80689580da73e27c1b4e4d26d4fb2cae8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 19 17:56:14 2011 +0100

    Update release notes.

commit d025e91f6751505c70b7b5f492ee72c67e274ecf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 19 17:54:35 2011 +0100

    java: Add guestfs-java(3) man page.

commit a548c9668315844763456c15e89e35e9702b851a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 19 17:40:52 2011 +0100

    Add missing reference to guestfs-perl(3) to guestfs(3).

commit 20480068caefae4ff62c3564113df0788a2a1c87
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 19 16:34:06 2011 +0100

    java: Tidy up the generated C bindings file.

commit d7da4807e83d4a960daca8f36bbc8a826063b135
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 19 14:45:11 2011 +0100

    java: Fix optional arguments in calls.
    
    This also adds tests.

commit c79ba93f7e53f6a62b5793ba35f1c3b13527eef6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 19 14:32:45 2011 +0100

    java: Enable warnings when compiling C bindings code.
    
    And fix the code so it doesn't generate warnings.

commit d8140d5689e49d926e5e1a53ec685088dec19a6d
Author: Nikita A Menkovich <menkovich@gmail.com>
Date:   Mon Jul 18 13:55:02 2011 +0100

    debian: Fix misspelling in debian/control.
    
    Updates commit c6577ac73db2d2d93a094ca2b7990e0d60e6a93a.

commit 32baae0e55318784af4a736ae956e11b4de274a2
Author: Nikita A Menkovich <menkovich@gmail.com>
Date:   Mon Jul 18 13:57:09 2011 +0100

    debian: Add debian/guestfsd.* to the tarball.

commit c6577ac73db2d2d93a094ca2b7990e0d60e6a93a
Author: Nikita A Menkovich <menkovich@gmail.com>
Date:   Mon Jul 18 13:55:02 2011 +0100

    debian: Fix misspelling in debian/control.

commit 463a739bf0475cf45bf03ad2c4130b2ed656686e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 18 11:55:41 2011 +0100

    Version 1.11.19.

commit 3b9d52b2a82bd6cdb10aa267b514805ad3f5e552
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 18 12:12:42 2011 +0100

    po-docs: Include source (POD files) in EXTRA_DIST.

commit 44d295756fc0fd58a85d4a417ba97145697894fb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 18 09:34:04 2011 +0100

    po-docs: Remove empty Spanish translation file.

commit 33fe14b42f4977740ef12c4d6fc08873b8eef676
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 18 09:33:24 2011 +0100

    po-docs: Fix UTF-8 encoding problem.

commit 03459c8fa754e45c7e492b378456e0afac1b0dcb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jul 17 23:05:50 2011 +0100

    po-docs: Update the list of output manpages.

commit f5d26e3cea568be665b6fbb442b328603cba8d93
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jul 17 23:03:37 2011 +0100

    po-docs: Generate list of *.pod files.
    
    Generate the list of *.pod files, instead of hard coding
    it (and having it get very very out of date).  Store the
    list in a separate file po-docs/podfiles.

commit 63c1d5dd6efb9b59a73a11f31aefdc55eaf28384
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jul 17 22:03:22 2011 +0100

    Add notes on making a libguestfs stable release.

commit d28d76b4fba3afe18757ab848346e8123a8bcae1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jul 17 22:02:58 2011 +0100

    Pull latest translations from Transifex.

commit dd497b76f846f6afed206fc86cf72592dedbbe7d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jul 17 22:01:40 2011 +0100

    Add tx pull wrapper script.

commit cd00157efca760ce043dcae216d921841dd25ff9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jul 17 10:29:47 2011 +0100

    ocaml: Generate ocamldoc.
    
    Also includes improvements to the OCaml documentation.

commit e72592563c0be15f1b2400e15205d5e803875685
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 16 19:11:52 2011 +0100

    ocaml: Bind guestfs_last_errno.

commit 8ee5c6d3a77b62f7c107db39751bb60366bee7b7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 16 19:11:37 2011 +0100

    Update API support.

commit 2d3193e971f3c7c976146a55e6c2d49dca9d7e04
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 16 15:26:32 2011 +0100

    Update ROADMAP file.

commit c5bd9539dba8476e79d859c5c09e3277538957b3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 16 15:23:48 2011 +0100

    fish: Don't make --ro the default yet.
    
    Defer this decision to a future version of libguestfs.

commit a711777bedcf64d814bb953ff8771858dbd7161b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 16 15:20:29 2011 +0100

    docs: Separate out combined =item 's in man pages.
    
    Turn:
    
     =item B<-a> | B<--all>
    
    into:
    
     =item B<-a>
    
     =item B<--all>
    
    This gives a more natural-looking manual page, as well as making it
    easier to directly link to these sections.

commit d84bb5dc19afd30c44f984b1c33c92691aa236f7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 16 12:36:07 2011 +0100

    Update and rearrange release notes.

commit 9f135be96e21d899b36ef2287a6ba8cea9beb4ff
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 15 22:09:29 2011 +0100

    Fix test-guestfish-escapes regression test to work with debug/trace enabled.
    
    If debugging or tracing is enabled, extra messages are sent to stderr
    which mess with this test.  Remove the extra messages before checking
    stderr.
    
    This updates commit 617e7f6bafa7de2303c08e1715004aae3141c389.

commit 1f0c650c8ffdf0602ec74b999f62d3efa6822c96
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 15 17:23:41 2011 +0100

    Version 1.11.18.

commit 35b15d918df53b9ced54dbb6015b94f7ee3afca4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 15 16:14:56 2011 +0100

    Update release notes.

commit db5d15792203c1928a450a9eefc87b3133ac4291
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 15 16:10:19 2011 +0100

    Update API support.

commit 1e9e351f178dcb425c4796c90fe7c8c5c250d100
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 15 14:57:00 2011 +0100

    ruby: Add binding for guestfs_user_cancel.

commit f4dadd0fcfe41b9cc6fcd6097c4c3cf509d69879
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 15 14:47:09 2011 +0100

    perl: Add binding for guestfs_user_cancel.

commit 60dd9494f0890dcc6c9a1cce311edc92cb992290
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 15 14:33:29 2011 +0100

    ocaml: Add binding for guestfs_user_cancel.

commit 50c54d2814b13d7d51f659600e93565dc6921b28
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 15 11:01:23 2011 +0100

    fish: Register ^C handler to cancel long transfers.

commit e187aa8431ccf0436d9aee03ee1e80b79f148217
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 15 11:36:23 2011 +0100

    fish: Add is_interactive flag.
    
    Decide early (before launch) if this is going to be an interactive
    session, and set the is_interactive flag.

commit 9ec9c97ce2ba46e56b304d3a367c86adc703160d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 15 10:43:36 2011 +0100

    Add user cancellation to the C API.
    
    This allows long transfers (FileIn and FileOut operations) to be
    cancelled by calling the signal and thread safe guestfs_user_cancel
    function.
    
    Most of this commit consists of a multithreaded program that tests
    user cancellation of uploads and downloads.

commit f173543fd207bdc254a5eb75180d82ef25eacae9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 15 11:38:21 2011 +0100

    New APIs: set-pgroup, get-pgroup
    
    If the pgroup flag is set in the handle, then the qemu and recovery
    subprocesses are placed in separate process groups.  The default is
    false.
    
    The purpose for setting up a process group is that ^C will not be
    passed from the main process down to these processes (killing them).
    This allows ^C and other keyboard events to be caught and handled in
    the main process.

commit 4b53a3737b76cad7aca407a0d9e37fed1d42ef69
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 15 10:42:56 2011 +0100

    guestfs.h: Add missing extern keyword before event functions.

commit d2a25fd1735506e8592bcd70b9c02063023cb149
Author: Nikita A Menkovich <menkovich@gmail.com>
Date:   Thu Jul 14 19:24:43 2011 +0100

    debian: New sub-package: guestfsd.
    
    This patch adds guestfsd debian package to the build.  The daemon can
    be installed in virtualization clients to enable libguestfs live
    access.

commit bb6a1b4cdc3fc441bb10ff4b9670895c199c6206
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 14 18:18:07 2011 +0100

    New API: write-append
    
    Append content to the end of a file.

commit 617e7f6bafa7de2303c08e1715004aae3141c389
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 14 18:17:39 2011 +0100

    fish: Handle backslash escapes in guestfish double-quoted strings.

commit d029fa69db88e216faeedad6ebe0ca337a76fa6e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 14 15:52:29 2011 +0100

    build: Add ./configure --enable-install-daemon
    
    If enabled, then the daemon will be installed in $sbindir
    (eg. /usr/sbin/guestfsd).  The default is off, as now.
    
    This option should be used by packagers when building the libguestfs
    live service.

commit 4accf3197235300029d04d0ab637b66eaaf9f8df
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 14 14:32:34 2011 +0100

    Version 1.11.17.

commit 62a34ff2d33b8692781ab297ca7c9972d72cdb4d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 14 13:42:33 2011 +0100

    resize: Clarify examples in the man page.

commit f2d816573ffba9c5a2022ac5b3b6514eaf02d0f7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 14 11:39:11 2011 +0100

    resize: Add btrfs support to virt-resize (RHBZ#721275).

commit a001a0d710ec61d8bc11841f44ac0d1f296040ea
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 14 11:38:25 2011 +0100

    New API: btrfs-filesystem-resize (RHBZ#721160).
    
    This resizes a btrfs filesystem.

commit 08910ee60cfac9aa648e59dda5dbb429825c561e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 14 13:02:31 2011 +0100

    docs: resize: Not just limited to resizing filesystems in partitions.
    
    If you use --LV-expand then filesystems in LVs can be resized too.

commit c6340f45007b0ab7e1c5391cf78afc10a816553f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 14 11:27:24 2011 +0100

    mkfs: Don't die if mke2fs is not available.
    
    Allow other types of filesystems to be created.

commit c21d6dc29c91691f2dcd914d0cc85f060f83289c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 13 15:59:33 2011 +0100

    Version 1.11.16.

commit fffe73ec6faebe2847ba0fa45c8a397fb5972d25
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 13 15:33:07 2011 +0100

    Update release notes.

commit f91c6f217facc88b60225769c61604a8b8c7169b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 13 15:03:04 2011 +0100

    Refresh README file.
    
    Update and verify the list of requirements, by checking it against
    both configure.ac and the Fedora specfile.
    
    Remove some obsolete sections that covered historical ground.

commit aa8a9ebf29b7fdc97467e911560a1a7a774e9e1f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 13 14:27:28 2011 +0100

    appliance: Add systemd to get /sbin/reboot for virt-rescue (RHBZ#661280).

commit 0c1cdfc6f234540c8cd5f41c239a5a3bf6b0f73e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 13 09:51:00 2011 +0100

    docs: Update API support.

commit d84db26a2bd28bd96aa88b6308dc540278db5c7d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 13 09:44:13 2011 +0100

    virt-resize: Arrange options in man page in alphabetical order.

commit d31de200b82ef66d7e87b32dd5345c053997cc35
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 13 09:27:57 2011 +0100

    virt-resize: Add --ntfsresize-force option.
    
    Use the non-deprecated g#ntfsresize_opts API call, and also add
    the --ntfsresize-force option for forcing resize.

commit 8c26750336f0f9cbcaa1e98278d9062af83a6b65
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 12 19:11:59 2011 +0100

    Version 1.11.15.

commit 995674a44aa00b3c68d47d367a8e92b610ffc700
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 12 17:26:34 2011 +0100

    TODO: Attach method for disconnected operation.

commit 511c82df46f5c6f4a7f984fdb81d4691038ed6da
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 12 17:18:48 2011 +0100

    part-get-bootable: Fix when partitions are missing or unordered (RHBZ#602997).

commit edd747a09060dd191277f1bcae827a94939cfb9d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 12 18:16:40 2011 +0100

    New API: ntfsresize-opts (RHBZ#685009).
    
    This is a more comprehensive fix for RHBZ#685009.  Add a new API which
    allows the --force flag to be passed, allowing multiple NTFS resize
    operations in a single session.

commit 2ba2ddf2113db7bb2afe3f739dc3cbaa5416a4ba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 12 14:13:57 2011 +0100

    Document that ntfsresize cannot be used multiple times (RHBZ#685009).

commit 4d4d3b2498be9dc8ab7e5f16928ac8f1874c2a58
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 12 13:31:42 2011 +0100

    fish: Show device mapper device in tab completion (RHBZ#688062).
    
    With this change:
    
    ><fs> luks-open /dev/vda1 lukstest
    Enter key or passphrase ("key"):
    ><fs> ll /dev/<TAB>
    /dev/mapper/lukstest  /dev/vda              /dev/vda1

commit ce5a8978b54f409de4347f16f7065b063cb47cf1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 12 13:26:25 2011 +0100

    New API: list-dm-devices (RHBZ#688062).
    
    List device mapper devices.

commit 68af98e570adca21b2e4022090adb5d1ac6ca38a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 12 12:23:15 2011 +0100

    Don't mention /dev/mapper in docs for vg-activate{,-all} commands.
    
    Although vg-activate and vg-activate-all do make /dev/mapper/VG-LV
    devices internally, we always prefer to use the /dev/VG/LV format and
    we return this format where possible.  Therefore don't mention
    /dev/mapper in this documentation.

commit 0344248af55802bbbd816b349ec1ba9305996f6e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 12 18:17:35 2011 +0100

    protocol: Force optargs_bitmask to be passed as 0 for non-opt actions.
    
    If the action doesn't take optional arguments, nevertheless force the
    optargs_bitmask field in the header to be passed as 0, and give an
    error if not.

commit c0f72f13c075a754afa7870ecf105138fba821bb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 12 12:51:43 2011 +0100

    list-9p: Avoid double free along error path.
    
    This updates commit 5f10c3350338bbca735a74db26f98da968957bd9.

commit ebe3d8f43a0ab7f60f3c1c612f117e793179f644
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 6 17:25:00 2011 +0100

    Version 1.11.14.

commit 407d8fe1db9b8c9b0b6608353e000cb08daa5605
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 6 10:53:04 2011 +0100

    mkfs-opts: Don't test optional arguments in this test.

commit 39d5c63be6037d1cb8bdf6e5a7fd9e3620c6ba6b
Author: Nikita A Menkovich <menkovich@gmail.com>
Date:   Wed Jul 6 10:36:13 2011 +0100

    mkfs-opts: Add optional sectorsize parameter.

commit f7a11c60437afa700775eaa86a9be1a543427959
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 6 10:50:25 2011 +0100

    capitests: Allow tests to properly test optional arguments.
    
    For optional arguments, you can now specify empty string to mean no
    argument, except for String optional arguments where you must use
    "NOARG" (empty string meaning a supplied empty string argument).

commit 24fb2c1255f751dad98dd1739b3ed3a52ce06f70
Author: Nikita A Menkovich <menkovich@gmail.com>
Date:   Mon Jul 4 10:25:04 2011 +0100

    Implement inode option to mkfs_opts command.
    
    This is needed because older versions of grub(for example in centos)
    do not understand filesystems created with newer version of e2fsprogs.
    By default in e2fsprogs 1.4+ creates partitions with 256 bit inode
    size, and grub expect 128 bit size.

commit 436f8df147d5854800692e8986c7b48eeea648de
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 30 16:06:07 2011 +0100

    Version 1.11.13.

commit f3ada2c7653866f2529c9f18aaa99f76cd984844
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 30 12:57:31 2011 +0100

    Add caution subdirectory containing safety and liveness tests.
    
    Not that I'm paranoid about qemu breaking snapshots of anything like
    that ...

commit 1acb82e9f70a81982c7c2ad8b7966bffc4fcfa8a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 30 12:06:09 2011 +0100

    Update release notes.

commit 76bd81820f50a390b7e853d65f41b29a37e63f43
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 30 11:36:38 2011 +0100

    inspector: Update documentation to cover <icon> element.
    
    This updates commit 7f16c346bbeba2f2fe3c31ccb85158178a284d84.

commit 8c5bdc3e12947580e91c018b71adf9ad3128bb75
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 30 10:14:33 2011 +0100

    python: Add explicit g.close() method (RHBZ#717786).

commit 81fbdee6cc5d231dcbc3eeb01412d46b19974b37
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 29 13:41:50 2011 +0100

    docs: Update API support.

commit 21c118a20e625dccd7cbd454f67a9f9c360c53f1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 28 19:52:11 2011 +0100

    Version 1.11.12.

commit dfb89e3556c02bcc5fbe62f90e3c716a2cbe93da
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 28 18:58:54 2011 +0100

    fish: Add 'display' command for displaying graphical files.

commit 7f16c346bbeba2f2fe3c31ccb85158178a284d84
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 27 15:27:46 2011 +0100

    New API: inspect-get-icon returns the guest icon.
    
    This API returns the guest's favicon if found, else an icon
    representing the guest operating system.  Currently supported by this
    patch: Fedora, RHEL and derivatives, Debian (but not Ubuntu),
    Windows XP, Windows 7.
    
    This also updates virt-inspector to include an <icon> element
    containing the icon in base64 encoding.

commit 5f26270c343bf543a7bf20cf3e6f182f6282f8ea
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 27 16:10:25 2011 +0100

    Change download_to_tmp so it can work with multi-root operating systems.
    
    The previous guestfs___download_to_tmp function did not handle
    multiboot correctly.  In particular it used the same cache name
    for downloaded files from different roots, which could have caused
    things like applications in each root to be confused.
    
    This changes the function so that the cache filename is prefixed
    with the root / fs number, eg. $tmpdir/0-Name instead of $tmpdir/Name.
    
    This change also requires the function to return the new name, so
    all places in the code which called this function had to be
    updated.
    
    This updates and fixes commit 3c1f762abed92f7a358f3bc93e3396d0606b18ad.

commit adb5db58d850ce6d15380177a63c68276f863c98
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 28 08:50:14 2011 +0100

    generator: Fix functions with both RBufferOut and optional args.
    
    No current function returns RBufferOut and has optional args.  Such
    functions would be generated incorrectly.
    
    RBufferOut implies a silent "size_t *size_r" argument is added after
    the regular arguments and before the optional arguments.  Various
    changes to the code generator need to be made to take this into
    account.

commit ea96c7acf7a332c08c2214796add647224a2ede0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 28 17:02:46 2011 +0100

    inspector: Fix comment in virt-inspector.rng.
    
    The comment referred to the command line syntax of the old
    virt-inspector.

commit b3c1dcfaee356a8feddef82c9ecbe5b7c6a4512f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 28 09:58:44 2011 +0100

    inspection: Remove note about root device string.
    
    This is a fairly pointless note/warning since (a) you can't use the
    API if you don't pass a root device string and (b) the code gives you
    a good error message if you pass something that is not a root device
    string.

commit 478f6c5bdbe4b7e466fe7eaca63aaba002f585ce
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 28 10:36:09 2011 +0100

    guestfs.h: Tidy up *_argv structs and other #defines.

commit 123610f1b5133a9e541a245467f60d065ea96575
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 27 18:14:15 2011 +0100

    Revert "Lib.pm: unknown filesystem label SWAP-sda2 (RHBZ#666578)"
    
    This reverts commit 5cab0d6c807d8a3bf9690375c663d11a10e21656.

commit 14bb3b5ae75f41af05ca6d26ebbb5e85aacf2e20
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 22 13:55:14 2011 +0100

    New API: mount-9p lets you mount 9p filesystems (RHBZ#714981).
    
    The updated patch makes 'options' into an optional parameter.

commit 5f10c3350338bbca735a74db26f98da968957bd9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 22 10:13:23 2011 +0100

    New API: list-9p lists 9p filesystem mount tags (RHBZ#714981).

commit 56b94f5f6aa7981533ad867cc908c6e9cca2ba42
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 22 10:36:44 2011 +0100

    trace: Print empty list correctly.
    
    Empty lists returned by RStringList and RHashtable functions
    were incorrectly printed as [""].
    
    Fix this so they are printed as [] instead.

commit e1e78bcef5e4654bd2456bd696840329359d35cd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 21 13:22:16 2011 +0100

    Version 1.11.11.

commit 9287197a85a7b51167a3b6c289a129760e6f9936
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 20 10:35:02 2011 +0100

    Enable deprecated option only with gcc >= 4.5.
    
    Before gcc 4.5, the deprecated option did not take the optional string
    argument (see [1]).  This caused compilation to fail with gcc < 4.5.
    
    [1] http://gcc.gnu.org/gcc-4.5/changes.html

commit cabfaa857fbd325bd0303fa56b28df8ce52aab33
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 18 13:04:18 2011 +0100

    perl: Ignore MYMETA.yml.
    
    This file is created by one of the build tools used by Perl 5.14.

commit ba9343b52d5fec1dd618e5439adc2647ce14dc0c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 18 13:01:12 2011 +0100

    todo: Idea for interactive disk creator program.

commit 5c3c7e8825341e18c9449976f8a321a04cc78d79
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 18 13:00:00 2011 +0100

    perl: Don't use qw() as parentheses.
    
    In Perl 5.14:
    
    Use of qw(...) as parentheses is deprecated at perl/blib/lib/Sys/Guestfs/Lib.pm line 1111.

commit 4ee190628bc05f0c8fad1f6d9c3e85619a91e8b8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 13 18:58:53 2011 +0100

    generator: Rewrite UUIDs that begin with zero byte.
    
    In util-linux <= 2.19, mkswap -U cannot handle the first byte of the
    UUID being zero, so we artificially rewrite such UUIDs.
    
    See: http://article.gmane.org/gmane.linux.utilities.util-linux-ng/4273

commit 1f59849a4a45a1c78488eb41b250de631b4405a6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 10 16:03:55 2011 +0100

    Version 1.11.10.

commit daf55c07978cd29fe6675911bf76da0b056fdae1
Author: Jim Meyering <jim@meyering.net>
Date:   Fri Jun 10 11:57:20 2011 +0200

    build: include <string.h> for src/match.c's use of strlen

commit 343ba6d482643882c3ab3a529f3d882ee1ba36f9
Author: Jim Meyering <meyering@redhat.com>
Date:   Thu Jun 9 22:15:52 2011 +0200

    bootstrap: use --libtool

commit 92a7d592dfd94420563a707e2e83041bb34ed9fb
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Jun 7 19:48:16 2011 +0200

    build: update to latest gnulib
    
    * .gnulib: Update submodule to latest.
    * daemon/m4/gnulib-cache.m4: Regenerate.

commit f5096dd546ac43c7288b3ab7aec1562f070f78f6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 9 10:10:50 2011 +0100

    daemon: Keep Coverity happy by ignoring some return values.

commit 29453a58d818df24c238d0a08a68886ebe4029dd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 9 09:39:54 2011 +0100

    Coverity: Don't return freed pointers from command* along error path.
    
    If the external command failed to run, we could free up the allocated
    *stdoutput and *stderror pointers, but then return those freed
    pointers to the caller.  The caller usually tries to print and free
    *stderror, so this is a serious error.
    
    Instead, return *stdoutput as NULL, and *stderror pointing to a
    generic error message.

commit 7a091a11d7aeddc170e4d1b833fd9d7d18c00841
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 8 22:38:53 2011 +0100

    Coverity: Missing return on error path.

commit 346c5b0ebf58c81f657540eeb72abaa41bfc4e3f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 8 22:30:24 2011 +0100

    Coverity: Ensure fp is closed along all error paths.

commit 7c020a14802255c966b2b402b983551b86a08bba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 8 22:27:01 2011 +0100

    Coverity: Close directory handle along error paths.

commit 869c11b30c72c57e48dd63c4641087a06abe80d5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 8 22:25:21 2011 +0100

    Coverity: Don't leak argv arrays.

commit 3135b8c378f9f98ae66e37fd79d305764334980d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 8 22:16:59 2011 +0100

    Coverity: Don't leak error strings.

commit 7fae594df719d1d81a043c4d0280b359f750facb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 8 22:14:21 2011 +0100

    Coverity: Check return value of sysroot_path.
    
    For some reason we were checking the parameter!

commit 3a5bd5aba23583e64bfaabc906ca95b0f9d37578
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 8 22:07:36 2011 +0100

    Coverity: Check return value of malloc.

commit 76dfb74324fa0daa343d7edf89bd05e1fe7b4db0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 8 22:04:25 2011 +0100

    Coverity: Don't close fd_cwd if fd_cwd == -1.

commit 3ed8d5122026f37dd96cc7e8503c4f3ecf0afbb7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 8 22:01:41 2011 +0100

    Coverity: Avoid calling sort_strings (NULL, 0) on empty list.

commit 48ebf50f3136ac27f4252662e351230ffa2b15e5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 8 21:56:56 2011 +0100

    Coverity: Don't call free_strings (NULL).

commit 9160eec4fbf12643d8d5fa13465066822b2fed92
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 8 21:53:07 2011 +0100

    Coverity: Remove unreachable code.

commit bfc02f78f36d88543f8435e450e28c986b667a94
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 8 13:12:01 2011 +0100

    init: Remove timeout in udevadm settle command.
    
    The given timeout (10s) was too low if the appliance was
    running slowly, which caused a cascade of other failures
    during tests.
    
    Note that in udev-171 and above on Fedora, /sbin/start_udev
    no longer exists, so now we are using this manual method to
    start udevd.

commit 2f73ea343cc4a3433f20e99a7835152767a70f80
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 7 12:36:02 2011 +0100

    protocol: Enhance "unexpected end of file when reading from daemon" error.
    
    Make this error more informative, since it is a common error when the
    appliance fails to start up.

commit 9ce239a8365b2209de24f72aa75a7a049ee72d01
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 4 22:22:44 2011 +0100

    Version 1.11.9.

commit cdd11b758f2601f7eeda4fca684638b0335d531a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 4 22:47:52 2011 +0100

    Only include date, not time, in BUGS file.
    
    This is so the file does not change so often when using 'make dist'.

commit 503c8f8661a9bfd4928d720cbfd985121149230c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 4 22:22:04 2011 +0100

    Remove dependency diagram, since it is very out of date.

commit 42e7ea6840cd66e4a136b6417bdee14e152fe140
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 3 17:00:07 2011 +0100

    virt-ls: Add virt-ls -lR option for complex file iteration.

commit bb965ded274f911fb5d7889f88db9adaad1d2a52
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 3 15:19:05 2011 +0100

    virt-ls: Refactor mode selection code.
    
    This is just code motion.

commit 7177340a6f0e3ac1f238c69b0ad5267e18252fe2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 3 14:49:19 2011 +0100

    virt-ls: Small fix for output of --help option.

commit 418842518bf856144e2ab33abb6de417d1b60753
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 4 13:13:11 2011 +0100

    Ubuntu: Fix compilation of virt-resize if old libguestfs already installed.

commit 3819b657b0e3cc7cf99d04fc1f7bced8269e6ce9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 3 09:41:20 2011 +0100

    recipes: in tr command \000 should be \0

commit 08bc8e40cea750bd35493ecab514e8e37c883a0a
Author: Nikita A Menkovich <menkovich@gmail.com>
Date:   Fri May 20 11:26:09 2011 +0100

    daemon: Fix error message.

commit 0c133cf689ba4816ba6e9283c3f9ed7f06dc0a77
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 20 10:54:55 2011 +0100

    todo: Document thoughts on visiting files.

commit b85b4fafe1e23dc99d10647f6d35cd37b0a3f02a
Author: Nikita A Menkovich <menkovich@gmail.com>
Date:   Fri May 20 10:35:06 2011 +0100

    debian: Add build dependencies: dpkg-dev, devscripts, gperf.

commit 4b91462bad010a0b214e808f94a916002be65b91
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 19 14:44:02 2011 +0100

    daemon: Make sysroot_len be size_t instead of int.

commit 7ac2c210dde062a0870431b60d0693c55e2cf17c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 18 22:23:05 2011 +0100

    todo: Remove event log parsing - done.

commit b646886d1aa244a32f37b19b7fb7921176d29fcd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 18 21:11:47 2011 +0100

    build: Install guestfs-recipes.1.html on website.
    
    This updates commit f2c7df589c7e161f33b46d05a943b5489dc2cffe.

commit f2c7df589c7e161f33b46d05a943b5489dc2cffe
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 18 15:45:36 2011 +0100

    Add new guestfs-rescue(1) man page with recipes.

commit 00d34429e5f343bcc3f6afbd27aa3a2ca7820086
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 18 15:27:20 2011 +0100

    Remove guestfish recipes.
    
    These were out of date.  We will replace them with more up to date
    information.

commit 95368927219f2888aeb1232c7ec950dde538bc39
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 18 15:32:59 2011 +0100

    guestfs-examples(3): Remove link to OCaml homepage.

commit 8a1be9265d8fda423a09e267cb92bd3fd2b1e163
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 18 10:04:37 2011 +0100

    Version 1.11.8.

commit f55b32b2db83495fc0987f0fe0e979818704dff1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 18 10:04:05 2011 +0100

    zero: Disable file test because of bug in file command.
    
    See: https://bugzilla.redhat.com/show_bug.cgi?id=705499

commit 94d1dfde2793dccdcaf105d77c6135cdae70fa5e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 17 22:54:20 2011 +0100

    virt-win-reg: Win XP paths can contain %systemdrive%.

commit 4a6890d824b6bcb811e0dca9a0e77d81451a9056
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 17 22:53:53 2011 +0100

    virt-win-reg: systemroot macro should be replaced case insensitive.

commit 598484729632d1207dc3e1493f27499de18d2242
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 17 22:06:00 2011 +0100

    New APIs: is-zero and is-zero-device, to test if file or device is all zeroes.

commit ef6f877b9df261fad1fbf361b8ce7af1055dfbb7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 17 20:57:56 2011 +0100

    Document that guestfs_file output depends on file(1) command.
    
    And therefore practically it cannot be part of the ABI since
    the output of file(1) itself changes from time to time.

commit b777a5a64926e9bf9b7109a0e4fb1332b20fa37f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 17 19:51:37 2011 +0100

    fuse: Add note about allowing other users to see filesystem (RHBZ#705200).

commit 916392e2272b82bf39f9b2d4efe90557639e1f0a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 17 17:48:48 2011 +0100

    Version 1.11.7.

commit 12414ddc020f94e75a791815d2c1ac2b0d76eaf1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 17 15:52:28 2011 +0100

    generator: Mark sfdisk functions as deprecated.
    
    Point to the part-* API calls as replacements.

commit 4ec8fd189dc8404e713c00bcfc36de358f5cdca3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 17 15:52:16 2011 +0100

    generator: Mark mount as deprecated.
    
    Callers should use 'mount_options' or 'mount_vfs' instead.
    
    See also:
    http://libguestfs.org/guestfs.3.html#libguestfs_gotchas

commit 31de91f6d2605899b3a797b73b358eec9c0b1196
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 17 15:51:25 2011 +0100

    generator: Mark wait_ready as deprecated.
    
    The function has been a no op for a very long time.  By marking
    it as deprecated we make it clear that you shouldn't call it
    in new code.

commit b43482964a8c7e19f47943506872cd58601c28e9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 17 15:50:16 2011 +0100

    generator: Check the flags fields.

commit 34acb80a28d1b48e734883a32f7f3344dc216ec0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 17 15:04:56 2011 +0100

    Enable deprecation warnings on all C programs.

commit 8c0aca8d9280fb87027826fe89d70cc2701e7f8b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 17 14:46:16 2011 +0100

    fish: fuse: Remove redundant -DGUESTFS_DEFAULT_PATH.
    
    This was left over from earlier code.  It is used in the base library,
    but not in guestfish or guestmount.

commit be507f6a225345ec3c03096fa05cdb0d0e3dec9a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 17 14:41:54 2011 +0100

    lib: Warn about deprecated functions (enable with -DGUESTFS_WARN_DEPRECATED=1).
    
    This allows C API users to be warned if they are using any deprecated
    functions.
    
    We don't warn about this by default.  Users have to specifically
    request this by defining the cpp symbol GUESTFS_WARN_DEPRECATED as 1.

commit 33adb59b60b1358656439a757f319ba8ce81e26c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 17 14:41:34 2011 +0100

    lib: Add GCC version macro to the header file.
    
    This will be used to internally enable various GCC enhancements.

commit 36b236fc97880c04e2ceeac502ff07a5e9993e28
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 17 14:43:48 2011 +0100

    lib: Add vertical space between each function in <guestfs.h>.

commit 64841fe8957f798df12a38bd81843c7011f2c278
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 17 13:58:20 2011 +0100

    appliance: Use qemu -machine option where available (RHBZ#700369).

commit 2dbe26c372fe102b4c77cb6a3ecfa435117a4ec3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 17 13:16:17 2011 +0100

    virt-win-reg: Support HKEY_USERS keys.
    
    This adds support for various Registry keys under HKEY_USERS (user
    preferences).
    
    (1) HKEY_USERS\<SID>
        where <SID> is a User SID.
    
    For example:
    
      # virt-win-reg Windows 'HKEY_USERS\S-1-5-19'
    
    lists out the LocalService user's registry.
    
    (2) HKEY_USERS\<username>
        where <username> is a Windows local username (this is a
        libguestfs extension).
    
    For example:
    
      # virt-win-reg Windows 'HKEY_USERS\rjones'
    
    lists out the user preferences of user 'rjones'.
    
    HKU can be used as an abbreviation for HKEY_USERS.  Merging is also
    supported.

commit 4443cfab8b16d862c8ab2971acccf4f18802b95c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 17 13:15:25 2011 +0100

    virt-win-reg: Don't use implicit $_ in map_path_to_hive function.

commit 3b4bb214c36d2659dff58e1a79bad8a9c48fa51d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 17 09:00:30 2011 +0100

    virt-win-reg: Don't hard-code the relationship between hive name and path.
    
    The crucial change is the tuple that is returned by map_path_to_hive:
    
    -    my ($hivename, [...]) = map_path_to_hive ($_);
    +    my ($hiveshortname, $hivefile, [...]) = map_path_to_hive ($_);
    
    Previously the $hivename was both the name of the hive (eg. "sam"),
    the name of the local copy in /tmp, and the name of the hive in
    %systemroot%\system32\config.
    
    In the new code, the $hiveshortname (eg. "sam") is still used for the
    local copy in /tmp, but we return $hivefile which is the full Windows
    path (eg. "/windows/system32/config/sam").
    
    The purpose of this change is to allow us in future to return hives
    from other Windows directories, specifically HKEY_USERS hives from
    Windows home directories.
    
    Although this is just code motion, it requires some quite extensive
    changes to virt-win-reg.

commit 9116f0eb01e23c9ec52144de6068c6918ce6c346
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 17 11:28:00 2011 +0100

    virt-win-reg: Add --unsafe-printable-strings option.
    
    This also requires hivex >= 1.2.7.

commit 977b61c5257876706218d72afe197c77cea6e6b8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 16 12:08:00 2011 +0100

    todo: See if qemu -machine option can be used to select KVM, TCG acceleration.

commit d6cf002174504eddb7c285f291b8f81c907b6eaa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 12 16:31:29 2011 +0100

    Version 1.11.6.

commit e95671d69e697f5b44775f797f1ef9fc0829d313
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 12 16:04:16 2011 +0100

    debian: Note that libconfig-dev ought to be required.
    
    However it doesn't appear to be in Debian at the moment.

commit 91ea9c1805112233140a463256c89072121fc182
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 12 13:52:27 2011 +0100

    debian: Include debian/ directory in tarball.
    
    This makes it simpler to build Debian and Ubuntu packages from the
    tarballs.

commit 48c91ac03cb0a6ac351822fe70200abb8ac7f761
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 12 13:50:38 2011 +0100

    build: Sort EXTRA_DIST into lexicographic order.

commit 03a8e3fc8eba11abb47a9f6f627b8d49076b1049
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 9 16:30:30 2011 +0100

    configure: Use Python platform-dependent site-packages.
    
    This updates commit c446e6e26e317e105870b0ab25fb082887e23bf6.

commit 2a8cf3aab32c45b327c6b6c1fe6d4e61c7c95909
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 9 15:22:32 2011 +0100

    Version 1.11.5.

commit ea70f55812f1ef621c57814a99a29d6798a5ad30
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 9 14:59:33 2011 +0100

    edit: Reorganize options alphabetically.

commit c665d14f29dd5d66be315b3042cb562aa0c40edd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 9 14:40:12 2011 +0100

    edit: Fix reference to virt-cat in the documentation.
    
    This updates commit 2b5fbc882a0a79646b668c7b95442f0b3673d63a.

commit c446e6e26e317e105870b0ab25fb082887e23bf6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 9 14:34:31 2011 +0100

    Use Python distutils to determine include and site-packages directories.
    
    This change was inspired by Hilko Bengen's similar change to hivex:
    http://git.annexia.org/?p=hivex.git;a=commitdiff;h=b808c875a34e62fcdf360534f923d6030590ff44

commit 2b5fbc882a0a79646b668c7b95442f0b3673d63a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 6 17:42:07 2011 -0400

    Rewrite virt-edit in C.

commit 5ce759bfdc70c97121ef34ab4d5c918d568f2474
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun May 8 21:59:50 2011 +0100

    daemon: Remove some less useful debugging messages.
    
    Remove some debug messages which were basically left over from when
    the code was being developed.
    
    However we leave debug messages where it is printing an external
    command that is about to be executed, since those are useful.

commit 5419153954ee0a2597358b992cc29e448a21ca60
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun May 8 16:53:03 2011 +0100

    Version 1.11.4.

commit 607aa95de927b5b8e4b212655c71bf21acbba372
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun May 8 15:13:23 2011 +0100

    Fix guestfs___rollback_cmdline when pos == 0.
    
    Because of the previous change to size_t, when pos == 0 the loop would
    wrap around and cause a segmentation fault.
    
    This fixes a regression introduced by
    commit 10167cea98f93a74abe63f0a54d3a662997e7489.

commit 8ee0ad0caf2f90f4883909cd9b61c4dd6f9cffbf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 6 17:33:44 2011 -0400

    configure: Sort output files in AC_CONFIG_FILES section.

commit 87fb6d852db04d0d707e6587d4579d1cf2bd05ef
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 6 12:23:00 2011 -0400

    fish: Allow -d UUID (specify libvirt domains by UUID).
    
    This applies in all the commands which use the common C option parsing
    code, ie:
    
    * guestfish
    * guestmount
    * virt-cat
    * virt-df
    * virt-filesystems
    * virt-inspector
    * virt-ls
    * virt-rescue

commit be3b028d7f2fadd8d2107a419393511e4510d0a4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 6 12:21:01 2011 -0400

    add-domain: Add allowuuid flag to allow UUIDs to be used for names.
    
    This makes a backwards-compatible change to the add-domain API.  If
    the optional allowuuid flag is true then UUIDs can be used instead of
    names in the domain name parameter.

commit a4c28b4ed1c5a102c8de2a7425568eb504d05c34
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 6 12:32:59 2011 -0400

    add-domain: Suppress libvirt errors on stderr.
    
    Install an error handler on the libvirt error connection so that
    errors are not printed on stderr (instead they go up through the usual
    libguestfs error mechanism).
    
    Unfortunately this doesn't suppress initial connection error messages
    to stderr.  I cannot see how to do this without affecting the global
    libvirt error handler, which is not acceptable for a library to be
    doing.

commit c49fc3831d12788c27b90d12f06a1cd69a88e3be
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun May 1 17:41:20 2011 -0400

    doc: Use I<-...> for cross-references to command line options.
    
    This is now used consistently across all the documentation.

commit 988a8784647a66adbece3c9fb470c06a4cce3cdd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun May 1 14:53:23 2011 -0400

    df: Refresh virt-df(1) man page.
    
    Add examples.
    
    Refresh description.
    
    Use I<...> to refer to command line options.

commit 805e6dbc15eae5a4f85eea3c37e295aefaefeb69
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 30 20:11:21 2011 -0400

    guestfs(3): Note that host file size limits affect guest disk limits.

commit 40f2b698ac765128bfcda5f0db893c95d09ae89a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 30 19:38:20 2011 -0400

    guestfs(3): Refresh documentation for private data area keys.

commit e1836891d435b9ef47e68949a3d69b1258924d0c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 30 19:26:08 2011 -0400

    guestfs(3): Document that old callback functions still work.

commit 108d7a134c5d26b967fa7162d9b80b40112c2869
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 30 19:10:52 2011 -0400

    guestfs(3): Referenced section is above, not below.

commit a5e421570cc840f70f2931e24b3df40c9a14cd2d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 30 19:10:25 2011 -0400

    guestfs(3): Refresh autosync gotcha documentation.

commit 470e373eea218c8d46b0c63dda93ee9ece48940f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 30 18:45:56 2011 -0400

    guestfs(3): Writing to a file descriptor, not just a pipe.

commit dd86183f3f6d4d5ad28e1f12c56ba920934e7ad0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 30 18:31:06 2011 -0400

    guestfs(3): Refresh documentation for guestfs_create, guestfs_close.

commit 91b35746b438240c0b64a22afae630ecbce5e02d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 30 05:55:27 2011 -0400

    Add a trace message to guestfs_close.
    
    Only the "first half" (ie. the call) is traced, because by the time
    the function returns the handle has gone and there's no way to
    generate events.
    
    You should see:
    
      libguestfs: trace: close

commit 10167cea98f93a74abe63f0a54d3a662997e7489
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 30 05:49:06 2011 -0400

    internal: Use size_t instead of int for command line size.

commit 478b2d80ed1d613f621e89a97a0b140004ebac29
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 30 05:45:26 2011 -0400

    guestfs_close: Move local variables close to code that uses them.
    
    This is just code motion.

commit b2f8627ab59daeb03f036dde6c66fb9da736950c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 30 05:42:43 2011 -0400

    guestfs_close: Remove unused local variable.

commit c0f96e9c6eda77e5e99de862dd4366010e4a1ab8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 27 20:10:24 2011 +0100

    guestfs(3): Document limits.

commit ea293658f41fb57a72f03e18d34597ef19c8d89d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 26 11:00:10 2011 +0100

    todo: Integrate with CMDBs (thanks Quinten Laureijs).

commit f24494195ab8541fda7236afb37a4f897c9bcee5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 22 22:53:07 2011 +0100

    python: Ensure Python GIL state is correct during callback.
    
    This updates commit 2cac52000a6a96a583af72e289a4296c596047d5.

commit dfd7efb91fb3120937c4780fee943abd0351c20e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 22 22:26:02 2011 +0100

    Version 1.11.3.

commit 2cac52000a6a96a583af72e289a4296c596047d5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 22 21:36:41 2011 +0100

    python: Implement new event API.
    
    This implements set_event_callback and delete_event_callback so that
    Python programs can use the new event mechanism.

commit 16da7589e91b0030fb5564553447f80b97c0b18c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 22 19:58:29 2011 +0100

    python: Rearrange C files for bindings.
    
    Move the hand-written functions into two new files:
    guestfs-py.h and guestfs-py-byhand.c
    
    This is just code motion.

commit 3acf732c2f23d8508f692efb2b222169914bfcdc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 22 21:34:08 2011 +0100

    perl: Decrement refcount in $g->delete_event_callback.
    
    This updates commit bc468c87d04b34faacd208c49cca4a5096e5103c.

commit 0da6f55a6745686ca056c6bc8ebf647f111cb8e8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 21 17:33:48 2011 +0100

    inspect: Look for %systemroot%/system32 for Windows heuristic.
    
    The virt-v2v transfer ISO had a /windows directory.  The core
    inspection code thought this was a Windows root filesystem.

commit 782f3a36469ca396dbf998ea82af2699153be3ed
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 21 17:29:44 2011 +0100

    list-applications: If software hive is missing, this is an error.
    
    virt-inspector would exit silently if list-applications failed along
    this error path.

commit 2b0ca7e7b8d369a42a51b1feec72ae8f17257c78
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 21 15:09:11 2011 +0100

    inspect: "centos" and "scientificlinux" are now separate distros.
    
    Previously we returned "rhel" for these, which was not accurate.

commit a9ac448cf8a3e8d13b67dc286940abe51226c9dc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 21 14:47:57 2011 +0100

    Update TODO.

commit 6d0d3b7f02a5a4801c6347e1ef0c8cd7755c2454
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 18 21:47:45 2011 +0100

    Version 1.11.2.

commit 08dc4a87b92435678780e9c49fe3bc1e7465d99f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 18 16:56:08 2011 +0100

    python: Release Python GIL while running libguestfs calls.
    
    Release the Python global interpreter lock while running libguestfs
    calls.
    
    We don't release it around guestfs_create() because that is a short
    call that just allocates memory.  We do release it around
    guestfs_close() since that is a potentially long-running (it can call
    wait(2) amongst other things).  We also release it around all the
    other generated Python calls.
    
    We don't yet support callbacks into Python code (ie. the new event
    API).  But when we do in future, we will need to also handle the GIL
    around those callbacks.
    
    This code is adapted from libvirt's python/typewrappers.h.  Thanks to
    Dan Berrange for showing us how to do this properly.

commit a3cce465570bf192e993a67feedfbab7e662c75a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 16 21:35:11 2011 +0100

    fish: --rw option will be mandatory in 1.12 not 1.10.

commit 4c2bb8b301970e8853a8feaa95e3698224640fba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 16 21:26:15 2011 +0100

    fish: Fix typo in guestfish man page (--format option).

commit 34d9fed24ad6a2d2e13bb817820e31373f6756e1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 16 21:12:53 2011 +0100

    inspector: Refresh the virt-inspector(1) manpage.

commit 5d139fa8a4a7f9ff65e7b936fd7376f661c72f48
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 16 15:29:58 2011 +0100

    run script: Don't depend on libtool being installed.
    
    Also use 'exec' to run the program.

commit 79f5720d2ccab820c90b7516f3fbf5e3dcbe9c8f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 16 14:57:33 2011 +0100

    Version 1.11.1.

commit 340ff70c1e28aa0ceb2f45918dabafc8fd7134d3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 16 14:56:38 2011 +0100

    Add images/guestfs-aux/fedora-packages.db{,.txt} to EXTRA_DIST.
    
    This updates commit d95874db3dc6c415061b86275d03770b4f28ffbb.

commit 33a2c184e12c0bdbf061a9f36c87d76c28444712
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 16 07:28:47 2011 +0100

    Remove local LIBGUESTFS_PATH detection from guestfish and guestmount.
    
    Remove the hack that let you run ./fish/guestfish or
    ./fuse/guestmount.  You now have to do:
    
      ./run ./fish/guestfish
    or
      ./run ./fuse/guestmount
    
    to run these programs without installing.

commit 5790f5bfafb12cc2ed9365461bf66e0fdfde7150
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 15 21:43:20 2011 +0100

    Remove ad-hoc run*locally scripts, replace with './run'
    
    Remove all the run*locally scripts and replace with a single top level
    ./run shell script.

commit 0108d7861d4cc9a1f0d87d89080d1be7750e54b5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 14 18:19:04 2011 +0100

    inspector: Handle write failures when creating example-*.xml.

commit 67493bfca44d436143d825b155bf2bc38990ea82
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 14 18:17:43 2011 +0100

    Delete file so db_load doesn't run incrementally.
    
    It turns out that db_load incrementally updates the database (instead
    of writing a new one).  Remove the old database to force db_load to
    write a new one.
    
    This also ensures that we handle write failure gracefully.

commit 36d3a4ce53317b104d48b60c9fe1ed679065d1d4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 14 17:58:51 2011 +0100

    inspector: Include <hostname> in output.

commit d95874db3dc6c415061b86275d03770b4f28ffbb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 14 17:53:48 2011 +0100

    inspect: Get version and release of RPM packages.
    
    This commit downloads the Packages RPM database allowing us to find
    other details about installed RPM packages (via
    inspect-list-applications).  This adds version and release.  Epoch
    cannot yet be found.
    
    This commit also updates the Fedora example image so that it contains
    a dummy RPM Packages database with some data.

commit a986e8dadb0c70634f6d1d89dd3e7bb5d9af3078
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 14 13:28:02 2011 +0100

    inspect: Abstract out db_dump code for listing RPM applications.
    
    There are two changes here:
    
    (1) The code for listing RPM applications ran db_dump and parsed the
    output.  We abstract out that parsing code into a separate reusable
    module (src/dbdump.c).
    
    (2) The old db_dump parsing code used db_dump -p (printable) format.
    Instead use db_dump -k (hex) format so we can read binary fields.

commit 3336b5448f12c9eb25bf7a0cecda1315c4cf07ea
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 13 23:27:05 2011 +0100

    inspect: Split code into separate files.
    
    The src/inspect.c file had grown rather large -- 3,500 lines.  Split
    it across several files according to function.
    
    This is just moving code.
    
    After the split the files are more evenly divided:
    
      536 src/inspect_apps.c
      766 src/inspect.c
      537 src/inspect_fs.c
      404 src/inspect_fs_cd.c
      785 src/inspect_fs_unix.c
      535 src/inspect_fs_windows.c
     3563 total

commit 439a42efdb052748c8457f866b2c68a581034826
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 13 23:02:45 2011 +0100

    inspect: Move shared PCRE match functions to separate file.
    
    This is just moving code around.

commit 3c1f762abed92f7a358f3bc93e3396d0606b18ad
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 13 22:35:35 2011 +0100

    inspect: Cache downloaded files in the handle g->tmpdir.
    
    During inspection we download various files such as the Windows
    'software' and 'system' registries.  Previously these were downloaded
    as temporary files and discarded immediately after use.  This meant
    that the 'software' registry was being downloaded twice by
    virt-inspector (it's required once for basic OS inspection, and a
    second time to list Windows applications).
    
    This commit changes this so that these files are cached in g->tmpdir,
    and thus the second time we just reuse the file we've already
    downloaded.
    
    Callers shouldn't be relying on inspect-list-applications to reread
    the actual registry from the VM (unless you close and reopen the
    handle).  It says in the documentation that the results of inspection
    may be cached in the handle.

commit 70975981bed8e0c01b5966c10b507bb82086e5f8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 13 22:02:08 2011 +0100

    Remove temporary directory containing arbitrary files.
    
    In preparation for caching inspection information in the temporary
    directory (g->tmpdir), allow the temporary directory to contain
    arbitrary files, and remove all of them when the handle is closed.
    
    This just generalizes the previous method of cleaning up the tmpdir.

commit 6740028b333840eec5e8e46e8512f8155728b037
Author: Jim Meyering <jim@meyering.net>
Date:   Wed Apr 13 15:17:32 2011 +0200

    Include string.h and libintl.h, as needed.
    
    * df/df.c: As above.
    * df/main.c: As above.
    * df/output.c: As above.
    * fuse/guestmount.c: As above.
    * inspector/virt-inspector.c: As above.
    * rescue/virt-rescue.c: As above.

commit ace1795d1045be96f92a68e6b61ffdee60431fef
Author: Jim Meyering <jim@meyering.net>
Date:   Wed Apr 13 13:15:39 2011 +0200

    Add more missing include directives.
    
    * cat/virt-cat.c: Include string.h and libintl.h.
    * cat/virt-filesystems.c: Likewise.
    * cat/virt-ls.c: Likewise.

commit 173c374bd01e84deafdaf1f9aa65b0f623e86470
Author: Nikita A Menkovich <menkovich@gmail.com>
Date:   Wed Apr 13 12:41:27 2011 +0100

    debian: Add dependency on libpcre-ocaml-dev.

commit 0db662eae54b21fccadabe817afbc0fa89d980b2
Author: Jim Meyering <jim@meyering.net>
Date:   Wed Apr 13 13:00:06 2011 +0200

    Add missing include directives.
    
    * fish/config.c: Include string.h, for use of strlen.
    * fish/keys.c: Likewise, but for use of memcpy.
    * fish/man.c: Likewise, but for use of memset.

commit a53833fdd21cd573fe8fd02d7a11a3a5e9764ce0
Author: Jim Meyering <jim@meyering.net>
Date:   Wed Apr 13 11:11:42 2011 +0200

    Avoid warning about implicit declaration of strlen.
    
    * src/events.c: Include <string.h>, for use of strlen.

commit 6ec2ed20cbbad871a8b48389cbe5785bb929c99f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 12 22:45:39 2011 +0100

    debian: libguestfs-test-tool-helper no longer exists.

commit 0d9f2c7311b005b2cfe2ecb3ff9fb57d4576ef7b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 12 22:45:18 2011 +0100

    resize: Include stamp file for manpage in CLEANFILES.

commit 6e635ac015d94e1d3c624579984eca9ebd8a4662
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 12 20:14:51 2011 +0100

    Version 1.11.0.

commit 189a2f3075aa7073b608409382bd55cfa375f458
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 12 19:36:25 2011 +0100

    Update RELEASE-NOTES for 1.10 release.

commit 30479a1190b2f1c2526301fd63182481b1dd6ad8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 12 19:36:00 2011 +0100

    Update ROADMAP for 1.12 and beyond.

commit 9e56040cd3169da1321ba9672d0f32910c883a89
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 12 19:35:27 2011 +0100

    README: virtio-serial is required.

commit 62f9e408b4da415448178ad81bf4b2f4e51361b0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 12 18:49:31 2011 +0100

    guestfs(3): Fix documentation for drive letters.
    
    We can now get drive letter mappings through the inspection API.

commit 88ff38dab607f7218756ce87e014c0e699e162f8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 12 18:05:35 2011 +0100

    inspect: Fix some small memory leaks in Windows inspection.
    
    Found using valgrind.

commit 11374abeadfb01252bdb02c0915d1edc79512e79
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 12 17:03:14 2011 +0100

    fish: Allows win:... paths to work with drives mounted anywhere.
    
    This allows you to mount disks on (eg) /c and /e and have the
    guestfish win:... path mechanism map drive letters to the
    right places.

commit c2c755440bceed92ca40a929f4dfe343d3265e2b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 11 12:33:21 2011 +0100

    todo: guestfish drive letters.

commit cde0c0c05741476e748586a59f3470e8bc211718
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Apr 10 21:10:19 2011 +0100

    resize: Update dependencies.

commit d600d53868237e0f2828a912d9672dbd480e315f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Apr 10 20:42:42 2011 +0100

    resize: Don't build this directory in parallel.

commit a6cb8fee205b1615d380456964bebe40bd840fb1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Apr 10 11:12:03 2011 +0100

    resize: Consistent use of 'part' in help output.

commit 61a42ff551073daf345bd03941797e6af1e97128
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Apr 10 11:06:58 2011 +0100

    resize: Missing \n after version.

commit 047173d18683a66cbe8949bc114833984898fed6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 9 22:50:15 2011 +0100

    resize: Link with local copy of guestfs.

commit ee212deef690c6bc0bae307a5566b97f49445aaf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 9 17:11:57 2011 +0100

    Version 1.9.18.

commit de4f5f2fe31804f2be3c4ec749374bb39ff9ab97
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 9 19:55:05 2011 +0100

    Update POT file.

commit d8818f6cb97891a1ffba23a775ad096572a486e0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 9 18:01:11 2011 +0100

    Include po/Makefile.in.in in git, to avoid needing to rerun gettextize.

commit b60a01f9a38f9358672e36e665e045fb85eb081c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 9 21:11:47 2011 +0100

    build: virt-resize manpage.

commit ca03635a4c83afbe9b51fe846a8b3d5361462a90
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 8 14:07:26 2011 +0100

    Rewrite virt-resize in OCaml.
    
    This is a fairly straightforward translation of Perl virt-resize into
    OCaml.  It is bug-for-bug and feature-for-feature identical to the
    Perl version, except as noted below.
    
    The motivation is to have a more solid, high-level, statically safe
    compiled language to go forwards with fixing some of the harder bugs
    in virt-resize.  In particular contracts between different parts of
    the program are now handled by statically typed structures checked at
    compile time, instead of the very ad-hoc unchecked hash tables used by
    the Perl version.
    
    OCaml and the ocaml-pcre library (Perl-Compatible Regular Expressions
    bindings for OCaml) are required.
    
    Extra features in this version:
    
    - 32 bit hosts are now supported.
    
    - We try hard to handle the case where the target disk is not "clean"
      (ie. all zeroes).  It usually works for this case, whereas the
      previous version would usually fail.  However it is still
      recommended that the system administrator creates a fresh blank disk
      for the target before running the program.
    
    - User messages are a bit more verbose and helpful.  You can turn
      these off with the -q (--quiet) option.
    
    There is one lost feature:
    
    - Ability to specify >= T (terabytes) sizes in command line size
      expressions has been removed.  This probably didn't work in the Perl
      version.
    
    Other differences:
    
    - The first partition on the target is no longer aligned; instead we
      place it at the same sector as on the source.  I suspect that
      aligning it was causing the bootloader failures.
    
    - Because it's easier, we do more sanity checking on the source disk.
      This might lead to more failures, but they'd be failures you'd want
      to know about.
    
    - The order in which operations are performed has been changed to make
      it more logical.  The user should not notice any functional
      difference, but debug messages will be quite a bit different.
    
    - virt-resize is a compiled binary, not a script.

commit 3a84e0784e1e3ab7b56850d0f8c9aa42f1ae3da1
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Apr 7 15:30:54 2011 +0100

    Compile rpcgen-generated files with -fno-strict-aliasing
    
    rpcgen generates source which can't be safely compiled with strict-aliasing
    enabled.

commit 6ea263b1f141614e7693a38b13e8f368237760a2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 6 19:45:46 2011 +0100

    test-tool: Don't use static binary helper program, nor ISO.
    
    This simplifies the libguestfs-test-tool program down to essentials.
    Bugs most commonly occur when starting the appliance, so what we
    should concentrate on test is just that.
    
    Previously the test tool built a special static binary helper program,
    packaged it up in an ISO, then ran this inside the appliance.  None of
    this really tested useful failure modes, but they did make the test
    tool itself harder to build, harder for users to run, and more
    brittle.
    
    This change also adds some more debugging of libguestfs state.

commit cbc6b720a4e58d32b6089db05288f4a468742b47
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 6 11:52:20 2011 +0100

    Update RELEASE-NOTES file.

commit 872e67ffdf6c7b19782514445d13e8f405e435c1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 5 21:24:51 2011 +0100

    Version 1.9.17.

commit 5141c8fc02d0d20c0eaffb5de2ed8e4164fe2a94
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 5 19:44:16 2011 +0100

    fish: copy-in, copy-out, edit, more commands can use win:... prefix.

commit b8be128caa27fa5e1636e9e4caff3e23a6dc761f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 5 19:43:30 2011 +0100

    fish: Enhance guestfish win:... parsing to understand drive letters.

commit ade2f824509c5399e60ddab7db2b618aaf8db0aa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 5 18:23:39 2011 +0100

    edit: Allow Windows-style drive letters and paths to be used.

commit 13d8963d8c0203e1f72c519e5acf79ebf7cccb4c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 5 14:03:08 2011 +0100

    New API: inspect-get-drive-mappings
    
    This returns the drive mappings from the Windows Registry.
    
    virt-inspector displays the drive mappings, giving output
    similar to this:
    
      <drive_mappings>
        <drive_mapping name="C">/dev/sda2</drive_mapping>
        <drive_mapping name="E">/dev/sdb1</drive_mapping>
      </drive_mappings>

commit 9e7c6a548353bde925c16434711bcc6208038d83
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 5 12:44:34 2011 +0100

    New API: inspect-get-windows-current-control-set
    
    This returns the actual registry key corresponding to
    CurrentControlSet (eg. it might be "ControlSet001").
    
    Previously the inspection code was hard-coding ControlSet001.  Now we
    use the correct control set, and also make it available to callers
    through the API.
    
    This commit also updates the virt-dhcp-address example so it uses this
    new API.
    
    virt-inspector displays the current control set when available.

commit 9b945cfa781a0f25c3b81239e2fcddceeede6e44
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 5 19:42:00 2011 +0100

    daemon: Reimplement 'mounts' and 'mountpoints' commands.
    
    Reimplement these so they read /proc/mounts instead of trying to parse
    the output of the 'mount' external command.
    
    One consequence of this is that these commands now work again for
    ntfs-3g filesystems.

commit f3eea44f97340f747e46b0df6931a04b53abaf01
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 5 18:44:55 2011 +0100

    Rename resolve_windows_path_silently to case_sensitive_path_silently.
    
    A more accurate description of what this function does.
    
    This is just code motion.

commit 60cdf446063a0ae61c52140355677d7da2327fa2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 5 17:46:23 2011 +0100

    edit: Move 'exit 0' to end of file.
    
    This is just code motion.

commit aed8f220d279e910e0f398fea6fa674cc6a63783
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 5 17:45:41 2011 +0100

    edit: Let $root == $roots[0].
    
    This is just code motion.

commit 4de124debf181ff6af38617b80c2355627e38d35
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 5 17:44:41 2011 +0100

    cat, edit: Reference guestfish equivalent commands in the manual pages.

commit afa17809599f3ebc82c3feef025ca812fb26c9fe
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 4 12:48:02 2011 +0100

    python: Convert any iterable argument to a list (RHBZ#693324).
    
    Thanks to Erez Shinan.

commit 8e61d636bb621e5e2bf6a2f4eb95329ceb2b9890
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 2 22:32:36 2011 +0100

    fish: Add 'pulse mode' to the progress bar.

commit 8629149baa3f1636f88665111beb457d39411fd2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 2 22:31:41 2011 +0100

    fish: Move variable decls to top of function.
    
    This is just code motion.

commit e16d486fa7e49b3638d9c76920b76dc4248b5e81
Author: Nikita A Menkovich <menkovich@gmail.com>
Date:   Sat Apr 2 11:05:19 2011 +0100

    debian: Add missing deps: ocaml-findlib, libstring-shellquote-perl.

commit 5eaffede90d454a9d6542331a77e3a88928705e3
Author: Nikita A Menkovich <menkovich@gmail.com>
Date:   Sat Apr 2 11:04:47 2011 +0100

    mkisofs is obsolete.  Require genisoimage everywhere instead.

commit bbaea1d03acc6f05a52dec11decb9668c9c82912
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 2 09:14:41 2011 +0100

    Pull translations from Transifex.
    
    New Ukrainian po-docs translation added.

commit 8bb22a2902fc723eb809086dd93f5b8ed2ec85b1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 1 20:37:01 2011 +0100

    Version 1.9.16.

commit 9b60f3a9f3b38c085e9265e56ddb839dabe6e416
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 1 16:03:14 2011 +0100

    du: Add pulse mode progress messages.

commit e9feff6f4ca75a7c457927c93ae7f719694b86c7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 1 18:37:29 2011 +0100

    cpmv: Add pulse mode progress messages.

commit 4a64a5a285877df58cd303194735f7414e11e7f3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 1 18:37:39 2011 +0100

    checksum: Add pulse mode progress messages.

commit 40f7323134e058c0920caa18c667ea99a4c8b3e8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 1 15:50:33 2011 +0100

    daemon: Introduce "pulse mode" progress events.
    
    This introduces a new form of progress event, where we don't know how
    much of the operation has taken place, but we nevertheless want to
    send back some indication of activity.  Some progress bar indicators
    directly support this, eg. GtkProgressBar where it is known as "pulse
    mode".
    
    A pulse mode progress message is a special backwards-compatible form
    of the ordinary progress message.  No change is required in callers,
    unless they want to add support for pulse mode.
    
    The daemon sends:
    
     - zero or more progress messages with position = 0, total = 1
     - a single final progress message with position = total = 1
    
    Note that the final progress message may not be sent if the call fails
    and returns an error.  This is consistent with the behaviour of
    ordinary progress messages.
    
    The daemon allows two types of implementation.  Either you can just
    call notify_progress (0, 1); ...; notify_progress (1, 1) as usual.
    
    Or you can call the functions pulse_mode_start, pulse_mode_end and/or
    pulse_mode_cancel (see documentation in daemon/daemon.h).  For this
    second form of call, the guarantee is very weak: it *just* says the
    daemon is still capable of doing something, and it doesn't imply that
    if there is a subprocess that it is doing anything.  However this does
    make it very easy to add pulse mode progress messages to all sorts of
    existing calls that depend on long-running external commands.
    
    To do: add a third variant that monitors a subprocess and only sends
    back progress messages if it's doing something, where "doing
    something" might indicate it's using CPU time or it's printing output.

commit 6e5f64089631622167e60df25ee009ef83df5170
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 1 15:27:46 2011 +0100

    daemon: When running commands, restart select if we receive a signal.

commit 42938f6faf9e724130be28f8e67d3c291bb81cba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 1 15:26:46 2011 +0100

    daemon: Reset SIGPIPE to default before running subprocesses.

commit 371eabfae3790588ed97c0017d2882799c7ea871
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 1 13:30:48 2011 +0100

    Generate progress messages during launch.
    
    This commit generates approximate progress messages during the
    guestfs_launch call.  Currently this code generates:
    
       0 / 12: launch clock starts
       3 / 12: appliance created
       6 / 12: detected that guest kernel started
       9 / 12: detected that /init script is running
      12 / 12: launch completed successfully
    
    (Note this is not an ABI and may be changed or removed in a future
    version).
    
    Progress messages are only generated at all if 5 seconds have elapsed
    since the launch, and they are only generated for the ordinary
    appliance (not if using attach-method to attach to an existing virtio
    serial port).

commit 02971adc3b0f07f3820d0c5e973fabf16d16deb3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 1 13:29:06 2011 +0100

    protocol: Sleep for 1ms before reading log messages.
    
    As explained in the comment:
    
      /* QEMU's console emulates a 16550A serial port.  The real 16550A
       * device has a small FIFO buffer (16 bytes) which means here we see
       * lots of small reads of 1-16 bytes in length, usually single
       * bytes.  Sleeping here for a very brief period groups reads
       * together (so we usually get a few lines of output at once) and
       * improves overall throughput, as well as making the event
       * interface a bit more sane for callers.  With a virtio-serial
       * based console (not yet implemented) we may be able to remove
       * this.  XXX
       */

commit 1bf970cb0e7fc0f9d8c10b567c6c7b4a66e43c17
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 1 12:17:22 2011 +0100

    Shared function to send progress messages.
    
    This is just code motion.

commit 1e6be6afe58de5bfb1ac056b80d3210888edfead
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 1 13:30:24 2011 +0100

    Add prototype for timeval_diff.
    
    This is just code motion.

commit 05dbe09a5c5be3d5f68dc6eb033c4f642fbac8bf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 1 13:54:18 2011 +0100

    docs: Progress messages don't necessarily reach 100% in the error case.
    
    This should be obvious, and now it is documented to avoid any
    confusion.

commit 94945d84c71703adc210793897e1a269a38945f2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 1 13:48:14 2011 +0100

    docs: Fix link to progress messages in guestfs(3).
    
    This updates commit 4e0cf4dbf8a8a96288f70114fdc3939da0aa7ad1.

commit 50e59c237081b2bda36e5a04ecdf446a7fc3ec4c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 1 15:28:42 2011 +0100

    Update copyright date on main guestfs(3) man page.

commit 2c082c5d681c9e0e76d0aad0345df3781d1aa8f1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 1 09:53:53 2011 +0100

    Version 1.9.15.

commit decda45734563d4f7d61355dcaf9318091250f37
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 1 09:53:44 2011 +0100

    fish: Fix incorrect path passed to perror.
    
    Fix commit b8e1dee73a1deef1bfd5937e2abfbe9afef7b1ef.

commit b5130936d870321d8dc28e4369122bd437cab89a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 1 08:50:49 2011 +0100

    Add libguestfs-tools.conf file to EXTRA_DIST.

commit 97d737a88b33d3df97ceacb026b29b1656604a8d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 31 20:20:04 2011 +0100

    examples: Add virt-dhcp-address program.
    
    This is like the mythical 'virt-ifconfig'.  There is not enough
    certainty around the right way to be doing this for us to make
    a full virt tool for this.  Therefore the code is just an example.

commit b41e73008a939ef493d2bfb82c9bd07b0f74736a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 31 20:18:23 2011 +0100

    examples: Use WARN_CFLAGS, WERROR_CFLAGS macros instead of -Wall

commit d5eb5216aae0cb83fae686f490d1c3c37c2c074e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 31 20:17:02 2011 +0100

    examples: size_t-correctness change in inspect_vm.c

commit 1612201a83e732eec7d98d1679dd9dd426bcd10d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 31 18:20:08 2011 +0100

    contrib: Fix URLs in README file.

commit 64bc4495031a1942472038db7aee0bf3b746949d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 31 15:51:00 2011 +0100

    inspect: Detect 32 bit applications running on WOW64 emulator (RHBZ#692545).
    
    These applications are located along a different Registry path.  See
    http://support.microsoft.com/kb/896459 for all the details.
    
    Thanks Jinxin Zheng for finding the bug and the solution.

commit b8e1dee73a1deef1bfd5937e2abfbe9afef7b1ef
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 30 17:03:11 2011 +0100

    Add /etc/libguestfs-tools.conf configuration file.
    
    This allows the default for --ro or --rw to be controlled for the
    three tools guestfish, guestmount and virt-rescue.

commit 4155d20014b24b2203c4dd8b00e2e19450a7e3bb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 30 16:33:14 2011 +0100

    rescue: Add -w|--rw option.

commit 3824935411e8a046f0359578978447dd5a0a1a16
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 30 16:32:33 2011 +0100

    fuse: Document -w flag in --help output.

commit 58f7a5a4ac8cce77dfaded1c29f3ad382b4cc9a8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 29 16:07:21 2011 +0100

    Exclude po-docs directory completely if po4a not available.
    
    Lift the if HAVE_PO4A ... endif completely out of the po-docs
    subdirectory, and just exclude the whole subdirectory if the po4a
    program is not available.

commit edb7501d60a03107c21f023b256d2b01cf116437
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 29 16:03:29 2011 +0100

    tests: Don't fail when compiled without support for NTFS.

commit 759f4369de965f46f4a93b3a75dada050f87e223
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 29 12:20:57 2011 +0100

    perl: Canonicalize /dev/vd* paths in old inspection code (RHBZ#691724).

commit d82d6f0633f63d4a884147b1e85851e96ff8f58d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 28 17:18:24 2011 +0100

    README: Note that getfacl, getfattr are optional dependencies.

commit c3fc40d0c5b5b4667137d07aaecefe8554b90f1b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 28 17:11:51 2011 +0100

    Version 1.9.14.

commit 0d6fd9e1d2488841c912c5351086e536772837ef
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 28 14:45:23 2011 +0100

    fuse: Fix getxattr, listxattr calls and add a regression test (RHBZ#691389).
    
    The documentation for the getxattr and listxattr calls is not very
    clear and as a result we were always returning something different
    from that which the Linux kernel would usually return.
    
    This fixes these calls, at least far enough that both the 'getfattr'
    and 'getfacl' programs now work fine on FUSE-mounted filesystems.
    
    Note that SELinux attrs are *not* passed through.  This appears to be
    a known bug between SELinux and FUSE.  For more information see:
    
    http://www.spinics.net/lists/selinux/msg09460.html

commit 4e529e06a4500959cd783f5029354fea47a253a6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 28 13:35:53 2011 +0100

    fish: fuse: Add -m dev:mnt:opts to allow mount options to be specified.
    
    This lets you turn on ACLs and xattrs by doing:
    
      -m /dev/sda1:/:acl,user_xattr
    
    The extra parameter is passed through to mount_options:
    
      libguestfs: trace: mount_options "acl,user_xattr" "/dev/sda1" "/"

commit feaddb062afcab9117215b4c2188f63d8b647b99
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 28 10:35:14 2011 +0100

    roadmap: Move QMP to 'beyond 1.10'.
    
    See: https://www.redhat.com/archives/libguestfs/2011-March/msg00124.html

commit b8724e23520563606aa15096a50f9964bd2e930a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 28 10:32:14 2011 +0100

    Open release notes for version 1.10.0.

commit e751293e10d5ecbb2ef43a61b9c153a1fc4f0304
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 28 10:03:16 2011 +0100

    ruby: Don't segfault if callbacks throw exceptions (RHBZ#664558).
    (Thanks Chris Lalancette).
    
    See:
    https://bugzilla.redhat.com/show_bug.cgi?id=664558#c6

commit a0e3b2183733c7440ad017c4ffe361935672339b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 25 14:42:40 2011 +0000

    RHEL 5: Use mke4fs on RHEL 5 as replacement for mke2fs.

commit 227bea6c7ef89b707fe2c01c4d0d0fb9081e8c04
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 25 14:34:31 2011 +0000

    mkfs: Force mke2fs to create a filesystem even on raw IDE device (RHBZ#690819).

commit 110bfe1fcc9964b82acf7df6d4d60774471f9157
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 25 12:32:08 2011 +0000

    Rename $tmpdir/sock to $tmpdir/guestfsd.sock.
    
    No functional change; this simply makes the purpose of the
    socket clearer.

commit 23b7c92b0dab43c6feaa137eaf46260f28cdc1f1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 25 11:22:38 2011 +0000

    inspector: Add detection of Slackware.

commit 652a1052373b4d6a6a43ab5e59aeb8db8e2bb284
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 24 12:23:13 2011 +0000

    Version 1.9.13.

commit 3f1e3223c491aa057d02c1da418ed896d09fff7c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 23 16:00:48 2011 +0000

    New API: guestfs_inspect_get_product_variant
    
    This returns a product variant for inspected operating systems.  In
    practice this is a useful way to distinguish between consumer and
    enterprise/server versions of Windows that otherwise have the same
    version number.

commit 0daf7e81a659bcdc1ce327151cc1207b124a35a1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 22 11:50:26 2011 +0000

    fish: Add better quick help to --help output.

commit c8faa5d0b0a17689d27bd33bc787ba0fe9a3f076
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 22 11:50:03 2011 +0000

    fish: Add -w|--rw option to --help output.

commit d06fee159c14d4fe7654a02bae8849c4f82565f8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 22 11:20:38 2011 +0000

    inspect: Don't fail for Windows guests with multiple disks (RHBZ#674130).

commit 5776c145d411e5ae00072ecf422055f3d0bd29e2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 22 11:05:21 2011 +0000

    inspect: Simplify Windows root heuristic code.
    
    Add special is_file_nocase and is_dir_nocase functions and
    remove the duplicate checks for files and directories with
    different cases.

commit 490560439061398d47873484a55fb823be29b285
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 22 11:15:21 2011 +0000

    umount-all: Use /proc/mounts instead of output of 'mount' command.
    
    The particular issue is that ntfs-3g (or FUSE?) no longer appears
    to update /etc/mtab, which meant that umount-all was not unmounting
    these partitions.  But parsing /proc/mounts is simpler and more
    robust in any case.

commit 1541f3a564f8ff14c1a63298120e4dc618ea3274
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 19 18:41:23 2011 +0000

    guestfs(3): 'kernel' -> 'supermin appliance'.

commit cf6f380c544456ee3e84fd41a480ea4cab3d94dd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 19 18:18:56 2011 +0000

    guestfs(3): Indent line to keep code together.

commit c6f45c897575dfc3df63cce1f79ba5456ae6c5f7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 19 12:40:24 2011 +0000

    todo: Add ntfsck.

commit c6310bd242ddaa7b0801df9da7e4fba7346dc53e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 18 20:02:29 2011 +0000

    fish: Add all stamp-*.pod files to CLEANFILES.

commit ec16f13e70111402ab13ddd7dacdcb5270f79342
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 18 19:33:06 2011 +0000

    Version 1.9.12.

commit f4d996fd26762053d68f46de5790aae893f03d38
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 18 18:27:21 2011 +0000

    proto: Fix both-ends-cancel case.
    
    In the case where both ends cancel at the same time (eg. both ends
    realize there are errors before or during the transfer), previously we
    skipped sending back an error from the daemon, on the spurious basis
    that the library would not need it (the library is cancelling because
    of its own error).
    
    However this is wrong: we should always send back an error message
    from the daemon in order to preserve synchronization of the protocol.
    
    A simple test case is:
    
      $ guestfish -N fs -m /dev/sda1 upload nosuchfile /
      libguestfs: error: open: nosuchfile: No such file or directory
      libguestfs: error: unexpected procedure number (66/282)
    
    (Notice two things: there are errors at both ends, and the
    loss of synchronization).
    
    After applying this commit, the loss of synchronization does not occur
    and we just see the library error:
    
      $ guestfish -N fs -m /dev/sda1 upload nosuchfile /
      libguestfs: error: open: nosuchfile: No such file or directory
    
    The choice of displaying the library or the daemon error is fairly
    arbitrary in this case -- it would be valid to display either or even
    to combine them into one error.  Displaying the library error only
    makes the code considerably simpler.
    
    This commit also (re-)enables a test for this case.

commit 33b638109ed66ea360b53b80b1f407b3a5f5ec39
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 18 17:17:30 2011 +0000

    proto: Fix FileIn ops that abort during the chunk upload stage.
    
    As a previous, incorrect attempt to fix RHBZ#576879 we tried to
    prevent the daemon from sending an error reply if the daemon had
    cancelled the transfer.  This is wrong: the daemon should send an
    error reply in these cases.
    
    A simple test case is this:
    
      guestfish -N fs -m /dev/sda1 upload big-file /
    
    (This fails because the target "/" is a directory, not a file.)
    Prior to this commit, libguestfs would hang instead of printing an
    error.  With this commit, libguestfs prints an error.
    
    What is happening is:
    
      (1) Library is uploading
      a file                          (2) In the middle of the long
                                      upload, daemon detects an error.
                                      Daemon cancels.
      (3) Library detects cancel,
      sends cancel chunk, then waits
      for the error reply from the
      daemon.                         (4) Daemon is supposed to send
                                      an error reply message.
    
    Because step (4) wasn't happening, uploads that failed like this would
    hang in the library (waiting for the error message, while the daemon
    was waiting for the next request).
    
    This also adds a regression test.
    
    This temporarily breaks the "both ends cancel" case (RHBZ#576879c5).
    Therefore the test for that is disabled, and this is fixed in the next
    patch in the series.
    
    This partially reverts commit dc706a639eec16084c0618baf7bfde00c6565f63.

commit c7368ce167d6dbfd3e69ba208301c5af3f17a8a1
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Mar 18 16:18:37 2011 +0000

    proto: Don't drop outgoing message when daemon cancels (RHBZ#576879).
    
    This is a (potential) fix for the long standing protocol bug
    which causes loss of synchronization when a FileIn action
    fails very early on the daemon side.  The canonical example
    would be the 'upload' action failing immediately if no filesystem
    is mounted.
    
    What's supposed to happen is this:
    
      (1) library sends
      request message              (2) daemon processes request
      first chunk of data          and sees that it will fail,
                                   sends cancellation
                                   (3) discards chunks of data
      (4) library sees daemon
      cancellation and stops
      sending chunks
    
    It was going wrong in step (1), in guestfs___send_to_daemon.
    In some (timing related) circumstances, send_to_daemon could
    receive the cancellation before sending the first chunk, at
    which point it would exit, *discarding the first chunk*.
    This causes the daemon to fail in step (3) since it reads the
    next request as if it was a chunk, thus losing synchronization.
    (The protocol specifies that you always have to send at least
    one chunk if there is a FileIn or FileOut parameter).
    
    The patch changes guestfs___send_to_daemon so that if it detects
    cancellation, it sends the remaining data in its output buffer
    instead of discarding it.  (This also fixes another edge case
    to do with sending partial data although I don't think we
    ever saw that in practice).

commit 7fb25f53f836172376c25b405b5f88f4ec37eed8
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Mar 18 16:17:09 2011 +0000

    daemon: Improve protocol debug messages.
    
    This adds 'guestfsd: ...' prefix before each message, and
    also puts a message at the top of the main loop just after
    a new message has been received.
    
    The intent is to make it simpler to follow the protocol.

commit dc8e4b057ecd3984d7c27c8ece54048b6a06d662
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 18 11:22:25 2011 +0000

    regressions: Enable both tests for bug 576879 (not fixed).

commit 1e68f84c5a46f3ff650368a897bd4113bd3f4aea
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 18 11:21:55 2011 +0000

    daemon: Print error for invalid chunk.cancel field.
    
    The chunk.cancel field should always be [0|1].  If it is not then
    something has gone badly wrong -- probably loss of synchronization.
    If this occurs print a debug message and return error from
    receive_file function.

commit 65852011d8f5150c5c0bcbfeac90e2fd784905c5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 18 11:20:26 2011 +0000

    proto: Improve debug messages.

commit 502a98948c1bade2969758aff3db09869481105a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 18 11:19:31 2011 +0000

    haskell: Small fixes for ghc 7.

commit e34fc32092e18b38282306558dcef66263a0fb10
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 17 12:46:57 2011 +0000

    regressions: Rename the file we are uploading too.
    
    This updates commit cbd8da6d4dd2e4cbc3b87fbc7cb7d6129eb69172.

commit cbd8da6d4dd2e4cbc3b87fbc7cb7d6129eb69172
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 17 11:57:40 2011 +0000

    regressions: Split the test rhbz576879.sh into two halves.
    
    We suspect that there are in fact two separate bugs.  In any
    case it makes sense for the two tests to be done separately.
    
    Note that these tests still fail.

commit eb6119da38ed98f9fe902401614c2d14ed20bb2e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 16 11:50:16 2011 +0000

    tests: Ignore return value from fwrite.

commit 6bb4d13d718d17ee89602acb97c46bc4d4a38d02
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 15 21:49:53 2011 +0000

    Version 1.9.11.

commit 7160ad148b2947735143f3e06d53fa732ff659ec
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 15 22:00:54 2011 +0000

    ruby: Missing files from EXTRA_DIST.

commit 883390fb2e8cdaf81223eb41c87f245571e3d63d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 15 16:46:00 2011 +0000

    perl: Binding and test for guestfs_last_errno (RHBZ#672491).

commit cf26ef818e918c8c32658399e8aa9e31289109a7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 15 15:00:58 2011 +0000

    ruby: Use ALLOC_N to avoid potential memory leak (RHBZ#667610).

commit c50ed37b71a50b2570a3b16a82a9d73e026be739
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 15 14:52:03 2011 +0000

    ruby: Remove unnecessary checking around StringValueCStr (RHBZ#667610).

commit e9f25e693e3211b0219d84f956dcd3d164bac9d3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 15 14:48:12 2011 +0000

    ruby: Add rdoc documentation (RHBZ#667610).

commit 6a64114929a0b098f5a1e31e17e7802127925007
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 14 22:37:21 2011 +0000

    New event API - Ruby bindings (RHBZ#664558).

commit bc468c87d04b34faacd208c49cca4a5096e5103c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 14 19:42:47 2011 +0000

    New event API - Perl bindings (RHBZ#664558).
    
    The methods $h->set_progress_callback and $h->clear_progress_callback
    have been removed, and replaced with a complete mechanism for setting
    and deleting general-purpose events.
    
    This also updates virt-resize to use the new API.

commit 7e51cc94ddb7527b37111d6fecce96dca14b900a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 14 16:44:17 2011 +0000

    New event API - OCaml bindings (RHBZ#664558).
    
    The functions set_progress_callback and clear_progress_callback have
    been removed, and replaced with a complete mechanism for setting and
    deleting general-purpose events.

commit 4e0cf4dbf8a8a96288f70114fdc3939da0aa7ad1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 10 12:32:22 2011 +0000

    New event API (RHBZ#664558).
    
    This API allows more than one callback to be registered for each
    event, makes it possible to call the API from other languages, and
    allows [nearly all] log, debug and trace messages to be rerouted from
    stderr.
    
    An older version of this API was discussed on the mailing list here:
    https://www.redhat.com/archives/libguestfs/2010-December/msg00081.html
    https://www.redhat.com/archives/libguestfs/2011-January/msg00012.html
    
    This also updates guestfish to use the new API for its progress bars.

commit 6d6b7edd1102f8383643866bf358e494e0d518ef
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 14 13:19:47 2011 +0000

    New APIs: guestfs_first_private, guestfs_next_private to walk over
    the private data area.
    
    This commit adds new APIs for walking over the keys and pointers in
    the private data area associated with each handle (note this is only
    applicable to the C API).

commit d1f1f74e5f45fa5b94ebb096fa65fa33ecc23d09
Author: Angus Salkeld <asalkeld@redhat.com>
Date:   Tue Mar 15 22:43:02 2011 +1100

    check the pid is > 0 before calling waitpid()
    
    Signed-off-by: Angus Salkeld <asalkeld@redhat.com>

commit 6f7c1a9f9d76bdf9f112e12e1508531fb41abfb2
Author: Angus Salkeld <asalkeld@redhat.com>
Date:   Mon Mar 14 22:40:12 2011 +1100

    check the pid is > 0 before calling waitpid()
    
    Signed-off-by: Angus Salkeld <asalkeld@redhat.com>

commit eb304e9689ca474834207605ed52c369bcdec6ea
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 11 10:47:05 2011 +0000

    RHEL5: Old pod2man didn't have --stderr or -u options.

commit 97eab125fa8e3dc481c1f1ba1a847cf43d537585
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 11 10:23:58 2011 +0000

    configure: Remove unnecessary variable assignment.
    
    Left over from pre-virtio-serial days.

commit 003fbdfe5d8b237f42f575199b742c8dde9b8a11
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 11 10:22:58 2011 +0000

    RHEL5: Make use of 'futimens' function optional.

commit 15ba6ae17d5272d3d906f4053ed424447dc910bd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 8 16:22:10 2011 +0000

    Version 1.9.10.

commit c1a227a960066fb9552e0c225bc473be365b67b0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 8 08:10:19 2011 +0000

    Detect Red Hat Desktop as 'rhel' distro (RHBZ#682979).
    
    /etc/redhat-release on Red Hat Desktop contains the following
    string:
      Red Hat Desktop release 4 (Nahant Update 8)
    
    Previously we matched against the string "Red Hat Enterprise Linux"
    but since this does not contain that string, this distro wasn't being
    detected correctly.
    
    Note this also changes the obsolete Perl code, for the benefit of
    virt-v2v.

commit a9d6b948b590f58023a97dddd76302e40d49d2e2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 7 19:30:31 2011 +0000

    Include <locale.h> in compilation units that use setlocale function.
    
    Fix required by gcc 4.6.0.

commit 8037da06feea097716ce700f38c0eac0d5411a7c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 7 19:28:30 2011 +0000

    generator: Introduce error code (errcode) concept.
    
    There was a lot of repeated code to map return types (eg. RErr)
    to error cases (eg. -1 or NULL).
    
    This commit introduces an error code type and two functions to
    map return types to error codes and error codes to strings.

commit 7c721e4fd674c409b3eee60fe237d480afa1c5e2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 7 15:55:56 2011 +0000

    Fix trace segfault for non-daemon functions (RHBZ#682756).
    
    Previously we expanded the code for 'trace_return' unconditionally for
    all non-daemon functions.  However this code was not prepared to
    handle all error conditions, and in fact would segfault if it tried to
    print RStringList or RHashtable where r == NULL.
    
    We need to make the code conditional on the return value, calling
    either 'trace_return' or 'trace_return_error' as appropriate.
    
    Note the difficult case for RConstOptString which returns NULL in
    non-error cases.

commit 2a9e345090ceeae5bdab68407bf1133c040c4f45
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 7 10:53:22 2011 +0000

    Fix URL of transifex instance to be the canonical one.
    
    This updates commit 182a2ceae6d6f50448159e24d8b5c0c92f44407f.

commit 182a2ceae6d6f50448159e24d8b5c0c92f44407f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 7 10:45:27 2011 +0000

    Import project into transifex.
    
    http://www.transifex.net/projects/p/libguestfs/

commit 1c772c921186be34331c7610992f57a69d20d908
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 5 09:17:41 2011 +0000

    debian: Rename nilfs2-tools to nilfs-tools.

commit eda9826d25336bcf661700270c580d4d62128750
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 4 12:13:32 2011 +0000

    virt-make-fs: Round disk size to integer, fix for qemu-img 0.14.
    
    qemu-img used to allow you to specify a fractional image size in bytes
    (or at least, it used to ignore the part after the decimal place).  In
    qemu-img 0.14 it no longer does this so we round down the size to a
    whole number of bytes.

commit 29b3ffdad5d6774f988fd0e25f9c8242e5dd577a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 4 12:13:12 2011 +0000

    virt-make-fs: In debug mode, print qemu-img command line.

commit 290e8864fff8a390d6bbbe20fe9781a03edb4c6a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 4 09:59:15 2011 +0000

    Version 1.9.9.

commit 2b26c7f721fc8ed2e6f64963289981ac286c02aa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 3 13:23:23 2011 +0000

    Fix inspection code when PCRE or hivex is missing.

commit 21fef55ca4907aa9872754f20320c24c7f8a5fac
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 2 05:11:10 2011 +0000

    java: Add a test of g.list_filesystems (a function that returns a Map).

commit eb54a7ede43d9275f10db6fce1472256550da0eb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 2 04:49:12 2011 +0000

    java: Fix generated functions that return RHashtable.
    
    Creating a HashMap directly from JNI is possible but very tedious
    (see: http://java.sun.com/docs/books/jni/html/fldmeth.html#26254)
    
    Instead we use the existing code to return hashes from JNI as plain
    String[], then add some code in the Java wrapper to convert these to
    HashMap<String,String>.

commit 0b2e45da609002d44cbbf689cfdee252e6806648
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 2 04:33:39 2011 +0000

    java: Return Map<String,String> for RHashtable functions.
    
    There's no point returning the specific HashMap type here.
    Return the generic interface type instead.
    
    Note that no users are actually calling these functions yet,
    since at present they always fail.

commit ec62f1127ec4f8609745f9d08b62c65e0ccbd154
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 2 04:30:30 2011 +0000

    java: Fix a minor whitespace error in generated code.
    
    In functions that don't have javadoc, the function prototype wasn't
    being indented correctly.

commit 80aad709954cc4a3a294200e242876599047cef8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 2 05:10:31 2011 +0000

    java: Remove old test file if one was left around.
    
    If a test.img file was left over from a previous run, then it
    would cause the subsequent test to fail.  Therefore remove any
    old test.img file.

commit db98ac041ec36c4e2ce322d336f5792fa8e6922d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 2 05:08:20 2011 +0000

    java: Enable assertions when doing 'make check'.
    
    It turns out that Java assertions are disabled by default.  You have
    to add the 'java -ea' flag to the JVM.  Who knew ..?
    
    Because of this oversight, the tests weren't actually performing the
    assertions that we wanted (although in fact none of the assertions
    were failing).
    
    This change enables assertions when running the tests.

commit f455dc3814bf9f7e7e894ba81360acb0edd92464
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Feb 6 17:18:24 2011 +0000

    Version 1.9.8.

commit 8d7d7c4ecfd202e04d18736718e9c5bb125ce4f0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 3 19:33:30 2011 +0000

    daemon: Ignore return value from chdir.
    
    This updates commit 7eb012f3710bb554d5fc2c4229036901b0b5ad90.

commit a20e5c00c35490fa29668630113a01240a69b701
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 28 19:25:02 2011 +0000

    fish: Add guestfish --live, guestmount --live options.
    
    The other programs have the variable, but the flag is not enabled
    either because it doesn't make sense or because the implications are
    not well understood.

commit 2020eded8a3f381c722abe001be8000723ff2418
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 27 22:45:50 2011 +0000

    Add documentation for attach method.

commit cfd9513a54778e1ade82dc1eb351ea32416938a8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 28 13:19:52 2011 +0000

    Add guestfs_add_domain 'live' flag.
    
    This optional flag controls whether this API call will try to connect
    to a running virtual machine 'guestfsd' process.
    
    If the flag is given and the virtual machine is running, then the
    libvirt XML is parsed looking for a suitable <channel> element, and
    'guestfs_set_attach_method' is called with the corresponding
    virtio-serial socket path.

commit 17434fb159e6391353363b3d11e2c1fb626fe548
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 27 15:54:33 2011 +0000

    lib: Implement attach-method unix:<path>
    
    Allow connections to a Unix domain socket which is connected
    (via virtio-serial) to a guestfsd running free in an existing
    guest.
    
    In order to use this you have to add the following element
    to the libvirt XML:
    
      <channel type='unix'>
        <source mode='bind' path='/tmp/socket'/>
        <target type='virtio' name='org.libguestfs.channel.0'/>
      </channel>
    
    (or perform the equivalent on the qemu command line).
    
    Then in guestfish, you can do:
    
      guestfish \
        attach-method unix:/tmp/socket : \
        run : \
        ll /
    
    (or any other commands as desired).

commit 91324e0a732fe592f2eecd5b541c731bf4f34b74
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 28 15:44:40 2011 +0000

    daemon: Remove -f (don't fork) option.
    
    This option was not being used.

commit 338ecaac0546fe0308df3ae5d0927a171b15edd7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 27 16:54:48 2011 +0000

    daemon: Allow -r option to run daemon standalone.
    
    This changes several aspects of the daemon.  Currently:
    
    * sysroot will be "" (ie. operate directly on /)
    * CHROOT_IN/CHROOT_OUT are disabled
    * autosync doesn't try to unmount everything

commit 7eb012f3710bb554d5fc2c4229036901b0b5ad90
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 3 18:49:35 2011 +0000

    daemon: change to root directory
    
    Ensure the daemon always starts with current directory == root.

commit 58bcfdf321878c475f283caf07c11b6fa7efc4fb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 27 11:20:43 2011 +0000

    New APIs: set-attach-method, get-attach-method.
    
    These allow you to get and set the attach method.  The format
    is one of:
    
    * appliance
    * unix:<path>
    
    It's stored broken out into an enum and a string in the handle.

commit 99f0d8859fdc8f6c81873d4cdd1c8c780ac25e84
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 27 10:12:34 2011 +0000

    lib: Move appliance launching to separate function.
    
    This is just code motion.

commit 5ae752559284efd925fb7959c5760d4fee25f1d6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 3 10:56:01 2011 +0000

    php: Ignore another generated file in php/extension directory.

commit 61a1a2b71c4811b9d6233a43db74229b9364f0c6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 3 09:39:49 2011 +0000

    daemon: Parse /proc/mounts instead of /etc/mtab
    
    Since Fedora util-linux 2.19, the %post script does:
    
      rm -f /etc/mtab
      ln -s /proc/mounts /etc/mtab
    
    We are no longer running %post scripts, so this means that /etc/mtab
    is a plain file in the appliance.  Usual 'mount' still updates it, but
    for some reason mount.ntfs does *not* update it in Fedora 15, meaning
    that you couldn't mount and then operate on NTFS partitions.
    
    It seems better to always parse /proc/mounts (ie. what the kernel
    thinks is mounted) unconditionally, rather than relying on the
    capriciousness of the external mount command.
    
    Therefore, parse /proc/mounts instead of /etc/mtab, but add a note
    saying that in future we should really be parsing
    /proc/self/mountinfo, but that needs a custom parser, and the format
    is rather tricky:
    
    http://lxr.linux.no/#linux+v2.6.37/Documentation/filesystems/proc.txt#L1462

commit f2a4020caf0bc3dd63e9eae95dfc1814f051f87e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 2 20:26:19 2011 +0000

    regressions: Fix rhbz557655.sh so it works with tracing enabled.

commit 5079e0fff3f3c150818adb6febad6393b674f126
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 31 09:34:47 2011 +0000

    guestfs-perl: Fix missing \n
    
    This updates commit 477eebc83dcd33d00d34398692692dae6af04f22.

commit ff6065063335194a8cac88be2d213047bf18a891
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jan 30 23:53:15 2011 +0000

    Version 1.9.7.

commit 0089575d4bd50a7ca55d7c3c8caa8a12ae09d40a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jan 30 23:53:04 2011 +0000

    virt-make-fs: Fix typo in man page.

commit 477eebc83dcd33d00d34398692692dae6af04f22
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jan 30 23:41:05 2011 +0000

    perl: Translate C examples into Perl and include a manual page.

commit 6975e87153f593fddd5c27435c2e6347825daca9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 29 07:01:06 2011 +0000

    perl: Ignore internal_* functions in POD coverage test.
    
    This updates commit 1d999540bddd7aea7c2d0fef8b15223d4acc645f.

commit b6c70b3f50472e20a33320e7d76887b011f33c64
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 28 22:51:36 2011 +0000

    Fix test-guestfish-a.sh regression test for new trace format.
    
    This fixes commit 1d999540bddd7aea7c2d0fef8b15223d4acc645f.

commit f060d5bcd40b4a6506d7994e67d57dccab1651b8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 28 21:41:06 2011 +0000

    autobuild: Add a 'make clean' step.

commit 82f5fdb0dbbc0c7b04861edeadf70c86c9342df2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 28 17:11:40 2011 +0000

    lib: Fix use-after-free bug in XPath parsing code.

commit d2636b0984830d950423dadd936114ff242c4a00
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 28 15:28:25 2011 +0000

    Add a new internal-autosync API to perform autosync.
    
    Instead of explicitly calling umount-all; sync, we add a daemon
    function called internal-autosync which does the same.
    
    Apart from slightly simplifying the process of closing the handle, the
    main advantage is we can modify the daemon for the standalone case so
    that internal-autosync does not do the umount-all operation.

commit 1d999540bddd7aea7c2d0fef8b15223d4acc645f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 28 11:14:42 2011 +0000

    Add a prefix to output when tracing (RHBZ#673479).
    
    Also separate the call and return lines so that everything can be
    easily 'grepped' from debug output.  The trace output now looks like
    this:
    
    $ guestfish -x -N fs exit
    libguestfs: trace: is_config
    libguestfs: trace: is_config = 1
    libguestfs: trace: add_drive "test1.img"
    libguestfs: trace: add_drive = 0
    libguestfs: trace: is_config
    libguestfs: trace: is_config = 1
    libguestfs: trace: launch
    libguestfs: trace: launch = 0
    libguestfs: trace: part_disk "/dev/sda" "mbr"
    libguestfs: trace: part_disk = 0
    &c.

commit 77df7d6d537cebe05e06bf07e6e4a2082fe6656a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 27 17:27:41 2011 +0000

    daemon: Replace root_mounted global with intelligence.
    
    We used to maintain a global flag 'root_mounted' which tells us if the
    user has mounted something on root (ie. on the sysroot directory).
    
    This flag caused a lot of trouble (eg. RHBZ#599503) because it's hard
    to keep the flag updated correctly when the user can do arbitrary
    mounts and also use mkmountpoint.
    
    Remove this flag and replace it with a test to see if something is
    mounted on *or under* the sysroot.  (It has to be *or under* because
    of mkmountpoint and friends).
    
    This also replaces a rather convoluted "have we mounted root yet"
    check in the mount* APIs with a simpler check to see if the mountpoint
    exists and is an ordinary directory.

commit e85fbee7bff9422a370d3f437594d262c043d89b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 27 15:54:00 2011 +0000

    daemon: Add perror to two exit paths to make errors clearer.

commit 8a406c7bee521289c6f8704549f1f144b5bbbbd9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 27 09:23:01 2011 +0000

    debian: Include actual shared libraries in python-guestfs package.

commit 92b74729e2608a0266fff3a36d87cebefe66d833
Author: Nikita A Menkovich <menkovich@gmail.com>
Date:   Wed Jan 26 15:34:01 2011 +0000

    mkfs-opts: Add optional "features" parameter.
    
    This allows the -O parameter to be added to the mkfs command line.
    This is used to select filesystem features.

commit dd653336cc34c2e8640aa7e19174a3e339049dc2
Author: Nikita A Menkovich <menkovich@gmail.com>
Date:   Wed Jan 26 15:32:18 2011 +0000

    mkfs-opts: Add a note about blocksize param and UFS filesystems.

commit 2110f6fa8c397f74e38408612d5514a42f3b9cee
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 26 14:15:23 2011 +0000

    generator: Fix generation of library-side stubs with optional String arguments.

commit c76f155496717c526ef0b5e72083bb0034f61d3c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 26 10:00:44 2011 +0000

    packagelist: Add ufsutils for Debian and Ubuntu.
    
    Note there is no mkfs.ufs available for Fedora (see RHBZ#541618
    for details).

commit 36fe0acf8a2e72c223d7a9f7a93815ff276a3cc1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 22 18:05:35 2011 +0000

    Version 1.9.6.

commit e8ab05b12c6b1c13278e549883efd47900a4bac1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 22 14:46:37 2011 +0000

    fish: Fix typo in error message (copy-in should be copy-out).

commit 78f1405de05ef1f2efebafd8245658d1707e59ef
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 19 21:47:23 2011 +0000

    Use /var/tmp for the cached appliance (for FHS compliance).
    
    The FHS advises large files not to be stored in the root
    filesystem[1], and that /var/tmp is persistent across reboots[2]
    (whereas /tmp is possibly not[3]).
    
    Therefore we should store the large cached supermin appliance in
    /var/tmp instead of /tmp.  /tmp is still used for all other temporary
    files and directories.
    
    In either case you can override this by setting $TMPDIR.
    
    [1] http://www.pathname.com/fhs/pub/fhs-2.3.html#THEROOTFILESYSTEM
    [2] http://www.pathname.com/fhs/pub/fhs-2.3.html#VARTMPTEMPORARYFILESPRESERVEDBETWEE
    [3] http://www.pathname.com/fhs/pub/fhs-2.3.html#TMPTEMPORARYFILES

commit 316ad8311a41869cf5f253225137dd03d1211ce7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 18 22:38:05 2011 +0000

    fish: Initialize pcmd structure.
    
    On Debian we get this warning which I'm pretty sure is bogus:
    
    fish.c:690: error: 'pcmd.cmd' may be used uninitialized in this
    function [-Wuninitialized]

commit 41bbc0a7a3f3cd768c83183327ffc562d2040a83
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 18 13:21:30 2011 +0000

    Version 1.9.5

commit c3887285abbb3606822626ba396a51cb5df80d43
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 18 11:46:03 2011 +0000

    fish: <! cmd executes a shell command and inlines the resulting commands.
    
    The new guestfish construct "<! cmd" executes the shell command
    "cmd", and then anything printed to stdout by "cmd" is parsed
    and executed as a guestfish command.
    
    This allows some very hairy shell scripting with guestfish.

commit 61a4db138e4f85033c655bf6b24df0949683c24c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 18 11:24:38 2011 +0000

    fish: Factor out command line parsing.
    
    Factor out the code which splits a string into a command line.

commit 4bcb267a248977c6b044e18a72266d665102de30
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 18 10:33:01 2011 +0000

    fish: Make exit_on_error into a completely local variable.
    
    Note that 'time' and 'glob' (which both run subcommands) do not
    correctly pass the exit_on_error flag in the remote case.  This is not
    a regression: the current code doesn't work either.

commit f6a21c1e0d44f9db409ce6583be7b5bc694767a8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 18 10:21:49 2011 +0000

    fish: exit_on_error is a local variable.

commit deadcc73260a82c210417382412f80d14c5292db
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 15 16:40:49 2011 +0000

    todo: Live CD inspection works, but not for Windows 7.

commit 07f1be28e85c37580d882c0a889528c1b9c6b4a0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 15 14:56:36 2011 +0000

    Version 1.9.4.

commit bc93d2ba38eb17a45888b97e8bcfd5f0e0bcb57c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 15 14:56:25 2011 +0000

    README: Note that po4a is mandatory if compiling from git.

commit c2f2a2c6769be908b25b0946f39770d09bb6ddc9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 14 22:20:51 2011 +0000

    Add ability to inspect install disks and live CDs.
    
    For examples of the virt-inspector output, see the additional
    inspector/example-*.xml files in this commit.

commit 4402e6048fb2a56461f9e4d474fc2f1391248781
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 15 13:18:36 2011 +0000

    inspect: Add macros for file size limits.
    
    This also bumps the file size limit for "small text files"
    up to 2 MB, since we want to parse Windows CD txtsetup.sif
    files that are usually around 500K in size.

commit 4ffa2d6798f7a2bf0baec8e1084659cf6358bc31
Author: Nikita A Menkovich <menkovich@gmail.com>
Date:   Fri Jan 14 13:39:38 2011 +0000

    New API: resize2fs-M to resize ext2/3/4 to minimum size.

commit 69f2f6290032e1079dfa1e83fab3559d5d2d690f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 11 21:54:57 2011 +0000

    Version 1.9.3.

commit e5220b26f51d5912371424ab6dfbdb46ce6aa170
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 11 13:55:23 2011 +0000

    df: Skip final '/' character when calculating basename.
    
    Previously it was including the final '/' character when calculating
    the basename for the -a option eg:
    
    Filesystem                                Size       Used  Available  Use%
    /Ubuntu1010x64:/dev/sda1                  9.4G       2.3G       6.6G   25%
    
    With this patch the '/' is not printed.

commit 0c60e4d9dd6549c2135699490ba8a9ec1dd50ab9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 11 10:43:51 2011 +0000

    fish: Don't fail if some mountpoints in /etc/fstab are bogus (RHBZ#668574).
    
    Fix guestfish (and other C tools) so that they ignore errors
    when /etc/fstab contains bogus entries.
    
    Update the documentation for inspect-get-mountpoints to emphasize
    that callers must be aware of this when mounting the returned
    values.
    
    Add a regression test.
    
    Update the example code ("inspect_vm") to reflect the way this
    API ought to be called.
    
    For more detail see:
    https://bugzilla.redhat.com/show_bug.cgi?id=668574

commit fc241abdbac7a016cd2fac169ad64876107df3c8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 11 10:47:11 2011 +0000

    Add logo used on the website.

commit a2bf709b3c68cd95554412c041a455354033fa2b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 10 10:41:20 2011 +0000

    Add cartoon fish logo (not completed).

commit 844d7f575527b5ade34188755e92d0edecb83fec
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jan 9 13:13:02 2011 +0000

    todo: /proc/self/mountinfo

commit 62d4f2550d6b412a4b3ad4b34d4b3d3a67c4eb6c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 8 20:51:58 2011 +0000

    todo: Add notes on inspecting ISO images.

commit 97339a0f43d687efac6f7edafdf21e4b8d9b35e8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 8 10:15:39 2011 +0000

    virt-filesystems: Ignore errors when getting label and UUID (RHBZ#668112).
    
    If virt-filesystems was pointed to an image that contained
    bogus or blank filesystems, then calls to vfs-label and/or vfs-uuid
    could fail, resulting in errors like this:
    
    libguestfs: error: vfs_label: /dev/vda1:
    
    These errors can be ignored and shouldn't stop virt-filesystems
    from working.

commit 7e1114445e713c4a15f3f2cede5842044de1735a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 7 20:38:55 2011 +0000

    resize: Fix typo in man page (thanks avesh@IRC).

commit 7ce627fce02eae8c7db36b4090fa0ce1bf69bf44
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 4 16:05:11 2011 +0000

    fish: fails to tilde expand '~' when $HOME env is unset (RHBZ#617440).
    
    This also adds a regression test.

commit a9802509184341e731de5c9af363184a9964a8a7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 4 16:02:48 2011 +0000

    fish: Fix off-by-one bug in tilde expansion.
    
    Although this doesn't seem to cause a crash, valgrind confirms
    that this is a genuine off-by-one bug.  It could potentially
    cause a crash if you did:
    
      echo 'echo ~root/foo' | guestfish

commit 04a9645ca6a3651e76ca311cd2ff79a22bd2af1f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 3 17:31:46 2011 +0000

    Version 1.9.2.

commit b8f9a20b039b34ba41098d1360866b6f9f74463d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 3 17:16:44 2011 +0000

    New tools: virt-copy-in, virt-copy-out, virt-tar-in, virt-tar-out.
    
    Relatively trivial wrappers around the equivalent guestfish
    commands.  Change also includes new man pages.

commit 72f4b2e7493bf81b111ecd83490c9d3ad2480382
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 3 17:17:54 2011 +0000

    .gitignore: Use full paths for some ignored files.

commit 1b1db82d64a9664f0da1c628ee896a113a605739
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 3 14:36:19 2011 +0000

    docs: Add QMP to ROADMAP file.

commit 440cd23f54f44132b8ff3d1e5b0b05b9dd5cc1c0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jan 2 22:55:48 2011 +0000

    filesystems: Document the columns in --long output.

commit 9ae4168c30b8be57909f5b0104c5e925743c6cc0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jan 2 21:43:22 2011 +0000

    Add initial announcement to release notes.

commit f13f3386007381f2955f8cfc45ecf84d9ebfa0ce
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jan 2 21:01:43 2011 +0000

    Update TODO file.

commit dd7ad7c7ebd7b3cf7fbcc03d3baadbb77bf4203a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jan 2 21:01:41 2011 +0000

    inspector: Apps in Windows VMs are now listed - update documentation.

commit f07a0b6f1e01f12db0286ae49744deee0efcb5b9
Author: Douglas Schilling Landgraf <dougsland@redhat.com>
Date:   Sun Jan 2 18:55:12 2011 +0000

    Lib.pm: unknown filesystem /dev/hd{x} (cdrom) (RHBZ#666577)
    
    This a purpose patch to avoid the message "unknown filesystem /dev/hdc".
    Where /dev/hdc is an entry in fstab for CDROM.
    
    Example of fstab:
    /dev/hdc                /media/cdrom            auto
    pamconsole,exec,noauto,managed 0 0
    
    https://bugzilla.redhat.com/show_bug.cgi?id=666577
    
    Signed-off-by: Douglas Schilling Landgraf <dougsland@redhat.com>

commit 5cab0d6c807d8a3bf9690375c663d11a10e21656
Author: Douglas Schilling Landgraf <dougsland@redhat.com>
Date:   Sun Jan 2 18:53:55 2011 +0000

    Lib.pm: unknown filesystem label SWAP-sda2 (RHBZ#666578)
    
    Hi,
    
    This is a purpose patch to avoid the message: unknown filesystem label
    SWAP-sda2.
    
    Instead of validate the label with 'eq', use '=~' and /$label/i.
    
    https://bugzilla.redhat.com/show_bug.cgi?id=666578
    
    Thanks
    Douglas

commit e99ac0394acbba2923e361d84511b9646f464585
Author: Douglas Schilling Landgraf <dougsland@redhat.com>
Date:   Sun Jan 2 18:52:52 2011 +0000

    Lib.pm: avoid message "unknown filesystem /dev/fd0" (RHBZ#666577)
    
    This patch to avoid the message "unknown filesystem /dev/fd0".
    https://bugzilla.redhat.com/show_bug.cgi?id=666577
    
    Signed-off-by: Douglas Schilling Landgraf <dougsland@redhat.com>
    
    Thanks
    Douglas

commit 62c47b74317f148338f5b85302b537a187fab199
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jan 2 16:50:39 2011 +0000

    Tempora mutantur, nos et mutamur in illis.

commit 5c9e8a65fe89e5e6baca8651000885d8467356ff
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 31 11:11:02 2010 +0000

    podwrapper: Fix up the HTML output so most inter-page links work.

commit d71faf98624c1fb2c760e0e9f55205beb06b7644
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 31 10:44:32 2010 +0000

    podwrapper: Fix script indentation.

commit 7a8c60e1c8fbaf09fb2fa2fe10b50df39c0d9650
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 31 10:39:05 2010 +0000

    podwrapper: 'builddir' was not defined - use a properly defined path.

commit 2dbd22727dbd8287adfcdbf4851b2e818d79a8e2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 31 08:41:44 2010 +0000

    Version 1.9.1.

commit ce85a6a82ae80fdfb3eb7c2c2251658f8aadc241
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 30 23:32:09 2010 +0000

    docs: add-domain: Remove ref to not impl add-libvirt-dom API call.

commit 86a53e17de672a79a994b905676b4566da9f072c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 30 23:14:12 2010 +0000

    docs: Refresh programming language list in guestfs(3).

commit 33e9639f2037540a89a9bbaf7212683e8a60fe84
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 30 23:08:18 2010 +0000

    docs: Refresh programming language equivalence example in guestfs(3).

commit cdc798ac3558e416dc756a0fcefad2af5ca307e0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 30 22:56:25 2010 +0000

    docs: Fix missing g handle in guestfs(3) man page.

commit 22042693cc1e0455a4a503dba93a9fedc9c74f04
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 30 22:56:07 2010 +0000

    docs: Refresh guestfs(3)/DOWNLOADING.

commit 1a9b7df8f2092701fdc5a77a4d9edfcaa1a20acf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 30 22:46:29 2010 +0000

    docs: Refresh guestfs(3)/MOUNTING

commit 3f4dc56a32074a02b1b829bd7a91878f73022d1d
Author: Jaswinder Singh <jsingh@redhat.com>
Date:   Thu Dec 23 13:45:26 2010 +0000

    Update Punjabi translations (RHBZ#665358).

commit 49b2ae2e69e1a273b4d4a8746a872ec00b91c86f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 21 17:23:08 2010 +0000

    recipes: Refresh guestfish recipes.

commit b1ca8b5fbb263fd945f21d0ccff99f40a59d562b
Author: Piotr Drąg <piotrdrag@gmail.com>
Date:   Tue Dec 21 13:42:27 2010 +0000

    Updated Polish translation (RHBZ#502533).

commit 327442119ff1f1791a0682928e59b0c4b4752007
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 20 22:33:45 2010 +0000

    fish: --ro will be default in 1.10, not 1.8.

commit e32a85cf9307e45826a38e7271576a965b2f2731
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 19 21:58:05 2010 +0000

    docs: Update API support.

commit 7ba1b55aa79c56ded770f8ea46716eb054fbfe78
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 19 22:08:49 2010 +0000

    api-support: Fix detection of similar APIs.
    
    Because we didn't match on word boundaries, the previous
    code would get confused by similar APIs, eg. getxattr vs getxattrs.

commit d2400da92e5e2cc7fd5e33e61220a33214d5241c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 19 21:53:09 2010 +0000

    docs: Obsolete HACKING file, move content into guestfs(3) man page.
    
    Add a new section called "EXTENDING LIBGUESTFS" to the
    guestfs manual page which contains all the information
    previously in "HACKING".

commit 84fbe21855b5b304413075fecb444135397591e6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 19 21:52:46 2010 +0000

    docs: Refresh README file.

commit dfbdae5dd27b84222825b6826065a3362ab71025
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 19 19:29:02 2010 +0000

    Update TODO file.

commit 8df8ccb287b739748294d4074c09448bd2b2e62b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 19 15:53:07 2010 +0000

    Version 1.9.0.

commit fc279d28060b2ee6f52dbc92cb1541f2494e1258
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 19 15:39:04 2010 +0000

    Update BUGS, PO files for 1.8.0.

commit 48eb763d85cb0b343339c8a49549688e821f0edd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 19 14:31:01 2010 +0000

    Prepare for next stable branch: version 1.8.0.

commit b62e154d97f727f322f954060c67b6ba14cb1925
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 19 14:25:50 2010 +0000

    Update RELEASE-NOTES.

commit e427d86de1ecd4a3b546df33445d0562a4b858ae
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 19 14:20:17 2010 +0000

    Add ROADMAP for 1.10.

commit 85c0bf53085e78b257cf71455a55924fe6e3943b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 19 12:04:43 2010 +0000

    fuse: Add more tracing for calls into guestmount functions.

commit 2712f237b01a3b7c582e253069864b0449b2d66e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 19 11:01:59 2010 +0000

    appliance: Don't exclude upstart (/sbin/reboot) (RHBZ#661280).
    
    Don't exclude upstart from the appliance.  It provides /sbin/reboot
    which is required by virt-rescue.

commit da24e7aab06361b8d9bb5b5c8417611501e94684
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 19 10:56:06 2010 +0000

    appliance: Don't hard-code febootstrap --exclude parameters.
    
    Create a separate file 'excludelist.in' that contains these
    regular expressions, and process it the same way as packagelist.in.

commit 9556903888eed268895a8454491d56302985f7e1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 19 10:55:03 2010 +0000

    appliance: Use a temporary file when processing packagelist.in.

commit acd25281bfa31b78fd03e25b495f66138a4dd987
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 17 18:56:15 2010 +0000

    docs: Add section on using /dev/fd/* with upload and download calls.

commit fa4931bc4e2944e9b3b72843d4b0350d7ad36238
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 17 10:21:41 2010 +0000

    docs: Fix link to function in documentation of "du" and "du-s" commands.

commit 8ae40fa990b38005379c1c831f56c07b6b452bee
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 16 23:21:29 2010 +0000

    Version 1.7.24.

commit 933e970b8ac654586bc3595f56b187fab65b1173
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 16 20:23:17 2010 +0000

    ntfs-3g: Document problems with symlinks and alternatives (RHBZ#663407).

commit 3a3836b933b80c4f9f2c767fda4f8b459f998db2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 16 20:05:48 2010 +0000

    New APIs: getxattr and lgetxattr to get single extended attributes.
    
    These APIs are essentially required to work around a problem
    with ntfs-3g.  This filesystem (or FUSE?) does not list all
    extended attributes of a file when you call listxattr(2).  However
    if you know the name of an extended attribute, you can retrieve
    it directly using getxattr(2).
    
    The current APIs (getxattrs etc) are simple to use, but they
    don't work if we can't list out the extended attributes (ie.
    by calling listxattr(2)).
    
    Example using the new APIs on an ntfs-3g filesystem:
    
    ><fs> lgetxattr "/Documents and Settings" system.ntfs_attrib | hexdump -C
    00000000  16 24 00 00                                       |.$..|
    00000004
    ><fs> lgetxattr "/Documents and Settings" system.ntfs_reparse_data | hexdump -C
    00000000  03 00 00 a0 34 00 00 00  00 00 18 00 1a 00 10 00  |....4...........|
    00000010  5c 00 3f 00 3f 00 5c 00  43 00 3a 00 5c 00 55 00  |\.?.?.\.C.:.\.U.|
    00000020  73 00 65 00 72 00 73 00  00 00 43 00 3a 00 5c 00  |s.e.r.s...C.:.\.|
    00000030  55 00 73 00 65 00 72 00  73 00 00 00              |U.s.e.r.s...|
    0000003c
    ><fs> getxattr "/Documents and Settings" system.ntfs_reparse_data | hexdump -C
    libguestfs: error: getxattr: getxattr: No such file or directory
    ><fs> getxattr "/Documents and Settings" system.ntfs_attrib | hexdump -C
    libguestfs: error: getxattr: getxattr: No such file or directory
    ><fs> lgetxattr "/Documents and Settings" system.ntfs_attrib | hexdump -C
    00000000  16 24 00 00                                       |.$..|
    00000004
    ><fs> getxattr "/Users" system.ntfs_attrib | hexdump -C
    00000000  11 00 00 00                                       |....|
    00000004

commit 236c1fb7db210038abb70ae436aeb4119dd99563
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 16 18:45:08 2010 +0000

    appliance: Add 'attr' package for xattr support in virt-rescue.

commit dec770f171329868081985ca0aa3d52eb3759935
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 12 23:18:26 2010 +0000

    generator: List files generated in a separate file.

commit 9aacbe712d1326cff05a7343cf4603df38e96ef7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 12 23:02:44 2010 +0000

    docs: Update RELEASE-NOTES to latest.

commit 0d267d6cd5cd86c7e5359146ba8745db4a349187
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 12 23:02:30 2010 +0000

    README: Advise using febootstrap >= 3.3.

commit 573e01e0871324c038bac2fd391c86c8b7fb0247
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 12 22:36:06 2010 +0000

    Version 1.7.23.

commit 6e874195970a8e352d104bd0ebc254fd92f3b370
Author: Thomas S Hatch <thatch45@gmail.com>
Date:   Sun Dec 12 10:55:09 2010 -0700

    Removed hfsprogs from supermin packages for Arch

commit e49aefd1f8a85c02d344cef18c8b07aa1c2187f9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 12 10:02:00 2010 +0000

    fish: Clarify documentation for --ro option.

commit e6a3770b43383d66f39230510d8ff01083d5c3ac
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 12 10:01:30 2010 +0000

    fish: Document equivalence of -a/add etc. in man page.

commit f341624668d10c58e2899354cef1e11c4175992a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 12 09:48:59 2010 +0000

    fish: Split ..|.. options into separate items in man page.

commit a6bfc9f3c44c6b4421d5a7b1d872411583a5cffa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 11 23:35:18 2010 +0000

    appliance: Don't set utime on cachedir until we know it is safe.
    
    This could be used to touch an arbitrary file (albeit one which
    must already exist), and this could have been a security problem.

commit f410d571ccbf54b34937dab2868614d35fe59855
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 11 23:23:36 2010 +0000

    appliance: Touch cached appliance files so they don't get tmp cleaned.

commit 3d114fcf84372c52ea769c4bb8efa572936f1f5a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 11 23:07:56 2010 +0000

    Remove extra \n character from end of error messages.

commit 52c6b0d96d26ae056759222fe0ac029ca2d60bbf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 11 18:08:08 2010 +0000

    Version 1.7.22.

commit 4beb2844091310012b5e28971707397d1d51d833
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 11 17:22:43 2010 +0000

    appliance: Be careful about cleaning up old appliances.
    
    This change resolves several issues with current appliance
    building:
    
    (1) Old appliances are cleaned up.
    
    (2) Race conditions between appliance building is handled better.
    
    (3) Several bugs fixed.

commit 363978fa7fc055da380d31103c7de378a08b71fb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 10 17:38:17 2010 +0000

    daemon: Use prog_exists to check for features.
    
    This updates commit 0938509e0422363554023ab99381fd70a22a6e08.

commit 4fb66110c2ffec1bc3f7fdf4a6d09b1d28a78db3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 10 17:19:02 2010 +0000

    debian: Work around warning in Debian udev init script.
    
    See also:
    http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=606622

commit 8d8dc4c10700ee43bd026469665f5a16f6d2cbf5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 10 15:05:17 2010 +0000

    win-reg: Add Windows Tips to documentation.

commit bc484e99c23842aa67d2b533023eeaaa30fd6868
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 10 14:36:18 2010 +0000

    win-reg: Move documentation after options, combine shell quote sections.

commit b4310a810cb4050eb6473971895d3c255f045ccc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 10 13:44:25 2010 +0000

    Version 1.7.21.

commit d72815578f7b8fea9702902d8562430e8a007a46
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 10 12:19:49 2010 +0000

    Remove several unused local variables.
    
    (Revealed by compiling under Debian where this is a warning).

commit 8dafeaa477f9e3d2fde827b8de4b44d66b661b69
Author: Thomas S Hatch <thatch45@gmail.com>
Date:   Thu Dec 9 22:04:24 2010 -0700

    Added packages for Archlinux support

commit 4164e9966456896379f964edb5f0676920f4bba2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 9 18:31:23 2010 +0000

    debian: Dependencies for all the different names of qemu/KVM.

commit 1d4f1ba129610f2c54cf6682df0cf134df89c48d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 9 18:31:03 2010 +0000

    debian: Quilt is not used for patch management.

commit ff99f399f09025eb4c880da8f13d666146dfac7f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 9 18:30:08 2010 +0000

    cat: Remove some unused local variables in virt-cat.c and virt-ls.c.

commit 8e7012131cbf406a936efbbe688aec253bd742a0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 24 11:41:13 2010 +0000

    Add debian/ directory (temporarily).
    
    This was created initially from pkg-libvirt/libguestfs.git
    commit 680ff0b0e8c9133ef987e68392bd3990715f6891.
    
    This is a temporary measure to allow us to build Debian and Ubuntu
    packages more easily.  When downstream packaging is being done on
    these distros we will remove this directory again.
    
    To build a Debian package, use this command:
    
      debuild -i -us -uc -b

commit b5516dc9d4a1418ad683aa7f046aa7fa30152721
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 9 16:24:35 2010 +0000

    debian: Exclude file-rc.
    
    This package duplicates /etc/init.d/README which is
    really supplied by sysv-rc package.

commit ff484e00535e11da17d9c63447abbb6b65e4f11b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 9 12:42:33 2010 +0000

    build: Use ./configure --with-python-installdir=DIR to select Python dir.
    
    We don't always want to install in the site-packages directory.  Allow
    the directory to be chosen using a configure option.  Rename the
    variable PYTHON_INSTALLDIR to reflect its true purpose.

commit 8ea322aba3041e67cf32b43101a3299f89c9b0dc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 9 12:35:41 2010 +0000

    build: Add "checking ... result" around Python tests.

commit 8e4c22db236f08f836a8ab94c8bb025d727684b5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 9 12:06:09 2010 +0000

    build: Remove check for root.
    
    With the new package building system, it is no longer dangerous to run
    'configure', 'make' or 'make check' as root (although it is still not
    necessary and not advisable).  In any case we don't need to check
    this.

commit 75893a554c374f59318844bca3433e6a2d6c774b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 9 16:41:20 2010 +0000

    inspector: Remove some unused local variables.

commit 5376e13806576a392270621ae3cf37c32be40559
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 9 11:54:59 2010 +0000

    fish: Remove some unused local variables.

commit 370f79fd3d3df3511fe50f39491c2d15f653c48f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 23 17:37:25 2010 +0000

    build: Remove AM_GNU_GETTEXT_VERSION macro.
    
    See discussion on the mailing list:
    https://www.redhat.com/archives/libguestfs/2010-December/thread.html#00032

commit f3805e2166e2ab54cd9a6e8b7c536e6f20a61dff
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 8 12:12:08 2010 +0000

    rescue: Add notes about networking.
    
    In particular the 'ping' command does not work because it is
    using QEMU user networking.

commit c5747bd43637efb81485866e1fade3bb55f6d726
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 8 12:11:53 2010 +0000

    rescue: Add note about using virt-rescue as root/non-root.

commit df5ae67129dcbb16e2437b65b4557dfe73c1782d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 7 22:16:02 2010 +0000

    docs: Link to guestfs-examples(3) after simple example.

commit 917c3520c7d6a2f3f9f670e42e0875aa40579a30
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 7 22:15:45 2010 +0000

    docs: Note that guestfs_sync is no longer necessary.

commit 4b8f70d46dcfed1489c97f822e263b8615f21ea0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 7 18:41:40 2010 +0000

    Version 1.7.20.

commit 70a92b3cfb278403c844d22c9a47c82ddfccdb9c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 7 18:39:11 2010 +0000

    build: relink-static.sh script removed from EXTRA_DIST.
    
    This updates commit 9bc15f5d98a3a17d465a94f42dc3ffb60c077293.

commit 0942cab0375cb445cc8edfba87ea82a703383964
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 7 17:55:38 2010 +0000

    ubuntu: deactivate LVs and VGs before removing them.
    
    Even with the '-f' option, LVM on Ubuntu sometimes cannot remove
    active LVs and VGs.
    
    Change lvm-remove-all so it deactivates each LV and VG before
    removing them.

commit 1c63d8239a9a05eeafd4e4b8c882200bc68a3109
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 7 17:32:40 2010 +0000

    Revert "umount-all: Add udev_settle after unmounting disks."
    
    This reverts commit ad2abf89c364d5ec73fb12af63b053637d99d757.
    
    Ubuntu still has errors even with the addition of udev_settle
    after umount-all.  Therefore this was just masking the problem.

commit 0938509e0422363554023ab99381fd70a22a6e08
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 7 16:51:41 2010 +0000

    debian: Fix ntfs3g available API on Debian.
    
    Really we should have a test for "is program on $PATH?" but this
    fix will do for now.

commit 37a242286896afe119163335143ffbdd6842127b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 7 17:16:20 2010 +0000

    fuse: Set UID and GID when performing FUSE tests.
    
    This avoids breakage on Ubuntu.

commit fd4d0d83f133772aa1e84d8a3af6f642f9c73b5c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 7 16:23:41 2010 +0000

    autobuild: Skip some tests on Ubuntu.

commit d29304c1b486c94970aff0631e0bf91c745b0ef9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 7 16:22:23 2010 +0000

    ubuntu: Allow test-luks.sh to be bypassed to workaround Ubuntu bug.
    
    This is necessary because of too old cryptsetup on Ubuntu.

commit ad2abf89c364d5ec73fb12af63b053637d99d757
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 7 16:15:32 2010 +0000

    umount-all: Add udev_settle after unmounting disks.
    
    This helps avoid an error on Ubuntu, but it's not clear if this
    is a real solution or just helps by adjusting the timing of some
    race condition.

commit 4df67f26aef7339ef9690da7becb756c9f3f4eaa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 7 15:29:55 2010 +0000

    fuse: Disable test which doesn't run reliably on Debian.
    
    See discussion in RHBZ#660687.

commit de419e4bace5d5be58a87d76f0c63ec39f327d1a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 7 14:49:34 2010 +0000

    fuse: Fix emulation of open call.
    
    We were being over-complex in this call.  All the FUSE API requires
    this call to do is to check permissions.

commit 97cbb842362e2548a59a1560c50e5f998fa5bda8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 7 13:29:40 2010 +0000

    fuse: Fix segfault in guestmount --verbose.
    
    If hash_delete returns NULL and --verbose option was given then
    this would cause a segfault.

commit 4c5038ab54fb6fdff75ca8d5fdda9e73f48a5050
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 7 09:48:20 2010 +0000

    Add autobuild script.

commit c45b5e7230c6c580645bec46f0c7f8d8dbdf08cf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 7 09:53:16 2010 +0000

    gitignore: Ignore all local* files in the main directory.

commit 1e78cd1690f15a45f80d384edca9b7b868b9b802
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 6 21:24:59 2010 +0000

    appliance: Don't quote the --exclude parameters.
    
    The quotes appear literally on the command line:
    
    $ s="--foo 'bar'"
    $ echo $s
    --foo 'bar'

commit 53853f717c5928bc61809cc26160da118cd556fa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 6 17:44:06 2010 +0000

    Add --with-febootstrap-yum-config.
    
    This allows the febootstrap --yum-config option to be passed through,
    allowing a separate yum configuration to be used.
    
    The hope is that this will enable building in Koji.

commit 9bc15f5d98a3a17d465a94f42dc3ffb60c077293
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 6 18:16:39 2010 +0000

    Remove ability to build static distribution.
    
    We are now going to build binaries for each distribution so
    there is no need to build the quasi-distro-independent static
    binaries any more.

commit 7eaecf8303c229268f1f55dcb5e37ff9f0bf420d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 6 16:46:00 2010 +0000

    regressions: Disable test for 576879.
    
    This test has worked only intermittently for a while.  Disable
    it.  The upstream bug has been reopened.

commit 1d29fc2932334d397edf3a3cdda2d23722e612cf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 6 15:55:36 2010 +0000

    build: Use grub-pc instead of old grub on Debian and Ubuntu.

commit 2ed6a02af6db2b54e0cfd4ea73e42a6b6e275af7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 6 15:01:38 2010 +0000

    build: Add diff to package list for Debian and Ubuntu.

commit 1719b764fe521f9d56eeda9d8bdf1e61ae5df411
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 6 14:59:03 2010 +0000

    build: Add cpio package to package list (for Debian and Ubuntu).

commit e79f1431803f68d66fe6086b3ea7a5ab298d67e0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 6 15:04:00 2010 +0000

    build: Look for other db_dump variations (for Ubuntu).

commit 095433f7b0b0a387268eb1a79c897d97092a9500
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 6 14:32:03 2010 +0000

    ubuntu: Disable xfsprogs from Ubuntu package list.

commit 227c9a4bca760f7f38e255f459720888a8335eeb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 6 14:31:17 2010 +0000

    ubuntu: Make Ubuntu into a separate distro for the package list.
    
    This allows us to select Ubuntu packages separately from Debian ones.

commit 0bb4208467dcfc49389037defe6ce7f291807901
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 23 17:39:31 2010 +0000

    build: Don't emit warnings about stack protector failures.
    
    These are seen on gcc 4.5.1 used in Ubuntu.

commit 34fe8095c52bfc2d5b0b80528aa0fdfa58154e9f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 6 13:39:37 2010 +0000

    debian: Enable more packages in packagelist.in.
    
    These were previously disabled because of problems with
    debirf.  Now we are not using debirf, we can use them
    again.

commit 194bacbe2a6203a83e8d73156e7120de086a705c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 5 11:20:21 2010 +0000

    Version 1.7.19.

commit 8227537100d9076ac5db6ce0e9e223762b676d24
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 4 23:47:47 2010 +0000

    Debian: Extra packages needed to run C API tests.

commit 6d75ce8e6ca1f3f0a946ee4e214f6d2bff07adc4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 4 21:14:17 2010 +0000

    appliance: Change to using febootstrap 3.x supermin appliance.
    
    This removes all support for building the ordinary / old
    style appliance using febootstrap 2.x, debootstrap, debirf,
    fakeroot and fakechroot.
    
    Instead this uses febootstrap 3.x to build the supermin appliance
    in a simpler cross-distro manner.

commit 078fbee4e73036783aefef9401735f8b80e81bb2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 4 19:07:15 2010 +0000

    appliance: Put /init in a separate supermin appliance component.

commit 85ba859aa8ca40299a1b6f112087138ec5dd140a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 4 19:06:39 2010 +0000

    appliance: Don't look for kmod.whitelist.
    
    This file is not used for building the supermin appliance.

commit 0710326ac5f1a06cf1dc3500617d04cf4cba5631
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 2 13:35:14 2010 +0000

    New API: mkfs_opts, mkfs with optional arguments.
    
    This is an extensible version of 'mkfs' which supports optional
    arguments.  There is now no need for 'mkfs_b' since you should
    use 'mkfs_opts' with the optional 'blocksize' argument instead.

commit 65f44b459070a1dbfba66c31e0be69588e49f4a8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 2 13:32:40 2010 +0000

    generator: Code to handle optional arguments in daemon functions.
    
    Previously we only supported optional arguments for library
    functions (commit 14490c3e1aac61c6ac90f28828896683f64f0dc9).
    
    This extends that work so that optional arguments can also be
    passed through to the daemon.

commit 01d62985c3f0234fc0e9e4909c85c6a401c4bfcc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 2 13:31:52 2010 +0000

    fish: Fix generation of code to handle Int/Int64 optional arguments.

commit faf1cd50492fd014267c22a0e988a75f1c337364
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 2 11:35:57 2010 +0000

    Fix argv struct mixup over Int/Int64.

commit 3451d73a693091ae1a33e7dbefbe56c1b93f426a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 2 10:23:30 2010 +0000

    todo: Refresh documentation.

commit 9f2135c4e4062087b9bd525406802da2a25c7365
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 1 18:00:17 2010 +0000

    Version 1.7.18.

commit 8022d46e5e2d9c3ab664ace6c9f185976e34dc20
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 1 13:33:31 2010 +0000

    Add progress notification messages to upload and upload-offset APIs.

commit 11be64049ba3ce36e1be297d2d6f54abca079742
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 1 13:31:25 2010 +0000

    protocol: Handle progress notification messages during FileIn.
    
    If the daemon sends progress notification messages while we
    are uploading FileIn parameters, these are received in
    check_for_daemon_cancellation_or_eof.  Modify this library
    function so that it turns these messages into callbacks.

commit 8bfca99b9ab5774ce8aa1086184479ebb98236b2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 1 13:24:23 2010 +0000

    protocol: Really read 4 bytes while checking for cancellation.
    
    We've not actually hit this bug in practice, but at least in
    theory while checking for cancellation we could read > 0 but
    fewer than 4 bytes, which would effectively be discarded and
    we would lose synchronization.
    
    Note the socket is non-blocking.
    
    Change the code so that we temporarily set the socket back to
    blocking and force the read of all 4 bytes.

commit 7e523077d650cfb71044d5e74aa8fe1f91c019ae
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 1 13:28:26 2010 +0000

    protocol: Send progress_hint in header.
    
    For actions that have FileIn arguments, count the size of all
    the input files and send that in the progress_hint field of the
    request header.

commit 3aa8182c3cc478bf723205f1a4dd84e160768448
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 1 10:30:44 2010 +0000

    protocol: Upload progress messages and optional arguments.
    
    Two unrelated changes to the protocol to support progress
    messages during uploads, and optional arguments.
    
    Note that this makes an incompatible change to the protocol,
    and this is reflected in the protocol version field (3 -> 4).

commit fdc8805362c6fc587bb7985c5290362ad3094f4e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 30 16:52:48 2010 +0000

    df: Fix segfault when using virt-df -a filename
    
    If 'filename' doesn't contain a '/' character then virt-df
    was calculating NULL as the basename and later segfaulting.

commit 8d28fe0ef284a2e786bc92b40fbb4620120de335
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 30 15:01:29 2010 +0000

    Version 1.7.17.

commit b79e075d637f669ce5e4aa2e9b7f578ac8de0839
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 30 14:17:37 2010 +0000

    php: Combine tests to reduce number of launches.

commit 2860b21ee1b86d6c944308a8be181c91bc07fd03
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 30 14:10:40 2010 +0000

    haskell: Combine tests to reduce number of launches.

commit aba7cad7dfbb12fe4e21f9388cf4e50b47117cfb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 30 14:06:27 2010 +0000

    java: Combine tests to reduce number of launches.

commit b034795a259fb5f255c1f9c835d722efab4d4f7c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 30 13:59:50 2010 +0000

    python: Combine tests to reduce number of launches.

commit 13af3835cdcfbf46c8072b7960d73ae9ca5deb4d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 30 13:56:33 2010 +0000

    ocaml: Combine tests together to reduce number of launches.
    
    Combine launch, lvcreate and readdir tests together into a
    single 'basic' test, so that we don't launch the appliance
    so often when testing in this subdirectory.

commit 61a0f7988447fe0911360f8dfc2962086967cc9a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 30 12:42:55 2010 +0000

    capitests: Convert many InitBasicFS tests to InitScratchFS.
    
    These tests run much more quickly if you don't have to run
    'mkfs' and (particularly) partitioning/LV commands between each
    test.
    
    The total time for running 'make -C capitests check' on my laptop
    has gone from 413 seconds down to 221 seconds.

commit f93cdf1ed3323b8d9451a7f4f6365ac30ab8ba81
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 30 11:48:35 2010 +0000

    capitests: Add 'InitScratchFS' test environment.
    
    This should allow us to perform filesystem-based write
    tests much more quickly, because we don't need to recreate
    the filesystem from scratch each time.

commit 17233ce2113aa730752ae3420cc209b2a72ab616
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 30 10:42:31 2010 +0000

    capitests: Move test documentation into HACKING file.

commit ba7ec6aea325b0a6df5777afc057df087f669a7b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 30 10:33:08 2010 +0000

    capitests: Use /dev/sdc for misc tests (instead of /dev/sdb).
    
    This change means that /dev/sdb is not being used during
    the tests (except passively, eg. in listings of devices).
    
    This allows us (in a forthcoming commit) to use /dev/sdb as a
    quick scratch filesystem for testing writes.

commit 6f09e4774ce64a15424a2601df10326d764cc7f7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 27 18:48:48 2010 +0000

    docs: Fix small inaccuracies in virt-resize(1).

commit 866a6a0fa5124a06918f84b7db28f831ab6e4495
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 27 18:43:23 2010 +0000

    docs: Fix typo in virt-filesystems(1).

commit 94e1465129ae738367421c2515ee23623ee80ed9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 27 18:39:35 2010 +0000

    docs: Remove ref to L</add-drive-opts> wrongly copied into some man pages.

commit cece0b85ecd6ea8609d8f838ef6e9aa75b55506f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 26 23:57:42 2010 +0000

    Update API support.

commit 8370d35221ac385908d78141ddcbc5916122fce1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 26 23:56:41 2010 +0000

    Updated RELEASE-NOTES file.

commit 0b2a3bd8404a72a3b7e99e330143c26bf42d458a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 26 22:36:14 2010 +0000

    Version 1.7.16.

commit 272b754093ef824486993540a893d39be8e7e9f0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 26 21:51:11 2010 +0000

    fish: Don't use external pod2text program.
    
    This removes the dependency from guestfish to the external
    pod2text program (and hence the final dependency on perl for
    guestfish).  This is done by storing the formatted pod2text
    output in guestfish as the help text.

commit b4c853f7d493af1d71f352832fed29eb7e377e8f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 26 21:49:58 2010 +0000

    generator: More options for internal pod2text generator.
    
    Allow extra width, and trimming options.
    
    This necessitates a change in the memoized format.  To avoid
    causing crashes if a new generator loads the old format, also
    change the filename of the memo file.

commit 60b3c8e81124a881cd93ed66c167cac37e87c36b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 26 18:26:09 2010 +0000

    libtool fix: Don't do fix if there was no -o option to libtool.
    
    For example if libtool is being run as 'libtool --mode=execute ...'
    
    This fixes commit 4cf4f2b66f850bb39c5bf29d3cd12ada9114d67e.

commit 9e6a8a4cbb30f6f4718669db0c4f7781ea3d6249
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 26 16:50:50 2010 +0000

    Version 1.7.15.

commit a44ec081b6ea10036ca0734197a47b1dfa035a1a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 26 16:53:06 2010 +0000

    build: Add several missing shell scripts to dist.

commit 4cf4f2b66f850bb39c5bf29d3cd12ada9114d67e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 26 16:48:55 2010 +0000

    Remove dependency_libs from libtool *.la files.
    
    Add a libtool wrapper which kills dependency_libs in libtool *.la
    files, to ensure that libtool doesn't add unnecessary extra libraries
    when linking.
    
    See http://lists.fedoraproject.org/pipermail/devel/2010-November/146343.html

commit 18de192b0a4b71ade57acc0b6af311cc17a1bf0a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 26 16:49:54 2010 +0000

    df: Missing direct dependency on libvirt.
    
    virt-df has an (optional) direct dependency on libvirt.  Because of
    libtool's over-linking behaviour this was being missed.

commit a6054bf90f39a84c1a8f8f7d3b9e81e84cb13696
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 26 11:36:50 2010 +0000

    rescue: Rewrite virt-rescue in C.

commit 076a9726e608c914cd4785e9a14e9a903a61ca34
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 26 11:37:28 2010 +0000

    Update HACKING description of tools/ subdirectory.
    
    This fixes commit 18374b5b7d3154e0b8b8a07e3590f6eee762b58e.

commit 403ac796a5067ac558ceca2409270eb55b477299
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 26 10:18:29 2010 +0000

    daemon: Close leaked file descriptor along checksum error path (RHBZ#657499).

commit 746c4b7789ad82e7b7521e456069cef8a1a9592c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 25 18:53:54 2010 +0000

    Version 1.7.14.

commit 18374b5b7d3154e0b8b8a07e3590f6eee762b58e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 23 12:05:04 2010 +0000

    df: Rewrite virt-df in C.
    
    I have diffed the output from the original virt-df with this
    new version, and they agree very closely.  Some differences:
    
     - Old virt-df have a divide-by-zero error in cases where the
       number of used inodes was 0.  New virt-df fixes this.
    
     - New virt-df uses gnulib human_readable library which displays
       numbers to 3 significant figures for -h output (old version
       used an ad hoc function).

commit 4838ec3326d2970e6afe3cde6b368aeae840b969
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 25 15:38:26 2010 +0000

    Export private function 'guestfs___for_each_disk' for use by virt-df.
    
    This private function (not part of the API) allows us to
    iterate over disks from a guest, avoiding the business of
    writing all the XPath code yet again.

commit 70faafe8d4f0c06c3e62c1e1469289255ee30c53
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 23 13:16:01 2010 +0000

    fish: Keep device names in options drives list.
    
    In the 'struct drv *drvs' structure, keep a list of the
    device name(s) for each added drive or guest.  The device name
    is the canonical name as that drive would be known inside
    libguestfs, eg. "/dev/sda"

commit dfa9d6cf32b23e34eeba916a9a263483990a3fce
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 25 15:36:57 2010 +0000

    Fix memory leak (xptype XPath obj) in add-domain API.

commit 3fc6dde15cf47b0cc837fb513ea7b91a12df8ae0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 24 20:02:09 2010 +0000

    Version 1.7.13.

commit 37366ede50b78ff9159e080ebae08a822795452a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 24 20:06:22 2010 +0000

    build: Remove some non-existent files from CLEANFILES.

commit 37e632b7b8e1bd8c9893bb8e3c9a8691c78256a4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 24 18:49:37 2010 +0000

    ruby: Translate C examples into Ruby and include documentation.

commit 472722a72df89895bb11a1244eafa7915b1af116
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 24 18:10:50 2010 +0000

    python: Translate C examples into Python and include documentation.

commit 086bd1f7bfab4c10d890ecca3506a1b091c0d398
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 24 13:34:16 2010 +0000

    ocaml: Translate C examples into OCaml and include documentation.

commit 58012dc9b67aa1b5de9c5dc70e7e471de3ed2a6a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 24 17:19:28 2010 +0000

    docs: Standard C examples, and guestfs-examples(3) man page.

commit e1aca6323e33e0dd50e23dc0d638f5789c9188e4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 24 15:19:33 2010 +0000

    build: Centralize all POD manipulation in 'podwrapper.sh' script.

commit c1592ac93886e7f39a6017272b2486d3f411d054
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 24 14:28:32 2010 +0000

    build: Rename bugs-in-changelog.sh

commit 0f478933108de342b0948b9e3cc6d4f00fbbfe0a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 24 14:25:57 2010 +0000

    build: Rename update-bugs as update-bugs.sh.

commit 4e3837d0f31af26dd460f7196323af10aac24be1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 24 12:42:17 2010 +0000

    generator: Remove unused variable.

commit d20b9cd6b82e26dd2f8cf43d9cc8f1e518f2e077
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 24 11:17:45 2010 +0000

    fuse: Add note in test about how to debug guestmount.

commit 951ea0e189f051c85de14c508d90d3bad0f1ca7a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 24 10:00:06 2010 +0000

    build: virt-make-fs requires String::ShellQuote, add to configure.

commit c6478d6a01c210ef19735429d7602e3458733e25
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 24 08:38:35 2010 +0000

    regressions: Fix test-launch-race to work in non-supermin case.

commit 5d7ee3f0c5b65cc7c417d762a648ce6c5bfdb532
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 23 20:05:56 2010 +0000

    daemon: blkid cache is at a different location on Debian.
    
    Remove both possible cache locations.

commit bd631df66f3eac3156e24ed8c1180d83f0f3a629
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 23 19:56:30 2010 +0000

    debian: Include ntfsprogs in the appliance.
    
    This allows us to build NTFS filesystems at least.  Mounting
    NTFS doesn't work in Debian because of a problem with debirf.

commit 22a50e4e3bb9125c5f2520b812811d4ae2bd7d72
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 23 19:05:53 2010 +0000

    inspect: Detect if db_dump and db_load programs are available.
    
    If db_dump is not available then disable RPM application detection.
    
    Note these utilities have odd names on Debian.

commit 72932bd0c94aa18c6054e7b70b852918f3b01293
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 23 18:42:28 2010 +0000

    build: Move po4a detection up near other program detection.

commit b9bd24b943f22f07b2ed5bf7edeab89bc8028f7e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 23 18:41:59 2010 +0000

    daemon: In sfdisk call blockdev --rereadpt with device name.

commit 8d3e97679a698386980bd1e5e5833542412a56f6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 23 18:12:26 2010 +0000

    ocaml: Fix some unused parameter warnings in OCaml bindings.

commit 4220b7a6411f1eeecc616e37adaa5b2d2fe9aec1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 23 15:55:50 2010 +0000

    Update README to reflect Perl modules that are really still required.

commit 12eb3eb8ab2e64ddccf319f7ddc9ef5fe4a3763a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 23 15:54:08 2010 +0000

    build: XML::Writer Perl module is no longer required.

commit fa0c588d1e70c1eb7020aa14484844bf43ed13ea
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 23 12:05:15 2010 +0000

    filesystems: Fix command synopsis in usage message.
    
    This updates commit fbc2555903be8c88ad9430d871cf0d27c8fded1e.

commit 9e6f85877c3f72bfb17d575601a253d560613569
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 23 10:21:56 2010 +0000

    Version 1.7.12.

commit d90bc32c7472da047c304d74e3a9e4cc21f6080b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 23 10:29:12 2010 +0000

    fish: Link to virt-inspector from guestfish man page.

commit fbc2555903be8c88ad9430d871cf0d27c8fded1e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 22 17:33:35 2010 +0000

    New tool: virt-filesystems
    
    This tool replaces virt-list-filesystems and virt-list-partitions with
    a new tool written in C with a more uniform command line structure
    and output.
    
    This existing Perl tools are deprecated but remain indefinitely.

commit f6d3d5677194ae7aaea70d43845341d91907b5ee
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 22 12:37:55 2010 +0000

    ls: Rewrite virt-ls in C.

commit f33d899fd0900b0cfe6dbbb152ce2fcf479bd38c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 23 09:47:34 2010 +0000

    resize: Fix canonical device function (RHBZ#655554).

commit f8af59c234b6bea50dadc7a6055c8a4739ca4530
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 23 09:03:23 2010 +0000

    inspector: Make whole disk paths canonical (RHBZ#655554).

commit 938c98ad76bd896be750dbc69ade5e251afb8dea
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 22 17:32:32 2010 +0000

    inspector: Fix documentation of -x option in usage.
    
    This updates commit c5cb65f0aac3298e634b183f73fda6644a158018.

commit b875f8e115842b37e6c7c9e59cb263a1cbb334aa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 22 17:31:15 2010 +0000

    cat: Fix documentation of -x option in usage.
    
    This updates commit d29e9a552f5823d1d8cb8d4962cb1301bbf60b0e.

commit 730d4db45ec95d9c9592d7721ff1c5a3db036816
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 22 13:09:26 2010 +0000

    cat: Continue after encountering an error.

commit cb8403c4282ddfbcc204920c72a104eb7f69e373
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 22 12:38:18 2010 +0000

    cat: Fix documentation for command line with format option.

commit 3d3ec55c35f1d2ee8a46b5b685164139f8ef0324
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 19 22:50:30 2010 +0000

    inspector: Fix rule to build HTML file.
    
    This updates commit c5cb65f0aac3298e634b183f73fda6644a158018.

commit ccea24323b1646badf463aaf0ce9fa46adb890fd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 19 22:31:24 2010 +0000

    Version 1.7.11.

commit 16127e773b12ac2395858a2914d340af211c1f48
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 19 22:30:54 2010 +0000

    po-docs: Remove virt-inspector.pl reference from Makefile.am.

commit c5cb65f0aac3298e634b183f73fda6644a158018
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 19 12:48:21 2010 +0000

    inspector: Rewrite virt-inspector in C.

commit 60a62788d48e1d45fcb75cf0bcc7d375c42b83ba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 19 15:31:22 2010 +0000

    fish: Fix memory leak in handling of encrypted volumes by -i option.
    
    This fixes a memory leak introduced by
    commit a232e62dcf508517a32b9a8d7e4529e827be721b.

commit 4f9a670d09b4d620fccc36e7c2df8fc912749f97
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 19 15:30:45 2010 +0000

    inspect: Fix memory leak of hostname.
    
    This fixes a memory leak introduced by
    commit fab75c0337d7897d10ea5e95e47ac05eab81ace9.

commit 53f670c33ad8609c9733aa8e8e3555091fdc9f87
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 19 15:13:00 2010 +0000

    cat: Fix run-cat-locally script so it doesn't go via Perl.

commit 3bd883f344a5d6f155f7252e8a478d5b7935d7c6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 19 13:05:49 2010 +0000

    cat: Give a better error if the user specified no drives on command line.

commit 06e993b7bac2fa1d506b24848c4ffddbdfdf49bc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 19 12:56:06 2010 +0000

    cat: Tidy up documentation for --format option.

commit 16e39ac0b8583c60fb1bc3378483b91886ed6f85
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 18 15:32:05 2010 +0000

    Remove FIPS .*.hmac files from the supermin appliance (RHBZ#654638).

commit e1ad5afaea3f6a3d3ca4131c259b76792b150d2e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 17 23:13:36 2010 +0000

    Version 1.7.10.

commit f445d25d7b6bb65470564c96d7198d63538880a3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 17 16:43:18 2010 +0000

    generator: trace mode prints return values.

commit 6c6aa111795b20533a99a7e38b614b2aa1c0ccb7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 17 16:06:55 2010 +0000

    generator: Make return value into an explicit variable.
    
    This is just code motion.

commit a5884a88fc57174c43d2ae9b50b437a60f6baf0b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 17 15:54:06 2010 +0000

    generator: Make trace flag an explicit variable.
    
    This is just code motion.

commit 5067f8fc779837385c6ce4a41e60420ffa52bbe9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 17 15:07:45 2010 +0000

    todo: Suggest that trace should include return values.

commit 4ac31247605dbcbe4b19212148de0a8671d0a43d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 16 23:34:07 2010 +0000

    rescue: Fix typo in documentation of --network option.

commit 91b490ec79f4f935ff1552b39053ac6fc2b1f0a6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 16 19:08:16 2010 +0000

    Version 1.7.9.

commit 9d3f336152ba9390ed2b27579c4b625d46e3c50d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 16 17:46:50 2010 +0000

    inspector: Replace old examples with ones derived from phony images.

commit fcc631dedb894379cde01af563df3f6a364db7cb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 16 17:37:30 2010 +0000

    images: Make phony Windows image for testing.

commit 9becb385b78eddb9b3817c6accaa6cdb3db0b5af
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 16 16:27:20 2010 +0000

    images: Make phony Ubuntu image for testing.

commit 858d75d3911c9715bf62c3e8088cce3e991fb0fc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 16 16:17:33 2010 +0000

    images: Make a phony Debian image for testing.

commit 6d4815d3a4921219379bc9ec3cceead217668426
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 16 15:41:16 2010 +0000

    images: Make a better phony Fedora image.
    
    This now includes a product string, major and minor version,
    hostname and even some applications.

commit 2bfeaeaa308adf27853c1ec6d1d958a3e4734b8e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 16 15:56:11 2010 +0000

    daemon: findfs-uuid and findfs-label should not return /dev/mapper paths.

commit fab75c0337d7897d10ea5e95e47ac05eab81ace9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 16 12:57:36 2010 +0000

    New API: inspect-get-hostname to return the hostname of the guest.
    
    This returns the hostname of the guest.  Tested on RHEL, Fedora,
    Debian 5, Ubuntu 10.10, FreeBSD 8, Windows 7.

commit 35afe0cb33c986bf595585a716ff259cf3415a1f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 16 12:45:50 2010 +0000

    inspect: Check /etc/lsb-release is not too large before calling head on it.

commit a4448956e9a815aff59cac3d98caf80f620fc4c4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 16 12:35:39 2010 +0000

    inspect: Add function to read the first line of a file, with safety checks.

commit 61cfe13ec49f1d1e9d6124f0ee98520aab720087
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 16 11:16:17 2010 +0000

    inspect: Abstract the wrapper that sets up Augeas.
    
    This is just code motion.

commit e428f914dda1c591f987e2b6f0ceaec828cd29c5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 15 23:22:08 2010 +0000

    Version 1.7.8.

commit 2cfd89d631319cf791c38b5b9f5a8a6331dc2ef2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 15 14:17:20 2010 +0000

    inspector: Replace code for listing applications with new core API.

commit 163be3d72a3f3dc902bcd0856d8aec448bc7907f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 15 12:26:36 2010 +0000

    New API: inspect-list-applications.
    
    This converts the current Perl code in virt-inspector for
    listing applications, into C, making it a part of the core API.
    
    This is also capable of fetching the list of Windows applications
    from the registry.

commit 8a3a4c25d3bb63674c9ccf8483d9bfd89085fe47
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 15 12:40:02 2010 +0000

    inspect: Centralize all file downloads through a single function.

commit 2729421d176e1194537b499911a5eeb5e32a8b09
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Nov 15 22:06:34 2010 +0000

    inspect: Add support for Linux Mint and Mandriva.
    
    Linux Mint is derived from Ubuntu.
    
    Mandriva has a release file, but it also has /etc/lsb-release and
    the same parsing code can be reused.  Mandriva has a package manager
    called urpmi.

commit a22d5a7390339eca5d9bafb2155439ad1ccc02ac
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Nov 15 22:21:15 2010 +0000

    docs: Put list of distros in alphabetical order.

commit 47af6aaab8f2dde736951b4e549c2638d942dae5
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Nov 15 22:20:51 2010 +0000

    docs: Debian and Ubuntu are now separate distros.

commit 3e766f745dc6cf351e56d9955f580152ddb9110a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 15 16:31:30 2010 +0000

    todo: live CD inspection

commit c3ae17cc79a4e8dd4be0a3ae65d33384c175573b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 15 10:14:16 2010 +0000

    Version 1.7.7.

commit e0afd9a3e4bbd073f36a4287744b4c5fe148413f
Author: Maxim Koltsov <kolmax94@gmail.com>
Date:   Sun Nov 14 16:21:56 2010 +0000

    build: Missing backslash again.

commit d8346d5d6428c7293d1ddf58e4f9ec4b7de25380
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 13 18:06:28 2010 +0000

    Version 1.7.6.

commit b943d06466724df39b7261ce75e43b0201ed7372
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 13 14:58:50 2010 +0000

    filearch: Refuse to download initrd if it is huge.

commit 9674a73c08e128d8a7a39a6be6140c373c0e61f0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 13 14:55:14 2010 +0000

    inspect: Fix error out path if minor_version parsing fails.

commit e44cf42f362d793c47d892a18a6853d88abd6ecb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 13 14:54:52 2010 +0000

    inspect: Refuse to download software hive if it is huge.

commit 692f127447d399db21c2e93026d4d2b0ac1839d1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 13 14:49:37 2010 +0000

    inspect: Refuse to parse /etc/fstab if it is huge.

commit 528cd8f64176ca50f5b82db5682b0ee31833b162
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 13 14:49:07 2010 +0000

    lib: Make some error strings localizable.

commit 79b202ca26226e0a95e3f04ac7ff91e9eb918b48
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 13 14:42:06 2010 +0000

    inspect: Inspection support for FreeBSD.
    
    This adds inspection support for FreeBSD.
    
    However this is not quite enough to allow guestfish -i freebsd.img
    to work, because guestfish will try to mount the filesystems,
    which cannot be done because Linux requires special mount options
    for the Universal Filesystem (UFS) used by *BSD.  Nevertheless
    you can manually run the same commands.

commit a5fd85e7392b589d9d90ab515ad3e4bd1befd874
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 13 14:41:01 2010 +0000

    inspect: Optimize root filesystem check.
    
    Avoid duplicate checks for things like /etc and /bin.

commit 55e6ccb23e0b1f954107b4d0284d3d41f7a4e7b8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 13 14:39:21 2010 +0000

    lib: Add match3 function.

commit a48ab78dc8272675caf7bebf17d2112aaaf6332f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 13 14:37:53 2010 +0000

    lib: Add safe_asprintf function.

commit cd96cca38cea638a6db76afceeed76babc9e763c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 13 12:25:56 2010 +0000

    docs: Add a section on security.

commit 35dbedb1b18157b2329e0e55d0b5355f26431814
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 13 11:32:47 2010 +0000

    docs: Rearrange guestfs(3) sections.
    
    This rearranges the sections into a more logical order:
    
     - synopsis and introduction
     - API-related overview sections
     - (security will go here, see next commit)
     - API in detail
     - architecture and other internals
     - usual end sections

commit 92444940f3ff80975e64e07e4a4861454101a529
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 13 08:13:18 2010 +0000

    static: Use correct libraries for static binaries.
    
    Also add virt-cat.static target.

commit 74cc619d942329043d646805c1b94be7df234d10
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 13 07:15:46 2010 +0000

    Version 1.7.5.

commit aec3091fa9c65e2f84d0bf9cdd520e597957eca9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 12 20:25:45 2010 +0000

    ruby: Add 'make install' rule for ruby bindings (RHBZ#652796).

commit 2325c99d07fa750c1098a3b2bc1bc80fb6bc846a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 12 19:33:55 2010 +0000

    todo: Notes on parsing.

commit 3fd2b9d0b6d2bac5e9267fbcf1556f459d7313fe
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Nov 12 12:29:14 2010 +0000

    New APIs: inspect-get-package-format, inspect-get-package-management.
    
    This APIs reimplement some parts of virt-inspector in C.

commit 6ab57837216f498a08d33240c429ed678968fb78
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 11 23:36:54 2010 +0000

    capitests: Remove warning about dead definitions.
    
    This updates commit cb7ec8be4ce6068b6cbc6522a67826cdbd161024.

commit 59db941bf64eae2eed6a8e6451e04aa0cbec8294
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 11 23:36:04 2010 +0000

    Check that just including <guestfs.h> on its own works.

commit 096f341714ee7d1575c93d437a8085821aa88d23
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 11 23:18:57 2010 +0000

    Don't need to include XDR headers in <guestfs.h>.
    
    Include the XDR headers in the internal guestfs-internal.h instead.
    
    This is knock-on effects to several other source files which
    were implicitly relying on indirectly loaded headers.

commit 649b990bbfe4127841d73ae86c92cc902ec56e93
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 11 23:17:37 2010 +0000

    Be less verbose in the macros defending typedefs in <guestfs.h>.
    
    This updates commit 4d59e271046f2b5f0d9b1730cd23425fd631c76c.

commit 3431f397d34740fcd3a2d6f94d03af6e5f8f1a36
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 11 22:25:15 2010 +0000

    perl: Ignore debug functions in Test::Pod::Coverage.

commit f614a6dde922a9bd7351138ed6ebd524634bbd16
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 11 19:04:40 2010 +0000

    Version 1.7.4.

commit f6c4026f85fa6ded33a51ec2757abda9f116fd5f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 11 18:03:12 2010 +0000

    build: xml-light is no longer required (thanks Maxim Koltsov).
    
    At some point we removed the last thing that required
    xml-light, but were still testing for it at various places
    in the build.  This removes all traces.

commit d29e9a552f5823d1d8cb8d4962cb1301bbf60b0e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 11 14:53:51 2010 +0000

    Rewrite virt-cat in C.
    
    With changes in the core API since 1.5, virt-cat was little
    more than a Perl wrapper which did some command line argument
    processing.  Thus it could easily be rewritten in C.
    
    This version also shares core command line argument processing
    with guestfish and guestmount, so the options have changed
    slightly (old-style command line *is* supported).
    
     virt-cat -a disk.img file [file ...]
     virt-cat -d domname file [file ...]
    
    Several other guestfish options are supported including encryption,
    and with the new style multiple files can be downloaded.  See the
    man page for details.

commit 4d900cdac8258daa2e99c6ceb2a4985154e94150
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 11 16:20:25 2010 +0000

    Generate a dummy 'Fedora' fedora.img in images directory for use by tests.
    
    We were generating this dummy 'Fedora' image already in the
    tools directory.  It contains just enough Fedora-like files
    to fool our inspection code and thus to test the tools.
    
    This is general enough that we can use it everywhere.

commit 4d59e271046f2b5f0d9b1730cd23425fd631c76c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 11 12:14:37 2010 +0000

    Defend all typedefs in <guestfs.h> with #ifdefs.
    
    This allows other libraries to redefine those typedefs
    if they need to use but not depend on <guestfs.h>.

commit 6263da7474c6e7818b025979712c9c5d7108640d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 11 11:51:02 2010 +0000

    lib: Make <guestfs.h> be completely generated.
    
    This removes the 'not-quite-separate' guestfs-actions.h and
    guestfs-structs.h files.

commit 4a3726d5ed0dd3174b46ec574eaf4f4140cb193b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 11 11:49:49 2010 +0000

    Fix small typo in a comment in src/Makefile.am.

commit cb7ec8be4ce6068b6cbc6522a67826cdbd161024
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 10 11:31:01 2010 +0000

    capitests: Add the code to test (proposed) add-libvirt-dom C API.
    
    This API was dropped as there are some problems with it.  This
    commit adds the original test code, but commented out.

commit 7509c91a71c729b3223eef4cde10d70daca66c72
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 9 18:56:00 2010 +0000

    fish: Use core add-domain API to implement '-d' option.
    
    This also makes libxml2 and libvirt into optional dependencies.
    If they are missing then the core API will print an error, as
    will the '-d' option to guestfish.

commit f08fe63761d4186d49212b1d2382b1a5a2b8a62f
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 9 18:53:01 2010 +0000

    New API: add-domain
    
    This new API allows you to add the disks from a libvirt
    domain.
    
    In guestfish you can use the 'domain' command to access the
    API, eg:
    
    ><fs> domain Fedora14 libvirturi:qemu:///system
    1
    
    The returned number is the number of disks that were added.
    
    Also here is a proposed (but commented out) low-level API
    which would allow you to add a domain from a virDomainPtr.
    However there are several problems with this API -- see discussion
    on the list:
    https://www.redhat.com/archives/libguestfs/2010-November/thread.html#00028

commit 4ada0a7815075c9cbe9d8b00da791c105ae739a9
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 9 12:08:06 2010 +0000

    generator: Add Pointer parameter type to the generator.
    
    This allows generic "foo *bar" pointers to be passed to
    library functions (not to daemon functions).
    
    In the language bindings (except Perl) these are handled
    as generic int64s with the assumption being that any
    pointer can be converted to and from this.  There is room
    to add specific support for some pointer types in future
    by specializing the match cases.  However this is inherently
    tricky because it depends on the implementation details of
    other bindings (eg. to support virDomainPtr in OCaml depends
    on the implementation details of the ocaml-libvirt project).
    
    Perl is slightly different in that you have to supply a
    typemap.  Again this would depend on the implementation
    detail of an external library unless you supplied a generic
    typemap for int64.

commit eaedf025f5c45a4e05cbf25e145215d48bea8f8d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 10 10:32:33 2010 +0000

    New API: debug-cmdline for printing QEMU command line (internal only).
    
    This is an internal-only debugging API so may be changed or
    removed at any time in the future.

commit 1c29849e0bdc731c023cff00d2c2354a41fd2a92
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 9 18:50:57 2010 +0000

    Add internal facility to checkpoint and roll back the command line.
    
    This internal interface can be used to ensure that certain
    operations are atomic.

commit a0b4caa0821b759de01361b7019c9c9c9607027d
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 9 15:59:40 2010 +0000

    lib: Make pcre, libmagic and hivex libraries optional.
    
    This change makes these libraries optional.  If they are not
    available at compile time then certain core API features will
    be disabled (see below).
    
    This also changes PCRE detection to use pkg-config instead
    of the ad hoc autoconf checks.
    
    The large inspect.c file has been split out into separate
    function-specific files.
    
      file-architecture: requires pcre & libmagic
      inspection: requires pcre & hivex

commit ec63875f9cd7277cf2d49827684bba936add7ce2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 10 10:32:12 2010 +0000

    Don't include debug* commands in the documentation.

commit 2ee6ea2ce128d200928173f3d4b40cadae17de93
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 10 10:51:46 2010 +0000

    capitests: Add whitespace in Makefile.

commit 8ac9575b204a8ac85f9030500cb6eabbf6aa3226
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 9 15:10:32 2010 +0000

    inspect: win64 regexp was dead code.

commit b52183b5491748d9e979d30e55db6d648b102416
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 9 14:50:23 2010 +0000

    lib: Augeas (client side) is not needed by the library.
    
    However it is used by the daemon.

commit bf3b9e2e236b4dd2216200993ba39545ad5160bb
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 9 12:05:08 2010 +0000

    ocaml: Error on compiler warnings.

commit a6454a437f98cc15d8347960f348937c651942e3
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 9 12:04:29 2010 +0000

    ruby: Remove extra space before parenthesis.

commit ed2bd31f9128036cd59399e1d8234023806082a7
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Nov 8 22:36:24 2010 +0000

    Revert "autogen: Touch ocaml/.depend"
    
    This reverts commit a0f85ba643990da25b6afe6a2bbd2407cf312c73.

commit e3acf93ce9e87ce308cf50a4f41408b25dd910e9
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Nov 8 22:35:13 2010 +0000

    Revert "Remove ocaml/.depend from git."
    
    This reverts commit 064569bcbf854a9cf588ce31851d987d5f114ec8.
    
    This commit does the wrong thing: creating an empty ocaml/.depend
    file is wrong because building the OCaml bindings will fail.
    Not having this file will prevent automake from running.  Therefore
    this file has to exist with the correct content in git.

commit 04df249d82ba3a24582bbbf1ad43b3c6ae2b1962
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 8 15:52:07 2010 +0000

    Version 1.7.3.

commit 5a10318ac808fb3cb0bf9071e0cf6b63a0b3eb6a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 8 15:29:35 2010 +0000

    build: Create an AUTHORS file.

commit e5ec461c67820f050b049b41a630069f0efe96d1
Author: Maxim Koltsov <kolmax94@gmail.com>
Date:   Mon Nov 8 15:10:14 2010 +0000

    build: Don't try to rebuild po-docs/<lang> if no po4a.

commit b0a48fa4504f85baa484987f54d8f99703e3ed3b
Author: Maxim Koltsov <kolmax94@gmail.com>
Date:   Mon Nov 8 15:08:01 2010 +0000

    build: Add ./configure --disable-php option.
    
    This disables the PHP language bindings.

commit 8e4a4d3d88b814504c6f2abbf6bf3dab789021b1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 8 14:53:48 2010 +0000

    build: Test for virt tools Perl libraries conditionally.
    
    Only test for these if $PERL is defined, and use $PERL as
    the interpreter.

commit ada875642332b56acbf75d68e964f2f16ca50530
Author: Maxim Koltsov <kolmax94@gmail.com>
Date:   Mon Nov 8 14:46:46 2010 +0000

    build: Add ./configure --disable-haskell option.
    
    This disables the Haskell language bindings.

commit 5b99e1b983b38d3405662c1e2b16f2731d465ce3
Author: Maxim Koltsov <kolmax94@gmail.com>
Date:   Mon Nov 8 14:35:13 2010 +0000

    build: Add ./configure --disable-ruby option.
    
    This disables the Ruby language bindings.

commit 041969480a2712311c2a82a0c118426793a9b338
Author: Maxim Koltsov <kolmax94@gmail.com>
Date:   Mon Nov 8 14:27:27 2010 +0000

    build: Warn if Python include or site-packages not found.

commit 3a7eb8ebdb47878ab9bd6b8aff88744365179f87
Author: Maxim Koltsov <kolmax94@gmail.com>
Date:   Mon Nov 8 14:24:59 2010 +0000

    build: Add ./configure --disable-python option.
    
    This disables the Python language bindings.

commit 57c74708ca4e00db259903998b67489e50b8d12b
Author: Maxim Koltsov <kolmax94@gmail.com>
Date:   Mon Nov 8 14:16:15 2010 +0000

    build: Add ./configure --disable-perl option.
    
    This disables the Perl bindings.

commit 53c524819323dcea8d5e3d56ff4fc6cf49b6c64f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 8 13:59:44 2010 +0000

    ocaml: Remove the old OCaml viewer program.
    
    This program is obsolete and the code has been reused for
    guestfs-browser here:
    http://people.redhat.com/~rjones/guestfs-browser/

commit af7af2fc5e48e4efecd1f65b60e61b88733161b9
Author: Maxim Koltsov <kolmax94@gmail.com>
Date:   Mon Nov 8 13:55:49 2010 +0000

    build: Add ./configure --disable-ocaml option.
    
    This can be used to disable the OCaml bindings.  Note that
    OCaml is still required in any case where you need to rerun
    the generator.

commit 428a45c3e15f03e9861e1b551e1ae8da821dba5f
Author: Maxim Koltsov <kolmax94@gmail.com>
Date:   Mon Nov 8 13:12:53 2010 +0000

    build: Add ./configure --disable-fuse option.
    
    If this option is specified, FUSE support is unconditionally
    disabled.

commit 4e656a61d40ff51e63aa06d857c40c14ff31ddb9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 8 12:46:31 2010 +0000

    supermin: If disabled, don't compile in supermin code or check for supermin.
    
    If supermin is disabled at compile time and the user just wants to
    use the ordinary appliance, there is no need to compile in all
    the supermin code, and in particular there is no need to check
    for the supermin appliance (which involves running
    febootstrap-supermin-helper that probably doesn't exist).
    
    This fixes a warning message observed under Debian w/o supermin:
    
      sh: febootstrap-supermin-helper: command not found

commit 2c4a7ef92a4583a1217213573ad406eb5d745990
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 5 18:36:02 2010 +0000

    fish: Add --rw option (does nothing yet).
    
    This adds the guestfish --rw option, intended in future
    to be required for writing to disk images.
    
    At the moment this does not change the default and so does
    nothing.  This patch is intended for backporting to the
    stable branches so that we can start to introduce scripts
    which use 'guestfish --rw'.

commit 26118d498eefe10c8fa604f949680d2417c8b25c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Nov 7 09:54:51 2010 +0000

    Add missing generated files to the tarball (thanks maksbotan).
    
    C# bindings were omitted entirely.  Add a Makefile.am for this
    directory even though we don't build these.
    
    Because of a missing backslash, some POD files were not being
    included.

commit 371e83c0902d0f6949a09095b1b10280d8881aac
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 5 15:17:45 2010 +0000

    fish: Add --listen --csh to for csh, tcsh compatibility.
    
    (Thanks Eric Blake).

commit be728962ff636e260f09dca6a1175c442d687551
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 5 15:07:11 2010 +0000

    fish: Suggest safer form of eval.
    
    eval "$(guestfish --listen)"
    
    instead of various other forms.
    
    (Thanks Eric Blake).

commit 633ae13c80d40b0f30db73e520c08cf365d2f8a3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 5 15:04:08 2010 +0000

    fish: More portable export sh statment.
    
    Don't depend on bash, but allow sh/dash/etc format:
    GUESTFISH_PID=nn; export GUESTFISH_PID
    
    (Thanks Eric Blake).

commit 7d8807ec3bc0b772d65e2ca1196f0980a037504e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 5 13:43:08 2010 +0000

    New API: inspect-get-roots to return roots from last inspection.
    
    Return the roots found by the last call to inspect-os, but
    without redoing the whole inspection.

commit 9f7926e7274aea9be43cf4bc1a9d1cf42ac6bec0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 5 13:42:07 2010 +0000

    generator: Don't die if an API call isn't listed in API versions file.
    
    For example, it may just have been added.

commit 12cf2f732a275928a7ce727840e1f5ba6684754d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 5 12:20:21 2010 +0000

    Version 1.7.2.

commit e51d6724d55c3a8c39b97c23abdf0b6168833e10
Author: Guido Günther <agx@sigxcpu.org>
Date:   Fri Nov 5 12:24:32 2010 +0000

    configure: Test for 'kvm' binary.

commit 7fc338690f385c2495b7ba5f98346a5c057991ea
Author: Guido Günther <agx@sigxcpu.org>
Date:   Fri Nov 5 12:23:11 2010 +0000

    Include <stdarg.h> in public header.
    
    Public headers use va_list, and this gives an error unless <stdarg.h>
    had been included before the header.

commit 6283982e36eeb3d19940618dc0aec88da08c7516
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 5 11:54:54 2010 +0000

    Don't print out key material in trace output.

commit a232e62dcf508517a32b9a8d7e4529e827be721b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 5 11:39:24 2010 +0000

    fish: '-i' option automatically handles whole-disk encryption.
    
    This feature is also available in guestmount because of the
    shared option parsing code.
    
    You don't need to do anything to enable it, just using -i
    will attempt decryption of encrypted partitions.
    
    Only works for simple Fedora whole-disk encryption.  It's a
    work-in-progress to make it work for other types of encryption.

commit 446db62e113594fef84d2f533ef3a1330153f0bb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 4 17:43:17 2010 +0000

    docs: Fix API support script.
    
    Before libguestfs 1.0.69 we needed to look in src/guestfs.c to
    see all the API calls.

commit ca236acc6773ba6712f499dc73a25e28acae85dc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 4 17:23:21 2010 +0000

    fish: Fix missing guestfish commands in HTML docs.

commit 74f7c9e4b7e27787e2052166eeedfbac5814200b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 4 17:04:03 2010 +0000

    fish: Make the 'help' command more helpful.

commit 7e3d76e41b3c2862ae04744b01e5e23b245393e4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 4 08:43:10 2010 +0000

    docs: Which API calls were first supported in which upstream versions.
    
    Run src/api-support/update-from-tarballs.sh (this won't work
    unless you have a local copy of the tarballs from the website).
    
    src/api-support/added contains the result of running the
    script, a list of pairs: (API name, version first appeared).

commit bfeffeb1e4d6f3725eb8148c098505a9d81a7ba5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 3 23:17:51 2010 +0000

    virt-win-reg: Current is the control set Windows chooses at boot.

commit 9694cd59f8250ae84c23922fda5cbb751e846e3c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 3 22:23:55 2010 +0000

    HACKING: Mention PHP bindings.

commit 19ea54b3f488755731ffc079519d6011dade9e5c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 3 22:11:22 2010 +0000

    docs: Indent *_va and *_argv functions correctly.
    
    This fixes commit f661db2c393d1b7e4211c55682b7fac82a70e36d.

commit ece3b30e4957b2d1d02377a82afb132e8061804d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 3 21:09:51 2010 +0000

    Version 1.7.1.

commit 58915725b1e464f7d447c0051ad916fbc1a82210
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 3 20:34:42 2010 +0000

    fish: Use a perfect hash for faster command lookups.
    
    Existing command lookups are approx O(n^2).  Replace this
    with a perfect hash implementation which should be a lot
    faster.

commit f661db2c393d1b7e4211c55682b7fac82a70e36d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 3 19:26:10 2010 +0000

    generator: Properly lay out and indent multi-line C function decls.

commit 5d6a91844520d07f9477e2ddca4caf8f040ef8a1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 3 18:33:31 2010 +0000

    docs: Clarify no additional error available from guestfs_create.

commit 01d613ae957431d65c700a34e369ef4c06dd6d8f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 3 18:29:58 2010 +0000

    docs: Clarify default error handler.

commit 6a218092812783eaea43919674eb8d1c74a80b33
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 3 18:02:08 2010 +0000

    docs: Error strings are in fact localized, documentation was wrong.

commit aae5bebe6878c01803653fae166c58b7217b6100
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 3 18:01:48 2010 +0000

    docs: Clarify, not every function that returns int returns -1 for errors.

commit 9cd1810b5e5b0a09f1a6eaf64fa14b924fbb0eae
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 3 17:24:50 2010 +0000

    capitests: Test guestfs_last_errno call.

commit 39052d270fcce991238fc5f9939677b5d6e31d15
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 3 16:15:48 2010 +0000

    fuse: Use guestfs_last_errno instead of errno-reversal-hack.

commit 2066805a5d93b62beaf6653324715f0b62b06a05
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 3 15:49:36 2010 +0000

    lib: Expose errno through new API guestfs_last_errno.
    
    If either the daemon sends back an errno, or a system call
    fails in the library, save the errno in the handle and then
    make it available to callers through the guestfs_last_errno
    function.

commit d859c283c469b9d9124d90d0ac32024671372ed5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 3 12:53:00 2010 +0000

    daemon: Send back the errno as a string.
    
    This changes the protocol again so that if the errno is available,
    it is converted to a string (like "EIO") and sent back over the
    protocol to the library.
    
    In this commit the library just discards the string.

commit 2be1648632e5e8dca06d84349314ab5e84f29e5c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 3 17:00:29 2010 +0000

    capitests: Test guestfs_add_drive_opts with optional args from C.

commit b535363e7e7a000cca3651790f911b2d0605968f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 3 16:56:34 2010 +0000

    capitests: Test some basic aspects of the C API.

commit 162c89ed497212859d748506209ffc1b88763ab2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 3 17:37:07 2010 +0000

    capitests: Use ftruncate instead of seek + write to create test files.

commit ec0fe45e48fa4621fc6fa0f5bcc44f184068c86f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 3 17:34:27 2010 +0000

    capitests: Don't open test files with O_NONBLOCK.
    
    I have no idea why we were doing this.

commit 2a33d81e2b7fa2affaaad48538307c818b4a8260
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 3 17:26:00 2010 +0000

    capitests: Set path in TESTS_ENVIRONMENT instead of in tests.c
    
    By exporting LIBGUESTFS_PATH with the right path to the appliance,
    we no longer need to hard code the path in tests.c

commit 8ccc6cd1f798f960e520ea8de24eb1f6a1313d3a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 3 15:46:46 2010 +0000

    generator: Remove unnecessary macro redefinitions.
    
    These macros are already defined in guestfs-internals.h

commit 6b8d05438cc0309f762fabf2f3cc7ae4bf5521c1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 3 15:48:04 2010 +0000

    Define internal safe_calloc shorthand.

commit 9ff99418361cd1b56b00e4ffef52444021e60c72
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 3 12:52:24 2010 +0000

    daemon: Don't use ../src path to include generator_protocol.h
    
    This file is already hard-linked into the current directory, so
    the relative path is not required.

commit c5a6584c4fcc0051e1a333838d7562a4fba7ad1f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 2 20:57:40 2010 +0000

    tests: Remove use of sfdisk from tests.
    
    Some older tests used sfdisk to create partitions for the
    tests.  sfdisk is buggy (more so than parted -- what is it
    with partitioning tools?) so replace these tests with
    equivalent part-* commands.

commit 1937698c25fb9f066dba7b48ad4731927e3e74da
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 2 20:33:06 2010 +0000

    daemon: Tolerate failure of blockdev --rereadpt after sfdisk.
    
    See commit 840536ea5a0568296dfd3e483442c76b93c5a949
    and commit 956fc5a3feacc970ea763697bf28fb686c875408.

commit 47d158596140328e12aa3b8028a77dd40bf12eeb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 2 17:05:58 2010 +0000

    binary: Link guestmount static binary with -lm.
    
    This is indirectly required via the new shared guestfish
    C inspection code by libxml2.

commit c36214c6825d77f1706c5eb5f6316bed88f240e4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 2 17:05:43 2010 +0000

    website: Distribute BUGS and RELEASE-NOTES files to website.

commit a2591230c12efad4a6ad843d9b8991e44fecabb2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 2 16:23:58 2010 +0000

    Version 1.7.0.

commit 3fac199a8b4f4580d348807769d964b94179cd7f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 2 16:18:30 2010 +0000

    Final RELEASE-NOTES file for version 1.6.0.

commit f0c28b391c2ca6d8be4b7b7313042a6b3eb4dc8c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 2 10:11:04 2010 +0000

    inspect: Add support for MeeGo.

commit bf0280bf589573c11529999a73e9ec642dea9d61
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 29 15:49:36 2010 +0100

    Version 1.5.26.

commit 7badf512f6859c2585c434a6d3f5772979bb5131
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Oct 29 11:54:34 2010 +0100

    inspect: Add support for Ubuntu.

commit 96b44334dd7421b8209f839faccb216a2cb0f773
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Oct 29 10:53:05 2010 +0100

    inspect: Add detection of Gentoo.

commit b4618fb060b40ba70f2be28b1b1ad625722a7edf
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Oct 29 10:32:53 2010 +0100

    inspect: Add detection of Arch Linux.

commit 233530d3541dd67ce8fec7d9677cdf659c9d2900
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Oct 29 10:21:33 2010 +0100

    inspect: Add detection of Pardus.

commit a81bf3f3ef24c8b6d66aea1038f7a16a382ff375
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Oct 29 10:50:39 2010 +0100

    inspect: Generic parsing of MAJOR.MINOR in product names.

commit 6e9917f72528d75e819b810bea8e0abd875b6810
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Oct 29 10:49:38 2010 +0100

    inspect: Generic parsing of release files.

commit 994ae6e35650e1eeefe63e3871f55efc41c4f5bb
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Oct 29 10:23:28 2010 +0100

    inspector: Sort <filesystems> section.

commit 12cf22ade46ba07aa162a311d3369096292d6d02
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 29 09:46:59 2010 +0100

    inspect: Ignore Pardus "/.swap" swapfile.

commit a0f85ba643990da25b6afe6a2bbd2407cf312c73
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Oct 29 09:53:57 2010 +0100

    autogen: Touch ocaml/.depend

commit 9f5d2171b8ab6ddedbf1822f24d4da969457433c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 28 22:56:11 2010 +0100

    inspector: List Debian packages.
    
    List Debian packages by downloading and parsing the file
    /var/lib/dpkg/status.

commit 6548a876f367427404a0f9ce9a634b01e0ccac78
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 28 22:32:50 2010 +0100

    inspector: Introductory documentation for XML format.

commit 99ed8d1be7547c3f2c7f7fdd479ab327b5c5ecc5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 28 22:32:05 2010 +0100

    inspector: Debian package format 'deb' instead of 'dpkg'.

commit 237627df37b97c18362755f646bbe1c4b05ee692
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 28 22:29:43 2010 +0100

    inspector: Return canonical block device paths in XML.

commit 4c5ca903b52ccc785a3d879da8506be248b0d6f7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 28 18:46:13 2010 +0100

    Version 1.5.25.

commit f2460699ab7f972b1981d072164a04820c52b0c6
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Oct 28 15:19:14 2010 +0100

    Ensure atomic creation of a cached appliance
    
    Cached appliances are discovered by their predictable path. Previously we were
    creating a cached appliance directly in this predictable path. This had at least
    2 undesirable effects:
    
    * Interrupting appliance creation would leave a corrupt appliance
    * 2 processes could simultaneously attempt to create the same appliance, causing
      corruption.
    
    This patch causes the cached appliance to be created in a temporary directory,
    and then renamed to the predictable path. As rename is an atomic operation, this
    makes the whole creation atomic.
    
    This patch also changes the predictable path to have a prefix of 'guestfs.'.
    This will make it simpler for system administrators to clean up old cached
    appliances.
    
    This patch resolves RHBZ#639405

commit 38af2eaceb4c8e9d675835bcd6e598ccb67daf0f
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Oct 28 15:19:13 2010 +0100

    Call febootstrap-supermin-helper using the new -u and -g options
    
    Use febootstrap-supermin-helper's new -u and -g command line options to setuid,
    rather than doing it in libguestfs.
    
    This resolves an issue with the generation of the cached appliance checksum. The
    checksum was being generated by a call to febootstrap-supermin-helper through
    popen(). Unfortunately, a bash misfeature meant that euid would be reset to uid,
    and the checksum was generated for uid, not euid. When virt-v2v is writing to a
    RHEV target, uid == 0 and euid == 36, which resulted in a cached appliance being
    created for root with permissions for uid 36.
    
    Note this requires febootstrap 2.10.

commit cf8add59d297d196facc2d0b9af45bb1d7946344
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Oct 28 15:19:12 2010 +0100

    Log the febootstrap-supermin-helper command line
    
    A side-effect of change 17e7cb9937a63ed8f9bb0fb6ac7302758be76846 was the the
    febootstrap-supermin-helper was no longer logged. This change adds it back using
    the new guestfs___print_timestamped_argv internal function.

commit 06fef60db5c7a96cb59aa92c4708e10333345e90
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Oct 28 15:19:11 2010 +0100

    New internal function guestfs___print_timestamped_argv
    
    This function generalises the existing print_cmdline used to output the qemu
    command line to output any given command line, and exports it to other modules.
    It also adds a timestamp to the old print_cmdline output for consistency with
    guestfs___print_timestamped_message.

commit 0353688577a27749f40bcc060e5703102c5a9649
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 28 13:41:12 2010 +0100

    list-filesystems: Use core list-filesystems API (RHBZ#642933).
    
    Change virt-list-filesystems to use the core inspection API
    instead of the deprecated Sys::Guestfs::Lib::get_partitions
    function.

commit 756c23997b864aa3e559172c01d247a9a9236b5d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 28 13:40:23 2010 +0100

    Sys::Guestfs::Lib: deprecate get_partitions (RHBZ#642933).
    
    However the code is left since this function is used
    by virt-v2v amongst others.

commit f30210cba89763a32cfbcbfd68ccfcec8d5300e4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 28 11:31:23 2010 +0100

    inspector: Rewrite virt-inspector (RHBZ#642930).
    
    Rewrite virt-inspector:
    
     - remove old and unsupportable features
     - use the C inspection API
     - don't run programs from the guest
    
    The RNG has been updated to reflect the new XML-only output.
    
    The new example files show the new XML output.

commit ca7e941329b31d1bffc8cae9dca6d28b06ecc300
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 27 16:06:11 2010 +0100

    tools: Use C API for inspection (RHBZ#642930).
    
    Update the following tools to use the C API for inspection:
    
     - virt-cat
     - virt-edit
     - virt-ls
     - virt-tar
     - virt-win-reg
    
    None of the tools in the tools/ directory now use the deprecated
    Perl inspection APIs.

commit a51f56adb168ac7d4b65b98c7f0cdb07f266265f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 27 16:47:33 2010 +0100

    New API: inspect-get-windows-systemroot to get systemroot.
    
    We are already using heuristics in the C inspection code to
    determine the Windows %SYSTEMROOT% directory.  This change
    just exposes this information through the API.

commit 40d58fe65e10aa692d056a573e21e5afdc9329c7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 27 15:47:45 2010 +0100

    Sys::Guestfs::Lib: deprecate inspection functions (RHBZ#642930).
    
    Deprecate the guest inspection functions in this module, remove
    documentation, and point users at the core API functions instead.
    
    However we will keep the code here since it is used by virt-v2v
    and virt-inspector.

commit fea2e61ac1129a2f01036d4dfbee8947f3d00886
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 27 14:51:17 2010 +0100

    daemon: Fix /dev/mapper paths from mounts and mountpoints (RHBZ#646432).
    
    Make the LV paths returned by these two commands canonical.

commit 2f52a40bed27e49972b957f1ef3276c422d5ef96
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 28 11:58:56 2010 +0100

    edit: Clean up tmp file handling in virt-edit.
    
    This was probably not a security issue, but this change
    makes the code cleaner by not opening the tmp file twice.
    
    Also be more careful about error checking in close syscall.

commit f93b234401093c63e67f2ffc254f611eee4daf7c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 27 17:32:21 2010 +0100

    doc: Warn about security implications of running commands.

commit e3851914de6bad3deb869ba865d2a6eb53c83151
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 27 15:33:35 2010 +0100

    virt-ls: Small fix to documentation.

commit 064569bcbf854a9cf588ce31851d987d5f114ec8
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Oct 28 15:15:07 2010 +0100

    Remove ocaml/.depend from git.
    
    ocaml/.depend is automatically generated. This patch removes it from git.

commit 0e896a490c46825e2ef998143d338dda5736223e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 27 12:21:02 2010 +0100

    Version 1.5.24.

commit fb998000e60b32219c2bf839044cff59f499dff1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 27 12:17:26 2010 +0100

    Disable test for RHBZ#576879 comment 5.
    
    This test has started to hang, for reasons we don't understand.

commit c66d6f215e8303d4eaf8ccfdb6a58cff04ccc485
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 26 15:28:28 2010 +0100

    Unify guestfish and guestmount options processing (RHBZ#642932).
    
    In guestfish, factor out the processing of the options -a, -c,
    -d, -i, -m, -n, -r, -v, -V, -x into a separate set of files:
    options.c, options.h, inspect.c, virt.c.
    
    Change guestmount so that it uses these same files (from the
    ../fish directory) to process the same options.
    
    This unifies the handling of these options between the two programs.
    It also adds the useful inspection feature to guestmount, so you
    can now do:
    
      guestmount -d Guest -i --ro mnt/

commit d600342b7d29c0176ff96a7807ebb38303ecb3a6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 26 13:01:47 2010 +0100

    df: Add --uuid option to print guest UUIDs instead of names (RHBZ#646821).

commit 6590e04bdcc3038312cb0a5f5545f1f0924907b2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 26 12:46:26 2010 +0100

    todo: Remove obsolete items from TODO file.

commit 33d6e0e7234d8bb1285ed5eac852f4f0a3dd9562
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 26 10:44:11 2010 +0100

    Document problems mixing mkmountpoint and umount-all (RHBZ#599503).

commit 607dcadd2dc7883865ada5ae158e750f19dfff67
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 26 10:04:56 2010 +0100

    appliance: Repo name is not Fedora-specific.
    
    The --with-repo parameter is also used by Debian to specify
    the Debian software repository, so remove references to
    Fedora.

commit f1930720d96d4a601f1ff63e6ce50da23b90188c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 26 10:03:50 2010 +0100

    appliance: Remove repo from appliance filename (RHBZ#638901).
    
    There's no need to have the appliance filename contain the
    repository name it was built from, and this change gives
    downstream users more freedom to mix and match libraries
    and appliances if they want to.

commit 99dc2a9702e6c8a2bf9073af4cbf1803417ec3ee
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 26 09:56:55 2010 +0100

    inspection: Ignore floppy disks and CD-ROM drives (RHBZ#642929).

commit f48cd1f262312ad278a293a20ab442dcfc076a69
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 25 13:22:17 2010 +0100

    Enable autosync by default.

commit 9160dee922ad0866a3f6245fb1e0ad0b2e90170c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 25 12:59:50 2010 +0100

    /dev/mapper paths should not be returned from C inspection APIs (RHBZ#638899).
    
    With this patch, /dev/mapper paths do not appear in the output
    of guestfs_inspect_os, as you can see from this example:
    
    Welcome to guestfish, the libguestfs filesystem interactive shell for
    editing virtual machine filesystems.
    
    Type: 'help' for a list of commands
          'man' to read the manual
          'quit' to quit the shell
    
    Operating system: Fedora release 13 (Goddard)
    /dev/vg_f13x64/lv_root mounted on /              <--- NB
    /dev/vda1 mounted on /boot

commit b01ef8eae1acc5105e623a25c8988bcc3326ea1c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 25 12:52:49 2010 +0100

    New API: lvm-canonical-lv-name: make LV name canonical.
    
    When logical volume names appear in places like /etc/fstab
    files they can have the form "/dev/mapper/foo-bar".  This
    function takes such names and makes them canonical.
    
    Note that this operation cannot be performed using the current
    API, because 'guestfs_stat' does not work on device names, and
    we don't really want to make a 'stat-device' call since that
    exposes too much non-useful detail about the appliance.
    
    With this patch you can do this:
    
    ><fs> debug ll /dev/mapper
    total 8
    drwxrwxr-x  2 root root   4096 Oct 25 12:51 .
    drwxr-xr-x 16 root root   4096 Oct 25 12:51 ..
    crw-------  1 root root 10, 62 Oct 25 12:51 control
    lrwxrwxrwx  1 root root      7 Oct 25 12:51 vg_f13x64-lv_root -> ../dm-0
    lrwxrwxrwx  1 root root      7 Oct 25 12:51 vg_f13x64-lv_swap -> ../dm-1
    
    ><fs> lvm-canonical-lv-name /dev/mapper/vg_f13x64-lv_root
    /dev/vg_f13x64/lv_root
    ><fs> lvm-canonical-lv-name /dev/mapper/vg_f13x64-lv_swap
    /dev/vg_f13x64/lv_swap
    ><fs> lvm-canonical-lv-name /dev/mapper/foo
    libguestfs: error: lvm_canonical_lv_name: lvm_canonical_lv_name_stub: /dev/mapper/foo: No such file or directory
    ><fs> lvm-canonical-lv-name /dev/mapper/control
    libguestfs: error: lvm_canonical_lv_name: /dev/mapper/control: not a logical volume
    ><fs> lvm-canonical-lv-name /dev/vg_f13x64/lv_root
    /dev/vg_f13x64/lv_root

commit 504c3de9fe9db97fb14f2ab8310a588fc3a04458
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 27 10:33:14 2010 +0100

    rescue: Add --network option.
    
    This enables networking in the rescue shell.

commit ec736e20d32febefa2fe35d503886e0999146f0e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 27 10:31:41 2010 +0100

    Don't use kernel module whitelist with ext2-based appliance.
    
    Since the ext2-based appliance is cached, and since it is not
    all loaded into memory (as with the initrd), we might as well
    put all the kernel modules in there.
    
    Note the kmod.whitelist.in file is still used for building the
    ordinary appliance.

commit 61da709722ec244da1c3c7d4f1a8706f76687cb3
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Oct 27 10:55:24 2010 +0100

    Fix networking in the appliance.
    
    Commit 4963be85 re-introduced networking to the appliance,
    but didn't configure the custom network the appliance expects
    since we switched to link local addressing. This patch
    configures QEMU to use the custom network again.
    
    Note that you still need to use guestfs_set_network (g, 1)
    to enable user networking.

commit 9332031543563fd2ae6e0e8731fc770f5a5931db
Author: Matthew Booth <mbooth@redhat.com>
Date:   Tue Oct 26 13:54:17 2010 +0100

    Don't include control characters in BufferIn trace output (RHBZ#646822).
    
    The example below shows what the output looks like for a large
    random buffer.
    
    $ guestfish -N fs -m /dev/sda1 -x -- \
        touch /test : \
        pwrite /test "$(dd if=/dev/urandom bs=128k count=1)" 0
    [...]
    pwrite "/test" "\x7f\xa0/\xb3\x80\xd3\xbc\xc3\xc3.\xb1\xe0\x1b\xafC\x06\xd5;\x0ajJ[o\xc1\xdd\xae\x1f\xce\xb2\x8d\xb3\xd0\x11\xcc$%\xe6<\xc7\xc7\xe7BU*\xc4l%\xaa\xea\xe9\x1an\xda]\xc6I\x0eC\xf9;\xec\x12a\x1f\xeaRH\xb2P\xd6+\xc4\xe6\xa5bW\x99\\x9d\xc8\x9bJ\xef\x99-\x16:h5\xe2\x0f\xa2\xa08\x9bU\x0b$\x138\xcf\xd4j\x9b\x83{%\xac0\xdaa1Xx\xbd`\x8e\xdd\x82\x87\x07\x98\xd2\x9ed\x8bq\xd0\x1f5\x8f\xab\xad4z1\xda\xc4b\xc1\xbc\x0f\xaa\xea\xc1\x15(\xfd1\xc2\x0bF\xe6\x9e\xb0+/g\\xab\xb0b\xde_\xca\xf9\xad\xe1?%\x17\xad\x98\xa4e\xc1\xe0f'\x89\xe9>\xff\xadhYi\xe7\x8c]%\xef\xe0\xa1R\xe5\xd5\x03K\xefI\xdf\xad\xd3\x82\xdb\x0f\xdd\xc3\x8f"\xf1G\xea\xf9r\xdd\xff\x88\x81\xb7\xf2\x0e\x0f\x1d;:\xf2F1\xdb\xb5D\xa1^\x928\xf5\x8e)\xab\xc4\xc3H(\xd0ol\xc6\xe4\xd6\xa3L\x1c\x06\xf4"<truncated, original size 130567 bytes> 0
    [...]

commit c9670080e9b7e614101109d385c66c2fdc15e191
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 25 12:54:59 2010 +0100

    daemon: Print failed path in stat command errors.

commit 1d5ec10659d67020c5b709e4df4c49bc0d59d58c
Author: Karel Klíč <kklic@redhat.com>
Date:   Mon Oct 25 12:48:36 2010 +0100

    fish: Fix too-short allocation in tilde expansion (RHBZ#636061).

commit 247324a4b3d9bf4782e18a629463a808d361fada
Author: Piotr Drąg <piotrdrag@gmail.com>
Date:   Sat Oct 23 12:52:35 2010 +0100

    Update Polish translations (RHBZ#502533).

commit ae748ba3c10ea93e7df03738c4e040fdb77e0c7c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 23 10:45:25 2010 +0100

    fish: Quote optional argument name in error message.

commit b7133b270922df2bc96a35c5316616b18c20c525
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 23 10:45:06 2010 +0100

    fish: Reject unknown opt args (RHBZ#642934,CVE-2010-3851).
    
    This updates commit 0c1d3c02a8147617ee0646e37d011235abdd2c22.

commit 6ecaa6371a340d30c2f818500b377963cf5afdee
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 23 10:23:45 2010 +0100

    fuse: Add --format option to docs (RHBZ#642934,CVE-2010-3851).
    
    This updates commit 44c5ee1163918bd5c9e6aa6c292f0c3bb15b7b25.
    
    Document the --format option in the guestmount manual page.

commit 204d54609b4b3e4ca637f0ce2fe98c33ce9d008b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 22 23:12:16 2010 +0100

    Version 1.5.23.

commit 4b0e7f5c6a097c2426385776f8b9d3ff0a80bb3f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 22 12:48:25 2010 +0100

    resize: Specify format of input, output disk (RHBZ#642934,CVE-2010-3851).
    
    This adds two new options: --format specifies the format of the
    input disk, and --output-format specified the format of the output
    disk.
    
    Requiring the format of the output disk seems a bit strange at first:
    after all, this is the disk that the virt-resize user has to create.
    However it is needed because we sometimes reopen this disk, after
    copying data over the first sector, and in theory a raw-format guest
    could write a qcow2 header here and have it copied to the output
    disk, which we would subsequently reopen.

commit 38bc7c98dff94b5ad451da86817f34a6fbc75b08
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 21 23:33:15 2010 +0100

    virt-make-fs: Specify format of disk (RHBZ#642934,CVE-2010-3851).

commit 1250d553f1bec4365b73ec96532fd1de0f85ea94
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 21 23:06:24 2010 +0100

    df: Specify format of disks (RHBZ#642934,CVE-2010-3851).
    
    The format parameter is taken from libvirt if available, else
    the user should supply the '--format' parameter (eg. for local
    disk files).

commit 641ccab6c3b17f1c94676eab99e8baa9cddf5a0b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 22 10:59:53 2010 +0100

    tools: Specify format of disks (RHBZ#642934,CVE-2010-3851).
    
    Sys::Guestfs::Lib is changed in two ways: firstly we take the format
    string from libvirt and pass it to add_drive_opts.  Secondly we allow
    an extra format =>  parameter to open_guest which allows the
    format to be specified for disk images.
    
    All the tools are changed to add an extra --format parameter allowing
    the format to be specified for direct disk images.

commit 44c5ee1163918bd5c9e6aa6c292f0c3bb15b7b25
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 22 15:01:55 2010 +0100

    fuse: Specify format of disks (RHBZ#642934,CVE-2010-3851).
    
    For command line disk images, specify the format using --format option
    in the same way as for guestfish.

commit 0c1d3c02a8147617ee0646e37d011235abdd2c22
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 21 23:05:26 2010 +0100

    fish: Specify format of disks (RHBZ#642934,CVE-2010-3851).
    
    For libvirt guests, the disk format is copied from libvirt (if
    libvirt knows it).
    
    For command line disk images, you can use --format to override
    format auto-detection.

commit 14490c3e1aac61c6ac90f28828896683f64f0dc9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 20 11:34:57 2010 +0100

    generator: Optional arguments, add-drive-opts (RHBZ#642934,CVE-2010-3851).
    
    This large commit changes the generator so that optional arguments
    can be supported for functions.
    
    The model for arguments (known as the "style") is changed from
    (ret, args) to (ret, args, optargs) where optargs is a more limited
    list of arguments.
    
    One function has been added which takes optional arguments, it is
    "add-drive-opts", modelled as:
    
      (RErr, [String "filename"], #required
             [Bool "readonly"; String "format"; String "iface"]) #optional
    
    Note that this function is processed in the library (does not go over
    the RPC protocol to the daemon).  This has allowed us to simplify
    the current implementation by omitting changes related to RPC or the
    daemon, although we plan to add these at some point in the future.
    
    From C this function can be called in 3 different ways as in these
    examples:
    
      guestfs_add_drive_opts (g, filename,
                              GUESTFS_ADD_DRIVE_OPTS_READONLY, 1,
                              GUESTFS_ADD_DRIVE_OPTS_FORMAT, "raw",
                              -1);
    
    (the argument(s) between 'filename' and '-1' are the optional ones).
    
      guestfs_add_drive_opts_va (g, filename, args);
    
    where 'args' is a va_list.  This works like the first version.
    
      struct guestfs_add_drive_opts_argv optargs = {
        .bitmask = GUESTFS_ADD_DRIVE_OPTS_READONLY_BITMASK,
        .readonly = 1,
      }
      guestfs_add_drive_opts_argv (g, filename, &optargs);
    
    This last form lets you construct lists of optional arguments, and
    is used by guestfish and the language bindings.
    
    In guestfish optional arguments are used like this:
    
      add-drive-opts filename readonly:true
    
    In OCaml these are mapped naturally to OCaml optional arguments, eg:
    
      g#add_drive_opts ~readonly:true filename;
    
    In Perl these are mapped to extra arguments, eg:
    
      $g->add_drive_opts ($filename, readonly => 1);
    
    In Python these are mapped to optional arguments, eg:
    
      g.add_drive_opts ("file", readonly = 1, format = "qcow2")
    
    In Ruby these are mapped to a final hash argument, eg:
    
      g.add_drive_opts("file", {})
      g.add_drive_opts("file", :readonly => 1)
      g.add_drive_opts("file", :readonly => 1, :iface => "virtio")
    
    In PHP these are mapped to extra parameters.  This is not quite
    accurate since you cannot omit arbitrary optional parameters, but
    there's not much than can be done within the limitations of PHP
    as a language.
    
    Unimplemented in: Haskell, C#, Java.

commit 87be9b26e7004a9a58970b4e97d0d152dc1c0704
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 20 10:49:59 2010 +0100

    generator: Rearrange argt logically (RHBZ#642934,CVE-2010-3851).
    
    This structure has accreted over time.  Rearrange the types
    into a logical order.

commit cd29c50ca820a03b9cecb300a84fb884425cb565
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 22 17:10:49 2010 +0100

    daemon: Use stdint UINT64_C instead of <const>ULL.

commit 2109d8d86aeb66093e0a9f41d3693693e3df66d5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 22 12:13:07 2010 +0100

    inspector: Add comment about why --fish option implies write mode.

commit 4460280960081d8b037719f671a7fcea8be091fb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 21 18:47:44 2010 +0100

    php: Create test file properly before running test.

commit c97d6c16bd74163d26f7ab9c7f55b842802b23d7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 21 18:41:56 2010 +0100

    php: Note that tests are testing the wrong thing.

commit 8f30c3c3f8c063f7c5ff8c6154d881e07a820251
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 21 16:39:04 2010 +0100

    ruby: Run tests one at a time, instead of in parallel.

commit ea6209198026080a9d9e588283e83aa9c4e2f177
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 21 13:59:36 2010 +0100

    generator: Refactor code for Perl bindings.
    
    This simplifies the code that generates the Perl bindings
    by removing repeated sections.

commit ed74706d80394fef709ec0258fc5cf7d974ff8b1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 21 11:59:49 2010 +0100

    generator: Missing newline character.

commit 6391d1a7cfa10337a75465c72d49df3c9ebc65ca
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 21 10:50:25 2010 +0100

    fish: Change 'int argc' to 'size_t argc' throughout.

commit fcd75e021a12fbd93c4d51fbca7844fdb4f7436f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 20 13:35:43 2010 +0100

    generator: Remove unused parameter.
    
    generate_c_call_args optional decl parameter is never actually
    used, so remove it.

commit dad3fcfefd7c013ecbe8fa04df032fefb619e7d6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 19 15:18:15 2010 +0100

    Version 1.5.22.

commit 7d746ba6915e3c0d8fbe41053da64f4e9fa11cd4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 18 14:34:28 2010 +0100

    virt-resize: Document guest boot stops at "GRUB" (RHBZ#640961).

commit f7475ec577b7ca810185e0fd70a39ac9adaae620
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 18 14:18:58 2010 +0100

    df: Correctly quote libvirt domain and filesystem in --csv mode (RHBZ#639986).
    
    This fixes virt-df --csv when used with libvirt domains that contain
    quotes, spaces, commas and other lesser-used characters.

commit 4d88a74532b20bcb60909c0d0983cdf7498aa08c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 18 13:35:06 2010 +0100

    virt-resize: Document qcow2 output format (RHBZ#642826).

commit 94fa736b64591a374e49250173c9cdcc7f4e1211
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 18 13:33:02 2010 +0100

    virt-resize: List truncate(1) in SEE ALSO section.

commit a80177cc847102d5a6e43a8ff87769e86f30bd6c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 18 13:18:20 2010 +0100

    tools: Add section describing quoting libvirt domain names to docs (RHBZ#643624)

commit b3d27793f04ae44b2c11f6422a19b4422ac941cd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 18 12:56:54 2010 +0100

    parted: Don't return "loop" for non-partitioned devices (RHBZ#634246).
    
    If you ran part-get-parttype command on a device which didn't
    contain a partition, it used to return the string "loop".  This
    is an internal representation that parted uses.  We should instead
    return an error because part-get-parttype makes no sense for
    devices which are not partitioned.

commit 361c513dc3e013d2d7e902e3b309a4c37cf6ee0f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 18 12:44:08 2010 +0100

    contrib: Note about what needs to be done for visualization.

commit 06397c2f1ffe56e2300ff9439a2903479c9c3da3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 18 12:41:41 2010 +0100

    todo: Add wishlist items to to-do list.

commit c50eb8f1cc33009f1ed29a002066e026fe2923f4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 6 16:38:12 2010 +0100

    todo: Add note about using blktrace.

commit 241c34fb7acff24713331f015429eb52055553a6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 6 11:30:02 2010 +0100

    contrib: More trace visualization.

commit 13276f753421c2df4f036647ce43e2ae8a2def0c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 6 10:19:20 2010 +0100

    debug: Add qtrace <device> on|off to allow selective traces.

commit 4f6bd18d2e2a9c1d317a07b59072579d8fff42ac
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 6 09:08:39 2010 +0100

    part-disk: Align whole disk partition to 64 sectors.
    
    Change the part-disk command so it aligns the partition to
    64 sectors (instead of 1 or 34 sectors as now).  This should
    ensure that the filesystem contained within is aligned.

commit ccc5425105dce58859c0793c83dd4d17a139d9ed
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 5 22:48:37 2010 +0100

    contrib: Fix small mistake in README file.

commit 37e0c30d9075a35780a945a462913165d973c372
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 5 22:21:43 2010 +0100

    contrib: Update README files.

commit 3e1a5352703a42980d9855f29fbfa6d5788c56ea
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 5 22:19:15 2010 +0100

    contrib: Visualizing block device access and alignment.

commit 6fbbcdd64c1983efeadb846958865373df962078
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 4 20:34:36 2010 +0100

    ocaml: Add g#ocaml_handle method.

commit 63bfcdbdd81b81e6a8e2157de36f9e1638801570
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 4 20:33:14 2010 +0100

    ocaml: Document g#close () method for objects.

commit 6af1cd7245de0183404ea6aadda4c2f63f9f616b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 4 20:29:05 2010 +0100

    ocaml: Create the handle when the object is instantiated.
    
    Previously we had only one handle shared between all objects .. oops.
    This fixes commit 67636f721056d2f2250b0ff8acd981a0294536a9.

commit 67636f721056d2f2250b0ff8acd981a0294536a9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Oct 3 21:18:25 2010 +0100

    ocaml: Add alternate object-oriented programming style.
    
    In original style:
    
    let () =
      let filename = Sys.argv.(1) in
      let g = Guestfs.create () in
      Guestfs.add_drive_ro g filename;
      Guestfs.launch g;
      let roots = Guestfs.inspect_os g in
      print_endline (Guestfs.inspect_get_product_name g roots.(0))
    
    The same code in the new OO style:
    
    let () =
      let filename = Sys.argv.(1) in
      let g = new Guestfs.guestfs in
      g#add_drive_ro filename;
      g#launch ();
      let roots = g#inspect_os () in
      print_endline (g#inspect_get_product_name roots.(0))

commit 1a3324ea2b0f4a4e04f99c4efb5af1d4cc256731
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 2 09:10:22 2010 +0100

    test-copy: Skip this test if /dev/fd is missing, because of broken mock 1.1.4.

commit 887a79d1d1c47e537fdffd1208acbacd598b0f96
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 2 09:07:42 2010 +0100

    test-virt-resize: Skip this test on 32 bit hosts.

commit fd10487c9e5d1196ff751f6f37b75a7e5455f243
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 1 21:04:07 2010 +0100

    Version 1.5.21.

commit ffc75da7139f1ff447b597457458b72eba2bb108
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 1 10:46:38 2010 +0100

    fish: Fix glob command (RHBZ#635969).
    
    This is a fix for the glob command in guestfish which was inadvertently
    broken in commit c359347dd42c9f5b875630537ee3641264826b89.
    
    This also appears to fix:
      https://bugzilla.redhat.com/show_bug.cgi?id=635969
      glob echo mkfs ext2 /dev/vd[b-t]1 prints garbage

commit c6c030b64bab98602363485cb62a9e1d847d570e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 27 17:06:14 2010 +0100

    Add test for virt-resize.
    
    This tests a number of things which have caused problems for us:
    
     - resizing PVs and LV content
     - handling GPT format disks
     - using qcow2 as a target disk format
     - shrinking disk images
    
    Note that the disk content is empty (not a real VM), but this is
    adequate since all we want to test are the operations and calculations
    done by virt-resize.  We are not interested here in whether e2fsprogs
    and LVM actually works.

commit 0dc1f8e7aeb390e72125f459930850b8050318df
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 27 17:00:45 2010 +0100

    resize: Fix handling of GPT and qcow2 (RHBZ#633766, RHBZ#633096).
    
    Previously we copied the bootloader data directly from the
    source disk image to the target disk image using host file
    operations (before launching libguestfs).  This has two problems:
    firstly it has no chance of working with qcow2, and secondly
    it didn't behave properly with GPT.
    
    This changes the code so that everything is done through
    libguestfs.  Block device sizes are now calculated properly
    for qcow2 (RHBZ#633096) because this is done using the libguestfs
    blockdev_getsize64 call.  The partition table is still created
    by parted, but to workaround a bug in parted this is done before
    copying the bootloader.  Finally the bootloader copy is done
    using the new APIs pread-device and pwrite-device.
    
    Shrinking now works, at least for simple cases (RHBZ#633766).

commit 7e4bf29fdf3067f3e83cd818a79ee522ae28e7ef
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 27 12:00:10 2010 +0100

    New API: pread-device, partial read for devices.

commit e65f5213637e71f6f88763ce177fd23c65e1033d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 27 10:51:38 2010 +0100

    pread: Check count and offset parameters are not negative.

commit 533aff2879d85a4061b9d31e9b25996ce0af60f5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 27 10:12:22 2010 +0100

    Freshen POD (manual pages) stylesheet.

commit a50cdb512c31efd75fe09ff6646b02a9a23faa02
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Sep 26 22:41:24 2010 +0100

    Version 1.5.20.

commit eeaab2ba84441a96977281a4472b1bccb9ec80a9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Sep 26 18:00:11 2010 +0100

    New API: pwrite-device
    
    This is the same as the existing 'pwrite' API call, but allows you
    to write to a device.

commit 5a8c8b8bf6e846b8d2d7e710f814d24d9a0183c3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Sep 26 17:59:50 2010 +0100

    pwrite: Check offset is not negative.

commit 406dbf7565e702588f172a8cc534acacb2fd7bee
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Sep 26 22:21:10 2010 +0100

    fish: Refresh guestfish documentation.

commit a7070682932717f318f57f9aca6188a954a7e9aa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Sep 26 19:34:46 2010 +0100

    Document ambiguity between devices and paths in API.

commit d72a617a262e000ce7bc97838ad1f0d640dc66ec
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 24 19:28:01 2010 +0100

    Document accurately how supermin appliance uses /tmp as a cache.

commit c9c0ac7d362fd19214c2c5e5bb7dcd9059950887
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 24 18:54:37 2010 +0100

    Allow $TMPDIR to override most temporary directory uses.
    
    Be more consistent in allowing the user to override use of the
    temporary directory by specifying $TMPDIR.  Also prefer P_tmpdir
    macro (defined in <stdio.h>) if that is defined, rather than
    hard-coding "/tmp" for the fallback location.

commit 840536ea5a0568296dfd3e483442c76b93c5a949
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 24 18:53:21 2010 +0100

    Call blockdev --rereadpt then udev_settle after sfdisk commands.
    
    This updates commit 956fc5a3feacc970ea763697bf28fb686c875408 so
    that we call udev_settle after rereading the partition table.  This
    ensures that the devices nodes for the new partitions have been
    created.

commit be49d1efa2c2447553f12a51c04f2c21f213fd75
Author: Daniel Cabrera <logan@fedoraproject.org>
Date:   Thu Sep 23 18:11:35 2010 +0100

    Update Spanish translations (RHBZ#636918).

commit efdc9c05031b04eecc6558976d65ac91449b51c8
Author: Piotr Drąg <piotrdrag@gmail.com>
Date:   Thu Sep 23 14:45:50 2010 +0100

    Update Polish translations (RHBZ#502533).

commit a7a1c981529a882ae0252584f0752dd1c14b8f00
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 22 21:50:46 2010 +0100

    Version 1.5.19.

commit df69543720de5bf7dd1a734c3bef6d191ceeab33
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 22 17:43:34 2010 +0100

    regressions: Test just-built guestfish.
    
    Instead of testing the installed /usr/bin/guestfish.
    
    This fixes commit ddda0f7bd00a37274dae38f4ce93955b8cfdf7d7.

commit 956fc5a3feacc970ea763697bf28fb686c875408
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 22 16:35:52 2010 +0100

    Call blockdev --rereadpt after sfdisk commands.
    
    On fast machines sfdisk has some sort of race where it
    fails to re-read the partition table it has just created
    (it's not clear if this is a race in sfdisk, the kernel or
    some other component).
    
    This commit works around the problem by calling
    blockdev --rereadpt after sfdisk operations, which
    experience shows is enough to stop the problem from
    happening.

commit f6fda69953ca110104481f1263ec9a96e74dbb88
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 22 15:37:34 2010 +0100

    Version 1.5.18.

commit ddda0f7bd00a37274dae38f4ce93955b8cfdf7d7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 22 14:10:58 2010 +0100

    Test guestfish -a and guestfish -d options.
    
    Since these options were both broken in released version 1.5.17,
    best to have a regression test to catch this in future.

commit e319b120acec1962319cca534d4504a8999135db
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 22 14:10:13 2010 +0100

    appliance: Ignore unreadable dbus service file (Fedora 15).

commit 734b2d2483f0b0e6c3f4e0427dcde19877355f0f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 22 11:59:58 2010 +0100

    fish: Fix segfault in free_drives() function.
    
    This updates commit 8ea62c8d7f3f7f7e4057b93105cf979271aa13f4
    so it doesn't try to free the optarg (stack-allocated) strings.

commit 460aa67118656e7bb53d2d04c70e9ee3a301c076
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 21 21:57:50 2010 +0100

    Version 1.5.17.

commit a54aa3caae32a029a523d293041413d35208e013
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 21 22:49:18 2010 +0100

    Update release notes for new features in 1.5 branch.

commit d75a2bff1264828f02b68a9c8bc7eb2521bd6684
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 18 10:09:04 2010 +0100

    fish: Implement 'hexedit' command.

commit 5d4ae18e2b93073080fbbf8c98b11eec15dbc1e6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 20 18:23:58 2010 +0100

    New APIs: upload-offset and download-offset
    
    These APIs allow you to efficiently write and read parts of
    files or devices.

commit 8c5a4d949ee8ffe4ac7f373e667f2f8930db4543
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 21 19:49:08 2010 +0100

    leak: Clear history before exiting guestfish.
    
    Clear the in-memory history before exiting.  This removes
    some but not all memory leaks associated with using the GNU
    History library.  As far as I can tell it is not possible to
    free up everything used by GNU History.
    
    (Found by valgrind).

commit 8ea62c8d7f3f7f7e4057b93105cf979271aa13f4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 21 19:40:23 2010 +0100

    leak: Free list of drives and mountpoints in guestfish.
    
    Previously the list of -a, -d, -m, -N parameters were leaked.  This
    change frees them explicitly.
    
    This is not such an important fix since guestfish is a one-shot
    program, but it aids in finding other leaks in future.
    
    (Found by valgrind).

commit e7f62742b6141fd19444fc0e191281777cd966f9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 21 19:38:50 2010 +0100

    leak: Free PCRE regexps when library is unloaded.
    
    The compiled PCRE regexps used for inspection were being leaked when
    the library was unloaded.
    
    (Found by valgrind).

commit 6d276dae8d1bbb54d8708c94d23879d39f5fd4a3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 21 19:37:24 2010 +0100

    leak: Appliance name was leaked during guestfs_launch.
    
    This frees the string containing the name of the appliance
    which was previously being leaked during launch.
    
    (Found by valgrind).

commit 0132890790a082c5d0f31cc64367b4897c8e88b7
Author: Matthew Booth <mbooth@redhat.com>
Date:   Tue Sep 21 13:22:58 2010 +0100

    Add more exclusions to .gitignore.

commit d1c2287fe4636db9a54888e71fb150984f00b0e4
Author: Matthew Booth <mbooth@redhat.com>
Date:   Tue Sep 21 10:50:41 2010 +0100

    Fix appliance build dependency problem
    
    The appliance was being completely rebuilt every time guestfsd was updated. This
    was because make.sh depended on guestfsd, which it had to do because it
    called update.sh to install guestfsd.
    
    This fix removes the call to update.sh in make.sh, and therefore the dependency
    on guestfsd. The Makefile already includes a rule to run update.sh when guestfsd
    is updated, so this was unnecessary.

commit ff4ae8633e0ca7c1e679870600830ee4d9f1cd71
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 21 08:53:44 2010 +0100

    fish: Add --echo-keys option to allow passphrases/keys to be echoed.
    
    See also:
    http://catless.ncl.ac.uk/Risks/26.17.html#subj13.3

commit 832864922a044bbd9acf58bc0c5b9bea9d4b2fa5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Sep 19 15:55:46 2010 +0100

    df: Add --one-per-guest option for using one appliance per guest.

commit 17e7cb9937a63ed8f9bb0fb6ac7302758be76846
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 20 14:02:06 2010 +0100

    Fix error launching libguestfs when euid != uid.
    
    When writing to a RHEV target, virt-v2v launches the libguestfs
    appliance with euid:egid = 36:36, which is required to write to
    an NFS target using root_squash.
    
    Since we changed to using a cached appliance, this causes an error on
    start up, as the cached files are owned by root, but the cache directory
    is owned by 36:36.  The reason is that bash resets euid to uid and
    egid to gid so when febootstrap-supermin-helper is executed, it runs as
    root:root.  The cache directory was created by libguestfs directly so
    it has the correct ownership.
    
    This patch fixes the issue by using explicit fork/exec instead of
    system (ie. not going via a shell) and by setting the real UID and
    GID to the effective UID and GID before execing.

commit 6123abc165e707a19e35b5cf16e676f79476116c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 20 13:06:13 2010 +0100

    todo: Suggest removing repo name from appliance name.

commit 0003ea2c3dbaa7e22f4f616539136821d80694b8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 18 09:38:05 2010 +0100

    generator: Generate guestfish-only commands.
    
    The guestfish-only commands such as 'alloc' and 'edit' are
    now generated from one place in the generator instead of being
    spread around ad-hoc in the C code.

commit 585fceb3350c17a3d6ed7f2daffd5e2b3e5fc3e1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 18 08:57:30 2010 +0100

    fish: In guestfish(1) turn command references into links.

commit 3eb76554ef1f2f218f8920d9a8b8fb4ba6b21d66
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 17 14:35:43 2010 +0100

    fish: Correction for online help for 'edit' and 'more' commands.
    
    This corrects commit b5c287bcd456bdb02d8ec0443483df34f4fd6b5d
    and commit 639ca1828b167bf59353f0cd3c8c79c6289bbd5d.

commit a37ec221af8542f4ec76f510f9cd3e78d89caa5c
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 15 22:12:35 2010 +0100

    Version 1.5.16.

commit 6b2ae9a8b0efba044f4d409b70211aba450a6899
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 15 22:08:35 2010 +0100

    configure: Make "fedora-13" the default repository.

commit dd093a7660338ac5ad1959394f09397df2c793de
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 15 21:47:37 2010 +0100

    fish: If -m option fails, suggest a mountpoint.

commit 325587d89e56a27c978b87ad591b4966fe79075f
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 15 20:49:32 2010 +0100

    todo: Remove section since we now have list-filesystems API.

commit d4ba3d3421523b7d9da5da7c0e77df9b215b3e7d
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 15 20:35:06 2010 +0100

    Version 1.5.15.

commit 000c4a82fbd78667849551114b6d08f391324796
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 15 17:22:29 2010 +0100

    New API: list-filesystems: list filesystems
    
    This API is a simpler replacement for the guestfish commands
    list-devices / list-partitions / lvs, in the case where you are
    just examining a guest by hand to see what it contains.
    
    Typical usage and output in guestfish is like this:
    
    $ guestfish --ro -a /dev/vg_trick/F13x64
    ><fs> run
    ><fs> list-filesystems
    /dev/vda1: ext4
    /dev/vg_f13x64/lv_root: ext4
    /dev/vg_f13x64/lv_swap: swap
    
    It can also be used to replace programs that try to mount
    devices to determine if they are mountable filesystems.

commit ffd4820ffe953b0583e3a9357e37d74bed3a2320
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 15 16:39:36 2010 +0100

    New API: part-to-dev: Convert partition name to device name.
    
    This adds a formal API for going from a partition to the containing
    device, eg. /dev/sda1 -> /dev/sda

commit ff38fea645e69e8f4d84f2691dac3116d9bac1c4
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 15 17:15:44 2010 +0100

    generator: Add TestOutputDevice.
    
    This is for testing functions that return a device or partition
    name, so that we can compare the return value with the canonical
    device name (eg. "/dev/vda1" == "/dev/sda1").

commit 43d5ea6f1ed4cc74c521e4d2b0eec6110f5c44fd
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 15 16:37:24 2010 +0100

    todo: More use of libblkid.

commit c98f0733616c900a021136a6753308a673df0afa
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Sep 14 22:29:08 2010 +0100

    fish: In usage message use new-style -i option syntax.

commit 42b62b8240a9b32f0a198105b03cfadaf97a7a7b
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Sep 14 22:28:10 2010 +0100

    fish: Update copyright dates in usage message.

commit 31a2c006cd6486f0ca5afb11e42bcc412385a074
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Sep 14 22:27:06 2010 +0100

    fish: Remove extraneous space from usage message.

commit 7c87dd1cf9cd14f753a2020425a5c20ba262f51b
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Sep 14 22:17:24 2010 +0100

    todo: More ideas.

commit 5a7c430f1f99cbb2aa9cc73318453ca425db3fee
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Sep 14 13:29:59 2010 +0100

    Version 1.5.14.

commit d3c6e50422562af592682fdd58dbadc98069ef18
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Sep 14 12:24:54 2010 +0100

    configure: Check for virtio-serial support in qemu.
    
    All other vmchannel methods are obsolete, but we were still trying
    to check for them.  This replaces all of them with a simple check
    for virtio-serial.

commit 9cab7e3ecd9df8bfa6a3dad1dd11ba88452c819b
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Sep 14 12:24:12 2010 +0100

    pardus: Check for cpio in configure.

commit 17b50a384f315f502ed1c236ce6641195286e3ae
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Sep 13 19:06:39 2010 +0100

    Update Spanish translation (RHBZ#633357).

commit a403e74355d2ef9a45041c931ed68204007905c5
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Sep 13 16:01:53 2010 +0100

    build: Add run-test-tool-locally to EXTRA_DIST.

commit 2b1e36db75c14d7e2f6f6a096d8cec3f1bd8adab
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Sep 13 14:47:43 2010 +0100

    Version 1.5.13.

commit 7419335e1113f28fd17b512992df22eb28cb4c05
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Sep 13 14:49:16 2010 +0100

    appliance: Disable setting scheduler to noop.
    
    This is a workaround until
    https://bugzilla.redhat.com/show_bug.cgi?id=630583
    is fixed (bug in Linux 2.6.36).

commit 3deebe5bf10f3baa954ebc1d12e92efdd635226f
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Sep 13 14:45:18 2010 +0100

    ubuntu: Remove bogus debirf file.

commit 75f0a92debd3f68c544c821fa54a973b91ea7e42
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Sep 13 14:44:46 2010 +0100

    ubuntu: Add linux-image to the packagelist.
    
    It seems that linux-image (ie. the kernel) is omitted in some
    versions of the base packages.

commit 93ae3fa9da7e31bba563977ee61b2df1b395400f
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Sep 13 14:44:05 2010 +0100

    ubuntu: /proc can be a symlink
    
    If it's a symlink then the succeeding mount commnd will fail.
    Remove it and make a /proc directory.

commit da107cf3d959af2d41da4bec3b9f2fd7c09c7ae9
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Sep 13 14:42:47 2010 +0100

    build: 'make quickcheck' rule now uses new run-test-tool-locally script.

commit 9f653edcdc6ecceb7a22441e496f1fc08a95f56c
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Sep 11 17:16:22 2010 +0100

    build: hivex is required.
    
    hivex library has been required since we moved the inspection
    code to C.  Check for this in configure.ac.

commit f565e71560862e9fa3e6d000c5f8fa6deb7e90e0
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Sep 11 13:14:45 2010 +0100

    Version 1.5.12.

commit e903739935ce32190b1c7b087d2cd9c2d2a7ec88
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Sep 11 13:41:26 2010 +0100

    build: require Augeas for library.
    
    Augeas has been required since we moved the inspection code to C,
    however we were not correctly enforcing this in configure.ac, nor
    correctly linking to the library until now.

commit 67fd3a7d99f3001aaf90682e102eba6708d8337a
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Sep 11 13:20:59 2010 +0100

    generator: Provide no-op generator if no OCaml compiler.

commit 2fbac04b9de826fb49400a1fc7a97262b76d078e
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Sep 11 13:14:04 2010 +0100

    build: Don't distribute src/generator.ml, no longer exists.

commit b42262c3db6013c363e2532cf7a466ccaf4d49f0
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Sep 11 12:19:25 2010 +0100

    generator: Calculate MD5 of test.iso at runtime.
    
    Because this used to be compiled into the C test, it changed
    every time the ISO was rebuilt (which because of Makefile deps
    was every run).
    
    Now it is calculated at runtime so the C test file doesn't keep
    changing.

commit 451a28349b11fe08cb3f7ca84e58b6e69646707b
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Sep 11 12:05:03 2010 +0100

    generator: Don't use real uuidgen for UUIDs.
    
    This was one reason why capitests/tests.c changed every time the
    generator was run.

commit 04d8209077d2227eb1d42695ba71147f78987050
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Sep 11 09:25:12 2010 +0100

    Split generator into separate source files.
    
    'src/generator.ml' is no more.  Instead the generator is logically
    split up over many different source files.
    
    Read generator/README for help and tips.
    
    We compile the generator down to bytecode, not native code.  This
    means it will run more slowly, but is done for maximum portability.

commit 264629b9f0ace1062b453b2d0ae55e48385189d3
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Sep 11 08:11:43 2010 +0100

    syntax: Replace -a and -o with && and || for portability.

commit 431503d007b22bf10226843cca84628544fadca9
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Sep 10 23:00:07 2010 +0100

    syntax: Use exit (EXIT_SUCCESS) instead of hard-coded number.

commit 513363290ef146c8cc54ba80087ae8dd66a40ab9
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Sep 10 22:55:32 2010 +0100

    syntax: Remove unused assert.h header.

commit 21aac863e29eca5552c4ae1645306e966f11c1d8
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Sep 10 22:55:03 2010 +0100

    syntax: Remove unused ignore-value.h header.

commit 0e422c0f590caf1d5f182c9b22f0b16e2a31b02b
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Sep 10 22:54:30 2010 +0100

    syntax: Remove unused signal.h header.

commit a0b7045e0abb7e3a7ff4d1324f16e50de94bed55
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Sep 10 22:53:56 2010 +0100

    syntax: Remove unused c-ctype.h header.

commit c1b63526774614dd5a1f6710e63ae466489469d5
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Sep 10 22:56:22 2010 +0100

    syntax: Fully bracket m4 macro arguments.

commit b3d94d6a71e74e817ad5bdb9497e88d19ec2e29d
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Sep 10 22:52:50 2010 +0100

    syntax: Remove trailing spaces.

commit b4a3aec60ed4775f8ca2eb079e389af3a1769069
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Sep 10 22:57:10 2010 +0100

    syntax: Use spaces instead of tabs for indentation.

commit 3d994f3d8e12356223d37c1b45ebe2eb39ef28a6
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Sep 10 22:51:39 2010 +0100

    syntax: Replace _prohibit_regexp with _sc_search_regexp.

commit c359347dd42c9f5b875630537ee3641264826b89
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Sep 10 13:26:10 2010 +0100

    fish: glob should only print commands when trace mode is enabled.

commit b033b55558503a1920c5b7cc1a7e1365749585e0
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Sep 10 13:25:40 2010 +0100

    fish: Add regression test for copy-in and copy-out.

commit 3161cb58a5c9d285c2b9f9c63887138dfc36f28c
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Sep 10 12:01:03 2010 +0100

    README: Document virtio-serial is now the only vmchannel.

commit b1e65806a185c6b2ec36efc04d85c268a65e97cc
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Sep 10 11:53:46 2010 +0100

    fish: const-correctness fixes in copy.c

commit f6246e932cb518cd8d7b3a02c338e736188f4115
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Sep 10 10:29:46 2010 +0100

    Version 1.5.11.

commit 025583593b020d80cf237d4539288f915118f927
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Sep 10 10:28:51 2010 +0100

    Update OCaml dependencies.

commit 646813ec513cb8eae3d9b13c52b846fc36654803
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Sep 10 10:28:37 2010 +0100

    Update PO files.

commit 878c8c77d8b46b1c4dd5189f67f0262d44eed70c
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Sep 10 10:27:45 2010 +0100

    fish: Fix 'copy-out' command when local directory is "/foo".

commit 3578f170a1f70a86fb2213fc576190ad5aff61be
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Sep 10 00:02:56 2010 +0100

    fish: Fix typo in documentation of copy-out.

commit 8902b33c0e2458dbaf939a1859a56c963a117939
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Sep 9 23:25:37 2010 +0100

    Version 1.5.10.

commit f383ac139f5575754715a9dfbe88c67346eaa6e5
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Sep 9 23:25:23 2010 +0100

    todo: Remove discussion of copy-in/copy-out.

commit 2635a9c70e5f8aab85bbcb6b7a645f720d1e4466
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Sep 9 18:49:10 2010 +0100

    fish: Implement copy-in and copy-out commands.

commit 43eed091129212dd29996838cf1d76af0f8fc135
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Sep 9 22:43:32 2010 +0100

    New APIs: is-chardev, is-blockdev, is-fifo, is-symlink, is-socket
    
    These complement the existing is-file and is-dir APIs.

commit 3a99114360636806078bbf614c241e89661bcc7f
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Sep 9 22:20:28 2010 +0100

    daemon: Move 'exists', 'is-file' and 'is-dir' to separate file.
    
    This commit is just code movement.

commit 55b6e18f95950b1a2ec69d549c9e6c8a5758d166
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Sep 9 22:42:57 2010 +0100

    generator: Fix incorrect shortdesc in docs for 'is-dir' command.

commit 22aa9268f548eab9763311a080859d8cf2257a93
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Sep 9 22:42:26 2010 +0100

    generator: Fix documentation for 'is-file' command.

commit 639ca1828b167bf59353f0cd3c8c79c6289bbd5d
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Sep 9 14:11:32 2010 +0100

    fish: Fix 'more' command to work with any file.

commit b5c287bcd456bdb02d8ec0443483df34f4fd6b5d
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Sep 9 14:11:20 2010 +0100

    fish: Fix 'edit' command to work with any file.

commit 13be76168260ee57e3d134177066ca7ceb984092
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Sep 9 13:53:08 2010 +0100

    guestfs: Reference guestfs-browser architecture in threads documentation.

commit b1454e38987473c94f20b10061031f2abe5a69a0
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Sep 9 13:52:48 2010 +0100

    guestfs: Document progress notification messages in protocol.

commit e2ef068cb7d18f0c0d4931f97332a38ea4ea2477
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Sep 9 13:52:32 2010 +0100

    guestfs: More accurate documentation for initial message.

commit 6d9f8f5c140c3116fb0292fcf73f560812c7d5fb
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Sep 9 13:51:52 2010 +0100

    guestfs: Remove traces of documentation for non-existent 'low-level API'

commit f3c05da4f9c226c18476eb135dfcb5875d65bf63
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Sep 9 12:00:36 2010 +0100

    guestfs: Fix typo in man page.

commit 979bcc553897f42024539ae6dd6ba66e9764a92c
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Sep 9 13:40:45 2010 +0100

    todo: Notes on virt copy command.

commit 6a87e0af24e957398ddae7db3c37da5d23f6686c
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 8 17:50:44 2010 +0100

    Bring TODO file up to date.

commit c51ade2e85b1e0b4d6f8537cc2bfe671023cd8b1
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 8 11:03:10 2010 +0100

    Version 1.5.9.

commit d5c8d3b45b9646a4ae9d4ea033e1cc13a6e25c1f
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 8 11:00:00 2010 +0100

    fish: Add guestfish -N bootroot and -N bootrootlv for creating boot+root disks.

commit 574df371a0421b4b83386f43e5095ccea5069e5b
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 8 10:24:01 2010 +0100

    fish: Add guestfish -N lvfs for creating formatted LVs.

commit 422a8d85d21fc29ee75d27917fd03a164048bfc9
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 8 09:58:37 2010 +0100

    fish: Add guestfish -N lv for creating disks with LVs.

commit 45f72c804b6fa76d94b7195bd5faea8c0d6f6b3d
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 8 10:23:28 2010 +0100

    fish: Improve appearance of guestfish -N help output.

commit fa918b166acd6123623fd0d03b5f4840b1579a02
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 8 09:37:22 2010 +0100

    fish: Allow guestfish -N help for listing prepared disk image help.

commit 60cdd02b02578b427ca3926d566811c6bb7a9970
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 8 09:05:18 2010 +0100

    fish: Generate list of prepared disk image types.
    
    This commit shouldn't change the semantics of the code.

commit 06c906168c0a96662ad47473cfe5f2fb3c316757
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Sep 6 10:13:31 2010 +0100

    test-tool: Add a 'run-test-tool-locally' script.
    
    This can be used to run the test tool without installing it.
    It sets the environment variables and command line arguments
    up correctly to run the tool from the build directory.

commit b76284876b9ab50b8aa5851fb960dbb66a58c2e2
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Sep 6 10:04:01 2010 +0100

    appliance: init script does 'ls -lR /dev' (verbose only)
    
    It's useful to see what files are in /dev subdirectories
    at boot, eg. for looking at virtio-serial ports.

commit aa96881a512a144f4611a8e7c9801be9bb7ff9cf
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Sep 6 10:03:38 2010 +0100

    daemon: Don't warn about 'long long' usage.
    
    This removes a fatal warning (-Werror) which stops compilation
    on 32 bit machines.

commit bd77c8d1b47d24619b48e8e2f3683c8ce324fca8
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Sep 5 16:51:45 2010 -0400

    php: Remove 'make clean' rule in subdirectory.

commit 56da696fc24fb2c398965d8cfc3c621dcfe06e9a
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Sep 4 12:45:42 2010 +0100

    Version 1.5.8.

commit 2c61e04c4599536fee771431fb1ebc8384523b2a
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Sep 3 12:15:00 2010 +0100

    PHP bindings.
    
    Note that these are not complete on 32 bit architectures.  PHP doesn't
    offer any convenient 64 bit type (on 32 bit).  Therefore you should
    always use these PHP bindings on 64 bit.

commit 2d8fd7dacd77361bc385be42112289faafb5c60d
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Sep 2 22:45:54 2010 +0100

    Define LIBGUESTFS_HAVE_<shortname> for C API functions.
    
    The actions each have a corresponding define, eg:
    
      #define LIBGUESTFS_HAVE_VGUUID 1
      extern char *guestfs_vguuid (guestfs_h *g, const char *vgname);
    
    However functions which are for testing, debugging or deprecated do
    not have the corresponding define.  Also a few functions are so
    basic (eg. guestfs_create) that there is no point defining a symbol
    for them.

commit 5fc69ce3ece5e4d4a3da9d78da244c4fa301b5ac
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Sep 2 22:27:35 2010 +0100

    build: guestfs-structs.h was missing from libguestfs_la_SOURCES.

commit 8ad79a7c4de406579cf38d938edf44a8b659d03a
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Sep 2 22:25:47 2010 +0100

    Add full docs pot file.

commit 8c48f5ae2ea5221f6c53934262c5505f4b20ca8c
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Sep 2 14:54:44 2010 +0100

    Allow manual pages and POD files to be translated.
    
    This uses the optional po4a package to split these files into
    PO files for translation, and reassemble afterwards.
    
    Note this creates an extra pot file (po-docs/libguestfs-docs.pot).
    We don't (yet) combine this with the main po/libguestfs.pot file.
    The 'libguestfs-docs.pot' file included in this commit is not the
    real thing, just a short cut down snippet for testing.  The real
    thing is created if you update one of the dependent files and
    rebuild.
    
    Note also the dummy ja.po, for testing the principles.

commit 1193df7e0abfa25a78de246b6be148ec09470623
Author: Geert Warrink <geert.warrink@onsnet.nu>
Date:   Thu Sep 2 14:56:36 2010 +0100

    Add Dutch translation (RHBZ#629593).

commit 25521f17d5b0841a13d66fc515fac0cffe23d9a1
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Sep 2 12:01:06 2010 +0100

    ruby: Add Guestfs::Guestfs.new() method.
    
    This is a more standard way to create objects in Ruby.  The old
    way was to call the module function Guestfs::create() which still
    works.

commit b8b0c99b46172712aa190f70182734934587af7b
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Sep 2 11:11:55 2010 +0100

    perl: Document handle is a hashref.
    
    For details see commit eb566f7dc7974b42ac65729a2e5e5bcee329a0a9.

commit 0f24424f357e854a9da382de11e4fe81305c8743
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Sep 2 10:58:28 2010 +0100

    perl: Add documentation about testing availability of methods and features.

commit 71f5cc5a2e2db613a99fe6b89278ce435e3a50d0
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 1 18:44:33 2010 +0100

    build: Link static -ltinfo into guestfish.static binary.

commit d8daebf3095aba66ca8d9ba9b9eb10b2eda7d31a
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 1 17:12:37 2010 +0100

    Version 1.5.7.

commit 231051474bcf3b3096d327a8853299e90139127d
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 1 18:10:41 2010 +0100

    fish: Add missing header file to sources.

commit d1485e02f538d50fd7d4790fb63317093ba8c6bf
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 1 17:12:15 2010 +0100

    ocaml: Add test for progress notification callbacks.

commit 8c37961b455cbc72d4879da65c6aafd332857f05
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 1 17:03:19 2010 +0100

    debug: Add 'debug progress' command.
    
    This debugging command generates progress notification messages,
    used for testing purposes.

commit 99679fe5a28efcee3be2406aeaf446b4e1a976df
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 1 15:38:15 2010 +0100

    debug: Arrange prototypes in alphabetical order.

commit 83f381f5ccfb7e86bfaaeeade9d06c9e54ddb0cf
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 1 15:37:24 2010 +0100

    daemon: Enable debug command by default.
    
    The debug command is useful for internal testing, and so should
    be enabled by default in all builds.
    
    Note that it is still *not* part of the stable ABI.

commit 867319ec5f9030d3c14c32e3302606f2bf11ac27
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 1 13:19:05 2010 +0100

    Consistent use of 'void *opaque' to refer to opaque pointer in C API.
    
    We inconsistently used 'void *data' or 'void *opaque' all over to
    refer to the same thing.  Use 'void *opaque' in all places in the
    published API and documentation.

commit c9bc865a7acf372a66f7c9a3f34440deb32f1ea9
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Aug 31 20:39:40 2010 +0100

    resize: Add progress bar to virt-resize.
    
    With this commit you will see a plain progress bar during the
    lengthy copy operations, similar to below:
    
    Summary of changes:
    /dev/sda1: partition will be left alone
    /dev/sda2: partition will be resized from 7.5G to 9.5G
    /dev/sda2: content will be expanded using the 'pvresize' method
    Copying /dev/sda1 ...
    [############################################################################]
    Copying /dev/sda2 ...
    [########################################------------------------------------]

commit 8ff17e1c9cf348c93ac731281b1e4a0d5fa7caf3
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Aug 31 20:14:17 2010 +0100

    perl: bindings to progress callback.

commit 3978a308a586e3a671807eb3716ba7c7596af21f
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Aug 31 17:04:52 2010 +0100

    ocaml: bindings to progress callback.

commit 4ea0abfce413767868a8f53b3d20e5d2f62dff08
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Aug 31 18:48:32 2010 +0100

    Implement private data area.
    
    The private data area is a hash table which is associated with
    libguestfs handles, that C callers may use to store arbitrary
    data for the lifetime of the handle.
    
    Later the OCaml bindings will use this in order to implement
    callbacks.

commit 54837f6d7ba83178625e2f0c3c063457d9f3f79c
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Aug 28 12:49:55 2010 +0100

    fish: Implement progress bars in guestfish.
    
    The progress bar is updated 3 times per second, and is not displayed
    at all for operations which take less than two seconds.
    
    You can disable progress bars by using the flag --no-progress-bars,
    and you can enable progress bars in non-interactive sessions with
    the flag --progress-bars.
    
    A good way to test this is to use the following command:
    
    guestfish --progress-bars \
              -N disk:10G \
              zero-device /dev/sda
    
    (adjust "10G" to get different lengths of time).

commit 3003df6bbc889c3939e6c478462dc4478d5b89f7
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Aug 28 12:48:49 2010 +0100

    fish: Detect UTF-8 output and open termcap/terminfo database.
    
    Provide a generic mechanism within guestfish to detect if
    output if UTF-8 and to open the termcap (or terminfo) database
    for the current terminal type.

commit 65510965b3475dd80bdbf042992298451dc2b67b
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 1 11:54:15 2010 +0100

    Add progress messages to download command.

commit 133a92be6948ff7e65bfecb7be70b15f4336d2af
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Aug 28 14:29:21 2010 +0100

    Add progress messages to zero-device command.

commit 88ab203e611694bc0d01aca745e8df18cb3f094e
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Aug 28 14:29:07 2010 +0100

    Add progress messages to zero command.

commit 55938405ccd3d5e5736f30c9bd78a51998cd7158
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Aug 28 14:28:42 2010 +0100

    Add progress messages to fill-pattern command.

commit 7f1ecfc87eb45cab401394b980e15f8981511627
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Aug 28 14:28:26 2010 +0100

    Add progress messages to fill command.

commit 41512f498b5f85a941ad165361b01135511fdd23
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Aug 28 11:11:32 2010 +0100

    Add progress messages to copy-size command.

commit e776a46ffcbede6d9b030dbc8f6ab32500b325ec
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Aug 28 10:33:24 2010 +0100

    Implement progress messages in the daemon and library.
    
    This implements progress notification messages in the daemon, and
    adds a callback in the library to handle them.
    
    No calls are changed so far, so in fact no progress messages can
    be generated by this commit.
    
    For more details, see:
    https://www.redhat.com/archives/libguestfs/2010-July/msg00003.html
    https://www.redhat.com/archives/libguestfs/2010-July/msg00024.html

commit a8a44cecbadfd21c7f0483f8c1cdb355d08960a4
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Aug 31 19:25:45 2010 +0100

    ocaml: Remove old entry from .gitignore file.

commit 377926be5bdadda3b149090c7a3a0d694552a9c3
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Aug 27 22:01:23 2010 +0100

    Version 1.5.6.

commit d46230f94e9e472938b61753a134371f8f290929
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Aug 27 21:47:49 2010 +0100

    Requires febootstrap >= 2.9.

commit d89a88d67e577ee6111820cb44c3440b7772608d
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Aug 27 15:27:22 2010 +0100

    daemon: Set O_CLOEXEC flag on the virtio-serial file descriptor.

commit 4932fdca3ca1e9002164a1c0b73876f32739d34d
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Aug 27 13:38:49 2010 +0100

    build: Don't add version extra string to the version number.
    
    If this string was non-empty, then it broke a lot of things because
    autoconf and other parts of the build system were expecting this
    string to contain a simple MAJOR.MINOR.RELEASE version number.
    
    This requires changes to guestfish and guestmount so they use the
    guestfs_version API to fetch the version from the library.  (The
    Perl tools were already doing it this way).  In a way this is more
    accurate, because it's no longer hard-coded in the binary, but
    fetched from the dynamically linked libguestfs.so.

commit 1c523760d32b9e4db8441fc11d59539e213635b5
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Aug 26 16:42:53 2010 +0100

    Update BUGS, PO files.

commit b59aff0bae7a0c564d0af500bc966a3fd972fd09
Author: Daniel Cabrera <logan@fedoraproject.org>
Date:   Thu Aug 26 16:40:44 2010 +0100

    Update Spanish translations (RHBZ#627556).

commit 3f7965b6deb7f0b8886728446e320bac6d1212c9
Author: Daniel Cabrera <logan@fedoraproject.org>
Date:   Thu Aug 26 16:39:39 2010 +0100

    Updated Spanish translations (RHBZ#626843).

commit 9bc72e2f9b988f73f38561fd3802a16a636f1f6e
Author: Piotr Drąg <piotrdrag@gmail.com>
Date:   Thu Aug 26 16:38:11 2010 +0100

    Update Polish translation (RHBZ#502533).

commit 92876a49db8ffbdf3a44d3680c6a8930b4db5cd5
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Aug 26 16:31:40 2010 +0100

    Prepare for version 1.5.5.

commit daead56fae46a4fedfef176fa3ed1ba37f88a078
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Aug 26 15:55:34 2010 +0100

    rescue: Fix typo in comment.

commit c3194e4d370d917db9900a31ea18f10492554da4
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Aug 26 15:08:20 2010 +0100

    Ignore launch() error in virt-rescue. (RHBZ#618556)
    
    launch() expects guestfsd to start, which it never does in virt-rescue, so it
    always returns an error about the appliance shutting down unexpectedly.

commit d3fc7e1e4d592dbdc6b8b9edf92dddc0a67eac28
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Aug 26 14:34:44 2010 +0100

    Shut down the appliance cleanly
    
    When guestfsd exits, or the user exits the virt-rescue shell, the init script
    exits which causes the kernel to panic. This isn't really a functional issue, as
    all useful work is done by this point. However, it does cause virt-rescue to
    display an unsightly error message.
    
    This patch causes the appliance to power off cleanly before the init script
    exits. Note it actually does a reboot rather than a poweroff. This is because
    ACPI is disabled in the appliance, meaning poweroff doesn't work, but qemu is
    configured not to restart on reboot.

commit c0b38fbb27c8771916386f47361833722d54518f
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Aug 26 12:11:59 2010 +0100

    Call sync after guestfsd exits
    
    Core files are not reliably written to disk if guestfsd dumps core. This patch
    makes libguestfs do the same appliance cleanup for guestfsd and virt-rescue,
    which seems to fix the matter.
    
    It also removes a redundant sleep and additional sync when exiting virt-rescue.

commit a45302cb8a0ee3b4ffd0656b24a06ebdf7b50f38
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Aug 26 13:36:10 2010 +0100

    Add a core_pattern debug command
    
    This adds a new debug command, core_pattern, which writes a new pattern for
    coredump files to the appliance kernel, and sets the daemon's hard and soft core
    limits to infinity.

commit a0d514f13d3334b79745d7d1f90a6ac615afa7c2
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Aug 25 11:53:00 2010 +0100

    Include statically linked binaries in the binary distribution.

commit 27ef6f9171127afd248f38d280cf3d0eae51fdaf
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Aug 25 11:41:17 2010 +0100

    Rename global 'xdr_str'.
    
    Two bits of XDR both contained a definition called 'str' which
    means that 'xdr_str' was being exported globally twice.  Because
    of the linker script this didn't affect us.  But it's best to
    rename this global so that conflicts cannot arise.

commit 6d15d4e7c27477507ba355384a340ce86cec617b
Author: Daniel Berrange <berrange@redhat.com>
Date:   Tue Aug 24 14:27:15 2010 +0100

    Add -nodefconfig command line option to qemu.
    
    Without this option, qemu will read some defaults from /etc/qemu/
    configuration files.

commit e503b31c15117a82abfe9dd4ba560ea6d03e45ca
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Aug 24 12:37:39 2010 +0100

    Version 1.5.4.

commit 4963be850090933e5769f9d3412d9eb86f522b1b
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Aug 24 11:53:40 2010 +0100

    New APIs: set-network and get-network to enable network support.
    
    guestfs_set_network (g, true) enables network support in the appliance.

commit 10d1aa3b64f61408bb092d998fb8c5f453a7749c
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Aug 24 11:19:55 2010 +0100

    build: Add 'bindist' rule for building binary distribution.

commit 5c1346dae72064f7fd9c2afe5517afc6f050cd9a
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Aug 23 22:58:51 2010 +0100

    Don't print debug messages when not in verbose mode.
    
    Don't print them because no one's listening ...

commit 831b1fc1805e8450202b5c2cf9ab17a163ab0cc5
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Aug 23 22:19:24 2010 +0100

    Change protocol to send Linux errno from daemon to library.
    
    This changes the protocol so that the Linux errno (if available)
    is sent back to the library.  Note that the errno is not yet
    made available to callers, since it is not clear how best to
    present this Linux-specific number.

commit 90d06e28888d9a492560ca986dca0708f881d173
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Aug 23 22:14:27 2010 +0100

    Raise error message max size to 64K.
    
    This commit removes one of the protocol limits, by raising the
    maximum error message size from 256 bytes to 64K.
    
    Although we could consider raising this further, since the
    error messages are currently stored in fixed sized buffers on
    the stack, that would require more invasive code changes.

commit 866ec00d1f8bc40042795b66ceec12608bb1f9e8
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Aug 23 21:53:32 2010 +0100

    Use virtio-serial, remove other vmchannel methods.
    
    This adds support for virtio-serial, and removes all other
    vmchannel methods.
    
    Virtio-serial is faster than other methods, and is now widely
    available.
    
    I tested this by using the guestfs_upload API on an 83 MB file:
      before: 6.12 seconds (14.1 MB/sec)
       after: 4.20 seconds (20.6 MB/sec)
    (note this is with the current 8K chunk size)

commit 5c31f6126ba4ea3e9056c34c300f6f5e332ab997
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Aug 23 11:12:29 2010 +0100

    Change to using ext2-based, cached supermin appliance.
    
    This changes the method used to build the supermin appliance
    to use the new ext2-based appliance supported by latest febootstrap.
    The appliance can also be cached, so we avoid rebuilding it
    each time it is used.
    
    Mailing list discussion goes into the rationale and details:
    https://www.redhat.com/archives/libguestfs/2010-August/msg00028.html
    
    Requires febootstrap >= 2.8.

commit 4b753c62089be663ac722e4a875bb061d259e87d
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Aug 23 12:54:27 2010 +0100

    Make print_timestamped_message into a cross-module function.
    
    This is just code movement.

commit a2d4a8bf073c3551d174bd6c406e0cf3d27fb560
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Aug 23 12:53:11 2010 +0100

    Factor out code for locating the temporary directory.
    
    This is just code movement.

commit 4d2f1632ad655130fafab3bf7fe8fa5cb59705d8
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Aug 21 12:45:51 2010 +0100

    Whitespace change: Add blank line between structures and functions.

commit c56fa58721a710aeb4a41bd73a472354a2128069
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Aug 21 10:39:39 2010 +0100

    appliance: Remove some obsolete testing rules from Makefile.am
    
    This haven't been used -- and haven't worked -- for a long time.

commit 83c221764d0f74a792790c1eca1f6b3f699fa8b6
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Aug 17 14:30:58 2010 +0100

    Version 1.5.3

commit ad373a4d6c2367b78b0dd337c1797f889a94b713
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Aug 2 23:29:43 2010 +0100

    Remove old ocaml-inspector code.
    
    Not used by anyone, didn't work well, and replaced now by the
    C inspection APIs.

commit 4440e22f4f7ebffe0728a8c019319d1a2b260cf5
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Aug 2 17:43:23 2010 +0100

    fish: Reimplement -i option using new C-based inspection.
    
    Don't shell out to virt-inspector.  Instead, use the new C-based
    inspection APIs.
    
    This is much faster.
    
    The new syntax is slightly different:
    
      guestfish -a disk.img -i
      guestfish -d guest -i
    
    However, the old syntax still works.

commit 1a9aa565b38eafe48621bc2fe42d35ea6a907708
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Aug 2 16:33:25 2010 +0100

    fish: Add -c/--connect and -d/--domain options.
    
    The -d option lets you specify libvirt domains.  The disks from
    these domains are found and added, as if you'd named them with -a.
    
    The -c option lets you specify a libvirt URI, which is needed
    when we consult libvirt to implement the above.

commit 8289aa1ad68ec94c87fc4d538f638d8816052d92
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jul 28 15:40:42 2010 +0100

    New APIs for guest inspection.
    
    This commit converts (some of) the Perl inspection code to C and
    makes it available through core APIs.  The new APIs are:
    
    inspect-os        - Does the inspection, returns list of OSes
    inspect-get-*     - Get results of the inspection
    
    where '*' is one of:
    
      type            - 'windows' or 'linux'
      distro          - Linux distro
      arch            - architecture
      product-name    - long product name string
      major-version
      minor-version   - major.minor version of OS
      mountpoints     - get a list of the mountpoints
      filesystems     - get all filesystems associated with the OS
    
    This works for all existing supported Linux and Windows OSes.

commit 65e9ac4595fbace8f301030469932be518456246
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jul 28 23:11:38 2010 +0100

    New APIs: findfs-label and findfs-uuid
    
    These two calls wrap up the /sbin/findfs command, allowing you
    to find a filesystem by only knowing its label or UUID.
    
    This is especially useful when resolving LABEL=... or UUID=...
    entries in /etc/fstab.
    
    Sample guestfish session:
    
    ><fs> vfs-uuid /dev/vda1
    277dd61c-bf34-4253-a8dc-df500a05e7df
    ><fs> findfs-uuid 277dd61c-bf34-4253-a8dc-df500a05e7df
    /dev/vda1
    ><fs> vfs-label /dev/vda1
    /boot
    ><fs> findfs-label /boot
    /dev/vda1
    ><fs> vfs-uuid /dev/VolGroup00/LogVol00
    40ce7c36-82ce-4a12-a99d-48f5e054162c
    ><fs> findfs-uuid 40ce7c36-82ce-4a12-a99d-48f5e054162c
    /dev/mapper/VolGroup00-LogVol00
    ><fs> findfs-uuid 12345678
    libguestfs: error: findfs_uuid: findfs: unable to resolve 'UUID=12345678'

commit ad4cff2625651bda9de25de9aba96bdf213d0a0a
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jul 28 15:38:57 2010 +0100

    New API: file-architecture
    
    This change simply converts the existing Perl-only function
    file_architecture into a core API call.  The core API call is
    written in C and available in all languages and from guestfish.

commit 3cd272fc6acb043b4002dbcbbf741cecbc4820be
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Aug 17 11:26:54 2010 +0100

    generator: No need to redefine safe_* macros.
    
    These are already defined in "guestfs-internal.h" which is
    included in the .c file.

commit 3905cc7ab496549b6ca0a0f67ec61d1d16968c33
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Aug 17 11:26:26 2010 +0100

    Add safe_strndup call.

commit 64d70228c704c49a023ab35499d003e9bb09cd73
Author: Matthew Booth <mbooth@redhat.com>
Date:   Tue Aug 17 12:19:05 2010 +0100

    Send trace output to stderr.
    
    Trace output sent to stdout can be lost in the event of a crash due to
    buffering.  This patch sends it to stderr instead.

commit 834077946a4a7a44bf7f0e5d19aa1d54d39022a4
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Aug 17 10:31:39 2010 +0100

    Python: Use new PyCapsule API where supported.
    
    See:
    http://lists.fedoraproject.org/pipermail/devel/2010-August/141064.html

commit 29925244c1be2d1d5f71d46eba205278624a1366
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Jul 31 14:35:07 2010 +0100

    generator: Fix typo in error message for RConstOptString.

commit 6280ac9b987c14f89749b4b4fdfec5a647567432
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jul 30 16:32:35 2010 +0100

    New API: is-lv: check if a block device is a logical volume (RHBZ#619793)
    
    This adds a new API, guestfs_is_lv (g, device), which returns true iff
    the named device is an LVM2 logical volume.
    
    A sample guestfish session:
    
    ><fs> lvs
    /dev/vg_f13x64/lv_root
    /dev/vg_f13x64/lv_swap
    ><fs> list-devices
    /dev/vda
    ><fs> list-partitions
    /dev/vda1
    /dev/vda2
    ><fs> is-lv /dev/vg_f13x64/lv_root
    true
    ><fs> is-lv /dev/vg_f13x64/lv_swap
    true
    ><fs> is-lv /dev/vda
    false
    ><fs> is-lv /dev/vda1
    false
    ><fs> is-lv /dev/vda2
    false

commit 737181bcd7b1de8c3a613d6282030c34efa78fb6
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jul 28 12:38:36 2010 +0100

    Rename internal functions.
    
    This is an update to commit 41f25ab3df5f306ac717fa7a6efd58328d30c1ae.
    
    Internal functions should be named guestfs___* (3 underscores) to
    avoid clashing with the implementation of actions (2 underscores).

commit 41f25ab3df5f306ac717fa7a6efd58328d30c1ae
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jul 27 13:01:39 2010 +0100

    Rearrange library code into separate files.
    
    We split the library code into these separate files:
    
     - guestfs.c: creating handles, closing handles, handle-related variables
     - actions.c: generated library-side stubs for each action
     - bindtests.c: generated code to test bindings
     - launch.c: launching the appliance
     - proto.c: the library side of the daemon communications protocol
    
    This is just code movement.

commit a617f521a4f695a63ced1c734128dc6c05b7024f
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jul 27 12:29:59 2010 +0100

    Rename guestfs-{actions,bindtests}.c to {actions,bindtests}.c
    
    Rename these two generated files, in preparation for splitting
    up the main src/guestfs.c file.

commit d30176ddbe44549cbdb637fb5725ad8a57c7ca57
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jul 27 11:11:42 2010 +0100

    TODO: Implement inspector code in C.

commit b42d34be04e5b3cfb809bd3b41508812b522b1d9
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jul 27 11:11:09 2010 +0100

    TODO: Implement recursive upload/download in guestfish.

commit 4a7d8cd5ce082ce770376e650a273d00dd73b5aa
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jul 27 11:10:32 2010 +0100

    TODO: Add link to discussion of progress bars.

commit cd773b0707ff26cd128cc37e21ae1456e67060e2
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jul 22 16:53:54 2010 +0100

    Version 1.5.2.

commit e7ee6eebed6ee3a5b56c0482ba2770e697d8febc
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jul 22 16:49:06 2010 +0100

    regressions: Don't print misleading 'Expect error ...' lines.
    
    Some tests in the regressions directory deliberately print
    error messages.  As long as they still PASS, this is OK.
    
    However these tests also printed some misleading messages
    about what error to expect.  Since error messages were slightly
    different across distros, these messages were not accurate.
    
    Therefore remove these messages, and replace with a general
    message before all tests telling users not to worry about
    errors from the tests as long as the tests don't fail.

commit 945e569db64ab2608b21feba0aa94044c9835ac3
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jul 22 11:00:59 2010 +0100

    New APIs: Support for creating LUKS and managing keys.
    
    This commit adds four APIs for creating new LUKS devices
    and key management.  These are:
    
      luks_format         Format a LUKS device with the default cipher.
      luks_format_cipher  Format with a chosen cipher.
      luks_add_key        Add another key to an existing device.
      luks_kill_slot      Delete a key from an existing device.
    
    This enables all the significant functionality of the
    cryptsetup luks* commands.
    
    Note that you can obtain the UUID of a LUKS device already
    by using vfs-uuid.
    
    This also includes a regression test covering all the LUKS
    functions.

commit 2fd8c259d3daa88b0cdf98090bb57f3dbd178432
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jul 22 16:51:05 2010 +0100

    Move variable initialization close to variable use.

commit 799d52be4f08f6c70c0e8ba1aa7367ba4cdd78c4
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jul 22 14:39:36 2010 +0100

    Revert "add_drive_ro adds readonly=on option if available." (RHBZ#617200).
    
    Adding the readonly=on option is not so clever.  This causes
    qemu to present the disk as read-only to the guest.  (The
    expected behaviour of snapshots=on,readonly=on was that it
    would open the disk O_RDONLY but present a writable disk to
    the guest).
    
    Since the guest sees a read-only disk, we are unable to do any
    recovery if a filesystem on the disk is inconsistent.  This basically
    prevents most accesses to live disk images.
    
    What we really want is a qemu option which presents a writable
    disk to the guest, but only opens the disk on the host side with
    O_RDONLY, to alleviate the udev bug RHBZ#571714.
    
    This reverts commit 676462684e05dd8341dd695762dd99a87d8ec022.

commit 2a286f16215ebfac88a32d259f2b68191eb8d27e
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jul 22 10:59:43 2010 +0100

    generator: Make documentation inside guestfish match man page.

commit e67298ce806c75b687e1812168bfa5aa19a83302
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jul 21 21:40:21 2010 +0100

    Version 1.5.1.

commit 637f8df83726ab9b50e8a6d2181bd1e0e93ec13e
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jul 21 19:50:06 2010 +0100

    New APIs: Support for opening LUKS-encrypted disks.
    
    This adds support for opening LUKS-encrypted disks, via
    three new APIs:
    
      luks_open:    Create a mapping for an encrypted disk.
      luks_open_ro: Same, but read-only mapping.
      luks_close:   Close a mapping.
    
    A typical guestfish session using this functionality looks
    like this:
    
      $ guestfish --ro -a encrypted.img
      ><fs> run
      ><fs> list-devices
      /dev/vda
      ><fs> list-partitions
      /dev/vda1
      /dev/vda2
      ><fs> vfs-type /dev/vda2
      crypto_LUKS
      ><fs> luks-open /dev/vda2 luksdev
      Enter key or passphrase ("key"):
      ><fs> vgscan
      ><fs> vg-activate-all true
      ><fs> pvs
      /dev/dm-0
      ><fs> vgs
      vg_f13x64encrypted
      ><fs> lvs
      /dev/vg_f13x64encrypted/lv_root
      /dev/vg_f13x64encrypted/lv_swap
      ><fs> mount /dev/vg_f13x64encrypted/lv_root /
      ><fs> ll /
      total 132
      dr-xr-xr-x.  24 root root  4096 Jul 21 12:01 .
      dr-xr-xr-x   20 root root     0 Jul 21 20:06 ..
      drwx------.   3 root root  4096 Jul 21 11:59 .dbus
      drwx------.   2 root root  4096 Jul 21 12:00 .pulse
      -rw-------.   1 root root   256 Jul 21 12:00 .pulse-cookie
      dr-xr-xr-x.   2 root root  4096 May 13 03:03 bin
    
    NOT included in this patch:
    
     - An easier way to use this from guestfish.
     - Ability to create LUKS devices.
     - Ability to change LUKS keys on existing devices.
     - Direct access to the /dev/mapper device (eg. if it contains
       anything apart from VGs).

commit 581a7965faa5bf242ab3f8b7c259ab17c2e967f4
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jul 21 12:52:51 2010 +0100

    generator: Add 'Key' parameter type.
    
    Add a 'Key' parameter type, used for passing sensitive key material
    into libguestfs.
    
    Eventually the plan is to mlock() key material into memory.  However
    this is very difficult to achieve because the encoded XDR strings
    end up in many places.  Therefore users should note that key material
    passed to libguestfs might end up in swap.
    
    The only difference between 'Key' and 'String' currently is that
    guestfish requests the key from /dev/tty with echoing turned off.

commit 2e7da2a2f3bbc6d6db148d7dc2ce238bf56f34db
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jul 21 12:52:10 2010 +0100

    generator: Remove unnecessary parameter.
    
    The 'name' parameter is not used on the right hand side of the
    match, so it can be removed.

commit 45a4cd79215752234c4a5a47fb4c9c6741b1594c
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jul 16 18:11:56 2010 +0100

    df: Minimize the number of times we launch the libguestfs appliance.
    
    This commit greatly improves the performance of the 'virt-df'
    command by batching as many disks as possible onto a single appliance.
    In many situations this means the appliance is launched only once,
    versus one launch per domain as before.
    
    However doing it this way is a lot more complex:
    
    (1) Because of limits in Linux and virtio-blk, we can only attach
    26 disks maximum at a time to the appliance.
    
    (2) We have to use LVM filters (lvm-set-filter) to confine LVM to
    the disks of a single guest.

commit d2cf9a15a9f22623dbbed33fb66c5077f1275df2
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jul 16 13:01:21 2010 +0100

    New APIs: lvm-set-filter and lvm-clear-filter.
    
    These APIs allow you to change the device filter, the list of
    block devices that LVM "sees".  Either you can set it to a fixed
    list of devices / partitions, or you can clear it so that LVM sees
    everything.

commit 321ca1ef91a90cec5b94058b84420e8018e3f1d8
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jul 16 12:58:54 2010 +0100

    Use an unsigned type (size_t) for all loop iterators.
    
    This resolves a warning from gcc 4.5:
      assuming signed overflow does not occur when simplifying
        conditional to constant
    
    This page explains the issues in some detail:
      http://www.airs.com/blog/archives/120

commit aac51942aab63a9355ad6724345ea923148bf2a9
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jul 16 12:57:24 2010 +0100

    generator: Don't hard-code name in DeviceList check.
    
    Only one function currently uses DeviceList.  The generated code
    unfortunately hard-coded the argument name from that function.

commit 0c0976496dafda4d172c5a7fc787d6a87d5bce8d
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jul 16 12:55:17 2010 +0100

    build: Don't warn about 'long long'.
    
    Various language bindings simply need this, so we have to allow
    it even though it's a GCC extension.

commit 5b77be72bc4e46c7a53a24f1eb4cbd107a708f17
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jul 16 15:17:01 2010 +0100

    doc: Add guestfish 'lvcreate 1M' gotcha.

commit 70d27f6e796097630134bd8ebc2b65a65b1bf5c4
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Jul 11 23:11:45 2010 +0100

    tar: Remove redundant use statement.

commit 10ea14a3f1adb7023dd0601e4759bd24a030a1c3
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Jul 11 23:11:08 2010 +0100

    edit: Clean up temporary files.
    
    Note to self: The 'tempfile' function does *not* default to
    removing files with the program exits!

commit fed8714b92b57da1a593f74b52635fd267442d5b
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Jul 11 23:09:07 2010 +0100

    edit: Add -b (backup) option and make uploading more robust.

commit 8f6d8b05152fda68e0c01848c0e5239e0093548a
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Jul 11 16:46:15 2010 +0100

    edit: Add -e 'expr' option to non-interactively apply expression to the file.
    
    (Suggested by Justin Clift).

commit 58667f2be077a4b05c9c640d58fb946b52ef2e88
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jul 8 11:54:50 2010 +0100

    Prepare for new development branch, starting at 1.5.0.
    
    Add BUGS and RELEASE-NOTES to EXTRA_DIST.
    
    Also update the RELEASE-NOTES file.

commit 49a71a4c606d52f78c364860a8917cf1076169e7
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jul 2 17:52:51 2010 +0100

    Make tmp directory world readable (RHBZ#610880).
    
    If you have a restrictive umask (0077 for example) then
    files in the tmp directory would be created with 0600
    permissions.  Example:
    
    drwx------.  2 rjones rjones     4096 Jul  2 17:52 .
    drwxrwxrwt. 57 root   root     102400 Jul  2 17:52 ..
    -rw-------.  1 rjones rjones 86328832 Jul  2 17:52 initrd
    lrwxrwxrwx.  1 rjones rjones       46 Jul  2 17:52 kernel -> /boot/vmlinuz-2.6.33-0.40.rc7.git0.fc13.x86_64
    
    This in itself is not a problem.  However in virt-v2v we also
    change UID:GID and the result is that qemu is unable to read
    the initrd file:
    
    qemu: could not load initial ram disk '/tmp/libguestfs2ssynP/initrd'
    
    With this patch we make the tmp directory and the files
    world readable.  After the patch:
    
    $ ls -la /tmp/libguestfsJFVzPg/
    total 116192
    drwxr-xr-x.  2 rjones rjones      4096 Jul  2 18:03 .
    drwxrwxrwt. 56 root   root      102400 Jul  2 18:03 ..
    -rw-r--r--.  1 rjones rjones 118869504 Jul  2 18:03 initrd
    lrwxrwxrwx.  1 rjones rjones        46 Jul  2 18:03 kernel -> /boot/vmlinuz-2.6.33-0.40.rc7.git0.fc13.x86_64

commit 8161ea9bb046c8450384b5b15e1f4b2f3dca582b
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jul 7 15:01:38 2010 +0100

    fish: Don't fail if -m and --listen flags are both given (RHBZ#612178).
    
    Testing this against a Fedora disk image:
    
    $ ./fish/guestfish --ro -a F13.img -m /dev/sda1 --listen
    export GUESTFISH_PID=6033
    $ ./fish/guestfish --remote=6033 -- ping-daemon
    $ ./fish/guestfish --remote=6033 -- ping-daemon
    $ ./fish/guestfish --remote=6033 -- exit
    
    Without this fix the first remote command would fail because
    qemu would have already been killed.

commit cf9e01508d48b752a29df4fceb95ed5306651fe2
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jul 2 20:12:41 2010 +0100

    todo: Add comment about progress of long-running operations.

commit 015b7a2ee6b4ba0f1400640fa16e2526a69d081e
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jul 2 10:50:38 2010 +0100

    inspector: Improve error message when YAML::Any library is not installed.

commit 9928498ad87ed1d7a1c191d5637d36d5f9b09ee4
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Jun 28 13:51:42 2010 +0100

    Explicitly depend on e2fsprogs.
    
    See: http://lists.fedoraproject.org/pipermail/devel/2010-June/137953.html

commit 61adbba900a4150110d9fcd20097b3a5c249e6c7
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Jun 28 09:13:36 2010 +0100

    Fix gfs2 support by adding required kernel modules.

commit 02b3ed7a4a5d1f51b6264e2e094194354a5e4401
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jun 16 16:12:52 2010 +0100

    Version 1.3.21.

commit 1079f74704a06c06996e547fdecf20a8f92799c6
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jun 16 15:25:45 2010 +0100

    ocaml: Fix thread safety of strings in bindings (RHBZ#604691).
    
    There's a thread safety issue with the current OCaml bindings which
    is well explained in the bug report:
    
    https://bugzilla.redhat.com/show_bug.cgi?id=604691
    
    This commit fixes the safety issue by copying strings temporarily
    before releasing the thread lock.  Updated code looks like this:
    
      char *filename = guestfs_safe_strdup (g, String_val (filenamev));
      int r;
    
      caml_enter_blocking_section ();
      r = guestfs_add_drive_ro (g, filename);
      caml_leave_blocking_section ();
      free (filename);
      if (r == -1)
        ocaml_guestfs_raise_error (g, "add_drive_ro");
    
    Also included is a regression test.

commit 1e568f057e8bb7b36cc14e0e531d74b75ad9cb6c
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jun 16 14:29:39 2010 +0100

    TODO: Add a note about impl of list-filesystems.

commit e832959a4d5645cb0168bd7b810d5cfcd6767168
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jun 15 11:15:30 2010 +0100

    todo: More ideas for TODO list.

commit 2ce51fda79ac406b27e27a3ccb65f115f5660c81
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jun 15 11:15:06 2010 +0100

    Update Spanish translations (RHBZ#603870).

commit e67e216118df3a724482cb698a868ecbaacbf326
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jun 11 10:40:48 2010 +0100

    perl: Check all images are defined in first param of open_guest.

commit eb566f7dc7974b42ac65729a2e5e5bcee329a0a9
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jun 10 15:25:43 2010 +0100

    perl: Add explicit close() method (RHBZ#602592).
    
    This add an optional explicit $g->close method which may be
    used to force the handle to be closed immediately.  Note the
    provisos about this method in the manual page entry.  Callers
    should *not* normally use this method.
    
    The implementation of the handle also changes.  Before, the
    handle was a blessed reference to an integer (the integer
    being the pointer to the C guestfs_h handle).  Now we change
    this to a hashref containing currently the following field:
    
      _g => pointer to C guestfs_h handle (as an integer)
    
    If this field is not present, it means that the handle has been
    explicitly closed.  This avoids double-freeing the handle.
    
    The user may add their own fields to this hash in order to store
    per-handle data.  However any fields whose names begin with
    an underscore are reserved for use by the Perl bindings.
    
    This commit also adds a regression test.
    
    This commit also changes the existing warning when you call
    a method without a Sys::Guestfs handle as the first parameter,
    into an error.  This is because such cases are always errors.

commit dbfd93b72f99ebdded394541a48177c415db8cbf
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jun 10 12:38:57 2010 +0100

    Add error callback (RHBZ#602599).
    
    Read the note in the man page before using this feature.

commit 91b00dc092be17a309f14fc35f41dbf1e41c4c58
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jun 10 12:26:06 2010 +0100

    Fix typo in documentation of guestfs_set_launch_done_callback.

commit 4dad67b6839e758dfbb0a8499fb96b3392b3a37b
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jun 8 18:17:37 2010 +0100

    Version 1.3.20.

commit a043b6854a0c4c40726746c0e29d2a183b25ec62
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jun 8 18:17:46 2010 +0100

    Revert "perl: Rerun configure if MAX_PROC_NR changes."
    
    This reverts commit f8ee7869f4836427109959cf20e299a31fa86eaf.

commit d706d7d40e81abac28eb00f8b103db28a282f854
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jun 8 18:12:32 2010 +0100

    TODO: Freeze/thaw filesystems.

commit 6e9b06d99058bdd4d8792506054ec3cd8cb8c736
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jun 8 18:11:16 2010 +0100

    TODO: Need to add regression test for virt-inspector.

commit 899420256134866605a977425aa927ebc4bb6f3f
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jun 8 18:04:17 2010 +0100

    TODO: 'file' command should be fixed.

commit aaf03a51a26ee501f5dbf2720bbb8a5e3b4e1e6b
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jun 8 16:44:18 2010 +0100

    virt-df: Disallow -h and --csv options together (RHBZ#600977).
    
    Before this commit, if you used the -h and --csv options together
    you would get these warnings from virt-df:
    
    $ virt-df -h --csv Guest
    Virtual Machine,Filesystem,Size,Used,Available,Use%
    Argument "13.5G" isn't numeric in printf at /home/rjones/d/libguestfs/tools/virt-df line 298.
    Argument "4.7G" isn't numeric in printf at /home/rjones/d/libguestfs/tools/virt-df line 298.
    Argument "8.1G" isn't numeric in printf at /home/rjones/d/libguestfs/tools/virt-df line 298.
    "/dev/vg_trick/RHEL55x64","/dev/VolGroup00/LogVol00",13,4,8,34.8%
    Argument "98.7M" isn't numeric in printf at /home/rjones/d/libguestfs/tools/virt-df line 298.
    Argument "18.8M" isn't numeric in printf at /home/rjones/d/libguestfs/tools/virt-df line 298.
    Argument "74.9M" isn't numeric in printf at /home/rjones/d/libguestfs/tools/virt-df line 298.
    "/dev/vg_trick/RHEL55x64","/dev/vda1",98,18,74,19.0%
    
    We could fix this so that the human-readable numbers get written
    into the CSV file.  However would probably be wrong for most uses
    of the CSV format (databases and spreadsheets) since they would not
    be able to interpret these human-readable numbers, or worse could
    misinterpret, eg. thinking that "1M" and "1G" are both 1.
    
    Therefore this commit disallows this combination of options.

commit ba39ced8804765705f4c61a92db0fddb8d672c7d
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jun 8 16:04:01 2010 +0100

    file: Fix file command on /dev/VG/LV paths (RHBZ#582484).
    
    Previous commit 4df593496e116dfb635731c058b7627e81fc179c broke the
    "file" command on logical volume paths, since these are symbolic
    links.  We *should* follow these (only).
    
    This inadvertantly broke virt-inspector too, which indicates that
    we need more regression testing in this area.  Since carrying whole
    Fedora images around could make the distribution even larger than
    now, I'm not sure at the moment how to do this.
    
    Thanks to Matt Booth for diagnosing this bug.

commit 1253f577fa162b9170b22f3c543167aa99795920
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Jun 7 15:29:31 2010 +0100

    Use the noop scheduler inside the appliance.
    
    In my limited tests, this seems to make a small but noticable
    difference, improving the performance of some straightforward
    read operations by a little over 10%.
    
    For more information see:
    http://kbase.redhat.com/faq/docs/DOC-5428

commit 1fd03b8400635d9c62ec0d635984128868e5bb63
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jun 4 18:44:49 2010 +0100

    Add release notes.
    
    To generate the "Bugs fixed" list, run the bugs-in-changelog script
    like this:
    
      ./bugs-in-changelog 1.0.89..

commit 6c27155621f75351a3b18237ac7631f0eb12c336
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jun 4 16:38:55 2010 +0100

    Version 1.3.19.
    
    Update BUGS and PO files.

commit 4df593496e116dfb635731c058b7627e81fc179c
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jun 4 11:45:06 2010 +0100

    file: Restrict to regular files (RHBZ#582484).
    
    The file call can hang if called on char devices (because we are
    using the file -s option).
    
    This is hard to solve cleanly without adding another file API.
    
    However this restricts file to regular files, unless called explicitly
    with a /dev/ path.  For non-regular files, it will now return a
    string like "directory".
    
    There is a small semantic change for symbolic links.  Previously
    it would not have worked at all on absolute links (or rather, the
    results would have been undefined).  It would have treated relative
    symlinks to regular files as the regular file itself.  Now it will
    return the string "symbolic link" in both cases.
    
    This commit also makes the API safe when called on untrusted
    filesystems.  Previously a filesystem might have been set up so
    that (eg) /etc/redhat-release was a char device, which would have
    caused virt-inspector and virt-v2v to hang.  Now it will not hang.

commit 74958b0ad44df6ed703cd3009983d04ade3a8e93
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jun 4 11:55:54 2010 +0100

    touch: Restrict touch to regular files only (RHBZ#582484).

commit e3befe5a2e85179dcc5a52aa7d74b9cc5f3430ec
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jun 4 11:23:01 2010 +0100

    daemon: Rearrange code in 'file' command.
    
      path = path to access file (/sysroot/.. or /dev/..)
      display_path = original path, saved so we can display it
      buf = optional buffer which is freed along return codepaths
    
    There should be no change to the semantics of the code.

commit 32f48cc3330a50b7b9e2af7db0f0470da209bb6f
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jun 4 11:21:58 2010 +0100

    gnulib: Ignore asm-underscore.m4 in the correct place.

commit 00cc40a5f3304ff940fed302107067945177f31f
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jun 4 09:46:34 2010 +0100

    Update to latest gnulib.

commit 4d5c22800214008b229e937dada2299de8353d9e
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jun 3 14:03:08 2010 +0100

    mkfs-b: Map block size to cluster size for VFAT and NTFS partitions (RHBZ#599464).
    
    This also adds a regression test for VFAT and (conditionally)
    NTFS filesystems.

commit 0606cb54671e10f104b4eba1c70378ef8725322b
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jun 3 14:01:18 2010 +0100

    mkfs-b: Check that blocksize parameter is > 0 and a power of 2.

commit f9d08600c52dc0730e7dad8d9259b59e32aeece2
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jun 3 14:31:58 2010 +0100

    generator: Allow individual tests to depend on daemon features.
    
    Using IfAvailable "featurename" we allow individual tests to
    only run if the feature is available in the daemon.
    
    This will allow us to extend testing to a lot more optional
    features such as NTFS.

commit cbe80b2bcfdee437d195f25aaf6f5d96329ab360
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jun 3 14:30:36 2010 +0100

    tests: Factor out common code into 'is_available' function.
    
    This commit is just code motion.

commit 8fca8549edb1581448fa45d08d90bad399c5dbfa
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jun 3 11:49:38 2010 +0100

    grub-install: Enable grub-install tests and create explicit device.map file.

commit dccd9b8f525cfae49b89c38066d752e6c054c7f6
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jun 3 11:48:41 2010 +0100

    grub-install: In docs suggest manually creating device.map (RHBZ#484986).

commit fbe0802f9d237837d10026471186b1ef973c0877
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jun 2 18:47:30 2010 +0100

    Version 1.3.18.
    
    Update BUGS and PO files.

commit ac37f65aaf1f162a2cc57fa8c296a1ff4109adb9
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jun 2 17:12:59 2010 +0100

    RHEL 6: sr_mod.ko is needed for RHEL 6 to see CD-ROM devices (RHBZ#598807).

commit cbb026036826f2ab40237aec0b0c5453b859625d
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jun 2 15:35:58 2010 +0100

    parted: Check partition number >= 1 in several calls.

commit 3ab2d089f3eb34562bc2c9ce4310869b46c69d70
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jun 2 12:32:33 2010 +0100

    daemon: Parse output of old parted which didn't support -m option (RHBZ#598309).
    
    This fixes the following commands when run with RHEL 5-era parted:
    
      get-bootable
      get-parttype
      part-list

commit aee7d55fcf754d97d945c318ec06d6387ade067b
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jun 2 12:31:40 2010 +0100

    daemon: count_strings function returns size_t

commit 50eed6d20de9b6d16975c3c0bbf6e545f8fba1fe
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jun 2 15:10:38 2010 +0100

    base64-in: Ignore garbage characters in input.
    
    On RHEL 5 you have to specify the -i option to get the
    external 'base64' command to ignore \n characters.  (The
    Fedora version seems to ignore these characters anyway).
    
    Add this option so the tests can pass on RHEL 5.

commit 1020b212b189968ead013436cac79019fbd8fdad
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jun 2 13:27:19 2010 +0100

    resize2fs: Document this command also works with ext4 (thanks Yufang Zhang).

commit f2b7a8e15c49ebc70c7ea56aefb340362aae5a99
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jun 1 16:27:33 2010 +0100

    fish: help command return error for non-existent commands (RHBZ#597145).
    
    With this change, the exit status indicates error for non-existent
    commands.
    
    $ guestfish -h foo
    foo: command not known, use -h to list all commands
    $ echo $?
    1
    $ guestfish help foo
    foo: command not known, use -h to list all commands
    $ echo $?
    1

commit 9733d4746988b3a072d8bb1daac4b9795b8f4134
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jun 1 16:18:53 2010 +0100

    daemon: write-file: Check range of size parameter (RHBZ#597135).
    
    This also adds a regression test.

commit 52f9cd4882135910ea06e1e50ac6441d455c9ab1
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jun 1 15:50:14 2010 +0100

    daemon: Limit label lengths (RHBZ#597118).

commit 000f8059a53860ddf3319c1f54d4df5dcd6aa846
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jun 2 13:36:19 2010 +0100

    Update BUGS and PO files.

commit da4812ab6b44c29cb3cf181c7aa896420ecb8aa6
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jun 1 14:04:51 2010 +0100

    Fix and deprecate get_e2label and get_e2uuid (RHBZ#597112).
    
    Fix these calls (see description in RHBZ#597112), but also
    deprecate them since the new calls vfs_label and vfs_uuid can
    work on any filesystem type.
    
    This also adds a regression test for the original bug reported
    in RHBZ#597112.

commit 27b730a6820b80a49a4da1af9f4c8e8a952f735e
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jun 1 13:57:12 2010 +0100

    New APIs: vfs-label and vfs-uuid return label and uuid for many fs types.
    
    These APIs generalize the existing 'get-e2label' and 'get-e2uuid'
    calls, to provide calls which should be able to get the label
    and UUID for most filesystem types.  These use 'blkid' to do the
    work.
    
    I have tested that the blkid commands themselves work on RHEL 5.
    
    (Suggested by Yufang Zhang).

commit 21c42e9fabf6cea3d564e338a314479ef120502a
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jun 1 15:27:57 2010 +0100

    daemon: Kill blkid cache to improve reliability of blkid commands.
    
    By killing the cache file, we make blkid work in situations such
    as a just-created filesystem.

commit 85c71f8fff3e80f549342bf995b686ba7303c2b4
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jun 1 13:39:25 2010 +0100

    daemon: Generalize the implementation of vfs-type.
    
    Note that there is no change to the semantics of the code.

commit fc1dc099a1ceeea45d3c21c699daf39618ca714a
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 28 20:08:01 2010 +0100

    todo: Should generate -N option.

commit 0e42861ccf9e55582db13828ca4eaef213de1f8a
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 28 20:05:56 2010 +0100

    todo: Remove implemented resize functions from TODO file.

commit 90b3539e28c1c5ab7e6a21c0d160010444773734
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu May 27 15:47:51 2010 +0100

    Make the supermin appliance include local augeas lenses

commit 245ed4b8eb076a8c4cc5787f49d21c4f68630f9f
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu May 27 15:47:50 2010 +0100

    Rely on new augeas lens for modules.conf and conf.modules
    
    Latest augeas includes a lens for /etc/modules.conf. If this new lens is
    present, the code to force the Modprobe lens to try to match /etc/modules.conf
    as well results in /etc/modules.conf not being parsed at all. This results in
    modprobe_aliases in virt-inspector output being empty.
    
    This change is equivalent to change cfd28d1140393667913689b7b9bcf21c8bfe592c
    from virt-v2v.
    
    An effect of this change is that the Modules_conf augeas lens is now required
    for correct operation on guests which use /etc/modules.conf.
    
    Fixes RHBZ#596776

commit 1b566fd6881943538bc50a92dec90d8d9b19d239
Author: Daniel Cabrera <logan@fedoraproject.org>
Date:   Thu May 27 15:20:37 2010 +0100

    Updates to Spanish translation (RHBZ#596763).

commit e3881fd0b706532fe0820a625cd1529ca07e1094
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 27 12:03:43 2010 +0100

    Version 1.3.17.

commit 0f6c6239fe0d1b4624e4e9776559c21486a9c7cf
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 27 10:37:43 2010 +0100

    Fix documentation for vfs-type to reflect reality.

commit 11eeb8885c7a8ffb59e12cd5fb2ae0fc324df383
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 27 10:32:51 2010 +0100

    Clarify documentation on distro backports in version command.

commit 8355d3245623c106439ca5ef66f24972c8e09019
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 27 10:31:07 2010 +0100

    Add reference to version number documentation to version command.

commit d12a702fe1898f3ea421210d92c705440efe07a8
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 27 10:25:18 2010 +0100

    Clarify sparse behaviour of truncate-size command.

commit 4412fd951ee7766ee9a70bf66b5cf11378a64ed0
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 27 10:03:47 2010 +0100

    Fix typo in documentation of guestfs_readlinklist.

commit b8861242d13cc034383a56ba891d3e0b9123a99c
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 27 10:01:25 2010 +0100

    Fix missing word in docuentation of guestfs_readdir.

commit 1d1cc4114d48623fb44e3d18e74407902c8f2ae9
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 27 09:49:28 2010 +0100

    Revise documentation on creating files.

commit 6b500f1b8e1ac8d28c485a5591c2833b18cc86e2
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 27 09:48:22 2010 +0100

    New API: fallocate64 (replaces fallocate).
    
    guestfs_fallocate takes an integer for the length, effectively
    limiting it to creating 1GB files.  This new call takes an int64_t
    for the length, but is otherwise identical.

commit c1e3cff523d72e8110cbc568a3c280e57c2aabca
Author: Richard Jones <rjones@redhat.com>
Date:   Wed May 26 23:42:43 2010 +0100

    Fix typo in description of echo-daemon command.

commit c35c83167dcdac440213c92e03b5e9bb1cf97ddb
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 25 23:17:58 2010 +0100

    Version 1.3.16.

commit b0cd2042bb5a9e086ea21d34b40418b7d191bc1e
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 25 23:16:23 2010 +0100

    Add bash complation script to EXTRA_DIST.

commit 5fb9cddf1ecc82c0f4fb7701902913ce7effb7a7
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 25 22:45:45 2010 +0100

    Version 1.3.15.

commit 2b7af34c30b5ea6ab4b27032d5ae4cd609c332d2
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 25 22:24:12 2010 +0100

    Add tests for available-all-groups command.

commit f7d3c8ec692a0f2596b0410a47fa69871904b2e9
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 25 20:13:55 2010 +0100

    fish: First pass at guestfish bash completion script.

commit 21bd2db7cf259a17cc3922409937b849e4b83c0f
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 25 13:54:11 2010 +0100

    fish: Don't eat words when completing case-insensitive paths (RHBZ#582993).

commit 53c3b9d2b03fa5cb0ac7e86a5a51f2a18a2b91c1
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 25 13:52:53 2010 +0100

    fish: Sort returned paths so the list is stable across multiple calls.

commit 06d8064ff8a57eba051044efd1ea1a33c34b9df0
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 25 13:52:17 2010 +0100

    fish: Document test1.img, test2.img etc used by -N option in FILES section.

commit 7fd6e4bfb11d1f86c585de06fb2146aa5cbd400e
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 25 13:51:58 2010 +0100

    fish: Create a separate FILES section in the manpage.

commit 34a306ab2a7e6d9f468e8194cef8a05624325260
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 25 13:41:39 2010 +0100

    fish: Move 'EXIT CODE' section to a more logical place in the documentation.

commit 0e28e4104d96bf0bf5b88fb07bb7e5f9f6e6f41f
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 25 11:45:23 2010 +0100

    resize: Refresh the examples in the documentation.
    
    The documentation was previously very intimidating.  Bring some
    common, simple examples up to the top of the page in a separate
    section.

commit 57cc217335ff511e579b094e47b0de57d5c3aaef
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 25 11:44:43 2010 +0100

    fish: Make the read/write warning more prominent.
    
    Follow the example on other manual pages by making the warning
    more prominent.

commit c9f1a45334efca844c8918b9f0de373f16fd9766
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 25 11:28:09 2010 +0100

    fish: New command: 'supported'
    
    This checks all available optional groups and prints out which
    ones are supported by the daemon.  Note you must launch the appliance
    first.
    
    Example:
    
    ><fs> supported
          augeas yes
         inotify yes
     linuxfsuuid yes
    linuxmodules yes
     linuxxattrs yes
            lvm2 yes
           mknod yes
          ntfs3g yes
       ntfsprogs yes
        realpath yes
           scrub yes
         selinux yes
              xz yes
        zerofree yes

commit 1bd1f9b85f45275b1600d148530bc1877ff15213
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 25 11:27:49 2010 +0100

    New API: available-all-groups to return list of all optional groups.

commit f8ee7869f4836427109959cf20e299a31fa86eaf
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 25 11:25:12 2010 +0100

    perl: Rerun configure if MAX_PROC_NR changes.
    
    If MAX_PROC_NR changes (because a new API has been added to the
    generator) then we need to rerun configure in order to set the
    Makefile's ${MAX_PROC_NR} variable, in order to rebuild Makefile.PL.

commit 90c51f911366656c781868c60a96524b7be79717
Author: Piotr Drąg <piotrdrag@gmail.com>
Date:   Tue May 25 09:41:20 2010 +0100

    Update Polish translations (RHBZ#502533).

commit f323479760ab23755d6b4f27c236befb5a4d6111
Author: Richard Jones <rjones@redhat.com>
Date:   Mon May 24 13:35:31 2010 +0100

    Version 1.3.14.

commit a554c62b709491401c9d3db744c21f6e543e11ba
Author: Richard Jones <rjones@redhat.com>
Date:   Mon May 24 13:34:33 2010 +0100

    build: Remove install_kernel from EXTRA_DIST.
    
    This updates commit a34fadf900625f1f7359ecf3ca760820ffa20815,
    removing this now non-existent script from EXTRA_DIST.

commit 613d041c78e25dafc238696f2fe35b51e443f23b
Author: Richard Jones <rjones@redhat.com>
Date:   Mon May 24 12:09:38 2010 +0100

    build: For development releases, print a notice.

commit 94030c5ce8b5848330e15e812a01064d5afcc6d0
Author: Richard Jones <rjones@redhat.com>
Date:   Sat May 22 18:51:57 2010 +0100

    guestfs_version: Correct documentation.
    
    Remove reference to 'ELF weak linking tricks' and replace
    with suggestion to use dl* functions.

commit 012b1c71f4eda3ae779da51d7d81c199d90f667d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 21 18:20:28 2010 +0100

    Build workaround for Python 2.4.x in RHEL 5.
    
    See:
    http://www.python.org/dev/peps/pep-0353/#conversion-guidelines

commit 63e8da5abeaad1d2aa332fc41ad8f161fc567cdf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 21 16:14:07 2010 +0100

    C99 compatible build fix for RHEL 5.

commit 7cb6fac3074c52ac3c3e9ead5d99e4a2887cf7b1
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 21 14:14:59 2010 +0100

    New API: ntfsresize-size to allow shrinking NTFS (RHBZ#585223).

commit 9be89728f2a0ff17d54a0dba981015fa6405eb50
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 21 14:14:25 2010 +0100

    New API: pvresize-size to allow shrinking PVs (RHBZ#585222).

commit 71b02d6654395ff04689055f3820b3ad4e54ec00
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 21 14:13:24 2010 +0100

    New API: resize2fs-size to allow shrinking ext2 filesystems (RHBZ#585221).

commit 5e1aff7856f721bf5737815a5b65c0de23ab0b0c
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 21 13:07:05 2010 +0100

    fish: Allow suffixes on number parameters (eg. 1M)
    
    This small change uses the gnulib xstrtoll functionality to
    enable suffixes on integer parameters in guestfish.  For example:
    
     truncate-size /file 1G
    
    (previously you would have had to given the full number).
    
    This also applies to the 'alloc' and 'sparse' commands (and
    indirectly to the -N option).  The specification for these commands
    has changed slightly, in that 'alloc foo 1MB' would now use SI
    units, allocating 1000000 bytes instead of a true megabyte.  All
    existing uses would use 'alloc foo 1M' which still allocates true
    megabytes.

commit 48a216a06d6fdab3c8292c383a37cd990c0bf939
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 21 14:51:29 2010 +0100

    fish: Fix '-N part' disk partition type sub-option.

commit 478e1942a9fb4d86b0c4701b6b71f1eac376d0c1
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 21 11:25:36 2010 +0100

    TODO: Suggest including undelete utility.

commit aecdf3c117874e3dc44282600b988d18350b3ad5
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 21 11:25:19 2010 +0100

    Fix name of update-bugs script in output file BUGS.

commit 5f9630338b59d422b640a25a02b46abb3c5f1986
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 20 18:53:10 2010 +0100

    ubuntu: Use direct udevd method to start udev on Ubuntu.
    
    On Ubuntu, /etc/init.d/udev is a symlink to an upstart file,
    but running that causes the appliance to hang.
    
    Therefore detect if this is a symlink and fall through to the
    direct start of udevd.  This shouldn't affect Debian because the
    file is not a symlink on standard Debian.

commit 4557112772c2efaaf36c01ecb9dfe2a9f1899cc2
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 20 13:54:13 2010 +0100

    ubuntu: Remove two FUSE packages from the default list.
    
    fuse-utils (a dependency of these) cannot be installed under
    debirf because it does something with the system udevd which is
    not permitted.  Seems to be a bug either in fakeroot or in the
    post install scripts for fuse-utils.

commit 4312988e0e3acc1f641b70072141916d03623570
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 20 11:04:30 2010 +0100

    ubuntu: Ignore packages in packagelist.in which are missing.
    
    For distros using 'yum', packages which cannot be found are just
    ignored.  This allows us to include for example 'e4fsprogs' on the
    list even though that only exists on RHEL 5.
    
    However for Debian-derived distros, missing packages would cause
    apt to fail.  This was particularly a problem when building Ubuntu
    since it doesn't have as complete a list of packages, and the list
    changed a lot between releases.
    
    This commit adds a check first for missing packages, ignoring those
    and thus acting more like 'yum'.

commit 2954491e73d8da7a57eeded2037ae98d1055b3c6
Author: Richard Jones <rjones@ubuntu910x64.home.annexia.org>
Date:   Mon Dec 21 15:52:36 2009 +0000

    Ubuntu: Use apt-get instead of aptitude when installing guestfsd.

commit a34fadf900625f1f7359ecf3ca760820ffa20815
Author: Richard Jones <rjones@ubuntu910x64.home.annexia.org>
Date:   Mon Dec 21 15:50:59 2009 +0000

    Ubuntu: Revert install-kernel to debirf default script.

commit 53ca11ee44f71ed056f72df9769ca93b9a35e1a7
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 20 10:39:44 2010 +0100

    generator: Make 'xz' into an optional group.
    
    On Ubuntu <= Karmic, xz-utils was not packaged, and therefore
    any xz-related tests would fail.  Thus make this an optional
    group so that we can test for this and avoid running the tests
    if xz utils are not present.

commit 30c091f49dafab4ca9c8b6640d19fc0450b15971
Author: Richard Jones <rjones@redhat.com>
Date:   Wed May 19 12:27:00 2010 +0100

    generator: Check parameters are not NULL (RHBZ#501893).
    
    This adds additional tests to check that several types of parameter
    including String are not NULL when passed to the C functions.
    Previously this would cause a segfault inside libguestfs.  With
    this change, you get an error message / exception.
    
    Of the possible pointer parameters, only OptString is now permitted
    to be NULL.
    
    This change does not affect the Perl bindings.  This is because Perl
    XS code was already adding similar checks if you passed undef into
    a parameter expecting a string.

commit e715451fae0ba738973af98a4e506b6c5564626a
Author: Richard Jones <rjones@redhat.com>
Date:   Wed May 19 12:25:03 2010 +0100

    generator: Some String parameters should be OptString (RHBZ#501894).
    
    I haven't checked the list of functions exhaustively, but
    these are the obvious ones.

commit 9735484c3579e4e4705cd99dd2f6617186b069cc
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 18 23:49:43 2010 +0100

    fuse: Implement write syscall (RHBZ#592883).

commit 1214b321621e7750c67423ecf4d9528809e1eeac
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 18 23:20:30 2010 +0100

    New API: Implement pwrite system call (partial fix for RHBZ#592883).

commit 3920ad95f6b2db8fbf20aa26692877a09070cb04
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 18 21:51:05 2010 +0100

    New API: write for creating files with fixed content (RHBZ#501889).
    
    The guestfs_write call can be used to create small files with
    arbitrary 8 bit content, including \0 bytes.
    
    This replaces and deprecates write-file, which cannot be modified
    to use BufferIn because of an unfortunate choice in the ABI: the
    size parameter to write-file, if zero, means that the daemon tries
    to calculate the length of the buffer using strlen.  However this
    fails if we pass a zero-length buffer using BufferIn because then
    the daemon tries to do strlen on a (really) zero length buffer, not
    even containing a terminating \0 character, thus segfaulting.

commit bda6cf75f259992bcba23c3c4c2339c50552f491
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 18 21:47:19 2010 +0100

    generator: Implement BufferIn parameter type (RHBZ#501889).
    
    The BufferIn argument turns into various things:
    
     in C      const char *, size_t parameter pair
    
     in XDR    an opaque<> type (instead of string) which allows \0 chars
    
     in other bindings
               mostly just a string, since most languages except for C
               permit strings to contain any 8 bit data

commit 5af010c96d687a7cf5251107a74770a231f42b77
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 20 10:11:18 2010 +0100

    fish: Fix build error if built without readline.
    
    fish.c:1447: error: 'add_history_line' defined but not used [-Wunused-function]
    
    (Reported by Matt Booth)

commit 6e10a24df0361b3e33cdfa4f0c16018a796f8b78
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 18 23:18:35 2010 +0100

    appliance: Fix /etc/resolv.conf
    
    Since changing to use link local address
    (commit fbf29976b33a69c64dc7847c54454bf2cfa5fde6)
    we have included an incorrect resolv.conf file in the appliance
    which points to the old (qemu) DNS server.  This commit changes
    to use the new DNS server.

commit 58d1f3c0306d2cd9de8cf16071732f88a36c06c1
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 18 21:54:17 2010 +0100

    Update BUGS.

commit 49fae775c4af7e99f94ff17212d153e60b15dd56
Author: Daniel Cabrera <logan@fedoraproject.org>
Date:   Tue May 18 14:38:57 2010 +0100

    Update Spanish translations (RHBZ#593292).

commit 2dc7bb00337656c00fabed2c1f017aac1fa09da4
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 18 10:02:02 2010 +0100

    appliance: Ignore utempter unreadable binaries (for RHEL 6).

commit 155aa76e57c99594a3724933b6d117f1053544b3
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 18 10:01:45 2010 +0100

    appliance: Change comment about unreadable binaries.

commit f1b651a99b93046b46641ca03e5ed6082866f7ef
Author: Richard Jones <rjones@redhat.com>
Date:   Sat May 15 20:54:26 2010 +0100

    Version 1.3.13.

commit ef5f1325888493cfd4f35b5a178188b7740f6765
Author: Richard Jones <rjones@redhat.com>
Date:   Sat May 15 13:49:55 2010 +0100

    Update BUGS

commit d858418b8b1493a4075970cefa3bf1530343c7de
Author: Richard Jones <rjones@redhat.com>
Date:   Sat May 15 08:44:04 2010 +0100

    Update PO files.

commit 002dc21cba1469cc5b1ce5ef4a7984a733b44a1f
Author: Richard Jones <rjones@redhat.com>
Date:   Sat May 15 08:43:02 2010 +0100

    Generate BUGS file from Red Hat Bugzilla database.
    
    Add a script which generates the 'BUGS' file from Red Hat Bugzilla.
    This is run whenever we do 'make dist' and deliberately stored in git.

commit 5d5565ca24b95719461b0c0aebdb0651dd2671ca
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 14 19:42:48 2010 +0100

    virt-df: Display domains in sorted order.

commit ee03a22f4107dd8c04e72e6a843897ad23549547
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 14 17:41:39 2010 +0100

    Updated Spanish translations (RHBZ#592360).

commit 40d270b0113f1e30319909b2d51adb5a57079cd1
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 14 15:15:47 2010 +0100

    Ensure ordinary appliance is updated before trying to build supermin appliance.

commit 2357adc79aaf6e0b1a4b9945e186a80226330538
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 14 12:38:39 2010 +0100

    Version 1.3.12, update PO files.

commit 8700a55d52f25f60f01ef1b67cff6d5c0071700b
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 13 17:07:17 2010 +0100

    Unify supermin appliance building using febootstrap 2.7

commit 55748a94bc840ac07d3c211119372cd16b31f1a0
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 13 09:56:27 2010 +0100

    Improve errors from tar-in/tgz-in commands (RHBZ#591155 RHBZ#591250).
    
    This commit improves the error messages from the tar-in, tgz-in (etc)
    commands by capturing the stderr from the tar command in a file and
    sending that back in the error message.
    
    The method used for the error file is primitive, and there is a case
    for a more generic error file mechanism, but this will do for now.
    
    Sample error messages after this change:
    
    $ virt-tar -u /tmp/test1.img /tmp/not.tar /
    tar_in: tar subcommand failed on directory: /: tar: This does not look like a tar archive
    tar: Skipping to next header
    tar: Exiting with failure status due to previous errors at /home/rjones/d/libguestfs/tools/virt-tar line 247.
    
    $ virt-tar -u /tmp/test1.img /tmp/test.tar /
    tar_in: tar subcommand failed on directory: /: tar: access.log: Cannot open: Read-only file system
    tar: Exiting with failure status due to previous errors at /home/rjones/d/libguestfs/tools/virt-tar line 247.

commit b76fd51e142494058ca0082b547aa5e747ad4b79
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 13 10:17:48 2010 +0100

    Combine common code in daemon/tar.c.
    
    This commit shouldn't result in any change in the semantics
    of the code.

commit dc706a639eec16084c0618baf7bfde00c6565f63
Author: Richard Jones <rjones@redhat.com>
Date:   Wed May 12 19:55:06 2010 +0100

    Fix FileIn cmds losing synch if both ends send cancel messages (RHBZ#576879).
    
    During a FileIn command (eg. upload, tar-in) if both sides
    experience errors, then both sides could send cancel messages,
    the result being lost synchronization.
    
    The reason for the lost synch was because the daemon was ignoring
    this case and sending an error message back which the library side
    (which had cancelled) was not expecting.
    
    Fix this by checking in the daemon for the case where the library
    also cancels during daemon cancellation, and not sending an error
    messages.
    
    This also includes an enhanced regression test which checks for this
    case.
    
    This extends the original fix in
    commit 5922d7084d6b43f0a1a15b664c7082dfeaf584d0.
    
    More details can be found here:
    https://bugzilla.redhat.com/show_bug.cgi?id=576879#c5

commit 11a2ad8c9a1da7fe7f8142be69312d0cb5979e0a
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 13 17:05:41 2010 +0100

    guestfish: Fix build error in 'print_shell_quote' function.
    
    Amend commit 1c6ed48bd3cd471dc so the prototype of
    'print_shell_quote' function is correct.

commit 520d895383c6e2b3eff1c4e3761624ebbb5f8b09
Author: Richard Jones <rjones@redhat.com>
Date:   Wed May 12 19:01:29 2010 +0100

    fish: Fix guestfish -N option when called with unknown image type.
    
    Previously it was falling off the end of the loop if you
    called it with an unknown image type.

commit 94e310dcfbcd368cbe02dbc1643ed2ff9821cd48
Author: Richard Jones <rjones@redhat.com>
Date:   Wed May 12 18:11:37 2010 +0100

    Improved error if virt-inspector cannot find OSes in image (RHBZ#591142).

commit 287f8957fea3efe411c7ac55595d5d6c7b613e4e
Author: Richard Jones <rjones@redhat.com>
Date:   Wed May 12 16:55:59 2010 +0100

    Fix error message in string-e command (RHBZ#588651).

commit 1c6ed48bd3cd471dc6e4613ede9151631e19f55a
Author: Richard Jones <rjones@redhat.com>
Date:   Wed May 12 15:58:00 2010 +0100

    guestfish -i and virt-inspector work on filenames containing spaces (RHBZ#507810).
    
    This commit fixes a long-standing bug which prevented guestfish -i
    and virt-inspector from working on disk images which had a space
    in the filename (or other unsafe characters).  It works by ensuring
    that the strings passed between guestfish -i and virt-inspector are
    quoted correctly in both directions.
    
    Note that this commit adds a dependency from virt-inspector to
    the perl module String::ShellQuote.  We have previously used this
    module in virt-make-fs.

commit 72324580801f2c0e2b702b430b90eb141618c7f4
Author: Richard Jones <rjones@redhat.com>
Date:   Wed May 12 15:01:45 2010 +0100

    Add version numbers to Perl modules (RHBZ#521674).
    
    Sys::Guestfs now contains a version number which reflects the
    ABI that we are compiled against, ie. '0.<MAX_PROC_NR>'.  This has
    the beneficial side effect of causing an error if the user tries
    to mix versions of the Perl module and the XS code.
    
    Sys::Guestfs::Lib now contains a synthetic version number which
    will reflect future changes in that module.

commit b7046fecee400396a35d9cd33d1726d27373c5a2
Author: Richard Jones <rjones@redhat.com>
Date:   Wed May 12 14:26:26 2010 +0100

    Update PO files, including extra strings from Perl files.

commit feb0cd04822231f056c3086f322afbefc2e2467c
Author: Richard Jones <rjones@redhat.com>
Date:   Wed May 12 14:24:23 2010 +0100

    po: Include strings from Perl programs in the PO files (RHBZ#559963).
    
    xgettext will only recognize '*.pl' as being a Perl file (otherwise
    it treats it as a C file and does not correctly find any strings
    in it).
    
    This commit also fixes two actual bugs that xgettext found in the
    strings in our Perl programs.

commit 48133118071a26950840fe33326c09130955c35e
Author: Richard Jones <rjones@redhat.com>
Date:   Wed May 12 14:19:50 2010 +0100

    po: Don't generate po/Makevars file and include Perl keywords (RHBZ#559963).
    
    I don't see a reason to autogenerate po/Makevars, and in the
    earlier commit which changed this file to being autogenerated
    we accidentally lost the special Perl keywords, copyright notice
    and bug reporting address.  Fix all of that.
    
    This partially reverts commit febff9d2a35c4f40abbaf8943146476bdeac671e.

commit 5477d98548661394cf0df3ce48929961e0d2a38f
Author: Richard Jones <rjones@redhat.com>
Date:   Wed May 12 18:10:58 2010 +0100

    Reduce imported functions in virt-df to ones which are actually used.

commit 0c1e77219ea264a51b62e648003bfbea51db8ffb
Author: Richard Jones <rjones@redhat.com>
Date:   Wed May 12 17:32:39 2010 +0100

    New API: fill-pattern for creating files with predefined patterns.

commit 9d158c3ab132df21d58890f18224cd2fe020de67
Author: Richard Jones <rjones@redhat.com>
Date:   Wed May 12 16:12:07 2010 +0100

    Run udev_settle() after swapon/swapoff (RHBZ#516096).

commit 87eecb507ee09a62f3a12f5f75d3417a09c0c8d4
Author: Richard Jones <rjones@redhat.com>
Date:   Wed May 12 15:29:03 2010 +0100

    fish: With both '-x' and '-i', pass through '-x' to inferior process.

commit 3cead7285040673a50a119f3be7de4d7f3334f73
Author: Richard Jones <rjones@redhat.com>
Date:   Sat May 8 20:12:55 2010 +0100

    Version 1.3.11.

commit f35365ecbf348f1030581e59795435987b8adf0f
Author: Richard Jones <rjones@redhat.com>
Date:   Sat May 8 19:57:52 2010 +0100

    virt-rescue: Add extra options.
    
    This commit adds the extra options '--append', '--memsize' and '--selinux'.

commit d0afef23e54f75a521eed8c7261a533776242cfc
Author: Richard Jones <rjones@redhat.com>
Date:   Sat May 8 19:55:27 2010 +0100

    virt-rescue: Refresh documentation.

commit 214a803ac571376d9862b100155f4ac08b4ff86f
Author: Richard Jones <rjones@redhat.com>
Date:   Sat May 8 09:45:19 2010 +0100

    Revert "fish: Add 'please wait' message when launching (and interactive)."
    
    This reverts commit 01fedcde05c930c1413e9fe0909fa1da1f360cdf.

commit 01fedcde05c930c1413e9fe0909fa1da1f360cdf
Author: Richard Jones <rjones@redhat.com>
Date:   Sat May 8 09:37:25 2010 +0100

    fish: Add 'please wait' message when launching (and interactive).

commit 55e9707f8591488542da48fc89738234b4d85016
Author: Richard Jones <rjones@redhat.com>
Date:   Sat May 8 09:28:19 2010 +0100

    launch: Rearrange the code so config check is first.
    
    Move the config state check first in the guestfs_launch function,
    so that we don't reset g->launch_t or calculate the temporary
    directory in the case where the launch function will immediately
    return with an error.

commit 301abf33c6985b61604dfae5db75cf767aa5e651
Author: Richard Jones <rjones@redhat.com>
Date:   Sat May 8 09:26:57 2010 +0100

    generator: FishAction is no longer used, remove this feature.

commit bece54704bb081339a87233bbc5401f2892467be
Author: Richard Jones <rjones@redhat.com>
Date:   Sat May 8 09:25:32 2010 +0100

    fish: Make 'launch' function static.
    
    This commit makes the launch function static and private to
    'fish.c', and changes the generator so the function is no longer
    called for the 'run/launch' command.

commit a96d70113ffcd01f55262c3d0fbe711bee759fec
Author: Richard Jones <rjones@redhat.com>
Date:   Sat May 8 09:14:00 2010 +0100

    fish: In 'reopen' copy trace setting to new handle.

commit 2064e43bcfc7fc5bde08a0442c646a0a46997875
Author: Richard Jones <rjones@redhat.com>
Date:   Sat May 8 09:10:00 2010 +0100

    Ignore test1.img file in directory.

commit 846238a031f690078235b98db573060d2b88a5c1
Author: Richard Jones <rjones@redhat.com>
Date:   Sat May 8 09:09:24 2010 +0100

    fish -N option unconditionally overwrites test*.img files.
    
    This is more convenient and makes it consistent with the
    'alloc' and 'sparse' commands.

commit 8e007581c91a5193e6aec0f6f9aeb379a935c9d4
Author: Richard Jones <rjones@redhat.com>
Date:   Sat May 8 09:04:28 2010 +0100

    fish: Make '-x' option enable traces instead of using separate echo path.
    
    Previously we had separate code paths for echoing commands (-x)
    and tracing (guestfs_set_trace).  This just unifies that so that
    the guestfish -x option enables tracing.

commit 94775c53f163926ef99e6c6b8ab67b402935301d
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 7 23:15:40 2010 +0100

    inspector: Support filesystem-on-image VMs (RHBZ#590167).
    
    $ virt-df /tmp/dbroot.img
    Filesystem                           1K-blocks       Used  Available  Use%
    /tmp/dbroot.img:/dev/vda               3096336     593628    2345424   20%

commit f606a79ed7a20ee59bc0755b1030c6d29e503724
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 7 22:50:50 2010 +0100

    daemon: Use 'error' instead of 'perror' before calling 'abort'.

commit b52ef0b021fc443d88d4d9c43f57468712e40965
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 7 22:49:49 2010 +0100

    daemon: gnulib module 'error' is used directly by the daemon.

commit 63882fb2201c834db57c9b9287ff9349310f7dde
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 7 22:50:22 2010 +0100

    daemon: Use parens around code section for safety.

commit fc6dd9daa13ac774156d0822b5aa7830171feb85
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 7 22:37:55 2010 +0100

    If qemu dies during launch, set an error message (RHBZ#588851).

commit a3eb97d6377c1e0af258029ec08b17584e617cbb
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 7 16:34:08 2010 +0100

    Version 1.3.10.

commit 42f59b28f123f53ae038df23a9abee08e959e46b
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 7 13:30:42 2010 +0100

    daemon: Fix read-file so it fails gracefully for large files (RHBZ#589039).
    
    Pengzhen Cao noticed that read-file would fail for files
    larger than the protocol size; this is *not* the bug.  However
    it would also lose protocol synchronization after this.
    
    The reason was that functions which return RBufferOut in the
    generator must not 'touch' the *size_r parameter along error
    return paths.
    
    I fixed read-file and initrd-cat, and I checked that pread was
    doing the right thing.
    
    This also adds regression tests for read-file with various categories
    of large file.

commit a84f1360499309e2d2ecb661adc6917539b5eef4
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 7 00:13:31 2010 +0100

    daemon: Fix wc* commands to work on absolute symbolic links (RHBZ#579608).

commit 26991ebb8181b57f4c8454f2862c938d7c5d012d
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 7 00:13:05 2010 +0100

    daemon: Fix strings to work on absolute symbolic links (RHBZ#579608).

commit deee8e2b4e377dc2eb23fc551a4d0711ac49b585
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 7 00:12:36 2010 +0100

    daemon: Fix head and tail commands to work on absolute symbolic links (RHBZ#579608).

commit 7d8e5886a6a8ab16c6a69d0e02e7f93cdb7430df
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 7 00:11:55 2010 +0100

    daemon: Fix grep and related to work on absolute symbolic links (RHBZ#579608).

commit 00fae9fe88ca83dfc3ee0b1b7d8e27e644f6e9c7
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 7 00:11:22 2010 +0100

    daemon: Fix checksum to work on absolute symbolic links (RHBZ#579608).

commit 7a4ec57e54ab98de05438bff838a7531391d3965
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 6 21:55:32 2010 +0100

    daemon: Fix hexdump to work on absolute symbolic links (RHBZ#579608).

commit 07369cb77a07f965cbf8e02f485c78a22c091f85
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 6 21:36:24 2010 +0100

    daemon: Fix for commands working on absolute symbolic links (RHBZ#579608).
    
    The original idea (suggested by Al Viro) was to fork and chroot
    into the sysroot and read the file from there.  Because of the
    separate process being chrooted, absolute links would be resolved
    correctly.  The slightly modified idea is to open the file in the
    daemon process (but temporarily chrooted, so symlinks resolve
    correctly), fork, and have the subprocess just be responsible for
    copying the file.  (Strictly speaking we don't need to fork, but
    this implementation is simpler).
    
    This commit just includes the changes needed to the command*()
    functions in daemon/guestfsd.c and adds an absolute symlink to
    the test ISO for testing it.  Later commits will fix the broken
    daemon commands themselves.

commit 34067b5c362d5070e91364cc1ed6487497462b42
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 6 20:32:09 2010 +0100

    daemon: Change command to abort() on resource problems.
    
    The comment in the code describes it thus:
    
      /* Note: abort is used in a few places along the error paths early
       * in this function.  This is because (a) cleaning up correctly is
       * very complex at these places and (b) abort is used when a
       * resource problem is indicated which would be due to much more
       * serious issues - eg. memory or file descriptor leaks.  We
       * wouldn't expect fork(2) or pipe(2) to fail in normal
       * circumstances.
       */

commit 4839d5142ca50818965866287932f9ded14729e6
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri May 7 14:58:32 2010 +0100

    Warn instead of dying if grub refers to non-existent kernel

commit 01c1d82823be7008d7930e7876c31939227a4f41
Author: Richard Jones <rjones@redhat.com>
Date:   Wed May 5 16:10:37 2010 +0100

    Update to latest gnulib.

commit fbf29976b33a69c64dc7847c54454bf2cfa5fde6
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 4 16:06:58 2010 +0100

    Use link-local addresses between appliance and host (RHBZ#588763).

commit 8a9f2ca65521d093ac14307aca4370d9497ac840
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 4 15:06:09 2010 +0100

    Change network configuration to use macros.
    
    Change the network configuration so everything is set using
    some macros at the top of src/guestfs.c.
    
    Also, rename the macros used in the daemon so they are not the
    same.  It was a very long time since these sets of macros had to
    match the ones defined in src/guestfs.c, despite what the comment
    said.
    
    Note that this commit should not change the semantics of the
    program at all.

commit 7d005a9ae820cff3274b456d99b0031d7277a61a
Author: Daniel Cabrera <logan@fedoraproject.org>
Date:   Tue May 4 13:35:01 2010 +0100

    Update Spanish translations (RHBZ#588733).

commit 097266e01cfa28319834bf750649650f3c22006f
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 30 23:12:34 2010 +0100

    tests: In verbose mode, print dashes between each test.
    
    Only affects tests when run with LIBGUESTFS_DEBUG=1.  Lets you easily
    see when each test starts and ends.

commit a0a394a4619c5d45932fee3de8d86cabf0ecb2e7
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 30 18:27:37 2010 +0100

    Version 1.3.9.

commit fd2d10d6ed91f417a9b99bb61526b45bb7ed3e4e
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 30 13:56:11 2010 +0100

    Document that guestfs_mount implies -o sync and performance problem (RHBZ#587582).

commit 90b4e24df6f27c02d3b11d8021b27a197cf18b75
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 30 12:27:00 2010 +0100

    contrib: Add dependency diagram of libguestfs ecosystem.

commit 2f9f3375028a02fdaec62f30e11bacd6524a342c
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 30 11:34:21 2010 +0100

    contrib: Add header to README file.

commit c24de46d06cc3ecccf00bfaaffb06172659cdd0a
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 30 10:51:49 2010 +0100

    lvresize: Use --force so it can make LVs smaller (RHBZ#587484).
    
    This also adds a regression test for this bug.

commit 25c15261253bbd2fb140e5ca1c902acf714f76a9
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 30 09:46:40 2010 +0100

    tools: Fix documentation for CurrentControlSet (thanks Yuval Kashtan).

commit 55641f5d1e9964f8a039005b511b8e688c92cddb
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 29 13:55:52 2010 +0100

    guestfs(3): Documentation on protocol gotchas.

commit d3be0facdd688f06eb4bc3743b53226f2d060482
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 27 15:48:38 2010 +0100

    Version 1.3.8.

commit 467268bc32598db96878307ed0752ea940c1c281
Author: Daniel Cabrera <logan@fedoraproject.org>
Date:   Mon Apr 26 15:57:45 2010 +0100

    Update Spanish translation (RHBZ#585961).

commit 78d2523ec8997679f7fca810de60620df4001e16
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 24 09:10:28 2010 +0100

    fish: Add 'man' command which opens the manual.

commit ce95be8b185ce697816c3446406d7129e01cc0e1
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 24 08:50:40 2010 +0100

    docs: Routine refresh of the documentation for guestfs(3) and guestfish(1).

commit b054e33db629e83c20c3d4e8ff941b7beb5abf34
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 23 14:43:13 2010 +0100

    Version 1.3.7 - note: fixes a segfault in guestfish 1.3.6.

commit 7c285ea84f63e511f95a3c8bfbb98cbf99b9466b
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 23 14:29:56 2010 +0100

    todo docs: Discuss shrinking filesystems and specifying sizes in guestfish.

commit 41ee105aabaf1e9a7efc437b87d9536d3dc14a75
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 23 14:14:26 2010 +0100

    New API: checksums-out for checksumming many files.
    
    Useful API for verifying the integrity of virtual machines.

commit 89a707aac5aa75d70cbb3049e8d328cfe6a40dea
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 23 13:43:05 2010 +0100

    generator: Update docs for checksum to point to checksum-device.

commit af29c84cef791381ac3aebae30d8831b7de77e36
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 23 13:42:10 2010 +0100

    daemon: Split out checksum type to program name mapping into function.
    
    This shouldn't change the semantics of the program.

commit d054dfb2f948f53188f448d2c7fade83db9bbab8
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 23 14:13:42 2010 +0100

    fish: Fix segfault in '-a' option.
    
    This fixes a segfault in the guestfish -a option which you would
    get when using guestfish 1.3.6.

commit 6e269c6e5123c1558589e0a59844dc0187fbd63a
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 23 10:25:35 2010 +0100

    todo docs: Integrate with host intrusion detection systems.

commit 2ed549e95c7ad75f28b5f0dd4c53849e1607444e
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 23 10:23:45 2010 +0100

    todo docs: Mapping filesystems to and from disk blocks.

commit dfe539d7649344a9cee1c821689823e7052446be
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 22 22:29:25 2010 +0100

    Version 1.3.6.

commit 4a9b979a3199dfef64a342f05d666da540203a7c
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 22 10:42:58 2010 +0100

    fish: Add -N option for making prepared disk images.
    
    Previously you might have typed:
    
    $ guestfish
    ><fs> alloc test1.img 100M
    ><fs> run
    ><fs> part-disk /dev/sda mbr
    ><fs> mkfs ext4 /dev/sda1
    
    now you can do the same with:
    
    $ guestfish -N fs:ext4
    
    Some tests have also been updated to use this new
    functionality.

commit 89486c50eaeb8b1cc5a6ff388cb47e859f8565d1
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 22 10:46:34 2010 +0100

    fish docs: Be consistent about using I<-..> for options.

commit e3e67f63b0a6ce952ba92cb966b8ac5ef239dcf9
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 22 10:44:35 2010 +0100

    fish docs: Use L</...> for internal links in the man page.

commit 75d9c056b2db9ceedef9eca64e67ad3350eabad8
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Apr 22 13:57:56 2010 +0100

    Whitelist the loop kernel module
    
    loop is sometimes a module, for example on RHEL 5.

commit 39416cdb11bb2005915ed293eafb3cc6d714416d
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Apr 21 15:39:49 2010 +0100

    Don't die during inspection if rpm -qa or dpkg-query fails
    
    If a problem in the package database prevented package enumeration from working,
    inspection would die. This change makes it emit a warning and continue.

commit 2b43970c8c97f24b1f45c040c6963d30661fa514
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Apr 21 15:39:48 2010 +0100

    Don't die during inspection if initrd doesn't exist
    
    This fixes a problem where inspection would die if grub.conf referenced a
    non-existent initrd. Just return an empty initrd instead.

commit 216557b1ebc013701e7474720bc1280f43e51bb1
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 20 22:20:46 2010 +0100

    Add zfs-fuse (ZFS via FUSE) support to the appliance.

commit c8f302a17453ad58acccd137342438795763606a
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 20 18:46:45 2010 +0100

    Remove checks for Test::Pod and Test::Pod::Coverage.
    
    Although these modules are optionally used by the Perl tests,
    they aren't necessary and won't break the build if they are not
    there.  These modules aren't available in RHEL 5.  Therefore
    remove these checks.

commit d7768dc5262a1eceeca04e3c602712ed99f5fbc9
Author: Daniel Cabrera <logan@fedoraproject.org>
Date:   Tue Apr 20 16:30:27 2010 +0100

    Updated Spanish translations (RHBZ#584038).

commit 199f218bf431b77c12a728f7072bed1553a0f0af
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 20 13:22:09 2010 +0100

    Check user doesn't run configure, make or make check as root.
    
    (Thanks to Yufang Zhang for helping to debug this issue).

commit 175c01d2336c07113f1c2966966957de5c344e3a
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 20 11:04:14 2010 +0100

    Replace 'dd' in tests with use of guestfish 'sparse' command.
    
    'dd' is a very inefficient way to create files.  'truncate' is
    better, but unfortunately that command is not available in RHEL 5.
    So use the guestfish 'sparse' command instead (which also avoids
    allocating disk space).

commit 54a8f8f30de2f3132da97c54d07ca4639c405de1
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 20 10:50:50 2010 +0100

    Document new version numbering policy.
    
    See discussion on mailing list:
    
    https://www.redhat.com/archives/libguestfs/2010-April/msg00005.html
    https://www.redhat.com/archives/libguestfs/2010-April/msg00057.html
    https://www.redhat.com/archives/libguestfs/2010-April/msg00058.html

commit c2a8efc548d6f997049cbb3d63bab360b0d946b6
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 19 20:55:15 2010 +0100

    Document umask (RHBZ#582548, RHBZ#583554).

commit 42e43db927dac13da0afe6dba39708295eb06021
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 19 20:13:05 2010 +0100

    docs: Clarify documentation for mknod (RHBZ#582948).

commit 27a67f8615b5788f5ff21b68b9afc01c35c5b832
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 19 17:25:58 2010 +0100

    Update PO files.

commit aba59fd3555ac8b38ae554a729970afd80e05404
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 19 17:13:46 2010 +0100

    Prepare for version 1.3.5.

commit c3a68961859a617f7c574c528d0f8ac1fdbb53e1
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 19 17:09:58 2010 +0100

    New APIs: base64-in and base64-out for uploading/downloading base64 content.

commit 87e49e7e87e570537f04e34178c9c6d2b876c16c
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 19 16:31:24 2010 +0100

    New API: debug-upload (not a formal part of the API/ABI).
    
    Allow arbitrary files to be uploaded into the appliance, but
    only when --enable-debug-command is enabled.  This lets you
    run shell scripts, like this:
    
      ><fs> debug-upload -<<EOF /tmp/script.sh 0700
      #!/bin/sh -
      # ...
      EOF
      ><fs> debug sh "/tmp/script.sh"

commit 3119aa687d4d594b50ee9df5ff6e8d709eb7ca85
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 19 14:41:01 2010 +0100

    fish: Allow -<<END as a syntax for uploading "heredocs".
    
    For example:
    
        ><fs> upload -<<END /foo
        some data
        some more data
        END
        ><fs> cat /foo
        some data
        some more data

commit 819f30e332160ba05f7bf6dd068622cc07bf9ffc
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 19 11:49:08 2010 +0100

    todo docs: Feature for base64 uploads and scripts.

commit 92d38b9ae3a0b1b4694da5e3d3a3cb155842cd91
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 19 10:20:58 2010 +0100

    docs: Add virt-resize(1) link to guestfish(1) manpage.

commit 1525e2ba0843aa6b1c7bb5ab6d83954cc284f710
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 17 22:19:20 2010 +0100

    Version 1.3.4

commit e55400960a6a06eb6dc16ea96f3c30ed580d3d3a
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 17 20:41:28 2010 +0100

    todo documentation: Idea: List, mount filesystems by UUID and label.

commit abb7365d4df7b945846a9f6189bbbd70e10122d1
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 17 20:36:11 2010 +0100

    todo documentation: remove 'virt-grow/shrink', see virt-resize

commit 398e6830a34e916c52cd23ba6d0b4c00602dfc61
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 17 20:35:34 2010 +0100

    todo documentation: virt-rescue now uses $TERM from library, remove from todo list

commit 3b759fe7fe568a3d643ee99e0aef0adaf163d1e5
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 17 20:34:35 2010 +0100

    todo documentation: Remove old section on PPC bugs.
    
    No one cares for PPC, and if they do they should file these
    as bugs in the bug tracker.

commit fc50bf2680d4ed653ff00d390cd7a17ebeb22cf2
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 17 20:34:21 2010 +0100

    todo documentation: Remove old ideas for Python bindings.

commit 2e0f3ed54b978925c79ca0d33e76bec338b23631
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 17 16:33:07 2010 +0100

    Documentation: Use 'g' instead of 'handle' in documentation.
    
    By convention we use 'g' for handles.  Copy this convention
    through to all the documentation.

commit 6e4bf8e278f5c8bd28eba7152d2f11d1e537ee1b
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 17 16:24:03 2010 +0100

    In guestfs(3), unmount "/" directory in the example.

commit 4680c732585b2c2d292f521f393215c7943096fa
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 17 16:22:53 2010 +0100

    Add compilation/linking example to guestfs(3) man page.

commit 3297466d33e9f9b73ee806ff2ba90ede1a4a02ab
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 17 15:59:41 2010 +0100

    generator: Use shortname in check_state() call.
    
    Saves a tiny bit of space in the library.

commit 09a0427448b1f4328b9246d4d8a26610bb5228c8
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 17 15:46:08 2010 +0100

    Build top-level directories in a more logical order.

commit 2a9abc7791a12af07ec2dada4b3a9a16eb452dca
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 17 15:41:16 2010 +0100

    Rerun generator if images/test.iso does not exist or has been updated.
    
    The MD5 hash of this file is embedded in the output of the
    generator.

commit 5922d7084d6b43f0a1a15b664c7082dfeaf584d0
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 17 14:25:55 2010 +0100

    Fix upload losing synchronization if root not mounted (RHBZ#576879).
    
    Modify the generator so that it can correctly handle early
    cancellation for Pathname|Device|.. parameters.  This fixes
    the upload command, but consequently we need to fix the
    parameters for tar_in and t?z_in commands.  This should also
    mean that 'win:' can now be used as the second argument of
    tar_in and t?z_in commands in guestfish, whereas previously
    this wouldn't have worked.
    
    Adds a regression test for the original problem.

commit 68467cb1c2f8b1cc7844ed6512b7f76ef2aba1d1
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 17 14:14:30 2010 +0100

    generator: Fix typo in a comment.

commit 61ab83d19009a8006dd73ebe16d22494b78be4d1
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 17 13:33:14 2010 +0100

    Improved checking, documentation of modes (RHBZ#582901, RHBZ#582929).
    
    chmod: Disallow negative mode, document mode affected by umask.
    
    mkdir-mode: Disallow negative mode, document that filesystems
    may interpret the mode in different ways.
    
    mknod: Disallow negative mode, document mode affected by umask.
    
    umask: Check the range of umask mask value carefully.

commit 42fc0e02b094ef3b19dae115276a0a33116af6d5
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 17 13:11:20 2010 +0100

    fish: Autocomplete 'sparse' command (RHBZ#582899).
    
    I also rechecked the list of built-in commands against
    the actual commands to make sure no others were omitted.

commit 4e5327187d6474e81241dd2b6f5418be2387a0cb
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 17 13:07:56 2010 +0100

    New API: get-umask, returns the current umask (RHBZ#582891).

commit 116d497c68c2e57f6e92abf8834112a794a145f0
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 17 12:38:18 2010 +0100

    Add a build test for the 'umask' command.

commit 4f376dbafb78ee9b5ad1652360472a14de64753d
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 17 12:33:31 2010 +0100

    fish: Print output from some commands in octal/hex as approp. (RHBZ#583242).

commit e64c1e5aacd605ea177972e56ede5be22ae13d4f
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 17 12:13:23 2010 +0100

    Documentation: lvcreate should say 'logical volume' (RHBZ#582953)

commit b35d2a0fd7a705d2ff60882e5107a7d29f7f8d6e
Author: Daniel Cabrera <logan@fedoraproject.org>
Date:   Wed Apr 14 14:59:30 2010 +0100

    Update Spanish translations (RHBZ#582252).

commit c0d73e0e60b99b87855364ff346551f5ff7efccb
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Apr 14 11:13:04 2010 +0100

    Fix build error in fuse/guestmount.c.
    
    guestmount.c: In function 'main':
    guestmount.c:899: error: implicit declaration of function 'setlocale'
    [-Wimplicit-function-declaration]
    
    guestmount.c wasn't including locale.h.

commit 66477d07e37ffe66cd6fea1105dd92b616d3cd27
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 13 18:42:27 2010 +0100

    New API: Add aug-clear call for clearing an Augeas node.

commit ad752b80d7fa064b7bdd3d4c8d47c95d79265b58
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 13 22:06:43 2010 +0100

    fish: Allow '-' prefix on command line to override exit on error (RHBZ#578407).
    
    Allow -cmd on the command line to mean that normal exit on error
    behaviour is overridden, ie. we will not exit.
    
    This allows you to do:
    
      guestfish -- command : -command : command
    
    with the second command allowing errors.  (Note that '--' is required
    to stop getopt parsing -command as an option).
    
    Also this fixes the remote case which is what the original
    bug report was about.

commit c076aaea7e6d9459c8d8a96d21abd71a0223f098
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 13 21:26:14 2010 +0100

    fish: Update documentation: Add another pipe example.

commit c7c4a476a5957794dc2e9af0ec14b447ecef5740
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 13 21:25:50 2010 +0100

    fish: Update documentation: Using 'lcd' command to change local directory.

commit 3d9b2a707d5739a2b80157a69b57e0cda40cd7bf
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 12 19:52:03 2010 +0100

    Update PO files.

commit bbf56d28b28cbde3bfb09ca8499a7b619d9b66c3
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 12 19:32:38 2010 +0100

    Prepare for version 1.3.3.

commit cdc89bb10ff584d3aaf07b70c264d659e5f416e3
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 12 16:34:36 2010 +0100

    resize: Add --LV-expand option for expanding Linux LVs.

commit 2bec01ba1fcceb4880aa991e599920be9b68996a
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 12 16:33:46 2010 +0100

    New API: lvresize-free to extend LVs into percentage of free space.

commit 508f1ee87e816bf6b6fc8e629ccbb2d61a971169
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 12 16:34:57 2010 +0100

    Fix time and timezone to be correct within the appliance.

commit 960b99f875162ade09b7db886d1362de7d548792
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 12 18:54:58 2010 +0100

    resize: Fix missing newline from end of print.

commit ba099ee689b42dd71b05d12583d69424fcfbc217
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 12 16:32:55 2010 +0100

    resize: Fix regular expression to exactly match ^ext[234]$

commit c53e64a156526adcb9937f63756f17f585f202d3
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 12 12:17:08 2010 +0100

    virt-resize: Mention alternate tools like gparted in the documentation.

commit de5607909b59d9068f64d87c4d9351286a873b42
Author: Daniel Cabrera <logan@fedoraproject.org>
Date:   Mon Apr 12 16:31:43 2010 +0100

    Updated Spanish translation (RHBZ#581501).

commit 9a608a1516bd339dc6d5ebe9952d3bced273c416
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Apr 11 17:02:18 2010 +0100

    Documentation updates.
    
    Fix copyright years.
    Fix URLs to point to new PRC site.
    Make sure guestfish(1) and guestfs(3) manpages reference the
    current list of tools.

commit 4e5678c1040503e7f05048ccb002fbf257bcb762
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 10 21:54:04 2010 +0100

    Version 1.3.2

commit 540da0bc1999deda670e846b8db7291826a1a728
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 10 21:23:27 2010 +0100

    New API: checksum-device for checksumming devices.
    
    Analogous to the usual 'checksum' call.

commit 5466638279b51d46e6b24d4f7148d520cb4f3c34
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 10 13:38:26 2010 +0100

    virt-resize: Enhance virt-resize so it can expand partition content.
    
    Enhance virt-resize so it can expand "first level" partition
    content, including ext/2/3/4/ntfs filesystems and PVs.
    
    Also extensively update the documentation.
    
    This has been tested on a variety of Linux and Windows guests.

commit e6bdd66fa6bdfa4e762f3c67ec1bac83a1d6643b
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 10 13:21:33 2010 +0100

    virt-list-partitions: Add -t / --total option.
    
    This option lists out block devices separately:
    
     $ virt-list-partitions -lht /tmp/WindowsResized.img
     /dev/sda1 ntfs 100.0M
     /dev/sda2 ntfs 11.9G
     /dev/sda device 12.0G

commit add5e22563972210f5c8baf9e8cf651fc1a7bbd8
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 10 13:35:31 2010 +0100

    Bugfixes for virt-resize.
    
     - copy more than 64 boot loader sectors across, since real boot
       loaders (eg. for Windows) can be much larger than this
     - copy bootable flag and ID byte to new partitions
     - start the first partition on the new disk at the same sector
       offset as on the old disk
     - sync the disks before existing

commit b68c030adfdbefe65bc9ecdd673844c01bddb32a
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 10 13:19:43 2010 +0100

    New partition APIs: part_del, part_get_bootable, part_get/set_mbr_id
    
    These APIs flesh out further the partitioning API.

commit cb9350019cc6382a35c98f522c9c4d221c92b605
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 10 13:17:50 2010 +0100

    daemon: More reliable parsing of the output from 'parted print'.
    
    Previously we used strtok.  However this has the problem that
    strtok considers multiple delimiter characters to be like a single
    delimiter, eg. "1:::2" would be parsed the same as "1:2".  In
    other words, the previous code would skip over or fail if there
    are empty fields.

commit 440ad646cdf31bdb5ad2bc92fc51fa6df3fb9c63
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 10 13:16:19 2010 +0100

    daemon: Make the RUN_PARTED macro take an error statement.
    
    This allows us to make the RUN_PARTED macro do something else
    along the error path, other than just returning -1.

commit 30752ac7ca042f533b8d0c4c6144400a8532b154
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 10 13:14:54 2010 +0100

    Documentation: Clarify documentation on the bootable flag.

commit 9752039e52d190c7d62281346fd2170a98434c86
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 10 13:14:12 2010 +0100

    New API: vgscan
    
    Implement vgscan to allow for a full rescan of all LVM
    PVs, VGs and LVs.

commit f8210da95888f0060b25dcca2ae299d5c16ff814
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 10 13:13:07 2010 +0100

    New API: ntfsresize.
    
    This implements the ntfsresize operation, using the external
    program from ntfsprogs.

commit e323d93ed2ab3b55885273ab6bd911e2996346d9
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 10 13:20:52 2010 +0100

    virt-make-fs: Use Sys::Guestfs::Lib::feature_available helper function.

commit d1dd00606d0b5b1430598e5092b017aa15d9ee11
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 9 09:40:59 2010 +0100

    Allow aug-ls to take Augeas variable as argument (RHBZ#580016).

commit 3765f97898a1194d96ab4124e1eb46e25701b3b2
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 8 19:33:57 2010 +0100

    Remove warning "No grub default" (RHBZ#580650).

commit e35debd642bea240609775610b68145dab0a634b
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 8 19:07:45 2010 +0100

    If qemu dies during launch in "null vmchannel" mode, don't hang (RHBZ#579155).
    
    Detect if qemu dies during launch by wait(2)-ing for it, and
    then getting EOF on the qemu pipe.  This was broken in null
    vmchannel mode, causing a hang.

commit dc5df3bfec706803e75a5f2454293db30e753249
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 8 19:06:00 2010 +0100

    Don't kill self accidentally.
    
    Always check that pid > 0 before calling kill (pid, 9).  The
    issue was that sometimes pid == 0, and this ends up killing
    ourselves.

commit fb4ec82d97f71963ea7f830cb0bc38abefcbac99
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 8 18:53:40 2010 +0100

    Fix for "warning: unexpected connection from UID ..."
    
    This warning is currently a fatal error.  The code attempts
    to retry the accept call, but because we don't reset sock = -1
    the retry doesn't happen and it dies anyway.
    
    Set sock = -1 so the retry attempt can happen.

commit 50195d6ec4e893f894ef1bbf7af6eeda56f96600
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 8 16:07:32 2010 +0100

    New API calls to upload/download txz files (RHBZ#580556).

commit 0ce9b2bb9bcac61f7fb5dd2811d9b3b621f8309b
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 8 15:49:14 2010 +0100

    configure: Default to using Fedora 12 repo (was Fedora 11).
    
    Fedora 11 is almost EOL at this point.

commit d0efcd6b63edb3e32a7ff0c7e032d06a2d16f348
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 8 15:17:07 2010 +0100

    Version 1.3.1.

commit d868221d9f746ab17b83e7220cef9227fcad3696
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 7 20:30:46 2010 +0100

    New tool: virt-make-fs for creating filesystems on devices.

commit de7ef2a0fdcbcddfd35ecb8ee2804e1ca0968454
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 7 21:04:01 2010 +0100

    Code cleanups related to RHBZ#580246.
    
    This includes various code cleanups:
    
     (a) A regression test for RHBZ#580246.
    
     (b) Use write instead of fwrite to write out the tar file.  This is
         just because the error handling of write seems to be better
         specified and easier to use.
    
     (c) Use size_t instead of int for length.
    
     (d) Clearer debug messages when in verbose mode.

commit 07f4b20ae959069fca41756b0dc103ec5fa99754
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 8 08:48:38 2010 +0100

    Fix tar-in command hangs when running out of disk space (RHBZ#580246).
    
    The problem was this sequence of events:
    
     (1) File transfer goes through OK.
    
     (2) pclose returns failure (because 'tar' subprocess failed)
    
     (3) We try to cancel the transfer by calling cancel_receive.
    
    Step (3) fails because the transfer (as far as the library is
    concerned) has succeeded, so causing a hang.
    
    The more fundamental reason why we see steps (1) and (2) is that
    'tar' does NOT fail immediately if there is a write error.  Instead
    it continues reading and discarding the input until the end of the
    input before giving "Error exit delayed from previous errors".
    IMHO this is a bug with tar, since an ENOSPC write error should
    be fatal for tar.

commit 4c50f4c38d9a50fbf983c79dd208d1b1598fef8a
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 6 23:54:08 2010 +0100

    fish: Print extended help when the user types an unknown command first.
    
    $ guestfish /tmp/disk.img
    /tmp/disk.img: unknown command
    Did you mean to open a disk image?  guestfish -a disk.img
    For a list of commands:             guestfish -h
    For complete documentation:         man guestfish

commit 2ade61d1f864c75ce65c358e4ac8a012a897b89a
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 6 11:03:03 2010 +0100

    Check error returns from posix_fallocate (RHBZ#579664).
    
    posix_fallocate has a non-standard way to return error indications.
    Thus all our calls to posix_fallocate were effectively unchecked.  For
    example:
    
      $ guestfish alloc test.img 1P
      $ echo $?
      0
      $ ll test.img
      -rw-rw-r--. 1 rjones rjones 0 2010-04-06 11:02 test.img
      $ rm test.img
    
    With this change, errors are detected and reported properly:
    
      $ ./fish/guestfish alloc test.img 1P
      fallocate: File too large
    
    This is a fix for:
    https://bugzilla.redhat.com/show_bug.cgi?id=579664

commit f42f2df8bc45b70064f52b0b279317931c8568fc
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Mar 31 13:19:34 2010 +0100

    Signed/unsigned warning on 64 bit.

commit ce3a9c56b712731dd6ac3694f7e8ac117e2a61dc
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Mar 31 13:19:34 2010 +0100

    New API: guestfs_zero_device to zero whole devices.

commit fb0375a0984efca96db1277398f9fe50ecdd578d
Author: Richard W.M. Jones <rich@annexia.org>
Date:   Tue Mar 30 21:07:27 2010 +0100

    Prettier POD CSS.

commit b08725d3be546ebb6c24b9adc0dcc7b33fc0f580
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Mar 30 17:49:44 2010 +0100

    Update PO files.

commit 2e47daea514fe577bf8b1661ceb070103e20ded1
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Mar 30 17:49:24 2010 +0100

    chmod +x virt-resize binary.

commit 855c321b59ef348f692ec83d16ce1dd99bda65a2
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Mar 30 17:49:06 2010 +0100

    Fix EXTRA_DIST rule.

commit e17c5a24b8dbbef76e183856c4c770b4754c4539
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Mar 30 17:05:56 2010 +0100

    Prepare for 1.0.89.

commit 4b48f93ce6407923ea23451cfe39ac63811d1f42
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Mar 26 17:14:04 2010 +0000

    Improved version of virt-win-reg, supporting exporting and merging.

commit 29c78cc979297b95407a5956b4caa34240a2f5a8
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Mar 30 16:14:09 2010 +0100

    virt-df: Match output with native (coreutils) 'df' command (RHBZ#578123).
    
    This commit fixes the 'Use%' field in the output so it matches what
    coreutils' 'df' command would print.
    
    Firstly we change the calculation to use the space available to root,
    not the space available to non-root.  This means it matches what 'df'
    when run as root in the guest would show.
    
    Secondly we display this rounded up to the next whole percent (ie. using
    ceil), which is also what 'df' does.
    
    Thirdly we change the regression test so it tests this.
    
    Note that even with these changes you are not guaranteed to get precisely
    the same figures from inside and outside the guest, as it depends on
    how quiescent the guest is and how recently the superblock was synced.
    
    Thanks: Rita Wu

commit fc5fbd460aa0aaf6bb65ca5fa1be59345f4f079f
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Mar 30 14:18:44 2010 +0100

    tools: Add basic tests for the virt-* tools.

commit bbe4888cd4aac8f67c6d34e67d8f622c0c4bfcb4
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Mar 30 13:45:16 2010 +0100

    tools: Sectional header for manpages in Makefile.am

commit f25da97554885d5032f124e12c1995d6eab720dd
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Mar 30 13:44:29 2010 +0100

    tools: Rearrange list of tools in Makefile.am.

commit 641e8275b3b63b68c82ef80735bb55f9da05ef2c
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Mar 30 13:34:16 2010 +0100

    daemon: Set TERM=dumb inside the daemon.
    
    Since commit 977edb3185fe8f we have been passing TERM from the
    library into the appliance (for the benefit of virt-rescue).
    However this changes the output of parted, which I would argue
    is a bug in parted:
    
     TERM=xterm /sbin/parted -m -- /dev/sda unit b print 2>&1 | hexdump -C
     00000000  1b 5b 3f 31 30 33 34 68  42 59 54 3b 0a 2f 64 65  |.[?1034hBYT;./de|
    
    Notice the escape-sequence junk before the official "BYT;"
    header.
    
    By setting TERM=dumb we avoid this.

commit f826ce4876135a8abb72383aa5a5681f045f5367
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Mar 27 11:02:03 2010 +0000

    Fix the error message when reply body is too large (RHBZ#509597).

commit ef3a6692412b234a46326d330943556977f7c988
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Mar 27 10:49:24 2010 +0000

    tests: Move alarm(2) calls to the correct place in the tests.
    
    This is a re-fix for RHBZ#505329.

commit 650159fce9b5d6424c233e42aa36c94e13dc2a1b
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Mar 26 21:08:43 2010 +0000

    Prepare for 1.0.88.

commit 977edb3185fe8f0cc01840227ac6d3ea1785d3c9
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Mar 26 20:08:45 2010 +0000

    rescue: Pass $TERM from library into the virt-rescue appliance.
    
    We set it on the kernel command line, then get it out from
    there when the rescue appliance boots.

commit cd551619947d5f1683bca3581da1e35abcad47c2
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Mar 26 20:02:10 2010 +0000

    rescue: Sync disk on exit, and improve messaging.

commit b6a0c8565cdf27e6d4fdf7adb1a66b30d45d5b92
Author: Jim Meyering <jim@meyering.net>
Date:   Fri Mar 26 20:01:45 2010 +0000

    Const-correctness fix.

commit 9e0b31a2af26b8d58a44dd80993a5e73d4942307
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Mar 26 10:10:16 2010 +0000

    appliance: Set $PATH instead of hard-coding paths to binaries everywhere.
    
    Change the appliance so PATH includes common directories.  Thus
    we don't need to hard-code paths to binaries (eg. "/sbin/fdisk")
    everywhere.

commit 57c143da4d9b9e75e6da83ef3b8e8c0979c6f0f6
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Mar 25 19:44:22 2010 +0000

    perl: use newSVpvn for variable length strings.
    
    Previously we used newSVpv (str, len), but if len == 0 then
    this means Perl tries to calculate the string length using
    strlen(3).  This is not desirable when we know the length, in
    which case we should use newSVpvn instead.

commit 3e9d96d246f75bd7d2aa592b84bd6446687cad85
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Mar 25 16:03:42 2010 +0000

    Update PO files.

commit 5a5be3c25cbec7f9e4805446f0a8a6529aee0a8f
Author: Daniel Cabrera <logan@fedoraproject.org>
Date:   Thu Mar 25 16:03:01 2010 +0000

    Update Spanish translation of libguestfs (RHBZ#576876).

commit 00a9ae7365e6bad258bcf079a18dcae94d0853ad
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Mar 24 23:28:14 2010 +0000

    Fix lvresize test on RHEL 5, by fixing guestfs_e2fsck_l.
    
    The problem is that mkfs was making an ext2 filesystem,
    which later we were checking with e4fsck.  e4fsck corrects
    an "error" on the filesystem:
      /dev/VG/LV: Adding dirhash hint to filesystem.
    e4fsck returns 1 (errors corrected) which we were interpreting
    as an error return.

commit c4e8aa245a243b020d6b7bd832674be871a43610
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Mar 24 22:02:34 2010 +0000

    Use ext4 dev tools on RHEL 5 (RHBZ#576688).

commit f57f1012a637a9950af43bf1b4925fa6b233789a
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Mar 24 21:21:23 2010 +0000

    Add support for minix filesystem (RHBZ#576689).

commit 0c43d6378131775fd08626743975c7f2551e1c1e
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Mar 23 22:10:45 2010 +0000

    Version 1.0.87.

commit def627e4daf2d32cebf91f5e01f44a0b7e512129
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Mar 22 18:38:31 2010 +0000

    New tools: virt-resize and virt-list-partitions.
    
    Virt-resize is the main contribution here, a program which can
    be used to expand and shrink partitions in disk images.
    
    Virt-list-partitions is used as an ancillary tool for planning
    resize operations.

commit b6483061c25e90ae1b9e016812dea8e3756d6c23
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Mar 22 18:36:16 2010 +0000

    New API: guestfs_copy_size to copy a fixed number of bytes.
    
    This is similar to 'guestfs_dd', but it copies just a fixed
    number of bytes from the source to the destination.  It's an
    error if the source is too short or if the destination is too
    small.

commit 5d90acbe4b670e14084bbe9d11b717bfb6d95603
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 19 17:21:05 2010 +0000

    Change some _exit(0|1) to _exit(EXIT_SUCCESS|EXIT_FAILURE).

commit cef4ba0b8fec2b95153a07ac9537306e50ba167f
Author: Richard Jones <rich@koneko.home.annexia.org>
Date:   Mon Mar 22 10:30:25 2010 +0000

    Mac OS X: Fix configure-time tests for Ruby.
    
    For ARCHFLAGS change, see:
    http://www.ruby-forum.com/topic/129717#579065
    
    We also add a test for the <guestfs.h> header and include
    that header when testing the library.

commit e5fa90a795ab632918081195c356aa4c02ab61cd
Author: Richard Jones <rich@koneko.home.annexia.org>
Date:   Mon Mar 22 10:29:18 2010 +0000

    guestfs.h: Include <stdint.h>.
    
    This allows programs to work if they just
      #include <guestfs.h>
    and no other headers.  It's not useful in the general
    case, but fixes some configure-time tests, particularly
    the one for Ruby on OS X.

commit 82bd4fac87dce677a69bc5297f11799baf3eb1f5
Author: Richard Jones <rich@koneko.home.annexia.org>
Date:   Mon Mar 22 10:05:49 2010 +0000

    ocaml examples: Fix linking line so it uses local library.

commit 36e8ece4ccdf0cb65cd6a8bb30d95c9813335645
Author: Richard Jones <rich@koneko.home.annexia.org>
Date:   Sun Mar 21 21:47:39 2010 +0000

    Mac OS X: Disable null vmchannel implementation.
    
    As far as I can tell, Darwin has no way to check the peer euid
    of a _loopback_ TCP socket.  This is required for the "null vmchannel"
    implementation to work securely.
    
    Therefore disable this - Darwin will use one of the other supported
    vmchannel implementations instead.

commit d4a202aa7bf45382e84f558239dadc24c73d195d
Author: Richard Jones <rich@koneko.home.annexia.org>
Date:   Sun Mar 21 20:41:41 2010 +0000

    Mac OS X: 'xdr_uint32_t' is 'xdr_u_int32_t'

commit fd8b87ec2b0e535e04508595c3da3e32382f6af0
Author: Richard Jones <rich@koneko.home.annexia.org>
Date:   Sun Mar 21 19:45:50 2010 +0000

    Mac OS X: For PATH_MAX, include <limits.h>

commit 9e397cc16be51f4f3940c7a5b90d0bc43f3f13a8
Author: Richard Jones <rich@koneko.home.annexia.org>
Date:   Sun Mar 21 19:30:25 2010 +0000

    Mac OS X: setlocale function requires <locale.h> header file.

commit dd12eaefb5879255be78f8233f7e503ffbf7c4f1
Author: Richard Jones <rich@koneko.home.annexia.org>
Date:   Sun Mar 21 19:15:40 2010 +0000

    Mac OS X: implement readline functions.
    
    OS X has an older version of readline with some differences
    in the names of functions.

commit 5ebf3a39340696fea0582a58074d22d11247a6e7
Author: Richard Jones <rich@koneko.home.annexia.org>
Date:   Sun Mar 21 19:13:43 2010 +0000

    Mac OS X: provide alternate implementation of posix_fallocate.

commit b2070ae3d797a32a8227c6b9231efa249c94d330
Author: Richard Jones <rich@koneko.home.annexia.org>
Date:   Sun Mar 21 17:49:49 2010 +0000

    Mac OS X: include <rpc/types.h> before <rpc/xdr.h>
    
    In PortableXDR this is not included automatically so we
    have to include it explicitly to get definitions for the
    XDR types.

commit cc6a6a3dcc8e03410a645500c28ee781c95c795f
Author: Richard Jones <rich@koneko.home.annexia.org>
Date:   Sun Mar 21 17:49:09 2010 +0000

    Mac OS X: include <string.h> in guestfs-actions.c
    
    This is required because guestfs-actions.c uses 'memset'.

commit b369fa6f91185efd4503aba4565671b8a0380d23
Author: Richard Jones <rich@koneko.home.annexia.org>
Date:   Sun Mar 21 17:16:04 2010 +0000

    Mac OS X: Fix HAVE_GNU_CALLOC so it works when __GLIBC__ is not defined.

commit a28791d6ac818761405fe898c600bafd7137b857
Author: Richard Jones <rich@koneko.home.annexia.org>
Date:   Sun Mar 21 17:15:26 2010 +0000

    Mac OS X: strerror_r on Macs is not like GNU strerror_r.
    
    Really this should be turned into a configure-time test.
    Perhaps one exists already?

commit a6802f80b3b91bfc7d6846db2989c381385e6a15
Author: Richard Jones <rich@koneko.home.annexia.org>
Date:   Sun Mar 21 17:14:37 2010 +0000

    Mac OS X: define MAX macro if not already defined.

commit 73e472f1f1e9b8830cb74f06659e95507696a4f9
Author: Richard Jones <rich@koneko.home.annexia.org>
Date:   Sun Mar 21 17:14:15 2010 +0000

    Mac OS X: kill(2) requires <signal.h>

commit 1bf76681103c755b1a650e002292aa33f7d0babf
Author: Richard Jones <rich@koneko.home.annexia.org>
Date:   Sun Mar 21 17:13:07 2010 +0000

    generator: Small fix for GODI users.
    
    GODI has an odd package layout, so the generator was unable to
    find xml-light.  Add the GODI directory to the search path.

commit df54298591bec8d34e7855c3528a2d5d450ffb20
Author: Richard Jones <rich@koneko.home.annexia.org>
Date:   Sun Mar 21 16:06:30 2010 +0000

    Ignore m4/intmax.m4

commit 35e916dbcf06ace10c73e67a0a20bae87bb0733b
Author: Richard Jones <rich@koneko.home.annexia.org>
Date:   Sun Mar 21 16:04:09 2010 +0000

    Remove out-of-date comment.

commit ef044690c54deb597bfe706cb88849dda5ebe8fc
Author: Richard Jones <rich@koneko.home.annexia.org>
Date:   Sun Mar 21 16:03:16 2010 +0000

    configure: Add --disable-daemon and --disable-appliance options.
    
    Use these on any platforms where you don't want or need to
    build the daemon/appliance combination.

commit b7d59e2cdaa73b42a2063a0653151bae20497074
Author: Richard Jones <rich@koneko.home.annexia.org>
Date:   Sun Mar 21 16:33:37 2010 +0000

    Run qemu with -nographic option.
    
    On Mac OS X this prevents a short "flash" as qemu opens a
    toplevel window.

commit a7cb2d9b08ca038a96aa180fee0f5e8745d2928d
Author: Richard Jones <rich@koneko.home.annexia.org>
Date:   Sun Mar 21 16:32:27 2010 +0000

    configure: Move host_cpu definition to earlier in the file.

commit 4a065c99e450446e0a9293fa663f97dfed2aa405
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Mar 21 21:23:47 2010 +0000

    appliance: Run depmod to create modules.dep for the kernel.
    
    Since we disabled running new-kernel-pkg in febootstrap, this
    has meant that the normal appliance has not had a modules.dep
    file.  (Supermin was unaffected by this).

commit 7581672c7893fd392ca10b47f044af327011f502
Author: Richard Jones <rich@koneko.home.annexia.org>
Date:   Sun Mar 21 19:30:52 2010 +0000

    Mac OS X: Detect bindtextdomain.
    
    These are missing on Mac OS X.  I think you would need to install
    a gettext package to get these.

commit f5d52fa3c00e525cd5d86089b85f970a5c4e7c21
Author: Richard Jones <rich@koneko.home.annexia.org>
Date:   Mon Mar 22 08:29:17 2010 +0000

    Mac OS X: Use gnulib setenv module explicitly.
    
    See:
    https://www.redhat.com/archives/libguestfs/2010-March/thread.html#00094

commit 50d2af4f8541a81d047753d7d300804ff649230c
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Mar 18 13:48:03 2010 +0000

    New APIs: Query the relationship between LVM objects.
    
    These calls allow you to query the relationship between
    LVM objects, for example, which PVs contain a VG, or which
    LVs are contained in a VG.
    
    See the example / test program 'regressions/test-lvm-mapping.pl'
    for an example of how to do this from Perl.

commit 27e73269d384814eb5f76468f609f7844cb75b0b
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Mar 18 13:46:26 2010 +0000

    daemon: Add a trim utility function.
    
    This function trims the whitespace from around a string.  It
    does this in-place, so it can be called for malloc'd strings.

commit 676462684e05dd8341dd695762dd99a87d8ec022
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Mar 16 21:50:13 2010 +0000

    add_drive_ro adds readonly=on option if available.
    
    Change the add_drive_ro call so it adds the readonly=on option
    if qemu supports that.
    
    This just means that qemu will not try to open the drive with
    O_RDWR, and should not otherwise change the behaviour of qemu or
    libguestfs.  (In particular, writes to the read-only drive are
    still permitted, and are just discarded when the handle is closed).
    
    However it should alleviate RHBZ#571714 where udev was deciding
    to incorrectly relabel a device because we had opened the device
    for writing (even though we didn't actually write to it).

commit 5442f45aea522a728fa5b06396d4f08d8506d7de
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Mar 16 21:44:26 2010 +0000

    Allow qemu_supports to run earlier.
    
    Reimplement qemu_supports() internal function.  Allow it to run
    before launch so we can test qemu features.  Document that you
    should run guestfs_set_qemu as early as possible to make sure
    these tests are reliable.

commit f8d781a00dcc9936802853d624ca92451463ab7f
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Mar 16 20:06:12 2010 +0000

    Add minimal vim to the appliance for virt-rescue.
    
    virt-rescue lacks an editor.  Add vim-minimal (Fedora)
    or vim-tiny (Debian) to make up for this omission.

commit 760a1c84d7e83fede50bb635749f092fb8b191c0
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Mar 16 21:11:23 2010 +0000

    tests: Don't use <guestfs-internal.h> in tests.
    
    It was failing when including this header, as a consequence
    of earlier commit 1f56debfcfdc35d6b0.

commit d89955fde9806d1125e03cc3caddea12df9d0cfa
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Mar 16 11:50:39 2010 +0000

    guestfs.h: More adjustment to comments in the header file.

commit 1f56debfcfdc35d6b0e7fec469dba0598d7f1901
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Mar 16 11:18:51 2010 +0000

    guestfs.h: Move some internal functions to the internal header.
    
    Functions like guestfs__send were never exported through the public
    API (libguestfs.syms prevented that).  However they appeared in the
    public header.  Move them to the internal header.

commit 504177b0aad966ef6db90190ad81eb1a75a193ce
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Mar 16 11:15:28 2010 +0000

    Rearrangement and comment changes in <guestfs.h> header file.
    
    There should be no substantive change.

commit 84bcb4dbee2f3b359409e911deaf82e6e5d0ab43
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Mar 12 18:28:21 2010 +0000

    Prepare for version 1.0.86.

commit 369872b91ed50e2803dc2837183258776e9868e0
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Mar 12 16:23:46 2010 +0000

    Tab to space (whitespace fixes only).

commit ffa3af3b5dd234012f9f4b9c28d483ff371f0ecc
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Mar 12 16:23:14 2010 +0000

    Docs: Change exit(1) -> exit(EXIT_FAILURE)

commit cb9613b993792c1c4b14fa0d9b5001ff644ac2f4
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Mar 12 16:20:31 2010 +0000

    Rewrite libguestfs-supermin-helper in C.
    
    libguestfs-supermin-helper was previously a shell script.  Although
    we had steadily optimized it, there were a number of intractable
    hot spots:
    
      (1) cpio still reads input files in 512 byte chunks; this is *very*
        pessimal behaviour, particularly when SELinux is enabled.
      (2) the hostfiles globbing was done very inefficiently by the shell,
        with the shell rereading the same directory over and over again.
    
    This is a rewrite of this shell script in C.  It is approximately
    3 times faster without SELinux, and has an even greater speed difference
    with SELinux.
    
    The main features are:
    
      (a) It never frees memory, making it simpler.  The program is designed
        to run and exit in sub-second times, so this is acceptable.
      (b) It caches directory reads, making the globbing of host files much
        faster (measured this as ~ 4 x speed up).
      (c) It doesn't use external cpio, but instead contains code to write
        newc format cpio files, which is all that the kernel can read.  Unlike
        cpio, this code uses large buffers for reads and writes.
      (d) Ignores missing or unreadable hostfiles, whereas cpio gave a
        warning.
      (e) Checks all return values from system calls.
      (f) With --verbose flag, it will print messages timing itself.
    
    This passes all tests.
    
    Updated with feedback from Jim Meyering.

commit 891aac7a0c35eb25f853c3960eadf8f1f22ca60b
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Mar 12 09:47:38 2010 +0000

    guestfish: Use xstrtoll to parse Int params (RHBZ#569757 RHBZ#567567).
    
    Change guestfish so it uses xstrtoll to parse Int (31 bit)
    parameters.  This fixes two bugs on 32 bit platforms which
    failed when long = 32 bits.  long long = 64 bits on both.

commit 599f94c9c14c970dcfd7cec8d6898cd3b46af8ca
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Mar 12 15:10:28 2010 +0000

    Special case hostfiles handling for libntfs-3g.so
    
    The ntfs-3g project keeps bumping their soname, and this causes
    dependency problems for the Fedora package.  The root of the problem
    is we depend on /lib/libntfs-3g.so.<N>, but if <N> keeps bumping,
    the dependency keeps breaking.
    
    This commit changes the hostfiles (and hence dependency) to be on
    /lib/libntfs-3g.so.* instead.  The downside to this is we could end
    up pulling more files into the appliance than are strictly required,
    but it will fix the Fedora packaging problems being felt by the
    Fedora maintainer of ntfs-3g.
    
    After applying this commit, the change to hostfiles looks like this:
    
    @@ -1489,7 +1489,7 @@
     ./lib/libpam_misc.so.0
     ./lib/libdmraid.so
     ./lib/libidn.so.11
    -./lib/libntfs-3g.so.74
    +./lib/libntfs-3g.so.*
     ./lib/libext2fs.so.2.*
     ./lib/libpam.so.0
     ./lib/libsepol.so.1
    @@ -1520,7 +1520,6 @@
     ./lib/libnss_files-*.so
     ./lib/libgio-2.0.so.0
     ./lib/libpam_misc.so.0.*
    -./lib/libntfs-3g.so.74.*
     ./lib/libanl.so.1
     ./lib/libdevmapper-event-lvm2.so.2.*
     ./lib/libpthread.so.0

commit ebfcb7f23df4546977628dc718982730682a68c0
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Mar 8 19:31:12 2010 +0000

    inspector: Read information about Windows guests from the Registry.
    
    This commit changes substantially the way that we get information
    about Windows guests.  We now use the Windows Registry to get
    information such as the version, product name and much else.
    
    This uses Win::Hivex (ie. the hivex library).  'reged' is no longer
    needed or used.
    
    As an incidental change, this also tries harder to search for
    %systemroot%, in the case when we cannot find boot.ini (ie.
    Windows Vista and more recent).  This ensures we can get more
    detail from those versions of Windows.

commit 4851466ec5adbbc039222201f7c3b1bc3b97e84e
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Mar 8 19:27:02 2010 +0000

    inspector: Add product_name field to output.
    
    This is a free text string containing the "product name" of
    the OS.  It's mainly useful for Windows guests, and a forthcoming
    patch will get this field from the Windows Registry.

commit ed6fc794c8a2f64f8b987137b54551f4380177f3
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Mar 8 19:28:48 2010 +0000

    inspector: Don't crash if $os->{kernels} does not exist.
    
    ie. on Windows.

commit dcfa05f703ca0c281c12a14450d06dfb4ac7893d
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Mar 8 19:24:48 2010 +0000

    inspector: Sort application names.
    
    This ensures the list of applications is stable.

commit aca024e9766268e6a09a8aeedee562d10910ca6d
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Mar 8 16:04:09 2010 +0000

    Remove plymouth libraries from the appliance.

commit f550f31477794a434fb499f08b7f21aa3b8e8f79
Author: Daniel Cabrera <logan@fedoraproject.org>
Date:   Wed Mar 3 15:49:39 2010 +0000

    Spanish translation of libguestfs (RHBZ#570181).

commit 4891ff9945177e8666af8381d1e0a54b8ce363e2
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Mar 2 10:34:20 2010 +0000

    More complete fix for bash regexp quoting bug.
    
    Commit 457fccae1b665347 was not a complete fix, in that it
    didn't work properly on RHEL 5 era bash (3.2.x).  For example:
    
      file=libntfs-3g.so.74
      [[ "$file" =~ ^lib(.*)\.so\.([0-9]+)\. ]] && \
        echo "lib${BASH_REMATCH[1]}.so.${BASH_REMATCH[2]}.*"
    
    would on those old shells print:
    
      libntfs-3g.so.7.*
    
    It seems the final \. was being treated as a plain period (ie.
    match anything).
    
    The only way to work around this incompatibility is to assign the
    patterns to variables and match on those, ie:
    
      p='^lib(.*)\.so\.([0-9]+)\.'
      [[ "$file" =~ $p ]] && ...
    
    This works in both old and new shells.

commit d09a918e086c19b133fc92c4339038247cfd7443
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Mar 1 13:49:25 2010 +0000

    Prepare for version 1.0.85.
    
    Update PO files.

commit d9e2285837c81baea914107567d26442ec76e3fa
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Mar 1 14:17:12 2010 +0000

    fuse: Fix typo in test.

commit 457fccae1b665347f81045e8c7a3309d8328c4fc
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Mar 1 13:32:34 2010 +0000

    build: Fix for bash quoting in supermin-split.sh.in (RHBZ#566511 RHBZ#566512)
    
    Bash changed how the =~ operator worked, see bash FAQ question
    E14 http://tiswww.case.edu/php/chet/bash/FAQ and
    http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=487387#25
    (RHBZ#566511).
    
    This also stops stray "builddir" (yum database) files being
    incorporated into supermin hostfiles in Koji (RHBZ#566512).

commit afcb3695b6ce9036f8a531745e254f146507f2a0
Author: Piotr Drąg <piotrdrag@gmail.com>
Date:   Mon Mar 1 09:38:07 2010 +0000

    Updated Polish translations (RHBZ#502533).

commit 49d85054fc0088d8b8acab13799e32fabe972e96
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Feb 25 20:02:38 2010 +0000

    Remove bogus msgstr from kn.po.

commit de33cc91ee93f85f06b9976fdc5454c0eb851b8e
Author: Guido Günther <agx@sigxcpu.org>
Date:   Wed Feb 24 09:07:56 2010 +0100

    List application in Debian based vm images
    
    Hi,
    attached patch adds the code to list applications installed in Debian
    based vm images.
    Cheers,
     -- Guido
    
    >From 9427a14725b33415058a0713923c62bd231504ec Mon Sep 17 00:00:00 2001
    From: =?UTF-8?q?Guido=20G=C3=BCnther?= <agx@sigxcpu.org>
    Date: Tue, 23 Feb 2010 21:05:02 +0100
    Subject: [PATCH 2/2] Add application listing for Debian

commit b5c307b7d6c154337b1d2427b81418ebc9e16251
Author: Guido Günther <agx@sigxcpu.org>
Date:   Wed Feb 24 09:06:23 2010 +0100

    Debian package format
    
    Hi,
    Minor nitpick: the Debian folks usually refer to deb as the package format not dpkg.
    Cheers,
     -- Guido
    
    >From 7a9665d40e0a3109833de10f17831ae06fc8885a Mon Sep 17 00:00:00 2001
    From: =?UTF-8?q?Guido=20G=C3=BCnther?= <agx@sigxcpu.org>
    Date: Tue, 23 Feb 2010 21:04:37 +0100
    Subject: [PATCH 1/2] Debina package format is called 'deb' not 'dpkg'

commit d070a017f710244908617eaa8fa147bc335aa660
Author: Guido Günther <agx@sigxcpu.org>
Date:   Tue Feb 23 20:42:48 2010 +0100

    check for grub/menu.lst too
    
    On Tue, Feb 23, 2010 at 08:07:14PM +0100, Guido Günther wrote:
    > On Tue, Feb 23, 2010 at 07:52:43PM +0100, Guido Günther wrote:
    > > Hi,
    > > attached patch makes virt-inspector find the kernels on Debian systems.
    > > Since there is no /etc/grub.conf it falls back to
    > > $grubpartition/grub/menu.lst.
    > Patch got somehow broken. New version fortchcoming. Sorry for the noise.
    Attached now. No idea where the 'if' went in the first version ;)
     -- Guido
    
    >From d30b4946f017ff8bde9d4ff62f93c418a707d9e8 Mon Sep 17 00:00:00 2001
    From: =?UTF-8?q?Guido=20G=C3=BCnther?= <agx@sigxcpu.org>
    Date: Tue, 23 Feb 2010 19:50:40 +0100
    Subject: [PATCH] Check for grub/menu.lst if /etc/grub.conf can't be found

commit 4ff21ceb2561936fc2e204f0a02e6ca8fb8fd507
Author: Guido Günther <agx@sigxcpu.org>
Date:   Tue Feb 23 18:55:56 2010 +0100

    Use 'service' if installed
    
    Hi,
    attached patch should make:
    
    http://git.debian.org/?p=pkg-libvirt/libguestfs.git;a=blob;f=debian/patches/0003-appliance-Use-service-udev-start-instead-of-running-.patch;h=c9e6b8489807d4fb1247cb6a8b6f9799bad2a09e;hb=d3a21b5b6850fc3c6e7903d0f5cafa3eb4197d49
    http://git.debian.org/?p=pkg-libvirt/libguestfs.git;a=blob;f=debian/patches/0004-Ubuntu-Prefer-starting-udev-by-hand-instead-of-using.patch;h=64b65a971b186e6ab1c9351e94b46d6f5aa242e0;hb=d3a21b5b6850fc3c6e7903d0f5cafa3eb4197d49
    
    superflous. If there's an init script it uses 'service' or falls back to
    calling the init script directly if it isn't there, otherwise it starts
    udev directly. Tested on Debian only so far. The patch is based on
    Rich's above two patches.
    Cheers,
     -- Guido
    
    From: =?UTF-8?q?Guido=20G=C3=BCnther?= <agx@sigxcpu.org>
    Date: Tue, 23 Feb 2010 18:49:34 +0100
    Subject: [PATCH] Check for service and use it if it's there
    
    Based on Richard's two patches for the Ubuntu build.

commit 1ea1e536346f59fa63fdd33639ffc297282bfc37
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Feb 24 10:33:27 2010 +0000

    Update PO files.

commit d6a10efaaa51d4c565f79388eda7f909df0e92f9
Author: Shankar Prasad <svenkate@redhat.com>
Date:   Wed Feb 24 10:32:03 2010 +0000

    Added Kannada translations (RHBZ#567860).

commit a8c3723e3818b5a7a31520043c6831115ab9d0e0
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Feb 22 12:53:16 2010 +0000

    Spin off hivex as a separate upstream project.
    
    This commit makes the semi-independent hivex library into a
    separate upstream project.  The git repo for hivex is now:
    
    http://git.annexia.org/?p=hivex.git;a=summary
    
    Downloads of hivex are available here:
    
    http://libguestfs.org/download/
    
    All questions, patches, bugs etc should be sent to the libguestfs
    mailing list and bug tracker.

commit aa4700f0325743aaa16b525637b00ee61b39df13
Author: Guido Günther <agx@sigxcpu.org>
Date:   Sun Feb 21 16:07:20 2010 +0100

    enable scrub on Debian

commit 219b80cc6c9c1410c39a6e540214727e3e3cf022
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Feb 19 13:51:07 2010 +0000

    hivexsh: Print hex bytes >= 0x80 correctly.
    
    These were being interpreted as signed chars, and thus printed
    as "ffffff80" etc.

commit abe54abdd2a51f8fc6da26d4e5d4773f68da695e
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Feb 19 13:50:31 2010 +0000

    Remove unused Perl modules.
    
    These were 'use'd but not actually used.

commit c06ee4ba0207ce41537a4f35245c2e8e42b64772
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Feb 16 08:06:04 2010 +0000

    Update PO files.

commit 04ee1adc919cf70091df624cb4a087703bf599a9
Author: Rajesh Ranjan <rranjan@redhat.com>
Date:   Tue Feb 16 08:04:59 2010 +0000

    Add Hindi translations (RHBZ#565759).

commit 699f38f05f2545a2c188370500df17cc52cbdf98
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Feb 15 23:15:17 2010 +0000

    Turn ProtocolLimitWarning into link to documentation section.

commit e3f371fff23fa01fc8cedc030ffa9e38b9a3bdc3
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Feb 15 22:58:22 2010 +0000

    initrd-cat: Needs ProtocolLimitWarning.

commit dabe72cb8b7b23cc6e6158d458327313b8a8495a
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Feb 15 22:53:40 2010 +0000

    Remove references to FTP, replace with FUSE.
    
    We originally intended to implement an FTP server (and before
    than, an NFS server).  But we didn't implement either.  We
    did however implement a FUSE service (guestmount) which takes
    the place of both.

commit 1f0f0df9b19520979857ab42b192ba46e0bc36dd
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Feb 15 15:55:38 2010 +0000

    Remove some unused variables.
    
    Since we have to compile with -Wno-unused-variables, we don't
    spot unused variables in code.  I found these by compiling the
    code in Ubuntu.

commit 30a0b5cf1606c54cc527d758949422396763cbd3
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Feb 15 15:34:34 2010 +0000

    Distribute .gitignore files.
    
    These are useful for Debian since they keep the tarball unpacked
    in git.

commit ed83d770252dda356bc9f8ad19149ada5e8708a5
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Feb 15 15:33:13 2010 +0000

    Add 'make quickcheck' rule to run a quick check.

commit 2109327021f4d464e2693e507fa92f1497ba0792
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Feb 12 19:43:17 2010 +0000

    Version 1.0.84.

commit e9c37113104c1cfb234535adc9b52ad3880a41ce
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Feb 12 14:06:25 2010 +0000

    daemon: Don't need to prefix error messages with the command name.
    
    The RPC stubs already prefix the command name to error messages.
    The daemon doesn't have to do this.  As a (small) benefit this also
    makes the daemon slightly smaller.
    
    Code in the daemon such as:
    
      if (argv[0] == NULL) {
        reply_with_error ("passed an empty list");
        return NULL;
      }
    
    now results in error messages like this:
    
      ><fs> command ""
      libguestfs: error: command: passed an empty list
    
    (whereas previously you would have seen ..command: command:..)

commit 9b3ef85a3d1b43faa98bb5dc922f8a273a5e1dde
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Feb 12 13:42:57 2010 +0000

    generator: Don't prefix error messages with command name.
    
    The command name is already being added by the RPC stubs, so
    adding it again in Perl and C# just results in doubled error messages
    like:
      foo: foo: the error

commit c03b7e4d756597f30415260a84a3caee3d9d6bde
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Feb 12 12:13:40 2010 +0000

    Sys::Guestfs::Lib::open_guest: Add interface parameter.
    
    This allows you to override the default QEMU block device emulation.

commit 33b4b759afe58c959bdc8b904d618aa1d699a240
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Feb 12 12:08:58 2010 +0000

    Sys::Guestfs::Lib::open_guest: Remove freeform parameters.
    
    Remove the ability to pass freeform parameters to Sys::Virt->new.
    We don't use it, it makes the code more complex to modify, and
    indeed there are no other args that Sys::Virt->new supports so
    this would never be used.
    
    Also change $readwrite to $rw to match parameter name.

commit 946dc06bb861a38cae959416362e4561c9e4829a
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Feb 12 11:47:18 2010 +0000

    New APIs: add-drive{,-ro}-with-if allows you to set QEMU block emulation.
    
    The default if=... comes from configure time (currently it
    defaults to if=virtio).
    
    This change allows you to set the QEMU block emulation.
    
    We don't think this will be used very often, but virt-v2v
    requires it in order to work around a subtle problem with
    running 'mkinitrd' in an appliance attached to a guest.

commit 48a9ff73319d0d065bff2b9374c84bcf6438cb20
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Feb 12 11:46:40 2010 +0000

    generator: 'interface' is a reserved word in Java.

commit 8d70639e27c79ce88c1e61898536c17cd71258e7
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Feb 12 11:27:44 2010 +0000

    add_cdrom: Update docs for adding ISO images.
    
    See also RHBZ#563450 (NB: This commit does not fix the bug).

commit f93cbe5756cf052cce8049087afdcf714a3fc70c
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Feb 9 18:00:24 2010 +0000

    Use mount-options instead of mount to avoid implicit -o sync.
    
    guestfs_mount adds -o sync implicitly.  This causes a very large
    performance problem for write-intensive programs (eg. virt-v2v).
    
    Document this as a "gotcha".
    
    Change the tests, guestfish, Sys::Guestfs::Lib, guestmount to use
    mount-options instead.
    
    (Note that this gotcha does not affect mount-ro).
    
    The source of the performance problem was first identified by
    Matthew Booth.

commit 245ac5673700f54479e9408e8659cb68f80c344a
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Feb 9 16:30:18 2010 +0000

    Add -enable-kvm option to qemu command line.
    
    If the version of qemu being used supports -enable-kvm option,
    then check if /dev/kvm is openable and add this option.
    
    I have found this option makes no difference, although it is
    *supposed* to enable KVM (hardware virtualization) support.

commit e4fbe3e2cd130fa0b1b21a105729cd6ef32aac38
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Feb 9 12:26:22 2010 +0000

    New API call: initrd-cat to list a file from an initrd.

commit 80bc4ffe9341fea06fb1c1e2bd099a53db6655f2
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Feb 8 22:51:19 2010 +0000

    Remove invalid Plural-Forms header from ml.po.

commit c0baa7bdb2b404e8c808700984b3fc1a699d8dd7
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Feb 8 16:44:41 2010 +0000

    Documentation: Added a section on libguestfs gotchas.

commit 6c97a65ce768b357a1481cde0533d4cf0b8b931c
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Feb 8 10:18:31 2010 +0000

    Make virtio block driver be the default for the appliance.
    
    Previously this caused a serious performance regression,
    but we believe this is now fixed:
    https://bugzilla.redhat.com/show_bug.cgi?id=509383

commit a1d388f25859b1c205aebb04dcd4846aa47027a1
Author: Ani Peter <apeter@redhat.com>
Date:   Mon Feb 8 10:06:32 2010 +0000

    Added Malayalam translations (RHBZ#562710).

commit 0d4bc93c737455d75dacab78cb9d65f47c500add
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Feb 5 18:54:52 2010 +0000

    Distribute hivexsh.1.html HTML file.

commit 23e117d8cfb13647d52fa5037464936454351f0a
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Feb 5 18:40:14 2010 +0000

    Update PO files.

commit 665ddb18fafeea53dff508c7dfdd00536ccab52e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 5 17:02:47 2010 +0000

    RHEL5: Keep old automake happy by defining docdir

commit 75f803a9d59a168c611e8518df7b4f75fe3bc98c
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Feb 5 18:01:18 2010 +0000

    Add scripts to EXTRA_DIST.

commit a65cc6b06d870287771302c1965b8d692fdaf560
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Feb 5 17:19:30 2010 +0000

    Update PO files.

commit e543a9a21421e766169b421d48904c6b8ebbfe5e
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Feb 5 17:19:21 2010 +0000

    Prepare for version 1.0.83.

commit 6d7777d48001076a276a75bf491bb1cf138ff941
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Feb 5 17:19:01 2010 +0000

    Add files to EXTRA_DIST.

commit 75beebd0126df18f0badd8d80d5aecd130f52761
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Feb 5 15:12:09 2010 +0000

    hivex: example6: Don't double backslashes.

commit 8e15d5a1899106de5080196ddca392b2ff997ac9
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Feb 5 15:05:36 2010 +0000

    hivex: example6: Hypothetical addition of keys for viostor.

commit 90781ca7d22a22b9abb367c10707639c7bd31c5b
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Feb 5 14:50:19 2010 +0000

    hivex: Fix handling of inline VKs.

commit 0764b932676b66ffca9ffa4cc5a45ebac7d81748
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Feb 5 13:47:32 2010 +0000

    hivexsh: Set correct type for 'expandstring' values.

commit 348bcd59b3fdfd9f8de353260fb31d745388a64e
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Feb 5 12:59:43 2010 +0000

    hivex: Documentation and cleanups.

commit ba48a213aba137fd65df5c8407b6bd49f4476c24
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Feb 5 12:59:18 2010 +0000

    hivex: Make limits into macros.

commit 495aa36aa67a2d626f1a855a0d01cfd5caa86a26
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Feb 5 12:57:53 2010 +0000

    hivexsh: Remove unused variable.
    
    This removes an unused variable left over by
    commit ab608f3948d903af64e814b2e67949a1a71d93a4.

commit 3a06848a71f18106fd79f8c73b490eca82d54dfe
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Feb 4 16:33:18 2010 +0000

    hivex: Complete the implementation of adding child nodes.

commit 006795555e9aa67c0070df4d0ec2d1bb3650e2f9
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Feb 4 18:42:58 2010 +0000

    hivex: More debugging around nk 'unknown2' field.

commit 5b7f2f3f9f0420d914ca8672718539783571db4a
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Feb 4 17:59:11 2010 +0000

    hivex: Check hash fields in lf/lh records.

commit 9a7f01917f674d43ef4a9b056f303f5dc0031210
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Feb 4 16:32:22 2010 +0000

    hivexsh: del command: Fix error message.

commit 3932b383869a1029457fac172827ef2b538d77de
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Feb 4 16:31:55 2010 +0000

    hivexsh: lsval: Remove stray quotation mark.

commit 43504796252dc8c399f490927008fcbf7d97b27b
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Feb 4 16:31:09 2010 +0000

    hivexsh: cd command: fix error handling
    
    The error behaviour of hivex_node_get_child is subtle, so the 'cd'
    command wouldn't always report errors correctly.  This fixes it.

commit 3113582ef88d280cfa3c479cc705c3972c777fb7
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Feb 4 16:29:32 2010 +0000

    hivex: allocate_block should update valid block bitmap.
    
    The internal allocate_block() function wasn't updating the bitmap,
    so if you revisited a block which you had allocated in the same
    session, you could get an EFAULT error.

commit 51efd7de7d80c329b6dab214141eacf626657a95
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Feb 4 16:29:11 2010 +0000

    hivex: More debug messages.

commit d7175703994997a6c40cf78cd74809b82deb1ed4
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Feb 4 16:28:26 2010 +0000

    hivex: Documentation update.
    
    ntreg_lf_record can have id "lf" (old-style hashes) or "lh" (new-
    style hashes).

commit 023a1811a708ac107022133f8931d47442b23c09
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Feb 4 16:27:58 2010 +0000

    hivex: Some missing le32toh endianness conversions.

commit 6ecb9ef1418631a11e10d080ea88556750593f22
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Feb 4 14:12:04 2010 +0000

    hivexsh: Document some peculiarities of the "cd" command.

commit aef0d618b08dc9fb27fb3a729dd8926cff26ae0b
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Feb 3 18:10:38 2010 +0000

    hivex: Implement deleting child nodes.

commit e14d001fc929307cf017408856be6b753908ab43
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Feb 4 13:24:27 2010 +0000

    hivex: Add flags argument to internal get_children() function.
    
    When we later call get_children to visit the intermediate
    ri/lf/lh records, we have already deleted the subkey nk-records,
    so checking that those nk-records are still valid is not very
    helpful.
    
    This commit adds a flag to turn these checks off.

commit 01ba5f80ee02405f2a558e735e32957a710fdd5b
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Feb 4 13:26:04 2010 +0000

    hivex: Don't die on valid registries which have bad declared data lengths.
    
    Some apparently valid registries contain value data length
    declarations which exceed the allocated block size for the
    value.
    
    Previously the code would return EFAULT for such registries.
    However since these appear to be otherwise valid registries,
    turn this into a warning and just use the allocated block size
    as the data length (in other words, truncate the value).

commit 578a5774a3ec00aad31988079eb6aacddcf6643f
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Feb 3 18:09:52 2010 +0000

    hivex: Minimal registry example.
    
    This is the smallest registry you can make and still have it
    load correctly in Windows regedit.

commit d9d885e7c8d93f0623cb0525e725f86969bb1033
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Feb 3 18:04:31 2010 +0000

    hivexsh: Add 'setval' and 'commit' commands.
    
    This adds the 'setval' and 'commit' commands to the hivex shell.
    
    Also adds some example scripts showing use of these.

commit f604f9b0b44c17adcf7a799db06a7fc4c758c5e9
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Feb 3 17:59:03 2010 +0000

    hivex: Begin implementation of writing to hives.
    
    This implements hivex_node_set_values which is used to
    delete the (key, value) pairs at a node and optionally
    replace them with a new set.
    
    This also implements hivex_commit which is used to commit
    changes to hives back to disk.

commit 4718aeb9f0f743a05dfa342bc797617f3b9f96b3
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Jan 18 11:08:56 2010 +0000

    hivex: Add HIVEX_OPEN_WRITE flag to allow hive to be opened for writing.
    
    If this flag is omitted (as in the case for all existing callers)
    then the hive is still opened read-only.
    
    We add a 'writable' flag to the hive handle, and we change the way
    that the hive file (data) is stored.  The data is still mmapped if
    the file is opened read-only, since that is more efficient and allows
    us to handle larger hives.  However if we need to write to the file
    then we have to read it all into memory, since if we had to extend the
    file we need to realloc that data.
    
    Note the manpage section L</WRITING TO HIVE FILES> comes in a later
    commit.

commit db8a46aa1165479ddf2b551e81a7e96bb06fc942
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Feb 3 17:35:53 2010 +0000

    Tools for analyzing and reverse engineering hive files.
    
    This commit is not of general interest.  It contains the tools which
    I used to reverse engineer the hive format and to test changes.
    Keeping these with the rest of the code is useful in case in future
    we encounter a hive file that we fail to modify.
    
    Note that the tools are not compiled by default.  You have to compile
    each explicitly with:
    
      make -C hivex/tools <toolname>.opt
    
    You will also need ocaml-extlib-devel and ocaml-bitstring-devel.

commit 6ea059d6a1bd1be605278057025d34dee675d64d
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Feb 3 17:52:05 2010 +0000

    hivexsh: Change some exit(1) -> exit(EXIT_FAILURE)

commit 286113fa0a7d3b33facc80f06fbc0154fdda43b4
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Feb 3 17:50:51 2010 +0000

    hivexsh: Only print final \n when interactive.
    
    When hivexsh was called non-interactively, it would print an
    annoying extra line.  Only print this line if we are being
    used interactively.

commit ab608f3948d903af64e814b2e67949a1a71d93a4
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Feb 3 17:48:37 2010 +0000

    hivexsh: Change handling of prompt argument to rl_gets()
    
    Make the result of isatty into a global variable (is_tty).
    
    Change the rl_gets() function so it takes the prompt string
    instead of a "display prompt?" flag.  rl_gets() then consults
    the global to find out if it should display the prompt at all.

commit 933505a3be8ea5675151048a48b4746295b56d9b
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Feb 3 17:45:20 2010 +0000

    Document that this flag is clear for default keys.

commit 97dac113f9ee7d7f2ed581db789707ff759c8cb3
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Feb 3 17:44:39 2010 +0000

    Misc documentation and gitignore update.

commit e8ad7d2e1b1422680f9f862e7443de67328de135
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Feb 3 17:41:15 2010 +0000

    Move htole*/le*toh macros into a separate header file.
    
    This allows us to reuse these macros in hivexsh later.

commit 187651c138666d0555bc8ccdd129bb0f51caa72b
Author: Sandeep Shedmake <sshedmak@redhat.com>
Date:   Thu Feb 4 08:50:14 2010 +0000

    Add Marathi translations (RHBZ#561671).

commit f513c8876e548180f7d4286e56aae9308562152f
Author: Piotr Drąg <piotrdrag@gmail.com>
Date:   Tue Feb 2 22:08:24 2010 +0000

    Polish translations (RHBZ#502533).

commit 36a8928599f2decac40bdc4def2ca1b7fd69e2b3
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Feb 2 08:49:56 2010 +0000

    Update PO files.

commit 6121d53a90376b48dde11c184474ec1af5da6bad
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Feb 2 08:49:10 2010 +0000

    Add Gujarti translations (Sweta Kothari) (RHBZ#560918).

commit 9dc69372c804328ecd5883c9d139a7c2f45741f8
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Feb 1 14:50:19 2010 +0000

    Update Oriya translations (thanks Manoj Kumar Giri) (RHBZ#559498).

commit 73c587ff0f2f8f76af39b16dafb0949be7bf0883
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jan 29 19:12:34 2010 +0000

    hivex: Reimplement hivexget as a simple shell script.
    
    hivexget is currently a large C program.  Now that we have hivexsh
    (the shell) we can reimplement hivexget as a simple bash script that
    calls out to hivexsh.

commit 15a5511e038f53ade23fa998985ecd4de39b60d5
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jan 29 12:18:30 2010 +0000

    hivex: Add 'hivexsh' program (shell for navigating registry hives).

commit a6025c11d97ed5802b3729a93d224d2baa20ff12
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jan 29 14:56:13 2010 +0000

    Set locale in C programs so l10n works (RHBZ#559962).
    
    This commit adds the calls to setlocale &c to all of the current
    C programs.
    
    It also adds l10n support to hivexget and hivexml which lacked them
    previously.
    
    To test this, try:
    
    LANG=pa_IN.UTF-8 guestfish --cmd-help
    
    (You can only do this test after installing the package, or at
    least the 'pa.mo' mo-file in the correct place).

commit 088d0c53cfe0dcb20b87707a9055175b2fd6b72f
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jan 29 14:24:54 2010 +0000

    Another unreadable file: /var/log/yum.log

commit 35a2aa114d88f943586bf40c971844245b12e0d6
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jan 29 09:57:37 2010 +0000

    Update PO files.

commit 21cf5f7760b730902e4ab99dae46b8122395d17c
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jan 29 09:57:12 2010 +0000

    Add Tamil translation (RHBZ#559877) (thanks to I.Felix)

commit c9ca0143139af3c5cfe4240dc5366973c98f83e3
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jan 29 09:46:52 2010 +0000

    Update Punjabi translation (RHBZ#559480) (thanks Jaswinder Singh)

commit 2a224424acc47dc0f50fe605463bf2936fceb27c
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jan 29 09:02:14 2010 +0000

    Fix regressions/rhbz557655.sh when debugging is enabled (v2).
    
    The previous fix didn't cope with ordinary warnings emitted by
    qemu (eg. "open /dev/kvm: No such file or directory").  This
    is a hopefully more complete fix for the problem.
    
    See also commit 3cd7ce75f1ce5048a4d9f6aeaf66aff3194e1096.

commit 3cd7ce75f1ce5048a4d9f6aeaf66aff3194e1096
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jan 28 22:35:16 2010 +0000

    Fix regressions/rhbz557655.sh when debugging is enabled.
    
    The regression test for RHBZ#557655 would fail if debugging was
    enabled, because debug output would get mixed up with the test
    output.
    
    To reproduce the error do:
    
    LIBGUESTFS_DEBUG=1 make -C regressions TESTS=rhbz557655.sh check
    
    This commit disables debug for just this test.

commit 74fe427460bd2d455d2860c937ae81a8b5a1d1e7
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jan 28 22:06:27 2010 +0000

    Implement 'vgrename' and 'lvrename' APIs.

commit 3c973b8a960dfde022a7d49b30b8c6d504a182e3
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jan 28 19:28:21 2010 +0000

    Version 1.0.82.

commit 9a7640218c8c13d2924686d96457cfe0d3f91b1c
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jan 28 17:39:06 2010 +0000

    hivex: Const-correctness fix on header_checksum (thanks Jim Meyering).

commit f8753ae9f7c460b7d087820201c0619fe2130cdd
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jan 28 16:25:19 2010 +0000

    hivex: Update some previously unknown nk-record fields.
    
    Update these fields with what we found out from reverse engineering
    the file.  Also bring the unknownX field names into line with
    visualizer.ml.

commit 64fa7b9db7bd8bd543c2afa413ffbcc488988eab
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jan 21 17:07:42 2010 +0000

    hivex: Fix calculation of block size for vk data blocks.

commit c052b36385a56df3017b7e75a610add2b2cdea5a
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jan 21 17:07:21 2010 +0000

    hivex: Display incorrect block size as unsigned in an error message.

commit cb2ec65d5e4a4174b0f24635b971eeb2cdd964ff
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jan 21 16:19:49 2010 +0000

    hivex: display bad block offset in hex

commit 203013dc166efb4067711baab59d3fe513c67921
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jan 21 16:19:26 2010 +0000

    hivex: hive type in vk-record is an unsigned 32 bit int

commit 8635be75c5e5499c388049d10d28bc1313ca832c
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jan 19 15:21:06 2010 +0000

    hivex: Add missing le32toh conversion around field access.
    
    This was missing.  It only worked because we test on a little
    endian platform.

commit a1b72fd0ba5b2fb0a198247b00f9e7230ca8796d
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jan 19 15:20:36 2010 +0000

    hivex: Clarify some more fields.
    
    Taken from sentinelchicken.com documentation.

commit 09d988e8f1cfa42ef9a5abe5c9c151962aa1d2cc
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jan 19 12:22:10 2010 +0000

    hivex: Modify children/values functions to return intermediate blocks.
    
    Modify the functions that return child subnodes and values so they
    can also be used to return a list of the intermediate blocks.  This
    is so we can delete those intermediate blocks (in a later commit).
    
    We also introduce an offset_list structure which is used for collecting
    lists of offsets, ie. lists of nodes, values or blocks.
    
    Note that this commit should not change the semantics of the code.

commit a96877f75061ba35efa9fa5dde9fdcf7a1eeaf2a
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jan 19 10:06:00 2010 +0000

    hivex: Add value_any callback to the visitor.
    
    The visitor currently contains lots of value_* callbacks, such as
    value_string which is called back when the value has type string.
    
    This is fine but it makes it complicated to deal with the case where
    you just want to see 'a value', and don't care about its type.
    
    The value_any callback allows visitors to see values generically.

commit 5fe4d4718cf00876d8de20f4c297dc4ca69db1a4
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Jan 18 17:56:13 2010 +0000

    hivex: Move header checksum code into a function.
    
    This function can be reused later.

commit f1dc74b8d605c07f4b8d4ca0b8dcf3db8c18edd1
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Jan 18 15:24:16 2010 +0000

    hivex: page 'offset_next' field is really 'page_size'.
    
    The documentation, as usual, is contradictory.  However this
    field is definitely the page size in all observed registries.
    Furthermore the following field marked 'unknown' is always
    zero, although this contradicts what the sentinelchicken.com
    paper says.

commit fd70638e05d1e04b276c2504c34abe8c609d19b2
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Jan 18 14:14:40 2010 +0000

    hivex: Collect more statistics about registries.

commit 1e4614ca8f8d2b3d758fef733f1294c611502b94
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Jan 18 10:58:06 2010 +0000

    hivex: Store filename in hive handle.

commit 5eb38569991a3e932ee474921775b0a49fd69980
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jan 28 10:46:01 2010 +0000

    Added Oriya translations (RHBZ#559498).
    
    Translation by Manoj Kumar Giri.

commit dab98a0e52b9bb9930048b94d637a2fdb218fc45
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jan 28 09:59:08 2010 +0000

    supermin: Add special case for libgcc_s-*.so.N
    
    Because this file contains the GCC version and a date, it frequently
    changes on the host.  Create a special case so that this file is
    matched using a wildcard for the version/date part of the name.

commit 1577cb04fa67b94f922139c9b31459778ea8721b
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jan 28 09:49:27 2010 +0000

    Added translations for Punjabi (pa-IN) (RHBZ#559480).
    
    Translated by Jaswinder Singh.
    
    Also updated pot files.

commit 214babb060d9e85e72bad4633310a9b4a5fcb9dd
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jan 26 10:45:14 2010 +0000

    supermin: Prevent multilib corruption (RHBZ#558593).
    
    On some combination of installing, upgrading and removing the base
    libguestfs package on x86_64, multilib can corrupt libguestfs by
    leaving a copy of /usr/bin/libguestfs-supermin-helper around which
    references the wrong architecture (usually, contains links to the
    i386-based appliance, when the x86_64 appliance should be constructed).
    
    This commit changes libguestfs-supermin-helper so that the script is
    the same on all architectures.  Instead, the library passes the
    differences to the script (eg. $host_cpu).  Because the i386 and
    x86_64 libraries should be at different locations (/usr/lib vs
    /usr/lib64) this should prevent multilib from screwing things up.
    
    Related links:
    https://bugzilla.redhat.com/show_bug.cgi?id=558593
    http://rwmj.wordpress.com/2009/11/16/please-someone-shoot-multilib/#content
    https://bugzilla.redhat.com/show_bug.cgi?id=235752

commit 7de6391695120cb1cfc3b77a497d6cf235a453a7
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jan 27 15:30:03 2010 +0000

    Added Telugu translations (RHBZ#559237).
    
    Also ran 'make -C po update-po' to update the POT file.

commit 3c398c8928d3860ca9e3c413046b6f38318bb6ef
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Jan 25 16:16:55 2010 +0000

    supermin: Ignore more unreadable files found on RHEL 6.

commit c479a06f4bba4b0172194cd5def4bc0aed84f5c1
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Jan 25 12:22:36 2010 +0000

    Sync to latest Gnulib.

commit 58abe782bf7137526b4a5c7e6d5d2b145e3b09d2
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jan 22 11:01:06 2010 +0000

    guestfish: Use xstrtol to parse integers (RHBZ#557655).
    
    Current code uses atoi to parse the generator Int type and
    atoll to parse the generator Int64 type.  The problem with the
    ato* functions is that they don't cope with errors very well,
    and they cannot parse numbers that begin with 0.. or 0x..
    for octal and hexadecimal respectively.
    
    This replaces the atoi call with a call to Gnulib xstrtol
    and the atoll call with a call to Gnulib xstrtoll.
    
    The generated code looks like this for all Int arguments:
    
      {
        strtol_error xerr;
        long r;
    
        xerr = xstrtol (argv[0], NULL, 0, &r, "");
        if (xerr != LONGINT_OK) {
          fprintf (stderr,
                   _("%s: %s: invalid integer parameter (%s returned %d)\n"),
                   cmd, "memsize", "xstrtol", xerr);
          return -1;
        }
        /* The Int type in the generator is a signed 31 bit int. */
        if (r < (-(2LL<<30)) || r > ((2LL<<30)-1)) {
          fprintf (stderr, _("%s: %s: integer out of range\n"), cmd, "memsize");
          return -1;
        }
        /* The check above should ensure this assignment does not overflow. */
        memsize = r;
      }
    
    and like this for all Int64 arguments (note we don't need the
    range check for these):
    
      {
        strtol_error xerr;
        long long r;
    
        xerr = xstrtoll (argv[1], NULL, 0, &r, "");
        if (xerr != LONGINT_OK) {
          fprintf (stderr,
                   _("%s: %s: invalid integer parameter (%s returned %d)\n"),
                   cmd, "size", "xstrtoll", xerr);
          return -1;
        }
        size = r;
      }
    
    Note this also fixes an unrelated bug in guestfish handling of
    RBufferOut.  We were using 'fwrite' without checking the return
    value, and this could have caused silent failures, eg. in the case
    where there was not enough disk space to store the resulting file,
    or even if the program was interrupted (but continued) during the
    write.
    
    Replace this with Gnulib 'full-write', and check the return value
    and report errors.

commit 306077ac965cde0a5605782921d33a72bb77c382
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Jan 25 11:34:56 2010 +0000

    Add 'filesize' call.
    
    Returns the size of a file.  You can already do this with 'stat',
    but this call is good for scripting.

commit c9324c2025b2636cda243b71debcb6c6457c6001
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jan 21 10:54:34 2010 +0000

    Missing crc kernel module on RHEL 6 / Linux 2.6.32 (fixes RHBZ#557195)

commit 0c28fb1a520ac6dea018cf42e6e056fe439f2810
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jan 15 14:06:32 2010 +0000

    hivex: Various improvements in header parsing, thanks to better documentation.

commit f004c406e0ac78d7e70d13260f2eff7e0257b4d4
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jan 15 12:42:02 2010 +0000

    hivex: Print header fields.  Print all offsets in hex (in debug output).

commit ac8ee450dbe65990378ca9c13094b7187ae70b0d
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jan 15 12:41:34 2010 +0000

    hivex: Reenable checksum calculations, but don't check result.

commit add1be720e4f4abf95bec17eea346436c8d776c7
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jan 15 12:40:56 2010 +0000

    hivex: Update documentation.

commit 0221c671e4ce572c602f8576e82f89b4c02c6232
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jan 14 16:46:13 2010 +0000

    hivex: Send all debug messages to stderr.

commit fab4298b6361fa62ac649fb885b62cf4ce84ad1b
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jan 14 16:45:59 2010 +0000

    hivex: Remove stray debugging message.

commit d0507993a7c3b39c2c86323a79eb3f4bfd2d19fb
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jan 14 16:29:47 2010 +0000

    hivex: Documentation: Add environment variables section.

commit 949d6e79ad81db208e5181d01f01b736a271c1e5
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jan 14 16:29:40 2010 +0000

    hivex: Whitespace change.

commit 8df82f709ab65a0cd4b28f1e51e27aa9cc702481
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jan 14 16:21:47 2010 +0000

    hivex: Move STR* macros into C file.
    
    Don't pollute the public header file with these macros.

commit 80dc92b979249bd596d906c81c85ca614f14feea
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jan 14 13:26:46 2010 +0000

    hivex: Small updates to the documentation.

commit e28207d5ad7ed96e10467e38788239ef9690285e
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jan 13 14:55:04 2010 +0000

    Fix generation of HTML documentation for website.

commit 279c560c62deca26e633a1d10e9ae120b98cab0c
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jan 13 13:08:30 2010 +0000

    Add guestfs.pod and guestfish.pod to EXTRA_DIST.

commit 33ad9f02e17e8dbcbcf4a751315394e520569f14
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jan 13 13:03:28 2010 +0000

    Prepare for version 1.0.81.

commit 008cbfcc15aa051c2a84d20b3be4caaab77904ea
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jan 13 11:24:44 2010 +0000

    Update to latest Gnulib.

commit b4a4db522fed542f48aa60717e65061c5e83c919
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jan 7 12:21:42 2010 +0000

    qemu: Upstream regression of -stdio serial option.
    
    Best explained by the comment in the code:
    
        /* Newer versions of qemu (from around 2009/12) changed the
         * behaviour of monitors so that an implicit '-monitor stdio' is
         * assumed if we are in -nographic mode and there is no other
         * -monitor option.  Only a single stdio device is allowed, so
         * this broke the '-serial stdio' option.  There is a new flag
         * called -nodefaults which gets rid of all this default crud, so
         * let's use that to avoid this and any future surprises.
         */

commit ce68503d5c74585f7f4df8a9ad3d54f927dfbcad
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jan 6 09:55:57 2010 +0000

    inspector: Update example XML and RNG schema.
    
    This updates commit a59dcdbd1b0a28c960e3792165a13f2daf4f6c35.

commit a59dcdbd1b0a28c960e3792165a13f2daf4f6c35
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jan 5 23:04:57 2010 +0000

    inspector: Make RPM application data more specific (RHBZ#552718).
    
    List applications with epoch, release and arch data.
    
    If epoch is 0, don't store this as an empty string, but as
    undefined, and don't output empty <epoch/> element in the XML.

commit 5e180db9eefcd6b459b805c2215ba4d174e4eb83
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Jan 4 15:39:49 2010 +0000

    Use linker script to control visibility of symbols.

commit db430348cae9f99549a4f7e155a162e71fb9900d
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Jan 4 14:55:24 2010 +0000

    generator: Move all library generation code together.

commit a9666ce8bb5793bf725d8d6d18c5ce545bdaf4a4
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Jan 4 14:40:08 2010 +0000

    generator: Print total lines of generated code.

commit 70c853d67a0cd5e54c821cd08726b91174517221
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Jan 4 14:51:36 2010 +0000

    C#: Add documentation about experimental nature of these bindings.

commit c0e4b5dc693cefdc81a4ec7cc1073a2cae371803
Author: Richard Jones <rich@koneko.local>
Date:   Sat Jan 2 19:46:20 2010 +0000

    Experimental C# bindings.
    
    Tested in only limited situations, with Mono on Linux.

commit d3c615c2d6167e6f0ae4d23b2902ea08a66a11ae
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Jan 2 19:47:37 2010 +0000

    Update copyright years.

commit 8980c01b46eafcf4b5dc127e4696c2cbe1bff09f
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Dec 31 12:26:04 2009 +0000

    Move guestfs(3) and guestfish(1) man pages into subdirectories.
    
    These manual pages have for a very long time 'lived' in the top
    source directory.
    
    Clean up this situation by moving those manual pages (plus associated
    generated files) into the src/ and fish/ subdirectories respectively.

commit 500ab86509e819cdf9c379f0bf6f0076bdd2ab68
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Dec 31 12:16:10 2009 +0000

    generator: Move src/guestfs-bindtests.c next to other src/ files.

commit b177f05ed6e65a9fe1fddc6ca602edcb912ac363
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Dec 31 11:51:48 2009 +0000

    generator: Use Continuation Passing Style (CPS) in output_to function.
    
    This makes the code simpler, shorter and less error-prone.

commit de08dbc83037df26f48bdfda038531f457c192d9
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Dec 31 11:29:49 2009 +0000

    generator: Rename GPLv2 to GPLv2plus, LGPLv2 to LGPLv2plus.
    
    The licenses are "any later version", so reflect this in the
    naming of the parameter to generate_header.

commit 677e021225d05e92034a68cb9a9b487e5331d35d
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Dec 31 11:22:26 2009 +0000

    generated code: Set copyright years to 2009-xxxx when current year > 2009.

commit 2e2eb15df010bbcc605c86b0714ad1ca796fc96d
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Dec 31 11:20:56 2009 +0000

    Remove separate inspector_generator.ml, combine this with generator.ml.
    
    This commit combines the previously separate "inspector_generator.ml"
    program which generated bindings for virt-inspector.
    
    Having two separate programs caused no end of troubles for developers,
    so we now combine them into a single program.
    
    NOTE: OCaml xml-light is now *required* in order to rebuild the
    generated code.

commit 9ff1c97f04e8c0e513262893df71da0d31b34637
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Dec 31 10:52:08 2009 +0000

    generator: Comment and whitespace changes only.

commit 5c6147ecc7ee3cf657edb1e19ad5ab4e973424e0
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Dec 18 19:20:37 2009 +0000

    daemon: Work around udevsettle issue (RHBZ#548121).

commit b3c4ddc8634e8268b151dcbd7ddd35a7286f4f04
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Dec 16 11:53:48 2009 +0000

    Prepare for 1.0.80.

commit 168cdbebb6a4ed81cb2156057b0793487e854c4a
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Dec 16 11:57:51 2009 +0000

    Include latest Polish translations (Piotr Drąg, RHBZ#502533).

commit 1c0ab7ab954c01cac2c87425a4b027e44c80e645
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Dec 16 11:55:21 2009 +0000

    Update PO files.

commit ab100792a1fe13c3e8cc180c94a52c91f0493358
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Dec 16 11:54:53 2009 +0000

    build: Fix typo in filename.

commit 835c0186c8771bb1c850f6c82356f9c731323413
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Dec 16 11:53:30 2009 +0000

    build: Remove references to old contrib/ files which were removed.

commit 4b09663f01224c27f00376011022526437680078
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Dec 16 11:15:26 2009 +0000

    appliance: Special case handling for libbfd in the supermin appliance.
    
    The libbfd library has a constantly changing, non-standard and
    very long name, eg:
    
    /usr/lib64/libbfd-2.20.51.0.2-7.fc13.so
    
    Just add a special case to deal with this.  This fixes the guestfs_strings
    command, which relies on the external strings binary which uses this
    library.

commit 795cf46a03bbe6ca0cbbeb951b8aceaf6e29eaca
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Dec 16 11:04:10 2009 +0000

    appliance: Ignore unreadable dbus helper programs.

commit 3b0d91890da5244dd642a5e7e9fa07312851693d
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Dec 7 11:28:21 2009 +0000

    lib: Link with $(LTLIBTHREAD), required by Gnulib lock module.
    
    This fixes commit cada248a53858341c91f70392e8f5b6e47d9b4fe.

commit f025a9c41dca06452e03a7f0e55cda0b6764038c
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Dec 4 15:38:09 2009 +0000

    appliance: Fix code which gets list of kernels.
    
    The first 'ls' command was failing, so the second 'ls' command
    would never run at all.

commit 9e5fabbe01c0964f7124595beec01dde836d93a6
Author: Jim Meyering <jim@meyering.net>
Date:   Fri Dec 4 15:34:41 2009 +0000

    accommodate leading "+" in git submodule output
    
    * cfg.mk (_submodule_hash): Also filter out "+".
    * autogen.sh: Likewise.

commit cada248a53858341c91f70392e8f5b6e47d9b4fe
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Dec 4 14:35:55 2009 +0000

    lib: Add thread-safety to global list of handles.
    
    This commit uses the Gnulib 'lock' module to implement a mutex on
    the global list of handles which is stored by the library.
    
    Note that Gnulib nicely avoids explicitly linking with -lpthread
    unless the application program itself links to -lpthread.  Locks
    are only enabled in multithreaded applications.
    
    $ ldd src/.libs/libguestfs.so.0.217.0
            linux-vdso.so.1 =>  (0x00007fffcb7ff000)
            libc.so.6 => /lib64/libc.so.6 (0x00007f96a4e6c000)
            /lib64/ld-linux-x86-64.so.2 (0x00007f96a544d000)
    
    Please enter the commit message for your changes. Lines starting

commit 983e7a23456f413394a254f3aa4dbee271a30c47
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Nov 30 14:11:20 2009 +0000

    daemon error handling: Define a new function reply_with_perror_errno.
    
    This allows you to save the errno from a previous call and
    pass it to reply_with_perror.
    
    For example, original code:
    
      r = some_system_call ();
      err = errno;
      do_cleanup ();
      errno = err;
      if (r == -1) {
        reply_with_perror ("failed");
        return -1;
      }
    
    can in future be changed to:
    
      r = some_system_call ();
      err = errno;
      do_cleanup ();
      if (r == -1) {
        reply_with_perror_errno (err, "failed");
        return -1;
      }

commit 4b4e0d0d07bd34f4368c6a213ff757d4ebf98411
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Nov 27 14:14:21 2009 +0000

    daemon error handling: recursive_mkdir shouldn't need to set errno.

commit 50c239c045675c7480d88bf10857f3e85c3385d3
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Nov 30 13:55:04 2009 +0000

    daemon error handling: Clear errno before calling stub functions.
    
    This just ensures that we accurately report errors, even if our
    error path code doesn't set errno.  We won't end up with a bogus
    errno left over from a previous call.

commit f02acc3d307f210d418a0177f374d02a4f8ccb5a
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Nov 27 13:42:43 2009 +0000

    Whitespace change.

commit 582b64a7b18d846e03d5ed2d24036d566b964124
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Nov 26 22:33:52 2009 +0000

    virt-rescue: Freshen documentation.

commit 47ecaa9ad4224803313ecc1d5b96def8eed3dac8
Author: Richard Jones <rich@koneko.home.annexia.org>
Date:   Thu Nov 26 22:32:15 2009 +0000

    guestfish: Freshen documentation.

commit 940ef864d02584720e3ef4f55d680fa3432ba508
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Nov 26 15:38:48 2009 +0000

    daemon: Move prototypes around to keep functions grouped logically.

commit bba019781a0df3744ccbfe9e580786b66dc9afa9
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Nov 26 16:06:03 2009 +0000

    Fix error handling in 'zero' function.

commit 4d53df4d7399d35b51bd69d76e00539d1de825e0
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Nov 26 15:17:37 2009 +0000

    daemon/Win32: Add contributed test script to test daemon using Wine.
    
    This test script allows you to test limited features of the
    Windows daemon by running it on a standard Fedora host using
    Wine.
    
    Read contrib/README and contrib/guestfsd-in-wine.sh in detail
    before using.

commit 115bc4b816ae5e203dff07070ddc8819585f38e5
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Nov 26 14:42:54 2009 +0000

    Ignore guestfsd.exe (Windows daemon).

commit 7a2f4dbbcbe89ea25aea255c4220a0e81eb7b956
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Nov 26 14:34:35 2009 +0000

    Remove old contrib/febootstrap directory.

commit f4845292fbed5560483aa5512af3a409c4f2f7a2
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Nov 26 14:26:44 2009 +0000

    Update PO files.

commit a86eb0e0d2c67e2153139c681632edc72162b8ed
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Nov 26 14:13:27 2009 +0000

    Make realpath call optional, disable it for Windows.

commit 6699491803962a5dee13997f1cc98f119d7101f4
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Nov 26 11:58:27 2009 +0000

    build: update gnulib submodule to latest

commit 9799810df94af7fa67dc23106b407ffed2dc0ec4
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Nov 26 13:23:56 2009 +0000

    daemon: program_name must be defined for Gnulib error module.

commit 15ebf328911fb6376376889c99029bcf2dbe0033
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Nov 26 11:52:28 2009 +0000

    daemon/Win32: use gnulib modules connect, socket and symlinkat (for readlinkat).

commit fd84feb8229f792e22e3cbfa9bf7e8156947eb2f
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Nov 26 11:26:40 2009 +0000

    daemon/Win32: provide htonl, htons, ntohl, ntohs functions.
    
    These functions are not available on Windows.

commit b76462f7433d064019382992163e3553c7906ee7
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Nov 26 11:13:00 2009 +0000

    daemon/Win32: Use Gnulib perror module.

commit 929ba5a843722ab490dd6c8d6f38daf0a1858533
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Nov 26 11:01:01 2009 +0000

    daemon: Link guestfs_protocol.[ch] into the daemon directory.
    
    Instead of doing a recursive call into the src/ directory to build
    the object files, hard link the source files into the daemon
    directory and build them separately.
    
    See:
    http://www.redhat.com/archives/libguestfs/2009-November/msg00254.html
    
    Thanks to Jim Meyering for noticing a typo in the original version.

commit 12f3e9780f2f35f6b81da8eb90ff24dd9ac93253
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Nov 26 10:52:37 2009 +0000

    daemon: Typo generator_build -> generator_built

commit 8e33cd5f2f2e7e30525cb2a70d86de70e3d6a4f9
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Nov 26 09:31:35 2009 +0000

    daemon: Indent C macros to reflect nesting level.

commit fcae398873453d0542123e040b388c3be10b14f8
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Nov 26 09:29:02 2009 +0000

    daemon/Win32: Win32 can't fork message moved to separate function (Jim Meyering)

commit 0a302b78780bad541debf3d3c2f46ad42afecef3
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 25 22:20:22 2009 +0000

    guestfs documentation: Missing space.

commit 8504318756597061bc37de20147367fc5615d6ed
Author: Richard Jones <rich@koneko.home.annexia.org>
Date:   Wed Nov 25 21:41:51 2009 +0000

    guestfs: Update architecture section of documentation.

commit d32cf866981ff7287d480c97fdddaa59bcc0e9c7
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 25 17:12:00 2009 +0000

    Update PO files.

commit fafd87038bdbca159b67efa6ee1b52861daed1f4
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 25 17:10:33 2009 +0000

    daemon: Fix build on Unix.

commit 34ac5d7b7ad068319169410d293495d789893350
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 25 16:54:46 2009 +0000

    daemon: Fix sync() call on Unix.

commit b854ff35a3c8e077e7c021aca3a604f11123d101
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 25 16:33:00 2009 +0000

    daemon/Win32: update comment

commit ed08d34eb6aa5c8fa6d9fba52012da9eb793421d
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 25 15:00:19 2009 +0000

    daemon/Win32: Supply MAX macro for challenged platforms.

commit 8d0d8cd4a340dea6fd3d84ab5b361aa757d5e19e
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 25 14:59:30 2009 +0000

    daemon/Win32: Windows can't daemonize.

commit ea99d9ec56e52758ea0d9f01a605fbc51ec95fba
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 25 14:56:42 2009 +0000

    daemon/Win32: Windows replacement for umask.

commit 33bc8fb6d25143ebba54f34c8ea6f5841a71f3e5
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 25 14:53:17 2009 +0000

    daemon/Win32: Replace setenv with Win32 equivalent.

commit 55355491c5ad2535b99a31ec81241f7f9f92177e
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 25 14:45:20 2009 +0000

    daemon/Win32: Use xdr_u_int for PortableXDR compatibility.
    
    PortableXDR didn't support xdr_uint32_t.  xdr_u_int is the same type.

commit b884456237b71e1a39fae3fc60f5a168b020cd6b
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 25 14:40:52 2009 +0000

    daemon/Win32: Don't bother blocking SIGPIPE on Win32.

commit b20a0916d8711fd3fb448dc5d4febee9d7a6331c
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 25 14:40:39 2009 +0000

    daemon/Win32: Use gnulib getaddrinfo module.

commit 579465ec1f4fdb1789bf94ac7356a3c961f3ae93
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 25 13:07:05 2009 +0000

    daemon/Win32: Implement statvfs using GetDiskFreeSpaceEx.
    
    At the time of writing Gnulib didn't support Win32 for its
    fsusage API.  Therefore this patch uses GetDiskFreeSpaceEx
    if it's available (on Windows) otherwise falls back to using
    Gnulib fsusage.

commit 63516f39a0b1381ef3d06d9eb55141bf6c4466b0
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 25 12:24:01 2009 +0000

    daemon: Move statvfs code into separate file.
    
    This makes no functional change to the code.  It just moves the
    statvfs-related code out of daemon/stat.c into a new file called
    daemon/statvfs.c.

commit b3035e8d7c04a71d9a54ab7e52bc9e169ecf0b47
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 25 12:17:10 2009 +0000

    daemon: Use gnulib futimens module.
    
    Instead of checking for futimens support and falling back
    (incorrectly in one case) to using futimes, use gnulib's
    module.
    
    However the gnulib module does not yet support Win32, so
    this change is only really useful on platforms like RHEL 5.

commit 25081d62684eea9e704ecc0a0a15d2421b203356
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 25 11:59:20 2009 +0000

    daemon/Win32: Use gnulib pread module.

commit fdbc5aa711dde73eb448fbe13165c00a44272d00
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 25 10:26:48 2009 +0000

    sync: Windows implementation of sync() call.
    
    Replace calls to sync() with calls to sync_disks() which supports
    Win32 via FlushFileBuffers.

commit c2aad5cd929a9932c010d045462bd923162fb593
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 24 16:16:08 2009 +0000

    daemon: Alternate implementation of posix_fallocate.
    
    If the posix_fallocate function is not available [ie. Windows]
    use an alternate implementation that just loops and writes.

commit a9519654032d2f09e76870d5d04dae2dff752c5b
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 24 16:10:13 2009 +0000

    dd: Missing include of <string.h>
    
    Breaks compilation on Windows.

commit 34d5df70d858e02ae6adc6537e1a6ea2df938238
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 25 11:38:44 2009 +0000

    daemon/Windows: Define _WIN32_WINNT when compiling on Windows.

commit 62d6ae454f1f75b2a8dc29e681586db73884cd08
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 25 16:24:49 2009 +0000

    build: update gnulib submodule to latest

commit 65ab9e660b0bf38ec644bc36641f2a1de4aa1699
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 25 15:29:39 2009 +0000

    build: update gnulib submodule to latest

commit 4404688aa3b476c820ef6ed6bea7e855f0a53e90
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 24 18:17:07 2009 +0000

    supermin: Die with an error if no kernels found (RHBZ#539746).
    
    Updated with a suggestion from Jim Meyering to use the '-d'
    option to ls to avoid a future case of directories matching.

commit 299d5b9dd260d47ac5121126ecd0e3f7bc4830b5
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 24 15:19:08 2009 +0000

    New tool: virt-list-filesystems
    
    Use this program as a convenient way to list the filesystems
    available in a disk image or libvirt guest.
    
    Example:
    
      $ virt-list-filesystems /dev/vg_trick/Debian5x64
      /dev/debian5x64/home
      /dev/debian5x64/root
      /dev/debian5x64/tmp
      /dev/debian5x64/usr
      /dev/debian5x64/var
      /dev/sda1
    
    This is designed to make it easier for novices to use guestfish
    and guestmount.  In particular with guestmount this acts as a way
    to get a list of filesystems to use with the '-m' option.  ie:
    
      $ virt-list-filesystems unknowndisk.img
      /dev/sda1
      /dev/sda2
      $ guestmount -a unknowndisk.img -m /dev/sda1 /mnt

commit 9b6185b9bf8147e20563608b23eaafce9c5edc2f
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 24 14:27:56 2009 +0000

    availability: Document how to check for single API calls
    
    This documents how to use autotools and dlopen(3) to test for
    the availability of single API calls at compile time and run time
    respectively.

commit 979eda8a5d3ad5cd9a8fe95159258afd681307f7
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 24 14:05:57 2009 +0000

    availability: Add a test for this call.
    
    Because all the tested groups are optional, there's not really
    a group we can reliably test, therefore test against the
    empty list (which should not fail).

commit 3817708a5b182e8c170e653eb383961a34e30245
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 24 14:00:34 2009 +0000

    availability: Clarify and fix documentation.

commit b017cd67bb56284d05fc168d2b3536bee55b9ebf
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 24 14:04:28 2009 +0000

    generator: Passing "" to StringList tests should turn into empty list.
    
    This is a bug in the generator which wasn't being tickled.  If
    you had a test which expected a StringList or DeviceList parameter,
    and you passed "" to that test, then you'd (probably) expect to be
    testing an empty list, but in fact you got a single element list
    containing an empty string.  This fixes it so you get an empty list.

commit 6b2c7a23b6c2d81c9e1825e8eb88ab446f63bf94
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 24 16:00:23 2009 +0000

    daemon: Fix return value from aug_defnode.
    
    Bug fix - the return value from this function was wrong
    in the no-Augeas case.

commit 22e531bc459309d9a871a845cfacd1396ff5b7e4
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Nov 22 19:15:56 2009 +0000

    Implement 'dd' command.

commit acdcbac91e9f03333a47204f2a6c52ac03288305
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Nov 22 19:14:48 2009 +0000

    Use STRPREFIX instead of STREQLEN.

commit e496f30dc5fbfd2452f192b1f2c8dcfa075a55ed
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Nov 22 19:14:19 2009 +0000

    generator: second parameter to upload is Dev_or_Path, not String.

commit a7a88083f0c9d83828dc9154c1c053fcd735d9ba
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Nov 20 18:45:22 2009 +0000

    build: Add missing dependencies in perl directory
    
    make all in the perl directory was missing a check that the library had been
    built.
    
    make check in the perl directory was missing a check that the appliance and test
    images had been built.

commit 1b60344e672e4fc233d7fe6b8ecfcda46a40f4d5
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Nov 20 18:43:20 2009 +0000

    build: Ensure building appliance depends on guestfsd
    
    Previously, only the update.sh rule checked the daemon had been built. update.sh
    is called directly from within make.sh, so in that path the dependency was never
    checked. This adds the daemon dependency explicitly to the rebuild-from-scratch
    path.

commit 1befbee8b8c00026a2f98ab7bc1ed4ca67083042
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Nov 20 18:05:49 2009 +0000

    build: Don't re-check generator.ml for each generator_built in daemon directory

commit 8b135cb5527616d5bc0c829ac9633d511af86766
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Nov 20 17:52:27 2009 +0000

    build: Rebuild the daemon as necessary from other directories
    
    This change ensure that making the appliance will always rebuild the daemon if
    required.

commit d49890d5bca89f87d4e75017fd4f9ba4deb55edb
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Nov 21 21:11:44 2009 +0000

    Update TODO file.

commit 6ce12286729395250fca86eebdfcaaf8aca69f33
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Nov 20 18:20:28 2009 +0000

    perl: Add Sys::Guestfs::Lib::feature_available
    
    This is a nicer Perl wrapper around $g->available call.
    
    Update the other code in Sys::Guestfs::Lib to use it before using
    LVM, Augeas.

commit 64de216ac7b6ef94f801e214a989c578f26956e8
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Nov 20 16:32:53 2009 +0000

    availability: Skip tests when functions are not available.

commit 2d9953097b6d3b71122d444a4550047e97aee009
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Nov 20 14:10:06 2009 +0000

    availability: Add optional groups and implement guestfs_available call.
    
    The current groups are defined very conservatively using the
    following criteria:
     (a) Would be impossible to implement on Windows because of
         sheer architectural differences (eg: mknod).
     (b) Already optional (augeas, inotify).
     (c) Not currently optional but not implemented on older RHEL and
         Debian releases (ntfs-3g.probe, scrub, zerofree).
    
    The optional groups I've defined according to these criteria are:
    
     . augeas
     . inotify
     . linuxfsuuid
     . linuxmodules
     . linuxxattrs
     . lvm2
     . mknod
     . ntfs3g
     . scrub
     . selinux
     . zerofree
    
    (Note that these choices don't prevent us from adding more
    optional groups in future.  On the other hand to avoid breaking
    ABIs we would not wish to change the above groups).
    
    The rest of this large commit is really just implementation:
    
    Each optional function is classified using Optional "group"
    flag in the generator.
    
    The daemon has to implement a function
    
      int optgroup_<name>_available (void);
    
    for each optional group.  Some of these functions are fixed at
    compile time, and some do simple run-time tests.
    
    The do_available implementation in the daemon looks up the correct
    function in a table and runs it.
    
    We document the optional groups in the guestfs(3) man page.
    
    Also: I added a NOT_AVAILABLE macro in order to unify all the
    existing places where we had a message equivalent to
    "function __func__ is not available".

commit 8fd7f255d611d2092a244c4a48c6b7b4529e98b1
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Nov 20 13:06:49 2009 +0000

    availability: Add guestfs_available.
    
    Start a new API allowing groups of functions to be tested for
    availability.
    
    There are two reasons for this:
    
    (1) If libguestfs is built with missing dependencies (eg. no Augeas lib)
    then the corresponding functions are disabled in the appliance.  Up till
    now there has been no way to test for this except to speculatively
    issue commands and check for errors.
    
    (2) When we port the daemon to Win32 it is likely that major pieces of
    functionality won't be available (eg. LVM support).  This API gives
    a way to test for that.
    
    There is no change for existing clients: you still have to check for
    errors from individual API calls.
    
    For new clients, you will be able to test for availability of particular
    APIs.
    
    Usage scenario (A): An LVM editing tool which requires
    both the LVM API and inotify in order to function at all:
    
      char *apis[] = { "inotify", "lvm2", NULL };
      r = guestfs_available (g, apis);
      if (r == -1) {
        /* print an error and exit */
      }
    
    Usage scenario (B): A general purpose tool which optionally provides
    configuration file editing, but this can be disabled, the result
    merely being reduced functionality:
    
      char *apis[] = { "augeas", NULL };
      r = guestfs_available (g, apis);
      enable_config_edit_menus = r == 0;

commit 5c9004347fe5920e2d0aa905ec709a514f0d9e38
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Nov 20 11:48:51 2009 +0000

    daemon/Win32: Use gnulib modules for first porting to Win32.

commit 03cd3050b342cecbc6f657e85637d1d16dbc60ab
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Nov 20 16:48:38 2009 +0000

    build: Add missing dependency libguestfs.la->guestfs_protocol.h

commit e1b48287ebd6143ba516e427772dca04b4b8c75d
Author: Jim Meyering <jim@meyering.net>
Date:   Fri Nov 20 16:25:00 2009 +0100

    build: correct sed transformation to work also on .git-module-status
    
    My patch was wrong.
    I kept the sed transformation the same in the two places,
    but it wasn't strict enough to also work on the file contents.
    Sorry about that.  This fixes it.
    
    >From 93927cc7b9f63c414e5bfeb7eba393fde3295601 Mon Sep 17 00:00:00 2001
    From: Jim Meyering <meyering@redhat.com>
    Date: Fri, 20 Nov 2009 16:23:17 +0100
    Subject: [PATCH libguestfs] build: correct sed transformation to work also on .git-module-status
    
    * autogen.sh: Use a more strict sed transformation so it works also
    on the contents of .git-module-status, which has no prefix.
    * cfg.mk (_submodule_hash): Use a stricter sed regexp.

commit 1b4bab6db252abcc3daab11159b0e45862c10b4c
Author: Jim Meyering <jim@meyering.net>
Date:   Fri Nov 20 14:30:57 2009 +0100

    build: make autogen.sh update .git-module-status, as it should
    
    I ran autogen.sh, but then make was always failing like this:
    
        $ make
        cfg.mk:141: *** gnulib update required; run ./autogen.sh first.  Stop.
    
    Here's the fix:
    
    >From f743f32079fea2e8a17c7f5b59305e584c75dba0 Mon Sep 17 00:00:00 2001
    From: Jim Meyering <meyering@redhat.com>
    Date: Fri, 20 Nov 2009 14:29:55 +0100
    Subject: [PATCH libguestfs] build: make autogen.sh update .git-module-status, as it should
    
    * autogen.sh: Without this, "make" would always say "gnulib update
    required; run ./autogen.sh first", even after you'd run autogen.sh
    successfully.

commit a84dee0f8df3c5d6ef3ecd5423f6bed3086419ac
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Nov 20 12:18:06 2009 +0100

    maint: use EXIT_* symbol (not constant, 2) to indicate key/path not found
    
    * hivex/hivexget.c (EXIT_NOT_FOUND): Define.
    (main): Use exit (EXIT_NOT_FOUND), not "exit (2)".

commit 4d45c45f0928c7791429d351dc69b75167888f7d
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Nov 20 12:15:14 2009 +0100

    maint: use EXIT_SUCCESS and EXIT_FAILURE, not 0 and 1 in "usage", too
    
    Convert by running these commands:
    perl -pi -e 's/\b(usage ?)\(1\)/$1(EXIT_FAILURE)/' \
      fish/fish.c fuse/guestmount.c
    perl -pi -e 's/\b(usage ?)\(0\)/$1(EXIT_SUCCESS)/' \
      fish/fish.c fuse/guestmount.c
    * fish/fish.c (main): Replace 0/1 with EXIT_SUCCESS/EXIT_FAILURE.
    * fuse/guestmount.c (main): Likewise.

commit c372c7c23a298a940b8a0868396ef2ae0d824e4d
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Nov 20 12:09:42 2009 +0100

    maint: use EXIT_SUCCESS and EXIT_FAILURE, not 0 and 1 to exit
    
    Convert all uses automatically, via these two commands:
    git grep -l '\<exit *(1)' \
      | grep -vEf .x-sc_prohibit_magic_number_exit \
      | xargs --no-run-if-empty \
        perl -pi -e 's/\b(exit ?)\(1\)/$1(EXIT_FAILURE)/'
    git grep -l '\<exit *(0)' \
      | grep -vEf .x-sc_prohibit_magic_number_exit \
      | xargs --no-run-if-empty \
      perl -pi -e 's/\b(exit ?)\(0\)/$1(EXIT_SUCCESS)/'
    * .x-sc_prohibit_magic_number_exit: New file.
    
    Edit (RWMJ): Don't change Java code.

commit e94f89f40d989d111882178c87b5bfc22314fca8
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Nov 20 11:50:54 2009 +0100

    maint: remove unnecessary include of openat.h
    
    * daemon/realpath.c: Don't include "openat.h".  not used.

commit 4e9fefd4e894e96e71934055958caeac441664b7
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Nov 20 10:44:38 2009 +0000

    build: update gnulib submodule to latest

commit 0d5b38f1d957609f3f96739507f491a6672f01d5
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Nov 20 10:43:45 2009 +0000

    daemon/gnulib: Include glob module.

commit 295a920f52911c4220dc51245f0cf9d0d2c41241
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Nov 20 10:41:07 2009 +0000

    daemon/Win32: Don't include missing headers.
    
    This is a partial fix for code in guestfsd.c where many of these
    header files are missing on Win32.

commit edb9b3abc03c0a0f84b1cbd9cf5920e3c84e5c18
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Nov 20 10:38:07 2009 +0000

    daemon/Win32: make some functions and fields optional.
    
    inotify: Make this optional on platforms that don't have this interface.
    
    mknod, mkfifo etc.: Make these optional on non-Unix platforms.
    
    readdir: If d_type field is missing on the platform, set the corresponding
    field to 'u'.
    
    stat: st_blocks and st_blksize are missing on non-Unix platforms, so
    set these fields to -1 in the corresponding structures.

commit 7d8a3404b27fcd71f84dbe4c022c4435d0070d6b
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Nov 20 10:36:59 2009 +0000

    daemon/Win32: NAME_MAX does not exist on Windows, use FILENAME_MAX instead.

commit 688bdc1a068a6c0bea58addd04d5bbe6dc1940c4
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Nov 20 10:36:21 2009 +0000

    daemon: Missing #includes revealed by cross-compiling.

commit 4d35cc2ff0589e786b0194b9cfdf3aa7b01f6b29
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Nov 20 10:33:27 2009 +0000

    daemon/Win32: Ignore mingw32-config.cache.
    
    The Fedora Windows cross-compiler 'mingw32-configure' script always
    uses a configure cache.  Ignore that file.

commit a216a8adaaf99021ec2f9b6c3eb2c4074252bbb4
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Nov 19 17:01:53 2009 +0000

    generator: open Unix module by default.
    
    Add:
    
      open Unix
    
    at the top of the generator, which means that we don't need to
    prefix any 'Unix.foo' symbols (we can just use 'foo' instead).
    
    Unfortunately the Unix module shadows one symbol in Pervasives
    (the Pervasives module is opened by default in OCaml code).  That
    symbol is 'stdout'.  So we replace this with 'Pervasives.stdout'
    in two places.  Still a net reduction in code size.

commit 986541c26ddeec7583cfb41412d4edaef60703a2
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Nov 19 16:59:56 2009 +0000

    syntax-check: Fix tab-vs-space issue in the generator.

commit b7423df56e12180df27dfc033ed2e4eae1f0175c
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Nov 19 16:50:19 2009 +0000

    Update PO files.

commit 3d05963f9e0fd2229e04e0add391a4cbcdf8d86c
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Nov 19 16:50:04 2009 +0000

    Update TODO file.

commit 8b3e75a3c78064a9dcf4952c50fe631442313743
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Nov 19 16:10:01 2009 +0000

    build: Fix parallel build of haskell bindings
    
    ghc isn't clever enough not to stomp on itself when building dependencies. This
    change makes the 1 dependency explicit.
    
    It also adds a dependency on src/libguestfs.la.

commit c477e2fb78347728aaacbbc89666dcda1481a4b9
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Nov 19 16:10:00 2009 +0000

    build: Fix inter-directory dependencies
    
    This change adds an explicit dependency on generator.ml for every file it
    generates, except java files. Java is left for another time because it's
    considerably trickier.
    
    It also adds a build rule for src/libguestfs.la so it can be rebuilt as required
    from other directories.
    
    It does this by creating a top level make file, subdir-rules.mk, which can be
    included from sub-directories. sub-directories need to define 'generator_built'
    to include local files which are built by generator.ml, and they will be updated
    automatically.
    
    This fixes parallel make, and will automatically re-create generated files when
    make is run from any directory.
    
    It also fixes the problem which efad4f53 was targetting. Specifically,
    src/guestfs_protocol.(c|h) had an erroneous dependency on stamp-generator, and
    therefore generator.ml, despite not being directly created by it. This caused
    them to be recreated every time generator.ml ran rather than only when
    src/guestfs_protocol.x was updated, which cascaded into a daemon and therefore
    appliance update.
    
    This patch also changes the contents of the distribution tarball by including
    files created by rpcgen.

commit 16c1b3164698900f52294e1396542ddd94a4cae4
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Nov 19 13:48:59 2009 +0000

    generator: Acquire lock to prevent two parallel runs of the generator.
    
    This commit acquires a lock on a file to prevent two parallel runs of
    the generator from stomping on each other.  The second run will wait
    for the first to complete before starting.
    
    The lock is acquired on the "HACKING" file because it's convenient --
    we are already checking this file exists to make sure that we don't
    start off in the wrong directory.
    
    Tested by adding some artificial sleeps in the code to observe
    locking behaviour between two parallel runs.

commit 60d020d363ec49a547fe047ac2f9bd88c8efcd5c
Author: Jim Meyering <jim@meyering.net>
Date:   Thu Nov 19 11:41:50 2009 +0100

    syntax-check: expand TABs in generator.ml
    
    Jim Meyering wrote:
    >>From 6f128e90afb055f9899011c4a592eb289e678936 Mon Sep 17 00:00:00 2001
    > From: Jim Meyering <meyering@redhat.com>
    > Date: Thu, 19 Nov 2009 11:39:10 +0100
    > Subject: [PATCH libguestfs] syntax-check: expand TABs in generator.ml
    >
    > * src/generator.ml: Expand leading TABs to spaces.
    
    That was incomplete.
    Please use the following instead.
    With it, now, "make syntax-check" now passes once again.
    
    >From 716a30d0b692972aac8fbea1fb7ad3318ab3a0d8 Mon Sep 17 00:00:00 2001
    From: Jim Meyering <meyering@redhat.com>
    Date: Thu, 19 Nov 2009 11:39:10 +0100
    Subject: [PATCH libguestfs] syntax-check: expand leading TABs
    
    * src/generator.ml: Expand leading TABs to spaces.
    * fuse/test-fuse.sh: Likewise.

commit f4619c24e2a5cceaf030ee015a5c005b5a84280c
Author: Jim Meyering <meyering@redhat.com>
Date:   Thu Nov 19 11:37:13 2009 +0100

    syntax-check: exempt *.pod from no-trailing-blank prohibition
    
    * .x-sc_trailing_blank: Exempt *.pod.

commit 44097b509c8fa665f8391e393025599a026cddac
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 18 17:41:41 2009 +0000

    BUILT_SOURCES now depends on running the generator.
    
    This completely reverts commit efad4f53923dcca94613e193d6383bd032e70498.

commit 9c75b1554b5121a7d2b24b99badd1333769a9555
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Wed Nov 18 16:02:53 2009 +0000

    daemon/RHEL: Choose correct udev settle script.
    
    On RHEL/CentOS 5.4, udevadm settle command does not work.  This didn't
    affect us before, but now that we're using parted for partitioning, we
    *do* need to wait for udev to settle (because parted isn't waiting for
    this, unlike sfdisk).
    
    This commit chooses the correct program to run.

commit 83eb2cf2fddbe3e06f50c18d5e651853f8d86813
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Wed Nov 18 16:01:23 2009 +0000

    fuse/RHEL: Don't require UTIME_{NOW,OMIT} to be defined.
    
    These macros don't exist on RHEL/CentOS 5.4.  If the feature
    is missing then just don't implement it in the FUSE layer.

commit 09d7b265e6a0b78592b0a8cc78d9382fd5cb680b
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 18 17:31:08 2009 +0000

    appliance: Print uptime.
    
    Print the uptime just before the init script runs the daemon, so we
    have a good idea of how long the kernel boot + init script takes to run.

commit 9473e8f72d1a7db0561e59f01c2dd45630c0a107
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 18 14:11:25 2009 +0000

    recipes: Fix git URL.

commit 52390cde840925d4f7e194fcafa7963ad7a2ec04
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 18 13:40:32 2009 +0000

    Prepare for version 1.0.79.

commit 4ffd4d460bd4b239ea9bcb60fbd225a7d37cb200
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 18 13:40:04 2009 +0000

    fuse: Add test-fuse.sh to EXTRA_DIST.

commit f5a3da14837fe65eab1df41df33f2bafeddcd9ce
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 18 10:37:10 2009 +0000

    generator: Fix API of functions that return RBufferOut
    
    (NB: The API / ABI doesn't actually change here - it's just made much
    simpler to use).
    
    The API for RBufferOut functions was unexpectedly hard to use in the
    case where a zero-length buffer might be returned.  For discussion on
    this see:
    
    https://www.redhat.com/archives/libguestfs/2009-November/thread.html#00115
    
    This commit ensures that in the zero-length buffer case, the return
    value is never NULL.  Thus code is now able to just check if the return
    value == NULL to indicate an error, which is simpler for all concerned.
    
    The implementation of this is, however, more complex because we have
    to be careful about this case inside both the daemon and the library
    code, which is what this commit does.
    
    This has passed a full round of tests.

commit 5c2da21b2ae56adc16bbd5bf9740a04ca70f9f19
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 17 17:03:31 2009 +0000

    fuse: Add tests for guestmount.
    
    This script contains non-exhaustive tests for the system calls
    implemented by guestmount.

commit 336275ee6dbff5efa2152a4f67ef354b81d15d59
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 17 17:02:45 2009 +0000

    fuse: Fix read for empty files.
    
    Error handling for the guestfs_pread call was incorrect, which
    meant that empty files could produce spurious error messages.

commit 3fc9951016d08e2467375e24094a468713637c1f
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 17 20:00:17 2009 +0000

    fish: Improve output of guestfish -h cmd
    
    Display this output like a short manual page.
    
    Don't put <..> around the parameters to the command.

commit 540c85a1102c5876265502f8ae287ea697834d20
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 17 19:51:29 2009 +0000

    New API call: fill - fill a file with octets

commit dcd08dd356ca361703f4f2a2e25b639b219ac40d
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 17 17:01:19 2009 +0000

    fuse: Fix cache invalidation in rename operation.
    
    We need to invalidate both parameters, otherwise the old (moved)
    file can appear that it still exists after the move.

commit a15f118e3b2221e68732ad0545f770b3324d593b
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 17 17:02:15 2009 +0000

    fuse: Fix hard link creation.
    
    The parameters were swapped.  We also need to invalidate the
    cache for both parameters.

commit 366339d41bc9af9d529f2118e1c971c49089d432
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 17 16:59:52 2009 +0000

    fuse: Fix symlink creation (RHBZ#538069).
    
    The parameters were swapped, preventing symlinks from being created.

commit dda10cd9357169d5c55d9d49e270a6202971b8c0
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 17 14:21:54 2009 +0000

    virt-df: Ignore domains which have ID 0.
    
    This is the remainder of the fix for RHBZ#538041.  Domains
    which have ID 0 are special domains.  libvirt defines it as
    the "control plane OS".  Only Xen and HyperV have this
    behaviour, and in both cases we should ignore those domains
    for the purposes of virt-df (user can just run "df" if they
    need that information for the dom0).

commit 9004f3c5302fbb70212ccc420b863c9a3ca75abf
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 17 14:09:58 2009 +0000

    virt-df: Turn errors into warnings when listing all domains.
    
    This is a partial fix for RHBZ#538041.  When listing all domains,
    don't die just because one domain fails, but keep trying for the
    rest.

commit 15de7e0d8d1529803a4c11168a86a05800e0ac13
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 13 22:23:08 2009 +0000

    Docs: copyediting

commit 5f9be62e68b120f51c948404e7f0cf3430962c68
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 13 16:36:04 2009 +0000

    Docs: Add documentation about other language bindings to API overview.

commit b296287daf9b884aa38646717725f5a389f96ca5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 13 16:35:51 2009 +0000

    Docs: line folding in example.

commit 747eb7138ada2c999abc686fc5de18bcad96a1b7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 13 15:57:32 2009 +0000

    Docs: group preformatted sections of text together.

commit 259f78cfa70af5505b8172bb81a3d1e2d7581bb5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 13 15:09:10 2009 +0000

    Docs typo: limited -> limits

commit c2cbf9cd082e2cca69481e31ebd9bafda879fa22
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 13 14:47:32 2009 +0000

    Docs: Add section on using multiple threads.
    
    This section was missing from the previous documentation.

commit 38d8943009e3a637e56af6adb43f6c12a7a357c7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 13 14:13:31 2009 +0000

    Docs: Add/extend API overview.

commit 407f34901361f6d68bca96543042b01581257485
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 13 12:15:09 2009 +0000

    Docs: Remove incorrect statement from man page.
    
    The low-level event-based API never existed so this statement
    in the man page is wrong.  If you want an asynchronous API, use
    threads.

commit 825d855b225c7c76371c72eae4d505a32c374007
Author: Jim Meyering <meyering@redhat.com>
Date:   Thu Nov 12 11:34:08 2009 +0100

    build: revive the ocaml package tests
    
    * autogen.sh: Generalize the ocaml-package-existence test.
    Remove the git-related part of the old test.

commit a6832406fabf251ba89ed91a9f23624fa16f977f
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Nov 11 13:50:24 2009 +0000

    Generate guestfs_protocol.x when stamp-generator updates
    
    This partially reverts efad4f53923dcca94613e193d6383bd032e70498.
    guestfs_protocol.x wasn't being generated when building from a clean checkout.

commit 62288e7118733ee433313267d44133ab5ce4b647
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 11 13:40:04 2009 +0000

    autogen.sh: Remove test for ocaml etc from this script.
    
    This test seems to cause a lot of trouble.  We need to go back to
    the drawing-board on this one.

commit cc9b2e30e5f6d6e77c60e3f501969c4a478899da
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 11 10:55:26 2009 +0000

    Set cpio blocksize to 64K.
    
    See:
    https://www.redhat.com/archives/fedora-devel-list/2009-November/thread.html#00523

commit a11927340db33ae00c41abbb96f91ecff0b3772f
Author: Richard Jones <rjones@debian5x64.home.annexia.org>
Date:   Tue Nov 10 19:12:46 2009 +0000

    Debian: don't depend on gfs-tools since these have depsolving problems.

commit b0c050c7de5b8f834ee9c8328bef843ed385749d
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 10 18:45:13 2009 +0000

    Update PO files for release.

commit 3ca69d9db34ebb31eba7b370ffe25a6178c83449
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 10 18:38:54 2009 +0000

    Check for ocaml-xml-light-devel (xml-light.cmxa)
    
    Also unquote $pkg since OCaml package names can never contain
    spaces or other unfriendly characters.

commit 61a1449b79e304bb8619e0781ec22cb600bedc01
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 10 18:23:52 2009 +0000

    Prepare for version 1.0.78

commit bdfb1bddffa48cfb486331166b8aed91637cb0d6
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Nov 10 18:49:42 2009 +0100

    tell "make syntax-check" that examples/to-xml.c is exempt from some tests
    
    * .x-sc_prohibit_strcmp: Exempt examples/to-xml.c.
    * .x-sc_prohibit_strcmp_and_strncmp: Likewise.

commit ae4589f17b0123044e3b27ebb8e14bc6f539c23c
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 10 17:09:54 2009 +0000

    examples: Don't use STREQ etc in the to-xml.c example.

commit ade327a7af869d4d70e28e2a596473943e0299dd
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 10 17:09:12 2009 +0000

    Don't export STREQ and friends in <guestfs.h>
    
    Move these to private header file(s) and other places as required
    since these aren't part of the public API.

commit 3833ddc6566f92783dc5a8894383c304e3d2c0b4
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 10 16:46:31 2009 +0000

    Fix problems found by 'make syntax check'

commit da33feca279d8feea3cd4b290c0d62c011f30d61
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Nov 9 14:42:55 2009 +0000

    Print timestamped messages during appliance launch.
    
    In verbose mode, print timestamped messages during guestfs_launch
    so we can see how long each step takes.

commit 3ae742c1498b8839250be295173d76b9c5731ed1
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Nov 9 14:16:21 2009 +0000

    Record time of guest launch.
    
    The guest handle field start_t was previously used (when we
    had the wait_ready call), but had fallen into disuse.  Note
    that it could never be accessed through the API.
    
    Rename this field as launch_t, convert it to a timeval, and
    use it to measure the time since guestfs_launch was called
    so that we can start profiling guest launch.

commit 28d74ee234bebaab552a662eb0700a36413b68b5
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Nov 9 14:15:43 2009 +0000

    appliance: Prefix kernel messages with timestamp.

commit b1e1ca2f74a921b3f784537d59c617df29ea1d60
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 4 23:15:26 2009 +0000

    Generic partition creation interface.
    
    This commit introduces a generic partition creation interface
    which should be future-proof and extensible, and partially
    replaces the old sfdisk-based interface.
    
    The implementation is based on parted but is hopefully not too
    dependent on the particulars of parted.
    
    The following new calls are introduced:
    
      guestfs_part_init:
        Initialize a disk with a partition table.  Unlike the sfdisk-
        based interface, we also support GPT and other partition
        types, which is essential to scale to devices larger than 2TB.
    
      guestfs_part_add: Add a partition to an existing disk.
    
      guestfs_part_disk:
        Convenience function which combines part_init & part_add,
        creating a single partition that covers the whole disk.
    
      guestfs_part_set_bootable:
      guestfs_part_set_name:
        Set various aspects of existing partitions.
    
      guestfs_part_list:
        List partitions on a device.  This returns a programming-friendly
        list of partition structs (in contrast to sfdisk-l which cannot
        be parsed).
    
      guestfs_part_get_parttype:
        Return the partition table type, eg. "msdos" or "gpt".
    
    The following calls are planned, but not added currently:
    
      guestfs_part_get_bootable
      guestfs_part_get_name
      guestfs_part_set_type
      guestfs_part_get_type

commit b03995b67f9bc23d066b282bb7dad9b7c71c90da
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 10 11:41:39 2009 +0000

    Add ata_piix to kernel module whitelist (RHBZ#533886).

commit aa4fffd512faf302bacfef70c4f1f81f64820a66
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 10 12:34:27 2009 +0000

    Fix compilation if readline library is not present.

commit 7cf477952aeb448294d8984cf5183b4cef0f6d5d
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 10 12:10:05 2009 +0000

    Fix compilation when Augeas is not present.
    
    It would complain that NEED_AUG macro was defined but not used.

commit b9de2dc61162bf7cb89560319aab5e96b920e8e0
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Nov 9 15:06:36 2009 +0100

    avoid "syntax-check" failure: hide cast of argument to free
    
    * fuse/guestmount.c (fg_readlink): Perform cast in a
     separate statement to hide it from "make syntax-check".

commit 15821057d4729d8bb369af3a230e717af5563abb
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Nov 10 14:31:42 2009 +0100

    build: die early if we lack ocaml, ocamlfind or ocaml-xml-light
    
    * autogen.sh: Ensure that we fail very early when not building
    from a tarball and when one of those is not installed.

commit 0e1e0f10df2c45cf0c43633ce0e59a4780308e63
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Nov 9 15:05:23 2009 +0100

    tests: enable strcmp-related syntax-check tests
    
    * cfg.mk (local-checks-to-skip): Don't skip these checks:
    sc_prohibit_strcmp_and_strncmp, sc_prohibit_strcmp.

commit c9d94984588d166bcdc077a7972a1b454678ba10
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Nov 9 22:33:54 2009 +0100

    change strncasecmp() == 0 to STRCASEEQLEN()
    
    git grep -l 'strncasecmp *([^=]*== *0'|xargs \
      perl -pi -e 's/\bstrncasecmp( *\(.*?\)) *== *0\b/STRCASEEQLEN$1/g'

commit 0c20bd8ea7092b93074ff08cae70e4cf6a06e7c5
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Nov 9 22:33:36 2009 +0100

    change strncasecmp() == 0 to STRCASENEQLEN()
    
    git grep -l 'strncasecmp *([^=]*!= *0'|xargs \
      perl -pi -e 's/\bstrncasecmp( *\(.*?\)) *!= *0\b/STRCASENEQLEN$1/g'

commit 539bf7e8983c53c4cf79ffa64302bef1585bec31
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Nov 9 15:03:01 2009 +0100

    use STREQ, not strcmp: part 2
    
    git grep -l 'strcmp *([^=]*!= *0'|xargs \
      perl -pi -e 's/\bstrcmp( *\(.*?\)) *!= *0\b/STRNEQ$1/g'

commit 9a8889e4d0c532b9f77af3a9cc7aae06adebfb83
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Nov 9 14:30:11 2009 +0100

    use STREQ, not strcmp: part 1
    
    git grep -l 'strcmp *([^=]*== *0'|xargs \
      perl -pi -e 's/\bstrcmp( *\(.*?\)) *== *0/STREQ$1/g'

commit 3e70b34eed5a48640e20fbf6dcba774aaace1f3c
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Nov 9 14:26:21 2009 +0100

    change strncmp() == 0 to STREQLEN()
    
    git grep -l 'strncmp *([^=]*== *0'|xargs \
      perl -pi -e 's/\bstrncmp( *\(.*?\)) *== *0\b/STREQLEN$1/g'

commit 627f89351d06e43564b47ea42cabaa522284c2a1
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Nov 9 14:21:46 2009 +0100

    change strncmp(...) != 0 to STRNEQLEN(...)
    
    git grep -l 'strncmp *([^=]*!= *0'|xargs \
      perl -pi -e 's/\bstrncmp( *\(.*?\)) *!= *0/STRNEQLEN$1/g'

commit 29842da1379ece83eae98ee786b475ae161f1687
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Nov 9 14:06:37 2009 +0100

    convert strcasecmp(...) != 0 to STRCASENEQ(...)
    
    git grep -E -l 'strcasecmp *\(.*!= ?0\b'|xargs \
      perl -pi -e 's/\bstrcasecmp( ?\(.*?\)) != 0/STRCASENEQ$1/g'

commit 9353c6253d5fac1648b13ad9958468a2d9f6ad6f
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Nov 9 13:58:42 2009 +0100

    convert uses of strcasecmp to STRCASEEQ
    
    git grep -l 'strcasecmp *([^=]*== *0'| xargs \
      perl -pi -e 's/\bstrcasecmp( *\(.*?\)) *== *0/STRCASEEQ$1/'

commit 7cd4b6aeee3693463b03608a31cf53f21152c2e8
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Nov 9 19:50:22 2009 +0100

    define STREQ, STRNEQ, STREQLEN, STRCASEQ, etc.
    
    * src/guestfs.h: Define STREQ and company.
    * daemon/daemon.h: Likewise.
    * hivex/hivex.h: Likewise.

commit e645763007e7097c14c1c3ba94010f2e32e536bf
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Nov 9 15:14:53 2009 +0100

    indent with spaces, not TABs
    
    * HACKING: Expand indentation TABs.
    * configure.ac: Likewise.
    * daemon/daemon.h: Likewise.
    * daemon/guestfsd.c: Likewise.
    * fuse/guestmount.c: Likewise.
    * hivex/LICENSE: Likewise.
    * src/generator.ml: Likewise.
    * tools/virt-win-reg: Likewise.

commit d710f768161fc9f78ed8243f2de948b65425c06e
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Nov 9 15:09:35 2009 +0100

    fix doc typo
    
    * fuse/guestmount.pod: Avoid "the the".

commit 9299f25cd277d5481cae2ed8dcd8789417df9f53
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Nov 9 15:08:09 2009 +0100

    placate 'make syntax-check'
    
    * hivex/hivex.c: Remove unused "#include <assert.h>".

commit 4e201a0c9bce31881da868e764101a6d1556c967
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Nov 9 18:01:48 2009 +0100

    avoid syntax-check warning about isdigit use in example program
    
    * .x-sc_avoid_ctype_macros: New file.

commit e0fb48c01f1c25c20e1d5cae0765e65d7eaa4250
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Nov 8 11:57:02 2009 +0000

    appliance: Enhance mkfs to support many more filesystem types.
    
    This fixes support for NTFS, and adds support for:
     - reiserfs
     - btrfs
     - GFS and GFS2
     - JFS
     - HFS and HFS+
     - NILFS
     - OCFS2 (disabled)
    
    We don't enable OCFS2 by default, because it pulls in about
    140 extra packages into the appliance.
    
    GFS & GFS2 default to single node (no lock manager etc).

commit 3cf719bc077a5f0d4f1a79279a5ba6e41d53c9b9
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Nov 8 11:55:38 2009 +0000

    Fix prototype of commandv to match prototype of commandrv.

commit a25d175cf6e8283288fd6d209b37b09ffee0dcf3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 6 17:27:02 2009 +0000

    daemon: Always reflect command stderr to stderr when debugging.
    
    When debugging (ie. LIBGUESTFS_DEBUG=1 & verbose flag set in daemon)
    always reflect any stderr output from commands that we run to
    stderr of the daemon, so it is visible.
    
    Previously if stderror == NULL in command*, stderr output was
    just eaten and discarded which meant useful error messages could
    be lost.

commit d714547ab361962ca6f76ec07736f1515595b2df
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 6 13:19:26 2009 +0000

    daemon: Add flags argument to command*() functions.
    
    This adds new variations of the command*() functions which
    take a 'flags' argument.  Currently the only flag available
    is defined as follows:
    
     COMMAND_FLAG_FOLD_STDOUT_ON_STDERR: For broken external commands
     that send error messages to stdout (hello, parted) but that don't
     have any useful stdout information, use this flag to capture the
     error messages in the *stderror buffer.  If using this flag,
     you should pass stdoutput as NULL because nothing could ever be
     captured in that buffer.
    
    This patch also adds some documentation for command*()
    function.

commit 49e85f8cda664819d0f73c476f1596d1ecc128c8
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Nov 9 11:03:25 2009 +0000

    haskell: Disambiguate truncate symbol.
    
    This is a hack, but GHC doesn't like it if we have a symbol
    with the same name as one in the Haskell Prelude.  Therefore
    we much hide the corresponding symbol in the Prelude when
    building this module.

commit 93e3253fa68f4792a2844e0758c1780896e518e3
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Nov 8 11:57:54 2009 +0000

    ocaml: Update dependencies file.

commit c0465ca3ae5cd55dbc5dc6d3a511ae5431985d3b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 6 12:32:57 2009 +0000

    ocaml: Sort the dependencies so they are stable between machines.

commit 79125c4dea9c69d08b522ed7c85f26dc6ee1bcb3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 6 10:48:37 2009 +0000

    ocaml: General improvements to generated code.

commit e1f5472395b08033c60054e8f87f3c61126c4fa4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 6 09:14:31 2009 +0000

    Fixes for compiling on 32 bit.

commit efad4f53923dcca94613e193d6383bd032e70498
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Nov 5 10:03:59 2009 +0000

    Don't update appliance after running generator.
    
    I'm not sure why these dependencies exist, but they cause the
    appliance to be updated every time the generator runs, which
    appears to be unnecessary.

commit ac2a53bbab44fe94306092b47aeddb899c55345a
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Nov 5 13:13:21 2009 +0000

    appliance: Add xfsprogs to list of packages

commit 857954dfbdd287d2e00d40c8c60f6cbe5b5730e2
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 4 21:51:35 2009 +0000

    fish: Allow <nn>P and <nn>E for petabyte and exabyte allocations.

commit 3266e51054fdc1f584bd7a8611c7706e6d0b7cef
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 4 18:03:58 2009 +0000

    fish: Allow <nn>T for terabyte allocations.

commit 5ce72e039ca332ba19bb9122b7c93d257e745bb5
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 4 17:42:03 2009 +0000

    fish: New command 'sparse', like 'alloc' but to generate sparse files.
    
    With sparse you can make sparse files, which is fun because you
    can experiment with really large devices:
    
      ><fs> sparse /tmp/test.img 100G
      ><fs> run
      ><fs> sfdiskM /dev/vda ,
      ><fs> mkfs ext2 /dev/vda1    # very long pause here ...
      ><fs> mount /dev/vda1 /
    
    To see the real (ie. allocated) size of the sparse file, use the du
    command, eg:
    
      ><fs> !du -h /tmp/test.img
      1.6G -rw-rw-r-- 1 rjones rjones 100G 2009-11-04 17:40 /tmp/test.img

commit fc2cce06ec537f3e6ddf153ffae389ab483e3809
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 4 17:23:11 2009 +0000

    daemon: Build daemon with AC_SYS_LARGEFILE.

commit 4f4880303693bc2e55ce431e87302098654b7f03
Author: Richard Jones <rjones@debian5x64.home.annexia.org>
Date:   Wed Nov 4 16:32:50 2009 +0000

    Debian: Use /bin/bash as the shell for regression test scripts.
    
    /bin/sh on Debian is a minimal shell called 'dash' which doesn't
    support some features we need such as the particular 'function'
    syntax used by regressions/test-stringlist.sh, and therefore
    this script was failing on Debian.
    
    Change all of these scripts to use #!/bin/bash explicitly to avoid
    these sorts of problems.

commit df1af0bbe21e906c11123e66ec470b60e55c9e44
Author: Richard Jones <rjones@debian5x64.home.annexia.org>
Date:   Wed Nov 4 15:47:03 2009 +0000

    daemon: When running external commands, open stdin as /dev/null
    
    Previously when we ran external commands from the daemon, stdin
    (ie. fd 0) was closed.  This caused a problem when running the
    external hexdump command which seems to break if stdin is closed.
    
    This patch opens stdin on /dev/null.

commit a3be3a3b877277c1e4b130e1676b9ad307cafa10
Author: Richard Jones <rjones@debian5x64.home.annexia.org>
Date:   Wed Nov 4 14:31:06 2009 +0000

    Debian: Include ISOFS driver in the kernel.

commit 644fccb4aeed3e39978d340b18821aa704adf1bd
Author: Richard Jones <rjones@debian5x64.home.annexia.org>
Date:   Wed Nov 4 14:30:41 2009 +0000

    Debian: Ignore Debian appliance root when looking for translatable files.

commit 3e4bd83ce0d3f9c7af52adb1dbdf5a5718e81454
Author: Richard Jones <rjones@debian5x64.home.annexia.org>
Date:   Wed Nov 4 14:30:13 2009 +0000

    debian: Ignore some generated debirf files.

commit 333e3da945b056efe6f9d2e4b74abdb19c9e87e8
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 4 12:42:18 2009 +0000

    configure: Fix summary messages.
    
    The following 3 summary messages in the configure output
    always displayed "yes" even if they were not actually
    enabled.
    
    Haskell bindings .................... yes
    virt-inspector ...................... yes
    virt-* tools ........................ yes
    
    Fixed by correcting the code that tests if the automake
    conditional is set.

commit ef642eb4e3bb278b5df14fbcf30403e3d30dcef3
Author: Jim Meyering <jim@meyering.net>
Date:   Tue Nov 3 18:55:21 2009 +0100

    hivex: fail upon integer overflow
    
    * hivex/hivex.c (windows_utf16_to_utf8): Avoid overflow and a
    potential infloop.

commit f95c697a44c321dd1d370620515aa71a71a4ad5b
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 4 11:33:29 2009 +0000

    hivex: Check unchecked calloc (Jim Meyering).

commit f8a0d6608221881a40d67affdc55f6c7bafd69a5
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 3 16:50:08 2009 +0000

    Update PO files.

commit e2976edb674762437352c73a854333c7d9c945af
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 3 16:49:31 2009 +0000

    Fix EXTRA_DIST line in fuse/Makefile.am.

commit bca39315908ad814addc6e5bfccb229ac774f652
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 3 16:49:13 2009 +0000

    Add make.sh.in to EXTRA_DIST.

commit aad55a71f6aa3f7195c4b4b022773c5ae1c01728
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 3 16:44:47 2009 +0000

    Comment out code which provokes strange gcc optimization error.

commit 589ce7e1c85bef6526c1d0de81bca2befbdfcc30
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 3 16:31:37 2009 +0000

    Prepare for 1.0.77.

commit 429de2254176e470035eef05e0f3e9910d46863c
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Oct 30 16:13:13 2009 +0000

    FUSE filesystem support.
    
    This implements FUSE filesystem support so that any libguestfs-
    accessible disk image can be mounted as a local filesystem.
    
    Note: file writes (ie. write(2) system call) is not yet implemented.
    
    The API needs more test coverage, particularly lesser-used system
    calls.
    
    The big unresolved issue is UID/GID mapping between guest filesystem
    IDs and the host.  It's not easy to automate this because you need
    extra details about the guest itself in order to get to its
    UID->username map (eg. /etc/passwd from the guest).

commit 08c9bf5e22ecf06e36cf128416a62214704da411
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 3 15:30:36 2009 +0000

    Allow callers to disable the recovery process.

commit 90cf7fc904fca42665fe04cdd90a4c547d23b00c
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Nov 2 17:02:32 2009 +0000

    New API call: pread
    
    guestfs_pread lets you do partial file reads from arbitrary
    places within a file.  It works like the pread(2) system call.

commit 55a7427b7679e25134cd43488a9f74cb542416ea
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Oct 31 13:41:18 2009 +0000

    New API calls: lstatlist, lxattrlist, readlinklist.
    
    These three functions are very specifically designed for FUSE
    support, so we can list directories efficiently.  Instead of
    making lots of lstat, lgetxattr and readlink calls, we can make just
    three calls per directory to grab all the attributes (which we
    then cache briefly).

commit 2eb19f526164a978c373a760deb30854d56b62ce
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Oct 30 16:10:45 2009 +0000

    New API calls: truncate, truncate_size, mkdir_mode, utimens, lchown.
    
    truncate, truncate_size: Used to truncate files to a particular
    size, or to zero bytes.
    
    mkdir_mode: Like mkdir but allows you to also specify the
    initial permissions for the new directory.
    
    utimens: Set timestamp on a file with nanosecond accuracy.
    
    lchown: Corresponding to lchown(2) syscall (we already have chown).
    
    The implementation is complicated by the fact that we had to
    add an Int64 parameter type to the generator.

commit 00425c073e5c0743ef425cd12108a85ac36b15f4
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Nov 2 14:30:54 2009 +0000

    examples/to-xml.c: Don't depend on Gnulib function.
    
    Since this program is just an example, it shouldn't require
    the Gnulib c-ctype functions.

commit ff704b2291680ca52051452abbce033953f65f3e
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Oct 30 17:11:02 2009 +0000

    appliance: Don't rebuild the appliance every time configure runs.
    
    config.status touches make.sh each time it runs, even if the
    resulting script would not change.  This causes the appliance
    to get rebuilt much more frequently than is necessary.
    
    There's no way to stop configure running, but we can move the
    config.status command into a Makefile rule to stop this
    undesirable behaviour.

commit 7ab898c286b846bdfc3f8d5f8f611f293e12df35
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Nov 2 16:15:14 2009 +0000

    guestfish: Fix a third indentation problem.

commit dd56b3c4c350e77cf47f9c071ac36ed94d02e369
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Nov 2 16:06:23 2009 +0000

    guestfish: Another indentation fix.

commit 4293b71a900ac3abfb178405e228c3f45915f5c0
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Oct 31 13:40:12 2009 +0000

    guestfish: Fix printing of buffers in structs.
    
    Somehow an 'indent' string crept in there, so it was printing:
    
      <char><indent><char><indent><char>...
    
    instead of:
    
      <char><char><char>...

commit 752aec78b012dbeb8997658bf574dfba690bcfed
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Oct 31 13:38:14 2009 +0000

    Fix rstructs_used handling in guestfish generated code.
    
    rstructs_used wasn't correctly generating code for guestfish
    because guestfish doesn't make all functions visible.  Since the
    calculation of rstructs_used was over all functions (including
    ones not available in guestfish) it could have generated
    unnecessary functions.
    
    In fact this error didn't affect us before - but I discovered
    it when I added some extra struct-returning functions (future
    commit).

commit 32ab3c183836ab434ab739bea8238593d70db2ac
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Oct 31 13:37:04 2009 +0000

    daemon: Don't warn on -Wunsafe-loop-optimizations.
    
    Ignore -Wunsafe-loop-optimizations, same as in the top level
    configure file.

commit 6600c275b2a845c3dc26ee97708abd04dd3c5c5c
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Oct 29 20:35:59 2009 +0000

    Add hivex* documentation to website.

commit 2ec5ff5d3436989882d4284690606989e71cef96
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Oct 29 20:33:27 2009 +0000

    Add HTML documentation to website.

commit bb67f62e3c6a326f37a1baaf64709840a155457f
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Oct 29 20:06:47 2009 +0000

    Prepare for 1.0.76.

commit 43a8e107ce8ad6eac99da82366bdf63b401e3d31
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Oct 29 18:46:46 2009 +0000

    Fix misspelling in previous commit.

commit d707ecc55ac2de267608435bdc1052176aecff46
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Oct 29 18:36:12 2009 +0000

    RHEL 5: Also add le{16,64}toh functions

commit a4e27cdf4d3b831792dd20d796dc98a5bc684290
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Oct 29 17:54:48 2009 +0000

    RHEL 5: Detect endianness functions and supply them.

commit e02f42cb1d7f60c9d2f020d7d8c1b5316fb61310
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Oct 29 16:54:18 2009 +0000

    Add virt-win-reg to toplevel Makefile.am, fix POTFILES.in

commit 130d7bc3a2758d18adfb3249e3768afed7a9d4d7
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Oct 29 16:44:09 2009 +0000

    Prepare for version 1.0.75.

commit 792c5283009ed6753239a14df9a6e9c71bea35fd
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Oct 26 11:03:07 2009 +0000

    Support for Windows Registry.
    
    In hivex/:  This mini-library allows us to extract Windows
    Registry binary files ("hives").
    
    There are also two tools: hivexml converts a hive to a
    self-describing XML format.  hivexget can be used to extract
    single subkeys from a hive.
    
    New tool: virt-win-reg.  This is a wrapper around the library
    functionality allowing you to pull out data from the registries
    of Windows guests.

commit d609130cb65fe7795b168a796426e39d64ceda97
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Oct 26 14:26:36 2009 +0000

    New API: vfs_type - get the Linux VFS driver for a mounted device.

commit aa7ca27e4be1fd38a1eff4d24974f053080a9704
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Oct 26 09:12:12 2009 +0000

    Modify Sys::Guestfs::Lib::resolve_windows_path to use case_sensitive_path.

commit ec02f0da1550e37acd95d615ff4fcf88569bcf2c
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Oct 26 09:04:42 2009 +0000

    guestfish: Add win: prefix to use Windows paths.
    
    Add a win: prefix for path arguments in guestfish:
    
    ><fs> file win:c:\windows\system32\config\system.log
    MS Windows registry file, NT/2000 or above

commit 74bde73d5c60c13b894fa60fff680a447499c884
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Oct 26 13:00:46 2009 +0000

    daemon: Change chdir to use openat/fdopendir.
    
    Uses Gnulib implementation of openat which should be portable.

commit 9add3c10a3b769e309f476bd0fd05e2a7126d31d
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Oct 26 08:20:00 2009 +0000

    New API: case-sensitive-path to return case sensitive path on NTFS 3g fs
    
    This function handles an annoyance/peculiarity of the Linux
    NTFS 3g driver, which is that it exports NTFS filesystems with
    names case sensitive, even though under Windows they would be
    case insensitive.
    
    This causes problems because the location of (eg.) c:\windows
    might appear as /windows or /WINDOWS (etc) depending on the
    inconsequential details of how it was originally created.
    
    Example of this problem on a real Windows guest:
    
      ><fs> file /windows/system32/config/system.log
      libguestfs: error: file: access: /windows/system32/config/system.log: No such file or directory
      ><fs> case-sensitive-path /windows/system32/config/system.log
      /WINDOWS/system32/config/system.LOG
      ><fs> file /WINDOWS/system32/config/system.LOG
      MS Windows registry file, NT/2000 or above

commit a4217192672fb4f2ff60efcacc59a202d9f77bd9
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Oct 26 09:30:38 2009 +0000

    inspector: Remove inaccurate paragraph from documentation.

commit a3dfe9398c9f629d013a82c1ba8014b500462f7d
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Oct 25 21:43:37 2009 +0000

    Include HFS (Mac OS X) driver.

commit 805cb234f3d9b3afc6c4bb7c82d9f7c64caeabce
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Oct 21 16:31:26 2009 +0100

    Set LC_ALL=C before running qemu.

commit 300461966b053bb62249f9084d4a85b25fee48f6
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Oct 21 10:16:50 2009 +0100

    init: Check that start_udev succeeded
    
    If start_udev fails for any reason, notice and fall through to manual /dev
    creation.
    
    Patch from Charles Duffy <charles@dyfis.net>

commit c925dce4e7654cbcf66eb90528de18d5d09aa7c4
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Oct 20 15:37:40 2009 +0100

    Version 1.0.74.

commit de64183f3d0d04127c2e7690c87435e6649d30a6
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Oct 20 15:03:16 2009 +0100

    Tab to space fixes, now passes 'make syntax-check'

commit cefc644d58786b73b2baaa2c2912da2738d24511
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Oct 20 10:19:21 2009 +0100

    guestfs_find: Fix memory leak of sysrootdir.

commit ea124897881d9e40d89eca5307e04def0fb42bdb
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Oct 19 17:59:00 2009 +0100

    virt-ls: Modify to use find0 instead of find.
    
    find0 is more scalable than find.  virt-ls will no longer
    crash if asked to recursively list / on a Linux guest.

commit 42c89f2e6bd956f738080b5aec53b7520f4f96da
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Oct 19 17:44:16 2009 +0100

    New API: find0 (unlimited version of find)
    
    This adds a new API call guestfs_find0, which is like guestfs_find
    but mainly doesn't suffer from the protocol limit of the earlier
    command.  The earlier command is not deprecated because it is
    still very useful.
    
    guestfs_find0 uses a FileOut parameter and writes the results to
    an external file.  The filenames in the output are separated by
    ASCII NUL characters (so a bit like "find -print0").
    
    There is also the addition of a regression test for this command.

commit 55f5dc6f1195d7dec5687ece3f6e74dde649ff7c
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Oct 19 16:57:54 2009 +0100

    guestfs_find: Document protocol limits for this API call.
    
    guestfs_find has to send the complete list of files in a single
    protocol message (hence, limited to 2-4 MB).  Unfortunately on
    a typical Linux guest, guestfs_find ("/") will exceed this limit
    resulting in an error.
    
    Therefore we should add an unlimited version of this call in a
    future commit.  This commit just documents the current limit.

commit 4dd6b77ff7037ee220b530cefb412ace3d880f61
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Oct 19 12:16:00 2009 +0100

    New tool: virt-ls
    
    This tool makes available the functionality of "ls", "ll", and "find"
    in a slightly simpler to use form.
    
    Examples:
    
      virt-ls -l myguest /tmp

commit 984a35cfc0ae09821fb39307b98ec8399bcd8982
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Oct 19 11:49:20 2009 +0100

    New tool: virt-tar
    
    This adds a new tool call virt-tar which is a general purpose
    archive and uploading tool.  It doesn't add any functionality
    which wasn't previously possible using guestfish, but makes it
    simpler to access for some users.
    
    Examples:
    
     virt-tar -zx myguest /home home.tar.gz
     virt-tar -zu myguest uploadstuff.tar.gz /tmp

commit 5c4bf92bc298e078ceccdde603313282d038544c
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Oct 19 10:45:44 2009 +0100

    tools: Make warnings about running on live guests more prominent.
    
    Add prominent warnings to the man pages about how it is dangerous
    to run these tools against live guests.

commit 945b6e0a085611b45b2ab0752a66e6e60b21666c
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Oct 19 10:18:46 2009 +0100

    Move virt tools (virt-cat, virt-edit etc) into tools/ subdirectory.
    
    This moves the tool programs into a single directory:
      cat/* -> tools/virt-cat
      df/* -> tools/virt-df
      edit/* -> tools/virt-edit
      rescue/* -> tools/virt-rescue
    
    This in itself simplifies the build process because we only need
    one Makefile and one copy of 'run-locally'.
    
    'run-*-locally' has become just 'run-locally' and takes an extra
    parameter which is the name of the tool, eg:
      run-locally cat [virt-cat params...]
    
    virt-inspector stays in its own directory, because this contains
    more than just a single Perl script.

commit 854f8e0d5643e55d045f5816a520d49a057990ef
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Oct 19 09:10:15 2009 +0100

    Comment: Describe the build order requirements for toplevel directories.

commit 29148ac40fc6ae54769ceb456d4bd533245a3995
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Oct 14 11:24:52 2009 +0100

    Prepare for 1.0.73.

commit f57f338c3bd937e923e1ba7cc4791b9462192110
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Oct 14 11:24:33 2009 +0100

    Add some missing EXTRA_DIST files.

commit d37f69795396ec2354eb2d8480d64b9e5bdafacc
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri Oct 2 15:42:14 2009 +0100

    inspector: Generate language bindings for OCaml.
    
    This commit adds a generic mechanism for deriving language bindings
    for virt-inspector, and implements one concrete binding, for OCaml.
    
    The bindings are generated from the RELAX NG schema (virt-inspector.rng)
    which is supposed to be a correct and always up to date description
    of the XML that the virt-inspector program can generate.
    
    From the RNG we generate a set of types to describe the output of
    virt-inspector for the language, plus an XML parser, plus some
    glue code to actually run an external instance of virt-inspector
    and parse the resulting XML.
    
    At runtime, an external 'virt-inspector --xml <name>' command runs
    and the XML is parsed into language-specific structures.
    
    This has been tested on the four example files (inspector/example?.xml)
    
    The only particular difficulty about the OCaml binding is the use of
    Obj.magic, which is naughty but works because of the isomorphism
    between the representation of tuples and records in OCaml.  This
    seems to cause no problems in my test program.  Apart from this, the
    OCaml binding is straightforward and could be adapted easily for any
    other languages that want type-safe virt-inspector bindings.
    
    It's important to keep virt-inspector.rng up to date with changes
    to virt-inspector's XML output format.

commit c6b8db6493dd633bf48b13daf72cdc9c078b5f9a
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Oct 5 12:25:15 2009 +0200

    build: avoid parallel ocaml/... build failure
    
    A parallel build could fail due to the use in ocaml/examples
    of ocaml/guestfs.cmi before it was built.
    * Makefile.am (SUBDIRS): Add both ocaml and ocaml/examples,
    to ensure they're built in this order, and not in parallel.
    * ocaml/Makefile.am (SUBDIRS): Don't define.

commit 65d61d4244b6301284e3b67e8ff23cc1374c90f2
Author: Piotr Drąg <piotrdrag@gmail.com>
Date:   Mon Oct 5 12:20:53 2009 +0100

    Updated Polish translation

commit 9f206cc4a6c5bc54cc20cc571a77d3aab5e2ea82
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Oct 1 16:59:28 2009 +0100

    inspector: Fix inspector/Makefile.am
    
    Accidentally pushed the older version of the patch in
    commit 9d25e82491ddcf495e1d30694327e4bfd3a23445.
    
    This includes Jim Meyering's suggested changes from
    https://www.redhat.com/archives/libguestfs/2009-October/msg00017.html

commit dde81c0c0e4d6517781392310768dfe8fe4392fe
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Oct 2 16:09:19 2009 +0200

    build: fix compile error
    
    Link demo scripts with just-build library, not the installed one.
    * ocaml/examples/Makefile.am (OCAMLFINDFLAGS): New variable.
    (lvs, viewer): Use it.
    This fix is based on a suggestion from Rich Jones.
    This addresses RHBZ#526917.

commit 9d25e82491ddcf495e1d30694327e4bfd3a23445
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Oct 1 16:59:28 2009 +0100

    inspector: Add tests for RELAX NG schema.

commit ee21bc1f8071bb35409e9f15fb8309348c9a5912
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Oct 1 16:58:38 2009 +0100

    inspector: Add RELAX NG schema for virt-inspector --xml output.

commit 3c58ea10c74e0a4121ad32b5d578955825371d92
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri Oct 2 09:51:06 2009 +0100

    configure: Update comment about viewer.ml.

commit bf6ea125577dccdb18cab635eda1fb79cd98e0d5
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Oct 1 16:06:17 2009 +0100

    inspector: Canonicalize device names (fix RHBZ#526717).
    
    Make filesystem device names canonical, so they are /dev/sd*
    instead of /dev/vd*.

commit 5d01670e31ef3259fb1fc84a83ab27aec8fdac0b
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Oct 1 15:22:12 2009 +0100

    run-*-locally: The programs are now virt-[tool], not virt-[tool].pl
    
    This fixes commit b488436cc54288fcae8988493749f2e6c87f274c.

commit 5021b2efea92c021c04812056149485ac4803e9c
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Oct 1 15:20:14 2009 +0100

    inspector: Don't bomb if no kernels detected.
    
    If $os->{kernels} wasn't defined, virt-inspector would exit with
    an error, leaving partial XML output.
    
    Change the code so it doesn't die in this case, instead just
    leaves out the <kernels> section.

commit d525103c8621f6ff0293311a8e8f9ac0c3580805
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Sep 30 15:32:41 2009 +0100

    OCaml viewer: Use ocamlduce to replace xpath code.

commit d278ef8ad9090441a713c7334804199318aeb3e1
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Sep 29 11:56:26 2009 +0100

    OCaml viewer: Handle exceptions properly.

commit 4c8bdd342450aad1f49a44a009eae015a44f9572
Author: Richard Jones <rich@koneko.home.annexia.org>
Date:   Sat Sep 26 12:45:37 2009 +0100

    OCaml example: graphical disk usage viewer.
    
    This is an example of how to write an app which uses libguestfs
    and libvirt, and has a responsive user interface (using threads).
    It is a Gtk-based "graphical virt-df".
    
    Read the top of the 'viewer.ml' file first for instructions on
    how to compile.  This program is not compiled by default.

commit f8a96c659616b4e88bb2e6af8e23deea3bd96f0c
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Sep 24 11:22:17 2009 +0100

    virt-df: Add note about parsing CSV.

commit 6a14f1c2502f58ff7bed8cb451f95a83f5ee920a
Author: Jim Meyering <meyering@redhat.com>
Date:   Thu Sep 24 10:59:01 2009 +0200

    avoid use of all ctype macros
    
    * cfg.mk (disable_temporarily): Don't disable sc_avoid_ctype_macros.
    * fish/tilde.c: Remove unnecessary inclusion of ctype.h.
    * bootstrap: Add gnulib's c-ctype module to the list.
    * daemon/m4/gnulib-cache.m4: Likewise.
    * daemon/ext2.c: Include "c-ctype.h", not <ctype.h>.
    Use c_isspace, etc, rather than isspace.
    * daemon/guestfsd.c: Likewise.
    * daemon/lvm.c: Likewise.
    * daemon/proto.c: Likewise.
    * fish/fish.c: Likewise.
    * fish/tilde.c: Likewise.
    * src/generator.ml: Likewise.
    * src/guestfs.c: Likewise.
    * examples/to-xml.c: Likewise.
    * examples/Makefile.am (to_xml_CPPFLAGS): Add -I$(top_srcdir)/gnulib/lib
    so inclusion of "c-ctype.h" works.
    (to_xml_CPPFLAGS): Rename from to_xml_CFLAGS.

commit 0ca36888c6975ffa7e03df11bf8ded42156939c7
Author: Jim Meyering <meyering@redhat.com>
Date:   Thu Sep 24 09:34:53 2009 +0200

    maint: prune dead wood from list of skipped syntax-check rules
    
    * cfg.mk (local-checks-to-skip): Remove now-passing and
    no-longer-relevant rule names.

commit dc0c80b3884c5fa2735b55b205e7406599bd77b0
Author: Jim Meyering <meyering@vv.meyering.net.meyering.net>
Date:   Thu Sep 24 09:24:55 2009 +0200

    maint: use spaces, not TABs for indentation
    
    "make syntax-check" was failing.  This fixes it.
    * HACKING: Indent with spaces, not TABs.
    * configure.ac: Likewise.
    * rescue/virt-rescue: Likewise.
    * src/generator.ml: Likewise.

commit 275b0db9619b38a734c4718eec5645536ecc90a0
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Sep 23 13:49:46 2009 +0100

    Prepare for 1.0.72.
    
    Also update PO files.

commit 4bd623f6a2d83b2c27daed56f3020152a7bf31f3
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Sep 23 14:23:47 2009 +0100

    More HTMLFILES.

commit 406d4aea4df47c586a97f44525022ef4cfad4cdf
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Sep 23 14:01:28 2009 +0100

    Include virt tools in EXTRA_DIST.
    
    Partially revert b488436cc54288fcae8988493749f2e6c87f274c.
    It turns out that automake doesn't automatically place bin_SCRIPTS
    in EXTRA_DIST.

commit b488436cc54288fcae8988493749f2e6c87f274c
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Sep 23 12:37:26 2009 +0100

    Rename virt-[tool].pl as virt-[tool]

commit 75b6338da3e6e33c02b931623f074ab5a76a1788
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Sep 23 12:09:26 2009 +0100

    Check return value from readlink.

commit 9adddc19e448781cf2076c44f66242fe48b47c7c
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Sep 23 12:05:55 2009 +0100

    Create manpage atomically.
    
    Don't fail with a partial file if disk full, etc.

commit 154370c0e8a7bfcb6af5236bd7232794c188eabb
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Sep 23 12:04:25 2009 +0100

    Replace @...@ with $(...) in these common Makefile.am files.

commit 82918538abc707fb59fff42204f99ef031c593a9
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Sep 23 11:50:49 2009 +0100

    guestfish: Update 'SEE ALSO' section of the manpage.

commit 7801621dc946fe894c960e683db3cf921ef23af6
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Sep 23 11:12:05 2009 +0100

    New tool: virt-edit
    
    Edit any file in a guest.  This was possibly previously
    using guestfish, but having a separate command makes it
    simpler.
    
    The usage is simply:
    
      virt-edit mydomain /some/file
    
    It runs $EDITOR or vi on the file, and if the user changes
    it, uploads the result back to the VM.

commit d15195bad9e50f4d80e84c39100a217a260fc806
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Sep 23 11:11:21 2009 +0100

    virt-cat: Remove some unused Perl module includes.

commit 1b21ed4f5d9307e87fad094ec177c90d5adb91ce
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Sep 22 19:50:21 2009 +0100

    Add 'virt-rescue' command.
    
    This command runs a "rescue appliance" against a virtual machine
    or disk image.  This is useful for making ad-hoc interactive
    changes to virtual machines.
    
      $ virt-rescue --ro /dev/vg_trick/F11x64
    
      Welcome to virt-rescue, the libguestfs rescue shell.
    
      Note: The contents of / are the rescue appliance.
      You have to mount the guest's partitions under /sysroot
      before you will be able to examine them.
    
      bash: cannot set terminal process group (-1): Inappropriate ioctl for device
      bash: no job control in this shell
      ><rescue> mount /dev/vg_f11x64/lv_root /sysroot
      EXT4-fs (dm-0): barriers enabled
      kjournald2 starting: pid 269, dev dm-0:8, commit interval 5 seconds
      EXT4-fs (dm-0): internal journal on dm-0:8
      EXT4-fs (dm-0): delayed allocation enabled
      EXT4-fs: file extents enabled
      EXT4-fs: mballoc enabled
      EXT4-fs (dm-0): mounted filesystem with ordered data mode
      ><rescue> ls /sysroot/
      bin   dev  home  lib64       media  opt   root  selinux  sys  usr
      boot  etc  lib   lost+found  mnt    proc  sbin  srv      tmp  var
      ><rescue> exit

commit 3bc55551356532c17403508dfd8466beb2b9db1e
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Sep 22 19:52:56 2009 +0100

    Add direct appliance mode flag and implementation.
    
    When the g->direct flag is set, the appliance stdin/stdout
    are not connected to the library.  Instead they inherit the
    stdin/stdout of the caller.
    
    This is used to implement virt-rescue.

commit d186e9d3d371162774d026f85823d9615ac3bbbc
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Sep 22 19:51:47 2009 +0100

    Tidy up appliance rescue code.
    
    The appliance shouldn't run the daemon after we leave the
    rescue shell.  It should just exit instead.

commit 0d9325bd101e4e96d7d0a6c9640874cbb1e15ed1
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Sep 22 13:34:50 2009 +0100

    Rejig configure.ac tests for qemu vmchannel support.
    
    vmchannel is no longer required, so we shouldn't test for it.
    However we should test instead for user mode networking support.
    
    Also fix up the documentation / error messages.
    
    Always test for vmchannel and user mode networking support in
    qemu.  This gives us more troubleshooting information if people
    report bugs.

commit b9da0fe3f74e02b355aa2be961e8df3ab8b16b88
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Sep 22 12:12:56 2009 +0100

    Prepare for 1.0.71.
    
    Update version number and update PO files.
    
    Put latest version and release date on the website front page.

commit 1e9e6e50bd1bb81524185d8e32e3b787dead965b
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Sep 22 10:41:05 2009 +0100

    Change handling of spaces on Linux kernel command line.

commit 419cf4bb01727a8b0f23f48199a2831df6c6650e
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Sep 21 15:34:21 2009 +0100

    Update documentation of qemu / vmchannel.

commit ae2e569489eea72083aab8109d8012f74587f692
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Sep 21 15:27:20 2009 +0100

    Implement "null vmchannel" - no vmchannel needed!
    
    This commit removes the requirement for vmchannel, although retaining
    support for it.
    
    In this configuration, known as "null vmchannel", the library
    listens on a random loopback port.  It passes the number of this
    port to the appliance (guestfs_vmchannel=tcp:10.0.2.2:12345), and
    the daemon then connects back.  The library, instead of connecting,
    listens and accepts the connection during guestfs_launch.
    
    QEMU SLIRP (user mode networking) is still required to make this
    work: SLIRP forwards the TCP connection transparently (instead of
    explicitly as with guestfwd) to 127.0.0.1:<port>
    
    There is a window in which any other local process on the machine
    could see the port number in the qemu command line and try to
    connect to it.  This would be a devastating security hole, because
    any local process could pretend to be the daemon and feed back
    malicious replies to our remote procedure calls.  To prevent this,
    we check the UID of the other side of the TCP connection.  If
    the UID is different from the library's EUID, then we reject the
    connection.  To do this we have to parse /proc/net/tcp.  (On Solaris
    we could use getsockopt (SO_PEERCRED), but this doesn't work on
    Linux TCP sockets).
    
    Other vmchannel(s) are still supported.  This is important, because
    we can't in general be sure the qemu will always support SLIRP.
    In particular, in recent versions of qemu it is possible to compile
    out SLIRP.

commit dcb5aa01835c2cc2310fd8427988a2f2af8924f9
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Sep 21 15:27:02 2009 +0100

    Gnulib: Add arpa-inet and netinet-in modules.

commit 8b217a87bf9175e7e02a5913e5617e0d12dfd09c
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Sep 21 13:03:27 2009 +0100

    Flexible guestfs_vmchannel parameter for future appliances.
    
    This reimplements parts of commit da0a4f8d1f6ddd302ceba028d87c6e009589e503
    in a different, but compatible way.
    
    We pass guestfs_vmchannel=tcp:<ip>:<port> on the command line.  This
    is intended to be used as follows (now and in future versions):
    
      tcp:10.0.2.4:6666    for guestfwd vmchannel
      tcp:10.0.2.2:<port>  for future "no vmchannel" implementation
      /dev/vcon4           for future virtio-console vmchannel*
    
    It also accepts the old-style guestfs=10.0.2.4:6666 parameter which
    is sent by older libraries, and turns this transparently into the
    correct format above.
    
    If no guestfs_vmchannel is passed, then this defaults to the guestfwd
    vmchannel which older libraries would expect.
    
    * Maybe this last one should be dev:/dev/vcon4 or file:/dev/vcon4, but
    we don't need to decide that now.

commit 8b91ee5e2d951ae467ac08421db89af48a642086
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Sep 21 12:32:25 2009 +0100

    Rearrange and tidy up code in guestfsd.c
    
    This just tidies up the main() function in the daemon.  There is
    no longer a huge fixed-sized buffer used for the kernel command
    line.  Variables are moved closer to where they are used.  Some
    local variables turned out to be unused - these are removed.  Finally
    the part that reads the kernel command line is moved into a separate
    function.
    
    There is only minimal functional change here (it now prints out
    the kernel command line).
    
    Literal '4' replaced with 'sizeof' expression, at Jim Meyering's
    suggestion during patch review.

commit 0740d45d28435015365b21213263249321d83878
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Sep 21 12:11:51 2009 +0100

    Make GUESTFWD_PORT into a string.

commit a1c8c3e1be70a821a5e4dfeeee6c78979e587b7a
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Sep 21 12:11:01 2009 +0100

    Remove unnecessary extra space from qemu command line.

commit 8869adf1e811d894088dbb0f371edc23299005c8
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Sep 21 11:52:53 2009 +0100

    Remove guestfs_wait_ready (turn it into a no-op).
    
    This commit changes guestfs_launch so that it both launches
    the appliance and waits until it is ready (ie. the daemon communicates
    back to us).
    
    Since we removed the pretence that we could implement a low-level
    asynchronous API, the need to call launch() followed by wait_ready()
    has looked a bit silly.
    
    Now guestfs_wait_ready() is basically a no-op.  It is left in the
    API for backwards compatibility.  Any calls to guestfs_wait_ready()
    can be removed from client code.

commit 62b322872543c2ec069ac4fb0103ab758f587cef
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Sep 21 12:01:11 2009 +0100

    Combine temporary buffers.
    
    buf[], append[] and memsize_str[] were all temporary buffers
    used in non-overlapping code.
    
    Combine them to use a single buffer (buf[]).

commit 8d8b3fafa3655f0a389d98cac63db23ddf9b446c
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Sep 21 11:07:47 2009 +0100

    Rearrange qemu command line order (no functional change).

commit 27374fa479368a15e3c50ea17343be1397b29a10
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri Sep 18 14:06:07 2009 +0100

    Enable new-style -chardev ... guestfwd command line.
    
    Newer versions of qemu have changed the command line format
    (again).  '-net channel' is now deprecated.  Instead we use:
    
        -chardev socket,id=guestfsvmc,path=/path/to/sock,server,nowait
        -net user,vlan=0,net=10.0.2.0/8,guestfwd=tcp:10.0.2.4:6666-chardev:guestfsvmc
        -net nic,model=ne2k_pci,vlan=0
    
    The old style format is still used if the new style is not
    detected at runtime.

commit d5fad33b4eaa39722ea1dc96de9446ffc4805e01
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Sep 17 16:44:20 2009 +0100

    Fix code which looked for leaked FDs between each command.
    
    This code was not checking the return value from system()
    so it failed if uncommented.  Add ignore_value() around the
    call to system.  However, leave the code still disabled.

commit da0a4f8d1f6ddd302ceba028d87c6e009589e503
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Sep 15 17:14:44 2009 +0100

    Remove explicit guestfs=10.0.2.4:6666 kernel command line parameter.
    
    Since we control the appliance tightly, we can just specify
    that it will always use a particular host and port, and we
    don't need to pass it on the command line each time.
    
    Also the VMCHANNEL_* constants are only relevant to the
    particular guestfwd vmchannel implementation, so we rename
    them as GUESTFWD_*.

commit abac360f324d8c881878c5d9b7fb64be93981125
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Sep 17 15:28:41 2009 +0100

    Daemon: fix handling of errors from xread and xwrite.
    
    If xread or xwrite returns -1, that indicates an error and we
    should exit.  Note that xread/xwrite has already printed the
    error message.

commit bb02f0fbe80ef093731bc9a6a407f1edaccf991d
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Sep 17 14:50:04 2009 +0100

    Fix verbose packet dumping functions.
    
    Add the configure parameter --enable-packet-dump so that this
    code can be enabled without editing the source.
    
    This code is normally commented out, because it is too verbose
    unless you happen to be debugging the underlying protocol.  Because
    it is normally commented out, I found it had bit-rotted slightly.
    This commit also fixes the obvious problems.

commit 5ccae24e06c52977f8b71d00c19f1100c1fa9c4c
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Sep 17 14:49:06 2009 +0100

    'len' should be an unsigned 32 bit int.
    
    This only happened to work by accident before because 'unsigned len'
    happens to be 32 bit on all platforms we support.

commit 6c8a69c602643ae3102c263148a94559d6594381
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Sep 17 14:39:42 2009 +0100

    Disable -Wunsafe-loop-optimizations
    
    This warning indicates that GCC could not do a particular sort
    of loop optimization.  It pops up randomly in certain forms of
    looping code, and seems safe to ignore.

commit b25ebed9e61e8903567a65b5a949d9bf47ee8e29
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Sep 15 17:13:24 2009 +0100

    Update PO files (no functional change).

commit b4852788e0a60eb6b5de84400b6a5c055f8531da
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Sep 15 11:13:54 2009 +0100

    Prepare for version 1.0.70.

commit 5af505c8cfb07840b25529131f304101750c6a04
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Sep 15 11:12:45 2009 +0100

    Update PO files.

commit d778225113dfc34ea4aa4c369937092e63223bba
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Sep 15 11:10:20 2009 +0100

    Set minimum gettext version to 0.17.
    
    This fixes the problem that the 1.0.69 tarball would fail in
    the po/ subdirectory when installing:
    
    make[1]: Entering directory `/builddir/build/BUILD/libguestfs-1.0.69/po'
    /bin/sh @MKINSTALLDIRS@ /builddir/build/BUILDROOT/libguestfs-1.0.69-1.fc11.x86_64/usr/share
    /bin/sh: @MKINSTALLDIRS@: No such file or directory
    make[1]: Leaving directory `/builddir/build/BUILD/libguestfs-1.0.69/po'
    
    RHEL 5.3 has gettext 0.14.6.  However the tarball will still
    build (since it includes all the required code).  This may cause
    a problem if RHEL users want to build from the git repository.

commit bf2f52e9c6f787d3b040083909aa9c11c54873f6
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Tue Sep 15 09:23:49 2009 +0100

    Fix comparison between signed and unsigned (for RHEL 5).

commit acbcbfaf39592b0b9c1864740ff0b3baad053b2e
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Mon Sep 14 20:14:47 2009 +0100

    Move decl out for C99 compliance.

commit 204e6da87d7887816ca71545e01ce1374afa4bb5
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Sep 14 19:35:58 2009 +0100

    Update PO files.

commit 130e7be812c45696877590b2d1bac3ab24883bff
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Sep 14 19:35:46 2009 +0100

    Move guestfs-internal-actions.h to EXTRA_DIST.

commit 7aa0d646d34f7cad4c220570ab4a0caafb6b4dc1
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Sep 14 19:28:14 2009 +0100

    Prepare for 1.0.69.

commit 0a0d743ba80e33e676084f2a254c63d4188857b0
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri Sep 11 20:00:30 2009 +0100

    Remove main loop.
    
    This commit removes the external main loop, which never worked
    and caused a number of bugs.  Requests are now done synchronously,
    and if the user wants to have requests issued in the background
    or to have a responsive GUI, then they'll just have to use threads.
    
    The big change is to push all reads and writes through two
    functions called send_to_daemon (for writes) and recv_from_daemon
    (for reads) which operate synchronously.  These functions
    read/write whole messages, and also handle checking for EOF
    (ie. daemon died) and asynchronous log message events from
    qemu (eg. from debug / dmesg printed by the guest).  A more
    complete description of how these work can be found in the code.
    
    This code passes a complete run of the tests.
    
    Bugs believed to be fixed by this commit:
    
      https://bugzilla.redhat.com/show_bug.cgi?id=501888
      internal error: reply callback called twice
    
      https://bugzilla.redhat.com/show_bug.cgi?id=504418
      In virt-inspector: "download: guestfs_download reply failed, see earlier error messages"
    
    I have tried to avoid reintroducing this:
    
      https://bugzilla.redhat.com/show_bug.cgi?id=508713
      libguestfs: error: write: Broken pipe (guestfish only)
    
    One other benefit of this is that 'set_busy/end_busy' calls
    no longer appear in traces.

commit 59b487b7dd9db0dd6f262ca4b39c471c7d6cfa53
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Sep 14 16:21:04 2009 +0100

    Don't enable trace in set_trace test.
    
    This leaves trace enabled afterwards, resulting in some
    ugly test messages.

commit f9071160c1a5fe21a825398a81ba3ca584892a4e
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Sep 14 15:43:23 2009 +0100

    Fix type punning warning about use of CMSG_DATA in Rawhide.

commit 22cee80bc2f631703bf417a54ef4e0f0837e921a
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Sep 11 09:27:57 2009 +0100

    guestfish: Enable grouping in string lists
    
    This change adds the ability to group entries in a string list with single
    quotes. So the string:
      "'foo bar'"
    becomes 1 token rather than 2. Consequently single quotes must now be escaped:
      "\'"
    resolves to a literal single quote.
    
    Incidentally, this change also alters another, probably unintentional behaviour
    of the previous implementation, in that tokens are separated by any amount of
    whitespace rather than a single whitespace character. I.e.:
      "a  b"
    resolves to:
      'a' 'b'
    rather than:
      'a' '' 'b'
    That last syntax can be used if an empty argument is still desired. Whitespace
    is now also defined to include tabs.
    
    parse_string_list can also now fail if it contains an unmatched open quote.

commit f8eb7a18f859fc778d06b9c3f0cafedbeba1e47f
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Sep 14 13:41:02 2009 +0100

    Ignore localrepo/ directory.
    
    This can be used by people building from source and packagers for
    their own purposes.

commit f04ee08806ec7bd313e9d54f48f2eb911fcb3067
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Sep 9 17:48:30 2009 +0100

    Add command trace functionality.
    
    Enable this by calling guestfs_trace (handle, 1) or by
    setting the LIBGUESTFS_TRACE=1 environment variable.

commit 7f2ac369f7747a033f5e84d8c7fb3aa131f25537
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Sep 9 12:34:13 2009 +0100

    Non-daemon actions indirect through generated code.
    
    Previously non-daemon actions were called directly by
    user code, eg:
    
    /* Non-generated */
    int
    guestfs_set_verbose (guestfs_h *g, int v)
    {
      g->verbose = !!v;
      return 0;
    }
    
    This changes these actions so they go indirectly via
    some generated code, eg:
    
    /* Generated */
    int guestfs_set_verbose (guestfs_h *g,
                    int verbose)
    {
      return guestfs__set_verbose (g, verbose);
    }
    
    /* Non-generated */
    int
    guestfs__set_verbose (guestfs_h *g, int v)
    {
      g->verbose = !!v;
      return 0;
    }
    
    The aim is to have a place in the generated code where
    we can add debug or tracing information for these non-
    daemon calls.

commit d5b89d36224b394391af09fba7ed0a7921175610
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Sep 11 17:04:13 2009 +0100

    guestfish: Redirect stdout when executing remote commands
    
    guestfish --listen necessarily redirects its stdout to /dev/null so as not to
    interfere with eval. The remote protocol doesn't contain any other provision for
    collecting stdout for the caller, so executing guestfish --remote will never
    generate any output.
    
    This patch fixes that by forwarding the caller's STDOUT to the listener over the
    unix socket connection. The listener redirects its STDOUT to the caller's STDOUT
    for the duration of the command, then closes it again.

commit 7eda9e6fb2b1f6504167ab650886f5a336fc6919
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Sat Sep 12 09:45:44 2009 +0100

    Update TODO list

commit 6661e0f21587f43579f50bf28d56ee4d45897093
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri Sep 11 20:21:37 2009 +0100

    Add diffutils package.
    
    On Fedora 12, /usr/bin/cmp is not pulled in unless we explicitly
    add the diffutils package.

commit 13432f02ca29eecaa61c8d66c7c52f9b70b2b3be
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Sep 11 14:27:54 2009 +0100

    Add echo_daemon command
    
    echo_daemon is a simple echo which can be used to test connectivity between the
    client and daemon.

commit 02ae70474d418b202b6a8411daa54f8dfc790206
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Sep 11 10:33:32 2009 +0100

    generator.ml: Fix string list memory leak
    
    Parsed string lists are allocated by malloc, but were never freed.

commit 006873b92da9d0a5c7d9008bd94caabe0028e4c0
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Sep 9 12:03:10 2009 +0100

    Ignore some more m4 files.

commit 13458c821bfbe2e1ac0f355f436097951f465694
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Sep 9 12:01:42 2009 +0100

    Don't include gnulib files in POTFILES.in.

commit cfab42b40752f6dc44971b3c48523b917b374e91
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Sep 4 18:00:23 2009 +0200

    avoid build-from-scratch failure due to missing daemon/configure
    
    * bootstrap: Don't use autoreconf's --norecursive
    option.  We require the default --recursive behavior in order
    to create daemon/configure.  Reported by Matthew Booth.

commit 97ef6a82ed32404b751a23b6658e0f9c7ab3298c
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 31 20:29:08 2009 +0200

    maint: guestfs.c: avoid warning about possible NULL deref from llvm/clang
    
    * src/guestfs.h (guestfs_abort_cb): Declare with attribute noreturn.

commit 41f8b506924243d4fd7570913fbbbd9f8040e11f
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 31 19:51:46 2009 +0200

    maint: guestfs.c: remove unnecessary initialization
    
    * src/guestfs.c (guestfs__receive_file_sync): Don't set "r",
    only to ignore it.

commit de81a7d930a6a2ad558eff9396da20237e06ccc1
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Aug 28 14:07:35 2009 +0200

    generator.ml: avoid a warning about signed overflow in tests.c
    
    * src/generator.ml: Emit "unsigned long int n_failed;" rather than
    "int failed;", to avoid warning from gcc about "assuming signed
    overflow does not occur when simplifying conditional to constant".

commit ba5842c1147f4463fce7f613618938fd5b9a1c1a
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Aug 28 13:53:36 2009 +0200

    generator.ml: avoid defined-but-not-used warnings in guestfs_c_actions.c
    
    * src/generator.ml (emit_ocaml_copy_list_function): New function.
    Emit a function definition only if it will be used.

commit 23740528cd2d75a236aae1fb5d073e8be2e5a295
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Aug 28 13:43:16 2009 +0200

    generator.ml: avoid warnings in generated ocaml/guestfs_c_actions.c
    
    * src/generator.ml: Emit prototypes for ocaml_guestfs_* functions,
    to avoid warnings from gcc -Wmissing-prototypes.  Normally we'd put
    these somewhere else, but in this unusual case, they're not needed
    anywhere else.  Handle the >5-argument case, too, for these:
    ocaml_guestfs_test0_byte, ocaml_guestfs_sfdisk_byte,
    ocaml_guestfs_sfdisk_N_byte.

commit e933691fd1c1a5543c05fcd209ce57daf6cac4f7
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 24 11:39:42 2009 +0200

    build: enable gcc warnings in capitests/ and ocaml/
    
    * capitests/Makefile.am: Use $(WARN_CFLAGS) and $(WERROR_CFLAGS).
    * ocaml/Makefile.am:: Likewise.

commit 4125126085bd81bf96efc2cdbdec0f5596c6c9e8
Author: Jim Meyering <meyering@redhat.com>
Date:   Thu Aug 27 13:23:20 2009 +0200

    ocaml/guestfs_c.c: avoid warning about missing prototypes
    
    * ocaml/guestfs_c.c (ocaml_guestfs_create, ocaml_guestfs_close): Declare.

commit 27420d5dcf7ba550751323ea2f27cf45b9146a91
Author: Jim Meyering <meyering@redhat.com>
Date:   Thu Aug 27 12:36:25 2009 +0200

    ocaml/guestfs_c.c: avoid warning about initialization discarding "const"
    
    * ocaml/guestfs_c.c (guestfs_custom_operations): Add a cast.

commit 1accb67720596bd946809d4032661f5d3adb7a26
Author: Jim Meyering <meyering@redhat.com>
Date:   Thu Aug 27 12:34:38 2009 +0200

    ocaml/guestfs_c.c avoid signed/unsigned-comparison warning
    
    * ocaml/guestfs_c.c (ocaml_guestfs_strings_val): Declare index as
    unsigned int.

commit 0fc0e4bd73c60c1cd742509a70cf79932def4ea5
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Aug 25 16:21:48 2009 +0200

    build: use only one m4/ directory
    
    * Makefile.am (ACLOCAL_AMFLAGS): Specify only one include dir: m4.
    * bootstrap: Tell gnulib-tool to put .m4 files in m4/, not gnulib/m4.
    * autogen.sh: Move autoreconf from here into...
    * bootstrap: ...here, so that it is run only when gnulib-tool is.
    Also, tell it to skip the usual autopoint and libtoolize runs.
    * m4/.gitignore: Update.

commit f482e7ea665938152518fe15cd71cfe882dd2b30
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Aug 25 09:10:21 2009 +0200

    build: invoke autopoint with --force
    
    * bootstrap: Invoke autopoint with --force, to avoid warning
    about existing build-aux/config.rpath.
    Invoke libtoolize before gnulib-tool, to avoid spurious warnings.
    * autogen.sh: Add comments.
    Remove build-aux/config.rpath before running autoreconf.

commit 52befe975fb3dcc780785f769429e2eeb72698ac
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Aug 25 09:43:04 2009 +0200

    build: update gnulib submodule to latest
    
    * .gnulib: Update to latest.

commit 881770900938595565036b9b191cfdf39ff0dc98
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Aug 21 19:44:36 2009 +0200

    build: don't define _GNU_SOURCE manually
    
    Now that we're using gnulib in earnest, any manual definition
    would provoke a redefinition warning.
    * fish/fish.c (_GNU_SOURCE): Don't define.
    * fish/destpaths.c (_GNU_SOURCE): Likewise.
    * src/guestfs.c (_GNU_SOURCE): Likewise.
    * bootstrap (modules): Add asprintf, strchrnul, strerror, strndup
    and vasprintf.
    * fish/fish.c (main): Set argv[0] to sanitized program_name, so
    functions like getopt_long that use argv[0] use the clean name.

commit b9a691af0fa468873eda3706a1c797568857785b
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Aug 21 19:19:39 2009 +0200

    guestfish: diagnose stdout write failure
    
    Use gnulib's closeout module to ensure any failure to write to
    stdout is detected and reported.
    * fish/fish.c: Include "closeout.h".
    (main): Call atexit (close_stdout);
    * bootstrap (modules): Add closeout.

commit 8e6d1e1a31a69589fde10e3e230620f1e9d27866
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 24 11:32:17 2009 +0200

    guestfish: don't try to diagnose getopt failure
    
    * fish/fish.c: ... getopt_long already does that.  Instead, suggest
    "Try `guestfish --help' for more information."

commit 6cd965e007f65d6e62872c6ddd782f1de06046e3
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Aug 21 19:05:20 2009 +0200

    guestfish: write --help to stdout, use gnulib's progname module
    
    * fish/fish.c: Include "progname.h".
    (main): Call set_program_name to initialize.
    Don't hard-code guestfish everywhere.  Use program_name.
    However, be careful when modifying argv[0], since it is used
    in the hopes that it is an absolute file name.
    (usage): Don't spew all of --help for a mis-typed option.
    Split long lines.

commit acdf8907dee4fad3049bcc19921ffa96b9b5376b
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 24 11:34:22 2009 +0200

    build: avoid some autoconf warnings
    
    * configure.ac: Move gl_EARLY and gl_INIT to be earlier.

commit 005c82b8b89c50f9fb606ce3f5855a0c9b7b1c23
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Aug 24 11:45:49 2009 +0100

    Todo: ntfsclone.

commit 0abb1ec2b3f0e1f482f93b1c8b3d2ef59bc0321e
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Sat Aug 22 10:40:42 2009 +0100

    Add waitpid along guestfs_close path (RHBZ#518747).

commit 89c3e552e311744c4a26194b48c07c5bd2d9dd83
Author: Jim Meyering <meyering@redhat.com>
Date:   Thu Aug 20 13:56:47 2009 +0200

    fish/: enable -Werror and all of gcc's warning options
    
    * fish/Makefile.am: Use $(WARN_CFLAGS) $(WERROR_CFLAGS).

commit 33687dfaa00658a602180f3afcebe9552804a048
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Aug 21 15:04:32 2009 +0200

    generator.ml: avoid signed/unsigned-comparison warning in fish/cmds.c
    
    * src/generator.ml (emit_print_list_function): Emit code that doesn't
    evoke warnings.  s/int/unsigned int/
    (emit print_*_indent): Likewise, s/int/unsigned int/

commit fad78c609423fe10139b468ec229c3d6792718e2
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Aug 21 15:02:16 2009 +0200

    destpaths.c: avoid signed/unsigned-comparison warning
    
    * fish/destpaths.c (free_words): Change param type: s/int/size_t/.

commit 78e2a30b90621e417b8677868092bc6426d7b097
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Aug 21 14:59:49 2009 +0200

    fish.c: don't perform arithmetic on void* pointers
    
    * fish/fish.c (xwrite): Use char*.

commit fbd7db94066d45df7eb980234fee8603c427daa9
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Aug 21 14:58:20 2009 +0200

    fish.c: avoid signed/unsigned-comparison warning
    
    * fish/fish.c (script): Change type of index to "unsigned int".

commit 7b2d9feb821376603bcbc0707e21edce36109f9a
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Aug 21 14:55:39 2009 +0200

    fish.c: avoid "assignment discards qualifiers..." warning
    
    * fish/fish.c (main): Cast-away-const.
    * fish/fish.h (bad_cast): Define.  Safer than using an actual cast.

commit 05fd2a60466cb7c270b60e9b93c46548acf319cd
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Aug 21 14:50:23 2009 +0200

    tilde.c: avoid a warning
    
    * fish/tilde.c (find_home_for_username): Change param type: s/int/size_t/
    (try_tilde_expansion): Adjust caller.

commit 2d80a11d189e4785a9804c87588dfabd1d593007
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Aug 21 14:45:13 2009 +0200

    fish.c: avoid warnings
    
    * fish/rc.c (UNIX_PATH_MAX): Remove unused definition.
    * fish/fish.h (rc_listen): Declare with __attribute__((noreturn)).

commit c17ff8145718ed86419a7f6c5000b73dd54e324a
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Aug 21 14:41:49 2009 +0200

    edit.c: avoid warning about signed/unsigned comparison
    
    * fish/edit.c (load_file): Change type of param from int to size_t.
    (do_edit): Adjust caller.

commit 7faff93c3cd2143ee20127f75625f5c520b9d787
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Aug 20 16:28:35 2009 +0100

    Remove virt-v2v.  New repo: http://gitorious.org/virt-v2v/

commit d1c35f871022e40f9abd93048c1115c6565f94cb
Author: Jim Meyering <meyering@redhat.com>
Date:   Thu Aug 20 12:29:46 2009 +0200

    daemon: diagnose socket write failure
    
    * daemon/proto.c (send_chunk): Don't ignore socket-write error.
    * daemon/proto.c (send_file_end): Return "int", not void,
    so we can propagate send_chunk failure to caller.
    * daemon/daemon.h (send_file_end): Update prototype.
    * daemon/tar.c (do_tar_out, do_tgz_out): Update uses of send_file_end.
    * daemon/upload.c (do_download): Likewise.

commit 0c92c583d5291e1a3a966b36f107bf48e4bfad93
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 19 21:37:56 2009 +0100

    tests: Found three more references to the squashfs, replaced with ISO.

commit b4acbdbfa1b29c23df2ea6bcc093a118843d3381
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Aug 19 17:51:40 2009 +0100

    tests: namemax on ISO devices is 255
    
    Was 256 for the old squashfs device.

commit 0a016df319420f9291c806bf8c8b528705b1bdc5
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Aug 19 15:51:27 2009 +0100

    Cleanup initialisation of hash entries in Lib.pm

commit 2f3a0e3975ddecce2330324a152530c5b99f22f9
Author: Richard Jones <rjones@debian5x64.home.annexia.org>
Date:   Wed Aug 19 15:09:27 2009 +0100

    tests: Use ISO instead of squashfs.
    
    The squashfs format changes too much.  Use an ISO file for
    the tests instead.

commit 2b891ceef355ce2d6532d65f8febbe3833d4399e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 19 14:03:35 2009 +0100

    mke2fs: Use e4fsprogs programs if available.
    
    On RHEL 5, mke2fs is ancient, and there is a non-standard "mke4fs"
    binary which acts like the more recent mke2fs on Fedora.  Since there
    are several annoyances and actual bugs in the ancient RHEL 5 mke2fs,
    use mke4fs instead if it's available.

commit 5da810b96072c0fd71d78713025a2e104295d0ff
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 19 14:02:08 2009 +0100

    tests: modprobe fat instead of ext2 module.
    
    On RHEL 5, ext2 is compiled into the kernel, so trying to modprobe
    it will fail.  I've checked that fat.ko is always a module on the
    platforms we care about (RHEL 5, Fedora 11, Debian), so use that
    to test instead.

commit 9d04d360c6086e048982b107b2bd7be5df884a83
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 19 14:01:13 2009 +0100

    tests: Conditionally skip UUID tests.
    
    More tests introduced which break with old e2fsprogs that didn't
    support UUIDs.  Skip those tests when the old platform is
    detected.
    
    Also tidy up this code a little.

commit 64d042cb08cd724baa3f60889436d9e0e0a69263
Author: Jim Meyering <meyering@redhat.com>
Date:   Wed Aug 19 14:30:02 2009 +0200

    avoid build failure due to Haskell keyword clash
    
    * src/generator.ml: Fix this particular problem by
    renaming the "module" parameter to "modulename".
    Avoid the general problem by ensuring that no parameter name is
    in the set of nearly all Haskell, OCaml and C reserved words.
    (zfile): Adjust one more offender: s/method/meth/.

commit 569989b7505be8e1ad556fed02805acbf38d1188
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Aug 19 12:52:16 2009 +0100

    Export inspect_linux_kernel in Lib.pm

commit 256c084a2373b77950c88d82f666357e06306e31
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Aug 19 11:42:46 2009 +0100

    Add boot/grub_fs to output
    
    If present, this gives the mount point of the filesystem which contains grub.
    All entries in grub.conf will be relative to this filesystem.

commit 6aa44937d5ee9accb0025cd8536c5adafd24ef23
Author: Jim Meyering <meyering@redhat.com>
Date:   Wed Aug 19 10:01:07 2009 +0200

    guestfish: detect more failed syscalls
    
    * fish/fish.c (issue_command): Detect/diagnose more failed syscalls.

commit 0f7656f2870fd5f1644e54438e7639fa2dcbc747
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Aug 19 09:44:51 2009 +0100

    Prepare for version 1.0.68.

commit 8f1b06f64807239d4b4c923af4db8626a866ff6f
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Aug 19 09:37:44 2009 +0100

    guestfs_launch: Correct checks for dup failure.

commit e55c1fc51e0f9bb5da9b35b8915bd04401798d14
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Aug 19 09:10:24 2009 +0100

    Updated PO files.

commit ab8edb0cf9a23ee4a1655ad3a26a0cff7d61ac3d
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Aug 19 09:09:47 2009 +0100

    build: Comment out some unused macros.
    
    GCC 4.4.1 warns about some unused macros.  Comment these out
    while they are not used.

commit df63ba5e7d916444bb1adae886e5135e8d278b28
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Aug 18 14:56:48 2009 +0200

    build: new configure-time option: --enable-gcc-warnings
    
    * configure.ac: Define/configure it.
    * src/Makefile.am: Use new variables.

commit f1b48465f7e051527ff84370de7f312a706e604b
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Aug 18 15:39:26 2009 +0200

    suppress warnings from -Wmissing-noreturn
    
    Even though these functions are marked as "not implemented yet",
    and they will surely return a value once implemented, ...
    * src/guestfs.c (select_add_timeout): Declare with noreturn attribute.
    (select_remove_timeout): Likewise.

commit 3fa23b14d28d8018f71f659d7e5902850695b24b
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Aug 18 15:35:32 2009 +0200

    suppress a warning from -Wswitch-default
    
    * src/guestfs.c (guestfs_end_busy): Add a "default:" label.

commit d93a02ce3ff1a8aa8ef2ca8be5bf79bbcf8537f4
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Aug 18 15:32:40 2009 +0200

    suppress signed/unsigned-comparison warnings
    
    * src/guestfs.c [struct guestfs_h] (msg_in_size, msg_in_allocated):
    (msg_out_size, msg_out_allocated): Change type from int to unsigned int.

commit dd922bedb7c3e85fbbe1eed10e371aec47138a1d
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Aug 18 15:23:35 2009 +0200

    build: don't perform arithmetic on void* pointers
    
    * src/guestfs.c (receive_file_data_sync, xread, xwrite): Use char*.

commit 1821af4d614aa8bd6a5b911217ac1f557a19820a
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Aug 18 15:12:26 2009 +0200

    generator.ml: suppress signed/unsigned-compare warnings
    
    * src/generator.ml (check_reply_header): Emit parameter declarations
    that are unsigned, so as to avoid signed/unsigned-compare warnings.

commit 93ab20eb367b1c177a73620222afdf1f616dea1c
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Aug 18 15:03:55 2009 +0200

    build: suppress an ignored-dup-return-value warning
    
    * src/guestfs.c (guestfs_launch): Handle dup failure.

commit 1d8afa2416416acaf8b7ffc500cadfde13e3aca3
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Aug 18 14:55:59 2009 +0200

    build: suppress an ignored-write-return-value warning
    
    * bootstrap (modules): Add ignore-value.
    * src/guestfs.c: Include "ignore-value.h".
    (stdout_event): Ignore failure to write to stderr.
    Also, prefer STDERR_FILENO over the literal "2".
    * src/Makefile.am (libguestfs_la_CPPFLAGS): Include gnulib's .h files.
    (libprotocol_la_CFLAGS): Remove -Wall -Wno-unused.

commit 53ce488f380e3dd94c26bf507c5639975125a1ee
Author: Matthew Booth <mbooth@redhat.com>
Date:   Tue Aug 18 15:06:20 2009 +0100

    New 'modprobe' command.
    
    Allow kernel modules to be loaded into the appliance.

commit 7b65b7d323b1933cc1137e677d0e5c33d8bc7ff2
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Aug 18 10:15:57 2009 +0200

    avoid compiler warnings about unused vars in generated code
    
    * fish/Makefile.am: Compile rc_protocol.c into a convenience library,
    so it can have its own CFLAGS, and link that into guestfish.
    
    generator.ml: Use TABs, not spaces for indentation.

commit a75756628f7e822da29b3728ec8e949c60c5cc3f
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Aug 18 09:16:56 2009 +0100

    generator: Small code rearrangement.
    
    Move code which updates pod2text memo file into a separate function.

commit 9c5f05ec14655195fc94dc7c72d132087abe634b
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 17 20:44:01 2009 +0200

    generator.ml: do not emit unused print_* functions
    
    * src/generator.ml: Do not emit functions like print_xattr,
    print_lvm_vg, print_inotify_event, that are not used.

commit 8966b137660fff6619905e842ef793c4c9ed4f6e
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 17 20:28:34 2009 +0200

    generator.ml: do not emit unused print_*_list functions
    
    * src/generator.ml (emit_print_list_function): New function.
    Emit a function definition only if it will be used.

commit c3be5c3297d18bfe2545914f0e07574430437ebe
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 17 18:47:46 2009 +0200

    generator.ml: avoid warnings in generated tests.c
    
    * src/generator.ml: Avoid warnings in generated tests.c, regarding
    print_strings, and in exercising any function that takes a StringList
    or DeviceList parameter.
    (print_strings): Change param type to "char *const *s".
    Declare fully-const initializer for each list-taking function use.
    Cast *List argument to "(char **)".

commit 5a07cdc35856adfa25b8d0924a8d641b2320aadf
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 17 18:44:37 2009 +0200

    avoid compiler warnings about unused vars in generated code
    
    * src/Makefile.am: Compile protocol.c into a convenience library, so it
    can have its own CFLAGS, and link that with the destination one.

commit 24a6cf4533118e04367f7fcdc6eadaa4e2dfbc56
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Aug 18 08:56:18 2009 +0100

    Implement 'debug ls' and 'debug ll' commands.
    
    These commands can be used to list files in the appliance.

commit a578bd9c8ebfc311ec7c9c01085a9cf84be4eae2
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 17 21:14:34 2009 +0200

    generator.ml: Use TABs, not spaces for indentation.

commit 59b26635a02fdf3cb095f0c9735943de6f7878b8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 17 12:27:43 2009 +0100

    Ignore manywarnings.m4 / warnings.m4.

commit 722ff7a4bc034a8fe078d766a30589c07b8bd870
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 17 12:26:58 2009 +0100

    java: Small fix to Java bindings.
    
    Missing declaration of local variable 'i'.

commit 4d8efdd4552874092263bf567701c3459b05a780
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 17 12:23:32 2009 +0100

    HACKING: Document make targets and ./configure --enable-gcc-warnings.

commit d17bd636a8114498aa27ffd4d0dd38a1822fe7cd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 17 12:23:16 2009 +0100

    Remove redundant macro.

commit 9b41eeb91733ee681a6a804464b6930d42ed8fd1
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 17 11:56:10 2009 +0200

    indent with spaces, not TABs

commit 9dd53bcb10283295d7fb5f0a3469be2984d99926
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 17 10:35:05 2009 +0200

    daemon: enable -Werror and many gcc warnings when --enable-gcc-warnings
    
    * daemon/m4/gnulib-cache.m4: Add two modules: manywarnings, warnings.
    * daemon/configure.ac: Implement --enable-gcc-warnings, and selectively
    disable a few warning options that are either not useful or that provoke
    too many warnings for now.
    Define and AC_SUBST WARN_CFLAGS and WERROR_CFLAGS.
    * daemon/Makefile.am (guestfsd_CFLAGS): Use $(WARN_CFLAGS)
    and $(WERROR_CFLAGS), rather than just -Wall.

commit c36fa40b981401cdbf61f596b804e79283d658b2
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 17 10:30:52 2009 +0200

    xattr.c: avoid warning about comparison between signed and unsigned
    
    * daemon/xattr.c (getxattrs): Use an unsigned index.

commit fabf3f661579710d543db46718ec627a53bad61f
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 17 10:25:42 2009 +0200

    guestfsd: don't ignore failed write-to-socket
    
    * daemon/proto.c (reply): Fix typo that would cause us to ignore
    failed write-to-socket.

commit 82a5f441ccc8286885bcab082560207d50acfefd
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 17 09:51:52 2009 +0200

    daemon.h: avoid warning about possible noreturn function
    
    * daemon/daemon.h (main_loop): Use "noreturn" attribute.

commit 9b0ab841856ed7168171f6dceaede88dc9fbb9b2
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 17 09:43:18 2009 +0200

    sfdisk.c, fallocate.c: use a string literal as format
    
    * daemon/fallocate.c (do_fallocate): Format was not a string literal.
    * daemon/sfdisk.c (sfdisk): Likewise.

commit 29e7b9908ea6a4c2a864955e73d5b1d7d64f1fc8
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 17 09:40:16 2009 +0200

    wc, blockdev: avoid warnings about discarding "const" qualifiers
    
    * daemon/wc.c (wc): Make "flag" param const.
    * daemon/blockdev.c (call_blockdev): Likewise, for "switc".

commit 5a9b41ed4462ec765303b973f74f17d5c0138a9a
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 17 09:38:50 2009 +0200

    daemon/zero: don't ignore write and close errors
    
    * daemon/zero.c (do_zero): Detect write and close errors.

commit ff2f3fc656b62ba4291ddb4a7238426c446db7c3
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 17 09:24:47 2009 +0200

    guestfsd.c: don't perform arithmetic on void pointers
    
    * daemon/guestfsd.c (xread, xwrite): Use char* pointers instead.

commit e82d864e02f7ab36881c6cda2798bb76370ee6c7
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 17 09:16:20 2009 +0200

    command.c: avoid shadowing a global function
    
    * daemon/command.c (do_sh_lines, do_sh): Do not shadow global "command".

commit d7569c00787fb92a8cd2f08c537ea1662f987901
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 17 09:15:34 2009 +0200

    avoid warning about old-style no-param function definition
    
    * daemon/df.c (do_df, do_df_h): Add "void".
    * sync.c (do_sync): Likewise.

commit 7793f8eda6b26002cb751503928e06f7b9c4a7d2
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 17 08:49:00 2009 +0200

    generator.ml: emit slightly prettier code
    
    * src/generator.ml: Emit a few omitted newlines.

commit 31053d2027d3db9423edcfc70a725b6ca3a7c84c
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Aug 14 16:54:44 2009 +0200

    python: avoid "_POSIX_C_SOURCE" redefinition warning
    
    * src/generator.ml: Include <Python.h> *before* <stdio.h>
    to avoid redefinition warning about "_POSIX_C_SOURCE".

commit adf20c0c4d9f488d55254f54a79079b9cacbde8d
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Aug 7 09:38:37 2009 +0200

    adjust const "**" pointers to avoid warnings
    
    Also, ...
    * src/generator.ml: Add DeviceList type, and propagate that change
    out to all calling/interface code.

commit 2ad9dbbe595b5311019376a55b13db0d7c5d8988
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Sun Aug 16 11:15:10 2009 +0100

    test-tool: Recognize '-t timeout' as an option.

commit a61bccecfba1c9501910d28de24bac945e95001f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 15 18:03:21 2009 +0100

    New commands: mkfs-b, mke2journal*, mke2fs-J*
    
    mkfs-b: Pass the -b (blocksize) parameter to mkfs.
    
    mke2journal and friends: Lets you create external ext2 journals on
    devices.
    
    mke2fs-J and friends: Lets you create ext2/3/4 filesystems with
    external journals.

commit da54ae6abbd840e28c294949bc796a231f050d6d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 15 18:02:08 2009 +0100

    generator: Generate the UUIDs for tests randomly.
    
    Adds a uuidgen function which gets the random UUID from the
    uuid program.  Uses this for tests.

commit 801e7d8418927e4308b8cb0a079015bbc9212d5e
Merge: 322ff984a fee26ee23
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Aug 14 22:05:39 2009 +0200

    Merge branch '226-elide'

commit 322ff984a39d53422b772bfeb8f69e7c648da8c0
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Aug 14 21:01:48 2009 +0200

    build: avoid "make sytnax-check" failure
    
    * daemon/configure.ac: Change a leading TAB to 8 spaces.

commit fee26ee231d22481a93176b29a9629c780b45dc3
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Aug 14 19:33:35 2009 +0200

    generator.ml: don't emit unused functions
    
    * src/generator.ml: Use "rstructs_used" to emit definitions only for
    put_TYPE_list functions that are used.

commit 4b940d1e349e382cb077be97af43a4893de9ea55
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Aug 14 19:12:18 2009 +0200

    generator.ml: factor out a function
    
    * src/generator.ml (emit_put_list_function): New function.

commit 8300b097ecbd66a1c9e2595e92bf4caca18768e4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 14 16:54:55 2009 +0100

    Work out which RStruct/RStructList structs are really used, and how.

commit 8249460acfc0ab7298d125b4ea29c72729a4582b
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Aug 13 20:45:06 2009 +0100

    guestfish: Add --selinux option.

commit 299bd94e2ace3daa39add2ae9dc7799596b91fcd
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Aug 13 17:27:38 2009 +0100

    Version 1.0.67.

commit 33f53aeb5061cb64aabdaa181632e080f4f4d898
Author: Jim Meyering <meyering@redhat.com>
Date:   Thu Aug 13 18:29:59 2009 +0200

    tests: increase likelihood that heap abuse triggers failure
    
    * regressions/Makefile.am (TESTS_ENVIRONMENT): Always set
    MALLOC_PERTURB_ to a random value in 1..255.

commit 2447695a8dfb67a883c91b43f7b931573e1d3908
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Aug 13 17:23:25 2009 +0100

    appliance: Remove /usr/sbin/tcpd - it's unreadable on RHEL 5.4.

commit 98334f9d3a9120c829c5efacfe402b2cf6254ca2
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Aug 13 17:16:14 2009 +0100

    appliance: Replace LANG=C with LC_ALL=C

commit 4556fd64a8e236ec041cc00ed9687ef9bd455812
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Aug 13 16:41:37 2009 +0100

    umount: Enable device name translation for device parameter.

commit 40a0f2595515b5624ddd93cf26c4ed6383ac530e
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Aug 13 15:00:38 2009 +0100

    mount: Check mountpoints are absolute paths.

commit 9f7bec212fc7d146b4fd4be6e8b3e98677dc0a0a
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Thu Aug 13 14:43:57 2009 +0100

    selinux: Don't fail if libselinux is not found.

commit 77b9dc04cf336e751287837fa35390d875b22e4b
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Aug 13 14:41:52 2009 +0100

    Misc parameters which are String but should be Pathname.

commit dcd67e2c4e81bb270ea7f5ed8b6675b114afca60
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Aug 13 14:41:05 2009 +0100

    In rmmountpoint, have to explicitly check for ABS_PATH (*not* NEED_ROOT).

commit 0790c58e369d8fe77c8d1c6473dd757c63abebab
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Aug 13 14:39:59 2009 +0100

    inotify-add-watch does not need to explicitly check for ABS_PATH.

commit 80c479162db74c461d671128237975aecc982a5e
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Aug 13 14:39:31 2009 +0100

    cp/cp-a/mv parameters marked as Pathname.

commit 9beb53ca567147aa2cd03c8e68b11706bc284713
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Aug 13 14:37:43 2009 +0100

    do_equal does not need to explicitly check for NEED_ROOT/ABS_PATH.

commit e99fb52fb7112dd72be0a43970542df85590556a
Author: Jim Meyering <meyering@redhat.com>
Date:   Thu Aug 13 14:47:00 2009 +0200

    generator.ml: convert leading TABs to spaces

commit bd34e4e9421edee4289b8239e50c1e45a3d842fb
Author: Jim Meyering <meyering@redhat.com>
Date:   Wed Aug 12 21:16:30 2009 +0200

    sfdisk: guard against buffer overflow
    
    * daemon/sfdisk.c (sfdisk): Don't let outrageous "extra_flag"
    or "device" strings overflow a fixed-size buffer.

commit a0bb8e69de762aa88144c7a4825e13c446c2bbcb
Author: Jim Meyering <meyering@redhat.com>
Date:   Wed Aug 12 09:49:24 2009 +0200

    do_umount: don't use RESOLVE_DEVICE anymore
    
    * daemon/mount.c (do_umount): Don't use RESOLVE_DEVICE here,
    now that the caller always invokes REQUIRE_ROOT_OR_RESOLVE_DEVICE.

commit 3a5a66de8f847a0ff11fdcf6c1644e19aa54c0f7
Author: Jim Meyering <meyering@redhat.com>
Date:   Wed Aug 12 10:57:03 2009 +0200

    generator.ml: factor out "pr_args n" function

commit 08c27722647d14a30648dd02e221e1e803d1189e
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Aug 11 18:07:17 2009 +0200

    generator.ml: finish adding Dev_or_Path support
    
    * src/generator.ml: Update all rules to handle Dev_or_Path.
    (the above changes to generator.ml are mostly mechanical)
    Emit a use of REQUIRE_ROOT_OR_RESOLVE_DEVICE.
    * daemon/upload.c (do_download): Remove use of
    REQUIRE_ROOT_OR_RESOLVE_DEVICE, now that it's automatically done
    in calling code.
    * daemon/file.c (do_file): Likewise.

commit 1020246b278aade9671d12dae2554cf7538cf0de
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Aug 11 17:38:05 2009 +0200

    generator.ml: add type: Dev_or_Path
    
    * src/generator.ml (file, download): Use it.

commit 1f0810eb3a98cbfd347af59b6b9bc624ddff6028
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Aug 11 17:17:08 2009 +0200

    generator.ml: constify do_mkdtemp
    
    * daemon/dir.c (do_mkdtemp): Rewrite for a "const" parameter.
    * src/generator.ml (mkdtemp): Declare parameter to be of type Pathname.

commit d70eb3c45bc93f9e9c7ba735e7209d0ede0e505b
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Aug 11 16:17:41 2009 +0200

    generator.ml: move String/Device decls "down" to definition

commit 84fc760439e82e6b3616abd0d1f9bd7d7eb01ec0
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Aug 11 15:59:56 2009 +0200

    generator.ml: use new "Pathname" designation
    
    Nearly every file-related function in daemons/*.c is affected:
    Remove this pair of statements from each affected do_* function:
    -  NEED_ROOT (return -1);
    -  ABS_PATH (dir, return -1);
    and change the type of the corresponding parameter to "const char *".
    * src/generator.ml: Emit NEED_ROOT just once, even when there are two or
    more Pathname args.

commit 79b5084f70cb67c37dd7cbe60821a78981fd8d59
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Aug 11 12:16:51 2009 +0200

    generator.ml: new type, "Pathname"
    
    * src/generator.ml: Emit NEED_ROOT and ABS_PATH into generated
    stubs.c, rather than requiring they be added manually at the start
    of each and every do_* function that operates on a "path" parameter.
    Update grammar: Pathname is just a String, with the above exception.
    Do not update augeas "path" parameters, since they are not file names,
    but rather ":"-separated search paths.  Except aug_init, for which
    "path" *is* a file name.

commit 752147a1da4b1c2381ecba301627427c82b8d8a4
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Aug 11 11:56:33 2009 +0200

    generator.ml: emit "const char *" for Device and String params
    
    * src/generator.ml: Emit "const char *", not "char *" for Device and
    String params, now that the non-const code is hoisted into the calling
    code in stubs.c.

commit a4d2e6df0bbbd7dc9e5bf400e4e35efec0a18ff0
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 10 23:15:25 2009 +0200

    fix daemon.h's use of NEED_ROOT-in-#define

commit 6bda071b5cd8393b37653687027c4ae6c6cf3804
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 10 23:11:01 2009 +0200

    update all NEED_ROOT uses
    
    run this command:
      git grep -l -w NEED_ROOT|xargs perl -pi -e \
        's/(NEED_ROOT) \((.*?)\)/$1 (return $2)/'

commit 0c07f0d23698798475e0d09491812aca52440328
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 10 23:07:21 2009 +0200

    * src/generator.ml: Change all `String "device"' to `Device "device"'.
    
    Then update each affected function, removing each uses of RESOLVE_DEVICE,
    now that it's generated in caller from stub.c.
    * daemon/blockdev.c (call_blockdev): Remove use of RESOLVE_DEVICE.
    * daemon/devsparts.c (do_mkfs): Likewise.
    * daemon/ext2.c (do_e2fsck_f, do_get_e2label, do_get_e2uuid): Likewise.
    (do_resize2fs, do_set_e2label, do_set_e2uuid, do_tune2fs_l): Likewise.
    * daemon/fsck.c (do_fsck): Likewise.
    * daemon/grub.c (do_grub_install): Likewise.
    * daemon/lvm.c (do_lvremove, do_pvcreate, do_pvremove): Likewise.
    (do_pvresize): Likewise.
    * daemon/mount.c (do_mount_vfs): Likewise.
    * daemon/ntfs.c (do_ntfs_3g_probe): Likewise.
    * daemon/scrub.c (do_scrub_device): Likewise.
    * daemon/sfdisk.c (sfdisk, sfdisk_flag): Likewise.
    * daemon/swap.c (do_mkswap, do_mkswap_L, do_mkswap_U): Likewise.
    (do_swapoff_device, do_swapon_device): Likewise.
    * daemon/zero.c (do_zero): Likewise.
    * daemon/zerofree.c (do_zerofree): Likewise.

commit 8601bbda56cdb2b8491b6e2054596ec9599c38f1
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 10 22:50:00 2009 +0200

    update generator to emit each RESOLVE_DEVICE call
    
    * src/generator.ml: Emit RESOLVE_DEVICE (device, goto done);
    just before each Device-enabled do_$FUNCTION.

commit fc266e5ab8c4f013d0e473029c5e0b4cd32cca92
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 10 19:10:14 2009 +0200

    s/NEED_ROOT_OR_IS_DEVICE/REQUIRE_ROOT_OR_RESOLVE_DEVICE/

commit ecd828beb250648541492a69a188a71305897e4e
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 10 19:08:11 2009 +0200

    guestfsd.c: correct s/IS_DEVICE/RESOLVE_DEVICE/ in another comment

commit 302c18e7d095755ab1bcd0b79fd8952e2450ac7a
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 10 23:13:31 2009 +0200

    manually adjust ABS_PATH uses for new semantics
    
    * daemon/file.c (do_cat): fix an ABS_PATH use

commit 0dd6c8c8442d4ff588f6dac2efab24d3409b0dec
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 10 19:03:36 2009 +0200

    update all uses of ABS_PATH
    
    run this command:
      git grep -l -w ABS_PATH|xargs perl -pi -e \
        's/(?:ABS_PATH)( \(.*?,) (.*?)\)/ABS_PATH$1 return $2)/'

commit 4a5e13f15734aa7363e605f716ad6e29c67475c5
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 10 19:02:12 2009 +0200

    propagate semantic changes to NEED_ROOT, NEED_ROOT_OR_IS_DEVICE
    
    changing IS_DEVICE semantics leads to changing semantics of
    NEED_ROOT_OR_IS_DEVICE and NEED_ROOT, too.
    * daemon/daemon.h: Update definitions.

commit e8795f3e9cc7e60a5ad709c0e3b53f60e37fd6c0
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 10 18:54:51 2009 +0200

    convert the last few, manually

commit 1997858e90da728287ef26a6d01a5766ac914312
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 10 18:51:32 2009 +0200

    change almost all uses: s/IS_DEVICE/RESOLVE_DEVICE/
    
    Use this command:
      git grep -l -w IS_DEVICE|xargs perl -pi -e \
        's/\b(?:IS_DEVICE)\b( \(.*?,) (.*?)\)/RESOLVE_DEVICE$1 return $2)/'

commit 966dbd977f12b639169a48042b558834f627e5f8
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 10 18:49:55 2009 +0200

    * daemon/daemon.h (RESOLVE_DEVICE): Rename from IS_DEVICE.
    
    Change parameter from "errcode" (which would be returned) to "fail_stmt"
    so that a caller can specify e.g., "goto done" upon failure.

commit dd449ffba1a5fb3373d847ee1d7b26e9df3ccb1c
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 10 18:17:05 2009 +0200

    generator.ml: define new String-like type: "Device"

commit da90c9d8761caced81b9cf7d6e41180afa53ecb9
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Aug 13 11:48:27 2009 +0100

    Don't assume grub is on a separate boot filesystem
    
    Paths in grub.conf are relative to the filesystem containing it. grub parsing
    currently assumes that it is on /boot, and will fail if it isn't, for example
    because a guest only has a single partition.
    
    This patch makes grub parsing work harder to work out what grub paths are
    relative to. Firstly, it looks for a previous detected 'linux-grub' filesystem.
    If this isn't found, it tries to work out which filesystem contains
    /boot/grub/menu.lst and uses that.

commit d082a76d679b019784bc0b131028ee74e381f4a2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 12 22:12:20 2009 +0100

    add_drive: Don't use cache=off if not supported by underlying filesystem.
    
    If you use the guestfs_add_drive function, then currently it
    generates a qemu command line element like:
    
      -drive ...,cache=off,...
    
    This causes qemu to try to open the device with O_DIRECT.
    Unfortunately some filesystems don't support this flag, notably tmpfs,
    which means you can't use libguestfs in conjunction with tmpfs.  On
    some systems /tmp is a tmpfs filesystem.
    
    This patch fixes this so that if the filesystem doesn't support
    O_DIRECT, then we omit the cache=off parameter.  This seems reasonable
    from a reliability point of view, because if you're using tmpfs then
    you probably didn't expect reliability in the case where your system
    suddenly powers off.

commit 67a679afb17747b5ec392e56cf6121b085b38a3a
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Aug 12 16:56:09 2009 +0100

    Add 'setcon', 'getcon' commands to set and get the SELinux context.

commit 27566d8323e4a8af59f5649aeeaef97ebd55cbd0
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Aug 12 18:23:17 2009 +0100

    Return error if allocations fail.

commit a9b0a6d54fe5fa6564f657650d4608240c71ea3a
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Aug 12 17:40:22 2009 +0100

    Add documentation for SELinux configuration.
    
    Also use L</...> to link between sections.

commit 0bf856930af2f5c45e9c24fd929a3feb25242d01
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Aug 12 17:40:07 2009 +0100

    Spelling fix: labelled -> labeled.

commit 2361905686c62b4163232139c3d390acd2c07916
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Aug 12 16:31:06 2009 +0100

    If using SELinux, mount /selinux in the appliance.
    
    If selinux=1 on the Linux kernel command line, then we mount
    /selinux in the appliance.  We will also bind-mount this
    directory into guests when we run commands.

commit 8157503b09e24667ddab833c1d12dd643ceac71b
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Aug 12 16:10:35 2009 +0100

    Allow selinux=? kernel flag to be controlled.
    
    Adds new API calls to set and get this flags.

commit bf76b637d25fb70f0320caa63e264104112feaab
Author: Jim Meyering <meyering@redhat.com>
Date:   Wed Aug 12 14:44:14 2009 +0200

    fish: don't read freed memory
    
    * fish/rc.c (rc_remote): Close file handle only *after* xdr_destroy,
    because that latter may flush its file handle (implicated via
    xdrstdio_create).  FYI, this failure is triggered for me only when
    MALLOC_PERTURB_ is set to nonzero < 256 in my environment.

commit f1d23409f7297c8435c939b919fe5c2331fd484e
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Aug 11 09:53:16 2009 +0200

    doc: improve emacs snippets
    
    * HACKING: Make (setq indent-tabs-mode nil) apply to nearly all
    files, not just C-mode ones.

commit 19bb2e59f4b976a0022fd1acb7b1620403985b70
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Aug 12 10:38:54 2009 +0100

    Fix regression test rhbz503169c10.sh.
    
    'll' command has changed semantics very slightly
    (see commit 6727e7c8bdf1cb39264a9de6333d228b51c39956).
    We need to fix this test so it doesn't try to run
    the ll command without a mounted disk.

commit 0aaf061c2f73f8852c59afaa9706f42bc578caae
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Aug 11 19:35:04 2009 +0100

    Add contents of /proc/mounts to the debugging information.

commit 6727e7c8bdf1cb39264a9de6333d228b51c39956
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Aug 11 13:16:27 2009 +0200

    daemon/ls: make do_ll require root, like all the rest
    
    * ls.c (do_ll): Do invoke "NEED_ROOT" here, and add a FIXME to
    provide a "debug ll" command with the semantics we're removing.

commit 9f7ebef3d464a2e40fae75012201a5da2740b99c
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 10 15:00:48 2009 +0200

    build: avoid first-time configure-from-clone failure
    
    * bootstrap: Run autopoint before using the file it creates,
    po/Makevars.template.  Reported by Richard Jones.  Details here:
    https://www.redhat.com/archives/libguestfs/2009-August/msg00135.html

commit 13a499406fe43ab3a6d4d13c660f6a8b368e638f
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 10 12:44:09 2009 +0200

    build: enable automake's silent rules option
    
    * configure.ac: Use AM_SILENT_RULES([yes]).
    Those who want verbose build output may configure with
    --disable-silent-rules or use "make V=1".
    * daemon/configure.ac: Likewise.

commit 92ac2400a326256ef819e0195d7ecfa7f03645be
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 10 12:17:00 2009 +0200

    build: daemon/do_debug: parameters aren't always unused
    
    * daemon/debug.c (MAYBE_UNUSED): Define.
    (do_debug): Mark parameters as unused only when they really
    are unused.  Spotted by Richard Jones.
    
    SCALAR(0xdd8370)
    prefer sizeof *VAR sizeof TYPE (no semantic change)

commit 98869b86413ff59afa009f9d06ebc0cc4477ab31
Author: Jim Meyering <meyering@redhat.com>
Date:   Thu Aug 6 16:05:44 2009 +0200

    build: avoid warnings in daemon/inotify.c
    
    Avoid "comparison between signed and unsigned integer expressions"
    warnings.  If it's at all hard or risky to avoid this type of warning,
    then it's not worthwhile.  Here, it's easy and safe.
    * daemon/inotify.c (inotify_posn): Declare local to be of unsigned type.
    (do_inotify_read, do_inotify_files): Likewise.

commit 835f6b2c067f3105a330f1a4309eade3afc80ee6
Author: Jim Meyering <meyering@redhat.com>
Date:   Thu Aug 6 15:28:48 2009 +0200

    build: avoid warnings in daemon/guestfsd.c
    
    * daemon/guestfsd.c (print_arginfo, print_shell_quote): Mark each
    "info" parameter as unused.

commit 5b3452e99992ffb2cee7e6353243b553cdc74a46
Author: Jim Meyering <meyering@redhat.com>
Date:   Thu Aug 6 15:26:13 2009 +0200

    build: avoid warnings in daemon/debug.c
    
    * daemon/debug.c (do_debug): Mark parameters as unused.

commit 7c68bcde3d34047cfbae45fb26a221a52ab6e3ea
Author: Jim Meyering <meyering@redhat.com>
Date:   Thu Aug 6 15:25:03 2009 +0200

    define ATTRIBUTE_UNUSED
    
    * daemon/daemon.h (__attribute__, ATTRIBUTE_UNUSED): Define.

commit 894d7c6733373bb333a4e148cf17c0aab97b8f96
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Aug 7 20:07:03 2009 +0200

    daemon/file.c: remove duplicate absolute-path check
    
    * daemon/file.c (do_file): Remove redundant use of ABS_PATH.
    It's redundant because the preceding line invokes NEED_ROOT_OR_IS_DEVICE,
    which also invokes ABS_PATH.

commit c8419d45c8ca6d0592a5a47399988908fd550d3f
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri Aug 7 17:38:44 2009 +0100

    Tidy up generation of java/Makefile.inc.
    
    (Just whitespace and comment changes, and small restructuring
    of the code).

commit f0d6be10c2d7bbf49bfa1cdbcb99e356458aa60f
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri Aug 7 09:51:04 2009 +0100

    Debug: Improve the way the qemu command line is printed.
    
    Change the way the qemu command is displayed to look like
    this:
    
    /usr/bin/qemu-kvm \
        -drive file=/tmp/test.img,cache=off,if=virtio \
        -m 500 \
        -no-reboot \
        -kernel /tmp/libguestfsHBJHRh/kernel \
        -initrd /tmp/libguestfsHBJHRh/initrd \
        [...]
    
    This allows the command line to be copied and pasted directly
    into the shell, and also makes it simpler to read.

commit b5b87cdb764dc757295316878a7fd6e2ff01bec4
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri Aug 7 09:31:35 2009 +0100

    Allow network interface to be configured.
    
    Add ./configure --with-net-if=(virtio|ne2k_pci) option.
    
    This lets you workaround the following virtio_net bug:
    
    https://bugzilla.redhat.com/show_bug.cgi?id=516022

commit 39e4f1dad208124640f0f795518390ba680a9704
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri Aug 7 08:32:56 2009 +0100

    Tests: swapon_device test mkswap /dev/sda1 instead of /dev/sdb.
    
    On RHEL 5, mkswap /dev/sdb fails, even with the '-f' option
    (contradictory to what the manual page says).
    
    This commit adds a new 'InitPartition' initialization which
    just creates /dev/sda1, and then does the swap test on that.

commit 530a90d3d4d7d107f52ac8db90fdb86c4f3e1737
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Aug 6 18:46:57 2009 +0100

    Always pass mkswap -f parameter.
    
    Otherwise mkswap will give a silly error if you ask it to
    swap on a whole device.

commit a8a4ce2bd3fd021e063cb3b939b45059f07ed053
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Aug 6 18:40:59 2009 +0100

    Tests: Don't test block size in statvfs test.
    
    The block size changes between kernel releases, causing
    a false failure in the tests.  The error was:
    
    test_statvfs_0: bsize was 65536, expected 131072

commit 6abec8f18473b8f373fb48a05265c0c5df881ff5
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Aug 6 17:02:25 2009 +0100

    Version 1.0.66

commit 1503652d07683b21c69a16f6e6f6af9aef84b839
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Aug 6 15:44:20 2009 +0100

    RHEL 5: inotify_init1 call did not exist on RHEL 5.

commit 690472768c2b94daaca3c9980bc31fcd6b09e8b7
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Aug 6 14:35:46 2009 +0100

    Fix: segfault in tab completion (RHBZ#516024).
    
    Actually this fixes two bugs: 'strs' was not being freed on every
    path, and the tab completion segfault described in the bug report.

commit 2b8019e56cf40fe8e8223b4e57cfd590495e8e60
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Aug 6 14:14:18 2009 +0100

    Fix errno check in readdir in devsparts.c

commit 5d78de834c53bfe29d2cc0397ac093428abe8425
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Aug 6 13:38:17 2009 +0100

    Add ne2k-pci driver to the appliance.
    
    This allows people to use the ne2k-pci network driver, for those
    situations where the virtio_net driver is broken (cough 516022 cough).

commit fbb3482a48b46f2ae51fb7600926fc04dc2c5ef1
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Aug 6 12:52:49 2009 +0100

    Make user network numbering explicit.
    
    Use:
     -net user,vlan=0,net=10.0.2.0/8
    just to make the (already implicit) 10.0.2.x network explicit.

commit 2237c2a2b2015388a19236f5bf4d966a045b388b
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Aug 6 12:10:52 2009 +0100

    appliance: More debug added to /init.

commit 12aedab609e09bdf8dd304487940d9d4ea46cb79
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Aug 6 13:07:51 2009 +0100

    Exclude daemon/lib and daemon/tests from being added to po/POTFILES.in

commit d35528d2405038b5864c8bfa85bd30d0f1485261
Author: Jim Meyering <meyering@redhat.com>
Date:   Thu Aug 6 07:50:11 2009 -0400

    build: remove bootstrap's --gnulib-srcdir option
    
    ...because it probably didn't work, and even if it did, we've
    discovered that using a separate git repo like that can lead
    to subtle mix-ups.
    Also, fix invocation of gnulib-tool in daemon/.

commit 03e59ae92a640def5e651eb092e8e8dba8c0daab
Author: Jim Meyering <meyering@redhat.com>
Date:   Thu Aug 6 13:47:48 2009 +0200

    build: fix build failure
    
    * bootstrap (gnulib_tool): Create lib and tests directories
    under daemon/ before running gnulib-tool there.

commit e05ddc70f1fa6d1e8253d69c5d17e69bfad2be90
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 3 11:44:51 2009 +0100

    daemon: use gnulib
    
    * daemon/Makefile.am (SUBDIRS): Define.
    (AM_CPPFLAGS): Define, to include from gnulib's lib/
    (LDADD): Define, to link with gnulib's libgnu.a.
    * daemon/configure.ac: Use AC_CONFIG_AUX_DIR([build-aux]),
    gl_EARLY and gl_INIT.
    (AC_CONFIG_FILES): Add lib/Makefile and tests/Makefile
    * daemon/m4/gnulib-cache.m4: New file, generated by running
    ../.gnulib/gnulib-tool --import --with-tests hash
    * daemon/.gitignore: Ignore all of the imported files.
    build: tell bootstrap about daemon/
    * bootstrap: Run gnulib-tool --update in daemon/.
    Remove bootstrap's --gnulib-srcdir option, because it probably
    didn't work, and even if it did, we've discovered that using
    a separate git repo like that can lead to subtle mix-ups.

commit 315b3069a083c89921f8ee44de19c53cea7e3b11
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Aug 6 11:01:20 2009 +0100

    appliance: Include more debug output in the /init script.
    
    Output more debugging information from this script, to enhance the
    usefulness of LIBGUESTFS_DEBUG output.

commit 98bc29fda446f5c667f4bc799161b3446bfc2ca1
Author: Matthew Booth <mbooth@redhat.com>
Date:   Mon Aug 3 16:04:50 2009 +0100

    Recognise cd-rom devices in devsparts.c
    
    Also:
    * Un-duplicate device detection code by creating a common mapping function.
    * Add some more comments.

commit b1e3c305f8e604a527c2f6b5a8f61cfebeec2b41
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Aug 5 23:33:22 2009 +0100

    Fix test failures in upload and download (RHBZ#515764)
    
    The tests hardcoded an MD5 of the test file, COPYING.LIB, whose contents had
    change. This change causes it to compute the MD5 rather than hardcoding it.
    
    OCaml provided by rjones.

commit 65326fe130cbb08ca797f257b552f301f0cec412
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Aug 6 08:56:39 2009 +0100

    Add copyright and license notice to regressions/test-noexec-stack.pl

commit e725c8bab2b1246d53309ba603d4c7f5b22cfdda
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Aug 5 17:32:02 2009 +0100

    Add some newly-untracked files to .gitignore

commit 8eb7f1a58f424ad0f210fe638574b5067d2ac97b
Author: Matthew Booth <mbooth@redhat.com>
Date:   Mon Aug 3 20:29:24 2009 +0100

    Fix swapon_label test
    
    The swapon label test has a side-effect, in that it creates a new partition.
    This causes the later failure of the list_partitions test.
    
    This change causes the swapon_label test to zero /dev/sdb after the test, and
    then re-read the partition table.

commit 634c033df2e698e1fcc692585fa445d019f0b6e6
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Aug 5 16:00:12 2009 +0100

    Add resultant change to po/POTFILES.in
    
    I missed this when committing 7e9cb884492aec243337ffc8e4432a9ff2690956

commit 7e9cb884492aec243337ffc8e4432a9ff2690956
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Aug 5 14:55:54 2009 +0100

    Add a test for an executable stack in resultant binaries

commit a86f512716d0e9054d4c409ef77b0115e8e1d56a
Author: Jim Meyering <meyering@redhat.com>
Date:   Wed Aug 5 08:01:38 2009 -0400

    build: generate some just-removed files in po/
    
    * bootstrap: Generate po/Makevars and po/LINGUAS.

commit 0c463dd0aa962c405b1be32c925acf9891c96bfc
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Aug 4 14:21:32 2009 +0200

    build: remove trailing blank lines; enable the syntax-check rule
    
    * cfg.mk (disable_temporarily): Remove sc_prohibit_trailing_blank_lines.
    * appliance/Makefile.am: Remove trailing blank line(s).
    * appliance/debian/modules/y0_install-guestfsd: Likewise.
    * appliance/make.sh.in: Likewise.
    * appliance/packagelist.in: Likewise.
    * appliance/update.sh.in: Likewise.
    * haskell/run-bindtests: Likewise.
    * ocaml/run-bindtests: Likewise.
    * python/run-python-tests: Likewise.
    * recipes/squashfs.example: Likewise.
    * ruby/run-ruby-tests: Likewise.

commit 3625b0198c74f2e01eb76b99dadba3a80f97a880
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Aug 4 14:19:29 2009 +0200

    build: exempt symlinks from trailing-blank-line prohibition
    
    * cfg.mk (sc_prohibit_trailing_blank_lines): Exempt symlinks.

commit a4c544ef1282b2ac73ce43885bd7a9691958958e
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Aug 4 14:03:17 2009 +0200

    build: enable syntax-check: TAB-only indentation in Makefiles
    
    * cfg.mk (disable_temporarily): Remove sc_makefile_TAB_only_indentation.

commit 1fc38df2dfe7e991e27d4c2fdd50fbd41ee9cf70
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Aug 4 14:01:38 2009 +0200

    build: tweak HACKING so we pass "make syntax-check"
    
    * HACKING: Convert leading TABs.

commit 8ae7e1057f43e9b79260cdf191f39d657fdf0293
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Aug 4 14:00:11 2009 +0200

    build: remove trailing blanks, enable syntax-check
    
    * regressions/test-cancellation-download-librarycancels.sh:
    * src/generator.ml:
    * cfg.mk (disable_temporarily): Remove sc_trailing_blank.
    * .x-sc_trailing_blank: New file.

commit e15ff2113f5b2a7e0aa138c47c14e93268d25aed
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Aug 4 14:46:38 2009 +0200

    maint: use COPYING.LIB version 2.1
    
    * COPYING.LIB: Update to 2.1.
    * .x-sc_TAB_in_indentation: Also exempt COPYING.LIB.

commit dc3d0e3b8ed8e77b1314f09d116ed97f6a440914
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Aug 4 13:55:51 2009 +0200

    build: don't emit trailing blanks, remove generated file
    
    * ocaml/Makefile.am (.depend): Don't redirect directly to $@.
    Filter out trailing blanks.
    * ocaml/.depend: Regenerate.

commit febff9d2a35c4f40abbaf8943146476bdeac671e
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Aug 4 13:49:19 2009 +0200

    build: remove more files added by ./autogen.sh
    
    * po/LINGUAS: Remove file.
    * po/Makefile.in.in: Likewise.
    * po/Makevars: Likewise.
    * po/Rules-quot: Likewise.
    * po/boldquot.sed: Likewise.
    * po/en@boldquot.header: Likewise.
    * po/en@quot.header: Likewise.
    * po/insert-header.sin: Likewise.
    * po/quot.sed: Likewise.
    * po/remove-potcdate.sin: Likewise.

commit f5034ceb5b7ec349ae19a8abdeec85835183d8ea
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Aug 4 04:47:17 2009 -0400

    build: tell aclocal to search gnulib/m4, too
    
    * Makefile.am (ACLOCAL_AMFLAGS): Append "-I gnulib/m4".

commit 4c2c2793bad56ce05caf6244e10fd5bcd7023383
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 3 10:55:34 2009 -0400

    Document and enforce the new spaces-only indentation policy.
    
    * cfg.mk (disable_temporarily): Remove sc_TAB_in_indentation,
    to enable the "make syntax-check" that enforces this.
    * .x-sc_TAB_in_indentation: New file.  Exceptions.
    * HACKING: Document the policy, with tips on how to conform.

commit 2f1a50d81671810256dce0852e6b1e0810ac44af
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 3 11:10:13 2009 -0400

    Convert all TABs-as-indentation to spaces.
    
    Do it by running this command:
    [exempted files are matched via .x-sc_TAB_in_indentation]
    
      git ls-files \
        | pcregrep -vf .x-sc_TAB_in_indentation \
        | xargs pcregrep -l '^ *\t' \
        | xargs perl -MText::Tabs -ni -le \
          '$m=/^( *\t[ \t]*)(.*)/; print $m ? expand($1) . $2 : $_'

commit 72c829395bb6a4800516d4f535e18af48195585b
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 3 11:00:22 2009 -0400

    Remove files imported via autogen.sh.
    
    * m4/.gitignore: Ignore these files.
    * m4/codeset.m4: Remove file.
    * m4/gettext.m4: Likewise.
    * m4/glibc2.m4: Likewise.
    * m4/glibc21.m4: Likewise.
    * m4/iconv.m4: Likewise.
    * m4/intdiv0.m4: Likewise.
    * m4/intl.m4: Likewise.
    * m4/intldir.m4: Likewise.
    * m4/intlmacosx.m4: Likewise.
    * m4/intltool.m4: Likewise.
    * m4/inttypes-pri.m4: Likewise.
    * m4/inttypes.m4: Likewise.
    * m4/inttypes_h.m4: Likewise.
    * m4/isc-posix.m4: Likewise.
    * m4/lcmessage.m4: Likewise.
    * m4/lib-ld.m4: Likewise.
    * m4/lib-link.m4: Likewise.
    * m4/lib-prefix.m4: Likewise.
    * m4/lock.m4: Likewise.
    * m4/longdouble.m4: Likewise.
    * m4/longlong.m4: Likewise.
    * m4/nls.m4: Likewise.
    * m4/po.m4: Likewise.
    * m4/printf-posix.m4: Likewise.
    * m4/progtest.m4: Likewise.
    * m4/signed.m4: Likewise.
    * m4/size_max.m4: Likewise.
    * m4/stdint_h.m4: Likewise.
    * m4/uintmax_t.m4: Likewise.
    * m4/ulonglong.m4: Likewise.
    * m4/visibility.m4: Likewise.
    * m4/wchar_t.m4: Likewise.
    * m4/wint_t.m4: Likewise.
    * m4/xsize.m4: Likewise.

commit c498ad1fea5a8ca7783a24929b472756f45c57a0
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 3 11:09:13 2009 -0400

    allow use of #if HAVE_CONFIG_H, for example code
    
    * .x-sc_prohibit_have_config_h: New file, to exempt examples.

commit ad7818c34d4d6ef6b0959ef7dbbf006968166030
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 3 15:39:09 2009 +0200

    guestfs: fix typo in my recent change
    
    * src/guestfs.c (guestfs_perrorf): Rename former err to errnum,
    to avoid compilation error.

commit 5fa153b18661e3651e1cc57bb3f477f9bef37f8f
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 3 15:21:44 2009 +0200

    Guard #inclusion of config.h in examples.
    
    * examples/hello.c [HAVE_CONFIG_H]: Include <config.h> conditionally.
    * examples/to-xml.c: Likewise.

commit 58e7e42033b1ac5044ae03f0aa5d5082c5fdb497
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 3 08:32:44 2009 -0400

    build: reenable "syntax-check" rule: sc_const_long_option
    
    * cfg.mk (disable_temporarily): Remove sc_const_long_option.
    * daemon/guestfsd.c (main): Declare long_options to be "const".
    * fish/fish.c (main): Likewise.
    * test-tool/test-tool.c (main): Likewise.

commit a3cceb6f1c9e55759f5d6a07bf5c74a7ea825dcd
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 3 05:53:26 2009 -0400

    build: temporarily disable failing "syntax-check" rules
    
    * cfg.mk (disable_temporarily): Define.

commit 480a489ee4c31cb2f9c9f45941645f05b5f74c67
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 3 05:18:10 2009 -0400

    maint: use a git submodule for gnulib
    
    * .gitmodules: New file, to track gnulib.
    * .gnulib: Submodule directory.
    * Makefile.am (EXTRA_DIST): Don't list config.rpath or
    gitlog-to-changelog.
    * autogen.sh: Adapt to use the new submodule.
    * cfg.mk: New file.
    (SUBDIRS): Add gnulib/lib and gnulib/tests.
    (dist-hook): Reflect new location of getlog-to-changelog.
    * configure.ac: Set build-aux/ as AUX_DIR.
    Invoke gl_EARLY and gl_INIT.
    (AC_CONFIG_FILES): Add gnulib/lib/Makefile and gnulib/tests/Makefile.

commit 3572996364d9d24406241dee5155048440053ecf
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 3 05:33:35 2009 -0400

    always include <config.h>
    
    * ocaml/guestfs_c.c: Include <config.h>.
    * examples/to-xml.c: Likewise.
    * examples/hello.c: Likewise.

commit d39310d10894808580f7c0cfb425083f55685e12
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 3 06:58:16 2009 -0400

    build: add -I option to get config.h.
    
    * ocaml/Makefile.am (AM_CPPFLAGS): Define.
    (guestfs_c.o, guestfs_c_actions.o): Use it.

commit d0fa2e6b7bccb00dbaae09a4d4c1a87b1dea0351
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 3 08:43:54 2009 -0400

    guestfs: don't fault upon failed vasprintf
    
    * src/guestfs.c (guestfs_perrorf): Handle failed vasprintf.

commit 6279c4bbf9cbbe66917ce9ffa4b98eca9040bcd9
Author: Matthew Booth <mbooth@redhat.com>
Date:   Mon Aug 3 11:43:38 2009 +0100

    Cleanup whitespace warnings in Lib.pm

commit e2fa1fe4efcb3bbfe5b7cc2e98b10357abb59422
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Jul 31 17:31:54 2009 +0100

    Use grub entries to find Linux kernels
    
    This change adds grub parsing to Lib.pm. It adds the following structure to $os:
      {boot}
      ->{configs}
        ->[0]
          ->{title}   = "Fedora (2.6.29.6-213.fc11.i686.PAE)"
          ->{kernel}  = \kernel
          ->{cmdline} = "ro root=/dev/mapper/vg_mbooth-lv_root rhgb"
          ->{initrd}  = \initrd
      ->{default} = 0
    
    The kernel and initrd entries are just references to their top level entries
    under kernels and initrd_modules respectively.
    
    It also changes the way Linux kernels and initrd are discovered. Instead of
    searching /lib/modules and /boot for files with matching names, kernels and
    initrds are scanned as they are discovered in grub.conf.
    
    Additionally, the following attributes are added to the kernels top level entry:
    * path
        The path to the kernel's vmlinuz file.
    * package
        The name of the package which installed the kernel.
    
    The xml output of virt-inspector is updated to reflect all of the above changes.

commit 1ba754119a43c4dd715d2e0a4637e50e10ac6987
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 31 23:24:11 2009 +0100

    guestfish: Display RStructList results more pleasantly.

commit 4610db9f1b77f8c263b348fda1974be165a7f841
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 31 22:31:05 2009 +0100

    Add interface to Linux 'inotify' API.

commit 804330120dcbedc754174fdfdf13cf7577a7eba9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 31 15:57:46 2009 +0100

    lib: Add selinux=0 to default kernel command line.
    
    SELinux exists in a very disturbed state if it is enabled at
    boot time, but no policy is loaded.  In particular, it messes
    up the security.selinux extended attributes on files in a
    not-very-useful way.
    
    We can't enable SELinux because we don't know what policy
    can or should be loaded.  Therefore it's best to disable it
    completely.

commit 8647c4ada502d0ce2b940f9e9cd47378d99a9164
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Jul 31 14:30:09 2009 +0100

    Update incorrect comment in Lib.pm
    
    Related: change the name of the function the comment describes to be more
    accurate.

commit 686f28dd7eb98c17aa98c981adf64c53af99e125
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 31 12:12:29 2009 +0100

    Improve warnings about missing tests.
    
    Don't warn where a command just has no tests.
    
    Instead check other commands' tests so we get a definitive
    (and much smaller) list of commands that are not tested anywhere.

commit 77b2275dfcebce16ceea17ddf77a7f9d0a41c082
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 31 11:55:38 2009 +0100

    New commands: swapon-*, swapoff-*, mkswap-file.
    
    swapon-device
    swapoff-device
    swapon-file
    swapoff-file
    swapon-label
    swapoff-label
    swapon-uuid
    swapoff-uuid
    mkswap-file

commit 0e6e32025885286e2de39efca34ced2aaf26b3a3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 31 08:57:10 2009 +0100

    New command: 'fallocate' to (pre-)allocate sized files.

commit afaff775c12f32b7912f194e2fcc8e76b8c82572
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 31 08:39:43 2009 +0100

    New commands: 'ln', 'ln-f', 'ln-s', 'ln-sf' and 'readlink'.
    
    These commands can be used to make hard and symbolic links.  The
    readlink command is used to read existing symbolic links.

commit 7c3a90f94cd6b8fec9cdd1c052b91a14c0ee0e0e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 31 07:39:30 2009 +0100

    Add 'realpath' command.

commit 641f6ae3bf14940d9057860fb022c2946c1daf1c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 31 07:40:57 2009 +0100

    Ignore failure of 'mv' commands in appliance Makefile.
    
    A lot of people report these as 'errors' when they are not.
    Hide the error messages.

commit bbe5877b6c86ace6f27c6f95c559a61888693923
Author: Jim Meyering <jim@meyering.net>
Date:   Thu Jul 30 14:03:48 2009 +0200

    configure.ac: more quoting
    
    Also, prohibit an invalid value of $JAVA_HOME,
    since it must be used unquoted below.

commit 995752f9ca73c0991d969d26be7494914b5f3aaf
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jul 30 12:10:52 2009 +0100

    build: If guestfwd test fails, need to print AC_MSG_RESULT 'no'

commit 8aa10e0bd024eed36f15a7e1fbe889e374425e09
Author: Jim Meyering <jim@meyering.net>
Date:   Thu Jul 30 10:50:49 2009 +0200

    build: fix test for --nocompress option
    
    Richard W.M. Jones wrote:
    > On Wed, Jul 29, 2009 at 10:50:44PM +0200, Jim Meyering wrote:
    >> The test for febootstrap-to-initramfs' --nocompress option
    >> was always failing for me on F11.  Here's why:
    > [...]
    >
    > Ouch that's obscure.  I've applied this patch and the previous
    > one you sent too.  Thanks!
    
    Our messages crossed.
    Rebasing my fixed patch and adjusting the log:
    
    >From 9e7846da50ceeee57187f703835bd3975e789719 Mon Sep 17 00:00:00 2001
    From: Jim Meyering <meyering@redhat.com>
    Date: Wed, 29 Jul 2009 16:33:02 -0400
    Subject: [PATCH] build: quote the other option test similarly
    
    * configure.ac: Quote properly.

commit fe1f08254967f7d053101fe3c5171346ae2be93e
Author: Jim Meyering <jim@meyering.net>
Date:   Wed Jul 29 22:50:44 2009 +0200

    build: fix test for --nocompress option
    
    The test for febootstrap-to-initramfs' --nocompress option
    was always failing for me on F11.  Here's why:
    
      $ bash                               ~/w/co/libguestfs:210-comment-fix
      $ t=`febootstrap-to-initramfs 2>&1`
      [Exit 1]
      $ if ! echo $t|grep -sq -- --nocompress; then echo not found; fi
      not found
    
    Notice: without quotes, the [--nocompress] term expands to "k",
    because I happen to have a temporary file named "k":
    
      $ echo $t
      Usage: febootstrap-to-initramfs [--files=filelist] k DIR Please read
      febootstrap-to-initramfs(8) man page for more information.
      $ echo "$t"
      Usage: febootstrap-to-initramfs [--files=filelist] [--nocompress] DIR
      Please read febootstrap-to-initramfs(8) man page for more information.
    
    a simpler example gives a clue:
    
      $ touch a b c
      $ echo [--z]
      a b c
      $ echo [--a]
      a
      $ echo [--b]
      a b
    
    it's interpreting [--nocompress] as a range: "-" through "n", plus
    the other characters, ocmpres.  "k" falls in the --n range.
    
    Anyhow, here's the fix:
    
    >From 84855642ed41828d01d55123cfab8d8dede759c1 Mon Sep 17 00:00:00 2001
    From: Jim Meyering <meyering@redhat.com>
    Date: Wed, 29 Jul 2009 16:33:02 -0400
    Subject: [PATCH] build: fix test for --nocompress option
    
    * configure.ac: Fix underquoting bug that would cause the test
    for febootstrap-to-initramfs' --nocompress option always to fail
    with certain-letter-named files in the top directory.

commit 5fd9891646a16792dda91505db6610ad9e36a704
Author: Jim Meyering <meyering@redhat.com>
Date:   Wed Jul 29 14:48:45 2009 -0400

    fix comments; move declarations
    
    * daemon/devsparts.c (do_list_devices, do_list_partitions):
    Remove stray words in comments.
    Move declarations down to definition.

commit d58084f387f8e141224d06169959eb0854dd9bc2
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Jul 29 23:02:42 2009 +0100

    Whitespace and comment changes.

commit a9b5fc1e39350c36f78cc19e2f066a3c315c8751
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Jul 29 22:53:23 2009 +0100

    df: Fix alignment of columns.

commit f8f10578093e926f5f36289a6c11615d067fbcad
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Jul 29 21:34:06 2009 +0100

    guestfish: Make more strings translatable.
    
    However this doesn't yet attempt to translate the POD
    command documentation.  We need a plan to do that.

commit 7c4f90ddb8378dcf90cb0cc219105dccaa8a9d6e
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Jul 29 18:46:55 2009 +0100

    tests: Use squashfs for static data where possible.
    
    Instead of creating a new InitBasicFS for just about every test,
    where a test doesn't need to write to the filesystem it is far
    faster to use prepared data on an InitSquashFS instead.
    
    This commit changes as many tests as possible to make this so,
    making the tests much faster.

commit bf2b08560f649c22152e4138531ad0b46b4ad1b3
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Jul 29 18:44:46 2009 +0100

    tests: Fix read_file test.
    
    The test ignored the fact that this function returns a (char *, size_t)
    pair, and just treated the char * as a string.  This of course would
    fail if the string didn't happen to be nul-terminated.
    
    The tests are updated to add a new TestOutputBuffer type which should
    be used with functions that return RBufferOut.

commit 9847e0c07d5907887e26ec60192fa12aa46277ee
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Jul 29 18:10:48 2009 +0100

    Implement '*grep*' family of commands.

commit a3944a2b30daf2fb0239433ea8a862df16d36b6a
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Jul 29 16:51:10 2009 +0100

    Updated Polish translations (Piotr Drąg).

commit 330a601317afa4cc77f2108cb9af007e764eeacd
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Jul 29 16:09:29 2009 +0100

    Version 1.0.65.

commit 2f4459f55b9af7c86ad537b4e652cc8ebe10d080
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Jul 29 15:59:28 2009 +0100

    Updated PO files.

commit e6a3836772a6e9a769539b29e9988aaa5f140d40
Author: Jim Meyering <jim@meyering.net>
Date:   Wed Jul 29 14:16:03 2009 +0200

    build: avoid locale-specific changes in generated, VC'd file
    
    When I build with LC_ALL=C in my environment,
    the all-local rule generates po/POTFILES.in that
    is sorted differently from the on that is checked in:
    
        diff --git a/po/POTFILES.in b/po/POTFILES.in
        index ca01b3d..154915a 100644
        --- a/po/POTFILES.in
        +++ b/po/POTFILES.in
        @@ -63,12 +63,11 @@ fish/tilde.c
         fish/time.c
         inspector/virt-inspector.pl
         java/com_redhat_et_libguestfs_GuestFS.c
        -ocaml/guestfs_c_actions.c
         ocaml/guestfs_c.c
        +ocaml/guestfs_c_actions.c
         perl/bindtests.pl
        -perl/Guestfs.c
        -perl/lib/Sys/Guestfs/Lib.pm
         perl/lib/Sys/Guestfs.pm
        +perl/lib/Sys/Guestfs/Lib.pm
         python/guestfs-py.c
         ruby/ext/guestfs/_guestfs.c
         src/guestfs-actions.c
    
    If we generate that file so that sort always uses the C locale, then,
    this type of difference will not arise.  Here's the patch to fix the
    rule as well as to reflect the change in the generated file:
    
    >From 609e1d1840da25614a7c9e8954e5356050c9f2ad Mon Sep 17 00:00:00 2001
    From: Jim Meyering <meyering@redhat.com>
    Date: Wed, 29 Jul 2009 08:13:35 -0400
    Subject: [PATCH] build: avoid locale-specific changes in generated, VC'd file
    
    * Makefile.am (all-local): Use LC_ALL=C to sort in C locale.
    * po/POTFILES.in: Regenerate.

commit 4fbd283c67831d8ef0f0b49045b3369f3ce036db
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 29 16:01:23 2009 +0100

    On RHEL 5, 'file' command prints 'AMD x86-64' for 'x86-64' arch.

commit b742f0874798050d31ef31fb7f66053e34d36194
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Jul 29 15:55:17 2009 +0100

    Run cpio with --quiet option so it doesn't print 'xx blocks'

commit aa999d0586fd69094cb06ccb3ae5c429649662e0
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Wed Jul 29 15:49:48 2009 +0100

    Lib.pm: Skip tests if perl-libintl module is not available.

commit 8b854734bd13b7f68b72422932de3bf24c84ca15
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Jul 29 15:33:22 2009 +0100

    Lib.pm: Use Perl backtick instead of slurp (Aron Griffis).

commit 25c4b0190c22e3bdc5594aff994c8e8f99db5ab3
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Wed Jul 29 15:02:16 2009 +0100

    Don't show empty CD devices (RHBZ#514505).

commit 2d5b0e7599b456d6817b0f225f5ed4ce4795d043
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Jul 29 12:45:11 2009 +0100

    ocaml: Rebuild the tests from source if the main library changes.

commit 06df9ec2413d7f5ae366bfab1b2177d7b3929837
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Jul 29 09:48:08 2009 +0100

    inspector: Determine guest architecture.
    
    This commit adds kernel and userspace architecture detection
    (fully for Linux, partially for Windows).  It adds an architecture
    for each kernel detected, and an architecture for each root (ie.
    userspace) found.

commit 1f65b900f0f17a700035dea9a76b910504f4507c
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Jul 28 17:55:35 2009 +0100

    Lib.pm: Add file_architecture command.
    
    This command detects the architecture of some types of binaries,
    libraries, kernel modules and initrd images.

commit 7cbd1bbdd5e613561ea7227081f7ddd666b98ee0
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Jul 29 10:15:06 2009 +0100

    Lib: Document the $ro parameter for mount_operating_system properly.

commit 4ce1433497e625b4060add414c1d0bc7a9a30392
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Jul 29 09:39:02 2009 +0100

    Mention related tools in the manual page.

commit ad7497c533cc5c24f667104bebbfa5f6dda8c8f6
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Jul 28 17:14:14 2009 +0100

    Whitespace: indent some names in images/Makefile.am correctly.

commit a82bfb88e553c6626c99757779f9b500664409ba
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Jul 28 15:43:14 2009 +0100

    Lib.pm: Use 'file' as replacement for 'zfile'.

commit 549bba81e739ab10d8013c9ca88ce70b0ddda8e4
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Jul 28 15:29:23 2009 +0100

    Pass '-z' parameter to 'file' command so it looks inside compressed files.
    
    Also we deprecate the old 'zfile' command.

commit 6fe5a945c5cf8094f4d0bf05763418ec20f4c5f2
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Jul 28 15:24:44 2009 +0100

    Add DeprecatedBy flag to mark functions which are deprecated.

commit 75c9b770ad23af1bece9df3b8c87eb9f60ab2024
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Jul 28 15:23:28 2009 +0100

    Need to declare asprintf_nowarn as inline to avoid gcc complaining.

commit 0f2e9c84e9ff1071260770930068642ecc8ac0d9
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jul 27 22:27:45 2009 +0100

    Replace shell_quote function with %Q and %R printf specifiers.
    
    %Q => simple shell quoted string
    %R => path will be prefixed by /sysroot
    
    eg. snprintf (cmd, sizeof cmd, "cat %R", path); system (cmd);

commit bf920f57677c67f903cf8c4c985ce3d290b1dbde
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jul 27 16:39:02 2009 +0100

    Add InitSquashFS test type, for tests that just use the squashfs (/dev/sdd).
    
    This also speeds up those tests because we don't have to wait
    to create a filesystem which is never used.

commit 22eb7fc966bafebedfde437c9b9c9fb903a8bc35
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Jul 24 14:56:38 2009 +0100

    Make read-only optional in mount_operating_system()

commit 3385d7a1bf6afb8508ce334c6231c35cbe2fbae0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 24 18:29:42 2009 +0100

    More ideas on a quick Perl one-liner syntax for TODO file.

commit 3082681cc661011c8745936cc8c05e6fa84e0b98
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 24 15:46:15 2009 +0100

    guestfish -iv should print virt-inspector command (for debugging).

commit d296feb05fbbd331a4ae3ed3e18bb822acdc13c8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 24 14:36:50 2009 +0100

    Reformat the TODO file.

commit 9e8e99c921bccb9ac3b3965a7d689ff443799426
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri Jul 24 09:31:49 2009 +0100

    Pass cgroup_disable=memory, saves ~ 5MB of RAM.

commit 6a0d9a9937162eee090f8dc331921724aef5784d
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jul 23 18:57:05 2009 +0100

    get_append call can return NULL, but bindings didn't handle it.
    
    It's not a good idea because there is no way to return an error
    indication.  However at least this means it won't segfault.

commit 9af502eff08017941a58ad676d0cbb867f83a341
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jul 23 12:45:12 2009 +0100

    RHEL 5 thinks squashfs is HFS+ filesystem, unless we specify the type explicitly.

commit 9c32abcbf6d5c3350e8e3ec4ab6cb4a8c4d1392f
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jul 23 11:16:15 2009 +0100

    Remove hard-coded qemu-kvm, replace with $QEMU.

commit 23cc897c1e2e4d3cd2cff5c7b9c74ebc54e8fff1
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jul 23 10:45:36 2009 +0100

    Version 1.0.63

commit f9de01b9b97e3d13959754446464f9b768deea81
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Jul 22 20:58:39 2009 +0100

    Add libguestfs-test-tool.
    
    This is an end-user testing tool, designed to test basic functionality
    of libguestfs/qemu/kernel combination on the end-user's final host
    machine.
    
    It does not perform a thorough test, but should be enough to find
    most booting issues.
    
    Also this is intended to be used when reporting bugs.

commit 26f69f706e8c661c6ae7946da1b9a4b7bf9150b9
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Jul 22 21:18:01 2009 +0100

    Fix typo in error message.

commit 23e6fc3f61294acf1bce2003dc4060df25e899f9
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Jul 22 21:11:10 2009 +0100

    Revert "Add 'set-kernel'/'get-kernel'/LIBGUESTFS_KERNEL to override appliance kernel."
    
    This reverts commit 34d2df41626f1ee4172a6d40b06d72d6ed9d6348.

commit 1a5755dbbff0fa4d87984cb7d67cb8239fd71a84
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Jul 22 13:42:51 2009 +0100

    set-append and set-kernel parameters are both nullable.
    
    (So are the return values, but leave that bug for another day).

commit 34d2df41626f1ee4172a6d40b06d72d6ed9d6348
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Jul 22 13:35:48 2009 +0100

    Add 'set-kernel'/'get-kernel'/LIBGUESTFS_KERNEL to override appliance kernel.
    
    This allows you to override the appliance kernel with an easy
    command or environment variable.

commit afe8096e9aa2a18541e92262d9473de4a65fa29e
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Jul 22 12:39:21 2009 +0100

    Todo: Suggestion for 'replace' command.

commit 10258cadd0067cb49b89faf1ce424b1c01f5a7c3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 21 16:01:04 2009 +0100

    Add commented-out support for alternate guestfwd syntax.
    
    This commit just moves code around.  The new support is not enabled
    because it doesn't work.  See qemu-devel, subject
    "guestfwd option doesn't allow supplementary ,server,nowait"

commit b2ae7ed6e67b3cf596e1000ec5219bbefb6123dd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 21 15:59:35 2009 +0100

    configure: Detect new-style guestfwd support (RHBZ#512957)
    
    However new qemu 0.10.5 still doesn't work.

commit 83458d26fafd027f5c5c18208b4937cbde6e5ad7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 21 13:34:46 2009 +0100

    Library: Pass more options on the Linux kernel command line.
    
    Always pass:
      noapic             (APIC causes problems for lots of people)
      udevtimeout=300    (for very slow qemu using softemu)
      acpi=off           (ACPI is troublesome and unnecessary, so turn it off)

commit 000f54aac80191b42e0c307440d09fafd4d5fac2
Author: Matthew Booth <mbooth@redhat.com>
Date:   Tue Jul 21 11:46:24 2009 +0100

    Split $os->{version} into $os->{major_version} and $os->{minor_version}

commit 98430c35faa073c60d4c00542c090fe0407c5af7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 21 11:47:57 2009 +0100

    Allow TMPDIR to override directory used for temporary files (RHBZ#512905).

commit e315e0723ec8c2f84809f06d7f2ede4955dd6c67
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 21 11:00:47 2009 +0100

    Generator: Implement RBufferOut and "read-file" call.
    
    This commit implements the RBufferOut type for returning
    arbitrary 8 bit data from calls.
    
    We also implement the guestfs_read_file call to read a
    whole file that can contain any 8 bit content, but up to
    a limit of ~ 2 MB.

commit f6eb8d44942c3d550c72933c406905f2cb86278d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 21 11:10:19 2009 +0100

    Docs: Fully document the guestfs_readdir ftyp return field.

commit 8ab8377ef64ec0e2483826388cf7d3c07ffa8ecc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 21 10:59:51 2009 +0100

    Docs: Add "API Overview" section to guestfs(3) manpage.
    
    This section collects together related API calls, to provide
    more coherent documentation about different ways to carry
    out actions such as uploading and downloading.

commit 039831c74c42553705abad99236ef6541e8dfcd5
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jul 20 19:04:40 2009 +0100

    Generator: Improve accuracy of a comment.

commit 7a14e0509d5cc976deda9b5299f56930e0317502
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jul 20 15:09:11 2009 +0100

    virt-inspector --fish: Fix incorrect '-a' parameter (RHBZ#512709)
    
    virt-inspector --fish dom
    virt-inspector --ro-fish dom
    
    Both of the above commands give incorrect results if run on a
    libvirt domain, eg:
    
    $ virt-inspector --ro-fish RHEL54Betax64
    ==> --ro -a RHEL54Betax64 -m /dev/VolGroup00/LogVol00:/ -m /dev/sda1:/boot
                ^^^^^^^^^^^^^
    
    This is because the current code just prints back the original @ARGV
    parameters.
    
    This patch fixes this by getting the image names instead.

commit 06f6cc32f02c25b88e763237332b17dc7c6c6837
Author: Matthew Booth <mbooth@redhat.com>
Date:   Mon Jul 20 11:16:55 2009 +0100

    Replace 'distrofamily' with feature tags
    
    It turns out that the distribution hierarchy is not as reliable concept as you
    might think. This patch removes distrofamily again.
    
    Instead of distrofamily, we will add feature tags. This patch adds 2 feature
    tags for Linux distributions:
    
    package_format (eg rpm/dpkg)
    package_management (eg rhn/yum/apt)
    
    This change is reflected in the output of virt-inspector

commit 503bd498dac5689f84983b583035a9a4a1f9e756
Author: Guido Günther <agx@sigxcpu.org>
Date:   Sat Jul 18 18:20:29 2009 +0200

    add nls_base.ko and nls_cp437.ko for vfat

commit 78029b529ad98769685d607230b70f71832d5906
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Sat Jul 18 10:43:52 2009 +0100

    Make /sysroot path configurable.
    
    Currently /sysroot is hard-coded throughout the daemon code.
    
    This patch turns the path into a variable so that we can change
    it in future, for example to allow standalone mode to be implemented.
    
    This patch was tested by running all the C API tests successfully.

commit e8c954933b2bfb3bc3ead5a151d49d164f1a8eab
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri Jul 17 17:40:30 2009 +0100

    Version 1.0.62.

commit 8ae10a31ab249994783e3cbcb0b8ee4b2fc591a0
Merge: b993f75d5 9e90b24c7
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri Jul 17 16:33:30 2009 +0100

    Merge branch 'master' of git+ssh://g-rjones@et.redhat.com/git/libguestfs

commit b993f75d55240187fb5f62f87e303490bfc68d86
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 17 16:32:05 2009 +0100

    RHEL 5.4 fix: Check for qemu-kvm binary in /usr/libexec

commit 9e90b24c7d76489f93830377e3d7d3c37f36c30c
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Jul 16 23:48:25 2009 +0100

    Differentiate 'distro' and 'distrofamily' in Sys::Guestfs::Lib
    
    Change distro in the output formally known as virt-inspector to reflect the
    actual distro. Possible values are now: fedora, rhel, centos, scientific,
    debian.
    
    Add new distrofamily entry which is one of: redhat, debian. Currently all
    distros except 'debian' are in the redhat family.
    
    This allows you to, for example, select a RHEL/CentOS/Scientific Linux specific
    kernel for installation rather than assuming they're all the same.
    
    Note this also changes the behaviour of virt-inspector --query. It will now only
    return rhel=yes for RHEL.

commit 2ab233b3124f4dd3e7c686de110d9a97cc525c18
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri Jul 17 09:37:37 2009 +0100

    cat: Example of finding DHCP IP address of a VM.

commit 963576e9001c658d2e386a992f39a768eac3894c
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri Jul 17 09:37:18 2009 +0100

    Fix non-srcdir builds: Ignore perl/Makefile-pl.old

commit 4c54721ad46b77c52eb6bb7e3ffe74325ac52797
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri Jul 17 09:36:28 2009 +0100

    Fix non-srcdir builds: further fixes to OCaml build rules.

commit 4d321bc8f157dac4bad828287758f92ea5a5173a
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jul 16 19:29:47 2009 +0100

    Fixes for non-srcdir builds: Only include POTFILES from SUBDIRS directories.

commit 0c4ec8c09a40f6c1aa18e87231bded3cfdbdb53b
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jul 16 19:27:16 2009 +0100

    Fix non-srcdir builds: fix OCaml build rules.

commit 551baf3082bf4a346a8320df182cb3840418388f
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jul 16 18:52:44 2009 +0100

    Fix non-srcdir builds: Files generated by configure should be in the tarball.

commit ebc5a981dc9219f6e4c33b8918be8753c4fc878c
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jul 16 18:32:57 2009 +0100

    Fix non-srcdir builds: Don't include generated *_protocol.c files in POTFILES.

commit 6bb4c300addd0776d9f74653b98383c717bc29a1
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jul 16 18:31:25 2009 +0100

    Don't clean up some non-generated files.

commit 811b4a51dc25219e19527304892e7f688867e105
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jul 16 18:23:53 2009 +0100

    Fix for non-srcdir builds: more misc fixes.

commit 98515732084c6856c2e22364b2ae64113c2c37c6
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jul 16 18:08:44 2009 +0100

    Fix for non-srcdir builds: Run src/generator.ml from the srcdir.
    
    Note that files generated by src/generator.ml are stored in
    the srcdir, *not* the builddir.  The reason is so that they
    can be included in the tarball and will appear in the srcdir
    for tarball builds.

commit a865795a7edfdc939cf3864ca1b7ea9cdc564dc7
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jul 16 18:04:01 2009 +0100

    More misc fixes to non-srcdir builds.

commit 4f3736162076419641a6225ac28b29d340020604
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jul 16 17:52:59 2009 +0100

    More misc fixes for non-srcdir builds.

commit fd6fecea052b608db0e7b328b1b4a2669258a66f
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jul 16 17:15:40 2009 +0100

    Miscellaneous fixes for non-srcdir builds.

commit 7428b0a70caed014d0cb4126fe8a77432d8957c6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 15 23:12:02 2009 +0100

    New commands: 'mkmountpoint' and 'rmmountpoint'
    
    These specialized commands are used to create additional mountpoints
    before mounting filesystems.  They are only used where you want to
    mount several unrelated or read-only filesystems together, and need
    additional care to use correctly.
    
    Here is how to use these calls to unpack the "Russian doll" nest
    of a Fedora 11 live CD:
    
     add-ro Fedora-11-i686-Live.iso
     run
     mkmountpoint /cd
     mkmountpoint /squash
     mkmountpoint /ext3
     mount /dev/sda /cd
     mount-loop /cd/LiveOS/squashfs.img /squash
     mount-loop /squash/LiveOS/ext3fs.img /ext3
    
    The inner filesystem is now unpacked under the /ext3 mountpoint.

commit 7fc3faabc71621a9d8b429d15327955f20757080
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 15 22:25:51 2009 +0100

    New command: 'mountpoints' which returns a hash of device -> mountpoint.

commit dbbbc753043aca5a32a96fa391851cc394e2ceea
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Jul 15 19:16:02 2009 +0100

    Build fix: perl-libintl is not required for the basic Perl bindings.

commit 9771ab2cab74887c6537a4bb16b5f12037e95e12
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Jul 15 17:18:19 2009 +0100

    Version 1.0.61

commit bdf7a27a790ff26664f91d95239ec33c5467bfeb
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Jul 15 16:34:19 2009 +0100

    New tool virt-cat: display a file in a virtual machine.
    
    This script is just a simpler way to cat a file from a VM.  It
    is otherwise equivalent to using guestfish.
    
     virt-cat someguest /etc/fstab
    
     virt-cat someguest /var/log/messages | tail

commit b3595c5553035798b7b33d05c9326f7e8dd55e69
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Jul 15 14:24:41 2009 +0100

    Make Perl strings translatable using perl-libintl.
    
    All Perl strings are now marked as translatable using __"string"
    or __x("string {placeholder}", placeholder => $_).  Perl strings
    now get copied to the PO files.
    
    The po/POTFILES.in file is now updated automagically whenever we
    add new *.c, *.pl or *.pm files into the repository.

commit 9449b0fce4145a56df9d43169d61e8b2c4e41b09
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Jul 15 11:39:04 2009 +0100

    guestfish: Add tilde expansion for paths (RHBZ#511372).
    
    This commit adds tilde expansion for local users in guestfish:
    
      ><fs> echo "~"
      ~
      ><fs> echo ~
      /home/rjones
      ><fs> echo ~foo
      ~foo
      ><fs> echo ~rjones/bar
      /home/rjones/bar
      ><fs> echo ~roo
      ~roo
      ><fs> echo ~root/foo
      /root/foo
      ><fs> echo ~root
      /root

commit 1d29b4e40bed1145e2ca359bda62d5aa218dbc41
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 14 15:50:29 2009 +0100

    Version 1.0.60.

commit f67babb7567f2012d299c59bdddc1b2f3dde5b11
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 14 15:59:45 2009 +0100

    java/Makefile.inc: Include this generated file.
    
    We have to include this generated file because it is part of
    the build system, thus required to exist before the generator
    runs.

commit b2da776b250a3a081f2929d604dd2423a5bbff8a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 14 15:41:51 2009 +0100

    File missing from tarball: rc_protocol.x

commit 8d53f8869f85b46ec3495db74565a241f33fe2cc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 14 15:19:34 2009 +0100

    Version 1.0.59.

commit 72c6cc02e2c66cccf3c092a232f107cca5896fe1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 14 14:34:57 2009 +0100

    RHEL 5: header was called <sys/xattr.h>

commit 74ee9390d3a7063470925d6d78dd9ba73bb4c634
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 14 14:31:18 2009 +0100

    Fix: daemon/xattr.c can now compile even when no xattr support.

commit a86aa7d152ed996170714a3a4516eab58bf8b59d
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jul 13 13:06:26 2009 +0100

    Guestfish feature: remote control of guestfish over a pipe.
    
    The use case is to have a long-running guestfish process in
    a shell script, and thus to avoid the overhead of starting
    guestfish each time.  Do:
    
     eval `guestfish --listen`
    
     guestfish --remote somecmd
     guestfish --remote someothercmd
     guestfish --remote exit
    
    This patch also supports having multiple guestfish processes
    at the same time.
    
    The protocol is simple XDR messages over a Unix domain socket.

commit 5d6cc25900df4e13e4085f13d4f846cc9719ce61
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 14 13:47:18 2009 +0100

    Removed getfattr/setfattr from TODO list, since now implemented.

commit 2600359b9b520ab386f069fbbcd656e5cdbd9b76
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 14 11:50:55 2009 +0100

    Support for Linux extended attributes.
    
    This commit adds six calls to support Linux extended attributes.
    They are:
      getxattrs     list all extended attributes for a file or directory
      setxattr      add/replace an extended attribute
      removexattr   remove an extended attribute
      lgetxattrs    \
      lsetxattr     (same as above, but operate on symbolic links)
      lremovexattr  /
    
    See attr(5) for more information.
    
    This also adds support for the FBuffer field type, which maps to
    an XDR opaque<> or a C (int, char *) pair.

commit 7b3c76c95162f773dec03e0555d3060f0d2546c9
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Jul 14 12:47:53 2009 +0100

    virt-inspector: Ignore swap partitions marked as "none".

commit 9af96c41f64567e6fbe0dd25f6ffa90385e9c49a
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Jul 14 11:48:55 2009 +0100

    Improve launch error message.
    
    The previous error message was confusing for new users:
    
      libguestfs: error: guestfs_mount: call launch() before using this function
    
    The new error message explains the action that the user must take,
    especially if they are using guestfish:
    
      ><fs> mount /dev/sda1 /
      libguestfs: error: guestfs_mount: call launch before using this function
      (in guestfish, don't forget to use the 'run' command)

commit 7c97febc5ffaeffda7231c88b2966fd85c0bb335
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Jul 14 11:37:05 2009 +0100

    Add reiserfs module to kernel whitelist.

commit c7845fb23e1353ae0331d8300271f813b637628c
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jul 13 18:28:45 2009 +0100

    Only allow virt-v2v to be run on single root guests (ie. no multi-boot).

commit 4e444d5c09d78b0d292d95d1f97de12f26cc139d
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jul 13 18:06:10 2009 +0100

    Ignore old-style initrd which is a compressed ext2 filesystem.
    
    'cpio' chokes on these, taking ages to decide that they are
    not cpio files, and producing masses of messages.  This was
    causing virt-inspector to be very slow (many minutes) on
    RHEL 3 guests.  With this fix, speed is back to normal.

commit 7d41d75c1d4e6dbe61f6cd353bc104663340483f
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jul 13 18:00:07 2009 +0100

    Implement new 'zfile' command, to show file type inside compressed files.

commit f9ecb943be086087feeeaeb49bd8865fd5e54545
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jul 13 16:49:12 2009 +0100

    Ignore java/Makefile.inc (generated file).

commit 96fdcf7f2ed0c0d32cf14b5fea95cfba94f2c977
Author: Matthew Booth <mbooth@redhat.com>
Date:   Mon Jul 13 13:51:42 2009 +0100

    Automatically generate list of built java sources

commit 456446a86909dd05a5162aca4d676f680b47abc4
Author: Matthew Booth <mbooth@redhat.com>
Date:   Mon Jul 13 12:55:02 2009 +0100

    Revert "Fix checking of generator being run from the right directory."
    
    This reverts commit 35c646965a21d452cf74ef3683612210a653c36d.
    
    As well as reverting this change, add a comment explaining that
    configure must run first.

commit 56f7a8a4c8af55d09caef883b60e61e8569ef5a1
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jul 13 12:27:35 2009 +0100

    Move BUILT_SOURCES so the comment is back in the right place.

commit ffd17f8e94af972429f5135208c795c0dbcdfbc8
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jul 13 12:12:34 2009 +0100

    Order alphabetically the options in guestfish.1 manpage.

commit ad64aff8342198f11cf7d8ffff148a9cd5afe6ce
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 11 21:35:03 2009 +0100

    Guestfish: implement -x option, echo commands before executing them.

commit 89dfb94d3ec0276e1bcbaf63c9ecee3ec4e73619
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 11 21:33:41 2009 +0100

    Fix: '-D' was not recognized as a parameter to guestfish.

commit 8d167a98eca95352e36775068bbc0d90f3009edb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 11 21:27:23 2009 +0100

    Regression test: Test reopening the handle in the same process.

commit 625d0bd56189450f48b6308371bf08ee6312d59f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 11 21:20:17 2009 +0100

    Guestfish: Add 'reopen' command to reopen the libguestfs handle.

commit b48dea6217920ef26e4745a9797c07a21407574f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 11 21:07:57 2009 +0100

    Add missing documentation for "more" command in guestfish help output.

commit c66f3600cd76c7fe0e318004c416f7845b934bc6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 11 14:00:53 2009 +0100

    Add tests to many non-daemon functions.
    
    Tests are added to the following functions:
      get_qemu get_path get_append get_autosync
      is_ready is_config is_launching is_busy
      set_memsize get_memsize get_pid

commit 35cf94c61f9f5e15a4e218bdaedba77c36aa4e5b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 11 13:44:53 2009 +0100

    Add TestOutputIntOp, CompareWithIntOp.
    
    These constructors allow enhanced tests where we compare
    the result of a test against some operator, eg. >= 1 or < 5

commit 5b0a37c47aaec0a753a00026b52c305442fd6678
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 11 13:38:01 2009 +0100

    Test for "version" command should be InitNone.

commit d7db5317bc4624184fccd816cbacfce3f75cbd27
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 11 13:37:24 2009 +0100

    Add comment to the code about InitNone and InitEmpty.
    
    These two constructors are treated as identical, but they
    should be distinct concepts.

commit 55c2a4677b4b6c172b4331d0c9cc9a12e8e20084
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 11 13:36:31 2009 +0100

    Fix UPDATES and host_cpu in configure.ac.
    
    UPDATES does not need to be propagated into config.h.
    
    host_cpu was AC_DEFINE'd twice.

commit 3f2ba6fdfbb82234e8a546dc54d568f49cd2e56b
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Sat Jul 11 12:12:33 2009 +0100

    Documentation for virt-v2v.

commit ce315bba284b40c2a729fce1ed2e3d7a746173f8
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Sat Jul 11 11:20:46 2009 +0100

    V2V outline program.

commit fa36a09e7af4275d53098908bfec2441c4ef9ff1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 10 23:14:16 2009 +0100

    Don't list Java files explicitly, since these files are auto-generated.

commit bbd6aeaccce04915be0706efda11c6d40f1f90a6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 10 22:46:06 2009 +0100

    Version 1.0.58.

commit 924df6051655ad145eca78e50dff84166b7124f3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 10 22:15:53 2009 +0100

    Proposal to add BufferIn and RBufferOut types (not implemented).

commit 335a8e3b0efa4c9dee01591134aeeb2b17ae22f5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 10 22:01:50 2009 +0100

    Sys::Guestfs::Lib: Exit with error if a libvirt domain appears to have no disks.

commit b2f01ebcbeed5bc0c954f80283baf7b5ba52256e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 10 21:59:46 2009 +0100

    virt-df: Recognise libvirt domains with file-backed disks.
    
    File-backed disks (<source file="...">) didn't get recognised
    before.  This patch fixes the problem.

commit 995715ebf9935a64f0321c09a527538706aa3cb7
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri Jul 10 17:57:41 2009 +0100

    Add --version options to virt-df, virt-inspector and virt-v2v.

commit 745f1d9ee8480b3a38f778fcc4506ce86da473a6
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri Jul 10 17:52:09 2009 +0100

    Add 'version' call to get true library version number.
    
    This patch also changes the way that the version is specified
    in configure.ac.  It is now made out of four parts (major, minor,
    release and extra) and constructed for AC_INIT.

commit 2105fabddfdcecca68e20285808b4d8bbe133227
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri Jul 10 16:28:15 2009 +0100

    Move 'use File::Temp' from virt-inspector program to Sys::Guestfs::Lib.

commit beb83b6760069558ce0bd23991866789818927ef
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri Jul 10 14:10:31 2009 +0100

    Version 1.0.57.

commit ca2b02887e268256ef6c66d6032571d3da70ff9c
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri Jul 10 14:09:47 2009 +0100

    Update PO files.

commit 7f021a32a29433153f9d4a69951eab97586f3b77
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri Jul 10 14:09:33 2009 +0100

    Additional C files for POTFILES.in.

commit 6d9804170017b4c44fa6d288e110b63573da14b4
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri Jul 10 14:02:45 2009 +0100

    Rename internal subroutines with leading underscore character.
    
    Otherwise Pod::Coverage in the tests will complain that the
    internal subroutines are undocumented.

commit e547e639b14072bc238cf161669bc3d94a8d6e13
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri Jul 10 13:04:17 2009 +0100

    Working version of virt-df.

commit ca75b55ec25f8ae3463702f16cdeb95ebde2916a
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri Jul 10 12:06:11 2009 +0100

    Fix for returning structures (hashes) from Perl calls.
    
    Calls such as stat and statvfs which returned a single structure
    were returning an array of values instead of a full hash of keys +
    values.
    
    Fix this by pushing the key names on the stack too.

commit 0fc6b7affd28ad77566e832f338650b771145ea1
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri Jul 10 11:43:17 2009 +0100

    '$_' should be marked as a local variable in Sys::Guestfs::Lib::open_guest.

commit 03e1f74ee08dc71bc09cc7655bf4732685f80b43
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri Jul 10 11:41:43 2009 +0100

    Properly close fds and unregister handlers in guestfs_close.
    
    This caused a segfault if you tried to repeatedly open and close
    a guestfs handle in the same program.  The reason is that the
    old handler remained registered (not always - it was racey).
    
    This adds proper cleanup to the guestfs_close path, also for file
    descriptors.

commit 67a3d3e3915a18a58702b7e68f514d9dc9a82a2e
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri Jul 10 10:44:20 2009 +0100

    Added framework for 'virt-df' command.

commit 9b56a72636ba7511f7bef19572c161327b9a01df
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri Jul 10 10:23:11 2009 +0100

    Ignore any file called 'localconfigure'.
    
    Developers should put their custom parameters for configure/autogen.sh
    into a script called ./localconfigure, and this script will be ignored
    by git and the build system.

commit 6e790a9d6b225fad4ab080489bd8226c3adb3506
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri Jul 10 10:22:47 2009 +0100

    Added outline of the virt-v2v script.

commit c1768e07fb207328daa36e3afce3933bcf9ae6cf
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jul 9 19:37:09 2009 +0100

    Remove virt-inspector --force option - it didn't do anything.

commit cf9d291e6dcf09a1d16d50a80fa420d4957f7da1
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jul 9 19:25:01 2009 +0100

    Sys::Guestfs::Lib minor documentation clean-up.

commit 22528e9bc486cbb6357192bd758c417c61bba955
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jul 9 18:29:08 2009 +0100

    Move the inspection analysis code into Sys::Guestfs::Lib library.
    
    Creates new functions:
      inspect_all_partitions
      inspect_partition
      inspect_operating_systems
      mount_operating_system
      inspect_in_detail
    
    Includes far more documentation for the process.

commit 64c565dc905cef89a681c0bd9dce0864f3b03797
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jul 9 15:29:28 2009 +0100

    Move 'resolve_windows_path' to Sys::Guestfs::Lib.

commit 7058e5c63ecc8ed41c9fcc011fbe215bad6f6369
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jul 9 14:35:34 2009 +0100

    Move 'get_partitions' call into Sys::Guestfs::Lib.

commit 2f70ca487bee8babe5aef27f00a2131ea86ebd50
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jul 9 14:01:58 2009 +0100

    Add Sys::Guestfs::Lib - useful functions for using libguestfs from Perl.
    
    This adds an extra Perl module called Sys::Guestfs::Lib which
    adds useful functions for using libguestfs from Perl.
    
    The intention is that common code shared between virt-inspector,
    virt-df and virt-v2v will move into this library.
    
    This patch also changes virt-inspector to use this library.

commit e3c2a599027f88a617b46b77be1673de0c94faee
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jul 9 14:01:10 2009 +0100

    Just whitespace changes in the generator code.

commit 92d47d7f85b68635e08d371568268cff4f76860e
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Jul 8 17:20:52 2009 +0100

    Update with links to the new mailing list.

commit 35c646965a21d452cf74ef3683612210a653c36d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 7 20:28:29 2009 +0100

    Fix checking of generator being run from the right directory.
    
    Originally it was looking for 'config.status', but this file
    might not exist until configure has been run.  Make it look for
    HACKING instead.

commit 9e67beed7a5053a391e25150ddf4e990f2769cb9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 7 20:06:27 2009 +0100

    Version 1.0.56.

commit b095858eb232039230c528b1d720670efad891c2
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Tue Jul 7 19:39:58 2009 +0100

    RHEL 5: Mount squashfs with explicit type.

commit bee76c62d0c1d481cc856c15337ed705e00246ed
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Tue Jul 7 19:02:59 2009 +0100

    RHEL 5: Skip 'scrub' test if command is not in the initramfs.

commit 291986771c95345daaf28fbcb0c54214b8e6b835
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Tue Jul 7 19:01:45 2009 +0100

    RHEL 5: 'mkswap -U' not supported, check before testing it.

commit 8e7277fc7436d2e1eab2c395a34ced47745c6214
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Tue Jul 7 17:34:31 2009 +0100

    Update ocaml/.depend.

commit 2e632a654f82a86c0bd29d935d1ed0b5db46113d
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Tue Jul 7 17:33:47 2009 +0100

    RHEL 5: RHEL kernels don't have $arch at the end, so look for non-arch kernels too.

commit 11400fde901e1c7a6d3c3887f322af66374793c2
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Tue Jul 7 17:33:09 2009 +0100

    RHEL 5: $(builddir) did not exist with this old autoconf/automake, so workaround.

commit 9a3c4a62398d9f0c553ac2b5f43a3eefafd7bac5
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Tue Jul 7 17:32:34 2009 +0100

    RHEL 5: for (int i = ...) is not permitted with this old version of GCC.

commit 157035503b509385084cafac8e5c5fa0afa2fef7
Merge: 6fb57e430 d5532e9ad
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Tue Jul 7 16:55:51 2009 +0100

    Merge branch 'master' of git://git.et.redhat.com/libguestfs

commit d5532e9ad29b28c2b323ad0abe4e0caa6e03f675
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Jul 7 13:42:34 2009 +0100

    Generate structs and struct lists generically.
    
    This modifies the way that struct and struct lists are generated
    (for return values) so that there is no need to add an explicit
    new type when adding a new structure.
    
    All tests pass, and the C API should be compatible.
    
    I have also inspected the changes that are made to the generated
    code by hand.

commit 6c87a747cae61097915c71f6d505f101579e8c7a
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Jul 7 13:03:36 2009 +0100

    Fix for 349814e9d912c4: Get correct path when building Ruby bindings.

commit b5e29ac706004ad29da2e0949beda41e8e27e398
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jul 6 16:01:51 2009 +0100

    Test two (of four) cancellation paths.

commit 82c7e685bf71c70bd1c1c0b9db002157e5788db4
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jul 6 16:01:23 2009 +0100

    Add a debug message to the library cancellation path.

commit 51ecd63944bb1374ebad518d814deaa2096bc365
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jul 6 13:10:25 2009 +0100

    Introduce regression tests for various qemu failures.
    
    Test failure of qemu and recovery of the library:
     - mid-command
     - between commands
     - during launch [test not working yet]
     - explicitly killed by guestfs_kill_subprocess
    
    Also this patch cleans up the other tests in this directory
    and disables the long-winded test-bootbootboot test.

commit f1fadb92179b68519b57680718e30a389a63d5e5
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jul 6 12:46:44 2009 +0100

    guestfish: Always fflush stdout between commands.

commit bf39034d3fd3e4fe83fe80acf60977cbfe7d1c3d
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jul 6 12:37:14 2009 +0100

    Whitespace change in ocaml/.depend file.

commit 7cbb86e4c8b6b8bca8606d219c5571549ceabba6
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jul 6 12:30:59 2009 +0100

    Add 'get-pid' command.
    
    This is used to get the PID of the qemu subprocess, mainly for
    debugging and testing purposes.

commit cab0443e2508209fab67bfe0f723ee79cc5e2929
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jul 6 12:30:33 2009 +0100

    Todo: Remote-control guestfish through a pipe.

commit 35d2b05e634bd77b3f3670d8d844caf750607482
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jul 6 12:05:55 2009 +0100

    Sort the .gitignore file (no semantic change).

commit 3fc2412186693a7fe04d19df5adf9decc4ffdf34
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jul 6 12:03:35 2009 +0100

    Remove files generated by autoreconf (Guido Gunter and Matthew Booth).

commit 51d0620ad90f913cb749e641a839876b3ef755f8
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Sun Jul 5 16:04:50 2009 +0100

    Don't die if reply message is oversized (RHBZ#509597).

commit a11cb4ac38cf245472d93e8df13c5ac630b883a7
Author: Guido Günther <agx@sigxcpu.org>
Date:   Sat Jul 4 14:41:23 2009 +0200

    use 'stupid_simple' instead of 'nested' initramfs
    
    speeds up start of the appliance

commit 22b787d17bf038d50b8f9a31db09c7de3a8f82eb
Author: Guido Günther <agx@sigxcpu.org>
Date:   Fri Jul 3 22:20:05 2009 +0200

    select proper kernel by architecture

commit 349814e9d912c4f372b8fbdfb10b03749911021f
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Jul 3 11:52:50 2009 +0100

    Make it possible to build in a separate directory
    
    This patch allows you to do:
    mkdir build
    cd build
    ../configure ...
    make
    
    This will output all generated files to the build directory. Given that
    autogen automatically runs configure, you can also do:
    
    BUILDDIR=./build ./autogen.sh
    
    which will do the right thing.
    
    Also:
    
    * Fix a dependency bug which means that guestfs_protocol.h
      isn't automatically rebuilt.
    * Re-running autogen.sh with no arguments won't blow away your previous
      configure arguments.

commit 5f9cb51f11879ece8b921d833850505d7e57d339
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Jul 3 14:17:23 2009 +0200

    generate slightly more "const-correct" code
    
    * src/generator.ml: Add a few "const" attributes.

commit 0cc0e9e39f816c3f6174c74bf4cb136a5b4e13ea
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Jul 3 12:05:22 2009 +0200

    avoid leak upon failed realloc
    
    * daemon/guestfsd.c (commandrv): Free original buffer (rather
    than leaking it) if realloc fails.

commit a7b73d4a1e09f12b2002083618056f0c823c1dcf
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Jul 3 11:53:49 2009 +0200

    remove trailing blanks

commit e9f5144537a4d89cc875bce42b269d1e2b119d8f
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Jul 3 11:52:19 2009 +0200

    daemon/readdir: avoid a small leak
    
    * daemon/readdir.c (do_readdir): Free both p and v.name, in case
    only one of the allocations failed.

commit 3f903f01d9d68f427d6afe8aa3daf24257c05c22
Author: Guido Günther <agx@sigxcpu.org>
Date:   Thu Jul 2 17:30:40 2009 +0200

    touch fakeroot.log
    
    indicationg we're done creating the appliance

commit 7e34d2cf59c2c8098683967c32782ffd8ca66aa7
Author: Guido Günther <agx@sigxcpu.org>
Date:   Fri Jul 3 12:42:38 2009 +0200

    remove superflous debirf scripts

commit 2018441f426aac5a6e48fc6d7cf8155122706215
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 3 12:02:21 2009 +0100

    Guestfish tab-completion on destination paths, fixed this time.
    
    Tab-completion on destination paths should now work correctly.

commit 3b5c29f589d4637af4a6f0453975a3df13a6113d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 3 11:31:01 2009 +0100

    Don't keep rebuilding debirf module symlinks.

commit ebed95e5138bea5c56590286f3dcf364748fc38f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 3 11:10:49 2009 +0100

    'readdir-and-stat' call is now effectively implemented.

commit a67c46b4b2ff5a2c4305e39d1bb105b658ca5f89
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 3 10:47:10 2009 +0100

    Add Debian appliance directory to the distfile.
    
    'make dist' won't copy symlinks into the output file, so we
    have to add a rule to the Makefile to copy these.
    
    (Issue reported by Guido Gunther).

commit 6fb57e430c8daa06d8d938ac02a104c8aadbbda5
Merge: b7e094fa1 ee4c49fad
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Fri Jul 3 00:22:14 2009 +0100

    Merge branch 'master' of git+ssh://192.168.122.1/home/rjones/d/libguestfs

commit 447dae7df43e8a98da59d94f1aef9895e087aa13
Author: Jim Meyering <meyering@redhat.com>
Date:   Thu Jul 2 15:39:08 2009 +0200

    use safe_malloc and safe_calloc in generated code
    
    * src/generator.ml (safe_malloc): Define to guestfs_safe_malloc.
    (safe_calloc): Define to guestfs_safe_calloc.
    [most generated code]: Fail immediately upon failure of otherwise-
    unchecked malloc and calloc calls.
    * src/guestfs.c: Include <stddef.h>.
    (xalloc_oversized): Define.
    * src/guestfs.h (guestfs_safe_calloc): Declare.

commit d0bdef850e7bf0edc1a8ee1f05880cdf867aeeb6
Author: Jim Meyering <meyering@redhat.com>
Date:   Thu Jul 2 15:25:58 2009 +0200

    prefer sizeof *VAR over sizeof TYPE (no semantic change)
    
    * src/generator.ml: Slightly safer, in case the
    declared type ever changes.

commit ee4c49fad5a3e36c6e909ab90bcb7d719c9395b3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 2 21:51:47 2009 +0100

    Prepare for 1.0.55.  PO files also updated.

commit b2c76a898b9d6fff09af05e4e3bd1d54c8816a95
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 2 21:50:30 2009 +0100

    Add 'sfdiskM' command.
    
    This command is a saner interface to partitioning.
    
    All partition sizes are specified in megabytes (not cylinders).
    You don't need to specify the cyls/heads/secs parameters.
    
    All the test code has been updated to use this, so it is now
    CHS-independent (eg. when CHS changes as between IDE and virtio).

commit c95f61b0a2e273c9376fe92c58ef6c4914d4ef17
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 2 21:48:17 2009 +0100

    Remove generated files guestfs_protocol.[ch].
    
    These generated files were accidentally left in when we
    removed the other generated files in cset
    b3cb0b04eb2d38ba32c160a83d8e3894b376907b.

commit 7d3cccb66df63815f8230009b8d2fdf8965fbaa8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 2 21:33:51 2009 +0100

    Don't rebuild the whole appliance if just the /init script has been changed.

commit 373a9ad0abb09ee079da834d251a744cdbe9ae70
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 2 21:32:59 2009 +0100

    Improve virtio-blk performance (RHBZ#509383).

commit c7a3729f459a845f4e7b30c09ea378c54ee49c32
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 2 17:38:55 2009 +0100

    Add ./configure --with-drive-if=(ide|scsi|virtio)
    
    With this flag the packager can decide to default to a particular
    qemu drive model.  The current default is 'ide', however note that
    we intend to change this in future to 'virtio' once some upstream
    regressions are fixed.  Packagers can force a particular drive
    model if they wish.

commit 8863ecde5dba262c0736da7505a9fa3655ed42f6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 2 16:02:32 2009 +0100

    Add the guestfish 'time' command.
    
     ><fs> time sfdisk /dev/sda 0 0 0 ,
     elapsed time: 6.12 seconds

commit 62e41312acd0f7fe7f3622a73d6f6efc27b1b511
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 2 15:11:59 2009 +0100

    Add list of function_names to the daemon.
    
    Messages which include the proc_nr can now also include the
    name of the actual function being called.

commit c127ad3d4a494abb2d9bb4fb6eaa179431d2411a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 2 14:11:19 2009 +0100

    In verbose mode, daemon will display the time elapsed for each command.

commit c12edb2d52956e17f7848e34ae1607dc6f0a2a81
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 2 14:10:55 2009 +0100

    Ignore generated file appliance/debian/debirf.conf

commit 9f19ddd0c42a509018340a82bd7dc13a0996e6f5
Author: Guido Günther <agx@sigxcpu.org>
Date:   Tue Jun 30 15:01:14 2009 +0200

    Build Debian based appliance using debirf

commit bcd7bd3aabf4a28bca24bf5d22ed3a68322ec637
Author: Guido Günther <agx@sigxcpu.org>
Date:   Tue Jun 16 23:47:36 2009 +0200

    add debirf files

commit 4e8884823caef364d271075fb9df7dbe450b892c
Author: Guido Günther <agx@sigxcpu.org>
Date:   Thu Jul 2 10:46:37 2009 +0200

    unconditionally load dm module
    
    needed for device mapper (LVM)

commit badfe3a7418cd77614415b71b28ead5f0a43a5e5
Author: Guido Günther <agx@sigxcpu.org>
Date:   Tue Jun 30 14:44:09 2009 +0200

    add missing module
    
    for modularized Debian kernels

commit 0bfadd6908aa9d6a15990541d61bc3cf8600e54b
Author: Jim Meyering <meyering@redhat.com>
Date:   Thu Jul 2 13:36:04 2009 +0200

    avoid automake failure
    
    * daemon/configure.ac: Use AM_PROG_CC_C_O, not AC_PROG_CC_C_O.

commit 11d8dd84d475c89c7fff702e7f7ac5bf57971ac4
Author: Jim Meyering <meyering@redhat.com>
Date:   Thu Jul 2 13:30:07 2009 +0200

    arrange to build some generated sources
    
    * src/Makefile.am (BUILT_SOURCES): Define.
    ($(BUILT_SOURCES)): Depend on stamp-generator.

commit cf61715fa7f8dcf644bebebfa7f2741d8d79a644
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 2 13:07:07 2009 +0100

    Re-add src/MAX_PROC_NR (generated file).
    
    This file is required by configure, so we need to add it so
    it is available after the git checkout.

commit b6b2004db1056d628a4d8c30dd61b14fb18cf876
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 2 12:23:08 2009 +0100

    Memoize the output of pod2text function in the generator.
    
    This speeds up the generator greatly.

commit ab4d96654e5e76da18f84ccdc99580823af9ecb6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 2 12:04:54 2009 +0100

    Updated PO files.

commit b3cb0b04eb2d38ba32c160a83d8e3894b376907b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 2 11:38:36 2009 +0100

    Remove generated code from git.
    
    Git users now require the OCaml compiler in order to regenerate
    the generated code after a checkout.
    
    Generated code will remain in the tarball, so users of the
    source tarball will not need the OCaml compiler.

commit da85ed425dc828ef4b8817f64d448101a88507b5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 2 11:29:00 2009 +0100

    Generator now runs automatically when it has changed.

commit 5186251f8f681f2ebb028423bb49a748861fd11e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 1 20:56:58 2009 +0100

    Add 'readdir' call.
    
    This adds a readdir call (mostly intended for programs).  The
    return value is a list of guestfs_dirent structures.
    
    This adds the new types 'struct guestfs_dirent' and
    'struct guestfs_dirent_list', along with all the code to
    return these in the different language bindings.
    
    Also includes additional tests for OCaml and Perl bindings
    to test this.

commit f20854ec61eef1aea313920f0cf193a78c1a9219
Author: Jim Meyering <meyering@redhat.com>
Date:   Wed Jul 1 16:09:33 2009 +0200

    fish: handle some out-of-memory conditions
    
    * fish/destpaths.c (xalloc_oversized): Define.
    (complete_dest_paths_generator): Use size_t as type for a few
    variables, rather than int.
    Don't deref NULL or undef on failed heap alloc.
    Don't leak on failed realloc.
    Detect theoretical overflow when count_strings returns a very
    large number of strings.
    Handle asprintf failure.
    (APPEND_STRS_AND_FREE): Rewrite as do {...}while(0), so that each use
    can/must be followed by a semicolon.  Better for auto-formatters.

commit 99e28249d52ca5495b636e14ae3e4387ee62c8fe
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 1 17:15:24 2009 +0100

    Call 'udevadm settle' after operations which add/remove device nodes.
    
    Because udev operates asynchronously, we found errors which were
    caused by a previous command (eg. sfdisk or pvremove) creating
    or removing a device, and that change not having happened by the
    time the next command was run.
    
    This patch adds calls to '/sbin/udevadm settle' after any commands
    which can add or remove device nodes.
    
    If udev is not being used or not available, this should have no
    effect.  The command fails and this is silently ignored.

commit 3e2d925717d1dac6b3862e98192c12d1080c2152
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 1 17:13:39 2009 +0100

    All instances of 'pclose' now check for return value != 0.
    
    We are generally interested that the subcommand ran without
    error, ie. had exit status of 0.  'pclose' returns the exit
    status, so we now check that pclose (fp) != 0.

commit fe27753ae5925cbe50042e47115364a57aadbbd7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 1 16:36:13 2009 +0100

    Fix error handling of external sfdisk command.
    
    Should use 'pclose' instead of 'fclose' (although fclose happens
    to work because of glibc internals).
    
    The result of pclose is the exit status of the command, so we
    need to test this is != 0.

commit 896079e29b4d49c6c18ac3316a94bfbe2f307648
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 30 14:01:40 2009 +0100

    Generated code for the virtio_blk change.

commit 4513f2ec7b6aa843005ba886cdd1747b6ff00915
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 30 13:59:29 2009 +0100

    Change to use virtio_blk (virtio block device) by default.
    
    virtio_blk is the fast, virt-native block device driver
    supported by qemu and KVM.  Note that virtio_blk device
    names are called /dev/vd*.
    
    Existing scripts should continue working because device name
    translation will silently change device names of the form
    /dev/sd* to /dev/vd* as required.
    
    See also:
    http://libguestfs.org/guestfs.3.html#block_device_naming

commit 202e11543ead0d21a8485879654c927ec95ea7f0
Author: Jim Meyering <meyering@redhat.com>
Date:   Wed Jul 1 15:45:01 2009 +0200

    Don't dereference or free undefined "msg" upon OOM.
    
    * src/guestfs.c (guestfs_error): Handle failing vasprintf.

commit e909c5e31f6b60e68220177b5cd5e81cfacb8d0d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 1 14:51:06 2009 +0100

    Add libguestfs(3) as an alias manpage for guestfs(3).

commit 2d47f87a3cb9c30340c58619819675981a09e2e5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 1 14:48:35 2009 +0100

    Updated PO files.

commit 996c02c80fbac3f0979863ebc9129de9b7d3709c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 1 14:45:52 2009 +0100

    Reorder the environment variables alphabetically in the documentation.

commit ad0e5d67c2b3e55fadda37cef816702f1d8d643b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 1 14:43:49 2009 +0100

    Document the $PAGER environment variable.

commit 70946fc1b7c7db06a7c11f9088719f0dd6eac1c4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 1 14:42:41 2009 +0100

    Document the LIBGUESTFS_MEMSIZE environment variable.

commit 532009d1ccf16b87859dd58884a82512e8eba937
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 30 15:10:31 2009 +0100

    Change statvfs test so it doesn't depend on device size.
    
    Current statvfs test depended on a lot of filesystem details
    which can change if the CHS of the underlying block device
    changes (eg. with the switch from IDE -> virtio).  These are
    not really necessary to test the call, so instead just check
    for filesystem features.

commit cf42e4d3879da45171e58dbcda25d6671aeb8f3e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 30 15:12:48 2009 +0100

    Clean up the output of the C API test code.
    
    Set output mode to unbuffered so that we see ordinary output
    messages and errors at the same time.
    
    Align "skipped" messages.

commit d4ecaee4d354147e5839ea71c65ea74092793a42
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 30 17:48:07 2009 +0100

    Todo: getfattr, setfattr.

commit a885afb07cc568b4fab66c008379e6059e6f8a22
Author: Guido Günther <agx@sigxcpu.org>
Date:   Tue Jun 30 12:17:40 2009 +0200

    Whitelist kernel modules for hardware emulated by QEMU
    
    (Modified from Guido's original patch to use a wildcard to
    specify all virtio modules - RWMJ).

commit 0884d8bbae6d76a603ec1385ada2938f88981c5c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 30 13:09:44 2009 +0100

    Generated code for mknod, mkfifo, mknod_b, mknod_c, umask.

commit f850e1f065fb04df7cc87a921ab3c658741cc393
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 30 13:08:34 2009 +0100

    New commands: mknod, mkfifo, mknod_b, mknod_c and umask.
    
    These commands are used to create block and char device
    nodes or FIFOs (named pipes) in the filesystem.
    
    The umask command is required also because the permissions
    used by mknod are masked by the umask.
    
    Also document and guarantee that the umask starts as 022.

commit a10a2d46f572829fcd1f4266315106f231327d08
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 30 13:07:07 2009 +0100

    Use octal numbers for modes in the test suite.
    
    We have to use the OCaml convention (0o...).  Note that in
    OCaml 0777 is a _decimal_ number.  It'll catch you out.

commit f68b3ac861ae607a333211c775dded82ae2b2c4a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 30 11:17:06 2009 +0100

    Generated code for 'set_memsize'/'get_memsize' calls.

commit 3d15f7e652340777514ff30c3cfc560a90b612ec
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 30 11:16:22 2009 +0100

    Add 'set_memsize'/'get_memsize' calls.
    
    Allow the qemu memory size to be specified either by API
    calls or by setting the LIBGUESTFS_MEMSIZE environment
    variable.

commit 284797c1561e5e089986027d469bd16ee1a983df
Author: Guido Günther <agx@sigxcpu.org>
Date:   Mon Jun 29 22:56:54 2009 +0200

    Use udev if available (Guido Gunter).
    
    Added support for Fedora's udev (Richard Jones).

commit b4fade6392ccb2961f0d7e2bf45dfc2e20333aed
Author: Guido Günther <agx@sigxcpu.org>
Date:   Mon Jun 29 18:40:00 2009 +0200

    define REDHAT and DEBIAN
    
    so we can preprocess packagelist.in

commit 3155a268151d70a669517a1f1ea8563a7d91cdb8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 20:39:41 2009 +0100

    Todo: Suggest an environment variable for memsize configuration.

commit da8ddb2745c3d53c36e3ad7f09836a4c27a4d3e6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 20:24:47 2009 +0100

    Generated code for the 'mkswap*' commands.

commit 662617ae725c5e41c24128a037060419fbe4b026
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 20:23:42 2009 +0100

    Implement 'mkswap', 'mkswap_L' and 'mkswap_U' commands.
    
    These commands are used to make Linux swap devices.  The mkswap_L
    command makes one with a label.  The mkswap_U command makes one
    with a known UUID.

commit e820df70c7c7486cc4d5cc9f3e7ddbbae195fd41
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 20:24:38 2009 +0100

    Todo: Allow memsize to be configured.

commit 6812864f3783fbe7d3b8e8f33ef1899463fccd02
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 18:52:14 2009 +0100

    Todo: Investigations into 'binarch' command.

commit 786e64ef01c54eb5d84b6cf2564a8c002ace885a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 18:40:42 2009 +0100

    Rearrange guestfish commands in the manpage.

commit f339cb33703fc1b561d9956c29c4eb0e57334a91
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 17:48:03 2009 +0100

    Add missing documentation for new 'more' and 'less' commands in guestfish.

commit d9105530a7da4dffb5cdcb38ef7af0f58f7d515c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 17:33:52 2009 +0100

    Version 1.0.54

commit 2cd636cc441041016744606a5a3b954155eca8d8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 17:33:32 2009 +0100

    Check for XML::Writer dependency for virt-inspector.

commit 1799b5ce4741446704418fe06ea7e13a91028b7e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 17:33:08 2009 +0100

    Remove generated files in make clean.

commit 128f822e16bb96677c75b88125e18f48d7ccedaf
Merge: 103fb55e6 ad475104e
Author: Matthew Booth <mbooth@redhat.com>
Date:   Mon Jun 29 16:27:05 2009 +0100

    Merge commit 'et/master'

commit ad475104ec7fae456d3309cbf4261b893ed160bb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 16:22:10 2009 +0100

    Fix for 'broken pipe' error when qemu dies (RHBZ#508713).

commit 5d6b6a3fbbfea19c606b984bac9cf64b6b81cafe
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 16:05:22 2009 +0100

    Generated code for mount-loop command.

commit a548d51b703f5385797594a37287f4532af289a2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 16:03:54 2009 +0100

    Add mount-loop command (RHBZ#508668).
    
    Loop device mounts don't work for the generic 'mount' commands
    because the first parameter should be a file not a device.
    
    We want to separate out files parameters from device parameters
    in the long term, so this adds a new mount-loop command for this
    purpose.

commit 25ebdcd50685c4364fc852feca201f8335d47b52
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 16:00:49 2009 +0100

    Fix memory leak in daemon/mount.c:do_mount_vfs.

commit 103fb55e6b1428366ab31a0f17484ef1baa68e96
Author: Matthew Booth <mbooth@redhat.com>
Date:   Mon Jun 29 15:34:29 2009 +0100

    Output the config filename containing a modprobe alias in XML
    
    This change affects the XML output:
    
    /operatingsystems/operatingsystem/modprobealiases/alias/text() =>
    /operatingsystems/operatingsystem/modprobealiases/alias/modulename/text()
    
    Additionally there are two new elements:
    
    /operatingsystems/operatingsystem/modprobealiases/alias/augeas
    /operatingsystems/operatingsystem/modprobealiases/alias/file
    
    These contain information about the location of the alias directive.
    /augeas is an augeas path. /file is the path of the file containing the
    directive.

commit 107a76ad3680fda05cfd58136d62eeab4e77a8dc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 15:18:04 2009 +0100

    Todo list: More suggestions.

commit c6d6f5ae1b76ec9aa5c540906aeed73d25d13eb9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 15:18:17 2009 +0100

    Generated code for 'initrd-list'.

commit 4dff42aa13dd726fb6b02843d0f4db4b4b330fe3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 15:16:40 2009 +0100

    Add 'initrd-list' command to list contents of initrd images.
    
    Add 'initrd-list' command to list the files inside (new-style)
    initrd images.  Update virt-inspector to use this instead of
    the less efficient download/unpack locally method.

commit 228b19aa9c28b03b339e8e23fcb46359e3ab617e
Author: Matthew Booth <mbooth@redhat.com>
Date:   Mon Jun 29 14:39:27 2009 +0100

    Add a comment to device naming heuristic

commit e492608f2f3809a824cb70ee03ff305964b69dd7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 12:47:20 2009 +0100

    Generated code for 'du' command.

commit 9a92446bcad09b492dee42dd5950bac67073fbea
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 12:46:59 2009 +0100

    Added 'du' command.
    
    This command estimates file usage for files and directories.

commit b2ed0f4c55c2bd3d07341ba2207f0cb238eb4e18
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 12:26:11 2009 +0100

    Generated code for df / df-h.

commit 405cf2a5772611ea05cca9fefa843154a9bc64a3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 12:25:31 2009 +0100

    Add 'df' and 'df-h' commands.
    
    df and df-h commands can be used interactively to show disk
    space usage.
    
    Use existing statvfs command from programs.

commit 8f382fd9e7b1745a4b1d6f25f0a775bed2573b8e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 12:09:52 2009 +0100

    Todo: Removed suggestion for short form for pipes.

commit 19a1382fc9317ab88cdbf1dde76a8015868af51d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 12:05:58 2009 +0100

    Implement "more" and "less" commands in guestfish.
    
    Use commands such as:
      more /etc/passwd
      less /etc/fstab
    
    These commands are specific to guestfish.

commit 17a45063960b4158fbe9541a2530ed6903b4f761
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 11:48:50 2009 +0100

    Todo list: Pipes now implemented, so remove from list.

commit 826020fe18bf2eee43f8afea392874bb88c0650a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 11:47:07 2009 +0100

    Generated code for head/tail commands.

commit 3854bbdecd1c089959fb812a739b84a96c05fbbf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 11:46:19 2009 +0100

    Implement "head", "head-n", "tail", "tail-n" commands.
    
    These commands let you view parts of a large file without
    passing the whole file over the network connection.

commit 5af058b7d02607dcbcfb8f561cc0b8fec9a7d305
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 11:18:19 2009 +0100

    Prevent 'n' being used as a parameter name.
    
    Parameters named 'n' sometimes break the Perl bindings, so
    check for this in the generator and prevent it.

commit f450ce75b754fb869b34433c0126f7bb592b141b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 10:09:13 2009 +0100

    Generated code for 'wc_*' commands.

commit 62ccc07e744d5ebfb45d9344827d36f9f61699f4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 10:08:59 2009 +0100

    Todo: wc command done.

commit 7613eb0c7c95649e2152a7fa4d1e6e5e8c653e96
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 10:08:25 2009 +0100

    Implementation of 'wc_c', 'wc_w' and 'wc_l' commands.
    
    These commands count characters, words and lines in a file respectively.

commit 4585b0bbceb3ff73fcf2fbee554000b135297c19
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 09:53:51 2009 +0100

    Implement TEST_ONLY environment variable to run selected tests only.
    
    To run just selected tests, do:
      TEST_ONLY="hexdump mkfs" make -C capitests check

commit 72caee07a5f4f2d7e34c954dba500ffbdbc27207
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 09:43:54 2009 +0100

    Add large test files with standard content for the C API test.
    
    Large test files with standard content for the C API test, and
    add a regression test for previous hexdump failure on large files.

commit ccacf5dec5207d94bc692bfa59670bc8ee4d049f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 09:43:38 2009 +0100

    Todo: RUN_ONLY_FOR

commit c18b48958520ada3712b9ac3954ebe1c449570cf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 09:39:08 2009 +0100

    Todo: 'wc' command.

commit 88da5cf8a32e683ed1d78419fcde609a389a2f65
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 27 15:00:48 2009 +0200

    Guestfish pipes.

commit d164ae963297a99e2222bc32b11928c1635c45d8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jun 28 13:54:22 2009 +0200

    Haskell bindings: Implement bindtests.

commit ef2b0cf761b6281a6a728aacb6ac0ec91fad33c8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jun 28 13:34:11 2009 +0200

    Haskell bindings: Int and Int64 return types.

commit 9414a730d2c8f4a5efffe9396fbbb2a5d10c15c0
Merge: 05273da88 66f728d4f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jun 28 13:28:30 2009 +0200

    Merge branch 'master' of git+ssh://g-rjones@et.redhat.com/git/libguestfs

commit 05273da8830f2f10e417115a3981924a8b14228a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jun 28 13:27:33 2009 +0200

    Haskell bindings: fix boolean arguments.

commit ec34c2bfbfcc53eadf823536dc182710e19b48b2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jun 28 13:17:23 2009 +0200

    Haskell bindings: Fix integer arguments.

commit 66f728d4f84306cef689a6150c5a1aec3c765508
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Jun 26 11:29:14 2009 +0100

    Clean up XML output
    
    This change makes XML use XML::Writer, and modifies the output in the
    following 2 ways:
    
    * /operatingsystems/operatingsystem/os is renamed to
      /operatingsystems/operatingsystem/name
    
    * /operatingsystems/kernels/version becomes an attribute of
      /operatingsystems/kernel for consistency with initrds

commit 247225c4415b28d02a82b7fc4dfdd35728437711
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Jun 25 17:19:29 2009 +0100

    Make virt-inspector look in more places for module aliases
    
    Specifically:
    /etc/conf.modules
    /etc/modules.conf
    /etc/modprobe.conf
    /etc/modprobe.d/*

commit 7ca3e5b08ae6e6f062b5065475ffb07cb08a7610
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Jun 25 14:33:26 2009 +0100

    Add yaml output for virt-inspector

commit 1154aff2c68b7ac156713c7fd66b5aa8907a3cb2
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Jun 25 10:17:37 2009 +0100

    Make run-inspector-locally try to work out where it is installed
    
    This change means that you can run run-inspector-locally from any
    directory. You can also symlink to it and it'll do the right thing. This
    means you can put a symlink to run-inspectory-locally in your path
    called 'virt-inspector', and 'guestfish -i' will work.

commit 13229b1d54c03be098ab75e6d451b5b46a98550d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 24 21:18:43 2009 +0100

    More TODO items for future work.

commit 67a469c3eb68cbf735749118249ea6cd2c892486
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 24 20:10:53 2009 +0100

    Allow guestfish -i / virt-inspector on live domains, in limited circumstances.

commit 215041c7178922341ecbfdb23eb203f2bb8c29c4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 24 20:04:58 2009 +0100

    Fix detection of optional libvirt support in virt-inspector.

commit efdf252102a65b691e405f80de4261dfc8a0035b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 24 20:01:41 2009 +0100

    Document the guestfish --version option in the manual page.

commit da947eadcfa1367c2d634667068db813a87a6dd1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 24 19:57:24 2009 +0100

    Clarify documentation for mkdtemp.

commit 0574eab8bc7d8e72db862ec36815835938a5fdf1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 24 18:25:09 2009 +0100

    Generated code for 'mkdtemp' command.

commit 8228eec99045ae720d8ef35851aa8c278f6b4e5c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 24 18:22:37 2009 +0100

    Add mkdtemp command.

commit af0cfda7e4942c14c9db7304962f8471ccad170f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 24 17:16:17 2009 +0100

    Version 1.0.53.

commit 1f6bc26fc0967c6e4ae4a4514d9734288839c0fd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 24 15:36:58 2009 +0100

    Fix libvirt integration in virt-inspector.

commit 53f5ea28ffe26c112e51ebdef6d46c25919ced4f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 24 15:35:59 2009 +0100

    Fix permissions on generated scripts in the appliance/ directory.

commit 63d28e74b3a2c4e6f3e31fc1f8e1219a1a943404
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 24 12:41:24 2009 +0100

    Version 1.0.52.

commit b96fb7eb3aa0ac67957ed15a7dd22bc7399cad44
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 24 12:15:57 2009 +0100

    Quote command line arguments to virt-inspector.

commit b91d47063c729246c65c41f827bcb1dc927529c0
Merge: e1c62f633 5e332cc6c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 24 11:55:57 2009 +0100

    Merge branch 'master' of git+ssh://g-rjones@et.redhat.com/git/libguestfs

commit e1c62f6332ae07cb6f95130dcc9852701d085e2b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 24 11:54:48 2009 +0100

    Added guestfish -i option to run virt-inspector.
    
    You can invoke guestfish with:
     guestfish -i libvirt-domain
     guestfish -i disk-image(s)

commit 5e332cc6c06532191f793a6789bafe818f726258
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Jun 24 11:50:08 2009 +0100

    Fix dependencies in perl so it doesn't always rebuild

commit 46551d9c51193a4bca2e1b249b8c5f111e1dc7b5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 24 09:59:39 2009 +0100

    Implement guestfish -f option to allow guestfish scripts.
    
    New '-f' option allows scripts to be written using:
     #!/usr/bin/guestfish -f

commit 94a49c8207277ec4017a0fb9a3cd8f1e61a518f6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 24 09:56:34 2009 +0100

    Incorrect assignment on glob error path.

commit ca5239918ce6de45a694610a11678cadc20cf2fb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 24 09:45:14 2009 +0100

    Todo items: guestfish options -i and -f.

commit d3270cfadd3416bd9961a2c6fb1cc131c43979da
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 23 22:02:10 2009 +0100

    Implement libtool library versioning.
    
    Use maximum proc_nr (MAX_PROC_NR) as a surrogate for the
    library ABI version, resulting in version numbers such as
    libguestfs.so.0.<MAX_PROC_NR>.0 for the final library.
    
    Add ABI guarantee to the documentation.

commit d2c0ee0ff7a9afdcdc1605dd464760f98d1b57d7
Author: Matthew Booth <mbooth@redhat.com>
Date:   Tue Jun 23 17:35:40 2009 +0100

    Make the supermin helper look for any x86 kernel
    
    If you've got a non-PAE kernel installed on an i686 machine, the kernel
    architecture is i586. This change makes sure that supermin finds the
    installed kernel.

commit bcb3fc0c3336c05e9ecbbfb25c7c31b42bd3e32e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 23 15:53:44 2009 +0100

    Generated code for 'scrub-*' commands.

commit da7cf3670fe60301beeb175ff6c284b737d5b7f4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 23 15:53:21 2009 +0100

    Added 'scrub-*' commands for securely scrubbing filesystems.

commit 69a481362c20b0ac3985d3003a0078a349ace0a2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 23 15:52:45 2009 +0100

    Bump up default guest size to 500M.

commit 2eda36dbadd4687f7488a86eea9313bbe30cde82
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 23 10:17:59 2009 +0100

    Updated Polish translation (RHBZ#502533).

commit 675411d34f807420d1b714436fc5a58fc0022dae
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 23 10:07:46 2009 +0100

    Command line argument handling.

commit 1d07f1f88a08fc84d91db0931fcf34d1f9db36d3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 23 08:27:52 2009 +0100

    '-no-kqemu' option is no longer necessary to avoid a warning.

commit 0b00aa44ea85ccce17a3579d14e9d4b0f0dd9185
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jun 22 17:02:15 2009 +0100

    Version 1.0.51

commit ead9aa23e2192471d2030f38ece828adfd50de3e
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jun 22 16:53:24 2009 +0100

    Add whitespace to the init script (no functional change).

commit 6f63b699aa03271468f4af9f90933e2d8dbd3db0
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jun 22 16:43:42 2009 +0100

    Issue MAKEDEV commands in a loop (RHBZ#507374).

commit 227b1eea90713d190a9cf5463af106af0b4eee2c
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jun 22 15:07:42 2009 +0100

    Check parameter types in Ruby bindings (RHBZ#507346).

commit 3eab7260a5e36ce6da0dff39456eb9100a13222b
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jun 22 14:24:52 2009 +0100

    Improve error message when appliance doesn't match library.

commit ca4a0c718083db4485edebe4d1b931090e098fa5
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jun 22 14:14:45 2009 +0100

    Missing \n character in Ruby bindings.

commit 3dfc0a8c5da8f3a4a6c13e936d4306b79b231dde
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jun 22 12:40:57 2009 +0100

    Make CHROOT_IN/OUT macros should loudly if the syscall fails.

commit 7c2e6fd3e98840c91b0bac8e13e2eb564810ba04
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jun 22 12:24:27 2009 +0100

    Include the lsof package.

commit 697f50aea8638fc9f5d1a250de6c1b9f4697500e
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jun 22 12:24:14 2009 +0100

    Check return value from close() call.

commit baa5a4099425803f01fa7eb2dce40c80c9c7611e
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jun 22 12:23:56 2009 +0100

    The 'debug sh' command now uses a real shell.

commit bb3a781783734e9f89f2cfa2cabca1efb32bcc45
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jun 22 12:23:31 2009 +0100

    test-boot-realistic rule should boot the rescue shell.

commit 23273711bdbb07cabb19c095797a33d71b7fe711
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jun 22 12:23:12 2009 +0100

    Rebuild supermin appliance when the daemon is updated.

commit 8736b6fa7173ddc33687c4bd9e3fb22d65922fd1
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jun 22 10:02:11 2009 +0100

    Version 1.0.50.

commit 394c8bec21d47b74567a4148fdbf87318c301441
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jun 22 09:35:43 2009 +0100

    Add 'glob' command for guestfish.

commit ad8a256f54a6cb99f89bb444c8597a152a793dce
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jun 22 08:20:42 2009 +0100

    Generated code for 'glob-expand'.

commit 05c34c1c1479bb07b31cfbf912743a8cf014a636
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jun 22 08:20:32 2009 +0100

    Add 'glob-expand' command.

commit 4211c7a258debd236017a19c70965bc1b3658edb
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jun 22 07:49:50 2009 +0100

    Generated code for 'sh' and 'sh-lines' commands.

commit 57d2dfab18ad3d987d9273bb7c1f42e73e0bbcb2
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jun 22 07:49:37 2009 +0100

    Add 'sh' and 'sh-lines' commands.

commit 6654f617a6f720baa8f1ced89179e11679353d1e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 20 16:05:12 2009 +0100

    Check return value from waitpid call in command*() functions.

commit 3ab8336db394683dad5f485388461e9146ac04ad
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 20 15:30:39 2009 +0100

    Add strong note about deprecation of functions which take either device names or filenames.

commit 3c5b447efd42b03c24104bdc1f3260e879bb1d25
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 20 14:55:49 2009 +0100

    Check return value from pclose.

commit 65acb799d2c94e6628f647f2319eb8d16f29a0d5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 19 19:48:19 2009 +0100

    Update to-do list.

commit 3216e9505da3652afad20c0a4612e931359117c2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 19 19:48:05 2009 +0100

    Generated files for 1.0.49.

commit 606d8ccee17c27e6ecf6fcfc9d05c5758ba77611
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 19 19:28:51 2009 +0100

    Prepare for version 1.0.49.

commit e250646e7cc99df9bb617c28d13c327ff79ab601
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 19 18:25:38 2009 +0100

    Supermin: choose newest available kernel.

commit b7f39224e17eecf53ea2671122d4b3176e4d202f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 19 14:47:22 2009 +0100

    Move init script into a separate file.

commit 677b280411cd3596051f288eecb73b5d8ae23caa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 19 14:26:44 2009 +0100

    Move distro package list to a separate packagelist.in file.

commit e395d7db8fd3fe3d1b121258fe2f401d6b3e64c8
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jun 18 21:06:22 2009 +0100

    Add tab-completion of guest filenames (currently disabled).

commit ace1f0ee2b0a2534e45f14599e38d2d06a03d4d4
Author: Guido Günther <agx@sigxcpu.org>
Date:   Mon Jun 15 20:27:52 2009 +0200

    check for Debian tools

commit e00b27fea31a67f3bae2f91c70ab1e6816673c4d
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jun 18 14:37:12 2009 +0100

    Remove unreadable binaries that give warnings in supermin appliance.

commit 6cb84b6e94f424afb9e25b392148fe679d4c7d51
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jun 18 14:27:20 2009 +0100

    Rename guestfs-supermin-helper -> libguestfs-supermin-helper.

commit be4508dbc4542e9f68fc8c539f8b1bf5193c3a2f
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Jun 16 11:22:31 2009 +0100

    Version 1.0.48.

commit 71322ebf4ee7dfb53db344aaedd70518a3c7a552
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Jun 16 10:55:36 2009 +0100

    Don't compress the supermin base initramfs.

commit 95b902b657dbce901f01fb97bd3cd52bd61636cb
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Jun 16 09:56:44 2009 +0100

    Reverse sense of whitelist test.

commit 28e2bceefeedbef82dcc24e60e8a22da0960354a
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Jun 16 09:56:19 2009 +0100

    Fix build_supermin_appliance to return kernel / initrd names.

commit 2b4e82d6ca502581bc63fd873e4b55aa93463f62
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jun 15 23:06:21 2009 +0100

    Missing files in previous release, so version 1.0.47

commit 3087b47c3abac1ad8773dd07500b51423e62079f
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jun 15 23:02:36 2009 +0100

    Missing files from previous release.

commit 9c662c7ea543ca5bc9ffae45283e92db7ba68e1f
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jun 15 22:47:09 2009 +0100

    Generated files for 1.0.46 release.

commit 5dc2f852d275b79c3e338c6ea5629c6baf4e1a8e
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jun 15 22:39:57 2009 +0100

    Prepare for 1.0.46.

commit 414aa67f2bcbbc5009b92f32611aa9196836736b
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jun 15 11:50:35 2009 +0100

    Experimental implementation of the supermin appliance (passes most tests).

commit eebec43a15a5de3a5b9f1281654f9cbdd44e19cf
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jun 15 11:37:58 2009 +0100

    Check for febootstrap-to-initramfs --files option.

commit d6ca37a95b5ed5b7e5c8e0a54fa5a5bbf0fa2075
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Sat Jun 13 12:58:24 2009 +0100

    Add --enable-supermin option.

commit 14ec52d3dc332a02dcb7d95b5f5d21fd863fc99e
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Sat Jun 13 12:58:47 2009 +0100

    Documentation for the supermin appliance.

commit 161c7cd7f9c9d1099c35db20f78d7e5a20ea6517
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jun 15 14:45:05 2009 +0100

    Move kernel module list to a separate whitelist file.

commit 67232e4a701f51ac770a085727a665277086a5ae
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Sat Jun 13 11:18:54 2009 +0100

    Update status of libguestfs in Debian.

commit 3ed322c7c8f1b7342af095ba6a8fb60a8e9a076b
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Sat Jun 13 11:16:43 2009 +0100

    Remove /lib/kbd (keyboard maps) from the appliance.

commit 812a2d57a8b847247796da2cd79a73aa1ab16b66
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Sat Jun 13 11:11:03 2009 +0100

    Remove firmware from the appliance.

commit aa7676aa74f3396fc65ae6b4bf01af7efe021e7e
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Sat Jun 13 10:59:51 2009 +0100

    make.sh calls update.sh directly.
    
    Combine the common tail of make.sh and update.sh so that make
    just calls update at the end directly.  The effect is the same.

commit 2e25c4255746b144932f84b7b6671d7d03f52278
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Sat Jun 13 10:48:16 2009 +0100

    Rename (make|update)-initramfs.sh.in -> (make|update).sh.in

commit bf4eda4d89468b232070dbe0161848acaac1c04a
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jun 12 13:39:32 2009 +0100

    Prepare for 1.0.45

commit f6018d198782c1e9ed062ba60dbd0a590c3b7d7b
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jun 11 17:27:18 2009 +0100

    Add guestfs_rescue=1 appliance option to start a rescue shell.

commit 6a623e37e191385c0d9285e3ec1136b2a02e6156
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jun 11 16:57:59 2009 +0100

    Catching hanging qemu in tests (RHBZ#505329).

commit 8a58d6b6252d07a2d157e892bddfdbb510616705
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jun 11 16:57:29 2009 +0100

    More TODO-list suggestions and a summary of PPC situation.

commit b7e094fa14b306fe776b9b2695cf82fa32d4923f
Merge: 32857b6c1 ccc1d2160
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Wed Jun 10 15:46:41 2009 +0100

    Merge branch 'master' of git://git.et.redhat.com/libguestfs

commit 1bc540ffd0521140600aa319cced7feb42ec5c0d
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jun 10 15:45:00 2009 +0100

    Prepare for 1.0.44.

commit ccc1d216032ff61a81eb1116df44d5bd82079462
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jun 10 15:31:29 2009 +0100

    Remove obsolete comment from generator.

commit 32857b6c1686c94b3c69c88307b137997f74f23d
Merge: ba85a1cf6 179778ade
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Wed Jun 10 15:34:36 2009 +0100

    Merge branch 'master' of git+ssh://192.168.2.134/home/rjones/d/libguestfs

commit 179778adeed965a9652c344a201d2078d868d391
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jun 10 15:31:29 2009 +0100

    Remove obsolete comment from generator.

commit d96554c58fd48db02156044fc15b181e453f0315
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jun 10 15:31:13 2009 +0100

    Specify type of squashfs filesystem.

commit ba85a1cf6275fe008ca379e2da6698ad8eb1d845
Merge: 908aaf4bb 9cd8ec1f5
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Wed Jun 10 15:10:03 2009 +0100

    Merge branch 'master' of git+ssh://192.168.2.134/home/rjones/d/libguestfs

commit 9cd8ec1f5082791e4d731a66524d101bdee49654
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jun 10 15:06:44 2009 +0100

    Allow HFS+, UFS and XFS filesystems (add to kmod whitelist).

commit 908aaf4bb0727831377547a64a4f680dafb6b221
Merge: 8224bfd00 dc3b5a7a5
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Wed Jun 10 14:32:59 2009 +0100

    Merge branch 'master' of git+ssh://192.168.2.134/home/rjones/d/libguestfs

commit dc3b5a7a52fd1a53ba482042fcfb8c4b0bf83b09
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jun 10 14:29:41 2009 +0100

    CentOS fix: Skip checksum test if no squashfs module.

commit 8224bfd0020ee9e2cb6c58c8d1b8eeba3028e943
Merge: edbb821cb ff211d06e
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Wed Jun 10 14:23:15 2009 +0100

    Merge branch 'master' of git://git.et.redhat.com/libguestfs

commit 8c637e1fb03d4a4ff36af770758671b3cabf9842
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jun 10 14:23:05 2009 +0100

    CentOS fix: skip ntfs-3g.probe tests if no binary.

commit ff211d06eb5d1949d74011f9fa60b9f5915f8a05
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jun 10 14:13:34 2009 +0100

    Done: Device independent naming feature.

commit 875dc84cc01dacb1e254e294a66e179b96fbdbc6
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jun 10 12:48:26 2009 +0100

    Implement device name translation.  Remove device name hacks in tests.

commit 56bef498f46ac3dd580f4bde3c8f3ed2fe688826
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jun 10 11:49:42 2009 +0100

    In the daemon, change all const char * parameters to char *.

commit edbb821cb7daefacb7b78821926d751ba40cc232
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jun 10 13:27:13 2009 +0100

    Fix #2

commit b3bf5d9634880d8c9d8a247504a6a89436a0afe5
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jun 10 13:22:45 2009 +0100

    Fix device tests.

commit 1e97e406c36031617a86a4fa6bb78a112848ee87
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jun 10 12:48:26 2009 +0100

    Implement device name translation.  Remove device name hacks in tests.

commit 7ec11d3aa119ea57d0ac249a9e65884045e2642a
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jun 10 12:48:02 2009 +0100

    Fix small sfdisk bug.

commit 887290e949d54c6ac4c9b787231e588f84f2367c
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jun 10 11:49:42 2009 +0100

    In the daemon, change all const char * parameters to char *.

commit 2df2f2854ed2d1f9857ef3c5aaca29810cf3c506
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jun 10 11:11:14 2009 +0100

    Add IS_DEVICE checks for all calls which take a device parameter.

commit 4aea83962337ac5e5847398e2128a9dbb8779247
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jun 9 22:01:00 2009 +0100

    Describe the standard naming scheme and translation algorithm.

commit fe491524cefd1ede281debbc128dab4ce26d7ab6
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jun 9 15:21:33 2009 +0100

    Added more to-do items to the list.

commit 27161658c897544a58c7d4f87c08f2ee8ce08d43
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jun 9 11:20:05 2009 +0100

    New website, change et.redhat.com references to libguestfs.org

commit 9726fe0b346cefb3e055b3a2f9daf0bf5252267d
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jun 9 10:51:02 2009 +0100

    Prepare for 1.0.43.

commit 7baf58278b620504d67acd01d3d992603fcd3b70
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jun 9 10:33:34 2009 +0100

    Add support for decoding the Windows registry.

commit 460d139e6a52da67a4f1947035b1978610349f78
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Jun 8 17:44:18 2009 +0100

    Generated code for ntfs_3g_probe command.

commit 3de234656bc61a2d35b0f1a9ccb1e6ef7535166b
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Jun 8 17:44:14 2009 +0100

    Add 'ntfs_3g_probe' command so we can probe the "mountability" of an NTFS partition.

commit 88be1d399915c716ff312f29a7d3f3afcfd509f8
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Jun 8 15:54:26 2009 +0100

    Todo: qemu options.

commit c1ac7607bfe845db3c8bb3e0a766d5f16d56b2ed
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Jun 8 15:48:39 2009 +0100

    Add missing documentation for guestfish 'lcd' command.

commit 3496c6c3dfb5ef4ab93f6aae86512665a37b23cf
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Jun 8 15:46:23 2009 +0100

    More TODO items.

commit fa8cb5dac284bf463677380e5ef55370f447d870
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Jun 8 10:01:42 2009 +0100

    Added 'lcd' command to guestfish.

commit 85d7e275b5460df6f075a6931cbaed7d0a0dcb7c
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Jun 6 17:44:01 2009 +0100

    Prepare for 1.0.42

commit 42b90f2d0d5b16da948f77e99e84c9192e742a4e
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Jun 6 17:34:42 2009 +0100

    Parse /etc/modprobe.conf and initrd to give us a closer understanding
    of what the guest will actually boot on.

commit f18af71ff43dd87d343b459134a470900f84b833
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Jun 6 13:19:44 2009 +0100

    Added query mode to virt-inspector.

commit 0b3b482542319bf329974397c99b8c0663b9e536
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jun 5 15:51:14 2009 +0100

    Modules are *.o in Linux 2.4 kernels.

commit 8281007ff4369feaebc5b8e3395fcbf4a8548561
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jun 4 15:09:16 2009 +0100

    Version 1.0.41.

commit ab81d09a710242ab61001ef5e8ffd321725b47a7
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jun 4 15:05:23 2009 +0100

    Fix RHBZ#503169 comment 13 (regression) and add a regression test.

commit 96b9d82e2f4f24cdd41040f54a7597202c04cf7e
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jun 4 15:04:05 2009 +0100

    Added regression test for RHBZ503169#c10

commit dcd8742578a57e0871d6db4797014bbfd854a57b
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jun 4 14:09:00 2009 +0100

    Move pure regression tests to their own subdirectory.

commit b6adf09c4d2cc3f1d0285950c151b1fd7688ec67
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jun 4 14:59:16 2009 +0100

    Generated code for the 'sleep' command.

commit 2ef06eacc2be08b0268c98a4d157176aff9356e0
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jun 4 14:58:14 2009 +0100

    Added 'sleep' command.

commit 9cedbba1a498e2a31be103c3adcd2df1ff9168c2
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jun 4 11:00:03 2009 +0100

    Prepare for version 1.0.40.

commit a903368c6db67dc599e5cbefe9e41611fba81faf
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jun 4 10:58:28 2009 +0100

    Add missing /dev devices (bug 503169 comment 10).

commit 6490ed4e5106b7c4e10c693068525c879dfb5964
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jun 4 09:14:47 2009 +0100

    Generated PO files for 1.0.39.

commit 3e70c50a0a17109f4f373a8fd909cac0edafdf7b
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jun 4 09:09:25 2009 +0100

    Prepare for version 1.0.39.

commit 80e15757879c4cf21e0511c62e57c19efb4aab63
Author: Charles Duffy <cduffy@messageone.com>
Date:   Thu Jun 4 08:45:04 2009 +0100

    Use --rbind rather than --bind for bind mounting /dev (to get /dev/pts).

commit 9d6de016ccd932c18001c08c371bf83c6dbff8f0
Author: Charles Duffy <cduffy@messageone.com>
Date:   Thu Jun 4 08:44:00 2009 +0100

    mount /dev via tmpfs before MAKEDEV invocation.
    This ensures that /dev can be bind-mounted when running commands,
    as initramfs cannot be bind-mounted.

commit d1da506d35e3c14b0bbe5397d73994fe082bc831
Author: Charles Duffy <cduffy@messageone.com>
Date:   Tue Jun 2 11:30:26 2009 -0500

    use add_drive_ro for --mount parameters from guestfish when called with --ro
    
    To prevent writes (such as ext3 journal replay) from occuring even when --ro is
    passed, guestfish should use add_drive_ro() for any drives specified on the
    command line with --add if --ro is also passed.
    
    As we need to look through the entire command line for --ro before adding any
    drives, we move the add process out of the argument-parsing loop and into its
    own function, patterned off mount_mps().
    
    Signed-off-by: Charles Duffy <charles_duffy@dell.com>

commit 76711b7e918f6dc504d3b5e11c6cac5ee11cc34f
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Jun 2 15:50:50 2009 +0100

    No parallel make in ocaml/ directory (RHBZ#502309).

commit 3aa9883eb155fe4e0b6f72f3bf6f6c9c5c6161f4
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Jun 2 14:51:45 2009 +0100

    Version 1.0.38

commit d1a1ab972bb22f4c38a21fcc73f81650aaa03b4e
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Jun 2 14:25:25 2009 +0100

    Generated code for 'add_drive_ro' call.

commit bfdc03be234d6d95f18450846433bce4f97e184c
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Jun 2 14:24:16 2009 +0100

    Add 'add_drive_ro' call. Fix up documentation. Plus a couple of minor code improvements in the tests.

commit 5abae435f0cb239b70878968e040d61a6730b897
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 29 16:12:51 2009 +0100

    Squashfs recipe.

commit afa6f05e2e0d784250ab6408ff13152920d74495
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 29 15:30:57 2009 +0100

    Correctly handle malloc/realloc(0)
     - malloc and realloc(0) are valid requests.  Some implementations
       may return NULL for these, which would not indicate an error.

commit 80c5acfd148ede4ec1ca2dc2330b043b0cea29d5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 29 13:40:29 2009 +0100

    Prepare for version 1.0.37

commit e02066bcb33a2aed5f23dd18c3168dc66efddb18
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 29 12:59:32 2009 +0100

    Use a squashfs attached as /dev/sdd during the C API tests.

commit 75d260b6968309159f3335588f0e3f773d32a663
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 29 12:15:37 2009 +0100

    Add cramfs and squashfs kernel modules (RHBZ#503135).

commit a011c5f3263601cd8555e50a4dfa03e27fdb7361
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 29 12:14:35 2009 +0100

    Fix the rule which rebuilds make-initramfs.sh.

commit f6e36bf361c587e0dbb2f0c71f5d22a7cf7f4f42
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 29 11:20:29 2009 +0100

    Fix mkdir-p if directory exists (RHBZ#503133).

commit 1e4173be10cf762c85f7f64ab27be98f3b57dd7a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 28 23:14:47 2009 +0100

    Rerun generator to update tests.

commit cebe6df7456ed60cb2ae25875b2a4f377297491b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 28 22:49:39 2009 +0100

    Version 1.0.36

commit 70e5dd559b79c81012979fd38673df075b769e82
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 28 22:03:18 2009 +0100

    Fix path to COPYING.LIB

commit d6a0adf00900b05b7e9e14a29caf86fb30dec6a9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 28 21:06:40 2009 +0100

    To-do: Note that we need to finish the bindings tests.

commit a3d4d655ffdd335372051c14ca53e8664ff799eb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 28 20:41:12 2009 +0100

    Distribute bindtests.rb in the tarball.

commit 22bc6a969bebfa8547422033f665c768fe8c7c1e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 28 20:38:50 2009 +0100

    Distribute bindtests.pl with the tarball.

commit d5424b938a989ba32e45982521f9cd56d093d163
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 28 20:28:04 2009 +0100

    Distribute bindtests file.

commit b03ce92f2a6775ed5c950a5a3aedfc6133711aba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 28 20:27:11 2009 +0100

    Fix path to guestfish in test-bootbootboot script.

commit 3a7590f2bb716ec6ce0e5b7445f3ec7409ba1b4b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 28 20:26:50 2009 +0100

    Fix permissions on ocaml/run-bindtests

commit babc0846cc911b01a58a7385d30ad25889b7175a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 28 20:15:51 2009 +0100

    Add tests for bindings parameters, fix several broken bindings.

commit c41fe04a652437c920acb0e820762c53bf44a139
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 28 16:23:04 2009 +0100

    Add the test0* functions, used to test language bindings.

commit e2206733d1287f5809dbde954f3eb64420471b0d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 28 13:15:34 2009 +0100

    Move C API tests out of root build dir into 'capitests' subdir.

commit a1e8cdf2a254c5eddaf525cd7c34e4c937690204
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 28 13:00:31 2009 +0100

    Move the appliance and build scripts into new appliance/ subdirectory.

commit 4e444d53cc9497b7cb36ad35fdee825cade72b0f
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed May 27 17:12:50 2009 +0100

    Updated PO files.

commit c59310f777a0437ebd95e14bf0b1987c61d8e0e8
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed May 27 17:11:57 2009 +0100

    Removed contrib/*.spec files.

commit e7d66edd8d481f162904d611bd499f968f2f74ef
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed May 27 17:04:48 2009 +0100

    Version 1.0.34.

commit e58626a0e59ebb1c3417de33080fa65cfe0b482a
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Wed May 27 16:17:13 2009 +0100

    Back to GNU gettext 0.14 for RHEL 5.

commit 6b668620681ada82857e09922a0feb004ee65882
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Wed May 27 16:12:52 2009 +0100

    abs_top_builddir doesn't exist in old RHEL 5 automake, use top_builddir instead.

commit 9c16028a2317a4e1ae5b0831a8a71c98c86852ae
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Wed May 27 16:11:24 2009 +0100

    Removed these old/obsolete specfiles.  For replacements see contrib/README.  (for Charles Duffy).

commit 6cfe0854e27bfecfb001aae12a960af8f06108c4
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed May 27 13:00:23 2009 +0100

    Version 1.0.33

commit 1b2c0e34b15a8f41f5036d127d60efed687b6c97
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed May 27 12:46:04 2009 +0100

    Improve javadoc (RHBZ#501883).

commit 6610af333b93d93f6f0f4b917e0caee0d35ba389
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed May 27 12:29:35 2009 +0100

    Guestfish built-in commands auto-complete (RHBZ#501878).

commit 65ad55778b8cd8e948d59fd3624966018366c45f
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed May 27 12:22:00 2009 +0100

    Fix Java configure tests (RHBZ#501885).

commit 08414bbb3c75585453c3bb084d4317b6107e4e8f
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed May 27 11:48:01 2009 +0100

    To-do item.

commit 7682199cfca20a52664c8e52035a06345862f226
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed May 27 11:40:59 2009 +0100

    README, TODO and HACKING files are now shown on the website.

commit 213988115a8fd25266050228ac5184264f56baf8
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed May 27 11:33:02 2009 +0100

    Allow more ext filesystem kmods (Charles Duffy).

commit b8b89f509c353fb662794c58bc840c8468c6e18f
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed May 27 11:31:39 2009 +0100

    Improve documentation in README file.

commit 8dfae186196e6cd740c1db0e0be2b5ac94b87993
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue May 26 10:04:20 2009 +0100

    Fix bug links.

commit 9f2e9d7c3d38ab9e1be7dbed84d4eea0d86d1ec2
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue May 26 09:55:25 2009 +0100

    Version 1.0.32

commit 2d1890d149bc200bd94e16f9a4f06eb13a2e3697
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue May 26 09:47:41 2009 +0100

    Added Polish translation (Piotr Drąg) (fixes RHBZ#502533).

commit f01957c37a1cdf74cf01a6c86b8b5a312b27dfba
Author: Richard Jones <rjones@debian5x64.home.annexia.org>
Date:   Sun May 24 16:01:45 2009 +0100

    (Commented out) Overwrite /sbin/init

commit bf19b4f0c4b0894924c1c69f3b87504f07c4404d
Author: Richard Jones <rjones@debian5x64.home.annexia.org>
Date:   Sun May 24 16:01:27 2009 +0100

    Print a message when /init starts.

commit 4091fffcd5d7b2820086e019b71eae23a2d4a9e9
Author: Richard Jones <rjones@debian5x64.home.annexia.org>
Date:   Sun May 24 13:53:23 2009 +0100

    Small documentation bug in configure script.

commit f7ef94f5158cc56d7b1fb391e5907abd87dc4c3f
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri May 22 10:52:43 2009 +0100

    In daemon, set PATH, SHELL and LANG environment variables.

commit 5f76f421d05041fc66fe0944ea3b85723f0d4cc4
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri May 22 10:52:28 2009 +0100

    Add 'debug env' command to print environment.

commit 31aaa279b51a5a16dbbd40879696eb850abfb224
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 21 20:32:05 2009 +0100

    Updated POT file.

commit 26637995f07006b7664e572879018adca7e328cb
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 21 20:22:32 2009 +0100

    Prepare for 1.0.31.

commit 7784b51430c6b4dbd85c6b023191ed3bb233ad77
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 21 20:21:43 2009 +0100

    Individual tests can be skipped by setting SKIP_TEST_<CMD>[_<N>]=1

commit 4010d56856f49b2be6f0cb227b47c48a38691a6a
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 21 19:48:57 2009 +0100

    Updated POT file.

commit df4b00d9cc8bf5882f121382222398288c51bb51
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 21 19:36:33 2009 +0100

    Prepare for version 1.0.30.  Reduce boot loop script to 10 boots.

commit b28815d7bf03d156af0276a11433638dcd736662
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 21 17:16:00 2009 +0100

    Add test-bootbootboot.sh script to EXTRA_DIST.

commit 167752ec90a88204ef762f8f7d8007fecc0d260e
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 21 16:31:34 2009 +0100

    Version 1.0.29

commit 3e408f493496597dc026d20778837f421f05a9dd
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 21 16:18:16 2009 +0100

    Generated code for e2fsck-f command.

commit 0f81d0941a2705d49bc129f69924265fa60d9677
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 21 16:17:38 2009 +0100

    Add e2fsck_f command, and modify lvresize test to use it (RHBZ 502018).

commit 2a042d9844ca203ccea28a5d533c18f2dbdfcfa7
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 21 16:03:31 2009 +0100

    Fix pvremove, vgremove, lvremove tests (RHBZ 502007).

commit d215800f10314dd5019d8d171961f8b97a35e817
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 21 15:59:11 2009 +0100

    Ignore generated file.

commit ff9c8dfcd178dcd3a35ae3e368b461f3bf44b2ad
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 21 12:45:26 2009 +0100

    Version 1.0.28

commit d70248333edf8a5b5f509609cf2c8f7fd77d5e05
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 21 12:01:36 2009 +0100

    Gettextize the source, make library strings translatable.

commit 29204fe10d6ad46bace50e82557cb95e8a0f3529
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 21 10:54:32 2009 +0100

    Intltoolize the source.

commit ff1b92c857d3c0377ce5062e2291fc3332dfc11e
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 21 10:00:00 2009 +0100

    Bugs have been moved to Red Hat Bugzilla.

commit 080545d0f87cca424420d05a743ab1f42becb72f
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed May 20 17:29:06 2009 +0100

    Bug about Fedora specfile.

commit f6bcb7b2ee269d82fee5e2d83bbb9187791033ce
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue May 19 15:25:45 2009 +0100

    To-do list for virt-inspector.

commit 91e3bbb85610904802191d055c25e5b285a9cb48
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue May 19 12:34:44 2009 +0100

    Prepare for 1.0.27

commit 123ad23a7e6df309553887affb7a44b8308a32d8
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue May 19 12:29:27 2009 +0100

    test-bootbootboot.sh is a test, not a source file.

commit 7b309445d4e9f93088ca052469338c8e3ce8dcbf
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue May 19 12:29:04 2009 +0100

    Skip 'zerofree' test if the command doesn't exist in the appliance.

commit 4c7183285105fd74496133c059a093b78dbe7723
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue May 19 12:21:32 2009 +0100

    virt-inspector now lists installed modules.

commit 1fc41b39dac877ccec1284da8bb14baa4df368b8
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue May 19 12:05:43 2009 +0100

    Generated code for 'find' command.

commit d1df2f342489bbbba086cae2bb95971c8e404cad
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue May 19 12:05:33 2009 +0100

    Added 'find' command.

commit 8b4819058243957c8fbbc92ef4fbbc0b46655380
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue May 19 12:05:06 2009 +0100

    Fix a memory leak in handling of tar files.

commit 135d55fe24bce65f8eb8ca50193eda8287fe7c9a
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue May 19 10:57:55 2009 +0100

    Inspect kernels for Linux OSes.

commit 816f3bcde7ed64b57b35fea80b09a721317df274
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue May 19 10:57:32 2009 +0100

    Base appliance on Fedora 11 (by default - may be overriden by configure).

commit ca49c50e06834bbc68e21630a5552c57494f2b53
Author: Richard Jones <rjones@redhat.com>
Date:   Mon May 18 20:22:53 2009 +0100

    Generated code for lvresize, resize2fs.

commit 0695593702b8612b500ff0b3bf800e5934f9b56e
Author: Richard Jones <rjones@redhat.com>
Date:   Mon May 18 20:22:36 2009 +0100

    Add: lvresize, resize2fs commands.

commit 38797198d8f60b0a1793d7f228f69c757307ac3f
Author: Richard Jones <rjones@redhat.com>
Date:   Mon May 18 17:23:49 2009 +0100

    Version 1.0.26.

commit 85ed8cef99c19b4143844991d14e0b848fecc5da
Author: Richard Jones <rjones@redhat.com>
Date:   Mon May 18 17:16:24 2009 +0100

    Add vg-activate{,-all} commands, and resize recipe.

commit adf0974245af914c46b48766d0efdd5ee8608dda
Author: Richard Jones <rjones@redhat.com>
Date:   Mon May 18 13:59:57 2009 +0100

    Ignore old make-initramfs file.

commit af7e3fc047447ff77ade4640194f9ec519068951
Author: Richard Jones <rjones@redhat.com>
Date:   Sat May 16 08:45:14 2009 +0100

    To-do: Explain the situation with resizing block devices.

commit 5cd39c83e23eb300d1bdfa806902a31b409ff420
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 15 14:01:28 2009 +0100

    Add: pvresize, sfdisk-N, sfdisk-l, sfdisk-kernel-geomtry, sfdisk-disk-geometry commands.  Pass --no-reread flag to sfdisk.

commit b8e5f51c79f539a740827506cc9da3ffcb6c87f8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 15 14:00:41 2009 +0100

    To-do: zerofree done, Haskell bindings need to be completed.

commit d901cc916102f1aaccfb73396b48aa303e5b8cd7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 14 23:47:17 2009 +0100

    Add support for zerofree command.

commit 4aa4ecc380edc509aba886417c67d9c39ab51c9a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 14 21:44:17 2009 +0100

    To-do: zerofree

commit 7ca3bda1660b58b82f4a11bc5637bf610a43aba6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 14 14:43:53 2009 +0100

    Enable run-time conditional test prerequisites.

commit 17fa7abbb83024deb639aebf27686848e232e085
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 14 13:00:12 2009 +0100

    Add test prerequisites.

commit 1eeaf2ea11a502bae686fde753b31a72e700a3ba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 14 11:20:00 2009 +0100

    Added a couple of bugs related to test code.

commit 16d6d9851ad33fde675b45c27725ea394b718c7a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 13 22:13:49 2009 +0100

    Bugs related to OptString handling.

commit 5d628a4a9cc11eb9a61a1dc683aadca9ac378736
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 13 18:03:41 2009 +0100

    Don't stash strings in the handle.
     - makes it impossible to write bindings for set_{path,qemu,append}
       functions

commit e8ecc08f663b44f3d79517affe52f137858dfe00
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 13 17:51:14 2009 +0100

    Add 'append', LIBGUESTFS_APPEND to set additional kernel options.

commit 5b17af107f75a0d6f3a39b88b9c18714014eb7af
Author: Richard Jones <rjones@redhat.com>
Date:   Wed May 13 15:55:26 2009 +0100

    Allow number of loops to be set on command line.

commit 70ac63f8c5e5818113e55e3fc77e6baf7be660cf
Author: Richard Jones <rjones@redhat.com>
Date:   Wed May 13 12:56:32 2009 +0100

    Tidy-up of test script.

commit c1f9ecec84093ea64f30311246fc18849a1aa460
Author: Richard Jones <rjones@redhat.com>
Date:   Wed May 13 11:44:11 2009 +0100

    Exit early from script on error.

commit 1ed352b5dd07ee6068e0255e17bf81dc609af702
Author: Richard Jones <rjones@redhat.com>
Date:   Wed May 13 11:43:21 2009 +0100

    Increase the wait time for vmchannel socket to appear (fix for slow / heavily-loaded) machines.

commit 09c42a97daeae4fdccf40374620e533469a281a6
Author: Richard Jones <rjones@redhat.com>
Date:   Wed May 13 11:16:24 2009 +0100

    Test booting repeatedly to track down qemu boot hangs.

commit d5709ba3fd9b666012926e0a2a7e36107433eb98
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 12 17:56:36 2009 +0100

    Version 1.0.25

commit e595146b5c742de5604a175f0d150931d9f6aa6d
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 12 17:55:33 2009 +0100

    test-command is not an actual test program.

commit 791a34b6d9408f2b412d84a75d8617748d2262b4
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 12 17:24:45 2009 +0100

    Prepare for version 1.0.24

commit b2a5fec5f8b8b6bf1313d8474448cd8b50057d1b
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 12 17:17:19 2009 +0100

    Refactor line splitting code in the daemon, and fix it so it works.

commit 45d78361d791f4a752fca9472b81bdc75f9f92a4
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 12 17:16:59 2009 +0100

    Test the 'command' and 'command_lines' functions thoroughly.

commit 8a7a6180a865e6895fa531865c5016d793271dfe
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 12 15:04:43 2009 +0100

    Remove Perl from appliance - fixes large appliance problem on Rawhide builds.

commit 03ff42cb2e088b00c15023d456058cbcdc5d3c81
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 12 12:58:45 2009 +0100

    Remove the specfile from the tarball.  Include contrib/ dir.

commit 1856e2ba451c472f5312d1441cced1995b27428a
Author: Richard Jones <rjones@redhat.com>
Date:   Mon May 11 16:44:07 2009 +0100

    Version 1.0.23

commit 8cddd6c7e754c8d893eb991bef0171641ad4479e
Author: Richard Jones <rjones@redhat.com>
Date:   Mon May 11 15:43:00 2009 +0100

    Depend on new febootstrap 2.0, and use febootstrap-install.

commit 09128ca421f13da9fb6446cd7b09b0ae89c3876f
Author: Richard Jones <rjones@redhat.com>
Date:   Mon May 11 10:51:21 2009 +0100

    Perl bindings fix: Not enough memory was allocated for array params.

commit d43dac69483e8ec62e8356d93f761684ce2f5cc8
Author: Richard Jones <rjones@redhat.com>
Date:   Sat May 9 17:19:24 2009 +0100

    Partial Haskell bindings.

commit f0a5cd69f92f734b94e2361a939e4a1eb01dad9c
Author: Richard Jones <rjones@redhat.com>
Date:   Sun May 10 13:51:51 2009 +0100

    Handle EINTR, EAGAIN in select main loop.

commit 62c11fb60ef722c77215357a14465b44b5c7402f
Author: Richard Jones <rjones@redhat.com>
Date:   Sat May 9 15:37:40 2009 +0100

    Note about using FUSE / mountlo code.

commit c889d127598f5613a49ee713adeb7165f473dbdc
Author: Richard Jones <rjones@redhat.com>
Date:   Sat May 9 13:52:24 2009 +0100

    Version 1.0.22

commit f9356f33b040b3ff5038aa30b21b30b1ad489e1c
Author: Richard Jones <rjones@redhat.com>
Date:   Sat May 9 13:43:15 2009 +0100

    Valgrind now implemented - remove from TODO list

commit c419731e3a04333aea7d1af7e1069221a34344a5
Author: Richard Jones <rjones@redhat.com>
Date:   Sat May 9 13:40:31 2009 +0100

    Add 'make valgrind' target to run tests under valgrind.

commit 09492abb6590c8b804273172dc5340705a868f95
Author: Richard Jones <rjones@redhat.com>
Date:   Sat May 9 13:31:08 2009 +0100

    Fix four memory leaks in guestfs.c revealed by valgrind.

commit cdc726dcfc8bd0b9351cc6879df1e35f37af7fb8
Author: Richard Jones <rjones@redhat.com>
Date:   Sat May 9 13:30:40 2009 +0100

    Fix memory leak in error return path.

commit 12baf36e87c6a0968939e98b1969bc1b9d8cb0bc
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 8 20:16:03 2009 +0100

    Experimental febootstrap install script.

commit cead6fe22d32e8fcdb26c60fdad5db49bf3f0ec0
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 8 15:49:42 2009 +0100

    To-do: Use valgrind.

commit 08361c8987f4552649b6c708f52e940e1575fa6e
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 8 15:49:34 2009 +0100

    Bug: Segfault in Perl bindings.

commit 2fa68269fa63c5aab2015e3ee6ee1d33185e6e0a
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 8 15:48:02 2009 +0100

    List installed applications (NOT WORKING).

commit 15e0fd573a87488c66cb3a6f0da01f3ab5f2f6ed
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 8 15:20:36 2009 +0100

    Generated code to support last 3 commits.

commit 77c3f9d0ed25218fc3f24cee083a2083157d8e0a
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 8 15:20:20 2009 +0100

    Add test script to test recovery from qemu failure.

commit c10fa84ada465d83bcbe0550ed512215036b4bea
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 8 15:19:51 2009 +0100

    Implement -command (to ignore errors) in guestfish, and allow recovery from qemu process failure.

commit 33377fc61d4356a0e83cf7ef39d545842647481c
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 8 15:19:03 2009 +0100

    Allow recovery from guest failure.

commit 0faa5dde7b992ba11bb88f77b3424676c7c492e4
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 8 14:28:03 2009 +0100

    Generated code to support previous 2 commits.

commit fa7c8bb79b45aecdf65ed93635a42f3fdf301134
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 8 14:27:47 2009 +0100

    Implement 'strings' and 'hexdump' commands.

commit bd7c8ee043dd02e2cfa3eba2ac5875fc34990610
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 8 14:27:02 2009 +0100

    Bug: write_file doesn't work with strings containing ASCII NUL.

commit 28e18580c25809050ecc6acd55bf9fe35740ca66
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 8 11:37:42 2009 +0100

    Note another bug found when testing on Koji.

commit 7310279bafaa24506c2381a486fe2be0a9cff931
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 8 09:29:20 2009 +0100

    Missing BRs in spec file.

commit 4be389ce26ce38491a5b9f16f9f0f9d81d7002fb
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 8 08:50:27 2009 +0100

    Version 1.0.21

commit 93ad7365e400915e6ce7fe6896ca7b599e7cf83a
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 8 08:44:34 2009 +0100

    Change memory calculation to choose a generous amount of memory.

commit d50dbf2d7cda1edc18d5249dae051cd58e65b99a
Merge: f78de8479 b99a342f3
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 8 08:40:49 2009 +0100

    Merge branch 'master' of git+ssh://192.168.122.141/home/rjones/d/libguestfs

commit b99a342f370695c30283f97d3b88c8736f0e279f
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Fri May 8 08:39:05 2009 +0100

    Added RHEL/CentOS example spec file.

commit f78de847966ce143c39f640a4ebecfa4b5236713
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 8 08:32:26 2009 +0100

    Force qemu quit when kernel panics (Charles Duffy).

commit 12c714e71d0c084babd90b62679ad318a1569792
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 7 21:39:37 2009 +0100

    Update date in changelog line.

commit a6155ea18b3d184f74438ae157dc43c4b8b3cbe4
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 7 21:34:08 2009 +0100

    Update %changelog in the specfile.

commit 4dffb3bbb5346410fe8b958add4a956b915d48a9
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 7 21:29:08 2009 +0100

    Prepare for version 1.0.20.

commit 427b5f079fd344919ecf568bab2084825aacf606
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 7 21:21:32 2009 +0100

    Fix leak in realloc failure (Jim Meyering).

commit dd8b152da0e899104fec305159640d08d7d6cdd9
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 7 21:10:01 2009 +0100

    Use unsigned type for lengths.

commit bb349b05333aa5bf87a3882f15458d8f7341d807
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 7 21:01:02 2009 +0100

    Handle EINTR and EAGAIN in reads.

commit 672c4ba257924c3e64836c08fb3b55bc4a6b2aba
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 7 20:52:33 2009 +0100

    Specify prototyping behaviour for Perl XSUBs.

commit e88c37bc71a54f1b8cff6a4bdc04b39fc32b28bf
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 7 19:28:21 2009 +0100

    Create daemon/m4 subdirectory if it doesn't exist already.

commit bfa4d217f09c00d574e1cf9266281ce15f2c9f1e
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Thu May 7 19:19:49 2009 +0100

    Set mandir (as in RHEL 5).

commit ab48e523b3f215dff09f68d3c0544ceec8757c68
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Thu May 7 18:51:34 2009 +0100

    Version 1.0.19

commit 6f0b962724a087a11edb5ce47aa06fa276fcb54b
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Thu May 7 17:24:02 2009 +0100

    Misc changes to make tests pass in RHEL 5.

commit fd2eccd2eff8da2272e9dbcdf9c6f0be9e687d4c
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Thu May 7 16:58:49 2009 +0100

    Include /usr/sbin on the $PATH (for RHEL 5).

commit c0beb26a0bc86188d38f2b36cbcd6cf20a676713
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Thu May 7 16:58:31 2009 +0100

    Need to keep and modprobe dm_mod module for device-mapper support on RHEL 5.

commit db1aacb8e0ac28283e1d9f7d02119868de19836b
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Thu May 7 16:57:55 2009 +0100

    /dev/hd* is also a block device on RHEL 5.

commit 74a31e619b6907caa80f987e16020edd85c9367f
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 7 16:05:50 2009 +0100

    Add BR on ncurses-devel (needed for RHEL 5).

commit 01b20efdf43b87981c6b9899122e22ef307ee52f
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 7 15:51:02 2009 +0100

    Augeas is now completely optional.

commit 818cb88fce5e60e5ffffe98e49da346083464300
Author: Richard Jones <rjones@redhat.com>
Date:   Wed May 6 20:46:17 2009 +0100

    Added TODO item.

commit 65dab4f7f761c8ec0a2040956ffdbb14423503d2
Merge: 2c273b92c 8f199409a
Author: Richard Jones <rjones@redhat.com>
Date:   Wed May 6 17:55:46 2009 +0100

    Merge branch 'master' of git+ssh://rich@hakodate/home/rich/d/libguestfs

commit 8f199409ab7ae1f3d327f46c265125985aeb3aff
Author: Richard Jones <rich@hakodate.home.annexia.org>
Date:   Wed May 6 17:55:18 2009 +0100

    Note bug about chroot not found.

commit 2c273b92c182adc4621c0426c9ddb44efcdd21b1
Author: Richard Jones <rjones@redhat.com>
Date:   Wed May 6 16:33:26 2009 +0100

    Note Augeas support should be optional (TODO).

commit bb98bbb91c74cca47b5e1f79fd54f4024572fd22
Author: Richard Jones <rich@hakodate.home.annexia.org>
Date:   Wed May 6 15:29:01 2009 +0100

    Fix missing futimens bug.

commit 459da0831ca259fc06dacb773e5ce602bd4ac226
Author: Richard Jones <rich@hakodate.home.annexia.org>
Date:   Wed May 6 15:21:46 2009 +0100

    AC_CHECK_FUNCS for multiple functions.

commit 9a571d41f56c86e290781492ba410070c34b3379
Author: Richard Jones <rich@hakodate.home.annexia.org>
Date:   Wed May 6 15:20:15 2009 +0100

    RARRAY_LEN macro for Ruby < 1.9.  Small strictness fix for OCaml < 3.10.

commit 76758f42b1abc89d5857697c87ead5036ed81b13
Author: Richard Jones <rich@hakodate.home.annexia.org>
Date:   Wed May 6 15:11:40 2009 +0100

    Backport CAMLreturnT for OCaml <= 3.10

commit 64847eed1658e7287c51e920e1a600e15b9eb1c2
Author: Richard Jones <rich@hakodate.home.annexia.org>
Date:   Wed May 6 15:08:13 2009 +0100

    Missing include <ctype.h>

commit 4b382eb8110050cb5b769c6f7d79b0b77eb79719
Author: Richard Jones <rich@hakodate.home.annexia.org>
Date:   Wed May 6 14:52:15 2009 +0100

    virt-inspector configure bug.

commit 60258700e81a6a68875496f365d9f9cec19c8df2
Author: Richard Jones <rich@hakodate.home.annexia.org>
Date:   Wed May 6 13:07:58 2009 +0100

    Added bugs noted by Charles Duffy.

commit ec8920e019930f29d3da4c318d3383e623cbfe22
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 1 19:00:22 2009 +0100

    Another TODO item.

commit 0cad78b28d48dfcc31f53292d0424ba5ded7fe12
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 1 18:51:15 2009 +0100

    Typo in documentation.

commit a4d88af2c13692e38fb7cfce77b082cee6e0462f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 1 17:41:28 2009 +0100

    Implement !local in guestfish.

commit 4ecdf8ec07d7eb4bfa4e1b5eef413e721a1f3711
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 1 13:10:47 2009 +0100

    Version 1.0.18

commit f47dafd23186938a22d41739d9bc695c7760b912
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 1 12:16:08 2009 +0100

    Generated code for 'equal' command.

commit d9ea3e8d979c3ade1b21f27083788fd33fa3b1fa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 1 12:15:58 2009 +0100

    Added 'equal' command to compare files.

commit 8c3b820c2b687345448e3d74a7101b07ff32688e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 1 11:47:31 2009 +0100

    Generated code for ping-daemon command.

commit 632012e6419f04fab93909f92ecbab5a2c590447
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 1 11:47:23 2009 +0100

    Added ping-daemon command.

commit 24bee20ce4196d45891925332a47a05aa5e40938
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 1 11:27:52 2009 +0100

    Generated code for dmesg command.

commit 8c60f5c681b5d7cf90bc798fcaf94cd4e242e27f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 1 11:27:32 2009 +0100

    Added dmesg command.

commit 9222136ac9b2e404dba128b1ac74dacaa8bf1038
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 1 11:18:53 2009 +0100

    Generated code for drop-caches command.

commit 2dc9e8a858b62830d15a8186fe575eb7903d2171
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 1 11:18:44 2009 +0100

    Added drop-caches command.

commit ac286b26df1aabceca26dac66c325a3676ace4cc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 1 11:00:46 2009 +0100

    Generated code for cp, cp-a and mv commands.

commit 3cb794463a62239e36d730bc5d2d3eb4c7a66096
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 1 11:00:34 2009 +0100

    Add cp, cp-a and mv commands.

commit af5087450063fe013ac2df4db39451d7da6152a3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 1 10:59:51 2009 +0100

    Always look for qemu-kvm, even on non-x86_64 platform.

commit 65f77271f290eca1d8b91d16fc6e123037f86229
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 1 10:11:12 2009 +0100

    Check fakechroot >= 2.9

commit 62fa13411d4eac94473fd2fdcb8f4fade36cf0d0
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 30 23:39:31 2009 +0100

    Version 1.0.17

commit e118c14b9552de311cbc1734e03a3226b484c1e8
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 30 23:10:22 2009 +0100

    Generated code for grub-install command.

commit b55bf8158f0b7f6b1760b7b3b5f7c1274a149127
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 30 23:10:15 2009 +0100

    Add grub-install command.

commit 0fea1c76712c3c9a8e4309aa0b325e48a0a935b8
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 30 22:39:36 2009 +0100

    Replace rtl8139 network card with virtio-net.

commit 58b9f95e00d4524c1ac7d994365e65b96cde5a8c
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 30 21:29:40 2009 +0100

    Add documentation for the 'edit' and 'echo' commands.

commit 4581eb2523eeb4d094d53af0555cb7e0f760ae2d
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 30 20:11:04 2009 +0100

    Added guestfish 'echo' command.

commit df189925e4a0e6f80b0aebbd78201db09a63daf3
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 30 19:53:52 2009 +0100

    Added a comment syntax to guestfish (# ...).

commit f1c552c43607299bb32aecc1bf696bbc31f94dc8
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 30 19:44:28 2009 +0100

    Prepare for version 1.0.16.

commit 36f9dac1a2530b575dab9226f6ddd85e6e8c8590
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 30 19:32:58 2009 +0100

    Added notes to the 'fsck' command documentation.

commit 62df226f26bd6ac3c481a7790eb89d760d2f0386
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 30 19:28:54 2009 +0100

    Added 'zero' command to wipe partition tables and superblocks.

commit 2a42bec2c5ee521f29179a5aab713f5a9ca2c3b8
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 30 19:28:08 2009 +0100

    Correct the path to /sbin/fsck.

commit 89404ec0ba9781b55cb3a87689bcc519e7d73ea2
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 30 18:59:02 2009 +0100

    Enable parallel builds (Jim Meyering).

commit 0703248d233744047515418893dac05ce013a642
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 30 18:57:07 2009 +0100

    Add generated code for 'fsck' command.

commit c69c3695303d5a660ad093a076c2e364ae6061de
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 30 18:56:55 2009 +0100

    Added 'fsck' command.

commit 296b536c965820b8334150df0247a0657f6e35fd
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 30 18:05:13 2009 +0100

    Bind-mount /dev, /proc and /sys into chroot when running commands.

commit f7e6ffa8a82f8a7a214a47ff32f46d9e893902d8
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 30 17:34:23 2009 +0100

    Autosync now runs umount-all; sync

commit e4733575efff31742444b180cdcfbc2504b144c8
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 30 17:23:57 2009 +0100

    Fix umount_all command so it unmounts filesystems in the correct order.

commit 41b959fd9b057354f642d84398b875d02b88b864
Author: Jim Meyering <jim@meyering.net>
Date:   Thu Apr 30 15:55:58 2009 +0200

    build: don't tell "make clean" to remove my '~' backup files
    
    Hi Rich,
    
    automake's policy on what to remove via "make clean" is reasonable:
    if running build rules creates it, then "make clean" can and should remove it.
    However, even if build rules happen
    to create backup files, please remove only the specific ones
    they can create, not all of the ones in a directory.  Just in case
    someone relies on those and expect them to hang around...
    
    >From 1e8be391ac17b4ddcf9671e8413d2660844e6993 Mon Sep 17 00:00:00 2001
    From: Jim Meyering <meyering@redhat.com>
    Date: Thu, 30 Apr 2009 15:47:52 +0200
    Subject: [PATCH] build: don't tell "make clean" to remove my '~' backup files
    
    * Makefile.am (CLEANFILES): Don't remove '~' backup files.
    * daemon/Makefile.am: Ditto.
    * examples/Makefile.am: Ditto.
    * fish/Makefile.am: Ditto.
    * images/Makefile.am: Ditto.
    * inspector/Makefile.am: Ditto.
    * java/Makefile.am: Ditto.
    * ocaml/Makefile.am: Ditto.
    * ocaml/examples/Makefile.am: Ditto.
    * perl/Makefile.am: Ditto.
    * python/Makefile.am: Ditto.
    * ruby/Makefile.am: Ditto.
    * src/Makefile.am: Ditto.

commit 5e62afd7ce5145eee1894fab6f0722119fee1d31
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 30 16:09:50 2009 +0100

    Safer way to copy RPMs in no-net builds (Jim Meyering).

commit 3c5bcce927dfa9213469d1f641408a0105685291
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 30 15:43:11 2009 +0100

    Updated the generator so it only overwrites files if they've changed.

commit abb447c32abdea467374edc30704818dd2883da7
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 30 14:20:07 2009 +0100

    Correction to 366a86fb6097ab0f704443f0a6ae2addbc3745d5:
      The code in fish/completion.c is generated, so update the generator instead.

commit 366a86fb6097ab0f704443f0a6ae2addbc3745d5
Author: Jim Meyering <jim@meyering.net>
Date:   Thu Apr 30 14:34:02 2009 +0200

    * fish/completion.c (commands): Declare with a 2nd "const".
    
    It's a const array of const strings.
    
    >From 70c53d3169ae53fc4874e00975893d33387c51e6 Mon Sep 17 00:00:00 2001
    From: Jim Meyering <meyering@redhat.com>
    Date: Thu, 30 Apr 2009 14:33:01 +0200
    Subject: [PATCH] * fish/completion.c (commands): Declare with a 2nd "const".

commit de2cf8615aacb4aa1ee521d65e7ef22fb73dcbb3
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 30 14:15:00 2009 +0100

    Use AC_PROG_CC_STDC because we really need an ISO C compiler (Jim Meyering).

commit ab0397017cc26833c09946cca19d86b907822a94
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 30 14:01:53 2009 +0100

    Use safe_malloc and/or check returns from malloc (Jim Meyering).

commit 6f5c3984a7ddfc111287e2ec214ba823db737db4
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 30 13:36:26 2009 +0100

    Fix unchecked malloc (Jim Meyering).

commit 4f7cc37e5f4a209773062d67e5f61a81f7800fc8
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 30 13:36:06 2009 +0100

    Fix unchecked malloc & realloc in 'commandv' func (Jim Meyering).

commit 6dff51fc7d8a33925f164bd66c2c26cd4b94b3df
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 30 13:35:36 2009 +0100

    Check return value from realloc call (Jim Meyering).

commit 668d27b56857230fb81c04d1663a5aca1b9e77b9
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 30 13:02:29 2009 +0100

    Rename tune2fs.c -> ext2.c

commit f666990c2f6d94beee4f21c0e52e582eee68b054
Merge: 141f01934 1507d230a
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 28 22:44:59 2009 +0100

    Merge branch 'master' of git+ssh://g-rjones@et.redhat.com/git/libguestfs

commit 1507d230a8ca04f9d8114cd7f6b6fa4161abe746
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 28 22:06:27 2009 +0100

    [PATCH] add dependency to ensure make-initramfs.sh is rebuilt when (Jim Meyering)

commit 141f019348017d0ae217b9c3fd9805a963313d82
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 28 17:44:10 2009 +0100

    Resync with proposed Fedora specfile.

commit 1957e9ed3402120f4868dcea04abb51ceb44df30
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 28 17:37:59 2009 +0100

    Build virt-inspector HTML for the website.

commit fd99b96c973a1a60060b2585a9b74b360f4738c4
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 28 16:06:02 2009 +0100

    Prepare for 1.0.15.

commit 0aa45a5662bcb96348bd4753fb0404991f713319
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 28 16:04:12 2009 +0100

    XML output.

commit 6f2929c4635c3f2af4a9211981d9edd1f58cce69
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 28 15:15:56 2009 +0100

    Perl output.

commit 5ca50cbee961aa2f8592b3a38fba41e2a732b282
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 28 15:08:26 2009 +0100

    --fish and --ro-fish options working.

commit 5aa57fbd34eb34922719d08712303b9d73ec215f
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 28 10:04:27 2009 +0100

    Added virt-inspector program from virt-v2v.

commit 798b8dc5d84bc9b4884c67389950377ac2b97a66
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 28 11:39:27 2009 +0100

    s/builddir/top_builddir/ (Luciano Miguel Ferreira Rocha).

commit 1d96b8bdb42e44049aa84d1daa3e5d835d525b03
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 28 09:59:35 2009 +0100

    Fix perl hanging during configure (thanks to Luciano Miguel Ferreira Rocha).

commit b03ee3675bed8d739ae722ed8c030ae02b3cb0ed
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 27 13:41:59 2009 +0100

    Generated code for ext2 UUID and label functions.

commit afca1dba5eeb989c231a22df26e48f0967387547
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 27 13:41:30 2009 +0100

    Functions for getting and setting the ext2 UUID and label.

commit e5b86fce27b0900d653911e64a85c3857c2fe604
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Apr 26 17:59:35 2009 +0100

    Version 1.0.14

commit 0b2748bb2729bea0d6f6b794e7f6e0cfb8d36bcc
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Apr 26 12:11:23 2009 +0100

    Add --version option (show version) to guestfish.

commit edd99a3f7903f6f80d3f73643cd6ee114dbdd553
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Apr 26 12:09:06 2009 +0100

    Added the --ro option (readonly) to guestfish.

commit 9501ab7792e50e464dc65e9190a0e1d84b5dd423
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Apr 26 11:15:57 2009 +0100

    Update BUGS with latest status.

commit 79633552a42f5d6d60d5204c39acb0bc093199ae
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Apr 26 11:11:48 2009 +0100

    Get ready for version 1.0.13.

commit 64a6a828bd318622420cf3018899392fd80c14e7
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Apr 26 11:06:47 2009 +0100

    Multiple callbacks during file transfers could cause data corruption - FIXED.

commit b176abd7bb39ba69ecb523138732dba4b91f4090
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Apr 26 10:43:07 2009 +0100

    Check for multiple callback in RPC code.

commit ab76c39d696c7f0a0071bfbac0e36af69594e68c
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Apr 26 09:52:42 2009 +0100

    More checks.

commit 2df2819aa552d1cc7bf6a450aaf4d090a4341a68
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Apr 26 09:52:13 2009 +0100

    Include UTF-8 NLS.

commit a30f66436eac79b9e532e448882d03375c0d5e78
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Apr 26 09:51:48 2009 +0100

    Use ferror to check for error conditions in pipe.

commit 38f9222d21fb3c3005872de05247ff16a66db945
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Apr 26 09:51:30 2009 +0100

    Carefully check return values from xwrite.

commit e65e1d5d0053431702bc99e5d59725324adf1af5
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Apr 26 07:05:12 2009 +0100

    Don't echo output in scripts.

commit 0583c8c2c3500715fe5757d2e2fcb0fdc019c2ae
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Apr 26 06:48:31 2009 +0100

    Added rpmqa example.

commit 027897d4ddaf886a309a032b488f64512d2dc873
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Apr 26 06:34:54 2009 +0100

    Document qemu wrappers.

commit 9e4a31f66cb956daeb1dcee9aafadc7da3313999
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 25 22:59:19 2009 +0100

    Documentation fix.

commit 68b7076d4b61f00c5a2fd9282f0a3c59d429c7df
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 25 22:56:57 2009 +0100

    Note about bugs.

commit 252bf70225e95dcd4b254d8bcfa8e9cb5251f11b
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 25 22:56:42 2009 +0100

    Clean up *~ files in recipes/

commit b787efa8c627b459c876c11e59199df626011123
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 25 22:56:34 2009 +0100

    New recipe: iso2tar.

commit 96124562bbadc7c4bbf0a4ceca39b838dbe47ed7
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 25 22:43:24 2009 +0100

    Include UDF driver (for CD/DVDs).

commit 39944fb11248786c1eb0ee0f9fd5447e5d3f1ed6
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 25 22:06:04 2009 +0100

    Include the right RPMs and kernel modules for NTFS & VFAT mkfs and mounts.

commit aed0fa2c015e56a882fd6d4b759c82df08fc40d7
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 25 21:41:09 2009 +0100

    Generated code for lvremove, vgremove, pvremove.

commit 58caa9e5f1dca3916178894876b938a6a45771b0
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 25 21:40:50 2009 +0100

    Implement lvremove, vgremove, pvremove.

commit b6d5c9e646d0aa18699a88d02ed9205380553b65
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 25 18:28:24 2009 +0100

    Better generation of recipes page.

commit a057a058e72d0949db4140e9a03b7a0e5b3c823c
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 25 12:36:45 2009 +0100

    export2tar recipe

commit 396bc943ed9cb7c6df091b18bc2eebe93ccc27d1
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 25 12:20:15 2009 +0100

    Improve CSS on recipes page.

commit b86d7b975629ae099ad9a137ced6f23b17c1531a
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 25 11:34:18 2009 +0100

    Added guestfish recipes.

commit ae17137f643c33f0ad8f61dc1abe4800815ddcc3
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 25 10:38:39 2009 +0100

    If LIBGUESTFS_PATH is set, guestfish shouldn't modify the path.

commit 2b21eec8d423d15c97227567834ce978f8cae42c
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 25 08:36:52 2009 +0100

    Added configure test for qemu vmchannel support.

commit ae5be84decf1a40e1de22176c747e110b77829a2
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 24 23:17:07 2009 +0100

    Experimental recovery process should help with not cleaning up qemu.

commit 18bf945023071d5d4ec8d96e25142e0ffd066e7c
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 24 22:26:50 2009 +0100

    Remove the debug mode from make-initramfs.sh.

commit 072567882711725190593f2196e658d5ebf6d5ca
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 24 19:03:18 2009 +0100

    Add support for ext4 to examples/to-xml.c

commit 251858d521c55f6b65d9a671d79c39007514a74e
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 24 18:33:06 2009 +0100

    chmod /sysroot (also makes it known to fakeroot)

commit 18d15a9e5b2324699feef0d710197bdd0f1b7b23
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 24 14:52:49 2009 +0100

    Resync specfile with proposed specfile in Fedora RR.

commit 56826a0dc9533cb1d7d227c5a2f70d8d31a4dd8f
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 24 14:31:38 2009 +0100

    Ruby bindings didn't NULL-terminate an array, resulting in segfault.

commit ab6f429a5a5ba084bdc948c0c21b2dceeae6298d
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 24 14:29:58 2009 +0100

    Added bug about qemu not being cleaned up after segfault.

commit b3021495a92b0d5bd2a91f922be42f28b0b321c8
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 24 13:19:21 2009 +0100

    Get ready for version 1.0.12.

commit 851b9a18d24de8fa81d4ca3063df59668484e884
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 24 13:15:49 2009 +0100

    Don't allocate file chunks on the stack.

commit 4507dd497f9a5eb8584e6d0937a87dc659cfa144
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 24 13:00:49 2009 +0100

    Don't use large message buffer on the stack (fixes Java/i386 segfault).

commit 5b0fcfffc1872f335a2a6da9505f2e8926b1a740
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 23 20:08:29 2009 +0100

    Fix 64 bit memsize overhead.

commit 8be6c7056d18cd5aa5edddfc73bfd4206b038cee
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 23 19:33:00 2009 +0100

    catsprintf leaks, use open_memstream instead.

commit 012a2ec1acf7a7a2d859f78ea4932ae9fb30522d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 23 19:23:52 2009 +0100

    Remove the 'debug mem' command, it's never going to work.

commit 5f8c46db05966a6e31b696d629fd3f74e4fb6c71
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 23 19:23:33 2009 +0100

    Reduce the amount of memory allocated to guests based on some testing.

commit 21dbad6b95d5355f622e74c9c9d8a547c04e6e00
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 23 18:52:34 2009 +0100

    Implement 'debug sh' and 'debug fds' commands.

commit e2870fb94cbd22affecdd16e8f75f75e78d1c18b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 23 18:52:06 2009 +0100

    Implement extensible strings with catprintf.

commit 6eaa49faddeef5ec086ad7c58e0cd591fb4400dc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 23 18:51:12 2009 +0100

    Use AC_GNU_SOURCE in daemon.  Don't need _GNU_SOURCE in C files any more.

commit b18961055531f0107ed4f62c0d2f28e4ac1270e0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 23 14:47:06 2009 +0100

    Fix buffer overrun in guestfish command-line parsing.

commit 8f9f02d483b87c787d089cf9329f5f1b81d3a77e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 23 14:39:31 2009 +0100

    Generated code for debug command.

commit 713283f4a67b3a1960ca96ce6608d046fc202d2d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 23 14:39:18 2009 +0100

    Add outline of 'debug' command.

commit 81d4a01ac03bc2996eea1ca4cc3182e50d21e6ba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 23 11:47:06 2009 +0100

    Automatically generate ChangeLog file from the git log (thanks: Jim Meyering).

commit 6fd5bc84893c600af75ef64fa9f9a043b665c76a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 23 11:32:53 2009 +0100

    Substitute '-' in command names in guestfish documentation.

commit 5d13ccaf55aed74b8e2d778c064c544e6300e0a5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 23 11:11:35 2009 +0100

    Fix Java tests by passing correct library path to JVM.

commit d660085d7aff275b720ef4efb28ecafd7d7209e5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 23 10:54:27 2009 +0100

    Configure script tests for Perl modules.

commit cf13c86a2c6fd56c07d7a92bcd28f99598c6a259
Merge: 54ca2f1f8 dd98434c1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 23 10:32:31 2009 +0100

    Merge branch 'master' of git+ssh://g-rjones@et.redhat.com/git/libguestfs

commit dd98434c1b45f7a27065b13839089c7265203e2d
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 23 10:28:28 2009 +0100

    Avoid a cast warning on 32 bit.

commit 54ca2f1f8c21e53af6798a68c897ce3b9acbfc91
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 23 10:19:33 2009 +0100

    Instructions on running KVM as non-root (Robert P. J. Day).

commit 8261323786f5cfa2f9d71d79b4ae8065352eae2b
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 22 22:01:08 2009 +0100

    Version 1.0.10

commit 79cdf81e2fb717ea4372a55170d16800cdbddf23
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 22 21:02:49 2009 +0100

    Generated code for new mount_* commands.

commit d7ffe439e8ec5304a1a2d1eb591d348c4ab84f38
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 22 21:02:15 2009 +0100

    Add mount_ro, mount_options, mount_vfs.  Fix small bug in OCaml generator.

commit 35dc2f5706a957fe9a17d4bc29ad433c541d2fa0
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 22 19:17:29 2009 +0100

    Get ready for 1.0.9.

commit c5b2282111ead9a0c59db5f40229d20fe0203681
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 22 19:15:11 2009 +0100

    Force a specific network NIC model (allows to work with latest qemu from SVN).

commit 92c2c33d6162ae0781be47472051305bae332252
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 22 15:27:42 2009 +0100

    Fix infinite loop encountered when reading Windows disk in example program.

commit a8d25362435121ada85656c08cd79642f79f9f7b
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 22 11:47:07 2009 +0100

    Added pkgconfig file (libguestfs.pc).

commit f99cb04943f1c4583e52df684011766add78ea28
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 22 11:30:58 2009 +0100

    Version 1.0.7

commit 228e71fe10128c6f91a6935e6b148c49801bb17f
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 22 11:03:05 2009 +0100

    Fix quoting of list args in guestfish manpage.

commit 93b14fcfe5376326632cb04e0c2f0cf1912cdbc6
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 22 11:02:00 2009 +0100

    Resync specfile to Fedora RR.

commit b837b64c74567b5291964005f691a18655396460
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 22 10:20:48 2009 +0100

    Create /tmp directory in the initramfs.

commit 94b95dc06c34d89cc56fb096b1e30b5e19d06c10
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 22 10:06:40 2009 +0100

    Include fuse.ko module in image.

commit 4bcb05e92f090f872fb823ffdadd241486a13107
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 22 09:18:02 2009 +0100

    Version 1.0.6.

commit 5e635ed9102d0ad4d0e0d03a60c8493451628473
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 22 09:04:04 2009 +0100

    Note, but don't fix, javadoc bug.

commit a331c0ca48bd796b3b382da2756537831293f44f
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 22 09:03:27 2009 +0100

    qemu runtime done - remove from TODO list.

commit 43db06ea892cc157324a6b837ca430607441c509
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 22 09:00:39 2009 +0100

    Allow qemu binary to be overridden at runtime.

commit 54dd7be5855055a698291084c0074a1abac7b921
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 22 08:46:35 2009 +0100

    Allow selection of qemu using --with-qemu

commit 0d89fb44869a22c0a3fb84fd13d31006e41799f9
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 22 08:14:49 2009 +0100

    Error message about using --with-java-home=no to disable Java support.

commit b36dab0552df45d3d08aeeaf931294d091516f1f
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 21 23:15:25 2009 +0100

    Fixes for Java.

commit 6d5f69f81a888e26a425800c80d2892e10d74cea
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 21 22:38:28 2009 +0100

    Add extra kernel modules required for ext4 support.

commit f52bc724a30e45c28f231b48bca5fe0eb22592f0
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 21 22:27:22 2009 +0100

    Updated documentation, prepare for 1.0.5 release.

commit 231b2cf3c76b0613ac580901919b33db2ec6791d
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 21 22:24:25 2009 +0100

    Another Java test.

commit 2b568496e6d571be317bcecd58785edbf5d39ba1
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 21 22:05:44 2009 +0100

    Testing the Java bindings.

commit 7f818fa00c3d019146c7178f152408038d4a4d52
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 21 21:14:55 2009 +0100

    Java bindings compile, not tested.

commit 28bce4792198bc832e6ac0027a57091daa4c91c7
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 21 14:38:12 2009 +0100

    Add summary message, fix libruby detection.

commit f087927c5c9ef891ba6c943ce887ae9f40258a83
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 21 14:25:31 2009 +0100

    More notes in the TODO list.

commit b9014d6a0da8b2b3a76c4ab51fab2773fe7480b2
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 21 14:25:16 2009 +0100

    Basic Java build environment.

commit 936108f54cbf8e81132a0a0a8c093a4056f0e11c
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 20 23:40:50 2009 +0100

    Various fixes to build and test in Koji.

commit 89f060b5cfecc11558174b7e0b3867f2b8d9c135
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 20 21:16:25 2009 +0100

    Fixes for CDPATH being set.

commit 6a77cc2611a84c6e46f45fff49d8f22059f8aa05
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 20 19:30:11 2009 +0100

    Use standard names for the OCaml/Perl/Python/Ruby subpackages.

commit 9b281a66c0b2db5f50531528a1bc8d7c53ecf373
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 20 18:20:34 2009 +0100

    Ruby also supported

commit 6397feeb74af9c750b0430bc88f0855b1f7f1d28
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 20 16:52:13 2009 +0100

    Include the __cplusplus header magic so API really callable from C++.

commit e44128bf547024509bc064e728fb269504486659
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 20 16:28:02 2009 +0100

    Version 1.0.3.

commit d802fd46928674fd399a495e48f8d8650678a851
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 20 15:59:08 2009 +0100

    Removed TODO item, now implemented.

commit 0232e722826cfda0f6042da983f9eb871f24e946
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 20 15:54:22 2009 +0100

    Added tar-in, tar-out, tgz-in, tgz-out commands.

commit 11350529fee2dbbcfda333bbe10d72f023dc2109
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 20 15:13:34 2009 +0100

    Various fixes to the daemon:
     - make sure SIGPIPE doesn't kill us
     - warn not to use macros in FileIn functions
     - add shell_quote function

commit feb188d27787c595f12507ce5bff5431c4932523
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 20 14:58:36 2009 +0100

    Some fixes to daemon upload command:
     - don't leak the file descriptor along error paths
     - can't use those macros in FileIn functions

commit 4ce2b7b7fb949f584e4ad4b9d18121459be34a6a
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 20 14:58:04 2009 +0100

    Make daemon cancellation really work.

commit c5d37435aa9e257fac1c2d517fadc7630fa0d869
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 20 13:14:07 2009 +0100

    Add tests for the upload and download commands.

commit 469c6cdfd5f2ffb07eaf01c16a21ed1e5cb174c1
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 20 11:45:29 2009 +0100

    Prepare for version 1.0.2.

commit 42341cc00362a9983142a95f36622ea5baeb280a
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 20 11:45:11 2009 +0100

    Avoid warning: Don't generate read_reply label unless needed.

commit 2069ade88144d8efd272a74be24b5c9ff49844dc
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 20 11:35:57 2009 +0100

    Fix file descriptor leak in daemon.

commit 24ccbb29ac475187f51a27dcd318db2b4824a0c1
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 20 10:19:45 2009 +0100

    Generated code for 'checksum' command.

commit aef3d2013fee188c9607f35657c45df88503cd64
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 20 10:19:29 2009 +0100

    Add 'checksum' command.

commit 170f262f0413de843af62b968f6d12c1c476ae7f
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 20 00:22:02 2009 +0100

    Implement upload and download commands.

commit d5151686d82b66c50935010fd5458be0e4386bab
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Apr 19 14:51:50 2009 +0100

    Use GUESTFS_LAUNCH_FLAG in the daemon, and use correct uint32_t.

commit 13465753d3ed056609ec1e3137750a05d0497a66
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Apr 19 14:39:19 2009 +0100

    Document initial message.

commit 08c333a73893a0fc413e7619c8e64bebaebc741a
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Apr 19 14:33:46 2009 +0100

    Document the internal protocol.

commit d73a4f097f96e7246718671b0a85cb94f0d3a88f
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Apr 19 12:41:35 2009 +0100

    Implement NEED_ROOT_OR_IS_DEVICE macro.

commit 749708a7ec8930c34605ec58c18fefe0ed8e7981
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Apr 19 12:29:25 2009 +0100

    Implement _send_sync, _send_file_sync and _receive_file_sync.

commit bb07a7f858da5d07c57360e62c0ddfd24ce6be45
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 18 22:33:15 2009 +0100

    Begin to add the upload and download commands.

commit 7bf3e1a43512293b1a3f78f880b57e7bbd372eae
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 18 21:21:44 2009 +0100

    Add ruby/ directory, add more warnings.

commit 42a8baf3c9abc6f742671f37e9e24b607e5f9857
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 18 16:29:00 2009 +0100

    Split out send and reply operations into separate callbacks.

commit 8e54ab289550a35747530e5b723fd35a22aa689a
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 18 15:41:22 2009 +0100

    guestfs_send -> guestfs__send, in case we want a future command called "send".

commit ef499de8946cf4b8120ef7917b2e5d7f9115041f
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 18 15:31:53 2009 +0100

    Separate out the high-level API actions.
     - Split out the high-level API actions so that they are in a
       separate file, and use the defined guestfs C API, instead of
       fiddling around with internal structures.

commit ad1d84a142169baaed293de71fb9430178d9f999
Merge: 1765330e0 8a4cdcef2
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 18 13:27:06 2009 +0100

    Merge branch 'master' of git+ssh://g-rjones@et.redhat.com/git/libguestfs

commit 1765330e07a48dc6f7bdef7007f69ebe606fa731
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 18 13:17:12 2009 +0100

    Rewrite of main loop impl, start of FileIn/FileOut support.

commit 8a4cdcef21770cb19368a3f9d5cff3df3c01f833
Merge: 0206f0ead 92804dec7
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 18 10:16:34 2009 +0100

    Merge branch 'master' of git+ssh://g-rjones@et.redhat.com/git/libguestfs

commit 0206f0ead2a0d9a19b9fd58f61bf5eb5dc33b87d
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 18 10:16:03 2009 +0100

    Version 1.0.1

commit 92804dec7c4982d2039f81586bc4a5cacb46217b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 16 23:55:56 2009 +0100

    Allow Ruby bindings to build correctly even if libguestfs not installed.

commit e88c365cfbc125b7f16f8b28ab74a0c32d150722
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 16 22:25:36 2009 +0100

    Fix spec file.

commit a5f68bd57d887c8c8818dbb92a9f8b7643f67827
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 16 22:13:20 2009 +0100

    Ruby bindings.

commit 5a6da98c943be987441673a590c151f15573b6cc
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 16 17:44:47 2009 +0100

    Resync with proposed Fedora specfile.

commit 1e60354dc8fb306fa139ae744a596f4f5bcbd9a7
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 16 17:38:27 2009 +0100

    Missing free() on return path (thanks: Steve Grubb).

commit 3ae8631c8fb1f9f05aab3549fd56a8b41cd99784
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 16 17:35:59 2009 +0100

    TODO list updated.

commit ecee63de60a2419abf54eb1967dab04643234ed6
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 16 16:34:23 2009 +0100

    Note slow kernel boot times for F11/12.

commit b56d67859c6835e9a33e9099b0eccbe02bca12d2
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 16 12:38:06 2009 +0100

    Updated TODO, BUGS.

commit 3eba057f5a16300eff4247d7beb4a3f51c094b1d
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 16 11:39:22 2009 +0100

    Added Python documentation.

commit 7e47aaa137128982fa6ee514c4b714c515819afb
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 16 01:31:19 2009 +0100

    Really needs qemu 0.10 for vmchannel support.

commit ce6c6978eedadcf2235dc1ac83bc0868f58c532b
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 15 23:58:11 2009 +0100

    0.9.9 for final cleanups before 1.0 release.

commit 05712b2457a44ee0f0020eced77db03c2aa419a1
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 15 23:54:51 2009 +0100

    'guestfish edit' commands and several bugfixes.

commit 54a6c3212ce1f942979639d2f2bd726414fff7c2
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 15 20:38:01 2009 +0100

    Started BUGS list.

commit 612a358b8935381e5b8d706e4a77689cd316a18d
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 15 20:27:30 2009 +0100

    Move guestfish 'alloc' command to a separate file.

commit 76f1a7d9941ba5b4ebc9e574cf9ee97e50294586
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 15 17:59:43 2009 +0100

    Version 0.9.3.

commit 4905c1ae8b12577943b53fd7b23187f5a59f07f0
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 15 17:58:35 2009 +0100

    Show byte sizes in example.

commit b348eacbc4d84337856cf7cca518d61c63e92631
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 15 17:48:54 2009 +0100

    Generated code for blockdev_* calls, RInt64, enhanced tests.

commit e038597ebd1e43c83a8ddde21c4f1898eb7a9a98
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 15 17:47:34 2009 +0100

    Added blockdev_* calls.  RInt64 type.  Enhanced tests.

commit 706c75629733d05a891a81eebe373d124409cfb8
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 15 16:04:27 2009 +0100

    Be strict about commands which don't test themselves, warn about missing tests.

commit 52471f572ec036a76bc977bcf39cfab179dfbc13
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 15 16:00:10 2009 +0100

    Version 0.9.2.

commit 3e9f98d0f73ec483b970c19ad1752acc380c38b9
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 15 14:19:03 2009 +0100

    Display ext2/3 details, and some bug fixes.

commit 0c2376a5c05053ce6a0479ade544be860c400fdb
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 15 14:09:01 2009 +0100

    Correctly free memory in RHashtable binding for OCaml & Python.

commit ad5abc8d367c9c410051062cae066b1b141b4c76
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 15 13:59:07 2009 +0100

    Generated code for tune2fs-l command and RHashtable return type.

commit d5ae4a54e83018687ec05255bc39e7f5ab71a453
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 15 13:58:44 2009 +0100

    Added tune2fs-l command and RHashtable return type.

commit 7fe2b338e4102a23ecd2f89b447b7618f0e93312
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 15 12:34:18 2009 +0100

    Added to-xml program.

commit 197f0ceeac625a20b923b274c6025eb0ccaeaed1
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 15 10:52:37 2009 +0100

    Remove 'df' program from examples - didn't ever work.

commit 6bcbe54b5785cb8c911ccf4b724ae6abfdf53ce4
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 15 10:45:01 2009 +0100

    Generated code for stat/lstat/statvfs changes.

commit 212a55d483c2a20e61f42211c0c64aab3645cb09
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 15 10:44:27 2009 +0100

    Added stat, lstat, statvfs and associated stat structures.

commit 946eec285f634e51b3ea6416a6d7947427c66797
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 14 20:47:51 2009 +0100

    Quoting in guestfish.

commit 8d898dadd931a9bb27202bb26f51828debb27906
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 14 16:16:34 2009 +0100

    Version 0.9.1

commit d268e64fe76944dc042e7ec68a65e59a6cff16ce
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 14 15:52:04 2009 +0100

    Added bindings for GNU readline.

commit 374af1d1c85580a7768967bf2f199f10182b011e
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 14 14:38:31 2009 +0100

    Better handling of trailing \n problem.

commit 5a563bbd9b2779640e3358f4bf1eaac622b58cae
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 14 14:20:47 2009 +0100

    Typos and documentation updates.

commit 98a43eba2fe2b18f5042138556c6beede0277223
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 14 14:20:07 2009 +0100

    Generated changes to perl XS bindings.

commit 5365ebd501850ea10d9a5b28fc6480ea34dbe16d
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 14 13:51:12 2009 +0100

    Add 'command' and 'command-lines'. Fix args freeing in Perl bindings.

commit 161018ed1e90c796e6e099859979da02d5f3e410
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 14 13:09:06 2009 +0100

    Fix 'file(1)' command to work on /dev devices.

commit adefe14e308a0f8cf73f9c60693a3dbbded157b9
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 13 23:58:33 2009 +0100

    Generated files for file(1) command.

commit 42283403886da648bb239177369aa65c0a659255
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 13 23:58:02 2009 +0100

    Added file(1) command.

commit a29a2e99ce120415941894da45087a360e6c65d3
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 13 23:57:26 2009 +0100

    Note a bug.

commit 2a243cfbe1938d324ac6445aa2917ec3db0d8c50
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 13 20:13:06 2009 +0100

    guestfs -> GuestFS

commit 55e302bb1002e236afc9b2d33aa47128b8542133
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 13 20:07:03 2009 +0100

    Python files.  Add $QUICK_RPMBUILD flag to avoid running tests.

commit 4ee9666a388f771e9b353dbedc90f52a73bb86e1
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 13 20:06:46 2009 +0100

    Install guestfs.py

commit f286a81cab9059ef3be51bf745e2903e065b36ea
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 13 19:40:50 2009 +0100

    Missing dependency.

commit ec89b939882564b0f7a481298e06111b7578d60d
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 13 19:39:39 2009 +0100

    Describe all available bindings.

commit 632d452727d32905627037e295aca38ce0b38f57
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 13 19:39:20 2009 +0100

    Need to package generator.ml -- oops.

commit 0344eb0b3cbbaaf0529c4e0d8f13db6199a407db
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 13 19:15:22 2009 +0100

    Prepare for 0.9 release.

commit adcf5dc6aa53c02877e6bc16e211b7062a8ea33c
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 13 19:15:12 2009 +0100

    Extra CLEANFILES.

commit 70c2ffc39677a9f5eb6b2230cb9ca2606b2fd966
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 13 19:10:10 2009 +0100

    Additional test programs for Perl, Python, OCaml bindings.

commit b3f11c5f62f725fa3f09452b38d52dba764f80d0
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 13 18:32:03 2009 +0100

    Lots, mainly Python bindings.

commit f968f6c36fda3bb66cd37cd56de250c29afa7698
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 13 10:33:44 2009 +0100

    Stricter checks on short descriptions.

commit b6722e6313e955ad0c1e4e4ec594c8e74cdd27af
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 13 10:27:20 2009 +0100

    OCaml bindings build using the installed, not built, library.

commit 848fd706616ca65be7f74b48b39c95363640a187
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 13 00:51:56 2009 +0100

    Old versions of augeas lack aug_load, aug_defvar, aug_node.  Check for those calls.

commit d68cce2e307fe13616a66c52f88ddf87bfae9c6a
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 13 00:29:00 2009 +0100

    Version 0.8.1

commit 7e7b2d30b13c2daad59995c06392cb4b24ffa9e6
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Apr 12 23:54:49 2009 +0100

    Distribute TODO file.

commit b7c9d26ddeb1f230c1eb4435f3893af0054cfdf7
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Apr 12 22:27:04 2009 +0100

    Fix looping bug in parse_string_list, and remove debug message.

commit f1a10c6285cca30f8c9491ae08951137457bb018
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Apr 12 19:01:07 2009 +0100

    More BuildRequires.

commit 6174ef5c2859309b1b648bc96145df095312e6e7
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Apr 12 11:57:53 2009 +0100

    More TODO items.

commit 819efe7df8b0f9a48e0ef59cbb5bdccc99c9c6d5
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Apr 12 09:42:32 2009 +0100

    Add BR qemu (required to run the tests).

commit 0102b0cc9ba68155795eb0ab1ad3bb9f9f29368d
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Apr 12 09:42:19 2009 +0100

    Added some ideas in TODO file.

commit 8eadcfd57d79d92d8366a86bbd220912ac735d3e
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 11 18:04:49 2009 +0100

    Minor adjustments for 0.8 release.

commit c169a0bb9ddde5b61045d95fb2728b43751488f1
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 11 17:30:57 2009 +0100

    Don't delete examples/Makefile.

commit b4d2a01828e5de85e5eee3631f7fe3925a0312ca
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 10 18:25:07 2009 +0100

    Added test suite.

commit 99f68f259f92eee884c6c7396f61b9c16e2bf354
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 10 15:10:29 2009 +0100

    Added test framework, no tests implemented yet.

commit c7f85827cf89a088fa85808202edc75c820fd14e
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 10 15:06:29 2009 +0100

    Need to set LD_LIBRARY_PATH so we pick up the right C library.

commit 286841877f4223d67ec00b83e5a2aabfbb9e19ed
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 10 12:53:28 2009 +0100

    Generated files for previous commands.

commit 44da812b424f5e10e268d47149d012d49edf858b
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 10 12:52:49 2009 +0100

    New commands: rm rmdir rm-rf mkdir mkdir-p chmod chown

commit dd0432e2efc2e22ddbc9fb0a2746ee1c6a9c582f
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 10 12:47:34 2009 +0100

    CHROOT_OUT must preserve errno.

commit 1c8f9c274adb342b263d083f0ac0c24e4b600974
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 10 12:47:04 2009 +0100

    Fix off-by-one error in Augeas wrapper code.

commit 95de8eea73b6fc105de728aad7571cfd0042666f
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 10 11:49:51 2009 +0100

    Change Err -> RErr for consistency with other return types.

commit 71fa671c6dd4decccb3d99941a5d02b0d13e0152
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 10 10:55:28 2009 +0100

    Documentation fix.

commit e61494eb0755d5323e04d8dca3867a154965092a
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 10 10:52:38 2009 +0100

    Code cleanup.

commit 3acec39588bd574a616fa0671a29cd1280f356fb
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 10 10:46:50 2009 +0100

    Add more function checking.

commit 469224a9eca9b575063e6a1ca1b1d97adb3448cb
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 10 10:26:10 2009 +0100

    Just use plain lists for argument representation.

commit 7c71920ab4f1b1beea3e1a38b91e2d81922d6cfb
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 10 10:19:00 2009 +0100

    Documentation fixes.

commit fb19874b1e1c40f3f5efafb39151b1bfc3ef725e
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 10 10:13:59 2009 +0100

    Correction in the aug-ls documentation.

commit d19ceb226c242844467b2935c1e19b989b4315e8
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 9 19:47:22 2009 +0100

    Remove *~ files when doing 'make clean'.

commit 2834059b2ac047bc099ed7617c4f6174d441d7e1
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 9 19:42:22 2009 +0100

    Documentation update.

commit 7e948f45852e4aab24775200da4b0de3c5904bdc
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 9 19:36:49 2009 +0100

    Bumped version number.

commit 01c26253a12ed1e6b1199f8c85f049a7fc4aef28
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 9 19:36:07 2009 +0100

    Added aug-ls (generated code).

commit 0677b12f2273ed266da9dd276c129342d6a939a2
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 9 19:35:16 2009 +0100

    Add aug-ls command (non-generated code).

commit 42643f08970c2efa5cb71a92166fbe323474c203
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 9 17:42:15 2009 +0100

    No need for mirror, add HTML docs to subpackages.

commit c989e8832df70b4cb8200ba8d5622048e560f1f7
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 9 17:42:01 2009 +0100

    Distribute the pod.css file.

commit 233595cc4e3c3422a5f5d8aec3314029da3f0ec7
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 9 16:48:46 2009 +0100

    Generate webpages.

commit e7eca50046e9a69dac27c0bee832af0a3014e02c
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 9 13:19:38 2009 +0100

    Added Augeas support.

commit a2e1d51acda406fd4193f121ac9f879e60cf4302
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 9 13:19:12 2009 +0100

    Updated HACKING notes about debugging.

commit c168ce1c91c8f4f615ec53e140970e0017ad750d
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 8 23:47:31 2009 +0100

    Generated code for new guestfs_read_lines API call.

commit f4299f7ea55c4bbc9302e102d2fc801829e75ef6
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 8 23:47:28 2009 +0100

    Definition and implementation of new guestfs_read_lines API call.

commit 45f3a8981723079a5a020ab9438593531b1d8368
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 8 23:13:31 2009 +0100

    Version 0.6

commit bf26360e5e91148a4479f812c2b43acce4f5884e
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 8 23:06:51 2009 +0100

    Added OCaml examples.

commit 13339826ea01f8dbd581b5d2544e7692171cf386
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 8 22:52:11 2009 +0100

    OCaml bindings compile.

commit 94050e0344685b6916e21581e618ad3e85795008
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 8 20:26:35 2009 +0100

    Many non-daemon functions are now auto-generated.

commit b5ff6816face6f8c1700d4f1df752c710620ff95
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 8 17:19:09 2009 +0100

    Version 0.5: Numerous small fixes to make rpmbuild work again.

commit c3168fc03cdff6be5638107b12f74bc895af55ed
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 8 15:22:29 2009 +0100

    Added more Perl bindings tests.

commit 447b96e57cdf40ddc3b7669ba65dbea961748f71
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 8 15:08:10 2009 +0100

    Bug fix: Trailing whitespace from 'pvs' command.

commit 9908e03e922b670437bcd89b6873f9ebc914567e
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 8 15:02:39 2009 +0100

    Fixed Perl bindings, they now work properly.

commit 00e309d3608661eaa8c9cc69ba5bf175c612698d
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 8 13:54:19 2009 +0100

    Ignore perl/Guestfs.bs file.

commit 0d112d58af8b2c28de9ee4ae5b0ed3527757bdfe
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 8 13:46:21 2009 +0100

    Updated generated files.

commit 562efcba335bc726954ed2ebcd75ece9c3aba41f
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 8 13:46:05 2009 +0100

    Mention OCaml & Perl bindings in introduction.  Error handlers must copy 'msg' if they want to stash it.

commit 622bc0af28dab528b04b50c74d34813dd2428bd1
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 8 13:45:14 2009 +0100

    File was removed, updated dependencies.

commit 5828e17afdc2fe22947ca68f879e2071359f5f81
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 8 13:44:46 2009 +0100

    Need to distribute OCaml bits even if OCaml not found.

commit 1ee6da96efe8340a7d3904a865d80cd59d9d3fde
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 8 13:44:13 2009 +0100

    First version of Perl bindings, compiled but not tested.

commit 8dcc88f867ab0bed24df49d8c0f347f1357bfffd
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 8 13:42:26 2009 +0100

    Added a note that I'm not going to do Python bindings for now.

commit 4144e2106cc70ad8f1e081b57da09f9c1e276812
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 7 16:52:25 2009 +0100

    Outline OCaml bindings.

commit 21ba59ce3cbc594ce9c7aeecd4dadb8430e4042d
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 7 14:55:25 2009 +0100

    Added guestfish(1) manpage.

commit bccbfe5ab55c8aa5bbb0fb6e209936ff1359605a
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 7 13:51:12 2009 +0100

    Fix: "aclocal: couldn't open directory `m4': No such file or directory"

commit acf9000252da7f4f3fde693ecc03461007cf0bf9
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 7 13:08:50 2009 +0100

    Added framework for the language bindings.

commit dfb90f793a40d38da47ee1b604ed0a73a05281d0
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 7 11:06:28 2009 +0100

    New header file.

commit 4af6b4777ae5ec3109f8a99c61ff84c3a5123abc
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 7 11:06:23 2009 +0100

    Remove unnecessary kernel drivers.  Big reduction in image size.

commit af92796e0308b31c9a6167e1c7bde6510ca409d7
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 7 10:42:15 2009 +0100

    Fix incorrect realloc size which was causing 'ls' command to fail on large directories.

commit 6085137e65cb63aaf725207f2929a571d1149420
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 7 10:25:46 2009 +0100

    Implement simple lvs/vgs/pvs commands.

commit 7ea56c8d0bca01a602df8e87e52d90c5b44e2cc2
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 7 09:52:46 2009 +0100

    Rename pvs -> pvs-full (etc), so we can add simple pvs (etc) commands.

commit 73d6932ab2dd3f9120a1f4a532621c07cb174705
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 7 06:50:31 2009 +0100

    pvs/vgs/lvs commands working now.

commit 8e570870f577ff0c3db074f88924633b559af5d4
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 6 12:55:26 2009 +0100

    Implement list-devices and list-partitions.

commit 1cf85b1e60e85c4940869c6291d75ac44a5bd190
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 6 11:44:48 2009 +0100

    Implementations of 'cat', 'ls', and some cleanups.

commit bf17bf81fef275892d24458ce5f1e5290b426742
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 6 11:43:14 2009 +0100

    Debugging tips.

commit e5e9541f2de4af37bca98633aa75f9f9533a07db
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 4 16:52:52 2009 +0100

    Fix incorrect short description of 'cat' command

commit 843514eef9dc6d04d71e031ba9ddb16e2beb9a04
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 4 16:38:28 2009 +0100

    Implement RString and RStringList return types.
     - implement 'll' command.
     - outlines for 'ls' and 'cat' commands.

commit eb50cde931893e54c5aa9816cbca49e36891be8f
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 4 14:51:48 2009 +0100

    Implement the alloc shell command.

commit fdeae81d81e979d74059f01350e94dbf37700075
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 4 14:51:31 2009 +0100

    guest_add_{drive,cdrom} now test if the files exist.

commit f0624da341ceadf637c700fa91727707bd44b41a
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 4 13:17:46 2009 +0100

    Add %post and %postun.

commit 6941420efeefc48100a545806271af2de92dda26
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 4 13:17:32 2009 +0100

    Fix parsing of paths with more than one element.

commit 8358ea9524509c02448fe52d5bea205c9c3f869e
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 4 12:54:47 2009 +0100

    LIBGUESTFS_PATH implementation.

commit 017b503c3bf79ad87cd66f73d36b4be5b31d10ad
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 4 11:29:44 2009 +0100

    Document --add and --mount options.

commit 236b5295bf3e497153a5cae9708c3d0249f2daf6
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 4 11:27:26 2009 +0100

    Mostly working spec file.

commit c9cc61940b41b1abb763a1932adfc3461372c10b
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 4 10:41:34 2009 +0100

    Implemented autosync, make it the default for guestfish.

commit 64a5ae0e969754c709974104a83e6d1dbb4c2764
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 4 10:29:25 2009 +0100

    Generate actions section in guestfs.3 man page.

commit 6d37b7698c1e2add43f0e8908e1bc30700f95f7e
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 4 09:40:44 2009 +0100

    Implemented running actions in guestfish.

commit b4c040d30e2677313a892ffe4cde0d53e446da7d
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 4 01:49:36 2009 +0100

    More tidy up of messages.

commit 76f3ea8fb3318966c376bc6fbccbd5a81a9ec564
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 4 01:40:43 2009 +0100

    Command line, help.

commit 4567839859befc5aa9e1eee942dc2ba0701516e2
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 4 00:58:40 2009 +0100

    Command line and interactive shell parsing, prompts etc.

commit bc0b3d6f473e607972d29be27f7ae6b1d0489c3b
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 3 23:47:47 2009 +0100

    Added outline of shell command, added generator support.

commit b72ec21d24824720385c9cd024b7f1eae734f4a4
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 3 22:45:42 2009 +0100

    Small updates to the generator.

commit 99bd425a0a8fb02c27e0c22b32dafa804773a7b1
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 3 22:25:34 2009 +0100

    Implemented 'mount' and 'touch' commands.

commit f5d2602bf6d40ecc71a5a17e0be9f480e9a4453a
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 3 22:24:32 2009 +0100

    Added a HACKING file.

commit 8ae9f67a1767c44ce1650d54665d1e7936181603
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 3 20:30:42 2009 +0100

    Added images/ directory for test images, and one image.

commit 316bbc36662c0df6b3d0ad48790e0b551a291df6
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 3 19:51:02 2009 +0100

    Parses return values and returned errors properly.

commit ff1f39794b2688f0fd6a0c367164e3d715136837
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 3 19:16:27 2009 +0100

    Make the partition configurable.

commit e83181345f8bedc8c3196184f3e3274c6a1c41a3
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 3 19:13:48 2009 +0100

    Added README file for examples directory.

commit 3906e4ff91c208e0ae90ab8b18e69e678a9bed8e
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 3 19:11:44 2009 +0100

    No verbose.  User can enable by setting LIBGUESTFS_DEBUG=1 if they want.

commit 9c5ea364505f9f2553a20e93b78a61e3953eacf8
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 3 19:11:29 2009 +0100

    Pass -no-kqemu parameter to avoid warning about kqemu.

commit d134143b55ecb5f7e6f74318acbf04f9e1370af6
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 3 19:08:19 2009 +0100

    Makes a series of non-trivial calls.

commit 40ca9a57829f2e82362e391d7d998bf33c8bd671
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 3 17:24:35 2009 +0100

    Daemon and library are mostly talking to each other now.

commit cd2fd58da3f5648a62f3fb7586cdc910c09a31af
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 3 17:23:33 2009 +0100

    Remove initramfs/fakelog.root if make-initramfs fails.

commit 1fbc83c9c265e3942e9799289584c66f7d5d6cf5
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 3 17:23:03 2009 +0100

    Remove NFS support - we will probably use FTP instead.

commit 55bf8fd622e9f84364b505db6591ace3ec2b5447
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 3 11:29:55 2009 +0100

    Lots more auto-generation.

commit a8b84fe17f5df830d3498ecf885e52f0914182dd
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 3 11:27:52 2009 +0100

    Set up ethernet interface.

commit 8d0068a752ee8e6bc223de5cb7cac5d190a8855e
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 3 01:15:17 2009 +0100

    Start the generated code and code generator.

commit 15dbb6973a7af11b81df047194228ea86d46939b
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 3 01:14:44 2009 +0100

    Add the first version of the guestfsd daemon.

commit 207056e82372093fa5bc678a9e55a2abc33704fa
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 3 01:13:42 2009 +0100

    Add update-initramfs.sh.in so we don't need to rebuild initramfs for
    small changes in the daemon.

commit 11d20e2b9f7dc1becba30d16c378c704a3ad1f50
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 3 01:12:21 2009 +0100

    Updated to newer GPLv2 document.

commit 56465eb694ba2077de37e66600c7bef96061cbe4
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 2 20:55:41 2009 +0100

    Correctly handle the case when select runs out of filehandles.

commit 163e399a001a300a53a4c99887742608d23e09ad
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 2 20:46:55 2009 +0100

    Code to handle the daemon communications socket.

commit 88f69eb03160a62d38a361a5ad68c6ba1e767a20
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 2 20:07:21 2009 +0100

    Guest boots, and basic select/callbacks work.

commit e94fca28c7503464c6ef0a9739c0d22741ef4dce
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 2 17:00:13 2009 +0100

    Ignore generated manual page.

commit 27146d368a4956a44c59d1a7fea4ab92685e080c
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 2 15:15:55 2009 +0100

    More documentation updates.

commit 82dd4b8a308dc97acabf37551bb780434f5e497a
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 2 12:10:59 2009 +0100

    More documentation.

commit 5de49dc0d82a86032eb51e2cb9e43813e2480594
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 1 20:29:03 2009 +0100

    Documentation of low-level API.

commit fddf794d1a4446c94f652af4eeba37a599355e6f
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 1 16:08:23 2009 +0100

    Add test-boot-realistic target.

commit fe6820c1bbaec015a883804545362a8c9b6b4583
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 1 16:08:01 2009 +0100

    Correct permissions problem in root filesystem by using febootstrap-run
    properly.

commit 6ed48042e4a8b009b5e38efbf4766a2676a33935
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 1 12:57:45 2009 +0100

    Various fixes to the build system, add 'make test-boot-image' target.

commit 002cdf48fee7a59d13865ea9848671b588e86daf
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 1 12:57:25 2009 +0100

    Run autoreconf with -i parameter.

commit 7ec96575f7cd74615f1ead8bc834bc07c3dc2999
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 1 12:57:10 2009 +0100

    More files to ignore.

commit 8c07ad6191e2a13cf240a47dbed72afdc4010aa4
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 1 12:56:49 2009 +0100

    Print size of kernel, don't need to delete gnome/help any more.

commit 1a2deb2bcdb0c8ec509b1d98805e0fc46122c5a9
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 1 12:53:40 2009 +0100

    Moved .cvsignore -> .gitignore.

commit 863d13ea1aadddc122ad82f4dad20e73231b48f2
Author: rjones <rjones>
Date:   Tue Mar 24 14:15:13 2009 +0000

    Build the initramfs.

commit 91df7a164befc0c9a24f85733837874da5a057ac
Author: rjones <rjones>
Date:   Tue Mar 24 09:38:31 2009 +0000

    Now using febootstrap.

commit 09c16b5da0ec982bfffe654a55abd637a3335c95
Author: rjones <rjones>
Date:   Wed Mar 4 13:18:48 2009 +0000

    Starts up QEMU now

commit b6233d1fff5d9a6bbc61e7123a57bdd7d8cbc792
Author: rjones <rjones>
Date:   Tue Mar 3 15:35:50 2009 +0000

    Running qemu as a subprocess.

commit 407caabfd04a8bb6338a7fcf4f46d85d75e709df
Author: rjones <rjones>
Date:   Tue Mar 3 09:08:12 2009 +0000

    Final fixes to build environment, and added autogen.sh.

commit 28d760b1542da7ff83b18c4ca60c2d03f327c2f4
Author: rjones <rjones>
Date:   Tue Mar 3 08:58:37 2009 +0000

    Build environment set up for libguestfs.
