commit 6e5039d1ef69acf38b2cdbd3d4b634887ae00979
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 17 17:38:07 2014 +0100

    Version 1.27.64.

commit 288bc73bb02fcf69b952a80fc4efe89337bfab4b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 17 17:37:37 2014 +0100

    v2v: Add test files to EXTRA_DIST.
    
    This fixes commit 852f2e8e3c3228be4b9cd2be5b1d5da10a41fe32.

commit 97c96ed6702cb7b4dfcc5acd08a29cb6f2b70b54
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 17 17:18:25 2014 +0100

    v2v: Windows: Add &REV_00 variant, which is used by W2K8R2.

commit 4f6033c3f4428f2c0033dfc256e71f05db17c3c2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 17 17:14:52 2014 +0100

    v2v: Windows: Fix quoting and type of viostor ImagePath parameter.
    
    The way to fix these bugs -- for future reference -- is as follows:
    
    (1) Install the corresponnding Windows version with virtio enabled.
    See:
    
    https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/7/html/Virtualization_Deployment_and_Administration_Guide/chap-KVM_Para_virtualized_virtio_Drivers.html
    
    (the ".vfd" method)
    
    (2) Download the SYSTEM and SOFTWARE registries from the
    virtio-enabled guest.
    
    (3) Examine each registry using 'hivexsh', especially the keys which
    we modify during virt-v2v (see v2v/convert_windows.ml).  Remember to
    use both the 'ls' and 'lsval' commands in hivexsh.
    
    (4) Download the SYSTEM and SOFTWARE registries from the guest that
    fails to boot.
    
    (5) Examine the same registry keys from each registry using 'hivexsh'.
    
    (6) Work out what the differences are, paying particular attention to
    quoting and the type of each key (eg. str(1), str(2), etc).
    
    Thanks: Matthew Booth.

commit ca6d7d9c34dacf83dc8611c74f66cfe208fcdc0b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 17 13:44:35 2014 +0100

    v2v: Print version of virt-v2v in debug output.
    
    Easier than asking users to send us this information, which they often don't.

commit e2e17055742c3de6145406033b16716f259949f2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 16 18:02:46 2014 +0100

    v2v: Add new section on resource requirements of virt-v2v to the manual.

commit 852f2e8e3c3228be4b9cd2be5b1d5da10a41fe32
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 16 14:08:17 2014 +0200

    tests: v2v: Test -i ova with two input disks.

commit d8849fadbdb88d1afa03174ab36057afba7a0fc7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 16 15:58:41 2014 +0100

    v2v: -i ova: Fix it so it actually verifies SHA-1 hashes from manifest files.
    
    There were two large bugs before: (1) It only found one manifest file
    (meaning that multi-volume OVAs would be broken).  (2) The regular
    expression didn't work so it wouldn't check the hash.  Bugs (1) + (2)
    combined so that the check just didn't do anything at all, which is
    why we didn't notice the multi-volume problem.
    
    Actually I suspect we shouldn't be doing this check at all, since I
    bet there are OVAs out there with broken SHA-1's.

commit 249aae0c2ffa685008c03f5d06e05c2989b1ec99
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 16 08:36:33 2014 +0200

    handle: Process empty LIBGUESTFS_* environment variables correctly (RHBZ#1153515).
    
    Ignore an environment variable:
    
     - if an environment variable is an empty string, AND
    
     - if an empty string would have no meaning for that environment
       variable (eg. LIBGUESTFS_BACKEND can only take on certain values,
       and an empty string is not one of them).
    
    Note that LIBGUESTFS_BACKEND_SETTINGS is meaningful as an empty
    string, and for this case I have removed the STRNEQ (str, "") test.
    
    Previously:
    
    $ LIBGUESTFS_BACKEND="" guestfish -a /dev/null run
    libguestfs: error: invalid backend:
    
    After this commit:
    
    $ LIBGUESTFS_BACKEND="" guestfish -a /dev/null run
    
    (no error message is printed)

commit 93c2769e2bb6a19b216d78216d062e4d99f43dbf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 15 22:19:19 2014 +0200

    Version 1.27.63.

commit 4511137c054416f407ff4e05c82ca6b9abc62d8a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 15 21:23:33 2014 +0200

    tests: v2v: Check -i ova generates the same XML each time.

commit 717c73d22b57dc2c06a80ca516b83591c64caafa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 15 21:18:21 2014 +0200

    v2v: -i ova: Try hard to preserve the order of floppies and CDROMs from the original OVF.
    
    Remove the common 'add_resource' function.
    
    Duplicate that function into code for adding disks, and separate code
    for adding removables (floppies & CDROMs).
    
    The removables code should look for all removable devices
    (ResourceType 14, 15, 16) in a single query, so that the order doesn't
    depend on the order in which we do the queries.

commit 59015939abc63de27fc6e8329a23f3087fd3f91a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 15 21:04:33 2014 +0200

    v2v: -i ova: Preserve the order of disks/removable/NICs from the source OVF.
    
    Because we built the lists up backwards, we ought to reverse them
    before passing them out of the module.

commit 516a95824a9a5408c353dc9843492b5092fbe0fc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 15 21:00:21 2014 +0200

    v2v: -i ova: Mainly whitespace and formatting changes.
    
    Mainly tidy up the indentation and comments to match the "house
    style".  No significant functional change.

commit 94f2eb8b26cef7faa42eba7c9cbe39d6a25858bd
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Oct 13 15:06:30 2014 +0200

    bash: add virt-log completion entry (RHBZ#1151766).
    
    Thanks: Lingfei Kong

commit 88a482dd9f6f1b842350edd0437dfe621ebcf510
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 13 13:07:43 2014 +0200

    v2v: Add 'exit' choice to --root ask.
    
    If the user does ^C then this leaves temporary overlay files around
    (possibly a bug?).  Offer an 'exit' choice to the user which exits
    cleanly.
    
    The new message looks like this:
    
      Dual- or multi-boot operating system detected.  Choose the root filesystem
      that contains the main operating system from the list below:
    
       [1] /dev/sda3 (Fedora release 20 (Heisenbug))
       [2] /dev/sdb3
    
      Enter a number between 1 and 2, or 'exit': exit

commit 04de9d3df064ab32ea31a0b803f29466cc0fc0d9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 13 11:40:00 2014 +0200

    v2v: When choosing a root from several, print an info message.

commit 2ba45489a1e296b89d3c32ef80e57efc13f32a88
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 13 11:39:24 2014 +0200

    v2v: Add an 'info' function for info messages, and use it for virtio message.

commit 2b4ba9d692d1dfa08b19459305477fd22b6066d8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 13 11:36:15 2014 +0200

    v2v: --root ask: Number the guests in the list correctly.
    
    Thanks: Junqin Zhou

commit 145a188f7056d4414adef472e95cad5640d79511
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Oct 13 11:02:14 2014 +0200

    edit: fix --format documentation (RHBZ#1151738).
    
    Use only --format=FMT as a way to specify a format, as the version
    without the equal sign will not work for that.

commit e3722252295921d095fc124bbb2f7698a510fafe
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 10 16:58:48 2014 +0100

    Version 1.27.62.

commit 5c7cb0ac7c8b0516ae56966b037fba36c1518b6a
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Oct 10 17:03:59 2014 +0200

    builder: use the JSON module
    
    Switch to the JSON OCaml module for JSON output.
    
    The resulting output is the same, except from an indentation level more
    within lists.

commit 901de75ff42f169880f5c2356483d30c1e1b04eb
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Oct 10 16:55:47 2014 +0200

    mllib: improve JSON: more types, indented output style
    
    Improve the homebrew JSON writer:
    - add more types (including also nested dictionaries and lists)
    - format in a compact way (single line), or indented (multilines)

commit bb0d7edfa017ed39f9a4f95b785bd50761cdb8ae
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Oct 10 15:10:20 2014 +0200

    Move JSON to mllib
    
    Move the simple OCaml JSON writer to mllib, so that can be enhanced and
    used also outside v2v.

commit 75b45143f0fe3df2449d1e6b523b63e2380c89aa
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Oct 10 15:09:27 2014 +0200

    appliance: remove few duplicates from Mageia's list

commit 7893a2cfb1b2e2e8fba9ceab35b498025fbe535a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 10 11:47:26 2014 +0100

    FAQ: Add a section on debugging libvirtd.

commit 632803856701bd664f8f482a5bfcaed6715cd36e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 9 18:07:33 2014 +0100

    v2v: Rename some modules to remove lib_ prefix.
    
    v2v/lib_ovf.ml -> v2v/OVF.ml
    v2v/lib_ovf.mli -> v2v/OVF.mli
    v2v/lib_linux.ml -> v2v/linux.ml
    v2v/lib_linux.mli -> v2v/linux.mli
    v2v/lib_esx.ml -> v2v/vCenter.ml
    v2v/lib_esx.mli -> v2v/vCenter.mli
    v2v/lib_xen.ml -> v2v/xen.ml
    v2v/lib_xen.mli -> v2v/xen.mli

commit 88a381b2a065e0447281eb3ca7a215b3855c98b0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 9 16:04:01 2014 +0100

    v2v: Increase readahead window for vCenter transfers (RHBZ#1151033).

commit 8f3a2ca5358d5601be7a9247b6d08193c4e2da46
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Oct 9 14:53:53 2014 +0200

    appliance: add dhcp-client on Mageia
    
    dhcp-client replaces the non-existing dhclient.

commit 979e7a49147f4ef1387337db262bf7ea12f627e3
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Oct 9 14:53:10 2014 +0200

    appliance: add dhcpcd and gptfdisk on Archlinux
    
    dhcpcd replaces the non-existing dhclient.

commit e21a4e5a90ccc5dce49d4fac5f3f4750e3fee182
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 9 10:30:01 2014 +0100

    Version 1.27.61.

commit 626d85d80be994065951b5f17706ca33ca5fc152
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 9 10:15:55 2014 +0100

    v2v: -i libvirt/libvirtxml: Give a better warning for local displays (RHBZ#1150880).

commit 4d4cada65a09dd40940aa021ba7a52b5fbf266be
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 9 09:34:11 2014 +0100

    daemon: copy-file-to-file: Unlink destination file on failure (RHBZ#1150867).
    
    When copying from file to file, don't leave the destination file
    around if the copy fails.
    
    However in the same code don't try unlinking the destination device on
    failure.

commit fbbcc6c6298dc7084891703bdb5af97541c29bdc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 9 09:29:31 2014 +0100

    sparsify: Fix documentation of --check-tmpdir option (RHBZ#1150858).

commit 9d6efb4966c4d0c9f528af8eb901acde65ce4825
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 9 09:21:06 2014 +0100

    diff: Remove copy and paste mistake from the documentation (RHBZ#1150815).
    
    Originated from copying this section out of the virt-ls man page.

commit f8f6250612a44ef56dc8ee8574058a7fdf30ee8f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 8 22:32:03 2014 +0100

    v2v: Allow -b/-n as alias for --bridge/--network.
    
    This was permitted by old virt-v2v too.

commit e66138fbe71c24df3a282e1b23d8ed5c80f7b8c7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 8 21:17:43 2014 +0100

    v2v: Enable trimming of data disks and non-mountpoints (RHBZ#1150701).
    
    This also modifies the --no-trim option so you can specify a device
    name, since this is necessary if fstrim can apply to non-mountpoints.

commit 69fe3945b7641811c99c3c03e05e73d2347e8a42
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 8 21:16:48 2014 +0100

    v2v: Fix the --no-trim option so it works.
    
    We never updated the no_trim variable in the case where this option
    was supplied, so it never did anything, proving once again that unless
    you have a test case, the feature won't work.

commit 36ce0e65f693b21a1557086f10fd49be40da720d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 8 20:21:36 2014 +0100

    v2v: Print virtual and real copying rates.
    
    Useful to diagnose speed issues in the qemu block drivers.

commit 7b8ed81560874a4992c249848dd49a4815b1d79d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 8 20:21:06 2014 +0100

    v2v: Print mountpoint stats in debugging output.
    
    Useful for debugging speed / fstrim issues.

commit 1e9b707e9bbcdba22caa262b33cc79c863c26c34
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 8 15:44:01 2014 +0100

    Version 1.27.60.

commit 6d0f46bacbace13b7c74c092dd7c9356dc4bd41f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 8 15:41:44 2014 +0100

    v2v: Add README.RHEV-M to EXTRA_DIST.
    
    This fixes commit 8adc32cae8898817bfa2ed7669eda1f6c4aa3dae.

commit c4bad9deaf04b4329d0ecb38c007017d6330391c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 8 15:00:25 2014 +0100

    v2v: -o rhev, -o vdsm: Fix export with multiple disks (RHBZ#1150475).
    
    When translating the original virt-v2v code, I misunderstood how image
    directories are created.  There is one directory under images/ per
    disk image, not one for all the disks in a single guest.
    
    Note this requires that -o vdsm uses multiple --vdsm-image-uuid
    options, one per disk image of the guest.
    
    Reported by: Alain Vondra
    Thanks: Tingting Zheng

commit 43e150c212c311aa9dbf535faa756b34bf7f580a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 8 14:59:52 2014 +0100

    mllib: Add 'combine3' function.

commit 8adc32cae8898817bfa2ed7669eda1f6c4aa3dae
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 8 14:39:40 2014 +0100

    v2v: Add notes about layout of Export Storage Domain for multi-disk guests.

commit 2de1602b707ba33676c2d6fdb98a0591aca08b6e
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Oct 8 13:44:25 2014 +0200

    log: tests: switch to a temporary file for outputs
    
    Using a pipe to redirect the output of virt-log will lose his return
    value, so use a temporary file to collect the virt-log output.

commit 371744bc59a25feeafa308b1aa9b9c9c0d2a0099
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 8 12:40:32 2014 +0100

    Revert "log: tests: fix appending the virt-log output"
    
    This reverts commit cfe2daabb2c146c96b1c291a97f08e58cfcdfd2a.
    
    The pipe hides the return code from virt-log or valgrind.

commit 7c97b01f2754ffb76f94b68497eb5829ffa92390
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 8 12:37:51 2014 +0100

    v2v: Add missing disk <rasd:Caption>.
    
    Possible fix for RHBZ#1150475.

commit cfe2daabb2c146c96b1c291a97f08e58cfcdfd2a
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Oct 8 11:14:28 2014 +0200

    log: tests: fix appending the virt-log output
    
    virt-log uses /dev/stdout as output file for guestfs_download, which
    will open the output file in truncate mode, truncating the output of
    test-virt-log.sh.
    
    Make sure to redirect the output of virt-log so it does not clobber the
    test output.
    
    Thanks to Richard for the hint.

commit aa42bcf54d83df326683b5bb9db68003396dfc6e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 7 15:29:12 2014 +0100

    Version 1.27.59.

commit fd421ebf88653455d8547f546e887cf5c5bfb890
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 7 15:29:39 2014 +0100

    p2v: Fix virt-p2v-make-kickstart so it won't fail when using a custom repo.
    
    Because of `set -e', using the `((i++))' expression causes bash to
    fail, unless we tell it to ignore the error code on that line.

commit b81256581b4cea83ebc9f472df1adcd89ac550ce
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 7 15:04:26 2014 +0100

    Update API support.

commit a97b3b6ae4ff2fd5a31e82a2ab35c559e17cf946
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 7 13:54:50 2014 +0100

    Update gnulib to latest upstream.

commit 09384e8164c795fff03a43b69499f782087c5b0a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 7 13:31:47 2014 +0100

    Update translations from Transifex.

commit 6e204f6ccccee1e6ebe27d940760cc7ea746126c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 7 13:31:36 2014 +0100

    Update BUGS.

commit 8ddae163e49a1ac459fbd3d1ff3a2546af9f75a6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 7 13:20:12 2014 +0100

    Update release notes.

commit a48ade569d485a114d29da358e4a2c36429b7ebb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 7 12:40:41 2014 +0100

    v2v: Further documentation fixes.
    
    Replace more instances of 'esx.example.com' with
    'vcenter.example.com', and rearrange command line arguments
    semantically.

commit f796435628cea8b037d5fc786934583019707c6e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 7 10:17:33 2014 +0100

    FAQ: Need to set SUPERMIN_KERNEL_VERSION in recent supermin.

commit 0f023a080b6612ba3ffba53eb557443adca0a88d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 7 09:27:09 2014 +0100

    v2v: Improve VMware import documentation.
    
    Additional information about URIs, which may contain cluster and/or
    folder names (thanks: James Mighion).
    
    Replace esx.example.com with vcenter.example.com to reduce confusion
    about vCenter vs ESXi.

commit c92734b209e4504e84a051e433c81d4d5449d660
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Oct 6 18:05:53 2014 +0200

    log: tests: skip fedora.img if journal is not available

commit cb1b7cbdd5f92ee41ba70915d74dfa845d2365ae
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Oct 6 16:10:44 2014 +0200

    tools: fix free -m invocation
    
    Since procps 3.3.10, free does not output the "-/+ buffers/cache" line
    anymore. On the other hand, the data from it can be calculated from the
    memory values, so just do the calculation manually (with awk).

commit c4bc416820005d6bc4956b32d9c6e0f83382702d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 6 13:09:58 2014 +0100

    lib: Enable detection of ARM (32 bit).
    
    This includes some empty binaries to use for detection testing.

commit 07f87a7c91736a0a2389c3100d7e3ef83ed55a35
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 6 13:09:46 2014 +0100

    lib: Document output of 'file-architecture' API for aarch64 binaries.

commit 56cfb8a9262c508169fd69ea4ca8a8db4b5a5a35
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Oct 3 14:24:48 2014 +0200

    sysprep: remove more logs
    
    - remove firewalld, grubby, and proftpd logs
    - extend the cups log removal also to its timestamped rotated logs
    - remove also the libvirt/libxl logs

commit 0823416925aa10d6f03b7227214df24dd3b2a823
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 2 17:02:21 2014 +0100

    tests: Fix SKIP_ environment variable in a couple of scripts.
    
    I checked and bug 690819 has nothing to do with either of these
    tests.  It was just a copy and paste error.

commit 7ff5d51815cf7f3beb936512dcc5c95c9d36ee1f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 2 15:55:51 2014 +0100

    Version 1.27.58.

commit 432390757522ec9dc575d4cc4a56f35e42ea301f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 2 15:30:02 2014 +0100

    tests: Disable UML tests in 'check-release'.
    
    This effectively demotes UML to unsupported status.  This has happened
    because UML has regressed quite a lot upstream.  There are multiple
    grave bugs revealed by running the test suite and I don't have the
    inclination to fix them.

commit 765dc6237ce7b93dd2f33d99be53eae92e048a7a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 1 20:12:41 2014 +0100

    tests: rsync: Skip this test when the backend is libvirt.
    
    It would work, except if you have a host firewall which will block
    inbound connections on virbr0 to non-standard ports.

commit 07c0926b588db5c86214917b609c2f477c817c0e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 1 20:12:04 2014 +0100

    appliance: Change example ping lines to ping 8.8.8.8.
    
    This are commented out (still) so this change does nothing.

commit 224de20b9a8d5ea56f6337f19b4ca237bb88eca0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 30 16:44:05 2014 +0100

    launch: libvirt: Use qemu-bridge-helper to implement a full network (RHBZ#1148012).
    
    When using the libvirt backend, don't use the SLIRP.  Use
    qemu-bridge-helper via libvirt to give us a full network connection.
    
    One consequence of this is that 'ping' works in
    'virt-builder --run-command'.
    
    A less useful consequence is that the host firewall will prevent
    connections on non-standard ports to the host.  So you can't (eg)
    connect to a rsync daemon on the host listening on an arbitrary port,
    which worked before.
    
    The default bridge is 'virbr0', but you can override this by setting
    LIBGUESTFS_BACKEND_SETTINGS=network_bridge=<some_bridge>
    
    Note: this does not fix virt-rescue (since it overrides the default
    backend and uses 'direct' for various reasons).

commit 67e6f32a240c7c234e6af637c1cd324b36a82cd3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 30 16:44:04 2014 +0100

    appliance: Use dhclient or dhcpcd instead of hard-coding IP address of appliance.
    
    qemu in SLIRP mode offers DHCP services to the appliance.  We don't
    use them, but use a fixed IP address intead.  This changes the
    appliance to get its IP address using DHCP.
    
    Note: This is only used when the network is enabled.  dhclient is
    somewhat slower, but the penalty (a few seconds) is only paid for
    network users.
    
    On SuSE or other distros, dhcpcd could be used if available.

commit 9018a23828b5c65b677a4ab1d21b776c6d225c73
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 2 13:19:03 2014 +0100

    mllib: Coloured messages, errors, warnings.
    
    Uses ANSI terminal codes to colour the output.

commit 25274b4f75196f77c891d8e858644ad0df1ad6f0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 2 13:01:12 2014 +0100

    v2v: Print the difference between our disk size estimate and actual size.

commit ae19e8f29f43db8514c18009e736e643ad9b25f9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 2 13:00:13 2014 +0100

    v2v: 'du -b' doesn't show real (sparse) size.
    
    This caused the actual size to be wrong (in OVF output).
    Use --block-size=1 instead.

commit 62159d5d48441d5df9706c0a19bc0f416b1e9e46
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 1 16:49:57 2014 +0100

    Version 1.27.57.

commit f23759c330fc8f4a6faba83fc2636d0f6dbf453b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 1 13:40:54 2014 +0100

    v2v: Copy post-conversion tasks section from old virt-v2v documentation.
    
    Copied verbatim, apart from some minor reformatting.

commit d0110a4e239a978326b51dd79ca2b9abe30c1cb5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 1 13:36:47 2014 +0100

    v2v: Copy -o rhev information from old virt-v2v manual page.

commit 886c566756d02f8568c20585a0936c387105b061
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 1 12:11:50 2014 +0100

    lib: Avoid rewriting LV names when creating canonical device name (RHBZ#1148355).
    
    Thanks: Timothée Ravier

commit c9c65e08eb595f92168dfd0e284aa8ba5525c1a7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 1 10:07:08 2014 +0100

    v2v: Add note to man page about removing VMware tools before conversion.
    
    Thanks: Matthew Booth.

commit d39744a030d075cdff82f1ca4c80ec40bdcfb699
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Oct 1 10:12:38 2014 +0200

    sysprep: add no-op --no-selinux-relabel (RHBZ#1148072)
    
    Add a no-op --no-selinux-relabel option, to be compatible with
    virt-sysprep < 1.26.

commit 011b5da6f5db32d22d176f3750e3417a6ad9d553
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 30 13:28:31 2014 +0100

    p2v: Fix reference to virt-v2v(1) in manual page.

commit 7357dcd8789be73952ba3a294f1c34eb18ec2e31
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 30 11:27:35 2014 +0100

    resize: Don't test MBR extended partitions while virt-resize handling is broken.
    
    The intention is to fix virt-resize and then revert this commit.

commit 6f196df4145847659b81c91b7314fe7e0775ad94
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 29 14:45:13 2014 +0100

    resize: Rewrite the tests to use a stochastic testing method.
    
    The previous tests were very limited, and ran the same two tests
    on every run.
    
    Randomly test:
     - MBR vs GPT
     - Primary, extended partitions
     - Expanding vs shrinking
     - Use of multiple --resize parameters
     - Source and target raw vs qcow2 formats
     - Resizing various different filesystem types
     - LV expand
     - extra partition or no extra partition
    
    To run the test over and over again (useful for finding regressions in
    virt-resize), do:
    
      while (cd resize; LIBGUESTFS_TRACE=1 ../run ./test-virt-resize.pl) >&/tmp/log ; do echo -n .; done
    
    If it fails, you can see the failure in /tmp/log.
    
    To rerun a specific test, search for the 'seed:' in the output of the
    original test, and specify it on the command line:
    
      (cd resize; ../run ./test-virt-resize.pl --seed=<SEED>)

commit 225257b67a921c9baa46c6d6d99b6c3ffe732290
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Sep 30 13:51:16 2014 +0200

    inspect: document also MINIX as OS
    
    Followup of commit 5b65d05d5a31415aaa6f284f73da745e0ee0408a.

commit 23d4cec345dfd587a07b73cdbfba43516e63a883
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 29 16:06:06 2014 +0100

    Version 1.27.56.

commit 42775561aa6d937bd8b8f1368c47de32bf310670
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 29 16:19:31 2014 +0100

    v2v: Add v2v/HACKING file to EXTRA_DIST.
    
    This updates commit ce814c6b6cdf939c95e70741c84c1757c72edf60.

commit 6495b07cc00ce1e21da2741d112c6d8c17b6271f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 29 14:49:11 2014 +0100

    resize: docs: --expand is above, not below, the current point.

commit a0dad3621f362ecdd2cbd6494243207d3dbd6df9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 29 14:48:41 2014 +0100

    resize: Using qemu-img create -c doesn't create a compressed qcow2 file.
    
    Remove inaccuracy from the manual page.

commit 35daabed8f6da1b6039c4fd32848dcff6347e0dd
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Sep 29 13:49:09 2014 +0200

    customize: fix attributes of /etc/shadow (RHBZ#1146275)
    
    When saving a configuration file, Augeas creates a new file and
    replaces the old one with it; this creates a /etc/shadow file without
    the SELinux xattrs, since they are missing.
    
    Thus, create a temporary file with all the attributes of /etc/shadow, so
    all the attributes of it (permissions and xattrs, among others) can be
    restored properly on the new /etc/shadow.
    
    As side effect, if a guest is already properly SELinux-labelled, then
    there should be no more need to relabel it to make sure /etc/shadow
    still has the right SELinux xattrs.

commit 5f9437ca4bb842b1e8ae91ffbf3c73820780c5a6
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Sep 29 13:48:10 2014 +0200

    builder, customize: disable SELinux
    
    Having SELinux enabled (even if not enforcing) in the appliance causes
    troubles to applications/libraries that read/write SELinux attributes.

commit 49ee9a21333adec00f3f943eaf1712a8ef3273bd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 29 12:07:19 2014 +0100

    resize: Simplify if-conditional in mbr_part_type function.
    
    This should be equivalent to the previous code, but it makes it easier
    for the compiler to pick up errors (eg. missing cases).
    
    This updates commit fc34e2d16c2d13d6ae7a381ba931e345ab5ae56d.

commit fc34e2d16c2d13d6ae7a381ba931e345ab5ae56d
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Fri Sep 26 11:04:07 2014 +0800

    resize: add function mbr_part_type
    
    Function mbr_part_type returns one of "primary", "extended" and
    "logical". The type is used by parted when adding partitions.
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit 80bd9082b5396d1e23751566e8e530fe3b2809cd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 29 12:04:32 2014 +0100

    resize: Fix whitespace in calculate_target_partitions function.
    
    This updates commit 21677c5b46468609d393a724ea629d948c87aec7.

commit 21677c5b46468609d393a724ea629d948c87aec7
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Fri Sep 26 11:04:06 2014 +0800

    resize: add function calculate_target_partitions
    
    And introduce parameter create_surplus to indicate whether to
    create surplus partition or not. Later this parameter will be
    used by when calculating positions for target logical partitions.
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit 5aa7e99cb9bba7eb7ab0d826fe76b29d9b1c9b2e
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Fri Sep 26 11:04:05 2014 +0800

    resize: add function find_partitions
    
    find_partitions can find partitions of given type.
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit cbb54a38493b8ee8b1c7db948f2030f014bfc21e
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Sep 29 11:18:56 2014 +0200

    diff: flatten also atime nanoseconds
    
    When not considering atime changes, flatten also the nanoseconds.
    
    Followup of commit 8664337cc39c8575ccb60abb8c6e30f92828ea51.

commit bdbe2f42aed589ea6319ce872304fe0998e30623
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Sep 28 21:13:34 2014 +0100

    v2v: Document when you need to run virt-v2v as root, and how to avoid it.

commit ca71b7c169dc233d4c4ce670b0fb3badc89abd19
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Sep 28 21:13:12 2014 +0100

    v2v: Use Glance (capitalized) consistently in documentation.

commit 5be7263760461ddb55662020373f39927499ba0a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 27 19:35:13 2014 +0100

    p2v: docs: Change boilerplate in description to reflect reality of hypervisors we support (continued).

commit e5fcb6e5db5b2586f5b69ccaf6fe9b871565415a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 27 21:51:22 2014 +0100

    p2v: Fix documentation for p2v.of kernel command line option.
    
    Copy and paste errors.

commit ae8b283038959d99a64a0268d536357f7c6a4a3b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 27 21:21:57 2014 +0100

    p2v: Revise virt-p2v(1) manual page.

commit b8130786bd1012fc68bcfc16478b923dc511e1c9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 27 19:35:55 2014 +0100

    p2v: Use "panel" consistently through documentation.

commit 4456d64e8fae28e6c8c1e88d4d846e1cdec8484a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 27 19:35:13 2014 +0100

    p2v, v2v: docs: Change boilerplate in description to reflect reality of hypervisors we support.

commit 2ae0e32da655e257d017c27d47fdd33d401842e7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 27 18:39:48 2014 +0100

    p2v: Document the virt-p2v GUI dialogs.

commit c9f2e4e7f152e89ed3b4b19d38151b119d27631d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 27 17:11:51 2014 +0100

    p2v: Rename guest.xml -> physical.xml.

commit ce814c6b6cdf939c95e70741c84c1757c72edf60
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 27 16:49:28 2014 +0100

    p2v, v2v: Document how it works for hackers.

commit 4c1ca9f880a55f1016114c4b4f607b4cedbaa2b1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 26 20:09:44 2014 +0100

    Fix update-bugs.sh script so it doesn't write an empty BUGS file.

commit 5498d021d012522c695ddcaa8ade9cb0ede2a024
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 26 19:30:57 2014 +0100

    v2v: Don't warn about being unable to rewrite /dev/cdrom (RHBZ#1146815).
    
    Old virt-v2v probably emitted the same warning.
    
    However it seems unlikely that /dev/cdrom needs to be remapped, as
    udev or the user should be able to supply a suitable symlink from
    /dev/cdrom to the removable device.  Therefore suppress this warning.

commit b03c2a971ae66e6bfb66090b2860cfee89241f93
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 26 19:26:14 2014 +0100

    v2v: Generate qemu-0.10 compatible qcow2 files for RHEV-M.
    
    RHEV nodes running on RHEL 6 cannot read the new qcow2 compat=1.1
    (a.k.a qcow2 v3) format.
    
    Thanks: Junqin Zhou, Tingting Zheng

commit 159d246b1dc4aae69ea04bbaeebaf3edd1fbcf23
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 26 19:14:57 2014 +0100

    v2v: Add documentation for diagnosing RHEV-M import problems.

commit 7ebab447935a3b4045470eff8bc880d34d584f03
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 26 17:14:19 2014 +0100

    Version 1.27.55.

commit dc6bba83387c460145aa3ea87f1b8f00b59a8334
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 26 14:06:48 2014 +0100

    v2v: -o qemu: Add a display to the shell script.

commit f7cd8b4d1069e4b58b4e4391ef84bddd6a3e2735
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 26 14:06:22 2014 +0100

    v2v: -o qemu: Only add a serial console to Linux guests.
    
    Makes no sense for Windows guests.

commit 630ab4c22afb91c69e1cc3ee0b6dba6f39a47dbe
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 26 14:03:21 2014 +0100

    v2v: -o qemu: Refactor end of line handling.

commit 2365c2dbccd84ff68919dd131624861da293bf44
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 26 14:01:37 2014 +0100

    v2v: Add a source 'window' display type.
    
    This maps to SDL/GTK, ie. qemu opening a window on the desktop.
    We only use it for -i disk -o qemu to help with debugging.

commit ea015319b06acb76a5bd89961b16c2bc82aff74e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 26 12:42:08 2014 +0100

    v2v: Add --no-trim option, allowing fstrim to be suppressed.
    
    Mainly useful for testing whether fstrim is responsible for various
    unexplained boot failures.  We can also suggest it in the field.

commit ad300fcd5e497c401589d54efd9d80334ff41b1b
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Sep 26 14:27:04 2014 +0200

    fuse: test-fuse: use acl_to_any_text
    
    Switch from acl_to_text to acl_to_any_text, so it is possible to specify
    options, like forcing the numeric IDs for users/groups. This ensure the
    resulting string has always numberic IDs, so the comparison can always
    succeed.
    
    Adapt the comparison string to the lack of final endline now.

commit 0db22ee7a70cc51f85b80af180f1d8f55cef5f0c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 26 10:21:07 2014 +0100

    v2v: windows: Sort files before uploading.
    
    This makes it easier to compare the trace output from different runs
    of virt-v2v.

commit 03ef91aa46e036b84a687a7c891720aeea651a17
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 26 10:06:00 2014 +0100

    v2v: Add --debug-overlays option.
    
    You can use this to accelerate testing:
    
      $ virt-v2v --no-copy --debug-overlays [etc]
      [...]
      [  82.0] Converting Windows 7 Ultimate to run on KVM
      This guest has virtio drivers installed.
      [  86.0] Closing the overlay
      [  91.0] Creating output metadata
      Overlay saved as /var/tmp/win7-test-sda.qcow2 [--debug-overlays]
      [  91.0] Finishing off
    
    No disk format conversion/copying is done, so it's very fast.
    
    The overlay file is preserved and can be tested directly (it uses the
    source file as backing).

commit dbff48de392717e36dd040a241d67462fdc68a14
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 26 10:05:30 2014 +0100

    v2v: Don't use Unix.unlink since Unix module is open in this file.
    
    Minor code refactor.

commit 35634e20e73c326d715560dd0e47c893ab16a5fa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 25 17:35:02 2014 +0100

    v2v: Disable extended debugging of hivex_open.
    
    It's not really necessary: we have never needed this for debugging
    inspection for example, and if hive open failures did occur we would
    ask the user to send us the hive files.  And it causes huge amounts of
    debugging messages to be printed which fills up the log.

commit 9a9d10d2a0388f84ace3454c56071c544a3b923f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 25 14:30:37 2014 +0100

    v2v: Put overlay on LIBGUESTFS_CACHEDIR, not /tmp (RHBZ#1146017).
    
    Since the overlay could grow very large (because of copy-on-read) it
    is not suitable for /tmp.

commit 401ee58ae1c47877358819ac0b1fb4f069e1fde6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 24 23:47:40 2014 +0100

    v2v: windows: Print product variant in virtio drivers warning message.
    
    The inspection product variant field is used to determine which
    drivers to install, so print it in case we couldn't find any drivers.

commit df77553f4e9394d17c3c2eae91a6918f2f5105f2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 24 23:44:19 2014 +0100

    v2v: windows: Rearrange the order of virtio drivers match clause.
    
    No functional change.

commit fc56757d39923903dcb662b759c43bcef794cc59
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 24 19:03:42 2014 +0100

    Version 1.27.54.

commit f6e40498a90ac6f082bede202d15d5a8fbb80fa3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 24 18:18:40 2014 +0100

    v2v: windows: Give a better message when Fast Restart is found (RHBZ#1145995).
    
    Thanks: Tingting Zheng

commit 4cc0677da74e847f1112303cbc4413697f7f7345
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 24 18:11:40 2014 +0100

    v2v: Failure to mount the root partition is a hard error.
    
    For other partitions, it is a warning.

commit 0ba0692fda5d866eb3ae57e9aa3c6d95de79c961
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 24 17:51:43 2014 +0100

    v2v: Update list of virtio-win drivers to latest (RHBZ#1145908).
    
    Update with latest list from:
    - virtio-win-1.7.2-1.el7.noarch
    - https://en.wikipedia.org/wiki/List_of_Microsoft_Windows_versions

commit 97b96af54c5fc47bca2ea8f87d179a8b4d9e5242
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 24 17:27:18 2014 +0100

    v2v: windows: Set filename correctly when uploading virtio drivers (RHBZ#1145916).
    
    Thanks: Jeff Forbes, Alain Vondra, Junqin Zhou

commit e1407b36906d978a01c2e3dc19d7b4e1a124cc9f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 24 18:29:27 2014 +0100

    v2v: tests: Don't care about the <model> XML when testing network and bridge mapping.

commit 7806e8667b172775a1a9763c495d68c9531e754a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 24 17:55:27 2014 +0100

    tests: Add drivers directory to phony Windows image.
    
    Allows virt-v2v to upload drivers.

commit 6e9dd6752fab0c8cdc67e7ba9745050093444295
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 23 22:16:24 2014 +0100

    v2v: Remap device in /etc/sysconfig/grub boot= entry.
    
    Old virt-v2v did not remap this device, so after conversion from Xen
    the file would have something like:
    
      boot=/dev/xvda
    
    Although this does not appear to affect anything, better to remap it.

commit 79501d1a55551bd51940844e769f589d76ad75ce
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 23 16:54:26 2014 +0100

    Version 1.27.53.

commit 8e0ae6560e6629f6e435147557f8e0e42ec7986c
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Tue Sep 23 17:20:34 2014 +0800

    syntax-check: fix prohibit_getopt_without_use check
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit 21e2b29e60d48e3a62848ac3c47041f1c4c69be5
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Tue Sep 23 17:20:32 2014 +0800

    syntax-check: fix prohibit_dirent_without_use check
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit 54c95ed332e015f0382fec8575a200631fdedd53
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Tue Sep 23 17:20:31 2014 +0800

    syntax-check: fix prohibit_c_ctype_without_use check
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit dfa9efce4b36f41403051a8ee3e27021188d79b2
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Tue Sep 23 17:20:30 2014 +0800

    syntax-check: fix prohibit_assert_without_use check
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit c9fdfe021cc13a7e3507adc65d23a84ef215e75c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 23 15:42:05 2014 +0100

    v2v: -o rhev: chmod the image so we will definitely be able to write to it.
    
    NFS sucks.

commit 0f4044b58fdc0693ce6db5925992386e3c453f23
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 23 15:36:12 2014 +0100

    v2v: -o rhev: On failure path, use forking wrapper to clean up images dir.
    
    Otherwise you get lots of errors like:
    
    rm: cannot remove ‘/var/tmp/mm/42f5e571-21af-44bd-8164-3ebe6bbc9f5a/images/7b28b0e6-79ce-4d78-a6cb-769760a3d373/31e2b06b-85cb-46ed-aac3-8bcef93dc704.meta’: Permission denied
    rm: cannot remove ‘/var/tmp/mm/42f5e571-21af-44bd-8164-3ebe6bbc9f5a/images/7b28b0e6-79ce-4d78-a6cb-769760a3d373/31e2b06b-85cb-46ed-aac3-8bcef93dc704’: Permission denied
    
    because the code is running as root.

commit 06b04e5676eff7af7d0d667eab2f84288cb28755
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 23 15:28:28 2014 +0100

    v2v: -o rhev: Use a random name when testing UID:GID mapping.
    
    Using a fixed name is risky if there are multiple parallel virt-v2v
    processes running.

commit ebb5de6a1f94086ccc6f21a78afebecc360dcd9d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 23 15:26:03 2014 +0100

    v2v: -o rhev/vdsm: Remove the test that the storage domain is writable.
    
    For '-o rhev' this is likely to fail (although for obscure reasons it
    *doesn't* fail on a real RHEV server, I don't quite understand why).
    The reason is because virt-v2v may be running as root, and with root
    squashing we don't have permissions to write into the storage domain
    directory.
    
    For '-o vdsm', VDSM is supposed to make sure we are running as the
    correct user, so there's no reason to doubt things will work.

commit 44e523d9cb8f357d1c60fa530cc90fa7d89ef6c1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 23 13:49:03 2014 +0100

    valgrind: Add suppression for another libvirt/selinux leak.

commit 02c220a6f189de0d901f16a2f09778c47aeff3ea
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 23 12:47:40 2014 +0100

    v2v: Disable valgrind tests that are confused by -o rhev forking.
    
    This updates commit 0dfa96c043cee4ce82c0a45c3ad09b0a61798b79.

commit d1145f20cbba96dab728b04e50a4cb074193ee89
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 23 12:22:26 2014 +0100

    v2v: Add -o qemu output mode and --qemu-boot flag.
    
    This lets you write a shell script that runs the guest under qemu.
    Specifying the --qemu-boot flag also boots the guest after conversion.

commit 91c1f58e21fd61dcf38e6d30bf4c59d27432f11d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 23 11:52:00 2014 +0100

    v2v: docs: Change examples so -i input comes before -o options.
    
    Make the input/output ordering of command line arguments clearer by
    changing:
    
     virt-v2v -i disk -o local -os /var/tmp disk.img
    
    to:
    
     virt-v2v -i disk disk.img -o local -os /var/tmp

commit 8cb30d1027435c47e2c762dc997897c3b2e2cac2
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Sep 23 15:03:55 2014 +0200

    configure: switch from "java-default-runtime" to "default"
    
    Archlinux switched to "default" as directory for the default JDK
    version.

commit 316c91c140c9994d47fd7950de742afeef162f95
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Sep 23 15:01:53 2014 +0200

    inspect: map Hurd devices, and enable fstab introspection
    
    Add a mapping for the Hurd device names, so it is possible to enable the
    inspection of /etc/fstab.

commit 5b65d05d5a31415aaa6f284f73da745e0ee0408a
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Sep 22 19:48:41 2014 +0200

    inspect: basic Minix support
    
    Add a basic support for identifying Minix, extracting its version and
    hostname.
    
    Related to RHBZ#1144137.

commit 0035a57dd196e99db9e40582df8f1a39af9fa143
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 22 22:41:33 2014 +0100

    Version 1.27.52.

commit 0dfa96c043cee4ce82c0a45c3ad09b0a61798b79
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 22 21:57:57 2014 +0100

    v2v: -o rhev: Write files and directories as user:group 36:36 (RHBZ#1143887).
    
    We need to write files and directories as user:group 36:36, else
    RHEV-M cannot import the VM.  Doing this in the presence of NFS is
    difficult.  See v2v/kvmuid.mli for how it is done in this commit.

commit c9c5353223b09d0010bae503383cd0ed8c07fc43
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 22 22:10:44 2014 +0100

    v2v: Allow the output mode to override disk_create.
    
    Also we allow the output mode to actually create the disk image.  This
    lets the output mode set ownership and permissions correctly if
    required.
    
    The default method just calls Guestfs#disk_create, so there is no
    actual change in this commit.

commit 15556b614d5125cedb55d79a793e027a01e5fe67
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 22 19:31:37 2014 +0100

    v2v: lib_ovf: Change create_meta_files so it doesn't write the files.
    
    Change Lib_ovf.create_meta_files so that instead of writing the
    .meta files, it just returns the content.  Output_rhev and
    Output_vdsm are correspondingly changed so that they write the
    content to the .meta files.
    
    This is just code refactoring, there is no functional change.

commit 6d09ff3600019617ccece59597c4d7d75ef84c4f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 22 18:28:07 2014 +0100

    Version 1.27.51.

commit 7b428603e3a6dc43c48e276b192fda05a4a50a13
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 22 18:25:51 2014 +0100

    v2v: Windows: Uploading viostor driver needs upload method, not copy.
    
    Thanks: Jeff Forbes

commit 1b12c6d46b7315f668da320db93c407a32ee8049
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 22 18:25:26 2014 +0100

    fuse: Remove test-fuse.sh (rewritten script) from EXTRA_DIST.
    
    This fixes commit aca076e2e2b3e03f4cf5b09cf7766925f97e4b68.

commit 1b9b4af7246c98c426801310bc61457c8872a8e9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 22 18:13:34 2014 +0100

    Revert "v2v: -o rhev: Chown the image files and metadata after the upload."
    
    This reverts commit dd58cde929ade2dd6bc216aac21658ed3b3f51aa.

commit 2e3e254e959f97ef967c6d3f89b1952f6282d034
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 22 18:13:22 2014 +0100

    Revert "v2v: -o rhev: Use chown --reference instead of 36.36 (RHBZ#1143887)."
    
    This reverts commit 70444670acc60c5700bcd07ea7440d186eb4b60c.

commit cd86bc510006fce668fe212b35ee19b5c3fdcb68
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Mon Sep 22 15:47:35 2014 +0800

    resize: simplify the code to filter parts
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit cee9a4993d4435b57aa233b7b678a9b7cc5c1d53
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 22 16:44:19 2014 +0100

    v2v: For grub legacy, edit grub config file instead of using grubby (RHBZ#1141145).
    
    The old virt-v2v code would either edit the grub config file (grub
    legacy) or use grubby --set-default (grub2).
    
    When translating this code, I figured we could use grubby in both
    cases, since grubby exists for grub legacy guests.
    
    However it doesn't appear to work for grub legacy guests.  Use the
    configuration file editing method for these, same as old virt-v2v.
    
    Thanks: Tingting Zheng

commit 58eaf258c143c0b8321d8b7cbc9b96e73e82536f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 22 13:57:02 2014 +0100

    fuse: Enable futimens test (RHBZ#1144766).

commit 8664337cc39c8575ccb60abb8c6e30f92828ea51
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 22 10:27:21 2014 +0100

    New APIs: Implement stat calls that return nanosecond timestamps (RHBZ#1144891).
    
    The existing APIs guestfs_stat, guestfs_lstat and guestfs_lstatlist
    return a stat structure that contains atime, mtime and ctime fields
    that store only the timestamp in seconds.
    
    Modern filesystems can store timestamps down to nanosecond
    granularity, and the ordinary glibc stat(2) wrapper will return these
    in "hidden" stat fields:
    
      struct timespec st_atim;            /* Time of last access.  */
      struct timespec st_mtim;            /* Time of last modification.  */
      struct timespec st_ctim;            /* Time of last status change.  */
    
    with the following macros defined for backwards compatibility:
    
      #define st_atime st_atim.tv_sec
      #define st_mtime st_mtim.tv_sec
      #define st_ctime st_ctim.tv_sec
    
    It is not possible to redefine guestfs_stat to return a longer struct
    guestfs_stat with room for the extra nanosecond fields, because that
    would break the ABI of guestfs_lstatlist as it returns an array
    containing consecutive stat structs (not pointers).  Changing the
    return type of guestfs_stat would break API.  Changing the generator
    to support symbol versioning is judged to be too intrusive.
    
    Therefore this adds a new struct (guestfs_statns) and new APIs:
    
      guestfs_statns
      guestfs_lstatns
      guestfs_lstatnslist
    
    which return the new struct (or array of structs in the last case).
    
    The old APIs may of course still be used, forever, but are deprecated
    and shouldn't be used in new programs.
    
    Because virt tools are compiled with -DGUESTFS_WARN_DEPRECATED=1, I
    have updated all the places calling the deprecated functions.  This
    has revealed some areas for improvement: in particular virt-diff and
    virt-ls could be changed to print the nanosecond fields.
    
    FUSE now returns nanoseconds in stat calls where available, fixing
    https://bugzilla.redhat.com/show_bug.cgi?id=1144891
    
    Notes about the implementation:
    
    - guestfs_internal_lstatlist has been removed and replaced by
      guestfs_internal_lstatnslist.  As the former was an internal API no
      one should have been calling it, or indeed can call it unless they
      start defining their own header files.
    
    - guestfs_stat and guestfs_lstat have been changed into library-side
      functions.  They, along with guestfs_lstatlist, are now implemented
      as wrappers around the new functions which just throw away the
      nanosecond fields.

commit aca076e2e2b3e03f4cf5b09cf7766925f97e4b68
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Sep 21 21:40:13 2014 +0100

    fuse: Rewrite test-fuse.sh in C.
    
    This gives us finer control over how system calls are done,
    and also potentially lets us test more.
    
    Currently two tests are disabled:
    
     - utimens because of https://bugzilla.redhat.com/show_bug.cgi?id=1144766
    
     - utimes because our stat call does not return the nanosecond fields

commit 5bb26dcd3c6be56b432c6bdc545968d8722af486
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 20 14:48:17 2014 +0100

    tests/data: Remove abssymlink.
    
    This file causes the test ISO to be rebuilt every time.
    
    Instead of including it as a Makefile dependency, create it just
    before making the ISO, which has the same effect.
    
    A test in fish/ also used this file.  Change it so it doesn't need it.

commit 5fa568f686e802e91b939cb53699c5bf568ee71a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 20 13:10:19 2014 +0100

    tests/guests: Don't calculate checksums of generated images.
    
    Turns out not to be useful, and takes a long time.
    
    This reverts commit 0c605eb94f20cb08e4a858988e0da121af6f66cb.

commit cd9c0fc9a4b0069528b9f157b589acccba931e1e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 20 11:38:39 2014 +0100

    v2v: Move mpstat type definition.
    
    It's only used by the core v2v.ml code, so move it to that file.
    
    This is just code motion.

commit eed49ac8971e1bbf95e089203e14b6fb7c6a731a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 20 10:11:25 2014 +0100

    v2v: Move target actual size computation into core v2v.ml code.
    
    This was only calculated for RHEV, but might benefit other output
    modes in future, and is generic code, so move it into the core code.

commit c1a32f5c11bd3c5b43c700927f40e5f4b1aeabb5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 20 10:13:13 2014 +0100

    v2v: Clarify description of ov_sd field in comment.

commit 0869f579fd4373f9270128cebc9f35777f7022da
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 20 09:03:36 2014 +0100

    aarch64: Add support to file_architecture API.
    
    Add support for aarch64 to the file_architecture API, so we can
    detect aarch64 guests correctly.
    
    Add a test binary and library.  These were generated on an aarch64
    machine by doing:
    
      echo 'main(){}' > bin.c
      gcc bin.c -o bin-aarch64-dynamic
      strip --strip-all bin-aarch64-dynamic
      echo '' > lib.c
      gcc -shared lib.c -o lib-aarch64.so
      strip --strip-all lib-aarch64.so

commit f61832b17aba2b9bf52899cf79b1a602f65a2968
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 20 08:53:38 2014 +0100

    v2v: Remove source.s_arch field and find architecture through inspection.
    
    Previously we required that the source hypervisor knew the
    architecture of the guest, and passed that through to KVM.
    
    However this was error-prone for several reasons:
    
     - OVF (-i ova) doesn't define the architecture
    
     - Disk images (-i disk) don't have an associated architecture
    
     - Libvirt XML sometimes lacks the <type arch=...> field, especially
       for RHEL 5-era libvirt.
    
     - It might not be set correctly for the guest.
    
    We know the real architecture from inspection of the guest, so use
    that instead.

commit 95b7e716ca4aa3e4cc6c33c11c722ad026712413
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 20 08:12:41 2014 +0100

    v2v: Fix typo in comment.

commit a36dde98899ea160a49c9af65a883383496cd331
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Fri Sep 19 18:55:50 2014 +0200

    appliance: Add libsystemd0 (and systemd as an alternative for sysvinit) on Debian-based systems

commit b2a1d4ce45a5a8a2a857de699b407413591ce875
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 19 14:52:16 2014 +0100

    Version 1.27.50.

commit 1e6dd6d2a31e21dc47cad26d0b06370e3894078b
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Fri Sep 19 15:39:13 2014 +0800

    resize: add function expand_partition_content
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit b9063b7c2f0ee94bef46c79d1bc50b018c22c686
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Fri Sep 19 15:39:12 2014 +0800

    resize: add function set_partition_bootable_and_id
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit 51f67a9c81baf746dc9da1774521e53bb14c4853
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Fri Sep 19 15:39:11 2014 +0800

    resize: add function copy_partition
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit 4e6526c0763037e3906ec0d2128ec8873cee2137
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Fri Sep 19 15:39:08 2014 +0800

    resize: add function print_summmary
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit d9f8746ea5a5f22ac71ac494c9d93e59354b4d10
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Fri Sep 19 15:39:04 2014 +0800

    add function div_roundup64
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit b05b9ba8bfb6db4fbb0f7325e8ff326978c46d1e
Author: Hu Tao <hutao@cn.fujitsu.com>
Date:   Fri Sep 19 15:39:03 2014 +0800

    resize: convert sectsize to int64
    
    Because sectsize is used as int64 everywhere.
    
    Signed-off-by: Hu Tao <hutao@cn.fujitsu.com>

commit 816d7cf9413ceb70fba48c069e3d2c39c6b67f49
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 19 13:18:45 2014 +0100

    fish: Restore text to default when exiting (RHBZ#1144201).
    
    The escape sequence \e[0;30m sets the colour to black.  This is fine
    if you use a black-on-white terminal, but fails rather badly if you
    use a white-on-black terminal.
    
    Instead use the escape sequence \e[0m which restores the terminal to
    the defaults, and works in both cases.

commit 4aa38bba2ca77cf0ff7271a8f419182c57f59f7a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 19 12:14:21 2014 +0100

    v2v: Clean the RPM database early on (RHBZ#1143866).
    
    If the RPM database in the source guest is corrupt, then subsequent
    operations will fail randomly.
    
    Old virt-v2v appears to have avoided this by cleaning the RPM database
    very early on.  When translating the code I inadvertantly moved this
    cleanup to a later stage -- in particular, after inspection of kernels
    was done which requires running rpm commands.  Move this back to the
    start.

commit 6db2ff52f9557bc3644700386320dc7a3fa54830
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 19 12:13:41 2014 +0100

    v2v: Move initialization of Augeas after inspection housekeeping.
    
    Just cleanup, it should have no effect on the way that the
    conversion works.

commit 7d9db86cab909a97bd51788b60f7f66dd55d38de
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Sep 19 13:33:21 2014 +0200

    appliance: move e2fsprogs as common for all distros
    
    All distro-specific sections have it, so just make it really common.

commit 70768239fde98eeed3b278aa9bb9ca1003343b5e
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Sep 19 13:26:37 2014 +0200

    appliance: remove duplicate packages in OpenSUSE, Frugalware, Mageia
    
    From some lists of distro-specific packages, remove the ones that
    appear already in the common list.

commit 95729079564edf83128186c4f9d2e6b494928270
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 18 18:08:43 2014 +0100

    Version 1.27.49.

commit c573feb4d1dcae0da85963237ef57312bb02e288
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 18 17:45:12 2014 +0100

    v2v: Print a message if the guest is virtio-capable after conversion.

commit 70444670acc60c5700bcd07ea7440d186eb4b60c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 18 15:07:32 2014 +0100

    v2v: -o rhev: Use chown --reference instead of 36.36 (RHBZ#1143887).
    
    When chowning the final directories, instead of chowning them to 36.36
    (ie. hard-coding those UID/GIDs), use a --reference chown so it should
    take the ownership from the parent directory.
    
    Unfortunately chowning is very complex because of:
    
     - NFSv3 vs NFSv4
    
     - root squash
    
     - idmap
    
    which creates approximately 8 different ways for this to fail.

commit 035f47cdde4052e77613c77d2e5e0f24dbab082f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 18 14:43:12 2014 +0100

    v2v: Fix code for editing grub2 console=... parameter (RHBZ#1143883).
    
    When presented with a RHEL 7 guest, virt-v2v would print the following
    warning message:
    
      virt-v2v: warning: could not update grub2 console: aug_get: no matching
      node (ignored)
    
    This happened because on RHEL 7, /etc/sysconfig/grub is a symlink to
    /etc/default/grub, and the Augeas grub2 lens returns entries under
    /files/etc/default/grub/*, but the code was checking for
    /files/etc/sysconfig/grub/*.
    
    The fix is to check all the possible Augeas paths until one matches.
    (Only the first match gets updated however).
    
    Also, don't rebuild the grub2 config unless we've actually changed it.
    This avoids doing a potentially failure-prone operation when it's not
    necessary.
    
    I suspect that the old virt-v2v code did not work correctly for RHEL 7
    guests, but old virt-v2v didn't print a warning here, it just failed
    to update silently.

commit e5dd3b08de331b14aee4f86eef373e3c900d8b61
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 18 13:56:58 2014 +0100

    customize: Make usage of --password-crypto option clearer (RHBZ#1143949).

commit c68b510be2c58b729143b5940be6dfbb56a94182
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 18 13:35:03 2014 +0100

    Update release notes.

commit 32736857b3590554c4707cfe33eebed0ccc04abe
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 17 21:34:10 2014 +0100

    v2v: Document the input: output: and convert: features in --machine-readable output.

commit 3562a816832d525b5948b41780bff05aa8dec027
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 15 18:44:51 2014 +0100

    generator: Change type of 'tests' to 'c_api_tests'.
    
    Just a code refactoring, has no functional effect.

commit e85a976c5a474d751c6e8352370047a3177a7c45
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 15 15:17:47 2014 +0100

    tests: Don't use relative paths to binaries in tests.
    
    All tests run under the ./run binary.  For a long time the ./run
    binary has set the $PATH environment variable to contain all of the
    directories with binaries in them.
    
    Therefore there is no reason to use ../fish/guestfish instead of just
    plain guestfish (and the same applies to other built binaries).

commit bced8f52897d3e588e88cde3774e1e3666492db4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 17 16:33:55 2014 +0100

    FAQ: Note that update-guestfs-appliance is not needed with libguestfs >= 1.26.

commit 58a285b5b3d60508779d83f5ffa1de349c4baa78
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 17 15:51:30 2014 +0100

    Version 1.27.48.

commit 0fabe1a2ed82ff1df9feda459ae139bcca5a3338
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 17 15:36:15 2014 +0100

    daemon: parted: Fix error message when part-get-name is called on non-GPT (RHBZ#1142416).
    
    The error message was bogus, fix it.
    
    This fixes commit 0316d247706aab7ce7c2225472feeb51fa8b1664.
    
    Found by: Lingfei Kong

commit 5fcc584c344e7894e2da15071050b6eb5f882f55
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 17 15:34:03 2014 +0100

    daemon: parted: Don't crash if part-get-name called on non-partitioned device (RHBZ#1142158).
    
    If do_part_get_parttype returns NULL, then return from the function
    instead of dereferencing the NULL pointer and crashing.  Note that
    do_part_get_parttype has already called reply_with_error in this case.
    
    This fixes commit 0316d247706aab7ce7c2225472feeb51fa8b1664.
    
    Found by: Lingfei Kong

commit 071051073292df15a19259bedc95cedf9a76b1f5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 17 15:13:33 2014 +0100

    v2v: Reconfigure /etc/modprobe.conf (RHBZ#1141145).
    
    More code that was omitted during the translation of old virt-v2v.

commit f982ce27032371c43e167609e0631bc792382da7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 17 15:13:21 2014 +0100

    v2v: Rebuild initrd last.
    
    Old virt-v2v rebuilt the initrd late.  Currently we rebuild the initrd
    right after choosing a kernel, but it's best to update the initrd
    at the end since mkinitrd may depend on other configuration files
    that we are changing (especially see next commit).

commit 5fed8dfae114367c347af170dcef0b5d6183f8c0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 17 13:59:39 2014 +0100

    v2v: -o rhev: Don't quote 'root' in error message.

commit dd58cde929ade2dd6bc216aac21658ed3b3f51aa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 17 13:40:10 2014 +0100

    v2v: -o rhev: Chown the image files and metadata after the upload.

commit d5001304e4952450851ab429416c96cc4c8e2331
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 17 12:56:53 2014 +0100

    v2v: Fix OVF VmType field, which should be 0 or 1 (RHBZ#1142008).
    
    Thanks: Shahar Havivi.

commit 05f665166c05519b8b5d4cd26fbe5e912cc63ba8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 17 12:55:06 2014 +0100

    v2v: Fix capitalization of ovf:volume-type (RHBZ#1142008).
    
    Thanks: Shahar Havivi.

commit fe36b2ce950d214aa198daf86188e8fdbe41f43f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 17 12:49:00 2014 +0100

    v2v: -o rhev/vdsm: Fix ovf:size and ovf:actual_size fields (RHBZ#1142008).
    
    These are integers in gigabytes (2^30).
    
    Thanks: Shahar Havivi.

commit 7739a6d3570efa2fee32b7210de40c73eca5b988
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 17 12:13:42 2014 +0100

    v2v: If virtio is enabled, map device names to vd* (RHBZ#1142004).
    
    The old virt-v2v code had:
    
        my $prefix;
        if ($virtio) {
            $prefix = 'vd';
        } elsif ($libata) {
            $prefix = 'sd';
        } else {
            $prefix = 'hd'
        }
    
    The translated code dropped the test for virtio by accident, which
    meant that device names would be mapped to sd* or hd* even if the
    virtio-blk driver was enabled for the guest.
    
    Thanks: Tingting Zheng

commit 4178bdc9b4c94e44f5b8520d6dbeeda92a6ae0cd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 17 11:51:54 2014 +0100

    sysprep: Clarify the documentation for 'flag-reconfiguration'.
    
    It was quite obscure what this actually did.  Make it clear
    in the documentation.

commit f722571c73d427530a357b7a864a5432cc7db461
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 16 16:46:34 2014 +0100

    sysprep: Clarify when --mount-options is used and what it does (RHBZ#1142186).

commit 9aeaace779e7ce9718208367f5079b4667f8468b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 16 16:43:28 2014 +0100

    Version 1.27.47.

commit 01b25d7fc6ea1dee80d104118436980b7d504af0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 16 16:20:15 2014 +0100

    v2v: Add xvda -> sda etc mappings (RHBZ#1142004).
    
    For Xen guests, a device can be presented twice as (eg) xvda and sda,
    and therefore we should map any otherwise unmapped xvdX.
    
    For non-Xen guests, this should have no effect.

commit d86016da8e5d9afd01c75067198aecad15d402c9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 16 15:49:34 2014 +0100

    v2v: Fix for 'grubby: bad argument --set-kernel: unknown option' (RHBZ#1141145).
    
    I made a mistake while translating the Perl conversion code and
    transcribed --set-default as --set-kernel.  grubby has no --set-kernel
    option so it failed.
    
    Thanks: Tingting Zheng

commit a7147ce9ffa93cd1cc0c9b568fe00cc81071a777
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 15 15:36:23 2014 +0100

    run: Add p2v to the PATH.

commit 8856fadadb4f10b89f13068d01d40643e31c488d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 16 08:36:38 2014 +0100

    v2v: Prevent conversion of "blocked" and "paused" domains also.
    
    Previously only "running" domains were blocked from conversion.
    However "blocked" is essentially the same as running (on Xen it just
    means the domain is running but waiting on an I/O resource).  And
    "paused" domains probably shouldn't be converted either since their
    disks are only crash-consistent.

commit 77b371b18b6a7ad37105a595931514f542a04396
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 15 11:31:55 2014 +0100

    v2v: Clarify the missing input format error message (RHBZ#1141723).

commit 21c6c70378b0a48528911bd93ce7b528c809805f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 15 11:03:35 2014 +0100

    Version 1.27.46.

commit 1dd485e500a2ee810802e2f6421dde104b2116ab
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 15 10:17:01 2014 +0100

    v2v: Allow pool UUID to be used in -os parameter (RHBZ#1141631).
    
    Thanks: Zhou Junqin.

commit 47251a3599b1477d7c3749912b404c756e613be6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 15 10:15:10 2014 +0100

    v2v: Allow domain UUID to be used in place of libvirt guest name (RHBZ#1141680).
    
    Thanks: Zhou Junqin.

commit a417287e0abe09f00bd9160f5b4336d493d0924c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 15 10:13:09 2014 +0100

    v2v: domainxml: Rework libvirt error handling.
    
    Don't rely on libvirt's implicit print-to-stderr.  Instead make sure
    that libvirt error messages are raised in the exception message.
    
    Also allow error strings to be translated.

commit be1385d2cbf198606c1d11c0302de6b11176d785
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 15 09:46:30 2014 +0100

    Revert "v2v: -i libvirtxml: Give an error if local disks are not readable (RHBZ#1140946)."
    
    This commit breaks remote disks.  See:
    https://bugzilla.redhat.com/show_bug.cgi?id=1141654
    
    This reverts commit 73c1f1cf7e1c4aa4e70407feff49ba847f7ebb63.

commit 7039d0e7f661e04ddec79eb8faabc50da5096451
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Sun Sep 14 21:21:25 2014 +0200

    Generate *.cmx targets only if a native OCaml compiler exists

commit 50d5d4b723295b35772b64650f4a96f43f7cc9fc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Sep 14 19:03:28 2014 +0100

    v2v: Add stringMap.mli (interface).
    
    Hopefully this should fix the incorrect build problem.  See discussion
    here:
    
    https://www.redhat.com/archives/libguestfs/2014-September/msg00071.html
    
    The interface was generated using 'ocamlc -i'.

commit a18c2aca14e451d54110c44ece4eeed536b3ece2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Sep 14 18:46:49 2014 +0100

    Revert "Use ocamldep -all option."
    
    This reverts commit a3881445efd04d5fe6da29db8b2d62a30088b9d1.
    
    See discussion on the mailing list:
    
    https://www.redhat.com/archives/libguestfs/2014-September/msg00069.html

commit 48604913db4095ab8f6ecc80d9f92b5a04a5285c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Sep 14 14:02:12 2014 +0100

    Version 1.27.45.

commit 4515413217c7d4a6fe026254bffa6f82746047c4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 19 13:54:50 2012 +0000

    daemon: Run udev_settle after pwrite-device finishes (RHBZ#1141451).
    
    When you call close on any block device, udev kicks off a rule which
    runs blkid to reexamine the device.  We need to wait for this rule to
    finish running since it holds the device open and can cause other
    operations to fail, notably mkfs.
    
    (cherry picked from commit a9c8123c72db47bcab8dd738e8d5256a9ae87f11)

commit 974c4cd015e82b9b2013b27bdbcd51406a997136
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Sep 14 12:22:11 2014 +0100

    appliance: Add comment with udev debugging option.

commit 88dea548031db0eaccc08b63c4ee1e3644cd0e83
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 13 16:44:47 2014 +0100

    v2v: -o rhev/vdsm: In --no-copy case, use estimate for ovf:actual_size (RHBZ#1140156).

commit 3e2f89a74fcc75a0f6b10945d2d4b0273cc21b03
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 13 16:44:17 2014 +0100

    v2v: Fix variable name usage_mb -> usage_gb.
    
    It's actually storing usage in gigabytes, not megabytes.

commit 5a620137bf48251c3deab93492e8b7156eb9e282
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 13 16:18:16 2014 +0100

    v2v: Estimate the amount of space required on the target.
    
    Estimate the amount of space required on the target by each source
    disk after conversion.  The estimate is approximately a ceiling on
    this, and actual use should be considerably lower.
    
    Provide an extra output method (#check_target_free_space) which output
    modules may use to check that there is sufficient free space to
    proceed, before conversion starts.  None of the output modules
    actually implement this at the moment.

commit f084fec3817a8f53c16056d50dd080a62d000af6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 13 14:54:39 2014 +0100

    v2v: Introduce Types.mpstats struct storing mountpoint statistics.
    
    This is just code refactoring.

commit b7bdb63d8967762a5b234049c4dda911150cc199
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 13 09:45:59 2014 +0100

    tools: Check for dangling --format parameters (RHBZ#1140894).
    
    In most C tools, virt-sysprep and virt-customize, you have to put the
    --format parameter before the corresponding -a parameter.  ie.  The
    following is correct:
    
      guestfish --format qcow2 -a disk1 -a disk2
    
    But the following is incorrect.  The --format parameter is dangling
    and prior to this commit would have been silently ignored:
    
      guestfish -a disk1 -a disk2 --format qcow2
    
    After this change, dangling --format parameters now lead to an error:
    
      guestfish: --format parameter must appear before -a parameter
    
    In virt-customize, also check that --attach-format parameter appears
    before --attach parameter.
    
    Thanks: Lingfei Kong

commit 7845bcc20f66eaa1f0e1df85f9f0dbe9da6037e6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 12 22:44:07 2014 +0100

    Version 1.27.44.

commit 764cbd5f695c6acbc39bd0b2b70746bfc9131e98
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 12 22:29:49 2014 +0100

    sysprep: Use 'error' function consistently throughout the program.

commit f1390d3d7a68580fcdceba7ffb26cb7d242d1505
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 12 22:19:42 2014 +0100

    sysprep: Ensure error handler surrounds all the code so we catch and print all errors.

commit 7bd7dabbd71583737e8d48536bb742be03988102
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 12 22:06:06 2014 +0100

    v2v: esx: Clarify that username can be specified in vpx:// URI (RHBZ#1141113).
    
    If there is an authentication error when getting the session cookie,
    emphasize in the error message that the username can be specified in
    the URI.
    
    Unfortunately libvirt asks for the username previously, but we cannot
    access that.

commit 7836aa523bbcd223e3ebb23b3d174197b614b30f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 12 20:06:49 2014 +0100

    v2v: Add -o null mode.
    
    In theory this discards the output.  Unfortunately in practice we have
    to write the output to a temporary file and delete it (because of
    limitations in qemu-img convert).

commit 73c1f1cf7e1c4aa4e70407feff49ba847f7ebb63
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 12 19:37:03 2014 +0100

    v2v: -i libvirtxml: Give an error if local disks are not readable (RHBZ#1140946).

commit 3729bc1fe1726abda7576fdd6243a47ac96de5fe
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 12 16:39:55 2014 +0100

    sysprep: Check --{keep,remove}-user-accounts parameters are not used when operation is disabled (RHBZ#1141157).
    
    You will see an error like this:
    
    $ virt-sysprep --remove-user-accounts foo,bar -a /dev/null
    virt-sysprep: error: user-accounts: --remove-user-accounts parameter was
    used, but the "user-account" operation is not enabled

commit 5066fde8f25fbcfa75bfa0c8e94b1b15eed3899a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 12 16:34:58 2014 +0100

    sysprep: Add an optional method for checking if unused arguments were passed to disabled operations.

commit 0513a91d2edd5089cd2db151b0605d6649c8a1bf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 12 16:21:11 2014 +0100

    sysprep: Replace --user-accounts option with --{remove,keep}-user-accounts.
    
    The --user-accounts option, with its double-negative '-' prefix on
    user names, is confusing.  Replace it with '--remove-user-accounts'
    and '--keep-user-accounts' options.
    
    This updates commit 128d474095bfabc2d724d0181155e364f1afbabf.

commit e1ed66e2b1c6b94bdfe10616667fdbc299ecb800
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 12 15:47:07 2014 +0100

    v2v: If non-Xen and Xen initrds match a kernel, take shortest name (RHBZ#1141145).
    
    Thanks: Tingting Zheng.

commit 44907763a6ee739f9fdd3b0a0e4b3d83ae4148d5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 12 12:41:26 2014 +0100

    v2v: Fix --help documentation of -o glance option.
    
    Thanks: Junqin Zhou

commit 8f1ce3a72f5d05fe7b80904ab51803a2e137aebb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 11 19:38:10 2014 +0100

    Version 1.27.43.

commit b67da2524fd8a95e217db8ef764ad1ca34b91a82
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 11 16:55:15 2014 +0100

    v2v: Split off -o vdsm mode from -o rhev (RHBZ#1140156).
    
    -o rhev: This is "traditional" output to a RHEV-M Export Storage Domain.
    It requires no cooperation from RHEV itself, and in all other respects
    works the same way as old virt-v2v did.
    
    -o vdsm: This is the new mode which requires VDSM cooperation.  VDSM
    manages the conversion, creating the directories, suggesting UUIDs,
    and cleaning up on failure.  This allows direct import into a Data
    Domain.
    
    The --rhev* command arguments now only apply to -o vdsm, and therefore
    have been renamed to --vdsm*
    
    The --vmtype command line argument may be used with -o rhev or -o vdsm.

commit 4c25f48bbad353ac6b0cc32f4174d2b4923d1f28
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 11 16:21:16 2014 +0100

    v2v: Move some utility functions into Lib_ovf module.
    
    This is just code refactoring and has no functional effect.

commit 694dc695b8ea79f78cdd73739512bfc229d7129e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 11 16:14:51 2014 +0100

    v2v: Remove unused struct (Types.output_rhev_params).

commit 04206fb3c036ae676fa6c50af26f40fa74cdd24a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 11 16:14:06 2014 +0100

    v2v: Rename module Output_RHEV to Output_rhev.
    
    This is just code refactoring, and has no functional change to the
    program.

commit de3614e0ff67f5a85625946f35af296080cbb6b8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 11 10:11:09 2014 +0100

    builder: Fix documentation of --list --list-format option (RHBZ#1140547).
    
    Also give an error if users use the incorrect one:
    
    $ virt-builder --list --format json
    virt-builder: virt-builder --list: use '--list-format', not '--format'.

commit b047feafa99a6b63b1caa1023db60eca7138c14a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 10 22:31:06 2014 +0100

    Update BUGS file.

commit 4fb3009a42b06f7b716b215de962343c05fd3cd4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 10 22:11:01 2014 +0100

    Version 1.27.42.

commit c862dc3d2018550146b02740c4f0737cd715f207
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Sep 10 11:39:55 2014 +0200

    fish: fix small memory leak in completion
    
    Do not leak the small memory buffer with the path.

commit 55f70c13e3064cc1132deaf5dadcd53387d0987e
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Sep 10 11:16:23 2014 +0200

    resize: print FSes which cannot be expanded
    
    Should ease a bit the discovery of a filesystem which cannot be
    expanded.

commit a67845bfa0f5ca5242ea6a965fe73169de830fbc
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Sep 10 11:01:34 2014 +0200

    test-charset-fidelity: set iocharset in vfat/msdos FSes
    
    The default charset for these filesystems depends on how the kernel was
    configured with, so explicitly set the default one (as specified in
    Linux sources), eventually setting later a new one for the tests.

commit c49d35a919284f54a8e98a8a17c2543e7973b583
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 10 17:01:10 2014 +0100

    v2v: Clearer error message if ssh-agent authentication is not set up (RHBZ#1139973).

commit 516faa1bcb64a95b25ec7f3b2be0d2d1f6c0c60d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 10 16:29:28 2014 +0100

    v2v: Fall back to virDomainGetInfo if remote libvirtd does not support virDomainGetState (RHBZ#1138586).
    
    RHEL 5 Xen doesn't support the relatively new virDomainGetState API.
    Instead you will see a warning message on stderr:
    
      libvirt: Remote Driver error : unknown procedure: 212
    
    If we detect that virDomainGetState is not supported, then fall back
    to calling virDomainGetInfo instead, which works everywhere.
    
    This updates commit 096c05a750b8b525e48149c0c6522769c92ab07c.
    
    See also:
    https://bugzilla.redhat.com/show_bug.cgi?id=1139973#c2
    https://bugzilla.redhat.com/show_bug.cgi?id=1138586

commit b6099f4aee3e14a04f6b8c8d62246d337f2a1582
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 10 11:20:56 2014 +0100

    v2v: Report error when multiple conflicting command line options are used (RHBZ#1140050).
    
    $ virt-v2v -i disk -i libvirt
    virt-v2v: error: -i option used more than once on the command line

commit a6279f5c7b4a7794eec32c650590790251aeb220
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 10 00:03:20 2014 +0100

    v2v: List convert modules in --machine-readable output.
    
    $ virt-v2v --machine-readable
    [...]
    convert:enterprise-linux
    convert:windows

commit 3d2e2bb44556a218ad4cc4d4d4e6b90cd43d60cf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 9 23:58:17 2014 +0100

    v2v: Abstract Convert_* modules from core v2v code.
    
    Previously the core virt-v2v code had to know which Convert_* module
    to call for each guest type (based on inspection).  After this change
    the core code doesn't need to know that, but instead Convert_* modules
    register their interest in particular guest types.

commit 102e9a8c057bb2670ed430feb5de082bd1a97d7a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 9 23:27:51 2014 +0100

    sysprep: Don't use --option=arg in documentation.
    
    Fedora patches OCaml's Arg module to support --option=arg.  Since this
    won't work on other distros or upstream OCaml, don't include such
    examples in the documentation.

commit c22d86870c9099935c8b92471ba4eb711c0b7018
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 9 23:08:24 2014 +0100

    v2v: Allow -o local as an alias for -o disk.
    
    This is symmetrical with -i disk / -i local.

commit 49fa6912ed16d6946da2a603fdb1fc24fdee530b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 9 23:06:54 2014 +0100

    v2v: Sort the -i options alphabetically in the man page.

commit 68e58e5814e74dc3ea8bf930b98eedf421ac5309
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 9 23:02:21 2014 +0100

    v2v: Update documentation credits.
    
    Shahar Havivi and Tingting Zheng for development & testing respectively.

commit 334dee64a2c90c4c57de33fd78ffc529f49ebb35
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 9 20:27:33 2014 +0100

    FAQ: Repeat advice to use ./run.
    
    The two adjacent sections can be read separately, and the second
    section doesn't mention not using make install / using ./run, so
    repeat it a second time.

commit 163eb3b7a1921fe675f5a85d5dc28692d5e03bda
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 9 17:04:47 2014 +0100

    resize: Support for expanding XFS filesystems.

commit aebe00e5c6f3087370fe86873cb715f32dc8233b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 9 16:02:44 2014 +0100

    Version 1.27.41.

commit a2107981a621168603dd91ad9f9f2c9948be0f3e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 9 14:20:43 2014 +0100

    daemon: Run 'udevadm settle' with debugging and warn if the command fails.

commit 6b379ab598a3885352d39bf5c084b3abb029abac
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 9 15:42:05 2014 +0100

    Version 1.27.40.

commit 59136518f13cb489cc17a411267d54444d7c8ac6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 9 15:04:24 2014 +0100

    v2v: Calculate dracut/mkinitrd kernel version correctly (RHBZ#1138182).
    
    Thanks: Tingting Zheng.

commit e89ab6dde47d8a54d7be42ea88c7dca84e335a0e
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Sep 9 15:10:33 2014 +0200

    tests: sysprep: slightly improve output
    
    Add minor spacing changes, and report the image being sysprep'ed, so it
    is easier to spot which image caused some warning message.

commit be1c6965006dec258b915c9561ac66c8cb36dfe6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 9 10:46:55 2014 +0100

    v2v: Check if there is sufficient free space for conversion (RHBZ#1139543).
    
    Before trying to perform the conversion, estimate if there is
    sufficient free space on the guest filesystem(s) for the conversion to
    be successful.
    
    If not, you will see an error similar to this one:
    
    [   6.0] Checking for sufficient free disk space in the guest
    virt-v2v: error: not enough free space for conversion on filesystem '/'.
    4354048 bytes free < 20000000 bytes needed

commit 4fc333d0eff19e82b6f41957af091ecf4806670e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 8 13:13:01 2014 +0100

    p2v: Use matchbox (window manager) in the virt-p2v ISO.
    
    virt-p2v can run without a window manager.  However it then sits in
    the top left corner of the screen.  Add a lightweight window manager
    to the ISO so that position and geometry hints work.

commit e52ec0a3dfb504e71db105405746dc2f36e07444
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 8 11:07:03 2014 +0100

    p2v: Whitespace change in options list.

commit a12745a48196c2de9fa67e7974c40be63491b0d5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 6 20:06:50 2014 +0100

    Version 1.27.39.

commit 0866d2238138ffd14ec2cadd75332adf549a3035
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 6 10:05:18 2014 +0100

    p2v: Add scripts to make disk or kickstart-based P2V ISO.
    
    Two scripts are added, replacing the make targets from the
    previous commit:
    
    virt-p2v-make-disk: Builds a virt-p2v disk or USB key using
    virt-builder.
    
    virt-p2v-make-kickstart: Builds a kickstart file (only) which can be
    fed to livecd-creator or similar tools on Red Hat-derived distros.
    
    Kickstart generation is slightly different: Instead of requiring the
    downstream 'libguestfs-pvhelper' package, the kickstart now embeds the
    virt-p2v binary(!) making it self-contained and downstream packaging
    simpler.
    
    In addition there are documentation changes.

commit 8e6478dc7d9f4bcfc76182f556dbcea457ecc110
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 6 09:41:15 2014 +0100

    p2v: Remove p2v-iso directory.
    
    As part of reworking the scripts that are used to build the P2V ISO,
    first remove the separate p2v-iso directory.  Similar scripts and
    documentation will be introduced back into the p2v/ directory in
    following commits.

commit e1ee037096a212beca8654a9f277be564066d9b1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 6 19:49:16 2014 +0100

    p2v: Temporarily remove Configure Network button.
    
    We will ship 1.28 without the capability of configuring the network
    (ie. DHCP will always be used).

commit a743f57cb8e74adaccae3a6f3b3da0c6961dc5ba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 6 19:47:15 2014 +0100

    p2v: Ensure the current version of virt-p2v is always displayed.
    
    This will help with debugging customer problems.

commit d7edde6b6dffb61dfd75edc1483eb6ed8ab56e2d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 6 13:49:13 2014 +0100

    p2v: Success message should have info logo, not error logo.

commit d82cf08ce12ffd86e9f1588881dbe3f0ffd12294
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 5 20:05:40 2014 +0100

    daemon: Check return value of end_stringsbuf.
    
    Found by Coverity.

commit 255ec57875221b9d7c620de4ddf038ac97743514
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 5 15:12:53 2014 +0100

    Version 1.27.38.

commit d85c38155a5c36ce9fc53a5318ab452921c0915d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 5 15:18:54 2014 +0100

    appliance: Add guestfs_shadow.aug to EXTRA_DIST.
    
    Fixes commit 61917136f5ad5efe30502f46f1adf60c20f15c97.

commit 553677398b8bfba60b3870a53d2f5174bac82147
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Sep 4 16:16:06 2014 +0200

    customize: use augeas to change passwords
    
    Make use of augeas to load and edit /etc/shadow, now that we have
    (either from upstream or by ourselves) a lens handling it.

commit a0cf4b3407ea86276633ca36389d0ec964e7d0d5
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Sep 4 16:14:42 2014 +0200

    sysprep: remove comment and notes about /etc/shadow lens
    
    We are either using the upstream lens, or our copy of it, to handle
    /etc/shadow, so now removing entries from it works.

commit 61917136f5ad5efe30502f46f1adf60c20f15c97
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Sep 4 15:27:37 2014 +0200

    appliance: daemon: import and use upstream shadow lens
    
    Import the upstream lens for the shadow file, just with a different
    identifier and not matching /etc/shadow by default. Instead, apply a
    transformation to have it match /etc/shadow only if the version of
    augeas is at least 1.2.1 [1].
    
    [1] While the last upstream version is 1.2.0, all the development seems
    to happen in master, so whatever the next version is going to be
    numbered (e.g. 1.2.1 or 1.3.0), the check will be fine anyway.

commit d01fbe86662860b3e7fef8b76a8ba9579669c8af
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Sep 5 14:47:22 2014 +0200

    daemon: add a way to check for the version of augeas
    
    Query augeas for its version when required, i.e. only once when using
    the new augeas_is_version function.

commit 54e32eb8e2e10369de4df0ab4481d1fbcf7ecfb9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 5 14:44:48 2014 +0100

    v2v: -i libvirt, -i libvirtxml: Print libvirt XML when debugging.

commit 35d49cd9de8f07ae281b276bad852ad33875a9b8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 5 14:13:28 2014 +0100

    v2v: When locating initramfs, ignore kdump initramfs images (RHBZ#1138184).
    
    Thanks: Tingting Zheng.

commit 096c05a750b8b525e48149c0c6522769c92ab07c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 5 13:36:01 2014 +0100

    v2v: -i libvirt: Check the domain is not running (RHBZ#1138586).
    
    It will print an error like this:
    
      virt-v2v: error: internal error: invalid argument: libvirt domain 'windows'
      is running, it must be shut down in order to perform virt-v2v conversion
    
    This only works for libvirt domains, and is explicitly disabled for
    test:/// URIs since these domains are always "running", but we use
    these URIs for testing.

commit de93b9060d88a3cda71eb1840d04c49fc94b404f
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Sep 3 17:38:32 2014 +0200

    daemon: make aug_close cleanup available for all
    
    Just code motion, no behaviour changes.

commit a935db30e5f27ab3f355ad77cabba01a82c53186
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Sep 5 11:29:57 2014 +0200

    v2v: R_OK is in Unix module

commit 922da70651a81c24f0fefc9f3885e1cda3250b5a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 5 09:54:32 2014 +0100

    v2v: -i disk: Add a clearer error message if the disk doesn't exist or is not readable.

commit d12f1ee99c42fe800567d82a5e99f1f31dd6760d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 5 09:49:39 2014 +0100

    v2v: -i disk: Don't fail if filename has no extension.
    
    Unhelpfully, Filename.chop_extension throws an exception if the
    filename has no extension (instead of just returning the filename).
    Therefore the -i disk option would fail if you passed any filename
    that didn't have an extension.

commit 54995514cb62b4adc066d178eabb7fded4b16196
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 4 15:21:17 2014 +0100

    Update gnulib to latest.

commit 0fc7cbe99b59484ac285da8825e4f351ca019d6d
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Sep 4 16:52:36 2014 +0200

    v2v: skip test-v2v-i-ova.sh if rhsrvany.exe is not installed

commit 03c9834cf3de504c9e2724894e7d9c222fd5e116
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 4 14:58:04 2014 +0100

    Version 1.27.37.

commit c3b3f683973813c008b5175726b68caa7fc6d4e8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 4 14:57:35 2014 +0100

    v2v: Add test OVF file to EXTRA_DIST.
    
    This fixes commit 90b1e9845fa0a25de12587749f259d0da8d70a01.

commit ba65af34357eb79e37480758416cdc4e184689aa
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Sep 4 13:42:20 2014 +0200

    customize: fix locking accounts with passwords
    
    When setting the password for a locked account, make sure to still write
    the password after the "!!" marker, otherwise the account will have no
    password.

commit 5edb78d1ae916e7d76be2ba0c4b86b3f82e8f9e1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 4 12:55:40 2014 +0100

    v2v: docs: Clarify how ESX & Xen imports happen through libvirt.

commit f243418d2300bf2bb7fdb64045544f6420ba90a3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 4 11:32:33 2014 +0100

    v2v: Add support for access to remote RHEL 5 Xen hosts over ssh.

commit 0c295c8e23a90d3a3f5efcfa0452ecde7317e122
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 4 12:37:12 2014 +0100

    v2v: -i libvirtxml: Detect disk format using any <driver type=...> field.
    
    Previously we only looked for <driver name=qemu type=...>.  However
    for Xen imports, the name field could be name=tap (or other values in
    fact).  Since there can only be one <driver/> element under <disk/>,
    look for any <driver type=...> in order to get the disk format.
    
    A further complication for Xen is that type=aio means "raw" (for
    obscure historical reasons), so map that.
    
    Thanks: Dan Berrangé.

commit 27a5ef9131317e4a715d1dfb62b155ee081c2888
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 4 12:07:36 2014 +0100

    v2v: Move json-generating code into separate module.
    
    Just code motion so we can reuse the same code for making
    `json:' remote SSH URLs.

commit d5662fe035be28f59e1f4ea9f3fd391aa93a591e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 4 11:19:24 2014 +0100

    -i ova: Tidy up the description in the manual page.
    
    This updates commit 90b1e9845fa0a25de12587749f259d0da8d70a01.

commit 90b1e9845fa0a25de12587749f259d0da8d70a01
Author: Shahar Havivi <shaharh@redhat.com>
Date:   Thu Sep 4 11:51:02 2014 +0300

    v2v: adding input -i ova
    
    Adding ability for v2v to get Vmware ova file as an input.
    
    Signed-off-by: Shahar Havivi <shaharh@redhat.com>

commit 44ca9d563a93126bd744a819dde7237d371fe1fd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 3 14:01:20 2014 +0100

    launch: libvirt / p2v: Fix empty_element macro.
    
    The empty_element macro was not safe when used in a "naked" if
    statement such as:
    
      if (config->flags & FLAG_ACPI) empty_element ("acpi");
    
    Fix the macro so it uses do { ... } while (0) to make it safe here.

commit 579119764226d040bec928d7944055b592437d7b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 3 12:25:37 2014 +0100

    v2v: Don't hard-code list of -i and -o options in help output.
    
    We can now get it from Modules_list.

commit 82b73852920685e1294f0349815daf3178ac2e20
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 3 12:15:27 2014 +0100

    v2v: Update TODO.

commit 941ebaa5e44cbf41e0dd94f811329d59f18c2868
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 3 12:15:00 2014 +0100

    mllib: error: Clearer message about how to enable debugging.

commit 711c32b0d9d31dc554b78f471be4b529eab4dbba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 3 12:14:27 2014 +0100

    mllib: Wrap errors at column 76 instead of column 72.
    
    Allows for slightly wider, better looking error messages.

commit bb362f687840cd9fcf68bea08fd34fe8e4ddc64c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 3 12:13:42 2014 +0100

    OCaml virt-* tools: Handle pretty printing of exceptions through a common library function.

commit e52742e6d35ae33e55e6fd7a0228e55ec63102d3
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Sep 3 11:13:54 2014 +0200

    sysprep: user-account: remove the correct home
    
    Query using augeas for the home directory of an user, instead of
    hardcoding /home/<username>.

commit ee5470d083f106f0843d65229c521d4f997674e8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 2 23:40:28 2014 +0100

    v2v: Clarify documentation for -o local.

commit 11b1e2862b0b37d33152faef737854920d75a2b9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 2 22:40:13 2014 +0100

    v2v: Update TODO.

commit e0506486b0b2ac0be0f975c299bd7ca442718b8f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 2 19:36:25 2014 +0100

    v2v: Review 3-X comments in TODO file and remove any which are not short-term goals to fix.

commit 03ed5a790b571db2ff5f96f58bdbc01af4646cb2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 2 19:34:09 2014 +0100

    p2v/v2v: List output drivers in `virt-v2v --machine-readable', and use that in virt-p2v.
    
    The new output of virt-v2v --machine-readable now lists the input and
    output drivers available in the binary:
    
      $ virt-v2v --machine-readable
      virt-v2v
      libguestfs-rewrite
      input:disk
      input:libvirt
      input:libvirtxml
      output:glance
      output:libvirt
      output:local
      output:rhev
    
    With this information, we can now pre-populate the virt-p2v GUI
    combo box.

commit 03d848ab68a1de7cbee49a6a00963f91e8f53696
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 2 17:06:45 2014 +0100

    Version 1.27.36.

commit 10f6206202b70f1f92807f5d5fed768a3f9e524c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 2 16:49:25 2014 +0100

    p2v: Support for interface to network map.
    
    Instead of having all interfaces connect to the "default" network on
    the hypervisor target, you can now create a map of interface to target
    network, either on the kernel command line, eg:
    
      p2v.network=em1:rhevm
      p2v.network=em1:rhevm,em2:management,other
    
    or through the GUI.

commit 1ce65eeaefa2ce203db50a455c537b647d885230
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 2 16:22:52 2014 +0100

    p2v: Print config->output_connection field in conversion debug.
    
    This fixes commit 81d3aee0713faddc320cd1db5ac125891d07a0f0.

commit 128d474095bfabc2d724d0181155e364f1afbabf
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Sep 2 15:55:33 2014 +0200

    sysprep: user-account: select which users to remove or keep
    
    Enhance the user-account sysprep operation, so it is possible to select
    which user accounts should be removed only (instead of all), or which to
    eventually keep.

commit c902ede1cd345258d6c388ab804fbf6a92b24ffd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 2 14:25:16 2014 +0100

    p2v: Use libxml2 to write the libvirt XML document instead of printfs.
    
    Solves quoting issues.  This is just code reorganization, there is no
    substantive change in the output.

commit fc52f98c76d37273d8a420a99fefb2e5d71dcd50
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 2 13:29:53 2014 +0100

    v2v: Update TODO file.

commit f0e1f580b17a84fbc914acb50975d0e43ed1f2df
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 2 13:19:24 2014 +0100

    p2v: Add some spacing on the conversion dialog.

commit 750e8190348a88a7daf861e1162e5812faead059
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 2 08:53:31 2014 +0100

    p2v: Add GUI controls for -o, -oc etc options on virt-v2v command line.

commit 81d3aee0713faddc320cd1db5ac125891d07a0f0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 2 08:58:46 2014 +0100

    p2v: Change p2v.output -> p2v.o etc and add p2v.oc
    
    Name these the same as the virt-v2v options, so for example
    '-oa' -> 'p2v.oa'.
    
    Also add the missing p2v.oc (-oc) option.
    
    This updates commit c516d2d07dd0d1e4429ec84d2e9ebe02a951c5b5.

commit 379f335059f31338e207d8d2b2c17d55334bcafe
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 2 14:32:54 2014 +0100

    v2v: Give a reasonable, early failure if output format is not raw or qcow2.
    
    See comment in the code for reasoning.
    
    Thanks: Shahar Havivi for discovering this.

commit c004e4648d2091eb217026b15eed7e041557b635
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Sep 2 11:36:29 2014 +0200

    appliance: exclude a lvm2 rule on Ubuntu (RHBZ#1111662).
    
    On Ubuntu, exclude the Ubuntu-only 85-lvm2.rules since it causes the
    automatic activation of volume groups on addition or change. This
    interferes with libguestfs, as vgs which are disables suddently get
    enabled.

commit 65822315109cdb1e0079d687ce0d59fdfd6d83f2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 2 09:05:12 2014 +0100

    generator: Don't use ocamldep -all option in this directory.
    
    ocamldep -all (introduced in commit a3881445efd0) creates a dependency
    rule
    
      optgroups.cmi ... : utils.cmx ...
    
    Because we never build a native code version of the generator,
    utils.cmx can never be remade, and so this results in optgroups.cmi
    being always rebuilt and hence rebuilding the whole directory.
    
    It's unclear how to fix this, but reverting the ocamldep -all change
    in this directory works around it.
    
    Partially reverts commit a3881445efd04d5fe6da29db8b2d62a30088b9d1.

commit a3881445efd04d5fe6da29db8b2d62a30088b9d1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 1 22:24:14 2014 +0100

    Use ocamldep -all option.
    
    In v2v, 'stringMap.ml' has no corresponding *.mli file.  ocamldep does
    not generate a *.cmi dependency for such modules, and this can result
    in parallel builds failing rarely because:
    
     (1) stringMap.ml is built (which has the side-effect of generating
         stringMap.cmi)
    
     (2) at the same time, types.mli is compiled.  types.mli depends on
         stringMap.cmi, but it is half way through being created by (1).
    
    There is no dependency to serialize (1) and (2).
    
    The resulting error is:
    
      File "types.mli", line 1:
      Error: Corrupted compiled interface
      stringMap.cmi
    
    Using 'ocamldep -all' generates extra deps for the *.cmi files, and
    otherwise appears to be safe, so use it.
    
    There are currently a few upstream OCaml bugs with dependencies and
    parallel builds:
    
    http://caml.inria.fr/mantis/view.php?id=3190
    http://caml.inria.fr/mantis/view.php?id=4991
    http://caml.inria.fr/mantis/view.php?id=5000
    
    It's not clear which of these apply here.

commit c435053b3476094cd7e05c50c2e7713fcb646d5c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 1 21:29:13 2014 +0100

    Improve diagrams on various manual pages using Unicode box drawing characters.

commit 3c1b81d2af5c61863ac59e28f2a8509ed7a3e7ce
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 1 17:40:56 2014 +0100

    Version 1.27.35.

commit 22a556099a41ca4cbbfb746b1e620348b41b5049
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 1 14:10:49 2014 +0100

    p2v: Add a test of virt-p2v.

commit c516d2d07dd0d1e4429ec84d2e9ebe02a951c5b5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 1 17:16:52 2014 +0100

    p2v: Add p2v.output* controls so we can control where the output ends up.
    
    This still needs to be implemented through the GUI.

commit b16e98ba140d55a3341fcd4a0bca946bca6d3643
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 1 17:14:17 2014 +0100

    p2v: Fix p2v.disks (etc) parsing on kernel command line.
    
    The parsing of p2v.disks, p2v.removable and p2v.interfaces did not
    correctly end at the first space, and therefore any other parameters
    that happened to be on the command line afterwards would be consumed
    as a list of disks or interfaces.

commit 0136f50f064bbcea303298e6f22935ee1afffb46
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 1 16:07:04 2014 +0100

    p2v: Add a status message for when we detect the control connection has been closed.

commit 04740c5a35654688183c50863c80b9a427019922
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 1 16:06:05 2014 +0100

    p2v: Send SIGHUP (not SIGTERM) to kill child process.
    
    One reason is that when testing the child process will be bash (not
    ssh), and bash is documented to ignore SIGTERM when it is running
    interactively.

commit b1125a9db71b51b9208571485e75774adee10017
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 1 15:55:56 2014 +0100

    p2v: Allow -EIO error when reading pty to mean the writer has closed the connection.
    
    This is apparently normal behaviour for ptys.

commit 8e5233741f64efb7c8a0cae51f1434fb3497038d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 1 13:06:09 2014 +0100

    v2v: Update TODO file.

commit 9fb2b82dbe32463858c7116d129d48c528729088
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 1 12:21:51 2014 +0100

    v2v: Add some defensive code to test for the broken qcow2 overlay bug.
    
    In commit 53e0d3ea5fc703066f0eb92a49eaf8be18961e7e I fixed a cause of
    disk corruption in the overlay file during conversion.
    
    To ensure this doesn't occur again unexpectedly, add a simple test to
    the virt-v2v code and to the tests.

commit 431cdfd983bc9864d6a44a456a97b72455bb17cd
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Sep 1 11:46:57 2014 +0200

    fish: edit: write to the real file name
    
    When saving, resolve the path of the file being edited and use that as
    real target to write to. Otherwise, if the file name is a symlink then
    it will be replaced by a regular file with the new content, leaving the
    old file untouched.
    
    Extend test-edit.sh to check for this situation.

commit ca9930ef164286df5075cac890f558974efe0893
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Sep 1 10:28:00 2014 +0200

    test-tool: stop printing the FEBOOTSTRAP_* envvars
    
    Stop printing the FEBOOTSTRAP_* environment variables, since they are
    not used anymore.

commit 356fe582b8d64163fb84f662b37f534633b9c2a7
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Aug 29 16:38:04 2014 +0200

    fish: edit: centralize the EDITOR handling
    
    Allow null as value for the editor parameter of edit_file_editor, which
    will then get it from the EDITOR envvar (falling back on vi).
    
    This is basically code motion from the two edit_file_editor users to it.

commit b1a648887547c10818e64b45aa983e8287b034d4
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Aug 29 14:58:31 2014 +0200

    fish: edit: factor out download and reupload phases
    
    Share some code between edit_file_editor and edit_file_perl; mostly code
    motion, with no actual behaviour change.

commit 510329939bf675a20f782939f8857ac433acec5c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Aug 31 14:09:51 2014 +0100

    v2v: -o glance: Write potentially huge temporary images to /var/tmp by default.
    
    Instead of /tmp.  This can be controlled by setting
    $LIBGUESTFS_CACHEDIR or $TMPDIR.

commit 705e4bfd11274b09cdc2e821f281e3faed28268b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Aug 31 13:37:51 2014 +0100

    builder: Add test of the --edit option.

commit 1fb19fcad3c2aa572951bddcecd01a93b8c469b2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Aug 31 13:35:33 2014 +0100

    customize: perl_edit: Type of Guestfs_val() param is a Guestfs.t not the object wrapper.
    
    This fixes commit c6b7e6cddac850d6d2caf2e2f3060467c38397fe.

commit 94cffee541a329de081fbec78c96d1e753bef6fa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Aug 31 11:35:58 2014 +0100

    -o glance: Multiple fixes.
    
    Now tested and working on a glance server.
    
    This fixes commit f01f641fbb1a29b5727c0443f3700b1c871ccfc9.

commit 5c487541beceb634997822030039ef4ddc6f3b63
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 29 22:43:10 2014 +0100

    Version 1.27.34.

commit 0d2f4c507455c8bd54c53770d1df047adb462808
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 29 21:14:24 2014 +0100

    v2v: Minor correction to -o glance documentation.
    
    This fixes commit f01f641fbb1a29b5727c0443f3700b1c871ccfc9.

commit f01f641fbb1a29b5727c0443f3700b1c871ccfc9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 29 18:27:20 2014 +0100

    v2v: Output to OpenStack Glance (-o glance option).

commit 1ce930ed2749b50bed52910f6d9067f37d3d1a84
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 29 18:22:20 2014 +0100

    v2v: Use copy_on_read in the overlays.
    
    To speed up conversions by storing everything we read during
    conversion in the overlay instead of having to reread it from the
    remote server during copying.
    
    Thanks: Matthew Booth.

commit 180e3c30dee577dd44b3f1ae5bb16de2459b1d23
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 29 18:19:13 2014 +0100

    Add support for qemu copy_on_read feature.
    
    When drives are added with this flag, reads from the backing file are
    copied into the overlay, improving performance of reads to the same
    area of disk (at the expense of local storage).  This is excellent for
    reading remote / slow sources like HTTP.

commit 6a3147a5a0259ab72c7e92e2ff00859f2fa8a09e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 29 16:26:45 2014 +0100

    v2v: esx: Add note to documentation about being asked for the password twice.

commit 8aea6d8fac809c00280a5738257ef4134357141e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 29 10:05:47 2014 +0100

    v2v: More esx:// -> vpx:// changes.
    
    This updates commit 155a6f0482e5eeb6a763d4d31354edc5f48a1f43.

commit c6b7e6cddac850d6d2caf2e2f3060467c38397fe
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Aug 28 15:06:39 2014 +0200

    customize: use the common perl file editing code
    
    Wrap edit_file_perl to OCaml, and use it instead of the OCaml version
    of it.

commit 57b3a35764a959e3f0995a1b38a129e75bd03f82
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Aug 28 14:23:46 2014 +0200

    fish: edit: add verbose parameter

commit 2d217eb00e38176767a50dadbbb80356e7362492
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Aug 28 11:33:14 2014 +0200

    edit: switch to common editing functions
    
    Switch virt-edit to the common edit_file_editor and edit_file_perl.

commit b53126efb0205b4722897c7d79acf6dbc810caf7
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Aug 28 11:21:12 2014 +0200

    fish: edit: add perl file editing
    
    Add the perl file editing, mostly based in the virt-edit implementation.
    
    This introduces a mild code duplication with edit_file_editor; will deal
    with it in a later commit.

commit f1c6d5d7f2b852c1d2ccee409c6ac58c02d2bfd2
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Aug 28 11:02:53 2014 +0200

    fish: edit: bring the fast-time-edit protection
    
    Bring from virt-edit the small hack of putting the ctime of the
    temporary file few seconds back to notice file changes also on fast
    editing.

commit c9b6c8dac1bc0fd7ece202d2d7acccb8279d053e
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Aug 28 10:45:28 2014 +0200

    fish: edit: return 1 for unchanged file
    
    Change the return value of edit_file_editor to 1, in case the editor did
    not change the (temporary) file.

commit f79ee54722aee530a4f0a0b61cfe1cba3035fc86
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Aug 28 10:44:55 2014 +0200

    fish: edit: bring backup extension to file editing w/ editor
    
    Bring the backup extension feature from the perl-like file mode
    implementation, although currently not making use of it.

commit 511275acb1e27b85034eb7b767dd4e93491f74a8
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Aug 28 10:29:55 2014 +0200

    fish: edit: improve the editor execution
    
    Dynamically allocate the buffer for the command, and check also its exit
    status.
    
    Improvements taken from the current implementation in virt-edit.

commit 7b9f0cf777c08b89195ef496f74bb35fe528e1d2
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Aug 28 10:19:09 2014 +0200

    fish: isolate file editing (w/ editor) code in own file
    
    Move the implementation of file editing using editor to an own file, so
    that can be shared by different tools.
    
    Mostly code motion.

commit 582a8fcd84e50ef3ef09c527d84f3d679044c243
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Aug 27 16:51:05 2014 +0200

    cat: use the common Windows path handling code

commit 73ed3171be20a25cbb13fc209d6126943e66d90c
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Aug 27 16:44:27 2014 +0200

    fish, edit: move the exit-on-case-sensitive-error behaviour to virt-edit
    
    Do not unconditionally exit if guestfs_case_sensitive_path, but let
    windows_path still return null. Make virt-edit then check for that, and
    eventually exit on its own.

commit de6258352997e4e7990862a9809d4fbbc875b978
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Aug 27 16:41:35 2014 +0200

    fish, edit: specifies whether mount Windows as readonly

commit 7523e308fa866efa9dec2ab170b473245903e09d
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Aug 27 16:18:47 2014 +0200

    edit: move windows path code to common file
    
    Move the code handling Windows paths from virt-edit to a common file,
    so that can be shared by various tools.
    
    Mostly code motion, with a minimum touch (the additional guestfs_h*
    parameter in mount_drive_letter) to make it build and work.

commit 2ab7906f7c695835c642e3dec9012090dcbe5d5c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 29 09:50:40 2014 +0100

    Version 1.27.33.

commit ed6173f6104e2b9f01f8b0de209935687df2bc8f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 29 09:41:33 2014 +0100

    v2v: Fix real conversions test by setting architecture in libvirt XML.

commit 591911f4bf0c328b207f8984c78fb6ede450f692
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 29 09:09:32 2014 +0100

    Add suppression for memory leak in libvirt testDomainGenerateIfnames.
    
    See: https://bugzilla.redhat.com/show_bug.cgi?id=1135388

commit 620d20c4bb314e6543a4901880845d01ee7d2ef9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 28 22:00:33 2014 +0100

    Version 1.27.32.

commit d8e04d454a756946516416df8c7df60289c68cdf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 28 21:49:48 2014 +0100

    v2v: Fix bugs in conversion when uninstalling VMware drivers.
    
     - Don't uninstall open-vm-tools (the old virt-v2v didn't).
    
     - Do fix the library replacement code so it works the same way as
       old virt-v2v.

commit 155a6f0482e5eeb6a763d4d31354edc5f48a1f43
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 26 19:34:37 2014 +0100

    v2v: esx: Add / fix ability to import guests from vCenter Server.
    
    See additional information in the manual page for details.

commit 3fa4fff9b485d8d8b92d5d925b4e047358e63175
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 28 15:05:17 2014 +0100

    v2v: -i libvirt: Allow map_source* functions to map the format as well as the path.
    
    For ESX we need to map the format (which is usually unspecified) to raw.

commit 04121c40a164072227de34289f5662f1701fe12e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 28 14:59:45 2014 +0100

    v2v: -i libvirt: Add whitespace to make the code clearer.

commit abbb636e759bcfc87260cbef780fda1bed815ea0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 27 20:39:35 2014 +0100

    v2v: Display a %-done progress bar when copying the disk image to the target.
    
    This isn't quite the progress bar we have in mind, but it's sufficient
    for now.
    
    When --quiet is used, the progress bar is not displayed.

commit e3a02c4153f3064dd9427c4044849cf77b3a3421
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 27 20:16:06 2014 +0100

    sparsify: Remove obsolete comment.
    
    We don't need to use compat=1.1 with modern qemu, and
    lazy_refcounts may be dangerous.

commit 53e0d3ea5fc703066f0eb92a49eaf8be18961e7e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 27 20:28:15 2014 +0100

    v2v: Remove lazy_refcounts option.
    
    This seems* to cause disk corruption in the overlay files.  A
    manifestation of this is that the qcow2 header is not written back
    correctly to disk, resulting in the backing file of the overlay
    "disappearing" and hence hardly any data being copied over to the
    target.
    
    * Note this could be for a variety of reasons and doesn't necessarily
    indicate a fault in qemu or qcow2.

commit 7aced6ffb20c27af725040abc4faecf3ddc61010
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 27 14:42:44 2014 +0100

    v2v: -i libvirt/libvirtxml: Check that domain type, name, arch are not missing.
    
    This can lead to incorrect output.

commit e112e9a7b2eaa9d75acc6e722e73f3ae377ab9f0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 27 14:35:08 2014 +0100

    v2v: -o libvirt: Fix <features> XML in output.
    
    It was writing each feature as PCData (ie. text), not as a separate
    element, resulting in corrupt <features> output.

commit 4132680aea6b564c7fd668b859b262c58773a4dd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 27 09:42:50 2014 +0100

    v2v: -i libvirt: Don't access remote -ic URIs during object creation.
    
    Previously if you used `-i libvirt -ic [a remote URI]' then the remote
    URI would be opened during object creation, which occurs during
    command line parsing.  The practical effect was that virt-v2v could
    appear to hang or give an error (eg if the remote URI is inaccessible)
    before printing any log messages.  This could be very confusing for
    the user.
    
    Split out -i libvirtxml into a separate module, containing the libvirt
    XML to source parsing code as a function called
    Input_libvirtxml.parse_libvirt_xml.
    
    Modify -i libvirt so it does all initialization and calls the helper
    function during the #source method, and not at object creation time.

commit f54aff9e9ffa55a50d4e7a15586931035e5884f4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 26 22:56:31 2014 +0100

    v2v: utils: Permit more safe/unquoted characters in url_quote function.

commit a18629ce40457ef429dc6dbbd10cd89eb8cc4cf7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 26 19:34:22 2014 +0100

    v2v: utils: Don't need to use module name (Common_utils.) here.

commit 715020e264a87e167595557670c46bab0b4db5a8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 26 22:49:05 2014 +0100

    v2v: Remove bogus %systemroot%\Drivers path.
    
    This was based an incorrect translation of what the old virt-v2v was
    doing.  %systemroot%\Drivers is not expected to exist already, and
    indeed does not exist in a real Windows 7 guest.

commit f527c22b009e2a7005b186db8889e553b935e9e6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 26 17:48:02 2014 +0100

    v2v: Implement binding for `virsh pool-dumpxml'.
    
    Add a mini-binding to libvirt virStoragePoolGetXMLDesc to get the pool
    XML directly using the libvirt API.  Change existing external calls to
    `virsh pool-dumpxml' to use this API instead.

commit 8dc45325a6b7790896a43f41db5aca376aee2bfc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 26 17:31:08 2014 +0100

    v2v: Work around buggy `virsh dumpxml'.
    
    The `virsh dumpxml' command doesn't work properly when the libvirt
    source requires authentication.  This is because the authentication
    prompts are sent to stdout, but stdout is also the place where we are
    reading the output XML from.
    
    Add a mini-binding to libvirt virDomainGetXMLDesc which avoids this,
    getting the XML directly using the libvirt API.  Change existing
    external calls to `virsh dumpxml' to use this API instead.

commit 53999bddf44539f70164a8aa8f2abb011cf33264
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 26 17:34:57 2014 +0100

    v2v: -o libvirt: Mistakenly we were calling `virsh dumpxml' instead of `virsh pool-dumpxml'.

commit c916ea5b680776f70f21ecb224e0e2ca7031c0f4
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Aug 26 16:12:24 2014 +0200

    daemon: lvm-filter: use augeas for setting the filter
    
    The way to set the filter for lvm devices was to open lvm.conf, look
    for uncommented "filter =" lines and replace the configuration there.
    This had the issue that if there is no uncommented filter line, then the
    filter cannot be changed at all; considering newer lvm2 releases ship a
    sample configuration with no uncommented filter lines, then the old way
    became wrong and not sufficient.
    
    Instead, take a copy of the upstream lvm.aug lens, with a simple change
    to allow parsing also negative values in configuration, and install it
    in the daemon. When asking to change the lvm filter, use augeas making
    sure to use this custom lens for the lvm.conf copy used within the
    appliance.

commit abb0b47e3f1b8b86d2d39c2a91782ac5ed4b134e
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Aug 26 14:39:28 2014 +0200

    daemon: move AUGEAS_ERROR to the common header
    
    Other than for current aug_* API, it will be useful for further code
    using augeas directly.

commit 9b501fa5c6365958de362ecaf0f4e90c147978a2
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Aug 26 14:31:05 2014 +0200

    daemon: add add_sprintf
    
    Bring the add_sprintf function for stringsbuf from the library.

commit b56b90bf6ed5812400e02daea54621834dab96ef
Author: Shahar Havivi <shaharh@redhat.com>
Date:   Tue Aug 26 17:19:36 2014 +0300

    v2v: add xmlXPathRegisterNs for libxml2 binding
    
    Signed-off-by: Shahar Havivi <shaharh@redhat.com>

commit 3f315f54e80f449d9fd7b05eafa1c23996775d02
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 26 16:01:39 2014 +0100

    Enable warnings in C code linked to virt-sparsify and virt-v2v.
    
    The C code didn't have -Werror enabled (when configured) and didn't
    enable the full set of warnings we would want.
    
    However OCaml-C bindings commonly declare functions which are
    called directly from OCaml, eg:
    
      external parse_memory : string -> doc = "v2v_xml_parse_memory"
    
      value v2v_xml_parse_memory (value xmlv)
    
    These do not require prototypes as no other C code will call them, so
    we have to switch off the GCC -Werror=missing-prototypes flag for
    these files.
    
    Also fixes some confusion between _CPPFLAGS and _CFLAGS.

commit 880bf5f2ef036186f820034b87febdd6ee87e9f0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 26 15:45:11 2014 +0100

    v2v: -i libvirtxml: Add example libvirt XML.

commit 8e7cf61a409c4303e6088116f213aad726770f36
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 26 15:43:52 2014 +0100

    v2v: -o local: Use /var/tmp instead of /tmp for examples.
    
    In case people are suffering from broken tmp-on-tmpfs setups.

commit 97f634e5fbc57620172fee55c8e5aff5edc9b597
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 25 22:13:34 2014 +0100

    v2v: Split Types.overlay into Types.target and Types.overlay structures.
    
    Move the fields from Types.overlay which were related to the target
    file out.  Now Types.overlay is only concerned with the actual qcow2
    overlay files, not with a mixture of both files.
    
    For every guest disk, there is one chain which looks like this:
    
       source_disk         overlay                 target
      +------------+      +----------------+      +---------------+
      | s_qemu_uri |<------ ov_source      |<------ target_overlay|
      | etc        |      | ov_overlay_file|      | target_file   |
      +------------+      | ov_sd          |      | target_format |
                          | ov_virtual_size|      +---------------+
                          +----------------+
    
       describes source    describes temp.         describes target
       disk file           overlay (qcow2)         file
    
    This is just refactoring.

commit 29b8fb6c15f31fdbd56a52e4472e259edc24e936
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 25 21:42:15 2014 +0100

    v2v: types.mli: Fix typo in comment.

commit 4d30b82ea3c6a231193203cf608f5537693c0679
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 25 21:36:28 2014 +0100

    v2v: Change "Trimming the filesystems" message to something less scary.
    
    Avoid copying unused and blank areas.  Avoid alarm and support calls too.

commit 93943a0f779cdda7d5df3225efeab9adbc68123a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 25 21:31:05 2014 +0100

    v2v: Simplify conversion dispatch code.
    
    Refactoring, no functional change.

commit 0f2b503394e1c3bf38d196859970c057be7806a8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 25 20:35:55 2014 +0100

    v2v: Update TODO.

commit 862a27c92d495975cc12925599333e108f16b20d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 25 20:29:31 2014 +0100

    v2v: Inline the initialize_target function.
    
    This function had got smaller and smaller until now we might as well
    just inline it.  Having it after the main function just obscured the
    order that the code runs.
    
    No functional change, just refactoring.

commit 5800d96e7a5fce47187dcf74a7d43fa9c385b8b5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 25 20:27:44 2014 +0100

    v2v: Remove the Types.overlay ov_source_format field.
    
    Not used by anything and unlikely to be useful.

commit 938fe047d087f6a8e0bd79f7e275948a60eb1508
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 25 20:22:19 2014 +0100

    v2v: Remove Types.overlay ov_preallocation field.
    
    The ov_preallocation field was essentially an implementation detail of
    the V2v module.  There was no need to carry it around in the overlay
    struct, and nothing else used it.  This also allows us to simplify
    other code.

commit 4c492e21ac61769c28cfd6ceb0b869cfcedd59a6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 25 20:15:53 2014 +0100

    v2v: Add comments to DOM module.

commit 613ae49319245189c085136371957cf110b9224e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 25 20:08:56 2014 +0100

    v2v: -o rhev: Move inspection functions.
    
    This is pure refactoring, no functional change.

commit 86a1f5581065704fc90e11225abe4c9169af7125
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 25 15:45:31 2014 +0100

    v2v: Trivial fix to documentation in internal interface to libxml2.

commit ce59aa8c845cfa4918cb9a0cec0b9056e28c1d4b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Aug 24 21:21:10 2014 +0100

    Version 1.27.31.

commit 066eb6962521015cf82c5e7e773911e3288d2c79
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 22 09:47:09 2014 +0100

    v2v: int64 -> int fix for previous commit.
    
    This fixes commit 318a1b17a6be2e20245ca05a68448b5dcd048884
    (thanks Pino Toscano).

commit 318a1b17a6be2e20245ca05a68448b5dcd048884
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 21 23:38:34 2014 +0100

    v2v: -i libvirt: Select sensible defaults if <memory> or <vcpu> is missing from input XML.
    
    If the <memory> or <vcpu> elements was missing from the source
    metadata then we would choose useless defaults, resulting in (for
    example) <vcpu>0</vcpu> being written to the output.
    
    Choose sensible defaults for these integer values.

commit 78f725ffd5d06557c401b3618dc4b73722655e00
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 21 23:25:44 2014 +0100

    v2v: Store original vnet, and add comment to output metadata when mapping it.
    
    When we map the network or bridge names (using --network or --bridge
    command line options), this commit keeps the original name and adds it
    as a comment to the output metadata.
    
    The comment will look something like this:
    
        <interface type='bridge'>
          <!-- bridge mapped from "VM Network" to "bridge1" -->
          <source bridge='bridge1'/>
          <model type='rtl8139'/>
        </interface>

commit d629b5252bbc26a5ffa88e235f6090f260bd436b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 21 23:24:39 2014 +0100

    v2v: DOM: Add XML comments (<!-- .. -->) to the model.
    
    This allows us to insert comments into the output libvirt XML or OVF.

commit 6e1e9604b6da2ef8eeca2acb945bde6becad038e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 21 21:47:22 2014 +0100

    v2v: Add a test of --network and --bridge command line options.
    
    This enhances commit aaf84abca9e19e6a358516b60cc8a49d0905aef5.

commit 02b653496db36666c8f36e4a1ec6a0daad3de146
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 21 22:36:44 2014 +0100

    v2v: -o rhev: Improve the error message when you pass a bogus -os parameter.

commit 9fa27d4f79673d3898f36fde974eb3ad30690032
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 21 22:23:55 2014 +0100

    v2v: -o libvirt: <source file=...> must always be an absolute path.

commit 53e788890d868d2a98c2dcfd48de02dcfca698aa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 21 22:22:04 2014 +0100

    v2v: DOM: Produce pretty-printed XML.

commit 1e1605d937a4e1dfa08aa577d6a8b9bf7213c401
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 21 22:21:54 2014 +0100

    mllib: Export output_spaces function.
    
    This was already in Common_utils, but was only used internally
    not exported.

commit b9e591f7f08c8ba5373e9c940599109f492695c9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 21 21:46:45 2014 +0100

    v2v: Tests can use guests.xml not guests-all-good.xml.

commit 350e3285f35862251165db8233d1d70aac9a73cd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 21 21:25:33 2014 +0100

    v2v: Update documentation for input & output classes.

commit f71d62fa7853c81332275f96db5ee90c9767c0ec
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 21 19:38:27 2014 +0100

    Version 1.27.30.

commit 4389702e5c96a894fe0d97666fc16c92c775d8d2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 21 19:28:41 2014 +0100

    v2v: Remove build path which inadvertently appeared in test data.

commit 1e1ceb52730d22cf06a0fa098f9382a7071c7ca1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 21 17:08:35 2014 +0100

    Version 1.27.29.

commit 1d0ef02b3665822ae89ddd2bd39a79c728075cf3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 21 17:06:53 2014 +0100

    v2v: Fix check-valgrind on --print-source option.
    
    This updates commit 3a6dc32342cd6a545d66e9b773bab8450f533fa5.

commit f5fda273b18380f44d399dae230ec622335e9f23
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 21 15:00:53 2014 +0100

    v2v: Remove ov_vol_uuid hack.
    
    Now that we're using classes for outputs, we can hide the RHEV volume
    UUIDs in the output_rhev class.

commit 3903f97cb38dfb0beaf26e37fb4f4a7a45850a74
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 21 14:49:43 2014 +0100

    v2v: Replace strings with variants for extra type safety.
    
    No functional change.

commit c3dda31492c1d5f53b47278ae383c7d4ce8d86b3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 21 13:35:59 2014 +0100

    v2v: Pass verbose flag into every input and output subclass.

commit d1c8240b76d4c900ddb61e4a9c3e0e8d9f4907b3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 21 13:27:09 2014 +0100

    v2v: Print log message when opening the source.

commit ca05d757b00359e05536b3fb01484c0b61cd0934
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 21 12:25:43 2014 +0100

    v2v: Change input and output variants into classes.
    
    Previously Types.input and Types.output were variants, resulting in
    the main v2v.ml code having to have knowledge of all the input and
    output types.  So you would end up with code in v2v.ml like:
    
      match output with
      | OutputLibvirt -> (* call some libvirt-specific code *)
      | OutputRHEV -> (* call some RHEV-specific code *)
    
    This changes these types to be abstract superclasses, with specific
    implementations provided by (and hidden inside) each input/output
    module.  The above code in v2v.ml now becomes:
    
      output#call ... (* no backend-specific knowledge needed *)
    
    Although this commit is very large, it is just refactoring.  There is
    no functional change in the code.

commit c7e56a530690e649a8ab33c1e40137900fb6927c
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Aug 21 13:20:25 2014 +0200

    appliance: add glibc-locale on OpenSUSE
    
    Provides the gconv modules, needed for iconv to work.

commit 640109e1e506a66111ce45ce82c9321e7da05887
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 21 11:02:37 2014 +0100

    v2v: Reorder sections in the manual more logically.

commit 3a6dc32342cd6a545d66e9b773bab8450f533fa5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 21 10:21:19 2014 +0100

    v2v: Add --print-source option.

commit aaf84abca9e19e6a358516b60cc8a49d0905aef5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 21 10:07:46 2014 +0100

    v2v: Add --network and --bridge options to perform network name mapping.

commit e787c7f213f67cc53e41774f2f6b363b517fe7c1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 21 09:12:04 2014 +0100

    v2v: Let source.s_name be the renamed guest name (in case we use -on option).
    
    The original guest name is saved in s_orig_name, although I checked
    all uses of s_name and nothing needs it at the moment.

commit cf714fc08d455bc4524d97ca7b575bf3cc50b7be
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 20 11:44:49 2014 +0100

    v2v: Update TODO.

commit ccb47f93ff52a4f80498072cf679e502b782f655
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 20 21:16:57 2014 +0100

    v2v: Add support for remote ESX connections.
    
    This allows `-ic esx://...' to work because we map the strange source
    URI used by ESX to a remote HTTPS connection.
    
    Example disk section that this handles:
    
        <disk type='file' device='disk'>
          <source file='[datastore1] Windows/Windows.vmdk'/>
          <target dev='sda' bus='scsi'/>
          <address type='drive' controller='0' bus='0' target='0' unit='0'/>
        </disk>

commit 0539c2044c69f892c0a31fdb490e44403853fa57
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 20 20:00:59 2014 +0100

    v2v: VMware returns MAC all zeroes.  Map this to None.

commit bc037d9dedc862c26f6fb9281b5798dd1678cb90
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 20 12:21:05 2014 +0100

    v2v: source_libvirt: Replace create_xml ?dir parameter hack.
    
    Instead of the ?dir parameter which was essentially a hack, allow
    callers of create_xml to provide functions that map
    <source file="..."> or <source dev="..."> to qemu URIs.
    
    The default for these mappings is the identity function.
    
    For -i libvirtxml we replace the old absolute_path_of_disk function
    with a source file mapping function which does the same thing.
    
    There is no functional change in this patch.

commit 2fc9fdda98dac8f665f204c5c9baf13541f49014
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 20 12:14:26 2014 +0100

    v2v: Don't attempt to make block device paths absolute.
    
    <source dev=...> in the libvirt XML should always refer to a block
    device, eg. /dev/sda1.  Don't attempt to make these paths absolute
    (they should already be absolute paths, and if they are not it's wrong
    to try to make them).

commit 7800150d06a6ec73194def6d05f90273aa40205e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 20 12:04:32 2014 +0100

    v2v: Add binding for libxml2 xmlParseURI.
    
    There is already a partial binding for this in fish/uri.c &
    mllib/uri-c.c.  However it is specialized to parsing the -a parameter
    on the command line and we want access to the full underlying
    functionality of xmlParseURI.

commit c5c3a23294dafc2352644e58b79c21fe0cd5ae99
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Aug 20 18:56:39 2014 +0200

    appliance: add mkisofs on OpenSUSE
    
    Needed for isoinfo.

commit 3ceff73915839f49686e6f55018929215c889782
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Aug 20 16:57:06 2014 +0200

    appliance: add cdrkit-isotools and mtools for Mageia
    
    - cdrkit-isotools provides isoinfo, used by the daemon
    - mtools is used by syslinux without being a dependency

commit b6ba84499228bf9ee52d319f1b34631409f3a3f4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 19 22:24:45 2014 +0100

    v2v: Add some examples to the manual page.

commit bcce760166f3a377376c030fba0a5e7d86e4f005
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 19 19:46:24 2014 +0100

    Version 1.27.28.

commit 3d1cb74b3eee51c5d015032ad964892be914ea9c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 19 13:34:55 2014 +0100

    v2v: Add display, removable disks, and network interfaces.
    
    These are now collected from the source metadata and (where
    possible) passed through to the destination.
    
    For reference, see the metadata structure of the old virt-v2v (roughly
    equivalent to Types.source in the new code):
    
    https://git.fedorahosted.org/cgit/virt-v2v.git/tree/metadata-format.txt
    
    As you can see the new code now covers all the metadata features of
    the old code.

commit df471095ef39e7b8e87300ed8599a35a581f3d05
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 19 13:34:35 2014 +0100

    v2v: Update TODO file.

commit 8b3b7cc0daf424249d49fbd7bca2d3a80d1af556
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 19 12:16:04 2014 +0100

    daemon: Fix echo-daemon so it doesn't fail on empty array input.

commit 0ed91a7399c9c58cc29c1320df0d70c9f1d49229
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Aug 19 15:48:05 2014 +0200

    appliance: initial packagelist for OpenSUSE
    
    Mostly complete and making most of the features work.
    
    The notable lack is ntfsprogs and ntfs-3g, which due to the way
    mount.ntfs is handled (i.e. using alternatives) do not work properly.

commit 4a4256b8075c69aa6da4b0139e0e3cc2a1291762
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Aug 19 14:25:49 2014 +0200

    tests: make the scratch disk used for scratch much larger
    
    50M can be not enough when uploading various copies of unstripped
    static binaries from the system, which can fill up such a small disk.

commit 6b2bf2c7ace9a1e619fe33b13c06fad49e0731a3
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Aug 19 14:22:07 2014 +0200

    builder: do not use xz --block-size for the test images
    
    Do not use the --block-size parameter of xz when compressing the test
    images, as that option does not exist in xz < 5.1.

commit 0fd95e2b9fb9e49cf455b30cd4b85b7d7c354988
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 19 12:11:06 2014 +0100

    drives: Add comments about fragile string handling.
    
    GC FTW.

commit b53286a6432b8b381769cd8e8a0c235ce13d58cf
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Aug 18 14:56:08 2014 +0200

    drives: fix deletion of servers on error
    
    Make sure to not skip any of the created server, and to always free
    the "server" array.

commit 06aa1bff0f865fda7d64411977bca992d97fa748
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Aug 18 11:18:23 2014 +0200

    daemon: zfile: call pclose instead of fclose
    
    fp was opened with popen, so close it properly.

commit 54887a3eeabb52e27a3a1a571cfd40a351223030
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 15 20:02:50 2014 +0100

    v2v: Update instructions for uploading a volume.
    
    The previous instructions didn't include the need to change
    <disk type='file' ...> to  <disk type='volume' ...>

commit 1866fc47a2561ca23997ab742cdb96b6f55400a6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 15 19:58:10 2014 +0100

    v2v: Add some more man pages that may be relevant to "SEE ALSO" section.

commit c5b0e59dcc29c749999c056cb2747f58b07deba7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 15 19:57:52 2014 +0100

    v2v: Fix formatting of --vmtype option in the man page.

commit 0327036b2ff1e10538424ceb8e4d10f2121d753e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 15 19:51:09 2014 +0100

    v2v: Fix typo in manual page.
    
    This fixes commit 7c7caae7c1872c317712c373217362172a46abd6.

commit 25b33344b970c73c2dfaff44bcd410407e1e783e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 15 19:50:43 2014 +0100

    v2v: Make -i local be an alias for -i disk.
    
    Analogous to -o local.

commit 7c7caae7c1872c317712c373217362172a46abd6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 15 18:07:02 2014 +0100

    v2v: Add new -i disk to allow direct import of disk images with no metadata.
    
    This is simpler to use and more convenient than -i libvirtxml, because
    users don't need to bother with writing libvirt XML.  However it is
    less expressive because many source capabilities such as memory and
    number of vCPUs cannot be specified this way.

commit eaadf5c130ae4b248e1b83825b2d9ea6f83bc8dd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 15 18:16:51 2014 +0100

    v2v: Rename -o (target) tests.
    
    No functional change.

commit cca6f25de9d022b0408677a87fa32360b4312b47
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 15 16:39:14 2014 +0100

    Version 1.27.27.

commit a5e2485426b6d3afd953216afeeecb3950e66ecf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 15 16:38:48 2014 +0100

    website: Add virt-p2v(1) and guestfs-p2v-iso(1) to the website.

commit 787c42d6eb4ae350789752016e862490fcbd78e8
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Aug 15 12:49:00 2014 +0200

    tests/syslinux: add /usr/lib/syslinux/bios as directory for mbr.bin
    
    On Archlinux that is the location of mbr.bin.

commit df88e30ff1af1dd70a80e12991c5a40ffe611189
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Aug 15 12:48:59 2014 +0200

    appliance: add mtools to Archlinux' packagelist
    
    It is an optional dependency but syslinux uses it, so pull it always in
    the appliance.

commit 3243da393b2630997c4e10b39a5f6fa2585b7e10
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 15 14:37:04 2014 +0100

    v2v: Add a test of -o libvirt target.

commit e2fcc2304c160d20abfee1e5fe6c77f12979d2bf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 15 13:19:53 2014 +0100

    v2v: Add -o libvirt target (creates guest directly in libvirt).

commit 8ba605cad0700a7907ec6ba98a6740c071e74b43
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 15 14:35:14 2014 +0100

    v2v: Display message when intializing the target.
    
    As initializing the target (-o ...) is a distinct operation, which can
    fail if the user supplied the wrong command line arguments, make sure
    we display an explicit message before we perform this step.
    
    It prints something like this:
    
      [   5.0] Initializing the target -o libvirt -os default

commit e95a1c75d8a5bb2ef230cd9f13bbe979e2a7457a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 15 10:08:29 2014 +0100

    v2v: Move libvirt XML generation into common module, and use DOM module.
    
    Since `-o local' and `-o libvirt' both need to generate libvirt XML
    they should share the same code to generate it.
    
    Also generate it using the DOM module instead of printing the XML
    directly.  This is cleaner and avoids quoting issues.
    
    No functional change here.

commit 7ab495b458c2a93335266de2a24bc827785d18ca
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 15 10:07:27 2014 +0100

    v2v: When outputting XML, write "<element/>" for nodes with no children.

commit 5e872dbd2e50222c68aa7c10e88709a5c7a0687f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 15 08:51:59 2014 +0100

    v2v: Pass acpi, apic, pae features through to libvirt XML output.
    
    Notes:
    
     - Drop the acpi feature for RHEL 3.  Old virt-v2v says there is
       a problem presenting ACPI to RHEL 3 guests although it is not
       specific about what this is.
    
     - Old virt-v2v does not pass features through to OVF at all.

commit 991c4e36dd52fccc1883a3b7a8aca071f9d20901
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 14 17:32:27 2014 +0100

    p2v: Find ACPI, APIC and PAE flags and add them to target libvirt XML.

commit 9fa9d39d71af63fe96a95ea5668c14b73555c348
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 14 17:34:39 2014 +0100

    utils: Add new CLEANUP_PCLOSE cleanup.  It calls pclose(3).

commit 93c7842367fc5c99147b0ff4ab64dc52a476c7b8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 14 16:58:22 2014 +0100

    p2v: Rewrite /proc/cmdline reading code to use getline.

commit 483b4b7bbdedbd59884865d3221b2d0dca02a687
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 14 17:35:14 2014 +0100

    v2v: Update TODO.

commit ddfe82e823ff1112e4f75436ece439adc34b2ac9
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Aug 14 19:06:20 2014 +0200

    configure: look for "java-default-runtime" as directory for Java
    
    This seems to be the new way [1] in Archlinux to specify, as symlink,
    the default version of Java.
    
    Thanks to Peter Wu for the notice about it.
    
    [1] https://wiki.archlinux.org/index.php/Java

commit 1d9388b80066529f58b873bc601eab92ebd3c8a6
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Aug 14 16:46:12 2014 +0200

    configure: add java-8-openjdk and java-7-openjdk as locations for java
    
    This helps some distros (e.g. Archlinux) where openjdk is installed in
    java-MAJOR-openjdk directories, without any "default version" symlink.

commit 9609521734c661ec70c34a68f6201a2601190fa6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 14 15:16:06 2014 +0100

    launch: direct: Only issue Debian /dev/kvm group warning if /dev/kvm wasn't openable (RHBZ#1130189).
    
    This warning was meant for the case where /dev/kvm is inaccessible and
    the user must add themselves to a special group.
    
    However we didn't take into account whether /dev/kvm was openable in
    this test.  If it's openable, no point issuing the warning.
    
    Move the is_openable ("/dev/kvm") test earlier, and don't issue the
    warning if that was successful.

commit c21176386080029d285ffdf672e293c62e986640
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Aug 14 14:00:35 2014 +0200

    appliance: add libc-bin to Debian's packagelist
    
    It provides libc binaries like ldconfig and its configuration.

commit d9a4c481c940e0c83b8133ce21225c3820a40c28
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Aug 14 13:46:18 2014 +0200

    appliance: update distros in comments
    
    Update the list of recognized names of distributions in the comments.
    
    No functional changes.

commit 6f045f8401a856d748ebbde08bd5efc0857721f8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 14 10:02:33 2014 +0100

    v2v: Skip virt-v2v tests if rhsrvany.exe is not installed.

commit 6ae0e9641bdf516c3e14d004ffb7bd5127fd5d9d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 13 22:10:22 2014 +0100

    Version 1.27.26.

commit 8a23c1d79e878599a17c70bfc0737159acd5b61d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 13 22:18:44 2014 +0100

    lib: Missing include of <locale.h>.
    
    Required by setlocale.  For some reason you only see the error
    when compiling with -O0.

commit d1e56118dd68b624af3f25c2612687521b431842
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 13 10:46:27 2014 +0100

    Add a separate TODO file for virt-v2v and virt-p2v.

commit ef10da8b3a62e3bf0df649f1e725e5150135b003
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 13 12:17:57 2014 +0100

    v2v: Add tests.
    
    The virt-v2v tests here are not meant to be thorough tests of guest
    conversion.  There is a test suite used to test conversion which is
    kept outside libguestfs because it contains lots of proprietary
    unredistributable guests like Windows.
    
    The tests here instead are testing:
    
    - virt-v2v command line arguments
    - virt-v2v reads and writes files to the correct places
    - valgrind & memory leaks
    - any conversion properties that can be tested using just the
      phony guests (but we don't go out of our way here)
    - that up to date guests don't crash virt-v2v

commit 7beb9f2cb5dcc2c88dc548d1de9acb03852388b7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 13 16:50:51 2014 +0100

    tests/guests: Add Windows/Drivers directory to phony Windows guest.
    
    Allows virt-v2v to complete.

commit 5b6a2e68b8ef8c05577379e19ab0bbf3f66ca216
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 13 13:07:28 2014 +0100

    tests/guests: Fix RPM database in phony Fedora guest.
    
    Fix the Name and Packages database so it looks enough like a modern
    RPM database to fool inspection.  I'm not sure whether or not the old
    version ever worked, but it doesn't work now.
    
    The format is not documented, but in brief:
    
    The Name database contains (Name, link) pairs.  The link is an
    arbitrary 32 bit integer.
    
    The Packages database contains (link, RPM-blob) pairs.
    
    The RPM-blob is a binary blob formatted like this:
    
     * Number of fields               4 bytes, big endian
     * Size in bytes of the store     4 bytes, big endian
     * Field descriptions:
         list of (RPMTAG, 0, offset in store, 0)
                                      4 * 4 * nr_fields bytes, big endian
     * The store                      binary data containing ASCIIZ strings
    
    For the values of RPMTAG_* that we understand, see src/inspect-apps.c.

commit f0b71818a6bfb3a9a4c40f26604ee1e7dec67926
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 13 12:37:48 2014 +0100

    v2v: Add fedora to "RHEL family".
    
    The calling code allows Fedora guests to be used when calling
    Convert_linux.  However Convert_linux itself would fail with an
    assertion error when you did this.

commit b743fe2c3ea27ad82eba04256242df7960bfd051
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 13 12:33:41 2014 +0100

    tests/guests: Define the disk format of our test guests in the test XML.

commit 89417216b9a151829ecf108630af1195e5fe0b9f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 13 12:34:12 2014 +0100

    v2v: Fix libvirt source to parse the format of a disk properly.
    
    Missing '@' means it wasn't looking for the attribute.

commit cec3b42ad6f72195f4ffae80757b34e046bbc2f6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 12 21:53:57 2014 +0100

    v2v: Add --no-copy option.
    
    This option allows callers to generate the metadata without copying
    the disks.

commit bfcda1ba6a21906d2f82c19cf43bcd475bb4f5d8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 12 17:44:51 2014 +0100

    v2v: Nothing uses ov_target_file_tmp, remove this.
    
    Previous virt-v2v would write to a temporary destination file then
    atomically rename everything at the end.
    
    However this appears to be unnecessary since we write the OVF file
    after copying the disks, so (I assume) RHEV-M won't see the disks
    before then.
    
    In any case nothing used ov_target_file_tmp so we can remove this
    feature to simplify the code.

commit 295086e93491db2edb0c4f6d4364118f5f0267dc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 12 16:35:05 2014 +0100

    v2v: Allow RHEV UUIDs to be specified on the command line.
    
    Currently various UUIDs used by `-o rhev' are generated randomly.
    This means they are different on every run of the program.
    
    Allow some of them to be specified on the command line.  (If not
    specified they are still generated randomly).
    
    This allows RHEV-M to run virt-v2v several times (eg to examine the
    OVF output) while having paths to files and OVF be stable across runs.

commit ba63916960d8ddb318b1a15872d2f142e0e719b6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 12 15:26:38 2014 +0100

    v2v: Combine miscellaneous RHEV command line options into a single structure.
    
    At the moment there is just one "miscellaneous RHEV command line
    option" (--vmtype), but we may add more in future.  Put them in a
    single struct for convenience.
    
    This is just code motion.

commit 83c314d5c016ce055a8500a9f8f9d8aa694349bd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 12 15:06:21 2014 +0100

    v2v: -o rhev: Fix error message.

commit 3f53dc46803edd40ff42db11024c5764b914508a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 12 15:04:15 2014 +0100

    v2v: `-o ovirt' is an alias for `-o rhev', document it.

commit 0a816c020c00e1b44dba3c4809eca91f70422a13
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 13 14:38:34 2014 +0100

    v2v: Don't disable trace/debug set by environment variables.
    
    If the environment variables LIBGUESTFS_TRACE=1 or LIBGUESTFS_DEBUG=1
    were set, then the current code would end up disabling trace/debug if
    the command line arguments did not contain -x/-v.
    
    Fix this so the effect of enabling trace/debug is cumulative.

commit 5d89c0fd14448f4a907b5fd7fb80afcf62562b80
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 12 15:00:23 2014 +0100

    p2v: Clean up and fix the code for excluding the root device.

commit 67da00d540fbb8c463e9496864b243d780340d9a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 12 12:40:58 2014 +0100

    p2v: Call the remote libvirt XML file 'guest.xml'.
    
    Previously it was called 'libvirt.conf' which is more than a little
    bit confusing.
    
    This is only an internal name, so there is no visible change in
    functionality.

commit 40fbd447ee2393d43549722f240fe356de31f210
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Aug 13 16:43:19 2014 +0200

    build: manually drop flex-/bison-generated files from dist
    
    It seems that Automake cannot handle properly the files generated by
    flex and bison, leaving them in the dist tarball.
    
    For now, add a dist-hook to manually prune them from distdir.

commit 577ec51a4ca6b1a7c331a0e3da31295d578a5303
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Aug 13 15:16:17 2014 +0200

    fish: add test-invalid-params.sh to EXTRA_DIST
    
    Followup of commit 7912759fc331f6e8a0f7c87731f6bfe8c6e96c1f.

commit 6a51ae503c372b2548c91639e8c23c8bbeac3c44
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 13 13:50:36 2014 +0100

    builder: Missing include of <locale.h>.
    
    Required by setlocale.  For some reason you only see the error
    when compiling with -O0.

commit 34feb37879ea3d3a9adbb5de5baa62882f7c6a9d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 13 13:07:07 2014 +0100

    lib: Typo in comment.

commit 841b20c39cfd53bd7097d2e3f81fd36f8135cc75
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Aug 12 10:16:18 2014 +0200

    python: fix possible free on uninit memory with OStringList optargs
    
    When using optional arguments of type OStringList, the code free'ing
    the member in the optargs_s struct corresponding to that optional
    argument would just check for a non-PyNone PyObject for that argument.
    If before that optional argument there are other arguments which can
    cause an earlier error return from that binding function, the free'ing
    code will then act on garbage values.
    
    Enhance the check by also checking whether the optargs struct has the
    bitmask with the element for that argument, meaning that the
    corresponding struct member was initialized.

commit abbbc832d50dafd2872d0f5fee94e62faa978e82
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Aug 11 15:15:16 2014 +0200

    p2v: check results of strndup and sscanf

commit bbae6136abe6432648be94decedc6c96cbe63328
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 11 14:51:37 2014 +0100

    p2v: Move libutils before libxml2 in the list of libraries (RHBZ#1102447).
    
    The error is:
    
    ../src/.libs/libutils.a(
    libutils_la-cleanup.o): In function `guestfs___cleanup_xmlBufferFree':
    cleanup.c:(.text+0x79): undefined reference to `xmlBufferFree'
    ../src/.libs/libutils.a(libutils_la-cleanup.o): In function
    `guestfs___cleanup_xmlFreeDoc':
    cleanup.c:(.text+0x99): undefined reference to `xmlFreeDoc'
    [etc.]
    
    Thanks: Arnaud Gaboury

commit a26a9e68819dab5f9c8eed821d8a686fffabbc5b
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Aug 8 17:13:02 2014 +0200

    df: unlock retire_mutex on early exit
    
    If pthread_cond_wait fails and the thread worker ends, make sure to
    unlock retire_mutex, which has been locked for the condition.
    
    The return value of pthread_mutex_unlock is ignored, as there's nothing
    that can be done with it at that point.

commit bb124552155667c082c075cb09267b12a7a567c1
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Aug 8 15:35:02 2014 +0200

    daemon: use CLEANUP_CLOSE

commit 4249ddd8bbd0d38f7e63890b999c6199b54af5b3
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Aug 8 15:34:07 2014 +0200

    daemon: add CLEANUP_CLOSE
    
    Just call close on the specified fd, if valid.

commit ad4ba5997be030ee4b67614d9e6004107482bbc3
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Aug 8 14:58:08 2014 +0200

    daemon: blkid: fix memory issues in "no -p/-i" mode
    
    Fix the memory issues in the implementation that uses no -p nor -i:
    - use add_string_nodup to add results from get_blkid_tag (which returns
      new strings), so those strings are not leaked
    - use free_stringslen to clean the hash on error, as in such case the
      stringbuf will not be terminated with a null entry, thus causing
      free_strings to crash

commit fef0881b3a31adebf66e0374fed3eb41f9d1471d
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Aug 8 14:56:27 2014 +0200

    tests: c-api: do not crash w/ missing hash entry
    
    If an hash does not have the requested key, just error out cleanly
    instead of crashing when trying to compare a null string.

commit 8d23fb31f11019b7b8c4834166748143cec84c0c
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Aug 8 13:49:59 2014 +0200

    daemon: initialize memory when handling DeviceList params
    
    When dealing with DeviceList parameters, the generator produces code
    similar to the following:
    
      CLEANUP_FREE_STRING_LIST char **devices = NULL;
      [...]
      devices = malloc (sizeof (char *) * (args.devices.devices_len+1));
      {
        size_t i;
        for (i = 0; i < args.devices.devices_len; ++i)
          RESOLVE_DEVICE (args.devices.devices_val[i], devices[i],
                          , goto done);
        devices[i] = NULL;
      }
    
    The block hidden within the RESOLVE_DEVICE macro is supposed to
    assign something to devices[i]; on the other hand, the code in
    RESOLVE_DEVICE can cause to just end (with an error) the current RPC,
    which would cause the cleanup of the "devices" array... whose members
    from the i-th to the (args.devices.devices_len-1)-th would be garbage
    pointers, causing random memory to be free'd (and thus crashing the
    daemon).
    
    Avoid the access to garbage memory just by having a cleaned "devices"
    array, so there will be always a NULL element after the initialized
    members.
    
    Add a test for vgcreate which passes a wrong device path causing the
    situation above, to test that vgcreate would fail gracefully.

commit d1f580550b32e8552ee64f12872b0fa10147957f
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Aug 8 10:23:37 2014 +0200

    rescue: fix sscanf placeholders for --smp and --memsize
    
    Use %d to parse them as int (since the variables for them as int)
    instead of %u, even if they both need to be at least > 0; the library
    will check for the validity of them anyway.

commit 7912759fc331f6e8a0f7c87731f6bfe8c6e96c1f
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Aug 8 10:15:32 2014 +0200

    src: always check value passed to set_memsize
    
    Move the minimum memory check from the environment parsing to
    set_memsize, so the limit is actually enforced also when using the API.
    
    Adapt the rhbz557655.sh test to the invalid memsize values being
    rejected now, and add a new test for checking invalid parameters
    explicitly.

commit 5fddd932054b1e4213807c545f85f5c0b3d698f7
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Aug 7 19:26:46 2014 +0200

    lua: always return luaL_error in actions
    
    Even if luaL_error is a "no return" function for the Lua runtime, adopt
    also in action functions the "return" idiom recommeded for it.
    
    This also helps code analyzers in not thinking that "g" might still be
    null after the null check followed by luaL_error.

commit 5ce123400745469a8dc3a931547c581d69b3bd8e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 7 12:25:13 2014 +0100

    aarch64: Add common function for getting the CPU model.
    
    And force a 64 bit CPU model when running on aarch64 with TCG.

commit f5c74637e36b6c8eb1281f93f7fe26f9016e405c
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Aug 7 10:45:04 2014 +0200

    daemon: add and use a reply_with_unavailable_feature macro
    
    Handy macro to reply the right way for an unavailable feature.
    While generally used so far in generated code, it can shorten that a
    bit, and avoid copy&paste when wanting to do manual feature checking.

commit 59584e1814205f62e36692ad3df26adcaeddcfc8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 5 18:06:22 2014 +0100

    Version 1.27.25.

commit 40cecb4b9cb4354902149f68918fe1d24a534c41
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 4 17:20:41 2014 +0100

    v2v: Add RHEV target.
    
    Use:
    
      virt-v2v [..] -o rhev -os nfs:/export
    
    or:
    
      virt-v2v [..] -o rhev -os /mountpoint
    
    to write to a RHEV-M / oVirt Export Storage Domain.

commit 95c3b78f081c2d861fb1517ccfd6b5eb1e1be224
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 4 22:20:56 2014 +0100

    v2v: Keep more inspection data in the inspect struct.
    
    Just code motion, no functional change.

commit e82c0c5e55c727e7ad416ad5cf103b056bd157c2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 4 16:24:42 2014 +0100

    v2v: Fix bytecode build.

commit b6cb67d958f5f9ac96b885c8e792beca2d6cac18
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 4 14:51:30 2014 +0100

    ./run: chcon the tmp directory in the builddir.
    
    Not just some random tmp directory which happens to be in the
    local directory.

commit e1c508c29f929134bfcb0f83b402a02e8ff94caa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 25 14:03:54 2014 +0100

    launch: Close file descriptors after fork (RHBZ#1123007).
    
    This refactors existing code to close file descriptors in the recovery
    process, and also adds code to close file descriptors between the
    fork() and exec() of QEMU or User-Mode Linux.
    
    The reason is to avoid leaking main process file descriptors where the
    main process (or other libraries in the main process) are not setting
    O_CLOEXEC at all or not setting it atomically.  Python is a particular
    culprit.
    
    See also this OpenStack Nova bug report:
    https://bugs.launchpad.net/nova/+bug/1313477
    
    Thanks: Qin Zhao for identifying and characterizing the problem in Nova.
    
    This is version 2 of this commit.  This commit is identical to the
    reverted commit 115fcc34325f965ac3723683e4462fc667dcd254 except that
    we don't close stderr.

commit e0ba7855f48284efa27efcae1fa69fb5f3354cf9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jul 27 11:18:55 2014 +0100

    html: Don't build HTMLFILES for disabled features.

commit 286f116691c8aad4ac8bf0d044e9f6ca8d5b3356
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 29 22:20:37 2014 +0100

    Revert "launch: Close file descriptors after fork (RHBZ#1123007)."
    
    This attempted fix for RHBZ#1123007 causes the qemu command line to be
    lost when verbose mode is enabled.  Since this is essential for
    debugging many problems, I am reverting the patch.
    
    This reverts commit 115fcc34325f965ac3723683e4462fc667dcd254.

commit 1d596eb7e68623beece1b5ad6d0c3eb94eb0b6ce
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 29 20:27:53 2014 +0100

    tests: qemu-speed-test: Allow test time to be adjusted with -t option.
    
    This is useful when analysing with `perf' since it allows us to
    increase the amount of time in the test versus the amount of time
    spent starting the appliance.

commit 1c7da06327701a5fba92fd1aac19606da70c6fd5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 29 11:51:13 2014 +0100

    tests: qemu-speed-test: Allow tests to be run selectively.

commit f342cfc69df2e55b2c0e79595d2a085396475af0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 29 11:50:41 2014 +0100

    tests: qemu-boot: Error if extra command line arguments are given.

commit 043cf4fbe30894af481c242095ed4cd436e136ea
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Jul 28 19:29:14 2014 +0200

    launch: direct: check for null paths in make_uri
    
    Some protocols may pass a null path to make_uri, so make sure to handle
    that gracefully.

commit 8ea6b3e03c8cccdd18a7910e9e5da75ee1e27807
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Jul 28 17:27:30 2014 +0200

    make-fs: do not leak the fd from mkstemp

commit 2fe93bda9f8744553da19882043f11da5348dc35
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Jul 28 17:24:02 2014 +0200

    make-fs: respect libguestfs' temporary dir
    
    Do not hardcode /tmp.

commit 50e3ef3357fe97028e958268eac7d63ec4e64408
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 26 21:37:59 2014 +0100

    Version 1.27.24.

commit 1b925a0efb9be0020002a9796164209ad6f4d9d2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 26 21:27:16 2014 +0100

    build: Add `maintainer-commit' rule to create a new version commit.

commit 08bfd9e41b08aed72fa2de1df71e166b8204c958
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Jul 25 17:36:17 2014 +0200

    p2v: close the mexp handle if mexp_spawnv fails

commit 9c3ce6535c34da761148204d5efe014598b1c0a1
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Jul 25 17:36:16 2014 +0200

    make-fs: use CLEANUP_FCLOSE

commit 9e7f5300c93c77f899d2bf543858e94608e6286f
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Jul 25 17:36:15 2014 +0200

    cleanups: add CLEANUP_FCLOSE (fclose on FILE*)

commit d8b9ce65c281cf9cd9ecea8229c83fad3cb64a9b
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Jul 25 17:36:14 2014 +0200

    p2v: properly call va_end

commit 7378edb9faf22f1a5a7b9e9f74621509da0e223a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 25 17:12:19 2014 +0100

    Add qemu-speed-test program to test speed of qemu.
    
    Currently it tests the upload and download speed of virtio-serial and
    the read and write speed of the block device (eg. virtio-scsi).

commit 115fcc34325f965ac3723683e4462fc667dcd254
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 25 14:03:54 2014 +0100

    launch: Close file descriptors after fork (RHBZ#1123007).
    
    This refactors existing code to close file descriptors in the recovery
    process, and also adds code to close file descriptors between the
    fork() and exec() of QEMU or User-Mode Linux.
    
    The reason is to avoid leaking main process file descriptors where the
    main process (or other libraries in the main process) are not setting
    O_CLOEXEC at all or not setting it atomically.  Python is a particular
    culprit.
    
    See also this OpenStack Nova bug report:
    https://bugs.launchpad.net/nova/+bug/1313477
    
    Thanks: Qin Zhao for identifying and characterizing the problem in Nova.

commit f18464995f63095d32431202fa2bedc5b60d7a88
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 25 16:06:46 2014 +0100

    tests: builder: Allow test to be skipped.

commit 81cafdcfd5932c0adddf22a06b3a770063526133
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 25 16:04:18 2014 +0100

    virt-resize: Unmount filesystem after testing size.
    
    We were mounting different filesystems on top of each other.  In fact
    this is not a problem, but it's nicer to unmount each filesystem
    properly after examining it.

commit fc7da04ccd2871a64447dff531ca332decb4bc0d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 25 16:03:09 2014 +0100

    daemon: Add extra debugging to umount_all command.
    
    No functional change, just prints some more debug messages.

commit 146cc78b7d1a5482db95e65e426138d8a9eff872
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 25 15:26:26 2014 +0100

    aarch64: Use a smaller test file for test-cancellation-upload-daemoncancels.sh
    
    This test worked by uploading a 100MB file into a 100MB container and
    seeing the inevitable crash.  Unfortunately virtio-mmio (used on
    aarch64) is quite slow.  Since this test is not testing the speed of
    virtio-mmio, use a smaller test file so the test finishes in a
    reasonable time.

commit d268de93949c2954fda8f0a1387b740903893481
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 25 14:42:38 2014 +0100

    tests: hotplug: Allow tests to be skipped.
    
    They don't work on aarch64.

commit 64498034bbc7bce2692597fb8bfbb721e8180543
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 25 10:04:44 2014 +0100

    tests: lvm: Allow test to be skipped.

commit 7f826e1296c85be7f4418830c8b5c992a80e9747
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 23 17:40:16 2014 +0100

    Version 1.27.23.

commit d682dad1864ef3b3353f1521098466459df97ca3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 23 13:08:49 2014 +0100

    aarch64: Add comment about efi-rtc=noprobe option.
    
    This updates commit 5326689d50cc82e9108c83511e666be6d081d9dd.

commit bcdbe6405c10ecb7374ae47eee6385be17dbd49e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 8 16:33:45 2014 +0100

    v2v: Add support for converting Windows guests.
    
    This completes commit f296d34f3b30c82309b22b54bf5a2c133992bd93.

commit f4698575cced4c45136635daa31821e6d55e7c77
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 8 21:31:06 2014 +0100

    customize: Add the ability to use --firstboot for Windows guests.
    
    This allows you to add potentially multiple --firstboot
    scripts to a Windows guest.

commit 199fa269508ac9ae2de32927e04996834af149d4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 8 21:41:58 2014 +0100

    mllib: Add regedit mini-library.
    
    This library replaces Win::Hivex::Regedit, or at least enough for us
    to be able to make the simple Registry modifications needed for
    installing firstboot scripts.

commit 9c49590d42642940acf5de06d978ba1e2d71e8d1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 8 20:57:59 2014 +0100

    customize: firstboot: Move Linux-specific functions into Linux submodule.
    
    No functional change.

commit 12b54ef5e3aecd55d228a96dfb0a9ab5c8acdf4a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 23 15:01:44 2014 +0100

    sparsify: Relax requirement that output device cannot be block device (RHBZ#1122557).
    
    To fix RHBZ#1056290, I prevented virt-sparsify being used if the
    output device is a block device.
    
    I have now retested this scenario and it does work (in both copying
    and in-place mode), and does not delete the output device, and
    therefore we can relax this restriction so only char devices are
    banned.
    
    This is useful for oVirt which uses a qcow2 formatted block device to
    store virtual machines.

commit 897b136aa8012bba26e61e0eb0851a6a4b0cdf5a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 22 19:10:04 2014 +0100

    Update translations from Transifex.

commit e7ae071f60846e0d91a1a1728b5614df912815f6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 21 14:36:43 2014 +0100

    Version 1.27.22.

commit 5326689d50cc82e9108c83511e666be6d081d9dd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 18 15:05:55 2014 +0000

    aarch64: efi-rtc=noprobe is needed to fix boot of upstream kernel on VM.

commit f4026d779e9736b5446f80d5b4d68eaa13fd07bd
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Jul 17 16:24:52 2014 +0200

    configure: look for "default-java" as directory for Java
    
    In Debian-based systems, /usr/lib/jvm/default-java is a symlink
    pointing to the location of the default Java version.

commit de5924a2294a6aeb09e4b41b55f06d2f3ea5e0ec
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 17 20:32:24 2014 +0000

    tests: Add test program to run qemu/appliance repeatedly.
    
    For example:
    
      $ time ./run ./tests/qemu/qemu-boot -n 100
      real 1m19.794s
      user 0m10.001s
      sys  0m5.928s
    
    will run 100 appliance start/stops, from multiple threads.

commit 83790960d63b78b1c2264777a4d87559d11f3b12
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 17 11:38:20 2014 +0100

    valgrind: Tweak the suppression matching OCaml leak in caml_search_in_path.
    
    In OCaml 4.02 this still leaks, but the stack trace is slightly
    different so the old suppression didn't match it.

commit 333ddf208b878441e3ef3ea6b65726f758310315
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 17 09:58:07 2014 +0100

    tests: Add a protocol regression test for long error messages.

commit 4106c97934ec5461ae854939185bfa574374bca2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 17 09:57:42 2014 +0100

    daemon: Truncate long error messages so XDR encoding doesn't fail.

commit 4d3953f09217e15212d18f53e1cf040d54156f72
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 16 22:05:39 2014 +0100

    Warn about large stack frames, and fix a few places with excessive stack usage.

commit 00c94d808b0abc825c379ea1f0f2d44827ad120a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 17 09:43:45 2014 +0100

    tests: Remove tests/protocol/test-qemudie-launchfail.sh
    
    This test has not been run since 2012 as it depends on specifics of
    how supermin and new-style appliances work (see
    commit 2d89aef897e633bffba1dffd600b122eacd88fc8).
    
    This commit removes the test entirely.

commit fa3d6e55b2e3a2be811038914ece3c5bdf57c4a2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 16 12:39:26 2014 +0000

    tests: qemu: Fix TCG test.
    
    $guestfish was not defined, so the UML test/skip did not do anything.

commit 9cdaaeee40384af47bb581c83407efac39090cb1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 15 18:22:05 2014 +0000

    tests: regressions: Allow non-exec stack test to be skipped.
    
    Currently fails on aarch64 because of a buggy GCC.

commit 9e01541e4814a81a1911d83d07f61aa8b4139ca2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 15 17:56:57 2014 +0000

    tests: 9p: aarch64 also uses virtio-mmio (instead of virtio-pci).

commit 2d01e06fc9983a3981062d96252dc6b4e3a5f326
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 15 17:55:18 2014 +0000

    tests: regressions: Skip test on aarch64 which also does not support IDE.

commit fe9d3f7a903741311cfd0ef0b82607be8ab923df
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 15 16:41:18 2014 +0000

    ocaml: Ignore Warning 3: deprecated feature: String.* functions.
    
    In OCaml 4.02, the 'string' type can be made immutable.  All String.*
    functions that are concerned with creating or mutating strings now
    give a warning like this:
    
      Warning 3: deprecated feature: String.unsafe_set
    
    Disable this warning since we don't want to turn on immutable strings
    yet.

commit d71ec218eaffe0caf07b44e349383ef1d9398feb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 12 14:50:15 2014 +0000

    aarch64: Add some earlyprintk debugging.

commit 57c7417f89b2e39f625e9b3276a5ef470fcd5b6a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 12 14:49:23 2014 +0000

    aarch64: Use console=ttyAMA0 instead of console=ttyS0.
    
    This still only prints early console messages.  Output stops
    after:
    
      bootconsole [earlycon0] disabled
    
    but I have not found any way to get later kernel messages.

commit 9d8ede1ae4b8b926a00c16d0f6ba52d8a6defbd7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 10 17:32:39 2014 +0100

    sysprep: Standard exception handling, taken from virt-builder & virt-v2v.

commit f913ca5ebcaacbd94a31ed8fac935833447cc0a7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 8 20:51:22 2014 +0100

    customize: Use Common_utils.error function instead of failwith.
    
    This is just code refactoring.

commit 82cf3c9d68237a3294f6e83f2b38de4f1414ca7f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 8 20:52:17 2014 +0100

    customize: Update copyright messages.
    
    No functional change.

commit f955fec7601309ca3b33080cb6d49ea916be452e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 8 23:01:05 2014 +0100

    docs: Remove useless "SHELL QUOTING" section from manual pages.

commit 9b47a53a4b5c34095efb297b12867b42752786d4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 11 10:21:39 2014 +0100

    sparsify: Add --tmp prebuilt:file option.
    
    This option allows oVirt to pass a prebuilt qcow2 file to use as the
    temporary overlay.  The file must be qcow2, and must have indisk as a
    backing file - the code does minimal checks to ensure this is correct.
    
    Example usage:
    
      qemu-img create -f qcow2 -b indisk overlay.qcow2
      virt-sparsify indisk --tmp prebuilt:overlay.qcow2 outdisk
    
    Note this only applies in copying mode.

commit 66aa98265dd215dcd4c717e7ef6845fbac859e54
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jul 15 11:06:32 2014 +0200

    appliance: init: run ldconfig
    
    Run ldconfig early in the init script, so libraries outside standard
    library paths but with a proper ld.so configuration file pointing at
    them can be found.

commit a791e081638025b64d1229d23d1181d96cc2a607
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 11 10:38:53 2014 +0100

    RHEL 6: p2v: Add fix for older PCRE.
    
    RHEL 6 pcre did not define PCRE_PARTIAL_SOFT.  However PCRE_PARTIAL is
    a synonym so use that.

commit 17bf3ce21cb28840987caaa79babd006458ad2d2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 8 13:55:31 2014 +0100

    Version 1.27.21.

commit f296d34f3b30c82309b22b54bf5a2c133992bd93
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 30 18:00:01 2014 +0100

    v2v: Add partial support for converting Windows guests.
    
    This is not yet complete.

commit 2ee1fb6472dfcde9cb649a5c2eb4eaffa12f5e2a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 8 09:02:46 2014 +0100

    builder: CentOS 7.0

commit 71ac957d4aedf9560a6b0c75629fea16a32d20c3
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Jul 7 19:33:44 2014 +0200

    Use Mkdtemp.temp_dir instead of Mkdtemp.mkdtemp

commit c8f3e99302e65a0c10bc82df49789d159bf17e5c
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Jul 7 19:30:29 2014 +0200

    mllib: introduce Mkdtemp.temp_dir
    
    Add a simple function to ease the usage of Mkdtemp.mkdtemp.

commit 3fc6983b1666a32ea6c1b44d88f140e3c84e7201
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Jul 7 11:40:19 2014 +0200

    inspect: ignore /etc/fstab with no entries (RHBZ#1113156).
    
    Just like no /etc/fstab is not an error, having one with no entries
    shouldn't be an issue either.
    
    With systemd, this could be a valid setup, with mount points set its own
    way.

commit 3f2e18efdeb4697bf175aae46fb18d0183292445
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 4 15:48:36 2014 +0100

    valgrind: Add suppress for libvirt memory leak in virFileFindResourceFull.
    
    https://bugzilla.redhat.com/show_bug.cgi?id=1116427

commit 2fe74642f4b2971ea279374a72ddedde733f5e44
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 3 11:48:49 2014 +0100

    launch: direct: Use -cpu host when using KVM on x86.
    
    This is the same as what the libvirt backend does.

commit fc9647bb4d82d7209ee54c26711c178c2396329d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 2 23:09:22 2014 +0100

    mllib: Remove trailing whitespace.
    
    This fixes commit b24b0b17a8ab5854c020cb1172597d805b911c73.

commit bf47ed1b6ab94f54737b914e15e5a35a148c1b7c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 2 18:18:39 2014 +0100

    tests: qemu: Test force_tcg setting is effective.

commit 2369e9c2d660e1b9010b5c0afc599b769efd08b2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 2 16:24:59 2014 +0100

    log: Pass correct parameter to localtime_r on 32 bit platforms.
    
    We were passing an int64_t which happens to be the same as time_t, but
    only on 64 bit.  This didn't work on 32 bit (or rather, it works on
    little endian, but only by accident).
    
    This fixes commit fb546eaee064b14ad192a4f0390325ba1b4c766a.

commit a2747578ebfc92d19ca615d8fd462d9b826eafb5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 2 16:17:05 2014 +0100

    journal: Fix binding of sd_journal_get_realtime_usec on 32 bit machines.
    
    sd_journal_get_realtime_usec is defined as:
    
        int sd_journal_get_realtime_usec(sd_journal* j, uint64_t* usec);
    
    Unfortunately we passed size_t* as the second argument.  This happened
    to work on 64 bit machines because size_t is 64 bit there, but failed
    on 32 bit machines, where we didn't pass a sufficiently large result
    buffer.
    
    This fixes commit 2d996df66c8d67e11a91a89c074c91a233356494.

commit 1e1d7cf6af45d9334e9cf24f771c47159d9a4fca
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 2 14:24:14 2014 +0100

    excludefiles: Exclude various common log files when building the appliance.
    
    These log files can get pretty big, and that causes problems
    like this one:
    
    http://linuxforum.ru/viewtopic.php?id=35381
    
    and this one:
    
    https://bugzilla.redhat.com/show_bug.cgi?id=1099172
    
    In both cases the problem was /var/log/lastlog which is apparently a
    large sparse file.  Supermin cannot cope with sparseness, so it copies
    the whole file non-sparse.  But since this could affect other log
    files this commit covers various common log file names and patterns.
    
    Thanks: semperN

commit f40e11ace4f7c3799549c9f746408b9ab444efef
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 2 13:54:16 2014 +0100

    Version 1.27.20.

commit 5d48f7a7921d57bd12bc5ddc60127c551d39fbef
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 2 13:22:18 2014 +0100

    Update gnulib to latest version.

commit 144a86ac8c4935c1ef5fdedba10144873ac70920
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 1 12:01:28 2014 +0100

    v2v: Change fstrim message to warning.
    
    This also ensures it is flushed and translated.

commit dbe0b69f24421f258da2fb420b58fc1530a9cd03
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 30 16:24:03 2014 +0100

    v2v: Remap block device names in grub & /etc/fstab.
    
    eg. Change /dev/hda to /dev/vda

commit 120d61cf56f7ad76be32b454df5d628c4e7f5501
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 30 14:14:08 2014 +0100

    v2v: Kill kudzu dead.

commit 838dce6557991f695296b5859db939146e56e527
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 30 14:13:32 2014 +0100

    v2v: When converting Linux guests, rebuild the initrd.
    
    It probably needs to be rebuilt to add virtio drivers.

commit a32d92e4205a2d6766cd138671a1ec62fbe811f5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 30 14:12:26 2014 +0100

    v2v: When inspecting Linux guests, collect kernel version & location of initrd file too.

commit 5cf5c3f1c79d66238de5ebe6dae57b5ff93cbe21
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 30 14:08:43 2014 +0100

    v2v: Change source disk into a struct.
    
    Simple code refactoring, allowing us to collect the target/@dev
    attribute in this (now) structure.

commit 544b087d4b4ee92239d26211effe192da4f71d38
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 1 16:12:32 2014 +0100

    generator: Sort the structs.
    
    Sort the structs when generating code.  Since the structs are
    logically indepedent of each other, this should have no effect except
    to make generated files list the structs in a different order.
    
    However this also fixes the following build problem:
    
      File "convert_linux.ml", line 322, characters 43-50:
      Error: This expression has type G.stat = Guestfs.stat
        but an expression was expected of type G.dirent = Guestfs.dirent
    
    It turns out the OCaml bindings don't like the fact that we have
    two structs with a common field name (dirent.ino and stat.ino).
    
    In OCaml < 4.01, this means that any attempt to reference stat.ino
    would fail because dirent.ino appears second in the file, overriding
    stat.ino.
    
    Sorting the structs has the side effect of making stat.ino appear
    second, thus resolving the build failure above.
    
    In OCaml >= 4.01 the compiler now uses some disambiguation rules based
    on the known types to resolve this problem, so accessing either field
    would work no matter what order they are listed in.
    
    See:
    
    http://ocaml.org/releases/4.01.0.html
    http://www.lexifi.com/blog/type-based-selection-label-and-constructors
    http://www.lexifi.com/blog/ocaml-extensions-lexifi-overidding-record-labels-and-constructors

commit 16e817456cf7e5162ba053c92f1a4df24a4160d5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 23 15:17:02 2014 +0100

    v2v: Modify conversion step to first do proper inspection and data
    gathering about the guest.

commit b6b9b90dd74c7b9204bdf218aa9360e117308e78
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 24 16:49:28 2014 +0100

    Use -v and -x flags consistently across OCaml virt-* tools.
    
    virt-customize:
    virt-sparsify:
    virt-sysprep:
    virt-v2v:
      - These tools consistently used -v to mean verbose/debugging
        and -x to mean enable libguestfs tracing.
    
    virt-builder:
    virt-resize:
      - These two tools did not recognize -x at all, and used -v
        to enable libguestfs tracing and general debugging.
      - This commit changes these two tools to consume -v/-x
        consistently with the other tools.
    
    Unfortunately this has a cascade of effects through the code.

commit 5d3ec4474c955672c761ac11a178f29581985cd2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 24 16:18:36 2014 +0100

    mllib: Rewrite text wrapping function so it can handle newlines within the text.

commit 9aa0969d8d6f9d8d20b2e9912e8ad7128fcad50d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 24 12:24:04 2014 +0100

    virt-cat, virt-ls, virt-edit: Fix typo in documentation.
    
    This fixes the following:
     commit aad3c467fb47d3aa0720624c20561cd8eb34072b
     commit de5e7331afbb83ffac509e899851e791191922b3
     commit 86706907af1adea96820ec2c5aa4222fcc4065b0

commit e46bbb45d1ea7432a21b8e7b1b8b1dd2efa79c12
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 24 08:28:28 2014 +0100

    Version 1.27.19.

commit 77a963886fc803de8f776ad0ba8d30634ebb9a95
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 23 17:10:50 2014 +0100

    v2v: Refactor common code for listing files in packages.
    
    At some point we should make these into real libguestfs inspection
    APIs.  However they are fairly hard to implement, at least for RPM.

commit 7a68afed14ff9623f5c643e185ab49af6f1505c7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 23 15:27:37 2014 +0100

    v2v: Move app2_version comparison functions to utils.
    
    Refactoring.

commit 5b29d9a1a8b22006e8ecfc18a0c1fa545ccb5132
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 23 15:08:11 2014 +0100

    v2v: Create apps_map when doing inspection step.

commit 6705be2379aaf88bf3c8c25ab3ab7ac8fe2da716
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 23 15:02:51 2014 +0100

    v2v: Create a shared StringMap module.

commit 9975bf8eb3dd34a88544e49e736ff4e3825602e1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 23 14:15:28 2014 +0100

    v2v: Rename Convert_linux_enterprise -> Convert_linux.
    
    Just module rename.

commit 76bf3f7289c6d43e9b240299e37079bb03afc4f4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 23 14:12:42 2014 +0100

    v2v: Rename Convert_linux_common -> Lib_linux.
    
    Just library name refactor.

commit 6f73266363af412004b31ade1812be06a916c402
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 23 11:57:48 2014 +0100

    mllib: Add a common 'warning' utility function.
    
    This commit changes many places in OCaml utilities that print
    warnings to use the warning function instead.

commit b24b0b17a8ab5854c020cb1172597d805b911c73
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 23 11:49:10 2014 +0100

    mllib: Add an interface for Common_utils library.
    
    It turned out that Common_utils was exporting the 'G' module (an alias
    for Guestfs).  We want any code that uses G as a shortcut to declare:
    
      module G = Guestfs
    
    at the top, since that avoids confusion for newbie (or experienced)
    OCaml programmers.

commit 273f3464654ebb10de9d53e3c1f225e8f3aade6e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 20 13:34:54 2014 +0100

    v2v: Warn only if virtio packages are missing from the guest.
    
    In this version of virt-v2v you have to install a virtio
    capable kernel before doing the conversion.

commit 8ed27e7865e6ce0dd85697fe133fdf3bf486080b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 20 13:22:59 2014 +0100

    v2v: In convert function, add a hash of app name -> app structure.
    
    For quicker lookups than searching the linear list.

commit 7b89f657c46357eff87878638289f7d1b3258c1d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 19 15:32:29 2014 +0100

    mllib: Move common code for comparing version strings to library.

commit 90bf3422c5333b3bb295d6fc466d4cf429b8301e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 19 13:29:15 2014 +0100

    v2v: When parsing input libvirt XML, get correct disk image format.
    
    Old Xen PV guests had:
    
          <driver name='tap' type='aio'/>
    
    The previous xpath expression matched any driver type attribute in
    order to pick up the format.  However we only want to match:
    
          <driver name='qemu' type='raw'/>
    
    so we need to check the name attribute as well.

commit af31670d03b83df424cfa540cc6020cce1a8340d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 19 13:28:22 2014 +0100

    v2v: Avoid segfault if xpath expression doesn't match any nodes.
    
    I'm not sure if this indicates that the xpath expression is wrong, but
    in any case it can be that xpathobj->nodesetval is NULL.  In this
    case, return 0 from xpathobj_nr_nodes instead of segfaulting.

commit 877583a6f4e1a09abc24633d4e68198a2f7d6f59
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 19 12:13:43 2014 +0100

    v2v: In -o local mode, name disks <name>-sda instead of disk-sda.
    
    This allows us to use the same shared output directory for multiple
    parallel tests.

commit 8ad5698d0297a4c52515593a102d03c2a7dbe3c8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 18 14:37:34 2014 +0100

    v2v: Print \n after warnings.
    
    Using eprintf so this is not implicit (unlike 'error' function).

commit beef28fe9687c962ea095776288c6a90ffef92cf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 18 14:18:41 2014 +0100

    v2v: Dump out 'source' structure when debugging.

commit 2f616342150c4fed21a443df23625367cfec886e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 18 14:18:21 2014 +0100

    v2v: string_of_overlay already has trailing \n, don't need to add one.

commit 437e387c4d7f00892c01d7b149390b0e125e9805
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 18 14:17:48 2014 +0100

    v2v: Print qemu-img source overlay command when using -v.

commit c62dbb8afd5995e6221df48db0e4f058ebc56c40
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 18 14:08:14 2014 +0100

    run: Add v2v/ subdirectory to $PATH.

commit 27e1b6ca8b39eace5fb7162af4e4ba16c05d0b34
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 18 14:06:50 2014 +0100

    v2v: Allow relative paths to appear in -i libvirtxml input.
    
    When writing libvirt XML by hand, or for tests, this is
    immensely useful.

commit c3c659e996b18a8b7ccdf8e2df673bbaa99aa7a7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 23 21:38:33 2014 +0100

    rescue: Use guestfs_add_drive_scratch to implement the --scratch option.

commit bb3ba0c43a515ecb1444f7f3d97e6f30b3b9a610
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 23 21:26:23 2014 +0100

    options: Compile out part of union which cannot be used when not compiling guestfish.

commit 86706907af1adea96820ec2c5aa4222fcc4065b0
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Jun 23 15:56:15 2014 +0200

    edit: add -m option
    
    Implement the -m/--mount as available in guestfish to override the
    automatic introspection and specify which partitions to mount instead.

commit de5e7331afbb83ffac509e899851e791191922b3
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Jun 23 15:54:00 2014 +0200

    cat: add -m option
    
    Implement the -m/--mount as available in guestfish to override the
    automatic introspection and specify which partitions to mount instead.

commit aad3c467fb47d3aa0720624c20561cd8eb34072b
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Jun 23 12:54:33 2014 +0200

    ls: add -m option
    
    Implement the -m/--mount as available in guestfish to override the
    automatic introspection and specify which partitions to mount instead.

commit 54c77f99cc0dada27a3e13e22a6afd4a69a98576
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 20 11:06:23 2014 +0100

    builder: Update centos.sh to add CentOS 7 QA.

commit 8d6cbd05cae7420385709a5bbd0e79d35ef6df5d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 17 17:40:48 2014 +0100

    website: Install HTML version of the virt-log(1) man page on the website.

commit cd111bd0e3f4052e256b9e0b823b8af943aac9f5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 17 17:40:00 2014 +0100

    virt-v2v: Remove text from README, moved into test data repo.
    
    There is (will be) a new repository containing the large/proprietary
    test images.  Move the README related to this to the new repo.

commit e6a067e183cda42e1ab3596536ab850986c25516
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 16 12:49:02 2014 +0100

    Version 1.27.18.

commit 98a1392849da06c0579c2506a30e5c7d52a93b52
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 16 12:25:05 2014 +0100

    virt-log: Fix memory leak because of wrong type of CLEANUP_* function.
    
    This fixes commit a3475cf9bbbbd3514b117d5edd75d9c0e239d43a.

commit cd15b2ead6b25554ad6c13ee5c1463c06f0895b2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 16 10:53:59 2014 +0100

    Version 1.27.17.

commit c1dd8e80ba687a88a9ee84033f331df0bebc78e7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 16 10:50:58 2014 +0100

    tests/guests: Add new file debian-syslog to EXTRA_DIST.
    
    This fixes commit 026342a7ee20cd31d4de6c212e848791f7099d5e.

commit 0c38cd4d25eb32187341d3642be51053577d7ceb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 16 10:14:06 2014 +0100

    virt-log: Add support for displaying the Windows Event Log.
    
    Uses the external program python-evtx, and this only works
    for Windows >= Vista.

commit d167da86d922d1c9341848117f7ce140a92dd951
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 16 10:31:29 2014 +0100

    virt-log: do_log_journal: return instead of exiting immediately.
    
    This cleans up commit a3475cf9bbbbd3514b117d5edd75d9c0e239d43a.

commit fb546eaee064b14ad192a4f0390325ba1b4c766a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 14 10:50:36 2014 +0100

    New tool: virt-log: It lists log files from within the guest.
    
    See 'TODO' file for suggested future improvements.

commit 026342a7ee20cd31d4de6c212e848791f7099d5e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 14 11:52:01 2014 +0100

    tests: guests: Add a text syslog file to the phony Debian guest.

commit 2d996df66c8d67e11a91a89c074c91a233356494
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 14 13:27:02 2014 +0100

    New API: journal_get_realtime_usec
    
    This adds a binding for sd_journal_get_realtime_usec(3).

commit e5276e4455f74ca3ad76d93a6ca41a7175038c0f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 13 22:48:18 2014 +0100

    Version 1.27.16.

commit 31c07bc9d8128f838671a68884613a512282ea5a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 13 22:42:42 2014 +0100

    podwrapper: Put =encoding line before first POD directive.
    
    =head isn't always the first POD directive.
    
    This fixes commit 1148bd91ce2c0bebc65f9855368fd026aaf9f603.

commit 1148bd91ce2c0bebc65f9855368fd026aaf9f603
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 13 14:22:50 2014 +0100

    podwrapper: Put the =encoding line at the correct place in the input (RHBZ#1109174).
    
    Commit c4dc70f8c43a7faae2a8698027a4ed23d316dfa0 broke the man pages
    for the Perl scripts in the tools/ directory.
    
    It inserted the =encoding line at the top of the file, instead of in
    front of the first =head1 entry, and this meant that the #!/usr/bin/perl
    and the prologue became a part of the POD, which was not intended.

commit 870c17e99acd038daed9b4004c66d401679475ab
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 13 13:34:38 2014 +0100

    sparsify: Add --tmp option to allow specifying temp directory or block device.
    
    Add the virt-sparsify --tmp option.
    
    This works in two ways.  Either you can specify a temporary directory,
    in which case it's just the same as setting $TMPDIR before:
    
      virt-sparsify indisk outdisk --tmp /var/tmp
    
    Or, as a new feature, you can specify a block device which is directly
    used (and OVERWRITTEN):
    
      virt-sparsify indisk outdisk --tmp /dev/sdX
    
    This is useful for oVirt nodes, where there is limited temporary
    space, but a block device can be assigned to the node.
    
    In both cases it is only used in copying mode.  In-place
    sparsification doesn't require large amounts of temporary space.

commit 893bfe2e36f5a766e822b14fe5e7e4fc9b2b3f75
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 13 13:34:01 2014 +0100

    mllib: Create a common utility function is_directory.
    
    This is a wrapper around Sys.is_directory which doesn't throw
    exceptions.

commit 9b5cdc874784437d7a59bd024043c2abd930b6c3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 12 13:28:03 2014 +0100

    fuse: UID 0 should override all permissions checks (RHBZ#1106548).
    
    Previously if you were root, and you tried to change directory into a
    directory which was not owned by you and not readable (eg. 0700
    bin:bin), it would fail.
    
    This doesn't fail on regular directories because when you are root the
    kernel just ignores permissions.
    
    Although libguestfs in general tries not to duplicate kernel code, in
    the case where we emulate the FUSE access(2) system call,
    unfortunately we have to do it by stat-ing the object and performing
    some (half-arsed) heuristics.
    
    This commit modifies the FUSE access(2) system call, so root is now
    able to chdir to any directory.
    
    It also adds some debugging so we can debug these complex permissions
    checks in the field if some other problem arises in future.

commit 87ac1c186eee81165003bb4d0196e147611527ba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 12 22:18:02 2014 +0100

    builder: Don't copy *.xz files to WEBSITEDIR.

commit bacc7fd0a3aa7cfe9ecd1a3740f9f7891cd90196
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 12 22:13:25 2014 +0100

    builder: Rebuild Fedora 19 disk image with Xen drivers.

commit 005316b7d869c505df0d8d39a96861e918351f3d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 12 15:42:33 2014 +0100

    builder: Get rid of remaining disk image signatures.
    
    These were deprecated and replaced in virt-builder 1.24.1.

commit 58ea77e79becc14e5ddacc0f37f41fac3a3f14e3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 12 15:38:52 2014 +0100

    builder: Update Fedora 20 image, with Xen drivers.
    
    This commit also removes the disk image signature.  These have not
    been needed since virt-builder 1.24.1.  No one should be running that
    version of virt-builder since there are newer 1.24 branch versions.

commit 0fa52e4e45d80874bc5ea5f112f74be1d3f3472f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 12 13:49:43 2014 +0100

    builder: Fedora: Enable Xen driver support.
    
    See:
    https://www.redhat.com/archives/libguestfs/2014-June/thread.html#00045
    
    Notes:
    
    (1) Edit dracut configuration to make sure the change is permanent, in
    case kickstart, virt-builder or something else installs a kernel or
    runs dracut.
    
    (2) We need to run dracut on the just-installed kernel, not on the
    running kernel.  The snippet to do this was copied from the Fedora
    cloud kickstart.
    
    Thanks: Olaf Hering, George Dunlap, Dario Faggioli.

commit d4d6540b24ac82fd7344db10e96270cc0a28aa68
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 12 13:49:09 2014 +0100

    builder: virt-install now requires '--serial pty' parameter.
    
    This updates commit 73ebaa30668ce7d9e3e413c3abf67a74829dfe5d.

commit 73ebaa30668ce7d9e3e413c3abf67a74829dfe5d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 11 12:43:03 2014 +0100

    builder: virt-install now seems to require '--serial pty' option.

commit 99472ab2e925a43e9ba51e62ee66145e92209b8f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 11 12:42:08 2014 +0100

    builder: Further updates to RHEL 7 GA script.
    
    The location of the trees have moved ... again.

commit 24800d2e96b668252e30977f3af81aa3b2195eef
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 11 08:21:34 2014 +0100

    builder: Update rhel.sh script for RHEL 7 GA.
    
    Set the rootfs for RHEL 7.x to xfs.  (/boot is ext4)
    
    Remove old RHEL 7 beta & rc releases.

commit 0dbdc470ed7a6fe7251929ee6f4dfeb8ddc01625
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 10 21:10:27 2014 +0100

    Version 1.27.15.

commit 7faa602e8f86702418e11572603badbfbb14f6b7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 10 19:31:06 2014 +0100

    launch: libvirt: Only use serial BIOS (sgabios) on x86.
    
    This device is not present at least on ARM.  Unfortunately libvirt
    doesn't give us any way to query when the device is present.
    
    This fixes commit bed592498d791c5ce6ad722f41dcbfbe243b0a7a.

commit e6a858907fd7851148440dcfc7cbabc5cee75a71
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jun 10 15:18:38 2014 +0200

    appliance: init: properly set PS1 and TERM for virt-rescue (RHBZ#812970).
    
    Setting environment variables such as PS1 for bash before starting it
    might not be effective when the startup scripts provided by the
    distribution unconditionally change it.
    Hence, set PS1 and TERM in a ~/.bashrc, which will be source'd last and
    thus be able to set them the way we want.

commit 844066597dc9ed92c0685c136f613c06276c6132
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jun 10 15:18:37 2014 +0200

    daemon: grub: show grub-install's output on error if verbose

commit 45db96b00dde2eb9429efbdc2f57bb1bbafafc03
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jun 10 15:18:36 2014 +0200

    daemon: print parameters for vgchange in error messages

commit 134ac97d22065224e200d6cd72231d116b45f054
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jun 3 14:48:51 2014 +0200

    daemon: retire the augeas feature
    
    Augeas has been a mandatory dependency of libguestfs for quite some
    time, so the aug_* functions could have been always called (without even
    checking the augeas feature). Thus retire the feature, marking it as
    always available with no more functions depending on it.

commit b28ef8791a21751b1def9f84108fec14ea73ffa9
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jun 3 14:37:41 2014 +0200

    builder: handle duplicated images (RHBZ#1092753).
    
    Filter the available images, removing the versions with an older
    revisions, and duplicates.

commit aeb879247456c619040d3a01a47a08ffa14c03f7
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jun 3 10:14:21 2014 +0200

    inspect: tighten NetBSD detection
    
    It seems recent (?) NetBSD versions have their kernel as /netbsd, so
    also check for it to detect NetBSD installations.
    
    The current detection so far basically relied on generic files and
    directories which can potentially be in every UNIX system, misdetecting
    them if a /etc/release file is present in them.

commit 5efbc8922ff3f338deb17b42bc7b63cc1545fcc0
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Jun 2 21:24:35 2014 +0200

    fish: list also aliases in the guestfish help (RHBZ#1103877).
    
    Output also the aliases (telling which function they refer to) in
    `guestfish -h`, together with non-alias functions.

commit 6577f34a687f339304f20ac703a2e468865a4297
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Jun 9 09:59:20 2014 +0200

    appliance: remove extra comma in Mageia's list
    
    Followup of commit 00d94d95c805ee027a9ef9e67f3979f1faada4a7.
    
    Thanks Thierry Vignaud for the notice.

commit 0196724330117232868b83bce709559ba3784952
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 30 18:08:26 2014 +0100

    Version 1.27.14.

commit 4d8ecb0d30b8e0c49ddb750b5102a2cb67fdd2b5
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu May 29 10:32:15 2014 +0200

    generator: fix daemon functions with optional params but no mandatory params
    
    The
      struct guestfs_$function_args args;
    declaration was not emitted in that case, leading to build failure.

commit 00d94d95c805ee027a9ef9e67f3979f1faada4a7
Author: Joseph Wang <joequant@gmail.com>
Date:   Thu May 29 08:46:20 2014 +0100

    appliance: Update packagelist for Mageia (RHBZ#1102448).

commit ef49b297cc56668da01efa637fb80007a76d23dd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 27 11:48:44 2014 +0100

    appliance: Increase udev timeout to 6000s (RHBZ#1096579).
    
    If the image is located on NFS, and the NFS mount is performing a
    large copy, then all other NFS operations stop.  This delay can be
    large enough that we hit the current 10 minute timeout in udev.
    
    Increasing this to 100 minutes is reported to cure the problem (in
    reality we want udev to wait indefinitely).

commit 917ca11a76863075b4fcb13fe0eec0c2a6a08892
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue May 27 11:02:58 2014 +0200

    ruby: add :nodoc: comment for internal methods
    
    This way they are ignored by rdoc.

commit e4005bd530aab62a8d86cfc7cb5db1c69ae873dd
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue May 27 10:57:13 2014 +0200

    builder: support aliases for images (RHBZ#1098718).

commit bed592498d791c5ce6ad722f41dcbfbe243b0a7a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 26 12:20:10 2014 +0100

    launch: libvirt: Add -device sga (sgabios).
    
    This feature was added to libvirt in 2011-07-08 so we can assume it
    exists.
    
    Thanks: Jiri Jaburek

commit 1fbf0a88f6c4e5648af8ec64e3933683078f4a94
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun May 25 22:34:51 2014 +0100

    fuse: Make all the skip messages consistent in this test.

commit f32aef2971497872c179cb16dd1a1d922c46587e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun May 25 22:34:04 2014 +0100

    fuse: Skip test-fuse-umount-race.sh if backing file does not exist.

commit 068455f21005aa7cf7ea9c0a82e01f2cf58659e1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun May 25 22:28:27 2014 +0100

    fuse: Skip guestmount --fd test if /dev/fuse does not exist.
    
    When we run guestmount (eg. in Koji) it will fail anyway, so don't run
    the test.

commit 2c460ac52f3df25897d93266aac717c3f1147797
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 24 19:17:46 2014 +0100

    Version 1.27.13.

commit 32f5d998731e1c0deed6ec80f5c873697986147e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 23 11:46:43 2014 +0100

    fuse: Add a test of guestmount --fd option (RHBZ#1100498).

commit 145c7ed5eeaaa491f91a8e31ff655df4177b1a5e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 23 11:27:37 2014 +0100

    fuse: Add guestmount --fd option (RHBZ#1100498).
    
    This implements the guestmount --fd option to allow you to run
    guestmount captive under another process (typically using
    `guestmount --fd=<FD> --no-fork').
    
    See: https://bugzilla.redhat.com/show_bug.cgi?id=1100498

commit a60212ee99de88591d060a95b30aa0e0cece5832
Author: Hilko Bengen <bengen@debian.org>
Date:   Thu Dec 12 21:06:22 2013 +0100

    golang: Fix for out-of-tree builds
    
    RWMJ:
    
    This is half of a downstream Debian patch to fix out-of-tree builds
    for golang.

commit ee9981714fbb266ff58450b8dd4c3568b284df77
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 23 11:04:20 2014 +0100

    Version 1.27.12.

commit 5d5e66ce334bf61bcc2e672d17d84dd0dd0dd364
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed May 21 15:03:17 2014 +0200

    daemon: scrub-file: resolve the path before calling scrub (RHBZ#1099490).
    
    Resolve the given path within the chroot, so scrub can be invoked
    outside the chroot on an already-resolved path.
    
    Add few tests in scrub-file for this and other similar issues.

commit d7aec9c0d31c14b97c0bb93595d492fdd3741143
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed May 21 15:01:50 2014 +0200

    daemon: add sysroot_realpath
    
    Similar to sysroot_path, but first resolves (using realpath) the given
    path within sysroot.

commit 05f84f4c214f9b91862ba63398a2e248e0e7d92d
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed May 21 14:58:40 2014 +0200

    Make realpath mandatory
    
    commit a86eb0e0d2c67e2153139c681632edc72162b8ed made it an optional
    feature, as on Windows it was not available; on the other hand, realpath
    has been used unconditionally already for quite some time, so having
    just the "realpath" command conditional on the presence of it does not
    make much sense.
    
    Drop the configure/build system handling of it, make the "realpath"
    command no more optional, and keep the "realpath" feature as
    unconditionally available now.

commit 50ed922a02c7316749d94dcaf81752d239124030
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed May 21 14:39:30 2014 +0200

    generator: add always-available optgroups
    
    Support the possibility to have optional groups always enabled (e.g.
    because they were present in the past, and they need to be kept for
    users).
    Add and use few helper optgroups-related functions to deal also with
    them.

commit 865f64006e9bab5c1c5efdfd9e8ceee140c8d998
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 21 09:36:34 2014 +0100

    ppc64: Use console=hvc0 console=ttyS0.
    
    console=ttyS0 used to work.  Now it's broken again, and the correct
    setting appears to be console=hvc0.  Since we can pass multiple
    console settings, do that to try and catch the right console.

commit 84189b370a0db5670e2a2d7a5b3d79cffdb67ed5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 20 13:13:39 2014 +0100

    Update guestfs-release-notes.txt.
    
    This updates commit a21dfc483c5102334d8c490a50077ec201ffe2e4.

commit 697b0d46782e1c4eb4bc927e54012e0ff8205b2d
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue May 20 13:31:07 2014 +0200

    fish: simplify output of 'supported'
    
    Print each line at once, making use of the padding features of printf
    instead of doing it manually.

commit a21dfc483c5102334d8c490a50077ec201ffe2e4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 20 10:45:33 2014 +0100

    Fix some spelling mistakes and typos in documentation (RHBZ#1099284).

commit e014ef33ab80de10df0bcdd73ff774310af3910a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 20 10:40:17 2014 +0100

    Update BUGS.

commit f49e003a875ce5703b7e8d4109a145ebe673129d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 17 11:15:54 2014 +0100

    p2v-iso: Add a kickstart target.
    
    This also changes the old p2v-iso/README file into a POD file
    which is installed as a manual page.

commit 1939cd4849ff3e52e76ddb91d9acd30bca3a0495
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 17 10:58:00 2014 +0100

    p2v-iso: unset CDPATH, set -e at the top of the virt-builder-target script.

commit c65fbeebb8482fede853445d639ddb6642fd3c1b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 17 11:44:46 2014 +0100

    configure: Move --with-default-backend test later in configure.ac.
    
    For some reason this test was right at the top of the script.

commit c5106511e004c90a0e538a6d39e3c32fbfea108e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 17 11:35:31 2014 +0100

    build: Use AC_PROG_AWK to define the right awk to call.
    
    We actually call plain 'awk' in many different scripts, but this
    commit does not change all of those.

commit 044ecdb9036d338a32e66a71745f9f946931e4f6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 17 10:38:59 2014 +0100

    builder: Make the summary printed at the end easier to read.
    
    This is just a whitespace change.  The new output looks like this:
    
                       Output file: fedora-20.img
                       Output size: 4.0G
                     Output format: raw
                Total usable space: 5.2G
                        Free space: 4.5G (86%)

commit 467bddd3b72fd62bae9695f644182b5dcc5cbd5b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 16 12:54:46 2014 +0100

    p2v-iso: Use xorg-x11-drivers meta-package to install Xorg drivers.
    
    Thanks: Andrew Price.

commit 8e6ddbdf708282324acbe0367a5961768cb4747e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 16 11:10:06 2014 +0100

    Version 1.27.11.

commit a09146386ce14e8899b8816894afe83f78604480
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 16 08:45:47 2014 +0100

    virt-p2v: Install the binary in libexecdir.
    
    Previously it wasn't installed at all.  However it makes sense to
    install it somewhere so that it can be placed in a package (a
    requirement if we're going to create a kickstart).  By placing it in
    libexecdir it is hopefully clear that it should not be used.
    
    Note on Red Hat distros, libexecdir is usually /usr/libexec.  On
    Debian it is usually /usr/lib/libguestfs.

commit 45971ab95222204a1b8d9a311a739c453308cade
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri May 16 11:05:40 2014 +0200

    build: bump the libsystemd-journal needed version to 196
    
    Bump to >= v196 the minimum version of libsystemd-journal needed for the
    journal integration, since that version provides
    sd_journal_get_data_threshold and sd_journal_set_data_threshold.

commit 77166308fad1ca970c5cdba785db4c36e44ea971
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 15 23:00:46 2014 +0100

    Version 1.27.10.

commit 047b6d3050a8e7b07f21df62044673380c6f897a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 15 13:43:18 2014 +0100

    Add p2v-iso directory containing scripts for building the virt-p2v ISO.
    
    It is not possible to have the ISO be built automatically when the
    user runs 'make'.  The README file describes how you should go about
    building the ISO or disk image.

commit fd82bb12fd5fc8233955b8ffd4a42c3d6f8d748b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 23 21:27:52 2014 +0100

    New tool: virt-p2v.
    
    This is a graphical standalone front-end to virt-v2v which can be run
    on physical machines (usually linked into a ISO or PXE boot image) to
    convert the physical machine to a virtual machine.

commit 0131d6f666d93dd353c4e4092fd945861646d319
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 1 14:41:30 2014 +0100

    New tool: virt-v2v.
    
    This is a rewrite of the original virt-v2v tool.  The original was
    written by Matt Booth et al in Perl between 2009 and 2013.

commit 40d9609b29b462b80821e9e6acc5dc5a9e4f01d8
Author: Maros Zatko <mzatko@redhat.com>
Date:   Thu May 15 14:44:36 2014 +0100

    generator: Change link to OCaml tutorials.

commit 1a1cb1ec3cdc24262db4de2f8bf12d3479096882
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 12 22:19:08 2014 +0100

    builder: Fix RHEL 5 download location.
    
    This fixes commit 3bc9ba6c8447cde07db057aea76d0d72f5d833df.

commit d2bfe2cb24a53f6968b1a4b54cfc7299e33cfeaf
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed May 14 17:59:31 2014 +0200

    builder: respect the proxy also when downloading images (RHBZ#1096465).
    
    Missing from commit 87d79c2ee259ce51595ad3a924fd216f882dc477.

commit b6c8afaee63e26de42695244eacbeb81b06171a9
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed May 14 17:28:13 2014 +0200

    builder: save the proxy for each entry
    
    Copy the information about the proxy of a source in all the entries of
    that source; this way it is possible to use it later when accessing to
    the actual image of an entry.

commit 3bc9ba6c8447cde07db057aea76d0d72f5d833df
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 10 17:18:39 2014 +0100

    builder: Fix RHEL script for RHEL 5.
    
    Root partition is on /dev/sda2:
    
    $ virt-filesystems -a rhel-5.10 --all --long -h
    Name       Type        VFS   Label      MBR  Size  Parent
    /dev/sda1  filesystem  ext2  /boot      -    510M  -
    /dev/sda2  filesystem  ext4  /          -    4.5G  -
    /dev/sda3  filesystem  swap  SWAP-hda3  -    1.0G  -
    /dev/sda1  partition   -     -          83   510M  /dev/sda
    /dev/sda2  partition   -     -          83   4.5G  /dev/sda
    /dev/sda3  partition   -     -          82   1.0G  /dev/sda
    /dev/sda   device      -     -          -    6.0G  -
    
    It would be better if we could mount by label in guestfish ...
    
    There is another problem with RHEL 5 guests in that the
    yum URL is slightly wrong.

commit 75022489c81242a6717e579ff6c5f8dc8ec6cbf6
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Fri May 9 11:14:55 2014 +0200

    appliance: update Debian-specific package list

commit 944a601020aeb4acc0646958aac7b65d2a3ed2e6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 10 12:11:11 2014 +0100

    builder: Add Ubuntu 14.04 disk image.
    
    Also remove the Ubuntu 13.10 image, since it's not an LTS image.

commit a1fcd2ca5f24d4646b40408bbbaffb74fb20d9e6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 10 10:45:15 2014 +0100

    builder: ubuntu: Allow virt-install --os-variant to be specified on the command line.
    
    Current virt-builder in F20 does not know about --os-variant=ubuntutrusty
    so to build that you can now do:
    
      ./ubuntu.sh 14.04 trusty ubuntusaucy

commit c7888ac61846aa1d21f0ff5dd19b046590b83072
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri May 9 15:06:50 2014 +0200

    configure: always add the extra warnings
    
    Get rid of --enable-gcc-warnings and just add all the warnings in any
    case; they are tested anyway, so only warnings supported by the compiler
    will be used.
    
    Regarding -Werror, add a new --enable-werror which enables its use.

commit a880bc1eb00909e64093f06a4373942a9b264616
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri May 9 12:20:33 2014 +0200

    tests/syslinux: add new syslinux 6+ path of mbr.bin
    
    Reported in https://bugs.debian.org/746748.

commit f46d53be18f586daa6e3e8ed4975da26c940b203
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri May 9 12:19:47 2014 +0200

    tests/syslinux: factorize search for mbr.bin

commit 5e574bb3049dac4a8f1f9b4a1cccbbbc3c15dc9e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 7 14:42:03 2014 +0100

    Version 1.27.9.

commit a651990fb12e2cc972e8a984378ec3d57bdce27c
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed May 7 15:45:07 2014 +0200

    test-charset-fidelity: allow to skip testing specific FSes
    
    Allow to skip testing the filesystem "foo" if the environment variable
    SKIP_TEST_CHARSET_FIDELITY_foo=1 is set. This way it possible to not
    test one or more filesystems without disabling the test altogether.

commit 3633109ff35f1d0f6bc72ed129911db6c4ae5c8e
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Apr 30 18:10:32 2014 +0200

    Fix handling of passwords in URLs
    
    So far, passwords in URLs (eg http://user:password@host..) have been
    handled as part of the username, and thus passing
      add-drive path username:username:password ...
    instead of
      add-drive path username:username secret:password ...
    
    Fix the parsing of URLs to handle passwords as separate elements,
    properly passing it as "secret" parameter for add-drive, and properly
    readd it when building URLs in the direct backend.
    
    Furthmore, to keep curl- and ssh-based qemu drivers working with
    authenticated resources, make sure they can accept secrets.
    
    Reported in comment #1 of RHBZ#1092583.

commit c24ce0811df8a3f1bf1cff5ccd3e89b948f696d0
Author: Nikos Skalkotos <skalkoto@grnet.gr>
Date:   Mon May 5 17:24:04 2014 +0300

    inspect: Add support for Oracle Linux
    
    Prior to this patch the library would return "rhel" instead of
    "oraclelinux" for Oracle Linux OSes.

commit 9e829363932c0db12f38e64763348f65380752f9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 3 16:47:48 2014 +0100

    New API: cpio-out converts a directory to cpio format.
    
    This is useful for generating Linux initramfses from other types of
    filesystems.  For example:
    
     guestfish --ro -a disk.img -i cpio-out / - | gzip -9 > initrd.img

commit c67e16734ce41b1ec8ec146531bcec20573fec7f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 7 09:04:23 2014 +0100

    sparsify: Add a note about qcow2 internal snapshots not being copied (RHBZ#1094746).

commit 2bd75a1ea1e606780915eeba5048f4bf8af84de9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 5 15:54:30 2014 +0100

    customize: random-seed file has moved again.
    
    Thanks, systemd.

commit 845daded5fddc70fc5e822769bc1e2a8cbead7ca
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue May 6 19:22:14 2014 +0200

    lib: xmlParse{File,Memory} -> xmlRead{File,Memory}
    
    Switch from xmlParse* to xmlRead* so we can explicitly specify parsing
    flags, including no network usage and no entity resolution.
    The two behaviours mentioned above were not done before either, so this
    should not introduce behaviour changes in libguestfs.

commit 4dc42693f23bd38393de001e8c45f22aac9e8292
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun May 4 20:57:33 2014 +0100

    guestfs-recipes: Fix language.

commit be874d7f509bd0ae9098cd2ac8d060865a57891b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 2 11:25:21 2014 +0100

    Version 1.27.8.

commit c2488b6ed832ce6899ed083530f4cfc68d5f2e97
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 2 11:24:45 2014 +0100

    builder: Add RHEL 7 signature to EXTRA_DIST.
    
    This fixes commit fea553778a1f38b8c0dc3bf76a67725f0cee9094.

commit 0c1a4b1781447d5b485b38e06fe3dcf486ab009d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 2 10:55:21 2014 +0100

    launch: direct: Turn gdb into a backend setting.
    
    You can now use LIBGUESTFS_BACKEND_SETTINGS=gdb in order to enable gdb
    debugging of the appliance.  This only works with the direct backend.

commit c4a91a1866ddba3a52a2b9f2be7d66f519d958ba
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Tue Apr 29 23:18:01 2014 +0200

    launch: direct: Supply -M option when testing qemu for devices.
    
    qemu-system-arm 2.0 as currently available through Debian/unstable
    doesn't want to tell us anything about available devices unless we
    specify a machine type.

commit 1550a80d6c639cb1bd2a29bba8203a2b8cbb80ae
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Apr 30 15:52:49 2014 +0200

    daemon: xattr: factorize do_getxattr and do_lgetxattr
    
    Move all the common code to a new _getxattr function, much like done for
    other xattrs operations.
    
    Mostly code motion, no functional changes.

commit fea553778a1f38b8c0dc3bf76a67725f0cee9094
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 29 23:00:40 2014 +0100

    builder: Add RHEL 7RC disk image.

commit df5bd5741b37da9cf97d7a76ac2805557aa630db
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 29 15:43:20 2014 +0100

    builder: Fix parallel builds of index-parse.o.
    
    When parallel builds are enabled it was possible for index-parse.c to
    be compiled before the file had been completely written by bison.  The
    usual symptom was that the 'do_parse' symbol was missing -- this
    simply happened because that symbol is defined at the end of this
    file, and the compiler compiled the file before the end part was
    written out.  But you could also see other strange & random compile
    failures as you would expect.
    
    This was tested by running this script on an 8 core server:
    
     cd builder/
     export MAKEFLAGS=-j9
     while make clean >/dev/null; make all V=1 >& /tmp/log; do echo -n . ; done
    
    Previously it would fail after <= 5 iterations.  With this change it
    runs for at least 100 iterations.

commit 50b207ca459a205efeec613ab04ff4c39dc6bee2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 28 09:14:34 2014 +0100

    Add a regression test for RHBZ#1091803.

commit efd159a063410b3d9d13814222abed231ec42f90
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 28 09:51:00 2014 +0100

    tar-in: Fix places where we didn't cancel the receive (FileIn) correctly along error paths (RHBZ#1091803).
    
    Thanks: Bo Fan.

commit 8df792d4a76eb188fcbc68b38c8bc1e757a6f6ff
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 23 19:50:37 2014 +0100

    Version 1.27.7.

commit ae891bc5f59f44d575912a087bd09d16e2d60a6b
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Apr 23 10:39:51 2014 +0200

    builder: isolate all the cache handling to a new Cache module
    
    While there is not that much in it, it groups together the small
    scattered-around bits handling the cache directory.

commit 101d728e80cce73b882aac7af457013491d03311
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 22 22:21:57 2014 -0400

    configure: Make sure grep matches qemu 2.x version string.

commit 4f5dc4afdc56483a29044d9d5498b5c764bcbc6a
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Apr 22 17:58:27 2014 +0200

    builder: add "[ignored]" to parsing errors for .conf files
    
    Parsing sources .conf files is not a fatal error (that file would just
    be ignored), so explicitly state that such parsing errors are ignored.
    
    This should address the last bit in RHBZ#1077817.

commit e7c746854b27754807d3a61902c25325b18d525d
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Apr 22 17:57:05 2014 +0200

    builder: add an optional suffix string for INI parsing errors

commit 3f4903e53ab8ccb8b199e17f65d5d4c32ed626ad
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 22 14:14:12 2014 +0100

    Version 1.27.6.

commit b176bde942b2ee046383884eb6fa919c3fe68145
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 22 13:25:12 2014 +0100

    FAQ: Describe better how to compile libguestfs from source using alternate qemu/supermin/kernel.

commit 2f5e9066db817f75b245f256abc0c64dd1ae54eb
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Apr 18 11:39:21 2014 +0200

    ruby: tests: convert from Test::Unit to MiniTest (RHBZ#1085029)
    
    Convert the tests to the MiniTest test framework, but keeping the usage
    of the old Test::Unit as fallback in case MiniTest is not available.
    In the latter case, use a bit of "glue" to make the old API look like
    the new API, so we can just rely on the newer MiniTest API.

commit fbae7f3e69ce598c52af71ec204f8dbd0a9ce5e5
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Apr 18 11:27:11 2014 +0200

    ruby: tests: isolate boilerplate in common file
    
    Isolate in a common file all the standard boilerplate in tests, i.e. the
    import of the test framework and the guestfs module (including the
    import path hack needed for the latter).
    
    Thanks to Vít Ondruch for the precious hints and suggestions.

commit 0316d247706aab7ce7c2225472feeb51fa8b1664
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Apr 17 11:32:50 2014 +0200

    daemon: parted: part-get-name: switch from sgdisk to parted (RHBZ#1088424).
    
    Use parted to get the name of partitions in GPT layouts instead of
    sgdisk, to reduce the possible discrepancy between output of tools.
    
    The actual case here is that recent parted versions fixed/improved their
    UTF-16 handling of partition names in GPT, and sgdisk seems to not be
    properly handling them, returning also unicode control bytes.
    Since parted can provide partition names already, just make use of it.
    
    Since sgdisk is no more needed for part_get_name, the function is no
    more optional on it.

commit 909c10d758887958c9e077732fe9beead55ec4e4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 16 21:12:30 2014 +0100

    sparsify: If using -v (verbose), ensure #disk_create runs verbose too.

commit e1a82bb13064db97c2918485a0d9c52329677e62
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 16 21:12:30 2014 +0100

    builder: If using -v (verbose), ensure #disk_create runs verbose too.

commit 9515345bbdd81d9c8eb72f09207a4c090ea56d2c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 16 20:09:39 2014 +0100

    builder: Suggest using virt-install --os-variant option in virt-builder man page.

commit 27355c9b0b49fb988181c6ad70375aa6f490c558
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 16 11:43:23 2014 +0100

    disk-create: Fix this API so it works correctly with block devices (RHBZ#1088262).
    
    When you call guestfs_disk_create on a block device with format=raw
    then it will try to discard the blocks on the device.

commit 1898d457bdd138a90dd859cd14658ab48020a7b2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 15 23:29:03 2014 +0100

    Version 1.27.5.

commit 3c260f23d4a4256e892955d38116c91e7bd189af
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 15 18:03:53 2014 -0400

    configure: Fix tests of qemu on ARM.
    
    qemu-system-arm now requires that you pass '-machine virt' (or some
    -machine type) explicitly.
    
    Change the configure test so it works on upstream ARM.

commit 87d79c2ee259ce51595ad3a924fd216f882dc477
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Apr 15 14:15:14 2014 +0200

    builder: add per-repository proxy configuration
    
    Add the possibility to configure the proxy in each repository .conf
    file, specifying whether use no proxy at all, follow the system
    configuration or use a specific proxy.

commit 040694ab79c3dfa86df41ae9e76e13d287413c66
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 15 14:23:34 2014 +0100

    Version 1.27.4.

commit 8ae2a8a9365bdcb0474042d4ad654d46807c7bfa
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Apr 14 14:18:41 2014 +0200

    sysprep: remove also hidden files/dirs in temporary dirs
    
    List manually and remove the content left (hidden files/directories) in
    temporary directories after the glob listing & removal.

commit 8f3959e581fdbebce95637408f8f44388abc60f4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 14 11:42:33 2014 +0100

    sparsify: Fix automake build.
    
    Previous commit 97c57a8887e04742c58c3956385a5366c6df02c3 added a
    potential bug in the sparsify build.  If virt-sparsify had used a
    *.mli file then it would have tried to run a command like:
    
     ocamlc mlguestfs.cmxa -c foo.mli -o foo.cmi
    
    This would fail because ocamlc doesn't know about native code
    libraries (*.cmxa).  In fact virt-sparsify was not affected by this
    because it doesn't use any *.mli files.
    
    Fix this by adjusting the automake variables.

commit c78b932199096d061364db2fb1d6a679922664c9
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Apr 11 16:15:13 2014 +0200

    builder: set an empty XDG_CONFIG_HOME in tests
    
    This way they are affected less by the environment.

commit 47ec61e9af19f8a750750ad498adc10fa7ae0521
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 21 15:24:01 2014 +0000

    listfs: If LDM not available, don't inhibit partition detection (RHBZ#1079182).
    
    If a disk has type 0x42 partition (which would indicate LDM), but LDM
    is not available then try parsing the partition anyway.  It might be
    parseable as plain old NTFS.

commit 97c57a8887e04742c58c3956385a5366c6df02c3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 8 21:17:39 2014 +0100

    sparsify: Use automake to build and link virt-sparsify binary.
    
    There are two observations which make this possible: (1) virt-sparsify
    contains at least one C unit, so automake thinks it is compiling a C
    program.  (2) Automake lets us add a *_LINK rule to override linking.
    
    We list the C sources of virt-sparsify as virt_sparsify_SOURCES, so
    automake thinks it is building a C program as normal.
    
    We override virt_sparsify_LINK to make it actually link an OCaml
    program.
    
    We add virt_sparsify_DEPENDENCIES listing the OCaml objects so that
    they get built before linking.
    
    We need a small linker script (link.sh) which adds some options at the
    end of the linker command line which are impossible to add using pure
    automake.
    
    Inspired by the same idea in supermin:
    https://github.com/libguestfs/supermin/blob/master/src/Makefile.am

commit 65b8edda0a65f9a5cc35039712d246147ac02238
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Apr 9 13:56:16 2014 +0200

    sysprep: remove ConsoleKit logs

commit 54d1f6e6110c686f774befd4c16feccf718dd431
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Apr 9 13:42:22 2014 +0200

    sysprep: remove the exim logs

commit f7d2738902367ef7a02c1f0fb9ef9221b41faca8
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Apr 9 13:38:50 2014 +0200

    sysprep: remove apt and aptitude logs

commit d413c94fa6c302b948fcf5de560a184895a75142
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Apr 9 13:29:39 2014 +0200

    sysprep: remove debug, syslog and faillog logs

commit ccf84d7b80948ba807ef8ce0216f55f756c894ed
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Apr 9 12:00:00 2014 +0200

    sysprep: remove debian-installer files

commit b08955e76af958f96e3c8d807284e1c379c4f532
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Apr 9 11:38:47 2014 +0200

    sysprep: remove the lightdm logs

commit fc9a4221ba2020685643ac839ee324b9545aea50
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Apr 9 11:31:11 2014 +0200

    sysprep: remove more anaconda configs/logs

commit 0c35c3adddbd50d3dfeea356a49e23c711c18b06
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Apr 9 11:22:53 2014 +0200

    sysprep: remove systemd journals

commit ffffe71c16d8e0cc8537bbaa4d8cc9908f528eb7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 9 10:19:37 2014 +0100

    build: Remove code coverage and code profiling options.
    
    This reverts commit 5a2e320ec9390b2146feea6d7b3b8c36a34d0a90.

commit 595bd5022a251a396050c247003ac60328a7facf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 8 10:05:34 2014 +0100

    sparsify: Relax test constraint (RHBZ#1079210).
    
    As long as over ~300MB is recovered, declare sparsification to be
    successful in this test.
    
    It looks as if the journal or other metadata takes up a variable
    amount of space after sparsification.

commit 466885b226821d8099e47cf7a869a00f70c3e5a4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 7 13:17:38 2014 +0100

    configure: Add message about GNUlib tests.
    
    Output was:
    
      yes
    
    Now the output is:
    
      checking if we should run the GNUlib tests... yes

commit f63d82781924b2e399a97f0024c7816bd3cd61e9
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Apr 4 16:09:51 2014 +0200

    customize: add the chmod command
    
    Add the chmod customize command to change the permissions of files.

commit df0d1978120b3e3e3c07b5677c00f00027efbe2b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Apr 6 16:19:33 2014 +0100

    Version 1.27.3.

commit 71738831545a51e0bd462fe72c7674581aabd160
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 3 20:27:18 2014 +0100

    recipes: Update the section on installing packages.
    
    Libguestfs >= 1.26 makes this easy.

commit 55437e459b80f3805925d42c5ab6ae0f63386360
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 3 12:23:37 2014 +0100

    mllib: utils: Add mapi function.
    
    This is List.mapi from the stdlib.  RHEL 6 did not have this function.

commit 82b486a9086f84447324d68b3c0cae300e0334f7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 3 16:05:00 2014 +0100

    appliance: Avoid touching appliance/supermin.d directory.
    
    We must avoid touching appliance/supermin.d unless it is necessary, so
    that we avoid unnecessary rebuilds of the full appliance.
    Unfortunately since we created temporary files there, even if we
    didn't decide to keep those temporary files they would still end up
    touching supermin.d.  To stop this, move the temporary files out.

commit b7ad029536b415b38c2fcc359acf123bae020e65
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Apr 3 15:26:26 2014 +0200

    appliance: exclude pkg-config, doc-base, and reportbug stuff
    
    Exclude the arch-independent pkg-config files (no pkg-config available
    in the appliance).
    
    Exclude also the doc-base and reportbug files, typically found in Debian
    systems.

commit d268cfd13ef8e8dff3313c951e4d415fd183cf89
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 3 08:58:46 2014 +0100

    builder: Add test of virt-index-validate.

commit 358c6571d0a70ec40ff8750885854d3ad6bb28ca
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 3 08:45:31 2014 +0100

    builder: Rearrange EXTRA_DIST in alphabetical order.
    
    No functional change.

commit 795a162cee3765cce19cf7c52128ec27a9482aa2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 3 08:44:24 2014 +0100

    builder: Don't use configure to generate test-index file.
    
    The file contained no replacement patterns so generating it
    with configure did nothing.

commit 9cbb619db205da435e022884c694ff4bfd687943
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Apr 2 18:13:59 2014 +0200

    builder: better handle some index parsing errors
    
    Add a new lexer token, unused in the grammar, for the unknown lines in
    index files; this should allow to better handle such kind of parsing
    errors, removing the need to exit() directly (and leave things in an
    unclean state).

commit 3fa5096f484087cd3415f7eb5dda98dfed11e7ed
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 2 17:33:37 2014 +0100

    customize: Add a "finishing" message at the end.
    
    Useful, mainly because it tells you the total time spent running.

commit 8c46a644bc664de32835541883123fbabe6991fe
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 2 14:06:03 2014 +0100

    customize: Add customize/*.ml files for translation.

commit 84f646a41a7571937a7b3f71f12338dfb60776b2
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Apr 1 18:01:19 2014 +0200

    src/launch: improve the addition of the no-hpet option
    
    Since HPET is specific to x86, we can safely add it its option only on
    x86 and x86_64 when creating the libvirt XML (no more hitting the
    launching failures due to that on other architectures).
    
    Regarding the direct qemu launch, since qemu 1.1 (which is our current
    minimum) "-ho-hpet" appears in the help only where actually supported,
    so we could just checking for it and adding it only if present. This
    should fix the architecture issues on this backend as well.

commit b03b3f6f463c80be90ca32d241a56123d4122ed6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 1 14:56:32 2014 +0100

    sparsify: Reorder external programs in SEE ALSO section.

commit 07dff756a7e86154a3ee4f951764eb1fd1f5ed0f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 1 14:55:20 2014 +0100

    sparsify: Remove duplicate "EXIT STATUS" sections from man page.

commit c58bef5125ff6d5d4a06c607707cdcbf61cdb25d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 31 18:07:08 2014 +0100

    Version 1.27.2.

commit 7c1d95cca0599ac63e5d82adde62bd9a0cbbde7e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 31 18:00:07 2014 +0100

    rescue: Fix the --suggest regression test so it works when using UML backend.
    
    The boot partition name is /dev/ubda1 in this case, so use a small sed
    script to canonicalize it for the test comparison.
    
    This fixes commit f6a37740f2ba6668bee4952fdd35c46cb6d79cba.

commit cf316569238194e5483d525c3ad618687a055656
Author: Lee Yarwood <lyarwood@redhat.com>
Date:   Mon Mar 31 16:52:31 2014 +0100

    Add the now mandatory arch=ARCH field to the index file examples.
    
    61323fa introduced a mandatory arch field within index files to
    identify the architecture of the OS installed within a given template.
    This change simply documents the requirement within the relevant
    section of the virt-builder man page.
    
    Signed-off-by: Lee Yarwood <lyarwood@redhat.com>

commit 4916806bdfd3ec158b03080ae2a7aacde18a4b84
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 31 15:09:34 2014 +0100

    Version 1.27.1.

commit 957afde13ba3c8fd6db07c7bb27751c2c009a9ee
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 31 15:13:09 2014 +0100

    python: Add README.txt to EXTRA_DIST.

commit 0d9a61a91ddca03fd5652441caa2a8c9123639ee
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 31 13:59:08 2014 +0100

    src: Fix test-utils.c to test the validate_guid function again.
    
    This fixes commit 768ab2e01dab5a8e7e751c33b72c1341fcaf9dc3.

commit 7e39cd46005d0547cb8ba77c915557efb588ed9a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 31 12:56:28 2014 +0100

    Remove internal libvirt_setlinux* APIs and use backend settings instead.
    
    This removes the internal APIs internal_set_libvirt_selinux_label and
    internal_set_libvirt_selinux_norelabel_disks.  The communication
    between the libvirt domain and the backend now uses the backend
    settings.

commit 5d4e4e7ecaafee6ad8c445f069b3b4c606ba013c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 31 14:20:28 2014 +0100

    ocaml: Add ESRCH to Guestfs.Errno module.

commit d137ad52c52f8b448d3413660a18c636b6f9ae65
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 31 12:53:25 2014 +0100

    New APIs: set-backend-setting, get-backend-setting, clear-backend-setting.
    
    Currently the backend settings are treated as a list of strings.  You
    can set the whole list (clearing any strings there previously), but
    you cannot search for an individual string or replace an individual
    string.
    
    This adds further APIs allowing you to do that.  We treat the backend
    settings as a list of environment-like strings (ie.  name=value), and
    add the following functions:
    
     - set-backend-setting (name, value)
    
       Set name=value.  Any previous settings of name are cleared.
    
     - get-backend-setting (name)
    
       Search for name or name=value and return the value.
    
     - clear-backend-setting (name)
    
       Remove any name or name=value settings.
    
    This also adds a regression test.

commit 1893eaded0cf7be68bc30eb3a9fbde814cb42316
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 31 13:33:10 2014 +0100

    handle: Free g->backend_settings.
    
    This was not being freed, resulting in a memory leak if you used
    LIBGUESTFS_BACKEND_SETTINGS.
    
    Found by valgrind.

commit 6af2306730b7e4e372e60b6435f87722972c504b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 29 18:52:32 2014 +0000

    python: Remove unnecessary library dependencies.
    
    We can remove the deps on libxml2, libvirt and gnulib, by only linking
    with utils.o (instead of utils.a).

commit fcbfc4775fa2a44020974073594a745ca420d614
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 29 16:07:21 2014 +0000

    python: Add a Python setup.py script.
    
    This is not used by libguestfs right now, but it does allow you to
    build a python "distribution" of libguestfs, like this:
    
      make -C python sdist
    
    The distribution tarball will be in python/dist/
    
    You can copy the distribution tarball somewhere, unpack it, and use
    regular 'python setup.py' commands such as:
    
      python setup.py build
      python setup.py install [--prefix=...]
      python setup.py --name
    
    In future we hope to be able to upload the distribution tarball to
    PyPi, but licensing issues prevent this at present.

commit 768ab2e01dab5a8e7e751c33b72c1341fcaf9dc3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 29 16:57:59 2014 +0000

    utils: Move guestfs___validate_guid out of utils.c.
    
    guestfs___validate_guid was a new function added to utils.c in
    commit beef77403cd9d634b6ff6daa9f33d292e2d320a7.
    
    However utils.c should not include <guestfs-internal.h> since the
    other functions in this file can be used by all front-end code, not
    just libguestfs.so.
    
    This function is only needed in libguestfs.so, so move it to another
    source file, and remove include of <guestfs-internal.h> from utils.c.
    
    Also: use 'size_t' for counting, not 'int'.
    
    This fixes commit beef77403cd9d634b6ff6daa9f33d292e2d320a7.

commit bc1a4157941f482efebce19529dbad01537a0051
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 29 17:12:07 2014 +0000

    utils: Remove for-loop variable decl.
    
    Breaks Python distutils which doesn't use C99:
    
    utils.c: In function ‘guestfs___copy_string_list’:
    utils.c:79:7: error: ‘for’ loop initial declarations are only allowed in C99 mode
           for (size_t j = 0; j < i; ++j)
           ^
    utils.c:79:7: note: use option -std=c99 or -std=gnu99 to compile your code

commit ebda77b647282c672bd76a021f52c9dc972ce34e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 29 15:07:54 2014 +0000

    virt-builder: Add --machine-readable option, as in virt-resize and virt-sparsify.
    
    This makes it easier to query the virt-builder binary capabilities,
    from external programs.

commit 30bdadf032d1c210bae6e2785277afe030d9baf4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 29 14:55:01 2014 +0000

    builder: Disable internal parallel xzcat on RHEL 6.

commit eff7aed6cfc24c1d605578f738a0d76112d9966b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 29 14:47:25 2014 +0000

    builder: Remove recursive include of index-parse.h.
    
    This breaks on Bison < 2.7, and seems unnecessary in any case since
    the same file is included earlier.

commit f6a37740f2ba6668bee4952fdd35c46cb6d79cba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 28 14:37:45 2014 +0000

    rescue: Add a regression test for virt-rescue --suggest option.

commit c8657535fd6c937a4ce9ebee647b03b8b6f76916
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 28 14:25:42 2014 +0000

    rescue: Don't leak various variables when using --suggest option with multi-boot guests.
    
    This fixes a leak which was introduced in
    commit 4255db65e58a86148ec291a7416a1148c453d926.
    
    Found by Coverity.

commit 15b06d6100ceed0974d52d1aeffa67e9e34fc7da
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 28 14:01:19 2014 +0000

    make-fs: Close FILE* along error path.
    
    Found by Coverity.

commit 410aae4b6f646e1fc20b82d24486c68f0c09916c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 28 13:59:56 2014 +0000

    make-fs: Check for error return from guestfs_statvfs.
    
    Found by Coverity.

commit 4cea94a958d72e6f3411ba0caaccf9c27543d15c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 28 12:35:25 2014 +0000

    daemon: parted: part-get-name: Don't leak partition type string.
    
    Found by './configure --enable-valgrind-daemon'.
    
    This fixes commit 820b87016794116c783bd224f2e776cfdf65108e.

commit a7a239f7ab8abe8e81861c06abea4dd21dc4cd3d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 28 09:57:07 2014 +0000

    builder: Use libgnu.la instead of -lgnu.
    
    This updates commit effcb99f838da1c4830b4a6b0cc4394b904376f2.

commit effcb99f838da1c4830b4a6b0cc4394b904376f2
Author: Olaf Hering <olaf@aepfle.de>
Date:   Fri Mar 28 10:44:16 2014 +0100

    builder: Link virt-index-validate with gnulib.
    
    [Gnulib tries to replace getopt because of the bug shown below.
    However because -lgnu was not used in the Makefile, the replacement
    failed. -- RWMJ]
    
    from config.log:
    
                 /* This code dumps core on glibc 2.14.  */
                 {
                   static char program[] = "program";
                   static char w[] = "-W";
                   static char dummy[] = "dummy";
                   char *argv[] = { program, w, dummy, NULL };
                   optind = opterr = 1;
                   if (getopt (3, argv, "W;") != 'W')
                     result |= 64;
                 }
    
    gdb --quiet --readnow ./conftest -ex r -ex bt -ex detach -ex q
    Reading symbols from /usr/src/packages/BUILD/libguestfs-1.26.0/conftest...expanding to full symbols...done.
    Starting program: /usr/src/packages/BUILD/libguestfs-1.26.0/conftest
    Missing separate debuginfo for /lib64/ld-linux-x86-64.so.2
    Try: zypper install -C "debuginfo(build-id)=5d1a12e6f0e95331cc4e39df74ecbd5adb76a1f7"
    Missing separate debuginfo for /lib64/libc.so.6
    Try: zypper install -C "debuginfo(build-id)=a06caa12df8f953a453befa827c3145adaf6269a"
    main(323) result 0
    main(344) result 0
    main(357) result 0
    main(370) result 0
    
    Program received signal SIGSEGV, Segmentation fault.
    0x00007ffff7b2dbf8 in _getopt_internal_r () from /lib64/libc.so.6
    Detaching from program: /usr/src/packages/BUILD/libguestfs-1.26.0/conftest, process 31042
    
    This change actually fixes build for me on sles11sp3 and 11.4.

commit a78cd210c3b659fdbf3e5344ca5882fb505d2cd5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 27 15:47:16 2014 +0000

    Version 1.27.0.

commit 996eca5da7adae60e726b9837a9cc8e94373de02
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 27 11:57:09 2014 +0000

    Version 1.26.0.
    
    New stable version.

commit a20e368fea11fec1a2927670bbe3035ad0bcf4c1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 27 11:34:37 2014 +0000

    fish: Check return values from a couple of API calls.
    
    Found by Coverity.

commit be250948bc3e10b370244476debb7ee90d8d8703
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 27 11:33:40 2014 +0000

    fish: Ignore return value from guestfs_user_cancel.
    
    As we are in a signal handler, there's nothing else we can do.
    
    Found by Coverity.

commit 40998806437eb74b60fddff466a8318f76551818
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 26 20:25:05 2014 +0000

    examples: Check return value from guestfs_list_filesystems.
    
    Found by Coverity.

commit 7792278e0534e0e91ddc160aee46f1623a5769a1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 26 20:23:19 2014 +0000

    virt-diff: Free memory along error path.
    
    Found by Coverity.

commit 8da50e5a3f83fffa2ed3508a57c787ee73af3d97
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 26 20:08:36 2014 +0000

    daemon: md: Whitespace fix.

commit 4caa2ea5ffa15719030e1528956163130020417f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 26 20:07:43 2014 +0000

    daemon: ldm: Initialize glob_t struct before passing to glob.
    
    Some implementations of glob might use fields in the struct, although
    not glibc as far as I know.
    
    Issue identified by Coverity.

commit fe97d5ed9cd32bac999a93fe1212538363f8a020
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 26 20:03:15 2014 +0000

    builder: pxzcat: Ignore return value from posix_fadvise.
    
    Quiets warning from Coverity.

commit 21390bc4aa8b9c5cd32df3e68f2d21fb196dcbc2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 26 16:53:37 2014 +0000

    Pull latest translations from Transifex.

commit f566f176c6fe502e9c765438551fb787a0cef8d9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 26 16:47:26 2014 +0000

    Remove the ROADMAP file.
    
    I don't think it provides any value now.  There is a list of bugs in
    'BUGS' and a set of ideas in 'TODO'.

commit 0febb59afa3d2fb711d2782ecdd51a656623a807
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 26 13:35:05 2014 +0000

    Final updates to release notes for 1.26.

commit a9b62321b6f6629580d9ada28b149019dd6174f5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 26 10:28:36 2014 +0000

    Version 1.25.49.

commit 90973755b2f891f3814e9d9d22f739aeb6fa494a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 26 10:21:38 2014 +0000

    customize: Use --no-network flag so test works under UML.

commit 63f0ee9c57a24a6f53becd7534c2a218212291f7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 26 00:05:45 2014 +0000

    Version 1.25.48.

commit 218ac6996be19b84d92f654633d8ad53d1937a02
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 25 23:52:51 2014 +0000

    Further updates to the release notes, for 1.26.

commit 36f4f105810a2b027e4164a73db8ae9789e849a5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 25 19:15:06 2014 +0000

    Further updates to release notes, for 1.26.

commit cec31436f8b87d84887a50fd6eeba853ccef1581
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 25 22:41:19 2014 +0000

    customize: Rename main.ml to customize_main.ml.
    
    The OCaml compiler isn't happy when two modules have the same name in
    different directories.  Since customize/ contains a library of modules
    used in other directories, and since those directories may have
    main.ml files too, we need to rename 'customize/main.ml' to
    'customize/customize_main.ml'.

commit 1a4709147a4e6cbebd394ce1a157a14e4c55db6b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 25 22:09:34 2014 +0000

    customize: Add various options from virt-builder.
    
    This adds the following options to virt-customize:
    
      --attach
      --attach-format
      -m / --memsize
      --network / --no-network
      --smp
    
    This fixes commit 2b208d84db080659badbb70044497aae040592e7.

commit 87fcb4df0340309d1858ea43ce242985225ab649
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 25 22:09:14 2014 +0000

    Add customize subdirectory to ./run script.
    
    This fixes commit 2b208d84db080659badbb70044497aae040592e7.

commit 36f179fdfa548965d0aa57335d12c4cc29e4cf0e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 25 16:06:25 2014 +0000

    Begin working on release notes for libguestfs 1.26 release.

commit a70dd85a1734ecf3e1a6bda57b382a451ffb936d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 25 09:50:32 2014 -0500

    aarch64: Use -M virt to specify virtual machine type.
    
    Thanks: Paolo Bonzini

commit d6072de4ffe19ea57fe94caedbb39f1f7517182b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 24 17:34:45 2014 -0500

    arm: Replace #ifdef with #if defined, etc.
    
    No functional change.

commit afb74f104dd4b1c27f3bb1254f51342ffa6702b9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 24 17:34:15 2014 -0500

    aarch64: Cannot emulate IDE, like all non-PC.

commit 219c2ddf1b186f2afeda698e0d93ba6b1559eaf8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 24 17:33:51 2014 -0500

    aarch64: This has no working hpet emulation, like ARM 32 bit.

commit f8c83e801afc26dd61a8108188ab4de9e4a4b0ec
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 24 17:33:10 2014 -0500

    aarch64: This has no PCI, like ARM 32 bit.

commit d396ccb47063e2a3d177e50cc2299b40788f2b75
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 25 13:00:22 2014 +0000

    Open release notes for 1.26 release.

commit 40cac10b62509bc1ad12fe9c10a89ad83ca0fb84
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 25 13:00:17 2014 +0000

    Update TODO with Python bindings suggestion.

commit 3d79c51a2853cc3347a31d67a04ce140cbe8d683
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 25 13:11:23 2014 +0000

    Update API support.

commit 7ad1683daef031c3a1f4ca1fb5e75553ec6c4234
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 25 12:51:25 2014 +0000

    Version 1.25.47.

commit 2b208d84db080659badbb70044497aae040592e7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 25 10:46:08 2014 +0000

    Add virt-customize standalone tool.
    
    This includes some simple tests and a manual page.

commit aa3bc8b65d56c6d9708b72286d61e459967eb33c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 21 13:41:31 2014 +0000

    sysprep: Remove the --autorelabel (and related) options.
    
    The customize module includes an --selinux-label option which can run
    'fixfiles restore' (on most SELinux guests) or set /.autorelabel (on
    some older ones).
    
    Commit 49014f81f350484da725f5ee2bc62bb24268a334 renamed the old
    --selinux-label option to --autorelabel, but note this was not
    included in a stable version of libguestfs.
    
    Note this change leaves a bunch of now redundant code for detecting if
    we created a new file in the guest.

commit ae6f726ecc3bc1b67fd76e51a7b1e1a33d4dcfc0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 19 15:14:06 2014 +0000

    sysprep: Use customize module for customizing the guest after sysprepping.
    
    Note this removes the following modules (all replaced by 'customize'):
    
     - delete       [--delete, --scrub]
     - firstboot    [--firstboot]
     - hostname     [--hostname]
     - password     [--password, --password-crypto, --root-password]
     - random-seed
     - timezone     [--timezone]

commit 51834ad2192b1c90b74894421c2633c831ca1f4e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 19 13:16:53 2014 +0000

    customize: Add a --password option for setting user passwords.

commit 4b0b3589e854f0ed9174250490dc9c6ade94292f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 17 15:34:31 2014 +0000

    customize: Move virt-customize-related code to a separate directory.
    
    Split virt-builder into build and customize steps, so that we can spin
    off a separate tool called 'virt-customize'.  This commit does not in
    fact create such a tool, but it moves all the common code into a
    library, in the customize/ subdirectory of the source.
    
    Although this is mostly refactoring, it does change the order in which
    virt-builder command line arguments are processed, so they are now
    processed in the order they appear, not the inflexible fixed order
    used before.

commit 8e386fc1beedc2b203231175c156151a1cc49c83
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 21 13:24:38 2014 +0000

    sysprep: Pass debug and quiet flags to all modules.
    
    Also use the Common_utils.make_message_function function to print
    messages (same as virt-builder).

commit 1edfdcbd58381ff0935891c451b448ccdd4af4f0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 21 10:54:11 2014 +0000

    sysprep: Allow order of operations to be specified by modules.

commit f450fb41060c8e0d8a14dc869a54b8981b8fc99c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 21 10:47:51 2014 +0000

    sysprep: Perform operations in alphabetical order.
    
    Previously we ran them in essentially a random order, although it
    might have looked alphabetical in some cases because the modules are
    loaded in order.

commit 4a9581668c74222d5e780507c81ffb9480c68701
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Tue Mar 25 12:00:41 2014 +0100

    appliance: Not all of Grub is needed, only grub-install

commit 0116a482fc98645e6e71848d5fe46e40571f3f3e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 25 10:47:53 2014 +0000

    Update gnulib to latest.
    
    Includes a fix for the missing 'git-log-fix' file.
    https://lists.gnu.org/archive/html/bug-gnulib/2014-03/threads.html#00019

commit f80fc724bc1d4410303459439b3c7bac51ad7520
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Mar 24 16:23:38 2014 +0100

    php: raise the per-test timeout to 300 secs
    
    Some tests might spawn an appliance, which will take time on slower
    architectures and on some virtualized environments.
    Hence raise the per-test timeout from the default of 60s to 300s (which
    should be hopefully enough for now).

commit 483f0e30962ef6a662478dc6f0b13a1852733d4d
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Mar 24 16:59:20 2014 +0100

    virt-sparsify --in-place: remove image if discard is not supported
    
    No point leaving it around if the test has been skipped.

commit 08234a1c48a9b9e69d1ab8790f9b754fc5ab8952
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 24 14:18:34 2014 +0000

    po-docs: Do not translate "__AVAILABILITY__" placeholder.
    
    This fixes commit da122e382f3d6d05c5981a3e5f4e3b806e3e37e3.

commit ad2c6a13b3b541ccc70fe18b4290a06e85b8fc06
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Mar 24 15:13:13 2014 +0100

    docs: remove customize-related files
    
    The work on them has not been committed yet.

commit da5b8b6d61d07514d3c74de1bdff7d23108e6849
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Mar 23 21:56:29 2014 +0000

    appliance: Fix quoting so that DEBIAN isn't always defined.
    
    Because of incorrect quoting previously, the DEBIAN symbol
    was always defined.

commit 07bf7402381bbbb4c69373ed150675ef313c2b85
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Mar 23 19:40:44 2014 +0000

    Update gnulib to latest version.

commit 26599da373c549034a1bc01923e5920f61f16abe
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Mar 23 16:31:10 2014 +0000

    ocaml: Enable parallel builds.
    
    Commit f75142c577255b30f2a8e1d27baa5fd185594197 disabled parallel
    builds in the ocaml subdirectory (which was the correct thing to do).
    This made building the OCaml tests in particular very slow.  Therefore
    fix things so that parallel builds can be used again.
    
    See also discussion here about different approaches:
    
    https://www.redhat.com/archives/libguestfs/2014-March/thread.html#00223
    
    This reintroduces commit dce94f3e266ed3f1fc634a1ef6953f2db1510963.

commit da122e382f3d6d05c5981a3e5f4e3b806e3e37e3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Mar 23 12:59:18 2014 +0000

    Update Ukrainian translations.
    
    Contributed by: Yuri Chornoivan (via Transifex)

commit f42769f94b20898452884091ac57d73a95f280c0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Mar 23 12:09:01 2014 +0000

    virt-make-fs: Fix typo in error string.
    
    Thanks: Yuri Chornoivan

commit 20f412637eb0a12642f780df80cd43f0a090652f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 22 14:08:08 2014 +0000

    builder: Fix typo in string.
    
    Thanks: Yuri Chornoivan

commit e589b6e82336dec3abb6e2b1aea31313b7ec5172
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Mar 20 16:57:29 2014 +0100

    builder: do not parse the same repository file name twice
    
    When parsing the repository configuration files, track the file names
    parsed, and in case of same file name in multiple location consider only
    the one in the directory coming before others in the prioritised list of
    paths.
    
    This way it is possible to "shadow" a configuration file in a system
    path with one with the same name in a local directory, for example.

commit 603ad40c5ac034f22f3f2f682755a871d9e84267
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Mar 20 16:35:15 2014 +0100

    builder: allow the index parser to parse files with no sections
    
    Gracefully handle files with no sections; extend the validate.sh test
    to try to validate an empty file.

commit fa0fed8a2deacc29524518fbaa1e51516edce872
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Mar 20 16:23:43 2014 +0100

    builder: allow to run website tests under valgrind

commit 37ed019f53959936daf784af87e772088675aaa9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 20 15:28:57 2014 +0000

    Version 1.25.46.

commit 4edf659aa0d06aff2c8490751596cb8db6d66743
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 20 15:24:34 2014 +0000

    php: Include new location of tests in EXTRA_DIST.
    
    This fixes commit 251a1934c9bcfe9727b011a4d8bfc4b769b3b744.

commit 62875c88be1cc88e05d41dfec13383ce1dbbbbbe
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Mar 20 14:47:04 2014 +0100

    builder: clean the parsing structs on error

commit c6c27620d0688f573c638711b6bcdb94204432cd
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Mar 20 14:43:57 2014 +0100

    builder: rename and make public the section/field free functions
    
    They will be needed also elsewhere.

commit 87ed6365e47fea2112d62a32f234f63eab8a6b19
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Mar 20 12:40:16 2014 +0100

    builder/virt-index-validate: try to cleanup in any occasion
    
    Always close the file (ignoring its result) after a parsing, and cleanup
    the parse_context object before any exit().
    
    This eases the debugging of memory issues in the actual parser.

commit c7639495d7af7a6c406d4413530fd6af9429a75d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 20 14:34:58 2014 +0000

    Revert "appliance: Remove genisoimage from packagelist."
    
    This reverts commit cd996642e04ef3293e1d8de2df7222b4e8fe8bc1.
    
    The daemon uses 'isoinfo' which is part of this package.
    
    Thanks: Pino Toscano.

commit cd996642e04ef3293e1d8de2df7222b4e8fe8bc1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 20 13:49:19 2014 +0000

    appliance: Remove genisoimage from packagelist.
    
    It is not used by the daemon as far as I can tell.

commit c4dc70f8c43a7faae2a8698027a4ed23d316dfa0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 18 15:30:03 2014 +0000

    podwrapper: Remove =encoding from input files and add it back in podwrapper.
    
    This changes podwrapper so that the input (POD) files should not
    contain an =encoding directive.  However they must be UTF-8.
    Podwrapper then adds the '=encoding utf8' directive back during final
    generation.
    
    This in particular avoids problems with nested =encoding directives in
    fragments.  These break POD, and are undesirable anyway.

commit ad33a5434cf80c567286d5598875aa23f544eeaa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 18 15:19:37 2014 +0000

    po-docs: Filter the po4a warning and =encoding line.

commit 420d324555111a0d60caf7bd451dbbd12f3153ea
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 18 15:06:44 2014 +0000

    po-docs: There are no *.pl files in the po-docs subdirectories any longer.

commit 01548fd5b7fcde221a7079cad7fab5f502f91e7a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 18 12:49:45 2014 +0000

    generator: Generate copyright notice in generated POD fragments.
    
    Using =begin comment ... =end comment.

commit d4129988c19a49c916c7b5f8ebb66e3e5761c145
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 18 12:43:34 2014 +0000

    podwrapper: Give an error if an --insert or --verbatim pattern is not found in the input.

commit 121c2894bc4d089142acb1652f30913b36807895
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Mar 19 18:30:58 2014 +0100

    tests/run-xml-to-junit.xsl: allow to define a different classname
    
    Read and use the classname attribute in each test if present, falling
    back to "TestSuite" (used so far).

commit 7c70429e2ed8652e865b6e4cc0cb77d54b775295
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Mar 19 16:48:20 2014 +0100

    builder: show the application name in errors of the index parser

commit 15f04f21b9acb6ab5b48bceb0898d5c5955647a5
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Mar 19 16:14:34 2014 +0100

    builder: show the file name in errors of the index parser

commit c871ed6b50e8e7fbfc2bd6cab2ceeaacd8449d71
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Mar 19 15:42:45 2014 +0100

    builder: make the C index parser reentrant
    
    Switch the lex/yacc parser into reentrant mode, to ease the handling of
    parsing-specific data; introduce a new parser_context struct for that,
    which is added as extra data to the parser.
    
    This should cause no behaviour changes in the parsing, just no more
    global variables used for getting data in/out the parser.

commit 251a1934c9bcfe9727b011a4d8bfc4b769b3b744
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Mar 18 15:12:26 2014 +0100

    php: move tests under a tests subdirectory
    
    This eases fixes the classname in the junit output of run-tests.php,
    which now can be properly handled by junit XML consumers.

commit 7fb823e4277148f61222b7174399e209b9cd576c
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Mar 18 14:38:02 2014 +0100

    php: make the test suite failures fatal
    
    So far the failure of some test would have not reported a non-zero
    return value by run-tests.php. Since now all the PHP tests pass, we can
    ask for failures to be fatal, by exporting REPORT_EXIT_STATUS=1 for
    run-tests.php.

commit d521f7c2e3d6ed8cbc47da36a376bb61f0b0c390
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 17 21:05:18 2014 +0000

    build: Disable a couple more ineffective warnings.

commit 19dcc0de1fd4988ff53d152297480462453e196b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 17 19:54:16 2014 +0000

    Annual scavange to find mixed declarations and statements.
    
    Hopefully this is just code motion.

commit 6035c764e67b9c142034848db7b3dd6390233420
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 17 18:56:57 2014 +0000

    build: Remove -Wno-declaration-after-statement.
    
    We have generally forbidden declaration-after-statement in our code
    (although there are plenty of places that do it).  In any case this
    warning is not in the default set, so we don't need to turn off the
    warning.

commit 931aec5b8846ce63b0e2b6beba5861a019b5f694
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 17 12:02:58 2014 +0000

    virt-sparsify --in-place: Exit with code 3 if discard is not supported.
    
    Also skip the test in this case instead of failing.

commit 5e1fc4640dc369221e5e37013c9f9c7c065bbb8b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 17 12:21:39 2014 +0000

    mllib: Allow exit code to be specified when calling 'error' function.

commit 6e99530ea850d5fdd7d008b63ca518016cb9fe57
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 17 12:02:28 2014 +0000

    launch: Return errno == ENOTSUP if discard is not supported.

commit 0563405d2e3f3d81581cccfecdfd41f2bdd08a47
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 17 12:10:15 2014 +0000

    ocaml: Add Guestfs.Errno submodule exposing useful raw errno numbers.
    
    For use when calling G.last_errno.

commit 996c0a286820cd131c7d53e208816665380b87a2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Mar 16 22:55:52 2014 +0000

    Version 1.25.45.

commit 455ccc15c3c9f71b1001fa45788a53d39c359aa6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Mar 16 22:55:24 2014 +0000

    Add tests/run-xml-to-junit.* to EXTRA_DIST.

commit 7fe365eee68b49972a1c528ddd78101215e1defd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Mar 16 22:44:03 2014 +0000

    tests/regressions/rhbz895904.sh: Rewrite without multi-line expression.
    
    RHEL 6-era bash cannot handle the multi-line $(...) expression in the
    original code.  Rewrite the test so it is semantically the same but
    doesn't have the expression that old bash can't handle.

commit 93335b5c4aa55eeba01625459b3c9c8c0df96059
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 15 15:46:54 2014 +0000

    appliance: init: Remove unnecessary comment, whitespace changes.

commit bae2134aefdfdad5c9955c69a0c9f0772c90e95e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 14 13:20:22 2014 +0000

    tests/discard: sync before close isn't necessary.
    
    However we should be calling shutdown, since we're writing to the disk
    and need to catch qemu errors.

commit d46ceea6014006ab19b6f795e2e28a7360d90b2c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 14 13:14:24 2014 +0000

    tests: fstrim: Sync before running fstrim.
    
    This makes fstrim work.  It's not clear why exactly.
    
    Thanks: Paolo Bonzini.

commit 55730f6118aa947a8e81d36cd6a9cb28ce0bb7dd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 14 13:00:43 2014 +0000

    Revert "tests: fstrim: Remount the disk."
    
    This reverts commit accf1b66aa835714690a2979e990c49243875dab.

commit 56efdb29bf5a2aad1e5326c9a378155858fc579e
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Mar 14 11:24:22 2014 +0100

    tests: skip the output of test-virt-rescue.pl from RUN_OUTPUT_FILE
    
    The output of test-virt-rescue.pl contains non-ASCII chars which give
    troubles when being XSLT-transformed, so just avoid its output to leave
    the rest of the resulting XML well-formed.

commit 38fbda9d37ab1bf57d6c4c0c6be51aa44f110ff5
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Mar 14 10:37:36 2014 +0100

    tests: provide a simple way to extract the tests data from run
    
    If the RUN_OUTPUT_FILE environment variable is set, "run" will output
    to the file indicated by that snippets of XML with the results and
    outputs of the tests run.
    
    Together with the run-xml-to-junit.sh (and its associated
    run-xml-to-junit.xsl style sheet) it is possible to convert that output
    file to a jUnit-like XML file, which could be used in CI systems.

commit accf1b66aa835714690a2979e990c49243875dab
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 14 10:09:47 2014 +0000

    tests: fstrim: Remount the disk.
    
    This makes fstrim work.  It's not clear why exactly.

commit 9b883d3c3ec0ff93bbea776572afb54d2a9b3524
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 14 09:15:49 2014 +0000

    tests/discard: Ensure a significant number of blocks are freed up on the host.
    
    It's reasonable to expect megabytes will be freed up and given back to
    the host.  Previously we just tested that at least 1 block was
    released.  This test checks that at least 1000 blocks are released
    (since stat(2) returns blocks of 512 bytes: 512 bytes * 1000 = approx 0.5 MB).

commit 8584c8cadf4fdf9067457e07529aa74c715e03fa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 13 13:50:23 2014 +0000

    gobject: Don't ignore old generated files.
    
    This was ignoring an old generated file (gobject/guestfs-gobject.h)
    which, if still around, would break the build.

commit b96dfa60d3e7a4409fc2de9134f7bf828f34fa57
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 13 13:01:14 2014 +0000

    gitignore: appliance: Don't ignore some files which are now obsolete and should be removed.

commit bd226af94bd63e28c303a588c12f78b27cb15698
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 13 10:56:29 2014 +0000

    Version 1.25.44.

commit 083203c635d9b4c9852e46caf9135817cac3c29f
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Mar 13 10:24:04 2014 +0100

    php: fix crash with OStringList optional arguments
    
    Properly initialize the variables for them to NULL, so there is no crash
    because of trying to use rubbish pointers.
    
    Kind of followup of commit 289fd29f0bfbb94566d9780dd8ac3fe15e55541d.

commit e411cf8269b1c8b1334500ebd80e5348fc0b0c8c
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Mar 12 19:29:56 2014 +0100

    php: remove the custom "env" loading in tests
    
    Other than being too late for changing environment variables like
    LD_LIBRARY_PATH, now it is no more needed.

commit 5fbbfe7440009aff3a6a8f584a1cea777ef2b5dc
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Mar 12 19:24:39 2014 +0100

    php: add a custom PHP runner for tests
    
    Since the default PHP test runner ignores a good number of environment
    variables to potentially tampering the test suite execution, create a
    custom php-for-tests.sh script which does nothing more than sourcing the
    custom environment that our run-php-tests.sh outputs and running the
    actual "php" executable (the one found by configure).
    
    This fixes the loading of the guestfs_php.so module in the test suite,
    as the libguestfs.so.0 library can be found by that module.

commit 04aaa6ddfce98870b0c0a71f7cd27e629a81fcda
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 13 09:13:04 2014 +0000

    appliance: Fix 'make clean' in appliance subdirectory.
    
    Commit 71dfd73042db24217329d815bf5eab26f413d97f broke 'make clean' in
    the appliance subdirectory, so it would remove all the supermin.d/*
    files, but without removing stamp-supermin so you couldn't rebuild
    supermin.d/ with a 'make' afterwards.
    
    In any case, 'make clean' is not supposed to delete the appliance
    (which is expensive to rebuild).
    
    Fix this so that 'make clean' doesn't remove supermin.d/* files.
    'make distclean' can be used to delete this, and since it also removes
    stamp-supermin, it will be recreated properly by 'make'.

commit a13109c2608dd1984eeb57013cf1dacdf4338210
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 12 21:41:08 2014 +0000

    FAQ: Make issues which will be fixed in libguestfs >= 1.26 / supermin >= 5.

commit 8df1c472697d1a1227dd6d8d9bfbba0bcfee5b82
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 12 21:40:16 2014 +0000

    FAQ: Remove section that only applied to obsolete Fedora & RHEL releases.
    
    Since this is fixed in all currently supported versions of Fedora
    & RHEL, there's no need to document the problem in the FAQ.

commit 80d77e934ffc10413f1b100a461e6ddfd23fc384
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 12 21:39:18 2014 +0000

    FAQ: Document virt-sparsify >= 1.26 can do in-place sparsification.

commit b7cec3e8f46a727c3c8d83e5b54be7469f2e4f1d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 11 19:10:52 2014 +0000

    sparsify: Add a test of the virt-sparsify --in-place option.

commit e3a32f95d03cd29bf713f790994deca34e79bafc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 11 18:28:49 2014 +0000

    sparsify: Add virt-sparsify --in-place mode.

commit b48e8850047f240dc67e1610757229e096ed9e25
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 11 14:29:38 2014 +0000

    sysprep: Add disks with discard = "besteffort".
    
    Since virt-sysprep tends to delete a lot of files, adding discard
    support to it makes some sense.
    
    Note that this probably won't have any effect for most filesystems
    since:
    
    (a) ext4 mounts also need to use -o discard,
    
    (b) ext4, and maybe others, require you to call fstrim explicitly,
    they don't discard automatically (except for userspace tools like
    mkfs.ext4 but that doesn't apply in this case).

commit fb3afdff475db07fa904548ea2eeca29243a29c2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 11 14:20:53 2014 +0000

    virt-format: Discard the data on the disks.
    
    If possible, this means that the host will be able to reclaim most of
    the space used by formatted disks.

commit 93f1bfcad74946824c6a12a456dbd01cee9a0571
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 11 14:40:38 2014 +0000

    Pass discard parameter from add-domain to add-drive.
    
    Allow callers to specify that all the disks from a domain are added
    with a specific discard mode (instead of always having discard
    disabled).

commit 3106789d81cea27f0860ff78d7e15f71b7007949
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 11 14:40:38 2014 +0000

    Pass cachemode parameter from add-domain to add-drive.
    
    Allow callers to specify that all the disks from a domain are added
    with a specific cachemode (instead of always having to use the
    default, writeback).

commit a9fc09366aa69d6f371b93ad948c4a2c70166fd1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 10 14:17:49 2014 +0000

    tests: Add tests of discard support.
    
    Test that blkdiscard, -o discard, and fstrim work in reality, end-to-end.

commit b408419791c2fc895f6d1168f53cd92729c037fd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 11 19:01:35 2014 +0000

    New API: blkdiscardzeroes - do discarded blocks read back as zeroes?

commit 452b228b46834a49744459cfb6b872903abe60ef
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 11 13:14:23 2014 +0000

    New API: blkdiscard - discard all blocks on a block device.

commit 499b9ee416d15f1713558b63b2e975343afcc88f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Mar 9 15:24:31 2014 +0000

    New API parameter: Add discard parameter to guestfs_add_drive_opts.
    
    This adds a discard parameter to guestfs_add_drive_opts which
    approximately maps to the discard=ignore|unmap parameter supported by
    qemu.
    
    If discard is set to "enable" then we force discard=unmap (and try to
    fail if it is not possible).  If discard is set to the more useful
    "besteffort" option, then we enable discard if possible.  The default
    is "disable".

commit 53afa03af9175f127c77c221ea27b2a4a12d1fea
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Mar 12 16:07:55 2014 +0100

    builder: fix typo in comment
    
    Followup of commit b1cf6246f3c80762cf27dbdb24168589a34daf00.

commit 2489692067a51c9ba39ae8992ee19975f41a55ba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 11 18:03:13 2014 +0000

    sparsify: Move copying-mode code to a separate file.
    
    This is just code motion.

commit a665a570a3dd574a90c3d75c70ddb698c46f5a68
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 11 16:00:40 2014 +0000

    sparsify: Refactor command line parsing to pass back a mode.
    
    This is just code motion, but sets the ground-work for adding a second
    mode (in-place image modification).

commit 63e836881ec15a7380ad7db54615a4d595377c0f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 11 15:40:17 2014 +0000

    sparsify: Move command line parsing code to separate file.
    
    This is just code motion.

commit d263a301bfe082fc78f4548566a6644b48bf51ae
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 11 15:39:57 2014 +0000

    sparsify: Remove unused 'open' directive.

commit 8df13884dfc028021ac94de8006cf30100b2968e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 11 15:32:35 2014 +0000

    sparsify: Capture any exceptions and display nicer error messages.
    
    This is just code motion, there is no functional change.

commit 073f90e681c87238d54b94ebcfd8889a6af7a8a4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 11 15:32:04 2014 +0000

    sparsify: Remove unused variable definition.

commit 2b4baf34782107bd6b4436737242f3156f57448c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Mar 9 19:18:52 2014 +0000

    launch: libvirt: Move the is_kvm flag (derived from libvirt capabilities) to backend data struct.
    
    This is just rearranging the data between structs.  There should be no
    functional change.

commit 5e105e06be4cc6c88b5d3fc5cf79acb48947e197
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 12 13:41:39 2014 +0000

    daemon: fstrim: Fix fstrim so it trims the correct filesystem.
    
    We didn't call sysroot_path, so it was trimming the appliance instead
    of the guest filesystem.

commit 46e30c1f7c90f8f24d1261a9bc37e05f9ef2a552
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 11 21:54:13 2014 +0000

    daemon: fstrim: When debugging, capture and print fstrim -v output.

commit b1cf6246f3c80762cf27dbdb24168589a34daf00
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Mar 12 15:06:55 2014 +0100

    builder: complete architecture handling
    
    Add the possibility to choose which architecture use to build the wanted
    image (--arch). Since this implies that running commands on the guest is
    usually not possible when the architecture is different than the host
    one, virt-builder will nevertheless try to check whether the host is
    compatible with the guest, allowing to run commands only in that case.
    
    The caching scheme is adapted to account for the architecture (with
    --print-cache showing the architecture as well).

commit cc495247f2f274d24086862d38af6047c380939d
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Mar 12 15:05:24 2014 +0100

    builder: show the architecture in the short --list output
    
    Just like the other --list output formats provide the architecture, show
    them also in the short format.

commit 7942cbf537ac50ec29b45f30bc5f0deff510c8fe
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Mar 12 14:50:15 2014 +0100

    drivers: group drive creation params in an own struct
    
    Group together all the various parameters (except the guestfs handle)
    passed to the create_drive_*, to avoid passing all of them at every
    function call.
    
    This is mostly an internal refatoring with no behaviour change.

commit 013ed9f94bf6f572d9622ad0dfbd211729451e92
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 11 22:11:32 2014 +0000

    appliance: Cosmetic rearrangement of supermin.d/* targets.
    
    No functional change.

commit 71dfd73042db24217329d815bf5eab26f413d97f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 11 22:10:43 2014 +0000

    appliance: Don't rebuild everything if just the daemon changes.

commit 72d1a6335e6a7071e87566d464b5f804f9e760ee
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Mar 11 15:57:35 2014 +0100

    builder: add languages.ml to POTFILES-ml
    
    Followup of commit 3cffc28834d40d1debe8ebb826b8a5564ce8479b.

commit 6379c85d1f2bbf0e1c7e8165ddeda8efa18f8344
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Mar 11 14:25:39 2014 +0100

    builder: output translated notes also in --notes

commit 3cffc28834d40d1debe8ebb826b8a5564ce8479b
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Mar 11 14:20:22 2014 +0100

    builder: move some language-related code into a Languages module
    
    Mostly code motion, no behaviour changes.

commit 8ba31e69dc359f2b22e47bfeb5230e72ba95699b
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Mar 10 13:42:16 2014 +0100

    builder: use Filename.check_suffix
    
    ... instead of manually extracting and checking the suffix by ourselves

commit 596955c1b52d8dd6a095254f7878da451a4bbb91
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 8 12:57:23 2014 +0000

    Version 1.25.43.

commit 29440e2fbcdee45d64eb6c5d5eb0cffca4a8ac23
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 8 12:41:20 2014 +0000

    java: Complete test suite.

commit 6fa9e5dac7c2381fc91c87152dc15c49ba38d377
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 8 12:29:00 2014 +0000

    java: Document how to compile and run Java programs.

commit 2b3131cf4053b7e39c5185c85ebaef78ce4d586e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 8 12:13:46 2014 +0000

    java: Document how to use optional parameters in the guestfs-java(3) man page.

commit 1ba2e3e14aa6d58bff26646a1328969fda44610f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 7 15:04:13 2014 +0000

    java: Add regression test for RStruct/RStructList (RHBZ#1073906).

commit ebf8a3654ac4a691d48199adb8e92e182012a8c2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 7 15:04:47 2014 +0000

    bindtests: Fill in all fields in dummy lvm_pv struct.
    
    Used for testing RStruct/RStructList return values, but only
    in GObject and Java bindings.

commit dff35285e491d1905d38c90d83fed98932cbc3b3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 7 14:34:55 2014 +0000

    java: Use correct Set*Field JNI accessors to set fields of the appropriate type.
    
    Using the wrong accessors (somehow - I have no idea how) caused other
    fields in the struct to contain incorrect values.

commit 7a0e71f7331540809db5f539d1a9fe2af050c56a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 7 14:25:14 2014 +0000

    java: Factor out common field code in RStructList.
    
    No functional change.

commit 8c219636a272c4288f22392ff27b9c04580aecb4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 7 14:01:28 2014 +0000

    java: Split long lines in generated output, and add other whitespace.
    
    No functional change.

commit d00840d727e4040a7958ecc613599d6ec2851e53
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 7 13:49:52 2014 +0000

    java: Fix bogus construction of all RStructList returned values (RHBZ#1073906).
    
    Thanks Maarten on IRC for spotting the problem.

commit 6aa64ee3a3f1c990b5f9ce537f2b840273c3c1ba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 7 13:26:16 2014 +0000

    java: run: Add java/.libs to LD_LIBRARY_PATH so JVM finds the right JNI file.

commit 16954981e2fa9b8a6d8553ac622dd3777e5d02ef
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Sat Jun 1 15:12:27 2013 +0200

    Allow gnulib tests to be disabled.
    
    RWMJ:
    
     - Patch taken from Debian downstream package.
    
     - The default in the original patch was to disable the tests.  I have
       changed this to default to enable them instead.
    
     - Removed AC_SUBST as the variable was not being used.

commit 96f6a8f57ce2d452efa35588a734fc170346b975
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 6 15:59:35 2014 +0000

    Version 1.25.42.

commit e1fdc43539c303101394b7bbddaaada4587637f5
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Tue Mar 4 22:24:52 2014 +0100

    Remove two more files that are generated by configure

commit 5213d7b960d77844673436806e0526acb3e95ffa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 5 16:12:53 2014 +0000

    tests/md: Remove bogus test skip which tried to appliance hostfiles.
    
    This file no longer exists since supermin >= 5.
    
    Bug identified by Pino Toscano.

commit bdcc37b888146d1e56238dec698bbc8f0fdfc607
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Tue Mar 4 19:17:40 2014 +0100

    Debian: Add systemd-related libraries (for guestfsd) to packagelist

commit 7c21e129c9bc6bc145ac1cc81b53cfa289951496
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Tue Mar 4 18:56:07 2014 +0100

    Do not ship test-qemu-drive-libvirt.xml with tarball as it is generated by configure

commit b30e2cf12269b6fc18a03f74a201eb10a2d92e7f
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Tue Mar 4 00:00:02 2014 +0100

    Fix out-of-tree build: Do not accidentally build mllib components in srcdir

commit d7e3aea7bcee93bc0c3918d8ed06847d575775b4
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Mon Mar 3 23:58:57 2014 +0100

    Fixes for various tests in out-of-tree builds

commit 0048b5dc32fc7f07c0a34c88364a9d591c25f069
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Sun Mar 2 19:18:18 2014 +0100

    Fix out-of-tree appliance build

commit 876983365a508ad0aac7cddab8c5badfb1da2988
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Fri Feb 28 19:58:04 2014 +0100

    More fixes for situations where ocamlopt is not available
    
    - run bindtests.opt only if available
    - use ocamlc -custom
    - Don't try to install native code if it hasn't been built (Thanks to Olaf Hering)

commit 0b285e07a01329bfb8d27f086c939a2ba552a342
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 3 22:06:58 2014 +0000

    Version 1.25.41.

commit e87e377cfb1e5bf506cc51d4b535fab8cc1a2533
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 3 21:58:42 2014 +0000

    appliance: Ensure that supermin.d directory is installed properly.
    
    Commit 0a966727abc83550d2026886eac2440c99e6cb5e had a missing
    backslash in the list of files, so that 'make install' didn't install
    all the files.

commit 3acb4343eaf14c7286e1d762bce4fb0ef535ceb4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 3 17:20:43 2014 +0000

    Version 1.25.40.

commit d37dd9b055142607a353269f8ea80581bc03fc96
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 3 17:21:55 2014 +0000

    Add new logo to EXTRA_DIST.
    
    This fixes commit d73531a0aa691ff961366afee4db2c99a40510b6.

commit 0a966727abc83550d2026886eac2440c99e6cb5e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 3 13:43:35 2014 +0000

    appliance: Remove conditionals in appliance/Makefile.am.
    
    If appliance is disabled, the whole appliance/ subdirectory is
    skipped.
    
    If appliance is enabled, we can assume that the daemon is enabled too
    (see previous commit) so we don't need the conditional code.  That
    conditional code didn't work since the supermin 5 rewrite.

commit a6d72be984498e07f455c643e07a51b977603fc2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 3 13:41:59 2014 +0000

    build: Don't allow --disable-daemon and --enable-appliance together.
    
    This makes no sense, since the daemon is contained in the appliance so
    you cannot build a (meaningful) appliance without having a daemon.

commit 631c7d9241febcc7889d0fcb88aa07858174dbe1
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Mar 3 16:28:14 2014 +0100

    builder: install a $sysconfdir/virt-builder -> xdg-virt-builder symlink
    
    This way "virt-builder" appears directly in the sysconfdir.

commit 6a5052a4092912684d4934716fd543038ce7e758
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Mar 3 14:25:12 2014 +0100

    run: add the builddir of inspector to $PATH

commit 31b16a9dda6d66b54a0965a987f9af5ad95fbf58
Author: Hilko Bengen <bengen@debian.org>
Date:   Sat Feb 22 12:26:40 2014 +0100

    Debian: Strip Lintian overrides, initramfs-related stuff from appliance

commit 7adc60d955260dab7bbc4242a4140041a2bd2870
Author: Bastien ROUCARIÈS <roucaries.bastien@gmail.com>
Date:   Fri May 17 10:11:37 2013 +0200

    remove last trace of ntfsprogs

commit 2b4e2eb97d8e60758a8b944927ec7cb278e8dd87
Author: Hilko Bengen <bengen@debian.org>
Date:   Thu Aug 11 00:24:11 2011 +0200

    Fix for systemd-based Debian systems

commit e0124b9a91b49dbb34b121f09cfc1789305c1362
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 3 12:08:21 2014 +0000

    logo: Make the 5 years text larger and more readable for website.
    
    This fixes commit d73531a0aa691ff961366afee4db2c99a40510b6.

commit d73531a0aa691ff961366afee4db2c99a40510b6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 3 11:55:01 2014 +0000

    logo: Add fish logo with 5 years star.

commit b88f98849a43761f38702de9e2a4da7fb69a75b7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Mar 2 19:30:28 2014 +0000

    appliance: Cosmetic change to the order of command line arguments of 'supermin'.

commit 49209b3f965f65da8041fa70a30ae3df5b892535
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 1 16:26:12 2014 +0000

    Version 1.25.39.

commit 0c4fae7cb31243c49fa319f0102dbe61b97b7601
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 1 15:49:54 2014 +0000

    configure: supermin should be listed as AC_PATH_PROG, since it is used at run time.
    
    See top of configure.ac:
    
     > # NB: AC_CHECK_PROG(S) or AC_PATH_PROG(S)?
     > # Use AC_CHECK_PROG(S) for programs which are only used during build.
     > # Use AC_PATH_PROG(S) for program names which are compiled into the
     > # binary and used at run time.  The reason is so that we know which
     > # programs the binary actually uses.

commit 01a018a9de1db36f01d70cb6892b21e804d93673
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 28 22:48:20 2014 +0000

    mageia: Add distro setting and extra packages needed by Mageia.

commit 962837650cfb95e50d3c44578cbf47f7ec625271
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Feb 28 14:20:08 2014 +0100

    builder: add libguestfs.gpg to EXTRA_DIST
    
    It needs to be in EXTRA_DIST, otherwise it is not put in the dist.

commit 12bdd94f7e2916830bed109dd503910f96fa3f2b
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Feb 28 13:14:33 2014 +0100

    tests/luks: disable if luks is not available

commit f75142c577255b30f2a8e1d27baa5fd185594197
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Fri Feb 28 14:35:56 2014 +0100

    Fix building on architectures where ocamlopt is not available

commit a4be4231cc0c27eb9daa6adbce24e11844fe23a0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 28 13:36:05 2014 +0000

    launch: libvirt: Fix unused variable when libselinux is not installed.

commit 7c8af234305f0fe2cb5a9042bd58fe3735e8cd73
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 27 12:36:13 2014 +0000

    appliance: init: Don't write to /proc/sys/kernel/hotplug when starting udev (RHBZ#1020806).
    
    /proc/sys/kernel/hotplug is an obsolete interface for processing
    hotplug events.  It is not used by modern kernels, which should set
    this path to the empty string (because they have
    CONFIG_UEVENT_HELPER_PATH="").
    
    Unfortunately our udev initialization code did:
    
      echo -e '\000\000\000\000' > /proc/sys/kernel/hotplug
    
    which was intended to set this file to \0 bytes.  However on Debian,
    where /bin/sh is "dash", not "bash", this writes "-e" to this file,
    which breaks udev events.
    
    Thanks: Peter Rajnoha for solving this.
    
    https://bugzilla.redhat.com/show_bug.cgi?id=1020806#c10

commit 963b0341e26ddc4ddc0e0f0fa13deacecdd5ab0f
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Feb 25 17:29:13 2014 +0100

    builder: update documentation
    
    Update the documentation according to the new .conf files structure, the
    drop of VIRT_BUILDER_SOURCE and VIRT_BUILDER_FINGERPRINT, the drop of
    hardcoded source and its key, etc.

commit 47538865f2e6d82f7fff6e0ef0f48cba48acfc64
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Feb 25 17:29:12 2014 +0100

    builder: remove the default fingerprint/pubkey
    
    Sigchecker can still import keys from the user's keyring, so there is no
    need to hardcode fingerprint and key of the index hosted on
    libguestfs.org (which is now pointed to using a .conf file).

commit 573cae45c3490ddbd04a39aaf63dbe0cd0518cb1
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Feb 25 17:29:11 2014 +0100

    builder: remove VIRT_BUILDER_SOURCE and VIRT_BUILDER_FINGERPRINT
    
    Drop these two environment variables, and the implicit hardcoded source
    hosted at libguestfs.org.
    This means all the sources must be provided as .conf files, or at each
    invocation with --source.

commit f4990bef1c2cffb878f472023b01895ee326e4b3
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Feb 25 17:29:10 2014 +0100

    builder: switch sources to .conf files
    
    Introduce and use simple .conf files to configure the sources of indexes
    for virt-builder. The location of these files is in XDG_CONFIG_DIRS /
    XDG_CONFIG_HOME, so it can be easily overridden.
    
    There are three .conf(.in) files shipped with this commit:
    - "test-index.conf.in" (in "test-config"), which points to the
      "test-index" index (used in tests only); the tests are adapted to
      point to the hierarchy containing this .conf
    - "libguestfs.conf.in" (in "test-website"), which points to the local
      "index.asc" (i.e. the offline copy of the libguestfs.org index);
      run(.in) will point to the hierarchy providing this .conf
    - "libguestfs.conf.in" (directly among the other sources), which points
      to the online "index.asc" and it is installed in sysconfdir, along
      with the key of this repository
    
    The tests are adapted, other than to the different way to pick sources,
    to the different output of --list, as "test-index" is not signed.

commit a3f1ac9a2dacd96003688e8125dae7d012d3b942
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Feb 25 17:29:09 2014 +0100

    builder: extract the default key to file
    
    This is basically default_pubkey from sigchecker.ml, just extracted as
    file. Not used right now, but will be in the future.

commit a21da3c8013e2658b41de962c4fb98df3c8896e4
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Feb 25 17:29:08 2014 +0100

    builder: add functions to read XDG_CONFIG_DIRS and XDG_CONFIG_PATH

commit ad38e68c34d3d15fb02901e3fbdd68bfe9887ebf
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Feb 25 17:29:07 2014 +0100

    builder: use Sigchecker.gpgkey_type for the fingerprint
    
    Use Sigchecker.gpgkey_type instead of just string as type in the
    sources list; adapt the listing code (and its expected output) to that.
    
    No behaviour change which eases a bit the addition of new sources with
    other key types.

commit c09f5bbc708bbed772570ba63a706efcedf68cac
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Feb 25 17:29:06 2014 +0100

    builder: allow "no key" as key in Sigchecker
    
    Additional way to distinguish no actual key available for signature
    checking; make sure to not allow signing in such situation.

commit fbe4dad2dedd89d1dae76df0393147398cfa1440
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 27 09:58:47 2014 +0000

    appliance: init: Initialize LVM in the same way as done on physical machines.
    
    Running vgscan appears to be unnecessary.
    
    The -aa option of vgchange activates LVs.
    
    The --sysinit option disables locking.

commit 06011270eca5b4a3149143b8c2c15cd8d9c9c7c0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 26 19:41:07 2014 +0000

    Version 1.25.38.

commit eb81df93d0b01211014132d196d95a88c762a399
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 26 10:10:20 2014 -0500

    appliance: Initialize local variables because gcc cannot track that they are not used uninitialized.

commit b13c22668d956df4cb8e82aaf1d0d3941581b715
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 25 16:08:13 2014 +0000

    appliance: Use supermin >= 5.
    
    This requires the new version of supermin (5.1.0).

commit d353b4a3c84fd828dc8e226a17d0daa69d85683c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 24 20:13:41 2014 +0000

    builder: Add arch= entry for Cirros.
    
    Thanks: Pino Toscano.

commit 9124730df27fa9e0709637dfe9271e01e11466b0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 24 15:43:13 2014 +0000

    builder: Add arch=x86_64 entries.

commit 0f3898b2f5587c9cdd9b26d51dac44b5c3f36055
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Feb 24 15:40:29 2014 +0100

    sysprep: use Mkdtemp to create the temporary directory
    
    Use the safer mkdtemp instead of manually creating a path.

commit 8ed905c7e6a837887a758417bdfd1822b86a214f
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Feb 24 15:08:03 2014 +0100

    builder: split INI C <-> OCaml glue code in own module
    
    Move in an own module the code which calls the C
    virt_builder_parse_index and does the array -> list conversion of the
    result. This way this code can be easily called also in places different
    than Index_parser without the need to copy the types mapping, etc.
    
    Just code motion, no actual behaviour changes.

commit 61323fabafdcab10abaf6b7002e5e1bb38ddbc5e
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Feb 24 11:31:35 2014 +0100

    builder: add a mandatory 'arch' key in index files
    
    Introduce a mandatory arch= key in all the entries of index files, to
    identify which architecture is each. Adapt the long and JSON list
    outputs to print also this new field.
    
    This introduces an incompatibility with index files created with
    virt-builder < 1.26, as they will be rejected until entries will have
    the arch= key added (which is ignored by older virt-builder, so adding
    it will not create backward-compatibility issues).

commit 838a3c997c664d8a28e6563baf7119480c1f0bd3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 21 16:46:14 2014 +0000

    Version 1.25.37.

commit 35e53c0381acc51908211fc6058c552029371e3e
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Feb 21 15:21:08 2014 +0100

    builder: allow Sigchecker to import keys from file
    
    Extend Sigchecker so it allows both fingerprints (to be imported from
    user's keyring, as before) and keys stored in files. To simplify this
    process (and have the fingerprint always around), the key is imported
    on Sigchecker.create time, instead of lazily at the first verification.

commit dd03d38be39fdf195ae3e4943b53921a28cc4536
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Feb 21 14:39:57 2014 +0100

    builder: use a disposable GPG keyring for every Sigchecker
    
    Create a temporary directory and tell gpg to use it as homedir, so
    imported keys do not get into the user's keyring. This also avoid
    importing the default key  when a different one is needed to check the
    signature.
    
    The only exception is when a non-default fingerprint is used: in this
    case, that key is read from the user's keyring, since it is where it is.

commit c79c62a3b0f007d5952a75b1cae3f793bd63132f
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Feb 21 14:34:36 2014 +0100

    mllib: add a binding for mkdtemp
    
    It seems OCaml has no way to safely create a temporary directory, so add
    a new binding to C's mkdtemp which does that.

commit 7794d9a187b47799055f8206fa18608c5247823f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 21 08:31:34 2014 +0000

    builder: Add ScientificLinux 6.5.

commit 7f77f4fb28ca3320fd63c157537a332ef97533ac
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Feb 20 11:37:49 2014 +0100

    mllib: add an hook to cleanup directories on exit
    
    Much similar to unlink_on_exit, but recursively cleaning directories.

commit 4c5a6afc848b556999fee1c0ebd246496cdb023b
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Feb 19 16:40:00 2014 +0100

    builder: accept also '_' in group names

commit 482fefa5d846f63e39e2ef64c419ab32e12e3b05
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 18 17:43:06 2014 +0000

    ppc64: Don't add -no-hpet with the direct backend either.
    
    Related changes in commit 479665e4fc31b94cd9372394bb9c97e8f87b6ab5
    and commit 62cb3a606d4b349d45f2d178945a998a90d1e130.

commit 479665e4fc31b94cd9372394bb9c97e8f87b6ab5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 18 15:12:13 2014 +0000

    ppc64: Disable hpet fragment in libvirt XML.
    
    Related change in commit 62cb3a606d4b349d45f2d178945a998a90d1e130.

commit bb35e725035d3d8e73604a95a8b055cc1073416a
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Feb 18 12:54:23 2014 +0100

    builder: move the XDG path handling in an own file
    
    Just code motion and renaming, no actual behaviour changes.

commit 8b1f1c15f5dfdeea122784d8c4d97e75b335989a
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Feb 18 10:44:49 2014 +0100

    fish: use XDG paths for the config file
    
    Read the configuration file from XDG paths for both global and
    user-local locations, keeping the old paths as fallback.

commit 62cb3a606d4b349d45f2d178945a998a90d1e130
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 17 15:17:27 2014 -0500

    launch: libvirt: Don't include hpet XML fragment on ARM.
    
    See comment and https://bugzilla.redhat.com/show_bug.cgi?id=1066145
    for explanation.

commit 8577aded9851731ae146643631eda0002bac1e20
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Feb 17 16:24:41 2014 +0100

    fish: change order of config files being read
    
    First read the global configuration and then the local one in user's
    HOME, so the latter can really override system settings.

commit 5d2b0d1366fc72a79b842ee4bccaa99a16cab754
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Feb 17 16:21:18 2014 +0100

    fish: small refactor of config reading code
    
    Even though so far there is just one possible setting to read, isolate
    in an own function the code to parse a configuration file and read the
    settings out of it.
    
    Now there's a new config_t handle used every time, but since config_read
    would reset an handle completely, there is no behaviour change.

commit 6b71b81a5f4b1bfbf9fb4efa576fe7e7ae2368a8
Author: Or Goshen <oberonc@gmail.com>
Date:   Mon Feb 17 14:51:56 2014 +0000

    appliance: Use configurable separator character for LIBGUESTFS_PATH.
    
    On Windows, the path separator character will be ';' instead.

commit 22f6c79b32ab281e1f025f6b20fbf1b4407ef08a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 17 10:08:38 2014 +0000

    Version 1.25.36.

commit 360abeebda97e9940a4045a331ce181d1a370719
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 17 09:13:42 2014 +0000

    builder: Fix dependencies which are not generated correctly by automake.
    
    See the error messages here:
    https://www.redhat.com/archives/libguestfs/2014-February/msg00148.html
    
    This fixes commit e2cc8b6465a400024fe2f0fcce0d0ff5f7e7719c.

commit 8f767f4caadbd5e964e4136a8361bcb32f2f63ea
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Feb 16 22:34:56 2014 +0000

    Version 1.25.35.

commit b987be513a919e91b79a045095f9b84db625165f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Feb 16 19:20:40 2014 +0000

    FAQ: Remove obsolete entry about libguestfs <= 1.13 and slow writes.
    
    Long since not a problem.

commit 728ba9b33fa6002de7da72629ff59a7ea99807b5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Feb 16 19:09:33 2014 +0000

    FAQ: Add several common problems with opening disk images.

commit c16d5d3de49e3cddce07f161a3316873304adc9c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Feb 16 13:30:25 2014 +0000

    FAQ: Create new section about problems opening disk images.
    
    Move the stuff about encoding problems here, because these are not
    really common problems.

commit 6594e88d80cbd49f798e393cad207d989adf7bc9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Feb 16 19:15:29 2014 +0000

    FAQ: Remove old RHEL 6.5 section.

commit 6cc521dc4533d10659214cc660f31239de9e28e7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 15 20:27:12 2014 +0000

    generator: Sort most output.
    
    Look for use of external_functions and fish_functions and replace with
    use of external_functions_sorted and fish_functions_sorted where
    possible.  This ensures that the output of the generator is sorted as
    far as possible.
    
    I also checked for uses of internal_functions and documented_functions
    but those are not used.  The *_sorted versions are always used
    instead.

commit bbfb9f9480baf3bbf62c6a07252bad9030bdc4a1
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Fri Feb 14 09:09:47 2014 +0100

    podwrapper: Recognize git-style dates in ChangeLog

commit bf8d75590c3924c3ebe343bf354e93ec7e84ccf9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 13 21:45:47 2014 +0000

    test: Use = instead of == for testing string equality in bash script.
    
    Found by make syntax-check.

commit d56b8bcb2c6509b5644fb4d79abb3a4211191388
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 13 21:45:31 2014 +0000

    Remove some unused header files.
    
    Found by make syntax-check.

commit f5de589966ae7f22a83d6ef6be6140ae68551a7b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 13 21:41:12 2014 +0000

    src/drives.c: Remove useless if-before-free.
    
    Found by make syntax-check.

commit 9018356a67eb644126814e4ef41555c56e884a79
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 13 21:39:50 2014 +0000

    Use bindtextdomain in some programs where it was missing.
    
    Found by make syntax-check.

commit e3d23cccf4099680a4335db97fe2ccf2d3c950f4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 13 21:38:42 2014 +0000

    builder: Suppress warning about unused yyunput.
    
      CC       virt_index_validate-index-validate.o
    index-scan.c:1270:17: warning: 'yyunput' defined but not used [-Wunused-function]
         static void yyunput (int c, register char * yy_bp )
                     ^
      CCLD     virt-index-validate
    
    By using %option nounput we can prevent this from being generated in
    the first place.

commit 9df9c871477d31ebd12c851069ba29ace352c584
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 13 21:07:40 2014 +0000

    configure: Move ocaml-gettext writing boilerplate to separate m4 module.
    
    This is just code motion.
    
    NOTE that after this commit you have to do:
    
      aclocal -I m4
      autoconf
    
    as 'make' may not do this automatically.

commit e4fe09c5ae28ee34d87bceecf58f72cc43af6249
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 13 17:48:06 2014 +0000

    builder: pxzcat: Fix char * signedness warning.

commit f8bac1329e845734333bf9ab13909a5364a1fa53
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 13 17:47:26 2014 +0000

    mllib/uri-c.c: Remove unused variable.

commit 72713825c44b0aa2587a96cf9e1bf089e3227660
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 13 17:39:58 2014 +0000

    gobject: Remove some more warnings from session.c code.

commit e74c957a2b2a293290b54e23fb5a7b16f845917b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 13 15:24:57 2014 +0000

    gobject: Clean up some warnings about unused variables.

commit 23d6d53633fa9cd1c5cd03fbed3aa954d5da2661
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 13 15:01:51 2014 +0000

    gobject: Don't direct error messages to /dev/null.
    
    We might want to see them.

commit 99ce50e0a0f9aa8b2c7459cc38e7d4e8760b19d2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 13 14:34:56 2014 +0000

    gobject: Use spaces between function name and call parameters.
    
    This is just a whitespace change.
    
    This was done by running the following command and then fixing a
    couple of places where it got it wrong:
    
    perl -pi.bak -e 'unless (m/#define/) { s/([a-zA-Z0-9])\(/$1 (/g }' \
      generator/gobject.ml

commit cd9f7411741290add87910d531a9cd8685b3be91
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 13 13:37:55 2014 +0000

    fish/uri: Initialize some variables to avoid a warning.
    
    The warning only appears when we set CFLAGS to be the same as used by
    RPM, which you can do by setting:
    
      CFLAGS="$(rpm --eval '%{__global_cflags}')"
    
    before running ./configure.
    
    FWIW the current value of that RPM expression (in Fedora 20) is:
    
      -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector-strong --param=ssp-buffer-size=4 -grecord-gcc-switches
    
    It is not clear which option precisely enables the warning.

commit 2954541fdd6bd419c43e861c187f4f384996b54d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 13 13:16:39 2014 +0000

    java: Avoid warnings in the tests and examples.
    
    Avoid warnings about missing serial version, and fix a warning about
    raw types.

commit ab2df2e6598d421067d600f89a3d225162424d9b
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Feb 13 14:52:50 2014 +0100

    mllib: hostname: on Debian replace it also in /etc/hosts (RHBZ#953907).
    
    In Debian/Ubuntu systems, read the previous hostname from /etc/hostname
    before replacing it, and replace it in /etc/hosts with the new hostname.

commit 4ca4eef0cc6877a595c3d71c09d3dc18a803b638
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Feb 13 10:57:31 2014 +0100

    sysprep: remove RH subscription manager files
    
    Add a new operation for it, which should do what
    `subscription-manager clean` does.
    
    Part of RHBZ#1063374.

commit f78877c77e502ac829ccbc11207b807bb1688420
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Feb 13 10:50:15 2014 +0100

    sysprep: remove RH subscription manager log files
    
    Part of RHBZ#1063374.

commit dcd5edd5d40757acd5515b57113a34555dfb52e3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 12 22:47:53 2014 +0000

    Version 1.25.34.

commit 3d4cc3cf576c5bf6105f5693eda87e5c6f775f5e
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Feb 12 15:12:19 2014 +0100

    mllib: hostname: add a newline in /etc/hostname
    
    /etc/hostname usually has an ending newline, so add it when changing it.

commit 82a4a8f02c5706979d961ad6c4ac767a37a3a7c9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 12 09:32:08 2014 +0000

    FAQ: Another common problem is permission denied errors when running as root.

commit 37aead588efc258472ebb923abb7804257d5ce0d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 12 09:30:39 2014 +0000

    FAQ: Add another common Ubuntu appliance problem.

commit d70ceb4cbea165c960710576efac5a5716055486
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 11 20:08:43 2014 +0000

    list-filesystems: Do not segfault if guestfs_btrfs_subvolume_list returns an error (RHBZ#1064008).
    
    If calling guestfs_list_filesystems with a disk image containing a
    corrupt btrfs volume, the library would segfault.  There was a missing
    check for a NULL return from guestfs_btrfs_subvolume_list.
    
    This adds a check, returning the real error up through the stack and
    out of guestfs_list_filesystems.
    
    This is potentially a denial of service if processing disk images from
    untrusted sources, but is not exploitable.
    
    Thanks: Jeff Bastian for reporting the bug.

commit 76e3e15d031df77db71b11ac1c40199eff80fa4d
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Feb 11 12:52:10 2014 +0100

    builder: do a copy when downloading local files
    
    Instead of spawning curl even to "download" file:// URIs, just copy
    them.

commit ba3569704cf5f381c618b6b07c8b001bac88e18a
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Feb 11 12:39:56 2014 +0100

    builder: prepare for different per-protocol download actions
    
    Small refactor of Downloader.download_to to allow different download
    actions depending on the protocol of the URI (which is now parsed).
    
    No actual behaviour changes, just mostly code motion.

commit c66cec6ffac2af400487b7fb4ff437eddc6e7aa7
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Feb 11 10:40:31 2014 +0100

    builder: isolate C libraries in an own OCAMLCLIBS
    
    Just moving stuff within Makefile.am, no functional changes.

commit a948389ce9c76bf7e8997bb27f3daac06cb20c50
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Feb 10 11:00:09 2014 +0100

    actions/part_set_gpt_type: set type of "guid" parameter as "GUID" (RHBZ#1008417).
    
    Switch the type of the "guid" parameter from "String" to "GUID"; this
    adds the validation of the GUID as such, rejecting straight away invalid
    GUIDs which otherwise could be handled badly by low-level tools (such as
    sgdisk).
    
    Add a couple of easy tests (taken from RHBZ#1008417) to
    part_set_gpt_type about this.

commit 775cad63a3f2156b38e7d8360b88ed11615779e8
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Feb 6 20:02:51 2014 +0100

    generator: generate code for parameter validation
    
    Implemented only in the C output, since every binding uses it anyway,
    and just for the "GUID" type (since its format is well-known).

commit b10dd601fb07eb3d8bf76b5f9fcac1c7fe59d4d5
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Feb 6 17:43:04 2014 +0100

    generator: add a GUID parameter type
    
    At the moment it is basically the change as String, and it is mapped as
    if it was such.

commit beef77403cd9d634b6ff6daa9f33d292e2d320a7
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Feb 6 15:57:09 2014 +0100

    utils: add a function to validate a GUID string

commit ed912a54d6d356e3c22617fd20e3595dd81a7b50
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 5 19:39:28 2014 +0000

    libguestfs-make-fixed-appliance: All supported versions of libguestfs should work.
    
    We're not supporting anything < 1.20 now.

commit 758d021b41bd23700ec6ee00b8c2cdd94d894fe3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 5 15:18:49 2014 +0000

    Version 1.25.33.

commit 798b539a1f95465391f5ab8781ada1e5e63c4355
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Feb 5 11:42:17 2014 +0100

    appliance/init: provide a symlink /var/lock
    
    Provide /var/lock as symlink to /run/lock, as it might be used by
    applications.

commit 59eb9bff87895a2cd779890de73652cb2a0ce503
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Feb 4 15:49:13 2014 +0100

    resize: preserve GPT partition names (RHBZ#1060404).
    
    Save the partition names/labels of the source partitions, and restore
    them after the partition copy.

commit 820b87016794116c783bd224f2e776cfdf65108e
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Feb 4 14:48:14 2014 +0100

    New API: part-get-name (RHBZ#593511).
    
    Counterpart of part-set-name, it uses sgdisk (hence needs the "gdisk"
    feature) to query for the label/name of a partition in a GPT layout.

commit 78c21ce912a9c251ade8e35b63e82e97c96236cd
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Feb 4 13:49:37 2014 +0100

    daemon: parted: refactor sgdisk info parsing code
    
    Isolate in an own function the code that runs sgdisk and parse a field
    of it (using an extraction function passed as parameter), using it for
    the GUID type.
    
    This is just code motion, no actual behaviour changes.

commit 170b64337de32b930b992a0cd584745fb22569ad
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 4 13:27:34 2014 +0000

    resize: Try to remove a few more _ -> .. cases.
    
    This allows the compiler to catch missing cases more effectively,
    especially if we update the types with more cases in future.

commit ef7ac043a640c0dc82260e97fb7ce1f438f7ee2d
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Feb 4 13:32:28 2014 +0100

    resize: properly restore GPT partition types
    
    If there is a GPT partition layout, then what should be read and
    restored for each partition is the GPT type and not the MBR ID.
    
    Related to RHBZ#1060404.

commit eab810f7786d7d3a500a912c74ea85468825f0f8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 4 08:50:43 2014 +0000

    Version 1.25.32.

commit d5b540153fa91230524133c09c879199b8e2d902
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 3 13:56:13 2014 +0000

    Remove bogus license file from daemon subdirectory.
    
    It was left over from when the daemon was a separate autoconf
    directory, and in any case the daemon has never been GPLv3 (it is
    GPLv2+).

commit d93e3c50eb3062263792b0be5022abe8504604d9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 3 09:08:12 2014 +0100

    fish: Additional GUESTFISH_* environment variables to control the prompt.
    
    This adds:
    
     - GUESTFISH_INIT
     - GUESTFISH_OUTPUT
     - GUESTFISH_RESTORE
    
    which along with existing GUESTFISH_PS1 allow you to fine control the
    colour of the output.

commit bed8a168c0ed76e784adcc046256432f615e3314
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Jan 30 17:06:42 2014 +0100

    builder: remove unused variables
    
    Leftovers of the list_entries_short+list_entries_long split done in
    commit 91aae893c70b3877b31803800ba77836fd7a45e8.

commit 07ef60c63f5fd635306d199622d36f9089c75ecc
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Jan 30 17:05:34 2014 +0100

    builder: output translated notes
    
    Output all the translations available for the notes in the "verbose"
    output and the JSON output, while trying to match the system langauge in
    the "show notes" output.
    
    The JSON output is slightly changed to handle translations, with the
    "untranslated" notes being matched as "C". The version is not bumped
    though, since there have been no stable releases with the former output
    yet.

commit 49014f81f350484da725f5ee2bc62bb24268a334
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 29 14:50:55 2014 +0000

    sysprep: Deprecate --selinux-relabel in favour of --autorelabel.
    
    virt-builder added a --selinux-relabel option with a slightly
    different meaning.
    
    This commit keeps the old --selinux-relabel / --no-selinux-relabel
    options in virt-sysprep, but deprecates them and replaces them with
    --autorelabel and --no-autorelabel.

commit fc6d3e6a9a920446fecc347a0521a1e3eda183d8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 29 14:46:05 2014 +0000

    sysprep: Add a reference to virt-builder from the manual page.
    
    The whole "COPYING AND CLONING" section really needs to be overhauled
    too, but first we need to make virt-builder work properly for
    customizing templates.

commit 5db1a28461cc42f09532e8b98150e716040d3aa0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 29 14:38:50 2014 +0000

    sysprep: Add --scrub option.
    
    This works like the option in virt-builder with the same name.

commit 2595fa5069383522741ffea3afbe99253e3899b2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 29 14:03:45 2014 +0000

    builder: Move Perl_edit module into common code.
    
    There is no functional change.

commit c841d08d7084db69e81614d54423686cf0566ad6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 29 09:31:24 2014 +0000

    appliance: Create checksum file with mode 0644 instead of 0755.
    
    Initial commit 4beb2844091310012b5e28971707397d1d51d833 used mode 0755
    for no reason.  It seems to have been a mistake.

commit f0f95bd0385874de976e58875aefc1279814d0bc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 29 08:45:19 2014 +0000

    perl: Data::Dumper and String::ShellQuote modules are no longer required.
    
    They used to be used by old Perl virt-make-fs.  Nothing else uses
    them.
    
    This updates commit d3512deb6728dffbb3a958c7168b81dbde56d748.

commit 32cbd7ca0d90d0013f92f64c3c5755ebed2fb960
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 29 08:19:32 2014 +0000

    make-fs: Remove warning from man page about lone --partition argument.
    
    C's getopt_long has no problem with this.

commit a8a655a85900297f0ddb3d599a09b80b9be8581a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 29 08:18:05 2014 +0000

    make-fs: Ensure --partition (on its own) creates an MBR partition.
    
    This fixes commit d3512deb6728dffbb3a958c7168b81dbde56d748.

commit 90d33787783c8bf383003ca99ba58068b2935a6c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 29 08:11:37 2014 +0000

    make-fs: Refactor debug stats code.
    
    Code motion, no functional change.

commit 5bf8c81d7d5bf438b13f3866750362d002847129
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 29 08:08:33 2014 +0000

    make-fs: Use an anonymous pipe instead of a named pipe.
    
    The previous translation from Perl slavishly followed the Perl code a
    bit too much and used a named pipe to communicate between the
    uncompressing subprocess and libguestfs tar-in.  From C we can use an
    anonymous pipe instead.
    
    This updates commit d3512deb6728dffbb3a958c7168b81dbde56d748.

commit c86fcc0fd4dde908bce41f9a5ca90b5fcd89f7e9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 29 08:00:55 2014 +0000

    make-fs: Make check-valgrind do something.

commit f5bc913434e5f895c52037231e1b018c57f01949
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 29 08:00:30 2014 +0000

    make-fs: Run virt-make-fs in test from builddir, not srcdir.

commit 59fce974e29110ca2831c22191456af0cc4b8f8f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 28 22:17:12 2014 +0000

    pod: Remove stray +x (executable) mode on various POD files.
    
    find -name '*.pod' -perm /0111 -exec chmod -x {} \;

commit 1771e1f2b2dc4b06896c13adf919b0ddb39e47c9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 28 22:10:25 2014 +0000

    Version 1.25.31.

commit 233d5410e5539c638ea186b81d43cf114c2ce217
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 28 21:56:18 2014 +0000

    sysprep: Add script4.sh (test script) to EXTRA_DIST.
    
    This fixes commit ce9d4d335b0c13f3ea75048666ccf5b63de29f8e.

commit dc91bf723174c486c3568d0098cf990482ef97fa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 28 21:01:48 2014 +0000

    Version 1.25.30.

commit 642cf4c5dc9af340173ff9aee2c432d6e69f480a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 28 20:26:42 2014 +0000

    tests: Test --label and other options in virt-make-fs.

commit d3512deb6728dffbb3a958c7168b81dbde56d748
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 27 13:29:54 2014 +0000

    Rewrite virt-make-fs in C (originally Perl).
    
    It should be very compatible with the Perl version.

commit 40512c66af562886311b5eff50a505b95c5fbadd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 28 18:53:25 2014 +0000

    daemon: Always pass -F option to mkfs.ntfs.
    
    Otherwise it moans about:
    
      mkfs: ntfs: /dev/sda: /dev/sda is entire device, not just one partition.
      Refusing to make a filesystem here!
    
    This has been happening for a while, so I don't know why we didn't
    notice it before.  It even happens on RHEL 6.
    
    A simple reproducer is:
    
      virt-make-fs -t ntfs any-tarball.tar.gz test.img

commit 9015d5ac1491a7a1fa662deab007f3fee7e4e53e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 28 15:08:16 2014 +0000

    virt-make-fs: Use disk-create API instead of calling qemu-img create.
    
    Strictly speaking this reduces the number of formats that virt-make-fs
    can output to, but it's likely that no one cares and if they do we can
    add new formats in future.

commit a594b7f90a682e2a9327b142138edb76ad8ba8ff
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 28 15:07:33 2014 +0000

    sparsify: Use new disk-create API instead of calling qemu-img.
    
    disk-create doesn't support the lazy_refcounts option.

commit 40261e4adcdef7b209954d003e2a1b0774e800b0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 28 15:07:26 2014 +0000

    rescue: Note that we're not using add-drive-scratch here, and maybe we should be.

commit f02fddc26bedd28d7b7e35e4c3a2e86d78c7b9ae
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 28 15:06:39 2014 +0000

    tests: Update miscellaneous tests to use disk-create API.
    
    Instead of calling out to qemu-img / truncate.

commit bd12e784e78ec041b3c984620168269d716312d3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 28 15:05:58 2014 +0000

    builder: Use disk-create API instead of calling qemu-img create.

commit d60e6a23a6c8996a23336a33d120fcbee56010f7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 28 15:04:59 2014 +0000

    examples: Update various examples to use new disk-create API.

commit 2794eac7390f8d7eb7b76cb0c374b4b2266d98a9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 28 15:04:09 2014 +0000

    fish: Use disk-create API to implement guestfish 'alloc' and 'sparse' commands.

commit 1e5eb0aebb80c2a37dfca018f589f0d84ee6e6ea
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 28 15:03:09 2014 +0000

    lib: Use disk-create API instead of qemu-img/truncate inside the library.

commit 588af1953e5f7ab74009b9175cc5d3efb8bb651a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 28 13:09:06 2014 +0000

    New API: disk-create for creating blank disks.
    
    This is a wrapper around either 'qemu-img create' or calls to open,
    truncate and posix_fallocate which litter and complicate existing
    code.

commit 65fc841ea68f0739ad1cd40c213b55200df6ceb8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 28 13:08:38 2014 +0000

    src/Makefile.am: Reorder SOURCES into alphabetical order.

commit e3f72805d108c601280b889692c47d7d825e6079
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 27 21:58:42 2014 +0000

    run: Actually use timeout --foreground option (RHBZ#1025269).
    
    The following commit managed to not actually add the --foreground
    option to the timeout command, just test for it.  Add it this time.
    
      commit 681488877456b83f039dc518861f29ab4e1857f0
      Author: Richard W.M. Jones <rjones@redhat.com>
      Date:   Thu Dec 19 08:21:53 2013 +0000
    
        run: Use timeout --foreground option.
    
        If timeout doesn't have this option (RHEL 6) don't use timeout at all.
    
        Attempt to fix RHBZ#1025269.

commit d9cd2dc9b0e847fda3831c9ff13def616ca5043d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 27 21:20:32 2014 +0000

    daemon: Add a note about how 'mount --rbind' doesn't work.

commit 9df50877f8b61106248acd2375d011acc209c6b5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 27 20:22:23 2014 +0000

    daemon: If /selinux exists in the guest, bind-mount /sys/fs/selinux to there.
    
    Commit 72afcf450a78b7e58f65b4a7aaf94d71cd25fca5 was partially
    incorrect.  If the guest userspace is expecting /selinux to exist,
    then we should bind-mount /sys/fs/selinux from the appliance kernel
    there.

commit ce9d4d335b0c13f3ea75048666ccf5b63de29f8e
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jan 28 15:04:38 2014 +0100

    builder, sysprep: initialise the random generator
    
    virt-builder and virt-sysprep may make use of
    Common_utils.string_random8 (which uses Random.int) for constructing
    temporary paths; not initialising the random generator means that every
    invocation will reuse the same name used previously (!).
    Thus just call Random.self_init, just like virt-sparsify already does.
    
    Expand the test-virt-sysprep-script.sh test to ensure that virt-sysprep
    is not affected again by this issue.

commit 95f8144cb605b70d4cb9ab3ca0976c1e1428b3d0
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Jan 27 17:25:55 2014 +0100

    tests/regressions: remove C part of rhbz1044014
    
    All it did was checking for a libvirt version, which is what
    libvirt-is-version now does; hence remove the C part, and use guestfish,
    ignoring the launch failure (as the C test did).

commit 4310f8f1753dc923ba5012f243014f54709f30fb
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Jan 27 16:33:22 2014 +0100

    tests/disks: skip test-qemu-drive-libvirt.sh if libvirt is < 1.1.3
    
    This test relies on the <test:runstate> element in the domain XML, which
    has been introduced in libvirt 1.1.3.

commit c01fb37839d28678dd8f5e33ec7fa376b03e8d71
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Jan 27 16:31:32 2014 +0100

    tests: add a a simple libvirt-is-version test tool
    
    libvirt-is-version returns successfully in case the available version of
    libvirt is greater or equal than the specified major/minor/release
    values.

commit f66d6a85b633f0e79d14c311db4020e22709117a
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Jan 27 14:25:47 2014 +0100

    tests/mountable: add missing space in test-mountable-inspect.sh
    
    No actual behaviour, other than getting rid of a bash warning.

commit de7a8336cd7c8806231e22e12c29b93463308065
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 25 12:04:37 2014 +0000

    Version 1.25.29.

commit 4e18712562fe69cae8901e9534dbbcf0d4d87192
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 25 11:56:40 2014 +0000

    tests/disks/test-qemu-drive-libvirt: Include test data.
    
    This was inadvertantly deleted.
    
    This fixes commit 01d27033bdd12974f850ff7a8e5de8f6b790379d.

commit 24e61492cc2db3aeb2943da84e4c07acfbcce2a0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 25 10:59:03 2014 +0000

    Version 1.25.28.

commit 080300dfec1dd603da2f7d53e72dd3e056317fb8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 24 19:43:05 2014 +0000

    builder: Add documentation for enabling Puppet (agent) in a guest.

commit 90e23b4e566f88595ac697b45d2531de851be6df
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 24 19:38:26 2014 +0000

    builder: Add --selinux-relabel option to perform SELinux relabelling.
    
    This adds the --selinux-relabel option which enables selinux in the
    appliance and runs:
    
      if load_policy && fixfiles restore; then
        rm -f /.autorelabel
      else
        touch /.autorelabel
      fi
    
    at the end of installation.
    
    When possible this fixes SELinux labels in the guest and makes the
    autorelabel step unnecessary.
    
    Notes:
    
     - The previous commit is required so that load_policy works.
    
     - During the build, SELinux is enabled but no policy is loaded.  This
       works because SELinux is in permissive mode.
    
     - This flag does not work if the appliance kernel and the guest have
       greatly differing versions, eg. a RHEL 6 guest with a Fedora 20
       appliance.  This is because SELinux changes the policy format and
       breaks backwards compatibility.  You would see errors like this:
    
       libsepol.policydb_write: policy version 15 cannot support MLS
       libsepol.policydb_to_image: could not compute policy length
       libsepol.policydb_to_image: could not create policy image
       SELinux:  Could not downgrade policy file /etc/selinux/targeted/policy/policy.24, searching for an older version.
       SELinux:  Could not open policy file <= /etc/selinux/targeted/policy/policy.24:  No such file or directory
    
       These errors are ignored (they go to the log file) and relabelling
       is done at boot instead.
    
     - It's not clear if loading guest policy is safe.  You should trust
       the virt-builder templates and to use libguestfs confinement for
       additional protection.

commit ab33653ef312e18042be08854aa0dec2c7254fc2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 24 19:36:33 2014 +0000

    daemon: Bind-mount /sys/fs/selinux into sysroot when running commands.
    
    Even though we are already bind-mounting /sys, it is necessary to also
    bind-mount /sys/fs/selinux in order for SELinux commands (in
    particular, 'load_policy') to work.
    
    This fixes/reverts commit 7367729ec7a5d016878dd00b32cce45cec372931.

commit 0e2489974b91e4728d544fe2aa08c2a1c9deb365
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 24 10:20:14 2014 +0000

    fuse: In mount-local-run, test if root filesystem has been mounted (RHBZ#1057504).
    
    It is never normally valid to use the mount-local* APIs when you
    haven't mounted some filesystems in the libguestfs namespace.
    
    If you try it, it results in some odd errors.  The mount-local-run
    call is successful, but subsequent operations fail:
    
    $ mkdir -p /tmp/mnt
    $ guestfish -x -N fs mount-local /tmp/mnt : mount-local-run
    libguestfs: error: lstat: lstat_stub: you must call 'mount' first to mount the root filesystem
    libguestfs: error: lstat: lstat_stub: you must call 'mount' first to mount the root filesystem
    
    With this commit, the mount-local-run call gives an error:
    
    libguestfs: error: you must call 'guestfs_mount' first to mount a filesystem on '/'.
    Note: '/tmp/mnt' is still mounted.  Use 'guestunmount /tmp/mnt' to clean up.
    
    The error is implemented by calling guestfs_exists (g, "/") which has
    the side effect of running the NEED_ROOT macro in the daemon.  (There
    is no simple equivalent of NEED_ROOT on the library side.)

commit 01d27033bdd12974f850ff7a8e5de8f6b790379d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 23 21:49:16 2014 +0000

    lib, fish: Handle Gluster, NBD, iSCSI and Sheepdog paths properly.
    
    This fixes the handling of paths for the protocols named above, with
    respect to leading '/' (or not) on the volume/export name.
    
    See previous commits which did the same fixes for Ceph:
    commit 53a3ff9c005fd69e773fdb18461a635c2502df1b
    commit 992a6b297023711862229aabe4e23b6a1c94c1cc

commit 870f076bddbc540b793670990dc504ef36fb2f41
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 23 19:35:23 2014 +0000

    Version 1.25.27.

commit 3331db84bc0e720abec0dfbc82bba15ccae00b6e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 23 14:14:26 2014 +0000

    resize: Don't truncate libguestfs error messages.
    
    If we rely on OCaml's internal exception printing, then it will
    truncate error messages like this:
    
      Fatal error: exception Guestfs.Error("could not create appliance
      through libvirt.
    
      Try running qemu directly without libvirt using this environment
      variable: export LIBGUESTFS_BACKEND=direct
    
      Original error from libvirt: unable to set security context
      'unconfined_u:object_r:svi
    note the truncation here ^^^^^^^
    
    Instead of using the internal exception printing, wrap the whole
    program in a 'main ()' function and add an exception handler.
    
    This large change is non-functional apart from the addition of the
    exception handlers at the end.

commit e8c10670213076b10bad2d0aac181637acd150b0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 23 13:31:11 2014 +0000

    launch: direct: Stop using deprecated -no-kvm-pit-reinjection if qemu is new enough (RHBZ#1053847).

commit 1d6ba35e6f57b3424b01bb0fe0debe57808b5abd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 23 10:48:57 2014 +0000

    tests: Add a test of libvirt domain XML to qemu command line (RHBZ#1026688).
    
    This tests that libvirt domain XML (ie. guestfish -d option) is parsed
    correctly and results in the correct qemu command line when using the
    direct backend.
    
    This is a good end-to-end test of various layers.

commit 1ed0ce3ef8877012d0909c5ae2ef5c29c61cf123
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 23 11:40:27 2014 +0000

    libvirt domain: Allow network drives with no <source name="..."> attr.
    
    This is valid for some network drives, for example:
    
      <source protocol='nbd'>
        <host name='foo' port='1234'/>
      </source>
    
    We pass an empty string as path to the guestfs_add_drive_opts API in
    this case.

commit 1d2e74414b04d69ed48984a7a4e809be502c7999
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 23 11:31:40 2014 +0000

    libvirt-domain: Remove unnecessary and wrongly indented parens.

commit 58ada01783ccac13e4ad86b71210d44e7084b8a5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 23 11:05:01 2014 +0000

    libvirt domain: Allow network drives with no <host> elements.
    
    This is valid for some network drives:
    
    <source protocol='rbd' name='abc-def/ghi-jkl'/>
    
    instead of this:
    
    <source protocol='rbd' name='abc-def/ghi-jkl'>
      <host name='foo' port='1234'/>
    </source>
    
    Allow both forms.

commit 992a6b297023711862229aabe4e23b6a1c94c1cc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 23 08:30:12 2014 +0000

    fish: Handle Ceph/rbd URIs and convert them to paths properly (RHBZ#1026688).
    
    The path at the API level (for guestfs_add_drive_opts) is:
    
      pool/disk
    
    The URI syntax is either rbd:///pool/disk or rbd://server:port/pool/disk.
    Because of the way URI parsing works we may need to remove a leading
    '/' character before passing the path down to the API.

commit 53a3ff9c005fd69e773fdb18461a635c2502df1b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 23 08:28:09 2014 +0000

    lib: Handle Ceph/rbd paths properly (RHBZ#1026688).
    
    The path at the protocol level is:
    
      pool/disk
    
    (with no leading '/' character).  This is now what you have to pass to
    guestfs_add_drive_opts.
    
    Also Ceph can be called with no explicit servers (it uses the contents
    of /etc/ceph/ceph.conf instead).  So allow zero servers to be used.

commit b93a1d50ad1dfe44e6ad2434dbc3f0c71fda7141
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 23 08:27:30 2014 +0000

    fish/uri: Tidy up error messages.

commit b7cd63fc1dc031914e110a46de3faa431387d959
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Jan 23 15:36:15 2014 +0100

    builder: read all the available notes from the index
    
    Switch the internal storage for the notes of each entry to a sorted list
    with all the subkeys available (which should represent the translations
    to various languages).
    The current outputs are the same (i.e. still the untranslated notes), so
    this is just internal refactoring/preparation.

commit 958e84d69960faf5b321bdec92283a0b37abd858
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Jan 22 23:13:24 2014 +0100

    builder: small code simplification
    
    No actual behaviour changes, just remove extra match statements.

commit 2541563a18309f0adf4c2e48bd16ccc39d4b76b9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 22 18:01:17 2014 +0000

    Version 1.25.26.

commit 629cb87b6d3cdf1d2d80754c5cd4241c7781bcf4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 22 17:13:00 2014 +0000

    tests/regressions: Don't include binaries in EXTRA_DIST.
    
    Because EXTRA_DIST simply used $(TESTS), and because the list of tests
    includes C binaries, these were included in the tarball (actually not
    binaries, but libtool scripts, but it's still undesirable).

commit 7d8d065feee46337a2c4a3b4736f57878de84928
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 22 17:00:43 2014 +0000

    tests: Add a regression test for RHBZ#1054761.

commit aa2ca8ba703254267939dfcd8d276cbd6f651858
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 22 17:10:09 2014 +0000

    daemon: lvm2: Ignore "unknown device" output when a PV is missing (RHBZ#1054761).

commit 49c3d819c184f71ac98cd436fb9435f5b3bbddda
Author: Colin Walters <walters@verbum.org>
Date:   Wed Jan 22 15:45:08 2014 +0000

    generator/set-uuid: Fix two typos in documentation

commit 9e4357ca54282c1ab053dd5a8ebd64a323830cf4
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Jan 22 15:34:22 2014 +0100

    builder: fix small regression in subkey parsing
    
    Introduced in 5cbdf35d651b6c730d62d9af4876039faa122efc, it caused the
    first character of the value to be skipped if the key has a subkey.

commit 13bca32e4ec9213e69ea55e837dea846719fb67e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 22 13:10:08 2014 +0000

    sparsify: Prevent overwriting block or char output devices (RHBZ#1056290).
    
    virt-sparsify doesn't work if the output is a block device, and cannot
    possibly work if the output is a char device.  Currently if you try
    this it actually overwrites (deletes) the output device which is not
    exactly desirable.  Therefore throw an error and exit.

commit c6ec6cde27ef87480b9b38f13b08b39eb1400f4b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 22 12:55:52 2014 +0000

    builder: Add -monitor none to example command line.

commit 873051e108eddfdd79205d0c8daf2654ad40e5d6
Author: Dan Lipsitt <danlipsitt@gmail.com>
Date:   Tue Jan 21 11:26:27 2014 -0800

    remove non-portable chmod
    
    'chmod --reference' is not available on Mac OS X.
    
    Keeping the original file and directing edits into it preserves permissions and removes the need to chmod.
    
    (Tried 'sed -i' for inplace editing but unfortunately it isn't portable either.)

commit ebb04b64a2c630089f7d6e8261f4cb2b93e12724
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 21 18:37:26 2014 +0000

    Version 1.25.25.

commit 5cbdf35d651b6c730d62d9af4876039faa122efc
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jan 21 18:52:42 2014 +0100

    builder: proper consider subkeys in index files
    
    The index files already allowed the 'key[subkey]=...' syntax for keys,
    but considering such string as whole key. Proper split the parsing and
    the handling of the subkeys, so they can be searched a bit easier.
    
    This causes no actual behaviour changes, it is just internal
    micro-refactoring. (Thanks Rich for the hints, too.)

commit 20a4bfde9628cfeb8bea441cab7dcc94843b34e3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 21 17:15:11 2014 +0000

    builder: Add tip for how to relabel SELinux guest at build time.
    
    Thanks: purpleidea/James.

commit 88094f3da44eb9871d67a1a015362b7ae20e00dd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 21 17:13:35 2014 +0000

    builder: Clearer note in man page about SELinux and where /.autorelabel file comes from.
    
    It's not added by virt-builder.  It is present in the templates (added
    by virt-sysprep in fact).

commit be5fd2fd349af5e306c7e139a23548c351701015
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 21 17:13:18 2014 +0000

    builder: Add note about cloning to man page.

commit 3e3e7cf02990ba00e6c9b622248da26e2c790af2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 21 11:46:17 2014 +0000

    sysprep: Replace flags list with side_effects object.
    
    Previously callbacks would return a list of flags, such as []
    or [`Created_files].
    
    In this commit we introduce two new objects, filesystem_side_effects
    and device_side_effects (the latter is not used yet).
    
    The callbacks that create files now need to call
    
      side_effects#created_file ()
    
    instead of returning flags.
    
    There is no functional change in this patch.

commit 11b4fc88fb6c567a7384fc36ecef526ed71f6f42
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 21 11:16:21 2014 +0000

    sysprep: Update comments.

commit 4505f61979a9737da53cdad419ae6d22538780d5
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jan 21 17:54:23 2014 +0100

    builder: allow more empty lines in index files
    
    Improve the index grammar to allow more than one empty line between
    sections, and to allow any number of empty lines at the end of the file
    (after the last section).

commit e2cc8b6465a400024fe2f0fcce0d0ff5f7e7719c
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jan 21 10:54:19 2014 +0100

    builder: add index-struct.h as dependency for index-parser-c.c
    
    Just like with index-parse.h, also index-struct.h is a dependency of
    index-parser-c.c which automake cannot generate correctly.
    Thus, add it manually.

commit 10b20b79384e2446277b3196f12a9736af7ff13b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 21 11:07:03 2014 +0000

    test-tool: Rearrange output into alphabetical order.

commit ffe1eaa11c68009ab8ac43317203a69489282f6a
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Jan 20 16:04:48 2014 +0100

    Revert "Minimum libvirt version is >= 1.1.1."
    
    0.10.2+ is still available on some recent-ish stable distros (like
    Fedora 19, Ubuntu 13.04), and should work fine for guestfs.
    
    This reverts commit 6b3e05e8da490fc11a2f07f0cc9022216a744ac7.

commit a7b5be067ee01e520de7a0384d79163e1e6f8ce6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 20 14:34:03 2014 +0000

    dist: Run 'git log' instead of custom script.
    
    It's useful to see the complete SHA1's since that is how we refer to
    fixes in Bugzilla.

commit ee90a36521e97fdceb9ef3169c25499cee46d0db
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 20 12:09:29 2014 +0000

    tests: Add regression test for get-attach-method == "appliance".
    
    This updates commit ecd31806a491c735878e9e54540a5c11ca1adce9.

commit ecd31806a491c735878e9e54540a5c11ca1adce9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 20 10:13:18 2014 +0000

    tests: Add a regression test for parsing LIBGUESTFS_BACKEND/LIBGUESTFS_ATTACH_METHOD (RHBZ#1055452).

commit 69267d8762b586deab6b930131e1d677ba85df8d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 20 10:21:26 2014 +0000

    launch: Allow backend = "appliance" for backwards compatibility (RHBZ#1055452).
    
    This fixes a regression which was introduced in
    commit 0f26218905816ca86b6ec57070eed802515f4853.

commit d0c5450c451acde4357ebcb4a5f9d4a74332a864
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jan 19 20:28:35 2014 +0000

    daemon: Use wipefs_has_force_option to decide whether to add wipefs --force option.

commit d87cfefcdd22939a9a0c86e3e8fcb467f4181b2a
Author: Olaf Hering <olaf@aepfle.de>
Date:   Sun Jan 19 20:22:49 2014 +0100

    daemon: add missing GUESTFSD_EXT_CMD usage
    
    Signed-off-by: Olaf Hering <olaf@aepfle.de>

commit badc4ffad555dc95770598cb040469e48a02d56a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 18 21:38:11 2014 +0000

    Version 1.25.24.

commit a1eacea5729b209d1187981d704193723004d6b1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 18 16:55:09 2014 +0000

    init: Display clocksource (only when debugging is enabled).

commit 012b01a0fb875bc8aade5a57adbb86599bc2c86c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 18 16:52:58 2014 +0000

    launch: direct: Make sure we pass lpj= parameter when using TCG.
    
    I have verified that 'refined-jiffies' is the clock source when using
    TCG (ie. not kvm-clock which seems only to be used for KVM).

commit 26f7fb237b713c798e23a336a3c4973513f83551
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 18 16:36:14 2014 +0000

    launch: libvirt: Add force_tcg backend setting.
    
    By using:
    
      export LIBGUESTFS_BACKEND_SETTINGS=force_tcg
    
    you can force the libvirt backend to use TCG (software emulation)
    instead of KVM (hardware accelerated virtualization).

commit 11ac9f702440fff5c8dad1f9756f24ca6867712c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 18 16:28:58 2014 +0000

    launch: direct: Add force_tcg backend setting.
    
    By using:
    
      export LIBGUESTFS_BACKEND=direct
      export LIBGUESTFS_BACKEND_SETTINGS=force_tcg
    
    you can force the direct backend to use TCG (software emulation)
    instead of KVM (hardware accelerated virtualization).
    
    This is sometimes useful, especially if you are trying to use
    nested KVM on Intel.

commit 1e4663858bef9fa6d50526f675f6c572d9fde78f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 18 15:33:10 2014 +0000

    New API: set-backend-settings, get-backend-settings.
    
    Allow settings (an arbitrary list of strings) to be passed to the
    current backend.  This will allow us to tweak how the backend works,
    eg. by forcing TCG.

commit 815e739d1230ce067b6a09d644257dac031c0ddc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 18 15:56:25 2014 +0000

    utils: Add regression test for C utility functions.

commit 89a617c07d83ac4517d62810c1eb597fa54a5d60
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 18 15:25:26 2014 +0000

    utils: Add utility function to split string into list of strings.

commit 693a21513b8bf4c61aad76f1860d68f44d5e5e73
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 18 15:25:07 2014 +0000

    utils: Add utility function to copy string lists.

commit 20514fec2507b22e06721c690d050173d097a1fc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 18 16:11:56 2014 +0000

    test-tool: Use size_t instead of int for array index.

commit 3858eeb5171c0d6824c424e03a523e5686a98dfd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 18 14:20:43 2014 +0000

    tests/nbd: Move wait for qemu-nbd to start up earlier.
    
    tests/nbd/test-nbd.pl contains a hack (a call to sleep) to wait
    for qemu-nbd to start up in another process.
    
    This sleep was previously located before the call to $g->launch()
    since that is where (previous to commit 4a0f5ed382) the backend would
    have connected to the NBD server.
    
    However in the new code, an initial NBD connection test is done when
    the drive is added (ie. $g->add_drive (..., protocol=>"nbd")), which
    duly failed intermittently because the qemu-nbd server had not opened
    its socket yet.
    
    Move the wait earlier -- just after the fork -- to avoid this.
    
    This updates commit 4a0f5ed38233393e75ea69ff0595936aed0e8abb.

commit b6ff6421686e6fd7e5f7db8eed24419c7bd09688
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 18 11:55:27 2014 +0000

    Use recommended timer settings for KVM (RHBZ#1053847).
    
    See: https://bugzilla.redhat.com/show_bug.cgi?id=1053847#c0
    
    Thanks: Cole Robinson, and several QEMU developers.

commit 937c0313a070ab9e9b7d75ffd8e509412ca7d755
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 18 11:40:30 2014 +0000

    launch: libvirt: Slightly simplify the XML generation code further.
    
    This updates commit 96737fc5b7a0c9f92896f4a7d0f738a66c56d3b0.

commit e5190e09325f857c777474f793c1874e1e971ee9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 17 19:32:05 2014 +0000

    Version 1.25.23.

commit c537b26f209513abb0bd48f46f300ecf6728618a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 17 19:23:27 2014 +0000

    uml: Fix rule which disables relative-paths test on UML.
    
    This fixes commit e22bd2dcd26ffe822a68c23852bbafe4767d98f0.

commit 716f6e4275fc490bffff96e713ad9dbf230aff97
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 17 15:48:22 2014 +0000

    Version 1.25.22.

commit e22bd2dcd26ffe822a68c23852bbafe4767d98f0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 17 15:07:55 2014 +0000

    tests: Add a test of relative paths, to make sure we don't break them.
    
    In some places we turn relative paths passed by the caller into
    absolute paths: for example in the libvirt backend, all relative paths
    to disk images have to be turned into absolute paths (by calling
    realpath) because otherwise libvirt doesn't work.
    
    This has the potential to break things, especially considering that
    qemu uses the path passed to it in order to resolve the relative paths
    of backing files.
    
    For example consider the case where 'overlay' is a symbolic link to
    /dev/dm-1, but /dev/dm-1 contains a qcow2 which references './backing'
    as its backing file.  If we rewrote 'overlay' to '/dev/dm-1', then
    qemu would try to look up '/dev/backing' for the backing file and
    fail.
    
    See also:
    
    https://bugzilla.redhat.com/show_bug.cgi?id=1053684
    https://www.redhat.com/archives/libguestfs/2014-January/thread.html#00087

commit 96737fc5b7a0c9f92896f4a7d0f738a66c56d3b0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 17 09:37:30 2014 +0000

    launch: libvirt: Use C macros to simplify XML generation.
    
    This commit implements some hairy C macros to simplify
    XML generation.
    
    Given the target XML:
    
      <cpu mode="host-passthrough">
        <model fallback="allow"/>
      </cpu>
    
    The old code would have looked like this:
    
       XMLERROR (-1, xmlTextWriterStartElement (xo, BAD_CAST "cpu"));
       XMLERROR (-1,
                xmlTextWriterWriteAttribute (xo, BAD_CAST "mode",
                                             BAD_CAST "host-passthrough"));
       XMLERROR (-1, xmlTextWriterStartElement (xo, BAD_CAST "model"));
       XMLERROR (-1,
                xmlTextWriterWriteAttribute (xo, BAD_CAST "fallback",
                                             BAD_CAST "allow"));
       XMLERROR (-1, xmlTextWriterEndElement (xo));
       XMLERROR (-1, xmlTextWriterEndElement (xo));
    
    The new code looks like this:
    
       start_element ("cpu") {
         attribute ("mode", "host-passthrough");
         start_element ("model") {
           attribute ("fallback", "allow");
         } end_element ();
       } end_element ();

commit f106b30c41996a9dedd699c1301f0c3eea1ee6b8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 17 12:14:38 2014 +0000

    drives: Avoid double-free along error path.
    
    This fixes commit 4a0f5ed38233393e75ea69ff0595936aed0e8abb.
    
    A simple test of this:
    
      guestfish <<EOF
      add-drive "" readonly:1 format:raw protocol:nbd server:localhost:10000
      EOF
    
    which would core dump.

commit 6b3e05e8da490fc11a2f07f0cc9022216a744ac7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 16 20:00:03 2014 +0000

    Minimum libvirt version is >= 1.1.1.
    
    Note this is the version in RHEL 7.

commit 4a0f5ed38233393e75ea69ff0595936aed0e8abb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 16 13:40:02 2014 +0000

    drives: Centrally create overlays for read-only drives.
    
    qemu has broken snapshot=on ... again.
    
    Change the way that drives are created so that the backend no longer
    has to use snapshot=on, <transient/> (which never worked), or UML's
    corresponding COW-creation feature (also broken).
    
    Instead of that, the src/drives.c code will create overlays when
    required by calling into a new backend operation 'create_cow_overlay'.
    This operation runs 'qemu-img create -b' or 'uml_mkcow' as determined
    by the backend, and returns the name of the overlay.
    
    The format of the overlay is still backend-specific because qemu needs
    to use qcow2 and UML needs to use COW.
    
    This patch also includes some factorization of the libvirt XML code.
    
    This also drops the drv->priv (private per-drive data) field, since it
    is no longer used by any backend.
    
    This also moves the guestfs___drive_source_qemu_param utility
    function, used & shared by the direct & libvirt backends only, into
    src/launch-direct.c (from src/drives.c).

commit 07e47513dfe77c0c038cc24e714a32fe096bc68f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 16 15:03:04 2014 +0000

    fish: Fix tests that specified qcow2 format, but passed a raw format disk.
    
    In some tests we were specifying qcow2 as the image format when adding
    a disk, but actually passing a raw format image.
    
    Libguestfs previously did not detect this until guestfs_launch, but it
    was still a bug to pass an incorrect format to guestfs_add_drive_opts.
    
    It only worked because these tests never call guestfs_launch.
    
    A later commit in this series will cause this to be detected
    (sometimes) during guestfs_add_drive_opts.

commit b3cf877e58cbcc4f6fd5d228028e19c1b294b1ac
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 16 18:01:20 2014 +0000

    builder: Fix unterminated I<...> in man page.
    
    Thanks: Lukas Zapletal.

commit 5b42351294f4d0ace6960b9f31215f3f97c5259d
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Jan 16 14:58:25 2014 +0100

    builder: add a JSON output for --list
    
    Simple JSON output for sources and templates, to be able to query them
    with no need to parse unstructured outputs like the "--list-format long"
    one.

commit e45bfe0d36c9f50143b13921a498f00ee06ca27d
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Jan 16 12:34:48 2014 +0100

    builder: add --list-format
    
    Add a --list-format which allows to choose which in format should be the
    output of --list.

commit 91aae893c70b3877b31803800ba77836fd7a45e8
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Jan 16 11:49:05 2014 +0100

    builder: small refactor of the list output
    
    Switch from a boolean for the short/long list output to labels for the
    actual format. Also, split the output of each list format to an own
    function for easier maintaineance.

commit 99d6e2c84ef490feb6ff2e37e4b0684f34bac554
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Jan 15 18:51:18 2014 +0100

    fuse: clear stat structs (RHBZ#660687).
    
    Not all the fields of struct stat are actually filled by us. This caused
    rubbish to appear in the microseconds fields, which were then used as
    base when changing atime/ctime (with e.g. touch), triggering EINVAL by
    futimens/utimensat when those rubbish values were out of the range
    allowed for microseconds.

commit 8bbd22d373e5189301c06c6f9e2dd1ae8b848b82
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Jan 15 14:02:24 2014 +0100

    fuse: remove extra trailing \n in debug messages
    
    debug() adds it already.

commit 7c431d703005f7e08567be82caf035feca9b931f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 14 17:30:40 2014 +0000

    builder: Add documentation for how to import images into OpenStack.

commit 775c6daf22884edad8ede4b0916024d3d7c04585
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jan 14 13:30:19 2014 +0100

    builder: test-virt-builder: check some results
    
    Check at least some basic modifications in the image created with
    virt-builder.

commit b7bb1f6cee19da143996c13e6cc019a039f3ee4f
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Jan 14 11:08:25 2014 +0100

    builder, edit, fish: use copy-attributes
    
    Make use of the new copy-attributes command to properly copy all file
    attributes from a file to the new version of it.

commit 4c4480de28aa2c6f614e627b3fd8de69e2905b32
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 13 22:09:26 2014 +0000

    Version 1.25.21.

commit aba64a0327094b6a82686411c4dfa7a30d64ecee
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 13 22:10:39 2014 +0000

    fish: Add test-file-attrs.sh to EXTRA_DIST.
    
    This fixes commit efb5f1841524ec75d765368b447270b8a3aff8ac.

commit e664739a578f31c3f97073e713f9f33d4eb62d8d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 13 20:58:08 2014 +0000

    builder: planner: Whitespace change.

commit 69d9c8515c32dcc67e4ce752215e18eb811f8029
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 13 20:42:48 2014 +0000

    builder: For performance, recommend using the --no-sync option.

commit 5136de98e7f4bd7a967da5b3ede72c729aa7805e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 13 20:29:50 2014 +0000

    builder: Add --no-delete-on-failure option to aid debugging.
    
    This lets you debug failures in virt-builder, especially when scripts
    or installing packages fails.

commit 6879fdf98961bf7ef1610e5d131f1b494892bcdf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 13 20:16:27 2014 +0000

    builder: Minor documentation fix to manual page.

commit e68baf1954f9b68a228c9ae99a738f2d750418c1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 13 19:26:01 2014 +0000

    Update generated files for new copy-attributes API.
    
    This updates commit efb5f1841524ec75d765368b447270b8a3aff8ac.

commit 5fa55389d4a84a942010f8a77d305bc134deacf2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 13 19:25:34 2014 +0000

    builder: Fix documentation for --attach option.

commit d885d6f6a97ee119fe1751df6f7d04844bfbf6be
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 13 16:19:51 2014 +0000

    builder: Document how to set Japanese in Debian 7.

commit efb5f1841524ec75d765368b447270b8a3aff8ac
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Jan 13 14:41:28 2014 +0100

    New API: copy-attributes.
    
    This allows one to copy attributes (like permissions, xattrs,
    ownership) from a file to another.

commit 418c064bc11950b0fa164ef6ba43ac9d628d223f
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Jan 13 14:33:35 2014 +0100

    sysprep: add --operations
    
    Add a new --operation parameter which, similarly to --enable, can be
    used to enable operations, but also to remove them, and to add/remove
    the default operations and all the available ones.

commit 0d1c00211b35e2cf00197293706b89154a526019
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jan 12 18:07:21 2014 +0000

    Version 1.25.20.

commit ed43cc12c4492510e38eee9c7f8a5076956e4066
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jan 12 18:06:26 2014 +0000

    builder/website: Add CirrOS signature file to EXTRA_DIST.
    
    This fixes commit 40b88fdbc76515fd21b33f54587c7f4f7b6e9715.

commit 7500ae3f75f4650c18f2a8433c6b5edcca6e88a6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jan 12 17:49:48 2014 +0000

    builder: Fix virt-builder test.
    
    Add Europe/London timezone to phony Fedora guest.
    
    This fixes commit dd1bfea513658368afd3728e0c5bf8ab6041cd1f.

commit fcdea83c6b9dc94a565a819a9f42e0c4721166e8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jan 12 17:06:02 2014 +0000

    builder: Document how to set Japanese language support in Fedora 20.
    
    This updates/fixes commit 7e8ad13e863a5c87e3da47288bcecdb88ca0e4cb.

commit a8c9aedd51a88b3e08d6cc2580053d44b11f716b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 10 21:17:09 2014 +0000

    builder: Document that SELinux guests will reboot for autorelabel.

commit f40e44c2f97a7fa17e6078d958ae2779b7ca83c7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 10 19:49:02 2014 +0000

    builder: Document how to set up local mirrors for performance and reliability.

commit 7e8ad13e863a5c87e3da47288bcecdb88ca0e4cb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 10 19:48:28 2014 +0000

    builder: Document how to change the language/locale of a new guest.

commit 6d4ac696e54902baf7d76de527b3df3d66c7dfa1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 10 21:18:07 2014 +0000

    builder: Add --link option for creating symbolic links.
    
    This is useful for configuring systemd services.

commit 39bc959c5b3a972e9a12921e002f27aaab2cd5ff
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 10 17:04:28 2014 +0000

    builder: List --install packages in the same order as on the command line.
    
    Previously the list was reversed.  Note this doesn't have any effect
    on how the packages are installed since the guest package manager
    doesn't care about the order.

commit 8ae6b6c9ff855f5eaf3f16188b1bcb4ddba095c5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 10 14:21:17 2014 +0000

    builder: Document how to change keyboard layout.
    
    This is too complex to implement directly in virt-builder.
    
    Instead we just document how to do it for some common Linux distros
    using --run-command, --edit etc.

commit 1e1b027c1b7c592ae8f04bcef8ffe93b7f2841d4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 10 13:47:05 2014 +0000

    builder: docs: Remove confusing reference to timezone.

commit dd1bfea513658368afd3728e0c5bf8ab6041cd1f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 10 12:12:30 2014 +0000

    sysprep, builder: Add --timezone option to set timezone of guest.
    
    You can use it like this:
    
      virt-sysprep --timezone Europe/London ...
      virt-builder --timezone Europe/London ...

commit cea270de3be3ca3c2b2e6555418c4b4eb8da7509
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 10 21:19:43 2014 +0000

    daemon: xattr: Remove unused variable.
    
    Revealed by using ./configure --enable-gcc-warnings.

commit 59d8cf62cb67688cea42a985029adea874f0b7a2
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Jan 10 15:10:03 2014 +0100

    daemon: xattr: move the listxattrs code in an own function
    
    Move in an own function the code that does the (l)listxattrs allocating
    the buffer of the right legth, as it will be useful later.
    
    No functional changes, just code motion.

commit 7630a7bbbdceee8e6aad08511e752f5fcb273416
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Jan 9 18:59:19 2014 +0100

    daemon: xattr: simplify the enabling of the linuxxattrs features
    
    Instead of enable them when having one of the two headers for it but
    still checking for the HAVE_* availability of each *xattr() function
    used, just enable the linuxxattrs as a whole when having any of the
    needed headers (like before) and all the needed functions.
    
    This might cause the linuxxattrs to not be available anymore on systems
    without the whole set of *xattr() functions implemented, but OTOH it
    simplifies the xattr.c implementations.

commit 746a0b1f19667606ee63c8d3ab6a75531a8bd71c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 8 20:22:21 2014 +0000

    tests: Add a regression test for libvirt authentication (RHBZ#1044014).
    
    This tests the virConnectAuthPtrDefault wrapper path.

commit 873db60c0e52893a38c374d867d0a305e5419d6a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 8 19:36:00 2014 +0000

    tests: Add a regression test of libvirt authentication events.
    
    This requires a change to libvirt (in libvirt >= 1.2.1), see:
    
    https://www.redhat.com/archives/libvir-list/2014-January/msg00378.html

commit 4125064554c8cb1b96680e24e49d74ee6024f761
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 2 12:20:18 2014 +0000

    libvirt-auth: Provide a friendlier wrapper around virConnectAuthPtrDefault (RHBZ#1044014).

commit 06f7bea14883c4903c58077757179341c0e1471a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 7 17:32:04 2014 +0000

    builder: Fix handling of --size parameter.
    
    It now matches the documentation:
    
      "Select the size of the output disk, [...]
    
      Virt-builder will resize filesystems inside the disk image
      automatically.
    
      If the size is not specified, then one of two things happens.  If
      the output is a file, then the size is the same as the template.  If
      the output is a device, partition, etc then the size of that device
      is used."
    
    This also adds checks to make sure that users don't try to shrink a
    disk (which is not possible), and they don't try to resize larger than
    the output block device.

commit a403febb8c43bf573c2354c39df22a29cf8863d8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 7 17:30:57 2014 +0000

    mllib: Add library function to run external command and slurp up the output.
    
    This also changes a couple of functions to use this new library
    function.

commit 3e802605b52dccd2574353d5aff220de8d8eb3b8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 7 17:30:20 2014 +0000

    builder: Pass ~prog global (program name) around.

commit ac41f616db35921074a4909524b9bc1a2bd2406d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 7 14:52:08 2014 +0000

    builder: Note in man page how to specify size in bytes.

commit 40b88fdbc76515fd21b33f54587c7f4f7b6e9715
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 4 12:37:40 2014 +0000

    builder: Add CirrOS 0.3.1 disk image.

commit 169a4a34e557271a848447611658901f1dc57a39
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 2 17:06:10 2014 +0000

    Version 1.25.19.

commit 6c971faecffd54f324a63b3c815925471b42d6bb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 2 16:53:34 2014 +0000

    Update copyright dates for 2014.

commit 883208284b6a49ccf86a2179e3a63220d2a73ad0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 1 16:32:56 2014 +0000

    Allow ./configure --without-qemu.
    
    This means there will be no default hypervisor, and effectively the
    user will always have to specify one (eg. by setting LIBGUESTFS_HV or
    calling guestfs_set_hv).
    
    This is useful on platforms where qemu doesn't work, or where qemu is
    not needed (eg. if you want to use UML, or you just want to compile
    libguestfs without using/testing it).

commit ee4ce2a0298d012bd8c500c35dc50e1f53e88c8b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 27 09:45:49 2013 +0000

    ruby: Fix .new method (RHBZ#1046509).
    
    The .new method was unintentionally broken in
    commit 9466060201600db47016133d80af22eb38091a49.
    
    This fixes the .new method and allows it to be called with multiple
    parameters, so you can use:
    
      Guestfs::Guestfs.new
      Guestfs::Guestfs.new()
      Guestfs::Guestfs.new(:close_on_exit => false)
      etc.
    
    For backwards compatibility, Guestfs::create may still be used.
    
    This commit also adds regression tests:
    
     - Use .new method in regular tests.  (Because this was not done
       before, we didn't catch the breakage.)
    
     - Test that ::create still works.
    
     - Test that args can be passed to .new method.

commit 480bd3a6d8a56b37936b08c94eb99f0921fe65de
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 27 13:21:38 2013 +0000

    RHEL 6: ruby: Fix fallback to rake/rdoctask for old rake.

commit c16f2ea53d502c1874f10fca0767ba5d05208985
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 27 12:56:51 2013 +0000

    RHEL 6: builder: Use iteri instead of List.iteri.
    
    RHEL 6 OCaml did not have List.iteri, so use the version from
    Common_utils instead.

commit ac1d5ba77bd98c3e1fb061458254340bbdb823f2
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Dec 23 16:35:53 2013 +0100

    tests/mountable: skip if btrfs is not available
    
    This test uses btrfs, so skip it if either the "btrfs" feature or the
    btrfs filesystem is not available.

commit d20289186d257105f304a4fa0c3e6d26a5fb0807
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Dec 20 15:00:09 2013 +0100

    inspect: fix detection of newer CirrOS versions (RHBZ#1045450).
    
    Add an own case for CirrOS, based on the /etc/cirros/version file
    provided in newer version instead of the Buildroot-generated
    /etc/br-version.

commit 1580d965cd2b994205aeef44f8c873aea2c91d5f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 15 10:13:10 2013 +0000

    builder: Add support for RHEL 7.0 beta 1 (public beta) to the script.

commit a13696e99cfba8735fcfed3e3a63008764943365
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Dec 20 11:38:52 2013 +0100

    Re-add regression tests for rh#563450
    
    Added in 2392fae6803b9de4a4761509007c160339d57f50 and removed in
    be025369ad622867ecf08d5c9170e8e59d2d6294; now they should work with any
    backend, as the device names are normalised and not change the guestfish
    output depending on the used backend.
    
    Thanks Richard for the hints.

commit 8acb91a58487eba2f3598457a97afe3e559c52af
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 19 18:38:57 2013 +0000

    launch: libvirt: Clearer message when libvirt screws up.
    
    Instead of:
    
    libguestfs: error: could not create appliance through libvirt.
    Try using the direct backend to run qemu directly without libvirt,
    by setting the LIBGUESTFS_BACKEND=direct environment variable.: internal error: process exited while connecting to monitor: qemu-system-x86_64: -drive file=/tmp/libguestfs3RnJSd/snapshot2,if=none,id=drive-scsi0-0-0-0,format=qcow2,cache=writeback: could not open disk image /tmp/libguestfs3RnJSd/snapshot2: Could not open backing file: Could not open '/home/lsm5/fimagebuilder/fedora-imagebuilder/fedora-imagebuilder-sda.qcow2': Permission denied
    
    it will now say:
    
    libguestfs: error: could not create appliance through libvirt.
    
    Try running qemu directly without libvirt using this environment variable:
    export LIBGUESTFS_BACKEND=direct
    
    Original error from libvirt: internal error: process exited while connecting to monitor: qemu-system-x86_64: -drive file=/tmp/libguestfs3RnJSd/snapshot2,if=none,id=drive-scsi0-0-0-0,format=qcow2,cache=writeback: could not open disk image /tmp/libguestfs3RnJSd/snapshot2: Could not open backing file: Could not open '/home/lsm5/fimagebuilder/fedora-imagebuilder/fedora-imagebuilder-sda.qcow2': Permission denied

commit d16db5a6180305543658f3a50657c70bbdf81b40
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 19 14:22:26 2013 +0000

    launch: libvirt: Don't default to using NULL for libvirt connection URI (RHBZ#1045033).
    
    NULL means that libvirt gets to guess what connection URI we meant.
    Currently it guesses qemu:///session for non-root and qemu:///system
    for root.  Except if LIBVIRT_DEFAULT_URI is set in which case this is
    used even if it's not appropriate.  Except if Xen is installed in
    which case it guesses xen:/// which is not helpful at all.
    
    Instead use qemu:///session (or qemu:///system for root -- that's
    likely to be wrong, but we can't help that).
    
    If the user really wants to use NULL and let libvirt guess, then they
    can now specify the libvirt:null backend.
    
    See:
    
    https://bugzilla.redhat.com/show_bug.cgi?id=1045033
    https://bugzilla.redhat.com/show_bug.cgi?id=886915
    
    A good way to test this is:
    
    LIBVIRT_DEFAULT_URI=iambroken libguestfs-test-tool
    
    The libguestfs libvirt backend should (after this commit) ignore
    LIBVIRT_DEFAULT_URI.  However other parts of libguestfs will still use
    it, eg. guestfs_add_drive_opts, guestfish '-d' option.

commit b46a5511b3a98c0d811353b1bc0c7745fa972dc6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 19 11:17:43 2013 +0000

    builder: Add --update option to update template/core packages.

commit 681488877456b83f039dc518861f29ab4e1857f0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 19 08:21:53 2013 +0000

    run: Use timeout --foreground option.
    
    If timeout doesn't have this option (RHEL 6) don't use timeout at all.
    
    Attempt to fix RHBZ#1025269.

commit 05b3aefb8bfd74d769719a62208b391018626f59
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 18 20:42:41 2013 +0000

    Version 1.25.18.

commit be025369ad622867ecf08d5c9170e8e59d2d6294
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 18 20:40:54 2013 +0000

    tests/regressions: Remove regression tests rhbz563450*.
    
    These two tests failed 'make check-release' (particularly the
    UML tests).
    
    This partially reverts commit 2392fae6803b9de4a4761509007c160339d57f50.

commit 80d267778499fc80c82552d6685703278d705f92
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 18 18:38:40 2013 +0000

    Version 1.25.17.

commit 70db54974b87c6b4384dbf8b839e0335e70189ae
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 18 18:37:50 2013 +0000

    fish: Fix memory leak in inspect/-i code (detected by valgrind).
    
    This only manifested in the new virt-diff tool.

commit d08efbec839515c7e1a46d2e06d3fafac74221b0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 18 17:38:26 2013 +0000

    Version 1.25.16.

commit 34cbde5b884b9debb2d314763c2f5f914bea012c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 18 17:37:56 2013 +0000

    builder: Change how EXTRA_DIST is generated.
    
    So that we don't need to change this every time we upload
    a new operating system signature.

commit 308292e4fb4f57ec814c998761e2c1361660500b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 18 16:16:15 2013 +0000

    Update to latest gnulib.

commit 1fcea09ee2e89d2e727e39df80dc595f5d0ba363
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 18 16:03:43 2013 +0000

    appliance: Create an /etc/resolv.conf file referring to qemu user network nameserver (RHBZ#1044585).

commit 1ee879f3e5baa398edc76dc02492662412faf2d7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 16 14:45:29 2013 +0000

    New tool: virt-diff.
    
    This tool can be used to show the differences between two
    disk images.

commit c7a2dce6075ce47e6776d4c9560f18821b80106d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 17 19:32:42 2013 +0000

    daemon: Sort extended attributes when returning them.
    
    A single file can have multiple xattrs.  Previously these were
    returned in the same order as the kernel returns them.  However it is
    more useful if they are sorted by attribute name.

commit 937ea7f16fbaf07c1ca374cc5be93b447bdc1fa2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 17 20:56:11 2013 +0000

    virt-ls: visit: Fix a bug with handling of extended attributes.
    
    The wrong pointer was passed to the visitor_function, resulting in it
    seeing the placeholder xattr entry (the one which stores the length of
    the list of xattrs - see
    http://libguestfs.org/guestfs.3.html#guestfs_lxattrlist ).
    
    virt-ls doesn't list xattrs at the moment, hence this bug was not seen
    before.

commit 276ef546c4674698d57a0e28f5f51c27a9d2d269
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 17 16:06:19 2013 +0000

    virt-ls: visit: Add an opaque pointer to the visitor function.
    
    Useful for passing around data, but not used by virt-ls.  It
    will be used by virt-diff.

commit a93d418c3e12490adcfe2cf15ba919ef447c6965
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 17 09:11:19 2013 +0000

    virt-ls: Move visit and other functions to common code library.
    
    This will allow us to reuse these functions in virt-diff.

commit 2b674ccdd368b89c15221c33ee5b13dda1d61209
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 17 10:26:30 2013 +0000

    fish: options: Add alternate add_drives_handle and inspect_mount_handle.
    
    These functions don't use the implicit 'g' global variable, but
    take a handle argument instead.

commit c513d3a6e57a4c7e0c0307d38360a7116fc34528
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 17 09:57:23 2013 +0000

    fish: Add option parsing for -A and -D options.
    
    Same as -a and -d except these add the drives to a second list
    of drives (drvs2).

commit 28adf7cea6d4416e25ac65f930b4568c0460eb7f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 16 15:09:58 2013 +0000

    fish: Move -d option parsing to common function.
    
    This is essentially just code motion, except:
    
    (1) It cleans up a few variable declarations which were implicitly
    used by the old macro that aren't needed any more.
    
    (2) The options are reordered alphabetically.

commit d9826467c2bf90b7db7adfd8b0ae8cbbfbb5f04f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 16 15:06:32 2013 +0000

    fish: Deprecate the -D option (prefer --no-dest-paths instead).
    
    This option will now print a warning:
    guestfish: warning: -D option is deprecated, use --no-dest-paths instead

commit 78b9229bc823d08d5a83adcba02da4030335f674
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 17 21:56:00 2013 +0000

    lib: Export guestfs_compare_* functions for comparing structs and lists of structs.

commit 3d398687be20bd1dd9aec7da41cb3bd1319371de
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 17 15:20:50 2013 +0000

    lib: Export guestfs_copy_* functions for copying structs and lists of structs.
    
    These complement the guestfs_free_* functions.

commit 0f3489ba6b80cfdd90230d66f58a49c9738b8fad
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 17 21:28:49 2013 +0000

    lib: Rename cleanup-structs.c -> structs-cleanup.c and free-structs.c -> structs-free.c.
    
    Just renaming generated files, no other effects.

commit 193b81a633501ccf6155935a50523cd802858410
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 17 22:09:21 2013 +0000

    daemon: Improve error message for readlink call.

commit 882b91cb480811333627583dff3eca596281a3a9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 17 13:57:10 2013 +0000

    generator: Fix bug in documentation of guestfs_free_* functions.
    
    These appeared in the documentation as:
    
     void guestfs_free_int_bool (struct guestfs_free_int_bool *);
                                                ^^^^
    
    which is obviously wrong.

commit d39b4dc606bb725b0790c24934dc936daf2c18d4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 17 10:20:53 2013 +0000

    fish: Ensure print_inspect_prompt can only be called by guestfish.
    
    Code clean-up.

commit a4f4f9c075fd5788e9176436a4a356c957a6d6b5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 17 10:19:26 2013 +0000

    inspector: Ensure low-level inspection functions can only be called by virt-inspector.
    
    Code clean-up.

commit d6e4709f5bcc7dd465151fa357530445cf23acdd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 17 10:11:53 2013 +0000

    fish: options: Fix incorrect comment.

commit 076d73696e2f2fdd275863fe1b88ca9d2088b675
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 16 14:37:12 2013 +0000

    virt-cat, virt-filesystems, virt-ls don't use libconfig.
    
    So it doesn't need to be linked in.

commit 685a28eb2cbcbe30420413c30780d2d729580931
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 18 13:19:44 2013 +0000

    tests: guests: Add /etc/motd test file to Fedora test image.

commit c4646290d61934cbec30f6e5c0d6226e7bfeb5c9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 18 15:05:36 2013 +0000

    builder: no_proxy environment variable should be passed to the appliance.

commit 6f3ca3699d067f0d00c71a2bcf3c2fc981eccc40
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 17 15:48:47 2013 +0000

    builder: Add Fedora 20 image.

commit c4fdb4023eed45dbf905526da4a91b846792079d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 16 14:14:01 2013 +0000

    builder: Remove blank line.

commit 2392fae6803b9de4a4761509007c160339d57f50
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Dec 16 14:54:27 2013 +0100

    drives: add CD-ROM disk images as read-only drives (RHBZ#563450).
    
    The current add_cdrom way basically appends a new raw "-cdrom /path"
    parameter to the qemu invocation (even when using libvirt as backend),
    hence such images are seen as "CD-ROM drives" inside the appliance.
    However, there is no need for such particular behaviour, as they need to
    be handled as normal (read-only) drives.
    
    Adding CD-ROM disk images as drives also changes the device names used
    for them inside the appliance from /dev/srN to the usual e.g. /dev/sdX.
    
    These changes fix different issues:
    - it is possible to start guestfish without adding disks with -a, then
      just add-cdrom and run
    - list-devices does not cause guestfsd to crash when sorting the list
      of devices (exposed by the test case in RHBZ#563450)
    - the result of list-devices now reflects the order images were added
      (RHBZ#563450)
    
    add_cdrom is still deprecated, but now in favour of add_drive_ro
    (instead of add_drive), with its documentation reflecting that.
    
    Add two small regression tests for the fixes described above.

commit 3cf5a25e3f63ea6832b96468a94cdb13dbd26e92
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 14 18:54:56 2013 +0000

    builder: Refuse to write to a char device or /dev/null.
    
    virt-builder --output /dev/null is tempting, but not possible, and
    might result in /dev/null being deleted(!)  Check for this case and
    prevent it happening.

commit 0037820ee003bfbc71bf35b18fb3a066cbf298f8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 14 18:53:20 2013 +0000

    builder: Only use virt-resize --no-sparse when writing to a block device.
    
    Previously we would use the virt-resize --no-sparse option if the
    final output file was a block device.  This is safe, but unnecessary
    for example if virt-resize was used as an intermediate step.  So only
    use this option if virt-resize is actually writing to the block
    device.

commit 0cdc8645880b3103ad4aa5d192db609270e51a8e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 14 17:32:40 2013 +0000

    Version 1.25.15.

commit d5d1dac3ac1e3027dc507b1343022f6bcea20822
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 14 16:43:40 2013 +0000

    builder: Add a link to blog posting about the planner.
    
    http://rwmj.wordpress.com/2013/12/14/writing-a-planner-to-solve-a-tricky-programming-optimization-problem/
    should help people to understand how this code works.

commit 6901cd2250fc25c1761f191fb02db74fecf4703d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 14 16:18:50 2013 +0000

    builder: tests: Add test-virt-builder-planner.sh to EXTRA_DIST.
    
    This fixes commit a27963b67ba1140c29c145a1ce14dbfc05f8d7da.

commit 3f433d90f208da8e2b7ea397485dfd8d415726a0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 14 16:18:23 2013 +0000

    builder: tests: Fix virt-builder --list output.
    
    This fixes commit a27963b67ba1140c29c145a1ce14dbfc05f8d7da.

commit a27963b67ba1140c29c145a1ce14dbfc05f8d7da
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 14 15:50:37 2013 +0000

    builder: Add a test of the planner.
    
    This tries out many combinations of size/format and ensures
    that the planner can deal with them.

commit 7af9cabadeb1da329de4411d7eaea2e347496446
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 14 15:50:04 2013 +0000

    builder: Flush debug info after printing it.

commit 0af1e55e68c7cdaecc0af22e8bc41b8cff197e44
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 14 15:49:25 2013 +0000

    builder: planner: Handle no format= in source case correctly.

commit 62cc7d3361127b4e007f8e23028213852be09124
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 13 13:18:47 2013 +0000

    builder: Use a planner to work out how to convert the template to the final image.
    
    The original template might be, say, xz-compressed raw of a certain
    size.  We need to work out how to convert it to, say, qcow2 with a
    larger size, in as few operations as possible.
    
    Instead of using a nasty aggregation of special cases to do this, use
    a breadth-first search over all possible trees to try to find an
    optimal plan.
    
    (Actually the current implementation isn't optimal, but it's fine for
    virt-builder.)

commit 81b4e5d5cd68f65aa950251e22332b3fa477fecb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 14 13:18:48 2013 +0000

    builder: Move is_block_device function into common utilities.
    
    This is just code motion.

commit d98fbf2071f363d8738992d2999c2f24737e875b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 14 13:15:32 2013 +0000

    resize: Move roundup64 function into common utilities.
    
    This is just code motion.

commit d57d8f22dec36f6cc80c2cd4ac4e936f0c0d0e49
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Thu Dec 12 23:59:53 2013 +0100

    golang: Don't run launch test if appliance has not been built.

commit 30936f499e08919a351d3d46c7e26a30dea697ea
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Fri Dec 13 11:04:30 2013 +0100

    sysprep: remove some Pegasus files, like certs (RHBZ#1041552).

commit 3ae829d752fedec43dffedeec958c8084a68a919
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 13 08:46:04 2013 +0000

    golang: Add note about difficulty of parsing go version numbers.

commit 29cfb10bd43f2e3d0543e08f1da20c4dfb83003e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 12 16:18:37 2013 +0000

    Version 1.25.14.

commit 1877c106030361821cf36c8873455d0c3d7134d3
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Dec 12 16:23:50 2013 +0100

    fuse: provide a stub "flush" implementation (RHBZ#660687).
    
    It seems that FUSE can invoke flush to make sure the pending changes
    (e.g. to the attributes) of a file are set. Since a missing flush
    implementation is handled as if it were returning ENOSYS, this can cause
    issues later.
    
    To overcome this, just provide a stub implementation which does nothing,
    since we have nothing to do and don't want to have FUSE error out.
    
    Furthermore, uncomment the timestamp checks in test-fuse.sh, since now
    they should be working fine.

commit 7775c121f782342e0d70351855bd6da3ebfb189e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 11 19:22:12 2013 +0000

    recipes: Use new style -a/-d options in virt-edit example.

commit 0c0caaddb00a5b25ab920e9f83bafbeca3ee9b7e
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Mon Dec 9 20:51:37 2013 +0100

    po: Create empty files to be edited by xgettext
    
    This avoids:
    
        xgettext: error while opening "libguestfs.pot-t" for reading: No such file or directory
    
    which I observed with xgettext (GNU gettext-tools) 0.18.3

commit dabc7a4a5623b28f7fd2b333564eee6c0214695b
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Mon Dec 9 20:50:21 2013 +0100

    Fix builder/website test in out-of-tree builds

commit cbc0e79d38c125c7f436055c88fa1dbd5425827c
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Mon Dec 9 20:49:41 2013 +0100

    Fix manpage generation in out-of-tree builds

commit b1210152217b35f52f204a1d92ee988ca713949c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 10 13:45:07 2013 +0000

    daemon: mkfs: Use -I option to force mkfs.fat to write a filesystem over a whole device (RHBZ#1039995).
    
    If you use virt-make-fs to create a partitionless FAT-formatted disk
    image then currently you will get an error:
    
    $ virt-make-fs --type=fat . /tmp/test.img
    'mkfs' (create filesystem) operation failed.
    Instead of 'fat', try 'vfat' (long filenames) or 'msdos' (short filenames).
    mkfs: fat: /dev/sda: mkfs.fat: Device partition expected, not making filesystem on entire device '/dev/sda' (use -I to override) at /usr/bin/virt-make-fs line 508, <PIPE> line 1.
          ...propagated at /usr/bin/virt-make-fs line 518, <PIPE> line 1.
    
    With this patch, the error goes away and partitionless disks can be
    created.

commit 1f0e75213bcb041083a87b46b3ec7bf1be054142
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 10 08:50:55 2013 +0000

    proto: Remove another error message which hides earlier error.
    
    When receive_file_data calls guestfs___recv_from_daemon, and that
    function returns -1, it adds the following error to the handle:
    
      receive_file_data: parse error in reply callback
    
    However this hides a more specific error message which was already
    added by guestfs___recv_from_daemon.

commit 78df80d64970ba6b62bb59888069dd9f0343a804
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 10 08:48:04 2013 +0000

    proto: Remove error message which hides earlier error.
    
    When chunked encoding fails, the following error is added to
    the handle:
    
      [filename]: error in chunked encoding
    
    However all paths returning -1 from receive_file_data already set a
    more specific error, which this error hides.

commit 41729c6556bbab7d5532a9a699848aa254b77d27
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Tue Dec 10 10:32:12 2013 +0100

    lib: fix newline in error output (RHBZ#923355).

commit 1472fbd903befb179112a1de673c376ec5bf9b2f
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Dec 9 19:37:51 2013 +0100

    sysprep: mention globbing in help for --delete
    
    Followup of ed4bcb119cb908e98ecc1107dcd8b740ee2f484f.

commit ed4bcb119cb908e98ecc1107dcd8b740ee2f484f
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Dec 9 16:19:12 2013 +0100

    sysprep: allow to specify globbing for --delete
    
    Adapt the globbing part from the old --remote-path work previously
    proposed for sysprep [1], allowing --delete to perform globbing when
    deleting paths.
    
    [1] https://www.redhat.com/archives/libguestfs/2013-October/msg00045.html

commit 7a41f5c1263d97d7656d41c56fd2237ba72975c7
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Dec 9 16:19:11 2013 +0100

    launch: switch from -nographic to -display none
    
    The latter is a better way to disable the qemu display output as we
    need to, without enabling extra devices (which are disabled already,
    anyway).
    
    Also, related to the change above, ban the -display parameter from the
    ones that can be supplied by the user.

commit c89ffbc15291e9418e36540e5e78311b6f39011b
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Mon Dec 9 16:19:10 2013 +0100

    sysprep: remove more anaconda and tuned logs (RHBZ#1039540).

commit a0c642c15610245d2c6b5f2bcd42a06b2d43f921
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 8 12:43:02 2013 +0000

    Version 1.25.13.

commit 3f44e09cb55d14e956a919d70325cde747c5404b
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Sat Dec 7 19:13:34 2013 +0100

    Fix virt-builder tests for out-of-tree build

commit 38410afc5a99c222f3880342a441fbc8d28fbb3b
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Sat Dec 7 19:12:51 2013 +0100

    Fix installing man-pages from out-of-tree build

commit f631770974770ba4a31f90d8a8315113c895dc0c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 7 10:30:14 2013 +0000

    Add CentOS 6.5 image.

commit 5c76af3a954b54246ebc3ecbad748e75d2057424
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 6 18:58:17 2013 +0000

    recipes: Add a recipe for masking a systemd service.

commit 023128a0eb29163288eb923b2f9dc81aa919f1d9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 6 15:02:36 2013 +0000

    Revert half of "builder: translate more user-visible strings"
    
    Don't change "os-version" to "OS version".  It's intended to be the
    same as the virt-builder man page, which consistently calls this the
    "os-version" string.
    
    This partially reverts commit ee0e56f43e55307fefa1d04505ed6477d604d220.

commit 915908fcdd6ebc2f20f760e21a7ca6c9a3848cc9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 5 22:37:48 2013 +0000

    launch: direct: Pass -enable-fips option if qemu supports it.

commit 178bc878e1d5b3b1d8636348245c06881c537a38
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Dec 5 16:30:05 2013 +0100

    po: fix dependencies for libguestfs.pot extraction
    
    Fix the dependencies of the libguestfs.pot target: other than using the
    right make variables holding the contents of the POTFILES, depend also
    on the POTFILES themselves.

commit c60dc40fe44f7db401d22a85bf382a02ca73b24f
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Dec 5 16:30:06 2013 +0100

    fish: improve the command error messages
    
    - when a command needs no parameters, tell that explicitly instead of
      "command should have 0 parameters"
    - use gettext's plural form when printing the number of required
      arguments
    - improve the error message for a variable number of parameters limited
      only in the maximum number of them, using also a plural form

commit 1a9a8ab48fb4e1427eb5ded27540fb76f8c5795b
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Dec 5 16:30:04 2013 +0100

    po: fix broken message extraction
    
    Extracting separately the pot for the various languages and then
    creating manually the global pot (by manually joining the above ones
    after having stripped their headers) is wrong, since other than being
    an hack it can create an invalid pot when the same message appears in
    sources written in different languages.
    
    Instead, a cleaner and safer solution is to first let ocaml-gettext
    (if available) extract the messages for the ml files, and then use
    xgettext to extract the messages for the other languages, joining the
    new messages to the existing (or not) pot file.

commit ee0e56f43e55307fefa1d04505ed6477d604d220
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Wed Dec 4 15:34:46 2013 +0100

    builder: translate more user-visible strings
    
    Translate also the "OS version" and "Notes" strings that appear in the
    --long output.

commit 6739073757158bc22826d60ebc6ce9460d562a13
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 2 13:40:56 2013 +0000

    Version 1.25.12.

commit 7af3602f5fe63956a1a4bfa18c3ff48124d95352
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Nov 28 15:49:14 2013 +0100

    inspect: improve detection of FreeBSD install discs (RHBZ#1033207).
    
    Check for /boot/loader.rc as "install disc" detection, using it to mark
    FreeBSD install discs.
    Also, check for /mfsroot.gz to see whether such disc is also a live one.
    
    See also RHBZ#1033207.

commit e754add14c8bffb76060e0f4d8ce1c98731de098
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Nov 28 14:48:37 2013 +0100

    inspect: ignore special CD devices on FreeBSD install discs
    
    /etc/fstab in installation discs of FreeBSD can have an entry pointing
    to the mounted CD itself; skip it as it is done with other CD devices in
    check_fstab.

commit 75bf5cfebf8833bc951254550c5855c4b0013542
Author: Pino Toscano <ptoscano@redhat.com>
Date:   Thu Nov 28 14:48:36 2013 +0100

    inspect: recognise Debian live images as such
    
    Check for filesystem.squashfs also in /live, since it is where
    live-build places it.

commit 04769ad507e1c84c8a04bf5fe9029ae20cc67600
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 26 18:32:01 2013 +0000

    launch: direct: Whitespace fix.

commit e7fa7f4d1691bc5e34b163509645c535ac6d8767
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 25 23:25:12 2013 +0000

    launch: Print program and version as part of standard debug output when launching the handle.
    
    There are a lot of cases where people post debugging output, but we're
    not sure precisely which version they are using.

commit 97ea81eb21e1be849b0e6b8fcdd2a9cda4edcb51
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 25 22:49:53 2013 +0000

    tests: Test that network drives are mapped to correct qemu -drive parameters.
    
    Although this test only specifically tests the direct backend, the
    same code is shared with the libvirt backend in some circumstances
    (eg. creating readonly drives).  So this is testing a bit of both.

commit 45afcdb30788d6cb9bdba14fe554b3b12a0d8479
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 25 20:07:27 2013 +0000

    ocaml: Remove unused function prototype.

commit 1ea1646e6f224dbc5b3922bb3c65aab4d71a9cb9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 25 17:02:29 2013 +0000

    po-docs: If *.pod files are missing, tell user to run 'make update-po'.
    
    I'm now fairly convinced it's not possible to do this automatically.
    However we should at least tell the user what needs to be done.

commit d81c577eff2519cd4ef7fb45ad33e711f5baacc8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 23 09:46:44 2013 +0000

    Version 1.25.11.

commit 53e45c82804dd52eca16867a287d025c3a63ed9d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 23 09:37:17 2013 +0000

    sysprep: Fix broken test when backend is UML.
    
    This fixes commit cc1888a4977eb4942254ea5ac15c1d0a47458317.

commit 78d452e9a65b407af3259d5dfaf7236b7ea8aebf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 22 17:16:11 2013 +0000

    Version 1.25.10.

commit 5ee193433a46d205e181bc51080e15f696bbda1a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 22 17:15:20 2013 +0000

    lua: Don't redefine lua_objlen if already defined.
    
    lua 5.2.2 seems to define this symbol already.

commit c90b0eff981858ab187516455f59744f1ce2d064
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 22 16:39:46 2013 +0000

    Version 1.25.9.

commit cc1888a4977eb4942254ea5ac15c1d0a47458317
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 22 14:40:18 2013 +0000

    sysprep: Add a test suite for the --password option.

commit 3712249f9659121277a0d2ca0549e02bc38e0cad
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 21 17:13:22 2013 +0000

    builder/sysprep: Allow accounts to be locked (RHBZ#1028660).
    
    This allows you to select both locked accounts and disabled
    passwords.  The two are subtly different concepts.
    
    A locked account [cf. passwd -l] puts "!!" at the beginning of the
    shadow password field.  Locking is reversible, because the "!!"  can
    be removed, restoring the original password.  Therefore "locked"
    acts as a flag in front of an existing selector.
    
    A disabled account has "*" in the password field.  Therefore it has no
    password.
    
    Note that an account may be both locked and disabled, although this is
    probably not useful.  The shadow password field will contain "!!*".

commit 02b5f00b2bf563d87134ad5f90ec06dbb9535bea
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 21 17:34:44 2013 +0000

    builder/sysprep: Allow 'random' as a password selector.
    
    This chooses a random password.

commit 91450b5f9a2bf0603971d7cdf3271f390ed0c2c4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 21 17:24:58 2013 +0000

    mllib: password: Replace password string with password_selector type.
    
    This is just code motion, there is no functional change.

commit 9186438937f5451ddfdaa33c9dcb9ffe27b2a098
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 21 13:57:07 2013 +0000

    builder/sysprep: Describe --password/--root-password option as "selector".
    
    It now appears in the respective man pages as:
    
      --root-password selector
    
    or:
    
      --password selector
    
    This avoids confusion from people who think these command line options
    take the password directly.

commit c7b0457c32b25fb289e9e1de3f960b12cebe4adf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 21 14:30:11 2013 +0000

    ls: Note that you can use virt-cat or guestfish to show file differences.

commit 90245512453bb404f50e54cddf052bce63385073
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 21 14:29:29 2013 +0000

    ls: In image diff example, don't use --time-t.
    
    It shows differences in file access times (atime) which is not
    actually that useful for most people.

commit 2d9f69db614c8fecdd11c879d00fca366850e720
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 19 17:49:45 2013 +0000

    FAQ: "execl: /init: Permission denied" error also caused by /init not being executable.
    
    This updates commit 98cd329323d35ab54efd976e095ae9cbf18ad338.

commit 98cd329323d35ab54efd976e095ae9cbf18ad338
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 19 16:59:34 2013 +0000

    FAQ: Attempt to explain "execl: /init: Permission denied" error.

commit acce28e8874e08acce0a6cd7a6703043a1e4ec25
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 19 09:09:02 2013 +0000

    lib: Make sure -lselinux is used when linking libguestfs.so.
    
    If libselinux was detected, it was not added to the linker command
    line.  This still worked (at least on Fedora) because some other
    library pulls in the dependency implicitly, possibly libvirt.  However
    this broke on Arch:
    
    https://aur.archlinux.org/packages/libguestfs/
    
    Reported by and thanks: Antoni Segura Puimedon.

commit 59596810b009744316941da8ef18b7e75b503b9f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 15 09:05:43 2013 +0000

    daemon: btrfs: Upstream 'btrfs device add' command now needs '--force' option to work.
    
    However earlier versions didn't have the --force option, so we
    have to detect it.

commit 64f93b36de5ae334c4e3eb82c0501285eec35d5a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 14 17:01:12 2013 +0000

    Version 1.25.8.

commit 793a5677cbd6f80ae0f4fbc3cdf478e7f84edadb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 14 15:50:03 2013 +0000

    virt-win-reg: Allow URIs (RHBZ#912193).

commit c032130226bdca539b8ac34ce622e5cd9a71c152
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 14 15:45:23 2013 +0000

    perl: Give error instead of crashing if optarg is not an array reference.
    
      $g->add_drive ("", server => 1);
    
    would segfault.  Now it gives a nice error instead:
    
      array reference expected for 'server' argument at [line]

commit 6a1061663fa467d43777a8ed98f4f07750125012
Author: Török Edwin <edwin@etorok.net>
Date:   Thu Nov 14 11:13:50 2013 +0200

    Avoid modulo bias in random password generation
    
    Char.code (input_char chan) mod nr_chars has modulo bias because
    the original interval is not a multiple of the destination interval,
    i.e. 256 mod nr_chars != 0.
    
    One way to fix this is to keep generating random numbers until they fall outside
    the interval where modulo bias occurs, that is accept only c=[256 % nr_chars, 256).
    That interval maps back to [0, nr_chars), and has a length of
    (256 - 256 % nr_chars), which is a multiple of nr_chars.
    
    RWMJ:
     - Modify the code so it goes into a utility library.
     - Use the same code across virt-builder and virt-sysprep.

commit f013b15fa1daf623cbf39007182c44c734e9bc79
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 14 10:09:52 2013 +0000

    mllib: Add a utility function for safely reading from /dev/urandom.
    
    OCaml's buffered 'in_channel' has a 64k buffer, so using it to read a
    few bytes from /dev/urandom removes a lot of the system's entropy (for
    example /proc/sys/kernel/random/entropy_avail goes from ~3000 to 128).
    
    This patch was originally by Edwin Török for builder.ml.  I
    generalized it because there are two other places where we did
    over-sized reads from /dev/urandom.

commit 544d6b25e345e2317b1f2e92684af6c08e1c58ba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 12 19:57:29 2013 +0000

    builder: Clarify architecture section of the documentation.
    
    I have checked and cross architecture builds work fine:
    
    http://rwmj.wordpress.com/2013/11/09/virt-builder-running-on-arm/#content

commit fb41ce252f551e818d86d6f8c70b9caa10a05bcb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 12 08:49:45 2013 +0000

    Change supermin man pages section 8 to section 1.
    
    Corresponding change in upstream supermin:
    https://github.com/libguestfs/supermin/commit/cb3f9e8bbaf5e612fdf97caf9f47a4cd839c3438

commit edacd479faf7175eb2ddb10dd8c7ab4c90db5d0b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 11 18:34:49 2013 +0000

    podwrapper: virt-install is not a libguestfs page.
    
    This now redirect to http://man.he.net/man1/virt-install, but this is
    unfortunately a 404.
    
    Incomplete fix for RHBZ#1029134.
    
    Thanks: Paul Maunders.

commit 4b2e9c9264dcebd3c5945050b7f1d1b4cb4d3dae
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 11 12:29:35 2013 +0000

    builder: debian: Remove bogus proxy from apt configuration.
    
    Thanks: Daniel Miranda

commit 50aca447eabaa8c47f7b6adf57db48a225bf589e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 11 13:15:19 2013 +0000

    builder: After building a template, print fields for index file.

commit 299e3153eefc4eabfcaada55efd34380bf48d42b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 8 16:14:41 2013 +0000

    Version 1.25.7.

commit 300b357eb98445926a096927655763a8d2150271
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 8 16:13:35 2013 +0000

    builder/website: Add some missing files to EXTRA_DIST.

commit 63ec023f19f2b397dfa629a8674bb9fbed752c71
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 7 15:30:13 2013 +0000

    builder: Allow /tmp or /Temp to be symlinks to a directory.

commit 7a8addb48553c90cf34cea5804d9d139e1c81b85
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 7 15:29:51 2013 +0000

    builder: Allow upload to directory when target is a symlink to a directory.

commit e982c0a2f56a5324d41b90b7a8f2715412f7e899
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 7 14:05:45 2013 +0000

    Update TODO: Remove some things that we've done.

commit 55795e652ebeb8f1860e8204d738b4af94a9975f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 6 19:16:00 2013 +0000

    builder/website: Add support for RHEL 5 releases to internal RHEL script.

commit 133ae6a34b5bdf8c831b0ee967eb1f7798062943
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 6 19:15:42 2013 +0000

    builder/website: Don't use http_proxy in internal RHEL script.

commit e906d30c62fcca597fa4ddb4d620ea1f9b83b8b2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 6 21:39:52 2013 +0000

    builder: After compressing the template, calculate the SHA-512 hash.

commit f459fe47f899e2e93a455a1338860a2b11165c9e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 6 21:39:34 2013 +0000

    builder: Add a Scientific Linux 6 image.

commit 7147d415645d2c66b459c4bf366b6288ddbf2584
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 6 19:19:20 2013 +0000

    builder: Old OCaml didn't have List.iteri, so add a utility function.

commit e9294668b4cd5cfa10ab4d936bccb271107f138b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 6 16:54:08 2013 +0000

    builder: Add script for making Red Hat Enterprise Linux instances.
    
    This uses some internal Red Hat repositories so it's not generally
    useful, but could be easily adapted by users.

commit b3a106cefc5dcb356ffb66ef53eba19452ebb60e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 6 15:08:08 2013 +0000

    builder: Fail if lex is not installed.
    
    This completes the fix for commit a4800e2d4fc50f372a8b626333c4fbb9b8ca9633.

commit 4dd6e4328ca57020e8e415e99925eab73b2fe95e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 6 13:42:58 2013 +0000

    builder: Use common code to sysprep, sparsify and compress images.

commit c76912cd778281f70490b05a276c140eacf8c647
Author: Adam Huffman <adam.huffman@gmail.com>
Date:   Wed Nov 6 13:32:32 2013 +0000

    builder: Add script for making Scientific Linux instances.
    
    RWMJ:
     - Renamed the script from sl.sh -> scientificlinux.sh
     - The output file is called scientificlinux-$version
     - I fixed some whitespace issues so it's now similar to the CentOS script.

commit f526fe1766471b51b92cad74af0103d1889db83a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 5 22:25:59 2013 +0000

    builder: Fail if bison is not installed.
    
    This partially fixes commit a4800e2d4fc50f372a8b626333c4fbb9b8ca9633.

commit 4339b55d105eab6eba2756bffff42a1c34f9f656
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 5 17:40:20 2013 +0000

    builder: Add dependencies which automake doesn't generate correctly.
    
    This is a further attempt, earlier commits:
    commit e3ac293e869a4c69225e3d954b812e9bf21588a1
    commit dfe97b352d6b398c3cb3ddb1c9984767722e514b

commit d669db7ff0a2f8216ae8287d4c74314c5d9e2f13
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 5 16:54:37 2013 +0000

    Update to latest gnulib to get hash relicensing change (thanks Jim Meyering).

commit 663012c5ffecc6f89ad164d292fc0f970338f824
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 5 16:51:08 2013 +0000

    builder: Fix centos script - output filename was wrong.
    
    This fixes commit 2f3fb2420e7f2ccc19fdc863ecc7b7ce29dd6aa1.

commit 6db81dc72e043c2d498a30d4326748089501497f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 5 16:13:17 2013 +0000

    Version 1.25.6.

commit e3ac293e869a4c69225e3d954b812e9bf21588a1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 5 15:56:34 2013 +0000

    builder: Add dependency from index-parse.h to index-validate.
    
    For some reason automake doesn't get this dependency right,
    resulting in occasional build failures if yacc races the
    rest of the build.

commit 01551e546293bbbd094d4d4acfdaf421f7758251
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 5 15:43:24 2013 +0000

    builder: Add some generated files to CLEANFILES.
    
    This updates commit a4800e2d4fc50f372a8b626333c4fbb9b8ca9633.

commit dfe97b352d6b398c3cb3ddb1c9984767722e514b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 5 15:42:05 2013 +0000

    builder: Add missing dependency.
    
    index-parser-c.c depends on index-parse.h being created first.
    However without an explicit dependency, this is not done (and implicit
    deps don't work because automake doesn't sufficiently understand OCaml
    programs).
    
    This fixes commit a4800e2d4fc50f372a8b626333c4fbb9b8ca9633.

commit 96eab7cc003a9b5457fed311cec27852ce22344c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 5 15:19:08 2013 +0000

    Version 1.25.5.

commit ab801c2657354639ae7bad1cd60ad387592249f4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 5 15:16:55 2013 +0000

    Don't include email addresses in AUTHORS file.
    
    Some authors had duplicate entries because they had multiple
    email addresses.

commit 92206e8d09455b3ec63d44e4b55d5eef415681af
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 5 15:15:17 2013 +0000

    builder/website: Add validate.sh test script to EXTRA_DIST.
    
    This fixes commit 154bfb7dd46e7998eed1d40ead95923590763739.

commit 2f3fb2420e7f2ccc19fdc863ecc7b7ce29dd6aa1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 5 14:08:01 2013 +0000

    builder: Replace centos-6.sh with a single script.
    
    Just use:
    
      ./centos.sh 6
    
    Note that you don't need to be root.

commit af9e9299bf0f422d7e07ccfe9a59e664b49c2dfe
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 5 14:08:01 2013 +0000

    builder: Replace debian-<NN>.sh with a single script.
    
    Just use:
    
      ./debian.sh 6 squeeze
    
    Note that you don't need to be root.

commit 91b5e7fb37751719304573882c521071aa811e36
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 5 14:08:01 2013 +0000

    builder: Replace ubuntu-<NN>.sh with a single script.
    
    Just use:
    
      ./ubuntu.sh 10.04 lucid
    
    Note that you don't need to be root.

commit ade0f1a97d6371f5d5a538da9d41263146cc58d6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 5 13:59:55 2013 +0000

    builder: Replace fedora-<NN> shell & kickstart with a single script.
    
    Just use:
    
      ./fedora.sh 18
    
    Note that you don't need to be root.

commit 681c88ef5d69b1dec4b929ff3451c45968023e5a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 5 10:21:32 2013 +0000

    builder: Internal implementation of parallel xzcat (pxzcat).
    
    Instead of calling out to the pxzcat program, use an internal
    implementation.  This requires liblzma to be available at build time.
    If it's not available, fall back to using regular xzcat.
    
    It is intended that eventually this code will go away when regular
    xzcat / unxz is able to use threads.

commit 7e2576a74a93474bc04525adc398cdc4144f389d
Author: Nikos Skalkotos <skalkoto@grnet.gr>
Date:   Tue Nov 5 12:15:47 2013 +0200

    Fix fstab block device resolution for FreeBSD
    
    The device name prefix for IDE hard drives used to be `ad' but now
    is `ada' (http://www.freebsd.org/doc/handbook/disks-naming.html).
    For virtio hard drives it is `vtbd'.
    
    Under an MBR partition table a slice will be used, so the name of
    the first partitions will be either `ada0s1a' or `vtbd0s1a'. Under a
    GPT partition table, where no slice is needed, the name of the first
    partition will be either `ada0p1' or `vtbd0p1'.
    
    Signed-off-by: Nikos Skalkotos <skalkoto@grnet.gr>

commit 154bfb7dd46e7998eed1d40ead95923590763739
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 5 07:25:46 2013 +0000

    builder/website: Add index validation test script.

commit cd10f6f4db32689b2552b52a4875795be8b35694
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 5 07:20:37 2013 +0000

    builder: Add an extra Makefile.am to builder/website.

commit 2035a75d66676c5fb2cc047a36c174dd953cd1b9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 5 07:15:19 2013 +0000

    builder: Fix missing files in EXTRA_DIST.
    
    This fixes commit a4800e2d4fc50f372a8b626333c4fbb9b8ca9633.

commit 004bf7c3db8fd87e8a041d97f06f8dcedd4ee8ff
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 4 22:33:48 2013 +0000

    Version 1.25.4.

commit 2dca9d719434f6783e11976699e45a98128ca913
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 4 22:13:23 2013 +0000

    builder: Fix 'check-valgrind' so it does something in this directory.

commit a4800e2d4fc50f372a8b626333c4fbb9b8ca9633
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 4 14:53:41 2013 +0000

    builder: Add a real scanner/parser for index files.
    
    This adds a tool called virt-index-validate to validate index files.

commit 3ffdddbedf176fa5f12172fb2e3c6bd4b2690f9e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 4 21:35:48 2013 +0000

    builder: Don't use git tree / libguestfs.git to refer to the source.
    
    git is just a VCS.

commit 50486232db08ccad4b38f5addfcef92b0f4faef3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 2 08:31:27 2013 +0000

    df: Allow parallel test to be skipped.
    
    It currently fails because of
    https://bugzilla.redhat.com/show_bug.cgi?id=1025942

commit 5280e3031be9d1f72d03510483fa22634b5d9af5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 1 16:47:20 2013 +0000

    builder: Only warn about unknown fields in the index if -v option is used.
    
    Allows us to add new fields in future without having pointless
    warnings from old versions of virt-builder.

commit 8d14abb0df1e216682fa9c35bda3d4ecdb9b4dd2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 1 16:45:52 2013 +0000

    builder: Allow checksum= as an alias for checksum[sha512]=.
    
    This is for backwards compatibility with virt-builder 1.24.0 which
    could not parse a key that contains square brackets and numbers.
    
    This updates commit 4b73e0be29302da0ae8c5c79a51e770cbe6ed7cf.

commit 5b9ac57d4e4eb6a9f190f734c8aaa98fd24a4816
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 1 15:10:11 2013 +0000

    builder: Update TODO file with some more ideas.

commit 20ad6becd87d281fa237748ef7e7c2df6c5ee3d8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 1 14:44:36 2013 +0000

    Version 1.25.3.

commit e9d908929fd87ef8adb6f95f35da35e39876f148
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 1 14:45:39 2013 +0000

    builder: Add missing files to EXTRA_DIST.

commit 7113aee0b439b411602d8d7d4b03bf02bc91b800
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 1 14:33:25 2013 +0000

    ./run: Disable timeouts in tests on RHEL 6.
    
    Workaround for https://bugzilla.redhat.com/show_bug.cgi?id=1025269

commit bb4e882d61b49045aabd35912ae7e3a18cd6028b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 1 14:16:34 2013 +0000

    builder: Allow multiple source paths to be specified.
    
    Users can now specify multiple source paths, eg:
    
      virt-builder --source http://example.com/foo \
        --source http://example.com/bar
    
    to get templates from multiple places.
    
    There is still only one built-in path, but we can add more later.

commit b25e8da6d60875d1b7416558ecb24fe3e161654d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 1 13:48:30 2013 +0000

    builder: When debugging, print curl command before running it.

commit 4b73e0be29302da0ae8c5c79a51e770cbe6ed7cf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 29 21:03:15 2013 +0000

    builder: index: Add checksum[sha512]=... option and deprecate template sigs.
    
    We don't need to sign individual templates, provided the signed index
    file contains the cryptographically secure checksums of the templates.
    Since the index file cannot be interfered with and the checksums
    cannot be spoofed, this is sufficient to ensure the integrity of the
    templates.
    
    Note the template signatures are now deprecated and will be removed in
    libguestfs 1.26.  To avoid any backwards compatibility issues, I will
    backport the relevant changes to the stable-1.24 branch.
    
    Thanks Dennis Gilmore for pointing out that we could do this.

commit 3b746ee796770302893e9aee20d077c1f67e0c01
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 1 08:21:23 2013 +0000

    ./run: Fix massive thinko in $PATH setting.
    
    This fixes commit 76c20d761b24195b3cd7a620524ae84ed0ab6ab3.

commit 984b024c5a74dd47b99dee128f8709dd36e56fb1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 29 21:03:01 2013 +0000

    builder: Whitespace change in error message.

commit 124f20a1ca49749af40f1052bb9506ec9a8b7046
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 29 21:02:39 2013 +0000

    builder: Be more careful about deleting temporary files on exit.

commit 9ac076c269f3396a01c699fb71ccb32c00bed6ca
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 29 21:01:54 2013 +0000

    builder: Whitespace fix in Index_parser module.

commit 2191b9ae4008c3352413dbb8c5394739c8a23574
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 29 19:45:23 2013 +0000

    Version 1.25.2.

commit e4c9212a8e9fe9c2a75ce5035a4c3bce53261018
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Tue Oct 22 16:17:25 2013 +0800

    sysprep: add feature of deleting specified paths
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>
    Signed-off-by: Richard W.M. Jones <rjones@redhat.com>

commit 42e445f98692c6344baafaab1da10e821288ac0a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 29 19:23:33 2013 +0000

    builder: Add -m/--memsize and --smp command line options.

commit eb4e356bc3bc96be040763def8c274eee82cafcd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 13 15:45:38 2013 +0100

    launch: direct: Add some code to enable qemu / gdb debugging.
    
    See the comment for details.
    
    Note this is disabled by default.  Developers can only enable it by
    changing #if 0 -> #if 1.

commit 12e0e3fb0948d9e2975f2bfa596d068d83b717fa
Author: Matthew Booth <mbooth@redhat.com>
Date:   Tue Oct 29 13:27:30 2013 +0000

    docs: guestfs_case_sensitive_path returns error on non-existent path

commit 2f85affefbd505a7582e8188d4483108b3aa10e6
Author: Daniel Exner <dex@dragonslave.de>
Date:   Tue Oct 22 20:44:43 2013 +0200

    Initial FrugalWare support.

commit 276cde033c454e084e38c36af693c3fcad86281f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Oct 27 18:50:07 2013 +0000

    builder: Add CentOS 6.4 guest.

commit 2937c035958f84986e84c47df49f79d19c4b5b59
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Oct 27 14:59:39 2013 +0000

    builder: Add a section on performance to the manual.

commit 76c20d761b24195b3cd7a620524ae84ed0ab6ab3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 26 20:23:22 2013 +0100

    ./run: Adjust $PATH to include all libguestfs binaries.
    
    Instead of typing:
    
      ./run ./fish/guestfish ...
    
    you can now use:
    
      ./run guestfish ...
    
    This is shorter, but there are also two good reasons for this change:
    It never made any sense to run the system-installed guestfish (or
    other) binary.  It would be unlikely to work.  Also binaries in
    libguestfs should be able to call other binaries freely without adding
    special exceptions (which we had before this change).

commit f114e28cc80eabdcf47c97e7e3895065cdfe4886
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 26 17:09:06 2013 +0100

    firstboot: Send the output to the console as well as to the log file.
    
    For systemd:
    Currently stdout+stderr go to the journal (these are effectively
    empty unless there are gross errors).  The output of the commands
    goes to the log file.
    
    With this change, the output goes to the journal, the console and
    the log file.
    
    For SysV-init:
    Currently stdout+stderr go to the console (but these are effectively
    empty).  The output of the commands goes to the log file.
    
    With this change, the output goes to the console and the log file.

commit 8b34855684fb660823a2801a4a5e8be32a6cc40f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 26 14:45:30 2013 +0100

    builder: Document how to boot VMs directly in qemu or KVM.

commit 0520aa3c42fbb174be37ef75b19390855d225897
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 26 11:40:48 2013 +0100

    builder: Add --write option to write a literal file.

commit 10c849ed1cb4375c5ef811197fa0a3206d365b86
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 26 11:27:06 2013 +0100

    builder: Allow --upload to a directory.
    
    Also set the owner and permissions on the destination file correctly.

commit cede5316b06fbaa8448ef1a109666edc55acb71e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 26 11:01:51 2013 +0100

    Version 1.25.1.

commit 2add5c9295c704738fbe183463243d4b65392bab
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 25 14:11:43 2013 +0100

    builder: Don't fail if ~/.cache doesn't exist (RHBZ#1022431).

commit dd5959cd8875496594df0fdbb8a00cbe6618c9ee
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 25 13:36:19 2013 +0100

    builder: Copy-editing on documentation.
    
    Plus some ideas added to TODO file.

commit 99840550d5508b228ee4b2533ad94da517873f76
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 25 13:35:51 2013 +0100

    builder: Add --mkdir option to create directories.

commit b3ab3b452ac9654ec9460e0eb881839432a38928
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 23 11:37:11 2013 +0100

    builder: Fix two problems in --help output.

commit 3f46a92ed5737bb8d75630a39729f95bc96417f6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 22 22:28:27 2013 +0100

    builder: Add --no-sync option to avoid sync on exit.

commit f59a404568c3076feeeaef7836dbd5cbf68720a2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 22 17:56:11 2013 +0100

    Revert "java: Remove version number from the jar file (RHBZ#1022184)."
    
    This reverts commit 7330ccd288a001d33866308ff8d679a884230d83.
    
    See comment in https://bugzilla.redhat.com/1022184

commit 7330ccd288a001d33866308ff8d679a884230d83
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 22 17:44:33 2013 +0100

    java: Remove version number from the jar file (RHBZ#1022184).

commit d4450c6590744ab96c7e0c3b21325d1eff666f29
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 22 14:22:46 2013 +0100

    builder: Use pxzcat (optionally) to speed up xzcat step.

commit 0e18bccb648f8c96366ae53746d83bd009f924f7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 22 14:09:20 2013 +0100

    builder: Make xzcat binary configurable and use AC_PATH_PROG.

commit 2f3a3e308af8012501437f723471a66537ecbf64
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 22 13:52:25 2013 +0100

    builder: Don't run virt-resize when not necessary.
    
    If:
     - the output is a regular file
     - the output format is raw
     - the user didn't specify the --size option
    then we don't need to run virt-resize.  Simply uncompress
    the template directly to the output file.

commit 2a76aa22c7105aa165d8fee6360ca6dbaf4027c3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 22 13:58:33 2013 +0100

    build: xz is required.
    
    It is needed for libguestfs-make-fixed-appliance and many other places.

commit 5b89dd4aa1e918890c5958b96857a6c249203dbc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 22 13:48:41 2013 +0100

    mllib: Create config.ml from configure and use it for --version options.
    
    Also don't internationalize the output of the --version option, as
    that isn't useful.

commit d6e5a6546afeb1554e676e5a4197002559f6cde7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 19 22:27:52 2013 +0100

    configure: Use AC_PATH_PROG{,S} for external programs used by the library.

commit a29777c111102e0b2419993b66f4124fa93286ea
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 18 17:55:45 2013 +0100

    Version 1.25.0.

commit 356e6a6504644768203e9ed611cfa920c3e3d070
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 18 17:38:46 2013 +0100

    Version 1.24.0.
    
    New stable branch.

commit 3b69792cd511faad22545e80beb3d15103f0e5ae
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 18 11:46:16 2013 +0100

    appliance: When valgrinding daemon + error path, sleep so valgrind messages are seen.

commit dfaf417fefbf979ffc47cf4723ebd306fac88130
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 18 11:45:53 2013 +0100

    appliance: Add comments to init script.

commit 1e24b8827054a2c7907439322c4eda25dd8580a8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 18 13:17:30 2013 +0100

    resize, builder: Improve speed by using cache=unsafe on newly created files.
    
    However because qemu might open these files immediately afterwards
    using cache=none, we have to sync the file before exiting.

commit 9a4bfb386ee05d3889269d1d41701793f97b2486
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 18 13:16:40 2013 +0100

    resize: Rearrange objects.
    
    This is just build refactoring.

commit 18c93ac61f8f5a0059d8ceda37f963ad4c06d19d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 18 09:09:59 2013 +0100

    RHEL 5: Don't use 'truncate' command in tests.
    
    Use 'guestfish sparse' instead, which is roughly equivalent.
    
    See commit ef1514aa1e0a099d71cbb7d2c5f24f9f32e1939d
    and commit 39df80dcc0e485e69048bddbf33c259ce532e50d.

commit b68a99b8e272267dc78694c0356e137f58c976f0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 17 16:03:08 2013 +0100

    Finalize release notes for libguestfs 1.24 release.

commit 6611d45ab7b2b0ca2656d11f7740eaf7d4100140
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 17 15:49:13 2013 +0100

    Update PO files from Transifex.

commit bbac0beab9f2fdb5c57b0e0db636c18662d99c2a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 17 15:48:44 2013 +0100

    Update ROADMAP.

commit feaf8718569b44529885dca6afba063ee3565c70
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 17 15:47:56 2013 +0100

    API support: Fix website directory for new location.

commit ad82de35b7e504e3638b3c1f8561df3c02313832
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 17 15:47:52 2013 +0100

    Update API support.

commit 3cce894f1ba4b1f08bbfe260105508df680273ee
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 17 15:42:38 2013 +0100

    Update TODO.

commit 24a315507d1293a0ec097b57d15efb3dae784489
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 17 15:12:19 2013 +0100

    Add man page for /etc/libguestfs-tools.conf (RHBZ#1019889).
    
    Add a man page to document this configuration file.  This is
    required by some distros, eg. Debian and RHEL.

commit 13b79aacca952974d5bac4b77a18d29a32b34593
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 17 15:03:37 2013 +0100

    Use qemu-img -o preallocation=metadata where possible.
    
    When format is qcow2 and we're *not* using a backing disk, we can use
    preallocation=metadata for better performance.

commit 54fb09e052d8cad50397f1085c1bdd346a13e659
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 9 12:08:10 2013 +0100

    fish: CVE-2013-4419: Fix insecure temporary directory handling for remote guestfish (RHBZ#1016960).
    
    When using the guestfish --remote or guestfish --listen options,
    guestfish would create a socket in a known location
    (/tmp/.guestfish-$UID/socket-$PID).
    
    The location has to be a known one in order for both ends to
    communicate.  However no checking was done that the containing
    directory (/tmp/.guestfish-$UID) is owned by the user.  Thus another
    user could create this directory and potentially modify sockets owned
    by another user's guestfish client or server.
    
    This commit fixes the issue by creating the directory unconditionally,
    and then checking that the directory has the correct owner and
    permissions, thus preventing another user from creating the directory
    first.
    
    If guestfish sees a suspicious socket directory it will print an error
    like this and exit with an error status:
    
      guestfish: '/tmp/.guestfish-1000' is not a directory or has insecure owner or permissions
    
    Thanks: Michael Scherer for discovering this issue.
    
    Version 2:
     - Add assigned CVE number.
     - Update documentation.
    
    Signed-off-by: Richard W.M. Jones <rjones@redhat.com>

commit 34da8850bb414e87f0ffd830506da77a7c0406b9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 16 16:32:06 2013 +0100

    builder: When doing maintainer test for new guests, test adding a user account.

commit 61306130f851ba0f3b8560e44b8f16881bcf8679
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 17 10:39:21 2013 +0100

    launch: libvirt: Add guestfs-<random> name to the handle.
    
    This is so we can display the random name in debug messages.

commit fc733cf9434b196b57ff3b00c790734a8063b0b7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 16 10:48:07 2013 +0100

    FAQ: useradd -> usermod.
    
    This fixes commit dd554d94ad2f381c37c4a5229502963058c2c9f4.

commit cb49299c13a15de9beae255d14f6bde04e788282
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 15 20:41:07 2013 +0100

    Version 1.23.33.

commit f08ef9778bca2646f72e3ea2116cbaf5f1899996
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 15 15:18:18 2013 +0100

    builder: Add maintainer test for new guests.
    
    This is not part of the automated test suite.  It's a manual test run
    by the maintainer which must be run on each new guest to ensure that
    all the virt-builder features work on the new guest.

commit b816f29adaab29c7c62ddb90d05715aa8f9e175b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 15 17:31:52 2013 +0100

    firstboot: Ensure firstboot scripts run in command line order.
    
    Previously they ran in effectively random order.

commit a3e5bc7bfa4146e2176e93cafaad19a555104062
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 15 17:30:08 2013 +0100

    sysprep: firstboot: Don't set `Created_files flag unless files are created.

commit 356a749bba464260434823dfde14d0ed2aae958d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 15 16:10:28 2013 +0100

    firstboot: Add some debugging to the control script.
    
    For reasons unknown, firstboot does not work on Debian 6 & 7.
    https://bugzilla.redhat.com/show_bug.cgi?id=1019388

commit 49e6ba51e3a75a84fc8da867fb5d3ef40c7c4665
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 15 16:19:43 2013 +0100

    sysprep: random seed: Try much harder to create a random seed file.
    
    Since this is essential for security, be much more proactive about
    trying to create a random seed file, even for guests which have buggy
    installers that don't create this file during installation.

commit 862da5dd79f66ca8df620e94170352f8bcd8bff7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 15 15:32:34 2013 +0100

    builder: Really force apt not to ask questions.
    
    This fixes commit b812a0d45992e729a85f10483ae26b82b8e2da90.

commit 8b977d152a02e8be273fbdbfcdde5625e0e62cb2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 15 14:46:40 2013 +0100

    builder: Remove capital O and lower case L from random root password.
    
    They look too much like 0 and 1.

commit 70e660a157dd57f0c3edcd27dafd2ff915711e0c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 15 14:37:48 2013 +0100

    builder: Wrap program in an exception handler which pretty-prints common exceptions.
    
    This looks like a large change, but is mainly just reindenting
    everything into a 'main ()' function.

commit fd63d896445260ce83f88e58c0219606f97dca9e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 15 14:19:53 2013 +0100

    builder: Remove nbdkit-xz-plugin support (it was disabled anyway).
    
    We can re-add this later if libvirt gets fixed, but for now simplify
    the code and concentrate on the one code path.

commit d8499c428a9234c816c2a0c1c3109df89d563e47
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 15 14:08:39 2013 +0100

    builder: Move command line argument processing to separate source file.
    
    This is just code motion.

commit 2bc223b6b28982e6fdb9f8810e81ec4aa7ea83f4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 15 09:53:08 2013 +0100

    firstboot: Fix test for installing sysvinit scripts.
    
    This fixes commit 9aa13e057497a91ce9037f18a51ea6f35b4f2aa5.

commit b812a0d45992e729a85f10483ae26b82b8e2da90
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 14 23:25:31 2013 +0100

    builder: Try really hard to make apt non-interactive.

commit ec6f9ee542e0e9ad0109a7522e83ea07b2f8a002
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 14 14:55:53 2013 -0400

    appliance: Remove cruft and run udevd directly.
    
    This commit removes a lot of cruft from old RHEL which was required to
    start udev.  Instead we run the daemon directly.
    
    Also it removes the fallback path which created some device nodes in
    /dev by hand.  This likely did not work.  This also removes the
    dependency on MAKEDEV which is long gone from most distros.
    
    This is required for Ubuntu, since the /etc/init.d/udev script didn't
    actually work.  The most common symptom was that /dev/virtio-ports/*
    was not created because udev didn't process the cold start events.

commit c9f98011fc34cba89c270732289854d75704ba31
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 14 18:07:22 2013 +0100

    Version 1.23.32.

commit d9008e141ca7e4308165486d0505df162edd1de9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 14 18:21:32 2013 +0100

    build: Add missing EXTRA_DIST files.

commit ec0d0e0f624f1c1fa94f8cfc6f191b3d52bc7c91
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 14 18:20:21 2013 +0100

    build: Add maintainer-check-extra-dist rule.
    
    This is used by the maintainer to check for missing files
    in EXTRA_DIST.

commit 56928b53810ae35f9b4d0e2fb24bdf7b3974721c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 14 18:20:55 2013 +0100

    build: Don't hard-code list of virt-builder templates in top level directory.
    
    It's troublesome for maintenance.  Use a wildcard here.

commit 9c7497a1eb549c11295a7711f18b2e8e4de0d1e0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 14 15:51:47 2013 +0100

    Update to latest gnulib.

commit 9aa13e057497a91ce9037f18a51ea6f35b4f2aa5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 14 14:56:56 2013 +0100

    firstboot: Install both systemd and SysV init scripts.
    
    This should be safe, and avoids the whole issue of whether a guest
    uses systemd or not.  Also it is possible to switch init systems
    (eg. by specifying init= on the command line) so it's not even clear
    if a guest "is" systemd.
    
    Thanks: Tom Gundersen on #systemd.
    
    This updates/fixes commit 596de56a436d56886616f5cc213bb72a4f6f5561.

commit cff95392f58a00654df3ffd2d9b09f58ae5e4e32
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 14 14:56:13 2013 +0100

    firstboot: Start service after network only.
    
    Not necessary to wait for syslog since (a) we do our own logging
    to a file and (b) syslog might not be installed.

commit 596de56a436d56886616f5cc213bb72a4f6f5561
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 14 14:05:27 2013 +0100

    firstboot: Fix firstboot scripts so they work on Ubuntu.
    
    Ubuntu 13.10 has /etc/systemd but uses Upstart.  This confuses the
    script because it assumed that if you have /etc/systemd then you are
    using systemd.  Ubuntu includes systemd services (inherited from
    Debian) but they just don't run.

commit 234c3801280a95fe8f2dc3e2523bee9e03f7f407
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 14 13:45:10 2013 +0100

    builder: Add --notes option.
    
    This displays the release notes.

commit d0b62bd500caf2c034e65b52c72368a006e135dd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 14 13:44:41 2013 +0100

    builder: Add short synopsis in --help output.

commit cc15877f079bbc13371794af5273035fc8e51520
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 14 13:44:06 2013 +0100

    builder: Tidy up release notes for operating systems.

commit 7e7017957ec067eb4e3f78d52003362a22f5d552
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 14 13:40:57 2013 +0100

    builder: debian/ubuntu: Add notes about running dpkg-reconfigure.
    
    Required to regenerate SSH host keys.

commit 6238cc84f6e539570792010881c98daae57bd946
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 14 13:27:07 2013 +0100

    builder: Fix typo in man page.

commit 22d182dbcb45595d170891857300d5fdc470dd63
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 14 12:33:06 2013 +0100

    builder: Fix output to block devices.
    
    If the output is a block device:
    
    - Detect the size of the output device.
    
    - Don't attempt to delete the output device on failure.
    
    - Turn off sparse copying in virt-resize.

commit fb4dd1b55a47b3bcfcd76a22b52ff3c99ded60e4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 14 12:32:29 2013 +0100

    resize: Add --no-sparse flag to let you turn off sparse copying.
    
    Useful when the target is a block device containing old data.

commit ceaa1ef0b8bc1ed7d86da0e126a9134699ebd066
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 14 13:15:04 2013 +0100

    builder: Run 'apt-get update' before trying to install packages.

commit dd554d94ad2f381c37c4a5229502963058c2c9f4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 14 12:32:04 2013 +0100

    FAQ: Clearer instructions for Debian and Ubuntu users.

commit b08d8e15bb5c758ce9ea1dbc934e47d16c7cec66
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Oct 13 18:12:02 2013 +0100

    builder: Kill any daemons started by installed packages.
    
    Some --install requests may pull in packages that start daemons (dbus
    being a favourite daemon apparently).  These daemons will prevent the
    disks from being unmounted and everything being cleaned up at the end.
    Add some experimental code to kill these daemons.

commit e8e0d98ef8cb5834d8dfb213fbfb5c9d69ea8b78
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Oct 13 17:51:12 2013 +0100

    builder: Add more templates to the list which is copied to the website.

commit 5d22ee8760d87072fabae072103bbe2ea9b65ffa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Oct 13 17:50:16 2013 +0100

    builder: Add the logo to the HTML manual page.
    
    Unfortunately:
    
     - It appears below the TOC.  This is unavoidable because of the
       flow of the current HTML.
    
     - The logo is now duplicated in git.

commit 2224372016f4a4fd62e9aa265800c447b3886cf9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 12 21:55:18 2013 +0100

    Version 1.23.31.

commit 6e77422800a6086a4c505afe71f5cc57422c33be
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 12 21:51:47 2013 +0100

    po: builder: Hack to remove duplicate message definition.
    
    Because we're not running msgmerge but concatenating the PO files, you
    can get duplicate messages (in this case "no"), resulting in this
    error:
    
    libguestfs.pot:6142: duplicate message definition...
    libguestfs.pot:3285: ...this is the location of the first definition
    
    Just work around this for now.

commit f3484ff3b4a06cfa0ef80894b9d53c32d9212142
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 12 21:28:44 2013 +0100

    builder: Document how to enable virtual consoles on Debian guests.

commit 1df6905c805d807bfeb86d0d687e05c3209123e3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 12 20:25:52 2013 +0100

    builder: Add --edit option.
    
    This allows you to use Perl to edit files in the guest.
    
    This works very similarly to the 'virt-edit -e' (non-interactive
    editing) function.

commit c80dcc2da62f0c265b205716f84fa37b14849882
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 12 20:31:39 2013 +0100

    builder: Small copy-edit to the manual.

commit 04041f23d01094b5c811c039810c19c45ff6e7ca
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 12 20:22:10 2013 +0100

    edit: Add virt-edit --edit as an alias for virt-edit -e.
    
    This just adds the alias and does nothing else.

commit a010ab51473dd27416c98628d5358859c62b4ee9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 12 20:24:26 2013 +0100

    builder: Upcase --delete and --scrub option arguments in man page.
    
    For consistency with other options.
    
    This updates commit 7820aaf1f3f1402811c1c3c8b2239aec0e12cf5e.

commit f7ca38b728a5bf1d567f74acdd6d2112cbd2a3da
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 12 20:10:34 2013 +0100

    appliance: Disable LD_PRELOAD libSegFault in virt-rescue shell.
    
    Commit c598e14052399f19d36d7874d7133cba779bd3c2 exports
    LD_PRELOAD=/lib64/libSegFault.so so that guestfsd and processes that
    it runs will produce descriptive stack traces.
    
    However it exports it to everything including the virt-rescue shell.
    But if we are chrooting into a guest which doesn't have this file (or
    indeed any guest) we should not use LD_PRELOAD.
    
    Therefore unset LD_PRELOAD in the rescue shell.
    
    See also related commit 21e5fc811ea3708ef0c768467ffe53368bc435e9.

commit 5b49f8de27735015b21cd6d2a186a8332edee684
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 12 19:03:09 2013 +0100

    builder: Add Debian 6 (Squeeze) guest template.

commit c64214f2a42eab698bd4764a09d064bc4f96032c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 12 17:19:52 2013 +0100

    builder: With -v option, dump out the log file.
    
    Useful for debugging install errors.

commit aec2e2edbf3f53ebe156a25d396c171e1aef30ee
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 12 17:14:58 2013 +0100

    builder: Add comment about download /dev/stderr truncating redirection files.

commit a43f5e57a872bed2bba14f60110ffbcefb1a0bab
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 12 16:37:57 2013 +0100

    builder: '@' (not '+') is used to install groups of packages in Fedora.

commit 17c2698617977e3b6c5556c5c0f361da0e23bdbf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 12 16:36:01 2013 +0100

    builder: Print some stats about the generated image at the end.
    
    It will print stats at the end like this:
    
      Output: fedora-18.img (8.0G)
      Free space: 3.2G (39%)

commit 7820aaf1f3f1402811c1c3c8b2239aec0e12cf5e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 12 15:45:48 2013 +0100

    builder: Add --delete and --scrub options for deleting guest files.

commit dc0ec4db2140b32bb7c8f7517f4d0f50609d5e7b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 12 15:33:48 2013 +0100

    builder: In documentation, use 'scrub log file' instead of 'wipe'.
    
    Since we really do try to scrub the data.

commit 11f116f21e8f7db023a62dd0629d13005eead02c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 12 15:13:42 2013 +0100

    builder: Advice on setting environment variables to maximize caching.

commit 4bea0548c701858f368a402f2866b93217b91f6f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 12 15:13:26 2013 +0100

    builder: Add --cache-all-templates option.

commit fdd4d75b85b49778542923d565c89a7fcddf63bb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 12 14:57:34 2013 +0100

    builder: Make --delete-cache obey the --cache option.
    
    Previously a command such as:
    
      virt-builder --cache /tmp/cache --delete-cache
    
    would delete ~/.cache/virt-builder (the default cachedir).
    
    It's obviously meant to delete /tmp/cache, which this commit fixes.

commit 2eeaea6423ed11b5bb35a5fb03a92b2ff8716118
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 12 14:52:27 2013 +0100

    builder: Add --print-cache option.

commit ff76d1abdb163f85c647c76d059dfb344222136c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 12 12:58:49 2013 +0100

    recipes: More recipes for virt-builder, syslinux, Xen partitionless guest conversion.

commit da85de8a42a3f0c28a8cd48c34d93801afb7aa23
Author: John Eckersberg <jeckersb@redhat.com>
Date:   Fri Oct 11 22:26:07 2013 -0400

    btrfs: Fix improper memmove usage in do_btrfs_subvolume_list (RHBZ#1018149).
    
    The third parameter (number of bytes to copy) was given as an offset
    relative to dest, when it should be relative to src.  This fixes some
    valgrind warnings I happened across.

commit 7d0d159bedd9c2e3460a08c072464998f8accb8a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 11 15:47:16 2013 +0100

    Version 1.23.30.

commit ff738d1480a488db4d77841dfbfde2e7adb91d18
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 11 13:24:59 2013 +0100

    debian: Warn if /dev/kvm is 0660 and user is not in the KVM group.
    
    On Debian, /dev/kvm is mode 0660 and group kvm, so users need to add
    themselves to the kvm group otherwise things are going to be very slow
    (this is Debian bug 640328).

commit 92e18649136157e90442f4bbc7616e2168d2e12c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 11 14:35:12 2013 +0100

    events: Add a warning event and direct all warning messages through it.
    
    This also causes warnings to be printed even in non-verbose mode,
    which is useful.

commit aada08a91cb697328c05c49992968b30ff044c09
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 11 13:28:58 2013 +0100

    launch: libvirt: Suggest using the direct backend if libvirt fails.

commit b4fea7592f1bd5d921b329fb8c396bdb240d539d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 11 12:43:39 2013 +0100

    builder: Avoid parallel cache downloads from stomping on each other.
    
    This should let you run virt-builder instances in parallel.

commit 802c7f7376ce7c11e1da29e69cd70ba746699dc7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 11 11:48:27 2013 +0100

    daemon: Don't leak 'device' string in parse_btrfsvol.
    
    Since 'device' is assigned repeatedly, and because
    device_name_translation allocates a new string each time, we have to
    free it in the loop and along error paths.
    
    Found by ./configure --enable-valgrind-daemon.

commit d8a8894cb24baab2a98ee3bd3a15dae12c76b9e7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 11 11:51:13 2013 +0100

    daemon: xattr: Fix scope of cleanup buf to avoid memory leaks.
    
    Found by ./configure --enable-valgrind-daemon.

commit 46304e93898321848e33ac4c35c71f632d42bca8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 11 11:13:18 2013 +0100

    daemon: Fix macro definition.
    
    Defined a bogus macro along an unused code path.

commit c245b55707d7495c7ad39e9ead76de670ecf4dfd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 11 11:12:57 2013 +0100

    daemon: parted: Fix memory leak of list of strings.
    
    Found by ./configure --enable-valgrind-daemon.

commit db0307b7e31bc09c4ce8d966c8b1554754b58532
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 11 11:12:27 2013 +0100

    daemon: Fix scope of cleanup functions to avoid memory leaks.
    
    Found by ./configure --enable-valgrind-daemon.

commit 237e1d41d777b3439b7660bfac294e3a096ef243
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 11 11:11:43 2013 +0100

    daemon: Ignore memory leak in aug_setm.
    
    (Found by ./configure --enable-valgrind-daemon)

commit 494c18802b17c9c91774a806c513a27a8ba60671
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 10 22:24:01 2013 +0100

    daemon: When valgrinding the daemon, take steps to cleanly exit daemon.
    
    This adds a new internal API: internal_exit
    
    Only when valgrinding the daemon, have the library call internal_exit
    along the close path, and close the sockets first.  This ensures we
    will see normal valgrind messages (we were only seeing valgrind aborts
    before).
    
    Note this is not used in production builds.

commit 34a3ad9e2dc34e8718a812c5e5555414cb90ee39
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 10 14:19:25 2013 +0100

    Version 1.23.29.

commit 0f8db6185f8b37023ecb901100444c9637aad0ed
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 10 15:50:01 2013 +0100

    inspector: Allow the test to be skipped by setting an environment variable.

commit 9f1bcbca55661632176dea4e1dadc4dea0ca7f21
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 9 12:07:39 2013 +0100

    fish: Use UNIX_PATH_MAX instead of hard-coded value for max length of socket buf.

commit 29003cf67fa6ff44c16ed743a58819a60bdc99fd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 9 20:55:28 2013 +0100

    sparsify: Use Filename.temp_dir_name instead of Filename.get_temp_dir_name ().
    
    The latter function is only available in OCaml >= 4.00 whereas
    Filename.temp_dir_name has been around since OCaml 3.09.1.  In this
    case it doesn't make any difference which one we use.

commit b2baaa0029b8eac3abefa6d8c752c0cf7a5bfafb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 9 20:42:47 2013 +0100

    generator: Change handling of C 'function(void)' to be simpler.
    
    This also fixes an obscure case in daemon/optgroups.h.
    
    The only difference in the generated output is:
    
    --- daemon/optgroups.h.orig	     2013-10-09 20:42:02.479681861 +0100
    +++ daemon/optgroups.h		     2013-10-09 20:42:10.563681858 +0100
    @@ -149,7 +149,7 @@
       int optgroup_inotify_available (void) { return 0; }
    
     #define OPTGROUP_JOURNAL_NOT_AVAILABLE \
    -  int __attribute__((noreturn)) do_internal_journal_get () { abort (); } \
    +  int __attribute__((noreturn)) do_internal_journal_get (void) { abort (); } \
       int __attribute__((noreturn)) do_journal_close (void) { abort (); } \
       int64_t __attribute__((noreturn)) do_journal_get_data_threshold (void) { abort (); } \
       int __attribute__((noreturn)) do_journal_next (void) { abort (); } \

commit b3d979c349c131bc1e695bfdace586675d391b2a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 8 18:39:18 2013 +0100

    build: WEBSITEDIR has moved.

commit 57956ce790cba7db20d91a42fa5c02df836aee22
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 8 12:34:33 2013 +0100

    Update TODO with more ideas.

commit ae897e055a5bb09a7948a6f152fae9b972b9221e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 8 12:32:41 2013 +0100

    builder: Upload /etc/resolv.conf from the host when the network is enabled.
    
    When the user has enabled the network (not the default) we upload
    /etc/resolv.conf from the host to the appliance /etc/resolv.conf
    so that programs in the appliance can contact nameservers.
    
    Commit 9521422ce60578f7196cc8b7977d998159238c19 previously changed the
    behaviour to copy /etc/resolv.conf into the sysroot when running
    commands.

commit 74d9fdf56f1bb01e5e447986a49d3dbdb49a3f3d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 8 12:15:52 2013 +0100

    df: parallel: Add a debug message when work function returns an error.
    
    Further attempts to find out why this hangs under Koji.

commit 5c53b3266968110629c339aada309753300e4c21
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 8 12:12:22 2013 +0100

    launch: If launch takes longer than 20 minutes, time out.
    
    Add a constant fixed timeout for launch (currently 20 minutes, we'll
    make it configurable if needed in the future).  If the appliance takes
    longer than this to connect back, we time out assuming that the kernel
    has hung during boot.

commit 89b65b9779dc19fd3f67c853de66efa9241c288b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 8 11:58:26 2013 +0100

    launch: libvirt: Clarify comment.

commit 4fc44a0157a1bcd4c618e0eb8afd7c553ed0f31d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 8 10:00:33 2013 +0100

    blockdev: Deprecate blockdev_setbsz and make it do nothing (RHBZ#624334).
    
    This call never did anything.  Don't use it.  Also I have submitted a
    patch upstream to remove the corresponding option from blockdev.
    
    See RHBZ#1002825 for an explanation of why this call was always
    useless.
    
    Thanks: Masayoshi Mizuma

commit f5ba136359b484f7d9a4fc9b9384b5dde6580328
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 8 09:09:49 2013 +0100

    Version 1.23.28.

commit 9521422ce60578f7196cc8b7977d998159238c19
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 7 19:55:00 2013 +0100

    daemon: command: Copy appliance /etc/resolv.conf in before running commands.
    
    When you try to run commands for an Ubuntu guest, they fail because in
    Ubuntu /etc/resolv.conf is a symlink to /run/...  and this turns out
    to be a dangling symlink when the Ubuntu guest is mounted up under the
    appliance.
    
    Therefore even if the network is enabled, any command which tries to
    do name resolution will fail.
    
    Ideally we would like to bind-mount the appliance /etc/resolv.conf
    into the sysroot.  However this is not possible because mount is buggy
    (see comment).  So instead we use a complex hack to achieve the same
    ends.
    
    Note this is only done if the network is enabled and if /etc in the
    guest actually exists.  The original /etc/resolv.conf is restored
    as soon as the command has run.

commit b8b1b0296b0af8d072f329828ecf004116bfc7d3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 7 19:53:54 2013 +0100

    daemon: Refactor bind-mount code.
    
    This is just code motion.

commit 93793db049ef82c956588fa1eced32b483af2875
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 7 17:04:26 2013 +0100

    daemon: 'exists' API should not follow broken symlinks.
    
    Using guestfs_exists on a symlink which existed but pointed to a
    non-existent file was returning false.  However exists obviously
    should not be following the symlink in the first place.

commit 894488c442740a34b96ce0edab7c48e48d94f91e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 7 15:59:37 2013 +0100

    sysprep: ubuntu: Use secure SHA-512 crypt back to Ubuntu 10.04.

commit 5a71a2ddaff35921f80c923ee1724adf2abb581a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 7 13:54:25 2013 +0100

    builder: Add Ubuntu 10.04LTS, 12.04LTS and 13.10 templates.

commit 22fc66f6b2bf5074ff7b276e1fe08bac5d726c99
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 7 14:27:25 2013 +0100

    sysprep: Fix documentation for --mount-options.

commit dfa52c63b1efcfeba3303cc6b37f71c2826fdf6e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 7 14:18:02 2013 +0100

    sysprep: Don't remove /var/cache/apt/archives/partial directory.
    
    Removing this directory breaks Ubuntu guests.
    
    This change adds a utility function which removes only files from a
    directory.  This is a safer way to clean cache directories etc.

commit c8080e53ea24bc91c305983509c8d463ca9e6f9f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 7 10:51:23 2013 +0100

    builder: network: Note that only outgoing connections are allowed.

commit 7dfc67cb12d29baa1729b534dc50fb3b5e5079c4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 7 10:02:57 2013 +0100

    builder: Add section on debugging and other documentation fixes.

commit 10a821553e0cbeeb4cfe7b614e44a4425296ad64
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 5 22:34:46 2013 +0100

    Version 1.23.27.

commit e79c99f58c962b17d38f3cc167faa08cbe814aca
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 5 22:26:28 2013 +0100

    perl: valgrind: Renamed function requires different valgrind suppression.
    
    Seems to be a difference in Perl 5.18.

commit d746d01b81c09a8d0b6bff880896df5ff8f9407d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 5 20:11:33 2013 +0100

    builder: logo: Small adjustments.

commit e9e6f60ef1f3a64a7e518b5f043e011701f8dd6e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 5 18:13:27 2013 +0100

    builder: Document how to import disk images to other tools.
    
    Thanks: Kashyap Chamarthy

commit 424549c23ffa01766959d23e7f67745b972f6a31
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 5 18:12:49 2013 +0100

    builder: Display the output filename.
    
    Thanks: Kashyap Chamarthy

commit 3d5ed2584c8abe652d561fcfa84897aa19b95a97
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 5 17:48:58 2013 +0100

    Version 1.23.26.

commit 80da8b19e0d9745df8774e9cf78e087abbda6064
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 5 16:00:21 2013 +0100

    builder: Use progress bar for large template downloads that are not in the cache.

commit 7b825803520a5ba08eac5fe5d05b691cd33438b9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 5 15:00:54 2013 +0100

    builder: Create an install log file, and dump the full log on error.
    
    This should make debugging much simpler, and also provides a
    build log in the guest once it's built.

commit cc37490e05d323c0393261bbfba87c2ccef3b40f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 5 15:00:36 2013 +0100

    builder: Tidy up error messages.

commit f93968d6faedef85b185eba65b85601ae3df3803
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 5 14:25:07 2013 +0100

    builder: Clean up messaging.
    
    Ensure every significant action gets a message.

commit d55edbd8fba1e0c512a30e49ee32532105b56dd4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 5 12:58:31 2013 +0100

    Add virt-builder logo.

commit bdd5a9a894134a533b06c01071e76fb74b80193b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 5 11:53:06 2013 +0100

    Update release notes with dependency changes since 1.22.

commit f532ca96dc7112774dcbda8a677258d3de2b54c3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 5 11:43:17 2013 +0100

    todo: Some items to do in virt-builder.

commit 39ee0d13db92266bcc7d2d62d83c21fbf4a67153
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 4 13:59:59 2013 +0100

    builder: docs: Minor copy-edits of the man page.

commit be8ccedaf10e921bf727221ad60b2b60df63d555
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 4 13:44:39 2013 +0100

    Update release notes.

commit 05e8410e0ebe7907e5732714b2a0f280d6b1ec44
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 4 13:44:23 2013 +0100

    Update API support.

commit d6f87fe6be5e09c0c462f92455171581a7120000
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 4 12:01:18 2013 +0100

    Version 1.23.25.

commit 8f5dd4ed02e320e42f6dd4d6443996054871b9dd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 4 11:43:31 2013 +0100

    builder: docs: Add sections on architecture, security, UML.

commit 64bef381f63d5dcad47095cbee72dba856e1b145
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 4 08:48:26 2013 +0100

    uml: Fix virt-builder test.
    
    Note comment in the test about networks.

commit fe7f88a35ddeeb53c5f86b20d7097b41c6277d53
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 4 08:33:52 2013 +0100

    builder: Fix --format/--output-format arguments to virt-resize subcommand.
    
    The 'virt-builder --format' option translates to the
    'virt-resize --output-format' option, because it specifies the output
    format.
    
    On the contrary, the 'virt-resize --format' option (the input format)
    is always 'raw'.

commit dd410e1165bbe6c049183176fc1bd8736b9e525b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 4 08:31:53 2013 +0100

    builder: Add -v option to test so we get all debugging output.

commit a914889b1d467b03eee5f26517c58433e856bbed
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 4 08:26:00 2013 +0100

    tests/nbd: Avoid warning when tests are skipped.
    
    Since END{} clause is always called,  might not be defined if
    we exit early.  Move the whole clause to the top.

commit e9f35e26c5e452bd1c752c339a45c8959d1a8c56
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 4 08:25:14 2013 +0100

    builder: Add test *.xz files to CLEANFILES.

commit 0373f4ce68ce8327fb154606e06bfe197803a89a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 3 21:58:35 2013 +0100

    Version 1.23.24.

commit 967668f7a80d1182729cbad6677c9568bdd608ef
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 3 21:46:35 2013 +0100

    website: Make the rule install builder files to website.

commit a80f0f40b1177ac594ac1f847afefa1ac71b46a1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 3 21:46:27 2013 +0100

    website: Add HTMLSUPPORTFILES to rule.

commit a0d73b7e21dcb382e282cb7ab4efda5cadebb1a7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 3 19:20:28 2013 +0100

    builder: Add Debian 7 template + scripts used to create it.

commit c975d9e53bfb2ea7038ec623747952c583713099
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 3 15:03:10 2013 +0100

    builder: Implement --hostname (set hostname of guest).
    
    This also makes a minor rearrangement so that the random seed, root
    password, hostname setting all happen before package installation.
    This keeps these configuration changes together and means that the
    packages that are installed can act differently based on hostname
    (which is conceivable).

commit 08b7c902284b3acf59a7c3a4687f4407a3af8b83
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 3 14:53:22 2013 +0100

    sysprep: Refactor hostname code into a common library.

commit 7e824a10155de2a8eea884bb142284714d4a1027
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 3 12:55:57 2013 +0100

    builder: Add tests.

commit 9ba6717e944b6a0d3a1a44ce1637e56fe0595409
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 24 14:00:37 2013 +0100

    New tool: virt-builder: For quickly building virtual machine images.
    
    On baremetal you can build and customize a new guest in under 2
    minutes.  For example:
    
    $ virt-builder fedora-19 \
        --root-password password:test \
        --install minicom \
        --firstboot-command 'yum -y update' \
        --firstboot-command 'useradd -m -p "" rjones ; chage -d 0 rjones'
    [     0.0] Downloading: file:///home/rjones/d/libguestfs/builder/website/fedora-19.xz
    [     1.0] Uncompressing: file:///home/rjones/d/libguestfs/builder/website/fedora-19.xz
    [    24.0] Running virt-resize to expand the disk to 4.2G
    [    77.0] Opening the new disk
    [    81.0] Installing packages: minicom
    [    94.0] Installing firstboot command: [001] yum -y update
    [    94.0] Installing firstboot command: [002] useradd -m -p "" rjones ; chage -d 0 rjones
    [    94.0] Finishing off

commit 6203c50479c0c693c3fbdca222d28e98f4e094e5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 2 17:57:08 2013 +0100

    sysprep: Refactor setting random seed code into a common library.
    
    This is just code motion.

commit da1d0da429336c13fa09956c8b12fd2e39c7395f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 1 23:49:54 2013 +0100

    firstboot: Invoke firstboot.sh script with 'start' parameter.
    
    .. else the systemd script does not run.

commit 147b4ee87eca03b8d418984a0b8cfbc67738f65a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 1 23:20:55 2013 +0100

    sysprep: Refactor firstboot code into a common library.

commit ff9bc90e639799caf3dc562a74a7036e9e676ccf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 27 20:30:10 2013 +0100

    resize: Don't add mllib/* sources to 'SOURCES'.
    
    This was a mistake in commit 2a6ce793200e2cc6793a0242ec9ea3f90ad452b8.

commit e8a092ae87ea9d317107b4e091e15f9673b55a76
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 27 14:25:23 2013 +0100

    sysprep: Refactor password handling code into a common library.
    
    Also the crypt binding is moved to mllib because this is a dependency
    of the password library.
    
    This is just code motion.

commit 748ab339696a4b5b32b1f6682fc7998f76cc715c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 27 15:22:08 2013 +0100

    mllib: Rename parse_size to parse_resize.
    
    This is just code motion, but it reduces a source of confusion.

commit 98d56bb10225538bb27bdb9044275f2f7938dfa1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 27 15:20:31 2013 +0100

    mllib: error function has ~prog parameter, instead of assuming virt-resize.
    
      $ virt-sparsify a a
      virt-resize: error: you cannot use the same disk image for input and
      output
      If reporting bugs, run virt-resize with the '-d' option and include the
      complete output.
    
    Note (a) it assumes the program is called "virt-resize" which it
    isn't, and (b) it assumes the program has a debug option -d which it
    doesn't.
    
    This commit changes the error message and adds a -v option to
    virt-resize.

commit e1d7fb406bca9d49488b748e540a8fe1fca19be7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 27 13:57:02 2013 +0100

    resize, sparsify: Small argument parser refactoring.
    
    Factor out a common string.

commit 21e5fc811ea3708ef0c768467ffe53368bc435e9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 3 21:38:18 2013 +0100

    daemon: Don't set LD_PRELOAD for guestfsd children.
    
    Commit c598e14052399f19d36d7874d7133cba779bd3c2 exports
    LD_PRELOAD=/lib64/libSegFault.so so that guestfsd and processes that
    it runs will produce descriptive stack traces.
    
    However if we chroot into /sysroot (ie. CHROOT_IN/CHROOT_OUT) and if
    the libSegFault.so library does not exist inside the chroot (as is the
    case on Debian guests) then we cannot run any processes.  In any case
    we *don't* want to necessarily run this library from the guest.
    
    The proper way to fix this is to confine all chrooting to a
    subprocess, but that's a big change to guestfsd which we'll have to do
    one day.  For now, unset LD_PRELOAD once guestfsd starts up.

commit 8abd0a83b3a94e4adbd0926df818686be982cdb8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 3 18:17:39 2013 +0100

    daemon: Fix xfs_info parser because of new format.
    
    The old parser had several problems: firstly it called the error path
    sometimes without calling reply_with_error causing a protocol hang.
    More seriously it had hard-coded line numbers, and since Fedora 21 the
    output of xfs_info has changed, moving lines around.
    
    Change the parser to be more robust against added fields by using the
    first name on the line as the section name, thus 'bsize=' is
    interpreted differently depending on whether it appears in the "data"
    section or the "naming" section.
    
    Ensure also that we don't call the error path without calling
    reply_with_error, which is a side-effect of the above change.

commit 216cb004aef8ad6cb554ecdb9d7c4eb7634fe678
Author: Cole Robinson <crobinso@redhat.com>
Date:   Thu Oct 3 15:06:03 2013 +0100

    launch: libvirt: Set attribute present=yes to enable kvmclock.

commit 0fbd645cb9bc35748f8cf9b68c11e1ce840aeb1c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 27 17:14:31 2013 +0100

    Version 1.23.23.

commit a2a7ba50516ce7482d013d948039570490a24aeb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 26 22:11:01 2013 +0100

    Update BUGS file.

commit dc0052381e3102231a16f53796f00f9a7977aca8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 26 21:33:04 2013 +0100

    Update PO files.

commit 93dbeb6b6c5ac161043d6d9dd7576f85548a055d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 26 21:30:56 2013 +0100

    tools: Generate a special POTFILES-pl and dump symlink hack in tools directory.

commit e2895b19bb2be67c01172cdd0634553c21923605
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 26 10:47:17 2013 +0100

    appliance: Create /dev/loop-control and similar devices.
    
    When 'mount -o loop' and similar commands are used, the loop module is
    loaded automatically by the kernel when /dev/loop-control is accessed.
    
    /dev/loop-control is created semi-statically by an unholy and
    overcomplex combination of kmod static-nodes and systemd-tmpfiles
    (instead of using, say, just udev or even just a simple series of
    mknod commands).

commit d0ef2ff9b654fb966a294beeab7992d61970c108
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 25 16:00:38 2013 +0100

    appliance: If --enable-valgrind-daemon then increase minimum memory to 768 MB.
    
    tests/c-api would fail from time to time if --enable-valgrind-daemon
    was configured.  There was no obvious memory leak.  It looks as if the
    overhead of valgrind was sufficient to break long-running tests such
    as this one.

commit 2f4f7726e8c81cc56befcb7caa78c01174354d76
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 25 12:20:37 2013 +0100

    launch: libvirt: Use host-passthrough instead of host-model.
    
    <cpu model="host-passthrough"> really passes -cpu host to qemu, which
    is what we want since we don't care about live migration or ABI
    stability.
    
    This should avoid http://bugzilla.redhat.com/870071 .
    
    Note this "taints" the libvirt domain.  We don't particularly care
    about that, and the reason for the tainting doesn't seem to make much
    sense anyway.
    
    This updates commit 6f76fdb41eb6bd124fbc3d084f5c2a3371b37d9b.

commit ae2dd1a9e77b06ae9e7fc8ff47d8b5ea7331e0a9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 24 13:54:08 2013 +0100

    sparsify: Fix incorrect reference to documentation from tool.

commit 48b0d1574969ccf59e30b6f9bfea4e1331f806c4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 24 13:48:47 2013 +0100

    mllib: Ensure that mllib is included in POTFILES-ml.
    
    This updates commit 2a6ce793200e2cc6793a0242ec9ea3f90ad452b8.

commit 09a4f42861177655b74968c1dc3be44f3d9944eb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 24 12:45:19 2013 +0100

    uri: Fix two compiler warnings.
    
    We have to include the right header so that guestfs___free_string_list
    is declared.  Unfortunately that means ensuring -I src is passed to
    the compiler in every tool subdirectory.
    
    Also fix (bogus) compiler warning about incorrect type of the
    parameter to caml_copy_string_array.

commit 2a6ce793200e2cc6793a0242ec9ea3f90ad452b8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 24 12:32:11 2013 +0100

    tools: Move shared OCaml code to mllib/ directory.
    
    Previously a lot of shared code lived in the resize/ directory for no
    particular reason.
    
    This is just code motion.

commit dbbdaebe227222bacc3731ef380f12abf62ba507
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 23 13:50:05 2013 +0100

    resize: Allow the input file to be a URI.
    
    This lets you use nbd as a source for resizing, eg:
    
      virt-resize nbd://example.com outfile

commit 4cdb5bcc5ea211daaab24adda23dbb5e71ba172e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 23 13:49:21 2013 +0100

    sysprep: Fix option quoting in manual page.
    
    This fixes commit b65c1c667b26313abf312a7ab51f8bf947243d07.

commit 5971fb2a70daf739dc73fe7d3525295011625cd9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 12 09:16:31 2013 +0100

    virt-df: parallel: Send debugging messages to stderr.
    
    Not stdout (ordinary program output) since that gets eaten by
    the tests.
    
    This fixes commit 67b9469754684bc0c79fffab7bbca9f6ffee84f0.

commit 54f1492615ab145296548310e8b793a62cacc1f4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 11 14:26:07 2013 +0100

    arm: Drop kernel_irqchip=off hack.
    
    Was only required because of the previous use of vexpress-a9.  With
    vexpress-a15 should no longer be needed.

commit f4b3f84409956df493f4a21b02a655adfef67828
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 11 14:24:54 2013 +0100

    arm: Switch to using Versatile Express A15 machine.
    
    This is the machine which qemu actually emulates these days.

commit 577330d5e538baea467a22861664f7cc264bdcc6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 11 14:42:45 2013 +0100

    Remove incorrect comment.
    
    qemu does in fact fix up the device tree with the correct memory size
    supplied by -m <ramsize> so the comment was incorrect.
    
    This updates commit 8d273a27156813593fe7f6bb657fcf04eb325b59.

commit 8d273a27156813593fe7f6bb657fcf04eb325b59
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 11 14:22:05 2013 +0100

    arm: Pass mem= parameter on Linux command line.
    
    It is thought that qemu-system-arm -m <ramsize> could conflict with
    the actual memory that Linux thinks is available (from the device tree).
    
    Thanks: Marc Zyngier

commit 27cfd77df94d70e0963ddce0976c238d4b0ddc31
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 11 11:57:40 2013 +0100

    arm: Don't bother supplying guest architecture.
    
    libvirt seems to do the right thing without this.

commit c3f8b441fdf48caf29c41a2b0a9034b067460b64
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 11 11:53:18 2013 +0100

    arm: Add notes about machine types.
    
    Thanks: Marc Zyngier from ARM, Andre Przywara from Linaro for
    patiently explaining this to me.

commit 2913c499cf708a6216baf87abc3178b050f388dc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 11 10:52:24 2013 +0100

    launch: Centrally define machine type and DTB wildcard.
    
    This avoids a bit of arch-specific #ifdef.

commit 4d955be4fb9fe304d5ab4222f0e9592f5fc1ef5b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 11 10:44:08 2013 +0100

    Version 1.23.22.

commit ccc9a891df8f8d0af1732bb5bc00b20f39ba24e6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 10 23:31:58 2013 +0100

    docs: Remove misleading / outdated section about other arches from README.

commit aee6fc4863c170d08e572dbdcfcb6f328edfc013
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 10 22:37:18 2013 +0100

    ppc: inspection: Use iconv "UTF-16LE" instead of "UTF-16".
    
    See commit message:
    https://github.com/libguestfs/hivex/commit/8e31fd84cb1c7edcd897ddaaea407774de459b2e

commit bae6d5cc63763fe012c8876408e40d8dec2976e4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 10 11:44:14 2013 +0100

    inspection: Don't print a warning if \Windows\explorer.exe does not exist.
    
    guestfs_case_sensitive_path does not test for file existence.  We have
    to test for it explicitly.
    
    This updates commit 9ea6e9701461e594033999150f930cc4fafec4d2.  See the
    description of that commit for more details.

commit 74938b895c1ad05378a74f0384dfe90cca70471f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 10 10:41:37 2013 +0100

    ppc: Disallow ide interface.
    
    qemu-system-ppc64 lets you add the IDE interface to the appliance, but
    the appliance kernel ignores it (and consequently can't find the
    appliance disk so it all goes wrong).  Best to just disallow this.
    
    Also skip tests that try using iface = 'ide'.

commit aee17de30a5379f5160616805c90299b17fc3823
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 10 10:09:01 2013 +0100

    ppc: Use a larger default memory size on ppc64.
    
    Without this, test-max-disks fails when creating device nodes.

commit 7f90aa099847563114cbcca9893b1f3f8cb4430a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 9 22:54:09 2013 +0100

    ppc: launch: direct: Use -M pseries.

commit 2bf082d908b0b6627ff3bf4b79ec42e883fb08da
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 9 12:23:26 2013 +0100

    arm: launch: direct: Use correct device name for virtio-scsi when detecting.

commit 415d74d0b8cd7d08a655041396e75841d59b90a4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 9 11:58:06 2013 +0100

    tests: Add a regression test that ensure the network can be added.
    
    This was only tested before (implicitly) by the rsync test in
    tests/rsync.  It's better to have an explicit test of this
    functionality.

commit c6dc813420b969cf828ae98e32bf97916a410603
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 9 11:57:20 2013 +0100

    arm: launch: libvirt: Use virtio-net-{pci,device} instead of hard-coding virtio-net-pci.
    
    This is so it works on virtio-mmio platforms such as ARM.

commit f8d89bc42fbd930c61e4f6a81d9a9dc3465f2924
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 9 09:02:59 2013 +0100

    arm: launch: libvirt: Set kernel_irqchip=off for KVM to work around buggy qemu/kernel.

commit 37e1e0da5acb34c902d55cde13c58cf580304bca
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Sep 8 23:23:11 2013 +0100

    arm: launch: libvirt: Force <emulator>.
    
    This is a temporary hack, because otherwise libvirt tries to use
    /usr/bin/qemu-kvm even though this is ARM.

commit 06e43a3359e8139241c69b5cc430b2f4c06f7fd8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Sep 8 23:22:34 2013 +0100

    arm: launch: libvirt: Use vexpress-a9 machine type.

commit cd16380a8337c4da7752774bb99c76b91475a15a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Sep 8 23:21:30 2013 +0100

    arm: launch: libvirt: Don't try setting a cpu model on ARM.
    
    One day we may be able to make this work, but presently libvirt says:
    
      CPU specification not supported by hypervisor

commit bb616a42d2541ae40d484d0c1159519dca43c8c3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Sep 8 23:09:34 2013 +0100

    launch: libvirt: 'is_custom_hv' instead of 'is_custom_qemu'.
    
    Just code motion related to the changed from LIBGUESTFS_QEMU
    to LIBGUESTFS_HV.
    
    This updates commit 78dbd08dd2115efcc488e8fbcaf9705697eb075b.

commit 1cfdb4d9a717988ec2594693068c4a9a01663e87
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Sep 8 20:50:54 2013 +0100

    arm: tests: 9p: Modify name of virtio-9p-pci device when using virtio-mmio.
    
    It's called virtio-9p-device on virtio-mmio.

commit 9d97b86ee8867637815ab75ca85a4a5248e3d919
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Sep 8 16:21:17 2013 +0100

    arm: Error if iface=ide and skip tests that use iface=ide.
    
    ARM doesn't support IDE.  (Well, that's not entirely true as I found a
    reference to one extremely obscure ARM board that had IDE disks, but
    qemu-system-arm doesn't appear to support them).

commit 25cce50a2ba11a9581abfa896785252f2f5e7151
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Sep 8 16:19:24 2013 +0100

    launch: direct: Handle iface=virtio using virtio-blk path.
    
    iface=virtio means use (old) virtio-blk.  Since there's an existing
    path for using virtio-blk, use that instead of adding if=virtio (which
    will fail on ARM).

commit 6e498461f6400c14406319594f3b0577d64cb8a2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 7 08:18:55 2013 -0400

    arm: launch: direct: Add kernel_irqchip=off to make ARM KVM work.
    
    See:
    https://lists.fedoraproject.org/pipermail/arm/2013-September/006758.html

commit af229ebd627b3a76224c15c630d0fbc76694298c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 7 13:06:21 2013 +0100

    Version 1.23.21.

commit 3f9f6235ec0e268a2c8b5472797f9072dcc020bb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 6 13:17:52 2013 -0400

    arm: appliance: Add support for device trees (dtb's).
    
    If supermin-helper >= 4.1.5 is found, use the new-style syntax and if
    the architecture requires it (only ARM for now) implement device
    trees.
    
    This means we pass a supermin-helper --dtb option to find the right
    device tree (currently Versatile Express A9, since that's what we pass
    to qemu in the -M option).  This makes supermin-helper find a
    compatible device tree file.
    
    Also that we pass the corresponding dtb file to qemu via the qemu -dtb
    option, or to libvirt via the <dtb> element.

commit 284fdfe2c54da36d62232e0a8533c1880ee8138a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 6 09:09:34 2013 +0100

    sysprep: Update POTFILES-ml.
    
    This updates commit ea7088b5cab30158149b07bd208e54631b86b8eb.

commit ea7088b5cab30158149b07bd208e54631b86b8eb
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Fri Sep 6 15:52:38 2013 +0800

    sysprep: remove tmp files
    
    This removes tmp files under /tmp and /var/tmp.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 2550971d726820753df9d36700f2dd67dfddee7d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 5 18:41:56 2013 -0400

    launch: direct: Set QEMU_AUDIO_DRV=none to stop qemu opening audio devices.
    
    Libvirt does the same thing, and it definitely has an effect
    on ARM at least.

commit 52cbb0a32351b8a3072defd1cdb4b19cffd65a3b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 5 18:02:33 2013 -0400

    arm: launch: direct: Use virtio-net-device instead of virtio-net-pci on ARM.
    
    This updates commit 92749924112b21e01d7cdbbb4cc07627168a705f.

commit 92749924112b21e01d7cdbbb4cc07627168a705f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 5 14:18:33 2013 -0400

    arm: launch: direct: Use virtio-mmio devices on ARM.
    
    Devices such as virtio-blk are (implicitly) PCI devices.  They don't
    work on ARM.  You have to use the alternate names like
    'virtio-blk-device' instead.

commit b46291a74c985297cc47451eaff0776fa66c55e1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 5 14:14:53 2013 -0400

    arm: launch: direct: Specify a -M (machine type).
    
    Currently this uses the Versatile Express A9 (vexpress-a9) machine
    type, which is not ideal long-term.  However it includes such things
    as virtio-mmio and so virtio things should work.
    
    Note that -M vexpress-a15 does not work with qemu (from git on
    2013-09-05 + Fedora kernel 3.11.0).  There are no boot messages.

commit f3710a43d4187cf6602f3880b7a7ce78898bdc82
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 5 13:50:08 2013 -0400

    arm: launch: direct: Don't use -cpu flag.
    
    We have no idea what the right choice is, so don't choose anything at all.

commit 931182598dae62be5214455bb600f1bc3724bb18
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 5 11:05:26 2013 -0400

    arm: configure: Search correctly for qemu-system-arm binary.

commit a6f2efe9b94f990598965f6614f6b89f24916574
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 5 18:47:00 2013 +0100

    launch: direct: Always use -drive ...,iface=none.
    
    For virtio-scsi, this is the same as always:
    
      -drive ...,iface=none -device scsi-hd
    
    For virtio-blk, this now uses:
    
      -drive ...,iface=none -device virtio-blk

commit 011c9639267f5f1bfac41e664b2c57cc12deabf8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 5 18:45:24 2013 +0100

    launch: direct: Always use cache=unsafe for the appliance.
    
    The code to select writeback was redundant, because current
    qemu always supports cache=unsafe.

commit 30c045797856b67f61ae213716f31a6099879f1f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 5 18:39:46 2013 +0100

    launch: direct: Refactor -drive parameter for virtio-blk/virtio-scsi.
    
    This is a straightforward refactoring of the code for generating
    -drive and/or -device parameters for virtio-blk and virtio-scsi.

commit bbd936d32b9ef8973709a7b80f6f892daf64bfb6
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Thu Sep 5 19:13:22 2013 +0800

    sysprep: remove firewall rules
    
    If we do not want to keep the original firewall rules, enable
    this operation to remove these rules automatically.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>
    
    RWMJ:
    
     - Updated po-file.
    
     - Change documentation to note that it's disabled by default
       and in theory could make the guest exploitable.

commit 475f5ce6a426d026927f31c045bd25160bf7a2f7
Author: Martin Kletzander <mkletzan@redhat.com>
Date:   Wed Sep 4 13:42:40 2013 +0200

    Get rid of gnulib error
    
    Even though this doesn't stop the compile phase, I find it a bit
    distracting that this is what I get with bootstrap:
    
    ../.gnulib/gnulib-tool: *** cannot find ./configure.ac - make sure you
    run gnulib-tool from within your package's directory
    ../.gnulib/gnulib-tool: *** Stop.
    
    Signed-off-by: Martin Kletzander <mkletzan@redhat.com>

commit 012d8ebf02e0de672de3b2bcbf192aa2510e5caa
Author: Martin Kletzander <mkletzan@redhat.com>
Date:   Wed Sep 4 13:42:39 2013 +0200

    Don't redefine _FORTIFY_SOURCE
    
    The macro _FORTIFY_SOURCE might be already defined by environment in
    which case it shouldn't be overriden (might be if it has lower value).
    
    Signed-off-by: Martin Kletzander <mkletzan@redhat.com>

commit efcf474d42ebf65a6307822f6a7d8fe674442210
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Thu Sep 5 14:57:33 2013 +0800

    sysprep: remove log file of ntp
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit c76dabf9eca03284683587e530a09cca99d45681
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Thu Sep 5 14:57:32 2013 +0800

    sysprep: remove log file of gdm
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 1baf716a7e3c5c9632418035b84fec947d9350c1
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Thu Sep 5 14:57:31 2013 +0800

    sysprep: remove log file of sysstat
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit e02c4e519ea1f504b1fe869a5547e75a80ba49e7
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Thu Sep 5 14:57:30 2013 +0800

    sysprep: remove /var/log/audit/audit.log
    
    audit.log is already included in /var/log/audit/*.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 67b9469754684bc0c79fffab7bbca9f6ffee84f0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 3 12:44:25 2013 +0100

    virt-df: parallel: Compile debugging messages in always.
    
    Enable debugging messages whenever LIBGUESTFS_DEBUG=1 / -v option, so
    that we can track down possible race condition seen in Koji.

commit 091eb0780349dade778d1ad3412ffacc7ffec9ec
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 2 19:37:57 2013 +0100

    daemon: augeas: Don't test if AUG_NO_ERR_CLOSE is defined.
    
    It's an enum, not a macro, and in any case it has been present in
    augeas.h since 0.10.0, and the minimum version that libguestfs
    requires is 1.0.0.
    
    This fixes commit 3d132f29204e8c5c77f08841b5288dfe3013f4f0.

commit 3d132f29204e8c5c77f08841b5288dfe3013f4f0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 2 19:19:26 2013 +0100

    daemon: augeas: Enhance error reporting for aug_init failures.
    
    Thanks: Dominic Cleal.

commit e690b737fe27efac4ae47dfcf8066da9c92dca7a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Sep 1 16:36:25 2013 +0100

    Version 1.23.20.

commit 912943034e21f6fd15b3c835a8130ae91ac724df
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Sep 1 11:11:55 2013 +0100

    drives: Don't need to call free_drive_servers since preceding code checks servers == NULL.

commit 3f0748f1fc64e42517c0d4535c27b1f32da86023
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 31 22:48:04 2013 +0100

    rescue: Use cachemode "unsafe" for the virt-rescue --scratch option.

commit f3a9c9f867bed178d1aabf9675955f633bf3069a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 31 22:47:44 2013 +0100

    sparsify: Use cachemode "unsafe" for the overlay disk.

commit 96cd7fcecb031bfe6baa49addfb026ae988fb7c1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 31 22:38:03 2013 +0100

    drives: Ensure all scratch drives use cachemode "unsafe".
    
    They are _scratch_ drives so any data on them doesn't matter and can
    be reconstructed in the event of a host system crash.

commit 749e947bb0103f19feda0f29b6cbbf3cbfa350da
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 31 22:24:40 2013 +0100

    add_drive: Introduce 'cachemode' parameter to control drive caching.
    
    This commit adds an optional 'cachemode' parameter to the 'add_drive'
    API to control caching.  This corresponds approximately to the
    '-drive ...,cache=' parameter in qemu, but the choices are much more
    restrictive, just 'writeback' or 'unsafe', for reasons outlined below.
    
    The caching modes supported by recent QEMU are:
    
      writeback:
       - Reports data writes completed when data is present in the host
         page cache.
         Only safe provided guest correctly issues flush operations.
    
      writethrough:
       - Reports data writes completed only when each write has been
         flushed to disk.  Performance is reported as not good.
    
      none:
       - Uses O_DIRECT (avoids all interaction with host cache), but does
         not ensure every write is flushed to disk.
         Only safe provided guest correctly issues flush operations.
    
      directsync:
       - Uses O_DIRECT (avoids all interaction with host cache), and
         ensures every write has been flushed to disk.
    
      unsafe:
       - No special handling.
    
    Since the libguestfs appliance kernel always issues flush operations
    (eg. for filesystem journalling and for sync) the following modes can
    be ignored: 'directsync', 'writethrough'.
    
    That leaves 'writeback', 'none' and 'unsafe'.  However 'none' is both
    a constant source of pain (RHBZ#994517), is inefficient because it
    doesn't use the host cache, and does not give us any safety guarantees
    over and above 'writeback'.  Therefore we should ignore 'none'.
    
    This leaves 'writeback' (safe) and 'unsafe' (fast, useful for scratch
    disks), which is what we implement in this patch.
    
    Note that the previous behaviour was to use 'none' if possible, else
    to use 'writeback'.  The new behaviour is to use 'writeback' only
    which is (in safety terms) equivalent to 'none', and also faster and
    less painful (RHBZ#994517).
    
    This patch also allows you to specify a cache mode for network drives
    which also previously defaulted to 'writeback'.
    
    There is a considerable performance benefit to using unsafe (for
    scratch disks only, of course).  The C API tests only use scratch
    disks (since they are just tests, the final state of the disk doesn't
    matter), and this decreases total run time from 202 seconds to 163
    seconds, about 25% faster.

commit 6e84861179cc735c8c9ea5215ce2a73ab1989928
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 31 18:26:33 2013 +0100

    sparsify: Test for qcow2 features instead of keying off qemu-img version.
    
    Test whether qcow2 features are possible in qemu-img instead of
    assuming they are by keying off the version.
    
    Also use the 'lazy_refcounts' flag, if available.  It may make writing
    to the overlay file marginally faster (however I tested it and there
    was no measurable difference).

commit 13f3b4a83d6c0abac140d05089ae604bfeef31ef
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 31 18:17:05 2013 +0100

    sparsify: Fix signal handling.
    
    If you don't have a ^C (SIGINT) signal handler at all, then at_exit
    handlers are not called so you end up leaving the large temporary
    overlay file lying around.  That was fixed, incorrectly, by
    commit 7283a5a2765c0670e9dceec70e626a49a30d269c.
    
    However the code now would delete the overlay file in the SIGINT
    handler but otherwise continue running until basically it tries to
    read the overlay file (now deleted) and fails.  So it kind of worked,
    by accident.
    
    Fix this so that the signal handler calls exit, thus ensuring both
    that the exit handler is called (to delete the file) and that the
    program actually exits as soon as possible.
    
    This also refactors the unlink_on_exit function into a utility.

commit 950afbb70584528b5a8b6f8ff9ce3d44c53b6934
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 31 18:13:04 2013 +0100

    daemon: Add comment about how zero_free_space would be better if we could do cancellation.

commit a1f9fb88aedcf141871a5955523ca032b4b6d5b0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 30 13:50:25 2013 +0100

    configure: Fix stupid typo which caused compressed images to always be used.
    
    Libguestfs won't work if you try to use it with supermin < 4.1.4
    because the logic for detecting if compressed images can be used was
    wrong (it was always enabled, instead of disabled for supermin < 4.1.4).

commit 72b0831ffa67383020fa94a6b534bf29af593cff
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 29 21:19:58 2013 +0100

    Rename virt-{cat,edit,filesystems,inspector,ls,rescue}.c to *.c.
    
    This is just renaming of files.

commit 5fd5cf7fdbc6762cb95e946a0f076c23fc640001
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 29 18:32:12 2013 +0100

    Version 1.23.19.

commit 6e9440ced8dcc9b040eb7970017ea3f457e68142
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 29 17:26:59 2013 +0100

    uml: Skip tests/md/test-inspect-fstab-md.sh
    
    Hangs at various places during the test, eg. running mdadm, mounting
    MD filesystem.  Seems to be a bug in UML/MD.

commit 1c8986e45c3f1a7e2391bde2848667332495e3aa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 29 13:59:14 2013 +0100

    mke2fs: Document that too small blockscount will result in ext2 filesystem (RHBZ#1002032).

commit c04fbbda3e1d2bf98e241a95e069ac1fe202c14f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 29 13:49:26 2013 +0100

    rsync: Document use of glob + rsync-out in guestfish (RHBZ#1001876).

commit 1b34d6171bb4aaa1134a9d867918d7163cc7e069
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 29 13:36:56 2013 +0100

    Add a regression test of tar-out excludes option (RHBZ#1001875).

commit 91c162586cc2170ea224016307016153f3d081b5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 29 13:26:51 2013 +0100

    daemon: tar: Use a temporary file to pass excludes to tar command (RHBZ#1001875).
    
    Use tar -X option instead of tar --exclude=... option.

commit a75ca610b80614253f8a9d9828a97dc61d919b8a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 29 11:41:46 2013 +0100

    daemon: Allow labels to be set on DOS filesystems using 'dosfslabel'.
    
    You can now use virt-format or virt-make-fs --label option to set a
    label for a DOS filesystem:
    
    $ ./run ./format/virt-format -a /tmp/test.img --filesystem=vfat --label=BOOT
    $ ./run ./cat/virt-filesystems -a /tmp/test.img --all --long -h
    Name       Type        VFS   Label  MBR  Size  Parent
    /dev/sda1  filesystem  vfat  BOOT   -    1.0G  -
    /dev/sda1  partition   -     -      0b   1.0G  /dev/sda
    /dev/sda   device      -     -      -    1.0G  -
    
    This also contains a small code refactoring.
    
    Thanks: Gerd Hoffmann (kraxel)

commit e17cd73fb7e3d7ce5e28f51c8451033f48a39153
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 29 11:37:06 2013 +0100

    virt-make-fs: Add --label option for setting filesystem label.
    
    $ ./run ./tools/virt-make-fs /tmp/supermin-4.1.4.tar.gz /tmp/test.img
    $ ./run ./cat/virt-filesystems -a /tmp/test.img --all --long -h
    Name      Type        VFS   Label  MBR  Size  Parent
    /dev/sda  filesystem  ext2  -      -    3.7M  -
    /dev/sda  device      -     -      -    3.7M  -
    
    $ ./run ./tools/virt-make-fs /tmp/supermin-4.1.4.tar.gz /tmp/test.img --label=BOOT
    $ ./run ./cat/virt-filesystems -a /tmp/test.img --all --long -h
    Name      Type        VFS   Label  MBR  Size  Parent
    /dev/sda  filesystem  ext2  BOOT   -    3.7M  -
    /dev/sda  device      -     -      -    3.7M  -
    
    Thanks: Gerd Hoffmann (kraxel)

commit c46e41cb3c41f6283e0350cac6ef0b9178ed3941
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 29 11:32:05 2013 +0100

    format: Add --label option for setting filesystem label.
    
    $ ./run ./format/virt-format -a /tmp/test.img --filesystem=ext2 --label=BOOT
    $ ./run ./cat/virt-filesystems -a /tmp/test.img --all --long -h
    Name       Type        VFS   Label  MBR  Size  Parent
    /dev/sda1  filesystem  ext2  BOOT   -    1.0G  -
    /dev/sda1  partition   -     -      83   1.0G  /dev/sda
    /dev/sda   device      -     -      -    1.0G  -
    
    Thanks: Gerd Hoffmann (kraxel)

commit d432ab2b5a965110bab542bfd397785eee9753dd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 29 11:24:00 2013 +0100

    format: Set MBR partition type byte appropriately (RHBZ#1000428).
    
    Windows won't see a filesystem unless the MBR partition type
    byte is set correctly.
    
    $ ./run ./format/virt-format -a /tmp/test.img
    $ ./run ./cat/virt-filesystems -a /tmp/test.img --all --long -h
    Name       Type        VFS      Label  MBR  Size  Parent
    /dev/sda1  filesystem  unknown  -      -    1.0G  -
    /dev/sda1  partition   -        -      83   1.0G  /dev/sda
    /dev/sda   device      -        -      -    1.0G  -
    
    $ ./run ./format/virt-format -a /tmp/test.img --filesystem=ntfs
    $ ./run ./cat/virt-filesystems -a /tmp/test.img --all --long -h
    Name       Type        VFS   Label  MBR  Size  Parent
    /dev/sda1  filesystem  ntfs  -      -    1.0G  -
    /dev/sda1  partition   -     -      07   1.0G  /dev/sda
    /dev/sda   device      -     -      -    1.0G  -
    
    $ ./run ./format/virt-format -a /tmp/test.img --filesystem=vfat
    $ ./run ./cat/virt-filesystems -a /tmp/test.img --all --long -h
    Name       Type        VFS   Label  MBR  Size  Parent
    /dev/sda1  filesystem  vfat  -      -    1.0G  -
    /dev/sda1  partition   -     -      0b   1.0G  /dev/sda
    /dev/sda   device      -     -      -    1.0G  -
    
    $ ./run ./format/virt-format -a /tmp/test.img --lvm --filesystem=vfat
    $ ./run ./cat/virt-filesystems -a /tmp/test.img --all --long -h
    Name        Type        VFS   Label  MBR  Size   Parent
    /dev/VG/LV  filesystem  vfat  -      -    1020M  -
    /dev/VG/LV  lv          -     -      -    1020M  /dev/VG
    /dev/VG     vg          -     -      -    1020M  /dev/sda1
    /dev/sda1   pv          -     -      -    1020M  -
    /dev/sda1   partition   -     -      8e   1.0G   /dev/sda
    /dev/sda    device      -     -      -    1.0G   -
    
    Thanks: Gerd Hoffmann (kraxel)

commit ca4b4089689c0c908ee56a8021d65a79d39d803e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 28 22:35:42 2013 +0100

    appliance: Use gzip-compressed cpio files if supermin-helper supports it.
    
    supermin-helper >= 4.1.4 has new support for compressed cpio files
    (not hostfiles).  Detect if this is supported, and use it.

commit 532117de297ecedb121f20fdc122ad83482e9b48
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 28 18:45:14 2013 +0100

    javadoc: Install javadoc in $(datadir)/javadoc/libguestfs (without -java-$(version)).
    
    Apparently this is the normal place for javadoc, and not
    where we installed it before.

commit b1919066ca3d83f11b72d38d64f25739bd0ff67e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 22 19:48:05 2013 +0100

    Initialize CLEANUP_* stack variables with NULL in various places.
    
    Code like:
    
      CLEANUP_FREE char *buf;
      /* some code which might return early */
      buf = malloc (10);
    
    is a potential bug because the free (*buf) might be called when buf is
    an uninitialized pointer.  Initialize buf = NULL to avoid this.
    
    Several of these are bugs, most are not bugs (because there is no
    early return statement before the variable gets initialized).
    
    However the compiler can elide the initialization, and even if it does
    not the performance "penalty" is miniscule, and correctness is better.

commit fc2947b1125aa34b5f04efd2d39cb82b2ebba586
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 22 19:38:54 2013 +0100

    daemon: sh: Fix missing initializer which caused segfault (RHBZ#1000121).
    
    Thanks: Olaf Hering.

commit 4fdf05e19903442aff65993c124a062c82b54e1c
Author: Olaf Hering <olaf@aepfle.de>
Date:   Tue Aug 20 16:33:01 2013 +0200

    lib: avoid pragma usage in journal.c
    
    journal.c: In function 'guestfs__journal_get':
    journal.c:120:9: error: #pragma GCC diagnostic not allowed inside functions
    journal.c:121:9: error: #pragma GCC diagnostic not allowed inside functions
    journal.c:123:9: error: #pragma GCC diagnostic not allowed inside functions
    make[3]: *** [libguestfs_la-journal.lo] Error 1
    
    Signed-off-by: Olaf Hering <olaf@aepfle.de>

commit d188594b11f2a16fe72b963a55edf41d4aa2e3aa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 20 18:28:25 2013 +0100

    daemon: hivex: Define empty hivex_finalize function in case !HAVE_HIVEX.
    
    Thanks: Olaf Hering (see previous commit).

commit 8590ec9b56fe491c97ea4a8b9df37b044dd92e59
Author: Olaf Hering <olaf@aepfle.de>
Date:   Tue Aug 20 15:48:51 2013 +0200

    daemon: fix build without systemd-journal
    
    Fix typo in OPTGROUP_JOURNAL_NOT_AVAILABLE
    Define empty journal_finalize, called by mount.c
    
    Signed-off-by: Olaf Hering <olaf@aepfle.de>

commit c2232321b6bcc403e8870b98cdcb0677009c71a4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 20 11:42:18 2013 +0100

    daemon: Document guestfs_verbose=1 and guestfs_channel=<PATH> in man page.

commit cb7b1c56b7cf447dd9f2ea4dde5cf65e9f9f8cf8
Author: Olaf Hering <olaf@aepfle.de>
Date:   Mon Aug 19 19:28:18 2013 +0200

    tests: change noinst to check
    
    This change avoids the hard requirement for qemu-tools during package
    build.
    
    Signed-off-by: Olaf Hering <olaf@aepfle.de>

commit d408931bba8be101613fb6d293be42fd577a1bdd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 19 15:46:20 2013 +0100

    Version 1.23.18.

commit 835e11c892c191d81716643ed738501c7852d0e9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 19 15:45:35 2013 +0100

    uml: Remove unused function is_numeric.
    
    This fixes commit b607f8628876f4779921047ad29aa9a623e3bde2.

commit 7e396954611d827dc236a114ed22a781687c002d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 19 14:17:55 2013 +0100

    fish: Document that guestfish --remote --add won't work as expected (RHBZ#998513).

commit a843b5e5e32c151e7b0c74bb4f7be1030f9ac85b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 19 13:50:29 2013 +0100

    launch: direct: Don't try to wait for qemu if parent process forked (RHBZ#998482).
    
    When using guestfish --remote, libguestfs is not the parent of qemu,
    so waitpid is expected to return -ECHILD.  And indeed guestfish --remote
    would print a bogus error message in this case:
    
      libguestfs: error: waitpid (qemu): No child processes
    
    If the parent process forked into the background, then it should have
    called 'set_recovery_proc 0' so we can use this to determine if we
    need to wait for qemu.
    
    Thanks: Kazuya Saito for reporting and identifying the issue.

commit b607f8628876f4779921047ad29aa9a623e3bde2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 19 10:34:39 2013 +0100

    uml: Remove kill_vmlinux subprocess, problem fixed upstream.
    
    Note you need to apply these patches to the Linux kernel to get
    User-Mode Linux to work with libguestfs:
    
    http://marc.info/?l=user-mode-linux-devel&m=137682544009451&w=2
    http://marc.info/?l=user-mode-linux-devel&m=137682543809449&w=2
    http://marc.info/?l=user-mode-linux-devel&m=137682544209452&w=2
    http://marc.info/?l=user-mode-linux-devel&m=137682543809448&w=2

commit 7cdd96323ce52c3d74d1fa2a535bb5b2d5529983
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 19 10:31:27 2013 +0100

    uml: Exit status 1 is a normal exit code for vmlinux subprocess.
    
    Note you need to apply these patches to the Linux kernel
    to get User-Mode Linux to work with libguestfs:
    
    http://marc.info/?l=user-mode-linux-devel&m=137682544009451&w=2
    http://marc.info/?l=user-mode-linux-devel&m=137682543809449&w=2
    http://marc.info/?l=user-mode-linux-devel&m=137682544209452&w=2
    http://marc.info/?l=user-mode-linux-devel&m=137682543809448&w=2

commit 18b40a88925df737d3552fa646d35a185feb6c62
Author: Or Goshen <oberonc@gmail.com>
Date:   Mon Aug 19 10:08:34 2013 +0100

    Fix to src/proto.c in libguestfs so it will compile with portablexdr under mingw.

commit f33343a5c16baeab6ffc45f36e0dadd7c956f402
Author: Nikita Menkovich <n.menkovich@sprinthost.ru>
Date:   Fri Aug 16 17:14:28 2013 +0100

    sysprep: added --mount-options option to mount selected partitions with options.

commit abc59d776a12fb96de6ff927054f3db2a9ed4fc4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 16 13:35:12 2013 +0100

    FAQ: Replace the debugging section (again) with a checklist of information we need to start to fix bugs.

commit 0a484e868f5f0b7f6245a80f67e09c8210721dac
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 16 13:24:19 2013 +0100

    FAQ: Move #debug anchor back to the right place.
    
    This was accidentally moved by this commit:
    
      commit b8b5ed65c26dd19a0bc9f8282a50c6dff90c456a
      Author: Richard W.M. Jones <rjones@redhat.com>
      Date:   Wed May 23 11:46:23 2012 +0100
    
        FAQ: Add section about using libguestfs in closed source programs.

commit 937a9a35320edb781721de5537d750c004872c98
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 16 12:00:06 2013 +0100

    FAQ: Delete section about Ubuntu 10.04.
    
    The link was broken, and we don't support Ubuntu 10.04 (maybe the
    'oldlinux' branch does).

commit f68d5ee16c88df4a3fe2233ba948fb4780fa2a09
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 16 09:13:59 2013 +0100

    cleanups: Use correct types for some cleanup functions.

commit bcd7e6d879fae159a1214552e5ea377dc38600c0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 15 22:30:21 2013 +0100

    uml: Add uml_mkcow requirement to README.
    
    This fixes commit 858d6e7176d7b18bc29c8503bbc2887a3b74a272.

commit 0875592763de96c0173abc021bd1328a59fcc860
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 15 16:57:04 2013 +0100

    launch: Create the direct & uml command lines safely.
    
    Refactor the direct & uml backends to safely create the qemu & vmlinux
    command lines.
    
    Don't do malloc-after-fork, which is not safe.  Do all the allocation
    in the main process before the fork.
    
    Use stringsbuf to simplify the code.

commit 0f26218905816ca86b6ec57070eed802515f4853
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 15 13:52:13 2013 +0100

    Refactor backends so they are modular.
    
    Instead of hard-coding the list of backends into the core of
    libguestfs in many places, make each backend into a true module which
    registers itself with the core when the library is loaded.
    
    This is a step towards making backends into loadable modules, but it
    doesn't actually do that.
    
    This is just code motion.

commit 9b720899fc971e47a066d8d8720d30c58b193d23
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 15 12:34:47 2013 +0100

    launch: libvirt: Move internal_set_libvirt_selinux_* APIs to common launch code.
    
    This is just code motion, but means the libvirt backend no longer has
    to export those two internal APIs.

commit d2ae632d3bc0a4fcdbf4150a33406d7646f8cdf9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 15 21:59:48 2013 +0100

    lib: Use stringsbuf at various places in the library to simplify the code.
    
    This is just code refactoring.

commit 35278e4c186badb9e243628771da4cbd068ffaa0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 15 22:01:36 2013 +0100

    lib: Add stringsbuf mini-library for constructing lists of strings.
    
    This is modelled on similar code in the daemon that we have used
    successfully for a long time.

commit f1d2934216d3fca0501946c8ae0e5c7cd370e6b6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 15 21:48:50 2013 +0100

    list-filesystems: Don't fail if there are no filesystems found (RHBZ#995711).
    
    list-filesystems was returning NULL (but not setting an error) if no
    filesystems were found.  Instead return an empty list.

commit d0a205778698ea3b70623ad73302e739cf631d3c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 15 18:43:08 2013 +0100

    cmd: Better type checking in CLEANUP_CMD_CLOSE macro.

commit 00cbb5c1854a52a5b4742aa7ca9601a9aaaab529
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 15 11:33:55 2013 +0100

    utils: Move guestfs___drive_name function to the utilities library.
    
    For some historical reason, it was stuck in src/launch-direct.c and
    the comment referred to launch-appliance.c!

commit bd30d3a61ce9d14f2f744870a5d4ed8167d609e2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 15 09:12:44 2013 +0100

    podwrapper: guestunmount is a libguestfs page, don't link it to he.net.

commit d63325f6a1489c12e949ed2def271aea5d490750
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 14 23:30:30 2013 +0100

    Version 1.23.17.

commit b1a8733511836591bcf8931f25f0fb5cec7924ff
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 14 23:28:11 2013 +0100

    Remove contrib file from EXTRA_DIST.
    
    This fixes commit 36d29700dcef01d681d41f0b593a16e7814e3ee1.

commit 55ee0329c5cd73797a35ae3a66b38445e35b43a2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 14 17:40:24 2013 +0100

    guestfs-performance: Add a section on the performance of UML.

commit 78dbd08dd2115efcc488e8fbcaf9705697eb075b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 13 22:28:28 2013 +0100

    Rename 'qemu' as 'hv', 'LIBGUESTFS_QEMU' as 'LIBGUESTFS_HV'.

commit 46763bcc0b9d04ada367f29ca07bd3e11e264a8e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 14 15:25:17 2013 +0100

    launch: libvirt: Don't enable <cpu mode="host-model"> on TCG.
    
    It's fairly pointless to do this with TCG, since all we would be doing
    is emulating a more complicated processor slowly.  Also it may be the
    cause of subtle problems we see during testing.
    
    This updates commit 6f76fdb41eb6bd124fbc3d084f5c2a3371b37d9b.

commit c53b459fdd7fc340f48a76496b7e7e18256a2d64
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 14 15:08:04 2013 +0100

    launch: direct: Don't use -cpu host on TCG.
    
    qemu -cpu \? documents this as:
    
    host  KVM processor with all supported host features (only available in KVM mode)
    
    And indeed if you try it with TCG you'll get this error:
    
    Unable to find CPU definition: host
    
    This fixes commit 038ed0a08eaed33e62a27c9f91780a25de0bc08c.

commit 08f605c0732e9a9131f7d0975ec3daf5461ad54f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 14 12:52:48 2013 +0100

    tests: Add a test that console log messages make it up to events.
    
    In Rawhide, the console was briefly broken although it "fixed itself"
    when libvirtd was restarted.

commit 36d29700dcef01d681d41f0b593a16e7814e3ee1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 13 21:45:29 2013 +0100

    Remove contrib/guestfsd-in-wine.sh.
    
    Added in 2009, unlikely it still works since I doubt it has been
    compiled since then.

commit 4a873ee96671c20d4b124703275190d43ac5a08c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 13 21:31:12 2013 +0100

    uml: Change (temporary) path to UML binary.

commit 0a9f1fe8d66cb28ef08726b9feaa3acb66645161
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 13 15:46:02 2013 +0100

    Version 1.23.16.

commit 5094b421974b042386716ec25d96b5804f9d114b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 12 22:47:25 2013 +0100

    uml: Add check-uml and check-valgrind-uml to release tests.

commit 23ad2c607112e43fc4acec40b77d913709f039aa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 12 16:19:28 2013 +0100

    uml: tests: Add 'make check-uml' and 'make check-valgrind-uml' rules.
    
    These run the test suite using User-Mode Linux.  Currently you have to
    set LIBGUESTFS_QEMU to point to the vmlinux binary, but perhaps we
    can solve that in future.

commit b922f6521ea4448194f5f9fd6dc924d98b3d1890
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 13 13:50:36 2013 +0100

    uml: virt-make-fs: Modify test so it doesn't use qcow2 under UML.
    
    Modify the test so it doesn't try to test qcow2 format when the
    backend is User-Mode Linux which doesn't support qcow2.

commit 003e854b984c03a675e629499ab40b28d3af2ee7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 13 13:49:42 2013 +0100

    uml: sparsify: Skip test since it needs qcow2.

commit 2d758d548bc6d6e86eabb0214a5ff79787d94be1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 13 13:49:31 2013 +0100

    uml: resize: Skip test since it needs qcow2.

commit ca5ecf2e761bde4c813b1f2c0b3a7d337655f1bf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 13 13:49:16 2013 +0100

    uml: fuse: Skip test since it needs qcow2.

commit 574a7ad04c797cea72639259a3a381c4fa7fc4ba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 12 22:50:19 2013 +0100

    uml: tests: edit: Skip test since it needs qcow2.

commit d25732f85262d9fe74937c99a6fe123ac59e298a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 12 22:21:38 2013 +0100

    uml: tests/qemu: Fix tests so they work without support for qcow2.

commit 1d20770d4120f45f8f591e356ee7cc0b109a7fbc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 12 22:06:10 2013 +0100

    uml: tests/md: Skip test-inspect-fstab.sh since it needs qcow2.

commit e9d2508694b466d580b18885fd9bcc6c2365d756
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 12 21:57:00 2013 +0100

    uml: tests/md: Fix test to cope with /dev/ubd* device names.

commit 73e959e1ee5eef1a47b7c261932afcc7adc82a7d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 12 16:56:47 2013 +0100

    uml: tests/luks: Fix assumption that broke /dev/ubd* device names.

commit 9c3d1efcaac1be87fb89142a6046650a373b30d2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 12 16:43:50 2013 +0100

    uml: tests/lvm: Fix assumption that broke /dev/ubd* device names.

commit f622d854a75c6a86b0061b364ec2486330c976bc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 12 16:40:57 2013 +0100

    uml: tests/mountable: Skip tests that need qcow2.

commit 4d64dbfe48ed19f837f8d86fb2cf026adcc9c6d1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 12 16:34:27 2013 +0100

    uml: tests/disks: Fix test so it can cope with /dev/ubd* device names.

commit 8d5a0d77fbed365211ec0e52dd848c7c1b93d950
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 12 16:19:11 2013 +0100

    uml: tests: Skip some tests which cannot work with the UML backend.

commit 4c66cbc3beee3132a01d5861e9c9465e0b997158
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 12 21:23:44 2013 +0100

    uml: Fix race when multiple handles are used in parallel.
    
    See comment for explanation.

commit 3e4d55a6f98aee0490c8dc6c5c4eb8d08e524afc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 12 16:31:24 2013 +0100

    uml: Fix maximum number of disks.

commit ed3c98434f5942e30af48f50e5b7ccf223e0eea6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 12 18:44:41 2013 +0100

    uml: Fix guestfs_canonical_device_name API to understand /dev/ubd* paths.

commit 42754046269806a6b6385fee0b72115c73461221
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 13 13:50:43 2013 +0100

    virt-list-filesystems: Fix to use $g->canonical_device_name instead of homebrew function.
    
    The homebrew function didn't recognize /dev/ubd* device names, and in
    any case using the API function is shorter and clearer.

commit 90cafed4c2dab142a5c76a6ee879de27d48d8dc9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 12 21:49:55 2013 +0100

    daemon: list-md-devices: Check if a /dev/md<X> device is valid before returning it.
    
    For reasons not fully understood, if md is linked into the kernel (and
    not a module), a /dev/md0 device node is created.  However this is not
    a real RAID device.  For example running mdadm --detail /dev/md0 will
    fail on it.
    
    Check the /dev/md<X> devices are real RAID devices before returning
    them from the list-md-devices API.

commit 52188f1ea308225ab948141b1f23e0b47f7dcf4f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 12 21:28:58 2013 +0100

    daemon: md: Whitespace fixes.

commit 8ad634877cf315288497a8580fb4afc7658deae9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 12 19:25:11 2013 +0100

    daemon: If /proc/modules doesn't exist, linuxmodules optgroup is disabled.
    
    It likely means the kernel was compiled without modules support.

commit 071d7fb6d703a1184af93ff2e9ee1812606bd16e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 12 19:24:35 2013 +0100

    tests/regressions: Allow regression test for bug 914931 to be skipped.

commit 42abbf096932bd1e6c9c1bef64f602a67107d088
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 12 17:48:08 2013 +0100

    tests/md: Fix error path to display the correct output.

commit 4cc99ea2e99c90263aaeeefc8ed952596865abfc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 12 16:00:59 2013 +0100

    docs: The old make check-with-appliance/etc rules were renamed.
    
    This fixes commit 68990840b64491b39ab8da5f1e46367ae5f01594.

commit 8b43767b7cbf029c6e4c3974958d00f188c50aa0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 12 13:42:26 2013 +0100

    tests: c-api: Fix device name comparison when using User-Mode Linux.
    
    This updates commit 858d6e7176d7b18bc29c8503bbc2887a3b74a272.

commit ab797f7e47133635012d8cde04b0176cb783c41e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 12 13:41:53 2013 +0100

    docs: Clearer documentation for User-Mode Linux.
    
    This updates commit 858d6e7176d7b18bc29c8503bbc2887a3b74a272.

commit 19ee64303e65766b4a1b1ac55adbbb646a1c3500
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 12 13:41:24 2013 +0100

    launch: direct: Print \n after printing qemu command line.
    
    This makes it easier to see error messages printed by qemu.

commit e037f0d26b79df4a1df3c77adb5bba326bfd92d3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 12 13:40:24 2013 +0100

    daemon: compare_device_names: Fix typo in this function.
    
    This would have broken the function if we were comparing mixed
    /dev/sda and /dev/ubda (ie different length) strings.  Which we never
    normally do, luckily.

commit c09a2b5faf81cb97f4e3b88dd5c19607ff2265dc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Aug 11 23:06:37 2013 +0100

    Version 1.23.15.

commit 29d86583112bde951e7ba5a13a4c10b792fd831b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Aug 11 23:37:17 2013 +0100

    daemon: Ensure CLEANUP_FREE* variables are initialized with NULL.
    
    Otherwise an early exit from the function will cause an uninitialized
    pointer to be freed.
    
    This fixes commit 1d7c3a27822717398415940bde1d4476441e9c1a.

commit 858d6e7176d7b18bc29c8503bbc2887a3b74a272
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 9 22:46:39 2013 +0100

    Add experimental User-Mode Linux backend.

commit 9a6cc3c92796b730bba354eceadbb62d8ab1b7b9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 10 12:41:03 2013 +0100

    daemon: Recognize /dev/ubd[a-] as a valid device name.

commit f55a1a1fe78d2ba926e4c93ec3cfe9e40c3f7951
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 9 22:45:37 2013 +0100

    daemon: Allow guestfs_channel to override the virtio-serial channel.
    
    Also if /dev/ttyS* is specified, make sure the serial port is set to
    raw mode.

commit 236415e33939803565ae88a9222d3bae56ea16f9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 9 16:08:26 2013 +0100

    conn: Make sure we display all log messages when qemu goes away.
    
    If qemu goes away it is (more in theory than in reality) possible for
    log messages to be lost in the kernel's socket buffer.
    
    This turns out to matter more for User-Mode Linux.

commit 3620ca13398d007945906f620f934e627097411f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 9 16:09:39 2013 +0100

    appliance/init: Allow guestfs_noreboot=1 flag to avoid reboot at end of /init script.

commit e5285cc4210683887a5a4a853fe4e6a72c23e74d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Aug 11 19:45:12 2013 +0100

    lib: Turn 'random_chars' function used by libvirt backend into utility function.

commit 467fd96e7e7537a5aa706dd5ca2edb513aa833e9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Aug 11 19:47:44 2013 +0100

    utils: Remove duplicate inclusion of <string.h>.

commit 2089f7a21a307402c3efa43e5d10ee8d5ff554fb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 10 12:39:40 2013 +0100

    daemon: ldm: Don't return an error if /dev/mapper doesn't exist.

commit 1d7c3a27822717398415940bde1d4476441e9c1a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 10 16:35:30 2013 +0100

    daemon: Device name translation now allocates a new string.
    
    Previously device name translation worked on the string in-place.
    
    This worked fine because the device strings always come from XDR where
    they are dynamically allocated.  However it wouldn't work if the
    translated name had to be longer than the original, specifically for
    /dev/sd -> /dev/ubd (for User Mode Linux).
    
    Therefore this commit changes the generator so that
    device_name_translation and parse_btrfsvol (which depends on it)
    allocate the new device name instead of overwriting it.

commit 89cf1c1163f5c01f2335b7c030bb884be3310394
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 10 13:34:58 2013 +0100

    daemon: Move all RESOLVE macros to daemon/stubs.c.
    
    These macros are pretty horrible to use, with unexpected side-effects.
    Move them exclusively into the generated code and rewrite the one
    place in the general C code which used them.
    
    There's no functional change in this code.

commit d9694362059e869da67c1333d62adb66f7d0aa1e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 10 16:47:46 2013 +0100

    tests/mountable: Better error messages.
    
    Better error messages (for diagnosis) when this test fails.  Also this
    fixes the line endings which were broken before.

commit 94872348e852a9bdfa4d170b0f238d796789c73a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Aug 11 17:36:55 2013 +0100

    Fix --enable-valgrind-daemon so it doesn't break valgrind of the library.
    
    Using ./configure --enable-valgrind-daemon breaks valgrinding of the
    library because guestfs_close wouldn't call guestfs_shutdown in that
    case, resulting in some resources owned by the backend being leaked.
    
    After this commit, --enable-valgrind-daemon will shut down the handle
    normally.
    
    This updates commit 55e3b8711f340a2f8bdb8ee8ff99deb40b4e9108.

commit e7b06f7cf84d0a87d0c80d56b06e7e0017e55adc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Aug 11 12:07:38 2013 +0100

    Print an error message if valgrind failure is detected in the daemon.
    
    This updates commit 55e3b8711f340a2f8bdb8ee8ff99deb40b4e9108.

commit 7367729ec7a5d016878dd00b32cce45cec372931
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 10 23:02:42 2013 +0100

    daemon: Remove unnecessary sysroot_path (selinux).
    
    This fixes commit 72afcf450a78b7e58f65b4a7aaf94d71cd25fca5.

commit 55e3b8711f340a2f8bdb8ee8ff99deb40b4e9108
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 10 21:51:27 2013 +0100

    Fix --enable-valgrind-daemon option.
    
    Don't add the "valgrind channel" to the appliance.
    
    Just dump out the valgrind.log to stderr while the daemon is running.
    
    Ensure that if valgrind tests fail in the appliance, that we don't
    exit with success in the library by checking for a canary message in
    the verbose daemon logs.
    
    This allows the option to be used routinely by developers.

commit 26309a1c3a4a8ae4c79cc72ed83dfea4bde5c1a0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 9 22:33:52 2013 +0100

    proto: Fix --enable-packet-dump mode.
    
    This was broken when we rearranged the socket code.

commit 6c2fad11ac9a68dcfd42ee18681dc9a552625be9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 9 17:33:02 2013 +0100

    appliance/init: Display uname -a in debug output.
    
    Useful for debugging kernel / architecture issues.  Note this
    has no effect if debugging is disabled.

commit ce6e5738fc4ca9533e73cfe6b5fe3db872b7ec9d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 7 14:54:10 2013 +0100

    daemon: Close augeas, hivex, journal handles in unmount_all.
    
    This is also called implicitly from internal_autosync, ensuring that
    exit won't fail because of an open handle.
    
    libguestfs: error: internal_autosync: umount: /sysroot: umount: /sysroot: target is busy.
            (In some cases useful info about processes that use
             the device is found by lsof(8) or fuser(1))

commit 7c535c501b1ce131ae98dd948b22fc260d659d1b
Author: Paul Mackerras <paulus@samba.org>
Date:   Wed Aug 7 13:56:26 2013 +1000

    Fix parsing of boot flag in do_part_get_bootable()
    
    The code in do_part_get_bootable() assumes that if a partition has the
    bootable flag set, then that is the only flag.  It compares the entire
    flags field with the string "boot".  However, the boot flag isn't
    always the only flag.  For instance, POWER systems typically have a
    bootable partition of type 0x41 (PPC PReP boot), which parted -m
    displays as:
    
    # parted -m -- f18.img unit b print
    BYT;
    /root/f18.img:16106127360B:file:512:512:msdos::;
    1:1048576B:5242879B:4194304B:::boot, prep;
    
    That is, the flags field contains "boot, prep", and thus libguestfs
    fails to see that this partition is bootable.  Ultimately this causes
    virt-resize to fail to set the bootable flag on the boot partition of
    the destination image, resulting in an image that won't boot.
    
    This patch fixes the problem by searching for the string "boot" within
    the flags field, instead of comparing the whole flags field.

commit 5b278937dfd5177eaafcbc41830450ef5c0a2ab8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 6 18:20:44 2013 +0100

    sparsify: Advertize in --machine-readable that we support --check-tmpdir option.
    
    This lets programs add the --check-tmpdir=[ignore|continue|fail]
    option to avoid interactivity.
    
    This fixes commit 7c463ac477168df5d4e4eb472ba01fa18b89c1a6.

commit 12b740fbe00d40f57c7faa4744726b33d73082c5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 6 16:29:02 2013 +0100

    Version 1.23.14.

commit 1ef79b7f1f914e33abc2bec41e640a75e64d2f89
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 6 14:43:56 2013 +0100

    Pull latest translations from Transifex.

commit 56f613b13003b2ef44b25da360c5dac6eb5b0c71
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 6 14:34:48 2013 +0100

    Update Transifex domain name from .net -> .com.

commit 3197a2687c0b1d9ba5b9b3d32b5f0200e630628f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 6 14:31:48 2013 +0100

    Update gnulib to latest version.

commit 7c463ac477168df5d4e4eb472ba01fa18b89c1a6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 6 13:18:54 2013 +0100

    sparsify: Get free space on TMPDIR and give a warning if we estimate it is too little.

commit f6b2efcdffe8688fc415b3f1cd9d608dd396f253
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 6 12:20:31 2013 +0100

    Update TODO file.

commit c4a3e8112ae7a022973f8658818f4672ed0565cb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 6 11:41:34 2013 +0100

    New APIs: aug-setm and aug-label.
    
    Bindings for the aug_setm and aug_label APIs in Augeas.

commit f26a0407d2a61ed334b4a9d42b1269feb3cab76e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 6 11:41:08 2013 +0100

    augeas: Improve error reporting.
    
    Display all the information from the handle about errors.

commit a709b10bb6f6e5cad81b9333ac7f15458f2e1ce5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 5 16:50:15 2013 +0100

    launch: libvirt: Enable kvmclock.
    
    This enables stable guest clocks.

commit 6f76fdb41eb6bd124fbc3d084f5c2a3371b37d9b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 5 16:42:43 2013 +0100

    launch: libvirt: Enable <cpu mode=host-model>.
    
    This may still cause problems on some CPUs because of a bug
    in libvirt.  See:
    https://bugzilla.redhat.com/show_bug.cgi?id=870071

commit 038ed0a08eaed33e62a27c9f91780a25de0bc08c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 5 16:35:47 2013 +0100

    launch: direct: Specify -cpu host,+kvmclock.
    
    '-cpu host' makes the CPU look like the host CPU.  This is useful
    because it means the appliance can use all the host CPU's features,
    eg. for fast checksumming or MD XORing.
    
    'kvmclock' is the paravirtualized clock for qemu/KVM.  It's much more
    stable than relying on tsc or a virtualized device such as HPET, and
    clock instability is one of the problems we have encountered when
    running libguestfs on a heavily loaded machine, especially in a nested VM.
    
    Note that we require qemu >= 1.2 (and have for a while) which has long
    supported both of these options.

commit 568368cdf524d3ef96fb3905e39cc859c4bb4258
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 5 16:35:15 2013 +0100

    launch: direct: Add drives after machine parameters.
    
    This is just code motion.  It should affect the semantics of the code,
    nor how the appliance VM is created.

commit 8d68f1c5ceb5ac613393654bde58127e50c0f7bf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 5 15:41:39 2013 +0100

    ./run: Omit timeout -k option on RHEL 6.
    
    If timeout doesn't have the -k option, don't use it.

commit 82a656341432ba61d00b38ff4e5413388286fd03
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 3 12:45:55 2013 +0100

    Version 1.23.13.

commit 93f8baeb9a07cbbf9bdaa5d10c98c1c9d6af96f7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 3 10:42:21 2013 +0100

    sysprep: Add "notes" field for notes on shortcomings, bugs, etc.
    
    Instead of keeping this information as comments in the source, put it
    into the virt-sysprep(1) man page.

commit 4cdbae926bb336c8d0dea8e7b6e0dcc3fb219c2d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 3 10:12:42 2013 +0100

    sysprep: Various code refactorings of the operations.
    
     - Use 'op' instead of 'xxx_op' for operation table.
     - Add a 'defaults' for the operation table and remove any default
       values.
    
    This is just code motion and there is no functional change.

commit 67fd809ca3ec711d80e69ab32646899e7ca047eb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 3 10:03:49 2013 +0100

    resize: Mark progress bar functions as "noalloc".
    
    Avoids GC overhead and turns these into simple C calls.  See:
    http://camltastic.blogspot.co.uk/2008/08/tip-calling-c-functions-directly-with.html

commit 3d39549ded3e05df929547bb65ce620e6487a81b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 3 10:01:34 2013 +0100

    resize: Mark isatty function as "noalloc".
    
    This turns it into an ordinary C call without the unnecessary [in this
    case] GC frame overhead.  See:
    http://camltastic.blogspot.co.uk/2008/08/tip-calling-c-functions-directly-with.html

commit 0c512a52bdc2a88296d04900625822b34d567112
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 3 09:20:41 2013 +0100

    FAQ: Tips about using direct backend and fixed appliance on Fedora/RHEL.

commit 9268f1487970eb9884ba674ab75dc99f91adc0a7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 3 09:19:57 2013 +0100

    FAQ: Common problem with Debian is not running update-guestfs-appliance.

commit 44df867382bf642689301c50d0cbb63bb354b987
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 2 15:00:04 2013 +0100

    sysprep: Allow root and non-root passwords to be set.
    
    This adds a virt-sysprep 'password' operation which adds the
    following command line options:
    
      --root-password     Set the guest's root password.
      --password          Set any guest password.

commit 5deea7fce675edb6803cd83a699b80e8ea383488
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 2 15:16:10 2013 +0100

    sysprep: Disable fs-uuids operation by default.
    
    Disable this operation because it is more likely than not to break
    Linux guests.
    
    To fix this properly will involve finding all the places in the guest
    where the UUIDs are used to locate and mount filesystems,
    eg. /etc/fstab and possibly initramfs.
    
    This updates commit 8965368eb89532ac1613fffb0a3a661f005bae81.

commit a89675ee5cf7b1ba255c185ad88487997b935a6d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 31 20:43:43 2013 +0100

    journal: Fix incorrect printf format specifier for 32-bit.
    
    journal.c: In function 'do_journal_skip':
    journal.c:134:5: error: format '%zd' expects argument of type 'signed size_t', but argument 3 has type 'int64_t' [-Werror=format=]
         reply_with_perror_errno (-r, "failed to skip %zd journal entries", skip);
         ^
    
    This fixes commit 5cb7f294f6a5a8b4a68e940c30ca9af0fe0741d5.

commit 6a46bd9a8622050b1b603b15933a068fba4a56a8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 31 20:42:06 2013 +0100

    arm: Avoid cast-align warning.
    
    Note the 64-bit int field really isn't aligned.  We hope that the ARM
    kernel this is running on will do the appropriate fix ups.

commit 94e5ea6b5ef0d4e4f2d30b51cb5dcce175819456
Author: Nicholas Strugnell <nstrug@redhat.com>
Date:   Wed Jul 31 16:24:20 2013 +0100

    sysprep: rhn_systemid: delete osad-auth.conf file in RHN configuration

commit a1e8acc736bbeb5f0703586a3b8781422fd2e2dd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 30 18:16:30 2013 +0100

    Version 1.23.12.

commit 65b4ab11e188ac94a025e1a86a43b84fac64a9e0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 30 16:16:55 2013 +0100

    tests: fish: Add valgrind testing to various existing tests.
    
    This involves running ./guestfish under $VG (== valgrind + options,
    defined only when check-valgrind is run).

commit 23d429ff845f29b345ff76efab669daf92b5ab42
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 30 16:15:04 2013 +0100

    fish: Add a test for -a URI options.

commit e3df223a5aed82b7e502bef327d57dd54d98587b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 30 16:13:24 2013 +0100

    fish: Fix guestfish so it can recognize sheepdog://... as a valid URI.
    
    Because "sheepdog" is 8 characters, it wasn't recognized before.

commit b65c1c667b26313abf312a7ab51f8bf947243d07
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 30 14:49:55 2013 +0100

    sysprep: Allow -a URI options to be used (RHBZ#968875).
    
    This allows you to sysprep a remote guest by doing eg:
    
      virt-sysprep -a ssh://remote.example.com/disk.img

commit 406522d1d2c9108c52f1356cbbb9bb4039d9ce84
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 30 14:34:23 2013 +0100

    resize: Add bindings for the guestfish -a URI parsing mini-library.
    
    This allows -a options to be parsed from OCaml programs, reusing
    the same code that is being used by C.

commit 4d7c14fdbb372d6ad5ef729b6969078b5fdb68da
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 30 12:43:33 2013 +0100

    fish: Split off URI handling (for -a argument) from general options parsing.
    
    This is so we will be able to reuse the same code in the OCaml tools.
    
    This is just code motion.

commit 671be806ae79df5d0a9e864d2f9b3461d08c7733
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 30 12:22:08 2013 +0100

    fish: options: Fix optarg -> arg.
    
    Don't read the global variable optarg.  Read arg instead.
    (In all cases they are the same, so this bug made no difference).

commit a3891430bc9fe408505277701962acaa664fc96a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 30 12:17:22 2013 +0100

    fish: Don't store xmlURIPtr directly in the drive struct.
    
    Original drv_uri fields:
    
          xmlURIPtr uri;        /* URI */
          char *socket;         /* ?socket parameter from URI. */
          const char *format;   /* format (NULL == autodetect) */
    
    New drv_uri fields:
    
          char *path;           /* disk path */
          char *protocol;       /* protocol (eg. "nbd") */
          char **server;        /* server(s) - can be NULL */
          char *username;       /* username - can be NULL */
          const char *format;   /* format (NULL == autodetect) */
          const char *orig_uri; /* original URI (for error messages etc.) */
    
    This is just code motion.

commit 0e1ba00059b5ebbca2e137f2685b2eb65ed33b13
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 30 12:16:38 2013 +0100

    internal: Add CLEANUP_XMLFREEURI (cleanup function for xmlURIPtr).

commit b56990ddf8aa4dc4db3da592783acfe055c05534
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 30 11:44:47 2013 +0100

    resize: Move isatty_stdout function to separate module (TTY.isatty_stdout).
    
    It was jammed into the Progress module just for convenience.

commit c663ab3bb9ab02fb3ca6209333c2d5402081c4de
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 29 14:37:50 2013 +0100

    daemon: cap-get-file: Return empty string if no capability on file (RHBZ#989356).
    
    Return an empty string (instead of an error) if no capabilities are
    set on a file, and document that in the API.

commit fb282e677c015de65627790a02aceb6ed264ed80
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 29 13:52:16 2013 +0100

    resize: Link to information about dracut-modules-growroot.

commit a1236b7251c20dea0db7c5c4fc475ceeda176296
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 29 11:58:48 2013 +0100

    tests/mount-local: Fix test of parallel mount-local.
    
    This fixes commit 14fabcd88e1500368affad86b3cf221f3884a739.
    
    Bug found by Kashyap Chamarthy.

commit 7a6968f1e4cf8cbaf55c51f791cec82fa69bd1bd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 29 08:58:41 2013 +0100

    Version 1.23.11.

commit ebf477107db6bfeff9d0fae56591ebaf3e20109d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jul 28 18:09:42 2013 +0100

    tests: Add tests for the new journal APIs (RHBZ#988100).
    
    This relies on the test data from
    commit b502197ec4f201fa79255243fa09343cf3550ab5.

commit 5cb7f294f6a5a8b4a68e940c30ca9af0fe0741d5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 27 15:28:50 2013 +0100

    New APIs: Add systemd journal support (RHBZ#988100).
    
    This adds simple support for reading the journal files from guests
    that use the systemd journal.
    
    The new APIs are:
    
      journal-open
      journal-close
      journal-next
      journal-skip
      journal-get
      journal-get-data-threshold
      journal-set-data-threshold
      internal-journal-get
    
    More complex journal support (eg. for seeking within the journal,
    support for cursors) could be added later.

commit b502197ec4f201fa79255243fa09343cf3550ab5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 27 17:58:50 2013 +0100

    tests/guests: Add some systemd journal data to the Fedora test images.
    
    The journal data blob comes from a real Fedora 20 (x86-64) machine.

commit 1937108a4a6070750f0d636f7dcc8725441cc4eb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 27 16:34:54 2013 +0100

    src/file.c: Be sure to call guestfs___lazy_make_tmpdir before using g->tmpdir.
    
    Although g->tmpdir is always set after launch, and none of these calls
    should be used before launch, it's always possible that a caller would
    use one of these APIs before launching the handle.
    
    If guestfs___lazy_make_tmpdir is not called, then g->tmpdir is NULL,
    and the constructed filename would look like "(null)/...".
    
    In fact it's possible to observe this error (although it seems to have
    no especially bad effects):
    
      $ strace guestfish ls / |& fgrep '(null)'
      unlink("(null)/ls1")     = -1 ENOENT (No such file or directory)

commit e31c32ce1bc87d164103e79288effc64bb41181f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 27 15:56:13 2013 +0100

    generator: Fix the case where a daemon function has one FileIn/FileOut parameter and no other parameters.
    
    The FileIn/FileOut parameters are not passed through to the daemon.
    Previously we generated incorrect RPC code (an empty 'struct
    guestfs_<fn>_args') because we didn't account for these FileIn/FileOut
    parameters correctly.

commit 559bd48960f795dc59d889e5776f545f2e0d494a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 27 15:48:33 2013 +0100

    generator: Fix whitespace.

commit 44c5026d9e06cf5f01098608ddd0aa4acb7bb6eb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 26 15:42:36 2013 +0100

    sysprep: On RHEL, firstboot script should be called S99... not 99.
    
    Thanks: Nicholas Strugnell

commit 4d2c63a9bc3accd7b852b1c8b2089c6296fee156
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 23 12:23:51 2013 +0100

    Version 1.23.10.

commit 4180abcc1fe25ecc1cc82ee114b037f61cdffd15
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 19 19:36:49 2013 +0100

    tests: Use unique or temporary names for temporary files.
    
    Review every test(!) to ensure that it:
    
     - Doesn't use a generic name (eg. "test1.img", "test.out") for any
       temporary file it needs.
    
     - Does instead use a unique name or a temporary name (eg. a name like
       "name-of-the-test.img", or a scratch disk).
    
     - Does not use 'rm -f' to clean up its temporary files (so we can
       detect errors if the wrong temporary file is created or removed).
    
    This allows tests to be run in parallel, so they don't stomp on each
    other's temporary files.

commit ccd069f859c35c778a4a0cb619dcb6c34a29e247
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 23 09:42:45 2013 +0100

    fish: For -N option, add drive with explicit format = "raw".
    
    Although autodetecting is safe (we always have just created a drive),
    it saves a little bit of time if we don't have to run qemu-img to
    detect the disk format with the libvirt backend.
    
    Note that for prepared drives the format is always raw and we don't
    anticipate creating drives in other formats.

commit 7c8c6e0760d54985d7a4b1fd01bf23c9c8466deb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 22 14:08:20 2013 +0100

    fish: Allow -N filename=type to use 'filename' instead of 'test1.img' (etc.)
    
    So:
    
      guestfish -N fs
    
    is equivalent to:
    
      guestfish -N test1.img=fs

commit 3c94f0245677a61f271163735444526bd37d29fb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 22 15:24:44 2013 +0100

    fish: Split up long line in --help output.

commit a8b03201f0c240d4ef433e349ef7645b90874bb5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 22 13:58:49 2013 +0100

    fish: Clarify documentation.
    
    It's not "the guest" which is launched, but the libguestfs appliance.

commit 8965368eb89532ac1613fffb0a3a661f005bae81
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 22 13:28:28 2013 +0100

    sysprep: Add new fs-uuids operation.
    
    This creates new random UUIDs for all filesystems in a guest.

commit df02c2471f3fe94c691c389c17a5d23d052848dd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 22 13:13:18 2013 +0100

    docs: Document labels and UUIDs in the API overview section.

commit 8580ef7d0f2aac2118fa7b4055f3eb28cd127093
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 22 12:41:47 2013 +0100

    New API: Implement set-uuid for ext2/3/4 and XFS (RHBZ#986877).
    
    Also includes tests.

commit 091d22f49e7fcb53fb3bb23e2ba94ca12eb88eab
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 22 11:29:42 2013 +0100

    daemon: Implement set-label for XFS and fix it for btrfs (RHBZ#986875).
    
    Implement 'set-label' for XFS filesystems.
    
    Fix the call for btrfs.  Previous
    commit d5817537fa6c51a7f851ecc5e4e63e60609e0c03 added some bogus
    documentation implying this call would work for btrfs, but it did
    not.
    
    Add tests.

commit 5724efa69f0192b71350d9c025e815218f112572
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 19 19:32:35 2013 +0100

    tools: 'test.img' is no longer used.
    
    This probably used to be a temporary file used for testing.

commit 14fabcd88e1500368affad86b3cf221f3884a739
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 19 16:42:53 2013 +0100

    tests: Use new guestfs_add_drive_scratch API where possible in tests.
    
    Replaces code such as:
    
      fd = open "test1.img"
      ftruncate fd, size
      close fd
      g.add_drive "test1.img"
    
    with the shorter and simpler:
    
      g.add_drive_scratch size

commit 57064c12aeb4145c2dd119cb98bca16d738dc3f3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 19 15:57:32 2013 +0100

    fish: Link to the new 'scratch' command from the old 'sparse' command.

commit 0d97bcf8ae498b2ad92e523f2a6bd973bde3a9c0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 19 15:57:11 2013 +0100

    tests/lvm: Remove some commented out debugging code.

commit 0f7642674bf948ddba1adce82ff768ed78f0ab16
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 19 15:05:54 2013 +0100

    tests/c-api: Use guestfs_add_drive_scratch API to create scratch drives.
    
    Replaces the old custom code for making and deleting the drives.

commit 1b11a83d5248511abbf86775601eb6e25a36c1ee
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 19 14:09:56 2013 +0100

    New API: add-drive-scratch.
    
    This adds a temporary scratch drive to the handle.

commit ecce45acc493639390972b8033f175a0bec9bef3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 19 14:25:46 2013 +0100

    Revert "tests: Add a regression test for all disk_* info commands (RHBZ#981663)."
    
    This reverts commit 2311fb0632a64cfa2bab8bf65c82ffaa042d619e.
    
    This is no longer needed, since now the disk_* info functions
    are being properly tested by the C API tests.

commit 8a3ecfc04e0561dac74c94ecbafaac8248e302c7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 19 14:23:50 2013 +0100

    tests/c-api: Remove 'GETKEY:' hack since it's no longer used anywhere.

commit 89865011e4ea725c9c69b0d473118ffcd5039ac3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 19 14:22:58 2013 +0100

    tests: Better testing of guestfs_disk_* functions using blank disks from tests/data directory.

commit 48ed7abc21430f0138a37b593e4341ef04db4f95
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 19 14:22:14 2013 +0100

    tests/data: Add some blank disks in various sizes and formats for testing.

commit b1d1a18af99c75ab99c27aa21604814399e572a8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 19 13:19:58 2013 +0100

    ocaml: Rewrite TESTS rule to be compatible with automake 1.13 parallel-tests.
    
    Because of this bug in automake:
    
      https://lists.gnu.org/archive/html/bug-automake/2013-01/threads.html#00103
    
    this requires that we duplicate the lists of bytecode (bc) and native
    code (opt) tests because we cannot use ordinary GNU make macros to
    construct these lists.

commit 7867c7cd8e4f3dd6c764a309136bce3a0f2630f9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 20 16:30:45 2013 +0100

    FAQ: Add section about different packaging strategies for libguestfs.

commit ec4498fec19764818b9b82255a206d57c5c279fc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 19 12:00:03 2013 +0100

    Update API support.

commit 0fbd5703c89504987dbda6fa41be96dd0bd7dc71
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 19 10:06:31 2013 +0100

    Version 1.23.9.

commit 3201e7556424bd305ec39ac49dd84c0471f64544
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 18 14:36:25 2013 +0100

    mkfs: Use -b size=<size> for xfs (RHBZ#981715).

commit 2311fb0632a64cfa2bab8bf65c82ffaa042d619e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 18 13:59:09 2013 +0100

    tests: Add a regression test for all disk_* info commands (RHBZ#981663).

commit 28e08776824dd3152638e647259c2f4701a0a577
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 18 13:07:13 2013 +0100

    info: Fix double-call to error function when qemu-img info command fails (RHBZ#981663).
    
    Previously if the 'qemu-img info --output json' command failed, then
    the stdout callback would be called first with a zero-length buffer.
    Since a zero-length buffer cannot be valid JSON (in this context)
    don't produce a separate error message.
    
    However do catch the case when qemu-img info might produce no output
    and no error (if that were to happen -- it does not happen at the
    moment).

commit d50cb7bbb4cc18f69ea1425e9f5cee9685825f95
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 18 13:04:55 2013 +0100

    info: disk-format et al: Fix error message when no file exists (RHBZ#981663).
    
    $ guestfish disk-format /etc/nosuchfile
    
    Instead of this obscure double error message:
    
      libguestfs: error: qemu-img info: JSON parse error: parse error: premature EOF
                           (right here) ------^
      libguestfs: error: qemu-img info: /etc/nosuchfile: qemu-img info exited with error status 1.
      To see full error messages you may need to enable debugging.
      See http://libguestfs.org/guestfs-faq.1.html#debugging-libguestfs
    
    You will now see this simpler error:
    
      libguestfs: error: disk info: /etc/nosuchfile: No such file or directory
    
    Thanks: Bo Fan.

commit aecb5f4b33107935191099dbd5559113f59ee51c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 18 13:57:39 2013 +0100

    cmd: Allow callers to override file-closing behaviour after fork.
    
    This allows us to send file descriptors directly to child processes,
    eg. using /dev/fd/<N>.

commit 758a2262f5f4033de3400bbe00fac2f85310b4ff
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 18 10:03:13 2013 +0100

    acls: Improve documentation for acl_set_file (RHBZ#985269).
    
    Thanks: Bo Fan.

commit ea817cdc603477ab691ce49b21ecf9f0cca6f944
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 17 16:57:58 2013 +0100

    library: Fix a few direct calls to perror(3).
    
    Mainly in the FUSE code, left over from when this code lived in the
    standalone guestmount program.

commit ed2351e13711ae860f27b35f942e656b31447f96
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 17 12:52:41 2013 +0100

    tests: Improve the testing of acl_set_file function.
    
    See also: https://bugzilla.redhat.com/show_bug.cgi?id=985269

commit a7b9d61cde63020686afe769ca8265a01fce208f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 11 21:05:56 2013 +0100

    ./run: Increase default timeout from 1h -> 4h.
    
    1 hour was not long enough for the C API tests when run in Koji.
    
    This update commit caab9f1e6f7ac0d8d5209c31854d640b807519ce.

commit ae78381287771a781f939f26a414fc8cfdc05fd6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 11 19:09:05 2013 +0100

    launch: appliance: Fix a double-free if kernel linking fails (RHBZ#983218).
    
    This also simplifies the code which takes the building_lock around
    guestfs___build_appliance.
    
    Thanks Attila Fazekas for the detailed bug report.

commit caab9f1e6f7ac0d8d5209c31854d640b807519ce
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 11 12:58:45 2013 +0100

    ./run: Timeout tests after 1 hour.
    
    No single test should run longer than 1 hour even on the slowest of
    hardware.  We are having a problem in Koji where a test hangs and then
    we end up losing the output completely, so a timeout + print the log
    to that point is much better.

commit 745e507c2fd06f9349212efe86f8143a1f0c5a0e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 11 12:53:28 2013 +0100

    ./run: Add a better comment describing --test mode.
    
    This is just code motion, there is no functional change.

commit 7e134f865f4e4e35f27d0c676645fffc16d85e80
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 9 14:32:14 2013 +0100

    Remove more temporary ($builddir/tmp) files when doing 'make clean'.

commit 0bc729e85b11262e5c1a38aff1602c960277c2b4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 9 13:59:52 2013 +0100

    golang: Fix it so it builds if libguestfs is not installed.
    
    It was using the installed copy of libguestfs not the local copy.
    
    We can't encode the paths in guestfs.go, since this source file gets
    copied into the install directory where those paths would not make
    sense.  Instead we have to use CGO_CFLAGS and CGO_LDFLAGS to
    communicate the right flags to go when doing the local build and test.

commit 2624315bf11ad39ee15d698405887e2c6c5fcd0e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 9 11:59:04 2013 +0100

    Version 1.23.8.

commit d457df7dc210178902e9462f5caa4d556753badd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 6 21:05:13 2013 +0100

    tests: Add test for aug_ls.

commit bf838e3333b5002e1094f9b38bc95c15e597ccb1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 6 20:46:19 2013 +0100

    tests: Test aug_insert, aug_clear and aug_save.

commit 48c16e5ef1174aa40a5769b229424e12835bba5c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 6 20:04:53 2013 +0100

    tests: Test aug_set.

commit 535963bac3018dc7a1874f0a2ed6896ffc3b70eb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 6 19:57:43 2013 +0100

    tests: Test result of aug_get properly.
    
    Don't just check aug_get runs, check the resulting string is correct.

commit 86ca8af9f1faf956da96c4e7c51ca6acac7ad40d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 6 19:24:40 2013 +0100

    tests: c-api: Add a cleanup function for tests.
    
    By specifying a cleanup function we can ensure that Augeas and hivex
    functions can be tested.
    
    There is no functional change here, verified by diffing the generated
    file tests/c-api/tests.c before and after.

commit b5a938f464a5f2649473b251f7adce7841b33974
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 6 20:41:34 2013 +0100

    tests: Fix mix up of actual/expected in error messages.

commit 02123b72429ab156512f682301946dfe02780336
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 6 15:08:13 2013 +0100

    FAQ: Fix typo.

commit 4b838a4b28e660cda4569c099784dc2a53dc74de
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 6 15:07:58 2013 +0100

    FAQ: Explain qemu-nbd & libguestfs better.

commit 31ce47fe489d74ac21401624d88739aafdcb21e1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 5 15:07:34 2013 +0100

    tests: Add basic Augeas tests.

commit 8c9a5d623ea79448a3912c22e90c05771d7d1c1f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 5 14:58:26 2013 +0100

    hivex: Add some simple tests of the hivex_* APIs.
    
    These are by no means comprehensive, but cover the basics.
    
    The 'minimal' hive comes from hivex.

commit c8f0a2eb76a39a009e0591f73e5249f3bcfc4ee8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 5 14:25:16 2013 +0100

    daemon: hivex: Check that hivex_commit is passed an absolute path (RHBZ#981683).
    
    You will now get an error like:
    
    libguestfs: error: hivex_commit: do_hivex_commit: path must start with a / character

commit 280dbed9aabcb5aa2ddbed4f0c49a82235df7eae
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 5 13:59:21 2013 +0100

    filesystem-available: Clarify documentation for this test.
    
    See:
    https://bugzilla.redhat.com/show_bug.cgi?id=980358#c1
    
    Thanks Bo Fan.

commit 06f2c1ad709cd5ea0a1e6956da14a56d5b959be7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 4 14:42:26 2013 +0100

    golang: Add examples and guestfs-golang(3) man page.

commit 43121a02e7c42bf4ab31110b22907bb5b9919e59
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 4 15:27:12 2013 +0100

    golang: Don't try to free the result of guestfs_last_error.
    
    The return value is a constant string, part of the handle, and
    it must not be freed by the golang code.

commit bb09c4a4489a0c2f18e1a95f40d12e288d2bc94f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 4 14:42:45 2013 +0100

    golang: tests: Call or defer g.Close().

commit 58b51f5921f7538f9c1dc41bb40820f3217e6883
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 4 13:50:32 2013 +0100

    golang: Add bindtests.

commit d48e4400fc454ce401a8feac9d013e489df6f198
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 4 14:00:56 2013 +0100

    golang: Map OptString to *string, not string (since string is not nullable).

commit 86c1e53ee6f3e499701d61c19d301cb5b148e394
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 4 13:49:01 2013 +0100

    golang: Capitalize fields in OptArgs* structs.
    
    Otherwise those fields aren't accessible outside the package.  We
    didn't catch this because all tests run in the same package.

commit a31926bd75478f8c635b287d34b83d0c247415c1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 4 13:12:00 2013 +0100

    golang: If 'go run' command fails, log the error message in config.log.

commit 8f504539f21647d72ac537fade26a02be004c63d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 4 13:11:45 2013 +0100

    java: Fix typo in comment.

commit 4bb3aa7dde3bb6fd5264c6f2cdb65835e58ee424
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 3 12:39:16 2013 +0100

    Version 1.23.7.

commit b6f01f32606d6f325e47562d97983f8ff69fd3c6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 1 12:45:09 2013 +0100

    Add Go (language) bindings.

commit 667b303c9afad887f7e23082d2d2b09fcd1f9d5c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 1 15:27:06 2013 +0100

    java: Fix comment in test script.

commit cd9f40945d45f2f44d3986f15dc9b82bd03ac7dc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 28 12:57:07 2013 +0100

    configure: python: RHEL 6 doesn't have sysconfig, use distutils.sysconfig instead.
    
    This works on recent Python as well.

commit 7f4048f9d57acd311416d4ceb4a7725ccc9554c8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 26 19:02:16 2013 +0100

    Version 1.23.6.

commit fb0bd82dbe9c3cad40312e89de5b61195f5fd889
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 26 14:37:26 2013 +0100

    daemon: Verify ext2/3/4 filesystem name before passing to mke2fs (RHBZ#978302).
    
    Add a utility function (fstype_is_extfs) to match ext2/3/4 filesystem
    names.  This is used in a couple of places.
    
    When passing the mke2fs -t parameter, verify that the request is for
    an ext2/3/4 filesystem.  Previously we did not check this, and neither
    did mke2fs when the -F flag was also used.

commit dd21bec4009ad6a65be1634b513be50ee668a63a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 24 21:06:58 2013 +0100

    sysprep: New operation to remove RPM database files.
    
    See:
    https://lists.fedoraproject.org/pipermail/devel/2013-June/184389.html

commit a7aa47f4de7c61620c92f95ceb2d6de833152574
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 20 09:13:41 2013 +0100

    virt-resize: Add notes about Windows and disk consistency (RHBZ#975753).
    
    Also group the Windows-related notes together.

commit b730bc0c4685887232daed8fafa491b28f38c300
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 19 19:03:21 2013 +0100

    virt-resize: Take into account large start offset of the first partition when calculating overhead (RHBZ#974904).
    
    Since we don't usually move the first partition, if the first
    partition has an unusually large offset from the start of the disk,
    then the unpartitioned space in front of that partition counts as
    partitioning overhead.  However the previous surplus calculation was
    not taking that into account.
    
    This was a problem for certain Ubuntu images which are partitioned
    with an 8 MB gap before the first partition.
    
    Thanks: David Hart.

commit 07f3e5ae5cba03d29c5b9675c7f137463b29d424
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 19 19:02:48 2013 +0100

    virt-resize: Add some more debugging messages.
    
    These are only printed when using the --debug flag and are
    helpful for diagnosing problems.

commit 7949fd3949c300ec70b85b40d8ac7a9d651cd4af
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 19 19:02:15 2013 +0100

    virt-resize: Fix minor typo in error message.

commit d8a3185823e608dbddbc6185209951140b8f3b33
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 19 13:26:18 2013 +0100

    tests: Add a regression test for iface launch hangs (RHBZ#975797).

commit f7fe7e8db021b13f40aba56722d6ebe58e3777d2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 19 14:40:51 2013 +0100

    launch: direct: Calculate appliance root correctly when iface drives are added (RHBZ#975797).
    
    This also changes guestfs___appliance_command_line to allow
    appliance_dev parameter to be NULL.  Previously a bogus root=
    parameter could be passed.

commit e7f83f2ecc8e5e00e15e49357b37980b68fa7153
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 19 13:21:10 2013 +0100

    tests/regressions: Remove duplicate test skip code.

commit cf0dcb6a0b4b855f9b16bd3849b8d2512ca5b058
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 18 17:43:26 2013 +0100

    Version 1.23.5.

commit d88f6c0ba62d65acf8db074d33109947907ec048
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 18 19:31:21 2013 +0100

    tests: inspection: Add example and test XML to EXTRA_DIST.
    
    This fixes commit a86cb71fcadbed3881e593b6de9706c03ca57149.

commit 0ff0454c59ae79d47fadcc4f2837e3bfca7af105
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 18 18:00:24 2013 +0100

    tests: inspection: Don't complain because NTFS UUID changes between test runs.
    
    This fixes commit a86cb71fcadbed3881e593b6de9706c03ca57149.

commit a86cb71fcadbed3881e593b6de9706c03ca57149
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 18 17:11:21 2013 +0100

    inspector: Add a real test of inspection.
    
    Verify that the output from inspection doesn't change, in order to
    catch regressions such as RHBZ#975412.

commit d7bc1dd92241ed569627b7583a014059afa5fc37
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 18 17:01:53 2013 +0100

    inspection: Replace phony XML with virt-inspector output from real guests.
    
    Also add an example from a real RHEL 6 guest.
    
    Remove rules for building these XML files which are no longer
    relevant.  These files were built by running virt-inspector on real
    guests, and then edited to remove excessive <application> sections.

commit 2343840936c900109b6675cc6e605026443ccf0a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 18 15:13:02 2013 +0100

    inspection: Fix hostname inspection because of faulty Augeas path expression (RHBZ#975412).

commit 2c4e7ad135b0a14021fad2b942f66b78af0041e0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 18 14:39:55 2013 +0100

    Augeas >= 1.0.0 is now required.

commit 2ee4d5e059840b518814dd6ce615627fe0a8391d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 18 15:12:02 2013 +0100

    utils: Add utility functions guestfs___concat_strings and guestfs__join_strings.
    
    These concatenate strings or join them with a separator in between.

commit 3a5b0f1787ed3f92a7ae8cdb0cd172609b9391f1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 14 13:20:26 2013 +0100

    Version 1.23.4.

commit 7f228489d00f526c5e5a4d29cf930150b0f29083
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 14 11:03:24 2013 +0100

    inspection: Fix inspection of Fedora guests (RHBZ#974489).
    
    Commit e71b2c11f59b3f8ae0c4b31c4ab5b0d1bfcdf181 broke inspection of
    Fedora guests because guestfs_is_file returns false for
    /etc/redhat-release (it's a symlink to a file, not a file).
    
    We fix this by using the new followsymlinks flag added in the
    previous commit.  Thus guestfs_is_file becomes
    guestfs_is_file_opts (g, filename, GUESTFS_IS_FILE_OPTS_FOLLOWSYMLINKS, 1, -1)
    which checks if it's a file or a symlink to a file.
    
    This fixes commit e71b2c11f59b3f8ae0c4b31c4ab5b0d1bfcdf181.

commit ef107448e89c10899cefc27f887bd627c1d7e777
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 14 10:53:17 2013 +0100

    Add followsymlinks flag to is-file, is-dir, is-blockdev, is-chardev, is-fifo and is-socket APIs.
    
    This adds an extra optional boolean 'followsymlinks' flag to those 6
    is-* APIs.  If the flag is true, then symlinks are followed, ie. we
    use stat instead of lstat in the test.
    
    For the rationale behind this change, see:
    https://bugzilla.redhat.com/show_bug.cgi?id=974489

commit 3cf442872b963e4e60367d728237569113f7c249
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 11 13:09:09 2013 +0100

    FAQ: Developer questions about committing and forking.

commit 372217c375aea4d1878f55bca36e29c53529435c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 11 13:08:49 2013 +0100

    FAQ: Emphasize that we don't accept github pull requests.

commit d2c05c96cabf63d1c5bf4eaf8452c33180b88e95
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 11 12:55:26 2013 +0100

    FAQ: Put B<> bold section around "Note"s in the text.

commit 0e652c11bec667544f77b1a033f23c3abf0c0022
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 11 12:55:12 2013 +0100

    FAQ: RHEL 6.5 will fix the buildnet problem.

commit 32fe7fd8536a452639a8304e77dde5305d79b209
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 11 12:54:29 2013 +0100

    FAQ: Indent Ubuntu releases in list.

commit 3b109ff20710a1cd2805e7bcc1d20c2713f89ab4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 11 12:53:25 2013 +0100

    FAQ: RHEL 7 is based on libguestfs 1.22.

commit 58519bbe9c456f04bf3cdb261a75351aa94461e5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 11 12:53:08 2013 +0100

    FAQ: Add link to RHEL 6.5 preview repository.

commit b30647cd23eecde5b61161aa678ffce6fd5aa5b4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 10 19:33:53 2013 +0100

    Version 1.23.3.

commit ef4969c2ce2754c6ce535c9ac8d51ee3e7df1ea8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 10 18:09:43 2013 +0100

    build: Fix 'make distclean' (again).
    
    So it doesn't break after the generator has been deleted by
    a previous distclean rule.

commit 546b3f3fce38874239161484b74aa90560a399dc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 10 16:08:05 2013 +0100

    txz-out: Fix this API to produce xz files again (RHBZ#972775).
    
    Commit 864ef706a84c7c87a62f776d4b2e82a6f959ae14 (in Aug 2012) broke
    the deprecated txz-out API.  Because of a thinko during this commit,
    instead of producing xz files it produces bzip2 files.
    
    Fix this API again.
    
    Thanks: Bo Fan / Red Hat QA team.

commit 21f427801c88656ff85467b1bf0acf7c567a59e2
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Jun 7 12:18:51 2013 +0100

    inspect: Fix bogus warning for partitions without /boot.ini
    
    Fix a bogus warning introduced by
    5abb196de869cd27a6fa2377d79b9a267120f48e. If a non-windows partition
    hasn't been detected as something else and falls through to windows
    detection, inspection would display a bogus warning about missing
    /boot.ini.
    
    RWMJ: Test if guestfs_is_file > 0, in case it returns an error.

commit 95850772021d35911b3597159ff50c11043da686
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 5 17:29:43 2013 +0100

    inspection: Reformat is_systemroot declaration.
    
    Just code motion.

commit 5abb196de869cd27a6fa2377d79b9a267120f48e
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Jun 5 16:56:03 2013 +0100

    inspect: Partial support for non-standard windows system root
    
    Support arbitrary windows system root for pre-vista systems where
    boot.ini is on the same partition as the system root.

commit 83b7d0a66e99fb970a0929123f6fc0e810869677
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Jun 5 16:56:02 2013 +0100

    inspect: Add internal match6 function

commit f1385192ad607190b01ccbdb0805eede8a787436
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Jun 5 16:56:01 2013 +0100

    inspection: Refactor windows systemroot detection to allow re-use
    
    This change refactors guestfs___has_windows_systemroot to
    guestfs___get_windows_systemroot. The new function returns a
    dynamically allocated char * which must be freed.
    
    The new function is no less efficient than before, as it returns the
    result of guestfs___case_sensitive_path_silently, which is required
    anyway. The new code is slightly more efficient than before, as it
    re-uses the result of this testing in guestfs___check_windows_root
    rather than running it again.

commit 5add9cbe78582fcf79bb0e1ab1267841a1647b62
Author: Olaf Hering <olaf@aepfle.de>
Date:   Tue Jun 4 16:39:12 2013 +0200

    Set DISTRO to SUSE if /etc/SuSE-release exists
    
    Signed-off-by: Olaf Hering <olaf@aepfle.de>

commit 012a4a5eb5c985e5ce22f3e6991da5369aeaed82
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 4 12:06:29 2013 +0100

    ocaml: Build dependencies for tests too.

commit 49bdaabc7d011e7fb55e457d6fb865c175d1c757
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 4 11:52:18 2013 +0100

    build: Add common-rules.mk, common rules for all Makefiles.
    
    This file is mainly a central place to:
    
     - include localenv if it exists, and
    
     - define the RHEL 5 backwards compatibility macros, instead of
       spreading them over every other file.

commit 76321709d6117383e36a48d5cdd3a1402171944d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 4 11:33:27 2013 +0100

    build: Don't include subdir-rules.mk in top level Makefile.am.
    
    Also there are no generated files at the top level, so no need to
    mention $(generator_built) in this file.

commit 94dbcb107f5a5d8658e76add344cf697a938783c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 4 11:30:09 2013 +0100

    Quote ./configure --help output (options) properly.

commit 44b453d6fb476c57a2ff11c7c8ceaf27fb7ac8c7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 3 23:00:21 2013 +0100

    build: Simplify and speed up expression that generates po/POTFILES.
    
    This has to run on every build, so:
    
    - Use two grep commands instead of lots.
    
    - Remove unnecessary use of sed.
    
    - Remove some obsolete directories that haven't existed for a long time.

commit 074e3b5c6702e3b743f1eaa41b88e040357f7e90
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 3 22:47:03 2013 +0100

    generator: Don't always recurse into the generator directory.
    
    Previously, every subdirectory that contained generated files would
    cause a recursion into the ../generator directory.  This was slow and
    unnecessary.  Only recurse if the generator actually needs to be
    rerun.
    
    Note this changes the semantics slightly: For example if you added a
    new action and just ran `make -C ocaml' then previously the generator
    would be rerun, but now it would not.  However I'm not convinced the
    previous semantics were that useful, particularly considering that
    with this change a simple `make' is much faster.

commit edf9d3c7f0d70488ef0ad6a87e7966d774b9b190
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 3 22:37:51 2013 +0100

    ocamldoc: Depend directly on guestfs.mli, guestfs.ml files, not wildcards.

commit b7cd34eb776a6429e2de536c53390f791dbc8470
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Tue Jun 4 00:31:57 2013 +0200

    python: Build extension with PEP-3149 compliant suffix if defined.

commit 7912e2936b347b1bf3728e9a53b2ccdbb97483a1
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Wed May 29 01:00:25 2013 +0200

    perl: Use symlink hack from hivex

commit cdc4413dacb7a5a7693205408d52da6f4c35da0d
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Wed May 29 00:58:17 2013 +0200

    Revert "perl: Fix build and test to work with separated builds."
    
    This reverts commit 4ea016dae96ed4fc3ca6d057f17fde9697f0e627.

commit 222a7b56f3d717cc4b33ae4ea4789a381db4f18c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 3 13:25:47 2013 +0100

    Version 1.23.2.

commit 731d0e1bf6b2b4b977633a454a697eb61dc1557e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 3 11:50:11 2013 +0100

    docs: Updated release versions which fix CVE-2013-2124.

commit c2dcd1096424e6ff37a2e634c364f27b193376e7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 31 14:14:19 2013 +0100

    inspection: Add a fuzz-test of inspection.

commit e8af0982da9f48cce00d999ec6777c15ab931d80
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jun 2 13:08:08 2013 +0100

    perl: Add rules + environment variables so Perl code can be valgrinded.

commit e71b2c11f59b3f8ae0c4b31c4ab5b0d1bfcdf181
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 31 22:39:16 2013 +0100

    inspection: Use guestfs_is_{dir,file} in preference to guestfs_exists.
    
    Where possible, using this is more accurate, and it helps when
    trying to do fuzz testing.

commit b4d8757dadb67d86d14bd8af854d7ba48e9a55f6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 31 19:42:07 2013 +0100

    events: Avoid event handler limit if program allocates and deallocates handlers.

commit 2019d0e9c7cd4b927cb98fe96d97e945dd4847e0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 31 14:36:08 2013 +0100

    New API: remount: Allow rw flag to be adjusted on mounted filesystem.

commit 697b0f89fed04a4017e033861a9eaaa40b3270d9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jun 2 18:52:44 2013 +0100

    proto: Fix for rare FileIn hangs. (RHBZ#969845).
    
    Yet another protocol bug!
    
    If the daemon cancels, then the library should send a cancellation
    chunk.  It normally does this during the loop where it is uploading a
    file.  However due to an oversight or possibly a regression when we
    modularized the socket code, the library did not send a cancellation
    chunk if the daemon cancelled just before the end of file was sent.
    
    This commit fixes this.

commit 1c9dfd079aa6d7893f72c5fd17656c847f72c8d6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 1 14:11:40 2013 +0100

    inspection: Correct fix for segfault if /etc/SuSE-release is an empty file.
    
    The test was the wrong way round.
    
    See: CVE-2013-2124.
    
    This fixes commit ae8bb84ecd46d7b6ef557a87725923ac8d09dce0.

commit 823628d41f898982979ab7dd53656377bef8ce1d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 31 11:49:22 2013 +0100

    lib: Don't call directly from one guestfs__* function to another.
    
    The public-facing functions like 'guestfs_*' are implemented as
    wrappers around implementation functions like 'guestfs__*' (for
    library-side functions only).
    
    Don't call from one 'guestfs__*' function to another.  It prevents
    ENTER events from being caught, especially where a deprecated function
    calls another implementation.
    
    Most code was not doing this, but there were still some places left
    where it was done.

commit e86459e5014eca637eade0bf0410175e5a4b5305
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 31 11:29:15 2013 +0100

    events: Use bool for flag.

commit 75cf879613899c1beb847b1f7a776df90b565be3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 31 11:28:54 2013 +0100

    events: Refactor code to make the common path clear.

commit ae8bb84ecd46d7b6ef557a87725923ac8d09dce0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 31 08:37:44 2013 +0100

    inspection: Don't segfault if /etc/SuSE-release is an empty file.
    
    Related to CVE-2013-2124.
    
    Thanks: Olaf Hering.

commit 36d6df671e57cd755dc4b0b38acd539615b73936
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 30 12:31:54 2013 +0100

    tests/http: Add a test of HTTP protocol.
    
    Disabled for various reasons.  See comment in Makefile.am.

commit b3e5ed69b5d1540f463413122f2db21b3bbcfd46
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 30 11:48:05 2013 +0100

    release notes: Recompile so that long URLs aren't broken in text output.

commit aab882a3a6f4acf99b7fba6ea9f9f072ed2898ea
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 30 11:45:59 2013 +0100

    podwrapper: Set Text::Wrap::huge property to "overflow".
    
    This stops long URLs from being broken in the text output mode.
    
    See:
    https://www.redhat.com/archives/libguestfs/2013-May/thread.html#00088

commit b0bd0bba933141c4922c9eecd1c721228adccb97
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 29 19:16:20 2013 +0100

    security: Centralize CVE information in one place (in guestfs(3)).

commit ee9f1abe7ffacf4c6000c16721dc9259c51b61a1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 29 19:13:46 2013 +0100

    security: Add documentation for CVE-2013-2124.

commit 1766ff1177f0cd2e918632f2f67183851f0273f5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 29 16:02:26 2013 +0100

    appliance: Add sensible disk optimizations.
    
    The timeout lets us read remote images without timing out.
    
    The noop scheduler lets the host do scheduling.  This generally makes
    sense for mixed workloads because the host has a global view of the
    system, and often has more compute power too.

commit da764805ba42fd940c3fbe4bbdc2312c5f84c38f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 29 15:39:47 2013 +0100

    appliance: Remove dead code which (if not dead) would have set disk scheduler to noop.

commit 52eb691e0b85d5a934db11c5dba042f7ce089b53
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 29 15:37:35 2013 +0100

    appliance: Don't set 'rotational' on virtio-blk devices.
    
    virtio-blk is obsolete so we don't need to bother optimizing it.
    People should use virtio-scsi instead.
    
    Also virtio-blk should choose the optimal settings itself.
    
    This was originally added to fix this bug:
    https://bugzilla.redhat.com/show_bug.cgi?id=509383

commit 9df4e51f65f15f3d217f527127c17da650d9ef48
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 29 16:22:02 2013 +0100

    generator: Set builddir for old RHEL 5 which didn't have this.

commit 1d08ea938f6c7b29160b833fa7b4be8241b4f565
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 29 16:15:24 2013 +0100

    generator: Set abs_srcdir for old RHEL 5 which didn't have this.

commit 06291ce0dd656605d3ada94c56103013d6eeaf3d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 29 14:35:54 2013 +0100

    generator: Set abs_builddir for old RHEL 5 which didn't have this.

commit 809a7012dec57977b6fd283c44c26584c15d6999
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 28 21:38:23 2013 +0100

    tests: Add 'make check-release' rule.
    
    This is a subset of tests which will be required to pass before a
    tarball can be released by the maintainer.

commit 0a60332e1bcff698555d31c8b2524a435a93a3f9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 28 21:33:56 2013 +0100

    tests: Add new 'make check-all' rule.
    
    This runs all of the check* rules.  Since this includes 'make check',
    'make check-all' is not quite equivalent to the old 'make extra-tests'
    which was removed in the previous commit.

commit ffde7b4d714e8602f0a6ac863e1a45ed6c927423
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 28 21:33:26 2013 +0100

    tests: Remove 'make extra-tests' rule.

commit 57e83615f0a5aa0315183b625e395d6b8d1c1726
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 28 17:22:58 2013 +0100

    Version 1.23.1.

commit fa6a76050d82894365dfe32916903ef7fee3ffcd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 28 16:15:59 2013 +0100

    inspection: Fix double-free when certain guest files are empty.
    
    The following commit:
    
      commit 5a3da366268825b26b470cde35658b67c1d11cd4
      Author: Richard W.M. Jones <rjones@redhat.com>
      Date:   Thu Jan 24 17:07:38 2013 +0000
    
          inspect: Use CLEANUP_* macros in inspection code.
    
    can cause a double-free along an error path when certain guest files
    are empty where we expected those files to contain at least one line.
    
    This causes virt-inspector to crash when run on these guests.
    
    The following is a test case which demonstrates the crash.
    `f20rawhidex64' is a Fedora guest, but with small adjustments to the
    test you could use any Linux guest for this test.
    
      $ qemu-img create -f qcow2 -b f20rawhidex64 /tmp/test.qcow2
      Formatting '/tmp/test.qcow2', fmt=qcow2 size=21474836480 backing_file='f20rawhidex64' encryption=off cluster_size=65536 lazy_refcounts=off
      $ guestfish -i -a /tmp/test.qcow2 -- rm /etc/redhat-release : touch /etc/redhat-release
      $ virt-inspector /tmp/test.qcow2
      *** glibc detected *** virt-inspector: double free or corruption (fasttop): 0x00007f18bc9925a0 ***
      ======= Backtrace: =========
      /lib64/libc.so.6(+0x34ecc7ca8e)[0x7f18b8e64a8e]
      /lib64/libguestfs.so.0(+0x3f91898078)[0x7f18ba13c078]
      /lib64/libguestfs.so.0(+0x3f91899761)[0x7f18ba13d761]
      /lib64/libguestfs.so.0(+0x3f91896d12)[0x7f18ba13ad12]
      /lib64/libguestfs.so.0(+0x3f91894140)[0x7f18ba138140]
      /lib64/libguestfs.so.0(guestfs_inspect_os+0x35)[0x7f18ba0bcc35]
      virt-inspector(main+0x547)[0x7f18ba7c57d7]
      /lib64/libc.so.6(__libc_start_main+0xf5)[0x7f18b8e09a05]
      virt-inspector(+0x6665)[0x7f18ba7c7665]
    
    This is a denial of service, but not likely to be exploitable.
    
    (Found by Coverity)

commit 1e7f2b29c428538aa3486c15c72a30c030b276f3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 28 16:04:06 2013 +0100

    rbd: Fix overallocation because of incorrect 'sizeof'.
    
    (Found by Coverity)

commit 9854d1f08d3142324593e953744281fca1940dbf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 28 16:02:24 2013 +0100

    conn-socket: Don't leak 'conn' on error paths.
    
    (Found by Coverity)

commit 0e756842f6e7435ff09c116c1c3edc5316d752a7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 28 15:59:54 2013 +0100

    erlang: Don't leak (some) strings along error paths.
    
    This fixes several string leaks along error paths which
    were found by Coverity.
    
    However this is not a complete fix.

commit e52a6b56f487890f5507b89c3ff6fdf173eab402
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 28 15:48:42 2013 +0100

    fish: Check for out of memory failure.
    
    (Found by Coverity)

commit a9a191d20e6b4ea951b0ef38cb5abad68987c81b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 28 15:48:23 2013 +0100

    inspection: Test for failure from match1 function.
    
    (Found by Coverity)

commit 49cb55146f6933dd1a7a9c38ec884aa5afc12247
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 28 15:41:32 2013 +0100

    drives: Don't call `close (-1)'.
    
    (Found by Coverity)

commit c7531fea6ee20242cd1b36f3416cfe6bf0c238ab
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 28 14:49:17 2013 +0100

    guestfs-testing: Add tests for various new features added since 1.14.
    
    In particular, test remote access using guestfish if they
    have libguestfs >= 1.22.
    
    Also add some diagnosis tips.

commit ada943b949774cdfc60953606f5e7aa9ac0a8638
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 24 14:19:41 2013 +0100

    syntax-check: HAVE_DECL_* macros are always defined.
    
    These macros are always defined to 0|1.  We don't need to
    check if they are defined.

commit 2ed3a383b4fc78966fa37b291c72784cd48100d6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 24 14:19:24 2013 +0100

    syntax-check: Remove trailing whitespace.

commit a787d2565f69e651b39fe08246b7235322db7a49
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 24 14:19:06 2013 +0100

    syntax-check: Use newline before EOF in these text files.

commit 5c80f22b64af2d15623105571cc743beec2f94f6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 24 14:18:32 2013 +0100

    syntax-check: Remove unused ``#includes''.

commit 014bc5f398d05f6474eb690d86f9f944e9e04000
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 24 14:17:06 2013 +0100

    syntax-check: Use exit (EXIT_*) macros instead of hard-coded 0|1.
    
    These are defined in <stdlib.h> which the test program already includes.

commit 77d08060b412775d1a9ab846decd14439980781d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 24 13:48:23 2013 +0100

    syntax-check: Ignore more syntax-check problems.
    
    For some reason maint.mk doesn't process all of these regexps,
    or perhaps the regexps are not well-formed.

commit 2bc1d522dbaea8727cfc7bcc4bb03bbb8a5c212a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 24 14:16:29 2013 +0100

    Ignore various intermediate files left around by 'make syntax-check'.

commit 42e268a2b412cc67c139d2023521de6ea35b3882
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 24 14:16:37 2013 +0100

    make help: Suggest using -j1 -k options with make syntax-check.
    
    This lets you see all the output, not interleaved.

commit afd6512536d27eb97e1ae0f8c4ea0d6807bce377
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 23 12:49:09 2013 +0100

    Version 1.23.0.

commit fca2dc9d0d3733a579a6a6af67d319270fb51459
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 23 12:06:46 2013 +0100

    Version 1.22.0.

commit 9d1c95281e493156ebbadfc75e190d2294123740
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 23 12:09:51 2013 +0100

    build: Set 'stable' or 'development' in commit tag automatically.
    
    This sets two macros: BRANCH_NUMBER and BRANCH_TYPE.

commit 455c277f96309033f12ba6ed843c1894b34cae0f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 23 11:51:46 2013 +0100

    release notes: Get ready for 1.22 release.

commit 3147500f15ca7299a09a48af514459d793d04c1a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 22 14:20:53 2013 +0100

    tests/mountable/test-internal-parse-mountable.c: Hoist variable decls to top.

commit 553ffd7a94ca3993ac5a00ca2ff4e65883f37207
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 22 14:19:57 2013 +0100

    tests/mountable/test-internal-parse-mountable.c: Don't fully allocate 1GB disk.
    
    This test required 1 GB of free space since it used posix_fallocate
    instead of creating a sparse disk.  Use truncate instead.

commit 72afcf450a78b7e58f65b4a7aaf94d71cd25fca5
Author: Hilko Bengen <bengen@debian.org>
Date:   Fri May 17 19:07:48 2013 +0200

    Fix for changed selinux mountpoint
    
    http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=707217

commit 6e20440fb1b53f86d696198806867e06773474b6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 21 18:23:52 2013 +0100

    Version 1.21.40.

commit fb5cc99f9ea733d409ea98fb7485fa8f52968070
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 21 18:12:36 2013 +0100

    release notes: Don't document new internal APIs.

commit 4db269cfe648f772f01966cbfc27ff8a864ae496
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 21 18:12:07 2013 +0100

    appliance: Use 'rm -f' on files which might have been moved so might not exist.
    
    This partially reverts commit fae4a2cfb99bab26f3bd60f52e4a586e39f54f49.

commit cfa0ec55ce5ff9ae777f6f547529af1faf6abd01
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 21 17:13:16 2013 +0100

    Update gnulib to latest version.

commit a53d6a40a76f49dc101dac7ef749711501e4f046
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 21 17:11:23 2013 +0100

    docs: Add notes about how various check-* targets are implemented.

commit 930c3bc91d130bc152eebee802c83656ff69b891
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 21 14:17:54 2013 +0100

    Update translations from Transifex.

commit aa7f953a2e713cda80949b1cf788b47afb3cfe8b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 21 14:12:49 2013 +0100

    Update ROADMAP for 1.24.
    
    That will be the next stable release after 1.22.

commit 69f73cd8f5825d516b33b8cd3d7dd22c9a2edf95
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 21 14:11:23 2013 +0100

    release notes: Update list of bugs.

commit 5a69428f5ec197dfa054e98e80098b758b36d5b9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 21 13:37:55 2013 +0100

    sysprep: Be prepared for CentOS etc. 7 which will act the same way as RHEL 7.

commit d2abdddf61c7bd0c6fc79dd83aa4332e213dc7ba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 21 13:37:03 2013 +0100

    sysprep: Update /etc/machine-info on Fedora 18+, RHEL 7+ (RHBZ#890027).

commit 0daa83cc9116a537cf154088a5a47c5c43ee6444
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 21 13:36:29 2013 +0100

    sysprep: Refactor code, introducing a function to replace a line in a file.

commit 3f0b54395c8338636bd19f8b229c025c4b8b034b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 21 13:26:49 2013 +0100

    Update API support.

commit 87ba073dd539a5440288590e179a96b3ca835ac6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 20 22:20:44 2013 +0100

    guestfs-recipes: Two more recipes from my blog.

commit c74f7f15cbb9bf67447e66ed64356f7346c5effc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 20 21:46:49 2013 +0100

    examples: If user does 'mount-local --help' don't create a disk image called '--help'.

commit 49979931f69ed68709a544fd45d8084c831981a6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 20 21:42:52 2013 +0100

    fuse: Reimplement umount-local using guestunmount.
    
    Instead of repeating the same code calling fusermount -u, retrying, etc.

commit e37de5492986fed8847f78a353d6194c6cfb0035
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 20 15:43:49 2013 +0100

    gluster: Normal port number (assuming 1 brick) is 24007.

commit 0ff8b315f575866e82177a5fb6778b468bcf63bd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 20 15:42:56 2013 +0100

    gluster: Note that client needs to run as root.

commit dcff65722f45d48326fff83db82e926de75fb1ea
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 20 15:27:57 2013 +0100

    gluster: Force exportname to begin with a '/' character.

commit f3bbd1f4ddc26b266d38666c1526549833ceeab7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 20 15:27:36 2013 +0100

    gluster: Don't force gluster port number to be specified.
    
    Gluster can choose its own port number.

commit 40691b7167fec6619385b38693eb65c375f0c7bd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 20 15:13:09 2013 +0100

    launch: libvirt: Allow port to be optional.
    
    Actually if you don't specify the port, currently libvirt gives
    an error:
    
      libguestfs: error: could not create appliance through libvirt: XML
      error: missing port for host [code=27 domain=20]
    
    However I think that is a bug in libvirt:
    
      https://bugzilla.redhat.com/show_bug.cgi?id=965142

commit fae4a2cfb99bab26f3bd60f52e4a586e39f54f49
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 20 09:00:16 2013 +0100

    appliance: Don't use 'rm -f' on files which ought to exist.

commit 40a0e086199780fd3326412f5dd8c27649cb619c
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Sun May 19 18:01:10 2013 +0200

    fish/test-events.sh: ignore "trace get_path" line
    
    The test would fail when LIBGUESTFS_PATH was not set.

commit b862d95c476b069ee91b793e7c3e0db6ce0bb05d
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Fri May 17 22:28:18 2013 +0200

    ./run: Turn error message about missing LIBGUESTFS_PATH into warning; output to STDERR
    
    The previous behavior caused the build to abort when trying to build
    the sysprep documentation -- without much of a hint of what went
    wrong.

commit 95ed4949f240649b0277a3d687cfd8f61cc396f1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun May 19 16:40:19 2013 +0100

    README: Clarify that building from git needs './autogen.sh'.

commit 2147d9d6cd938f0cab280e448f79cdbfc5822484
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 18 07:43:43 2013 +0100

    daemon: Don't install man page for guestfsd(8) if --disable-install-daemon.

commit f9eee0ad8de7a50e769d6f3621329e411b546605
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 17 11:54:07 2013 +0100

    php: Work around buggy PHP returning array as long.
    
    Because OStringList is an optarg, we must specify "a!"  to
    zend_parse_parameters.
    
    However zend_parse_parameters still returns this as a *long* rather
    than a NULL (or empty array) so positively check that it has returned
    an array.

commit 6d87aaefa0d9c4ea9b49bed71bd8975c60fbae8f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 17 11:53:45 2013 +0100

    php: Fix comment in run-php-tests.sh.
    
    This updates commit cd40cf713991569e51b42742177e57f3dca148bc.

commit 2d58c42ab8177c8dadc75a40ac861c9dba3aad22
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 17 11:13:07 2013 +0100

    Update release notes.

commit f7c312ba6bc99a331f2b3996624dc3408a8cc3c0
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu May 16 16:21:42 2013 +0100

    Fix compiler warning when libselinux is not present
    
    static function selinux_warning() isn't used if HAVE_LIBSELINUX isn't
    defined, which results in a warning.

commit e5f0dfb6e3425e8dbaa405847ae98a8dcc421da7
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Thu May 16 22:13:50 2013 +0200

    Use pkg-config for Python
    
    At least libpython2.7-dev and libpython3.3-dev on current
    Debian/unstable ship with pkg-config files. As with the pkg-config
    check for Lua, we check for versioned and an unversioned .pc files.

commit 7865f825376b218746946bf423b359169ed3fc61
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 16 11:11:39 2013 +0100

    appliance: Run lvmetad if it exists.
    
    This daemon is used by newer LVM to interface with udev events.

commit ef199cf66ea544fc52f1bd206de7e141e0dbcc47
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 15 13:00:09 2013 +0100

    Version 1.21.39.

commit e70927a5e56224a64a31192f05f02534e1f18c46
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 13 15:50:49 2013 +0100

    drives: Fix rules for quoting files that contain ':'.
    
    The test was backwards.
    
    This fixes commit a95214b1985e694946e3426120a6fdc13a3f081f.

commit 11774eeb80d1710ea84459708344c15b4cfaae7a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 13 08:40:23 2013 +0100

    faq: Update documentation for Debian Squeeze (thanks Hilko Bengen).

commit dee7ab1b79955372986070f7fab33145cf4cd06d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 11 20:14:26 2013 +0100

    http: Fix typo in documentation.
    
    This fixes commit 83f74f5c564c51a1324b12e5edc4b50356d49dc6.

commit 83f74f5c564c51a1324b12e5edc4b50356d49dc6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 11 18:18:12 2013 +0100

    Add support for qemu's curl driver (ie. FTP, FTPS, HTTP, HTTPS, TFTP).

commit e3c2397165884622e57f9d9b62349f4134bb3e61
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 11 18:07:24 2013 +0100

    iscsi: Document that one server must be passed, and that username may be passed.
    
    This fixes commit 8b271101a1724bab926c65c77436d8128bf1c2df.

commit be05a036e231e562a8ba86ed1a6f4f11cff9d8fb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 11 18:04:25 2013 +0100

    drives: Fix typo in error message.
    
    This fixes commit 0a065c45748ec5efe86f4d02f4864a58ed7dae36.

commit af0f2cc9e51347cbbbd0d08be31def5ac9002ff0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 11 15:51:51 2013 +0100

    Version 1.21.38.

commit 0a1111391baa78025077cfec55aeb4c1145356f9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 11 15:53:59 2013 +0100

    build: Add 'make maintainer-tag' rule for tagging HEAD with current version.

commit ec3d3a809a5dabbdd7784d07d877e647183a523d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 11 15:51:12 2013 +0100

    tests/regressions: Remove bogus comment in test.
    
    This updates commits a95214b1985e694946e3426120a6fdc13a3f081f.

commit a95214b1985e694946e3426120a6fdc13a3f081f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 11 13:36:43 2013 +0100

    drives: Remove check for ':' in filename (RHBZ#811649).
    
    Modern qemu can now handle this properly.  ':' is only special if what
    precedes it looks like a transport, so:
    
      qemu-system-x86_64 -drive foo:bar     .. fails
      qemu-system-x86_64 -drive ./foo:bar   .. works
    
    Thus by adding ./ in front of relative paths that contain ':' we can
    work around this.
    
    In addition, this broke iscsi:// URIs because iSCSI target names
    routinely contain ':' characters.

commit 0a065c45748ec5efe86f4d02f4864a58ed7dae36
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 11 13:33:36 2013 +0100

    drives: ceph/gluster/iscsi/sheepdog/ssh: Force the disk name to begin with a '/'.
    
    This avoids confusion when using URIs in guestfish, since the path
    will always start with a '/', and we don't otherwise know if we should
    remove it or not.  By forcing the '/' to always be there, we deal with
    this problem in the API instead.

commit 914d3e68ec272436f91080f47ddfe4db8f1d8751
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 11 13:23:48 2013 +0100

    drives: Use libxml2 to construct safely quoted URIs for qemu.

commit 8b271101a1724bab926c65c77436d8128bf1c2df
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 10 21:38:14 2013 +0100

    Add support for iSCSI.

commit 7a9ebd757cca0ec22fd730703bed16005ebfb6a4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 10 14:23:08 2013 +0100

    src/inspect-fs.c: Don't segfault if internal_parse_mountable returns NULL (RHBZ#961812).

commit 6a1c76807ec483b7eab4bc62822ef1c4f12e2be6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 9 17:44:44 2013 +0100

    ./run: Don't set LIBGUESTFS_PATH if --disable-appliance.
    
    Thanks Dave Vasilevsky for spotting this problem.

commit 55eae0af3b3b645c78b84278291ec0089e5492b0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 9 15:35:46 2013 +0100

    recipes: Add link to script for converting Windows DVD to bootable USB key.

commit d66145622550ff4f4ce9a5f8aefcdb6e9ae4c33a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 9 15:35:08 2013 +0100

    New API: cp-r
    
    This runs 'cp -rP' and is useful for copying when the target
    doesn't support file owners or permissions (ie. FAT).

commit e7e8a1bfefab19db7512d05a4a00e3ffb37f5dd8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 9 10:22:44 2013 +0100

    Version 1.21.37.

commit 3287f177e01b15aa5c43fcf1640773be259ce965
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 9 08:52:40 2013 +0100

    fish/options.c: Whitespace changes.

commit a820e9e3bd55632d88a2d76581921e1cebd17c62
Author: Dave Vasilevsky <dave@vasilevsky.ca>
Date:   Wed May 8 21:16:51 2013 -0400

    fuse: Document the fstype parameter

commit f83df69bec28fe5414da3896af0ec3b0986beaa4
Author: Dave Vasilevsky <dave@vasilevsky.ca>
Date:   Wed May 8 21:02:21 2013 -0400

    fuse: Allow specifying the fstype of a mount

commit bec7888be3b0b09c794a6ef3d5d00baa22f9c68c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 8 11:50:31 2013 +0100

    rbd: Miscellaneous stylistic changes, no functional change.

commit 51f7c6bb82e3582ed78767d8748eb1abbb0a7d48
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 8 11:50:09 2013 +0100

    Use size_t for loop iterators.

commit 97274c7f7548284697e4af088fb379e27f0393ef
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 8 11:44:36 2013 +0100

    src/libvirt-domain.c: Cast constant strings to avoid warning about signedness.

commit afc870dd76dc409e734b3bd7f7da3d558d79dea1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 8 11:37:13 2013 +0100

    src/drives.c: 'auth' string is const.
    
    This fixes commit f3e01b69e04a0e8321e9d54ca39a4d7ea762f80d.

commit 3e76844bc15bc79edc3f3499da1d6a5d20e03842
Author: Mike Kelly <pioto@pioto.org>
Date:   Tue May 7 10:50:12 2013 -0400

    rbd: Support using a custom secret

commit 75c203facb92cfcc7e058ca2a743e381a97e2466
Author: Mike Kelly <pioto@pioto.org>
Date:   Tue May 7 10:50:11 2013 -0400

    libvirt: extract usernames for network disks

commit f3e01b69e04a0e8321e9d54ca39a4d7ea762f80d
Author: Mike Kelly <pioto@pioto.org>
Date:   Tue May 7 10:50:10 2013 -0400

    rbd: support usernames, for cephx authentication

commit 1806828885cc34257d347c288efea248de255c32
Author: Mike Kelly <pioto@pioto.org>
Date:   Tue May 7 10:50:09 2013 -0400

    libvirt: initial support for networked disks

commit 2ce06ec808ce1c9ca9e6190f3ddc043b43e3b576
Author: Mike Kelly <pioto@pioto.org>
Date:   Tue May 7 10:50:08 2013 -0400

    rbd: send mon_host for rbd drives
    
    This is how the servers are passed to kvm.

commit 13fba490cdbcea2371ca11593767087dbf0c21c3
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Wed May 1 23:15:48 2013 +0200

    Fix rpcgen call for separated builds.

commit 66145799cb1b4b0c7598966a668b7f8a8cb890a9
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Wed May 1 23:14:38 2013 +0200

    perl: Fix install target for separated builds.

commit 34b106c3917fe65c69e0587b2664c38886aa21db
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 2 14:28:00 2013 +0100

    Version 1.21.36.

commit 333337b6a9b1a6d3fd383a99d496771f808e008e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 2 13:18:12 2013 +0100

    debian: Add OCaml .depend files to DISTCLEANFILES.
    
    Otherwise debuild complains that these files have been created after
    it does a 'make distclean'.

commit 5faba45fe1adfaeb316e4616d4e3a4937e57e599
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 1 09:44:47 2013 +0100

    tests/c-api: Various code refactorings.
    
    - Don't use fixed names for the disks.  This will allow us to
      parallelize this test.
    
    - Add a new "GETKEY:<key>" String parameter which can retrieve keys
      from the handle.  The temporary disk names are stored as keys.
    
    - Don't test the close callback.  However this uses the close callback
      mechanism to delete the temporary disks, and in any case close
      callbacks are well tested by the language binding tests.
    
    - The generated code now produces a static array of tests (instead of
      a 'perform_tests' function), making it possible to parallelize.

commit f003c50c520f9515f433b0043a69ebd5154060ed
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 1 09:34:39 2013 +0100

    tests/c-api: Remove global guestfs handle.
    
    This will allow us to parallelize these tests.

commit 76950a0e8de277c7b51645fc36a7dd902852b126
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 1 09:33:51 2013 +0100

    tests/c-api: Warn about deprecated functions in main program.
    
    And replace deprecated guestfs_set_close_callback with
    non-deprecated guestfs_set_event_callback.

commit 9d5236d73cd0ec0c70172fa301c4722bb458db5d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 1 09:09:55 2013 +0100

    tests/c-api: Factor out common init_* into separate functions.

commit 02fbf566e88624f581ab67b1cc818f36e1dfdc33
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 1 08:36:16 2013 +0100

    java: Standardize Java test numbering.

commit ad1e9e7eace04ce92730691be7d0dbd56bb2af9d
Author: Mike Kelly <pioto@pioto.org>
Date:   Tue Apr 30 13:49:10 2013 -0400

    ssh: fix setting the username part
    
    Right now, we'd always be setting a NULL username.

commit 3c43019f8df837f3c0c4325679d46cbb336eced2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 30 17:41:05 2013 +0100

    ruby: Standardize test names and numbering.

commit a24639d7d38bc4ffd5d242611ebe75be8cc1a482
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 30 17:34:22 2013 +0100

    python: Standardize test numbering.

commit 897a69604dd2f3999b829376ae10ff7c6e6b3288
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 30 15:42:31 2013 +0100

    perl: Make the 030-create-flags test same as canonical OCaml version.

commit dc3b783b51a83df1a986c1456b01a1a38dba9d96
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 30 15:41:08 2013 +0100

    ocaml: Set close-on-exit flag to true in this test so handle is cleaned up.
    
    Otherwise the valgrind test fails since the handle resources
    are leaked.

commit a2a6cfba569316372e2b90230ed06094816bf464
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 30 15:08:58 2013 +0100

    Version 1.21.35.

commit 1623f540b113391b2f5b91f0f5a6e31e5bf2bed2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 30 13:25:16 2013 +0100

    erlang: Make separated builds work correctly.
    
    Set ERL_LIBS and also create a phony 'ebin' directory for the
    guestfs.beam (library) so that the tests run against the local copy
    not the installed version, and so that separated builds work.

commit 327403f3acf4654e4259dd66070d473601ee41cd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 30 13:25:01 2013 +0100

    erlang: Add a CLEANFILES rule.

commit d9f5829ebe7b10d6b4193c08c5bee1d2df4fd0c6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 30 12:48:44 2013 +0100

    python: Fix for separated builds.
    
    Ensure that ./run sets PYTHONPATH to include the Python source
    directory (location of guestfs.py).

commit 4ea016dae96ed4fc3ca6d057f17fde9697f0e627
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 30 12:22:54 2013 +0100

    perl: Fix build and test to work with separated builds.
    
    This is inspired largely by Hilko Bengen's equivalent
    hivex patch here:
    
    https://github.com/libguestfs/hivex/commit/887466794a40f57b84ce32524e1a650d6674c7e6

commit 440183b440ae66011e1739f64744c45d8c8c4220
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 30 12:20:53 2013 +0100

    perl: run-bindtests: Don't set PERL5LIB.
    
    This environment variable should already be set properly
    by 'run', there is no need to set it from this test script.

commit 21dd1c50c9a961551c6224f2fc0687cff2057a65
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 30 12:49:32 2013 +0100

    ./run: Set s= (srcdir).  Use absolute paths.

commit 93e64b4448c7afccf4c4751ff5deba3e321e7851
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 29 19:25:14 2013 +0100

    tests/mountable: Fix incorrect use of inspect-os API (RHBZ#957380).

commit 4e5ed8ff7be8c2de6450ffccba184f45abb09ae8
Author: Mike Kelly <pioto@pioto.org>
Date:   Mon Apr 29 12:57:14 2013 -0400

    Make a 1G test image instead, avoiding a size bug
    
    mkfs_btrfs: /dev/vda2: device /dev/vda2 is too small (must be at least
    256 MB) at .../libguestfs/tests/guests/guest-aux/make-fedora-img.pl line
    140.

commit 0da34f968c6d6f75740a83020a57bd0775e53c78
Author: Mike Kelly <pioto@pioto.org>
Date:   Mon Apr 29 12:57:13 2013 -0400

    Refactor image partition sizing

commit 852beefc4c0d44e15596798028b902d325f24882
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 29 16:41:06 2013 +0100

    Version 1.21.34.

commit d02af3a3110dac69ae8a70572a976f8464ce5823
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 29 16:08:47 2013 +0100

    perl: Almost standardize the Perl tests.
    
    This needs more work, but brings them mostly up to the same
    standard form as the OCaml tests and the test documentation.

commit f82a9dbf0fbc66fb099c68cea0d17ac2e4dc67a9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 26 16:49:58 2013 +0100

    ocaml: Standardize the test sequence for all bindings; implement this for OCaml.
    
    The idea behind this change is to have a consistent set of
    tests across all bindings, while at the same time saving time.
    For background see:
    
    https://www.redhat.com/archives/libguestfs/2013-April/thread.html#00069

commit cc93840d31e440e64e27ee13df3afd134ef2e68f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 29 15:22:34 2013 +0100

    tests: Add a regression test for RHBZ#957772.

commit c5f356a60351dd51cbd3a9aabcac2cd40562f36a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 29 15:23:27 2013 +0100

    daemon: Properly quote arguments for tar-out, base64-out commands (RHBZ#957772).
    
    This fixes commit c78ec7e085e99bfddd0509dece72bf6a8d0188ce
    which was an attempt to fix RHBZ#908322.

commit 79688aff7483dfcdc1034564cac6cae9999e4324
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 25 20:08:18 2013 +0100

    ./run: ruby: Set $RAKE and fix Ruby tests.
    
    This wasn't set which caused Ruby tests to silently not run
    without any indication.

commit 0d989d52a615b86aa65477c7719e9c7e49b18873
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 25 20:10:26 2013 +0100

    ruby: Fix segfault in regression test.
    
    This was revealed by the regression test for RHBZ#664558.
    Unfortunately because Ruby tests had been silently disabled,
    this regression test was never run.

commit 2ea9d82a23c7b28f87e89541ba7f455cad9e950e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 25 20:09:28 2013 +0100

    ruby: Fix optargs test.

commit cd4c2c6caa50339c1d8f0f418b8340eb7c7bd5e2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 25 14:59:19 2013 +0100

    Version 1.21.33.

commit a30b41f73560af492cbebecc4f6cd9258db8df0b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 25 13:34:24 2013 +0100

    tools: The programs are located in the source directory.

commit 9e9be1cee717acd5c43c1e4ae9d39029649be962
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 25 13:34:06 2013 +0100

    python: Test programs are located in the source directory.

commit a9c81f1919375519d1e3f1555b480f152fa0ceb0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 25 13:33:46 2013 +0100

    fish: Add $srcdir in several places where test files exist in the source directory.

commit 7af69445f2b64448b8ce2d0b314daacfcd01112e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 25 13:33:24 2013 +0100

    tests/rsync: This test only copies generated files.

commit 5057a8f3442882bb5e350d8124a500cfebda1e94
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 25 13:33:00 2013 +0100

    tests: Add $srcdir in several places for test files located in source directory.

commit 073da79e5bd09a5cdcff7151386d1d02135d4118
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 25 13:26:35 2013 +0100

    tests/xml: Get XML data file from source directory.

commit 423a2d9dde99b102347d3418069aff56a00161e0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 25 13:24:23 2013 +0100

    tests/btrfs: Get data files from source directory.

commit 59b9ee181b25dbcc5bb8660e6bc7538c1805a471
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 25 13:20:48 2013 +0100

    tests/selinux: Pick up run-test.pl script from source directory.

commit 86025d33a8ced775361487073563c3d5fe90b955
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 25 12:44:17 2013 +0100

    tests/guests: Various fixes for separated builds.
    
    This now correctly builds all the phony guests when
    builddir != srcdir.

commit 5d6a08e2c80b3c297e3d9d4d17aef893ea8c87ab
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 25 12:36:55 2013 +0100

    tests/guests: Don't include fake Windows binary hive files in git.
    
    This means that people compiling from git will be required to have the
    'hivexregedit' command (from hivex).

commit c0d1a74023dbac77f6c4e526967d185a1615b977
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 25 12:33:31 2013 +0100

    tests/guests: Ensure hard to generate files are cleaned by 'make distclean'.
    
    This allows us to switch from non-separated to separated builds
    without breaking (the user must do 'make distclean' between the
    switch).

commit c3bf39a1f91792390eef9790b43d059e3161522d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 25 12:20:53 2013 +0100

    perl: Fix 'make check' to find bindtests.pl in source directory.
    
    Despite this change, separated builds are still broken, apparently
    because ExtUtils::MakeMaker doesn't support this sort of
    configuration, or else we're using it wrong.

commit b7da435003c6d6da3b78bbd70f51e22dba07486b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 25 12:02:16 2013 +0100

    tests/c-api: Allow FileIn paths to be prefixed by "$srcdir".
    
    Since tests involving FileIn will often wish to read from local files,
    it makes sense that they would want to open files in $srcdir.
    
    Therefore allow such paths to be prefixed by "$srcdir" which is
    substituted at run time by the same named environment variable (set by
    automake).
    
    This fixes separated builds in tests/c-api directory.

commit a1e51676fd42b8919a22d4c13cdc6a7e0ac091fb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 25 10:40:18 2013 +0100

    Remove many uses of $(builddir).
    
    "$(builddir)" is always "."
    
    Therefore most uses of $(builddir) are suspect and should be
    removed or replaced with "."

commit c1898ee996858a94bdaddc3b8a497784bc5d0cc5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 25 10:39:30 2013 +0100

    appliance: Fix rule for building supermin.d/init.img.
    
    Use a temporary directory instead of copy hack.

commit b426540b7f4b7687f7635cc5ed4901533fecb4d5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 25 10:33:40 2013 +0100

    tests/data: Add a comment noting a bug in the Makefile.
    
    abssymlink is an intentionally dangling symlink, but this confuses
    make which thinks it has to rebuild the rule every time.

commit 71ca0f8ecef2f77af9e6363c48affbed9d26eb62
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 25 10:33:16 2013 +0100

    tests/data: Don't prepend build paths with $(builddir).
    
    It's both unnecessary and confuses make.

commit 618a4372cfc21adf009590b03ca5575533766f79
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 25 10:32:42 2013 +0100

    tests/data: Fix initrd when doing separated builds.
    
    Otherwise the initrd contains paths like '../../tests/data/empty'
    which obviously causes the tests to fail.

commit 0ec2726a522b1f9253378707ce0bd7766b12bfcd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 24 20:35:05 2013 +0100

    php: Disallow separated builds.
    
    As it stands, this will just break.  Until it is fixed, give a
    diagnostic message.

commit 13c0b780a33aabdeb44491dd35dbb62c3d3a7cbd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 24 20:36:15 2013 +0100

    gobject: Fix separated builds.

commit a8b26aaab922fdb15940cb7f8bcb3a095d2a0bae
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 24 20:36:04 2013 +0100

    haskell: Fix separated builds.

commit aab50b9c5051e6014e5598ed0cd31245d942b696
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 24 21:44:17 2013 +0100

    java: Allow source directory to be prepended by make.
    
    Fix for separated builds.

commit 1d252d7149a27fe671f9eee55154828157ebc552
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 24 20:35:37 2013 +0100

    java: Bindtests.java is generated in the source directory.
    
    Fix for separated builds.

commit 5ab516d0684c9181a88449425a68f3ed1317e7c0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 24 20:25:25 2013 +0100

    ocaml: bindtests.ml is generated in the source directory.
    
    This seems to be necessary because separated builds don't recognize
    the *.ml file as being a source file (unlike, for example, *.c files).

commit fdbe6d81f45aa9644de89e62db26b51b84cd68e3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 24 21:43:13 2013 +0100

    generator: Place generator, stamp-generator, build files into builddir.
    
    Previously the generator binary was (deliberately) placed into the
    source directory.  However there was no real reason for this to
    happen.  Always put the build products into the builddir.

commit e72855e4fa02d30da6f697dc17f4f4953ff402de
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 24 21:09:56 2013 +0100

    generator: Make stamp-generator in the Makefile.
    
    Since stamp-generator is a Makefile thing, make it in the Makefile,
    not in the generator itself.
    
    Also this ensures stamp-generator is created in the builddir, not in
    the source directory (fixing separated builds).

commit 88271bab7cbfc3b19521fed580635b3c93f97a32
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 24 20:32:25 2013 +0100

    configure: Make sure that certain build directories exist.
    
    When builddir != srcdir, this ensures that certain build directories
    which might not exist are created by configure.

commit c4255fd0e3d187a48ff5287221467a61b962ec70
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 24 20:34:10 2013 +0100

    tests/data: Ensure all generated image files are removed by 'make clean'.
    
    Otherwise the build breaks if you switch from a non-separated build to
    a separated build.

commit 3f450de0a945c17cabc1ddc5d411748422aa2d12
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 24 18:42:12 2013 +0100

    Fix 'make distclean'.
    
    Because the generator subdirectory is cleaned first, and other
    directories recurse into the generator directory, 'make distclean'
    would fail (because generator/Makefile would be deleted by that
    point).
    
    Change subdirs-rules.mk so it doesn't fail if generator/Makefile has
    been deleted already.

commit 88b59ea92f59569d73d99e23b03b045c2abb612d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 24 18:41:39 2013 +0100

    subdirs-rules: Remove 'appliance' rule.
    
    It was used in only one place (perl/Makefile.am).
    
    If users want to build just the appliance, then they could do 'make -C
    appliance'.

commit 1add24e77471eb88af03d2f7ad41e11a0d4b7cb9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 24 15:22:34 2013 +0100

    configure: Create resize/ subdirectory if building in a different builddir.

commit 6c71ab2208995e46deaefbd8daa0fcdb364c74cf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 23 10:34:57 2013 +0100

    Version 1.21.32.

commit d99e26d2f3c637b52c6cf65502c05d05db2ee5db
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 23 10:59:19 2013 +0100

    tests/guests: Add make-guests-all-good.pl to EXTRA_DIST.
    
    This fixes commit 2ae72dcaf89130647f03ff7c3d0900215a91f59a.

commit 83659caadbb695fd4ccfc5b31104f46b9083d30a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 23 10:37:11 2013 +0100

    release notes: Fix unterminated C<...> sequence in POD.

commit fecc74e080aa89bc1f4f07b815792c1998edf48f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 22 16:11:32 2013 +0100

    tests: sysprep: Specify list of operations explicitly.
    
    This commit makes no functional change on its own, but it allows us to
    filter out failing operations on Ubuntu.

commit 50003c8cba6082308b2a3edb17ef90be8dc0e0f3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 22 13:59:01 2013 +0100

    grub-install: Change test to use /dev/sda instead of /dev/vda.
    
    The previous test for grub-install hard-coded /dev/vda (ie. assuming
    virtio-blk instead of more modern virtio-scsi).
    
    This changes the test to hard-code /dev/sda instead.  However this
    change is still not correct since /dev/sda will be adjusted by block
    device name translation in the call to grub-install, but not what is
    written to /boot/grub/device.map.
    
    Since we no longer support grub-install on Fedora, this won't affect
    things, but Ubuntu still has a 'grub-install' command (although it's
    actually from grub2).

commit 2e6e77fd0225a2f89494356a643919f021b053ef
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 19 16:05:48 2013 +0100

    gobject: Link libguestfs-gobject library with GIO.
    
    So that we get the g_cancellable_* symbols.

commit 1eaf338acdd4ee60cc85ae74417fd055534ff69d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 19 15:52:54 2013 +0100

    gobject: Link libguestfs-gobject library with GOBJECT_LIBS.
    
    There's no such thing as a _LIBS variable in automake, so
    this line was effectively being ignored.

commit 6a5495ea3c085eb557526d5e1431cf3c8bbe4bc4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 19 15:37:40 2013 +0100

    virt-ls: Use string instead of small array.
    
    This works around the following warning:
    
    virt-ls.c: In function 'show_file':
    virt-ls.c:574:1: error: stack protector not protecting function: all local arrays are less than 4 bytes long [-Werror=stack-protector]

commit 2da8d495908a5d716ba505def7794bc25555fca0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 19 15:29:50 2013 +0100

    examples: Don't ignore return value of chdir.
    
    GCC 4.7.3 whinges about this.

commit 2ae72dcaf89130647f03ff7c3d0900215a91f59a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 17 20:06:24 2013 +0100

    tests: guests: Auto-generated guests-all-good.xml.
    
    Only include guests which we successfully created, so for example if
    there's no NTFS support then the Windows guest won't be included.

commit 0c605eb94f20cb08e4a858988e0da121af6f66cb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 17 18:00:18 2013 +0100

    tests: guests: Display some information about each phony guest for debugging.
    
    This adds debugging output like this:
    
      fedora-btrfs.img: file size bytes: 536870912
      fedora-btrfs.img: allocated bytes: 12963840
      fedora-btrfs.img: MD5 hash:        7e8eded44fc832b0f88b0dc5eebf490c

commit b7ccdd7cf38e297325cc05889e349ee29f05766a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 17 17:03:13 2013 +0100

    tests: Mark 'skipped' function with __attribute__((printf)).
    
    With recent GCC, you get this warning:
    
    tests-main.c: In function 'skipped':
    tests-main.c:256:3: error: function might be possible candidate for 'gnu_printf' format attribute [-Werror=suggest-attribute=format]

commit 6af706846fd718b4a26fbb3abaf498d3a36cf6aa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 17 08:55:28 2013 +0100

    Version 1.21.31.

commit 3b0e4328751a5a1319d7164452e295515df1218d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 16 20:22:42 2013 +0100

    fish: options: Allow Unix domain sockets to be specified in --add URIs.
    
    You can now use a URI such as:
    
     guestfish -a nbd://?socket=/tmp/sock
    
    (a NBD connection to Unix domain socket /tmp/sock).

commit 44092e06ce459dce1be5658bba2c8cf4dd438d54
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 16 19:33:54 2013 +0100

    fish: options: Format server name as "tcp:host[:port]".
    
    This is safer, because otherwise a URI could contain some clever
    "unix:..." string as the hostname, tricking qemu into opening a Unix
    domain socket at an uncontrolled location.
    
    This fixes commit 349300af08be9ae9f3d7259e688e2ee5318f2171.

commit 87690b10ffaaf4a23e290ca8ae2421a5b74e143a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 16 19:36:29 2013 +0100

    df: Move variable decl to top of function.
    
    Since this code is no longer conditional, we don't need to have the
    extra { ... } inside the case statement.
    
    This tidies up commit 2f0a4d7c18e622c48e33edc3f80dbd593c6398bc.

commit f5544e8c93d5683010e4f8fb5b799762cd95ebe7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 16 18:41:32 2013 +0100

    Version 1.21.30.

commit 2f0a4d7c18e622c48e33edc3f80dbd593c6398bc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 16 16:39:48 2013 +0100

    Require libxml2.
    
    libxml2 is very commonly available on Linux distros and has also been
    ported (and is widely available) on Mac OS X and Windows.  Therefore
    simply require libxml2, and remove a lot of conditional code.

commit 349300af08be9ae9f3d7259e688e2ee5318f2171
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 16 13:57:38 2013 +0100

    fish: Add -a URI (add remote storage) to options.
    
    Add a remote drive by doing:
    
     guestfish -a ssh://example.com/path/to/disk.img
    
    There are several different protocols supported, as explained in the
    man page.
    
    This affects all virt-* tools that use the common guestfish options
    parsing code.

commit b48e416d27412674b8f11de9cfcef079adf6ccf2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 16 13:57:01 2013 +0100

    fish: options: Whitespace change.

commit cfda2693c608db532c4cc6aecc37c1624af6c0fb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 5 13:01:19 2013 +0100

    Add support for SSH (Secure Shell) block device.

commit ca11cd104dae4a2d301a2d8e9f511b4073bd7c81
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 15 09:51:24 2013 +0100

    FAQ: Add a quick summary to the debugging section of the FAQ.

commit 848db89b7f4aacd7f514f42967193c10460b3493
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 13 10:48:08 2013 +0100

    Version 1.21.29.

commit 288a24eebe88c538a404501fcce5c5b524c390b6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 12 22:16:25 2013 +0100

    tests: Split C API tests into regular C file + generated tests file.

commit 883aea9b1dd69648c0f5bb455955e3165254de7e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 12 22:00:01 2013 +0100

    tests: Replace TestOutputHashtable with TestResult and C test.

commit c43f762257e749178e181a165088b98efe2d0384
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 12 18:21:56 2013 +0100

    tests: Replace TestOutputBuffer with TestResult and C test.

commit 424fe36d32ba762767bd8446f3c7b19b121dff10
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 12 18:11:43 2013 +0100

    tests: Replace TestOutputFileMD5 with TestResult and C test.

commit 0a49838135f9ae1325b69d2853a63267c58fb889
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 12 17:35:06 2013 +0100

    tests: Remove TestOutputLength (not used by any tests).

commit 685c5fb3b10e45bb8c4b60480da805a49cadb9c7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 12 17:19:22 2013 +0100

    tests: Replace TestOutput/TestOutputDevice with TestResult{String,Device}.

commit 45840581d637bde85b235d2a074cb4316db2cdaf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 12 16:17:08 2013 +0100

    tests: Replace TestOutputList{,OfDevices} with TestResult.
    
    This adds helper C functions 'is_string_list' and 'is_device_list'
    allowing these tests to be carried out in generic C code instead of as
    specialized tests.

commit 45599a8895097a836e7296e29c5fa59f40234875
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 12 15:26:22 2013 +0100

    tests: Replace TestOutputStruct with TestResult.

commit 24fdf05d30c15a383c41390ba80579433e67c83a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 12 14:34:51 2013 +0100

    tests: Replace TestOutputInt{,Op} with TestResult.

commit c9ef854f8327e2f79ce3c763de3d8b2ee987621e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 12 14:13:39 2013 +0100

    tests: Replace TestOutputTrue/False with TestResultTrue/False.

commit 008be5dbfa4df03a6ead8a07cf40d170efd21455
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 12 13:27:08 2013 +0100

    tests: More flexible re-implementation of C API tests.
    
    Instead of using the various 'TestOutput', 'TestOutputList' etc
    macros, it makes better sense to let the tests contain fragments of C
    code to perform the checks.
    
    Several new macros are added:
    
    - 'TestResult': This macro takes a C expression which is evaluated to
    test the result of commands.  For example to compare if a string
    result has some value:
    
       TestResult (* command sequence *), "STREQ (ret, \"abcd\")"
    
    The variable "ret" contains the result from the last command in the
    sequence.  But also, variables "ret1", "ret2", etc contain the results
    from the last but one command, the command before that, and so forth,
    allowing much more flexible tests to be written.
    
    - 'TestResultTrue', 'TestResultFalse': Wrappers that test the last
    command for true/false.

commit e327351304d603e8f12b7a95ab277ae480d4edec
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 12 10:10:55 2013 +0100

    tests: 'If' and 'Unless' conditions never used, so remove them.

commit 09b4cc45a3da90e565e502d62137f089b116235d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 12 10:13:19 2013 +0100

    is_lv: Does not need to depend on lvm2.
    
    It only uses 'stat', not any lvm binaries.

commit e4ef9a82817120deee0282ed4ae2a3d255ef54da
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 11 17:58:28 2013 +0100

    valgrind suppressions: Suppress libmagic leaks.

commit a7107854ba67a5d0295e1df9c48342fc3eebd142
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 11 23:21:17 2013 +0100

    debian: packagelist: Add mtools.

commit 3acf6768f0142d71b826b255e00d31276b8982ac
Author: Olaf Hering <olaf@aepfle.de>
Date:   Thu Apr 11 20:41:44 2013 +0200

    add --with-supermin-extra-options configure option
    
    Useful to pass --use-installed and other options to supermin.
    
    Signed-off-by: Olaf Hering <olaf@aepfle.de>

commit c2013308eda5279e4af5f31a1046d3bef9be9ca1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 11 14:41:24 2013 +0100

    Update translations from Transifex.

commit f4d5f3d6a21ac2c602fd2b85e283df3fc7e8f2ae
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 11 14:26:06 2013 +0100

    Update gnulib to latest.

commit 142b874ce8ddc09a06e765df66445a3611d61c29
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 11 13:30:22 2013 +0100

    Remove use of gnulib progname module.
    
    It's simpler to use the glibc 'program_invocation_short_name(3)'
    feature, and fall back to a generic solution.  Also remove risky
    assignments to argv[0].

commit f2b90b374fe7d8e111cd9f4a0e840fa55b91f4f6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 11 12:19:00 2013 +0100

    New APIs: set-program, get-program.
    
    These set or get the program name in the handle.  Most programs
    will never need to call this, since we set this, if possible,
    using the glibc 'program_invocation_short_name(3)' feature.

commit 1a06ac25f574ae3def52a7b5d8fbfe6950d8e4bf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 10 11:57:49 2013 +0100

    fish: Add help for prepared disk images to the man page.
    
    Also the long description for each prepared disk image can now contain
    Perl POD markup.

commit b72daebaf4a859769455a1db70a40603cb5597be
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 10 10:01:17 2013 +0100

    inspection: Don't fail if libosinfo database is not found (RHBZ#948324).

commit 2cf0b5c19b1ecdb7aa8f676a460282bf074d9fd8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 9 23:25:53 2013 +0100

    fish: welcome message: guestfish can edit disk images.

commit abe07ce2ca559db557eaf2c6a456e8b3f71ca516
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 9 23:15:24 2013 +0100

    "guestfish" now means the "guest filesystem shell".
    
    Remove the word "interactive" which implies that guestfish can only
    (or often) be used interactively.

commit 6a7327dfa98adab3ecfeac1cf1297fa835027141
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 9 18:45:15 2013 +0100

    Version 1.21.28.

commit c396d4cd326541e215df5bd4c845ea92c63a81b7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 9 17:30:09 2013 +0100

    examples: Update debug-logging.c example.
    
    This updates commit e3546ad2ce2c0d953e3be2b072bacd48972450af.

commit e3546ad2ce2c0d953e3be2b072bacd48972450af
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 8 20:10:07 2013 +0100

    examples: Add example program showing enabling debugging and capturing log messages.

commit 6582d4ad9fdb15edc346f6420b01c707e40f8541
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 5 10:33:58 2013 +0100

    Update release notes for future 1.22 release.

commit a3de6eddd49c81349dbdb041ba0d4b40f1ef3fd3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 5 10:33:25 2013 +0100

    pod: Fix "wide character in print" warnings by declaring encoding correctly.

commit dfa25a46e35b87ae8a5e548d383e8bf75b4b4b26
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 4 22:14:25 2013 +0100

    Fix typo in extlinux documentation.
    
    This fixes commit dee1dd64c3cd5e67393dec679040eb02e81c84b0.

commit f9f3c7c5acd1b47ff3e263ee3b89d45dd0613a16
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 4 21:04:32 2013 +0100

    Version 1.21.27.

commit dee1dd64c3cd5e67393dec679040eb02e81c84b0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 4 16:06:43 2013 +0100

    New APIs: Add support for syslinux and extlinux (bootloaders).
    
    This also adds tests of SYSLINUX and EXTLINUX which create bootable
    guests.

commit e73cd348c8a2786b5e9874dd1f96cf7bc36412f2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 4 18:21:01 2013 +0100

    Don't delete iconv locale data from the appliance.
    
    - /usr/lib{,64}/gconv/*:
    
    This is the iconv data, required for APIs like iconv_open to work.  In
    particular, the mtools 'mcopy' program fails completely if it cannot
    use iconv.  'mcopy' is used by SYSLINUX to copy files to the disk.
    
    The error you would have seen is:
    
      Error converting to codepage 850 Invalid argument
      Cannot initialize 'S:'
      Bad target s:/ldlinux.sys
    
    - /usr/bin/localedef and /usr/sbin/build-locale-archive:
    
    These are not really needed, but both are simply small binaries so we
    might as well not delete them.

commit 3cdca7616a5f5a550d93e4f088b1b97fd7c9a602
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 4 14:15:44 2013 +0100

    daemon/copy: Ensure errno is preserved along error paths.

commit 33c087ea9c72f74da8cc7cfd86d9fc6ca5c92b6b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 4 13:45:42 2013 +0100

    Add 'sparse' option to copy-{device,file}-to-{device,file} calls.
    
    Setting the 'sparse' optional boolean causes writes to be omitted if
    the block to be written contains all zero bytes.
    
    This should help with sparse backing files (eg. raw, qcow2, dm-thin, etc).
    
    Also, modify virt-resize to use this option by default when copying
    devices.  The savings in virt-resize can be quite startling, eg
    'du -sh' (ie. true size) of a resized disk image:
    
    8.1G      /tmp/f15x32-resized.img    # before this change
    3.2G      /tmp/f15x32-resized.img    # after this change

commit 289fd29f0bfbb94566d9780dd8ac3fe15e55541d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 4 11:49:27 2013 +0100

    php: Fix segfault when function has an OStringList optional argument.
    
    How this PHP/Zend stuff is supposed to work is not documented, but at
    least with these changes it no longer segfaults.

commit ba0199c487feec7f02cfc00ba3e900e6fa5ed4d8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 3 18:58:43 2013 +0100

    python: Let RHashtable be returned as a Python dict.
    
    The initial proposal was suggested by Matt Booth and discussed on the
    mailing list here:
    
    https://www.redhat.com/archives/libguestfs/2013-April/msg00007.html

commit 3dcb572bda87385ee9db4574b888120667aa4ece
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 3 12:33:24 2013 +0100

    Better error messages for FUSE and other things not supported.
    
    The bare message "FUSE not supported" wasn't actionable.

commit d0a8cca9a1a399d43c6e44dfc655eedbe61d22ec
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 2 15:53:37 2013 +0100

    FAQ: In Fedora >= 19, the RPM detects if it can access the network when building.

commit 387b232126cca86ad45f2a608f492d7b89ed714a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 2 15:25:48 2013 +0100

    Version 1.21.26.

commit 667482ca9a4268ef5b3565b274159e39efac0ef2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 2 12:28:27 2013 +0100

    perl: Remove Sys::Guestfs::Lib.
    
    See announcement on the mailing list for more details about this change:
    
    https://www.redhat.com/archives/libguestfs/2013-April/msg00001.html

commit 2287b988ee85fe478c4b3a9aed268d705b879bba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 2 13:11:33 2013 +0100

    perl: Remove use of Sys::Guestfs::Lib::open_guest function.
    
    This obsolete function does all sorts of libvirt/XML things, which can
    now be replaced by using ordinary API calls; especially $g->add_domain.

commit ecda39bed408ebbbe86b757d4a424391944a2572
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 2 13:05:30 2013 +0100

    tests/data: Update README and comments about initrd binary files.
    
    These are used for testing the C, not Perl, file_architecture API.

commit 1cb38ab9244347c78787a1e0832081c6edbfd716
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 2 12:27:34 2013 +0100

    New API: feature-available.
    
    This API is an easier to use version of the existing guestfs_available,
    because the new API returns true/false instead of throwing an error
    when a feature from the list is not available.
    
    In truth we've had this implementation internally in the library
    and several tools and in Sys::Guestfs::Lib for a long time.  This
    change just turns it into a publicly consumable API.

commit 288b2b2d4fa642e7a58728f1900d416ecb1e8328
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 2 10:14:51 2013 +0100

    virt-ls, virt-edit: Remove references to Sys::Guestfs::Lib and other irrelevant Perl libraries.

commit 6fa1177b0a429b13034797e3471da0dbbc4ccac3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 1 20:29:17 2013 +0100

    java: Make test cases depend on jar file.
    
    This fixes parallel builds.  The error you would have seen was:
    
      error: error reading libguestfs-1.21.25.jar; zip file is empty

commit 1a2e03c323cdc28d74d276c5c2a5b02df41d38f7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 1 20:28:16 2013 +0100

    java: 'make clean' should remove whole api/ directory.
    
    This directory (containing HTML documentation) can be removed
    completely when making clean.  CLEANFILES cannot recursively remove a
    directory, so use a clean-local rule instead.

commit ce49e1fdc05ddad306fcf2278429f0433c7f954e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 1 11:57:22 2013 +0100

    build: Change various check rules so they implicitly act like 'make -k'.
    
    Rules such as 'make check-valgrind' are implemented using a for-loop.
    They would always exit after the first error, even if 'make -k' was
    used at the top-level.  Since 'make -k'-style behaviour is generally
    more useful, change these for-loops so they run all the tests, and
    report errors at the end.

commit 599f5d7ddc793189a6ebfd61ccfac3abe6644cec
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 1 13:31:16 2013 +0100

    make clean: Remove *~ (editor backup) files.

commit 5f5ce4f59fe9d27bddef9ad5fe9712fe6bc663dd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 1 11:40:35 2013 +0100

    make clean: Clean contents of tmp directory.

commit b050d7e4bf2cdbd04e980511635687f1114035e0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 1 11:35:26 2013 +0100

    valgrind: Write separate log files in tmp/valgrind-<DATE>-<PID>.log
    
    Current code wrote a single valgrind.log in the top-level directory.
    This was overwritten with each valgrinded program, which wasn't much
    use.  The new version writes multiple separate valgrind-*.log files
    containing the date and PID (so each is unique).
    
    It would nice if valgrind could delete log files that don't contain
    errors, but this doesn't appear to be possible.

commit 68990840b64491b39ab8da5f1e46367ae5f01594
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Mar 31 21:58:46 2013 +0100

    "attach method" is from now on known as "backend".
    
    This large, but mainly mechanical commit, renames "attach method"
    everywhere to "backend".
    
    Backwards compatibility of the API (guestfs_{set,get}_attach_method)
    and environment (LIBGUESTFS_ATTACH_METHOD) is maintained, but in new
    code use guestfs_{set,get}_backend and LIBGUESTFS_BACKEND instead.
    
    The default backend (launching qemu directly) is now called 'direct'
    instead of 'appliance', although you can still use 'appliance' as a
    synonym.

commit f2b1a01e76ba8bd6865c5a2bed3204e222b43a08
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Mar 31 22:54:23 2013 +0100

    build: Clarify output of 'make help'.

commit 72f5a6b004f07910eef2557066a0a8ce45b26087
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 30 22:56:06 2013 +0000

    Version 1.21.25.

commit 75f2fcd68799f54951e9f75528ac7ea66c01ce69
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 30 19:44:39 2013 +0000

    docs: Remove obsolete sections from libguestfs gotchas.
    
    These refer to old behaviour in long-unsupported versions
    of libguestfs.

commit 806289ec66ee2984cbd0840b5ed4e2e61e75a36e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 30 19:43:52 2013 +0000

    docs: Refresh API overview section.

commit b2eef585710ddbff543a74a010ba524da61d78d8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 30 19:28:29 2013 +0000

    docs: Alternate ways to list filesystems through the API.

commit 8e76cb451278676f4ede4d34a32ac15ba2251aae
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 30 19:02:35 2013 +0000

    FAQ: Update distro support section.

commit 02a4e5ac6afb7089b1f878d07c285842df0d7f37
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 30 18:16:51 2013 +0000

    debian: Allow test-virt-alignment-scan-guests.sh test to be skipped.

commit 2a090e0667b303df59f2fd068dcb61a5afe79a96
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 30 16:26:25 2013 +0000

    tests/guests: Add 'guests-all-good.xml{.in}' libvirt test guest set.
    
    This differs from 'guests.xml' in that there are no guests with
    missing disks, etc., so we can use this to test virt-alignment-scan
    accurately.

commit 429ffda3299edb1fe391c7d331ea5d32c2aab75c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 30 12:52:12 2013 +0000

    parallel: Propagate errors from worker threads and exit with error code.
    
    In virt-df and virt-alignment-scan, ensure that errors that happen in
    worker threads are propagated all the way up and result in
    exit(EXIT_FAILURE).
    
    Note that this makes the align/test-virt-alignment-scan-guests.sh test
    fail (for a genuine reason).  This is fixed in the following commit.
    
    This updates commit 8b90f55dc733e358a0892d8e6e5c67fe2cc4e891.

commit 30702c7f548fe21282cae3fe911bf51b6eb925fe
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 29 21:49:12 2013 +0000

    Version 1.21.24.

commit f55a2dbf29fb5c96e74b8ae663f313cc23a8a8b7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 29 22:02:22 2013 +0000

    java: Make bindtests depend on jar file so parallel builds work.
    
    This fixes commit c36ced5e21348f5357fc70b402664c9a5d827b06.

commit 8b90f55dc733e358a0892d8e6e5c67fe2cc4e891
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 29 21:27:56 2013 +0000

    virt-alignment-scan: Don't call exit(3) from this multi-threaded program.
    
    For more information see:
    https://bugzilla.redhat.com/show_bug.cgi?id=790837#c2

commit d6ea2f5911a6c7f3037ae822e872b810ad80ba51
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 29 20:04:11 2013 +0000

    daemon: file: Remove extraneous space after output of 'file' command (RHBZ#928995).

commit a9ad3088bf2506b082262d411c9ffd2d50016777
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 28 23:37:31 2013 +0000

    daemon: parse_btrfsvol: Perform device name translation before trying to stat the device.
    
    If using (eg) virtio-blk, the canonical name won't work unless device
    name translation is done first.
    
    This fixes commit 47b929b7893b3a76ff22760d245cb80720ae6345..

commit bb276e8a2624b122c26010ca6a44993707afaadf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 28 23:28:10 2013 +0000

    daemon: parse_btrfsvol: Move variable decls to top, whitespace fixes.
    
    This fixes commit 47b929b7893b3a76ff22760d245cb80720ae6345.

commit a28a430b1042d581e0611e5f837344485879369c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 28 23:26:15 2013 +0000

    daemon: Fix parse_btrfsvol to use STRPREFIX instead of bogus strncmp.
    
    This fixes commit 47b929b7893b3a76ff22760d245cb80720ae6345.

commit c50cde67cc979d44d8459722ae9dba0700b6d031
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 28 20:24:25 2013 +0000

    java: Format CLEANFILES rule.

commit c36ced5e21348f5357fc70b402664c9a5d827b06
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 28 20:20:09 2013 +0000

    java: Enable parallel builds.
    
    This reverts commit 89404ec0ba9781b55cb3a87689bcc519e7d73ea2.

commit 6185aa4e38ce6e1101bad9b97514a7d15927bba8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 28 20:15:51 2013 +0000

    ocaml tools: Enable parallel builds.
    
    In particular, building virt-sysprep is slow because there are so many
    modules.  Enable parallel builds.  If it breaks, we should fix it, not
    work around it.

commit dce94f3e266ed3f1fc634a1ef6953f2db1510963
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 28 20:13:36 2013 +0000

    ocaml: Fix and enable parallel builds.
    
    We only have to serialize the two calls to ocamlmklib, since both will
    try to create a file called 'libmlguestfs.a'.  Apart from that,
    parallel builds here should be fine.

commit b13c935bbd2e14f3f5654c2e0a5ab69f606b473e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 28 20:12:47 2013 +0000

    ocaml: Break circular dependency of mlguestfs.cma{,x} <-> guestfs.cm{o,x}

commit 3c34db980868057916d6fe2489ad8906660e83d6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 28 17:13:34 2013 +0000

    Use new-style demand-loaded bash-completion scripts.

commit df7f57a19388078c664a2c40300330135f965e4d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 28 15:18:43 2013 +0000

    Version 1.21.23.

commit 924aa44c1fe18386b7ee24551e0b16f0ecc7cc48
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 28 11:40:49 2013 +0000

    bash completion: Extend this script to work with other virt tools.

commit 6c9a7fe5616bda5b17eef2558e52dc1f48e87722
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 28 13:07:22 2013 +0000

    Add --long-options option to most tools.
    
    For example:
    
    $ guestfish --long-options
    --add
    --cmd-help
    --connect
    --csh
    --domain
    --echo-keys
    [etc.]
    
    The idea of this is to make it easier to write a bash completion
    script that accurately expands --<TAB> options for each command.

commit b98de580c98b1e804dbc8b6a55cabcf80a2f6e18
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 28 10:57:48 2013 +0000

    fish: Better tab completion for guestfish.

commit 05ba39372468ccd383bb3808397b2b419a022b80
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 28 13:40:38 2013 +0000

    OCaml tools: Use Common_gettext and Common_utils modules.
    
    Share these modules across all three tools virt-resize, virt-sparsify
    and virt-sysprep.
    
    This is mostly code motion.

commit 69e0f86cabfe132087ef9cda2eafd0d86b18c4a8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 23 18:57:39 2013 +0000

    osinfo: Fix declaration of guestfs___osinfo_map to work when libxml2 is not installed.

commit 186bb67c6e8496d04a6f5646df9b2fb483cdc189
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 19 12:01:24 2013 +0000

    Add support for: Gluster, Ceph (rbd), Sheepdog.
    
    These are not tested at all, and so probably won't work.  However the
    code and infrastructure is in place so we can fix bugs easily as they
    arise.

commit 97be29893e6a760bd1082008645942814a904c63
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 19 12:06:48 2013 +0000

    build: Add 'make check-valgrind-with-appliance'.

commit 62d940d2dd3a152736663ec5318b1b2e240653d6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 19 12:06:24 2013 +0000

    build: Small rearrangement of Makefile.am check-slow rule.

commit 55ce68784f447826c8796e491e8279f0df22f22a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 19 12:03:16 2013 +0000

    build: Fix 'make extra-tests' to call 'check-valgrind' instead of rule that doesn't exist.

commit 71de9ef03909218473d820938fff61665d35a6e7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 19 11:59:57 2013 +0000

    build: Turn off warning about overlength-strings.
    
    ISO apparently specified a limit of 4096 bytes/characters for strings.
    The description of the guestfish command 'add-drive' is now longer
    than this limit, causing this warning.
    
    Turn off this warning, since GCC has no problems with these strings.

commit a535befbeba39c03487c9c277cd09b68e61c3fde
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 18 22:35:43 2013 +0000

    nbd: Update and clarify the documentation for NBD.

commit 66df6ae908dc6e0d2870e04680eff15d39c808e8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 18 22:35:24 2013 +0000

    drives: Make parse_servers return an int (number of servers).
    
    This is just a code refactoring.

commit f8941b09e6756304e5fa1da82824593d1da65a63
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 18 19:46:24 2013 +0000

    Version 1.21.22.

commit dc4c959ce1ddfd2cc82284bfb24f7b5e862e791e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 18 17:30:13 2013 +0000

    nbd: Allow 'unix' transport & socket to be specified.
    
    This allows the server string to contain "unix:/path/to/socket",
    thus using a Unix domain socket to connect to the NBD server.

commit 43b6d75a08f543ab2074885e13c10fb0b80ece2f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 18 16:42:24 2013 +0000

    tests: nbd: Ensure qemu-nbd subprocess is always killed.
    
    Even if the test fails/dies for some other reason.

commit f750c3e72d35fb14abea9806aa2c39a1356872cb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 18 16:35:02 2013 +0000

    drives: Factor out common code for making a file= qemu parameter.

commit 9c32c73afd755cd1b0b5a34d1c6bf3a1dc068fca
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 18 15:48:02 2013 +0000

    drives: Allow multiple servers to be passed to add_drives.
    
    This changes the existing (non-published-in-stable) API for
    add_drives{_opt} so that instead of having separate 'server' and
    'port' parameters, now we have a single 'server' parameter which is a
    list of strings.
    
    This is so we will be able to cope with protocols such as Ceph which
    allows multiple servers, or Sheepdog which can use an implicit local
    server (ie. zero servers specified).
    
    NBD still requires exactly one server.

commit 766393d8542c9824c034016b7238c5e854ed323a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 18 15:47:34 2013 +0000

    inspection: Remove unused #includes.

commit 66417582219dd25ae794dacaaa6df2ea9f1131e1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 18 14:58:50 2013 +0000

    drives: Add a common guestfs___free_drive_source function.
    
    This refactors the code to introduce a common function.

commit 612a3f06b46d5ae651bf855980f30fc817eadc63
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 18 14:58:36 2013 +0000

    drives: Whitespace change.

commit cec0c55a358fb19b583db8bfd0514b3d8b03aee8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 18 12:04:24 2013 +0000

    drives: Change internal struct drive_source.
    
    This is just code refactoring.

commit 856c2f6a47f5230bb88564fd254e1f834ee41e43
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 18 09:55:36 2013 +0000

    nbd: Note that readonly connections are not supported by the appliance attach-method.
    
    This documents the problem and links to the upstream bug.

commit ae3011d5184eb7b9614695f87ba7d16460f558e4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 16 20:18:50 2013 +0000

    lib: Remove -Wswitch-default.
    
    This warning is actively dangerous.  Because it forces you to use a
    'default:' case in every switch statement, it means you can no longer
    detect missing cases in enums.

commit bf1c3196b53293c2f1c3cd37ab14b00b40d6e942
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 16 20:22:26 2013 +0000

    lib: Add missing cases in switch statements.
    
    These were being hidden by misguided use of the dangerous
    -Wswitch-default flag.

commit 2af946b3bf4bf0426ed72f05c653635e157ee4c6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 15 22:41:01 2013 +0000

    Version 1.21.21.

commit af1c53d104180415a8584c48f19fd4ea7df224f5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 15 22:40:06 2013 +0000

    appliance: Make sure cachedir has mode 0755 (RHBZ#921292).
    
    See https://bugzilla.redhat.com/show_bug.cgi?id=921292#c4

commit e7c78881fc539b10374d0507d6ca2c3edae65020
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 15 22:39:45 2013 +0000

    appliance: Use ignore_value() macro instead of casting return to (void).

commit c83221a869c99eb812071f72d326cf8e4525b47d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 15 14:43:50 2013 +0000

    drives: add_drive was only called from one place, so inline it.
    
    This is just code motion.

commit 694a091d3faac78acbd0b5a368856b569c7ba5e2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 14 23:09:56 2013 +0000

    lib: Add direct support for the NBD (Network Block Device) protocol.
    
    You can now add remote NBD drives using:
    
     ><fs> add-drive "" format:raw protocol:nbd server:localhost
    
    (Note that you also need to add port:NNNN if the server is running on
    a non-standard port).
    
    The corresponding qemu-nbd service can be started by doing:
    
     qemu-nbd disk.img -t
    
    This commit also adds a test.

commit e7e2b56569ddba018912193c192210ae50950815
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 14 22:34:56 2013 +0000

    drives: Make drv->readonly flag into a bool.

commit b1df9a9df121e8386222291aacac9f9f8602c620
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 14 22:15:35 2013 +0000

    drives: Refactor code to separate 'struct drive' creation from adding drives.

commit 33ec3eca298c83d5af90a899fa5f22da6bd0a266
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 14 19:11:31 2013 +0000

    launch: Move code concerned with adding drives to 'src/drives.c'.
    
    Apart from adding a few comments, this is entirely code motion.

commit a2b88b8637f1df13540bcf099c965cfc6c7112be
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 14 13:50:49 2013 +0000

    Add ./configure --with-extra-packages="..." option.
    
    This adds extra packages to the appliance.  It's useful for adding
    debugging packages.

commit 85dd52f470f8cb84dbd83c8478b7f9feb3ab7b06
Author: Hilko Bengen <bengen@debian.org>
Date:   Wed Mar 13 21:13:04 2013 +0100

    Mount /run as tmpfs inside appliance (workaround for febootstrap's /init)

commit e29a130d8f3dbf8eab23ae78aabc2d95e7f56470
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 14 12:47:40 2013 +0000

    erlang: Use $(ERLANG_LIB_DIR) to get Erlang libdir.
    
    Instead of previous custom hack which didn't work properly on Debian.
    
    Thanks: Hilko Bengen.

commit 04acc32abf5bea2ce53f695b4030be5f2147a469
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 14 12:20:52 2013 +0000

    README: Discourage general users from doing 'make install'.
    
    It causes plenty of problems with people have multiple parallel
    versions of libguestfs installed, and there's no benefit because you
    can easily run libguestfs and tools from the build directory.

commit 87c9ec881cb695724e01d9f6fc9df996d4c67cb6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 14 12:15:23 2013 +0000

    ruby: Support 'make INSTALLDIRS=vendor install' for Ruby as well as Perl.
    
    As with Perl, you can now set INSTALLDIRS to control where Ruby places
    its files (ie. in the site dir, which is the default, or in the vendor
    dir).
    
    The difference in file layout between 'make install' and
    'make INSTALLDIRS=vendor install' is shown below (for Fedora 18).
    
    --- /tmp/site	2013-03-14 12:14:35.740015694 +0000
    +++ /tmp/vendor	2013-03-14 12:14:13.668093944 +0000
    @@ -119,21 +119,20 @@
     ./usr/lib64/ocaml/guestfs/mlguestfs.cmxa
     ./usr/lib64/ocaml/stublibs/dllmlguestfs.so
     ./usr/lib64/ocaml/stublibs/dllmlguestfs.so.owner
    -./usr/lib64/perl5/auto/Sys/Guestfs/Guestfs.bs
    -./usr/lib64/perl5/auto/Sys/Guestfs/Guestfs.so
    -./usr/lib64/perl5/auto/Sys/Guestfs/.packlist
     ./usr/lib64/perl5/perllocal.pod
    -./usr/lib64/perl5/Sys/bindtests.pl
    -./usr/lib64/perl5/Sys/Guestfs/Lib.pm
    -./usr/lib64/perl5/Sys/Guestfs.pm
    +./usr/lib64/perl5/vendor_perl/auto/Sys/Guestfs/Guestfs.bs
    +./usr/lib64/perl5/vendor_perl/auto/Sys/Guestfs/Guestfs.so
    +./usr/lib64/perl5/vendor_perl/auto/Sys/Guestfs/.packlist
    +./usr/lib64/perl5/vendor_perl/Sys/bindtests.pl
    +./usr/lib64/perl5/vendor_perl/Sys/Guestfs/Lib.pm
    +./usr/lib64/perl5/vendor_perl/Sys/Guestfs.pm
     ./usr/lib64/php/modules/guestfs_php.so
     ./usr/lib64/pkgconfig/libguestfs-gobject-1.0.pc
     ./usr/lib64/pkgconfig/libguestfs.pc
     ./usr/lib64/python2.7/site-packages/guestfs.py
     ./usr/lib64/python2.7/site-packages/libguestfsmod.la
     ./usr/lib64/python2.7/site-packages/libguestfsmod.so
    -./usr/local/lib64/ruby/site_ruby/_guestfs.so
    -./usr/local/share/ruby/site_ruby/guestfs.rb
    +./usr/lib64/ruby/vendor_ruby/_guestfs.so
     ./usr/sbin/libguestfs-make-fixed-appliance
     ./usr/share/doc/libguestfs/example-debian-netinst-cd.xml
     ./usr/share/doc/libguestfs/example-debian.xml
    @@ -406,3 +405,4 @@
     ./usr/share/man/uk/man3/guestfs-perl.3
     ./usr/share/man/uk/man3/guestfs-python.3
     ./usr/share/man/uk/man3/guestfs-ruby.3
    +./usr/share/ruby/vendor_ruby/guestfs.rb
    
    For prompting me to fix this, thanks: Hilko Bengen.

commit 0fd925da77983d6f438f2494d8dd3cd122234f68
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 14 10:47:00 2013 +0000

    launch: Print attach-method, tmpdir, umask, euid when launching.
    
    These are only printed when debugging is enabled, but should help
    debugging hard-to-pin-down permissions problems.

commit df656c9d5a49af97ecfce4147a276d478c78019e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 14 08:56:29 2013 +0000

    tests: Make it easier to grep failures out of the log file.

commit 3e4d3f415cd581361444ac52ee7b27086dff37f4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 13 18:45:30 2013 +0000

    Version 1.21.20.

commit 1b644ad64eb9b9c1d6e97953b98c8c00559bf37d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 13 16:59:23 2013 +0000

    utils: Fix error messages for external commands that fail (RHBZ#921040).
    
    This adds a common utility function (guestfs___exit_status_to_string)
    and a common error function (guestfs___external_command_failed), and
    uses them all over the library and tools when converting exit status
    in error messages etc.

commit 50a3fa5f4275b5b97ac1d9a5121c89caa68cde3e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 13 16:41:29 2013 +0000

    lib: Move common errors to src/errors.c.
    
    This is just code motion.

commit e9d30742949e9e24259927fd0bd5104d6bb9bfff
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 13 17:19:17 2013 +0000

    rescue: Remove dead code.
    
    This pty code was defended by #if 0 ... #endif and was dead code.

commit 368b4c6480057ed090ee5793b6fdf88e138188e7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 13 10:57:36 2013 +0000

    Ignore case when generating AUTHORS file.

commit b17c3a7eb384a32b93acb32597db9e6290b6e22c
Author: infernix <infernix@infernix.net>
Date:   Tue Mar 12 17:37:48 2013 +0000

    launch: appliance: Add custom parameters last.
    
    This allows custom parameters to modify parameters added by
    libguestfs, eg. by doing:
    
      -set drive.hd0.file=rbd:foo/bar
    
    [infernix adds the comment below:]
    
    This works for recent versions of QEMU. The way to use this is:
    
    guestfish
    ><fs> add-drive /dev/null
    ><fs> config -set drive.hd0.file=rbd:pool/volume
    ><fs> run
    
    This will probably work for more types (sheepdog, iscsi et al), but
    with the caveat that the libguestfs layers are bypassed so you'll
    *always* end up directly accessing the disk in rw mode.

commit 0b285cd8a6b6ce351663e9fde248b904734ca4c3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 12 13:19:26 2013 +0000

    docs: Update documentation on attach-methods.
    
    Add better instructions for getting the default attach-method.
    
    Update libguestfs-test-tool(1) to show how to enable and disable
    libvirt.

commit 6e4f9be4929118c4a571f60ea10d370aa35360fb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 12 12:35:17 2013 +0000

    php: Pass all libvirt environment variables down to PHP test scripts.
    
    Including LIBVIRTD_* and VIRTLOCKD_*.
    
    This updates commit cd40cf713991569e51b42742177e57f3dca148bc.

commit 49622ab63b814f32e3b60e31ff12198551f41693
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 11 23:03:38 2013 +0000

    Version 1.21.19.

commit 5e5026b730dfea1e940e961a5b7e516a9c9bda72
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 11 18:33:17 2013 +0000

    qemu-img info: Use --output json and YAJL (JSON parser) to safely parse output (RHBZ#920225).
    
    The old parser is still used if either YAJL is not available or
    qemu-img info doesn't support the --output json option.

commit 2f8960f7844274177185f65a636c9b511980a41e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 11 16:27:13 2013 +0000

    qemu-img info: Prefix parsing functions as old_parser_*.
    
    Prefix functions in this file with old_parser_... to make it clear
    this is the old / slightly unsafe human output parser, which is
    shortly to be replaced by a safer JSON parser.
    
    This is just code motion.

commit cd40cf713991569e51b42742177e57f3dca148bc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 11 16:04:17 2013 +0000

    php: Fix tests.
    
    - Use ./run script to run the tests.
    - Set environment variables correctly, including $PATH.
    - Test the locally built, not installed, copy of libguestfs.

commit becc4fecf42955295d292aa3c7e6525b6a3e0a54
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 11 14:29:13 2013 +0000

    php: Revise README-PHP documentation.

commit c64e99782fa0648e2208ce544d816c77a9f49903
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 11 14:28:40 2013 +0000

    docs: Note that $PATH affects libguestfs.
    
    If $PATH is not set, libguestfs and/or libvirt tend to break.

commit 350c478d7b7517660d7a31e860fe993f52ff5964
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 11 14:27:25 2013 +0000

    launch: libvirt: Unset $PATH can cause libvirt launch to fail.
    
    Note this fact in the error message that is printed in this situation.

commit 02159e9aa8a1d40c8c266aabe835003ad1e32629
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 11 14:05:33 2013 +0000

    launch: libvirt: Print proper dotted libvirt version.

commit fe3798f366bbe581e9058ba03778dc49ee83dc4a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 11 13:44:50 2013 +0000

    php: Print libguestfs error string if test fails.

commit d44752a110e46c1a67ef1b9aae71e2dc0691a178
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 11 13:44:33 2013 +0000

    php: Fix test, /dev/null format must be "raw".

commit 7a968beb4682f4304ac9f17cbb7a4612c28aadb9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 11 12:34:22 2013 +0000

    lib: Give values for each state in 'enum state'.
    
    The values of CONFIG, LAUNCHING and READY and (kind of) exposed
    through the API so shouldn't change.
    
    Use a bad sentinel for NO_HANDLE since that indicates a serious error.

commit 99e5ffd1de7a21a10c33fcddbdf560a8b5808800
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 11 12:24:03 2013 +0000

    lib: Add comment for libguestfs handle.

commit d9efcfb5561a3ad3a6a557c4ec275277a48963d1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 11 11:03:55 2013 +0000

    RHEL 5: tests/xml: Define O_CLOEXEC in LD_PRELOAD library.

commit 1b5b397da8d02421c99ac4ed235cae0ec113f741
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Mar 10 20:08:06 2013 +0000

    RHEL 5: tests: Use gnulib.
    
    Gnulib defines O_CLOEXEC which is missing on RHEL 5.

commit d16bb6b70c8e70285fbc12bc85da5a4cdad9f928
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 9 19:25:33 2013 +0000

    RHEL 5: Replacement for 'Unix.isatty stdout' for old OCaml versions.
    
    Unix.isatty missing on RHEL 5-era OCaml 3.09.3.

commit e73944faf40c0a880ecd66bc0e7ade3f4b8ddc2c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 9 18:36:09 2013 +0000

    RHEL 5: gnulib: Use module mkstemps.
    
    RHEL 5 glibc doesn't have this function.

commit bb0617859fe4b272c6ce0d1ab37db04e6d7fdfb4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 8 20:16:04 2013 +0000

    RHEL 5: inspect: Add macro for be32toh if one is not defined in the header files.

commit 74297e6109b1f97b36a38c15f9bfecd841372ab5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 8 17:03:37 2013 +0000

    Add suppression for memory leak in libmagic.

commit 52c3edd5e008bdd74d06f5b1823d9b6495a74f4d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 8 14:02:19 2013 +0000

    filearch: Use a more logical way to construct the cpio command.

commit 801487f2a74c4ce8d70dd4465443bd4c58719ed0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 8 13:50:42 2013 +0000

    filearch: Don't print errno if cpio command fails, print command status instead.
    
    errno is meaningless here.

commit 22d82d00b4e61010bdbf5fe6bec7688cba7c511b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 8 13:16:37 2013 +0000

    generator: Small fix for OCaml 3.12.1.
    
    OCaml 3.12.1 (unlike 4.00.1) doesn't let you use printf formatters
    in this way:
    
      printf (if foo then "&%s" else "%s") str

commit 0ee24ccf8adb080260a5bb4260593cafe7bc016d
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Thu Mar 7 19:59:26 2013 +0100

    Move Ruby-related checks from autoconf to extconf.rb; add extra check for rb_alloc_func_t
    
    Ruby ships its own config.h which may or may not define the same
    relevant constants as our autoconf-generated config.h. Instead of
    trying to specify the exact path to the wanted header file we may just
    as well simply use Ruby's autoconf-inspired checks and macros.

commit 3a895ba794c1cf6d802c2a7bdecf171ae87f9376
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 7 23:29:21 2013 +0000

    df/parallel.c: Fix if libvirt is not available at compile time.

commit ef33ea359db61f4ddde38b67c1628b0e214499fb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 7 21:53:16 2013 +0000

    Version 1.21.18.

commit 6557d0c0824fd25cba4f96d033b77554b4b787f9
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Thu Mar 7 22:15:23 2013 +0100

    out-of-tree build: Fix link creation

commit a568dec4cf00405002c723c69f2d76d9e38d3c20
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Thu Mar 7 22:15:22 2013 +0100

    Still build the libguestfs-specific parts when --disable-appliance is passed to configure

commit 43b37d02a14827376ad6c5c1449d27a875ff783e
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Thu Mar 7 19:59:28 2013 +0100

    out-of-tree build: Fix localized manpages

commit 0a50e644353658fb7dac97c5efe665ffd20cd3fd
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Thu Mar 7 19:59:25 2013 +0100

    out-of-tree build: don't distribute extconf.rb.in template, use generated exconf.rb
    
    Apparently, the file will only be autogenerated in $(builddir) if it
    is not already present in $(srcdir).

commit bb1f665d7fd59f7f36b8f23540cb36b5fd6a1f74
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 7 18:21:06 2013 +0000

    protocol: Handle log messages from connection layer centrally.
    
    Previously described as a "gross hack and massive layering violation".

commit ed41fcd75c32877198e826aabdb23d553504b1f9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 7 14:55:40 2013 +0000

    protocol: Abstract out socket operations from protocol code.
    
    This creates an abstract layer below the protocol code which handles
    the socket operations.  This will make it easier to introduce libvirt
    virSocketPtr operations in future.
    
    In the handle, g->conn contains the connection to the appliance.
    g->conn is NULL when we're not connected.
    
    poll(2) is used instead of select(2).
    
    All error messages about launch failing or the appliance unexpectedly
    dying are handled by two common error message functions, and these
    contain a better explanation of what to do.

commit 06b39b8098ea314d8dc72e2162c53157a58f8aab
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 7 16:28:08 2013 +0000

    protocol: Remove message_summary code.
    
    Produces lots of output, and not very helpful.

commit 2c8e7ba9b47f70d5222d6c5020a6cdf86e2f8e87
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 7 11:40:44 2013 +0000

    launch: unix: Set g->daemon_sock = -1 after closing it.
    
    This ensures we don't accidentally use the closed fd.

commit 9ae639948ad9d28af53887ef5d7dc8b040fccd82
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 7 11:39:44 2013 +0000

    lib: Rename g->fd to console_sock and g->sock to daemon_sock.
    
    This just renames the fields in the handle to more descriptive names.
    There is no functional change.

commit f9381847f1ef349ec15136e11f07957814408745
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 7 11:12:04 2013 +0000

    launch: appliance: Set FD_CLOEXEC flag on console socket.
    
    The earlier (pipe-based) code never set this flag, but that was a bug,
    potentially allowing the file descriptor to be leaked to subprocesses.
    
    Set the FD_CLOEXEC flag, but also ensure it is cleared in the child
    process just before qemu is exec'd (otherwise qemu would not have a
    console).

commit 6e7cbb09a900fdf9841dd5a0a044d72cc67edfac
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 7 09:50:36 2013 +0000

    launch: appliance: Use socketpair instead of pipe for qemu stdin/stdout.
    
    The libvirt backend already uses a Unix socket for the appliance
    console, and so for the libvirt backend the fields g->fd[0] == g->fd[1].
    
    Change the appliance backend to use a socketpair, so we need just a
    single file descriptor for qemu stdin/stdout (ie. appliance console).
    
    Consequently we can remove the array int fd[2] in the handle and
    replace it with a single file descriptor.

commit 8136ca37194b162af714e2e0328d9171729370f9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 6 21:13:14 2013 +0000

    proto: send_to_daemon is not an exported function.
    
    This function is only used inside src/proto.c, so rename
    it from guestfs___send_to_daemon to just send_to_daemon.

commit 7de25c2bca7a06cbd076d0f025cc62c0d49d8167
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 6 14:30:32 2013 +0000

    valgrind: Add suppression for memory leak found in libselinux.

commit c44c5ee26870584f4f9dfea5305f707b4142c717
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 6 11:18:14 2013 +0000

    debug: Add command to generate lots of debug messages.

commit ba08a51094409811d0bd01a7af5ec596a8640cc1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 5 17:03:21 2013 +0000

    launch: libvirt: When debugging, print permissions of appliance and sockets.
    
    When debugging is enabled, this prints out the permissions (ie.
    ls -laZ) of the appliance and sockets directories.  This should be
    helpful for debugging RHBZ#913774.

commit 59f01c4a7057cb0222fb9289234282b3b9c4ca76
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 5 16:46:53 2013 +0000

    launch: libvirt: Rename 'is_root' as 'current_proc_is_root', and documentation.

commit ed354e8f8b4f3204a244b8b2a345d9f6262122fc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 5 16:44:41 2013 +0000

    launch: libvirt: When root, set socket permissions to 0660 (vs 0775).
    
    Since qemu connects to both, there was no point at all in having these
    sockets be readable by other, nor executable by anyone.
    
    The sockets should now end up as:
    
      srw-rw---- root.qemu

commit a4a2a181c2881d62f5addaa4f6e3836c4e691333
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 5 15:26:41 2013 +0000

    fuse: tests: Set FD_CLOEXEC flag on file descriptor.
    
    This is not required here, but it helps if the test code matches what
    the documentations says you should do.

commit f7789acdabbfb4a825e47c31ad4933fcfb8f60af
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 5 14:06:09 2013 +0000

    Version 1.21.17.

commit 603968934423041757e9e4cf75419b184cec1698
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 5 14:40:18 2013 +0000

    guestmount: Add --no-fork flag.
    
    This prevent guestmount from daemonizing.

commit 0120a087f444d3ebeb16b96696b993684db550db
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 5 14:05:35 2013 +0000

    Add guestunmount.1.html to the website.
    
    This fixes commit 3e9e40aee322789e7f81422f4cfd42915b36eb4c.

commit 3e9e40aee322789e7f81422f4cfd42915b36eb4c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 4 18:47:05 2013 +0000

    fuse: Add guestunmount program to handle unmounting (RHBZ#916780).

commit 09442d058875987f3636982c4a313e05d2709e32
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 4 15:26:07 2013 +0000

    fuse: guestfs_umount_local is not thread-safe.
    
    Despite what the documentation may have said, it certainly was not
    safe to call guestfs_umount_local from another thread.
    
    guestfs_umount_local could generate events, call the error handler, or
    access other fields in the handle, with no locking at all.
    
    We should aim to make guestfs_umount_local thread-safe in future.
    
    See also:
    https://bugzilla.redhat.com/show_bug.cgi?id=917706

commit d08f5ebd9a926f6ecca7498f8f0c2eff9273d313
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 4 13:28:15 2013 +0000

    generator: Generate guestfs_user_cancel.
    
    This function is now generated, so bindings in various languages
    are made automatically.
    
    Note that the function previously returned void, but now it returns
    int (although always 0).  We don't believe that this is an ABI break
    since existing programs will continue to work.

commit ac2f6c4ef218afc8b61e80595ab5647ef70b9cb6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 4 13:22:05 2013 +0000

    generator: Add 'wrapper' flag to control when wrapper is generated.
    
    Non-daemon functions normally have a wrapper function called
    eg. guestfs_name.  The "real" (ie. hand-written) function is called
    eg. guestfs__name.  The wrapper deals with checking parameters and
    doing trace messages.
    
    This commit allows the wrapper function to be omitted.  The reason is
    so that we can handle a few functions that have to be thread-safe
    (currently just: guestfs_user_cancel).  The wrapper is not thread safe
    because it can call events and/or the error handler.

commit 4236929fbbd8943589e9ad2441e3f4393872dc79
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 4 13:16:00 2013 +0000

    generator: Typo in comment: "Checking" -> "Check".

commit 9b7de52d58bb70294e6c5be6fb80b888d42f7ad7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 4 09:55:33 2013 +0000

    threads: Note that even innocent-looking functions need a mutex.
    
    RWMJ was caught out by this one ...

commit 66351f7494954f26e2fcf35f4b02238fcfdb366f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 4 09:53:10 2013 +0000

    trace: Put trace buffer on the stack instead of in the handle.
    
    This makes more sense, and makes the code slightly closer to being
    thread safe (although it's still NOT thread safe).

commit 8e2b920fe67d859399945910f8a55209586865c8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 1 16:25:41 2013 +0000

    FAQ: Add question about running fsck on live filesystems.

commit 7d8b97559b6a6f63507a0dbec9f5da67d3dbd24e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 1 15:55:18 2013 +0000

    Version 1.21.16.

commit 7f5bedd53b3b13d3638be47088d2239470d1dc3e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 1 14:44:51 2013 +0000

    lib: Check calls to xmlXPathEvalExpression for nodesetval == NULL.
    
    libxml2 xmlXPathEvalExpression can return an unusual nodeset:
    
      $1 = {type = XPATH_NODESET, nodesetval = 0x0, boolval = 0, floatval = 0,
        stringval = 0x0, user = 0x0, index = 0, user2 = 0x0, index2 = 0}
    
    Note that the nodeset is non-NULL, but the nodesetval is NULL.
    
    Check every call site and fix those that don't deal with this
    correctly.

commit 3adb0d6d01d17a6bd443ff14a16f673dfb88f577
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 27 22:27:23 2013 +0000

    add-domain: Move 'connect_live' function.
    
    This is just code motion.

commit e78a2c5df3c4ec79e22e03ee4994958537f2e8d8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 27 22:24:16 2013 +0000

    add-domain: Pass SELinux label from guest to appliance (RHBZ#912499).
    
    When adding a domain (ie. guestfs_add_domain), read the SELinux
    <label/> and <imagelabel/> from the guest and use them for the
    appliance.  The appliance is statically labelled the same as the
    guest, so it is able to read its disks.
    
    However tell libvirt not to try relabelling the disks, to prevent
    libvirt from disturbing the existing labels on the disks (in
    particular when the libvirt connection is closed, we don't want
    libvirt to try to restore some other label on the disks).
    
    Updated with feedback from Matthew Booth.

commit 26df366d3bf712a84337c2402f41506f2be6f610
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 27 22:18:15 2013 +0000

    launch: libvirt: Allow the SELinux label to be set on qcow2 overlay files.
    
    When a disk is opened readonly, the libvirt attach-method privately
    creates a qcow2 overlay on top.
    
    This commit lets that overlay get an SELinux label, and sets it to the
    imagelabel specified by guestfs_internal_set_libvirt_selinux_label.
    
    The above only applies to the libvirt attach-method.

commit b9ee8baa49afbf8b6d80a42f3a309b660c7b32a5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 28 15:37:07 2013 +0000

    New internal API: internal_set_libvirt_selinux_norelabel_disks.
    
    If set, this causes <seclabel model=selinux relabel=no> to be added to
    the disk element in the libvirt XML.
    
    It has no effect *except* on the libvirt attach method when SELinux
    and sVirt is being used.

commit 617eb88c5e66247894fde2aae11bd102889eb85c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 27 18:41:12 2013 +0000

    New internal API: internal_set_libvirt_selinux_label
    
    This internal API sets two SELinux labels in the handle (the process
    label and the image label -- they are closely related).
    
    If using the libvirt attach-method with SELinux and sVirt, then this
    will cause the following XML to be added to the appliance definition:
    
    <seclabel type=static model=selinux relabel=yes>
      <label>[LABEL HERE]</label>
      <imagelabel>[IMAGELABEL HERE]</imagelabel>
    </seclabel>
    
    It is ignored by other attach-methods.

commit a6a703253be9e9c590a49a149c0170f2e46a1eb2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 27 22:23:34 2013 +0000

    add-domain: Refactor domain XML parsing code.
    
    This is just code motion.

commit d01ac175598add0de574a4cccfe48d0c5cc4276c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 28 14:54:24 2013 +0000

    test-tool: Give an error if there are extra arguments on the command line.

commit 3f1e7f1078ac40a6736b7721cc248f8ed0614f48
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 27 18:36:22 2013 +0000

    launch: libvirt: Refactor SELinux warning code.
    
    This is just code motion.

commit 93feaa4ae83b72864e7c10e9a388219ad9960123
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 28 13:34:42 2013 +0000

    parallel: Don't access the global handle from multiple threads.
    
    libguestfs handles are not thread safe, and it's not safe even to read
    settings from the handle from multiple threads (eg. guestfs_get_trace).
    Stop doing this in the parallel library.  This caused fairly
    reproducible segfaults when you enabled '-x' and/or '-v'.
    
    This fixes commit 34e77af1bf42a132589901164f29bd992b37589e.

commit ce7cffa85a76f539fcccb0c34321594e96b2a186
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 27 14:07:25 2013 +0000

    libutils: Don't include "guestfs-internal.h".
    
    This mini-library shouldn't access library-internal stuff.  It should
    only use the "guestfs-internal-frontend.h" header.

commit 1ea7752e95a90aa8016d85489c7460b881fc59b0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 27 11:07:16 2013 +0000

    lib: Move 'for_each_disk' function back into libvirt-domain.c.
    
    This function is no longer called from anywhere outside the library,
    or even outside libvirt-domain.c.
    
    This is just code motion, except for the size_t changes which are
    required in order to avoid signed overflow optimization error:
    
      assuming signed overflow does not occur when simplifying conditional
      to constant [-Werror=strict-overflow]

commit 4c5c555eeb37da74d9af902762308a544f4f82d4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 26 22:11:40 2013 +0000

    generator: Line up GUESTFS_EVENT_ALL.

commit c29660588fd7b196f11aa7f92e7d5230534a59e5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 26 22:08:53 2013 +0000

    generator: Remove "deprecated macros for internal functions".
    
    No need for these since these are internal functions that only code
    under our control should have been calling.

commit 1ea73f4bdf7c4e7998c23e4fab2166ca30b6665b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 26 17:48:56 2013 +0000

    Version 1.21.15.

commit db30fe0cb098492a7c49ec8ca03fc11b69da244c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 26 17:24:42 2013 +0000

    lib: Fix memory leak in guestfs_list_filesystems.
    
    This fixes commit 6e7f052ef40fc799605f13e21e1dc4928d274f41.

commit b6cbd980fb2fe8e43de9e716769cba63cd8d721b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 26 17:00:50 2013 +0000

    tests: Add tests of guests to virt-df and virt-alignment-scan.

commit 5ff3845d280515ab623d22666c3f5013f095d32a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 26 16:47:38 2013 +0000

    tests: guests: Add blank disks plus libvirt test:// XML.
    
    You can now run virt-df and virt-alignment-scan on all of the test
    guests by doing:
    
    ./run ./df/virt-df -c test:///path/to/tests/guests/guests.xml
    ./run ./align/virt-alignment-scan -c test:///path/to/tests/guests/guests.xml
    
    which is kinda cool.

commit fe939cf842949f0eda0b6c69cad8d2d6b5b2c3fd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 26 14:50:44 2013 +0000

    lib: Turn guestfs___for_each_disk back into an internal library function.
    
    Since the refactoring of virt-df and virt-alignment-scan, those
    tools no longer use this function.

commit 6e3aab2f0c48280e746e90050abf25947159e294
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 26 14:35:19 2013 +0000

    Partial rewrite of virt-alignment-scan to use parallel threads.
    
    See previous commit (virt-df equivalent change) for the rationale.

commit 34e77af1bf42a132589901164f29bd992b37589e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 25 18:46:40 2013 +0000

    Partial rewrite of virt-df to use parallel threads instead of single appliance.
    
    Previously when you asked virt-df to show stats for all your libvirt
    guests, it used a single appliance and tried to attach as many disks
    as possible to it, even disks from different guests.
    
    However this has been problematic: Not only is the code to do this
    horrendously complex, but it's also insecure, and it doesn't interact
    well with sVirt labels (see RHBZ#912499 comment 7).
    
    In the meantime we discovered that running parallel appliances gives
    you most of the performance of using a single appliance, but with a
    lot less complexity and better guest isolation (see the documentation
    in commit 680450f3b4f8c2da7a0b1d8f0bd8c2232efc4054).
    
    Therefore this is a partial rewrite of virt-df so that in this case it
    now uses parallel appliances.
    
    Notes:
    
    The '--one-per-guest' option is now the default and only way to do
    things; this option now does nothing.
    
    By default, the amount of parallelism to use is controlled by the
    amount of free memory seen when virt-df starts up (subject to some
    minima and maxima).  The user can control this through new command
    line option '-P'.

commit 76266be549c521e3767a94c07e9ae616826a2568
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 26 13:13:59 2013 +0000

    lib: Export guestfs___add_libvirt_dom for use by virt-df and virt-alignment-scan.
    
    See the comment in guestfs-internal-frontend.h in this commit.

commit 556e109765d7b6808045965a1eefcb434294f151
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 26 10:02:18 2013 +0000

    tools: Introduce a mini-library for estimating max threads based on free memory.
    
    This mini-library runs the 'free -m' command and greps the output to
    estimate the max. number of libguestfs appliances we could run in
    parallel in the remaining free memory.

commit f8b92c066805708766d9f1aa925721febed28068
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 26 16:59:57 2013 +0000

    df: Always have TESTS= line even if appliance is disabled.

commit a885dd025d9e8fa9ebaf0ffbeb4f7bd1f9629f4d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 26 16:57:54 2013 +0000

    virt-alignment-scan: Set LANG=C in test.

commit 4a6c8021b599952b991725043bac5c722635b3f6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 26 10:05:23 2013 +0000

    lib: Add a global MIN macro to guestfs-internal-all.h.

commit d02610853d3f732f4527d2dc51b803943e5ece10
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 25 17:39:11 2013 +0000

    Version 1.21.14.

commit ff0269e80fcd2031afa7d48e414b7ca7e1ef4d7a
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Mon Feb 18 22:43:41 2013 +0100

    out-of-tree build: fix test-tool
    
    (Not entirely sure whether using Gnulib to replace standard functions
    is a good idea at all.)
    
    link with libgnu:
      CCLD   libguestfs-test-tool
    libguestfs_test_tool-test-tool.o: In function `main':
    /home/bengen/src/deb/pkg-libvirt/libguestfs/debian/build-default/test-tool/../../../test-tool/test-tool.c:103: undefined reference to `rpl_getopt_long'
    /home/bengen/src/deb/pkg-libvirt/libguestfs/debian/build-default/test-tool/../../../test-tool/test-tool.c:113: undefined reference to `rpl_optarg'
    /home/bengen/src/deb/pkg-libvirt/libguestfs/debian/build-default/test-tool/../../../test-tool/test-tool.c:125: undefined reference to `rpl_optarg'
    /home/bengen/src/deb/pkg-libvirt/libguestfs/debian/build-default/test-tool/../../../test-tool/test-tool.c:126: undefined reference to `rpl_optarg'
    /home/bengen/src/deb/pkg-libvirt/libguestfs/debian/build-default/test-tool/../../../test-tool/test-tool.c:109: undefined reference to `rpl_optarg'
    libguestfs_test_tool-test-tool.o: In function `set_qemu':
    /home/bengen/src/deb/pkg-libvirt/libguestfs/debian/build-default/test-tool/../../../test-tool/test-tool.c:382: undefined reference to `rpl_perror'
    /home/bengen/src/deb/pkg-libvirt/libguestfs/debian/build-default/test-tool/../../../test-tool/test-tool.c:366: undefined reference to `rpl_perror'
    libguestfs_test_tool-test-tool.o: In function `make_files':
    /home/bengen/src/deb/pkg-libvirt/libguestfs/debian/build-default/test-tool/../../../test-tool/test-tool.c:416: undefined reference to `rpl_perror'
    /home/bengen/src/deb/pkg-libvirt/libguestfs/debian/build-default/test-tool/../../../test-tool/test-tool.c:428: undefined reference to `rpl_perror'

commit cd1558b89ea2081528daa8a2833b6291e68bf98a
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Mon Feb 18 22:43:40 2013 +0100

    out-of-tree build: fix daemon
    
      CC     guestfsd-9p.o
    In file included from ../../../daemon/9p.c:32:0:
    ../../../daemon/daemon.h:33:34: fatal error: guestfs-internal-all.h: No such file or directory

commit 680450f3b4f8c2da7a0b1d8f0bd8c2232efc4054
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 23 22:35:48 2013 +0000

    docs: Update guestfs-performance with parallel scaling numbers and test script.

commit ff80a540117945046e4671907f3a6799384fe39b
Author: Olaf Hering <olaf@aepfle.de>
Date:   Mon Feb 25 10:56:47 2013 +0100

    lib: avoid pragma usage in inspect-fs-windows
    
    pragma GCC diagnostic is a gcc 4.6+ feature, compilation fails with
    older compilers:
    
    inspect-fs-windows.c: In function 'map_registry_disk_blob':
    inspect-fs-windows.c:502: error: #pragma GCC diagnostic not allowed inside functions
    inspect-fs-windows.c:503: error: #pragma GCC diagnostic not allowed inside functions
    inspect-fs-windows.c:505: error: #pragma GCC diagnostic not allowed inside functions
    make[3]: *** [libguestfs_la-inspect-fs-windows.lo] Error 1
    
    Use memcpy instead of pragma to fix compile error.
    
    Signed-off-by: Olaf Hering <olaf@aepfle.de>

commit 455d6b1845b54649693d67cdf991a8ac470a395f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 23 20:55:59 2013 +0000

    recipes: Add example converting from one format/filesystem to another.

commit fadec0687f67eb904b8c312d7d922fa7bd97147f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 23 20:32:33 2013 +0000

    daemon: protocol: Fix memory leak when receiving FileIn file (RHBZ#914934).
    
    This fixes commit 950951c67de61da27dceca8ffb2079031c13e43b.

commit 4136850f3ced2c8da6ca4f44c0f80881cb6d1352
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 23 19:59:04 2013 +0000

    tests: Add a regression test for RHBZ#914931.
    
    This involves adding a new test API which crashes the appliance in the
    middle of a simulated upload, then a test which uses that API to test
    for the libguestfs (library-side) crash.

commit 7953128ca66207a7a3ca44e02fec1de48253223e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 23 19:24:49 2013 +0000

    protocol: Don't segfault if appliance crashes during FileIn upload (RHBZ#914931).
    
    Instead of the segfault you now get a more informative error:
    
    *stdin*:0: libguestfs: error: connection to daemon was closed unexpectedly.
    This usually means the libguestfs appliance crashed.  Please enable
    debugging (LIBGUESTFS_DEBUG=1) and rerun the command, then look at the
    debug messages output prior to this error.
    libguestfs: error: /dev/stdout: write: Broken pipe
    libguestfs: error: file receive cancelled by daemon

commit d950e1a3bc582e48839d800aa1522968a795a983
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 23 08:18:27 2013 +0000

    run: Refer to README and correct documentation for linking to script.
    
    Any link works, even a hard link.

commit 1ca842d98b2da7fb3cd09e572c88ddba5b52b673
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 23 08:14:35 2013 +0000

    run: Relicense as LGPLv2+.
    
    To allow reuse in other projects and because of the equivalent change
    made by Eric Blake to the libvirt 'run' script.

commit 37796d70bf5c00d004add2f9b14bef8b3b3cf5db
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 20 23:20:45 2013 +0000

    Update API support.

commit b49eefdb15c5679c3d1dea19ae9ecc1293cd4fa7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 20 21:25:44 2013 +0000

    Version 1.21.13.

commit 9d6aa8b537110ce52ffba6a9d70f9ccf6b392979
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 20 20:03:47 2013 +0000

    Use guestfs___count_strings instead of custom versions in various places.

commit 907fbfff53157b447079aab587cc0f01ed0f000a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 20 20:00:04 2013 +0000

    python: Use guestfs___free_string_list instead of custom version.

commit 4ede94ab7bc09c9dde8445b521387e343537c4ac
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 20 19:45:44 2013 +0000

    ocaml: Use guestfs___free_string_list instead of custom-coded one.
    
    It should be possible to add the guestfs___free_string_list to
    dllmlguestfs.so, but I cannot work out exactly how to do this.  As a
    result we end up using src/utils.c directly.

commit 6ee164d47ae29ad16b6184f8020841f860d93798
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 20 19:55:04 2013 +0000

    ocaml: Missing #include <config.h> in generated file.

commit 27e6347b759fc824f911835e7908f4daf7b3654f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 20 19:45:25 2013 +0000

    lua: Use guestfs___free_string_list instead of custom-coded version.

commit 0b7acf50b69cbc45b740f05115cbf44c232fae08
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 20 19:24:35 2013 +0000

    fish: Use guestfs___{free_string_list,count_strings} utility functions.
    
    Instead of custom-coded versions.

commit e27295c5780c1b42610f56be9082bb81f27f6fcd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 20 19:24:21 2013 +0000

    libutils: Add guestfs___count_strings utility function to common library.

commit 7ef461948ec79608e43166ba897338ea69041c47
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 20 19:11:05 2013 +0000

    erlang: Use guestfs___free_string_list from libutils, instead of custom version.

commit 04723b4dd105d204b5afa7201860c9a81eda05b2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 20 17:06:46 2013 +0000

    lib: Create libutils convenience library.
    
    The libutils convenience library is a place for code shared between
    the main library, language bindings and virt tools.  Note that the
    code is statically linked into both the library, each binding and each
    tool, but this is an improvement because (a) the source is shared and
    (b) libguestfs.so can export fewer private functions.
    
    Currently it contains the cleanup functions, and the functions
    guestfs___free_string_list function and guestfs___for_each_disk.
    
    guestfs___for_each_disk has changed so that it no longer
    unconditionally sets the error in the guestfs handle.  Instead callers
    can control error handling.

commit a4953090e1515fed7a1c0945316435043740f7f2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 20 17:08:53 2013 +0000

    lib: Rename guestfs_error_errno as guestfs___error_errno, etc.
    
    These are internal functions.  Very old versions of libguestfs used to
    export them, but they haven't been (and shouldn't be) exported for a
    long time.
    
    Also remove the unused guestfs_error function.

commit 1a2465c187e53ac26128cfdd9bcaae19475e2d0d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 20 16:05:11 2013 +0000

    build: Remove long and mostly irrelevant comment about libtool versioning.

commit 21013249659931aea326bd2a3f1ed1753b309963
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 20 16:03:14 2013 +0000

    build: Rearrange src/Makefile.am into a more logical order.
    
    This is just code motion.

commit 6566621345a46d5514565b59cc2889c1c4583169
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 20 14:03:24 2013 +0000

    tests: Add valgrind suppression for libvirt 1.0.2 memory leak.
    
    Leak reported as RHBZ#913145.

commit b7ab6de628936868ce676820a3871cbf4d6ac372
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 20 14:19:09 2013 +0000

    tests: Add valgrind suppression variant for new manifestation of an old libvirt memory leak.

commit 61162bdce1a00a921a47eb3e788e8fb9e4bd07ac
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 20 13:50:43 2013 +0000

    lib: Use CLEANUP_* macros to simplify XPath query code.

commit b10a6cfe24a20d59d6eb099454761f71573f478d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 20 11:28:50 2013 +0000

    rescue: Improve error messages in the test script.

commit 175d6ba432d804c835391b52c3362b9bbc3eccae
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 20 10:30:44 2013 +0000

    faq: Add section for developers, including how to send patches and propose features.

commit 065861ce6bd1069b0ae111bcd14057d82cfc3963
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 20 10:00:21 2013 +0000

    docs: Rewrite security section (thanks Dan Berrange).

commit 8671cfa343d24fb5ebe6b2cefdbf9006458c4f2f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 19 17:35:48 2013 +0000

    Version 1.21.12.

commit a1c89bf03dd432f0e4c8c26fe01fd9b2a50df97e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 19 15:37:18 2013 +0000

    build: Only add 'serial-tests' for automake >= 1.12 (thanks Hilko Bengen).
    
    Earlier versions of automake complain if they get a configuration
    parameter which they don't understand.  The error is:
    
    configure.ac:27: error: option 'serial-tests' not recognized
    
    Use some m4 hackery to work around this.

commit c7ba91761c05cce3806b908cba8a7a0bd902c7be
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 18 16:28:14 2013 +0000

    handle: Define DEFAULT_MEMSIZE, MIN_MEMSIZE constants.
    
    This is just code motion.

commit 70514c7f7e34243cc2b9c8ee925bcc243a1001b2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 19 12:59:23 2013 +0000

    ruby: Add binding for guestfs_event_to_string.

commit 0f849029d18cf4095294dfb76a65bd998d763ad5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 19 12:45:37 2013 +0000

    python: Add binding for guestfs_event_to_string.

commit e9d83e94a28d433e40857a9a8ed3fc23e1320932
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 19 12:45:22 2013 +0000

    perl: Add binding for guestfs_event_to_string.

commit 7e71c9fb34fb28c685b631b5403fbb2d3b8e7553
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 19 11:48:02 2013 +0000

    java: Use guestfs_event_to_string instead of generated code.

commit 2a8de9001eae01c0534fe60e72305931adfff4df
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 19 11:32:59 2013 +0000

    fish: Use guestfs_event_to_string instead of guestfish-specific generated functions.

commit 5c513060b17def062dcafdae13ff4fe05f49dbe2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 18 22:55:21 2013 +0000

    ocaml: Add binding for Guestfs.event_to_string and use it in events test.

commit b793fafcb79360e3d42936af788aaa8b3dbdd226
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 18 22:01:04 2013 +0000

    New C only API: guestfs_event_to_string.

commit 6902f093ffd2bfbd21fcc7bc682db8106fd2fd93
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 18 14:02:21 2013 +0000

    handle: Translatable string in guestfs_parse_environment.

commit 0e0eec76d9dca032e3eb45c0bbe024edc7bb16f8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 18 13:02:59 2013 +0000

    generator: Whitespace changes.

commit cbfa394bfc7e980381097b457761ddc42d59d01f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 15 14:41:56 2013 +0000

    lib: Fix memory leak when the 'lpj' setting is read from dmesg.
    
    It was failing to clean up and close the 'struct command' buffer,
    because commit 94d90f03e2bbb595890b01e2a10b63e00e976691 added an
    incomplete patch to use CLEANUP_CMD_CLOSE.
    
    This fixes commit 94d90f03e2bbb595890b01e2a10b63e00e976691.

commit 5c6895bda1053b4cbbcc8c72fe30d8fd17d403d6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 15 14:25:25 2013 +0000

    java: Print a better error message when JVM version is too old.
    
    This fixes commit 87d1f7714f8e1b0f595bad3b7932592f0f85d54b.

commit 87d1f7714f8e1b0f595bad3b7932592f0f85d54b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 15 12:57:19 2013 +0000

    java: Note that JVM >= 1.6 is now required.

commit c598e14052399f19d36d7874d7133cba779bd3c2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 14 22:15:25 2013 +0000

    appliance: Use a glibc trick to try to display a stack trace if a program in the appliance segfaults.

commit 989d3c76918da0468ce853cef8afb6e4e8230885
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 14 15:38:40 2013 +0000

    Version 1.21.11.

commit 9021351c8e5c756689855a4a32bfe0889e6b0965
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 14 16:33:01 2013 +0000

    tests: mountable: Add test-mountable-inspect.sh to EXTRA_DIST.
    
    This fixes commit 7d976657e6f02ca0b61858f668ae792a70327309.

commit 52b7418670f0319e1fbd055c0156be6eb3d16551
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Feb 13 10:38:59 2013 +0000

    Fix API doc errors

commit f0f8d7ce781fdfb4a4292a77e2834c7c3d192052
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Feb 13 10:30:51 2013 +0000

    gobject: Fix doc generation of L<guestfs(3)/CVE-2010-3851>

commit 23f8bd4fac40739de3233f2fb3278a41c68c3f14
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 12 17:09:44 2013 +0000

    daemon: Fix RESOLVE_MOUNTABLE, internal_parse_mountable.
    
    - The mountable->volume field was not being initialized on the
      device path.
    
    - XDR string fields cannot be NULL.
    
    This fixes commit 7d976657e6f02ca0b61858f668ae792a70327309.

commit db554cf2710ff0cc849a9271ce17c6b3fce2882e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 12 17:02:33 2013 +0000

    tests: mountable: Print error message if guestfs_create fails.

commit 4f7d1b3ae768751f469940a203b1e7647033558c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 12 17:01:44 2013 +0000

    tests: Add Fedora btrfs phony guest to target list.
    
    This fixes commit 754e8194382a9ed265c7fa172e438049e4eb8389.

commit 77c57ab8432f0155e4d1a007d2789d4901a9f804
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 12 17:00:10 2013 +0000

    tests: Reorder the tests so test guest is created before it's used by mountable test.
    
    This fixes commit 7d976657e6f02ca0b61858f668ae792a70327309.

commit 1399005d7e1832889c108039291413b5c20b26ca
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 12 15:18:17 2013 +0000

    examples: Ensure each example program is documented.

commit e84d6e6102fcc55eff0044351cb7d8d1a3296e20
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 12 15:02:43 2013 +0000

    examples: Rename example programs, replacing '_' with '-'.

commit 4215d0ca683378e34d8c5f87d7ec85c834e75b78
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Feb 7 15:49:51 2013 +0000

    mountable: Test inspection of fedora image

commit 7ba0e10501f23358c38939930d613bf2393d744d
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Feb 7 14:06:13 2013 +0000

    inspect: Update inspect_os to use mountables
    
    This fixes inspection of guests which use btrfs subvolumes.

commit 7d976657e6f02ca0b61858f668ae792a70327309
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Feb 6 10:32:35 2013 +0000

    New internal API: internal_parse_mountable

commit b0abf10b9f2e07f4002f4d486fcb2c02fd91aac3
Author: Matthew Booth <mbooth@redhat.com>
Date:   Tue Feb 12 14:45:19 2013 +0000

    build: Minor cleanup in daemon/Makefile.am

commit 754e8194382a9ed265c7fa172e438049e4eb8389
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Feb 7 15:36:01 2013 +0000

    btrfs: Make a stub Fedora btrfs guest for inspection testing

commit 6e7f052ef40fc799605f13e21e1dc4928d274f41
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Jan 25 16:13:19 2013 +0000

    mountable: Make list-filesystems return btrfsvols

commit bcb933a0c169b090739a0a7e5c98224dd61aa8ef
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Jan 25 14:49:35 2013 +0000

    btrfs: Update btrfs_subvolume_list to take Mountable_or_Path
    
    btrfs_subvolume_list can now take either the path of a mounted btrfs
    filesystem, or a mountable describing the location of a btrfs
    filesystem, or one of its volumes. In the latter case, the filesystem
    will be automatically mounted outside of /sysroot before running the
    btrfs tool, and unmounted afterwards.

commit 72aaf56fed5c942b2631005edc58f7b8e6f701ae
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Jan 25 14:30:40 2013 +0000

    mount: Add mount_vfs_nochroot
    
    This internal function allows mounting a mountable outside /sysroot.

commit ec6a4de37a94558ecfdeb22c54d5e5c1571a2437
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 12 11:56:42 2013 +0000

    faq: Add common questions about virt-resize/virt-sparsify in place support.

commit 954e315d217af39fb09467f228fb7e03a0530d10
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 12 11:56:16 2013 +0000

    faq: Fix some small typos in section on virt-sparsify.

commit 6c5577e40373f02ff798e8cfc49206b9edd76484
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 12 11:55:45 2013 +0000

    faq: Update RHEL information.

commit cd47df1fe5e854c01756b184e3175bd57f611dbd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 12 10:55:26 2013 +0000

    test-tool: Point to SELinux documentation for further information.

commit 0e79b9dd038b83ebe5d6f2bc1d93379a2e5c7cd7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 11 21:44:39 2013 +0000

    examples: Add all the C examples to the guestfs-examples(3) man page.

commit 09c4f94c9def22dc7413425d419098462227e70a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 11 21:36:27 2013 +0000

    build: Separate out *_CPPFLAGS from *_CFLAGS.
    
    This is pretty pointless.

commit bbb637f96221733d4e492fa73a68cf7981677db9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 11 21:22:25 2013 +0000

    test-tool: Get rid of the "=== Test starts here ===" banner.
    
    It confuses things, because that is not always the start
    of the output.

commit ee61d16e3efa90705f77f6051f639ef1e3c6d094
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 11 21:21:01 2013 +0000

    test-tool: Display SELinux status in output of libguestfs-test-tool.

commit 45b427157924d9b15dc60ba7e9048640ffebb2e4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 11 19:38:55 2013 +0000

    Version 1.21.10.

commit 05444da98351c9269fc8c6278f8bb5c5cfd4bb83
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 11 17:35:11 2013 +0000

    tests: Add a regression test for stack overflow in events (RHBZ#909624).
    
    Note this is a check-slow test since generating 1,000,000 progress
    events take a few minutes.

commit b3cf5d1d9638313a656ee61f1bd5f06bbca21abf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 11 17:55:59 2013 +0000

    proto: Fix stack overflow when there are many progress events (RHBZ#909624).
    
    Thanks: Eric Blake.

commit a43f88b1c5299baf36561bda57531845ea94551a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 11 17:28:10 2013 +0000

    daemon: Allow rate to be specified in 'debug progress'.
    
    There are now two forms of the 'debug progress' command:
    
    (1) debug progress <n> (the original form) generates ordinary
    rate-limited progress messages for <n> seconds.
    
    (2) debug progress <n> <rate> generates progress messages every <rate>
    microseconds for <n> seconds.
    
    The second form omit the usual rate-limiting, and so wouldn't
    be generated like this from an ordinary API call.  However this
    is useful for testing events (see RHBZ#909624).

commit 942e1395624b4a10348b693b656fd9f359dbc1b2
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Jan 25 14:48:05 2013 +0000

    mountable: Implement Mountable_or_Path
    
    A Mountable_or_Path argument is passed as a mountable_t. A new type is
    added to mountable_t to handle already mounted paths.

commit 93d4fddaef909a7863be93cace2a98aba75af7cc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 11 15:49:12 2013 +0000

    lib: Add format attribute for GCC 4.8 in two places.

commit 984431a9ef789c54a3008bd80610b2488f90e61d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 11 15:48:49 2013 +0000

    daemon: Force disable -Wsuggest-attribute=format warning around asprintf_nowarn, for GCC 4.8.

commit f226133c1a8467e85d02b8de634c1ac2a931ba83
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 11 15:59:28 2013 +0000

    lib: Define GUESTFS_GCC_VERSION in the internal header.
    
    Note that you have to use this as follows:
    
    #if defined(__GNUC__) && GUESTFS_GCC_VERSION >= x0y0z /* gcc >= x.y.z */
    
    since GUESTFS_GCC_VERSION is not defined unless it's GCC.

commit ef2276654eae2e1bbcbcdb440a54029c12efccd0
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Jan 24 15:21:14 2013 +0000

    generator: Create Mountable_or_Path, initially identical to Dev_or_Path

commit 47b929b7893b3a76ff22760d245cb80720ae6345
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Jan 24 10:10:13 2013 +0000

    mountable: Implement Mountable support for all apis which take it
    
    A Mountable is passed from the library to the daemon as a string. The daemon
    stub parses it into a mountable_t, which it passes to the implementation.
    
    Update all implementations which now take a mountable_t.

commit d5817537fa6c51a7f851ecc5e4e63e60609e0c03
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Jan 24 09:25:31 2013 +0000

    generator: Convert relevant arguments from Device to Mountable
    
    This change updates the api style of all apis which should take Mountable
    descriptions rather than block devices. It also updates the documentation
    accordingly, but doesn't implement any functional changes.

commit 007c2f236d29e846cfc4829f11562f2dc8f58d6a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 11 14:13:59 2013 +0000

    test-tool: Document how to change SELinux settings.

commit b1a89d3b1ccdcd5aed3619cfc2c47812b288205e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 11 14:05:26 2013 +0000

    test-tool: Document how to run with alternate libvirt.

commit 3877cab3298f65ee118f413f68a2438af8fa58e4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 11 13:41:40 2013 +0000

    test-tool: exec qemu in the wrapper script.
    
    This ensures that libvirt can control qemu directly, eg. being able to
    send it signals.

commit 20fd81147df3796000bc242a0c515f67713fdbdd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 11 13:20:37 2013 +0000

    test-tool: On i386, upstream qemu program is now called 'qemu-system-i386'.
    
    For a while, the upstream qemu i386 emulator has been called
    'qemu-system-i386' (instead of just 'qemu').  Fix test-tool so it
    calls the right program.

commit df983d19946fec697db2c502d7a6bb36ff0d2df5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 11 13:18:26 2013 +0000

    test-tool: Don't call guestfs_set_qemu before guestfs handle is initialized (RHBZ#909836).
    
    Because of evolution of the code, if the user used the --qemu or
    --qemudir options, libguestfs-test-tool would segfault because
    guestfs_set_qemu was being called before the guestfs handle was
    opened.
    
    Change the code so this doesn't happen, and also remove the global 'g'
    variable to make the code a bit more robust.
    
    Bug found by Amit Shah.

commit e4495b24bcd9aa9a238cc35c6a908e16c1efaf3c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 11 12:07:30 2013 +0000

    daemon: link: Remove use of PATH_MAX.
    
    Replace readlink calls with gnulib areadlink function.

commit c3afef3eecf58beac3f22c98a2e383e644d75f2f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 11 11:59:35 2013 +0000

    daemon: xattr: Remove use of PATH_MAX.

commit 09f391373489a30126932f8a4afe0bab69e1322a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 11 11:52:40 2013 +0000

    daemon: realpath: Remove use of both PATH_MAX and NAME_MAX.

commit 9c9ceec6b7726143dfc09306ede3d101be8f1879
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 11 11:37:59 2013 +0000

    daemon: initrd: Remove use of PATH_MAX and other cleanups.
    
    - Move variables to the top.
    - Rearrange comments to make more sense.

commit 1703c6841b397d92c278fcb5bac749b0ab35e33a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 11 08:43:01 2013 +0000

    daemon: find0: Remove use of PATH_MAX.

commit e527aed8958ebfb9ea04520144e3c69848940187
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 11 12:43:48 2013 +0000

    getline: Rename &n parameter as &allocsize.
    
    The second parameter passed into getline(3) is the size of the
    allocated buffer, *NOT* the length of the returned line.  This can be
    confusing, so rename this parameter as 'allocsize' consistently
    throughout the code.
    
    This is just code motion.

commit e0a3a7c1e50107a9304d4f3193453988d6dc35ea
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 9 22:38:24 2013 +0000

    docs: Improve reasons for using libguestfs-make-fixed-appliance.
    
    Thanks: Richard Harman.

commit d6c0ff055dea9fe56d196ccd49b17fcc105d8c42
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 9 21:17:41 2013 +0000

    launch: libvirt: Make it clear that setsockcreatecon debug message is just a warning.
    
    This was disturbing to some users, but other users saw the warning
    when it was really something they should pay attention to.  Make it
    clear that it's a warning, unless people are really using SELinux +
    sVirt.
    
    Thanks: Richard Harman.

commit 8ad8e1075b4f69e87014a033537da9decac35420
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 9 21:02:11 2013 +0000

    Version 1.21.9.

commit d538af8a0a5169e1c0e5f8d4e6222c47cbe237aa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 9 20:52:40 2013 +0000

    rescue: Count the mountable filesystems when displaying the 'suggest' message.

commit 4255db65e58a86148ec291a7416a1148c453d926
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 9 17:34:53 2013 +0000

    tools: Use CLEANUP_* macros in several C tools.

commit 20a562321c20a7902843537c4f3a1e6d58ba4c3b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 9 17:48:30 2013 +0000

    generator: Export libxml2 CLEANUP_* macros unconditionally.
    
    These call abort() if libxml2 is not actually installed, but that
    should never happen inside the library or tools.

commit 94d90f03e2bbb595890b01e2a10b63e00e976691
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 8 18:10:44 2013 +0000

    lib: Define CLEANUP_CMD_CLOSE macro and use it throughout the library.

commit 59b296fecc4d2287cfbac4f07c8f6291d3fcfc41
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 8 14:14:06 2013 +0000

    tools, tests: Use "guestfs-internal-frontend.h" header.
    
    Instead of redefining STREQ, etc.

commit 30029b7ffb7f7bfda474301fd134e773fdf7db7e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 8 14:10:41 2013 +0000

    lib: Use CLEANUP_FREE_<struct>, CLEANUP_FREE_<struct>_LIST macros in a few places in the library.

commit 5f54da6fdf63f8bc9c831fa4e1fb7239c08e3306
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 8 13:39:47 2013 +0000

    lib: Add CLEANUP_FREE_<struct>, CLEANUP_FREE_<struct>_LIST macros for API structs.
    
    For example:
    
     {
       CLEANUP_FREE_STAT struct guestfs_stat *stat = guestfs_stat (g, "/foo");
    
       // stat is freed automatically when we leave the scope.
     }
    
    The new header file "guestfs-internal-frontend-cleanups.h"
    includes definitions for these.  It should not be included
    directly.

commit 5e770c8f6a41257ea828bf765aa07624f139d369
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 8 13:53:33 2013 +0000

    lib: Allow guestfs_free_* functions to be safely called with a NULL pointer.
    
    This is so they work just like 'free'.

commit 7b7cfa62e30b6a0810deadbe442a348f2940dec7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 8 16:00:27 2013 +0000

    lib: Remove explicit defines of _BSD_SOURCE.
    
    An equivalent is defined already in <config.h>.

commit cab1a0c1d94441eef693ce559b6a15363ac973ca
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 8 13:38:37 2013 +0000

    generator: Add #ifndef defense around guestfs-internal-actions.h file.

commit 8fb2306be4e183a402e3eaf9ac277b73924516ae
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Jan 23 13:46:33 2013 +0000

    generator: Add new Mountable argument type
    
    This type is initially identical to Device.

commit 6e7f95b669ef1f8fec6ef22d115b8a34adbe6b43
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Feb 8 14:53:05 2013 +0000

    inspect: Fix improperly ignored error in check_filesystem

commit 7d6b5bb837ab5cdb3e8b1774e28499d368917009
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Feb 7 11:22:46 2013 +0000

    inspect: Don't re-implement list_filesystems in inspect_os

commit dd58db7329063f40223ece984a15df7f3b01ad67
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Feb 7 11:04:38 2013 +0000

    Fix bogus partition number passed to guestfs___check_for_filesystem_on
    
    Partition number was being passed to guestfs___check_for_filesystem_on
    based on an index in list_partition. However, this ignores the
    possibility of multiple block devices.
    
    This change makes guestfs___check_for_filesystem_on examine the
    passed-in device directly to determine if it is a whole device, or
    what its partition number is.

commit a7d7e8176f5d8b612f3f3095013f043fe9be3a41
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Feb 7 10:39:00 2013 +0000

    New API: is_whole_device

commit 3045c0cbafddede553da73f1e0afa139e475ac83
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Feb 7 14:18:02 2013 +0000

    btrfs: Fix btrfs_subvolume_list on F18 (RHBZ#903620).
    
    The output of btrfs subvolume list has changed in F18 to include generation,
    which breaks the parsing in btrfs_subvolume_list. This change replaces sscanf
    with a more robust regular expression. The new regular expression should also
    handle the addition of future unexpected columns.

commit c78ec7e085e99bfddd0509dece72bf6a8d0188ce
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 6 14:27:39 2013 +0000

    daemon: Check parameter of base64-out and tar-out before running external command (RHBZ#908322).
    
    For base64-out, check the filename parameter exists and is not a
    directory.
    
    For tar-out, check the dir parameter exists and is a directory.

commit ca056d53bdfd2967be8a0d6908d658e25571878d
Author: Matthew Booth <mbooth@redhat.com>
Date:   Mon Feb 4 14:11:57 2013 +0000

    generator: Add visibility to action struct
    
    The visibility field in action replaces in_fish, in_docs and internal.
    The defined types are:
    
    VPublic:
      A public API. This is exported and documented in all language
      bindings, and in guestfish.
    
    VStateTest:
      A public API which queries the library state machine. It is exported
      and documented in all language bindings, but not guestfish.
    
    VBindTest:
      An internal API used only for testing language bindings. It is
      guarded by GUESTFS_PRIVATE in the C api, but exported by all other
      language bindings as it is required for testing. If language
      bindings offer any way to guard use of these apis, that mechanism
      should be used. It is not documented anywhere.
    
    VDebug:
      A debugging API. It is exported by all language bindings, and in
      guestfish, but is not documented anywhere.
    
    VInternal:
      An internal-only API. It is guarded by GUESTFS_PRIVATE in the C api,
      and not exported at all in any other language binding. It is not
      documented anywhere.

commit f9bafde5e7f1302ce7c5ea304e51a8d90a323b58
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 6 13:27:26 2013 +0000

    daemon: download: Add extra check that download file is not a directory (RHBZ#908321).

commit f473a173b8c8b825a66297502dee39b11fe3d99c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 6 13:14:07 2013 +0000

    daemon: Add more information to certain calls to perror.
    
    Replace selected calls to 'perror (filename)' with:
    
      fprintf (stderr, "syscall: %s: %m\n", filename);
    
    so that more information is available about precisely which syscall
    failed.
    
    Note this is *not* reply_with_perror.  These messages are only printed
    in verbose output, for the benefit of debugging.

commit f631e84102706a3e826c9d2454fe67dad636830a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 6 12:59:00 2013 +0000

    9p: Missing call to reply_with_perror.

commit c98ef8d089e5607ead7f15033e1bfa291d855eeb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 5 20:27:25 2013 +0000

    Version 1.21.8.

commit a0a4ee5245afdb7961d39b243439b902229dd599
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 5 15:31:05 2013 +0000

    Use 'supermin' and 'supermin-helper' in preference to febootstrap.
    
    Febootstrap has been renamed upstream to 'supermin':
    https://www.redhat.com/archives/libguestfs/2013-February/msg00004.html
    
    This commit changes libguestfs so it can use either program to build
    the supermin appliance.

commit 72dd398679cd0bb803daf306d12558369615ba70
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 4 19:43:25 2013 +0000

    daemon: Call wipefs before mkfs to work around pathological behaviour in btrfs.
    
    See: RHBZ#907554, http://www.spinics.net/lists/linux-btrfs/msg21197.html

commit 7e25e0780eac92701904aa86689e8759da98fb86
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 4 21:47:52 2013 +0000

    FAQ: Update section on sVirt.

commit 4075ed9247ad1061efe5438373b7d82230639c77
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 4 13:12:28 2013 +0000

    build: Add src/guestfs-internal-{all,frontend}.h to EXTRA_DIST.
    
    This fixes commit ec3b75e5ffd1abea1400f6609ae9c61eab0dfa71.

commit 776ffbfaec2a52203272024a5a1ef2bf3ec788e7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 4 13:03:25 2013 +0000

    Version 1.21.7.

commit 4940bd9a9e4771c2c1321b7d072fe1018c3e4a9a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 4 11:49:52 2013 +0000

    fish: Be stricter about boolean values.
    
    Previously I noticed that bfan used this command without any error:
    
    ><fs> hivex-open /WINDOWS/system32/config/software write:ture
                                                       ^^^^^^^^^^
    
    This was because the code allowed any string to be evaluated as a
    boolean.
    
    The new code is stricter.  It allows the following strings only case
    insensitive (everything else is an error):
    
      1
      true
      t
      yes
      y
      on
    
      0
      false
      f
      no
      n
      off

commit d012b729faaa3db73bf198f82ae28d567005b137
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 4 12:17:31 2013 +0000

    ruby: Include "guestfs-internal-frontend.h" in extension.
    
    Also undefine '_' symbol defined by Ruby's internal headers.
    
    This fixes commit ec3b75e5ffd1abea1400f6609ae9c61eab0dfa71.

commit 9e27a1556cc653cb10ed6711a5fb70d623cb93ac
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 4 11:49:04 2013 +0000

    perl: Include "guestfs-internal-frontend.h" in XS file.
    
    Also undefine '_' symbol defined by Perl's internal headers.
    
    This fixes commit ec3b75e5ffd1abea1400f6609ae9c61eab0dfa71.

commit 5e4f03ccf25a9996fc4fadb4ce0e17b4b567cd5c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 2 15:24:23 2013 +0000

    README: Format the list of requirements better.

commit 0d18a8b4075c30d28e2f7346f751445b6156e24b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Feb 2 13:56:19 2013 +0000

    Update copyright dates for 2013.

commit 791ad3e9e600ef528e3e5a8d50be79d56b18129d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 1 16:18:42 2013 +0000

    fish: Use CLEANUP_* macros in a lot of places.

commit 6c1aca5ae28021fac9282d13ee0a51a926e5e566
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 1 15:54:13 2013 +0000

    fish: Use CLEANUP_FREE in parse_config.

commit 4b20a20d330f177415faf4a78e063ab81965e011
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 1 14:39:54 2013 +0000

    Remove TMP_TEMPLATE_ON_STACK macro.

commit 42bffcd00aac31f9f844a2a2e9b91faa4509408c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 1 14:16:51 2013 +0000

    Remove all occurrences of the bad_cast (lowercase) function.
    
    Not to be confused with the libxml2 macro 'BAD_CAST' which converts
    from 'signed char *' to 'unsigned char *'.
    
    The 'bad_cast' function was defined and used all over the place as a
    replacement for a '(char *)' cast.  I think it is better to make these
    casts explicit, instead of hiding them in an obscure function.

commit ec3b75e5ffd1abea1400f6609ae9c61eab0dfa71
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 1 13:43:38 2013 +0000

    Rearrange internal header files.
    
    This commit rearranges the internal header files.
    
    "src/guestfs-internal.h" is just for the library, as before.
    
    "src/guestfs-internal-frontend.h" is for use by all library, bindings,
    tools C code, but NOT the daemon.
    
    "src/guestfs-internal-all.h" is for use by all C code including the
    daemon.
    
    This is just code motion, but it has some important consequences:
    
    (1) We can use the CLEANUP_* macros in bindings and tools code.
    
    (2) We can get rid of TMP_TEMPLATE_ON_STACK.
    
    (3) We will (in future) be able to stop bindings and tools code from
    using the safe_* allocation functions (which are NOT safe to use
    outside the library alone).

commit 63c324e6c4e68d7332bd954571965f941548a297
Author: Cole Robinson <crobinso@redhat.com>
Date:   Wed Jan 30 15:05:13 2013 -0500

    tests: Handle changing QEMUDIR
    
    qemu-wrapper isn't regenerated if QEMUDIR is changed, so just
    delete it and force regeneration.
    
    Additionally we can drop the silent binary check, since
    check-with-upstream-qemu-1 already does a similar test with --version
    that will actually report an error to the user.

commit 27b995c8418657e7b371295ebcb26e985a7a1268
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Jan 30 16:48:43 2013 +0000

    Make internal-only functions and structures private
    
    Certain functions are intended to be internal only, but we currently
    export them anyway. This change moves them into a separate section of
    guestfs.h protected by a GUESTFS_PRIVATE variable. This change also
    enables private structs, but doesn't implement any.
    
    This change only affects the C api. Language bindings aren't affected,
    but probably should be in the future.

commit 1dd9bf73b792e88a8428f46a91dd2a3b35fe9571
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Jan 30 10:34:55 2013 +0000

    build: Fix haskell dependencies and parallel build
    
    Without this change all the tests in the haskell bindings are rebuilt
    every time. The primary motivation for this change is to fix this.
    
    The fix for the above also allows parallel builds to be re-enabled.

commit 63c50c7847575c0b1dd5ee0c9976153bd43612e7
Author: Matthew Booth <mbooth@redhat.com>
Date:   Tue Jan 29 15:23:46 2013 +0000

    build: Add common rule for sources shared between daemon and library

commit be4a3d77c42148731a977b68aab8b454372518d7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 29 10:19:12 2013 +0000

    daemon: hivex: Rewrite filename param of hivex_commit to include sysroot (RHBZ#905341).

commit 908c45567cd9a4d84e44470951eddc159135e6d0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 28 18:42:05 2013 +0000

    Version 1.21.6.

commit 950951c67de61da27dceca8ffb2079031c13e43b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 28 15:06:07 2013 +0000

    daemon: Use the new CLEANUP_* macros to simplify code.

commit 233055974d76f8aa93586c8b3bffe8e4f1068a85
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 28 15:05:23 2013 +0000

    daemon: Add CLEANUP_* macros which automatically free memory when leaving scope.
    
    cf commit 98b64650c852ccc9a8eef8b9691052faeb4873c8

commit 071de5ccfbb743f1b68da84f3264eddc2195e8d5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 28 15:04:11 2013 +0000

    daemon: Allow free_strings (NULL) and free_stringslen (NULL, ..).
    
    Equivalent to free (NULL).

commit 3a8a62c3e4ab466904aceb61cba67be14dd5e99d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 28 14:16:17 2013 +0000

    lib: Further use of CLEANUP_* macros.

commit cd3b626a3334e0c11058687acbeed6f9adc92394
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 25 15:54:40 2013 +0000

    launch: libvirt: Use CLEANUP_* macros.
    
    Also implement macros for cleaning up libxml2 objects.

commit 5a3da366268825b26b470cde35658b67c1d11cd4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 24 17:07:38 2013 +0000

    inspect: Use CLEANUP_* macros in inspection code.

commit 98b64650c852ccc9a8eef8b9691052faeb4873c8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 24 16:19:37 2013 +0000

    lib: Add CLEANUP_* macros which automatically free things when leaving scope.
    
    Use the macro like this to create temporary variables which are
    automatically cleaned up when the scope is exited:
    
      {
        CLEANUP_FREE char *foo = safe_strdup (bar);
        ...
        // no need to call free (foo)!
      }
    
    The following code is also valid.  The initialization of foo as 'NULL'
    prevents any chance of free being called on an uninitialized pointer.
    It may not be required in all cases.
    
      {
        CLEANUP_FREE char *foo = NULL;
        ...
        foo = safe_malloc (100);
        ...
        // no need to call free (foo)!
      }
    
    This is also valid:
    
      {
        CLEANUP_FREE char *foo = ..., *bar = ...;
        ...
        // no need to call free (foo) or free (bar)!
      }
    
    The CLEANUP_FREE_STRING_LIST macro calls guestfs___free_string_list
    on its argument.  The argument may be NULL.
    
    The CLEANUP_HASH_FREE macro calls hash_free on its argument.  The
    argument may be NULL.
    
    Important implementation note:
    ------------------------------
    
    On GCC and LLVM, this is implemented using __attribute__((cleanup(...))).
    
    There is no known way to implement this macro on other C compilers, so
    this construct will cause a resource leak.
    
    Important note about close/fclose:
    ----------------------------------
    
    We did NOT implement 'CLEANUP_CLOSE' or 'CLEANUP_FCLOSE' macros.  The
    reason is that I am not convinced that these can be used safely.  It
    would be OK to use these to collect file handles along failure paths,
    but you would still want a regular call to 'close'/'fclose' since you
    must test for errors, and so you end up having to do:
    
      if (close (fd) == -1) {
        // failure case
        // avoid double-close in cleanup handler:
        fd = -1;
        ...
      }
      // avoid double-close in cleanup handler:
      fd = -1;
      ...

commit acb85dafb1ee4c5cc84efd68b610ac743cad9852
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 25 12:39:28 2013 +0000

    Allow guestfs___free_string_list (NULL).
    
    Equivalent to free (NULL).

commit aab796c60873d169333babd4b77cc2642ea2ba48
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 28 13:08:56 2013 +0000

    perl, python, ruby: Add definition of EVENT_ALL in these languages.

commit 27c81f3175d0c287ec10b8279d768dd14abb49c9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 28 13:05:13 2013 +0000

    generator: Define all_events_bitmask.
    
    In the C bindings, use this more accurate mask instead of 'all bits
    set'.
    
    In the Java bindings, use this instead of open coding.

commit ded72a96f08b8563d7b1a114fb916b051c0040a3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 28 13:08:35 2013 +0000

    header: Minor whitespace fix.

commit f3976de591fbdbb238fe5326a606f9c2177977b2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 28 13:06:11 2013 +0000

    header: Deprecate LIBGUESTFS_HAVE_* in favour of GUESTFS_HAVE_*.

commit d3068a3afffdb7b1e33f3a9c39d3f4830baae3de
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 26 18:27:33 2013 +0000

    header: Link to guestfs-examples(3) man page from header file.

commit a0d874725d6e1eaee1bfc5337385b5910ab5cf1f
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Jan 24 14:58:15 2013 +0000

    Update vim line length to 70
    
    Apparently this makes it the same as emacs or something.

commit abb1d466364f74adfcf3c985b92673285fd32e44
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 24 13:09:16 2013 +0000

    python: Inherit from 'object' base class.
    
    This fixes the following Debian bug:
    http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=698771
    
    For an overview, see this question and the links from there:
    http://stackoverflow.com/questions/4015417/python-class-inherits-object

commit ec8939fd471d440305f666a36754510be8f011c7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 22 14:43:37 2013 +0000

    launch: libvirt: Add 'is_root' flag to the params struct.
    
    This is just code motion, but it allows us to read this flag inside
    the 'construct_libvirt_xml_seclabel' function in future (as a possible
    way to fix RHBZ#890291).

commit 085b86a95a9c6f740847039de1f0dd4c47c64bf1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 22 13:50:57 2013 +0000

    libvirt: Add debugging when opening libvirt handle.
    
    When debugging is enabled, this produces output like below.  This is
    useful when diagnosing what URI libguestfs is using.
    
    libguestfs: opening libvirt handle: URI = NULL, auth = virConnectAuthPtrDefault, flags = 0
    libguestfs: successfully opened libvirt handle: conn = 0xb05580

commit 875dc113646d586c5d8fa269ec18d54446a9b352
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 22 13:45:11 2013 +0000

    launch: libvirt: Refactor seclabel code.
    
    This is just code motion.

commit ed5a083891a51527ce2cde5117a6c14de888ac0c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 21 22:16:07 2013 +0000

    Version 1.21.5.

commit 4d8bdf035717b9dced3bc7fd45d74969758eb686
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 21 16:59:23 2013 +0000

    fuse: Use guestfs_rename to implement rename(2) syscall (RHBZ#895910).

commit 159e8f8c3a0e4df5c0a34c1693192a3679a47322
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 21 16:58:54 2013 +0000

    New API: rename: Rename file within the same filesystem (RHBZ#895910).

commit f956457b5d601ade045aeebdeefc5bf5a16a698e
Author: Matthew Booth <mbooth@redhat.com>
Date:   Mon Jan 21 15:57:23 2013 +0000

    docs: Fix cut/paste error in pread_device

commit 28e34290ff0dc11e9c5d8b8a1e5992cd0cc941fb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 21 14:30:32 2013 +0000

    fuse: If guestfs_last_errno returns 0, don't return no error to FUSE layer.
    
    guestfs_last_errno (g) == 0 doesn't mean "no error".  It means the
    errno was not captured.  In this case we have to substitute some sort
    of errno, so choose EINVAL arbitrarily.

commit 533082e28240522df51e6615d99794d726c8e1f0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 21 13:41:23 2013 +0000

    daemon: Change ln, ln-f (hard-link) APIs to use link(2) instead of external ln (RHBZ#895905).
    
    The reasons to do this are twofold:
    
    (a) It's probably a tiny bit faster.
    
    (b) It lets us capture the real errno if the link(2) syscall fails.
    
    The errno is also passed through guestmount, fixing RHBZ#895905:
    
    + guestmount -a test1.img -m /dev/sda1:/ -m /dev/sda2:/boot /tmp/mnt
    + touch /tmp/mnt/foo
    + cd /tmp/mnt
    + ln foo boot/foo
    ln: failed to create hard link ‘boot/foo’ => ‘foo’: Invalid cross-device link

commit ebc86ae6d76bab3e09484a039ddffcb323a106a3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 21 11:14:14 2013 +0000

    Fix checksums-out command (RHBZ#895904).
    
    This was broken by the earlier
    commit 0306c98d319d189281af3c15101c8d343e400f13.
    
    This commit also adds a regression test.

commit e18e20793f12745e96cc28eedd85e3118f8e20e7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 21 08:15:54 2013 +0000

    tests: virt-make-fs: Allow btrfs to be skipped.

commit 2974b5d66612e9cc6d948d4f8d4648510333aed9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 18 17:23:43 2013 +0000

    tests/qemu: Don't require LVM for these tests.

commit 64b229e8ffdf24ee4817a46d809a4919b4269049
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 18 08:18:24 2013 +0000

    Version 1.21.4.

commit d8f14591d10df847fad2e24f2f430b2543020912
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 18 07:11:13 2013 +0000

    daemon: lvm: Fix various paths relative to new lvm_system_dir.
    
    This fixes commit 9fd41abd40c3ffc10985e862dc34c868360a1b22.

commit 312d02afe46452c2fdf6c0a321a8dfbe7ae06631
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 18 07:12:23 2013 +0000

    tests: Don't construct the guests in parallel.
    
    In automake 1.13, check_DATA is now built in parallel, resulting in it
    trying to build 4 or 5 guests in parallel.

commit aa83e7c7b887f21f25685be163b763958983f2c2
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Thu Jan 17 23:59:22 2013 +0100

    Fix packagelist for current Debian-based systems

commit 111f444d69c766f465b68aa7e574cf83b5c7b1a1
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Thu Jan 17 23:59:21 2013 +0100

    inspector: Fix tests for out-of-tree builds

commit 9637bddc33d314cf7d9d4a63630de75b4e3b5dfd
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Thu Jan 17 23:59:20 2013 +0100

    erlang: fix bindtests for out-of-tree build

commit 24c4178749817639ecf9ad61f7de2b0f90f6ba3b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 18 06:42:13 2013 +0000

    appliance: Add libcap to the appliance (thanks Skippy VonDrake).

commit 2c68aca9d791414e011d31bfc09255158972599b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 17 18:21:20 2013 +0000

    automake: Force serial-tests.
    
    automake 1.13 started to use stupid parallel tests by default,
    breaking everything.

commit 9c8e47247b7958ac378542120d4fc8c22ef9ecf0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 17 18:10:14 2013 +0000

    FAQ: Document "Could not allocate dynamic translator buffer" and how to fix it.

commit c61b589f9b426b71d7498e9398c813bb47940a24
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Jan 4 12:54:18 2013 +0000

    gobject: Add pkg-config for gobject bindings

commit 9fd41abd40c3ffc10985e862dc34c868360a1b22
Author: Olaf Hering <olaf@aepfle.de>
Date:   Wed Jan 2 16:13:06 2013 +0100

    daemon: copy entire lvm directory
    
    cp will fail if /etc/lvm is an empty directory. Copy the entire
    directory and adjust environment variable.
    
    Signed-off-by: Olaf Hering <olaf@aepfle.de>
    
    RWMJ:
     - Fixed a couple of whitespace issues.

commit a710c42f0fa6d22664f21bcdcead83642da0d405
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 17 09:43:59 2013 +0000

    Version 1.21.3.

commit a0e9d310d1a2bd725c762a485f2b72761bac35df
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 16 14:28:10 2013 +0000

    ruby: Use updated package names, but allow fallback to the old names (RHBZ#894545).
    
    Thanks Dominic Cleal.

commit d4763a2e2480ebfc46285c7a67448df540c66b81
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 16 11:30:07 2013 +0000

    daemon: Suppress two false positives from Coverity.
    
    Using // coverity[...] or /* coverity[...] */ comments in the source
    it is possible to suppress specific Coverity errors.  The suppressed
    error should occur in the line following the comment.
    
    In this case I have suppressed two false positives from Coverity:
    
    (a) We deliberately assign to a NULL pointer in order to cause a
    segfault, for testing how the library reacts when this happens.
    Coverity flags this, but it is not an error in this case.
    
    (b) Coverity does not model global variables (a known shortcoming).
    Therefore the code 'errno = posix_memalign (...)' cannot be modelled
    by Coverity, even though the code is correct.  Coverity raises a false
    positive about this.
    
    (Thanks Kamil Dudka, Coverity)

commit ce828c6afcabee255e1f706292e92f76eb81c094
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 10 06:25:30 2013 +0900

    podwrapper: Refresh podwrapper man page.
    
    This also adds a rule so you can do:
    
     make podwrapper.1
    
    if you want to read the documentation as a man page.

commit 0d2d26d8e7edf16d51435f10b7f26f800b2c689b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 4 05:07:16 2013 +0900

    java: Implement the event API.

commit 3f08d50863dc9fe694c363e3c7e2b058fcd84ef5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 8 11:29:31 2013 +0900

    java: Use defined constants for flags in call to guestfs_create_flags.

commit 05a67bcc25cf50c487a4e4191cd50b688aeb48bd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 7 23:41:46 2013 +0900

    java: Change synopsis in man page to show use of add_drive.

commit 7d89baa3e9968e93f46c45ff0d9e07dd23753f17
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 7 06:46:09 2013 +0900

    java: Tidy up javadoc.

commit f58b6c5953151931b18f6671c9e67dd154816863
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 9 12:28:23 2013 +0900

    Refresh README file.

commit 20e23ab2a3aa7daad49d665792b1050bf8001249
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 4 12:33:48 2013 +0900

    Update copyright dates for 2013.
    
    On generated files in git and README.

commit e051b270a2ba68d1a22b705d7839317f643624c5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 29 14:28:47 2012 +0000

    haskell: Use unused bogus data types.

commit bff29314df40385fd5b05e1a53859a270ee9ce1c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 29 13:57:24 2012 +0000

    haskell: Typo in man page, lists -> list.

commit 60d744e32f64dbe8badadbd60d2b5e3d092ec8a2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 29 13:38:13 2012 +0000

    haskell: Implement 'head' and 'tail' by hiding the Prelude functions.

commit 406e372469df3a99d5290b28bc2a9964fbc33694
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 29 13:35:07 2012 +0000

    haskell: Use 'import Guestfs as G' in test code.
    
    The code is equivalent but shorter.

commit 67d59d015306f69da4dfff70d818f0f55855ed68
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 29 12:48:23 2012 +0000

    haskell: Document current state of Haskell bindings.

commit 1881be1e56f36caffeb7cb870bb6e3b9278a0135
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 29 13:13:17 2012 +0000

    haskell: Fix RHashtable in the generator.

commit 3a72944597d553f4d2ce9d2dd780c674907bf71f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 29 13:12:52 2012 +0000

    haskell: Use .NOTPARALLEL in this directory.

commit 7718cb5afe8f014d3ea517882f3a581cece823ed
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 28 21:34:28 2012 +0000

    haskell: Fix RStringList in generator.

commit 5ede0b21b08d74d424f9413668e3e50b9c7d7ee0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 28 20:44:36 2012 +0000

    haskell: Add tests of config functions.

commit c9e0ff8831eb478d99d2246c27aaa23c6b33b0ca
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 28 20:19:20 2012 +0000

    haskell: Allow non-appliance tests to run when !ENABLE_APPLIANCE.

commit 604f9a79dbf3cca4f273e0ba4e0356e884aa82c7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 28 20:17:31 2012 +0000

    haskell: Renumber tests according to Perl scheme.

commit 3e7dcc384a7d8f7295a001701b3b072c1be53ebf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 28 20:11:23 2012 +0000

    haskell: Enable RString, RConstString in generator.

commit beebade8740169dc03422df40571f9553bb8eb76
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 28 19:59:31 2012 +0000

    haskell: Enable RBool in generator.

commit 11e111ec01c8a4bbce2f648cd8fdc609f5e9861d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 28 19:55:01 2012 +0000

    haskell: Replace deprecated INCLUDE directive.
    
    The INCLUDE directive is obsolete.  You must now put the name of the
    include file before the C function name.

commit 9ae248e03f81f3f8173a3f822ae868dfa60f1e68
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 27 20:02:31 2012 +0000

    arm: Recomment vexpress-a15 instead of vexpress-a9.
    
    Neither works (because of lack of PCI) but A15 emulation is probably
    better than A9 emulation.

commit 6c9aaf394f078b924a46a5b2e4ab1b3576d17b72
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 27 20:01:15 2012 +0000

    launch: appliance: Fix parsing of QEMU_OPTIONS.
    
    If there was no quoting character, the options could run off the end
    of the string and into whatever string which happened to be following
    in memory.
    
    This bug was revealed when libguestfs was compiled on arm.

commit bcdaa463135d1904ec496aae7207abfb8bdb8e25
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 27 19:36:33 2012 +0000

    launch: appliance: Small refactoring of virtio-scsi detection code.
    
    This is just code motion.

commit a9d70d1ae463136e738d4ef4c56de1195b7f8e65
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 27 18:52:31 2012 +0000

    Fix whitespace in configure.ac.
    
    Standardize on 4 spaces for indentation in configure.ac file.
    This is just a change of whitespace.

commit 364ee94b8d1c4db4dc942a78e64cc72aa6455cae
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 27 18:05:40 2012 +0000

    arm: Prevent -Wcast-align warnings.
    
    See link below for a general description of the problem:
    
    https://github.com/libguestfs/hivex/commit/f8b62e4cd2f65cd712164c59094e81f2958aa000

commit 5af94b56924b6d0277fe0552f4b35ef83de5f88d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 27 15:56:51 2012 +0000

    arm: Only use -device sga if qemu supports this device.
    
    qemu-system-arm does not have the sgabios device.

commit 741c8606db504a2c1a7e7f0df9063a795604da74
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 27 15:27:16 2012 +0000

    lib: Remove useless cast.
    
    'strings' is declared as char **, so the return type of
    this expression will already be char *.  The cast is both
    useless and potentially hides errors.

commit 4a877452f5bf69b9b967f91eb9a527eb4328fd46
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 24 09:48:41 2012 +0000

    build: Fix ./configure --with-febootstrap-yum-config option.
    
    This fixes commit bfddae7ceefa4a419ff56848122a46c71c4d6a3c.
    
    Also tested that all variants actually work.

commit 4b5d27869f5754114d633d6eade5030f04830716
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 22 22:42:29 2012 +0000

    Version 1.21.2.

commit bfddae7ceefa4a419ff56848122a46c71c4d6a3c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 22 17:26:44 2012 +0000

    build: Change --with-febootstrap-yum-config to --with-febootstrap-packager-config
    
    For the rationale behind this renaming, see:
    https://github.com/libguestfs/febootstrap/commit/b8cbe191d0f03af1f6a42a07795995b16d5a8c24
    
    You can still, for the time being, use
    ./configure --with-febootstrap-yum-config
    but it's preferred to switch to the new option.  The new option is
    identical, just renamed.
    
    Qe still pass the deprecated --yum-config option to febootstrap
    itself, since both old and new febootstrap support this.

commit e73cf67762f7eb7b0850a74b9610c6e18b64352c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 20 15:33:12 2012 +0000

    inspection: Set fs->device field on swap devices.
    
    For some reason the fs->device field was not set for swap devices.
    
    Apparently this did not matter before (this bug has existed since at
    least libguestfs 1.16), but in commit 6ee80b8dac we started to depend
    on the fs->device field being non-NULL.  This resulted in segfaults
    when inspecting any guest which had a swap device, eg:
    
     #0  __strcmp_sse42 () at ../sysdeps/x86_64/multiarch/strcmp-sse42.S:164
     #1  0x00007ffff7d740cb in parent_device_already_probed (g=0x703a70,
                            partition=0x6f79b0 "/dev/vda4") at inspect.c:156
     #2  0x00007ffff7d73e00 in guestfs__inspect_os (g=0x703a70) at inspect.c:83
     #3  0x00007ffff7cee11d in guestfs_inspect_os (g=0x703a70) at actions-1.c:397
    
    This commit sets fs->device to the device name.
    
    (Thanks Matthew Booth for first noticing this problem.)

commit 6628cc7ef60bf61d718c76e668546970a0dfb411
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 20 12:09:49 2012 +0000

    Pass noapic on i686 kernel command line.
    
    qemu 1.2 i686 TCG is buggy and hangs when emulating APIC.
    https://bugzilla.redhat.com/show_bug.cgi?id=857026

commit eca01c3105fc8dc7b19883078facd0b121b6e2dc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 18 20:39:46 2012 +0000

    faq: Suggest 'approx' (apt proxy) to speed up Debian builds.
    
    Thanks Hilko Bengen.

commit d1ad89520e626c7fc03fb9627b8a054abd760a61
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 18 17:29:21 2012 +0000

    tests: Skip windows.img tests if it is zero-sized.
    
    If ntfs-3g is not installed, then tests/guests creates a 'windows.img'
    file which is zero-sized.
    
    This is problematical because other tests which use this image will
    fail at best, or hit RHBZ#847549 (qemu/virtio-scsi bug) at worst.
    
    Change the tests which use windows.img so they skip if 'windows.img'
    has zero size.

commit a34072e25b8504abdb65e0e80b05cffbe6fbd46e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 18 16:26:17 2012 +0000

    build: Add 'make print-subdirs' rule, useful for selectively running tests.
    
    If you want to selectively run tests, or if the test suite fails half
    way through, use:
    
      make print-subdirs
    
    to print the subdirectories, select the ones you want to run / the
    remaining ones, and do:
    
      make check SUBDIRS="..."

commit fa162417ed97218d528b8fa03cd22ad9ce788a56
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 18 11:51:42 2012 +0000

    daemon: Make gdisk into an optional dependency and optgroup.
    
    Also document that gdisk is a dependency at all.
    
    This fixes commit 956e30effa25eee00fb9e8f5303a6a1fe7409037.

commit 2434a86da42eb15205929b77765a0038f7d42a31
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 18 08:55:06 2012 +0000

    lua: tests: If $LUA is not set, set it to 'lua' instead of '/usr/bin/lua'.

commit 3f88f88c801fa8ede4d9555338a7b10f6ccb38f5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 18 08:53:34 2012 +0000

    lua: Fix misapplied patch.
    
    This fixes commit 5b70120293f3702f290fba5023a7016fa5ff1beb.

commit 8be9743e742d60c279d80a1d098d17d8a87851bc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 18 08:43:06 2012 +0000

    ruby: Disable -Wstrict-prototypes warning for Ruby headers.

commit 034d393bb13f54c4a471aace55ab7b1f62d2ff21
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 17 22:36:27 2012 +0000

    docs: Properly document attach methods in the guestfs(3) man page.

commit 62f98d64a51c8076d1a233cef8feeeaa9307a4dc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 17 23:01:11 2012 +0000

    lua: Fix Lua configure test on Fedora.
    
    On Debian, the lua pkg-config file is called "lua5.1.pc" (etc)
    whereas on Fedora it's called "lua.pc" for all versions.

commit 5b70120293f3702f290fba5023a7016fa5ff1beb
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Mon Dec 17 22:24:03 2012 +0100

    lua: Use correct binary for tests

commit f07e89c5f90a1cef8e61428f30916d39ab35541b
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Thu Dec 13 20:44:40 2012 +0100

    lua: Add ifdefs for Lua 5.2 compatibility

commit 05103cc6937b709192438eed8333aa1fbbb6af02
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Thu Dec 13 20:44:38 2012 +0100

    lua: Use pkg-config to determine Lua version, parameters

commit 8237ac89c5b51490f3f3c6f44d35ecaa184dca05
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 17 19:27:12 2012 +0000

    daemon: Use pvcreate --force option (RHBZ#887971).
    
    pvcreate fails if the partition contains a swap space signature.  Use
    more force to stop it from complaining.

commit 4ad6b28d83d0d91374fcc308d651d6b36ad88038
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 17 12:25:03 2012 +0000

    Version 1.21.1.

commit eab324bbbb6e38120f5882f7e0fadb86e322557c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 17 12:37:01 2012 +0000

    list-filesystems: Ignore MBR type 0x42 (Windows dynamic disks) (RHBZ#887520).

commit 6f02e33c6fbf2f14ba11ef07cb078ad6f6b2fea3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 17 12:24:29 2012 +0000

    sparsify: Document that virt-sparsify doesn't work well on multi-disk VMs.
    
    See: http://bugzilla.redhat.com/887826

commit 79339798b398eda0cb24f6f192af1a74c8956792
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 16 21:28:19 2012 +0000

    launch: libvirt: Improve loop invariant from previous commit.
    
    This fixes commit 11b6293d1bf7a6c0133c609e0e8067b4422dc794.

commit 11b6293d1bf7a6c0133c609e0e8067b4422dc794
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 16 20:56:39 2012 +0000

    launch: libvirt: Parse capabilities XML and fail early if qemu/KVM not supported (RHBZ#886915).

commit c4ad2c0ce3eea1fdb6e1123e8d5fcfed2d5a0849
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 16 18:35:31 2012 +0000

    daemon: Fold stdout on stderr when running e2fsck.
    
    User Phill Bandelow noted that virt-resize fails with an e2fsck error
    on a host where the system clock had been accidentally set in the
    past.
    
    Unfortunately this was hard to diagnose because guestfsd 'ate' the
    stdout of the e2fsck program.  I have verified by code inspection that
    e2fsck prints messages on stdout.
    
    Thus this changes the daemon to fold stdout and stderr together so we
    get to see all error messages from e2fsck when it fails.

commit 22fe98ad9f885dec1af04dd748d66c344e056032
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 15 20:20:15 2012 +0000

    build: Improve 'make help' output description of 'make extra-tests'.

commit eca2dd2e8c152ffe8a20960b0973bbd6527a051d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 15 20:15:12 2012 +0000

    build: Better formatting for 'make help' output.
    
    This is just whitespace changes.

commit 486efb002ae6a0011401fb6839a0823615f998e3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 15 20:10:25 2012 +0000

    build: Show 'make -k check' as a possibility in 'make help' output.
    
    Thanks to Cole Robinson for this suggestion.

commit 448a02373df95dafc0d4b3e4db0e77c96a09074d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 15 18:14:05 2012 +0000

    ruby: Enable C compiler warnings.
    
    This has the desirable side effect that the correct CFLAGS get passed
    to the C compiler when building the Ruby extension.

commit 1571aef9cc761ffa88da096fc09bd214f3e372c9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 15 18:06:11 2012 +0000

    python: Enable C compiler warnings.

commit 62e775c350edfddeafd829ca3edcdf3a8065eb00
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 15 17:19:53 2012 +0000

    Change the handling of private functions, safe_malloc etc.
    
    Rename guestfs_safe_malloc et al to guestfs___safe_malloc etc.
    
    To use the private functions, code now has to define
    -DGUESTFS_PRIVATE_FUNCTIONS=1.  This will make it easier for us in
    future to work out which programs are using these functions and to
    minimize both the number of programs and the functions they are
    calling.
    
    Note that the Perl, Python, OCaml, Ruby and Java bindings use
    guestfs_safe_* calls.  None of the other bindings do.  This is a bug
    (in the bindings using those functions): these functions will call the
    out of memory callback on failure.  This function defaults to abort(),
    and since this happens from a language binding, there is no way to
    change this default.

commit 27f6878e2af47f798062ae1a6571cdd13c9e5a88
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 15 17:03:11 2012 +0000

    guestfs.h: Fix use of __attribute__ and GCC < 4.
    
    I guess no one uses GCC 3 any more, because if they did, including
    <guestfs.h> would not work since GUESTFS_DLL_PUBLIC would not have
    been defined.
    
    At the same time, ensure that __attribute__((noreturn)) is only used
    when the compiler is GCC >= 3.1.

commit 95df8a7c0cedb0daf8f5318fbeb931f6a67e6286
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 14 21:54:13 2012 +0000

    inspection: Don't call guestfs_hivex_close if previous guestfs_hivex_open call failed.
    
    (Thanks Skippy VonDrake)

commit a9051eb98ea7c97899b98b6b493f0de45a05c17a
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Dec 14 14:01:08 2012 +0000

    daemon: Add sentinel attribute to commandf and commandrf
    
    Causes a compiler warning to be emitted if you omit the trailing NULL argument.

commit 956e30effa25eee00fb9e8f5303a6a1fe7409037
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Dec 14 15:53:27 2012 +0000

    Add support for getting and setting GPT partition type GUIDs
    
    New APIs:
      part_set_gpt_type
      part_get_gpt_type

commit 2aa731e7c441581f0d72bcd06e9431b92931466a
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Dec 13 15:22:39 2012 +0000

    daemon: Remove redundant fork in commandrvf
    
    Currently the code is doing a redundant fork when passed the
    COMMAND_FLAG_CHROOT_COPY_FILE_TO_STDIN flag. The additional
    sub-process does a chroot() which has no effect because all file
    handles are already open at that point, then simply copies its input
    to its output.
    
    This change simply replaces the above with a dup2 of the passed file
    handle to STDIN of the command process.
    
    RWMJ:
      Don't initialize 'pid' variable.

commit d7a806ca1af9d571b8e313b8247ac46ad6338346
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 13 17:53:36 2012 +0000

    configure: Change minor from .20 to .21 for new development branch.

commit e92f9666defd5db09812c1ebd59f9cc4a957475c
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Dec 13 15:22:38 2012 +0000

    daemon: NFC Use symbolic names in commandrvf
    
    Improve readability of commandrvf() by replacing bare int values for
    file descriptors with their symbolic names STD{IN,OUT,ERR}_FILENO.
    
    Also add PIPE_READ and PIPE_WRITE for referencing relevant ends of a pipe.

commit 52cd07a0ac50205da06c61b55e68feb6b0f1777d
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Dec 13 16:03:32 2012 +0000

    daemon: fix directory outside current root when executing commands
    
    When executing a command, we temporarily chroot, fork and exec the
    command, then chroot back. We intentionally don't chdir in the parent
    process so that we can 'jailbreak' the chroot later. However, this has
    the effect that commands are executed with a current working directory
    which is outside the current root.  This unusual state can cause
    errors in executed commands which don't anticipate it.
    
    This change does a chdir("/") before executing and command. This
    happens inside the fork, so the jailbreak isn't affected in the
    parent.

commit f784c8785980e0e1476f370b53722c42b4cf017f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 13 13:20:49 2012 +0000

    Version 1.20.0.

commit 25652a6d5c0e688a0b6a59548ecf2f30a5760da9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 13 11:47:14 2012 +0000

    proto: Free drives array when qemu subprocess dies abruptly.
    
    Commit ed7fda161e1f3d0beb02a368fcbcf5ed95dcdac1 changed the g->drives
    linked list into an array, and also made a subtle change to the
    (undocumented) semantics of drives in the rare case when qemu is
    relaunched.
    
    Every time we go back to the CONFIG state, we should free the drives
    array.  However there was one place where this was not happening.
    This was caught by the tests of the protocol, but only when using the
    default (appliance) method, not the libvirt method which we were more
    interested in testing in Fedora.
    
    When testing on Debian using the appliance method, we therefore hit
    this bug for the first time.
    
    This relates to or fixes the following commits:
      commit 9df159b34a9e41e6f36c5435869a54396b92a864
      commit 33f49d85c2a82e66f33cedccb2dbd14faa6070dd
      commit ed7fda161e1f3d0beb02a368fcbcf5ed95dcdac1

commit 585dd44e173b5141637ce89717ed0689f0c116e4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 13 11:45:36 2012 +0000

    debian: Allow test-disk-labels test to be skipped.

commit 14c7e9e52aaa87d5ef354abb5f4c7385ba5bb4c6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 13 10:46:22 2012 +0000

    launch: appliance: Disable virtio-scsi if qemu <= 1.1.
    
    Debian Wheezy (7) ships with old qemu 1.1 which claims to support
    virtio-scsi but in reality it's broken.
    
    Disable virtio-scsi in this case.

commit 9508b750fd4c85050acbc7f6735c54afb983f9aa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 13 10:38:45 2012 +0000

    launch: appliance: Parse qemu version.

commit c6558c75dd5fee111804a0ca175295ada5f6363f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 13 08:50:12 2012 +0000

    docs: Add website index.html.in to stable release documentation.

commit 5a293885a3ae8deb83bc0cce080420dec7aa511b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 12 17:36:26 2012 +0000

    release notes: Update bugs list because one more bug was fixed.

commit 903e4864c0c1776f38e0bf686117e4ac4c266287
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 11 22:55:27 2012 +0000

    Update gnulib to latest version for libguestfs 1.20 release.

commit 668683bd3dc3fb745b19b9f882b18200e190cdf5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 11 22:00:19 2012 +0000

    docs: Add gnulib update to stable release documentation.

commit 29cec9e2352143b5ddf841992010810ae327a31a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 11 21:55:58 2012 +0000

    build: Fix 'make help' output.
    
    check-valgrind-local-tests -> check-valgrind-local-guests

commit 1a70df0ba6f2e1c3d97b66a7b5dc55dc9742c1bb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 11 21:21:16 2012 +0000

    Update API support ready for libguestfs 1.20 release.

commit 858bd9ffe07207ab87fdd10e2a84930afb9068cb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 11 10:40:42 2012 +0000

    launch: libvirt: Label sockets with svirt_socket_t (RHBZ#853393).

commit 966ebadb1439fb102a11a6f84afa5851cce6d339
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 11 17:16:13 2012 +0000

    Update AUTHORS and BUGS files.

commit 436593f81fe55df503077bf5d425f54f3cef9036
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 11 17:15:49 2012 +0000

    Push and pull latest translations from Transifex.

commit 557b8c6a0d45f1c4974e28f5398ca1b0e6783c20
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 11 17:02:04 2012 +0000

    Update ROADMAP for libguestfs 1.20 release.

commit aeff59daa891f9d04526d47638c83147623ac4de
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 11 16:29:35 2012 +0000

    Update release notes and get ready for the libguestfs 1.20 release.

commit 0efe61b19d4156748912a9a480cd17a141e07575
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 6 13:42:36 2012 +0000

    Add support for Windows dynamic disks (libldm / ldmtool) (RHBZ#782167).
    
    New APIs:
    
      list-ldm-volumes
      list-ldm-partitions
      ldmtool-create-all
      ldmtool-remove-all
      ldmtool-scan
      ldmtool-scan-devices
      ldmtool-diskgroup-name
      ldmtool-diskgroup-volumes
      ldmtool-diskgroup-disks
      ldmtool-volume-type
      ldmtool-volume-hint
      ldmtool-volume-partitions

commit a93ea649594c8cac2226dea7da62e8ba2613a2ad
Author: Matthew Booth <mbooth@redhat.com>
Date:   Tue Dec 11 15:01:12 2012 +0000

    inspect: Remove unused is_mountable field from filesystem struct

commit 66ada9ed3142f8af84f007bf7b673d80c688b2c9
Author: Matthew Booth <mbooth@redhat.com>
Date:   Tue Dec 11 15:01:11 2012 +0000

    inspect: Remove unused is_swap field from filesystem struct

commit 4fd5b89e3689cd0bd7e85cba285bfc73e304643d
Author: Matthew Booth <mbooth@redhat.com>
Date:   Tue Dec 11 15:01:10 2012 +0000

    inspect: Remove unused content field from filesystem struct
    
    RWMJ: Don't remove entire if-clauses.

commit 91b3233e4a45c970424975260fce23d0a1655ca4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 10 19:58:30 2012 +0000

    docs: Copy-edit documentation of the private data area.

commit b554d7de82a14df4784c7ea6aaa6b2a58109742a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 10 17:23:41 2012 +0000

    guestfs-performance: Some copy-editing.

commit 7d2ae9f30f814116c0db8fecda1eb7d412e8ee58
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 10 16:18:39 2012 +0000

    daemon: Generate the code when libraries are statically not available.
    
    Since we as developers rarely test the case where some library is
    statically not available, that side of the code was hardly tested,
    except by unfortunate users in the field who often hit cases where
    functions were missing or misdeclared.  In fact, when making this
    change I noticed several bugs like that.
    
    Change it so that this code is autogenerated, and therefore always
    correct and up to date.
    
    Previous code which looked like this:
    
      int
      optgroup_acl_available (void)
      {
        return 0;
      }
    
      char * __attribute__((noreturn))
      do_acl_get_file (const char *path, const char *acltype)
      {
        abort ();
      }
    
      /* etc */
    
    is replaced by a single line:
    
      OPTGROUP_ACL_NOT_AVAILABLE

commit 5802b30ae5643517b1d29f21eca965c8de703e58
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 10 16:14:42 2012 +0000

    generator: Change optgroups so second element is a list of functions.
    
    Before this commit it was a list of function names (ie. strings)
    making it hard if you wanted to get back to the original function
    definition.

commit 2a2719d889d4d6cced40845a6d7c40c873ab5506
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 10 16:13:15 2012 +0000

    generate: Simplify generate_prototype ~single_line feature.
    
    This is just code refactoring.

commit 74763eafa7c92cd128689aacedce1d8e48f6dfd8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 10 15:49:48 2012 +0000

    daemon: Make sure *.h files have guards against double-inclusion.
    
    This is just code cleanup.

commit 82344085aa1c0cc19b34d6a1be351b4828486f8f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 10 13:07:07 2012 +0000

    erlang: Add more tests.
    
    Since I made lots of changes to the Erlang bindings (prompted by
    Coverity), I wasn't confident that something didn't break because
    there were no real tests before.

commit bc05e91f0ebacf1a59a3ad2c421fce17bac8f788
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 10 12:41:47 2012 +0000

    ./run: Add Erlang support to run script.

commit cac8c56423acf6d4345f05b9d32fd3910fab7b71
Author: Cole Robinson <crobinso@redhat.com>
Date:   Sat Dec 8 20:51:07 2012 -0500

    tests: Fix qemu-wrapper.sh generation

commit 6ab4d505f1afd1df6b96136b19f6e5a5eba1f02a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 8 16:27:46 2012 +0000

    launch: libvirt: Avoid double-close of console socket on error path (found by Coverity).

commit 98391ab9c68a04cbd922344d2d21c867b26eed9d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 8 16:25:09 2012 +0000

    xfs: Remove potential double-free of 'buf' in multiple places (found by Coverity).

commit ac6f94fb3ef571a20841906342357cfc22035c7e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 8 16:22:13 2012 +0000

    lua: Add comment about unsolved, hard to fix race (found by Coverity).

commit 0c6bc2f42fc1a362cdc6c9fdd5f5698f53b1bd28
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 8 16:03:27 2012 +0000

    erlang: Avoid unintentional sign extension (found by Coverity).
    
    Comment from Coverity:
    
      libguestfs-1.19.66/erlang/erl-guestfs-proto.c:115: sign_extension:
      Suspicious implicit sign extension: "buf[0]" with type "unsigned char"
      (8 bits, unsigned) is promoted in "(buf[0] << 24) | (buf[1] << 16) |
      (buf[2] << 8) | buf[3]" to type "int" (32 bits, signed), then
      sign-extended to type "unsigned long" (64 bits, unsigned).  If
      "(buf[0] << 24) | (buf[1] << 16) | (buf[2] << 8) | buf[3]" is greater
      than 0x7FFFFFFF, the upper bits of the result will all be 1.

commit 96e59eee66a474de95ed2fac5a975d8a3c254d1a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 8 15:50:05 2012 +0000

    lib: 'tmpfile' is never NULL (found by Coverity).

commit 359c8f89026b43ababc9026ba9385dbb75f96207
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 8 15:46:46 2012 +0000

    fish: Close 'sock' in remote control code (found by Coverity).

commit b18a1b4e66c9c3ba8bf5a7dd7af14d9e9eef248b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 8 15:42:26 2012 +0000

    md: Free up 'ret' along error path (found by Coverity).

commit a23d065c49dda1100cead9f719fd80808c5caabe
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 8 15:38:54 2012 +0000

    lib: Free up the right list if guestfs_internal_lstatlist returns an error (found by Coverity).
    
    We were freeing up a list, but not the right list.

commit 6d94de3f204bf01aa74cb06cfa796d54204dd08d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 8 15:32:14 2012 +0000

    fish: Don't leak stdout_saved_fd on error path (found by Coverity).

commit 855f023d2eb33fcc7ee072864b3682e7e674045e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 8 15:27:12 2012 +0000

    lua: Don't leak memory for returned objects (found by Coverity).

commit 9733665bc6bb88aa29e587bd66757044a21d5263
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 8 15:19:32 2012 +0000

    python: Don't leak memory along error paths (found by Coverity).

commit a1e37b7ea57ea39ee66f22663284999bb9602204
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 8 14:48:49 2012 +0000

    perl: Use safe_malloc instead of malloc (found by Coverity).

commit 3fe5f0a971e13733499ab1c947a0bf3940f4d0d8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 8 14:46:53 2012 +0000

    php: Return SUCCESS from PHP_MINIT_FUNCTION (found by Coverity).

commit 489cb059c28825ca50fcdaff2f97cd570748bbcc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 8 14:42:58 2012 +0000

    fish: Don't segfault here is 'words' happens to be NULL (found by Coverity).

commit 40bfce762962c25c986ca76bc6f0daac9a1906eb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 8 14:38:20 2012 +0000

    lib: Avoid segfault if guestfs_internal_readlinklist returns an error (found by Coverity).

commit 42e0cf77f3720600432f4d9e61526222b2c92062
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 8 13:44:57 2012 +0000

    inspect: Remove dead code (found by Coverity).

commit 9df159b34a9e41e6f36c5435869a54396b92a864
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 8 13:42:07 2012 +0000

    launch: appliance: Really add dummy appliance slot (found by Coverity).
    
    In the previous code, appliance was unconditionally set to NULL and so
    we never added the dummy appliance slot to g->drives.  This probably
    doesn't matter, since hotplugging doesn't work for the 'appliance'
    attach-method.  Despite that, it's better to get this right.
    
    This fixes commit ed7fda161e1f3d0beb02a368fcbcf5ed95dcdac1.

commit e9e5a0f94ec42c5600b7813806179ddac5c8667a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 8 13:36:04 2012 +0000

    daemon: Fix error checking in function (found by Coverity).

commit 7941f6785e409ad283b654ca26db9f919bf5f7c7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 8 13:30:14 2012 +0000

    fish: copy-out: Fail on some errors when creating output directory (found by Coverity).
    
    However it's not an error if the output directory already exists.

commit 15d5c94377d97bfd5462db52b060f8a9c06d4ea4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 8 13:28:11 2012 +0000

    daemon: Explicitly ignore return value from modprobe command (found by Coverity).

commit baf5a062243f39ccaf409301c260ed317250ff49
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 8 13:25:15 2012 +0000

    fish: Ignore failure of mkdir (noted by Coverity).

commit 091b98a9eaed6a447876c36f7d15f61641da60f7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 8 13:15:18 2012 +0000

    tmpdirs: Explicitly ignore return value from guestfs___cmd_run to keep Coverity happy.
    
    We don't care if this command fails.

commit aa785c85d9f5f21aff62287a315618b878f3039d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 8 13:12:17 2012 +0000

    lib: Explicitly ignore return value from guestfs_parse_environment in guestfs_create (found by Coverity).
    
    The purpose of adding guestfs_create_flags was so that users could
    check for errors from guestfs_parse_environment if they need to.

commit 59b51274ebfce54ac9d384c05dc8c54b393107c0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 8 13:09:29 2012 +0000

    Check for error from some guestfs_set_* calls (found by Coverity).
    
    For some guestfs_set_* calls, add checks for error, when error might
    possibly occur.  eg. It's plausible that guestfs_set_network might
    fail if the attach-method being used doesn't support it (although this
    doesn't happen at the moment).
    
    In other cases, don't check for errors, eg. if the error doesn't
    matter or there's nothing we could plausibly do about it.

commit 8331d46384bc718a793fd840b75b6ad8fba265ab
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 7 13:29:55 2012 +0000

    virt-rescue: Document a method to capture core dumps from within the rescue environment.

commit bb0de6938aec2764586b55a3da4728b74fc09de4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 7 12:33:18 2012 +0000

    daemon: Fix noreturn error in acl and capabilities code.
    
    This is an improvement over the original fix in
    commit fe4cdb2a477e88cd65d418aa3c3f12cb029f3dde.

commit f5e9e2780bbc128dbb4f6bebcce238561d9a2303
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 7 12:32:49 2012 +0000

    configure.ac: Fix comment.
    
    I spent a lot of time looking at how gnulib "manywarnings" works, and
    this comment reflects my improved understanding.

commit 47511ddbc93c1526a0991dfe1e0cf3c158ecd16e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 7 12:07:10 2012 +0000

    Add NOT_SUPPORTED macro to daemon and library.
    
    This convenience macro returns errno == ENOTSUP.

commit 77e9b1a9e869802fc72e8f1a4ce81d25c12fcfee
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 7 12:05:12 2012 +0000

    appliance: Add (default commented out) section containing debugging tools.

commit 52744cc232641580847d7239d163cf15298f8651
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 4 15:21:49 2012 +0000

    tests: charset: Fix broken Makefile.am escaping.
    
    This fixes commit 5a2e320ec9390b2146feea6d7b3b8c36a34d0a90.

commit 5a2e320ec9390b2146feea6d7b3b8c36a34d0a90
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 4 11:37:15 2012 +0000

    configure: Add --enable-code-profiling and --enable-code-coverage flags.
    
    These configure flags enable code profiling (with gprof) and code
    coverage (with gcov) respectively.
    
    Although this is a nice idea, it's not currently very useful.
    
    Libtool mangles filenames in such a way that gcov cannot locate its
    datafiles.
    
    Profiling is of dubious utility with libguestfs which is not CPU-bound
    and relies extensively on running external programs (oprofile-like
    system profiling that took into account libguestfs + qemu or
    libguestfs + qemu + the appliance + filesystem tools *would* be
    useful).
    
    Also neither flag will help in capturing data from the appliance.

commit f92b4a7d8358f4931f8eb85a8f159ae7dccd2bed
Author: Evaggelos Balaskas <ebalaskas@ebalaskas.gr>
Date:   Mon Dec 3 22:15:39 2012 +0000

    packagelist.in for archlinux
    
    latest archlinux has some small changes:
    
    btrfs-progs-unstable --> btrfs-progs
    genisoimage --> cdrkit
    iproute --> iproute2
    module-init-tools --> kmod
    procps --> procps-ng
    udev --> systemd
    util-linux-ng --> util-linux
    
    and could you plz add the below packages
    
    lrzip
    less
    sed
    
    RWMJ: I took this opportunity to make some general cleanups to the file:
    
    - add 'less' and 'sed' for everyone
    - 'module-init-tools' & 'kmod'[1]
    - 'procps' & 'procps-ng'[1]
    - 'util-linux' & 'util-linux-ng'[1]
    - sort the ArchLinux packages into order
    
    [1] Note that febootstrap is supposed to ignore packages it doesn't
    know about.

commit 57009f0136dd2188f4d0a44dfc32952999f79ae2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 3 18:45:59 2012 +0000

    build: Make 'check-valgrind' fail noisily if valgrind is not installed.
    
    The way the existing configure script worked, @VG@ would be empty, and
    it would run all the way through the check-valgrind rule successfully
    without actually running anything under valgrind.

commit 3cced0950cd3bdde6b3d862fdf88be4c7c81475f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 1 19:01:31 2012 +0000

    docs: Minor copyedits to the release notes.

commit e35045720bb48e4febdcd33d5f05820dda0da5f5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 1 14:56:25 2012 +0000

    Update release notes.

commit 443ea95faff78fe91fdf601cde81b72a4163b83c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 1 13:38:58 2012 +0000

    Version 1.19.66.

commit b57ab59b8e373fa26bf35378c8fb60fb6ee1a028
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 1 13:20:55 2012 +0000

    doc: Document problems with hibernated Windows guests and Windows 8 "fast startup" (RHBZ#882299).

commit 921b716b0b4079a61d1a68e814a3808852f5a318
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 1 11:45:55 2012 +0000

    test-tool: Parse the environment separately.
    
    This lets us report bugs when parsing the environment.

commit e8d6d6f737ec0dce73b34b3ff85943497883b6e0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 1 11:43:33 2012 +0000

    test-tool: Create the handle later.
    
    Although this leads to a small amount of code duplication with the -V
    option, the overall effect is cleaner.
    
    This is just code motion.

commit 6b5f9221b4fa5842c428e4258205c39295203127
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 1 11:33:23 2012 +0000

    tmpdirs: Make relative TMPDIR (etc) absolute, and check it's a directory (RHBZ#882417).
    
    This fixes commit 1efed122c07792f4c66a4083159cfacfb1893212.

commit 575895d8b062697fcdddc773fae0f55f5b50c6e8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 1 11:14:57 2012 +0000

    test-tool: Print tmpdir properly.
    
    It was actually printing cachedir.
    
    This fixes commit f9ab256f0e4c1197b505b0249e66e7614644bd0b.

commit 3d59ed5458575e417e704db58ede43a4e386014d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 1 09:27:40 2012 +0000

    inspection: Get icon for Windows 8 (RHBZ#801117).

commit c08fbc9cb490a5cfaea7ff344c20f7ffcdbf39e3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 1 09:09:56 2012 +0000

    contrib: Useful script to extract all logos/icons from a Windows guest.

commit 160977987f8e3922cebcdaaeb36fa69f92dc7587
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 30 23:00:33 2012 +0000

    inspection: Temporary logo for Windows 8.
    
    See the comment from the code:
    
      NB about Windows 8: No location we've found so far contains a
      suitable icon for Win8.  In particular, explorer.exe definitely
      does *not* contain any Windows logo as a resource (I checked).
      Therefore the "basket icon" that this produces is just a stand-in
      until we have a better idea for solving this problem.
    
    and:
    
      https://bugzilla.redhat.com/show_bug.cgi?id=801117

commit f5ae46dca79511cf2d4762ca4ef07b59bd647309
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 30 12:32:30 2012 +0000

    inspection, virt-sysprep: Use /etc/hostname on F18+, RHEL7+ (RHBZ#881953, RHBZ#858696).

commit fe4cdb2a477e88cd65d418aa3c3f12cb029f3dde
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 30 09:00:08 2012 +0000

    daemon: Avoid gcc warning about noreturn function in acl & cap code.
    
    acl.c: In function 'do_acl_get_file':
    acl.c:158:1: error: function might be candidate for attribute 'noreturn' [-Werror=suggest-attribute=noreturn]

commit a8f6e06b3008d626824d46921e29b524c03757a2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 29 19:39:57 2012 +0000

    Version 1.19.65.

commit 6ee80b8dac508927ff56ba6093bc47755f4880ae
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 29 17:24:30 2012 +0000

    inspection: Don't probe partitions when we've probed the whole device (RHBZ#798979).
    
    So we don't get multiple <operatingsystem> entries, particularly for
    install ISOs.

commit 90e7981082a2685b235724a6dd9b737cb90fe553
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 27 17:38:31 2012 +0000

    inspection: Read libosinfo database in order to inspect OS install CD/DVD/ISOs (RHBZ#803650, RHBZ#805417).

commit 31101db4c706ac0b8a32ee08f2ba19c0f33208f8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 29 16:53:55 2012 +0000

    lib: Indent CFLAGS in Makefile.am.
    
    This is just a whitespace change.

commit 56937996142ea880f0d5e79f1223004c9ae19a1c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 29 16:52:17 2012 +0000

    inspection: Move variable decls to top of function.
    
    This is just code motion.

commit fc6f34d5cd5cbba4f6a55f9ed8d108acaeeeb64a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 29 15:23:28 2012 +0000

    inspection: Implement "openbsd" type and distro.

commit 0e5eef87d0bdbd8690d9a6863a49bee4d6a198da
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 29 17:06:37 2012 +0000

    daemon: isoinfo: Fix parsing of bogus dates.
    
    eg:
    
    $ isoinfo --debug -d -i ubuntu-12.04-desktop-amd64.iso
    CD-ROM is in ISO 9660 format
    System id:
    Volume id: Ubuntu 12.04 LTS amd64
    Volume set id:
    Publisher id:
    [...]
    Creation Date:     2012 04 25 16:13:46.00
    Modification Date: 2012 04 25 16:13:46.00
    Expiration Date:                :  :  .
    Effective Date:                 :  :  .
    [...]

commit 380ce2eeaab5d37e5343aa2ba1fcde755ecefa23
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 29 11:44:50 2012 +0000

    fish: Make type == drv_N field private to guestfish.
    
    The -N option / drv_N type only makes sense when we are compiling
    guestfish, and just serves to complicate non-guestfish code.

commit 9e7daf2ee8f0a619440ca1c55dfe5ddcf61b4460
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 29 11:04:29 2012 +0000

    virt-df: Better output when multiple -a/-d options are specified (RHBZ#880801).
    
    This is very well explained in the bugzilla comments:
    https://bugzilla.redhat.com/show_bug.cgi?id=880801#c1
    
    With this change, the disk name has a one or more plus signs ('+')
    appended to show that there are additional disks:
    
      $ virt-df -a Win7x32TwoDisks-a -a Win7x32TwoDisks-b
      Filesystem                   1K-blocks    Used  Available  Use%
      Win7x32TwoDisks-a+:/dev/sda1    102396   24712      77684   25%
      Win7x32TwoDisks-a+:/dev/sda2  12478460 7403416    5075044   60%
      Win7x32TwoDisks-a+:/dev/sdb1    521212   55728     465484   11%

commit 6255cc834319715165386655014e7c2fb12adafc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 27 08:48:39 2012 +0000

    Add .mailmap to EXTRA_DIST.

commit 36232b0bbe5097454ead7aeb297886450b794462
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Tue Nov 27 16:40:22 2012 +0800

    Add the .mailmap and change the method to generate AUTHORS
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 567747f78e40cd3a18ebb4bfece864806fcdcd04
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 26 09:00:16 2012 +0000

    lib: lpj: Refactor code.
    
    Only run one grep command to grep any number of files.

commit 8243c0c6f66e50aab7593d34d090baae4cfa66db
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 26 08:58:26 2012 +0000

    lib: lpj: Only return first match in read_all function.
    
    If there where several lpj=.. matches then the earlier matches would
    be leaked.  Only return the first one and don't leak memory.

commit d2c75dd0ffc8c468880ad18d83167bbb183928b1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Nov 25 18:11:19 2012 +0000

    lib: Get lpj= from /var/log/boot.msg (thanks Olaf Hering).

commit d7517360f26cb27a2d4b06e2dc1b0a02968fe55e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 24 15:11:28 2012 +0000

    Version 1.19.64.

commit a4c0d7a82a906ed5213740227efc279d3e557165
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 24 14:17:35 2012 +0000

    launch: appliance: Handle non-\0 terminated buffer correctly.
    
    The read_all function is used as a callback for
    
      guestfs___cmd_set_stdout_callback (cmd, read_all, [str],
                                         CMD_STDOUT_FLAG_WHOLE_BUFFER);
    
    As noted in the documentation for CMD_STDOUT_FLAG_WHOLE_BUFFER, the
    buffer returned is not \0-terminated, and so using memdup will create
    an unterminated string, and therefore potentially a memory overrun
    when reading or searching the string.
    
    Use strndup instead so the final string is \0-terminated.

commit aeea803ad0fafe1ed4c7f8e781dfe4fdc150cac0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 24 13:50:27 2012 +0000

    appliance: Pass lpj=... on the appliance command line (thanks Marcelo Tosatti).
    
    Try to get the host's loops_per_jiffy value and pass this on the
    command line to the guest.  In theory this should avoid the appliance
    having to recalculate this value in a VM with TCG (which is generally
    error-prone).  This should avoid timing issues.
    
    We only do this when we are certain that the guest will be TCG.
    Currently we only have enough information to do this from the libvirt
    attach-method.  So mostly this will only affect people using Fedora in
    a VM.
    
    The host loops_per_jiffy value is not exported by the kernel.  It is
    only printed by the kernel early during boot, so if boot messages have
    "scrolled off" the kernel ring buffer, it won't be available.  Some
    operating systems save early kernel messages in /var/log/dmesg but (a)
    Fedora 18+ seem to have abandoned this file and (b) on Ubuntu this
    file is unreadable for spurious "security" reasons.
    
    I have submitted a patch to make lpj available through /proc/cpuinfo.

commit 62895440bc13abe1bc7dbccf9f8b412f16d16a7d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 24 12:51:11 2012 +0000

    launch: libvirt: Refactor parameter passing to construct_libvirt_xml* functions.
    
    This is just code motion.

commit e987c038ead0a2398f13727ab1de518a216a1d50
Author: Olaf Hering <olaf@aepfle.de>
Date:   Fri Nov 23 20:20:13 2012 +0100

    lua: fix build error due to LUA_GLOBALSINDEX usage
    
    lua 5.2 changed API, LUA_GLOBALSINDEX is no longer available.
    http://www.lua.org/manual/5.2/manual.html#8.3
    
    Signed-off-by: Olaf Hering <olaf@aepfle.de>

commit 12acff5f56f5dbd85840d8f7c570f23ff122a7a1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 23 17:33:00 2012 +0000

    Version 1.19.63.

commit 1ef9af9acbd4cfaadb3f96e0e1a5e519fad2da9d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 23 17:17:57 2012 +0000

    daemon: Ignore lvresize error "New size..matches existing size" (RHBZ#834712).
    
    The lvresize command unnecessarily gives an error if you don't
    change the size of the LV.  Suppress this error.

commit dd4038c8a4f7f1326f0399ea83f48c22a3ce6c2a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 23 14:50:54 2012 +0000

    test-tool: Don't print banner when using --help, -V, etc options (RHBZ#879416).

commit 2272cccfd4d78c37ae7fa16369a9893f29533a1a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 23 12:30:21 2012 +0000

    launch: Refactor duplicate code which constructs the appliance command line.
    
    Move this into a common file.

commit a6a0b9ba164f68dd79782f054604102017bc9c15
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 23 12:12:33 2012 +0000

    lib: Fix memory leak and simplify command code.
    
    Fix the following memory leak found by valgrind:
    
    ==13629== 498 (112 direct, 386 indirect) bytes in 1 blocks are definitely lost in loss record 99 of 110
    ==13629==    at 0x4A06B2F: calloc (vg_replace_malloc.c:593)
    ==13629==    by 0x4CA564E: guestfs_safe_calloc (alloc.c:71)
    ==13629==    by 0x4CA9B02: guestfs___new_command (command.c:143)
    ==13629==    by 0x4CA66E9: guestfs___build_appliance (appliance.c:690)
    ==13629==    by 0x4CBD1B9: launch_libvirt (launch-libvirt.c:188)
    ==13629==    by 0x402E7E: main (virt-filesystems.c:349)
    
    Also adjust the command code in several places to make it simpler.  We
    can almost always call guestfs___cmd_close right after
    guestfs___cmd_run, avoiding any need to close the handle along error
    paths.
    
    Tested by running the test suite under valgrind.

commit fae8d7cafb66e0da697cde71f7e9444165c76ff7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 22 14:49:54 2012 +0000

    New APIs: Implement Linux filesystem capabilities.
    
    This adds the following new APIs:
     - cap_get_file
     - cap_set_file

commit 218b39acae324955b089dcfc191b0270b6bafb62
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 22 14:49:54 2012 +0000

    New APIs: Implement POSIX ACLs.
    
    This adds the following new APIs:
     - acl_get_file
     - acl_set_file
     - acl_delete_def_file

commit 784e53287e18c324dda9c4cc93b9aae4790eb909
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 22 09:54:48 2012 +0000

    fish: Fix test-remote-events test.
    
    Because the shell script was missing a space, the final output test
    was failing, although for some reason this didn't cause the whole test
    to fail.
    
    Fixing the missing space also revealed a bug in the test output, which
    is also fixed.

commit 9fb5a3ceaffd88aaf37b5253e540626457319d24
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Wed Nov 21 17:50:58 2012 +0800

    sysprep: remove crash data generated by kexec-tools
    
    Remove the kdump generated kernel crash data.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>
    
    RWMJ:
     - Added /var/log/dump/* path for SLES (thanks Olaf Hering).
     - Update po/POTFILES-ml.

commit 30f202da4388a801fbe17314fd22fcf04431d10f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 20 19:53:18 2012 +0000

    Update API support.

commit 8ae8f1453b1efe69d3f14fcd5eef5b8982104e78
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 20 19:51:45 2012 +0000

    Update PO files from transifex.

commit 20d524f4faad274f06131770096a4321d79c217b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 20 18:31:55 2012 +0000

    Version 1.19.62.

commit d0f89fed85d7f6c07a4d76d2e11f3a6812b63dd4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 20 18:40:15 2012 +0000

    ./run: Ensure all paths are built up cumulatively.

commit 12905a9bbbfc5a39401bfd3b629ac96b9ce93f3e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 20 18:31:45 2012 +0000

    lua: valgrinding Lua code doesn't work.
    
    See comment.

commit 1e321b883b8c7f5b7c072e869db26f5a1a0a152e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 20 18:31:16 2012 +0000

    valgrind: Ignore init_libguestfs symbol.
    
    It's not relevant, since the memory leak begins in libvirt.

commit 0ff561f3324df2841c90e65fb994294d2ddcfca0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 20 17:34:23 2012 +0000

    lua: Replace internal lua_guestfs_* functions with guestfs_lua_*.
    
    This is just code motion.  It just ensures there is no possible
    conflict with lua_* symbols.

commit 1f984509952865632f434b4349f679a2e4a42935
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 20 17:32:37 2012 +0000

    lua: Attach __tostring functions exceptions.
    
    This includes a test.

commit 4749bff379862205dfa6c6ff94984711894c9eb0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 20 16:42:40 2012 +0000

    lua: Fix whitespace.

commit ca488a6d7b6f5701b63249d5a0c73eada09c432c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 20 16:20:12 2012 +0000

    lua: Various fixes to the bindings (thanks Jerome Vuarand).
    
    See http://article.gmane.org/gmane.comp.lang.lua.general/95065
    
    Note that this is incompatible with existing code.  You
    have to do:
    
      local G = require "guestfs"
      local g = G.create ()
    
    ie. give the module your own name ("G" in that example).

commit 8f80f9fdae13a320da978dffa2c9d94e7b68a810
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 20 14:23:35 2012 +0000

    lua: Print the error thrown by callbacks.

commit efb2d07ad642bd227e40ed917332f64f82b2553d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 20 14:15:45 2012 +0000

    lua: Add comment (not fix) for incorrect 'g' argument in callbacks.
    
    Thanks Jerome Vuarand.

commit 7f1f7dd44f4b85c1ce027b2ed194d388518ff452
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 20 13:56:06 2012 +0000

    lua: Add bindtests.

commit b19f007bd2449f635780078e61a174f19838b32d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 20 14:11:34 2012 +0000

    lua: Use lua_rawgeti to read elements from lists of strings.
    
    This is faster, but more importantly it avoids the strange error
    'lua: attempt to index a string value' which appears with (some)
    single element lists.

commit 69c5f3045a7a25ef62f65b47a79c60e3de77fee0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 20 13:55:46 2012 +0000

    lua: Add LuaStyle of commenting to the generator.

commit 74105fdab11385c85d634f5d3ffe3acd165406a4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 20 13:39:38 2012 +0000

    lua: Allow regular int to be passed as a 64 bit integer.

commit 3454cfb73c74b4fd3fba9d834c13685b166d9d3f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 19 15:43:52 2012 +0000

    daemon: wipefs: Use --force option if available.
    
    See https://bugzilla.redhat.com/show_bug.cgi?id=872831
    and https://bugzilla.redhat.com/show_bug.cgi?id=865961

commit b5b475ab827b862cce07ab095e4cb8b4ab1a954a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 20 09:10:15 2012 +0000

    lua: Simplify get_event function.
    
    Use luaL_checkoption which is designed for this purpose.

commit fdfdc883fcac8c8d7e4e9a86572d941421b5ff87
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 19 18:19:29 2012 +0000

    lua: Document Guestfs.event_all.

commit e866ee7c792ab3c5a25737e27038a718b0c5a995
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 19 18:16:08 2012 +0000

    erlang, lua: Fix links in man pages.

commit 556fc92e8adc6c10e1608dafaca89d9cac581fb7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 19 17:13:14 2012 +0000

    lua: Test globals in Guestfs.* namespace.

commit bc03a48c7132c75072003fcdd54930db3b70721e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 19 17:06:21 2012 +0000

    lua: Add global Guestfs.event_all (list of all events).

commit 36e71e0cf45b5515d8447d959d9a1642223f2dc7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 19 14:46:59 2012 +0000

    Version 1.19.61.

commit f77ddb9e114e560724d6548499047ae6894ab59c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 19 13:00:52 2012 +0000

    lua: Various fixes and enhancements:
    
    - add support for events (with test)
    - test progress messages
    - update documentation to describe events
    - refactor handle closing code
    - refactor error code
    - use 'assert' in test code instead of 'if ... then error end'

commit d14557d434de5cb1c9754ae0f3e8e820e0a46694
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 19 09:39:30 2012 +0000

    perl: Add test of multiple independent handles.

commit 6e5916e0f4da885b61350e1edc96e6173a5ea324
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Nov 18 19:24:20 2012 +0000

    lua: examples: Boolean true shouldn't have quotes around it.

commit 6483c506b91d0093af96f361d6756853fac26972
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Nov 18 16:45:44 2012 +0000

    lua: Add another test to prove that the handles are really independent.

commit 6710296b7a597b0741b0559f2cefc3997986de40
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Nov 18 16:45:08 2012 +0000

    lua: Don't use %m since Lua string formatter doesn't understand it.
    
    Use %s + strerror as a replacement.

commit 4ba8b5a00d7336e87e15a854b0534c630f456f7c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 17 21:17:44 2012 +0000

    lua: Add some missing features.
    
    - Remove default error handler.
    - User cancel.
    - Add the errno to the object which is thrown on error.
    
    Still no events.

commit a9c4efdcfd213202c9c9b478e92fe908a700b957
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 17 20:02:25 2012 +0000

    Version 1.19.60.

commit ff8bfd3e92f21955d0a91b481583131f356b8fe4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 17 10:10:13 2012 +0000

    Add Lua bindings.
    
    These are relatively complete, although only lightly tested.  Missing:
    
     - events
     - last_errno
     - user_cancel

commit 4a2e8e89577ad4031aba1b2e5afb65ca58c2c39d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 17 18:14:05 2012 +0000

    perl: Clean up and update the tests.

commit 3d0e937b84b4d028d80b66afb960903b7bc10b97
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 17 17:55:00 2012 +0000

    perl: Small test of create with flags.

commit 43369e1bd4d98acf1cce6eb0216dcdb43d43bf1b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 15 16:37:23 2012 +0000

    sparsify: Better error when user specifies --compress + raw output (RHBZ#852194).

commit 2f321ced219eeff9a2df305fd8a621c03875893f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 15 15:35:25 2012 +0000

    todo: We must implement ACLs and filesystem capabilities for SCAP.
    
    Thanks Steve Grubb.

commit a41629deb965830788d6b531272a0a20767e2ce6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 15 10:08:21 2012 +0000

    daemon: Perform device name translation on mke2fs journaldevice (RHBZ#876579).
    
    Also various fixes:
    
     - remove fixed-size buffer
     - change if (err) free (err) -> free (err).

commit 5d9f10c31297c5f6bfe261717dfc5c841722a4c2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 15 09:01:15 2012 +0000

    recipes: Add sections about hexdumping, hexediting sectors.

commit fd81d3f9b25f9ee8616091c9c3abb7373e185015
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 14 22:34:06 2012 +0000

    recipes: Add recipe for diffing two guests.

commit 5638cd3024f7d891be098ce7f9962213e49b9270
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 13 14:42:49 2012 +0000

    Version 1.19.59.

commit e8ad3efbc4e91e4a48654d65981f5906b462fb96
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 13 15:21:42 2012 +0000

    dist: Add miscellaneous files to the tarball.
    
    Lots of these had been omitted over time.

commit 2d89aef897e633bffba1dffd600b122eacd88fc8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 13 15:19:53 2012 +0000

    tests/protocol: Add test-qemudir-launchfail.sh to tarball (but don't run it).
    
    This file was present in git, but missing from the tarball.
    
    Don't actually run the test: it depends on details of how the
    appliance is constructed which would fail for old-style appliances.

commit 715afda3416080ef9ee961f3ebcff7ef16cfc986
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 13 15:16:49 2012 +0000

    fish: Add test for remote events.
    
    This test was present in git, but not included in the tarball,
    nor in the tests that guestfish actually runs.
    
    This fixes commit 17182af3a6de8e3e94e0a914416c54f09bb74007.

commit 5c44c691f2c288e04571b54c1b6844402f9865e4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 13 14:31:01 2012 +0000

    tests: Add a parallel launch test.
    
    This is designed to reveal libvirt race conditions such as
    bug 875741.
    
    This is a "slow test" so it only runs if you do 'make check-slow'.

commit ee5f18293b72779ea7387414cca5cd8c35230fc8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 13 13:46:47 2012 +0000

    tests: Add 'make check-slow' rule to recursively run slow/long-running tests.

commit cb4284b9e331c5c27351dadf8fe776f137eff318
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 13 12:53:40 2012 +0000

    Add 'make help' rule.
    
    This gives a short overview of the make targets.

commit 3636c5fcff69e7a5a5afa126a597883db4c781bb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 12 17:54:31 2012 +0000

    tests: Replace 'make extra-tests' with individual tests.
    
    'make extra-tests' was a monolithic set of tests that did all sorts of
    things: valgrind, tests over local guests, tests with upstream qemu,
    tests with upstream libvirt, tests with the appliance attach method.
    
    This made it hard to perform individual tests, eg. just valgrind
    testing.  It was also hard to maintain because the tests were not
    located in the same directories as the programs and sometimes
    duplicated tests that were run elsewhere.
    
    This commit splits up 'make extra-tests' into 5 separate targets:
    
     make check-valgrind              # run a subset of tests under valgrind
     make check-valgrind-local-guests # test under valgrind with local guests
     make check-with-appliance        # test with attach-method == appliance
     make check-with-upstream-qemu    # test with an alternate/upstream qemu
     make check-with-upstream-libvirt # test with an alternate/upstream libvirt
    
    (You can also still run 'make extra-tests' which is now simply
    a rule that runs the above 5 targets in order).
    
    This replaces everything that was in the tests/extra directory,
    so that has now gone.

commit c4a3ea066be9823d4572b57fd05940345904b826
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 13 09:01:53 2012 +0000

    extra-tests: Add $(libvirt_ro_uri) substitution to configure.
    
    This is essentially just code motion.

commit 765d14dc0551b2c05d6a846aa6701055b080180c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 12 18:13:37 2012 +0000

    Define whole valgrind command (as @VG@) in the configure script.
    
    This is mostly just code motion, but it also changes the default
    location where valgrind.log is written to be the top build directory
    (instead of tests/extra/valgrind.log).

commit ab360c48d4bf6ddb3f14c0f2434e235dfea3a184
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 12 20:10:55 2012 +0000

    align: Add a test for virt-alignment-scan.

commit ac2ddfd90a7f5f424b19fbfbfb06d4dfff0547fa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 12 18:46:13 2012 +0000

    fish: Add simple tests of starting up, inspection, using the prepared disks.

commit 73631705cfdad72ed4ae8446757dd41c341800dd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 12 18:26:48 2012 +0000

    inspector: Add some real virt-inspector tests.

commit e884abfd06f3f06eab3f8db9843367ab62f7e9e9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 12 15:06:44 2012 +0000

    extra-tests: Move valgrind suppressions file to top source directory.
    
    This is just code motion.

commit b2663be064dd369d96259d2bc2ed54ffe616e595
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 12 13:39:03 2012 +0000

    Various fixes to API support script.
    
    Remove internal structures, fix it so it works with the new
    code layout under src/

commit 02ecd048d3caf7804361bb0f5dca071f97aefaa1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 12 12:56:39 2012 +0000

    lib: Split up huge src/guestfs.c into logical compilation units.
    
    This file had grown by accretion to include:
    
     - code related to handles (now in src/handle.c)
    
     - safe allocation (src/alloc.c)
    
     - debug, errors, warnings (src/errors.c)
    
     - private data (src/private-data.c)
    
     - miscellaneous functions (src/canonical-name.c, src/utils.c)
    
    This commit also removes about a dozen #include files which were
    probably not really used.
    
    This is just code motion.

commit f9ab256f0e4c1197b505b0249e66e7614644bd0b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 10 22:03:25 2012 +0000

    test-tool: Print cachedir and tmpdir.
    
    This fixes commit 1efed122c07792f4c66a4083159cfacfb1893212.

commit 2c9e532566f58d8aca362fdc150bd88d291c396d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 10 14:03:57 2012 +0000

    Update release notes.

commit 17090bd09f25c490bce9a5159d54bcabb7a8ecc2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 10 11:25:26 2012 +0000

    Version 1.19.58.

commit fcf8032cbda2d09c21f31141df8ccc193e13263b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 10 08:55:38 2012 +0000

    lib: Fix memory leak in tmpdir/cachedir code (found by valgrind).
    
    This fixes commit 1efed122c07792f4c66a4083159cfacfb1893212.

commit 99377e27486a8704c5b5171cf1ce83e2b6702c1e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 9 22:38:41 2012 +0000

    tests: Remove double-test for availability.
    
    If you have a function which is in the X optgroup, and also has
    IfAvailable X, then two tests for the optgroup are added to the
    output.
    
    Check for this case and give an error.
    
    This also fixes existing APIs.

commit a74f1681686e534e9c1883e26278cf7e0b74da07
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 9 20:44:12 2012 +0000

    tests: More efficient use of strings in the object code.
    
    No functional change.

commit a270faefefe37752de12622bd072c32ea6042e78
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 9 20:33:24 2012 +0000

    tests: Use guestfs_{push,pop}_error_handler.
    
    Replace the custom error handler with calls to
    guestfs_{push,pop}_error_handler only where necessary.  This
    simplifies the generated code.

commit 2deb235cf4d30e715507f02b02a0391e1d0c3ee9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 9 20:26:05 2012 +0000

    tests: Cleanup code that prints each test name.
    
    This is just code motion.

commit 56c7967cadbd87ca922e02355f142f70744c1330
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 9 20:19:30 2012 +0000

    tests: Change code for printing warnings about untested functions.
    
    Just code cleanup, no functional change.

commit 04a8cffee7d93bd7fc82f7cf9ef16db75933a273
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 9 20:19:08 2012 +0000

    tests: Remove dead code in generated output.

commit 599a1930b0778fb93dcbb4bd679f9263fe650683
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 9 20:18:54 2012 +0000

    tests: Format the generated code properly.
    
    This is just whitespace changes in the output.

commit 25ff0db3b48ef31e90ea3bfe79f435272536aa95
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 9 19:50:13 2012 +0000

    fuse: Use guestfs_{push,pop}_error_handler so we can see errors in shutdown.
    
    In the fork (usual) case, we still won't see any errors since stderr
    has been redirected to /dev/null, but this way is still a little more
    correct.

commit 2d220f5da2cd25e0fda0c98b98ecb384c1fe5c47
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 9 18:03:49 2012 +0100

    tools: Modify existing tools to use guestfs_{push,pop}_error_handler.
    
    This is a shorter and more convenient way to disable errors
    temporarily across calls.

commit b460d9f32eb527bc7aad4894a5f85c4e69366104
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 9 18:47:57 2012 +0100

    lib: Modify library code to use guestfs_{push,pop}_error_handler.
    
    This is less efficient than directly manipulating g->error_cb, but
    easier to maintain.

commit a3b6751863b4e7e620dd1b75b4a8d8187d2069a5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 9 17:47:07 2012 +0100

    lib: Add new C API calls: guestfs_push_error_handler,
    guestfs_pop_error_handler.
    
    The addition of these calls makes it much simpler to temporarily
    disable or ignore errors:
    
     guestfs_push_error_handler (g, NULL, NULL);
     guestfs_mkdir (g, "/foo"); /* We don't care if this fails. */
     guestfs_pop_error_handler (g);
    
    Note these calls are used by the C API only.  They are not necessary
    in other languages, because those map errors to exceptions.
    
    The subsequent commits change existing code to use push/pop instead of
    laboriously saving and restoring the error handler.

commit 2013e005bd02f5706887c8861f10410ffd82084f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 9 18:41:31 2012 +0100

    lib: Break long line in definition of guestfs_set_error_handler.
    
    This is just a whitespace change.

commit 692701f382f8a1c51be0b798b918f2f34e401b54
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 9 18:57:29 2012 +0100

    examples: Copy-editing instructions printed by the mount-local program.

commit dedf10aaa928b16ba27f0756b3d356f65d57c648
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 9 17:15:50 2012 +0100

    header: Define LIBGUESTFS_HAVE_CREATE_FLAGS=1.
    
    This fixes commit 9466060201600db47016133d80af22eb38091a49.

commit 1586bbb9517f31ba493dc8e909d732bc6e04310e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 9 13:34:45 2012 +0000

    fish: Update documentation for environment variables.
    
    This fixes commit 1efed122c07792f4c66a4083159cfacfb1893212.

commit 1efed122c07792f4c66a4083159cfacfb1893212
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 8 11:36:35 2012 +0000

    lib: Rework temporary and cache directory code.
    New APIs: set-tmpdir, get-tmpdir, set-cachedir, get-cachedir.
    
    The current code has evolved over time and has a number of problems:
    
    (a) A single environment variable ($TMPDIR) controls the
    location of several directories.
    
    (b) It's hard for the library user to predict which directory
    libguestfs will use, unless the user simulates the same internal steps
    that libguestfs performs.
    
    This commit fixes these issues.
    
    (a) Now three environment variables control the location of all small
    temporary files, and the appliance cache:
    
      For temporary files: $LIBGUESTFS_TMPDIR or $TMPDIR or /tmp.
    
      For the appliance cache: $LIBGUESTFS_CACHEDIR or $TMPDIR or /var/tmp.
    
    The user can also set these directories explicitly through API calls
    (guestfs_set_tmpdir and guestfs_set_cachedir).
    
    (b) The user can also retrieve the actual directories that libguestfs
    will use, by calling guestfs_get_tmpdir and guestfs_get_cachedir.
    These functions are also used internally.
    
    This commit also:
    
     - reworks the internal tmpdir code
    
     - removes the internal (undocumented) guestfs_tmpdir call (replacing
       it with calls to the documented guestfs_get_tmpdir API instead)
    
     - changes the ./run script to set LIBGUESTFS_TMPDIR and
       LIBGUESTFS_CACHEDIR
    
     - adds a test
    
     - fixes a few places like libguestfs-make-fixed-appliance which
       depended on $TMPDIR

commit e8d937bd739a70394ec72482a8cb1df3b0601dcc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 8 12:49:11 2012 +0100

    lib: When parsing environment, handle LIBGUESTFS_TRACE first.
    
    So that we can trace all the later calls.

commit ebe5ca7771f78a7b0649a209b9aed6be4f5726e0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 7 20:29:59 2012 +0000

    Version 1.19.57.

commit 101fd44fc5ce3055da91a5bf8aa0d89a5d2f3a79
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 6 13:05:15 2012 +0000

    format: Allow virt-format test to be skipped by setting SKIP_TEST_VIRT_FORMAT_SH=1.

commit 3b06bee2fbba75dfdd0cdf2a705f8761bed08ca0
Author: John Eckersberg <jeckersb@redhat.com>
Date:   Mon Nov 5 10:16:36 2012 -0500

    lib: debian support for package arch inspection

commit 6ac943fbef4fa8386da456048f856a387f941fc2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 3 10:10:12 2012 +0000

    tests: wipefs: Don't try to wipe mounted filesystem.
    
    Previously wipefs (the utility) allowed this, but it's obviously a bad
    thing to do and the new wipefs gives an error if you try it:
    
    wipefs: error: /dev/VG/LV: probing initialization failed: Device or resource busy

commit 4bd61ed32213e1f243d6df9ff17edd85dc5e5eb1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 2 22:14:49 2012 +0000

    fish: Fix documentation quit | exit -> separate exit & quit headings.

commit 4f6060b9d9058cee60d5c732706b64366b473fae
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 2 22:13:22 2012 +0000

    fish: Clean up prompt documentation.

commit 46449f6894cddf2bc954ac91c489f72238ce9a84
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 2 22:05:29 2012 +0000

    fish: Use Unicode LOWER ONE QUARTER BLOCK to represent cursor.
    
    'ls' (with no argument) is not a valid command.
    
    This fixes commit bad5c7d5a50e7f340d3a5daff59d7f3c18c0ab8f.

commit 6c539fa0a6fe88cd7184b01259219b5eb5330cfd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 2 14:45:11 2012 +0000

    Version 1.19.56.

commit 9a1a0c67ac6cb4e13d361c116e5e70dfc22d9c17
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 2 12:08:38 2012 +0000

    generator: Split up huge src/actions.c into separate files.
    
    Split the functions according to a simple hash across
    C.nr_actions_files files (this number can be increased later if
    necessary).
    
    This is just code motion.

commit 58720cc968366894366a430842b4bc5151b5f7fd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 2 11:59:25 2012 +0000

    generator: actions: Move variant functions to a separate file.
    
    This is just code motion.

commit 6f34b81321ad61adb2c22655ec68c57febbbe80b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 2 10:38:48 2012 +0000

    generator: actions: Move 3 helper functions to a separate file.
    
    This is just code motion.

commit f56bc8edd5f23c23298bf3f609a98dd6fec5d512
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 2 09:32:52 2012 +0000

    New API: mklost_and_found

commit 4cfc277674f50ed9eff63e2010d3241172e7a30e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 2 09:12:32 2012 +0000

    todo: General updates.

commit f39478424f05110525eb3126185eae5346b0b746
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 2 09:03:27 2012 +0000

    ROADMAP: Remove some completed items.

commit 226457de3d56d810ff08687e3b16996be5f223b0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 1 19:31:17 2012 +0000

    sysprep: Don't fail when trying to remove /var/spool/at/spool (directory).
    
    This fixes commit 1949016e899b2737525fdc9b6dda451ad9ecbd66.

commit dd9bbeb060b55f17f4e2a006601e1ac73bbdb9d9
Author: John Eckersberg <jeckersb@redhat.com>
Date:   Thu Nov 1 13:35:16 2012 -0400

    inspect: Use new inspect_list_applications2 API call
    
    RWMJ:
     - Update virt-inspector.rng.

commit bafd8229149ccc0e05676e031bae5d1489fa74a6
Author: John Eckersberg <jeckersb@redhat.com>
Date:   Thu Nov 1 13:35:15 2012 -0400

    lib: Add inspect_list_applications2 method (RHBZ#859949)
    
    RWMJ:
    - Fix memory leak in guestfs__inspect_list_applications wrapper.
    - Don't document app2_spare* fields.

commit 4c285dd8f6a263ed62802af2c89c4cc75497c1ce
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Thu Nov 1 00:14:52 2012 +0100

    message catalogs don't need to be executable

commit 6871400223e928af3f058edf24e8c974c777689d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 30 14:35:25 2012 +0000

    Version 1.19.55.

commit de129a136355a92aa6a4afe47678aa13160fc806
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 30 13:19:53 2012 +0000

    build: Source 'localenv' in top-level Makefile.
    
    Also document 'local*' files.

commit f5194e6b0a470d6fe05eaa39b57eb9d0770bbe38
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 30 12:56:06 2012 +0000

    tests: Allow more tests to be skipped.
    
    Specifically tests which involve btrfs, because btrfs is
    currently broken upstream (RHBZ#863978).

commit eb185eef2998e7eed1dce6b82e3b4836a3db3ab2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 30 11:23:58 2012 +0000

    generator: Use an OCaml struct to store the structs.
    
    This just makes it simpler to add extra fields to each struct.
    
    This is code motion.

commit 72e19deee75317368a211234950fad11b8d381f1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 30 10:21:47 2012 +0000

    lib: Force visibility default on public actions.
    
    This is currently done implicitly because of the linker script.
    However in order to do symbol versioning, we will have to do
    this explicitly at each definition instead.

commit 8c66ba455d196225767b45706af6702c18cd180c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 30 10:31:17 2012 +0000

    generator: Move struct-freeing functions to a separate source file.
    
    This is just code motion.

commit ccf5c6ae564b30592157219fc048e29c374085ba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 30 08:31:38 2012 +0000

    sysprep: Move a comment.
    
    No change.

commit f491f3a95804a4b34d7c70c6d05aa945e59b3c8e
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Tue Oct 30 15:50:54 2012 +0800

    sysprep: remove man pages cache
    
    Remove the cache files generated by man-db.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 3884bc7d7a3545831f1e3ce8bde1ae5f64776bc4
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Tue Oct 30 15:50:53 2012 +0800

    sysprep: remove fontconfig cache
    
    Remove the cache files generated by fontconfig.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 63a091e21dbb509923eaeeb310707447385c566c
Author: John Eckersberg <jeckersb@redhat.com>
Date:   Mon Oct 29 16:22:00 2012 -0400

    lib: update inspect_list_applications to return all installed RPMs (RHBZ#859885).
    
    Note that because of RHBZ#859949, this will return two identical
    entries for RPMs which differ only by arch.

commit 269460770d9d472e882da7ec80a1e3a1ba4f8c3a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 29 15:40:33 2012 +0000

    build: Remove 'make bindist' rule.
    
    We've not distributed binaries for quite a long time, and possibly
    this is not advisable.

commit e6f8a589ee75764bda21e9045156b2ffa4567fec
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 29 15:13:15 2012 +0000

    Version 1.19.54.

commit dd09744432468c416033ca84dc0ae1a438240de0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 29 15:12:54 2012 +0000

    guestfs-testing: Use L<> around links.

commit bad5c7d5a50e7f340d3a5daff59d7f3c18c0ab8f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 29 12:49:21 2012 +0000

    fish: Add GUESTFISH_PS1 environment variable to control prompt.

commit 9de4dfddc7acf0d6c9d3a32f5d923ffa650cbce1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 27 16:19:53 2012 +0100

    fish: Make progress bars slightly lighter.

commit 3c1d85ae95452cee30029c719aa2523fdb5384c7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 25 21:58:20 2012 +0100

    docs: Review and clarify ERROR HANDLING section of guestfs(3).

commit 7271c9146d57299e4c71b23aaeac5ccef4a84d39
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 25 16:16:17 2012 +0100

    launch: libvirt: Disable CPU host-model.
    
    See the comment in the change.
    
    This "fixes" commit f7a67914c03db6d4c75671793964954640af7892.

commit 835ae2c43ca70a90e33262bb71da1883ab6a4473
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 25 14:23:00 2012 +0100

    gitignore: Ignore config.cache file.

commit f7a67914c03db6d4c75671793964954640af7892
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 25 14:11:01 2012 +0100

    launch: libvirt: Fix <cpu> element.
    
    Use <cpu mode="host-model"> (not model=... which was a typo).
    
    Also set fallback=allow so that libvirt knows it can use another
    CPU model if it wants.
    
    This fixes commit 890a4fbc8740b9b2019885a866aa06bc82566a41.

commit 5c8f073786285303f3bda1c30bd0b1953e0667a7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 25 14:10:43 2012 +0100

    daemon: Mark some functions as attribute((noreturn)).

commit 91c07d2a06fd4ec33db8d7737bfd73f61aa645fc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 24 11:14:56 2012 +0100

    fish: Fix test-events.sh because of new debug message.
    
    Commit 2e90f4312928f332f8997b52be3fe54f20920242 added a debug message
    which isn't filtered out by the set of grep -v's in this test.
    Therefore this test would fail when run with LIBGUESTFS_DEBUG=1.

commit a66fd2fac25d5520b4eb2935dea6a501daed946a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 22 12:18:40 2012 +0100

    resize: Depend explicitly on Unix module.
    
    Commit a0722c7ad846960be54978a31ebe73b76e119203 introduced a
    dependency on the Unix module.  This was not listed in the list of
    '-package's, but as long as you had ocaml-gettext installed it would
    still work because that pulled in Unix implicitly.
    
    Thanks Olaf Hering.

commit 6e63636869b9ea7559a28810437e7fdc43ab6a17
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 19 11:08:08 2012 +0100

    Version 1.19.53.

commit 0e0bea70dd166143670b5d01375fbfe2aebaf23e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 18 13:33:12 2012 +0100

    filearch: Use command mini-library to run external cpio command.

commit af5ec9381ea3b4e54aa7ef3a50d474d827f7ef19
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 18 22:08:52 2012 +0100

    fuse: Use command mini-library to run the fusermount command.

commit 95b83ef9d4cb42688202832ba150d90e61cf435d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 18 20:02:19 2012 +0100

    info: Use command mini-library to run 'qemu-img info' commands.

commit a3598aa257f6f08e8067621ccdbc68c0270e02f9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 18 21:51:20 2012 +0100

    inspect: Use command mini-library to parse the output of db_dump command.

commit 019b840e4758ccd254925181f6fbaf3192c7bde1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 18 10:55:42 2012 +0100

    inspect: Change icon code to use command mini-lib instead of system(3).

commit 7917e55ddb001d284c769faa65fc30c09e703f6b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 18 20:15:31 2012 +0100

    launch: libvirt: Use command mini-library to run qemu-img create command.

commit a0ead23016991717a62b6c136a2683abbd14c151
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 18 18:38:29 2012 +0100

    launch: appliance: Use command mini-library to parse output of qemu -help etc.

commit 8d4f3f85f2bdf38a2868ea785cf66efa65af25f3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 18 15:07:18 2012 +0100

    appliance: Use command mini-library to run febootstrap-supermin-helper (RHBZ#713678)

commit fa209341f834d1ab00e0d9fa767c8221506285e4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 18 14:20:54 2012 +0100

    lib: Change guestfs___remove_tmpdir function to use command mini-library.

commit 2e90f4312928f332f8997b52be3fe54f20920242
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 17 14:31:33 2012 +0100

    lib: Add a new 'command' mini-library for running external commands.
    
    This is a wrapper or mini-library for running external command,
    loosely based on libvirt's virCommand interface.
    
    Amongst the advantages are:
    
     - Can redirect errors into the error log (RHBZ#713678).
     - Can redirect output into a callback function.
     - Handles shell quoting properly.
     - Safely resets signal handlers, closes file descriptors, etc.
     - Single place where we can implement other improvements in future.

commit 2dab72794eef55f941cc61f1f34baa9fc7988298
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 18 17:35:30 2012 +0100

    valgrind: Add suppression for memory leak in libdl:_dl_init function.

commit 773fa611411d457d4b18dcb171b333b7356c20ba
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Sun Oct 14 14:32:36 2012 +0800

    NEW API: mktemp
    
    Used to create temporary directory or file with an optional suffix.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>
    
    RWMJ:
    
     - Split this out into a new file (daemon/mktemp.c).
    
     - I don't see a reason to deprecate the mkdtemp function which
       works fine.  Instead remove complex dir-making code from the
       new function.
    
     - Test and fix the patch (missing close(fd)).

commit 67e483689c086e22e9a3e038ea4e7285d9a0c4d2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 17 10:31:24 2012 +0100

    configure: Add db5.1_dump, db5.1_load for Debian Wheezy.

commit 978d16ec763b6c4c8277ff06fc725c0d98b7cfe0
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Wed Oct 17 15:48:14 2012 +0800

    TODO: remove the already implemented yum cache clean feature
    
    The cleanup of package managers cache is already implemented
    by sprep_operation_package_manager_cache.ml, so remove this
    TODO item.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 25ec619a462548c29fc706e7bb98094b43d94c13
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 16 09:12:18 2012 +0100

    todo: Implement Ruby blocking calls.

commit 99bd15ad0e900ce16fe16d2a58b4d6f8ba38a0fe
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 15 21:35:13 2012 +0100

    generator: Add 'blocking' flag to marking blocking (long-running) functions.
    
    In languages like Python where we release a global lock around
    long-running libguestfs functions, it is also useful to *not* release
    this lock for small, non-blocking functions.
    
    Therefore mark all functions with a 'blocking' boolean flag.  It
    defaults to true, and is true by definition for all daemon functions.
    For non-daemon functions, I have classified them manually.
    
    Only when the blocking flag is set do we generate the code to release
    and reacquire the lock around libguestfs calls.

commit 3d46f7dc038f87e00a27e9f294d4115436f1ff23
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 15 22:38:16 2012 +0100

    ocaml: Get rid of CAMLprim.
    
    It's wrong to use it, and in any case it doesn't do anything on Linux.

commit 8a89c728218ecb1c2226d28f9592604b9c2d96ca
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 15 18:02:06 2012 +0100

    Update release notes.

commit c164cc9bea89aa627dad4338469c26a1a70b61f5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 15 16:35:13 2012 +0100

    lib: Add a test for environment parsing functions.
    
    This updates commit 9466060201600db47016133d80af22eb38091a49.

commit ec1d2398722fbebd6dd3daa205d0dd3ca653fe8d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 15 16:34:23 2012 +0100

    lib: Fix guestfs_create_flags example program in man page.
    
    This fixes commit 9466060201600db47016133d80af22eb38091a49.

commit a0722c7ad846960be54978a31ebe73b76e119203
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 15 15:51:55 2012 +0100

    resize, sparsify: Suppress progress bar when output is not a tty.

commit c9acb029edf7c20ca937a1f6051b5834cdfdddf7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 15 15:51:21 2012 +0100

    sparsify: Fix dependencies so they include resize/progress.*
    
    This fixes commit 91b2238fc8e462c02f697f0c053043a55f43c13d.

commit 471f4e64d3363e25483bba36eab41d41b3eb0206
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 15 15:43:46 2012 +0100

    libvirt: auth: Some clarifications of the API from Dan Berrange.
    
    This updates commit d83d17e9dbfb24496a0841fc2aed436181ca0341.

commit 9466060201600db47016133d80af22eb38091a49
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 15 11:14:59 2012 +0100

    New APIs: guestfs_create_flags, guestfs_parse_environment,
    guestfs_parse_environment_list.
    
    Add a new function for creating a handle:
    
     guestfs_h *guestfs_create_flags (unsigned flags [, ...]);
    
    This variant lets you supply flags and extra arguments, although extra
    arguments are not used at the moment.
    
    Of particular interest is the ability to separate the creation of the
    handle from the parsing of environment variables like
    LIBGUESTFS_DEBUG.  guestfs_create does both together, which prevents
    us from propagating errors from parsing environment variables back to
    the caller (guestfs_create has always printed any errors on stderr and
    then just ignored them).
    
    If you are interested in these errors, you can now write:
    
     g = guestfs_create_flags (GUESTFS_CREATE_NO_ENVIRONMENT);
     if (!g)
       exit (EXIT_FAILURE);
     r = guestfs_parse_environment (g);
     if (!r)
       exit (EXIT_FAILURE);
    
    Also you can *omit* the call to guestfs_parse_environment, which
    creates a handle unaffected by the environment (which was not possible
    before).
    
    This commit also includes new (backwards compatible) changes to the
    OCaml, Perl, Python, Ruby and Java constructors that let you use the
    flags.

commit 389cb608df19b80323214eefad464a7ebfb7f235
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 15 14:51:32 2012 +0100

    ruby: Add RUBYLIB to run script.

commit f65c9bfcf279fd29f927d02159e1f51e6b2db3ae
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Oct 14 13:23:30 2012 +0100

    Version 1.19.52.

commit 1c1630bb23ab0119fd47c167355ba7002635b1c3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Oct 14 13:28:31 2012 +0100

    Update PO files from Transifex.
    
    Also run 'make update-po'.

commit c36456cf0330f134553ffeefff8f3deafc2522fb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Oct 14 13:22:34 2012 +0100

    Update API support.

commit 626ca8e74f97a8c5fbe354211e81132976a21435
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Oct 14 12:54:02 2012 +0100

    valgrind: Fix FUSE memory leak suppression.

commit d83d17e9dbfb24496a0841fc2aed436181ca0341
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 13 12:57:12 2012 +0100

    New APIs: Model libvirt authentication events through the API.
    
    This commit models libvirt authentication events through the API,
    adding one new event (GUESTFS_EVENT_LIBVIRT_AUTH) and several new
    APIs:
    
      guestfs_set_libvirt_supported_credentials
      guestfs_get_libvirt_requested_credentials
      guestfs_get_libvirt_requested_credential_prompt
      guestfs_get_libvirt_requested_credential_challenge
      guestfs_get_libvirt_requested_credential_defresult
      guestfs_set_libvirt_requested_credential
    
    See the documentation and example which shows how to use the new API.
    
    This commit also changes existing calls to virConnectOpen* within the
    library so that the new API is used.
    
    Also included is an example (but not a test, because it's hard to see
    how to automatically test the libvirt API).

commit 07d0546f5d210d1cee048de8d42bdf58302f0d93
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 13 20:52:31 2012 +0100

    configure: Add --without-libvirt option.
    
    Normally we check if libvirt is installed, and the default is still to
    do this.
    
    However having this option makes it simpler to check if a change to
    the code has broken the case where libvirt is not installed.
    
    In fact, this change revealed one such place, which is also fixed in
    this commit.

commit 085bf7c97aae67e8f84fe95f97ee4bfee849d523
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 13 09:29:38 2012 +0100

    docs: Make 'EVENTS' into its own =head1 section.
    
    For some reason it was stuck under "CALLS WITH OPTIONAL ARGUMENTS",
    which made no sense.

commit 96a76c79e40a5d6853c660fc2a980d084b0eaafd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 13 14:20:31 2012 +0100

    launch: libvirt: Make handle data conditional on HAVE_LIBVIRT.
    
    This means that we can use virConnectPtr and virDomainPtr instead of
    using void* types.  In the case where libvirt support is disabled or
    not present, effectively nothing changes.

commit 325d67c615f19da1b679e4d673636cf6d91a4c41
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 13 14:06:46 2012 +0100

    lib: Rename src/libvirtdomain.c -> src/libvirt-domain.c.
    
    No change, just code motion.

commit 64e8e0011c6e961bae010b6008d07f501d53f35d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 13 15:34:01 2012 +0100

    lib: Pointer arg to safe_memdup function should be const.

commit bdfe2216715ff15691ab719ee0e63ccc2e84526c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 12 20:45:19 2012 +0100

    configure: Fix capitalization in configure script.
    
    Just make the output of ./configure --help and the <config.h>
    file consistent.

commit 467fb589b969b2d5a6fbb72c327c6c57cb65fcc3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 12 20:44:56 2012 +0100

    configure: Fix C++ compiler test so it doesn't print random junk.

commit e6e999eac2e58d6126d83d51cd820966912b0c6b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 11 17:12:51 2012 +0100

    Version 1.19.51.

commit 15b9ed3ed2078c034f25bf3ba31298dd89c6cddf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 11 17:12:21 2012 +0100

    daemon: Call udev-settle at the start of the daemon.

commit 67e9572286f98b830bef64cfcae5a072bf3a1882
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 11 15:50:41 2012 +0100

    launch: libvirt: Always set <qemu:env> TMPDIR.
    
    If TMPDIR is not set, we must choose one, because otherwise libvirt
    will use a random TMPDIR: http://bugzilla.redhat.com/865464
    
    The convenient guestfs___persistent_tmpdir function does everything
    needed in this case.

commit 911a16a9fa965ce8defb3307f6bf338f5d2d5c94
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 11 13:51:19 2012 +0000

    fish: progress bar: Send interactive progress bar output to /dev/tty (RHBZ#859875).

commit 91b2238fc8e462c02f697f0c053043a55f43c13d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 11 13:23:24 2012 +0000

    sparsify: Re-use progress bar wrapper code from virt-resize.
    
    The code was identical -- just copied with s/resize/sparsify/.
    Instead of duplicating identical code, cause the Makefile.am to use
    the code from the ../resize/ directory.
    
    Unfortunately because there are two Utils modules (which are
    different), this means we had to rename those modules to Resize_utils
    and Sparsify_utils respectively.  So this is a rather larger change
    than intended.  However it's just code motion.

commit f4a2aecd5ff4904994d75ad92b50a834d40eef17
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 11 13:18:46 2012 +0000

    fish: inspect: Canonicalize paths for printing (RHBZ#859876).

commit c34dcf184ef4eaa35634d1696e0c68d21b811170
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 11 13:12:26 2012 +0000

    fish: inspect: Move variable decls to top of function.
    
    This is just code motion.

commit 77ce157db8bd1e784bf73850b65cfcf60fb5ca66
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 10 21:22:43 2012 +0000

    Version 1.19.50.

commit 316c2a6fc7ac38867e96a4d0d626a7f2dc61ee14
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 10 21:11:17 2012 +0000

    docs: Fix documentation about hotplugging.

commit 2e388e8a3740aa470276b78027f51304a7f0ff92
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 10 21:05:52 2012 +0000

    launch: Add warning not to avoid calling launch twice on the same handle.
    
    For more information on this topic, see:
    https://www.redhat.com/archives/libguestfs/2012-October/msg00045.html

commit 7376811983060f94552d90576aed61955102c68d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 10 13:51:54 2012 +0100

    Revert "btrfs: Add a workaround for btrfs failures seen with kernel 3.7.0."
    Revert "btrfs: Add an extended workaround for btrfs failures seen with kernel 3.7.0."
    
    Reverted these workaround, since we may have found a fix for the btrfs
    bug itself (for details see RHBZ#863978).
    
    This reverts commit d9e5b514aa4ef6d659b267e8caef4ebec8a221b1
    and commit a03f536f0dae3ca20e11b7c2ba41e4a7eb1f28c9.

commit 33f49d85c2a82e66f33cedccb2dbd14faa6070dd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 10 16:38:53 2012 +0000

    tests: Fix test-qemudie-* so they re-adds the disk on second launch.
    
    Commit ed7fda161e1f3d0beb02a368fcbcf5ed95dcdac1 changed the
    way that the drives are handled across appliance shutdowns.
    
    Previously during the following sequence of calls:
    
      create the handle
      add drive(s)
      launch
      kill subprocess
      launch
    
    the added drives are still in the handle at the second launch.
    
    After the above commit, the added drives are removed from the handle,
    which means the second launch happens with no drives (which could be
    an error).
    
    This was never actually defined either way, so in this case fix the
    test to re-add the drive before the second launch.
    
    Since hotplugging was added, it isn't really feasible to return to the
    original semantics, since users might remove drives, in which case we
    have lost information about those drives so we cannot restore them on
    the second launch.
    
    NOTE: PLEASE CALLERS DON'T DO THIS!  Always use a new handle for each
    launch of the appliance.

commit a03f536f0dae3ca20e11b7c2ba41e4a7eb1f28c9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 10 11:15:39 2012 +0100

    btrfs: Add an extended workaround for btrfs failures seen with kernel 3.7.0.
    
    See:
    https://bugzilla.redhat.com/show_bug.cgi?id=863978
    and:
    http://thread.gmane.org/gmane.comp.file-systems.btrfs/20257
    
    This extends the fix in commit d9e5b514aa4ef6d659b267e8caef4ebec8a221b1
    because I missed the case where mkfs.btrfs is called directly.

commit 0032c60336c6f819859d30ec68179373e8943ef6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 9 21:58:21 2012 +0100

    docs: Fully document all subdirectories of the source.

commit b54fa22cd0a6a091324ff1978e0de2c54a0fabde
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 9 21:57:54 2012 +0100

    docs: Add overview to guestfs(3)/EXTENDING LIBGUESTFS.

commit e10647e3349db040cbb9b0956155e12447eefb72
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 9 12:06:03 2012 +0100

    appliance: Add 99-guestfs-serial.rules to EXTRA_DIST.
    
    This fixes commit 7786d56db8c22413949f98ef6b15fe0ea367d195.

commit e4bca563b46286c70dddac5bf9a174039715414d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 9 11:21:17 2012 +0100

    Version 1.19.49.

commit d9e5b514aa4ef6d659b267e8caef4ebec8a221b1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 8 22:25:43 2012 +0100

    btrfs: Add a workaround for btrfs failures seen with kernel 3.7.0.
    
    See:
    https://bugzilla.redhat.com/show_bug.cgi?id=863978
    and:
    http://thread.gmane.org/gmane.comp.file-systems.btrfs/20257

commit 45c9fbd6f50eeed9307892e883b25b8b3b263b3a
Author: Olaf Hering <olaf@aepfle.de>
Date:   Mon Oct 8 20:10:36 2012 +0200

    launch: appliance is optional
    
     # virt-filesystems -v -d 6326ad4e-5805-2ab4-1338-d1dad8c76162 --all
    libguestfs: libvirt version = 10002
    libguestfs: [00000ms] connect to libvirt
    libguestfs: [00001ms] get libvirt capabilities
    libguestfs: [00234ms] build appliance
    libguestfs: [00234ms] create libvirt XML
    libguestfs: error: error constructing libvirt XML at "xmlTextWriterWriteAttribute (xo, BAD_CAST "file", BAD_CAST appliance)": No such file or directory
    libguestfs: closing guestfs handle 0x656270 (state 0)
    
     # ls -lh /usr/lib64/guestfs/*
    -rw-r--r-- 1 root root  13M Oct  8 16:15 /usr/lib64/guestfs/initramfs.x86_64.img
    -rw-r--r-- 1 root root 3.7M Oct  6 09:25 /usr/lib64/guestfs/vmlinuz.x86_64
    
    Signed-off-by: Olaf Hering <olaf@aepfle.de>

commit 0a85fbc946d7838366c35c0425efddb1a91f593c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 8 17:26:53 2012 +0100

    Add support for hotplugging (removing disks).
    New API: remove-drive.
    
    Note because of a bug in fuser, this only works with psmisc >= 22.20.
    
    This also updates the hotplugging tests.

commit 18b7f09f366d518050f467d0944c81c82fd5e39e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 5 14:56:35 2012 +0100

    Add support for hotplugging (adding disks) to the libvirt attach-method.
    
    When libvirt is used, we can allow disks to be hotplugged.
    guestfs_add_drive can be called after launch to hot-add a disk.
    
    When a disk is hot-added, we first ask libvirt to add the disk to the
    appliance, then we make an internal call into the appliance to get it
    to wait for the disk to appear (ie. udev_settle ()).
    
    Hot-added disks are tracked in the g->drives array.
    
    This also adds a test.

commit 7786d56db8c22413949f98ef6b15fe0ea367d195
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 3 10:50:51 2012 +0100

    launch: Add add_drive 'label' option.
    New API: list-disk-labels
    
    Allow the user to pass an optional disk label when adding a drive.
    
    This is passed through to qemu / libvirt using the disk serial field,
    and from there to the appliance which exposes it through udev,
    creating a special alias of the device /dev/disk/guestfs/<label>.
    Partitions are named /dev/disk/guestfs/<label><partnum>.
    
    virtio-blk and virtio-scsi limit the serial field to 20 bytes.  We
    further limit the name to maximum 20 ASCII characters in [a-zA-Z].
    
    list-devices and list-partitions are not changed: these calls still
    return raw block device names.  However a new call, list-disk-labels,
    returns a hash table allowing callers to map between disk labels, and
    block device and partition names.
    
    This commit also includes a test.

commit 3ad44c866042919374e2d840502e53da2ed8aef0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 6 19:27:14 2012 +0100

    launch: libvirt: Create qcow2 overlays for read-only drives and the appliance.
    
    Instead of adding the snapshot=on option via <qemu:arg>, create qcow2
    overlays for any read-only drives and the appliance using 'qemu-img
    create' + a temporary file.
    
    This is a workaround for missing support for <transient/> in libvirt's
    qemu driver.  Also for the unpredictable way that libvirtd handles
    $TMPDIR: we want to control where the temporary disk is created.
    
    Currently it is also much slower, because qemu-img is slow.  However
    we hope to fix qemu upstream.

commit ed7fda161e1f3d0beb02a368fcbcf5ed95dcdac1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 8 14:35:32 2012 +0100

    launch: Make g->drives into an array (was a linked list).
    
    Using an array simplifies the implementation of hotplugging.

commit 8354dc46fdcb2984d809d2864f97691167f04f50
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Oct 7 11:58:36 2012 +0100

    Version 1.19.48.
    
    We need to regenerate the tarball because the previous one
    had the guestfsd man page missing.  Hence bumped version
    number.

commit 62e56876c870c470856d98f01cecb1110e5684eb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Oct 7 11:55:01 2012 +0100

    daemon: Add guestfsd.pod to EXTRA_DIST.
    
    This fixes commit df2469a48f4641bdfe26a4179dd946df190fa970.

commit 63eae6fa6f44f1056cb6cf90d0d6e6f42282a967
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 6 23:35:14 2012 +0100

    Version 1.19.47.

commit 9f24ac2db0ebba436d483e3e0073813f150fb783
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 6 18:48:10 2012 +0100

    launch: Add private data pointer to the struct drive.
    
    This can be used by the attach-method, eg. for libvirt-only data.

commit 6867b0a3fb6491e1d26c747100dad364dbf20c70
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 6 18:44:05 2012 +0100

    launch: add_null_drive: Force null drive to be writable.
    
    Because we create a special file, there is no point forcing qemu
    to create an overlay as well.  Save time by setting readonly = 0.

commit 328510121ad720680b71b65b9b2a60e816ca49f8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 5 15:13:16 2012 +0100

    launch: Rearrange code for adding drives to the g->drives list in the handle.
    
    This is just code motion.

commit 92feed7d662b7d9d1f8c475cf06df203143a3a5f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 3 11:46:07 2012 +0100

    build: Use 'tmp-d' as name of temporary directory instead of 'tmp'.
    
    When building supermin.d/daemon.img, use 'tmp-d' instead of 'tmp'
    as the name of the temporary directory.
    
    This is just code motion.

commit 1467ea00b850bec2722671a400adb2ffda533365
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 5 11:03:03 2012 +0100

    docs: add_drive: Clean up documentation of the 'filename' parameter.
    
    Also, remove duplicate documentation of using '/dev/null' as the
    filename.

commit 013fb91a6974dfcb493fb9ccffb23329788f4976
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 6 21:34:12 2012 +0100

    tests: Fix rhbz690819.sh to skip when attach-method is libvirt.
    
    This sets the iface parameter (implicitly), which is not supported yet
    by the libvirt backend.
    
    This updates commit 8e198dc1c50fcdba6720b23da478ef75cc979733.

commit 9bd3d5bc6d6a3be517da5faf9e7c8a84394ca0f9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 6 17:41:36 2012 +0100

    FAQ: Document debug* and internal* functions in the FAQ.

commit 8e198dc1c50fcdba6720b23da478ef75cc979733
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 3 10:49:20 2012 +0100

    launch: libvirt: The drive 'iface' parameter is not yet supported.
    
    We could add support, but at the moment return an error
    if the user tries to use the iface parameter.

commit 60650da1ed7b6d916ceeee0e397c7bb2fbc282e5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 3 10:30:15 2012 +0100

    docs: Minor cleanup of documentation for add_drive 'name' parameter.

commit 4a4ca0c01da3307b69fc4925c5f2ece1e728d4b3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 3 09:15:37 2012 +0100

    syntax: Use __PATTERNS__ instead of @PATTERNS@ in podwrapper man pages.
    
    It is slightly dangerous to use @PATTERNS@, since these might
    be substituted by autoconf when they appear in Makefile.am files.

commit df2469a48f4641bdfe26a4179dd946df190fa970
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 3 07:47:18 2012 +0100

    docs: Add guestfsd(8) man page.

commit 378e5d672286e18789bc4331705edb45210ac27a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 1 12:57:00 2012 +0100

    Version 1.19.46.

commit 572291c64ed79b4988de6d23c31458d7c3c71b1d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 1 12:57:04 2012 +0100

    configure: Rearrange build options report in ./configure output.
    
    This had accreted over a long period of time, so it wasn't
    arranged very logically.

commit 6f53d49a27fbf7f1b5c22080e2509375e128d5e4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 28 15:00:26 2012 +0100

    daemon: When sorting devices, don't fail on mix of /dev/sd and /dev/vd
    (RHBZ#858128).
    
    If compare_device_names was given two devices with devices with
    different interfaces (eg. /dev/sda and /dev/vda) then it would try to
    compare the partition numbers, and fail when it could parse them.
    
    It's arguable what we should be doing in this case (except for
    strongly discouraging people from using the interface feature), but
    let's at least not cause the daemon to assert-fail.
    
    Found by Red Hat QA, thanks Mohua Li.

commit 9ea6e9701461e594033999150f930cc4fafec4d2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 28 10:15:13 2012 +0100

    inspection: Fix calls to case_sensitive_path (RHBZ#858126).
    
    Don't assume that if guestfs_case_sensitive_path returns NULL, that it
    means the file does not exist.
    
    The (previously undefined) behaviour of case_sensitive_path was that a
    NULL return meant "either the file doesn't exist or some other error".
    However in commit 973581780d8a006f336684fef6762801402d775d this was
    changed so that if the last element of the path didn't exist, it was
    assumed to be a new file and the (non-NULL) path of the new file is
    returned.
    
    This change breaks code (including in libguestfs) which tries to use
    case_sensitive_path as a dual-purpose call to fix-up a path for
    Windows and test if the file exists.  Such code should be rewritten so
    that it explicitly tests for file existence after calling
    case_sensitive_path.
    
    I examined all the calls to case_sensitive_path in libguestfs and
    modified them where necessary.

commit 55b7c4df7895b8c22d737723d857a9a63db69926
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 28 09:57:49 2012 +0100

    virt-edit: If case_sensitive_path returns an error, exit.
    
    The 'windows_path' function was blindly copied from virt-cat.  In
    virt-cat, errors are checked by the caller to 'windows_path'.  But
    virt-edit lacks this check.  Change the function in virt-edit to add a
    check and exit on error.

commit 6cd040fcdf662ff56be08a03eb80918ec10191ec
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 26 21:21:02 2012 +0100

    Version 1.19.45.

commit 8d63edaa9317e957d03beb9834ddac5f30349ef1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 26 21:16:14 2012 +0100

    sysprep: Typo in man page: resets -> reset.

commit 91617069b9903af303187acaf8e83bc7dece2c93
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 26 21:03:37 2012 +0100

    run: Label tmp directory.
    
    There's not really any point just documenting that people
    should label the tmp directory, when we can just label it.
    So change the ./run script so it calls chcon.
    
    However it's not a failure if chcon doesn't work.  If SELinux
    is not installed or is disabled, then labelling will fail.

commit f7e138835a7194135113088767c46df65dbf292a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 26 20:56:44 2012 +0100

    recipes: Add a section about diagnosing hanging guests.

commit 4f3048c6be0663c6c254a765ec5f83a7b40a8808
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 26 12:26:33 2012 +0100

    test-tool: Add prominent warning about including complete output.
    
    Everyone ignores the documentation.  Everyone ignores me even
    when I specifically tell them to include the complete output.
    
    Place a prominent notice at the beginning of the output.

commit ca2e65275d797864d2a5b3b3d0e115460522e5bb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 26 12:26:28 2012 +0100

    test-tool: guestfs_get_path might return NULL.
    
    It would almost certainly indicate a bug if it happens, but
    don't rely on printf not segfaulting if it did happen.

commit b44d82ec8db4146f0851fdf0ef5f5d7492f34953
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 26 12:04:02 2012 +0100

    Revert "test-launch-race: Add SELinux label to $TMPDIR."
    
    Because RHBZ#860235 has been fixed in selinux-policy 3.11.1-25.fc18.
    
    This reverts commit 7fc838cca334ccf3d388c5598ff7fae88dbe4513.

commit 9b7813c5bd91d53e358deee64ab42b00b42c37ba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 26 12:03:16 2012 +0100

    guestfs-testing(1): Start by running libguestfs-test-tool.

commit f7f746a98e8d378ac8934a7f7b82a48b3e2a5aa4
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Wed Sep 26 17:20:27 2012 +0800

    remove the useless "h" option
    
    "h" option is not enabled in virt-cat, remove it.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 19b29c36370beb76fd3f3a1f45289ce34c03e3c3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 25 19:00:50 2012 +0100

    FAQ: Miscellaneous cleanups.
    
    - Use S<...> for non-breaking spaces.
    - Arrange the builds section better.
    - Add a section on enabling sVirt.
    - Other small fixes.

commit d19e557df54f3822d38621b8c2da098bf44b4d53
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 25 18:30:36 2012 +0100

    docs: Link to guestfs-recipes(1) from intro in guestfs(3).

commit a8056050c0f303f66ba2beed3bbe1ade8fca79cf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 25 14:26:38 2012 +0100

    gobject: No need to remove old API files.
    
    In commit 3d84ca76fec491015030daa53e9122b03032ddfd we changed the
    generator so it now automatically removes old API files.

commit 7fc838cca334ccf3d388c5598ff7fae88dbe4513
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 25 12:15:19 2012 +0100

    test-launch-race: Add SELinux label to $TMPDIR.
    
    This is a temporary workaround for
    https://bugzilla.redhat.com/show_bug.cgi?id=860235
    which can be removed once this bug is fixed.

commit b3bf53714b4e783fb7c7565a6be050dece0d3d1a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 24 21:25:31 2012 +0100

    libvirt >= 0.10.2 required for libvirt backend.

commit c9cccb776e0f15d6a28120fe5dbaed3ef6a70486
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 24 17:00:03 2012 +0100

    Version 1.19.44.

commit 45d459f4023a581712c4441acb440c821342bdf6
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Mon Sep 24 16:49:21 2012 +0800

    Fix tests/bigdirs/test-big-dirs.pl to use mke2fs
    
    Let tests/bigdirs/test-big-dirs.pl uses mke2fs to create small
    inode ratio files.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>
    
    RWMJ:
     - Fix invocation of mke2fs with optional arguments.
     - Run the test to check it works.

commit 0c2aab966a9ecde8a23044877cb3123cd238100a
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Mon Sep 24 16:32:51 2012 +0800

    NEW API:ext:mke2fs
    
    New api mke2fs for full configuration of filesystem.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>
    
    RWMJ:
     - Update description.
     - Run and fix the tests.
     - Remove bogus filename from po/POTFILES.

commit a297a9348f2a22dcf057de2ef00389b7d36b0d15
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 24 16:39:41 2012 +0100

    tests/bigdirs: Add empty TESTS= rule.
    
    Without this empty rule, automake doesn't generate the rest of the
    testing infrastructure, so you can't enable the test yourself by doing
    'make check TESTS=test-big-dirs.pl'.

commit 790c1a0c7b141e3e4f37c3f670c19e039873dcbe
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 24 09:45:33 2012 +0100

    generator: xdr: Re-code procedure table.
    
    This is just code motion.

commit db6a8512402f068815f882928662af0d8f5eec83
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 24 09:26:10 2012 +0100

    generator: Tidy up comments in guestfs_protocol.x.

commit a95d4261b8cedc31bfc3c5358be7b346b27d457b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 24 09:24:33 2012 +0100

    generator: Allow an optional emacs-mode at the top of generated files.

commit a3d7f5bc17aa3935a427812a49de60ecc0a345ca
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 24 09:26:45 2012 +0100

    generator: The default input files are 'generator/ *.ml' [sic].
    
    Since generator source files were renamed, the comment at the
    top of each generated file was wrong.
    
    Unfortunately we cannot allow /* to appear within a comment,
    so the space is necessary.

commit 1949016e899b2737525fdc9b6dda451ad9ecbd66
Author: Olaf Hering <olaf@aepfle.de>
Date:   Fri Sep 21 21:04:43 2012 +0200

    sysprep: handle at jobs in cron-spool operation
    
    cron-spool claims to remove at jobs, but it has no code to actually do
    that. Add patterns to remove files in known at spool locations.
    
    Signed-off-by: Olaf Hering <olaf@aepfle.de>

commit 55fef0e4e607b1d447a0a0804acd69481f7613e4
Author: Olaf Hering <olaf@aepfle.de>
Date:   Fri Sep 21 20:00:34 2012 +0200

    sysprep: handle distro specific sysv scripts
    
    Currently firstboot would only work on redhat-based images.
    Handle redhat-based, suse-based and debian guests, error out in case of an
    unknown distro.
    Update firstboot.sh:
     - make sure scripts exists and can be executed
     - add LSB header to avoid insserv warnings later on
     - run script only if called with "start"
    Update functions, pass only required options.
    
    Signed-off-by: Olaf Hering <olaf@aepfle.de>

commit 09c372ea250e8241d62e9fde70eabe7bdca83050
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 22 10:47:11 2012 +0100

    test-launch-race: Add comment.

commit ab0610d7528a4816166e6d2840f8b675c14b2d09
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 21 16:31:05 2012 +0100

    Version 1.19.43.

commit 0e7d3de002de79b3d36e473149cfe9b54ad1b4c3
Author: Olaf Hering <olaf@aepfle.de>
Date:   Fri Sep 21 14:09:10 2012 +0100

    sysprep: handle suse-based in hostname operation
    
    Signed-off-by: Olaf Hering <olaf@aepfle.de>

commit 1b364d74a8d42c956abdf4c5dbbc56cf1e250033
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 21 12:42:53 2012 +0100

    launch: Handle guestfs_config qemu_value == NULL.
    
    The second parameter to 'config' may be NULL.
    
    In commit 52fa23d74f6308daf804c2330b0b27e0b4412594 (refactoring of
    guestfs_config) the code this got lost, and guestfs_config would
    segfault if qemu_value was NULL.
    
    Also this fixes the libvirt method to handle the same case.
    
    I checked libguestfs-1.18 and -1.16 branches, and this problem does
    NOT affect them.

commit 763ec36cf0c6ffa6d359b65ff7f1ee9ab1c7361e
Author: Olaf Hering <olaf@aepfle.de>
Date:   Fri Sep 21 11:00:01 2012 +0200

    Update SuSE Linux detection.
    
    Update SuSE Linux detection. Up to now everything with a
    /etc/SuSE-release file was treated as openSuSE. With this change SLES
    based distributions such as "SUSE Linux Enterprise Server", "SUSE
    Linux Enterprise Desktop" and "Novell Linux Desktop" will show up as
    "sles". The 'opensuse' detection was updated to handle older openSuSE
    releases as well as the well known SuSE Linux releases, starting from
    6.0. Everything else with a /etc/SuSE-release file will show up as
    "suse-based".
    
    Here is a collection of release files:
    
    ==> Dist/6.0/etc/SuSE-release <==
    SuSE Linux 6.0 (i386)
    VERSION = 6.0
    
    ==> Dist/6.1/etc/SuSE-release <==
    SuSE Linux 6.1 (i386)
    VERSION = 6.1
    
    ==> Dist/6.2/etc/SuSE-release <==
    SuSE Linux 6.2 (i386)
    VERSION = 6.2
    
    ==> Dist/6.3/etc/SuSE-release <==
    SuSE Linux 6.3 (i386)
    VERSION = 6.3
    
    ==> Dist/6.4/etc/SuSE-release <==
    SuSE Linux 6.4 (i386)
    VERSION = 6.4
    
    ==> Dist/7.0/etc/SuSE-release <==
    SuSE Linux 7.0 (i386)
    VERSION = 7.0
    
    ==> Dist/7.1/etc/SuSE-release <==
    SuSE Linux 7.1 (i386)
    VERSION = 7.1
    
    ==> Dist/7.2/etc/SuSE-release <==
    SuSE Linux 7.2 (i386)
    VERSION = 7.2
    
    ==> Dist/7.3/etc/SuSE-release <==
    SuSE Linux 7.3 (i386)
    VERSION = 7.3
    
    ==> Dist/8.0/etc/SuSE-release <==
    SuSE Linux 8.0 (i386)
    VERSION = 8.0
    
    ==> Dist/8.1/etc/SuSE-release <==
    SuSE Linux 8.1 (i386)
    VERSION = 8.1
    
    ==> Dist/8.2/etc/SuSE-release <==
    SuSE Linux 8.2 (x86-64)
    VERSION = 8.2
    
    ==> Dist/9.0/etc/SuSE-release <==
    SuSE Linux 9.0 (x86-64)
    VERSION = 9.0
    
    ==> Dist/9.1/etc/SuSE-release <==
    SuSE Linux 9.1 (x86-64)
    VERSION = 9.1
    
    ==> Dist/9.2/etc/SuSE-release <==
    SuSE Linux 9.2 (x86-64)
    VERSION = 9.2
    
    ==> Dist/9.3/etc/SuSE-release <==
    SuSE Linux 9.3 (x86-64)
    VERSION = 9.3
    
    ==> Dist/10.0/etc/SuSE-release <==
    SUSE LINUX 10.0 (X86-64) OSS
    VERSION = 10.0
    
    ==> Dist/10.1-remastered/etc/SuSE-release <==
    SUSE LINUX 10.1 (X86-64)
    VERSION = 10.1
    
    ==> Dist/10.1/etc/SuSE-release <==
    SUSE Linux 10.1 (X86-64) Beta8
    VERSION = 10.1
    
    ==> Dist/10.2/etc/SuSE-release <==
    openSUSE 10.2 (X86-64)
    VERSION = 10.2
    
    ==> Dist/10.3/etc/SuSE-release <==
    openSUSE 10.3 (X86-64)
    VERSION = 10.3
    
    ==> Dist/11.0/etc/SuSE-release <==
    openSUSE 11.0 (X86-64)
    VERSION = 11.0
    
    ==> Dist/11.1/etc/SuSE-release <==
    openSUSE 11.1 (x86_64)
    VERSION = 11.1
    
    ==> Dist/11.2/etc/SuSE-release <==
    openSUSE 11.2 (x86_64)
    VERSION = 11.2
    
    ==> Dist/11.3/etc/SuSE-release <==
    openSUSE 11.3 (x86_64)
    VERSION = 11.3
    
    ==> Dist/11.4/etc/SuSE-release <==
    openSUSE 11.4 (x86_64)
    VERSION = 11.4
    CODENAME = Celadon
    
    ==> Dist/12.1/etc/SuSE-release <==
    openSUSE 12.1 (x86_64)
    VERSION = 12.1
    CODENAME = Asparagus
    
    ==> Dist/12.2/etc/SuSE-release <==
    openSUSE 12.2 (x86_64)
    VERSION = 12.2
    CODENAME = Mantis
    
    ==> Dist/sles8/etc/SuSE-release <==
    SuSE SLES-8 (AMD64)
    VERSION = 8.1
    
    ==> Dist/sles9/etc/SuSE-release <==
    SUSE LINUX Enterprise Server 9 (x86_64)
    VERSION = 9
    
    ==> Dist/sles9sp2/etc/SuSE-release <==
    SUSE LINUX Enterprise Server 9 (x86_64)
    VERSION = 9
    PATCHLEVEL = 2
    
    ==> Dist/sles9sp3/etc/SuSE-release <==
    SUSE LINUX Enterprise Server 9 (x86_64)
    VERSION = 9
    PATCHLEVEL = 3
    
    ==> Dist/sles9sp4/etc/SuSE-release <==
    SUSE LINUX Enterprise Server 9 (x86_64)
    VERSION = 9
    PATCHLEVEL = 4
    ==> Dist/sled10/etc/SuSE-release <==
    SUSE Linux Enterprise Desktop 10 (x86_64)
    VERSION = 10
    
    ==> Dist/sled10sp1/etc/SuSE-release <==
    SUSE Linux Enterprise Desktop 10 (x86_64)
    VERSION = 10
    PATCHLEVEL = 1
    
    ==> Dist/sled10sp2/etc/SuSE-release <==
    SUSE Linux Enterprise Desktop 10 (x86_64)
    VERSION = 10
    PATCHLEVEL = 2
    
    ==> Dist/sled10sp3/etc/SuSE-release <==
    SUSE Linux Enterprise Desktop 10 (x86_64)
    VERSION = 10
    PATCHLEVEL = 3
    
    ==> Dist/sled10sp4/etc/SuSE-release <==
    SUSE Linux Enterprise Desktop 10 (x86_64)
    VERSION = 10
    PATCHLEVEL = 4
    
    ==> Dist/sled11/etc/SuSE-release <==
    SUSE Linux Enterprise Desktop 11 (x86_64)
    VERSION = 11
    PATCHLEVEL = 0
    
    ==> Dist/sled11sp1/etc/SuSE-release <==
    SUSE Linux Enterprise Desktop 11 (x86_64)
    VERSION = 11
    PATCHLEVEL = 1
    
    ==> Dist/sled11sp2/etc/SuSE-release <==
    SUSE Linux Enterprise Desktop 11 (x86_64)
    VERSION = 11
    PATCHLEVEL = 2
    
    ==> Dist/sles10/etc/SuSE-release <==
    SUSE Linux Enterprise Server 10 (x86_64)
    VERSION = 10
    
    ==> Dist/sles10sp1/etc/SuSE-release <==
    SUSE Linux Enterprise Server 10 (x86_64)
    VERSION = 10
    PATCHLEVEL = 1
    
    ==> Dist/sles10sp2/etc/SuSE-release <==
    SUSE Linux Enterprise Server 10 (x86_64)
    VERSION = 10
    PATCHLEVEL = 2
    
    ==> Dist/sles10sp3/etc/SuSE-release <==
    SUSE Linux Enterprise Server 10 (x86_64)
    VERSION = 10
    PATCHLEVEL = 3
    
    ==> Dist/sles10sp4/etc/SuSE-release <==
    SUSE Linux Enterprise Server 10 (x86_64)
    VERSION = 10
    PATCHLEVEL = 4
    
    ==> Dist/sles11/etc/SuSE-release <==
    SUSE Linux Enterprise Server 11 (x86_64)
    VERSION = 11
    PATCHLEVEL = 0
    
    ==> Dist/sles11sp1/etc/SuSE-release <==
    SUSE Linux Enterprise Server 11 (x86_64)
    VERSION = 11
    PATCHLEVEL = 1
    
    ==> Dist/sles11sp2/etc/SuSE-release <==
    SUSE Linux Enterprise Server 11 (x86_64)
    VERSION = 11
    PATCHLEVEL = 2
    
    Signed-off-by: Olaf Hering <olaf@aepfle.de>

commit 71f87d9a8f04212fc0534b3fb423780185181585
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Thu Sep 20 19:36:21 2012 +0200

    ./run: Keep gnome-keyring from disturbing test script output

commit e5d01c21d7aa2683ad4b98cb30960219103c056d
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Thu Sep 20 19:36:20 2012 +0200

    ./run: Make sure that the temporary directory exists so test scripts can produce output files

commit e482f2faf0a1fef41358a8083153b327203505e9
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Thu Sep 20 19:36:03 2012 +0200

    python: PyInt_* no longer exists in python3, replace with PyLong_*

commit b36b44af9e177fe5c9677d430abc7cba0633049c
Author: Olaf Hering <olaf@aepfle.de>
Date:   Thu Sep 20 15:19:43 2012 +0200

    rename local variable to avoid clash with match macro
    
    match will expand to guestfs___match, rename the local variable to avoid clash.
    
    Signed-off-by: Olaf Hering <olaf@aepfle.de>

commit 64cc0dafd03bb23ef1520c8f46fd2dd44a0d8c4e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 20 17:56:40 2012 +0100

    docs: Add links to various guestfs-* man pages from guestfs(3).

commit 8aa8eb205b02e1014e5ed9577f4a9da9fd864aba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 20 17:56:10 2012 +0100

    recipes: Add section about uploading raw filesystem content.

commit 840deea12079b05a9f588016af273843d5d6e1b8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 20 11:41:16 2012 +0100

    launch: Make the "launched failed" message more explanatory.
    
    Since this is the most common error seen by people who have
    installation problems, buggy qemu, etc, and since no one reads the
    FAQ, describe in this error message what resources are available to
    debug launch problems.

commit 181de70feb86840ee9ef761107933414e37ff144
Author: Olaf Hering <olaf@aepfle.de>
Date:   Wed Sep 19 19:37:34 2012 +0200

    sysprep: handle SuSE in random-seed operation
    
    Signed-off-by: Olaf Hering <olaf@aepfle.de>

commit d6c11b0a3d4c1f7911413b19e52ab6a60ed213ad
Author: Olaf Hering <olaf@aepfle.de>
Date:   Wed Sep 19 19:32:35 2012 +0200

    sysprep: add zypper to package-manager-cache operation
    
    libzypp and zypper store their cache files in
    /var/cache/zypp/{packages,raw,solv}/ and /var/cache/zypper/RPMS/
    Add a single pattern to match both cases.
    
    Signed-off-by: Olaf Hering <olaf@aepfle.de>

commit 245608a735027bbafee8306c3ae23c55ee4eeaa1
Author: Olaf Hering <olaf@aepfle.de>
Date:   Wed Sep 19 19:26:39 2012 +0200

    sysprep: remove apache2, audit and ntp in logfile operation
    
    Add more entries to the dump ground of logfile patterns.
    
    Signed-off-by: Olaf Hering <olaf@aepfle.de>

commit ae0f60744b7f20538f8b9945ef99301fa1ecfe45
Author: Olaf Hering <olaf@aepfle.de>
Date:   Wed Sep 19 18:18:29 2012 +0100

    sysprep: handle SuSE in hostname operation
    
    SuSE based installations store the hostname in /etc/HOSTNAME.
    Add code to handle both opensuse and sles. Code to properly detect
    the latter will be added with another patch.
    
    Signed-off-by: Olaf Hering <olaf@aepfle.de>

commit 88c406feba1390f830c20bfb4c11989a4e877b91
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 19 17:34:11 2012 +0100

    sysprep: Create /etc/sysconfig/network file if it doesn't exist (RHBZ#858696).

commit aeb2f76a585afdca07691771ab4d3d50cab2cbd0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 18 12:51:36 2012 +0100

    extra-tests: Re-run the tests against upstream libvirt.

commit 157b5006dbf2db2927e48ce592a83a279513d183
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 18 12:48:36 2012 +0100

    extra-tests: Clean up some comments about the upstream qemu tests.

commit 7e4b197cb6a5071c13e407546a21f9b93fe3798d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 18 12:47:50 2012 +0100

    extra-tests: Add scripts used by these tests to EXTRA_DIST.

commit e4ef926d6f3178b48953c143b8faafc79fd6e095
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 17 23:06:44 2012 +0100

    Version 1.19.42.

commit a3ce00059934a3b72fd72c9d8fc67de99ca9907a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 17 22:52:53 2012 +0100

    tmp: Ignore libguestfsXXXXXX temporary files in tmp dir.

commit 5479b8db587120c1582d755c056ccf26bc095806
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 17 22:41:25 2012 +0100

    ./run: Write temporary file in tmp directory.
    
    We have a new 'tmp' directory under the top level dir for temporary
    files.  Use it for the temporary output from the ./run script.

commit f9f0767e20847734db3747c06b4ff11729a62a07
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 17 16:34:59 2012 +0100

    launch: libvirt: Pass TMPDIR to qemu subprocess.

commit a2dc3dbad0b9e6ee827247ee3ceefca480f5a052
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 17 16:25:53 2012 +0100

    New API: rm-f: remove a file, ignoring errors if it doesn't exist.

commit 74283d58cfb62e6cc73bfe0f62ca142ddc1e8fb2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 17 14:03:28 2012 +0100

    inspect: Fix segfault and error caused by earlier code cleanups.
    
    This fixes commit e128a627fb8f39f4f4c11b782cef895bd79f0282.

commit 2e17d78178eb085bdf54eb170bf036e0d7143c19
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 17 13:38:38 2012 +0100

    launch: libvirt: Disable sVirt if using a custom qemu (ie. setting <emulator>).
    
    See:
    https://bugzilla.redhat.com/show_bug.cgi?id=857659
    especially Dan's comment 4.

commit e128a627fb8f39f4f4c11b782cef895bd79f0282
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 17 13:15:49 2012 +0100

    Fix multiple errors where jump skips variable initialization.
    
    <file>: error: jump skips variable initialization [-Werror=jump-misses-init]
    
    This has only just appeared, possibly related to previous gnulib
    update.  In any case, this is just code motion / cleanup.

commit c387b69cba8f145438188b2b4567abbc9580ade0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 17 13:31:45 2012 +0100

    daemon: stubs: Move all arg decls to top of function.
    
    For some reason, argument declarations were handled
    inconsistently for strings and non-string arguments.
    Non-string arguments were all declared at the top of the
    function stub, where as string arguments were declared
    in place.
    
    Be consistent.
    
    This is just code motion.

commit 176bd182d3f94fe7e774b8af0b56c014f639d6c7
Author: Jim Meyering <jim@meyering.net>
Date:   Mon Sep 17 11:51:05 2012 +0200

    maint: remove a subsumed syntax-check rule
    
    * cfg.mk (sc_prohibit_trailing_blank_lines): Remove rule.  It is now
    subsumed by the much more efficient sc_prohibit_empty_lines_at_EOF
    rule in gnulib's maint.mk.

commit 3988dec9b7bbf3cb8628aff879d1f518a9d52404
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 17 10:15:43 2012 +0100

    syntax: Exclude examples and test program from <config.h> requirement
    (thanks Jim Meyering).

commit 72ab351acef2f2bc6b0e4f36d69e94f8fa064f3c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 17 10:12:20 2012 +0100

    syntax: Allow strncpy in launch-*.c files (thanks Jim Meyering).
    
    We use strncpy, justifiably, to copy the socket name into
    the fixed length Unix domain sun_path buffer.

commit 369709177e47773eaa37f1fdbe8d9967b21d1133
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 17 10:10:17 2012 +0100

    syntax: Exclude examples from strcmp and strncmp checks (thanks Jim Meyering).

commit 552576c7f9ccb1862bcfc9fbd5c301d775aaf90c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 17 10:06:28 2012 +0100

    syntax: Ignore documentation when testing for magic number exit() calls (thanks Jim Meyering).

commit 2100ba14fbfaf3e89059d9112959463506932d74
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 17 09:54:27 2012 +0100

    syntax: Exclude PO files from doubled words test (thanks Jim Meyering).

commit cb13ffe190ac41a9b77fe27521838f495c1a5077
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 17 09:51:01 2012 +0100

    syntax: Remove definitions of O_CLOEXEC, except in examples (thanks Jim Meyering).
    
    The gnulib <fcntl.h> replacement header will now define this symbol if
    it's not defined already.

commit 2337b9ccd729e05b46cf6abb1f4173e6e994c1cb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 17 09:47:15 2012 +0100

    syntax: Exclude period in error message checks from PHP programs (thanks: Jim Meyering).

commit fbdcfe2b77b6c272876143779912d41b0849111f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 17 09:45:38 2012 +0100

    syntax: Disable cast arg to free test (thanks Jim Meyering).

commit b95fff13577cdd3da4300bbd639441cc77cf935a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 17 09:44:11 2012 +0100

    syntax: Exclude certain files from bindtextdomain test (thanks Jim Meyering).

commit e942c02a2eeb4d55606dec5fe943ea7d81f989ba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 17 09:52:31 2012 +0100

    Update to latest gnulib.

commit 946ae89a78995b58a211e1791a81be8d6949802f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Sep 16 13:35:07 2012 +0100

    Version 1.19.41.

commit e6bd0b87eb753fa96b6533b0dbe498697701ad3a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 15 17:10:34 2012 +0100

    extra-tests: Write a qemu wrapper script on the fly.
    
    Passing the $upstream_qemu environment variable is not reliable when
    libvirt is involved: Environment variables are passed to the first
    instance of the session libvirtd, but because libvirt reuses the
    session libvirtd, subsequent environment variable settings are lost
    (this is filed as RHBZ#856619).
    
    Bypass all of this by writing a custom qemu-wrapper.sh which contains
    the hard-coded values we want.

commit 2fd51c28fd5bb3114b4a078d1698732a6e66bfc1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 15 13:52:17 2012 +0100

    extra-tests: Rerun extra tests with regular appliance attach method.
    
    If libvirt is being used as the backend, rerun all the extra-tests
    again using the regular appliance backend.

commit 509dd90c43afed75b861b7d82ebe8739d3500d54
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 15 13:47:39 2012 +0100

    extra-tests: The upstream qemu test now reruns all the extra tests.

commit eeb0c598ec8caa50998336713ed4e62902e0a74d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 15 14:40:28 2012 +0100

    extra-tests: Fix libvirt URI so we can run tests with libvirt attach-method.

commit 2cac8d490e9884a8c7376e49fd1cda2e3d3abec1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 15 13:28:24 2012 +0100

    syntax: Remove trailing whitespace.
    
    Found by 'make syntax-check'.

commit 44a11e955b31f7c0cf463a04d640263cccdd0c4d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 15 13:27:50 2012 +0100

    generator: Remove inaccurate comment.
    
    The correct way to extend functions is documented in generator/README.
    This comment was no longer accurate.

commit 6361810b53be4d5e0513b4f7c11d29cf1d6d3b45
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 15 13:21:55 2012 +0100

    syntax: Replace test == with = or -eq as appropriate.
    
    Found by 'make syntax-check'.

commit d26f40236196eb2cdf81fa62cbfa28ca89623b28
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 15 13:19:12 2012 +0100

    syntax: xfs: Rewrite split_strdup function to avoid use of strncpy.
    
    Found by 'make syntax-check'.

commit b0cefb417d01c6dcb87cc6bafe9c19b98c690c9d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 15 13:11:45 2012 +0100

    syntax: Use STREQ/STRNEQ in place of strcmp.
    
    Found by 'make syntax-check'.

commit 90b7c53b70dda9a131cf13beb5d1e77cc41534f7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 15 13:08:08 2012 +0100

    syntax: Remove include <signal.h> in file that doesn't use it.
    
    Found by 'make syntax-check'.

commit 2383d7a78e8abc308e36b2045087a9785c893f49
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 15 13:01:10 2012 +0100

    syntax: Remove PATH_MAX-sized buffers allocated on the stack.
    
    On Linux PATH_MAX is 4096, but on some platforms it can be much larger
    or even not defined (ie. unlimited).  Therefore using a PATH_MAX-sized
    stack buffer is not a great idea for portable programs.
    
    This change removes use of PATH_MAX-sized stack-allocated buffers.
    
    This change only applies to the library and standalone programs.
    Inside the daemon, memory allocation is much more complicated so I
    have not changed those (yet).
    
    Found by 'make syntax-check'.

commit a67129b0fb45b2f83eb711c6c599569d0f53e580
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 15 12:38:07 2012 +0100

    syntax: Remove gnulib "ignore-value.h" in files that don't use it.
    
    Found by 'make syntax-check'.

commit d6bb49a172c369c3bcc85771af804649c3733ef3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 15 12:35:59 2012 +0100

    syntax: Remove include <dirent.h> in files that don't use it.
    
    Found by 'make syntax-check'.

commit 9fce75aa13de52561ec0f4ae083c4ab0fa4455d1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 15 12:34:41 2012 +0100

    syntax: Remove gnulib c-ctype.h in files that don't use it.
    
    Found by 'make syntax-check'.

commit 6272e49f51a192f2f8ecd8ffbb018f60ca0bac28
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 15 12:32:41 2012 +0100

    syntax: Remove include <assert.h> where assert is not used.
    
    Found by 'make syntax-check'.

commit da75618fb2eecb644d8ec84c9584c402b0bc5339
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 15 12:31:07 2012 +0100

    lib: Rearrange headers.
    
    This is just code motion.

commit 8747ff743216fbb6119606c22966e2283f30a54a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 15 12:30:12 2012 +0100

    lib: Remove unused headers <arpa/inet.h> and <netinet/in.h>
    
    These were used back in the day when we used TCP for the
    communications channel with the guest.

commit dec73f70fc5320faec46a21f27aae6748cea3450
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 15 12:25:28 2012 +0100

    syntax: Remove HAVE_*_H tests which are always true.
    
    Gnulib supplies replacements for these headers, so there
    is no need to test.

commit cd8976a5b52425f9d7c45249e1a593a341d91c52
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 15 12:22:44 2012 +0100

    perl: Add <stdio.h> and <stdlib.h> for printf and malloc.

commit 188b44ee458a666bee8a18ed47cccdec25859aff
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 15 12:21:24 2012 +0100

    perl: Include <inttypes.h> and assume it always defines PRId64 and PRIu64.
    
    If these are not defined in the header files, it's a problem on
    the platform which we should fix with gnulib.  Our replacement
    definitions might be wrong here.

commit 5a46eadd3dcab1b8944eabc0f21097048e0ebe13
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 15 12:15:47 2012 +0100

    lib: These optargs structures are not modified, hence const.

commit ae137124ca143e57f16d103f24cb3f21a3157b09
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 15 11:50:32 2012 +0100

    syntax: Remove test for TAB indentation.
    
    Nothing particularly wrong with using TABs for indentation,
    and this test also has a lot of false positives.

commit 57d089fd6d28ed351ca30259c975fcee6e02fee8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 15 11:33:35 2012 +0100

    syntax: xfs: Remove useless if before free.
    
    Found by running 'make syntax-check'.

commit 6951becfdb0b69b4defff4393f48314e884ad7c1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 15 11:53:44 2012 +0100

    docs: Fix documentation of syntax-check target, add extra-tests.

commit 244e9a2ac40fa8a1494f769740947c8a600ee8d7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 14 23:03:37 2012 +0100

    faq: Make the legal section less unnecessarily legalistic.

commit 19da851610fc14b547ff9e25101921f69edc7f2f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 14 23:02:23 2012 +0100

    faq: Tidy up headings.

commit 2c59af77545c764ddded93af2c0a0611be79376e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 14 22:57:02 2012 +0100

    faq: Add more answers about read-only disks.

commit 6575ac4c61cc41a2e3c662b58fd0e0cee2b6a2e3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 21 16:50:33 2012 +0100

    launch: libvirt: Enable sVirt.

commit 5b02c8d0bcdf815702b069cd69a8790ee41a310f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 14 16:45:43 2012 +0100

    test-9p: Disable this test with libvirt.
    
    This test doesn't work with sVirt if SELinux is enforcing, because
    qemu won't be able to access the 9p-exported directory on the host.

commit 834747a85d80ce02e9deca32be89199c10cd74fd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 14 14:42:24 2012 +0100

    build: Create new 'tmp' directory for tests.
    
    Having a separate directory means:
    
    (1) It's easy to clean up orphaned temporary files, the appliance,
        etc.
    
    (2) You can put an SELinux label on this directory so that qemu can
        write to it when you're using sVirt and SELinux is enforcing:
    
        chcon --reference=/tmp tmp

commit aa9e0057b19e29f76c9a81f9aebeeb1cb5bf1fdb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 14 15:50:38 2012 +0100

    launch: libvirt: Mark appliance disk as <shareable/> (thanks Dan Berrange).
    
    This is a fix for multiprogramming: If two instances of libguestfs
    share the same appliance disk, then libvirt would unlabel the disk
    when one of the instances closes the handle, resulting in the other
    qemu being unable to continue accessing the appliance.
    
    Adding the flag makes libvirt understand that the disk is shared so it
    doesn't do this, and it apparently handles locking correctly too if we
    were using sanlock.

commit 281b155800f2e62b994e59bef418ca200da8e93a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 14 11:34:26 2012 +0100

    test-tool: Print more environment variables.
    
    This prints LIBVIRT_*, LIBVIRTD_*, LD_* and PATH, since these are all
    useful for debugging and could affect libguestfs in some way.

commit 8acdc23622ea95a233ac831d67c143517aa94bba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 13 19:31:51 2012 +0100

    fish: Replace '_' with '-' in deprecation cross-refs (thanks Olaf Hering).

commit d9a98dc1cdcfb185e659c0d02f74ae6739b340db
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 12 21:38:48 2012 +0100

    lib: guestfs_disk_format: Set LC_ALL=C instead of LANG=C.
    
    LC_ALL takes precedence over LANG.  See:
    
    http://pubs.opengroup.org/onlinepubs/7908799/xbd/envvar.html

commit 97a1439d90b819b32177a69c9f318b47040b49d3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 6 12:46:57 2012 +0100

    release-notes: Add 'draft' background image.

commit 81c682f1295a934d18bd4dc9e42b8e843df0c207
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 5 13:56:34 2012 +0100

    extra-tests: Don't use $QEMU as a variable.
    
    Since 'QEMU' is set (overwritten) by the autoconf-generated Makefile,
    this test would always test installed qemu, not upstream qemu,
    making it pretty useless.  Use another name for this variable.

commit 3d84ca76fec491015030daa53e9122b03032ddfd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 5 11:12:52 2012 +0100

    generator: Remove generated and unused files from previous runs of the generator.
    
    If you go back in time in git (eg. git reset, git bisect) then you can
    end up in a situation where a file that was generated by a later
    version is left around unused in the earlier version.
    
    This isn't a problem for most things, but gobject documentation
    generation picks up any file in a directory, even unreferenced ones,
    and breaks.  So the correct thing to do is to remove these files.

commit 169ac913e9930f7e4a27f395e6c06901f7c849c3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 5 11:12:25 2012 +0100

    generator: gobject: Use a more normal way to output files.
    
    The generator output is identical, verified by comparing the
    output files before and after the change.

commit dc8aca2cf92cc4674a8aed401922bced87524e7e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 4 23:16:47 2012 +0100

    Version 1.19.40.

commit 9c4097dfd827d3b647a9799f11b3a91daecc4f6a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 4 22:29:09 2012 +0100

    sparsify: Fix use of closed handle (thanks Olaf Hering).
    
    This fixes commit faaedeb3432253847107ca2c4530f681c6a1e385.
    
    Also contains an update to the test which tests the format
    auto-detect path.

commit bdb5689f58c0db18de28d6a703b3af4f22eded38
Author: Olaf Hering <olaf@aepfle.de>
Date:   Tue Sep 4 17:43:39 2012 +0200

    fix fuse_opt_add_opt_escaped return type
    
    I: Program returns random data in a function
    E: libguestfs no-return-in-nonvoid-function guestmount.c:75
    
    The function fuse_opt_add_opt_escaped has only one caller and a return
    code is not checked.
    
    Signed-off-by: Olaf Hering <olaf@aepfle.de>

commit 853feb971f4d111346d1f65211dbbd75ce1a9aae
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 4 17:10:23 2012 +0100

    Version 1.19.39.

commit c4171ad58f61f72f5f6c6c8e711a7bcc19d20f75
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 4 15:34:35 2012 +0100

    shutdown: Add 'check_for_errors' hint along the shutdown path.
    
    This hint tells the backend whether anyone cares about errors when the
    appliance is shut down.
    
    Currently this only has any effect on the libvirt backend, where it
    controls whether or not we use the VIR_DOMAIN_DESTROY_GRACEFUL flag.

commit cc4b3139d17b98d734d98286bb698bb3b105da05
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 4 15:25:22 2012 +0100

    launch: libvirt: Add VIR_DOMAIN_DESTROY_GRACEFUL flag.
    
    We want libvirt to report failures when destroying the guest.  See:
    
    https://bugzilla.redhat.com/show_bug.cgi?id=853369#c12

commit 05beac65e58ef20899c7a50888a2854c07f83db9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 4 14:02:58 2012 +0100

    rescue: Add an expect-driven test for the virt-rescue command.
    
    This command was not tested at all.  As a result we didn't notice that
    it was broken for a long time (RHBZ#853159).
    
    This adds a test that drives the command through a pty.  It uses the
    perl 'Expect' module, although this is not required.

commit 8248a346d71ed7fc964595f6e973ff6593cdc217
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 4 14:37:44 2012 +0100

    proto: Don't set g->fd[] to /dev/null in direct mode, fixing virt-rescue (RHBZ#853159).
    
    https://bugzilla.redhat.com/show_bug.cgi?id=853159
    
    git bisect pointed to the following commit:
    
      commit ec8e3b6cad170d08ac18b580792dfb137eb171dc
      Author: Richard W.M. Jones <rjones@redhat.com>
      Date:   Fri Jul 20 14:24:10 2012 +0100
    
        launch: Abstract attach method operations.
    
        g->attach_ops points to a structure which contains the
        operations supported by each attach method backend
        (ie. appliance, unix, etc.).
    
    Since that commit was essentially just code motion, it wasn't clear
    why virt-rescue should be affected by it.
    
    In fact the reason is as follows:
    
    (1) In direct mode, we don't need g->fd[] (which would normally be
    connected to the stdin/stdout of qemu).  So we opened them on
    /dev/null so they had some value.
    
    (2) accept_from_daemon / read_log_message_or_eof reads from g->fd[1].
    Since this is connected to /dev/null, it always reads EOF.
    
    (3) This would cause child_cleanup to be called.  This is completely
    unintentional: we don't want to cleanup the child at this point, even
    in direct mode.
    
    (4) Prior to the commit above, child_cleanup first waited for the
    process to exit (ie. waitpid).  This happened to work, since we are
    effectively waiting for the user to exit virt-rescue.
    
    (5) After the commit above, the order of operations was changed so
    that we first killed qemu before waiting for it.  This broke
    virt-rescue.
    
    The fix is to change direct mode so that it leaves g->fd[]'s as -1.
    The rest of the protocol code can deal with this situation -- it
    ignores the log fd instead of trying to read from it.

commit 2e36adf83ce4a9cbccd313d6f3a88b5c5973ce44
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 4 12:04:31 2012 +0100

    rescue: If attach-method is 'libvirt', force it to be 'appliance'.
    
    The libvirt backend currently doesn't support direct mode.  We should
    make that work in future.  As a workaround, force the attach-method to
    be 'appliance' in this case.

commit 6fdf1f40fa85d2e6e7a1118f4cfa532ea9831b89
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 4 11:53:57 2012 +0100

    rescue: If -v / debugging enabled, don't mask error messages.
    
    We set the error handler to NULL in order to mask "normal" error
    messages that we expect to see because of the unusual way that
    virt-rescue runs the appliance.  However if the user selected -v /
    enabled debugging, then it is reasonable to expect they want to see
    every message, so do not mask anything.

commit 77f70a5f7cd908609833a948031544c0befbc874
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 4 11:49:51 2012 +0100

    launch: libvirt: Direct mode flag is not (yet) supported, so give an error in this case.
    
    We definitely intend to support this in future.

commit 381c067d5463b669f82d0601975f5a3f0e6faaba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 4 11:55:13 2012 +0100

    Update release notes (text file).
    
    This updates commit 9e4ac650e4c4d934a91a88d7e4aaf5495845a71b.

commit 9e4ac650e4c4d934a91a88d7e4aaf5495845a71b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 4 11:31:28 2012 +0100

    Update release notes.

commit d03361b1afee09135b0cbd92a2cc180c66c5f84e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 4 09:03:08 2012 +0100

    lib: Add tests to the disk-{format,virtual-size,has-backing-file} APIs.

commit 4ed981bd5f0a158db3cfb87794628806bf00d443
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 4 08:58:21 2012 +0100

    New APIs: disk-virtual-size and disk-has-backing-file.

commit e388c4f3fd26c8756ac33e94b02f8435a0179bc1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 4 08:39:04 2012 +0100

    lib: Reimplement qemu-img info parser for flexibility.
    
    This allows other fields from the output of 'qemu-img info'
    to be parsed out.
    
    This updates commit 20902e7ce02fa375d5d336e6b984f615472ad1b1.

commit 1030e8aba0993b48cc36c4aa78cd6665914ed99c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 4 09:39:25 2012 +0100

    Fix guestfs_disk_image API to work with relative paths.
    
    guestfs_disk_image makes a symbolic link to the real filename in order
    to sanitize the filename.  However this fails if the filename is a
    relative path.  Call realpath(3) to make the filename canonical.
    
    This fixes commit 20902e7ce02fa375d5d336e6b984f615472ad1b1.

commit 26732678c6f23730f28a37694be932c96e3c4e50
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 3 18:35:17 2012 +0100

    Version 1.19.38.

commit 47ddb77fb12233708905f741aa04fca302e37bce
Author: Olaf Hering <olaf@aepfle.de>
Date:   Mon Sep 3 18:01:37 2012 +0200

    daemon: provide list of checksum commands
    
    While adding the list of external commands I missed the
    various checksum tools.
    
    Signed-off-by: Olaf Hering <olaf@aepfle.de>

commit faaedeb3432253847107ca2c4530f681c6a1e385
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 3 16:46:10 2012 +0100

    sparsify: Use guestfs_disk_format to autodetect input format (RHBZ#853762).

commit 9f8ba4e8d16e5c50c3cd657f9beae3518947b6ed
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 3 16:45:48 2012 +0100

    launch: libvirt: Use guestfs_disk_format API to autodetect input format.

commit efdc2bae40b3e74b90a61f82bcb7b18830697272
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 3 11:34:01 2012 +0100

    guestfs(3): Document disk image formats and how to detect them.

commit 20902e7ce02fa375d5d336e6b984f615472ad1b1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 3 15:56:29 2012 +0100

    New API: guestfs_disk_format
    
    Detect the disk image format of a file, in a secure way.

commit b6413f8dbef92c46c4baf9499366716a166f2163
Author: Olaf Hering <olaf@aepfle.de>
Date:   Mon Sep 3 10:58:27 2012 +0200

    daemon: remove call to obsolete udevsettle
    
    udevadm is included in all reasonable recent distributions.
    This avoids 'command not found' errors in verbose mode.
    
    Signed-off-by: Olaf Hering <olaf@aepfle.de>

commit c659cf8ea602755035460ca7ac4a794da19df597
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Mon Sep 3 17:00:11 2012 +0800

    TODO: remove the implemented hostname removing feature
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 98bf41d80d4ecdd65f7974d134d34a3926a39a75
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Mon Sep 3 16:05:37 2012 +0800

    sysprep: remove hostname from ifcfg-*
    
    Remove hostname from network interface configuration.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 3820a2578c120056683a4b152b72021f82b2c821
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 3 08:52:33 2012 +0100

    generator: Test zero args, one optarg; and 63 optargs.
    
    This just generates the code; it's not called.

commit f65dee769d1fc53c5963c381bf8a1bf02654f78c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 3 09:35:56 2012 +0100

    java: Fix >= 32 optargs (thanks Wanlong Gao).

commit d331fd70e2c3ba2815460c8cd93a97eb9a81c6a5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Sep 2 18:26:48 2012 +0100

    generator: Rename 'generator_*' as '*'.
    
    This is a simple renaming of the files/modules.
    
    Note that in OCaml, module names are derived from filenames by
    capitalizing the first letter.  Thus the old module names had the form
    "Generator_api_versions".  The new modules names have the form
    "Api_versions".

commit 11d655ab83211eb6808d32296cbbab31fc023aac
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Sep 2 19:47:26 2012 +0100

    TODO: Suggest removing hostname from ifcfg-eth* files.

commit b799bc58a84e155783afae23f64f27e23ddd06dd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Sep 2 16:26:09 2012 +0100

    recipes: Checksum file/device.  Download to stdout.

commit a1d981edeae120a0523d0974c703f1a956202415
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 31 19:12:27 2012 +0100

    tests: Attach copyright and license (GPLv2+) notices to various test scripts.
    
    For some reason these tests did not have license notices.

commit d754f4a5a30e0473754004c187b919dcc05e8f6f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 31 19:05:51 2012 +0100

    tests/rsync: Allow rsync test to be skipped by setting SKIP_TEST_RSYNC_SH=1.

commit 42b892a8c555c15f1066341faaec359c5126af10
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 31 18:34:24 2012 +0100

    Version 1.19.37.

commit 3ed3e23ed09a765a3275ca2d82518b335ede759f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 31 15:20:25 2012 +0100

    Copy the kernel so that libvirt can add an SELinux label to it. NB. This requires febootstrap >= 3.20 with --copy-kernel flag.

commit 3728c122f1b2c235aaf92da077e307ffd2fb2178
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 31 15:14:51 2012 +0100

    guestfs-internal.h: Organize functions by file.
    
    This is almost just code motion.  While doing this I discovered two
    prototypes for functions which no longer exist:
    
      * guestfs___launch_appliance
      * guestfs___launch_unix
    
    so these prototypes have been removed.  The rest are rearranged more
    logically.

commit b17d1896168bed2dc4c8c82bc368e79e10b14457
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 31 14:30:10 2012 +0100

    tests: Make mkswap and tar tests conditional on linuxfsuuid and xz features.

commit 87cb1549761c9441b0fa7ee9b6a85b8eeb164c5c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 31 10:23:41 2012 +0100

    tests/mount-local: Link test program with gnulib.

commit 4e6bf1ed653540a8954a6a11fe5a0fb424013af9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 31 09:53:44 2012 +0100

    src/dbdump.c: Shouldn't depend on HAVE_HIVEX (thanks Tao Zhou).

commit 0306c98d319d189281af3c15101c8d343e400f13
Author: Olaf Hering <olaf@aepfle.de>
Date:   Thu Aug 30 20:51:27 2012 +0200

    daemon: collect list of called external commands
    
    guestfsd calls many different tools. Keeping track of all of them is
    error prone. This patch introduces a new helper macro to put the command
    string into its own ELF section:
    
    GUESTFSD_EXT_CMD(C_variable, command_name);
    
    This syntax makes it still possible to grep for used command names.
    
    The actual usage of the collected list could be like this:
    
      objcopy -j .guestfsd_ext_cmds -O binary daemon/guestfsd /dev/stdout |
      tr '\0' '\n' | sort -u
    
    The resulting output will be used to tell mkinitrd which programs to
    copy into the initrd.
    
    Signed-off-by: Olaf Hering <olaf@aepfle.de>
    
    RWMJ:
     - Move str_vgchange at request of author.
     - Fix snprintf call in daemon/debug.c

commit 4aa1464d42c62e8cbff4669f01f53f0425c287e3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 30 20:09:16 2012 +0100

    launch: appliance: app.virtio_scsi must not be bool.
    
    This is used to store values 0..3, so it mustn't be a bool.  Ooops.
    
    RHEL 5's gcc revealed this bug.

commit 163e030ee13644ad9efe1e078aff47b879657333
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 30 17:29:36 2012 +0100

    daemon: Remove e2prog hack (only needed for RHEL 5).
    
    Instead this patch will be carried out of tree in the oldlinux branch.

commit 0573c199502f54f07b8de190702ba9fe87a06506
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 30 16:39:48 2012 +0100

    Version 1.19.36.

commit c945609ac9f19ca36ac14093f71dccfc70de2dbe
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 30 15:35:16 2012 +0100

    launch: libvirt: Remove code for creating sockdir.
    
    Create the sockets in g->tmpdir as usual.  It's a bug in libvirt that
    it doesn't label the sockets correctly no matter where they are
    located.

commit a7de51b3c80d03ef8a064d658ed0b96a9eaca4d9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 30 15:20:00 2012 +0100

    launch: libvirt: Avoid memory leak if sockdir is not created (found by valgrind).

commit 8af32b9d5fa0601fabffd9550f1cdc97ac78306a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 30 13:29:49 2012 +0100

    FAQ: Remove link to old RHEL 6.3 preview repo.

commit 7036a3bccfab22eb4ed2e66ef0e69a058264e323
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Thu Aug 30 17:25:47 2012 +0800

    NEW API:xfs:xfs_repair
    
    Add a new api xfs_repair for repairing an XFS filesystem.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>
    
    RWMJ:
      - Fix non-error return path so it doesn't send two replies.
      - Document return code.

commit bcbad66b185048ee49f58c49ae382f6e69d3c666
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 30 10:46:35 2012 +0100

    docs: Add guestfs-release-notes.txt to Makefile deps.

commit 2d6bf3ba70c50996062e90f78af63c4811bf516b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 30 08:58:00 2012 +0100

    tests/big-dirs: Don't run this test by default.

commit 8742713050dd20a1f11d5d32b468ae2beb644a80
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 29 20:59:06 2012 +0100

    run: Make --test flag print the time taken to run the test.
    
    This is useful because it lets us see which tests take
    the longest.

commit 1ac36e4f3692c256159d3e8b9c7d7b04923e02fd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 29 19:00:02 2012 +0100

    Version 1.19.35.

commit 9ef22fa921f440560eb953177d83fae130bbaac4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 29 18:34:47 2012 +0100

    python: Convert OInt64 using PyLong_AsLongLong so 64 bit ints work correctly.
    
    This avoids the following error on 32 bit machines:
    
      OverflowError: Python int too large to convert to C long

commit b2378a81bb7acb94409469e8b19d0c717811a99d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 28 18:54:27 2012 +0100

    Update inspection and example programs to use new hivex* APIs (RHBZ#852394).
    
    I tested this by comparing the output of virt-inspector over Windows
    guests before and after the change, which was identical:
    
    $ md5sum `ls -1 /tmp/*.before /tmp/*.after`
    c292d6629b5a761eccb4a279754399b4  /tmp/Win2003.after
    c292d6629b5a761eccb4a279754399b4  /tmp/Win2003.before
    eb1e1ff29208a9ee46e9c100dfec26b2  /tmp/Win2012.after
    eb1e1ff29208a9ee46e9c100dfec26b2  /tmp/Win2012.before
    d060a95d7ffe5dce6c4e66feb80c2837  /tmp/Win7x32.after
    d060a95d7ffe5dce6c4e66feb80c2837  /tmp/Win7x32.before
    8914eee70ac4f8a0317659e09e00dcdc  /tmp/Win7x32Dynamic.after
    8914eee70ac4f8a0317659e09e00dcdc  /tmp/Win7x32Dynamic.before
    a2dcdfc0f9d64054640875aa791889e0  /tmp/Win7x32TwoDisks.after
    a2dcdfc0f9d64054640875aa791889e0  /tmp/Win7x32TwoDisks.before
    5ed49568a5147dce7517c99de41ebf2e  /tmp/Win8previewx64.after
    5ed49568a5147dce7517c99de41ebf2e  /tmp/Win8previewx64.before
    fdfc7d272b79a665ae3313ae1ae30660  /tmp/WinXP.after
    fdfc7d272b79a665ae3313ae1ae30660  /tmp/WinXP.before
    3c705444be664f1316b21c5d8d3cb0be  /tmp/WinXPRecConsole.after
    3c705444be664f1316b21c5d8d3cb0be  /tmp/WinXPRecConsole.before

commit 288cc74d77fd80e40a442344d9d0ce00162c1fb4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 29 13:01:53 2012 +0100

    New API: guestfs_hivex_value_utf8
    
    A convenience function that reads a value from the registry
    and returns it as UTF-8.

commit 8a723ca62eb4f93f19c5c66beffaf70997afb64c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 28 16:03:50 2012 +0100

    New APIs: hivex_*
    
    Transscribe many hivex(3) APIs into the libguestfs API.
    
    There is one hive handle per libguestfs handle, as with Augeas.
    
    Note that hivex uses iconv_open for some APIs (eg. hivex_value_string).
    But since we delete all the i18n files from the appliance, this
    doesn't work -- iconv_open returns EINVAL.  Therefore hivex APIs which
    require iconv cannot be bound in the daemon.

commit 228d49bb842cda517b414bbfab460e8be429cc5f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 28 19:11:39 2012 +0100

    lib: Remove AUGEAS_CFLAGS, AUGEAS_LIBS.
    
    The library doesn't actually use libaugeas, except indirectly via the
    libguestfs API.  The libguestfs API implements this in the daemon, so
    there's no need for the library to link to augeas at all.

commit 044c5b26d7ed1bde70cbeacb0ffa3f8bcb932092
Author: Olaf Hering <olaf@aepfle.de>
Date:   Wed Aug 29 15:15:12 2012 +0200

    remove ulockmgr from fuse LDFLAGS
    
    libguestfs fails to build with --enable-fuse on openSuSE 11.4 and
    earlier because the included fuse version does not include
    libulockmgr.so. configure already used pkgconfig to retrieve the correct
    CFLAGS, so there is no need to hardcode -lulockmgr.
    With this change the build succeeds again.
    
    Signed-off-by: Olaf Hering <olaf@aepfle.de>

commit 684efb3706795bdd8cb0d4c026067fb4d70e23d1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 29 14:15:39 2012 +0100

    java: Further java/java-home fixes.
    
    In particular the JVM executable is now called $JAVA_EXE.
    
    This fixes commit 40b9c14ca9af3b31ea1cf5336142d63313bbae39.

commit 15cd9dde5e0e4a7d510de71ef8991750971cf6d1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 29 10:31:09 2012 +0100

    perl: bindtests: Fix 64 bit integers on input on 32 bit Perl interpreter.

commit 40b9c14ca9af3b31ea1cf5336142d63313bbae39
Author: Wulf C. Krueger <philantrop@exherbo.org>
Date:   Tue Aug 28 18:02:19 2012 +0200

    Fix Java detection and rename --with-java-home to --with-java.
    
    Without this patch, if JAVAC points to a valid executable, --with-java-home=no
    is not respected but the build simply fails.
    Furthermore, --with{,out}-java is a more common form and more in-line with all
    other options.

commit 9ef36632ca76ea11b5227e977a9fb9db3fad0d01
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 28 17:48:19 2012 +0100

    launch: libvirt: Don't crash if shutdown_libvirt is called early in launch.
    
    The assert (conn != NULL) was being triggered with this
    stack trace:
    
        at launch-libvirt.c:1305
        fd=<optimized out>, error_if_eof=error_if_eof@entry=0) at proto.c:222
        size_rtn=size_rtn@entry=0x7fffffffdb34,
        buf_rtn=buf_rtn@entry=0x7fffffffdb58) at proto.c:548
        libvirt_uri=<optimized out>) at launch-libvirt.c:391

commit cab48ce73cb19b1aa8784e6c6a3cb8f47b0cbc0e
Author: Wulf C. Krueger <philantrop@exherbo.org>
Date:   Mon Aug 27 20:28:48 2012 +0200

    Fix disabling the Perl bindings.
    
    --disable-perl isn't currently respected because $PERL correctly points
    to the perl executable and $missing_perl_modules doesn't prevent the
    perl parts to be installed either. Thus, a check for $enable_perl is
    needed.

commit 81709b5b70f0a3388ba7df80072756855bceaa81
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 28 11:15:13 2012 +0100

    Version 1.19.34.

commit 512f21c965c5d4bf1faf922d6a241c397f703e67
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 28 12:56:38 2012 +0100

    po-docs: Copy all *.1 and *.3 files to the install dir.

commit 67a803e1f28ef0ba7549ef71cd5a094dabf962a7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 28 13:16:51 2012 +0100

    po-docs: Update the list of man pages.

commit ddc67d94f37ca4e942cb385d4e5ec476766fef12
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 28 13:15:29 2012 +0100

    po-docs: Fix podwrapper so it works on translated POD files.
    
    These don't contain literal strings like "AUTHORS" (they have the
    translated versions instead) and so checking for these English strings
    is rather useless.
    
    Also we don't usually have the '--license' parameter conveniently
    around so don't enforce this section.

commit 540fbfcf34089e2baeea9c94a850cdea0c0db903
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 28 12:55:01 2012 +0100

    po-docs: Don't output translated virt-sysprep page as HTML.

commit 23b7fe09e1589c3c9ca5f52a9588ad1c73649b14
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 28 12:45:58 2012 +0100

    tools: Fix podwrapper errors in tools directory.
    
    This also makes the test for license "code" less strict, so it should
    only match POD, not Perl comments.
    
    This fixes commit 2f97bf873b64384835f257f8916bf1ebb2af62b4.

commit 0a275bd090850963f331a115a4fadfbf1dfb1caf
Author: Masami HIRATA <msmhrt@gmail.com>
Date:   Sun Aug 26 19:32:04 2012 +0900

    Mac OS X: Fixed combination of running autogen.sh on Linux and building on Mac OS X
    
    Signed-off-by: Masami HIRATA <msmhrt@gmail.com>

commit d555a68ca6475bbb6f7f60ae1bdcdffa99df351f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 28 04:46:04 2012 -0400

    podwrapper: Ignore $parser->html_charset if it fails (thanks Wulf C. Krueger).
    
    This method was added in Pod::Simple 3.16 so earlier versions of Perl
    won't have it.  It's not the end of the world if we don't set it.

commit f23a5c468e959f86df89e2a4e8aa9160eca532f8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 28 04:00:52 2012 -0400

    Modified API: mkswap now takes optional arguments.
    
    Add optional label and uuid arguments, and deprecate mkswap-L and
    mkswap-U.
    
    This also adds a call to udev_settle after creating the swap device.
    This is an attempt to workaround the following problem seen in Koji
    and Rawhide:
    
    libguestfs: trace: mkswap_L "swapit" "/dev/sda1"
    libguestfs: send_to_daemon: 72 bytes: 00 00 00 44 | 20 00 f5 f5 | 00 00 00 04 | 00 00 00 83 | 00 00 00 00 | ...
    guestfsd: main_loop: proc 210 (part_disk) took 2.28 seconds
    guestfsd: main_loop: new request, len 0x44
    mkswap -f -L swapit /dev/sda1
    libguestfs: recv_from_daemon: 40 bytes: 20 00 f5 f5 | 00 00 00 04 | 00 00 00 83 | 00 00 00 01 | 00 12 37 cf | ...
    libguestfs: trace: mkswap_L = 0
    libguestfs: trace: swapon_label "swapit"
    libguestfs: send_to_daemon: 56 bytes: 00 00 00 34 | 20 00 f5 f5 | 00 00 00 04 | 00 00 00 ae | 00 00 00 00 | ...
    guestfsd: main_loop: proc 131 (mkswap_L) took 0.77 seconds
    guestfsd: main_loop: new request, len 0x34
    swapon -L swapit
    swapon: cannot find the device for swapit
    guestfsd: error: swapit: swapon: cannot find the device for swapit
    libguestfs: recv_from_daemon: 100 bytes: 20 00 f5 f5 | 00 00 00 04 | 00 00 00 ae | 00 00 00 01 | 00 12 37 d0 | ...
    libguestfs: trace: swapon_label = -1 (error)
    swapon_label: swapit: swapon: cannot find the device for swapit
    test_swapon_label_0 FAILED

commit c2ac512f12cc87d27d04f69cb70b2c5e4c4a9bc5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 25 17:28:37 2012 -0400

    docs: Revise README file.

commit 670e4f7f1286f8a6872b3731eb6120f3d48e9dfe
Author: Masami HIRATA <msmhrt@gmail.com>
Date:   Sat Aug 25 22:31:29 2012 +0900

    python: Fixed syntax errors in python/guestfs-py.c
    
    Signed-off-by: Masami HIRATA <msmhrt@gmail.com>

commit c638e1f03d2700560fe32c0889224ac29bd52334
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 21 22:02:21 2012 +0100

    docs: Use man page name as default title in HTML output.

commit 52a60349abda50edc6ff0b1bd61225a55c3dd93d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 21 21:12:47 2012 +0100

    release-notes: Add more visible separation between sections in the source file.

commit 20ba04d83e2acea96d729eac1133df009f10f7df
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 21 20:16:07 2012 +0100

    Update release notes.

commit 2f97bf873b64384835f257f8916bf1ebb2af62b4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 21 20:11:52 2012 +0100

    podwrapper: Add --license parameter, which is required.
    
    This adds standard LICENSE and BUGS sections to all of the man pages
    that are processed by podwrapper.
    
    Modify all the calls to $(PODWRAPPER) to add the right --license
    parameter according to the content.  Note that this relaxes the
    license on some code example pages, making them effectively BSD-style
    licensed.

commit f1d98bbc79496947210ee0305f80440ed8557ec1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 21 20:13:47 2012 +0100

    man pages: Ensure consistent copyright/author sections, remove license
    section.
    
    Ensure each man page contains consistent COPYRIGHT and AUTHOR
    sections.
    
    Remove the LICENSE section.  We will add that back in podwrapper in a
    later commit.

commit e89e180d2b1ee7c3a452a327a336dd3facd2a51f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 21 20:11:15 2012 +0100

    podwrapper: Ensure the input file is printed in some error messages.

commit e1e8b3a1cfdeee34fbd51f79b8724c5a58f25c10
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 21 17:44:42 2012 +0100

    docs: Document null disks.
    
    It's always been possible to use /dev/null as a disk image.
    Document this formally in the API.

commit e3bb1f7c927a9c34195e51c5810606227dc70e3f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 21 16:40:57 2012 +0100

    launch: libvirt: Always create /var/run/libguestfs.
    
    This directory won't necessarily exist (esp. if /var/run is
    really /run).  So create it each time.

commit dcd35cb55c4ee8a9144c05811f51ac32fc0c7c6d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 21 13:56:18 2012 +0100

    Version 1.19.33.

commit 984044043dc423687862fe2058b43786ab4acf1a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 21 13:21:55 2012 +0100

    FAQ: Re-add #backup anchor for section on backups.

commit 52e38c7bdc293cb2f2531eab3dde6d569a05b5e9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 21 13:19:33 2012 +0100

    recipes: Update dumping filesystem content to mention that we now support MD/RAID.

commit 1e4c6e36a6d122b4615dc509ef745dde7e37321d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 21 13:16:18 2012 +0100

    recipes: Refer to virt-format, virt-make-fs for creating disk images.

commit 5f234548ed07b8e41a31462290aae3ea842630c2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 21 13:10:13 2012 +0100

    recipes: Cloning Windows: plans for virt-sysprep.

commit 9fd4d16819ad200814be717732c77664e18132f2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 21 13:09:53 2012 +0100

    recipes: For auditing for setuid files, point to virt-ls examples.

commit 0d2e70b1c71dba01f71a4375eb10b83059a41bb2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 21 12:56:22 2012 +0100

    recipes: For sparsifying guests, point to virt-sparsify.

commit d944a491ac3aa9b9ed1bcdc0ee378519a367276a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 21 12:56:10 2012 +0100

    recipes: For listing files, point to virt-ls.

commit ad6870102fc2c36b5b0949d10b3d2ad8847c4024
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 21 12:55:59 2012 +0100

    recipes: Mention virt-sysprep firstboot feature.

commit 87cf749cde7b9ecdfd95d0b4cac939a2be767fd7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 21 12:55:46 2012 +0100

    recipes: Most guests now use grub2, so change the example.

commit 10d48bef3055e1b7177b4f8df52133c50484a87a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 21 12:55:25 2012 +0100

    recipes: Add a section on deleting a file and other common file operations.

commit 1454751b731ff3a448cc5b5b46f4cbc1fc2f66d0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 21 12:55:09 2012 +0100

    recipes: Update cloning section.

commit 9f59d1162537b296ce3790fa06e8571086ab0828
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 21 12:24:05 2012 +0100

    launch: libvirt: Minimum libvirt version is now 0.10.0.

commit faf548a4bdd36b476ee6838bfc7d0c134435a331
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Mon Aug 20 16:17:01 2012 +0800

    xfs_growfs: drop the unstructed output
    
    Just drop the unstructed output since we can get the structed info
    from xfs_info instead.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 11b78a710729c34c1ef921feb119569b7d580877
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Mon Aug 20 16:17:00 2012 +0800

    New API: xfs: xfs_admin
    
    Add new api xfs_admin to change parameters of an XFS filesystem.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>
    
    RWMJ:
     - Remove printuuid, printlabel, since they don't change any settings.
     - Adjusted the documentation.
     - Fix the tests.

commit 5e6727746367ba3f935dccb80109abf8e34fe74d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 20 16:46:09 2012 +0100

    run: Disable 'memory optimizations' in glib programs, for valgrind (thanks Dan Berrange).

commit cd1627e8041ffa06764ef82b984f4291660edcc9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 18 22:27:17 2012 +0100

    FAQ: virt-sparsify and raw sparse output.

commit d67e6ea75dde6309ce4c6162a4a0429ab8d6709b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 18 22:08:29 2012 +0100

    Replace mount-options with mount where appropriate.
    
    Since our minimum supported version is now 1.16 and mount was fixed in
    1.13.16, it is now safe to replace mount-options + empty options with
    mount wherever it occurs.

commit 781d72f55897b1ed923c795a0132241f53f6c6eb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 18 13:09:27 2012 +0100

    Update API support.

commit 64098f18d0815462ee31e2aee4d9e41a941a990b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 18 12:09:47 2012 +0100

    Version 1.19.32.

commit 8f3c0fd98d30cff1697dbe512432cd873f1af61d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 16 14:49:58 2012 +0100

    sysprep: docs: virt-sysprep can now be used to customize a guest.

commit 99cfc1f36ea88255a2b9497e983d57c1700dcc4c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 16 14:48:54 2012 +0100

    sysprep: Add --firstboot functionality.
    
    This allows you to add scripts that run in the context of
    the guest the first time it boots.

commit 99759da25c29a7376490074da3d2c22602a2acec
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 17 17:28:25 2012 +0100

    docs: Rewrite section on protocol limits again.
    
    This updates commit 92e241440d361e9491a9d96d23ad7a378cb2ab6a.

commit 92e241440d361e9491a9d96d23ad7a378cb2ab6a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 17 10:32:08 2012 +0100

    docs: Update documentation to reflect no 2/4 MB protocol limits.

commit d6e1d82267d935f0635d3374e93bdb676701baa7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 17 15:50:36 2012 +0100

    todo: Suggest full mke2fs API call.

commit 92a0ac50371d038d53a8aa9a8c8fd0b6ef57e88b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 17 14:31:39 2012 +0100

    tests: Add a test for large directories.
    
    This also tests the reimplemented APIs:
     - ls
     - lstatlist
     - lxattrlist
     - readlinklist

commit 07eb7021638140c4dfc2b5b99bbb4c129d21e03f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 17 15:50:51 2012 +0100

    New API: fill-dir: Fill a directory with files (for testing).

commit 6952505694bfd8dda20e4e18b5f8b76b97db82a4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 17 14:21:34 2012 +0100

    guestfs_readdir: Note that this suffers from protocol limits.

commit a69f44f56f20beab7793be428df22104f79500e7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 17 14:11:21 2012 +0100

    guestfs_ls: Reimplement to avoid protocol limits.

commit 1b4d8e2cca7819b4c6e14bb052f40a9fc40205d3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 17 13:57:37 2012 +0100

    New API: ls0 - List files, separated by \0 characters.
    
    This API is not especially useful on its own.  It will be used to
    reimplement guestfs_ls to work without protocol limits.

commit 8ee51907685d6db92031e84d249ea3bb4cdc2d67
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 17 13:10:53 2012 +0100

    guestfs_readlinklist: Reimplement to avoid protocol limits.

commit dc66dd32c214db99467341caea0be517d2dd736f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 17 12:21:37 2012 +0100

    guestfs_lstatlist, guestfs_lxattrlist: Reimplement to avoid protocol limits.
    
    Note that the code to do this was already in virt-ls, so this is
    change is mostly just moving the code into the core library.

commit 118932fbeac606919f8b96c81184f4f3e0910508
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 17 11:47:49 2012 +0100

    guestfs_write, guestfs_write_append: Reimplement to avoid protocol limits.
    
    Note that we keep the old daemon calls, but rename them as
    "internal_write" and "internal_write_append".  This lets us implement
    the new library-side calls more efficiently in the common case when
    the uploaded content is smaller than the message buffer.  In most
    cases the new calls won't end up using a temporary file.

commit 735ce57cda24e2e2f41418d9a9ad34944fefdfb9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 17 11:07:33 2012 +0100

    guestfs_read_lines: Reimplement to avoid protocol limits.
    
    This also makes a larger test suite for this command.

commit 96d3ac28d636290e9478ac27226862e627682025
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 17 10:36:23 2012 +0100

    guestfs_read_file: Reimplement to avoid protocol limits.

commit 9d85eba3c3c169478d1edf0dd7ef9495d4be19ce
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 17 09:47:29 2012 +0100

    guestfs_find: Reimplement to avoid protocol limits.
    
    This also reimplements the virt-ls -R option to use the replacement
    guestfs_find API, which is simpler (though actually less efficient).

commit 294bee38bcdd38542bf26292365ac27aebb06642
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 17 08:15:31 2012 +0100

    guestfs_cat: Reimplement to avoid protocol limits.

commit 50d904c0181d1e714938cc5c702616f5a79c0bd2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 17 12:32:34 2012 +0100

    generator: Fix error message in checks of proc_nr.

commit 0f33a1d90c65f31444e14aef27d489706230939f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 16 12:58:49 2012 +0100

    sysprep: Improve error messages.

commit 6f5447abe34dcddefa0885b006e65419fe84717a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 16 18:20:57 2012 +0100

    Update TODO.

commit e9ef74ebc2c745707660ef3035a2710629fef157
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 15 17:57:40 2012 +0100

    Version 1.19.31.

commit 856e78a2ce025563de5d9e8c416edf054b0db563
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 15 17:39:39 2012 +0100

    subdir-rules.mk: Remove rules that recursively build src/ and daemon/.
    
    These are unnecessary, and slow down the whole build.

commit cc25afcc35ed69ca1c005a1396578675437450e6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 15 17:04:13 2012 +0100

    gobject: Disable bindtests.
    
    - gint64 cannot be reliably sent.  It seems to try to convert it
      via a 32 bit int, and fails if it overflows.
    
    - OStringList is not implemented yet.

commit 5abd7bfc4cd8411efb8c3ad30e8a2b2610a7a1be
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 15 15:44:18 2012 +0100

    launch: For /dev/null drives, create a temporary disk.
    
    This is a workaround for a bug with virtio-scsi in qemu 1.2:
    https://bugzilla.redhat.com/show_bug.cgi?id=847549

commit 7f9f2818651860a15a7142d3761e3168e062c357
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 15 16:08:19 2012 +0100

    test-launch-race: Use /dev/null instead of hand-made zero-length file.
    
    There seems to be no reason why creating a zero-length
    file is necessary for this test.

commit 46cf4a7e875b828c7a97bd85f577721bce386bc3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 15 15:43:30 2012 +0100

    launch: Move code to add a drive to the list to separate add_drive utility function.
    
    This is just code motion / simplification.

commit 4b8ac437295d5420d3186a913bc3740b69a8d342
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 15 15:41:42 2012 +0100

    launch: Add utility function guestfs___lazy_make_tmpdir.
    
    This lets us create g->tmpdir lazily earlier if needed.
    
    This commit is just code motion.

commit 22607a97cdf115caabf05c3dc87c5f154a2e914c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 15 15:41:05 2012 +0100

    lib: Add 'g->unique' to handle, for making unique IDs.

commit 8fd6f1bebef11d1c4eb77ac2b7d95fd5a7e82be9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 15 15:40:29 2012 +0100

    inspect: Clarify comment about uniqueness of cache.

commit ba61236d0d6756f45d8707e96cda00c016cadebe
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 15 15:01:01 2012 +0100

    close: Check if g->tmpdir is non-NULL before removing tmpdir.
    
    This happens, by chance, to work.

commit 16f22d89eb142f1485fc28afaa89026cf8c956d9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 15 14:44:37 2012 +0100

    bindtests: Test sending min and max 64 bit integers.

commit 704e46af9c054fe3571884989c992dfd7d8284e5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 15 14:50:29 2012 +0100

    java: Fix bindtests when passing 64 bit integer literals.

commit 9526f632d80f8d66ecf8a7da5444e1446129fceb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 15 14:49:01 2012 +0100

    ocaml: Fix bindtests when passing negative optional arguments.

commit f6de298d0498d5672d05da839021a41277df8e09
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 15 14:10:38 2012 +0100

    erlang: Add tests.
    
    Add bindtests and general tests for Erlang.

commit bd35b3c055cb4a1bda041faede018dd7d4cfc1ba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 15 14:38:15 2012 +0100

    erlang: Fix 64 bit integers in parameters.

commit e3f356bda1d249a65f5606d5e4729ba6f7e56189
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 15 14:08:43 2012 +0100

    erlang: Fix BufferIn parameters.
    
    These would break if the buffer contained a \0 character.

commit fad0f53dc8a21b61dc5ff011d836f5fd5fdab0c3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 15 14:07:35 2012 +0100

    New internal APIs: internal-test-set-output, internal-test-close-output.
    
    These internal (testing) APIs allow the bindtests output to
    be sent to some other place than stdout.
    
    This is necessary for Erlang, since stdout is used to communicate with
    the Erlang interpreter.

commit 7dd2389359d190e81696f1b2e91e719bdc1822f2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 15 14:05:36 2012 +0100

    python: Fix comment referring to Perl(!)

commit 449bd4b50ff8ecd9128439a39a74ca731a17aa1f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 15 13:01:19 2012 +0100

    generator: Allow permission of output files to be specified.

commit 3234a1f903bb77c66252b38425a4c913f8e7bb8c
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Tue Aug 14 21:52:02 2012 +0200

    Even on Debian, the package containing the diff binary it has been diffutils for two years.
    
    There had been a virtual package "diff" that depended on diffutils, but that's gone in wheezy/sid, too.

commit 42e8c093b74ac578ef75c6f3aefdbea7f46478e1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 15 12:14:39 2012 +0100

    python: Fix optargs so we don't use special sentinel values.
    
    Previously with Python it was impossible to set a boolean or integer
    optarg to -1 because that was used as a special sentinel value to
    indicate that the optarg was not set.
    
    Instead, use None as the sentinel value, since that cannot be a
    boolean or integer type.

commit e990e80c266db84e5c9e4198e44307958a9cd19c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 15 12:14:06 2012 +0100

    python: Before freeing OStringList, cast it to char ** to avoid a compiler warning.
    
    This fixes commit c1a269513c05b44af0ed6e6b7b48f5dd11e01060.

commit 94f133f25bce7e9d354ea4d31c96b5635900d292
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 14 18:21:05 2012 +0100

    Remove unnecessary comment from <guestfs.h>.
    
    Read guestfs(3) for documentation, and don't discourage people from
    doing that by putting these comments into the header file.

commit 5ea795aa488df9becaab3a55a57cd4fb46cb34d4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 14 18:17:40 2012 +0100

    docs: Fix '= head' -> '=head' in back compat entries in guestfs(3).

commit f5208ab8656a402e8de43780f9155056b45ce11f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 14 17:51:24 2012 +0100

    Version 1.19.30.

commit ce35eb90a2c3b745295e38abdaf17a645f1df9ee
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 14 13:58:49 2012 +0100

    tar-out: Add list of excluded patterns (--exclude=...) (RHBZ#847881).

commit c1a269513c05b44af0ed6e6b7b48f5dd11e01060
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 14 13:56:07 2012 +0100

    generator: Add new OStringList optional arg type.
    
    This allows lists of strings to be passed as an optional argument.

commit 637b06ab1384f0c904715ba76fc759dac1b95500
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 14 13:55:00 2012 +0100

    daemon: New utility functions 'join_strings', 'concat_strings'.
    
    Useful functions for concatenating strings together.

commit 690bdaa3927e56d33e241752eef37f887274d73b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 14 11:14:10 2012 +0100

    bindtests: Space before parens in call.

commit d23293db7e69f7c9501ebab2cede0b7cb48c595a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 14 10:01:40 2012 +0100

    todo: Suggestion: Add sh-in, sh-out, debug sh-in, debug sh-out.

commit 4dbae7cc06544fc1e9b622826f613bec84ec6d11
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 14 09:54:31 2012 +0100

    tar-out: Add optional numericowner flag (RHBZ#847880).
    
    This is equivalent to the tar option --numeric-owner.

commit 864ef706a84c7c87a62f776d4b2e82a6f959ae14
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 14 09:04:51 2012 +0100

    Add optional compress flag to tar-in, tar-out APIs.
    
    The compress flag can be used to control compression, one of: (none),
    "compress", "gzip", "bzip2", "xz", "lzop".  Thus these calls can now
    be used instead of tgz-in/tgz-out/txz-in/txz-out, and also support
    more compression types.
    
    Mark these APIs as once_had_no_optargs so that compatibility code is
    generated.

commit 84c897c93a794e4bdab37dfd505618de68bf145d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 13 13:51:29 2012 +0100

    docs: Add a section describing how to use gdb + qemu wrappers to debug the appliance.

commit 22da2cb0ae45c1c50e7ba5618f9944a3d417ec7e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Aug 12 22:51:45 2012 +0100

    docs: Show how to use 'annotate-output' command to collect timings.

commit 769a6f24c60e7a4d55560025554796ba4be19d03
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Aug 12 17:01:44 2012 +0100

    ocaml: Use Store_field macro instead of caml_modify.
    
    Use the safer, higher level Store_field macro when constructing arrays
    of structs to return.
    
    I don't know if it is strictly necessary in this case, but it's safer.

commit 2c046c0d6fb2faccc2b2d5596d0af1c8d043eb76
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 11 20:52:28 2012 +0100

    virt-make-fs: Don't display output of 'qemu-img' except on error path.

commit 2295b09f259ece053f1370f7527d01705976732a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 11 20:51:28 2012 +0100

    virt-make-fs: Remove note about vfat and ownership of tarball files.
    
    This problem has been fixed in
    commit 50780a84f65ec5d76605691cea889392c2730f54.

commit f3b21b4da563faf991f008807df62ea4732747af
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 11 19:08:33 2012 +0100

    Include guestfs-release-notes.txt in the tarball.
    
    This fixes commit 589db4e42ad5e759041521e7673bd7aa2f800736.

commit 32e5bab3ee25d6642dab285b35e2490a74f4f04b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 11 18:35:13 2012 +0100

    tests/9p: Add test to EXTRA_DIST.
    
    This fixes commit 499497fab03716278cb5214a8aa89a35618e06c6.

commit 42d404fa6490790f699505fa0f225e966cec151f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 11 14:18:08 2012 +0100

    Version 1.19.29.

commit 159b1479cc43f22ebcc9e0187efbb8a3eeda1c5d
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Wed Aug 8 17:59:39 2012 +0800

    sysprep: remove the process accounting log files
    
    We just remove the process accounting files previously without
    touch a empty file, this will cause psacct runs error.
    Restart the service can't help us create this file auto.
    
    couldn't open file '/var/account/pacct': No such file or directory
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 9fab546206e0102daac01f835bc546117342f4c7
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Mon Aug 6 16:23:20 2012 +0800

    xfs: fix a possible memory leak
    
    free out when failure.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit b93d004c7ce3bd6c3ae331d57289b02f9ce01af9
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Mon Aug 6 09:17:48 2012 +0800

    Fix typo in release notes.
    
    Fix typo.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 589db4e42ad5e759041521e7673bd7aa2f800736
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 4 19:24:30 2012 +0100

    Convert release notes to a POD file / man page.
    
    Note that we add the text version to git so that it's available for
    people to read without requiring any special tools.

commit 198cc630f0634fa318c6943f8de6706951701250
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 4 14:37:46 2012 +0100

    New APIs: rsync, rsync-in, rsync-out
    
    Implement rsync.

commit a05623cd71fe4f179c9fd61a1a3e327c35290e56
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 4 14:36:55 2012 +0100

    fish: Add --network option.
    
    This enables the libguestfs user network, and is the equivalent of the
    'virt-rescue --network' option.

commit 7d6f76709e71b38e0bc4f018c4d873a32ffe19da
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 10 21:37:46 2012 +0100

    generator: 'delete' is a reserved word (in C++).

commit 04b475b41476b75ef3851fdd093a9868df0c7357
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 11 07:47:25 2012 +0100

    tests/extra: Add workaround for memory leak in libvirt.
    
    See: https://bugzilla.redhat.com/show_bug.cgi?id=847429

commit 1fe6f1f7bbc454472b02d94927d3b4da2814ad53
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 4 17:24:20 2012 +0100

    Update release notes for libguestfs 1.20.

commit 47410e79995f9d8c5fb9739ca4609c78e13218ee
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 4 11:45:15 2012 +0100

    appliance: Add rsync and openssh-client{,s} to the appliance.
    
    This adds ~10M to the appliance (328M -> 338M).
    
    However for virt-rescue these are frequently requested tools.

commit 87602b09ead198bd84c0dac83fde2d1c3dfe55bd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 3 22:38:41 2012 +0100

    fuse: guestmount doesn't let you pass '-- [FUSE options]'.
    
    I don't think it ever did, so the --help text was always
    wrong, and definitely didn't match the real behaviour of
    the program.

commit 083125f709c8ca6ec56abf99df918e70376a99bd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 3 15:38:10 2012 +0100

    ruby: Mark all VALUEs as volatile.

commit 2a87261dfc830cd6bcb44aa1628d955cb6423bd7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 3 12:54:18 2012 +0100

    fish: Fix 'copy-out /' (RHBZ#845522).

commit 7fa67427c6b2725bdcce52c08511f8813b7bd42e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 3 11:53:44 2012 +0100

    Document problems copying long filenames from NTFS to Linux filesystems (RHBZ#845488).

commit 1394d4a69be2ec65ed0b34e34f7a2aee816070fc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 2 17:35:32 2012 +0100

    Version 1.19.28.

commit 863168467f14e33407c4bf9c7f790bcd4911aea3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 2 17:21:47 2012 +0100

    examples: Use add_drive_opts function in examples.
    
    In libguestfs 1.20, you will be able to use 'add_drive'
    instead of 'add_drive_opts' (except in the C bindings).
    
    However until libguestfs 1.20 is the minimum stable version
    people will still be using old versions where you have to use
    'add_drive_opts'.  This makes the examples confusing.
    
    Therefore continue to use 'add_drive_opts' in the examples
    for now.

commit b3d0cc0588845d3cad3fd67943d93e1bd87b1700
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 2 14:05:54 2012 +0100

    grep: Add optargs to grep API and deprecate fgrep etc.
    
    This commit makes grep into an optargs API, with flags for extended,
    fixed, [case-]insensitive and compressed.
    
    At the same time it deprecates: egrep, fgrep, grepi, egrepi, fgrepi,
    zgrep, zegrep, zfgrep, zgrepi, zegrepi and zfgrepi.

commit d40b5028762eeaf9235165301bd76d468b7e251c
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Wed Aug 1 17:02:07 2012 +0800

    xfs: add new api xfs-growfs
    
    New api xfs_growfs for expanding a XFS filesystem.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 9b9c3721146b734fb71721875d80e5f2db1b7b7b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 1 18:44:19 2012 +0100

    Revert "appliance: Add '-drive detect-zero=on' flag if qemu supports it."
    
    This reverts commit fe2253088ff51b51e2586f27a9408a38655170e3.

commit 981c7b731048af39e00181da70bd5fc17d3e04be
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 31 22:55:58 2012 +0100

    Reviewed and revised TODO file.

commit 4efa0f8f38b1d0d35c34b8a05168c06a312e9823
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 31 13:41:51 2012 +0100

    m4: Sort .gitignore with LANG=C.  Also add pipe2.m4 (used by RHEL 6).

commit f21b866f3141bb85ebf93ccf0c906ab0b73960f9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 31 13:21:42 2012 +0100

    build: On x86 search for qemu-system-i386 not qemu-system-i686.
    
    host_cpu can be set to i686.  The qemu binary is called
    qemu-system-i386.  Apply some sed to fix this.

commit 06780a92b3e4ea14c09a169cc1d22c1371621fc3
Author: Eric Blake <eblake@redhat.com>
Date:   Tue Jul 31 13:14:28 2012 +0100

    build: Allow building with new glibc headers and -O0.
    
    This is a patch taken from libvirt.  See:
    
    http://libvirt.org/git/?p=libvirt.git;a=commitdiff;h=2af63b1c349

commit 499497fab03716278cb5214a8aa89a35618e06c6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 30 23:17:49 2012 +0100

    9p: Add a regression test for 9p functionality in qemu.

commit 77326fa4ad757bb255a3c3a07bef8c3ce050a5ac
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 30 23:33:40 2012 +0100

    appliance: Exclude kernel* packages explicitly.
    
    febootstrap >= 3.19 will no longer exclude the kernel package
    by default.

commit 54db02b60a9b588b5eeda588816a31a998fb0b6f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 30 19:27:09 2012 +0100

    Version 1.19.27.

commit 7b2f6bd665bac3890b64eccc77e010e6bf84bda7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 30 17:32:10 2012 +0100

    libguestfs-make-fixed-appliance: Don't reference obsolete development version.

commit b075b4d1feaaaa83272a8821828d9c7ce8843686
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 30 15:16:45 2012 +0100

    New API: utsname
    
    Typical output:
    
    ><fs> utsname
    uts_sysname: Linux
    uts_release: 3.5.0-1.fc18.x86_64
    uts_version: #1 SMP Mon Jul 23 17:43:39 UTC 2012
    uts_machine: x86_64

commit b61a8a50bc8d481df32f929046abf09383c8380e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 28 21:28:23 2012 +0100

    sysprep: Describe more directly how to use qemu-img for snapshotting.

commit dcc0ebc8e0c4a8abd505421a584573272a03f7aa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 26 22:00:07 2012 +0100

    tests: Consistent use of $(top_builddir)/run --test when building test guests.

commit 590774ed9e005dc85ca6851939e76d02da6624c8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 26 21:56:37 2012 +0100

    build: Use $(top_builddir)/run in Makefile.am's.
    
    Not necessary, but this makes all invocations of 'run' consistent.
    There is no functional change.

commit 96d34d883f309ede4c889e852cef68dc5c9e45b9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 26 19:01:28 2012 +0100

    Version 1.19.26.

commit fe2253088ff51b51e2586f27a9408a38655170e3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 26 18:25:06 2012 +0100

    appliance: Add '-drive detect-zero=on' flag if qemu supports it.
    
    NB: The patch to implement this feature in qemu is not upstream, and
    may never make it upstream.  However this is so useful for
    virt-sparsify that I decided to add this to libguestfs while we see
    what qemu decides to do.

commit 0f837ec068783a6318ba6f7490b567566bce2aa4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 26 11:13:39 2012 +0100

    ruby: Allow optional arguments hash to be really optional.
    
    Allow optargs functions to be called as either:
    
      g.mkfs_opts(fs, device)
    
    or:
    
      g.mkfs_opts(fs, device, { optargs hash })
    
    This also preserves backwards compatibility with once_has_no_optargs
    functions such as mkfs.

commit 5f30912d74a553399d2bda055560d4340a15088d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 25 23:38:37 2012 +0100

    ruby: In event wrapper, ignore callback functions which have type T_ZOMBIE.
    
    Note that in old versions of Ruby, T_ZOMBIE was not defined.

commit 7b84b496031fb207cb00c8f314aeb06544a1d7b5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 25 22:56:54 2012 +0100

    ruby: Set LD_LIBRARY_PATH for Ruby libs in run script.
    
    This lets you use './run gdb ruby ...' and get accurate
    debugging information.

commit 208d1c1a09e9d7cbc27207ea7ff1c84ff1f64fbd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 25 16:50:40 2012 +0100

    sparsify: Detect qemu-img version and use qcow2 v3 for overlay if available.
    
    qcow2 v3 is generally more efficient, although unfortunately it
    doesn't support automatically sparsifying zero writes.
    
    Note this *only* uses qcow2 v3 for the intermediate overlay file, not
    for the final output (since we want the output to be broadly
    compatible with old hypervisors).

commit 0b3b5f984c2011632c6d56e5f0ae1194d2c5074b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 25 16:28:12 2012 +0100

    sparsify: Change code that generates qemu-img -o argument.
    
    This is just code motion.

commit 42bf3274e471cdef6a3b89b3f5918040b95a0fb5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 25 10:49:20 2012 +0100

    sysprep: Generate new random UUIDs for LVM2 PVs and VGs (thanks Kazuo Moriwaka).

commit e64bf3fb2945e552d74bde43fb2ff4e1180b976b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 25 10:29:58 2012 +0100

    New APIs: pvchange-uuid, pvchange-uuid-all, vgchange-uuid, vgchange-uuid-all.
    
    These APIs will allow sysprep to change the UUIDs of all PVs and VGs
    in the system.
    
    LVs don't have UUIDs AFAICT, or at least there seems to be no way to
    change them if they do have them.

commit 2b59b5f1d2e36b0ef84b7c7c9ab2c4b602f2ad91
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 25 14:17:42 2012 +0100

    sysprep: Change perform callback to perform_on_filesystems and perform_on_devices.
    
    Operations that need to work directly on guest block devices will fail
    because the block devices are busy.  Therefore add a phase with the
    filesystems unmounted, and allow operations to specify that they need
    to work in this phase.

commit 1fb95e65661f19c050b928694f750f2406eff2ac
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Jul 25 14:17:37 2012 +0100

    fish: Use minimal permissions when initially creating history file

commit b7ff02354d6db6b322629ad1d065d56d5ffca3c3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 25 10:15:47 2012 +0100

    sysprep: Tidy up the Makefile.
    
    This is just code motion.

commit 4fa51f11da26280c703bac150a5f9a86fc853f2e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 25 10:09:28 2012 +0100

    sysprep: operation machine-id: return `Created_files.
    
    This operation can create the /etc/machine-id file, so it may need to
    be relabelled by SELinux.
    
    This fixes commit e68336d72a7d71a44d80f0d13c40ff44653e5c01.

commit e68336d72a7d71a44d80f0d13c40ff44653e5c01
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Wed Jul 25 13:56:16 2012 +0800

    sysprep: remove the local machine ID
    
    remove the local machine ID, leave it empty, let it be generated
    during next booting.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>
    
    RWMJ:
     - Whitespace change.
     - Remove completed items from TODO.

commit a121f1d654be3d7ed053b0c3bc1aa16f5285d348
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Wed Jul 25 13:56:15 2012 +0800

    sysprep: remove the auto generated abrt data
    
    remove the automatically generated abrt data.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>
    
    RWMJ:
     - Remove copy and pasted line.
     - Use C<> in description.

commit d74e7fad28ae7a2f894a12d30807f4b36078bf13
Author: Masami HIRATA <msmhrt@gmail.com>
Date:   Tue Jul 24 23:10:49 2012 +0900

    Mac OS X: Use u_int64_t/uint64_t instead of unsigned hyper in .x file
    
    Signed-off-by: Masami HIRATA <msmhrt@gmail.com>
    
    RWMJ:
      Fixed whitespace in generator_xdr.ml

commit 61c9ea496e0579bb7d1bcf496595d66c3f08cfec
Author: Masami HIRATA <msmhrt@gmail.com>
Date:   Tue Jul 24 23:10:48 2012 +0900

    Mac OS X: Use libtool --mode=execute instead of LD_LIBRARY_PATH
    
    because Mac OS X doesn't support LD_LIBRARY_PATH
    
    Signed-off-by: Masami HIRATA <msmhrt@gmail.com>

commit 7d3f190d90140aa15b1326bdf7756c39559ae3c2
Author: Masami HIRATA <msmhrt@gmail.com>
Date:   Tue Jul 24 23:10:47 2012 +0900

    Mac OS X: Use gnulib stat-time module explicitly.
    
    Signed-off-by: Masami HIRATA <msmhrt@gmail.com>

commit a887dd5109e258936c411c6123c7b16d5445a0aa
Author: Masami HIRATA <msmhrt@gmail.com>
Date:   Tue Jul 24 23:10:46 2012 +0900

    lib: Use <sys/socket.h> and <sys/un.h> for sockaddr_un
    
    Signed-off-by: Masami HIRATA <msmhrt@gmail.com>

commit 399887defd2965449a82f29704a0dcc0f3c699b7
Author: Masami HIRATA <msmhrt@gmail.com>
Date:   Tue Jul 24 23:10:45 2012 +0900

    Mac OS X: Use real files for gtk-doc (not the symlink)
    
    Signed-off-by: Masami HIRATA <msmhrt@gmail.com>

commit 9519c60ce565437c91ce23ceb380f3bfe49ec224
Author: Masami HIRATA <msmhrt@gmail.com>
Date:   Tue Jul 24 23:10:44 2012 +0900

    Mac OS X: don't check glibc-style extended printf formatters unless --enable-daemon
    
    Signed-off-by: Masami HIRATA <msmhrt@gmail.com>
    
    RWMJ:
     - Test was in the wrong place (before --enable-daemon had been
       detected) so I moved it later.

commit 7dab20876530a7ac954b4fe809755ac12a8d8c4d
Author: Masami HIRATA <msmhrt@gmail.com>
Date:   Tue Jul 24 23:10:43 2012 +0900

    Mac OS X: #define UNIX_PATH_MAX 104
    
    See http://developer.apple.com/library/mac/documentation/Darwin/Reference/Manpages/man4/unix.4.html
    
    Signed-off-by: Masami HIRATA <msmhrt@gmail.com>

commit 6e3f8d2511a63bdcfa7c7d0e5414d5643c4ff599
Author: Masami HIRATA <msmhrt@gmail.com>
Date:   Tue Jul 24 23:10:42 2012 +0900

    Mac OS X: Added check of #include <endian.h>
    
    Mac OS X doesn't have endian.h
    
    Signed-off-by: Masami HIRATA <msmhrt@gmail.com>

commit a47fa7a65e89d80ba1362b39cb9686e5022b7dce
Author: Masami HIRATA <msmhrt@gmail.com>
Date:   Tue Jul 24 23:10:41 2012 +0900

    Mac OS X: Use gnulib fstatat module explicitly.
    
    Signed-off-by: Masami HIRATA <msmhrt@gmail.com>

commit d6ef91d7c4b6cfbd9e4d49317dc7ed414900c4d2
Author: Masami HIRATA <msmhrt@gmail.com>
Date:   Tue Jul 24 23:10:40 2012 +0900

    Mac OS X: Use gnulib memmem module explicitly.
    
    m4/.gitignore: Update.
    
    Signed-off-by: Masami HIRATA <msmhrt@gmail.com>

commit ef1a8446a659fe3647d755334703a1020a0f88dc
Author: Masami HIRATA <msmhrt@gmail.com>
Date:   Tue Jul 24 23:10:39 2012 +0900

    configure: Use $(PERL) instead of perl
    
    Signed-off-by: Masami HIRATA <msmhrt@gmail.com>

commit 8f3a839aa86c14666ce06a45c8d28026c302f2e9
Author: Masami HIRATA <msmhrt@gmail.com>
Date:   Tue Jul 24 23:10:38 2012 +0900

    configure: Add -nographic command line option to qemu.
    
    Without this option, configure will fail when there is no display.
    
    Signed-off-by: Masami HIRATA <msmhrt@gmail.com>

commit ebe826f23fc71b1a4e8dbd888ce1548ce4192873
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 24 14:48:39 2012 +0100

    Version 1.19.25.

commit 67e1c90605f82dbc878a309e7315d982fc63f30d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 24 14:26:55 2012 +0100

    launch: libvirt: Suppress printing of libvirt errors to stderr and other cleanups.

commit 493e80ab4e7199bdbb44b16535448d65944eca66
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 24 11:13:52 2012 +0100

    launch: libvirt: Use SELinux-mandated directory for sockets (RHBZ#842307).
    
    Note this does not yet enable sVirt confinement of the appliance.
    That requires at least that SELinux policy goes upstream, plus there
    may still be bugs.

commit 97aeaa86d0e311853534de10367e821445cc655d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 24 13:41:43 2012 +0100

    todo: More suggestions for virt-sysprep (thanks Kazuo Moriwaka).

commit 5d0ef099631e84adfca714b9fa28290778b6e3b7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 24 11:13:21 2012 +0100

    launch: libvirt: Move free to end of function.
    
    This is just code motion.

commit 507aa9ac35e2d7d200ee48f0d3d9dfa0f1644ef1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 24 11:12:46 2012 +0100

    launch: libvirt: Add is_blk utility.
    
    This is just code motion.

commit d8b2c1afee4e23ca864727bebc53a04c490715bc
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Tue Jul 24 16:47:23 2012 +0800

    umount: use Dev_or_Path for the argument type
    
    Use Dev_or_Path instead of String.
    
    Remove the RESOLVE_DEVICE since Dev_or_Path will generate
    REQUIRE_ROOT_OR_RESOLVE_DEVICE instead.
    
    RWMJ:
    Note a change in semantics: this now requires root.  However this is
    OK and still works with mkmountpoint and friends because
    'is_root_mounted' works even if something is mounted below the root.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit c03cdcc25ca9b4d2169f5566ea1470758caef812
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 24 10:21:32 2012 +0100

    launch: libvirt: Set <emulator> in libvirt XML if g->qemu is not the default.

commit 40e5317cfb4eb804129e9dd1eda0e5769a394520
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 24 10:16:31 2012 +0100

    xfs-info: Fix description to refer to 'pathordevice' param.

commit f4094b91d2cdb7635c79269f4534f18a153a4828
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Tue Jul 24 16:47:22 2012 +0800

    xfs_info: resolve device when doing xfs_info on a device
    
    Resolve device first, like do_umount.
    Use Dev_or_Path.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit bda974e64cabddde33227a678a984c37cd135f39
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Mon Jul 23 17:51:31 2012 +0800

    umount: add force umount and lazy umount
    
    Add the option force and lazy for force and lazy umount.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 6bdc4b30ead7cefea0b5e0edc876b5e7f4351db9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 23 21:53:55 2012 +0100

    Version 1.19.24.

commit 2b059535b19125ca082f4354a7ff73f4f5a33822
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 23 21:37:59 2012 +0100

    tests: Skip regression test for 790721 if attach-method is not 'appliance'.

commit 941ec968b8a1d6f891d30631a8ddb1e23e427b99
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 23 21:26:18 2012 +0100

    lib: Initialize libvirt and libxml2 once when the library loads.

commit bf00be0e17c03f46075b3276fade7bd23d380557
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 23 19:03:08 2012 +0100

    launch: Make get-pid and max-disks APIs into virtual methods of the current attach-method.

commit 3614d76b37ee8ef90f5a280e1bb51bccd87eaadb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 23 18:56:20 2012 +0100

    tests: Move debug-drives testing API to launch.c and change the output.
    
    It should work with any attach-method.

commit a6366f5dae0e8332cfdad0894aa6e5c7fc3faa2c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 23 20:16:54 2012 +0100

    python: Set file encoding to utf-8.

commit bc917a0efc03b8c28966c9ab474f525752ebe440
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 23 18:43:38 2012 +0100

    tests/protocol: Skip these tests if default attach-method is not 'appliance'.

commit b6afb98a79248997da1b76b946362742dfcd625a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 23 18:21:22 2012 +0100

    tests: Fix get-attach-method test.
    
    If ./configure --with-default-attach-method is set to something other
    than 'appliance', then this will legitimately return a different
    string.  Simply test that it runs, rather than testing the output.
    
    This fixes commit 20a5b4de7ddc4221544784df65eb472481698dcb.

commit c65ee25a756071deedf49f5f0fcf117984727b64
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 23 18:20:41 2012 +0100

    tests: Remove get-pid test.
    
    If the libvirt attach-method is used, then there is no known PID
    (libvirt hides it).

commit 0a1b2f85e6b551efd39f02f93941bfae333c1c26
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 23 17:10:11 2012 +0100

    launch: libvirt: Use <driver name="qemu" type=[format] />.
    
    We were using format= which was bogus and libvirt was ignoring it and
    forcing raw format instead.
    
    Also in its default configuration libvirt won't do disk format
    autodetection at all, so we must do it instead.

commit f9e484ca4559063de82ec153f742271475916fa8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 23 17:41:23 2012 +0100

    launch: libvirt: You can't set O_CLOEXEC flag using fcntl + F_SETFL.
    
    And in any case there is no point, since proto.c already sets the
    SOCK_CLOEXEC flag (using accept4) on this socket.
    
    The code now matches the code in launch-appliance.c.

commit 793a482015ec670186ac53b2c753f299ed27307c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 23 17:40:55 2012 +0100

    launch: libvirt: Use accept4 to set socket flags correctly.

commit 5fb0f4e07ecaa3e084d3ae173606d6f03df393c3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 23 16:43:14 2012 +0100

    launch: libvirt: Add <on_reboot>destroy</on_reboot> to libvirt XML.
    
    This causes libvirt to add the qemu -no-reboot option, which
    reflects existing behaviour.

commit 20a5b4de7ddc4221544784df65eb472481698dcb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 23 15:24:57 2012 +0100

    launch: Allow default attach-method to be set in environment or configure.
    
    You can now choose the default attach method in two ways:
    
    (1) Set the LIBGUESTFS_ATTACH_METHOD environment variable.
    
    (2)  ./configure --with-default-attach-method=appliance|libvirt|...
    
    Note that (1) overrides (2).

commit 7a691e6665ed5079e6baa000c9c475f32ca78475
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 23 15:24:07 2012 +0100

    java: Set '-encoding utf8' for javac and javadoc commands.

commit 7f519bdc06de978c2460112a88e8bfac5f292dee
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 23 15:18:12 2012 +0100

    java: JAVAC_FLAGS -> EXTRA_JAVAC_FLAGS.
    
    This is just a rename.

commit 99f108b840830a7e967bf75521e4e4bee31ec946
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 23 14:28:03 2012 +0100

    launch: libvirt: Move remaining to-do items to TODO file.

commit 68836022d26fdb3f55596cd12ecf1cf6e54f547c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 23 13:14:16 2012 +0100

    launch: libvirt: Add a hack to detect if KVM is available.
    
    We need to select the <domain type=...> attribute depending on whether
    KVM is detected in the libvirt capabilities.
    
    This is a hack because it doesn't try to parse the libvirt
    capabilities XML.

commit 890a4fbc8740b9b2019885a866aa06bc82566a41
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 23 13:05:46 2012 +0100

    launch: libvirt: Use <cpu model="host-model"/> (thanks Dan Berrange).
    
    This ensures maximum performance of the appliance, particularly for
    things like MD where the guest needs to use optimal SSE instructions.

commit 67f7a30cc995be2aa5474422f708a2df093f5d52
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 23 12:54:08 2012 +0100

    launch: libvirt: Change disk XML according to whether host path is device or file (thanks Dan Berrange).

commit f2d7305091f538644a5ce6ce21ced320db60344d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 23 12:46:37 2012 +0100

    launch: libvirt: Use "guestfs-" prefix on random names (thanks Dan Berrange).

commit ef75c4c568e8e855f133b4a577c6629932aae49a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 23 12:45:31 2012 +0100

    launch: libvirt: Enforce minimum version of libvirt 0.9.13.

commit 524bb29526050e140d0ffb314c78b20d1aaf6078
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 23 12:37:22 2012 +0100

    launch: libvirt: Use snapshot=on instead of <readonly/>.
    
    For compatibility with the appliance backend, devices added readonly
    are in fact added writable with snapshots on top.  This is necessary
    because options like 'mount -o ro' usually require write access to the
    disk (eg. to replay journals).

commit abcd6f0c157c7b689fff8e7dfefb725c752174db
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jul 22 14:40:43 2012 +0100

    Version 1.19.23.

commit aa0efa9eb496d20993a4b2326912562abb843719
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 21 14:25:54 2012 +0100

    launch: Add libvirt backend.
    
    Complete the attach-method libvirt backend.
    
    This backend uses libvirt to create a transient KVM domain to run the
    appliance.
    
    Note that this still will only work with local libvirt URIs since the
    <kernel>, <initrd> and appliance links in the libvirt XML refer to
    local files, and virtio serial only works locally (limitation of
    libvirt).  Remote support will be added later.

commit 42ba2620031d4b52e5319e212c2ea96d80a93b52
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 19 15:32:03 2012 +0100

    Add attach-method "libvirt" or "libvirt:<URI>".
    
    With this commit, you can set the attach method to libvirt,
    but calling launch will give an error.

commit f32b93416a9579feb1af19540c3c04924290f131
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 21 15:47:13 2012 +0100

    launch: Make 'drive_name' into a common function.
    
    This is just code motion.

commit fa3b204f4a672bed859cf9e8ea0b0c8c9e3542d2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 21 13:21:43 2012 +0100

    appliance: Push appliance building lock into guestfs___build_appliance.
    
    Since we will be calling guestfs___build_appliance from the libvirt
    code in future, there's no point having two places where we have to
    acquire the lock.  Push the lock down into this function instead.
    
    Because "glthread/lock.h" includes <errno.h> we have to add this
    header to the file too.

commit a58368b3db4f02b9fd907cec82621be11884d256
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Sat Jul 21 09:11:57 2012 +0800

    fuse:remove the unused macro when fuse is not available
    
    Just make gcc happy when fuse is not available.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit ec8e3b6cad170d08ac18b580792dfb137eb171dc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 20 14:24:10 2012 +0100

    launch: Abstract attach method operations.
    
    g->attach_ops points to a structure which contains the
    operations supported by each attach method backend
    (ie. appliance, unix, etc.).

commit 08cad543492c9624be0659dfb18b7a8b21de8fba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 20 11:57:10 2012 +0100

    launch: Move the command line building code entirely into launch-appliance.c.
    
    Although we still use the handle as convenient temporary
    storage.

commit 52fa23d74f6308daf804c2330b0b27e0b4412594
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 20 12:37:53 2012 +0100

    launch: Move guestfs_config API and build list of qemu parameters in handle.
    
    Move and rewrite guestfs_config so it accumulates a list of qemu
    parameters in the handle.  These are added to the appliance at launch
    time (with attach method == unix:...  you'll now get an error).

commit 4df6beee54ca870faa92bcee346a671e19c80237
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 19 20:24:39 2012 +0100

    launch: Move launch timing / messages code into launch.c.

commit 54fd9a10a6da427f3888e913a9f942375e83c189
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 19 20:14:12 2012 +0100

    lib: Use bool (from <stdbool.h>) for a few fields in the handle.

commit 709e28e6d530655bf314c5b98db6f5d91857d6f7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 19 20:06:40 2012 +0100

    lib: Rearrange fields in guestfs handle.
    
    Arrange the fields more logically.  This is just code motion.

commit a6e0e0d6bf3fdb16a78665cb5b4ee34ac341d1e8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 20 12:19:56 2012 +0100

    add-cdrom: Rewrite description emphasising that this API should not be used.

commit 184b9d7c11f771a74c981f739c28fa0713f3e3e7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 20 08:34:46 2012 +0100

    ocaml: Skip mount-local test if /dev/fuse is not writable.

commit 9d314c7c3f4a22a21d2a2f5b8efe01dd7c43cbe8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 19 19:05:55 2012 +0100

    launch: Remove some dead code from the appliance method.

commit 4c261da5ba8a7679709bf6c8efefc2598c5f5f51
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 19 17:08:51 2012 +0100

    lib: Split launch.c into separate files.
    
    launch-appliance.c contains the code associated with the 'appliance'
    attach-method.  Mostly.  In fact there are a few APIs which don't fit
    so nicely:
    
     - config: deprecated API which fiddles with the qemu command
       line directly
    
     - max-disks: depends on the qemu implementation (virtio-scsi
       or not)
    
     - debug-drives: used for testing only
    
    launch-unix.c contains the code associated with 'unix:<path>'.
    
    launch.c is the common code for launching, along with a few other APIs
    such as guestfs_add_drive_opts.
    
    This commit also reduces the number of headers to just those
    which are required.

commit 80d102c49df440c64b744a14bf1d5f46a1c5b82b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 19 17:09:31 2012 +0100

    Remove debug-cmdline API.
    
    Note that debug* calls are not part of the stable API and can be
    removed or changed at any time.

commit eca544d87d9335123077e30b7547270b6bfe0f2b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 19 16:24:55 2012 +0100

    lib: Use safe_asprintf when constructing attach_method.
    
    Just a small code cleanup / simplification.

commit 2e4089f30007e79bc157c775cfd3b326d22f2992
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 19 15:45:27 2012 +0100

    build: Rename most C files that contain underscore with dash.
    
    This is just code motion.
    
    Some files cannot be renamed.  Notably rpcgen input and output files
    must not contain dash characters, else rpcgen breaks.

commit 6054051a9d8a5eee4141ca4b12aa5b7d1f36f56d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 19 14:28:15 2012 +0100

    fish: Rename fish/virt.c to fish/domain.c
    
    This file handles the -d option for guestfish and other C command line
    utilities.  Renaming this file makes it less confusing.

commit d1d29ab488002dda9e9a1b25fc2dbe4cb844f5ef
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 19 14:24:37 2012 +0100

    build: Rename src/virt.c to src/libvirtdomain.c
    
    This file contains the code implementing guestfs_add_domain
    (for adding a libvirt domain) so this name is less confusing.

commit d88f4ca634685f9aefab1a283f03646e32ba4a25
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 19 13:53:27 2012 +0100

    build: Arrange libguestfs_la_SOURCES in order.

commit a8b4ea1f0c173ab5662a4d0d084f0affb972c94e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 19 15:46:18 2012 +0100

    Remove references to long-obsolete Ocaml_inspector module from .gitignore.

commit f514d462cda5395c8614577930ee69eebafc969d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 19 16:08:45 2012 +0100

    podwrapper: Fix setting of GIT_DIR in git subcommand.
    
    This fixes commit 1e17a32060feb937b3972f61b37f9116ad7d8d9a.

commit 805d6425655abe1450567786ee4b887b23022a3c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 19 14:15:52 2012 +0100

    license: Use latest license files from gnu.org.
    
    COPYING from https://www.gnu.org/licenses/gpl-2.0.txt
    COPYING.LIB from https://www.gnu.org/licenses/lgpl-2.1.txt
    
    (Note this change shouldn't alter the licensing of libguestfs)

commit 719297a2201757be9dfa73de748274d9151e83fb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 19 13:51:16 2012 +0100

    Version 1.19.22.
    
    Includes rebuilt gnulib to work around test problems with
    test-getlogin_r.

commit 6e1b5f0feac50a498cb7319e5051a251877fe682
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 19 12:43:55 2012 +0100

    gnulib: Don't include or run getlogin_r test (thanks Jim Meyering).
    
    See:
    https://lists.gnu.org/archive/html/bug-gnulib/2012-07/msg00194.html

commit fc86db3b3bcd884ee37cef79e22b0324df9fcae6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 19 11:16:35 2012 +0100

    build: Return 77 from skipped tests.

commit 1b94ea204d3ce9b8a114b805d2781ab0f4628d94
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 18 21:51:20 2012 +0100

    Version 1.19.21.

commit a0a517869cf9848ba86209c4792ae63d96278ca2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 18 14:57:41 2012 +0100

    tests: Rewrite parallel mount-local test in C.

commit eef11f33f9f14d3706b681bd4e23e334fcc9b791
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 18 13:45:21 2012 +0100

    ocaml: Test mount-local, without parallel test.
    
    Unfortunately the parallel test keeps hitting this bug:
    https://bugzilla.redhat.com/show_bug.cgi?id=838081
    which could be a bug in the OCaml runtime.
    
    Just test simple mount-local.  We will write a parallel test in C to
    replace this.

commit 50780a84f65ec5d76605691cea889392c2730f54
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 18 12:33:16 2012 +0100

    tar-in: Add --no-same-owner flag to tar command when target filesystem doesn't support chown (RHBZ#840572).
    
    When using tar-in or tools built around it such as virt-make-fs, if
    the target filesystem is vfat then unpacking the tarball would fail
    because tar tries to chown(2) files and fails.
    
    You would see errors such as:
    
    tar: <file>: Cannot change ownership to uid 500, gid 500: Operation not permitted
    
    This change detects whether the target filesystem supports chown(2).
    If not, it adds the --no-same-owner flag to tar to stop it from trying
    to change the ownership of newly created files.

commit 781857a86b3bc8238995a9212ea09aa368fc2fc9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 18 12:32:21 2012 +0100

    daemon: Make 'random_name' into a utility function.
    
    This is mostly code motion, although the precise contract of this
    function changes slightly to make it more generally useful

commit 9c2b9c2df6c3c10b090d71bc808d755dbf625cbe
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 18 11:14:19 2012 +0100

    virt-make-fs: Suggest guestfish for complex layouts in man page.

commit b25aea33fa314857c8094e09af9654f925fb935f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 18 10:03:29 2012 +0100

    build: Change how make.sh, packagelist, excludelist are updated.
    
    Add proper dependencies for these files, but also use 'cmp' to ensure
    they only get overwritten if the new files have actually changed, so
    we don't rebuild the appliance unnecessarily.

commit 87206e4e9e3b0ca813a4ff7b5fac0eccc07a484a
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Wed Jul 18 09:58:43 2012 +0800

    New API: add new api xfs_info
    
    Add xfs_info to show the geometry of the xfs filesystem.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>
    
    RWMJ:
     - Updated po/POTFILES.
     - Use xfs_ prefix for all struct fields.
     - Return uninitialized fields as -1 / empty string.
     - Copyedit the description.

commit 2f89f584c0203023f8a829ff9796dc2c14ddeb68
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Wed Jul 18 09:58:44 2012 +0800

    augeas: make functions as noreturn
    
    Just make gcc happy.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 8e75e21b23f18ec0b0fa4f07f96c31dd56a50f25
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 17 20:04:24 2012 +0100

    podwrapper: Use UTF8 in output, send errors to stderr.
    
    This fixes commit 1e17a32060feb937b3972f61b37f9116ad7d8d9a.

commit d76ea07814b1d1390d1d94f0e579c0fe4e28dca8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 17 15:38:52 2012 +0100

    Version 1.19.20.

commit 973581780d8a006f336684fef6762801402d775d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 17 13:44:45 2012 +0100

    case_sensitive_path: Allow trailing path element to be missing (RHBZ#840115).
    
    case_sensitive_path is undefined when the final path element doesn't
    exist.  Currently it returns an error, but this means that creating a
    new file doesn't work as expected:
    
      $ guestfish --rw -i -d windows touch 'win:c:\blah'
      libguestfs: error: case_sensitive_path: blah no file or directory found with this name
    
    We should allow this case (provided there is no trailing slash) so
    that new files or directories can be created.

commit ac0373bdecfabe6acf99d3662e5117de73fa2aef
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 17 13:31:05 2012 +0100

    case_sensitive_path: Move variables to top of function.
    
    This is just code motion.

commit 4bc110e2bc738bde9b9c09bc602ef13c06b60e90
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 17 12:46:04 2012 +0100

    docs: Use L<...> for links.
    
    Instead of working around bugs, podwrapper has been fixed so that
    links work in all output formats.

commit 182b4a66609ffd5366575d72351cd8174cf68145
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 17 13:16:40 2012 +0100

    podwrapper: Subclass Pod::Man so we can fix the way links are generated.

commit 9967ad3fa13178c70afd5da77f77a4115808733d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 17 13:15:55 2012 +0100

    podwrapper: Define $VERSION in subclass.
    
    The superclass sometimes uses this and will give an undefined
    error if it's missing.

commit 60c42dd2a1a173ec1161502762bc33ae7a1cf190
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 17 12:49:59 2012 +0100

    podwrapper: Tidy up the program name.
    
    Messages now look like this:
    
      podwrapper.pl: wrote guestfs-examples.3
      podwrapper.pl: wrote ../html/guestfs-examples.3.html

commit f6846d74c947bd8b711ef0b29148fa1e90580354
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 17 12:34:51 2012 +0100

    perl: In examples, call $g->shutdown, $g->close.

commit a99ea198b24745c49cdb42645c3497ac3b0e6a2f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 17 12:33:45 2012 +0100

    perl: Use $g instead of $h in documentation.
    
    $g is the "standard" name for libguestfs handles.

commit 8d0baf7b859fbbe40bdb072b2009d77c02cee7c3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 16 23:04:17 2012 +0100

    docs: febootstrap is in section 8 of the manual, not section 1.

commit 1e17a32060feb937b3972f61b37f9116ad7d8d9a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 16 19:41:39 2012 +0100

    Replace podwrapper shell script with custom Perl script.
    
    This uses Pod::Simple so it properly parses the input POD and can
    generate proper custom output as required specifically by libguestfs.
    
    One immediate benefit is that links between and within manual pages
    now work mostly correctly.

commit 0bf1e5b6650e71434430bf119b486a779516886d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 16 21:58:57 2012 +0100

    Fix pod.css for new HTML output from Perl 5.16.
    
    There used to be a <div> around the table of contents, but that
    is no longer present.

commit 3a442e66170518f725b92a1041546d81fde95492
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 16 21:58:34 2012 +0100

    configure: Make generated files read-only.
    
    Some of the generated files anyway.

commit f2ea617e224cd82496e56a41b5878063d6f02e3d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 16 18:56:57 2012 +0100

    build: Change calls to podwrapper.sh to use $(PODWRAPPER).
    
    This will allow us to easily change the location of this
    script in future.

commit c7d342a94a89324be2f568c940ba089fdd5aa0c0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 16 16:47:44 2012 +0100

    virt-make-fs: Add --floppy option to make preconfigured vfd's.

commit 24b7979ea25cbe5f08494cc4580c1341e78e090e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 16 16:26:26 2012 +0100

    virt-make-fs: Recognize "msdos" as a partition or filesystem type.
    
    Set MBR partition type byte accordingly.

commit d69a03e44832d8a8da84696bd4e2aaf3cd5d6cff
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 16 14:01:46 2012 +0100

    Revert "ocaml: Calling Gc.compact before g#mount_local works around RHBZ#838081."
    
    This reverts commit ad7c4498f66f37c4219242c6df04d28e9ee7877f.
    
    Reverted because we still see core dumps.

commit 2bd080fd5a233656d32b2697922881df54bc7a77
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 16 10:16:54 2012 +0100

    Version 1.19.19.

commit 98f2d221cfe184535a493057f5b2b38d8bee34e4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 16 13:29:32 2012 +0100

    run: Update comments.

commit 95d26f02405c090f886fc2c47a9e51ca37f9c09e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 12 16:38:57 2012 +0100

    generator: Rename 'ntfsresize_opts' API to 'ntfsresize'.
    
    By using the once_had_no_optargs flag, this change is backwards
    compatible for callers.

commit e055bf4caba24fd24153984770ffe71b42003f76
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 12 16:38:57 2012 +0100

    generator: Rename 'mkfs_opts' API to 'mkfs'.
    
    By using the once_had_no_optargs flag, this change is backwards
    compatible for callers.

commit 7486fc6f43bdb22a989cc039e361afc4c0658d52
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 14 12:42:24 2012 +0100

    generator: Rename 'add_drive_opts' API to 'add_drive'.
    
    By using the once_had_no_optargs flag, this change is backwards
    compatible for callers (except Haskell, PHP and GObject as discussed
    in earlier commit).

commit b48ae2eadf43315159f2174c8fd35b05ede14c0f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 13 13:42:40 2012 +0100

    generator: In non-C bindings, generate '*_opts' alias.
    
    In C, a function called 'func' which has once_had_no_optargs=true will
    (because of the previous commit) generate 'func_opts' and a
    backwards-compatibility function called 'func'.
    
    This commit changes some of the non-C bindings so that they also
    generate 'func_opts' which is merely a wrapper that calls 'func'.
    
    This avoids incompatibility when we rename 'mkfs_opts' etc back to
    plain 'mkfs', and it also makes it easier to translate between other
    language bindings and C code.
    
    NB: Some bindings do not include aliases:
    
      PHP:     There's no way to easily alias methods in PHP < 5.3, and we
               can't assume everyone has this minimum version.
    
      GObject: Very complex to add aliases, but we should probably do this
               at some point.
    
      Haskell: No support for optargs in these bindings.  Unfortunately
               this means that we can no longer bind 'Guestfs.add_drive'
               (since it will be changed to add optional arguments) making
               the Haskell bindings even less useful than they were already.

commit 98757e151ae8ad8d334f028690abcc85b91c73e5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 12 16:32:47 2012 +0100

    generator: Allow non-optargs functions to gain optargs.
    
    This commit adds a flag (once_had_no_optargs) which can be used to add
    optargs to functions that currently don't have any.
    
    The idea is that if 'func' currently has no optargs, we can safely add
    optargs provided we are backwards compatible for existing callers.
    
    In C that means we leave 'guestfs_func' alone and provide an extra
    function 'guestfs_func_opts' that takes the optargs ('guestfs_func'
    becomes a wrapper that calls 'guestfs_func_opts').
    
    In the C generator this means there are two names for each function
    (although the two names are normally identical).  'c_name' is the name
    that we export publicly (eg. [guestfs_] 'func_opts').  'name' is the
    internal name of the function (eg. 'func') which is used for
    everything apart from the public interface, and also to generate the
    no-optargs compat function.
    
    In other languages that can add optional arguments safely, we simply
    add the arguments to the existing 'func', so for example in Perl:
    
      $g->func (required_args)
      $g->func (required_args, optional_args)
    
    can be used.
    
    Note that this commit does not cause any change to the output of the
    generator.  I verified this by diffing the output before and after.

commit 9eb606045627ff5fdc30eea011c67eb30b7655fa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 13 11:33:49 2012 +0100

    generator: Rearrange some C generator code into sub-functions.
    
    This is just code motion.  I verified this by comparing the
    generator output before and after this commit.

commit 0da2dbef26a9efddbc1f4cd6cbe796b3b5f98d13
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 13 13:59:00 2012 +0100

    java: Generate overloaded non-optargs method for each optargs method.
    
    For example the existing method:
    
      public void mkfs_opts (String fstype, String device, Map<..> optargs);
    
    is now accompanied by this overloaded method which is a simple wrapper:
    
      public void mkfs_opts (String fstype, String device)
        throws LibGuestFSException
      {
        mkfs_opts (fstype, device, null);
      }

commit 60805c92179bc193be2d125504b12d285ff7c74b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 12 16:27:38 2012 +0100

    generator: Add c_optarg_prefix for each action.
    
    This updates commit 9286f556c6a9e6967fcac8aacdae3660821c4c7a.

commit 9286f556c6a9e6967fcac8aacdae3660821c4c7a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 12 12:50:49 2012 +0100

    generator: Add c_function (C function name) to each action struct.
    
    This field, which is generated internally by the generator, is the
    name of the C function corresponding to each action.
    
    For actions that have NO optional arguments, it's just "guestfs_<name>".
    
    For actions that have any optional arguments, it is
    "guestfs_<name>_argv" (since any binding has to construct the optional
    argument struct explicitly).
    
    In a future commit, this mapping may become more complex.
    
    This commit also "fixes" the C# bindings which didn't handle optional
    arguments properly at all.  In fact, it doesn't fix this, it just
    changes it enough that it probably now compiles.  We should either
    compile and test the bindings routinely with Mono, or drop them, since
    they are starting to bit-rot.
    
    In the GObject bindings, I have added a space between the C function
    name and the first paren.
    
    Apart from the C# and GObject changes, this is just code motion.  It
    was verified by diffing the output of the generator before and after.

commit e80f3687322f91642e8d196de38892174f8c648a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 12 11:11:31 2012 +0100

    generator: Change the way that camel-case names are generated.
    
    Store the camel-case name directly in the struct instead
    of generating it on the fly in only the GObject bindings.
    
    This is just code motion.  Tested by verifying that the generator
    output is identical.

commit e452a0b8cacd031ecea158a141ecbc41b3426de2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 11 23:56:10 2012 +0100

    tests: Rename test0* functions as internal_test*.
    
    The internal_* prefix is reserved for internal functions
    such as these tests.

commit 7a0478bed0fe3ccbdf16087552f3d6ea196f29ec
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 11 23:55:11 2012 +0100

    tests: Better way to ensure 'g' is used and return success or error.

commit 39d1a7dbc9c7d4ae8cbb492a39149d1f8e75ff70
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 11 15:07:01 2012 +0100

    generator: Use a struct instead of a tuple to describe each action.
    
    Each action changes from a tuple like this:
    
      ("cat", (RString "content", [Pathname "path"], []), 4,
       [ProtocolLimitWarning],
       [InitISOFS, Always, TestOutput (
          [["cat"; "/known-2"]], "abcdef\n")],
       "list the contents of a file",
       "[...]");
    
    to a slightly longer but more readable struct:
    
      { defaults with
        name = "cat";
        style = RString "content", [Pathname "path"], [];
        proc_nr = Some 4;
        protocol_limit_warning = true;
        tests = [
          InitISOFS, Always, TestOutput (
          [["cat"; "/known-2"]], "abcdef\n")
        ];
        shortdesc = "list the contents of a file";
        longdesc = "[...]" };
    
    ["defaults" is a struct which contains the defaults for every field,
    allowing us to use the "{ defaults with ... }" syntax to just update
    the fields we want to be different from the defaults.]
    
    This is a mechanical change and there is no change to the output of
    the generator.  I checked the output before and after with diff to
    verify this.  There are no changes in the output apart from UUIDs
    which are expected to change with each run.

commit 7b619d47f6931286620bc7c1cb6dcb4e63cc951b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 11 15:05:57 2012 +0100

    todo: Tidy up test0 functions.

commit 196742cd46a8d80f0298f9f58c540482919306a3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 11 10:47:18 2012 +0100

    generator: Add a note in generator/README about safely extending functions.

commit cf0defedb8121a0ff39c1d4c6d9f3eee9fd7ee72
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 11 10:46:56 2012 +0100

    generator: Move note in comment to generator/README file.

commit ec0c7e0a1aafd145309ab53749d910ad837d8745
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 10 18:59:35 2012 +0100

    fuse: Cleaner code and documentation for safe cleanups.

commit f883e4d8d3ea65c5cd4c2dc5d557989c00aafc56
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 10 18:59:04 2012 +0100

    tests/guests: Add temp files to CLEANFILES.

commit 1c8403885cb5ddff7eda975772cb154b375dbaae
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 10 18:44:45 2012 +0100

    Update translations from Transifex.

commit 33bb7408f684bf0d4eff0a0e99c53449fa4923e4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 10 13:46:17 2012 +0100

    podwrapper: Fix shell script.
    
    This fixes commit f9a5e3ed86ee7bcd13619f13b4d4de6ce46ac8c3.

commit f9a5e3ed86ee7bcd13619f13b4d4de6ce46ac8c3
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Tue Jul 10 07:30:11 2012 +0200

    podwrapper.sh: Take date from ChangeLog or from the latest git commit.

commit afb30b1b8a6dc8b256788c26bbb5a9dc22e6972d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 9 18:36:46 2012 +0100

    Version 1.19.18.

commit 8df259496a80bc74edbab4436e3679d0900bd173
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 9 15:56:47 2012 +0100

    fuse: Add regression test for RHBZ#838592.

commit 5546ea6d68532caa69fbede1f29385afe34e7362
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 9 15:56:20 2012 +0100

    fuse: Add guestmount --pid-file option (RHBZ#838592).

commit bfbfe6dd788ee3705383b544c5bc238a7dd5ca53
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 9 15:24:26 2012 +0100

    fuse: Link to mount-local documentation in guestmount man page.

commit 1cde66165aac222f1a07ad4c3873c61d49eabb02
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 9 15:23:52 2012 +0100

    fuse: Document race condition possible with fusermount.
    
    See also:
    https://bugzilla.redhat.com/show_bug.cgi?id=835466#c9

commit b749dc70742e749dbd7c0c20e6e7191fdd199170
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 9 15:23:09 2012 +0100

    fuse: Document Device or resource busy errors from fusermount.

commit bd3e42a8ded1ed7a4177ad03646572eb6155a49c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jul 8 12:55:44 2012 +0100

    Revert "launch: Correction in comment."
    
    This reverts commit 6e5a85bb9b6557bc337625a339728e23f5f2dd94.
    
    It turns out this is a bug in QEMU after all.

commit e6dec159488f589df62c9f59477281f8264a19c8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 7 16:19:55 2012 +0100

    extra-tests: Add a test using upstream qemu.

commit 6e5a85bb9b6557bc337625a339728e23f5f2dd94
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 7 15:49:22 2012 +0100

    launch: Correction in comment.
    
    https://bugs.launchpad.net/qemu/+bug/1021649 is invalid, probably
    caused by a Fedora ROM.
    
    This updates commit 52d188e32fb8addb45bf926df07e34ab35898f85.

commit 1596b6026ddd1e343efc6a74fc23f46e4975868f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 7 12:39:46 2012 +0100

    Update gnulib to latest version.

commit ac25512175fc99860b1cdd4de9969b2d2259d7e6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 6 14:11:38 2012 +0100

    Version 1.19.17.

commit ad7c4498f66f37c4219242c6df04d28e9ee7877f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 6 13:47:07 2012 +0100

    ocaml: Calling Gc.compact before g#mount_local works around RHBZ#838081.

commit 52d188e32fb8addb45bf926df07e34ab35898f85
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 6 10:29:26 2012 +0100

    qemu: Use sgabios by default (thanks Dan Berrange).

commit 1b87f89b5c61f7b840663ddebaa58beb716bb1e9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 4 16:44:26 2012 +0100

    todo: Investigate qemu caching modes.

commit a95fc923880018e5e533d69ba2bef702e0f6dd3c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 3 21:45:07 2012 +0100

    Version 1.19.16.

commit 7996e0882442dc7bac2ab573e2fcac0b488c8cc7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 4 16:16:17 2012 +0100

    qemu or qemu-kvm >= 1.1.0 is required.
    
    Earlier versions of qemu contained a bug in the qcow2 code which
    causes qemu to segfault when shutting down and flushing its internal
    cache, and this can result in data loss.

commit ffbf1475f7ae7c462db289ad4834391469e72edd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 3 13:22:45 2012 +0100

    New API: guestfs_shutdown: Cleanly shutdown the backend.
    
    The new API splits orderly close into a two-step process:
    
      if (guestfs_shutdown (g) == -1) {
        /* handle the error, eg. qemu error */
      }
      guestfs_close (g);
    
    Note that the explicit shutdown step is only necessary in the case
    where you have made changes to the disk image and want to handle write
    errors.  Read the documentation for further information.
    
    This change also:
    
     - deprecates guestfs_kill_subprocess
    
     - turns guestfs_kill_subprocess into the same as guestfs_shutdown
    
     - changes guestfish and other tools to call shutdown + close
       where necessary (not for read-only tools)
    
     - updates documentation
    
     - updates examples

commit bcc4ffb52b9f4b5db7861682905ec32844f4603b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 3 13:09:53 2012 +0100

    close: Warn if qemu exits unsuccessfully.
    
    Currently guestfs_close has no method to return an error indication,
    so this commit simply prints the error on stderr.

commit fc3c6fff4b0a6ffeb75aa78b1d73241a14a03cd1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 3 11:07:13 2012 +0100

    close: Rearrange the order in which the handle is closed and freed.
    
    The order is now:
    
     - remove the handle from the list of handles
     - send close trace message
     - sync and shutdown qemu
     - run user close callback
     - free temporary directory
     - free memory
    
    This commit ought to be no functional change.

commit 27ebf517fae972eee49ae5911a03fabe5f4b6e54
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 3 14:42:10 2012 +0100

    perl, python, ruby: Fix comments on call to close method.
    
    Make the comments consistent.
    
    Also make the Perl example call $g->close explicitly so it is
    consistent with the other examples.

commit 917550a117904ec1a06b77a7870a147014d71adb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 3 14:36:45 2012 +0100

    examples: In create_disk example, don't call set_autosync.
    
    This is now set by default in all supported versions of libguestfs.
    It's just confusing if the examples refer to it.

commit c0a3c9ce70b98171e737e49e6dccc4457963f2ec
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 2 16:38:19 2012 +0100

    daemon: Run fsync on block devices after sync (RHBZ#836710).
    
    On Linux, sync(2) does not actually issue a write barrier, thus it
    doesn't force a flush of the underlying hardware write cache (or
    qemu's disk cache in the virtual case).
    
    This can be a problem, because libguestfs relies on running sync in
    the appliance, followed by killing qemu (using SIGTERM).
    
    In most cases, this is fine, because killing qemu with SIGTERM should
    cause it to flush out the disk cache before it exits.  However we have
    found various bugs in qemu which cause qemu to crash while doing the
    flush, leaving the data unwritten (see RHBZ#836913).
    
    The solution is to issue fsync(2) to the block devices.  This has a
    write barrier, so it ensures that qemu writes out its cache long
    before we get around to killing qemu.

commit cb24ceedd8a8ef7da71cfcce6db10669de47685c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 2 16:30:23 2012 +0100

    daemon: Code tidy up in devsparts.
    
    No functional change.

commit 0437a7905619b8370e25fbae1a3e6388c5277be9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 2 12:47:37 2012 +0100

    Add notes about how qemu cache=none works internally.
    
    This is just a comment and has no functional effect.

commit 1608ca182b094a1dbe22094f39a5e86f18f728b7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 2 12:46:14 2012 +0100

    Rename qemu option cache=off to cache=none.
    
    Note that qemu treats these identically, so this change has
    no functional effect.

commit 906f8e3ae24a084d9a70d33d84c0ce29bdafa79c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 2 12:34:11 2012 +0100

    appliance: Update paths to udevd.
    
    systemd is playing a WTF game with udevd, moving it around and
    renaming it unnecessarily in each release.  Chase all known locations.

commit 100271c7bc00a1f9baacd8c56b43e156b736fc12
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 2 12:33:42 2012 +0100

    appliance: Update comment to note that systemd package now contains udevd.

commit 757b089053137dc9e12be4b69b7c68fa7c70ae08
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 29 20:16:44 2012 +0100

    Version 1.19.15.

commit 5489304c8d2836713ec58051c24514eba22b8c94
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 29 18:03:02 2012 +0100

    tests: Add a test of /dev/disk/by-id paths (RHBZ#627675).

commit 339f3647f889424af2a2256c4fcad0b44982c275
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 29 17:57:00 2012 +0100

    tests: Use qemu-img to create an overlay for testing, instead of copying.
    
    Replace:
    
      cp tests/guests/fedora.img test.img
    
    with the longer but possibly more space-efficient equivalent:
    
      qemu-img create -F raw -b tests/guests/fedora.img -f qcow2 test.qcow2

commit ea8421c5d297698856a87c2cfe4a6b42796175a8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 29 18:20:42 2012 +0100

    inspect: Check partition exists when doing fstab mapping.
    
    If the partition name we're about to return doesn't really exist,
    then don't perform the mapping.

commit 7eaa99994ebd354f4b078d4068695984989a907f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 29 16:45:07 2012 +0100

    inspect: Guess device name from /dev/disk/by-id/*-partN path (RHBZ#627675).
    
    See https://bugzilla.redhat.com/show_bug.cgi?id=836573#c3
    for an explanation.
    
    Useful function 'is_partition' shows how to tell if a device name
    represents a partition.

commit 47b8225b05a7e35411f954f61f3eb3115c5a9f45
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 29 16:43:53 2012 +0100

    inspect: Refactor resolve_fstab_device code into multiple functions.
    
    This is mostly code motion, although it also fixes a memory leak in an
    extremely rare failure case, and it generally tidies up the existing
    code.

commit 152b179a19e43fcb0baec65ea65d394ee1dba891
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 29 19:03:37 2012 +0100

    New API: guestfs_nr_devices
    
    This returns the number of whole block devices added.  It is usually
    simpler to call this than to list the devices and count them, which
    is what we do in some places in the current codebase.

commit cba49169094f04dead9b165b6b5991afa92132ff
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 29 14:54:44 2012 +0100

    ruby: Fix detection of library (thanks Hilko Bengen).
    
    On Debian, the Ruby C extensions library isn't '-lruby', it's
    something like '-lruby1.8' or '-lruby-1.9.1' and these can even be
    parallel-installed.
    
    Fix detection so we use Ruby's own rbconfig.rb file to find the right
    library to use.

commit b07d0968823d008776345a1c724713d2320e1571
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 29 14:54:05 2012 +0100

    ruby: Changing spacing in configure file.
    
    No functional change.

commit b9f858e5eefa0d2abae5ff0a61a39b0d34334bc1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 29 14:18:10 2012 +0100

    ruby: Remove useless AC_SUBST in configure file.

commit a176f508cb96e404fbb8eb7b142fa8b43ea70b00
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 28 17:19:14 2012 +0100

    Update API support from tarballs.

commit 27efd99ddb5fcf16e0c58ecfee8832ec53d3c9ff
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 28 13:49:32 2012 +0100

    tests: Reformat TESTS_ENVIRONMENT so all use a standard format.
    
    No functional change.

commit 2f1a602c4bc8988c538297dbf49e6c9b486e2441
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 28 13:47:35 2012 +0100

    python: Set PYTHON in run script.

commit 04a533ca8c8fcea6d84a14f4ae8a672df94a2e46
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 28 13:46:31 2012 +0100

    ocaml: Set CAML_LD_LIBRARY_PATH in run script.

commit e7d2d3cb8905598b57c4d24a933ef25fdb021b1d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 28 13:41:40 2012 +0100

    ruby: Use run --tests for tests.

commit 8439e97f764872d8bc31c6bcf4c7b44afbc4523a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 28 13:40:33 2012 +0100

    java: Use run --tests for tests.
    
    Java-specific environment variables are set in the run script.

commit 1b56aedc2b68a2db1e98c68d5344247742909e2e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 28 13:34:52 2012 +0100

    gobject: Use run --test for tests, and set GJS in run script.

commit 2d56e5af900662ea0a13e9e8ea4a802609214ecc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 28 13:32:53 2012 +0100

    run: Rearrangement and add comments.
    
    No functional change.

commit 927ef14c584524a16e8be3fb7eff6cd3ee880ce6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 28 13:15:57 2012 +0100

    run: Set MALLOC_PERTURB_ to a random value.
    
    MALLOC_PERTURB_ is a glibc feature which causes malloc to wipe memory
    before and after it is used, allowing both use-after-free and
    uninitialized reads to be detected with relatively little performance
    penalty:
    
      http://udrepper.livejournal.com/11429.html?nojs=1
    
    Modify the ./run script so that it always sets this.
    
    We were already using MALLOC_PERTURB_ in most tests.  Since ./run is
    now setting this, we can remove it from individual Makefiles.  Most
    TESTS_ENVIRONMENT will now simply look like this:
    
      TESTS_ENVIRONMENT = $(top_builddir)/run --test

commit b3df3ba5c824dc5ea15902df2f1ee80254aca22f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 28 08:56:18 2012 +0100

    Version 1.19.14.

commit cadfab1a20f3cfb37e1a4d69fbea001754dcba32
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 27 16:34:23 2012 +0100

    tests: Fix 'run --test' so it cleans up its temporary file.
    
    This fixes commit 05d4e07918bfa9907a1fa66391e8e2e2370c64d4.

commit 1d17a6e9d8f434f952f3c171b5a81ca6b916fa1f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 27 15:49:06 2012 +0100

    Ensure #include <config.h> occurs in every C file.

commit 6777425636d1c04494e52c61dc44f523458d12d3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 27 15:30:56 2012 +0100

    src/actions.c: Include <config.h> in this generated file.
    
    On RHEL 5, because _GNU_SOURCE was not defined, open_memstream was not
    being declared, resulting in miscompilation and a segfault in the
    trace code whenever open_memstream returned a pointer >= 0x80000000
    (which would be truncated to a 32 bit int and then sign-extended).

commit 6afb7336e33dc28c4fd1a4545a8298ee36c10723
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 27 10:54:02 2012 +0100

    gobject: bindtests: gjs exception behaviour changed, fix test.
    
    When libguestfs calls 'error (g, "error")', gjs in F17 throws
    error.message == "Error invoking Guestfs.test0rinterr: error"
    
    In F18, error.message is simply the string "error".
    
    Fix the test so it works for both cases.

commit b3a5403cdad6d3b9c8e4d342538790cfaecbd99c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 26 23:49:00 2012 +0100

    Version 1.19.13.

commit 2eacd4a19157586ffa122318f1d2e2fd94a5e44f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 26 23:34:42 2012 +0100

    fuse: Use the ./run --test script to run tests.

commit 05d4e07918bfa9907a1fa66391e8e2e2370c64d4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 26 22:47:35 2012 +0100

    tests: Add ./run --test option.
    
    This option, when added via
      TESTS_ENVIRONMENT = [...] $(top_builddir)/run --test
    allows us to run the tests and only print the full output (including
    debugging etc) when the test fails.

commit bbb7d75c91450ab029edb794b0486eeb8220e4fd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 26 23:00:29 2012 +0100

    ./run: Fix indenting for shell script.

commit 0977c8408a1119c0582e3d2ab6edef23a1f1f22e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 26 18:38:23 2012 +0100

    ocaml: Allow parallel mount-local test to be skipped.
    
    FUSE is not very reliable on RHEL 5.

commit 8d88b06277c1d6d7a26b9434cc69a7bae9ada7fc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 26 17:46:05 2012 +0100

    FAQ: Add Gentoo (thanks Agostino Sarubbo).

commit eb8eb3b9d52bada636317bbcbf0c94183740c1a6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 26 15:32:36 2012 +0100

    Version 1.19.12.

commit c87956837e962072fff61edef5b18e55ad42d730
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 26 14:39:16 2012 +0100

    launch: Avoid double-close when qemu exits early.
    
    The stdin and stdout of the qemu process are aliased to g->fd:
    
      g->fd[0] = wfd[1];
      g->fd[1] = rfd[0];
    
    However if the child exits early, then child_cleanup closes g->fd[0],
    g->fd[1], AND the code at the cleanup1 label closes wfd[1], rfd[0],
    resulting in a double-close.
    
    Avoid this case by setting wfd[1], rfd[0] to -1.  In the cleanup1
    label, only close wfd[1], rfd[0] if they are not -1, and add the same
    for g->fd[0], g->fd[1].

commit 9e221e55b61e9f1cd0caf292ca609a4ca26f1d4d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 26 13:36:19 2012 +0100

    launch: Ensure errno from test_qemu_cmd is captured and printed.

commit 11317b5d1243f3afc35f7abe8edc646f75813e36
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 26 13:31:58 2012 +0100

    launch: Set g->sock = -1 to avoid double-close.
    
    This fixes commit ef5c02c6ee72eb8e127115923951777a2c2b8480.

commit ef5c02c6ee72eb8e127115923951777a2c2b8480
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 26 11:47:26 2012 +0100

    launch: Log errors from close syscall.

commit 90d0beb3c528d91029349b64d0159836c776189b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 26 09:17:19 2012 +0100

    tests: Add thread IDs to test of bug 790721.

commit 8fc2127975de2f364e348c5a558d78e77988953c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 25 15:19:58 2012 +0100

    sysprep: Don't check for /dev/fuse before running the test.
    
    The program doesn't actually require FUSE when used without
    any --script options.

commit f27770e1412c0dbe652d490791347911aac62b24
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 25 15:19:19 2012 +0100

    fish: Allow mount-local test to be skipped with environment variable.
    
    The test uses FUSE, so we need a way to disable it on RHEL 5.

commit 2afa0eeb9040d90fc020c01caa0b24b00e0556ce
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 25 15:14:46 2012 +0100

    tests: Allow SELinux tests to be skipped with an environment variable.

commit 030e318049b58a1d62f1179dba3a7fb0f015a83c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 25 11:29:16 2012 +0100

    Version 1.19.11.

commit 729bb9c6b5ae0c0e7c68dc802b1617936062f966
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 25 09:03:39 2012 +0100

    launch: Treat /dev/null specially, for old KVM.
    
    Old KVM can't add /dev/null readonly.  Treat /dev/null as a special
    case.
    
    We also fix a few tests where /dev/null was being used with
    format=qcow2.  This was always incorrect behaviour, but qemu appears
    to tolerate it.

commit 78a515ec4a4e8650bd2e1ffc0bfbb97b9568306d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 25 09:02:18 2012 +0100

    lib: Remove obsolete NETWORK, ROUTER definitions in header file.
    
    These haven't been used since we switched over to virtio-serial.

commit a0a86484be86da3085377f874a9de76c94db712b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 22 22:06:30 2012 +0100

    Version 1.19.10.

commit 461455ca7cab93af09445d135483f5705589cc0c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 22 13:02:35 2012 +0100

    tests/xml: Fix compilation of test on RHEL 5 with old libvirt.
    
    Old <libvirt.h> had a conflicting definition of virDomainGetXMLDesc:
    
    fake_libvirt_xml.c:36: error: conflicting types for 'virDomainGetXMLDesc'
    /usr/include/libvirt/libvirt.h:715: error: previous declaration of 'virDomainGetXMLDesc' was here
    
    The difference is not material ('int' vs. 'unsigned int').
    
    Avoid the error by not including <libvirt.h>.

commit 9e7644346dc4303316e59dda13ea5b2f60549626
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 22 12:58:49 2012 +0100

    tests: Add workaround for missing O_CLOEXEC.

commit 35882ba97722ddf9b4c55a332961b08ad8240dd7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 22 12:57:14 2012 +0100

    tests: Fix broken workarounds for missing O_CLOEXEC.

commit ef1514aa1e0a099d71cbb7d2c5f24f9f32e1939d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 22 11:04:31 2012 +0100

    test-virt-resize: Replace truncate with guestfish sparse.
    
    Another instance of 'truncate' command.
    
    See commit 39df80dcc0e485e69048bddbf33c259ce532e50d for an
    explanation.

commit 4d3ec25b47361601604e2f585178393e60f4cd4d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 22 10:54:57 2012 +0100

    part-get-bootable: Fix when partitions are missing or unordered (RHBZ#602997).
    
    The original fix for this in
    commit 511c82df46f5c6f4a7f984fdb81d4691038ed6da was not complete, in
    that it did not fix the case of the old (pre '-m' option) parted.
    This doesn't matter for Fedora, but it matters for RHEL 5 which has
    this ancient parted.

commit 8098d062b4cb70defd4aecba0ba8cd75cf893751
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 22 09:46:39 2012 +0100

    ruby: Add a replacement rb_hash_lookup function for Ruby 1.8.5.
    
    This function was first added to Ruby in 1.8.7.

commit 823ba05ebd8f1a12574a3f154aaf7c8b4f2aeeac
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 22 09:45:06 2012 +0100

    ruby: Fix libruby test.
    
    If -lruby was not available, this used to define HAVE_LIBRUBY=0.
    However this meant that the later test -n "$HAVE_LIBRUBY" would
    be successful, whereas it should fail in this case.

commit 6cb74d46ba5b1c3f1edd3bfb12df9d4da2ec8a8f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 22 08:49:40 2012 +0100

    virt-format: Don't call wipefs unless API is available.
    
    This API is optional.  Don't call it unless it's available
    in the appliance.

commit 145f35badfd9ca4a6d9f54f7732566a5e5114876
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 22 08:41:14 2012 +0100

    tests: Add SKIP_TEST_* variables to allow these tests to be skipped.
    
    By setting these variables, we can skip tests that fail on
    RHEL 5.

commit 6352953ea927819a8ece795d03c4938e657d0a97
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 19 08:31:25 2012 +0100

    FAQ: Mention update-guestfs-appliance (thanks Steven Dake).

commit 489da3ccdf96e995d3f53fe68eced37b16baa1d2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 18 22:21:05 2012 +0100

    build: Workaround for AC_PROG_SED not existing.
    
    This didn't exist on ancient autoconf in RHEL 5.

commit bc7f1a5ef156576c069f47ea33f4977979ac032d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 18 21:42:44 2012 +0100

    build: Define abs_builddir if not defined already.
    
    This is missing on RHEL 5.
    
    This updates commit 50aa9533e4a505e1c64dbedddb30491bfbb755d6.

commit baee3f52ef1c4018f6b19a805a5c9ed01cf8ce73
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 18 16:33:15 2012 +0100

    Version 1.19.9.

commit d7c9c6a0d926982b64d13949a5da580ea4ecc4b6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 18 13:05:35 2012 +0100

    fuse: Skip 'truncate' tests if this command is missing.

commit 39df80dcc0e485e69048bddbf33c259ce532e50d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 18 13:04:46 2012 +0100

    tests: Replace truncate command with 'guestfish sparse'.
    
    RHEL 5 didn't have the truncate command, but we can replace:
    
      truncate -s SIZE FILE
    
    with the roughly equivalent command:
    
      guestfish sparse FILE SIZE

commit 4846b84476015874d569c14c2c30fcd71aa4d54c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 18 10:11:19 2012 +0100

    fuse: Add replacement for fuse_opt_add_opt_escaped.
    
    RHEL 5-era FUSE didn't have this function.
    
    I copied the function out of upstream FUSE, since the license is
    compatible.

commit 50aa9533e4a505e1c64dbedddb30491bfbb755d6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jun 17 22:59:46 2012 +0100

    build: Define builddir and abs_srcdir when they are missing.
    
    RHEL 5-era autoconf did not define these, so define them manually
    when they are missing.
    
    Define builddir as '.'  The scripts require this.  It won't work
    in the srcdir != builddir case, but we don't care about that for
    RHEL 5.
    
    This commit also moves the builddir / abs_srcdir variable setting
    above the include of subdir-rules.mk, in case that include uses
    these variables.
    
    Useful script:
    
      for f in $(find -name Makefile.am | xargs fgrep '$(abs_srcdir)' -l) ; do
        if ! grep -q '^abs_srcdir' $f; then
          echo missing in $f
        fi
      done

commit dd216fedbdacfd641c2da4073ae26d3ccb6098a6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jun 17 23:13:22 2012 +0100

    ocaml: Use OCAMLOPTFLAGS when compiling .cmx (ie. native code) files.

commit 87de36670108a19b832e8f5ded8d413e7b575d70
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 16 10:19:04 2012 +0100

    configure: Look for mkisofs as well as genisoimage.
    
    For our purposes, the two tools are compatible.

commit 60a2f8706b305b4068df020598abee9566022e20
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 14 17:37:11 2012 +0100

    Ignore .gdb_history file.

commit 7b1cd65c4433124ef443d1eea8bca97356e7a40a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 14 17:36:17 2012 +0100

    ppc64: is_openable function needed on all platforms now.
    
    This fixes commit 295d6af48d1d8c5238d1536b0c6a2ece42b0b445.

commit cd6005128d52c01152abe5464f21cfd4f0605c28
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 14 16:21:09 2012 +0100

    Version 1.19.8.

commit 81ee155b9d385f73efa8540faea5725701d1ec5d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 14 12:38:01 2012 +0100

    tests: Add tests for extended attrs and SELinux, direct and via FUSE.
    
    Note that the SELinux + FUSE test is disabled because of:
    
    https://bugzilla.redhat.com/show_bug.cgi?id=811217
    https://bugzilla.redhat.com/show_bug.cgi?id=812798#c42

commit abbace68881b0917919913fe71bd738e45f36df5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 14 14:21:16 2012 +0100

    virtio-scsi: Increase udev timeout.
    
    In Koji, when you've got 200+ disks, udev times out before all the
    udev events have been processed.

commit d43e3d63de1622e98313bb797922dfd7d95ddd11
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 14 12:22:26 2012 +0100

    virt-edit: Document CVE-2012-2690.

commit 199cc2853c586b384a2b45154b06437d3fc38e89
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 14 09:57:28 2012 +0100

    Require febootstrap >= 3.17.

commit 8b15fb3e22cd8bf541ac142c00f15628c2b7bc40
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 13 23:25:50 2012 +0100

    Version 1.19.7.

commit 4c828dc568eef7425db7f4a65cb1482329aad72d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 13 16:24:29 2012 +0100

    tests: Add a test which adds the maximum number of disks and uses them.

commit 8735e92a1dae603f2584684ea802b0f5dc332543
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 13 14:49:06 2012 +0100

    virt-df: Use guestfs_max_disks instead of hard-coding limit of 25.
    
    And comprehensively fix it so it works with > 26 disks.

commit a9d7d044f552855a7ef78d953c0c2672e35bfc80
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 13 22:09:13 2012 +0100

    New API: device-index.
    
    This returns the index of the device, eg. /dev/sdb => 1.
    Or you can think of it as the order that the device was
    added, or the index of the device in guestfs_list_devices.

commit 46ed232dc2ff2f7dff91cd93a13d7ce6f2cec504
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 13 20:36:40 2012 +0100

    New API: guestfs_canonical_device_name.
    
    This API makes device names canonical, eg. /dev/vda1 -> /dev/sda1.

commit 998ebc333dbfe40c5953e36fb42f9610727a7532
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 13 18:28:22 2012 +0100

    lvm-filter: Make it work with > 26 devices.
    
    Thanks Alasdair Kergon.

commit c0a087b8236755e95371d5c352c9d29a3ca992c0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 13 17:27:56 2012 +0100

    daemon: Fix order of devices in guestfs_list_devices when > 26 disks.
    
    Sort the device names correctly, not just treating them as
    strings.  As a result, /dev/sdz < /dev/sdaa.

commit 4165e28b53d7024c38a171586acfb5c5b2c858b7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 13 14:42:21 2012 +0100

    New API: guestfs_max_disks.
    
    Returns the maximum number of disks that may be added to a handle.

commit 919b7e3f6c476c291744b98354208b04b0a670b3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 13 14:34:59 2012 +0100

    Update documentation on maximum number of disks.

commit cef979b2897725b735c68f5b806d332f4cea864d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 13 12:07:54 2012 +0100

    appliance: Add lsscsi to package list.

commit dbd489f95d08e6e6631f39924b0ad154f4ff8377
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 13 17:26:49 2012 +0100

    virtio-scsi: Fix disk name calculation.
    
    This fixes commit 0c0a7d0d868d153adf0600189f771459e1068b0a.

commit 69e2616b6c4965981b3f91396aa0c64a62c607ee
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 13 11:27:50 2012 +0100

    Require febootstrap >= 3.16.

commit 6e981fe5860631d1a996ad1c2961a78934b61a1a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 12 23:04:16 2012 +0100

    Version 1.19.6.

commit 320adf477805f703b0a1c79d86c3fb4078d11700
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 12 19:17:25 2012 +0100

    tests/md: Don't hard code /dev/vda in expected output of tests.
    
    Use a small sed script to canonicalize the device names.

commit 9a5c0d39081f9f40d7ad12fbb55fb6120046679c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 12 19:49:45 2012 +0100

    tests: Fix spelling in comment.

commit 7509cdf18e6d3fd96b10246f4d0417e5285e38f6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 12 18:51:59 2012 +0100

    tests/lvm: Don't hard-code /dev/vda in test.
    
    Hard-coding it breaks virtio-scsi because the devices are called
    /dev/sda etc.

commit 62c5b6db58911a5e51f59965619355437b7a7214
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 12 18:50:22 2012 +0100

    daemon: Always pass -F option to mke2fs.
    
    Apparently e2fsprogs only knows that "/dev/sda" is a whole device, but
    doesn't think that "/dev/vda" is.  On switching the default device
    over to virtio-scsi, that causes mke2fs without -F option to complain
    and ask for an interactive prompt.  Adding -F forces it to go ahead
    anyway.
    
    This caused several less-used APIs to break with virtio-scsi.

commit 0c0a7d0d868d153adf0600189f771459e1068b0a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 12 18:02:55 2012 +0100

    appliance: Add support for virtio-scsi.
    
    This requires febootstrap >= 3.15.

commit e0b5ecc801da55998405df77f5e21a79b2ba7caf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 12 14:52:43 2012 +0100

    Record output of qemu -device '?'.
    
    This allows us to find out what qemu devices are supported
    at runtime.

commit 295d6af48d1d8c5238d1536b0c6a2ece42b0b445
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 12 15:31:35 2012 +0100

    Require QEMU >= 1.0.
    
    QEMU 1.0 was released at the end of 2011.
    
    Remove all the cruft about detecting broken -machine type which
    was only required for QEMU 0.15.
    
    This also reverts commit 30ecbf3ec2ada68f7e125a180553e31b069033b7.
    Even on ARM you can pass -machine accel=kvm:tcg and qemu does the
    right thing, so I'm not sure why we wanted to disable that.

commit 7652b5aece3ac8fba5f34dc630fa772b3b63211f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 12 14:38:28 2012 +0100

    Remove ./configure --with-drive-if and --with-net-if options.
    
    These were used to select the default drive and network interface.
    They both default to 'virtio'.
    
    These were added back in the day when virtio was buggy, so that
    packagers could revert to using ide/ne2k_pci to work around distro
    bugs.  However virtio has been stable in qemu for a very long time, so
    it seems unlikely that any packager would need to use these, and in
    any case it would be better to do this detection at runtime (cf. for
    virtio-scsi).

commit 7590924022066f49d0adc48dbd05a4e8c053a5a4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 12 14:20:34 2012 +0100

    New API: fstrim - allow filesystem trim.

commit 668a0cebdf736a632f23764a927a095446fef1ca
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 9 22:00:46 2012 +0100

    Version 1.19.5.

commit 251b131e0a55cce21f6ee2240315903e34c4ffe1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 9 21:13:09 2012 +0100

    tests: Allow regression test for bug 690819 to be skipped.

commit 42475dd21fbdc551137fe815efadf08a87729642
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 9 20:50:25 2012 +0100

    blockdev_getbsz: Remove test.
    
    The output of this test depends on page size, so on ppc64
    it returns 64K.

commit 20137c8731d142797e2476e35fe724c95a8a7a06
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 9 20:18:09 2012 +0100

    fish: Change test-escapes so test is not endian-sensitive.
    
    The test used the external 'od' command to compare the output of
    guestfish with what it's supposed to be.  Unfortunately by default
    this outputs groups of 2-byte words, with the words' endianness
    affected by the current hardware endianness.  For example:
    
    x86-64$ echo -n ab | od
    0000000 061141
    0000002
    
    ppc64$ echo -n ab | od
    0000000 060542
    0000002
    
    By using 'od -b' instead we can output bytes instead of words, and
    there is no endianness issue, and the output is clearer:
    
    x86-64$ echo -n ab | od -b
    0000000 141 142
    0000002
    
    ppc64$ echo -n ab | od -b
    0000000 141 142
    0000002

commit ac2f9a42fbdacbea4840f9334ed50575f1006089
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 9 14:47:11 2012 +0100

    btrfs: Modify test to correctly detect btrfs availability.

commit 011666ae77b765b1a2b6b8e804d1cc1552f23e41
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 9 14:46:07 2012 +0100

    btrfs: Modify btrfs availability to test if the kernel supports btrfs.
    
    This is closer to the real meaning of "availability of btrfs", since
    just having the btrfs tool doesn't help much if it's not supported by
    the kernel too.

commit 4ba6aa3eaeb112a1468ad9189120d12e1df23709
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 9 13:42:13 2012 +0100

    New API: filesystem-available: tests for filesystem availability.
    
    This also creates an internal filesystem_available function within the
    daemon.

commit 4f671c829e33a218309f332621802d8d6f8d5040
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 8 19:34:53 2012 +0100

    ppc64: Update README with notes about ppc64 support.

commit 6cf15e8841897d3190c3e730e6eeae06fe4b8b1d
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Fri Jun 8 01:23:55 2012 +0200

    out-of-tree build/install fix for translations

commit 52af9a88b83b5d23695b733915dd91f27c67ab43
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 7 14:42:13 2012 +0100

    Version 1.19.4.

commit f90c01a5dc6a01284debdd0a45406f9d4a5e7159
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 7 09:18:12 2012 +0100

    Enhance BUGS script.
    
    Since RHBZ was updated, the old python-bugzilla program broke.  When
    it was fixed, I found the (undocumented) ordering of the results from
    the old tool was no longer true.
    
    This commit adds a small Perl script to sort the output predictably.
    Now bugs are sorted by both bug state and bug number, so the output
    should be more stable than before.
    
    Re-enable creation of the BUGS file in 'make dist'
    (this reverts commit 91f3456244e7843768da659e24ce0aeeb4ebe4b0).
    
    Also the BUGS file has been updated.

commit 4e5d3b06fb2f366c0010ae6aa15f9dee74261917
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 6 23:09:47 2012 +0100

    arm: Use #if defined instead of #ifdef.
    
    No functional change.

commit 1bdfc88eba7f932b2581d55ecf4455d0e70335c2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 6 13:42:17 2012 +0100

    ocaml: Fix parameters to ocaml_guestfs_create.
    
    The first parameter (not used) is a unit, so declare it properly.

commit 450493cf6b563389bd11f02284bd22d7ed90b5da
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 2 10:35:06 2012 +0100

    ppc64: Avoid "defined by not used" warning for is_openable function.

commit bbb21f923a77c0d6dde370688ba745367340ca45
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 31 23:24:22 2012 +0100

    Version 1.19.3.

commit 3893dc0b9436ebb4dd620c6ca9b1d038eacf83a6
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Wed May 23 22:51:31 2012 +0200

    Split off GObject tests that require an appliance

commit 148e8068267bcf9ce8ff3a5062747998f960619d
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Wed May 23 22:49:35 2012 +0200

    Fix out-of-tree build for GObject bindings

commit bcbb6bb760d45b3a640c5e0c9d0e0cf64c2cf0f2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 28 17:55:07 2012 +0100

    xattr: Refuse to set or get oversized extended attributes.
    
    See:
    https://www.redhat.com/archives/libguestfs/2012-May/msg00152.html

commit a7868dd3c940b6cee0894e6033ba611f01a423dd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 28 16:09:15 2012 +0100

    appliance: 'udevd' has been renamed, since it joined systemd.

commit a7e4a6c692554e4207b3bdff65946427e66e9fce
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 28 10:01:45 2012 -0400

    appliance: Move udev (common package name) to the common section.
    
    This should be just code motion.

commit a81165eb004d886cb5efaaecd9dca5cd8b39e66b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun May 27 21:53:21 2012 +0100

    Version 1.19.2.

commit 42dd5fa5b91fd5b27d6d4c8cc56958e17d6f534e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 26 23:07:03 2012 +0100

    Update to latest gnulib.

commit fe68cd77cbda4a8e19cd6e940c07b9afc1527610
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 25 16:52:19 2012 +0100

    Version 1.19.1.

commit 8e8a5764293d1b6bc3dbfb9409722e4c13384aec
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 25 14:03:24 2012 +0100

    tests: Add a test of non-ASCII character fidelity on various filesystem types (RHBZ#823887).
    
    Thanks Laszlo Ersek.

commit 6445bc5952efd47fb1aa0880d9038040551d72ed
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 25 13:09:10 2012 +0100

    doc: Add documentation covering use of utf8 option when mounting vfat (RHBZ#823887).

commit 73071b3163774ff9a514a05bc8e6fb35fa910787
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 25 15:42:02 2012 +0100

    trace: Fix display of non-printing characters.
    
    Previously the code would drop the first character in any sequence of
    non-printing characters that occurred within a string.
    
    Fix for commit e6f18c59d577dd0b443bc6a1d76f699c4e0dde9f.

commit fba81add94cde015afe8a65245cb4e60a1d3e6bf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 25 15:08:27 2012 +0100

    trace: Fix escaping of non-printable signed characters.
    
    Fix for commit e6f18c59d577dd0b443bc6a1d76f699c4e0dde9f.

commit 3936412e33ec268f63b30b6ff5a38e7b8fe4f752
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Fri May 25 14:56:53 2012 +0800

    sysprep: remove the data and log files of puppet
    
    Remove the data(keys) and log files of puppet.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit f00066d22b11bf40d0272f68565a2a27fea15627
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 24 15:40:36 2012 +0100

    inspection: Don't fail if /etc/HOSTNAME or /etc/hostname are empty files (RHBZ#823821).
    
    Change guestfs___first_line_of_file so that if the file is empty this
    returns an empty string instead of an error.  This is consistent with
    the behaviour of this function in the case where the file starts with
    a \n character, where it would previously have returned an empty
    string.
    
    Change all callers so that they handle this case.
    
    Then change the hostname parsing code so that it doesn't give up when
    /etc/HOSTNAME is empty, but falls through to the next alternative, and
    similarly for /etc/hostname.
    
    Thanks Todd Mummert for finding and diagnosing this bug.

commit cffb7fefc88a317f957785f6448fb24183c8c629
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 24 15:38:46 2012 +0100

    inspection: Use parse_release_file to parse ttylinux release file.
    
    parse_release_file should be used to set fs->product_name, instead of
    calling guestfs___first_line_of_file directory, although currently the
    two are equivalent.
    
    This is code motion and fixes
    commit b648b1813fc8e55db790435b5414d9be3ec765d2.

commit ee9ab52bc3e087f63dcc51d3b6ac5c79277425e1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 24 14:50:20 2012 +0100

    fish/mount: Add better error message when -m (mount) fails (RHBZ#824043).

commit 216a6d16abdfbc36a5514df34f59507ef825e33e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 24 14:50:00 2012 +0100

    fish: Remove inaccurate comment from code.

commit d5d9ceee8b56a10761e207ad9970ebf704fc46e8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 24 14:40:52 2012 +0100

    virt-make-fs: When writing vfat, add utf8 option to mount (RHBZ#823885).

commit 975a41db20eff2b5edf510f8a65005c915b21f27
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 24 12:30:50 2012 +0100

    virt-make-fs: Provide a clearer error message when mkfs fails (RHBZ#823883).

commit f904fa822316ff793e71d4d4ff7dc79e608dcb25
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 24 08:48:51 2012 +0100

    appliance: Include 'bzip2' in appliance (RHBZ#824716).
    
    Missing package caused this error in compress-device-out:
    
    libguestfs: error: compress_device_out: compression type bzip2 is not supported
    
    Thanks Mohua Li.

commit b8b5ed65c26dd19a0bc9f8282a50c6dff90c456a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 23 11:46:23 2012 +0100

    FAQ: Add section about using libguestfs in closed source programs.

commit 144d7cd98811472a5541d2c53c487e670657051b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 23 11:19:34 2012 +0100

    FAQ: Add a note about "child process died unexpectedly".
    
    This is a common search term on the main website, and there is no good
    information provided by Google at present.

commit c7d3aa9cd6c065158d43b3c7fe553e814c642d6b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 23 11:08:52 2012 +0100

    FAQ: Update Ubuntu instructions.

commit 0e05e9f6ce696cf2a5172eda3fe054367164106b
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Tue May 22 22:22:20 2012 +0800

    TODO: sysprep todo list clearance
    
    Remove the implemented features from TODO list.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 54028b9b669cfe495089a7652bb8cd06115f4907
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 22 14:53:57 2012 +0100

    java: Remove unnecessary imports from the generated Java code.

commit 87d604f88c44f891a338349e2b012b6deadf7896
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 22 13:50:19 2012 +0100

    debug: Add setenv debugging command.

commit f774f8fd8d107e6d820ce414f9765745ea75dad7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 21 16:27:04 2012 +0100

    Version 1.19.0.

commit 1f3b8b395b5a58b71736841d4ed3cd2c6235639e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 21 16:18:24 2012 +0100

    New stable branch: Version 1.18.0.

commit 91f3456244e7843768da659e24ce0aeeb4ebe4b0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 21 15:24:32 2012 +0100

    build: Temporarily disable generation of 'BUGS' file.
    
    Red Hat Bugzilla is broken: RHBZ#823510.

commit d51631034a84acb7ff68f5d5890e8092b18daffc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 21 14:35:07 2012 +0100

    Update API support.

commit 695b3c9633e3e96a558f80be2d73231bb53dcb0b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 21 14:34:46 2012 +0100

    Update PO files from Transifex.

commit 27b9c1c755724aa0ff5b36f90d8a8a70944b1dbb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 21 14:18:43 2012 +0100

    Update road map for 1.18 branch.

commit d1f6325e1069cdb5705dbdae5f82a765e570679e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 21 13:45:58 2012 +0100

    Update release notes for 1.18 branch.

commit a119e057d177fc3e89206c433efd8463df1a9826
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 18 11:14:34 2012 +0100

    sysprep: Credit Wanlong Gao, Fujitsu under 'AUTHORS' section.

commit f5e0c0e3eec1e85e62167540529664c965d2563e
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Fri May 18 17:20:04 2012 +0800

    sysprep: remove kerberos data in the guest
    
    Remove the generated kerberos data in the guest.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit b6d4c2921287b0e9aa8015d4d79de8d319972791
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Fri May 18 10:49:56 2012 +0800

    sysprep: remove ca certificates in the guest
    
    Remove the ca certificates.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 020e7aa505f6673c1a379ae00dd6d64eea472771
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 17 19:52:03 2012 +0100

    Version 1.17.43.

commit 88a854cf7fd80ce4a6c6c3ded3aaaa3c135a1964
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 17 17:19:09 2012 +0100

    virt-ls: Don't initialize path = NULL.

commit 32765e440cee03bb7b89d1aa58c7dea4f55458c8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 17 17:11:16 2012 +0100

    virt-ls: Fix --checksum option (RHBZ#822490).

commit b9331a2d73f2ce2e424329d35139e68f0fbe8c7a
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Tue May 15 22:29:19 2012 +0800

    NEW API: add new api btrfs-fsck
    
    Add the new API btrfs-fsck to check the btrfs filesystem.
    Btrfs is currently under heavy development, and not suitable for
    any uses other than benchmarking and review. But it'll be useful
    in the near future.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit a84d02e8d8fbb7d31cd124cd0eefe56cddeb3045
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Tue May 15 22:29:20 2012 +0800

    btrfs: change the return value of btrfs-set-seeding
    
    Change the return value from "r" to "0".
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit e9f6ce249230f6c03a96f721b5cab1768dfe839c
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Tue May 15 16:02:08 2012 +0800

    gobject: remove old generated files further
    
    also remove guestfs-gobject.c
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 7fffaf204ef59d6a068baa6b6b94a32eb6172846
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 15 08:38:46 2012 +0100

    gobject: Remove old generated files.

commit 2040a15ac7e54fd27d303f0f710d28b983f1f568
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 14 23:03:54 2012 +0100

    sysprep: Add missing 'utils.mli' to SOURCES.
    
    Consequently this file was also missing from the tarball.

commit 2fd2c85f6a42575749b9d38bd2f1512ae25db760
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 14 17:47:57 2012 +0100

    doc: Add notes on how GPT works on 4k sector disks.
    
    I used scsi_debug to create a 4k sector virtual disk:
    
      modprobe scsi_debug dev_size_mb=128 sector_size=4096
    
    I then used 'gdisk' to create lots of partitions, and used 'hexdump'
    to examine what was written to disk.

commit e8ec521dc64208016b0dc8dcb873324819ed734d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 14 15:32:08 2012 +0100

    todo: Notes about partitioning tools.

commit 18451abdf5b3618750af11da6579db547b266b8d
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Mon May 14 18:38:25 2012 +0800

    New API: add new api btrfs-set-seeding to enable or disable seeding.
    
    Add the new API btrfs-set-seeding to support the seeding-device
    feature for btrfs.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit a75020a06674a4ec77712c1d8000b51eac53f454
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Mon May 14 18:38:24 2012 +0800

    TODO: add note for libblkid
    
    Add the note about compatible in TODO for libblkid.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit b42dcb05dcfe737f631fd60750187d5d7db8ac69
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 14 12:01:24 2012 +0100

    examples: Further fixes to mount-local example program.
    
    * Set PS1 prompt properly for bash shells.
    * Touch a file into the root directory of the new filesystem.
    
    This fixes commit 46b6766156ace142443b36e20e55074c544ae6cc.

commit 2c50a5da4682b713d76c25cb4f2ef1591556367a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 14 10:49:09 2012 +0100

    example: Various fixes to mount-local example program.
    
    * Move MOUNT_OPTIONS to #define at top.
    * Move SIZE_MB to #define at top.
    * Set PS1 in subshell (doesn't work - why?).
    * Hide libguestfs errors from guestfs_mount_local_run.
    
    This fixes commit 46b6766156ace142443b36e20e55074c544ae6cc.

commit a219fede920dce9157f23ed8dec0f3aa18c6df44
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 14 08:22:03 2012 +0100

    debian: examples: Don't break when O_CLOEXEC is not defined.
    
    This affected Debian 6.
    
    This fixes commit 46b6766156ace142443b36e20e55074c544ae6cc.

commit 9cf19466f0b296cb20136c3c38eaf601612fd22b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun May 13 23:18:44 2012 +0100

    Version 1.17.42.

commit 034733e981024f0686dc00a3eb286ac12f256d96
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun May 13 23:01:15 2012 +0100

    examples: Add mount options "acl,user_xattr" to mount-local example.
    
    This fixes commit 46b6766156ace142443b36e20e55074c544ae6cc.

commit 46b6766156ace142443b36e20e55074c544ae6cc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun May 13 22:53:01 2012 +0100

    examples: Add an example of using the mount-local API from C.

commit 7201a48d18d03bf3b16141bcff8c56e842d3b1c1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun May 13 22:20:32 2012 +0100

    examples: Add if HAVE_HIVEX ... endif around virt_dhcp_address example.

commit 157f6fb18b7197f688ea761a4e52cd39287024f2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 12 17:22:36 2012 +0100

    qemu: Move -nodefaults etc logically together.
    
    This is just code motion.

commit eb29a9424ccaa56cc6b2b667a2fdb6a75d6d59af
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 12 14:18:05 2012 +0100

    arm: Add configure flag '--with-qemu-options'.
    
    This flag allows extra QEMU options to be passed on the command line.
    
    This is useful mainly on arm (see the notes in the updated README
    file).

commit 30ecbf3ec2ada68f7e125a180553e31b069033b7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 11 21:32:39 2012 +0100

    arm: Disable -machine, -enable-kvm options except on x86, x86-64.
    
    Presently KVM is only applicable to x86 and x86-64 (although that will
    change in future, and there are rumoured to be implementations for
    some current non-x86 architectures).  In any case having these options
    breaks ARM, so disable them for non-x86 architectures at the moment.

commit 10725acf9666c067df569fbcae86b48d8381ac81
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 11 21:33:50 2012 +0100

    arm: On Linux ARM kernels, the serial console is ttyAMA0.
    
    Cope with unnecessary lack of standardization.

commit 5c5979084536b8d03cd7cc37dd5a8a7a0b01fe56
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 27 11:05:08 2012 -0400

    arm: Disable test for -no-hpet during launch.

commit a3718c6b8be9bcbfd1e753c699f030d1852bc26e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 11 22:39:45 2012 +0100

    arm: Set minimum LIBGUESTFS_MEMSIZE at 128.
    
    For ARM Versatile ("versatilepb") architecture, memsize must be set to
    256 (megabytes) else the appliance is unable to boot.  Previously
    setting LIBGUESTFS_MEMSIZE=256 was not allowed.
    
    Versatile Express has larger limits.

commit 77afc92fcd08677f9a9ae3b4f6c6919eb8ec2b33
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 12 13:40:45 2012 +0100

    configure: Fix valgrind --vgdb test.

commit 0e960614ab0f7d878347d74229ffbb69a4a05540
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 12 13:14:42 2012 +0100

    configure: Add a comment about vmchannel_test.

commit e275786cb2bce728b1a5c8c705cdf76a904be386
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 11 14:20:23 2012 +0100

    Version 1.17.41.

commit a50db3be6072d70a14ea9a586f3f1c62ba20ecdb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 11 13:49:21 2012 +0100

    doc: Add a note about compiling under clang.

commit a1680f03b7d38bf007d29ac23035e5af33736b0e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 11 13:47:29 2012 +0100

    configure: Allow systemtap/DTrace userspace probes to be disabled.
    
    './configure --disable-probes' will disable these probes.  Otherwise
    they are autodetected as before.
    
    The <sys/sdt.h> produces lots of errors when you try to compile with
    these probes enabled under clang, so it is necessary to provide a way
    to disable them for clang users.

commit 042a0b063b22bd02bb72f4a78cf29ffe5553d4d8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 10 22:58:50 2012 +0100

    FAQ: Fix typo in download (thanks badnews@IRC)

commit 1581dbe79f79b44bc10dfe3d0724c8911d6f0778
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Thu May 10 23:18:22 2012 +0800

    sysprep: remove blkid tab in the guest
    
    Remove blkid tab cache in the guest.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 56475678264d90028c508daa488fafeed98b3042
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 9 16:29:39 2012 +0100

    configure: Replace 'echo -n' with 'AS_ECHO_N' macro (thanks Eric Blake).

commit 7b72c124288f7420dea4f5b4eb832f466ba46a47
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 9 16:11:08 2012 +0100

    Update to latest gnulib.

commit 5764ac12cfdecd1f807fb87ae7a2a9783907b42b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 9 16:12:55 2012 +0100

    bootstrap: Remove autopoint, po stuff from bootstrap script.
    
    It's not needed since we no longer use gettextize cruft.

commit d0ec0b4c8c085427896759a1a6e369d2f747fc7b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 8 22:58:05 2012 +0100

    Version 1.17.40.

commit af1439bc9f5c4a536c55df9c07bd1aec023beace
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 8 17:32:49 2012 +0100

    Updated PO files from Transifex.

commit a79b22a613b591432d024d65c549fe8957837f6b
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Mon May 7 22:44:39 2012 +0800

    sysprep: remove pam data
    
    Remove the generated pam data in the guest.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit dd23234f730db7add330bd06f87cab1f08654747
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat May 5 14:55:03 2012 +0100

    test-tool: Implement -V / --version option.

commit 3ea36903f26d5a235ec5a20219173e4a16c8ca95
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 3 18:05:32 2012 +0100

    Update API support.

commit eaa05ff012ba3f9971cd95d2ea14e34dceb69ec0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 3 16:50:25 2012 +0100

    Version 1.17.39.

commit e0f36898cb62bb1982890a33c18cbd1277d5a186
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 3 15:38:08 2012 +0100

    virt-df: Don't fail immediately if a disk is not accessible (RHBZ#789504).

commit bd91bd76d188e4a7402dd5d3c904f8cc128823b1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 3 15:37:59 2012 +0100

    virt-alignment-scan: Don't fail immediately if a disk is not accessible (RHBZ#789504).

commit 9e2cdd309b709ee1e88269ee3252768515bf56ad
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 3 15:23:14 2012 +0100

    virt-alignment-scan, virt-df: Add newlines after error messages.

commit a2cc317c03aeb4963fce03d9d8be93cdf3c3a475
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 3 14:21:21 2012 +0100

    virt-make-fs: Add a test of btrfs (regression test for RHBZ#816098).

commit c53ea071c690b1760b89a56f2a634bec00d2b554
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 3 13:44:49 2012 +0100

    virt-make-fs: Simplify test code.
    
    This is just code motion.

commit 0cc35251421bc5c4d5a682566e2d71b942bbcc4a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 3 14:31:37 2012 +0100

    virt-make-fs: Fix estimation when making btrfs (RHBZ#816098).
    
    This also disables data and metadata duplication, which is not very
    useful on a constructed filesystem on a virtual disk.

commit 93734c78d8f802fbd80418e6ddb333b21f060fa9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 3 14:30:49 2012 +0100

    virt-make-fs: Use mount instead of mount_options.

commit e60556d92725289a26ccb406c9c94be32b3251c8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 3 14:30:09 2012 +0100

    virt-make-fs: Fix filesystem type check when estimating ntfs.

commit 00202b9c2941c2b4ff514c5ea32818807f42acf4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 3 12:15:27 2012 +0100

    tests: Regression test for RHBZ#701814.
    
    This commit adds a tests/xml directory, and an LD_PRELOAD module which
    can fake arbitrary libvirt XML from an external file (and is therefore
    a much more flexible test than using the libvirt test:// driver
    alone).
    
    Also added is one regression test for:
    https://bugzilla.redhat.com/show_bug.cgi?id=701814
    
    Loading the given libvirt XML using Sys::Guestfs::Lib::open_guest
    used to fail with the error:
    
      format parameter is empty or contains disallowed characters at /home/rjones/d/libguestfs/perl/blib/lib/Sys/Guestfs/Lib.pm line 256.
    
    Thanks to Tom Horsley for supplying the test data.

commit f072a21f3aef6779aaa77329578ae3677a685d85
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 3 12:25:54 2012 +0100

    perl: Don't fail if 'type' (disk format) attribute is missing in libvirt XML (RHBZ#701814).
    
    Old versions of libvirt allowed you to define disks like this:
    
        <disk type='file' device='disk'>
          <driver name='qemu'/>
          ...
    
    Since the <driver> element does not have a 'type' attribute (which
    defines the format), we are supposed to do autodetection, so the
    format should be undefined.
    
    However what actually happened was that the code in
    Sys::Guestfs::Lib::open_guest received format as an empty string from
    the xpath query, causing libguestfs to give an error.
    
    If the xpath query returns the format as an empty string, undefine it.

commit 66a525ce5a4e95fb8576ea183e06e1eb730a135d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 2 16:33:40 2012 +0100

    fish: Add a regression test for the 'glob' command.

commit 620ad8eb1a5df298c5701a7b438b12f9627f06ab
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 2 16:14:41 2012 +0100

    fish: glob command now expands /dev/ patterns (RHBZ#635971).
    
    For example:
    
    ><fs> glob echo /dev/*
    /dev/vda
    /dev/vda1
    /dev/vda2
    /dev/vda3
    ><fs> glob echo /dev/v*/*
    /dev/vg_f16x64/lv_root
    /dev/vg_f16x64/lv_swap

commit 79bf966ceaa3508698f19bdc951ffc51693eb499
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 2 15:34:02 2012 +0100

    fish: Move 'feature_available' function to global.
    
    This is just code motion.

commit 29c5e052e46af9b66af69429b2e8ee5dfc0fadbe
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 2 14:44:54 2012 +0100

    fish: Clean up glob code and make it return error if malloc fails.
    
    This commit tidies up the code for the 'glob' command.  It also makes
    the command return an error if malloc fails (previously it would just
    print a message but not return any error indication).

commit 1304236c6c666ac0ef2174299f0a0270f3dec347
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 2 13:55:18 2012 +0100

    fish: Add --pipe-error flag to allow detection of errors in pipe commands (RHBZ#803533).
    
    For a test case, see:
    https://bugzilla.redhat.com/show_bug.cgi?id=803533
    
    In guestfish, we use the gnulib closeout module which sets up an
    atexit handler to detect if there were any errors on stdout when the
    program exits.  This is so we can fail correctly in out of disk space
    cases like:
    
     guestfish [...] > output
    
    However the atexit handler just checks that there was any error on
    stdout (using ferror).  If a pipe command such as:
    
     ><fs> command_with_lots_of_output | head
    
    ran at any time during the session, the error flag would be set
    (because the underlying writes failed with EPIPE errors).
    
    So the commit first adds a test for ferror (stdout) after each command
    that we issue.  This brings error handling closer to the point of
    failure, and so is generally a good thing.
    
    Secondly we reset the error flag after detecting and dealing with the
    error, so that avoids the redundant 'guestfish: write error' message
    produced by gnulib closeout.
    
    Thirdly we add a --pipe-error flag which causes guestfish commands to
    fail on pipe commands line the one above.  The default is off for
    backwards compatibility reasons.

commit 95a67b1e6ad315af0ea7bedbb5348512635e4834
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 1 19:49:54 2012 +0100

    Update release notes.

commit 500cc67f29b43ebb970f6f276967ee5e9959b140
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 1 14:08:39 2012 +0100

    Version 1.17.38.

commit e6bfb55f65a8248e1d18ac4fd9eb345651a66529
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 1 13:27:45 2012 +0100

    Turn libguestfs FAQ into a man page: guestfs-faq(1).

commit 922052c70fdc66859c78bbc89a7817aad141862a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 1 11:18:57 2012 +0100

    doc: Rewrite description section in man page guestfs(3).
    
    Make the introduction in the man page shorter and punchier, so it
    leads readers directly to other pages of interest.

commit 51f43402f630d73cbfe25e60565878a05e230df5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 1 08:57:41 2012 +0100

    Version 1.17.37.

commit 027fefd517b8a93c54611a6cc4c51a54fea1b9fe
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 30 11:33:19 2012 +0100

    Add gettext support for OCaml tools (virt-resize, virt-sparsify, virt-sysprep).
    
    Note that this support is optional: To enable it, install the
    ocaml-gettext library from
    http://forge.ocamlcore.org/projects/ocaml-gettext .  If this library
    is not installed, then configure detects this and inserts dummy
    gettext functions that do nothing.

commit 75514ab57a06e534f26698fe1725ca29b966c3ad
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 30 16:04:51 2012 +0100

    Remove gettextize.
    
    Replace the sociopathic nonsense in gettextize with a simple
    Makefile.am which does the same ... and is faster.

commit 6aa95e87c1f259589ff9c7812707e4b30b8f6fd7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 30 16:23:05 2012 +0100

    Remove "convenience header" "gettext.h" and use <libintl.h> instead.
    
    gettextize provides a local file called "gettext.h".  Remove this and
    use <libintl.h> from glibc headers instead.
    
    Most of this change is mechanical: #include <libintl.h> in every C
    file which uses any gettext function.  But also we remove the
    gettext.h file, and adjust the "_" macros.
    
    Note that this effectively removes the ./configure --disable-nls
    option, although we don't know if that ever worked.

commit ea74856d953aec39af6ee556221618fda644312f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 30 10:18:37 2012 +0100

    configure: There are now more OCaml tools than just virt-resize.
    
    virt-resize, virt-sparsify, virt-sysprep are all OCaml tools, so
    change what is printed in the report.

commit 79822d46e3d7785ae7b02272e6661f15a61f4b5e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 30 10:12:33 2012 +0100

    configure: Comment fix.

commit bb73cf0941ba9d34eb2ecf82d10ecb5fc5d2362d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 30 15:03:24 2012 +0100

    Move 'libguestfs.pc' (pkgconfig file) to src/ directory.
    
    Since it describes the C library, it's better in the src/ directory.

commit a23e84ee0283ef538f21d201d72176f83f4da4ae
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 30 09:42:36 2012 +0100

    todo: virt-sparsify whitelist option.

commit cc798540370658ecc1bba94c4ab4b64485c9bcc6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 27 15:35:50 2012 +0100

    debug: 'progress' (unsupported debug command) now checks argument is reasonable (RHBZ#816839).
    
    Thanks Yuyu Zhou.

commit d448ae0c2bff2079212734835899e17cac468620
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 27 09:10:43 2012 +0100

    gobject: Fix installation of headers.
    
    RPM build errors:
    error: Installed (but unpackaged) file(s) found:
       /usr/include/optargs-add_domain.h
       /usr/include/optargs-add_drive_opts.h
       /usr/include/optargs-btrfs_filesystem_resize.h
       /usr/include/optargs-compress_device_out.h
       /usr/include/optargs-compress_out.h
       /usr/include/optargs-copy_device_to_device.h
       /usr/include/optargs-copy_device_to_file.h
       /usr/include/optargs-copy_file_to_device.h
       /usr/include/optargs-copy_file_to_file.h
       /usr/include/optargs-e2fsck.h
       /usr/include/optargs-inspect_get_icon.h
       /usr/include/optargs-md_create.h
       /usr/include/optargs-mkfs_btrfs.h
       /usr/include/optargs-mkfs_opts.h
       /usr/include/optargs-mount_9p.h
       /usr/include/optargs-mount_local.h
       /usr/include/optargs-ntfsclone_out.h
       /usr/include/optargs-ntfsfix.h
       /usr/include/optargs-ntfsresize_opts.h
       /usr/include/optargs-set_e2attrs.h
       /usr/include/optargs-test0.h
       /usr/include/optargs-tune2fs.h
       /usr/include/optargs-umount_local.h
       /usr/include/session.h
       /usr/include/struct-application.h
       /usr/include/struct-btrfssubvolume.h
       /usr/include/struct-dirent.h
       /usr/include/struct-inotify_event.h
       /usr/include/struct-int_bool.h
       /usr/include/struct-isoinfo.h
       /usr/include/struct-lvm_lv.h
       /usr/include/struct-lvm_pv.h
       /usr/include/struct-lvm_vg.h
       /usr/include/struct-mdstat.h
       /usr/include/struct-partition.h
       /usr/include/struct-stat.h
       /usr/include/struct-statvfs.h
       /usr/include/struct-version.h
       /usr/include/struct-xattr.h
       /usr/include/tristate.h
    
    We want to put these headers into the subdirectory, but not
    guestfs-gobject.h.  This isn't easy with automake.

commit 1f0964536b7c9a4a165e9b041ef0e5340ead7e1f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 27 09:10:29 2012 +0100

    gobject: Fix whitespace in Makefile.am.

commit 23f8cab1e85fd77b053cc880d31687261c81e357
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Fri Apr 27 14:18:53 2012 +0800

    sysprep: Remove the data of dovecot
    
    Remove the data of dovecot.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit ac75e46c5a4d7c2e6330efd34f4c5a2a0bc71fe5
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Fri Apr 27 14:18:52 2012 +0800

    sysprep: remove the logfiles configured by logrotate
    
    Remove the logfiles configured by /etc/logrotate.d/*.
    Omit the logfile of "samba" and "sssd" which we removed
    them separately .
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit e493884a7600e4c71f31bb4041cca13a44c56236
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 26 18:03:58 2012 +0100

    Version 1.17.36.

commit 819cba54e6a19104de39ad1b153e5116d7028bca
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 26 17:55:54 2012 +0100

    btrfs: Fix btrfs test so it works with btrfs-progs in Rawhide.
    
    See: http://bugzilla.redhat.com/816346

commit a505423e589b4820745e855c49dded60afc04f6a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 26 15:33:12 2012 +0100

    lib: Remove the BUSY state.
    
    Originally this state was intended so that in some way you could find
    out if the appliance was running a command.  However there was never a
    thread-safe way to access the state of the handle, so in effect you
    could never do anything useful safely with this information.
    
    This commit completely removes the BUSY state.
    
    The only visible change is to the guestfs_is_busy API.  Previously you
    could never call this safely from another thread.  If you called it
    from the same thread it would always return false (since the current
    thread can't be running a libguestfs command at that point by
    definition).  Now it always returns false.

commit eafefab93756b980bdb892df86e1ac3e5b88a260
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 26 15:52:23 2012 +0100

    gobject: Use generator_built macro to ensure generated files are rebuilt properly.

commit d58cb029a3a2acd2f4d40a58ea845911cfd003ed
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Apr 26 13:30:31 2012 +0100

    gobject: Move headers into a subdirectory
    
    The gobject bindings generate a large number of header files, which pollute
    /usr/include when installed. This patch moves them all into a guestfs-gobject/
    subdirectory. guestfs-gobject.h remains in the same place.
    
    This change also moves generated source files into src/, because it makes the
    gobject directory a bit tidier.

commit 317ba894b3fb62156654cb50b8dc4ab36970f14e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 26 13:55:30 2012 +0100

    btrfs: Fix docs for btrfs_subvolume_set_default (thanks Matt Booth).
    
    This fixes commit 87ea7a04094d5ed40f3f047ff2b7a613d4d530d4.

commit 8fb67ee66acbdcff805984715567a92a30428aec
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Apr 12 09:29:45 2012 +0100

    gobject: Implement libguestfs events as signals
    
    Implement libguestfs events as GObject signals. Callback arguments are passed in
    a boxed object.
    
    Note that this patch fixes the length of the uint64_t array in the callback
    arguments at 16, whereas it is actually arbitrary length. This is to make it
    introspectable. There is currently no way to pass an arbitrary length array to a
    callback, and have its type introspected.

commit 6c88c3758b60f4c4ec9ec7fcaf89074949dd88a4
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Apr 4 16:49:17 2012 +0100

    gobject: Wrap literal sections in POD in CDATA sections

commit a2dc83cf03c3a040e12a3ac33ab6bc99e0faf5c4
Author: Matthew Booth <mbooth@redhat.com>
Date:   Tue Apr 3 16:28:47 2012 +0100

    gobject: NFC generated code formatting fix

commit 8cb30dc80550da06871b0becc3582b2cdc4948ae
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 26 12:56:34 2012 +0100

    rescue: Add --scratch option.
    
    This lets you create temporary scratch disks.

commit 39d79e677b684dfd49c852ee7ce4c4bf3d5cf56f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 26 12:56:01 2012 +0100

    fish: Add opaque field to the drives list for programs to use.
    
    Not used at present.

commit 2cc4314ecc4ab4f66446cb4ebd65d4f53da75acd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 25 23:08:24 2012 +0100

    Version 1.17.35.

commit beaa5288558fc78304bcd008b9254ae2725017f2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 25 22:58:25 2012 +0100

    appliance: Remove some unnecessary errors.
    
    virt-rescue prints errors such as:
    
      rm: cannot remove `/proc': Is a directory
      mkdir: cannot create directory `/proc': File exists
      rm: cannot remove `/sys': Is a directory
      mkdir: cannot create directory `/sys': File exists
    
    People have reported these errors (which are nothing to worry about)
    as bugs in the past, so avoid them where possible.

commit 2d414112f7439d3f5b1b56b2392ab080c961f90c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 25 19:42:01 2012 +0100

    btrfs: Enhance the btrfs device test.
    
    This enhances commit 87ea7a04094d5ed40f3f047ff2b7a613d4d530d4.

commit 12c5394d4cb379890c9c69c16d1d735674a2e80d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 25 19:26:57 2012 +0100

    tests: Add some more substantial test data.
    
    The two tarballs:
    
      8252 bytes   tests/data/filesanddirs-10M.tar.xz
     41152 bytes   tests/data/filesanddirs-100M.tar.xz
    
    contain, as their names suggest, highly compressed files and
    directories, with unpacked size respectively around 10M and 100M (the
    precise size after unpacking depends on the filesystem).
    
    These can be used for testing purposes.

commit e188eb8268cfba652cc65e09c848da88b6156fad
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 25 19:08:56 2012 +0100

    btrfs-device-delete: Use correct (sysroot-prefixed) path to filesystem.
    
    This fixes commit 87ea7a04094d5ed40f3f047ff2b7a613d4d530d4.

commit 87ea7a04094d5ed40f3f047ff2b7a613d4d530d4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 25 16:35:12 2012 +0100

    New btrfs APIs.
    
    Bind the easy parts of the 'btrfs' program.
    
    The new APIs are:
    
    btrfs-device-add: add devices to a btrfs filesystem
    btrfs-device-delete: remove devices from a btrfs filesystem
    btrfs-filesystem-sync: sync a btrfs filesystem
    btrfs-filesystem-balance: balance a btrfs filesystem
    btrfs-subvolume-create: create a btrfs snapshot
    btrfs-subvolume-delete: delete a btrfs snapshot
    btrfs-subvolume-list: list btrfs snapshots and subvolumes
    btrfs-subvolume-set-default: set default btrfs subvolume
    btrfs-subvolume-snapshot: create a writable btrfs snapshot

commit 3cc9703f901e85a589692b9d0bf5ef7cbf72ed73
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 25 16:33:31 2012 +0100

    btrfs: Modify mkfs-btrfs API so it takes a list of devices.
    
    btrfs filesystems can span multiple filesystems.
    
    Note this changes the API, but this API has not yet been released in a
    stable version of libguestfs.

commit bd1a699c15f8854f366abacb47152212e20675ea
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Wed Apr 25 10:29:52 2012 +0800

    TODO: remove sssd and samba in sysprep
    
    remove the TODO of sssd and samba in sysprep.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 046d6c20e76ac4201af574020330ceb9314531b8
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Wed Apr 25 10:25:11 2012 +0800

    sysprep: fix typo of the object
    
    Fix the typo of the OBJECT.
    I'm sorry for the copy and paste typo.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 303b159134de44f7b43ba90ccfc7be0fead8adfa
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Wed Apr 25 10:25:10 2012 +0800

    sysprep: remove the db and log of samba
    
    Remove the db and log of samba.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 580ae3297a04a1f531eeb5c42e060260626d410f
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Wed Apr 25 10:25:09 2012 +0800

    sysprep: remove the db and log of sssd
    
    Remove the db and log of sssd.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit a98d9f4840e0bad4d68875a772edd74db9285b1b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 24 19:36:33 2012 +0100

    todo: Suggest 'virt-customize' tool.

commit 0e49186814cb516c5f10fdb6606e64aaeacbef3f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 24 19:26:09 2012 +0100

    todo: Debian APT cache is now removed (thanks Wanlong Gao).
    
    This updates commit 7fc7c3aa5b8088abc52b5cc39b682cdaedd1ba84.

commit 5fab4db8def54112f3058307cb96769b794e0feb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 24 19:24:10 2012 +0100

    bugs: Update BUGS file.

commit d16868b9381ea696f7ed5d22b7d0c1a3bb56f0b3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 24 19:24:00 2012 +0100

    bugs: Print count of bugs in each section.

commit 37a3cdbc139167d7b77d84a761f681595ff7fc23
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 24 17:38:45 2012 +0100

    generator: Add explicit types to pod memoization code.
    
    This is just code motion.

commit a2d30626cb80a6546a2904d9a82a9b205f8f1270
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 24 17:17:59 2012 +0100

    Version 1.17.34.

commit 7fc7c3aa5b8088abc52b5cc39b682cdaedd1ba84
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Tue Apr 24 15:23:48 2012 +0800

    sysprep: remove the cache of package manager
    
    Remove the cache of package manager like yum and apt.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>
    
    RWMJ:
    - Small code cleanup.

commit 95515c45762471c4f807ce442e1be85aac0da511
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Mon Apr 23 16:41:51 2012 +0800

    sysprep: flag the system for reconfiguration
    
    Flag the system for reconfiguration by touching /.unconfigured .
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>
    
    RWMJ:
    - Updated so this is disabled by default, since it requires
      user intervention at next boot.

commit 148b51fe0ba8311336e649d089e8da83d5fb8b8c
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Mon Apr 23 08:58:44 2012 +0800

    sysprep: remove user accounts
    
    Remove user accounts from /etc/passwd, /etc/group,
    /etc/shadow, and the home directory of the user,
    except the root user.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>
    
    RWMJ:
    - Updated to use Augeas to delete accounts.
    - Disable this by default, since it is very invasive.

commit 7916f5d43c021ced2f13d2bf707dbc7702ee8f2b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Apr 22 23:22:56 2012 +0100

    Version 1.17.33.

commit 8d41470b6fc81b742896996393812b274514bca2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 21 22:27:39 2012 +0100

    sysprep: Don't enable every option by default.
    
    All current operations are enabled by default.
    
    Also:
    
    * The POD description is split into a heading and the description body.
    
    * An 'enabled_by_default' flag is added to the structure.

commit 97ef9afca77ee81a6c0d1a30cf4d367d7cefa2e3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 21 21:43:32 2012 +0100

    build: Change comment above OCaml tools.

commit 03d321d0225512bdcd136ac7cb086c0b292a9c09
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 21 15:37:43 2012 +0100

    guests: Add /etc/shadow file to fedora.img.
    
    This is used for testing file permissions and SELinux contexts.

commit c844a38d6e6990af00506afb434a6f7b40e5259f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 21 14:39:21 2012 +0100

    tests: Space before parens in perl code.

commit 2152affd3008703974d0d5c65515f5695dafb9ca
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 19 22:46:07 2012 +0100

    Update release notes.

commit 36f1eb922530b254631781bd6475ff6348f511af
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 19 10:50:44 2012 +0100

    configure: Test for tgetent, tputs and 'UP' symbols (from libtinfo).

commit e97b6a1bb15e8cad319dceff53c58f8267e8152f
Author: Jim Meyering <jim@meyering.net>
Date:   Wed Apr 18 11:18:19 2012 +0200

    maint: fix doc typos
    
    Fix typos spotted by http://github.com/lyda/misspell-check.
    * configure.ac: As above.
    * ocaml/examples/guestfs-ocaml.pod: Likewise.
    * fish/guestfish.pod: Likewise.

commit c253c69d0955242e5f23dc194ddbaf34764f79f7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 18 17:29:13 2012 +0100

    Remove obsolete valgrind rule from C API tests.

commit 58a5b5bd944655b028c915a91dad2220176986db
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 18 17:28:47 2012 +0100

    extra-tests: Check if valgrind supports --vgdb=no option.
    
    This option didn't exist in RHEL 6 valgrind.

commit 5d6a323b9358bb01233681b784fa67414a5d2c6d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 18 14:23:57 2012 +0100

    Check library still compiles without libvirt.

commit b0b5fdc69f6ee831f325760f95a164627b499f77
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 18 10:50:32 2012 +0100

    sparsify: Add a note about sparsify on tmpfs.

commit 4542401fee7a141204baea98dcdc9fa557878f85
Author: Matthew Booth <mbooth@redhat.com>
Date:   Tue Apr 17 10:17:58 2012 +0100

    Don't abort inspection if mdadm.conf ARRAY doesn't have a uuid

commit 158479ffc02837230fbff9377242500febf0d472
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 17 18:33:23 2012 +0100

    Version 1.17.32.

commit 255882a3f615c7727d2cc2f18f692513dc0a75e9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 17 17:41:43 2012 +0100

    python: Remove 'del g' from the docs, replace with 'g.close ()'.
    
    'del g' is a trap for the unwary.  If the handle has any other
    references, it does nothing (in fact, it can be actively dangerous if
    the user was expecting the appliance to go away).  In non-CPython it
    can be delayed arbitrarily long.
    
    Using 'g.close()' on the other hand is always safe.

commit 7995c513baf9929a1c5cefc30498a93b45eafd52
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 17 17:41:33 2012 +0100

    todo: Note about -cpu host.

commit 6065f21b109def2f083b5915bd119babffa8fa7a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 17 16:24:27 2012 +0100

    virt-alignment-scan: Fix error code.
    
    This fixes commit fb401ebff837f9df7c06acb8467b2c03d5b8ced0.

commit 84d450210b3ea01de3fe26b2cf1db2b492d77aec
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 17 15:03:02 2012 +0100

    resize, sparsify: Add a simple-minded check to stop indisk = outdisk.

commit 8d3d5a52d2746af91f770608cce5f47462f33aba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 17 14:54:48 2012 +0100

    sparsify: Fix comma/colon and quoting in qemu-img command.
    
    Colon characters are not allowed in qemu/qemu-img filenames.  There's
    no way to quote them.
    
    Comma characters CAN be used.  However they must be quoted (by
    doubling) when used in the '-o' option.
    
    Fix general quoting problems in the external command.

commit fb401ebff837f9df7c06acb8467b2c03d5b8ced0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 17 10:38:07 2012 +0100

    virt-alignment-scan: Add ability to list all domains.
    
    The output looks like this:
    
     F16x64:/dev/sda1      1048576         1024K   ok
     F16x64:/dev/sda2      2097152         2048K   ok
     F16x64:/dev/sda3    526385152         2048K   ok
    
    If the --uuid option is used, then UUIDs are shown instead of names.

commit 5ec0fba56e76409b234b0e0daa8a0edf06104812
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 16 15:53:34 2012 +0100

    gitignore: Move cscope.out to second section.
    
    This fixes commit 3c843e2129d7ce2d6b9bbc6c294cacf7385aa5e3.

commit 3c843e2129d7ce2d6b9bbc6c294cacf7385aa5e3
Author: Matthew Booth <mbooth@redhat.com>
Date:   Mon Apr 16 15:48:16 2012 +0100

    .gitignore: cscope.out isn't always at the top-level

commit 63cb25236b1d9b81f3732eddb5040e475a1e952a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 16 13:30:07 2012 +0100

    fuse: Improve reporting in mount-local when verbose is enabled.

commit 6c2b8340c355d0db7b3282833c84e5ea58bfb643
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Apr 15 21:53:43 2012 +0100

    Version 1.17.31.

commit 8104b2dfab32aea972ecfc4e89bf350b092e1952
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 13 13:13:50 2012 +0100

    New APIs for reading and writing ext2 file attributes and file generation.
    
    The new APIs are:
    
      get-e2attrs: List ext2 file attributes of a file.
      set-e2attrs: Set or clear ext2 file attributes of a file.
      get-e2generation: Get ext2 file generation of a file.
      set-e2generation: Set ext2 file generation of a file.
    
    These are implemented using the lsattr and chattr programs from
    e2fsprogs.

commit 9ccde76f611bf4658180717a41544350b5b4632a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 13 12:41:04 2012 +0100

    todo: Remove obsolete sections from the TODO file.

commit 2a5a5e15e2a6f95ec9ea8a3085db68d520296942
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 13 09:35:08 2012 +0100

    sysprep: Make the tests run quietly.

commit 1f373aa24667fef62378d58ac546ddd2adaf37e9
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Fri Apr 13 15:36:28 2012 +0800

    sysprep: bash_history: fix copyright
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit ecdfd2c8cccbf8aa27b5a90d66437132ebb501b7
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Fri Apr 13 15:36:27 2012 +0800

    sysprep: remove .ssh directory in users' directory
    
    Remove the .ssh directory of user "root" and any other
    users who have a .ssh directory in their home directory.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit b288f21e0c1f7f99d80b72e89a846b9f3b900af9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 13 08:43:37 2012 +0100

    Version 1.17.30.

commit 4b0e525d1dcabe5ffc9b323103ee757be397abb0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 13 08:31:01 2012 +0100

    tests: Fix reference to guestfish in test for RHBZ#811649.
    
    This fixes commit a9bd90abfb3d4519278dfff305b8b7033ae6d76a.

commit e14f545f810a9667a6e50f5667ed709766e6d6e4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 12 21:35:14 2012 +0100

    Version 1.17.29.

commit a9bd90abfb3d4519278dfff305b8b7033ae6d76a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 12 16:49:58 2012 +0100

    Add regression test to test funny filenames (RHBZ#811649).

commit d2183a62aadff11609b561d3f821ec7d6094aa39
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 12 17:07:49 2012 +0100

    lib: Escape , as ,, on qemu command line (RHBZ#811649).

commit 4be630edb31f654068509d470e8b44039580954d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 12 16:57:30 2012 +0100

    lib: Remove check_path function, limitation is colon, not comma (RHBZ#811649).
    
    Remove the bogus check_path function and move the functionality into
    the two places where it was being used.
    
      qemu -cdrom ,
    
    works fine, I tested it.
    
    Colon cannot be used in a block device filename anywhere, since the
    qemu block driver interprets it as a prefix.  There is no known way to
    work around this problem.  I checked this is true with kwolf.
    
    Comma is fine in -drive options, provided it is escaped by doubling it.

commit 4dba0e1e9d7fca190e7877856ce69618d99e85c9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 12 16:52:50 2012 +0100

    Revert "launch: don't add a drive twice"
    
    This reverts commit be47b66c3033105a2b880dbc10bfc2b163b7eafe.

commit a97e9429ea888b4732bbbcfdd85b9368dd6ef96c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 12 18:59:04 2012 +0100

    extra-tests: Add suppression for memory leak in FUSE.

commit 5b414f581f1e40f91e44914776b119ce3ef6594c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 12 18:43:59 2012 +0100

    extra-tests: ocaml: Use a short delay instead of Thread.yield.
    
    On the new faster computer, Thread.yield wasn't yielding, so the
    second thread would block the main test from proceeding (only when run
    under valgrind however).

commit 681377f1b274cba0a4881ad18ccf200b9a014e94
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 12 10:20:58 2012 +0100

    inspector: Update example XML.

commit 96b6504b09461aeb6850bb2e7b870a0a4c2f5edf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 12 10:15:35 2012 +0100

    inspection: Remove spurious warning for Ubuntu 10.04 with encrypted swap (RHBZ#811872).

commit a996f0d370d883374dbe2448f57b72966d20514e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 12 10:20:39 2012 +0100

    inspector: Fix incorrect arch in example-ubuntu.xml.

commit 6c276606d7cd124b2a0fcf50526bfa89142144d5
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Thu Apr 12 16:27:16 2012 +0800

    sysprep: remove the bash history of users
    
    Remove the bash history of users in home directory,
    and history of root.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit ed2a06708ce2527256581abc44ce2e0edaaa3147
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 12 08:22:53 2012 +0100

    website: typo: guestfs-performance.3 -> guestfs-performance.1

commit 292664c3ac496cc3a2473aa65f934c71305240e5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 11 23:00:39 2012 +0100

    Version 1.17.28.

commit 287d5a126e5337d8bedc7a60cf7dddd365f02d85
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Apr 8 16:53:00 2012 +0100

    New man page: guestfs-performance(1).
    
    This contains tips for engineering libguestfs for greatest performance.

commit 307e8bc51a7416fa62ec43568cb8ba1876490a62
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 11 22:02:19 2012 +0100

    docs: Add libguestfs-test-tool(1) and libguestfs-make-fixed-appliance(1) to guestfs(3) man page.
    
    Inexplicably these were not included before.

commit 3e164f15b77230b0961048893d03ec588fc8ab0e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 11 18:37:14 2012 +0100

    po-docs: Allow parallel builds in po-docs directory.
    
    The first time the directory is checked out from git, there are no
    *.pod files.  In a parallel build, the first thread notices this and
    runs the 'make -C .. update-po' rule, but the other threads also try
    to run at the same time and fail.

commit c1fb89e7fcaa806e913bf15ba2b4602583bd2f23
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 11 18:36:24 2012 +0100

    po-docs: No need to touch virt-sysprep.1 output file.

commit de2dc9f71dd284e033e999a4d0541848a7201b02
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 11 18:20:10 2012 +0100

    extra-tests: Add suppression for libvirt/gnutls leak.
    
    https://www.redhat.com/archives/libvir-list/2012-April/msg00322.html

commit b6dd7e72500cbfa4e13379b9f2b1d0ccfa7ebec3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 11 17:53:46 2012 +0100

    python: Add a regression test for RHBZ#811650.

commit 0f7de2279a4af0bb259c9e36fca5e5c3aa835301
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 11 17:43:47 2012 +0100

    launch: Set error when qemu fails early during launch (RHBZ#811650).
    
    This caused the Python bindings (and probably others) to
    segfault because guestfs_last_error(g) would return NULL.

commit f237ae2ad61ad583e5eacf5759b25c32bb7538a1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 11 17:24:55 2012 +0100

    python: Add PYTHONPATH to './run' script.
    
    Also:
    
     - tidy up the script
     - use the ./run script when running Python tests

commit 4ee518508fcc084f6d34c1c213b73a3abf13ddac
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 11 16:21:06 2012 +0100

    sysprep: Sort and align all arguments (thanks Wanlong Gao).

commit 16b2ffa97ea8b2872306bc4400605821440f6589
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 11 16:20:23 2012 +0100

    sysprep: Make a common Utils.compare_command_line_args function.
    
    This isn't quite code motion, since the new function also ignores case
    (which previously we didn't ignore).

commit a3d6629a0b54aca6d7b5b38750399b5396cdbf07
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 11 16:18:29 2012 +0100

    sysprep: Move skip_dashes function into Utils module.
    
    This is mostly code motion, but I also changed the function to use
    String.unsafe_get and raise Invalid_argument on failure.

commit edca57b49e88d179d996652a44f7d6ba5b9ca729
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 11 16:14:57 2012 +0100

    sysprep: Add utils.mli (interface) file.

commit b8fbbcf79147ee88c605726d74b2672b765e4d21
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 11 13:25:36 2012 +0100

    sysprep: Print some logging by default.
    
    It can be disabled using the --quiet option.
    
    The logging looks like:
    
    Examining the guest ...
    Performing "cron-spool" ...
    Performing "dhcp-client-state" ...
    Performing "dhcp-server-state" ...
    Performing "hostname" ...
    Performing "logfiles" ...
    Performing "mail-spool" ...
    Performing "net-hwaddr" ...
    Performing "random-seed" ...
    Performing "rhn-systemid" ...
    Performing "script" ...
    Performing "smolt-uuid" ...
    Performing "ssh-hostkeys" ...
    Performing "udev-persistent-net" ...
    Performing "utmp" ...
    Performing "yum-uuid" ...
    
    Reviewed-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit b10a3d718e4ff8957e8af4afafcd1680c386ad33
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 10 18:14:04 2012 +0100

    extra-tests: Disable valgrind vgdb.
    
    This leaves files called 'vgdb-pipe-*' in .

commit 7fe9905c4bcd29187ce865d16506d4bff0206cd0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 10 14:23:19 2012 +0100

    Version 1.17.27.

commit 5e054f873198b83947de328777d9ced3bfa39ad5
Author: Qin Guan <qguan@redhat.com>
Date:   Tue Apr 10 14:14:21 2012 +0100

    sysprep: Allow hwaddr to be removed on other Red Hat derivatives (RHBZ#811117).

commit 60b87d0a5c97a458cefb6c5d31eeede7709f5a3d
Author: Qin Guan <qguan@redhat.com>
Date:   Tue Apr 10 14:13:40 2012 +0100

    sysprep: Allow hostname to be set on other Red Hat derivatives (RHBZ#811112).

commit 8ae322e5a70e3d39ac9952f4bb15718f800e133a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 9 16:53:04 2012 +0100

    Use posix_fadvise when uploading or downloading files.
    
    But ignore it if the call fails, since the file descriptor could be a
    non-file (eg. /dev/stdout).

commit 669c0bd4075a1b61f61bf3a9dda7c80caca12f72
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 9 15:53:19 2012 +0100

    Fix libguestfs-make-fixed-appliance --help option so it displays usage.
    
    Previously it printed 'Internal error!'

commit 12a56dfc8a140d6cd016b0d783a94b50ccd81878
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 6 20:09:18 2012 +0100

    gobject: Remove guestfs-gobject.c from POTFILES.in.
    
    This file no longer exists after the sources were split across
    multiple files for the benefit of gtk-doc.

commit f2ac7c18a775dc10c3fa502f3de5ad01faa0efea
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 6 18:49:45 2012 +0100

    tests: Fix guest building so parallel 'make -jN check' works.
    
    This means renaming various temporary files (eg. fstab.tmp) that
    several of the scripts were using so they don't conflict
    (eg. fstab.tmp.$$).
    
    Also the rule:
    
      fedora-md1.img fedora-md2.img: guest-aux/make-fedora-img.pl
    
    causes the script to run twice in parallel when using 'make -jN'.
    Replace this with a stamp file so it runs once:
    
      fedora-md1.img fedora-md2.img: stamp-fedora-md.img
      stamp-fedora-md.img: guest-aux/make-fedora-img.pl

commit 418a048215b17dcf1f0c74693831306cbcf0f194
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 6 18:48:58 2012 +0100

    tests: Don't print "4" when running make-windows-img.sh
    
    The return value of the pwrite-device command -- 4 (bytes) -- is
    printed out.  Hide it instead.

commit d9f77f214bb8448139792c5a871dca2dfe9845db
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Apr 4 14:01:22 2012 +0100

    fuse: Add missing #include to guestmount.c
    
    Fix compilation failure on F17

commit 4b86f1ad03f617e60f68be6153ca75baaaedf754
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 4 12:46:40 2012 +0100

    debian: Suggest 'apt-get build-dep' to install dependencies.

commit ec162e7d587fae1a8137fa1b64ec3f45fc0d0e9c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 3 23:10:05 2012 +0100

    Update RELEASE-NOTES file for future 1.18 release.

commit 19494b19888bb63684aaa5b6b0c3e14773156f04
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 3 12:58:24 2012 +0100

    Version 1.17.26.

commit 465c97ebf4421cdf5aadfb6bcb623da8c2d99e8a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 3 10:52:27 2012 +0100

    parallel mount-local test: Don't run more than 12 threads.
    
    On the Koji builder that has lots of memory, this was trying to run
    something like 20 threads.

commit 999aac63eb9652e07a828d801feb691ce6d9d17b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 3 10:48:55 2012 +0100

    Use absolute paths where necessary in .gitignore file.

commit 5c8a241e5cd119f436a050ddbbf7ea73f83ff8e4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 3 10:24:23 2012 +0100

    inspection: Support Fedora 17+ (RHBZ#809361).
    
    Recognize grub2 as a bootloader, and /bin being a symlink to
    /usr/bin (ie. UsrMove feature added in Fedora 17+).

commit 04ddf3cfa2915c811b9a8b72fd3bd17484d26683
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 3 09:54:50 2012 +0100

    sysprep: Add GDM and session preferences to logfiles.

commit 25d156f262bc13ab90369b6703366f4132081d6e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 3 09:47:18 2012 +0100

    sysprep: Remove installation logfiles in /root.

commit a1d88b60e334f29b9e61f64a062e910ab63919d0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 3 09:43:12 2012 +0100

    sysprep: Include logfile glob list in the man page.

commit 817cebe3ad01867a6c8c1358330cdd26e25c6f34
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 2 19:09:52 2012 +0100

    Version 1.17.25.

commit 50009403b3c6663924bd029f8dde1deee8cc7abc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 2 10:12:38 2012 +0100

    New API: mkfs-btrfs for creating btrfs filesystems (RHBZ#807905).
    
    This allows all parameters from btrfs to be accessed.

commit 77ac6b73cde017452d48d53aaf6fa755502b05d5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 2 08:46:23 2012 +0100

    mkfs: Don't allow blocksize to be set on btrfs (RHBZ#807905).

commit f8a88def14f844e60f20d7887e249e32b57e7243
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Apr 1 21:55:09 2012 +0100

    extra-tests: Test virt-sysprep.

commit 95123a9144edc1ddb3ad67d75276ca3af70eddb8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Apr 1 20:02:25 2012 +0100

    sysprep: Add a test of the --script option.

commit 6282d92b1bc4fe57a92f939258d7ccee815fa6ab
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Apr 1 20:01:08 2012 +0100

    sysprep: Simplify and tidy up the test.

commit 9cb976ab5f9c37b90bfaeacbc1296647429b9bcd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Apr 1 20:00:36 2012 +0100

    sysprep: script: Documentation fix.

commit b1f997164ef6c34dbcdefdd7c7ee044255f83333
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Apr 1 20:00:28 2012 +0100

    sysprep: script: Miscellaneous fixes and cleanups to shell script.

commit de656448f7949d2b04e75455d5a2233d0c5856b9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Apr 1 20:00:06 2012 +0100

    sysprep: script: Wait for child process to exit.

commit 6c88ae851f80e766a94576fcea7c701994de05cc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Apr 1 19:59:32 2012 +0100

    sysprep: script: Remove useless check that script is executable.
    
    This check will fail if the script is on the path.  Also document
    that script must be on the path or else the full path to the script
    must be given.

commit 65e20e34dd7eecb234d75bfcb0c4b5aab7972583
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Apr 1 19:57:41 2012 +0100

    sysprep: Add some debug code when performing operations.

commit 64550dcad224cb48021f12de07d638181c6b295c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Apr 1 16:06:54 2012 +0100

    Version 1.17.24.

commit 94e94550ed0905d60173866e0ce1e41f9987c44c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Apr 1 13:17:32 2012 +0100

    sysprep: Add more files to CLEANFILES.

commit 7ed21d9a5c11d6bc8e9da3912cfcfc8a873ddef0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Apr 1 13:15:56 2012 +0100

    sysprep: When generating man pages, use 'run' script.

commit 3a58a00483df9ce02d8814981e4381a5f73c9a8b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Apr 1 09:28:24 2012 +0100

    Add po/remove-potcdate.sin to git and EXTRA_DIST.
    
    This file is produced by gettextize and required by 'make dist'.

commit 3b94cf504615bcbb0ff0cb4c01ba2b577f523733
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 31 23:15:04 2012 +0100

    Version 1.17.23.

commit 6e3de762782b050fe7ad675297089a42026f05c4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 31 23:17:05 2012 +0100

    Ensure that SOURCES are always in EXTRA_DIST, even if OCaml not available.

commit ad43dde9c87a6c3d58c626d2fa42dd68c2e15e01
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 31 21:41:10 2012 +0100

    sysprep: Implement 'script' operation for running general scripts against the guest.

commit 026f616650c41e42b7c3058a8637fe2d76bfb793
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 31 11:44:00 2012 +0100

    Rewrite virt-sysprep.

commit d00596dfbb386333c06744a20c514c0ccc8f2367
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 31 10:28:49 2012 +0100

    fish: Add a regression test for mount-local, mount-local-run commands.

commit e430ce89085dcda3ee9a6074629d38aebbccc53e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 30 18:42:02 2012 +0100

    Update translations from Transifex.

commit dd126109e58d5f5ff0bbfa67033d179dbef4218b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 30 18:27:26 2012 +0100

    Update API support.

commit ed96872bd2e43ac5bbf37023159688e67bf3346d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 29 20:31:54 2012 +0100

    Version 1.17.22.

commit b2cddfe2f5e7ed7ba45d83548ecbc8092bd8fc3a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 27 10:25:17 2012 +0100

    Add test of parallel mount-local calls.

commit c6f09fac0666260587f95bdfee3c20c9166dae94
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 14 08:44:41 2011 +0000

    New APIs: mount-local, mount-local-run, umount-local (FUSE support in the API).
    
    Add FUSE support directly to the API.  Instead of needing to use the
    external 'guestmount' command, you can mount the libguestfs filesystem
    space on a local mountpoint using an API call from any language.
    
    Note that although mount-local-run is marked as Cancellable, the
    current implementation does not support it, but it would be relatively
    simple to add it.

commit 49fdba0ae98b5b6995ccaf0f0ba4f542bfff7ce3
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Mar 29 13:40:49 2012 +0100

    gobject: Ignore generated guestfs-sections.txt

commit 1c5dc612bd3610602eb1a441cb9ad380392cc631
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Mar 29 13:40:22 2012 +0100

    gobject: Add split-out files to POTFILES.in

commit b9cb387a109f4d09cdef84a62194201e78f97cb7
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Mar 29 13:33:26 2012 +0100

    test: Thread function is a candidate for attribute noreturn.
    
    The start_test_thread function never returns, it is always
    cancelled by the main thread.

commit d67da6419ac025db7c48f82054d7153b2c71481d
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Mar 29 09:29:47 2012 +0100

    Partially revert "generator: Fix unescaped '<' and '>' in api descriptions"
    
    Don't escape < and > in verbatim sections.
    
    This partially reverts commit 09a4e7664b59789f90b6674f640f9d688e4f8b43.

commit 0c9361a3568c23581ab43cb926fe138669c4b168
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Wed Mar 28 23:30:59 2012 +0200

    Fix out-of-tree build for GObject bindings
    
    guestfs-gobject.h (in the source directory) was not found.
    
    In file included from <stdin>:4:0:
    /path/to/libguestfs/gobject/guestfs-gobject.h:23:37: fatal error: guestfs-gobject-session.h: No such file or directory
    compilation terminated.
    Error while processing the source.
    make[2]: *** [Guestfs-1.0.gir] Error 1

commit 4db251048bd0aca2b98247109f00e68c2080a71c
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Tue Mar 27 21:57:56 2012 +0200

    Fix out-of-tree build for Java bindings

commit 17c828d99550da31c33cc8a7e0f874dd651ded19
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Tue Mar 27 21:57:22 2012 +0200

    Fix out-of-tree build for appliance

commit 2b9167540fb1f8138519575568afef6dacafb1e1
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Mar 28 17:28:32 2012 +0100

    gobject: Remove gtk-doc from TODO

commit 3b0cb4dfdc5471933a8f0682f368b7486fd1ebec
Author: Matthew Booth <mbooth@redhat.com>
Date:   Tue Mar 27 13:44:55 2012 +0100

    gobject: Split sources into 1 file per class
    
    This greatly improves the usability of the generated gtk-doc.
    
    Although there is a lot of churn in generator_gobject.ml, this is almost
    exclusively code motion.

commit 3311e110c7364be42b90b96894adce628135d8bf
Author: Matthew Booth <mbooth@redhat.com>
Date:   Tue Mar 27 10:01:01 2012 +0100

    gobject: Add gtk-doc for GuestfsSession and GuestfsSessionClass

commit 321748d3c2313c159cbbe5f154e36a073a6a84b1
Author: Matthew Booth <mbooth@redhat.com>
Date:   Tue Mar 27 09:50:42 2012 +0100

    gobject: Add gtk-doc field descriptions for generated structs

commit e49bd34fb7e2c2bd66cf83797af2656b1a2d44b2
Author: Matthew Booth <mbooth@redhat.com>
Date:   Mon Mar 26 17:49:25 2012 +0100

    gobject: Add gtk-doc for optarg wrapper classes

commit 574d104b151db97f4eebc2ba058aba9c09705300
Author: Matthew Booth <mbooth@redhat.com>
Date:   Mon Mar 26 17:22:27 2012 +0100

    gobject: Drop references to Guestfs::<foo> in comments

commit e3758fc4309b8ce32cb255a52c25aa687b5a59da
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Mar 23 16:18:22 2012 +0000

    gobject: Handle various problem content in gtk-doc API descriptions
    
    Produce better gtk-doc for:
    * URLs
    * RHBZ# references
    * CVE references
    * API cross-references
    * Parameter references
    * Escaped characters

commit 6b13952657906b32e7cb60ef1c1be5754016e66b
Author: Matthew Booth <mbooth@redhat.com>
Date:   Mon Mar 26 16:23:45 2012 +0100

    gobject: Add basic gtk-doc for all parameters

commit ed5cc90ed52820d11d9da6e913697465160cbc6b
Author: Matthew Booth <mbooth@redhat.com>
Date:   Mon Mar 26 15:58:53 2012 +0100

    gobject: Add basic gtk-doc for properties

commit 9863dd387f71cc7f1344e7d489a3834bf038ba28
Author: Matthew Booth <mbooth@redhat.com>
Date:   Mon Mar 26 15:58:25 2012 +0100

    gobject: gtk-doc SECTION must be named after a source file

commit 1004b2ec25f5ab874a02652749f3ed304eee3074
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Mar 23 14:49:36 2012 +0000

    gobject: Include explicit types for all parameters

commit b0ebf37a9498320b8876aa0c3d3a432af5639165
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Mar 23 13:04:07 2012 +0000

    gobject: Add infrastructure to build gtk-doc

commit 4d0aa08b000743cb523792d0824f2514e2e45ffa
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Mar 28 19:19:58 2012 +0100

    java: Delete target file before running javah.
    
    javah from old GNU classpath won't overwrite the target *.h file,
    instead leaving the old one which results in a predictable build
    failure.  Delete the target so this won't happen.

commit 5ea27d740eb9a7a2fe666dd9ffa70114c0c42756
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Mar 28 19:06:01 2012 +0100

    fish: Fix compilation when libconfig is not available.

commit 3d174b39bff6118bca3068c20ff874924cbfa1fd
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Mar 28 19:02:58 2012 +0100

    Don't provoke -Wstrict-overflow warning from map_app_md_devices function.
    
    Unclear if this is a real bug or not.

commit f2fae5151f33e933f4d574dc4324b7a8a2ee393c
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Mar 28 19:01:56 2012 +0100

    Work around -Wstrict-overflow warning on gcc 4.5.1.

commit b169b03dd42b82218c7241f33425c27660e4bdae
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Mar 28 18:55:38 2012 +0100

    m4: Update .gitignore for old Fedora.

commit 8111b108d224dda868f257ac0ef23838991b3594
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Mar 28 18:19:54 2012 +0100

    configure: Don't fail if GOBJECT_INTROSPECTION_CHECK is not defined.

commit f35aadcd86a081756b35c1eb4326a9d23e82f21e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 27 17:39:59 2012 +0100

    tests: Don't include internal guestfs header in tests.

commit a33ea716015adf6a9bcf755aaf736294848f7ad2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 27 15:06:56 2012 +0100

    generator: Allow functions with no requires args, and with some optional args.
    
    Previously the generator disallowed such functions.

commit a138063acb32f6fccfef24381a9c61f08d68ea74
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 27 17:26:48 2012 +0100

    Ignore guestfs.pyo.
    
    This fixes commit e8ef35df267de6fd6308d0c49a6bdef41113cf19.

commit e8ef35df267de6fd6308d0c49a6bdef41113cf19
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Mar 23 12:53:31 2012 +0000

    Only ignore guestfs.* at the top level
    
    The guestfs.* rule appears to be for temporary appliance directories, which are
    only at the top level. It was matching more than that.

commit 13e5f1a3b1f6493ea5e576bdd607aedc2c7ddc82
Author: Matthew Booth <mbooth@redhat.com>
Date:   Tue Mar 27 15:38:41 2012 +0100

    generator: Remove doc reference to non-existent guestfs_inotify_watch_all

commit 09a4e7664b59789f90b6674f640f9d688e4f8b43
Author: Matthew Booth <mbooth@redhat.com>
Date:   Tue Mar 27 15:24:50 2012 +0100

    generator: Fix unescaped '<' and '>' in api descriptions

commit f5c31db5ed4225c263e6f508a85f38aa80411c0e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 26 18:28:00 2012 +0100

    fuse: Fix documentation for call to virt-filesystems.
    
    virt-filesystems requires -a/-d option.

commit f1d10672c7da94f8983b3b5d434e64b127da1242
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Mar 25 19:35:43 2012 +0100

    df: Avoid a compilation error if libxml2 is not available.
    
    virt_df-domains.o: In function `add_domain':
    /home/feeliwood/Downloads/libguestfs-1.17.21/df/domains.c:274: undefined reference to `guestfs___for_each_disk'
    
    guestfs___for_each_disk is only available when libvirt _and_ libxml2
    dependencies are available at compile time.
    
    Thanks Tho Huynh.

commit 88b5ee9d952fa3268fab54abb9e62aa3fef42927
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Mar 25 19:20:07 2012 +0100

    Revert "ruby: Replace deprecated rdoc/task and rake/gempackagetask."
    
    This reverts commit fd7a5a8bbdc69b9d2a92f6d05ac555334d0516bf.
    
    This breaks Ruby 1.8.7 in Fedora 16.

commit fc198a3b9aeaa76ee7d6ffc27402d25a4379dbbd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 22 10:05:27 2012 +0000

    Remove references to obsolete directory appliance/debian.
    
    This directory has not existed for a long time.

commit a14021078b6c52c54d84fd4f18ff83302d6c183a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 22 10:00:26 2012 +0000

    Remove debian/ subdirectory.

commit 55c4e7a0d3d6f06b6361dd48d42355eae7a10388
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 21 12:34:01 2012 +0000

    Version 1.17.21.

commit 7d2027295fb394dd5d8cbc1e960ea6a47d420225
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 21 10:55:23 2012 +0000

    filesystems: Implement parents of MD and VG devices (RHBZ#805070).

commit a8f8af950d5b178a77a3b6423fbbd1ba447858f9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 20 19:14:32 2012 +0000

    filesystems: Allow the parents column to contain multiple parents.
    
    A list of parents is passed for this column.
    
    This column is rendered as an (internally) comma-separated list.

commit 3f6cc550ff5dcaca813b19938daaf41baacb1efa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 20 17:17:02 2012 +0000

    New API: md-stat.
    
    This returns information about the underlying devices of an MD
    (software RAID) device.

commit 65ebec4a7a70cd179e4c39d72f539e500931c267
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 20 17:14:56 2012 +0000

    generator: Generate a .gitignore file specifically for java structs.

commit f62db21d8babc14d580f754b0bf4d0cbe3c5bc9d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 20 12:27:14 2012 +0000

    daemon: Set last errno to ENOTSUP when APIs are not available.

commit 7526df547c5bea9a0cb4370ca022e413388dce2e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 20 12:25:40 2012 +0000

    daemon: Add reply_with_error_errno function.
    
    This function allows you to pass an explicit errno back to the
    library.  reply_with_error is redefined as a macro that calls
    reply_with_error_errno with errno == 0.

commit c7dff02ccbb6bbe505c73df5d83bea8afdc188c3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 19 16:32:10 2012 +0000

    inspection: Set last errno to ENOTSUP when inspection APIs are not available.
    
    Previously there was no programmatic way to tell if inspection APIs
    were unavailable because they are not compiled in (because hivex isn't
    around).  This contrasts with daemon APIs where the availability is
    covered by the guestfs_available API.
    
    Change the inspection APIs so that when they are not available, the
    last errno is set to ENOTSUP.  (Note that ENOTSUP must be defined on
    all POSIX platforms).
    
    This allows programs to detect if they are using a version of
    libguestfs that was compiled without support for inspection, without
    having to parse error messages.

commit b8fc61bd9b87f9d55d37cd52f584f7706b2af078
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 20 09:11:16 2012 +0000

    todo: Document proposed attach-method fd:N

commit e1ffb1011566ec68246df33ca42774b44ad5006c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 19 10:20:08 2012 +0000

    po-docs: Rename LINGUAS -> linguas (RHBZ#804464).

commit 752bd8f6327eea4cee0fb77442b8250ec29df0ce
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 17 22:11:32 2012 +0000

    Make HTML from libguestfs-test-tool man page.

commit 7c2ebad357f996d6f88612cbd7fa2fbd95d78480
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 17 20:39:54 2012 +0000

    Version 1.17.20.

commit a4fd393663babbd242f209ed29033b3cb4943749
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 17 14:36:28 2012 +0000

    New API: vgmeta: Download volume group metadata.

commit 05461175c48b9d7ac7c42d0a243971f489578295
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 17 09:26:20 2012 +0000

    appliance: Add a tool to make fixed appliances.

commit fd7a5a8bbdc69b9d2a92f6d05ac555334d0516bf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 16 22:14:44 2012 +0000

    ruby: Replace deprecated rdoc/task and rake/gempackagetask.

commit f9c4fdfeea7d46634e00d0d9d3f22dfe7030a9ca
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 16 18:27:52 2012 +0000

    todo: Suggestion for virt-sysprep.

commit a6f47c285f09f86db67eb619952a0a3f715bb908
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 16 15:18:48 2012 +0000

    Version 1.17.19.

commit 14938b46a74467d0e4b1cd076ffd7fcbf06c26eb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 16 14:42:30 2012 +0000

    generator: Sort camel-case structs.

commit a43f35f5bb7c40b000083cd8be5cb1f28595a3f1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 16 13:28:13 2012 +0000

    New APIs: isoinfo and isoinfo-device.
    
    Get ISO primary volume descriptor information for either ISO devices
    or ISO files.

commit d17218c2107ada5e8e1c011fa51ed88b4873d9ef
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 16 11:05:42 2012 +0000

    appliance: Include genisoimage in the appliance.
    
    This is mainly useful for the 'isoinfo' tool, but 'genisoimage'
    itself may be interesting to have in future.

commit 6bee63beb45678ff937593af59748dfceacdc608
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 16 14:10:40 2012 +0000

    generator: Fix CompareWithString test.
    
    This type of test was not used, and in fact the generated test
    simply didn't work.

commit c8630300b8ab46c668da1c8d5c1cdb9d1e3a4552
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 16 14:10:00 2012 +0000

    generator: Fix FUInt{32,64} struct field types.
    
    We were not using an unsigned type in the XDR.  This doesn't
    affect data integrity or the protocol, but it makes it more
    complicated for the daemon to set these fields.

commit 710ec49bac8bce10bfc0b9ba4b34d877c22f7287
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 16 12:40:16 2012 +0000

    daemon: Don't call reply_with_* after split_lines fails.
    
    split_lines already sets reply_with_*, so calling it again would lose
    protocol synchronization.

commit 974dffc6769b732befe85bcd8f614b9600927631
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 16 10:44:04 2012 +0000

    inspect: Fedora/RHEL CDs are multipart if totaldiscs > 1, not > 0.

commit 553e50c105c9f4c6cacde48dc8ab05f8faa665db
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 16 10:43:40 2012 +0000

    inspect: Parse isolinux menu title from RHEL 6.2 Live CD.

commit 5749de39c2b44644662fb176784731bce851b828
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 16 10:42:46 2012 +0000

    inspect: Add comment documenting findings of RHEL 5, 6 install CDs.

commit 5411f3fd457a46f39ccbb317a2bbb5897731eef6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 15 16:45:37 2012 +0000

    Version 1.17.18.

commit 85a701c10c89a806850ce42450f820d63c482935
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 15 10:50:52 2012 +0000

    todo: Document further virt-sparsify improvements.

commit 98f066e27443287a393dc1fc9f9c0ede4f58be48
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 15 16:07:08 2012 +0000

    sparsify: Implement --zero option.
    
    This unconditionally zeroes the named partition or filesystem.

commit 1c1ecb2c419382f1677501b22cb98a06c7abe9a9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 15 16:01:51 2012 +0000

    sparsify: Add a note about encrypted disks to the man page.

commit 7283a5a2765c0670e9dceec70e626a49a30d269c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 15 15:49:22 2012 +0000

    sparsify: Unlink temporary overlay file if user presses ^C.
    
    Add a signal handler so this potentially large temporary file
    is removed when the user hits ^C.

commit 31c26be91f855d661ccdfc3eeb7d4626f4085a12
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 15 15:25:06 2012 +0000

    sparsify: Support sparsifying Linux swap partitions.

commit 8c9f6a64be9840a955e481e932f13d005c0de0de
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 15 10:32:27 2012 +0000

    sparsify: Use zero-device instead of dd if=/dev/zero to zero device.
    
    zero-device is more efficient in general, and avoids writing to blocks
    which are already zero.

commit b05611d8efbfad10518fe874d53292c6a1b7f2b9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 15 10:30:21 2012 +0000

    Use the new lvcreate-free API to create largest possible LVs.

commit 79c4ecc0f398d4317a3713e0691df873a7d4b663
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 15 10:25:26 2012 +0000

    New API: lvcreate-free: Create logical volume as % of free space.

commit 03d4345c8c8de4df1c9d4446b0817d85ff378aa9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 15 10:07:26 2012 +0000

    sparsify: Use new zero_free_space API.

commit d9bdb9587b4e1cad0c3e9997ea7d2b2a07aed0ad
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 15 09:43:04 2012 +0000

    New API: zero_free_space: zero free space in a filesystem.
    
    Add an API for doing what virt-sparsify was doing: freeing up free
    space in a filesystem.
    
    The current implementation is simple-minded: we create a file, fill it
    with zeroes until we run out of space, then delete the file.  However
    the description leaves it open to do a better implementation, eg.
    using sparsification support that is currently being worked on in ext4
    and qemu.
    
    The implementation also sends progress notifications, which is an
    advantage over the old 'dd' method.

commit 7934ea2395d2a417fbc20efc22573113f7ae9d7a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 15 16:07:28 2012 +0000

    sparsify: Only print qemu-img command if verbose.

commit 91cede3465cd2496a01a89d5c8815df7c326c2ec
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 15 13:53:32 2012 +0000

    inspect: Ignore missing HKLM\SYSTEM\MountedDevices (RHBZ#803664).
    
    When a Windows guest doesn't have a HKLM\SYSTEM\MountedDevices node,
    inspection fails.  However inspection should not completely fail just
    because we cannot get the drive letter mapping from a guest.

commit 2bc922dd8e12bcf05e0aeef8a8b60b6aab9ee915
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 14 23:06:44 2012 +0000

    inspector: Update man page to describe how to access inspection info from other languages and guestfish.

commit c23f3b8e527bde9a83dd7ae24273db6da87a7268
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 14 21:13:43 2012 +0000

    Add guestfsd.suppressions file to EXTRA_DIST.

commit e743eb3984b6d9f75e942fed06e167911b45a4ee
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 14 19:57:36 2012 +0000

    Version 1.17.17.

commit 606732d02e678161ff433040a21d54fc2ea8bb43
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 14 19:30:46 2012 +0000

    Use O_CLOEXEC / SOCK_CLOEXEC for almost all file descriptors.
    
    The presumption is that all file descriptors should be created with
    the close-on-exec flag set.  The only exception are file descriptors
    that we want passed through to exec'd subprocesses (mainly pipes and
    stdin/stdout/stderr).
    
    For open calls, we pass O_CLOEXEC as an extra flag, eg:
    
      fd = open ("foo", O_RDONLY|O_CLOEXEC);
    
    This is a Linux-ism, but using a macro we can easily make it portable.
    
    For sockets, similarly:
    
      sock = socket (..., SOCK_STREAM|SOCK_CLOEXEC, ...);
    
    For accepted sockets, we use the Linux accept4 system call which
    allows flags to be supplied, but we use the Gnulib 'accept4' module to
    make this portable.
    
    For dup, dup2, we use the Linux dup3 system call, and the Gnulib
    modules 'dup3' and 'cloexec'.

commit 13e7a1b400b7e2a5e9335d25205b09e74c89d858
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 14 19:29:52 2012 +0000

    java: Make sure generator is rerun when necessary to rebuild generated files.

commit d042e56f2a21553795c108a5b76a9d5eec219b1b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 14 19:29:11 2012 +0000

    java: Enable -Xlint:all and fix all warnings.

commit 6b233bd39e8cff7be303a5a82eb0cbb06c0573bc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 14 19:28:13 2012 +0000

    todo: More ongoing code cleanups.

commit 302309921a8cde83eb19a7c25b7ee43932b91a05
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 14 16:13:40 2012 +0000

    appliance: Enhance --enable-valgrind-daemon with a suppressions file.
    
    This lets us suppress errors in system libraries.

commit 5da61d30520315a7d5060137a6c109f2109a7631
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 14 16:12:54 2012 +0000

    daemon: When copy subprocess fails, print return code.
    
    Useful for debugging.

commit 9974c42a29d60e6d1364c7d39f8c952604d41012
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 14 12:53:37 2012 +0000

    todo: Document ongoing code cleanups.

commit f8762715215df9f3f81d1d29b1ed25e1e8e9554d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 14 12:52:55 2012 +0000

    daemon: labels: Memory leak in 'set_label'.
    
    This fixes commit d1711dae9dbd7f516469f88807604894c1304228.

commit 7e32d892d76a31f55e2a4151902623b9949e3efa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 13 08:45:49 2012 +0000

    Version 1.17.16.

commit f76a88011a993d059beafe090a21a20be1cb9f4d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 13 08:23:56 2012 +0000

    Replace 'int' with 'size_t' passim.
    
    Analyze all uses of 'int' in the code, and replace with 'size_t' where
    appropriate.

commit 14df5fa5d1731a502332e9d4a41f54ee3d4a4dac
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 13 08:19:11 2012 +0000

    daemon: Implement a growable strings buffer type.
    
    Previously a lot of daemon code used three variables (a string list,
    'int size' and 'int alloc') to track growable strings buffers.  This
    commit implements a simple struct containing the same variables, but
    using size_t instead of int:
    
      struct stringsbuf {
        char **argv;
        size_t size;
        size_t alloc;
      };
    
    Use it like this:
    
      DECLARE_STRINGSBUF (ret);
    //...
      if (add_string (&ret, str) == -1)
        return NULL;
    //...
      if (end_stringsbuf (&ret) == -1)
        return NULL;
      return ret.argv;

commit d66dd2260c724bdfe57a8595aac37c8e9173cee5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 12 16:27:10 2012 +0000

    Fix strict-overflow bugs and reenable this warning.
    
    In two places, we were counting things in an array using an 'int'.  In
    theory, the int could overflow, so gcc determines this to be undefined
    behaviour.
    
    The fix is to use size_t or ssize_t instead.

commit 17182af3a6de8e3e94e0a914416c54f09bb74007
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 12 15:14:54 2012 +0000

    fish: remote: Output from close event now passed over stdout (RHBZ#802389).

commit f7c744bbf819b5984cbd3569d35d82a0451996b3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 12 15:13:29 2012 +0000

    fish: remote: Make sure global cleanups are called for guestfish --listen.
    
    Return to the main program ('fish.c') and perform global cleanups when
    the guestfish remote server exits.

commit b3a9e818686c83caeb5b4fd9763437eac0d32654
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 12 15:11:33 2012 +0000

    fish: remote: Move close_stdout just before accept() call.
    
    This is just code motion.

commit 1f603bfd6d7cd17e88f737a496b7e5ee053750c2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 12 15:09:15 2012 +0000

    fish: Rename tests and make test paths relative.
    
    When these tests were originally in the old regressions/ directory,
    they used to refer to guestfish via the path '../fish/guestfish'.
    Some of the tests were also called 'test-guestfish-*'.
    
    Now that the tests have been moved into the fish/ directory, neither
    of these things make sense.  So change the relative path to
    './guestfish' and rename all 'test-guestfish-*' as 'test-*'.

commit 2c8ead5aa0e6b821bf2d21a89e437e9a6c0ed1ca
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 12 14:10:05 2012 +0000

    tests: Remove/fix unused variables warnings.

commit 100e30763ea6ef3585d807bdecd32658275ae257
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 12 12:04:46 2012 +0000

    Version 1.17.15.

commit 099e3dd9f129e05bff5512855ea89530a7999004
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 12 12:19:59 2012 +0000

    tests: Remove unused variable.

commit 5cad29043fa53ab8f499db276fe1a9a89ab2b21b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 12 11:22:40 2012 +0000

    configure: Enable more warnings, and some cleanup.
    
    However -Wstrict-overflow is still disabled, see:
    http://gcc.gnu.org/bugzilla/show_bug.cgi?id=52560

commit 6292e630da080eb5d3427af6190eb68fe4eb1415
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 12 11:47:21 2012 +0000

    erlang: Remove unused variables.

commit e9e0920c00c55894358559bcdbd89d55cbb66d2a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 12 11:47:09 2012 +0000

    format: Remove unused variables.

commit 13c2db39abff3c0050eade5bcce997afdf04d721
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 12 11:46:49 2012 +0000

    daemon: Remove unused variables.

commit 46d1280100b025de2a448331306e794d688748bd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 12 11:29:06 2012 +0000

    inspect: Move variable decl to top of function.

commit 4bcd0b3c1766e459426e7d4138619790d4dd77d8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 12 11:27:32 2012 +0000

    inspect: Use 1/0 instead of true/false, and fix a bug in UUID parsing.
    
    UUID parsing returned 'false' (ie. 0 == OK) when the UUID contained
    illegal characters.  Now it returns -1 == failure.

commit cd3f2986eee8dbadc8253d4c3462f7e214f1236d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 12 11:26:55 2012 +0000

    lib: Remove some unused variables.

commit 1aa72017ca1efc422d3be13077a3d9c769922c82
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 12 11:26:29 2012 +0000

    lib: Use size_t instead of int for array iterator.

commit 3d279d15c192779a290892e1789fa74360f002ff
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 12 11:25:13 2012 +0000

    inspect: Use uint64_t for maximum file size in bytes.

commit b8cdf6c2b9d12df6acbe295fd75c8c59c8b7eec1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 12 11:24:51 2012 +0000

    lib: Use size_t for allocation size in safe realloc function.

commit 24413ac4d8c8d64b3339f9e61886db8f7fbfed4f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 12 11:23:57 2012 +0000

    bindtests: Use size_t instead of int for array iterators.

commit e6f18c59d577dd0b443bc6a1d76f699c4e0dde9f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Mar 11 20:12:41 2012 +0000

    Coalesce printable characters in debug and trace messages (RHBZ#802109).

commit 5b7b1c43ab85bb75bdb36844cce1cc124d5df4f2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 9 17:26:19 2012 +0000

    Document error message from resize2fs (RHBZ#755729, RHBZ#801640).

commit 2fb545b840745f6d944d89872f1d7372821b30cc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 9 16:53:02 2012 +0000

    resize2fs: Run 'e2fsck -f' automatically if filesystem is not mounted.

commit 4c9218658e4d4b769acaa41d999b4bce437fbc37
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 9 16:52:28 2012 +0000

    e2fsck: Comment, whitespace, error message cleanups.

commit 99923c7cd0e2d729d0205f872a8ae28775b1b8af
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 9 16:15:41 2012 +0000

    Mark e2fsck-f as deprecated, replaced by e2fsck API.

commit dfe30bdfe70f18d61404b41300f274480163c44d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 9 16:13:49 2012 +0000

    Revert "ext2: tweak the error returned message of resize2fs-M(BZ755729)"
    
    This reverts commit 0eaf06e673833bc25673d5c3d2487fffae310285.

commit d0cf52b9118ab18bfffc7e4397531192610a7371
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 9 16:01:17 2012 +0000

    Version 1.17.14.

commit baa5e1ea5167b3a1c3bf9b6400834cbaf2ac3136
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 9 10:37:06 2012 +0000

    example: Copying a directory between two guests using threads.

commit f1f045adf8d00549dd3efa3619e1162f9004b61e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 9 12:05:43 2012 +0000

    Close all file descriptors and remove all signal handlers in the recovery process.
    
    If the parent process uses a pipe (or any fd, but pipes are a
    particular problem), then the recovery process would hold open the
    file descriptor(s) of the pipe, meaning that it could not be fully
    closed in the parent.  Because the recovery process doesn't use
    exec(2), this wasn't avoidable even using FD_CLOEXEC.
    
    Avoid this by closing all file descriptors when starting the recovery
    process.
    
    After discussion with Dan Berrange, he points out that it's also a
    good idea to set signal handlers to the default after forking, so that
    any signal handlers set up in the parent don't affect the child.

commit 99702fe443383707b9d9c1b84570baf3bebf9253
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 8 19:27:37 2012 +0000

    extra-tests: Export LIBVIRT_DEFAULT_URI to pick-guests.pl.
    
    This fixes commit 2912e4e1173226f461517a0008664e01b5d3066d.

commit f8e7a41e678c3bd7ede50a38b1da7f3a5f92ddea
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 8 17:39:11 2012 +0000

    Version 1.17.13.

commit 2912e4e1173226f461517a0008664e01b5d3066d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 8 16:19:20 2012 +0000

    extra-tests: Check that guests are accessible before picking them.

commit 0721464b83915fbfae6d6a9da787f5069b2c6d6a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 8 15:01:55 2012 +0000

    fish: Document that guestfish sets pgroup to true (RHBZ#801273).

commit 270daae52b6a96b4d05cbe03e0b31a0b2e4ac1ae
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 8 14:49:23 2012 +0000

    inspect_apps: Avoid double-close on error path (found by Coverity) (RHBZ#801298).
    
    Error: USE_AFTER_FREE:
    /builddir/build/BUILD/libguestfs-1.16.5/src/inspect_apps.c:392: freed_arg: "fclose" frees "fp".
    /builddir/build/BUILD/libguestfs-1.16.5/src/inspect_apps.c:404: deref_arg: Calling "fclose" dereferences freed pointer "fp".

commit 3f3b08a6bc610ca0886e02972257dfcb633a9d40
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 8 14:36:25 2012 +0000

    dbdump: Avoid double-close on error path (found by Coverity).
    
    Error: USE_AFTER_FREE:
    /builddir/build/BUILD/libguestfs-1.16.5/src/dbdump.c:132: freed_arg: "pclose" frees "pp".
    /builddir/build/BUILD/libguestfs-1.16.5/src/dbdump.c:142: deref_arg: Calling "pclose" dereferences freed pointer "pp".

commit b2c1d8be39d4689267ef7e4188e2cf936b30628f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 8 14:30:10 2012 +0000

    daemon: glob: Initialize glob buffer (quiet Coverity warning).
    
    Error: UNINIT:
    /builddir/build/BUILD/libguestfs-1.16.5/daemon/glob.c:32: var_decl: Declaring variable "buf" without initializer.
    /builddir/build/BUILD/libguestfs-1.16.5/daemon/glob.c:36: uninit_use_in_call: Using uninitialized value "buf.gl_offs" when calling "rpl_glob".
    /builddir/build/BUILD/libguestfs-1.16.5/gnulib/lib/glob.c:557: read_parm_fld: Reading a parameter field.
    /builddir/build/BUILD/libguestfs-1.16.5/daemon/glob.c:36: uninit_use_in_call: Using uninitialized value "buf.gl_pathc" when calling "rpl_glob".
    /builddir/build/BUILD/libguestfs-1.16.5/gnulib/lib/glob.c:557: read_parm_fld: Reading a parameter field.

commit 3345444cccfe2e2fb07d4769d1e764eca59dd6f9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 8 14:11:18 2012 +0000

    comment: Note time-of-check to time-of-use race found by Coverity.

commit ae0f9f149b2b527b924d4532aa38302056d8a6b0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 8 13:53:04 2012 +0000

    daemon: inotify: Check event->len in inotify struct is reasonable.
    
    The Coverity error is this (which I think is wrong):
    
    Error: TAINTED_SCALAR:
    /builddir/build/BUILD/libguestfs-1.16.5/daemon/inotify.c:211: tainted_data_argument: Calling function "read" taints argument "inotify_buf".
    /builddir/build/BUILD/libguestfs-1.16.5/daemon/inotify.c:232: var_assign_var: Assigning: "event" = "(struct inotify_event *)&inotify_buf[n]". Both are now tainted.
    /builddir/build/BUILD/libguestfs-1.16.5/daemon/inotify.c:258: lower_bounds: Checking lower bounds of unsigned scalar "event->len" by "event->len > 0U".
    /builddir/build/BUILD/libguestfs-1.16.5/daemon/inotify.c:272: var_assign_var: Compound assignment involving tainted variable "16UL + event->len" to variable "n" taints "n".
    /builddir/build/BUILD/libguestfs-1.16.5/daemon/inotify.c:228: lower_bounds: Checking lower bounds of unsigned scalar "n" by "n < inotify_posn".
    /builddir/build/BUILD/libguestfs-1.16.5/daemon/inotify.c:281: tainted_data: Using tainted variable "n" as an index into an array "inotify_buf".
    
    Adding a sanity check of event->len is prudent.

commit 3b3d9ca4e1fa0a4f566cb2a8008540ee640b738b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 8 13:23:15 2012 +0000

    daemon: debug: Close fd along error path (found by Coverity).
    
    Error: RESOURCE_LEAK:
    /builddir/build/BUILD/libguestfs-1.16.5/daemon/debug.c:469: open_fn: Calling opening function "open".
    /builddir/build/BUILD/libguestfs-1.16.5/daemon/debug.c:469: var_assign: Assigning: "fd" =  handle returned from "open("/proc/sys/kernel/core_pattern", 1)".
    /builddir/build/BUILD/libguestfs-1.16.5/daemon/debug.c:474: noescape: Variable "fd" is not closed or saved in function "write".
    /builddir/build/BUILD/libguestfs-1.16.5/daemon/debug.c:476: leaked_handle: Handle variable "fd" going out of scope leaks the handle.

commit 4dd26c28a3786f756c20f204488bfbcfc5e75309
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 8 12:21:09 2012 +0000

    fish: Properly free up strings, lists along all error paths (found by Coverity).
    
    This also includes some tidying up of the generated code.
    
    Error: RESOURCE_LEAK:
    /builddir/build/BUILD/libguestfs-1.16.5/fish/cmds.c:13254: alloc_fn: Calling allocation function "parse_string_list".
    /builddir/build/BUILD/libguestfs-1.16.5/fish/fish.c:1386: alloc_fn: Storage is returned from allocation function "realloc".
    /builddir/build/BUILD/libguestfs-1.16.5/fish/fish.c:1386: var_assign: Assigning: "argv_new" = "realloc(argv, 8UL * argv_len)".
    /builddir/build/BUILD/libguestfs-1.16.5/fish/fish.c:1392: var_assign: Assigning: "argv" = "argv_new".
    /builddir/build/BUILD/libguestfs-1.16.5/fish/fish.c:1396: return_alloc: Returning allocated memory "argv".
    /builddir/build/BUILD/libguestfs-1.16.5/fish/cmds.c:13254: var_assign: Assigning: "devices" =  storage returned from "parse_string_list(argv[i++])".
    /builddir/build/BUILD/libguestfs-1.16.5/fish/cmds.c:13271: leaked_storage: Variable "devices" going out of scope leaks the storage it points to.
    /builddir/build/BUILD/libguestfs-1.16.5/fish/cmds.c:13288: leaked_storage: Variable "devices" going out of scope leaks the storage it points to.
    /builddir/build/BUILD/libguestfs-1.16.5/fish/cmds.c:13293: leaked_storage: Variable "devices" going out of scope leaks the storage it points to.
    /builddir/build/BUILD/libguestfs-1.16.5/fish/cmds.c:13311: leaked_storage: Variable "devices" going out of scope leaks the storage it points to.
    /builddir/build/BUILD/libguestfs-1.16.5/fish/cmds.c:13316: leaked_storage: Variable "devices" going out of scope leaks the storage it points to.
    /builddir/build/BUILD/libguestfs-1.16.5/fish/cmds.c:13334: leaked_storage: Variable "devices" going out of scope leaks the storage it points to.
    /builddir/build/BUILD/libguestfs-1.16.5/fish/cmds.c:13349: leaked_storage: Variable "devices" going out of scope leaks the storage it points to.
    /builddir/build/BUILD/libguestfs-1.16.5/fish/cmds.c:13355: leaked_storage: Variable "devices" going out of scope leaks the storage it points to.

commit d0453c02545c825810fec6e5874c55d7ac5ec678
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 8 11:44:31 2012 +0000

    daemon: proto: Close fd along error paths (found by Coverity).
    
    Error: RESOURCE_LEAK:
    /builddir/build/BUILD/libguestfs-1.16.5/src/proto.c:894: open_fn: Calling opening function "open".
    /builddir/build/BUILD/libguestfs-1.16.5/src/proto.c:894: var_assign: Assigning: "fd" =  handle returned from "open(filename, 0)".
    /builddir/build/BUILD/libguestfs-1.16.5/src/proto.c:903: noescape: Variable "fd" is not closed or saved in function "read".
    /builddir/build/BUILD/libguestfs-1.16.5/src/proto.c:911: leaked_handle: Handle variable "fd" going out of scope leaks the handle.
    /builddir/build/BUILD/libguestfs-1.16.5/src/proto.c:918: leaked_handle: Handle variable "fd" going out of scope leaks the handle.

commit fbf10d7f682178a6a71cfa8dbac2acd23f869597
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 8 11:41:13 2012 +0000

    daemon: upload: Close fd along error path (found by Coverity).
    
    Error: RESOURCE_LEAK:
    /builddir/build/BUILD/libguestfs-1.16.5/daemon/upload.c:225: open_fn: Calling opening function "open".
    /builddir/build/BUILD/libguestfs-1.16.5/daemon/upload.c:225: var_assign: Assigning: "fd" =  handle returned from "open(filename, 0)".
    /builddir/build/BUILD/libguestfs-1.16.5/daemon/upload.c:233: noescape: Variable "fd" is not closed or saved in function "lseek".
    /builddir/build/BUILD/libguestfs-1.16.5/daemon/upload.c:235: leaked_handle: Handle variable "fd" going out of scope leaks the handle.

commit cba36e730524525b5fc1c0df2ec3dd878d55ff15
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 8 11:39:50 2012 +0000

    daemon: 9p: Close fd along error paths (found by Coverity).
    
    Error: RESOURCE_LEAK:
    /builddir/build/BUILD/libguestfs-1.16.5/daemon/9p.c:130: open_fn: Calling opening function "open".
    /builddir/build/BUILD/libguestfs-1.16.5/daemon/9p.c:130: var_assign: Assigning: "fd" =  handle returned from "open(filename, 0)".
    /builddir/build/BUILD/libguestfs-1.16.5/daemon/9p.c:142: leaked_handle: Handle variable "fd" going out of scope leaks the handle.
    /builddir/build/BUILD/libguestfs-1.16.5/daemon/9p.c:149: noescape: Variable "fd" is not closed or saved in function "read".
    /builddir/build/BUILD/libguestfs-1.16.5/daemon/9p.c:153: leaked_handle: Handle variable "fd" going out of scope leaks the handle.

commit 855aaf414af3b8c8ca1f722a589fd251cc8317ee
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 8 11:32:43 2012 +0000

    proto: Close file along error and cancel paths (found by Coverity).
    
    Error: RESOURCE_LEAK:
    /builddir/build/BUILD/libguestfs-1.16.5/src/proto.c:1125: open_fn: Calling opening function "open".
    /builddir/build/BUILD/libguestfs-1.16.5/src/proto.c:1125: var_assign: Assigning: "fd" =  handle returned from "open(filename, 833, 438)".
    /builddir/build/BUILD/libguestfs-1.16.5/src/proto.c:1133: noescape: Variable "fd" is not closed or saved in function "xwrite".
    /builddir/build/BUILD/libguestfs-1.16.5/src/proto.c:1146: leaked_handle: Handle variable "fd" going out of scope leaks the handle.
    /builddir/build/BUILD/libguestfs-1.16.5/src/proto.c:1173: leaked_handle: Handle variable "fd" going out of scope leaks the handle.

commit 618954a6b0adc3e0eacda799b88f020c801a0106
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 8 11:17:27 2012 +0000

    Check return values of guestfs_inspect_get_{type,distro} (found by Coverity).
    
    Error: NULL_RETURNS:
    /builddir/build/BUILD/libguestfs-1.16.5/examples/virt-dhcp-address.c:129: var_assigned: Assigning: "guest_distro" = null return value from "guestfs_inspect_get_distro".
    /builddir/build/BUILD/libguestfs-1.16.5/examples/virt-dhcp-address.c:131: dereference: Dereferencing a pointer that might be null "guest_distro" when calling "__coverity_strcmp".
    [...]
    /builddir/build/BUILD/libguestfs-1.16.5/examples/virt-dhcp-address.c:126: var_assigned: Assigning: "guest_type" = null return value from "guestfs_inspect_get_type".
    /builddir/build/BUILD/libguestfs-1.16.5/examples/virt-dhcp-address.c:128: dereference: Dereferencing a pointer that might be null "guest_type" when calling "__coverity_strcmp".

commit 35d5be22b1c09c3a99b445f65453601ec25b9f60
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 8 11:06:46 2012 +0000

    Check return values from calloc (found by Coverity).
    
    Error: NULL_RETURNS:
    /builddir/build/BUILD/libguestfs-1.16.5/src/inspect.c:417: returned_null: Function "calloc" returns null (checked 67 out of 81 times).
    /builddir/build/BUILD/libguestfs-1.16.5/src/inspect.c:417: var_assigned: Assigning: "ret" = null return value from "calloc".
    /builddir/build/BUILD/libguestfs-1.16.5/src/inspect.c:418: dereference: Dereferencing a null pointer "ret".
    [...]
    /builddir/build/BUILD/libguestfs-1.16.5/src/inspect.c:374: returned_null: Function "calloc" returns null (checked 67 out of 81 times).
    /builddir/build/BUILD/libguestfs-1.16.5/src/inspect.c:374: var_assigned: Assigning: "ret" = null return value from "calloc".
    /builddir/build/BUILD/libguestfs-1.16.5/src/inspect.c:375: dereference: Dereferencing a null pointer "ret".

commit 0ffa223a75fe4b5b077e4ec68534155039772c3a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 8 10:53:59 2012 +0000

    Dead code: Remove comma-check in first if-clause (found by Coverity).
    
    Error: DEADCODE:
    /builddir/build/BUILD/libguestfs-1.16.5/fish/event-names.c:65: dead_error_condition: On this path, the condition "comma" cannot be true.
    /builddir/build/BUILD/libguestfs-1.16.5/fish/event-names.c:57: const: After this line, the value of "comma" is equal to 0.
    /builddir/build/BUILD/libguestfs-1.16.5/fish/event-names.c:57: assignment: Assigning: "comma" = "0".
    /builddir/build/BUILD/libguestfs-1.16.5/fish/event-names.c:65: dead_error_line: Execution cannot reach this statement "fputc(44, fp);".

commit 109d3ad34aac8d50a1c02437928a64d9bad9f1a6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 8 10:51:02 2012 +0000

    Dead code: 'lvs' cannot be true here (found by Coverity).
    
    Remove dead code; however only comment it out since if we change the
    preceeding code we may need this line again.
    
    Error: DEADCODE:
    /builddir/build/BUILD/libguestfs-1.16.5/src/listfs.c:107: dead_error_condition: On this path, the condition "lvs" cannot be true.
    /builddir/build/BUILD/libguestfs-1.16.5/src/listfs.c:54: const: After this line, the value of "lvs" is equal to 0.
    /builddir/build/BUILD/libguestfs-1.16.5/src/listfs.c:91: const: After this line, the value of "lvs" is equal to 0.
    /builddir/build/BUILD/libguestfs-1.16.5/src/listfs.c:54: assignment: Assigning: "lvs" = "NULL".
    /builddir/build/BUILD/libguestfs-1.16.5/src/listfs.c:91: new_values: Noticing condition "lvs == NULL".
    /builddir/build/BUILD/libguestfs-1.16.5/src/listfs.c:107: dead_error_line: Execution cannot reach this statement "guestfs___free_string_list(...".

commit 07a8c3c0c25974e0b9496966a7a1354be9ee844f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 8 10:48:21 2012 +0000

    Ignore return values from some functions in guestfs_close (Coverity warning).
    
    Error: CHECKED_RETURN:
    /builddir/build/BUILD/libguestfs-1.16.5/java/com_redhat_et_libguestfs_GuestFS.c:9552: example_assign: Assigning: "r" = return value from "guestfs_internal_autosync(g)".
    /builddir/build/BUILD/libguestfs-1.16.5/java/com_redhat_et_libguestfs_GuestFS.c:9555: example_checked: "r" has its value checked in "r == -1".
    /builddir/build/BUILD/libguestfs-1.16.5/ocaml/guestfs_c_actions.c:5584: example_assign: Assigning: "r" = return value from "guestfs_internal_autosync(g)".
    /builddir/build/BUILD/libguestfs-1.16.5/ocaml/guestfs_c_actions.c:5586: example_checked: "r" has its value checked in "r == -1".
    /builddir/build/BUILD/libguestfs-1.16.5/perl/Guestfs.xs:5990: example_assign: Assigning: "r" = return value from "guestfs_internal_autosync(g)".
    /builddir/build/BUILD/libguestfs-1.16.5/perl/Guestfs.xs:5991: example_checked: "r" has its value checked in "r == -1".
    /builddir/build/BUILD/libguestfs-1.16.5/python/guestfs-py.c:13702: example_assign: Assigning: "r" = return value from "guestfs_internal_autosync(g)".
    /builddir/build/BUILD/libguestfs-1.16.5/python/guestfs-py.c:13707: example_checked: "r" has its value checked in "r == -1".
    /builddir/build/BUILD/libguestfs-1.16.5/ruby/ext/guestfs/_guestfs.c:16000: example_assign: Assigning: "r" = return value from "guestfs_internal_autosync(g)".
    /builddir/build/BUILD/libguestfs-1.16.5/ruby/ext/guestfs/_guestfs.c:16001: example_checked: "r" has its value checked in "r == -1".
    /builddir/build/BUILD/libguestfs-1.16.5/src/guestfs.c:191: check_return: Calling function "guestfs_internal_autosync" without checking return value (as is done elsewhere 5 out of 6 times).
    /builddir/build/BUILD/libguestfs-1.16.5/src/guestfs.c:191: unchecked_value: No check of the return value of "guestfs_internal_autosync(g)".

commit 10f240a07f156493eb0540a95f9a3deba36c6862
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 8 13:13:24 2012 +0000

    tests/md: Number the errors so we can easily see which test fails.

commit 5503d95e1b340de38b77b0d5be639da72b0f88c6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 8 10:46:13 2012 +0000

    Update translations from Transifex.

commit 0fdcc76901807c103845e4ac293df5712e212fe4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 7 22:32:14 2012 +0000

    Update API support.

commit 4504f424f5589f81086f5250674b55708e162e5f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 7 19:21:14 2012 +0000

    dist: Distribute all tests, even when configured with --disable-appliance.

commit 2f126e07bbd81532147cb59a272e11bce3e6d9ed
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 7 17:36:48 2012 +0000

    Version 1.17.12.

commit cfa0f9b381b5e3639e41554e78fcd38d611ef270
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 7 18:11:08 2012 +0000

    inspection: Add detection of FreeDOS install CDs (RHBZ#786188).

commit a9510b7b22663ac27c8d59cee1bbd777468e1cac
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 7 18:09:59 2012 +0000

    inspection: Add detection of FreeDOS (RHBZ#786215).
    
    FreeDOS is returned as type="dos", distro="freedos".  No version or
    application information is returned at present.

commit 518cdb596e3d1e75e30d8df8fff5835aa2842479
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 7 17:30:48 2012 +0000

    Add 'display_icon' example program.
    
    Running this on a disk image displays the guest icon
    (using external 'display' program).

commit 4d8ae8f5a2e309a6a518fdb0b6f65685aa9137e0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 7 17:30:17 2012 +0000

    Comment change.

commit e40f408faeea204417bc46024590a07272eeda92
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 7 17:29:38 2012 +0000

    Hide stderr of bmptopng.
    
    This program is noisy on stderr.  Send that to /dev/null.

commit 2c9c0525ebda105f37e6a6eea2307db4cb2f0a73
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 7 15:07:37 2012 +0000

    build: Make netpbm and icoutils into proper optional dependencies.
    
    Netpbm and icoutils (wrestool) have always been dependencies.  Since
    they are not always present, make these into optional dependencies
    (which they were, sort of, before).
    
    Also document these dependencies in the README file.

commit b9061ddf2d337fcc42cfeae0ac8ec4e329a1a421
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 7 14:11:53 2012 +0000

    Add support for Buildroot and Cirros distributions.

commit b106dda97c9e18563bb27a44a025016fef6dec97
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 7 14:11:38 2012 +0000

    Whitespace change.

commit 3bf5d0d0e4b3fa5f26e58ad803a9e97f71c7ae0b
Author: Matthew Booth <mbooth@redhat.com>
Date:   Tue Mar 6 14:48:41 2012 +0000

    gobject: Update TODO with details of inspect_get_type fix

commit deaae550723eb3725f890256bfa08a35c671d5f0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 5 09:36:34 2012 +0000

    Version 1.17.11.

commit 715f7e28090d08c16bfdd32b0298812972c12b36
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 5 08:58:00 2012 +0000

    Remove ConfigOnly flag from set-autosync.
    
    guestfs_set_autosync sets a flag which affects guestfs_close, and so
    this call can be made at any time before the handle is closed, not
    just in the config state.

commit 705971b509e1c60419444f228825533080c4ae34
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Mar 4 14:41:37 2012 +0000

    Test header file under C++.

commit 49611f121fa10d1497e46ab9aa6a7448cb89cd86
Author: Marcin Gibula <m.gibula@e24cloud.com>
Date:   Sun Mar 4 11:54:19 2012 +0000

    Make "template" a reserved word.
    
    Function guestfs_mkdtemp uses c++ keyword "template" as a parameter
    name. In result, attempt to use guestfs.h header in c++ program
    results in compile error.

commit b11e9f49191c244ddc27ae663505e6fb89dbdcd7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 3 18:41:01 2012 +0000

    Version 1.17.10.

commit 3b78b3a8496cdd66567b6f433206273966858e74
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 3 18:40:42 2012 +0000

    ruby: Use RbConfig instead of Config.
    
    I have checked, and this works with Ruby 1.8 as well.

commit 5e8a4627d9f0d313485f186a63dc2250f6fd5c01
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 3 16:58:48 2012 +0000

    Add a 'fixed' style of appliance.
    
    This is just the 'kernel', 'initrd' and 'root' files, copied from one
    machine to another, along with a 'README.fixed' file which is also
    used for identification.
    
    This allows the appliance to be copied from one machine to another,
    making it easier for us to distribute a starter appliance for people
    who cannot get febootstrap or appliance-building working.

commit 49726b9269490e331e740d55952da87552ca2500
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 3 16:58:05 2012 +0000

    Rebrand 'ordinary appliance' as 'old-style appliance'.
    
    This is just code motion.

commit ba468e9c5ecb32046299dd69a6e045f2aa7ba982
Author: Nikos Skalkotos <skalkoto@gmail.com>
Date:   Thu Mar 1 21:00:36 2012 +0200

    Test fails in arch linux
    
    --20cf303ea4a84a7a7c04ba331375
    Content-Type: text/plain; charset=ISO-8859-1
    
    Hello Richard,
    
    I found what the problem was and the udev symlinks where not created. The
    init script in the appliance uses a full paths for udevadm (/sbin/udevadm)
    which in my case was wrong. In Arch Linux udevadm is hosted under /usr/bin,
    not /sbin. When I fixed this, libguestfs was able to communicate with the
    appliance VM.
    
    Since PATH variable is defined and exported in init, there is no need in
    using full paths for external programs. As far as I've seen this affects
    all the git branches in libguestfs's repository. Please find attached a
    patch for the master branch.
    
    Nikos Skalkotos,
    Athens, Greece
    
    On 24 February 2012 10:25, Richard W.M. Jones <rjones@redhat.com> wrote:
    
    > On Thu, Feb 23, 2012 at 08:50:12PM +0200, Nikos Skalkotos wrote:
    > [...]
    >
    > I don't know specifically why it fails with ArchLinux, but the problem
    > is caused by the /dev/virtio-ports/* symlinks not getting created by
    > udev.
    >
    > /dev/vport0p1 exists:
    >
    > > crw------- 1 root root 252,   1 Feb 23 18:17 vport0p1
    >
    > but udev doesn't make the corresponding /dev/virtio-ports symlink:
    >
    > > /dev/virtio-ports/org.libguestfs.channel.0: No such file or directory
    >
    > The symlink is supposed to be created by this udev rule:
    >
    > /lib/udev/rules.d/50-udev-default.rules:KERNEL=="vport*",
    > ATTR{name}=="?*", SYMLINK+="virtio-ports/$attr{name}"
    >
    > So I'd start by looking to see if that rule exists in the udev rules
    > that Arch is using.  Secondly if it does exist, is the corresponding
    > *.rules being copied into the appliance?  (Check appliance/supermin.d/
    > hostfiles)
    >
    > In an old Ubuntu that has udev that predates having this rule, we add
    > the following patch:
    >
    >
    > http://libguestfs.org/download/binaries/ubuntu1004-packages/0002-ubuntu-10.04-Use-dev-vport0p1.patch
    >
    > Rich.
    >
    > --
    > Richard Jones, Virtualization Group, Red Hat
    > http://people.redhat.com/~rjones
    > virt-p2v converts physical machines to virtual machines.  Boot with a
    > live CD or over the network (PXE) and turn machines into Xen guests.
    > http://et.redhat.com/~rjones/virt-p2v
    >
    
    Hello Richard,<br><br>I found what the problem was and the udev symlinks where not created. The init script in the appliance uses a full paths for udevadm (/sbin/udevadm) which in my case was wrong. In Arch Linux udevadm is hosted under /usr/bin, not /sbin. When I fixed this, libguestfs was able to communicate with the appliance VM.<br>
    <br>Since PATH variable is defined and exported in init, there is no need in using full paths for external programs. As far as I&#39;ve seen this affects all the git branches in libguestfs&#39;s repository. Please find attached a patch for the master branch.<br>
    <br>Nikos Skalkotos,<br>Athens, Greece<br><br><div class="gmail_quote">On 24 February 2012 10:25, Richard W.M. Jones <span dir="ltr">&lt;<a href="mailto:rjones@redhat.com">rjones@redhat.com</a>&gt;</span> wrote:<br><blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex">
    On Thu, Feb 23, 2012 at 08:50:12PM +0200, Nikos Skalkotos wrote:<br>
    [...]<br>
    <br>
    I don&#39;t know specifically why it fails with ArchLinux, but the problem<br>
    is caused by the /dev/virtio-ports/* symlinks not getting created by<br>
    udev.<br>
    <br>
    /dev/vport0p1 exists:<br>
    <div class="im"><br>
    &gt; crw------- 1 root root 252,   1 Feb 23 18:17 vport0p1<br>
    <br>
    </div>but udev doesn&#39;t make the corresponding /dev/virtio-ports symlink:<br>
    <div class="im"><br>
    &gt; /dev/virtio-ports/org.libguestfs.channel.0: No such file or directory<br>
    <br>
    </div>The symlink is supposed to be created by this udev rule:<br>
    <br>
    /lib/udev/rules.d/50-udev-default.rules:KERNEL==&quot;vport*&quot;, ATTR{name}==&quot;?*&quot;, SYMLINK+=&quot;virtio-ports/$attr{name}&quot;<br>
    <br>
    So I&#39;d start by looking to see if that rule exists in the udev rules<br>
    that Arch is using.  Secondly if it does exist, is the corresponding<br>
    *.rules being copied into the appliance?  (Check appliance/supermin.d/<br>
    hostfiles)<br>
    <br>
    In an old Ubuntu that has udev that predates having this rule, we add<br>
    the following patch:<br>
    <br>
    <a href="http://libguestfs.org/download/binaries/ubuntu1004-packages/0002-ubuntu-10.04-Use-dev-vport0p1.patch" target="_blank">http://libguestfs.org/download/binaries/ubuntu1004-packages/0002-ubuntu-10.04-Use-dev-vport0p1.patch</a><br>
    
    <br>
    Rich.<br>
    <span class="HOEnZb"><font color="#888888"><br>
    --<br>
    Richard Jones, Virtualization Group, Red Hat <a href="http://people.redhat.com/%7Erjones%0Avirt-p2v" target="_blank">http://people.redhat.com/~rjones<br>
    virt-p2v</a> converts physical machines to virtual machines.  Boot with a<br>
    live CD or over the network (PXE) and turn machines into Xen guests.<br>
    <a href="http://et.redhat.com/%7Erjones/virt-p2v" target="_blank">http://et.redhat.com/~rjones/virt-p2v</a><br>
    </font></span></blockquote></div><br>

commit d6f736ab1836d84f329b3fa2af8b7685b4b85dde
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Wed Feb 29 14:37:37 2012 +0800

    virt-sysprep: add the hostname and net_hwaddr support for rhel
    
    Add the support for rhel.
    Change the hostname and delete the HWADDR for rhel.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 48a5cb2a2c150ad74203479d3f96a8066241d309
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 28 10:31:23 2012 +0000

    Version 1.17.9.

commit 88ba4da4d6c07762fc95c96ea67019f0ebf4677c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 28 10:25:26 2012 +0000

    resize: Fix --output-format flag (RHBZ#798196).
    
    Update the test to use the --format and --output-format flags.

commit a93d4a9dc1aea6940886c85d4b09f21cbfc80969
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 27 19:39:11 2012 +0000

    resize: Document steps to avoid UNMOUNTABLE_BOOT_VOLUME BSOD (RHBZ#797986).
    
    (Thanks Grant Williamson for finding and fixing this problem)

commit d1711dae9dbd7f516469f88807604894c1304228
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 27 14:05:38 2012 +0000

    New API: set-label, for setting a label on any filesystem.
    
    Currently only ext2/3/4 and (newly) NTFS are supported.
    
    This change also deprecates set-e2label.

commit e567f064e235f23ef709d4ed52834fb2135c6956
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 27 12:00:57 2012 +0000

    New APIs: ntfsclone-in, ntfsclone-out.

commit 51aa51884e8dfa22b489e958743bf8f3ac3785cc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 27 11:13:45 2012 +0000

    New API: ntfsfix for fixing problems on NTFS.
    
    Note this is not a "chkdsk" equivalent tool.

commit 2e788ca45eddc4c6fdb4a3ac5fa6f74c54c98437
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 27 10:51:45 2012 +0000

    Update TODO.

commit b5cc1fa04996b6bde06d78fade52bedefceed782
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Sat Feb 25 10:02:20 2012 +0800

    set-smp: limit the number of cpus below 255
    
    Limit the number of cpus below 255, since qemu can't support.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 9e5c0b39c6b598a733a790d73d27eae491910a22
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Thu Feb 23 23:41:53 2012 +0800

    Add a flag to make some functions called only at CONFIG state (RHBZ#796520).
    
    Add a flag "ConfigOnly" to make sure that some non-daemon functions
    should be called only at CONFIG state (RHBZ#796520).
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit db2cb21a8508e83daa2530df66c06dea0930071c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 15 20:58:47 2012 +0000

    Version 1.17.8.

commit 5fa7aace200a49961173de6316a81e239987c179
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 15 19:25:52 2012 +0000

    sysprep: Try unmounting the filesystem a few times when busy.
    
    tracker-miner-fs jumps into newly mounted filesystems.  This prevents
    the filesystem from being unmounted, so retry a few times.

commit afed7e493dcd594620f19b93e9fb73e58553f60a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 15 16:54:05 2012 +0000

    appliance: Make appliance building thread-safe (RHBZ#790721).
    
    Appliance building can be called from multiple processes, but this is
    only safe if each process holds a lock on the 'checksum' file.
    However threads within a process are not excluded by a file lock, and
    so this strategy completely failed for a multithreaded program calling
    guestfs_launch in parallel.
    
    Since it makes no sense for threads in a single program to race each
    other to try to create the appliance, add a lock around appliance
    building.
    
    This serialises building the appliance, but the rest of guestfs_launch
    (eg. starting up qemu) can run in parallel.

commit c9ea94810e2f7a5fcce2a7136eb07ce795f49c53
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 15 10:40:57 2012 +0000

    tests: Test parallel launch from multiple threads.

commit 6a70cb337cff736831b51bbc9c4331785d756c20
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 15 10:39:50 2012 +0000

    test-user-cancel: Add \n to fprintf error messages.

commit 84a4160fd30c46575b93f87f6ffc7cc556b0af93
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 13 14:44:03 2012 +0000

    Version 1.17.7.

commit cd06ddf4422a31528f4a268dad813938947e1a0d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 13 13:48:02 2012 +0000

    tests: Add a regression test for RHBZ#789960.
    
    Test all the ways that the 'mount' command can fail.  Ensure that none
    of them result in failures or desynchronization.

commit 1b15e543a8efee027451dcfb68743d35eda95dfc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 13 13:46:40 2012 +0000

    regressions: One test is not being run.
    
    rhbz727178.sh exists, but historically was never added to the list of
    tests, so it doesn't run.  Create a special variable for this test and
    ensure it is added to EXTRA_DIST.
    
    Test was originally added in
    commit d7356a2801130907997acd5c7502e8417566e782.

commit 07081591cf9928454148db84828da8a7f39b6c6f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 13 13:44:18 2012 +0000

    daemon: Return error properly when user tries to mount appliance root (RHBZ#789960).
    
    In the case where the caller attempts to mount the "hidden"
    appliance root device (eg. /dev/vdb if /dev/vda is the only
    normal block device added), we were calling reply_with_error
    but not actually returning immediately, resulting in protocol
    desynchronization.
    
    This commit fixes this obvious mistake.

commit ba443ae0486ae30ea597c4e126de63371f8fa7a8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 13 08:58:04 2012 +0000

    daemon: Don't xdr_free uninitialized args struct on error paths.
    
    For stubs of functions that had arguments, code did this:
    
    static void
    mount_stub (XDR *xdr_in)
    {
      int r;
      struct guestfs_mount_args args;
    
      if (optargs_bitmask != 0) {
        //...
        goto done;
      }
      // possibly other tests here
    
      memset (&args, 0, sizeof args);
    
      [...]
    
    done:
      xdr_free ((xdrproc_t) xdr_guestfs_mount_args, (char *) &args);
      return;
    }
    
    This caused xdr_free to be called on uninitialized 'args' struct,
    causing a segfault.
    
    The fix is to add another label, so the code looks like:
    
    static void
    mount_stub (XDR *xdr_in)
    {
      int r;
      struct guestfs_mount_args args;
    
      if (optargs_bitmask != 0) {
        //...
        goto done_no_free;
      }
      // possibly other tests here
    
      memset (&args, 0, sizeof args);
    
      [...]
    
    done:
      xdr_free ((xdrproc_t) xdr_guestfs_mount_args, (char *) &args);
    done_no_free:
      return;
    }
    
    This fixes commit 330fbea5b2d6bd7db84f7ea7afe87cf1bcd438e0
    and commit 0344248af55802bbbd816b349ec1ba9305996f6e.

commit c8a11468c4dc761acdcb9b184d345bafe1b5114d
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Sun Feb 12 12:35:26 2012 +0100

    Do not run test-virt-format.sh if appliance has not been built

commit 9403c5516fed43fabf5ac361eee4fbd622d54989
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 10 09:31:49 2012 +0000

    Version 1.17.6.

commit badf2d6c4d2c2a3e12bad4dcbd5854401156bb5f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 10 10:49:37 2012 +0000

    virt-format: Add a test.

commit 7c21e49c2c83092e9fd5f40c43a03c764a6d3663
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 10 10:32:55 2012 +0000

    fish: edit: Preserve permissions, UID, GID, SELinux context when editing files (RHBZ#788641).

commit ddae5abf80f65fc149eec253f14f073d397b49c2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 10 10:12:45 2012 +0000

    fish: In edit command, upload to a new file.
    
    If the upload fails, this means we don't leave a partially
    written file.
    
    Also add a test for the edit command.

commit ca80e4490463d646de4504fc2bcb4e4a722bedb8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 10 09:31:34 2012 +0000

    fish: Refactor error handling in the 'edit' command.
    
    This is just code motion.

commit ac58ddcd1ab3468134baa1f76df6e044a6d60363
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 10 11:26:54 2012 +0000

    wipefs: Fix documentation.
    
    This fixes commit a2b3e0900ee14e5a49d526c24e22edefc3030f99.

commit 39625b59ee5aeecfb855575abb939934216eeff2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 10 10:06:08 2012 +0000

    ocaml: Ensure bindings are recompiled whenever there is an API change.

commit df3c6acacdedd4e158ae8ca8bb7c175ab4170147
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 10 09:55:51 2012 +0000

    wipefs: Include "optgroups.h".
    
    This fixes commit a2b3e0900ee14e5a49d526c24e22edefc3030f99.

commit 088546af9dd7574ed74d19989b24ddbb2eb122e4
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Fri Feb 10 17:10:03 2012 +0800

    virt-format: erase the filesystem signatures before erase partitions
    
    erase the filesystem signatures on each device, then erase
    the partitions, avoid to list all the partitions here.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit a2b3e0900ee14e5a49d526c24e22edefc3030f99
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Fri Feb 10 17:10:02 2012 +0800

    NEW API: add a new api wipefs
    
    Add the new api wipefs to erase the filesystem signatures
    on a device but now erase any data.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 6ca8a2db6d6f1028a35ece616af44538074483fc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 8 20:54:55 2012 +0000

    docs: Note that JRuby should use the Java bindings.

commit a915d78ef9bccc88a12d63a2c863a3030ee9300e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 8 18:16:19 2012 +0000

    New API: llz: This runs ls -laZ and is useful for showing SELinux contexts.

commit 24d7889eba3eb6ee2f37ed9d384aa8734ebad7b7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 8 18:05:29 2012 +0000

    edit: Preserve file permissions, UID, GID, SELinux context on edited files. (RHBZ#788641)

commit 016ae77e6c2331560a3716ea1ebae82f122b4909
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Thu Feb 2 21:54:10 2012 +0100

    java: Make use of JAR_INSTALL_DIR, JNI_INSTALL_DIR

commit 2cbf5ea543f0b1b23c5b716425f4f984e956a81f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 8 14:03:19 2012 +0000

    Version 1.17.5.

commit f504cb02e1e8ef394287ddbaaad2fb1ec04bc33f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 8 14:34:51 2012 +0000

    findfs: Remove /run/blkid/blkid.tab.
    
    See this util-linux commit:
    https://github.com/karelzak/util-linux/commit/b82590ad46acf9fe8d332b53875e24c3c31e2482

commit 518edc506fbdd66dcdd5a558cd086cfa296585a2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 8 14:02:51 2012 +0000

    extra-tests: Add suppression for uninitialized memory bug in latest glibc.

commit 0559f038ada850f627529ece97f5a4e8721a7ecd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 8 14:02:14 2012 +0000

    extra-tests: libnl moved from /lib64 to /usr/lib64 on Fedora.
    
    Update suppressions file to match.

commit 825b5e65c094396154594fcb31db59fe51867a33
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Feb 7 08:13:50 2012 +0000

    perl: Ignore perl/MYMETA.json

commit 21a9efcad5379cbfcc2404142472ec5efda4aaa0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 6 18:27:51 2012 +0000

    blockdev, parted: Call udev_settle before and after commands. (RHBZ#769304)
    
    See comments in the code for details.
    
    This is an alternate fix to
    commit a9c8123c72db47bcab8dd738e8d5256a9ae87f11.

commit a98170e0e255021481cd428ee12d0858a59a875b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 6 18:24:52 2012 +0000

    Revert "daemon: Run udev_settle after pwrite-device finishes."
    
    This reverts commit a9c8123c72db47bcab8dd738e8d5256a9ae87f11.

commit 3c9ef0e9780443d28a078c49bab80cb13e5608ae
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Feb 6 15:45:45 2012 +0000

    build: Choose a virtual directory for the daemon which is not a symlink.
    
    Check /sbin, /usr/sbin, /bin and /usr/bin to ensure that neither the
    directory nor the parent (eg. /usr) is a symlink, and use this
    directory for the virtual directory used to store guestfsd in the
    appliance.

commit 590d8c3c3732c603cfb1d2180190a02df528e5ed
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 3 20:57:28 2012 +0000

    build: Remove 'run' from EXTRA_DIST.
    
    This file shouldn't be included in the tarball as it contains
    hard-coded paths from the maintainer's machine which cannot be
    relevant to the target machine.

commit b7a7ad1d113e4c7d302d1e06592e268cdb1b59df
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 1 17:36:19 2012 +0000

    Version 1.17.4.

commit 330fbea5b2d6bd7db84f7ea7afe87cf1bcd438e0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 1 12:18:35 2012 +0000

    Clarify the error message when unavailable functions are called (RHBZ#679737).
    
    Callers are supposed to use the availability API to check for
    functions that may not be available in particular builds of
    libguestfs.  If they don't do this, currently they tend to get obscure
    error messages, eg:
    
      libguestfs: error: zerofree: /dev/vda1: zerofree: No such file or directory
    
    This commit changes the error message to explain what callers ought to
    be doing instead:
    
      libguestfs: error: zerofree: feature 'zerofree' is not available in this
      build of libguestfs.  Read 'AVAILABILITY' in the guestfs(3) man page for
      how to check for the availability of features.
    
    This patch makes the stubs check for availability.  The stub code
    changes to:
    
      static void
      zerofree_stub (XDR *xdr_in)
      {
      [...]
    
        /* The caller should have checked before calling this. */
        if (! optgroup_zerofree_available ()) {
          reply_with_error ("feature '%s' is not available in this\n"
                            "build of libguestfs.  Read 'AVAILABILITY' in the guestfs(3) man page for\n"
                            "how to check for the availability of features.",
                            "zerofree");
          goto done;
        }
      [...]

commit 90d6386c13edcb479113889bbd3cedf83c2e6277
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Tue Jan 31 18:19:31 2012 +0800

    examples: code cleanups
    
    do a code cleanup by removing the tailing spaces
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit d60d5c091f46dda8399ce2af1b6e5920bd5fb819
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Mon Jan 30 15:22:53 2012 +0800

    guestmount: use O_ACCMODE instead of hard coding
    
    Change hard code 3 to O_ACCMODE.
    it'll be more sensible.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 0042898880167f93c5e64d76008ab07bd0aa9485
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Mon Jan 30 14:36:05 2012 +0800

    guestmount: remove tailing spaces
    
    just do a cleanup.
    remove the tailing spaces.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit e3f15780c8197a66bfb620b802ba18d0ba0dd2ce
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 30 10:47:47 2012 +0000

    daemon: Fix crash in aug-defnode (RHBZ#785668).

commit 6e703c1316548e42b5133ba508fe0e7d090ac3d0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 28 19:14:57 2012 +0000

    virt-alignment-scan: Fix typo in man page (thanks yurchor).

commit 03684e7a616eab56a81665c8c8859426e50ae429
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 28 17:35:34 2012 +0000

    ocaml: Various fixes for bytecode compilation.
    
    Set LD_LIBRARY_PATH so we link against the just-built library, not
    the installed library.
    
    Use OCAMLCFLAGS instead of OCAMLOPTFLAGS where appropriate.
    
    Remove unnecessary -cclib option for bytecode linking (gcc is not used
    in this case).
    
    This fixes commit eb68a314133c88260cdf4547d7d338446488e698.

commit a3ac2cc788c9c08b13a03799e8d62ebd52be8a57
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 28 10:24:36 2012 +0000

    Version 1.17.3.

commit d33c70fd6417c71b8965a088355dcc9e2ade51f7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 28 10:24:18 2012 +0000

    ocaml: Sort the tests.

commit 8fd5a377b8521d53f56b66136d686a31c7e302b6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 28 10:23:57 2012 +0000

    extra-tests: ocaml: Additional suppressions so we can test bytecode.

commit eb68a314133c88260cdf4547d7d338446488e698
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 27 22:11:53 2012 +0000

    ocaml: Test bytecode and native code bindings.
    
    Compile each test twice, as bytecode and native code, and
    test both.

commit 799852e64691068f3256c27d18870bdb2537c2be
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 27 21:48:35 2012 +0000

    ocaml: Fix bytecode bindings for functions with >= 6 args.

commit 7972b1da8121e3f9c98865f00fc6115d9aff2754
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 27 18:43:07 2012 +0000

    Update to latest gnulib.
    
    This contains a workaround for stdalign bug:
    http://lists.gnu.org/archive/html/bug-gnulib/2012-01/msg00340.html
    http://gcc.gnu.org/bugzilla/show_bug.cgi?id=52023
    
    (Thanks Paul Eggert).

commit 8f564ae7a2fb0f170308bd103a6be0a981583b1c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 27 15:36:31 2012 +0000

    appliance: udev >= 176 now requires /dev to be a devtmpfs.
    
    See this udev commit:
    https://git.kernel.org/?p=linux/hotplug/udev.git;a=commitdiff;h=220893b3cbdbf8932f95c44811b169a8f0d33939

commit d5bc69e54579013dc46c2f16d7bf82a10082a83a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 26 16:03:39 2012 +0000

    Version 1.17.2.

commit 93e443ccad74305c41c925f64063ef451db8fa08
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 26 17:05:25 2012 +0000

    build: Add gobject/TODO.txt to EXTRA_DIST.
    
    This updates commit dd25638fc14ea63cf8e8eb0940173f1c6952447f.

commit de00aa84afcdb72ac096d17a290d6f46fc217e4f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 26 17:04:16 2012 +0000

    build: Add contrib/make-check-on-installed.pl to EXTRA_DIST.
    
    This updates commit 3d0c9f3fc63395083fef798ee31058a0bea8432e.

commit 3d0c9f3fc63395083fef798ee31058a0bea8432e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 26 13:36:05 2012 +0000

    contrib: Add a script for running test suite on installed packages.

commit 0a4d1810634b9c329f7e4d5f0b2116dd479c5fe1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 26 12:24:11 2012 +0000

    contrib: Delete 'removed' sections from the README file.
    
    There is no point in continuing to document removed stuff.

commit 09227c9d664ca21b47b65c2fcd8fa2ddc485b554
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 26 14:55:10 2012 +0000

    fish: Fix 'test-guestfish-escapes.sh' when running an alternate guestfish binary.
    
    The error messages would be prefixed by the path to the
    alternate binary, eg:
    
    ../fish/guestfish: invalid escape sequence in string (starting at offset 0)
    
    Fix this by normalizing the messages further.

commit 9f8e9dcc703759ff1f7413ebf75b90ca20e3acb4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 26 13:48:59 2012 +0000

    ocaml: Don't install bindtests.*.

commit b1ace6738177481276dce05bf1d2597bb67f2a80
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 26 13:35:38 2012 +0000

    ocaml: Don't install libguestfsocaml.a.

commit dd25638fc14ea63cf8e8eb0940173f1c6952447f
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Jan 26 11:55:43 2012 +0000

    gobject: Add a TODO list

commit 8bad4d1c4765fd997511a505cdb2a860148ae16d
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Jan 25 15:10:01 2012 +0000

    gobject: Add an explicit close call
    
    This change binds guestfs_close(). It consequently results in RConstOptString
    being able to throw an error.

commit 6568dd85f4aef705e7cf5c4301bc3b8f7119efd2
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Jan 25 13:17:39 2012 +0000

    gobject: Allow RConstOptString to return an error
    
    RConstOptString cannot return an error in the C api. This makes it a special
    case for the GObject api, as all other return types have a corresponding GError
    **err argument to return an error. This change removes this special case, and
    includes the possibility of an error return in the API. An error is indicated by
    setting *err to a non-NULL value.
    
    This change is in preparation for adding a close api. An attempt to call any
    api, even RConstOptString, on a closed handle must return an error.

commit 501561742b43edb044072ec85048bb35b0b8201a
Author: Jiri Popelka <jpopelka@redhat.com>
Date:   Wed Jan 25 17:16:56 2012 +0000

    appliance: Switch to using 'iproute' ('ip' command) from 'net-tools' (RHBZ#784647).
    
    Change 'ifconfig' and 'netstat' commands to use 'ip' instead.
    
    'iproute' was already included in the appliance, so this reduces the
    size of the appliance accordingly.

commit 8ac53919357eae4b4f891bf2f6cb8635dd905fe3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 24 19:29:08 2012 +0000

    Version 1.17.1.

commit a05ddcd2a719f97ba036e9d6ca4e6491ed8b1fd0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 24 16:42:39 2012 +0000

    daemon: Fix use-after-free in case-insensitive-path (found by valgrind).
    
    This commit tidies up the code by splitting out the path
    element-searching code into a separate function.
    
    Valgrind found that 'closedir' frees the 'struct dirent *', which
    wasn't immediately obvious.  So now we do the 'closedir' after all
    operations which touch 'd->d_name'.

commit 9700708a19a46a61ffe53c6e648206336781477e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 24 16:42:31 2012 +0000

    daemon: Fix leaking error message (found by valgrind).

commit 86f64c37b914645afb345f96af13ad843ec641b1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 24 16:42:13 2012 +0000

    daemon: Close inotify handle on exit.

commit 94a7fb9fc5d04615f23f94c34eb90c35d20ba117
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 24 16:42:05 2012 +0000

    daemon: Close augeas handle on exit.

commit ff2e685828ce6160de34756696069b80e35472e8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 24 16:39:02 2012 +0000

    daemon: Fix leak of strings in md-detail (found by valgrind).

commit 4c2101362edf5f2df5d018c3674b423de2a3538a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 24 16:38:04 2012 +0000

    daemon: md: Whitespace changes, and use size_t for i instead of pointer.
    
    This is just a code clean-up with no functional change.

commit aa978b75ae1df0d3111953114fafe0854c3f222e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 24 15:14:07 2012 +0000

    daemon: Fix leak of strings in blkid (found by valgrind).

commit 43a6974cb35759d4772f610f3c92b0d31f0503ac
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 24 15:13:32 2012 +0000

    daemon: blkid: Whitespace changes, and use size_t for i instead of pointer.
    
    This is just a code clean-up with no functional change.

commit f86c3a45ae19f5bb558ab9ead255ecaf004b24b0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 24 15:12:27 2012 +0000

    daemon: Return value from write syscall is ssize_t, not int.

commit 9f8f1fd8560f2c3e7b625cf6d65a052cd061fd2e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 24 15:12:01 2012 +0000

    daemon: Don't leak 'cmdline' (found by valgrind).

commit f65f653ab1541400afe2f796ab1b20cd721e769d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 24 15:11:21 2012 +0000

    daemon: Length of message is a 32 bit unsigned quantity.

commit 9cf7ecbe4fea5162b86e2c78c1a40cca737bc1da
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 24 15:10:43 2012 +0000

    daemon: Fix use of uninitialized stack data (found by valgrind).
    
    This uninitialized data was also sent over the protocol,
    potentially being a serious information leak.

commit 84242a8d0bf9c37e700cd8a3436607dbc7908f1e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 24 15:09:02 2012 +0000

    daemon: Fix memory leak in 'initrd-cat' (found by valgrind).

commit d08806adfc5d111b4b6c761540ff508d3f25b66e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 24 13:47:25 2012 +0000

    Enable running the daemon under valgrind.
    
    This commit allows you to run the daemon under valgrind.  You have to
    enable it at configure time:
    
      ./configure --enable-valgrind-daemon
    
    This should *not* be done for production builds.
    
    When this feature is enabled, valgrind is added to the appliance and
    the daemon is run under valgrind.  Log messages from valgrind are
    passed back over a virtio-serial channel into a file called
    'valgrind.log.$PID' in the top build directory.
    
    Running 'make check', 'make extra-tests' etc causes many
    valgrind.log.* files to be created which must be examined by hand.

commit b7122eaa58ccd153a8c39bc3b6f890755c5df089
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Mon Jan 23 23:17:37 2012 +0100

    resize, sparsify: find progress mini-library in out-of-tree builds (2)

commit 22224254fa4676735985818d2ff3c8feafe4457c
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Mon Jan 23 23:16:37 2012 +0100

    Fix --{en,dis}able-install-daemon
    
    This fixes...
    
        configure: error: conditional "INSTALL_DAEMON" was never defined.
    
    ... when specifying --disable-daemon

commit 734b1f662f4e563cc8baad3aca8cf751314e0e49
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 23 15:32:30 2012 +0000

    API support: Fix src/api-support/added file.
    
    This fixes commit 37e07db1598b433c12ee643302712d81b2c5415d.

commit 51c199ca6f31711198c6e501cd30411693fa5200
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 23 15:04:10 2012 +0000

    Version 1.17.0.

commit b1f188e24b16d3175c8c5a4264559be1cfdd57ae
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 23 13:42:43 2012 +0000

    Update ROADMAP.

commit 7caa81ab9da1555f6679e7f3f339a2a9c8b41831
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 23 13:34:32 2012 +0000

    Finalize RELEASE NOTES.

commit 61dc072a8b3d4f9e5a32a3a28acc59e2d1864a99
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 23 13:19:22 2012 +0000

    Pull translations from Transifex.

commit fd3e3ca18863650a16c10d4ef5e66b7153c2b08a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 23 12:18:13 2012 +0000

    debian: Debian 6 blkid has -p but not -i.
    
    Fix the existing test to work correctly in this case.
    
    Other cleanups.

commit abc17351adfd5b707098e2ee36dd6104b29622bb
Author: Matthew Booth <mbooth@redhat.com>
Date:   Mon Jan 23 10:42:27 2012 +0000

    gobject: Require minimum gobject library version of 2.26.0
    
    The GObject bindings require G_DEFINE_BOXED_TYPE, which was not added until
    2.25.15. There are probably other dependencies.

commit 6edecdec59336fbf737abce8cdf2f76ee2d7ffb4
Author: Jim Meyering <jim@meyering.net>
Date:   Mon Jan 23 11:35:55 2012 +0100

    maint: use $var notation rather than ${var} when possible
    
    I noticed some uses of ${srcdir} in shell scripts.
    That is almost always better written as $srcdir.
    The patch below converts most such variable references.
    Here are the few remaining candidates:
    
    $ git grep -i -E '\$\{[a-zA-Z_0-9]+\}'|grep -v Makefile.in.in
    configure.ac:        JAR_INSTALL_DIR=\${prefix}/share/java
    configure.ac:        JNI_INSTALL_DIR=\${libdir}
    debian/rules:   for TEST in ${DEBIAN_SKIP_TEST}; do \
    debian/rules:#          mv $${mod} $$(dirname $${mod})/libguestfsmod.so; \
    java/Makefile.am:libguestfs_jar_DATA = libguestfs-${VERSION}.jar
    java/Makefile.am:libguestfs-${VERSION}.jar: $(libguestfs_jar_class_files)
    perl/lib/Sys/Guestfs/Lib.pm:                      "-f", '${Package} ${Version} ${Architecture} ${Status}\n',
    perl/typemap:            croak (\"${Package}::$func_name(): called on a closed handle\");
    perl/typemap:        croak (\"${Package}::$func_name(): $var is not a blessed HV reference\");
    tests/data/Makefile.am:   echo "$${i}abcdefghijklmnopqrstuvwxyz"; \
    
    We could change all of those, too, except the ones in configure.ac
    and Makefile.am, since they refer to Make variables.  Even those
    should be changed, but to use the preferred Makefile notation:
    $(prefix), $(libdir), $(VERSION).
    
    >From a86770ecd45666232a94d76c8725c8f9b1c76e3a Mon Sep 17 00:00:00 2001
    From: Jim Meyering <meyering@redhat.com>
    Date: Mon, 23 Jan 2012 11:15:12 +0100
    Subject: [PATCH libguestfs] maint: use $var notation rather than ${var} when
     possible
    
    The only case to avoid in a shell script is when the byte after the
    "}" is word-constituent, and concatenating it would thus change the
    name of the variable.
    
    These changes were induced by running this command:
      git grep -l -i -E '\$\{(srcdir|md)' \
        |xargs perl -pi -e 's/\$\{(srcdir|md)\}($|\w)/\$$1$2/gi'
    
    The "g" was needed because there was one line with two instances.
    The "i" is to handle ${SRCDIR}.  The ($|\w) ensures that concatenating
    whatever follows the "}" won't change semantics.
    
    * gobject/run-bindtests: Use "$srcdir", not "${srcdir}".
    * haskell/run-bindtests: Likewise.
    * java/run-bindtests: Likewise.
    * ocaml/run-bindtests: Likewise.
    * perl/run-bindtests: Likewise.
    * python/run-bindtests: Likewise.
    * ruby/run-bindtests: Likewise.
    * tests/guests/guest-aux/make-debian-img.sh: Likewise, but $SRCDIR.
    * tests/guests/guest-aux/make-ubuntu-img.sh: Likewise.
    * tests/guests/guest-aux/make-windows-img.sh: Likewise.
    * tests/md/test-mdadm.sh: Likewise, but $md.

commit 37e07db1598b433c12ee643302712d81b2c5415d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 23 10:35:24 2012 +0000

    Update API support.

commit 3a754cc88fca72db8bb2f8e6c83df13491f25ff0
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Mon Jan 23 09:48:37 2012 +0000

    gobject: Run bindtests from srcdir.

commit 70070cf24420bee01770da2897d2ca32e3183181
Author: Jim Meyering <jim@meyering.net>
Date:   Mon Jan 23 10:03:14 2012 +0100

    build: don't use automake-internal variable
    
    Hi Rich,
    
    I realized a day or two late that my suggestion was not quite right.
    Here's the fix:
    
    >From 5294c21cf07c4ec2f094182ba9f32696f3de2751 Mon Sep 17 00:00:00 2001
    From: Jim Meyering <meyering@redhat.com>
    Date: Mon, 23 Jan 2012 10:01:40 +0100
    Subject: [PATCH libguestfs] build: don't use automake-internal variable
    
    * ocaml/Makefile.am (mlguestfs.cma): Use the documented variable form,
    $(libguestfsocaml_a_OBJECTS), not the $(am_libguestfsocaml_a_OBJECTS)
    that I suggested for commit 1.15.16-17-g8b9eaec.

commit 7fbf0cc4993908d143ac9ea1005815863f222062
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Fri Jan 20 08:44:46 2012 +0100

    check for febootstrap etc. even if not building appliance

commit d4f79584875381af0d07d29eba1f9f80603e27ff
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Sat Jan 21 22:32:45 2012 +0100

    fish: Filter out error messages about history file in test script

commit b6e0552ee5359da785bd1c08cadf022190e98720
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Sat Jan 21 22:56:51 2012 +0100

    Do not run appliance-related checks if not building appliance

commit 7004fafc6989efbbb1ef46723e8a91f936f16249
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Sat Jan 21 22:39:59 2012 +0100

    Replace setting of environment variables with usage of local run script
    
    (Includes fix by RWMJ)

commit 5cfd3e7b3e1a7a4031f676d5b65392c7de113164
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jan 22 14:47:43 2012 +0000

    php: function_entry -> zend_function_entry.
    
    function_entry was left over from PHP 3.
    
    See: http://news.php.net/php.pecl.dev/7123

commit 4f868b84d6e7c387e27f50aae54476bc97a70bc2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jan 22 14:38:07 2012 +0000

    php: Enable 'make clean' in extension subdirectory.

commit 71785543325535379d9ab59fb3594ec6fe4e9309
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 21 11:19:29 2012 +0000

    Version 1.15.19.

commit 17a599ef277254775fedad91384480be969e1d8e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jan 22 11:33:01 2012 +0000

    gobject: Include bindtests-manual.js in EXTRA_DIST.
    
    This fixes commit 93b0769ec7929a909678411d75840f81bed55a81.

commit f81499fb64f4f4910dd3989ed297e1a0a143e332
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jan 22 11:01:12 2012 +0000

    gobject: Document these bindings in guestfs(3).

commit 4edd061975217e4eeb09f66b8c9ea0d3fb17edba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jan 22 11:00:58 2012 +0000

    website: Rebuild the HTML manual pages from scratch.

commit de5d416fc7b3213641b035288c1df199346e9020
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 21 11:27:35 2012 +0000

    daemon: Move internal-autosync function to new file internal.c.
    
    This is just code motion.

commit 93b0769ec7929a909678411d75840f81bed55a81
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Jan 19 16:51:01 2012 +0000

    gobject: Add bindtests for return values

commit 02ccef7684b0e0ec7c0e9435393f24b0c6b417f4
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Jan 19 16:43:20 2012 +0000

    bindtests: Test optargs in test0
    
    Note that this change disables compiling and running the haskell bindtests. The
    haskell bindings do not implement optargs, and adding optargs to test0 causes
    that method not to be bound in the haskell bindings. This prevents the haskell
    bindtests from compiling. These should be re-enabled when optargs are
    implemented.

commit e99a6a84834d924095a873514a159304091f2b1f
Author: Matthew Booth <mbooth@redhat.com>
Date:   Tue Jan 17 16:41:07 2012 +0000

    gobject: Add basic bindtests

commit cce1bbb345978ac9e1813745cfee19bb3ce661e7
Author: Matthew Booth <mbooth@redhat.com>
Date:   Tue Jan 17 15:28:01 2012 +0000

    run script: Add support for gobject introspection

commit 5c5babb40b06256d251425b10ca5cfff97907462
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Jan 4 09:42:41 2012 +0000

    gobject: Add GObject bindings

commit eb58fa9978b71448c01348c151cc002c21983c71
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Jan 20 10:55:24 2012 +0000

    generator: Add CamelName flag
    
    We can make a good guess at camel case names for most APIs. For example,
    add_drive_opts can be automatically transformed to AddDriveOpts. However, other
    apis don't produce a satisfactory name when transformed automatically. For
    example, we would want md_create to produce MDCreate rather than MdCreate.
    
    This change adds a CamelName flag which allows a camel case name to be specified
    explicitly when the automatic transformation isn't satisfactory.

commit b8720abfe56391bf5b7b624e003ab7df90f5ceb4
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Fri Jan 20 08:44:47 2012 +0100

    resize, sparsify: find progress mini-library in out-of-tree builds

commit 251c6e994de97d9e87a0ace01144c12366e12c2b
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Fri Jan 20 08:44:44 2012 +0100

    Fixed out-of-tree compilation of OCaml code after .depend files removal

commit 762d1bbda18ffd6c16980009946549384bb95526
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Fri Jan 20 08:44:42 2012 +0100

    fish: Remove hard-coded path from test script

commit 3d80161d9c277c800a3214694ba56a8909e655df
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Jan 18 17:33:42 2012 +0000

    c: Fix prototype generator when last argument is a BufferIn
    
    We were passing the name of the last argument directly to va_start. However, if
    the last argument is a BufferIn it expands to 2 arguments, the latter of which
    is <name>_size.

commit 24f01a581b0452cfc8d7239b6a556e4282b0b964
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Jan 18 16:44:10 2012 +0000

    bindtests: Add a test for RBufferOut
    
    Fixup the existing test, and add an entry in actions so it's actually generated.

commit a20b88be8364fc485d654377819e6daab303ef7a
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Jan 18 16:26:26 2012 +0000

    bindtests: Fix sscanf test in test0rhashtable

commit 7412bb342141bdfe0d44d6526728f4e1fd284fe0
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Jan 18 16:11:14 2012 +0000

    bindtests: Add something non-zero to the RStructList test output

commit 04cb1bb10627e3e3ab139d392887b8afb6a70c08
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 20 12:16:53 2012 +0000

    Update release notes with feedback from Hilko Bengen.

commit 3f6ca541c7b24d4c86688a509582cb41a7e0078c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 20 09:40:35 2012 +0000

    Revert "generator: Add CamelName flag"
    
    This reverts commit 83c20f02dc0e97b098e9de837839a3f4a4416129.

commit 1982779fa31a823f8277343c90d871553dc2450a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 19 18:41:35 2012 +0000

    Version 1.15.18.

commit 72c97e6607ba12ff590e2f27d563910537ac8fc4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 19 16:07:39 2012 +0000

    Update release notes.

commit a9c8123c72db47bcab8dd738e8d5256a9ae87f11
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 19 13:54:50 2012 +0000

    daemon: Run udev_settle after pwrite-device finishes.
    
    When you call close on any block device, udev kicks off a rule which
    runs blkid to reexamine the device.  We need to wait for this rule to
    finish running since it holds the device open and can cause other
    operations to fail, notably BLKRRPART.

commit ea3f16f6d9dd1aedc03c4438d1f01565d634ffda
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 19 13:07:30 2012 +0000

    appliance: Add psmisc package to the appliance.
    
    This allows us to use 'fuser' and other ps tools.

commit 61abcf71c05c07bfaca96666b16a0bc30a6edab4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 19 11:30:23 2012 +0000

    daemon: pwrite/pread: Don't double close on error path.
    
    In Linux, close (fd) closes the file descriptor even if it returns an
    error.

commit 08840bab44c38d0c69b5780c57b2bf370c96d58c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 18 22:05:02 2012 +0000

    Tempus fugit.
    
    Update all copyright dates to 2012.

commit d8a1389df35ddd5b6d9af86dc27c1978ea07348f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 18 21:15:37 2012 +0000

    tools: Mark obsolete tools clearly in the man pages.

commit b9b77e701421033c196d2b80559cdcd721e28570
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 18 16:09:20 2012 +0000

    Version 1.15.17.

commit 535977bff811d996bd61577e3e71af1393646951
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 18 12:48:14 2012 +0000

    lib: Use -fvisibilty=hidden by default; only ABI symbols are now visible.
    
    http://gcc.gnu.org/wiki/Visibility

commit 8b9eaec993e3199ff4ef1056abe2f18cbed1289b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 18 12:30:36 2012 +0000

    ocaml: Use automake to build the C part of the bindings.
    
    By arranging the C part of the bindings into a library, we can get
    automake to build it instead of using $(CC) directly.

commit 607784df926aeb9293dbeb346f45d93907c7ffa2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 18 10:37:47 2012 +0000

    ocaml: Don't include guestfs-internal.h directly.
    
    However since the OCaml bindings use guestfs_safe_strdup and
    guestfs_safe_memdup we need to export those two (in the private
    functions section) from <guestfs.h>.

commit db90770ec5e867cc120a9753bf928f081002c2e7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 18 12:47:49 2012 +0000

    ocaml: Add -Wno-missing-field-initializers to avoid a warning.

commit 6de1a1242e9501f8a7042d3cdd970ab9c7496823
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 17 17:34:24 2012 +0000

    New tool: virt-format: erase and make blank disks.
    
    This tool allows you to easily reformat a disk, creating a blank disk
    with optional partition, LVM and empty filesystem.

commit dd0707be5f9153a78ea0a07ec72f4e1f341a38c9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 17 18:28:44 2012 +0000

    fish options parsing: Allow add_drives to be called multiple times.
    
    Ensure that the drv structure is always zeroed on allocation.
    
    Don't leak old drv->device when add_drives is called multiple times.

commit fd1a6d8003b29eaec5230f838f673df7cd0e9c86
Author: Matthew Booth <mbooth@redhat.com>
Date:   Tue Jan 17 13:44:29 2012 +0000

    c: Allow NULL optargs to be passed to _argv calls
    
    Previously, passing NULL optargs to an _argv call resulted in a segfault. This
    change causes NULL optargs to be interpreted as no optargs, and to be correctly
    handled accordingly.

commit c7119da1306e1e04a1a35c5c2caf407e4b46d173
Author: Matthew Booth <mbooth@redhat.com>
Date:   Tue Jan 17 13:25:21 2012 +0000

    c: NFC Remove redundant parentheses

commit 3b352de1e91e6d0a5190e631159398164f4a8e0d
Author: Matthew Booth <mbooth@redhat.com>
Date:   Mon Jan 16 14:45:03 2012 +0000

    generator: Add an explicit Cancellable flag
    
    Currently any api which takes a FileIn or FileOut parameter is implicitly
    cancellable. This change make cancellable an explicit flag in anticipation of it
    being added to other apis.
    
    Note that a Cancellable function must be able to return an error, which means it
    can't return RConstOptString.

commit 83c20f02dc0e97b098e9de837839a3f4a4416129
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Jan 13 10:00:30 2012 +0000

    generator: Add CamelName flag
    
    We can make a good guess at camel case names for most APIs. For example,
    add_drive_opts can be automatically transformed to AddDriveOpts. However, other
    apis don't produce a satisfactory name when transformed automatically. For
    example, we would want md_create to produce MDCreate rather than MdCreate.
    
    This change adds a CamelName flag which allows a camel case name to be specified
    explicitly when the automatic transformation isn't satisfactory.

commit b1ea8a7808744068fe0d1306d1005e841a570b4c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 16 10:15:02 2012 +0000

    resize2fs-M: fix double-free along error path (thanks Matthew Booth).

commit 3e9f8d050a7709ef3e9ea8c6b5098bac6fc21740
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 16 10:14:38 2012 +0000

    e2fsck: Tidy up the documentation for this API.

commit 4ac5e2d2180f6cbf8c1f14b8b54f97b5a1865318
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Sat Jan 14 00:03:45 2012 +0800

    e2fsck-f: change the internal to use e2fsck
    
    Since we implement the new api e2fsck, just change the
    internal of e2fsck_f to use e2fsck now.
    v1->v2: use optargs_bitmask
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 38a0966da88da6d199eb1da37456b4c33f4901da
Author: Wanlong Gao <wanlong.gao@gmail.com>
Date:   Sat Jan 14 00:22:09 2012 +0800

    NEW API: add a new api e2fsck
    
    m: Wanlong Gao <gaowanlong@cn.fujitsu.com>
    
    Add a new api e2fsck with two options:
    correct: same as '-p' option of e2fsck
    forceall: same as '-y' option of e2fsck
    
    Thanks for Rich's idea.
    v1->v2: use optargs_bitmask
    v2->v3: change the optargs_bitmask check
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 0eaf06e673833bc25673d5c3d2487fffae310285
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Sat Jan 14 00:03:43 2012 +0800

    ext2: tweak the error returned message of resize2fs-M(BZ755729)
    
    Tweak the error message "e2fsck -f" and "e2fsck -fy".
    Indicate the user to use the correct and/or forceall options.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit f6db1ec41050e70580674ebbeb8fac5335df3284
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Jan 11 11:07:34 2012 +0000

    build: Remove .depend files from git
    
    Remove generated .depend files from source control, and don't barf when they
    don't exist while bootstrapping.

commit 9fde0fad08c5807fb442db9616fbfe202fedba8a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 11 14:03:02 2012 +0000

    Update RELEASE-NOTES.

commit 54a7982dc3a6d3cc903c8d6e73be30c46fdf90d4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 10 18:52:53 2012 +0000

    extra-tests: Only test 5 random guests.
    
    If you have a lot of guests, running extra tests takes a lot of time,
    but (arguably) you're not really doing any more detailed testing.
    
    Thus pick up to 5 guests at random to test.  A different random
    selection is done on each run, ensuring that data-driven errors (eg in
    inspection) will still be found eventually.

commit adb0050d86dd069a7ac78d7bc9e7b932b25b8f5b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 10 16:53:17 2012 +0000

    Version 1.15.16.

commit 39a10c9fabcf7646b3dcb183c22ddba577d2a075
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 10 16:51:36 2012 +0000

    Allow /dev/null to be added multiple times.
    
    Change the test for duplicate drives so that you're allowed to
    add /dev/null multiple times.  This corresponds to traditional
    usage.
    
    This amends commit be47b66c3033105a2b880dbc10bfc2b163b7eafe.

commit 01e717b3c141c509a7200b0a6c560f75815c08f2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 9 16:55:49 2012 +0000

    daemon: debug segv correct use of dereferencing NULL.

commit e0c309379556ad50d43a08b4aa4ec0146d2b60d8
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Mon Jan 9 20:53:24 2012 +0800

    launch: move the filename checking to a wrapper
    
    Move the filename's comma character checking to a wrapper.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit be47b66c3033105a2b880dbc10bfc2b163b7eafe
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Mon Jan 9 15:22:43 2012 +0800

    launch: don't add a drive twice
    
    1. Change the g->path to restore a absolute path instead of the mixed.
    2. Check that if the adding drive is duplicated with the added drive.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>
    
    RWMJ:
    
    - Make sure abs_path is NULL before it is assigned, so freeing it
      will work along the error path.
    
    - Fix the test which added /dev/null multiple times.

commit 0a7b734d2f54d4e98882532da9887feb66c9824a
Author: Matthew Booth <mbooth@redhat.com>
Date:   Mon Jan 9 10:16:35 2012 +0000

    generator: Create a separate type for optional arguments
    
    Previously, optional arguments had the same type as regular arguments, but were
    constrained by various runtime tests to be only Bool, Int, Int64 or String. This
    change makes the type of optional arguments stronger by giving them their own
    type.
    
    A convenience function, optargs_to_args is defined to convert optargs in the few
    places where they are genuinely treated identically to mandatory arguments.
    
    It also allows for future changes to optional arguments which do not affect
    mandatory arguments.
    
    RWMJ:
     - removed redundant parens
     - readded the check for > 64 optargs, but changed it to > 63
     - changed the new function to args_of_optargs

commit e24af214fe8f9dccac39ed520b57ce7d458f9fd1
Author: Matthew Booth <mbooth@redhat.com>
Date:   Mon Jan 9 10:16:34 2012 +0000

    generator: Rename java_structs to camel_structs to better reflect their purpose
    
    This map was originally included just for the java bindings, but is generally
    useful to any binding which uses camel case by requirement or convention.

commit 6f6485ec34f29401bbab65dd4275a3b564ed11b3
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Mon Jan 9 15:22:42 2012 +0800

    launch: add a goto label when add_drive error
    
    Code cleanup.
    Add a goto label to simplify the code.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit da13c1c0e6980f4838090be9e775b4d5c35662b7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jan 8 19:12:46 2012 +0000

    Version 1.15.15.

commit 49b894599bf82790c83e2949626b7a8958732b6a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 6 21:08:25 2012 +0000

    debian: Add build-dep erlang-dev.

commit c51caebea20b499ca0f9e652da0d964689969d79
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 6 18:44:41 2012 +0000

    Update to latest gnulib.

commit ebdda911b5dc4e2695413578ed2e0f0b387c0d89
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Jan 4 11:15:24 2012 +0000

    Tempora mutantur, nos et mutamur in illis.

commit c655415dc051b84d6178399e5f7cb76ff7af06c0
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Jan 4 09:56:16 2012 +0000

    build: Fix automake warnings

commit 882408947758fde740efa87b55aff31cd1960983
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 4 10:16:29 2012 +0000

    Sort .gitignore (using sort -d -- dictionary order).

commit 8af6237fd6b84057760e61ffa5fb111e880a56be
Author: Wanlong Gao <wanlong.gao@gmail.com>
Date:   Fri Dec 30 16:10:50 2011 +0800

    gitignore: ignore the git related files
    
    *.eml for email picked patches
    other for orginal git patch related files.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit f49a30eba8bb9f352637c3c24138074bbe3f5555
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Wed Dec 28 17:59:38 2011 +0800

    fish: fix the Ctrl-\ causes guestfish to abort bug(RHBZ#596761)
    
    Handle SIGQUIT by guestfish, so that it can't be terminated.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 10df9d88ab4191c4092f4a88c7343ab3f5f31a70
Author: Wanlong Gao <wanlong.gao@gmail.com>
Date:   Tue Jan 3 23:41:43 2012 +0800

    AUTHORS: add the email address for each authors
    
    Add the email address for authors.
    It would be better.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 49218ae6b451004c8f7b5549d5876c8568a7c1a6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 23 22:30:29 2011 +0000

    fish: mount can be used instead of mount-options with libguestfs >= 1.14

commit 871e1cfe3ae28028eaa4be7d87d7c43f68b4d5ec
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 23 22:30:09 2011 +0000

    fish: Fix --format parameter in man page.

commit 03d052d5782aa1aed07fe8b37a846f8cd69961d3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 23 13:26:31 2011 +0000

    Version 1.15.14.

commit 6032da66819b7ccf99001ba636926100f475cb89
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 23 10:37:04 2011 +0000

    lib: Try harder to remove temporary directory along error paths (RHBZ#769680).

commit 690ff694ca6db586c06ec484ea158261c156aa2f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 23 10:33:25 2011 +0000

    lib: Add guestfs___remove_tmpdir helper function.
    
    This function does 'rm -rf <dir>' for temporary directories, safely
    working if '<dir>' contains shell meta-characters.
    
    Replace existing code for removing directories with this.

commit 486cafd4acf4945bbf3fea541eaa320f5c419406
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Fri Dec 23 14:54:04 2011 +0800

    gitignore: ignore the guestfs.* directory
    
    Let git ignore the guestfs.* directorys.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 87e03fd48ebc9d0fd3a6ba1ed2481f840ffa6db4
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Fri Dec 23 11:46:21 2011 +0800

    extra-tests: add test-guests to prevent test error
    
    extra-tests is depending on tests-guests.
    We need guests/*.img when doing extra-tests.
    
    /work/git/libguestfs/run valgrind --log-file=/work/git/libguestfs/tests/extra/valgrind.log --leak-check=full --error-exitcode=119 --suppressions=/work/git/libguestfs/tests/extra/suppressions ../../cat/virt-cat -a ../guests/fedora.img /etc/fstab >/dev/null
    ../guests/fedora.img: No such file or directory
    make[1]: *** [test-tools-internal] Error 1
    make[1]: Leaving directory `/work/git/libguestfs/tests/extra'
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit b5f90793026832889cae3d4997810cb34777cf9a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 23 08:28:26 2011 +0000

    fish: Fix test-guestfish-events.sh so it works when LIBGUESTFS_DEBUG=1 is set.
    
    Various messages were added and changed when this variable was set
    while tests were running.

commit 2ac869bcc86fbf0dd7e878f10a2b60769a58c962
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Wed Dec 14 17:40:56 2011 +0800

    mkfs: optimization and code cleanup
    
    v1->v2: fix a typo pointed by Matt
    
    Optimizations by reducing the STREQ operations and do some
    code cleanup.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>
    
    RWMJ: Whitespace changes.

commit 6067e1540fab8e8ca85e8c052bbee057882548be
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 22 22:17:17 2011 +0000

    tests/lvm: Contains a Perl test so we must set PERL5LIB.
    
    This fixes commit 498758faee6be7e989869bf7feba5e1026a1bb65.

commit 37aba887d7494a8d970a860e190bd77765d6b440
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 22 19:12:14 2011 +0000

    tests/protocol: Contains a Perl test so we must set PERL5LIB.
    
    This fixes commit 498758faee6be7e989869bf7feba5e1026a1bb65.

commit 76044a5c00fa331a36e2cbce0ef666b88c2988c2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 22 18:34:22 2011 +0000

    Version 1.15.13.

commit 9a5f784d511a8f00a8386f316eab41fe660430db
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 22 17:56:47 2011 +0000

    Security: Mitigate possible privilege escalation via SG_IO ioctl (CVE-2011-4127, RHBZ#757071)
    
    CVE-2011-4127 is a serious qemu & kernel privilege escalation bug
    found by Paolo Bonzini.
    
    http://seclists.org/oss-sec/2011/q4/536
    
    An untrusted guest kernel is able to issue special SG_IO ioctls on
    virtio devices which qemu passes through to the host kernel without
    filtering or sanitizing.  These ioctls allow raw sectors from the
    underlying host device to be read and written.  Significantly, neither
    qemu nor the host kernel checks that the range of sectors is within
    the partition / LV assigned to the guest.  For example, if the guest
    is assigned host partition /dev/sda3, it would be able to read or
    write any part of /dev/sda including other partitions and the boot
    sector.  Exploits through LVs passed to the guest are also possible,
    with some limitations.  File-backed virtual block devices are not
    vulnerable.  Non-virtio block devices are not vulnerable.
    
    This patch mitigates the problem by disabling the SG_IO ioctl
    passthrough in qemu.  Thus if libguestfs is examining an untrusted
    guest and the libguestfs appliance/daemon is compromised (eg. by
    executing guest commands, or through some other compromise), then the
    compromised appliance will not be able to issue the above SG_IO ioctls
    and exploit the host.
    
    Note that this is just mitigation for libguestfs.  Users will still
    want to fully update their host kernel, qemu/KVM and libvirt, in order
    to prevent other (non-libguestfs) routes to compromise.
    
    The following versions of libguestfs (will/have) this patch applied.
    
      libguestfs >= 1.15.13
      libguestfs >= 1.14.8
      libguestfs >= 1.12.11
      libguestfs >= 1.10.12
      libguestfs >= 1.8.16
    
    Earlier versions may be vulnerable unless a downstream packager has
    applied this patch.
    
    Cc: Hilko Bengen <bengen@hilluzination.de>

commit ad5b5f96da53a6f51424e22e26f2d8a325eec681
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Sat Dec 10 22:16:55 2011 +0100

    Fixed checks for libpython features
    
    The python3.1 package shipped with Debian/squeeze does not have the
    'mu' suffix that was assumed before.

commit be1419a442d9936e737fb2ca6f0fdba36a048964
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 22 16:13:08 2011 +0000

    Version 1.15.12.

commit 1fcec724aa565eac6604eae249f674ad47e9f8a5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 22 15:09:19 2011 +0000

    tests: Add a simple liveness tests for qemu.

commit 1edf00d3bdb38241007bc9c789bf9710f6f5c45c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 22 13:12:43 2011 +0000

    tests: Finalize the order we run the tests.

commit d24e088dc3475db4496e5cbd67c143c25ef12b1e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 22 13:05:34 2011 +0000

    tests: Put test-tool and comment into own section.

commit cd077b8229731e292798f34dd56892cbfa6f1e0e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 22 12:15:06 2011 +0000

    tests: Split images -> tests/data + tests/guests

commit c649817586e5b4df53b251d1290422f5ef046045
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 22 12:00:44 2011 +0000

    tests: Rename extratests -> tests/extra.

commit 498758faee6be7e989869bf7feba5e1026a1bb65
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 22 11:35:43 2011 +0000

    tests: Split regressions -> various subdirectories of tests/

commit 5d93d70b4d36b2337104b3dbca07722fa4d47ff5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 22 08:40:30 2011 +0000

    tests: Rename capitests -> tests/c-api.

commit 72f5487be2df82277021d61f01884381ed9efbc5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 22 08:34:57 2011 +0000

    tests: Rename caution -> tests/qemu.

commit c09db4e834ab0efb93588d0427aba110a1f234e8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 22 08:34:08 2011 +0000

    tests: Document new tests/ subdirectory.

commit f5a49bf1cae335889da6be53fd1ca302273be78b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 22 08:33:16 2011 +0000

    docs: Arrange directory names in alphabetical order.

commit a0a8de4253ad545d668977dbf54f90118f601192
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 20 18:26:20 2011 +0000

    extra-tests: Add an extra suppression for OCaml 3.11.2 in RHEL 6.

commit 7123f0cab155c5c25ecae670677683001c1634ad
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 14 08:38:27 2011 +0000

    fish: Allow events to be processed in guestfish.
    
    Add 'event', 'list-events' and 'delete-event' commands so that event
    handlers can be registered, listed and deleted in guestfish.  The
    event handler is a shell script snippet or host command.
    
    Cc: Pádraig Brady <P@draigBrady.com>

commit 3c9dfd1e95fae5c31df1fbcb6bdec2982a69a004
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 14 12:07:31 2011 +0000

    python: Missing () in guestfs-python(1) examples.

commit 0ef30bbb316b50beba511a5eb4bd7174671fa1ca
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 9 17:34:01 2011 +0000

    Version 1.15.11.

commit ae45cee728039d7724fc73e5ffb2550c8054d268
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 9 15:30:23 2011 +0000

    fuse: Return EXIT_FAILURE if fuse_main fails.
    
    fuse_main can return any non-zero value on error.  In particular on
    certain sorts of error such as unsupported -o options it returns 1
    (not -1).
    
    Therefore make sure any non-zero return is turned into EXIT_FAILURE.
    
    (Thanks Pádraig Brady)

commit 54e91da925323642e67b8ce4b95899fe4b7a51c4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 9 09:49:37 2011 +0000

    fish: -i option should fail if / is not mountable, but warn about others.
    
    In particular this stops a problem with guestmount where if the -i
    option half-recognizes the guest OS, it would mount the disk (and
    fail, giving only warnings), leaving the mountpoint unusable.
    
    (Thanks Pádraig Brady)

commit 19e2f5aa4fd4ed70b505661d918b5575616ad441
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 8 11:39:58 2011 +0000

    daemon: Fix utimens so it doesn't hang on named pipes (RHBZ#761460).
    
    This also adds comprehensive tests for utimens on regular files,
    directories (RHBZ#761451), named pipes (RHBZ#761460), symbolic links,
    block and char devices.
    
    Note that there is a small change in the (previously undefined)
    semantics of this call: It now sets the time on a symbolic link
    itself, not on what the symbolic link points to.

commit 31fba8d8033216f8a288e75fe3f575b73b9ef925
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 8 11:15:18 2011 +0000

    daemon: Allow utimens to work for directories (RHBZ#761451).
    
    You don't need to open the file O_WRONLY in order to call futimens on
    the file descriptor.  Opening it O_WRONLY fails for directories.
    Therefore open O_RDONLY instead.

commit 98edfac1ee70bcf15ee7caebc306e11cdbbb0d9a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 7 12:12:35 2011 +0000

    copy-in/copy-out: Wait for the tar subprocess only (RHBZ#760669).

commit 7d3848ddc046f79cc1112809bd9970eea8060018
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 7 11:46:43 2011 +0000

    fish: Improve error messages when no OS / multi-boot OS found with inspection (RHBZ#760775).

commit 41a7a68cf33a174ba950aa29951a07c391a16b4d
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Tue Dec 6 20:42:11 2011 +0100

    let the user explicitly choose ruby and rake programs

commit 2353b9d3b867fb19db4e403b49a93674d8b2682c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 6 15:10:46 2011 +0000

    Version 1.15.10.

commit 43942b08cfbcf91bef29ec532f3d097a8519c982
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Mon Dec 5 18:35:57 2011 +0100

    Fix rpcgen post-processing for out-of-tree builds

commit 2972987d0257d9c3d26b53f961e802d121b436cd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 5 10:36:13 2011 +0000

    ruby: Use RSTRING_PTR, RSTRING_LEN for compat with Ruby 1.9 (RHBZ#760000).

commit 6c5f7c954cfdce16d4883b7244b5bc324c417ddf
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Mon Dec 5 18:06:43 2011 +0800

    blkid: split the RHEL5 which can't support some options
    
    RHEL5 shoult not support '-p', '-i' and '-o export' options.
    But we just split it according to the '-p' option.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit f499d7d42567349a7e45170df95de97f38db5b52
Author: Wanlong Gao <gaowanlong@cn.fujitsu.com>
Date:   Mon Dec 5 16:57:22 2011 +0800

    TODO: remove the implemented command blkid
    
    Remove the implemented command blkid from TODO lists.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit e18058a5a56236cbac23f10dc8a91420a3525562
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 4 16:47:37 2011 +0000

    Revert "blkid: Use -c /dev/null because RHEL 5 blkid doesn't have -p option."
    
    This reverts commit 6533491b178d18bfab8240cf093be4ef9b547548.

commit 7f14c042eb6ecab162d599fb182c7d63cebcfb9e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 4 16:47:29 2011 +0000

    Revert "blkid: Fix mistake in previous commit."
    
    This reverts commit c48226a5026816b115ab63b50d3601531aff59dc.

commit c48226a5026816b115ab63b50d3601531aff59dc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 3 23:16:00 2011 +0000

    blkid: Fix mistake in previous commit.
    
    This updates commit 6533491b178d18bfab8240cf093be4ef9b547548.

commit 6533491b178d18bfab8240cf093be4ef9b547548
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 3 22:58:03 2011 +0000

    blkid: Use -c /dev/null because RHEL 5 blkid doesn't have -p option.

commit 615924abaa968398d6529529fa2f31ae23de825b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 3 14:34:52 2011 +0000

    daemon: Use pkg-config to locate Augeas CFLAGS / libraries.
    
    Augeas 0.10 depends on libxml2, so this is now required in the
    appliance (in fact, it was already present).
    
    However this exposed two bugs:
    
    (1) In libguestfs we use a home-brewed recipe for Augeas flags,
    resulting in this error:
    /usr/include/augeas.h:24:25: fatal error: libxml/tree.h: No such file or directory
    
    (2) Augeas's own augeas.pc didn't include the libxml2 flags, so
    it was broken.  This requires a patch to Augeas 0.10, see:
    https://www.redhat.com/archives/augeas-devel/2011-December/msg00008.html
    
    Change to using pkg-config to detect Augeas.  It is still an optional
    library.

commit cd1322e30d6c34d7d9f87d72dfa1660aa5d8af38
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 3 12:59:27 2011 +0000

    Version 1.15.9.

commit fcb975a6424d48d63f03961e34b92ed7c6a27362
Author: Wanlong Gao <wanlong.gao@gmail.com>
Date:   Sat Dec 3 17:07:47 2011 +0800

    NEW API: add blkid command to print the attributes of the device
    
    A NEW API blkid.
    It can print the device attributes.
    Use it after list-devices, we can list ower devices and the attributes
    of each device.
    Use it like:
    blkid <device>
    It's should be a usefull function.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit b7addee24d211014086c44bcef6a0c799e4fb987
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 2 15:03:19 2011 +0000

    extra tests: Test that valgrind and libtool are installed.

commit e72c200e4c16dce72654a57ef6e9a0ad1ca686e1
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Dec 2 14:04:20 2011 +0000

    inspection: Add a test for MD device mapping in fstab
    
    Check that we properly handle fstab entries of the form /dev/md0 and
    /dev/md/foo.
    
    RWMJ: Add a skip to test if the Augeas lens is not available.

commit 922c3623c63b137ce940c574791104744e716c4a
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Dec 2 14:04:19 2011 +0000

    inspection: Handle MD devices in fstab
    
    This patch fixes inspection when fstab contains devices md devices
    specified as /dev/mdN. The appliance creates these devices without reference to
    the guest's mdadm.conf so, for e.g. /dev/md0 in the guest will often be created
    as /dev/md127 in the appliance. With this patch, we match the uuids of detected
    md devices against uuids specified in mdadm.conf, and map them appropriately
    when we encounter them in fstab.

commit 655f8037def7742a608fb272004eec51424ac31d
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Dec 2 14:04:18 2011 +0000

    build: Add more suppressions for valgrind tests

commit 1970a14178b5c53569965d35e54efead6c4c4bdc
Author: Wanlong Gao <wanlong.gao@gmail.com>
Date:   Fri Dec 2 21:47:51 2011 +0800

    mkfs: enable to make xfs filesystems when the device already has a filesystem
    
    Just add the -f option to mkfs.xfs to make sure we can
    make a xfs filesystem when the device already has a
    filesystem on it.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 1a35ca59088e572c11633e85524bb282cb436186
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Thu Dec 1 22:06:30 2011 +0100

    libguestfs: Added gnulib includes from builddir, as suggested by the Gnulib documentation
    
        Since some modules (`getopt', for example) may copy files
        into the build directory, `top_builddir/lib' is needed as well as
        `top_srcdir/lib'. -- GNU Gnulib manual, section 2.2 Initial import

commit f23352aefd96dc873111e5e5d55ea22b30c3e0ad
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 30 17:08:33 2011 +0000

    todo: Suggestion for UUIDs in /etc/fstab (thanks Joshua Daniel Franklin).

commit ce331df0f1857bccebaaddfac79677bc9f527197
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 30 17:08:27 2011 +0000

    ocaml: Fix OCaml dependencies.

commit ece902712bcd54e0cd28b57352c6a4efcf26c4f6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 29 23:31:30 2011 +0000

    Version 1.15.8.

commit e7e3a32edc29e3448b1d7efb3f6b53c5173c4e9c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 29 18:20:05 2011 +0000

    python: Memory leak: Free roots array along handle close path.

commit 00c9755ee3bea98968acea47bac858db94f7fbe2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 29 18:19:54 2011 +0000

    perl: Memory leak: Free roots array along handle close path.

commit eb7ec6170eca278fb910e18ca1f7ca81c6b507c0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 29 17:47:18 2011 +0000

    ruby: Memory leak: Free roots array along handle close path.

commit efef3e3c1205e5476044f41fb88385e3ba07468d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 29 17:51:59 2011 +0000

    extra tests: Add comments about what is not tested here.

commit 27d00960c93b26c68fa1f4068502c32a6e3b5e94
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 29 17:32:19 2011 +0000

    extra tests: Absolute path for 'run' command.

commit cee513112adcf4084d6be9e3b5037b7b54c9f514
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 29 17:22:56 2011 +0000

    extra tests: Split up and reorder tests more logically.

commit 14b1e7b963cd5446ab76a067085b91925dd5d3e3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 29 17:20:11 2011 +0000

    extra tests: Test virt-sparsify.
    
    This adds the virt-sparsify --debug-gc option which causes
    virt-sparsify to call Gc.compact before exiting, allowing
    GC and memory problems to be tested.
    
    Add an extratest which runs virt-sparsify under valgrind.

commit 7708d3e04f6ec3985fd74ee1a44a5615d43065e2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 29 17:14:18 2011 +0000

    extra tests: Test virt-resize.
    
    This adds the virt-resize --debug-gc option which causes
    virt-resize to call Gc.compact before exiting, allowing
    GC and memory problems to be tested.
    
    Add an extratest which runs virt-resize under valgrind.

commit 082a55f76cd61f3590976f6b095552ea65259ced
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 29 17:13:45 2011 +0000

    ocaml: Load test should call Gc.compact to flag memory errors.

commit 6bd0eec12f2e39360847bfe7a9f50628cc89ed8e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 29 17:13:17 2011 +0000

    ocaml: Fix memory leak in bindings for functions that return buffers.
    
    RBufferOut binding didn't free the buffer after copying it onto
    the OCaml heap.
    
    Found by valgrind.

commit bcd2dba76efa4da4edb1b04f6348b0a0dfb109c2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 29 16:11:21 2011 +0000

    Version 1.15.7.

commit e1f395defc6db5bbc82537af6e517d94216b7d4b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 29 13:13:44 2011 +0000

    extra tests: Run C API tests under valgrind.

commit d81c0829ea4a99aadb98df37be9543a973269041
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 29 13:13:06 2011 +0000

    protocol: Memory leak: Free temporary buffer along recv_discard path.

commit aa4eb4cd109dda0dc7dfdd66a5163a18b0be2277
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 29 12:52:15 2011 +0000

    extra tests: Run OCaml tests under valgrind.

commit 6ccae55ddcf0c08cd1b1cdbc07afeed043ad410d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 29 12:51:20 2011 +0000

    extra tests: Split VG variable into VG / RUN_VG.
    
    This is just code motion.

commit c5dbb1e63a8e0c45c7088dd2e58f5abbcfc30620
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 29 12:25:34 2011 +0000

    ocaml: Memory leak: Free roots array along handle close path.

commit 35c8e4fa7f5c90cc8371028e2bfc0562272380e3
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Nov 25 13:16:54 2011 +0000

    inspection: Cleanup iteration over fstab entries in inspect_fs_unix.c
    
    Select non-comment labels using an augeas path to return the correct
    nodes in the first instance, rather than applying a regular expression
    to all results.
    
    There is no functional change to the code.
    
    RWMJ:
     - Rebased to current HEAD.
     - Move variable decls to top of function.
     - Some whitespace changes.
     - Remove check for errors from snprintf since it can never happen.

commit 7c89d9ef6b37314fb55aabd0c389a9d652acdb0f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 28 20:40:01 2011 +0000

    inspection: Add outline support for GNU/Hurd.

commit f5bfc68fdb3e25b9d75c65e3f5e88983584b25ed
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 28 19:12:44 2011 +0000

    fish: When -m option fails, canonicalize device names that are printed.
    
    The error message now looks like this:
    
      guestfish: '/dev/vda6' could not be mounted.  Did you mean one of these?
                /dev/sda1 (ext4)
                /dev/vg_f15x32/lv_root (ext4)
                /dev/vg_f15x32/lv_swap (swap)
    
    Note that '/dev/sda1' has been canonicalized.

commit 450134501c37f1dd1b898dc390591a3f84ec18b4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 28 19:07:30 2011 +0000

    fish: Rearrange code for displaying mountpoints when -m option fails.
    
    This also frees the list returned by guestfs_list_filesystems.

commit 425374ddc84c4f9f74a5218e8d35452bb511d9f3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 25 08:34:59 2011 +0000

    docs: Tidy up documentation for md-stop.
    
    This cleans up commit cbd1c45d95c530c8d94103dcc2c521bf5501ef59.

commit 56c151fe8c6e4c2e9b35506339cabfef0957f824
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 24 20:28:02 2011 +0000

    Version 1.15.6.

commit b5b4816ab006ce09b7a7103dbe87b3129046648d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 24 20:17:57 2011 +0000

    ubuntu: Add extra suppressions for libnl.1 leaks.

commit 56b3b40603a95b09a0f34c2e49143bc7b40cbdfd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 24 19:36:50 2011 +0000

    Update API support.

commit be7cb789069afc93e7c1b0e7a1a9a293dc846d45
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 24 17:47:13 2011 +0000

    extra-tests: Include valgrind suppressions file.
    
    This updates commit c55bad93fbde03a3daa6058913f02098c45e55f5.

commit 3bbcbd5eeadabb1cc5a40b2f8ae586e6aafd39c6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 24 16:54:17 2011 +0000

    regressions: Allow test-launch-race.pl to be skipped.
    
    export SKIP_TEST_LAUNCH_RACE_PL=1
    will cause this test to be skipped.

commit 2d5841133a199619d56d026ad9ea4e97791f4a8f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 24 16:27:36 2011 +0000

    debian: Use mdadm -D --export instead of mdadm -DY.
    
    For compatibility with mdadm on Debian Squeeze.

commit c55bad93fbde03a3daa6058913f02098c45e55f5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 24 14:08:09 2011 +0000

    Add 'make extra-tests' rule and run extra tests.
    
    These tests are optional, and require a special environment and
    tools to run.

commit dd76ce2b4c93dd10d8eca9ab7c77bc831f103d03
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 24 15:50:54 2011 +0000

    lib: Fix memory leak when debugging enabled (found by valgrind).
    
    If you enabled debugging (eg. LIBGUESTFS_DEBUG=1) then every
    debug message printed would be leaked.

commit bfc0a5f58d3cb6faad5a44bed392f33190e62246
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 24 15:49:49 2011 +0000

    test-tool: Fix multiple memory leaks found by valgrind.

commit cd3d28491dd19d25a6c04a8bc6a7ec94bded413b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 24 15:49:27 2011 +0000

    filesystems: Fix memory leak found by valgrind.

commit c4381dba737d5cb8aad8e1b2e2123b0fcaff1d1a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 24 14:39:10 2011 +0000

    part-disk: Change default alignment of this to 64K (128 sectors).
    
    This is the minimum alignment.  1MB would be better.
    
    Note that the exact behaviour is not defined in the API.

commit 7b192f5a672197ad67ac23501e420c674aa2f3a9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 24 14:06:31 2011 +0000

    virt-alignment-scan: Add checks for when API calls return NULL.
    
    In particular, virt-alignment-scan -a /dev/null would segfault
    because of an error returned by parted.

commit cbd1c45d95c530c8d94103dcc2c521bf5501ef59
Author: Wanlong Gao <wanlong.gao@gmail.com>
Date:   Thu Nov 24 21:06:07 2011 +0800

    New API: md-stop for stopping MD devices
    
    This API is used to stop a md device.
    When we want to move a device to another md array, we should
    stop the md device which contained this device first.
    
    Signed-off-by: Wanlong Gao <gaowanlong@cn.fujitsu.com>

commit 182c25b2a42e9a8f76beba440da328e37f18c9b9
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Nov 24 12:09:03 2011 +0000

    Rename mdadm_ apis to md_
    
    This change renames the following 2 apis:
    * mdadm_create -> md_create
    * mdadm_detail -> md_detail
    
    This is more consistent with list_md_devices, and removes a reference to an
    implementation detail from the api.

commit 373dca7d12a8741e116205b4a3ac67a7d82cc782
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Nov 23 14:00:55 2011 +0000

    NFC: Allow multiple config files in inspect_with_augeas in inspect_fs_unix.c
    
    This change is in support of the addition of MD support to fstab inspection.

commit 011a248381cacd6751deb1d1be122cc9bd6aba09
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Nov 23 14:00:54 2011 +0000

    NFC: Consolidate the error path in check_fstab in inspect_fs_unix.c

commit 454a08380d9de78448927ab77480f833342d214c
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Nov 23 14:00:53 2011 +0000

    md: Inspect MD devices

commit c8cb3d27b62da20be6b2fa06f1ce6b63a722c32b
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Nov 23 14:00:52 2011 +0000

    NFC: Declare and use variables on the same line in inspect.c

commit 34c0542189a443e57f2b09886f31b5bdad404bbf
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Nov 23 14:00:51 2011 +0000

    build: Nothing under images/ should be translated

commit d3458d7bc46d4fa68acd759cf5dc308f76531fe4
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Nov 23 14:00:50 2011 +0000

    build: Create an MD variant of the dummy Fedora image
    
    This change involves rewriting make-fedora-img.sh in perl. This allows the
    flexibility to write mdadm.conf containing whichever uuids where randomly
    generated when the md devices were created.

commit 252ad4aa41c213948e4ee1f01e6c7ff7861f75e3
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Nov 23 16:35:10 2011 +0000

    run script: Don't overwrite LD_LIBRARY_PATH and PERL5LIB
    
    This change allows the run scripts of virt-v2v and libguestfs to be chained.

commit 065b6b5798913c9bb40215944920199ae7d27007
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 22 16:03:37 2011 +0000

    gnulib: Rebase to latest.

commit 9b102aae65449a8d321e8cf44a3993af558291db
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 22 16:40:37 2011 +0000

    Don't rely on implicit promotion of float to double in printf args.

commit 99ec97dcdfaf242ba0683a230ba51e4a87f7458b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 22 16:39:37 2011 +0000

    fish: In generated code, put function names on a new line.
    
    eg:
    
    static void
    run_foo ()
    {
    }

commit 7b3137e664c3f4edf6ac7043a34c4166567e17bd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 22 13:18:32 2011 +0000

    df, testing: Add notes on virt-df numbers (thanks Kashyap Chamarthy).

commit ce6c4eeabe3f2ce96d11d6d55c3ac6aca542d4c8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 22 10:11:10 2011 +0000

    sparsify: Add -o option for passing qemu-img output format options.

commit b83b705959c3c93bff0c343bcad09305399895a5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 22 09:54:52 2011 +0000

    sparsify: Add --compress option.
    
    This adds the -c option to the final qemu-img command.

commit 342b4a55d056734a0344db8b4bcf1a90104a8a59
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 22 09:39:54 2011 +0000

    sparsify: Add auto-detection of .vdi files.
    
    Note that for this to work properly, it requires a patch to
    the 'file' command.  See:
    https://www.redhat.com/archives/libguestfs/2011-November/msg00120.html

commit 0cdd9444744e7ae0d82fe4c94d13e9ddd00e8e2d
Author: Matthew Booth <mbooth@redhat.com>
Date:   Mon Nov 21 15:23:18 2011 +0000

    fish: Add MD devices to guestfish device autocompletion.

commit a7740cb19a6991d21dc9395dffb87d69ee5986b5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 21 13:25:36 2011 +0000

    Version 1.15.5.

commit 6f39cfaeacda146d0eaa35da6f6413fa6ab3d40a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 21 13:09:59 2011 +0000

    guestfs-testing: Link to libguestfs-test-tool.

commit 7828f4dfe3d5ff4d086261218908c8da37bb9d97
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 21 11:45:54 2011 +0000

    contrib: Update introduction to libguestfs.

commit 8bc6e9d6a89672bbe1e7469774abe889354deb67
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Sun Nov 20 23:57:47 2011 +0100

    out-of-tree build: ruby

commit a3b24296810d98e47552c6838dcd6ab6845aba03
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Nov 20 13:38:28 2011 +0000

    Add guestfs-testing(1) man page.
    
    This contains suggested manual tests that users can run.

commit 3e9f4af1e1126b1e1f7a93379172dd095dd1b908
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 17 13:33:57 2011 +0000

    Version 1.15.4.

commit c4bd6bba8d88ecf1ebf4a9c2c80a407d9971aaf7
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Nov 17 12:43:49 2011 +0000

    New API: mdadm-detail.

commit 0c99bb06f4565e053e18e082065bdc739f5130ab
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Nov 17 12:43:23 2011 +0000

    Add custom indentation config for vim.

commit 730fb50780df860474dc1fae16c9891187e99c82
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Tue Nov 15 21:28:22 2011 +0100

    out of tree build: haskell

commit a0509ff0715533e341573e24f6888fd7dcf4ba51
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Tue Nov 15 21:28:21 2011 +0100

    java: out-of-tree build, don't build static library

commit ddb3fac1bf1b0493779c9425b518598473ef106a
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Tue Nov 15 21:28:20 2011 +0100

    out of tree build: erlang

commit b051fffc6f4f6c095a3401f89a47fbb948a71ee1
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Nov 10 17:57:16 2011 +0000

    Update list-filesystems to check md devices.

commit 00a0fab50b3803be8db5b7d9fa0869a70b0da556
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Nov 10 17:56:10 2011 +0000

    New API: list-md-devices.
    
    Return a list of Linux MD devices detected in the guest.
    
    This API complements list_devices, list_partitions, list_lvs and
    list_dm_devices.

commit c11a92751e003b3d4bc3584b598afc9bd9d9e703
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 11 11:01:46 2011 +0000

    New API: mdadm-create for creating MD devices.

commit 47963bc9cc0b47af0541010a4fa14260405acaa5
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Nov 11 20:26:17 2011 +0000

    32 bit: Fix printf off_t.

commit 5d48250224fcb140b7e6e17f36b37deab4e0659b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 11 19:11:02 2011 +0000

    32 bit: Use %td for ptrdiff_t (difference between two pointers).

commit 6e6b3ff35f9baafb22d5459ca13c112b1e00ae1b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 11 13:30:09 2011 +0000

    df: Disable part of virt-df test.
    
    See:
    https://www.redhat.com/archives/libguestfs/2011-November/msg00051.html

commit c81a16a4e2e703d0aaa595151602bcf03430f6ab
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 9 17:54:38 2011 +0000

    New API: Bind the tune2fs command.
    
    Previously we bound the 'tune2fs -l' command so that we could list out
    the tunables of an ext2/3/4 filesystem.  Also commands like
    set_e2label and set_e2uuid used tune2fs.
    
    This commit binds many of the tunables that can be set using tune2fs.
    
    The coverage is not complete, but we can add more later because this
    uses optional parameters so the call is extensible without breaking
    ABI.  The current change gives us enough for using libguestfs within
    OpenStack.

commit 9ba779ea367b2ea7077da7bdd75e813cd06c7eea
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 10 16:34:57 2011 +0000

    tune2fs-l: Add a test.

commit 5f0b75f040b118c4394466438adc99f38144722d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 10 16:33:40 2011 +0000

    generator: Support testing the output of RHashtable functions.
    
    You can use TestOutputHashtable to test the output of RHashtable
    functions.

commit edd502543adbdc2fa5dda0c015ea7c390bb39f64
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 10 15:53:23 2011 +0000

    daemon: Define safe ADD_ARG macro for constructing arg lists on the stack.

commit 1ecc6b149364f3b4b6ed1a4b043821c3b025be98
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 9 22:44:47 2011 +0000

    Version 1.15.3.

commit 29172e7c4878085a680812f7f3b8ad6ea5f1193c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 9 17:48:42 2011 +0000

    ocaml: Fix bindings when a function takes more than 10 parameters.
    
    If any function had more than 10 required + optional parameters, OCaml
    bindings could not be generated.  Currently there are no such
    functions.

commit af2b0378bbb178a4e3db326ac3082d66170fcafc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 9 17:47:23 2011 +0000

    tests: Fix bitmask parameter when testing optional arguments.
    
    The bitmask was being constructed backwards(!)
    
    As a result, any test which tested optional arguments didn't work.
    There are very few such tests and they happened not to be affected by
    this.

commit 271f8e4b70e4acf2db96f6fe6317fda327fa5f2e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 9 21:21:00 2011 +0000

    fish: More informative documentation of optargs.

commit 145ed04e41a3fcd3be87c11cae0085f4551f1da8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 9 17:53:58 2011 +0000

    ocaml: Compile OCaml bindings and tests with -warn-error.

commit 22c72b911e65b93cfd049f42e6bd1b9ad7d55299
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 9 17:50:37 2011 +0000

    ocaml: Catch EVENT_ENTER case in test.
    
    For some reason we are not compiling the tests with -warn-error so
    this problem was not noticed before.
    
    This fixes commit 9420eaf44ec4067c3740b91b0be0fede08a0c515.

commit 04ea1375c55aa67df4e7fc61dbb534111767f3b6
Author: Matthew Booth <mbooth@redhat.com>
Date:   Tue Nov 8 14:27:49 2011 +0000

    Update FSF address.

commit 9c299b64bb24cefafa582fe425bb65b78373d205
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 4 15:55:13 2011 +0000

    daemon: Use a private copy of /etc/lvm so we don't modify the real config.
    
    In the libguestfs live case we need to be careful not to modify the
    real /etc/lvm/lvm.conf file (when setting the filter rule).
    
    When the daemon starts, make a complete copy of /etc/lvm in a
    temporary directory, and adjust LVM_SYSTEM_DIR to point to the copy.
    All changes are made in the temporary copy.

commit 6011b1f803ba7308c6a94b9bf6b7212cfccb9f42
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 4 15:30:12 2011 +0000

    daemon: Don't use files with fixed names in /tmp (thanks Steve Kemp).
    
    Although this doesn't matter for the ordinary (appliance) case, it
    matters for the libguestfs live case.  In that case it could cause the
    guest to be exploited by a tmp/symlink attack.

commit f93e8dbb78794029dcc51e8b0d77b5ed4eadac5e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 3 14:47:26 2011 +0000

    Version 1.15.2.

commit 22998927f91f123e7c35d3ebf49e5744f3d7eafe
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 3 13:09:54 2011 +0000

    virt-sysprep: Don't use xmlstarlet.
    
    Use virt-inspector --xpath option instead.

commit d1ee71782ace98a11c5aabaf1f9fd5f601e08367
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 3 13:06:25 2011 +0000

    Add virt-inspector --xpath to run XPath queries directly.
    
    xmlstarlet is good, but not available in Red Hat Enterprise Linux.
    
    Build a simple but sane XPath query parser into virt-inspector
    directly so that we don't need any external tools.

commit ffbafadcb8dfebcaba529cb8d7e2da52dd032d8a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 3 10:45:58 2011 +0000

    resize: Remove requirement for ocaml Pcre library.
    
    This library is not available in RHEL 6, and in any case removing the
    dependency is a simple change.

commit 63898268101e5ec91c8dac46651dbee5976272ce
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 3 10:32:02 2011 +0000

    resize: Add tests for some Utils functions.

commit 31e5539a14f78d8815d0d930e91023a65b5395e7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 3 09:48:45 2011 +0000

    python: Use sys.version_info[0] instead of sys.version_info.major.
    
    The major/minor fields only exist in Python >= 2.7.  This works for at
    least Python 2.5 and 2.6.
    
    Thanks to Hilko Bengen.
    
    This updates commit 646142f5136da9cfe2b908703a822c53350f70e9.

commit 2116f79cbcd4605b4997931285f14dde1f72a992
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 2 19:43:53 2011 +0000

    python: Fixes for Python 3 (RHBZ#750889).
    
    These fixes allow libguestfs bindings to work with Python 3 (tested
    with Python 3.2)
    
    You can select which Python you compile against by doing:
    
      PYTHON=python ./configure && make && make check
    
    or:
    
      PYTHON=python3 ./configure && make && make check

commit e2249b7ce1dd0a2f8f110e0e47aca397185a6373
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 2 19:42:29 2011 +0000

    python: Pass $PYTHON environment variable to tests.
    
    If the user set PYTHON when configuring, this variable is not passed
    through to the tests, so it is possible the tests will fail because
    they are testing the wrong version of python.  By passing $PYTHON
    through to the tests we ensure that we test against the same version
    of python that we configured with.

commit 25454b83082a4cfed4f1664d2f9cdfcb222ba7c2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 2 18:19:15 2011 +0000

    python: Include <config.h>.
    
    Ooops ...

commit 646142f5136da9cfe2b908703a822c53350f70e9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 2 18:18:14 2011 +0000

    python: Correctly check for Python major/minor.
    
    The manual for sys.version warns that you should not parse the string,
    which we were doing.  It would have failed on python "2.10" or
    similar.
    
    Do it correctly using the sys.version_info struct instead.

commit b4791fd4049d88421b240a17cc6417c0bbf8e795
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 2 13:23:37 2011 +0000

    contrib: Use PNG images as fallback for IE compatibility.

commit acd06dbe326da7cd883f0a7df599d0d173c4bd04
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 1 17:51:00 2011 +0000

    contrib: Update talk.

commit fdcd33a1554c768412061a0448c5ab2044fdae07
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 1 15:11:16 2011 +0000

    Version 1.15.1.

commit fc821f97894926c0dcf4f52f55a2d1a810e27873
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 1 14:10:49 2011 +0000

    contrib: Add all contrib files to EXTRA_DIST.

commit 4ac261b3ee3fbc72614623b4ef630a55393b462f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 1 14:07:59 2011 +0000

    contrib: Add libguestfs talk.
    
    This is a short (10-15 min) talk that I give to introduce the main
    features of libguestfs.  The "slides" are in the form of a complete
    self-contained HTML page with a handful images that can be easily
    distributed before the talk.

commit 0257e27e17214d84f49a51e1138fb46b23d6b024
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 1 09:47:25 2011 +0000

    rescue: Add --suggest option to suggest mount commands.

commit b4da051d54a1597c7d8db8880d21a52265a6172e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 1 09:47:01 2011 +0000

    fish: Use size_t instead of int when counting strings.

commit 4e3a1205ebfec1a5cbc3062d6f73a684090e80b5
Author: Matthew Booth <mbooth@redhat.com>
Date:   Mon Oct 31 16:47:50 2011 +0000

    Fix debug help error message.
    
    When given an invalid debug command, libguestfs responds with the
    error message:
    
      libguestfs: error: debug: use 'debug help' to list the supported commands
    
    However this command does not work, as debug requires two
    arguments. This change updates the message to prompt the user to use
    'debug help 0'.

commit 6f84ef6768e9c625d67f7eb015277b0ec1b2c2af
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 31 16:44:55 2011 +0000

    appliance: Add 'mdadm' package.

commit 365885dab2ae6dcdf0b2c45d0adeb803ade03f63
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 27 17:40:31 2011 +0100

    perl: Add %guestfs_introspection hash with introspection information.
    
    Because this is a useful introspection API, it is a candidate for
    being backported into older stable branches.

commit 477c437ba0e2108413fe2b54a830b36c251242f3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 27 16:06:44 2011 +0100

    Version 1.15.0.

commit 908fd031d31c29f3ca3037a26c2e85070ed381dd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 27 14:26:46 2011 +0100

    Pull latest translations from Transifex.

commit 6edd6cdebadab0117bc602f02e0dc68ea7d1a2ef
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 27 13:45:22 2011 +0100

    generator: Remove DangerWillRobinson.
    
    This warning was applied unevenly.  Potentially any command can be
    dangerous or safe, so it was a needless warning.

commit 7b44f7b3df0b20b2b5e889d89e82a35eed20d43e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 27 13:44:02 2011 +0100

    fuse: Skip guestmount test if setfacl is not installed.
    
    This dependency is optional, don't fail the test if it's not
    installed.

commit 2749d6edfbed3b9185b53e9c9befb8d370965b0c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 27 13:36:15 2011 +0100

    virt-sysprep: Skip test if xmlstarlet is not installed.
    
    This dependency is optional, so don't fail the test if it
    is not installed.

commit 46e08a159a86d993a44830d70da442cd073859c2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 27 13:30:22 2011 +0100

    virt-alignment-scan: Add additional data for 4K sector drives
    (thanks Matt Booth).

commit d9c4b702e75ae565f7a4664e835a6e53c0675763
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 27 12:28:47 2011 +0100

    test-virt-sparsify: Relax size_after constraint (for Debian).
    
    size_after on Debian was 10136K.  The host filesystem was ext3 (vs
    ext4 for Fedora where we did the original testing).  Probably indirect
    blocks (vs more efficient extents on ext4) causes the difference,
    although I did not look at it in detail.

commit e07774344208c9ee4e32d35061ba67591e4c441f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 27 10:55:06 2011 +0100

    Update RELEASE-NOTES for 1.14 release.

commit a08bfe2896c15e1f58bc8514791e0c5ff8a09d62
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 27 10:54:55 2011 +0100

    Update ROADMAP for 1.14 release.

commit 7fef001bd9a2b64ebbf8c936fa75d9c0f8ae76bd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 26 22:22:32 2011 +0100

    Update API support.

commit 19005b2cfc6b077aafd16cb5b97a08180e4e39f8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 26 21:12:18 2011 +0100

    Version 1.13.26.

commit b0eabcca60da8fec55cbeaf83e17320281ed75b8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 26 20:53:30 2011 +0100

    guestmount: Fix --live option (RHBZ#744795).

commit bf7f3170eadb8be5a74a7698a6f7b1dda7a27541
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 26 19:30:23 2011 +0100

    fish and other tools: -d option uses readonlydisk="read" (RHBZ#747290).
    
    Tools like virt-edit would not be able to edit disks marked as
    <readonly/> in the libvirt XML.  It's not clear if this is a bug or a
    feature.

commit b893294dcc948d4b41318a400fc4235a190d306b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 26 19:27:01 2011 +0100

    add-domain: Add readonlydisk optional argument (RHBZ#747290).
    
    This optional argument controls how <readonly/> disks in
    the libvirt XML are handled.  It can be set to one of:
    
      "write" (default) - add them R/W
      "read" - add them R/O
      "error" - throw an error if asked to add them R/W
      "ignore" - ignore these disks
    
    I have added limited regression tests for this feature.  However
    libvirt's test:/// XML does not allow you to specify that a domain
    starts off shut down, so we cannot fully test this.  Instead I tested
    it by hand.

commit 163f7df8452f5d7eb47039a98cd97d498528e4d5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 26 17:47:34 2011 +0100

    libvirt: Detect if a disk has the <readonly/> flag.
    
    This changes the private function guestfs___for_each_disk so that the
    <readonly/> flag on libvirt disks is detected and passed through to
    the callback function.

commit 62909197d120c01cc86095518aacca9d4ad268dd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 26 15:55:29 2011 +0100

    test-user-cancel: Make this test choose smaller cancellation numbers.
    
    Use a Gaussian distribution for random numbers so that smaller numbers
    are chosen more frequently.
    
    This also exposes a bug in this test which only happens when small
    numbers are chosen:
    
    If the test thread starts up quickly, it can get to
    guestfs_user_cancel before the guestfs_upload command has happened in
    the main thread.  This causes the cancel to be ignored (correctly) and
    we end up in the second loop writing data until the disk runs out of
    space.  Fix this by repeatedly asserting the cancel flag in the second
    loop.

commit ced99cf69e55515a58b4651767bda4ab17c82776
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 26 14:09:39 2011 +0100

    Version 1.13.25.

commit d64fca7b848df36f2043a8af72aaa670e3c14c53
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 26 13:56:18 2011 +0100

    virt-resize: Be much more conservative about moving first partition.
    
    Commit 2910413850c7d9e8df753afad179e415f0638d6d caused Windows 7
    resizes to break with the 0xc0000225 boot error.
    
    Change the --align-first auto (default) option so that it is more
    conservative about when it moves the first partition.  In particular
    it doesn't move it if it's already aligned (as it is for Win7), nor if
    there is more than one partition (also Win7).
    
    Tested with: Windows XP, 2003, 7, Ubuntu 10.10 and RHEL 5.

commit 178a6d78a84a82cfddbf17678c8c8c2a9d9d0dd2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 26 13:55:38 2011 +0100

    Flush stdout for progress bars used by guestfish, virt-resize.

commit 119e67a92e74c3e657133c751a4f92d40924d787
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 25 19:03:38 2011 +0100

    virt-resize: Handle extended and logical partitions (RHBZ#642821).

commit f4b3351692c5740242414b6b84588a22094b75bb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 25 14:18:29 2011 +0100

    resize: Get the partition table type of the source disk earlier.
    
    Also we only permit MBR (DOS) and GPT partition tables.  In theory
    previously we allowed other partition table types, but it is unlikely
    that it would have worked in reality.

commit f223dfa29aafeb7b9a07bbedf03d15acddd62e92
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 25 22:49:55 2011 +0100

    New APIs: copy-{file,device}-to-{file,device}.
    
    The four new APIs:
    guestfs_copy_device_to_device,
    guestfs_copy_device_to_file,
    guestfs_copy_file_to_device, and
    guestfs_copy_file_to_file
    let you copy from a source to a destination, between files and
    devices, optionally allowing source and destination offsets and size
    to be specified.

commit 663b99950daeaa2b023520aae756a3a28969c493
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 25 14:14:35 2011 +0100

    ocaml: Make sure virt-resize, virt-sparsify are rebuilt if Guestfs API changes.
    
    Add a dependency so these tools are rebuilt from scratch if the
    Guestfs API changes.  This prevents the error:
    "[...] make inconsistent assumptions over interface Guestfs".
    
    This commit includes the generated changes to .depend files.

commit 51672634fddc20095adc1300e0bfee2c99c604f5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 25 12:47:16 2011 +0100

    virt-filesystems: Add MBR partition type byte to the output.
    
    This adds an extra column containing this information, looking
    like this:
    
    Name       Type        VFS   Label  MBR  Size  Parent
    /dev/sda1  filesystem  ntfs  -      -    6.0G  -
    /dev/sda1  partition   -     -      07   6.0G  /dev/sda
    /dev/sda   device      -     -      -    6.0G  -
    
    In particular you can use this to tell if a partition is an extended
    partition, because the field will contain '05' or '0f'.

commit 47412f137f2b09dbc2b44b78ba84c0b348e3f402
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 25 12:46:05 2011 +0100

    New API: part-to-partnum
    
    This converts a partition device name (eg. /dev/sda1) to a partition
    number (eg. 1).  This is useful in conjunction with the parted APIs
    that mostly take a disk device + partnum.

commit 1e891d900714b84a84f9c9e79c6e033aa56c0fcc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 25 10:55:20 2011 +0100

    virt-cat: Handle Windows paths and drive letters (RHBZ#693359).

commit 639232f2b0e2b6d537c8947ee51837d5509b1339
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 24 17:36:07 2011 +0100

    Version 1.13.24.

commit 3814680423984b3c46c2f99e944c2a71862bde9f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 24 13:24:16 2011 +0100

    Add test for qemu broken -machine option (RHBZ#748266).
    
    Also add this option, if necessary, when testing for virtio-serial
    support.
    
    When the workaround is enabled, we specify machine type 'pc'.

commit 35900223df1d05d0b8f4da79c854bee9899f81be
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 24 15:35:47 2011 +0100

    Revert "out-of-tree build: daemon"
    
    This reverts commit 025dba7f803419f510fd8f085ce693838af82878.
    
    If build and source directories are the same, you get this error:
    
    make[3]: Leaving directory `/home/rjones/d/libguestfs/generator'
    make[2]: Circular guestfs_protocol.c <- guestfs_protocol.c dependency dropped.
    make[2]: Circular guestfs_protocol.h <- guestfs_protocol.h dependency dropped.
    rm -f guestfs_protocol.h
    ln  guestfs_protocol.h
    ln: accessing `guestfs_protocol.h': No such file or directory

commit 21a4cf7ef54a8598126f39023a51ef43415679dc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 22 15:55:48 2011 +0100

    virt-win-reg: Document syntax for deleting keys and values (RHBZ#737944).
    
    NB: This requires hivex >= 1.3.2 before this syntax becomes true.

commit e192035bbd6f80262f60565e0a91588848f2a4e3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 21 22:48:10 2011 +0100

    virt-make-fs: Refresh man page.

commit c214cdc54e955ff1a01c00b99b0d6bd20e8b6bcd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 21 17:31:03 2011 +0100

    Fix ./configure --disable-erlang.

commit e7ea6d06ab4f203c8acb95f9df72ee0035d76941
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Thu Oct 20 14:20:56 2011 +0200

    out-of-tree build: fixed bindtests and inspector

commit aa67ea2b9b800305a00615f3a463cdd46eae9181
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Thu Oct 20 14:20:55 2011 +0200

    out-of-tree build: fix HAVE_OCAML=false case

commit 025dba7f803419f510fd8f085ce693838af82878
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Thu Oct 20 14:20:54 2011 +0200

    out-of-tree build: daemon

commit 31bf0cf313f21bdeb0d166c4c76aad050ad32232
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 21 16:29:20 2011 +0100

    add-drive-opts: Correctly handle unreadable and unwritable files (RHBZ#747287).

commit 0c06d740b77fb9225a0e2bd13dc88b0b88ee87cb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 21 16:02:34 2011 +0100

    virt-make-fs: Set MBR partition type byte correctly (RHBZ#746295).

commit 527079aa0db9b608ee4c25e7b3eccc4058685608
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 21 12:49:18 2011 +0100

    lib: Common code for formatting the qemu -drive parameter.
    
    This is just code refactoring.

commit f5172902bc9d92451c83dc3c1a85b5aeb975b43a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 21 12:28:45 2011 +0100

    Allow compilation without hivex (RHBZ#723474).

commit 9a6e5369b2134a3bd2a6decda48bbf5ac9d7cd41
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 21 12:15:36 2011 +0100

    po-docs: Force make update-po on first build from git.

commit b148df4df9f27162b2e1991c3fbeef070b2c343a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 20 22:18:03 2011 +0100

    Version 1.13.23.

commit fef0ff3d869d2ebdb48eea0c538270fc98f5952d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 20 23:04:41 2011 +0100

    appliance: udev-174 moves udevd to /lib/udev/udevd (instead of /sbin/udevd)

commit 2910413850c7d9e8df753afad179e415f0638d6d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 20 22:06:33 2011 +0100

    resize: Add --align-first auto|never|always option.
    
    The first partition can now be aligned.  We fix the bootloader
    correctly for Windows by adjusting the "Hidden Sectors" field.

commit 37cdd39ada139956f237b55c87c095bed622b5e3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 20 16:49:15 2011 +0100

    resize: Add --alignment flag to allow partition alignment to be picked.

commit 5d8e4102b46158f323fb1f6d76a342edcb997b73
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 20 14:46:11 2011 +0100

    resize: Refactor the code for creating target partitions.
    
    The old code mixed the business of planning the layout of the target
    partitions with the creation of the target partitions.  The
    replacement code separates these into two tasks: firstly we create a
    new 'partitions' list with the target layout, secondly this directly
    drives the creation of the partitions.
    
    As part of this change I have *removed* the old code that was supposed
    to handle extended/logical MBR partitions.  It simply didn't work, and
    didn't have any hope of working, and there is a separate bug open to
    fix it.

commit 9f198956047583e506713a4472117922f8b27b2e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 20 14:53:13 2011 +0100

    resize: Remove p_size field from partitions structure.
    
    This field simply contained a duplicate copy of p_part.part_size.
    
    There is no functional change in this commit.

commit 040b6cb061e510992c2b8f1ab97289f55c363ba2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 20 10:58:21 2011 +0100

    Update RELEASE-NOTES.

commit 41260de67f9fa852eab168a6d36276c5deb02bf7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 19 17:37:25 2011 +0100

    Version 1.13.22.

commit f354f9b4fd488a487f2c4c1e7b3770eba4332aed
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 19 17:12:07 2011 +0100

    Pushed and pulled latest translations from Transifex.
    
    Fixed one bug in the nl PO file:
    
    msgid "security: cached appliance %s is not owned by UID %d"
    msgstr "beveiliging: UID %d is geen eigenaar van toepassing %s in cache"
    
    should be:
    
    msgid "security: cached appliance %s is not owned by UID %d"
    msgstr "beveiliging: UID %2$d is geen eigenaar van toepassing %1$s in cache"

commit c46bedf925cd9c6c9a9cbaee115358fd1dffcbfe
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 19 15:43:37 2011 +0100

    inspection: Return root devices sorted.

commit 6aa3ece129d04a588ceb161c4b203a20664ddcd8
Author: Matthew Booth <mbooth@redhat.com>
Date:   Tue Oct 18 13:42:16 2011 +0100

    inspect: Handle cciss devices in /etc/fstab

commit f5c9f0e9ee1729b1260cef3e51ca91936e1868c4
Author: Matthew Booth <mbooth@redhat.com>
Date:   Tue Oct 18 13:30:40 2011 +0100

    inspect: Don't assume number of captures in match functions
    
    It is possible for the pcre library to return a variable number of captures for
    a single regular expression. e.g.:
    
      ^/dev/(cciss/c\d+d\d+)(?:p(\d+))?$
    
    This will return either 1 or 2 captures depending on whether the device has a
    partition suffix. The current match wrappers don't allow for this, and require
    that a predictable number of matches are returned.
    
    This change updates match, match1, match2, and match3 to ignore the specific
    number of matches returned. Instead, any returned captures are assigned to the
    given arguments, and any remaining arguments are set to NULL.

commit a1df33eac2c0a0a4fbb256871e491e28dd11ce90
Author: Matthew Booth <mbooth@redhat.com>
Date:   Tue Oct 18 11:01:01 2011 +0100

    inspect: Add drive naming hints
    
    We currently use a heuristic to guess how drive names we find
    referenced in the guest map to drive names in the appliance. If this
    heuristic fails it can cause inspection to fail.
    
    This change adds a new 'name' option to add_drive_opts, which allows
    the user to explicitly pass the name of a drive to libguestfs if it is
    known. This change also updates the fstab-parsing inspection code to
    use this information if it is available.

commit 1f615fddaffd33afc75a582021769583c8f4db4e
Author: Matthew Booth <mbooth@redhat.com>
Date:   Mon Oct 17 16:07:31 2011 +0100

    NFC: Remove unnecessary goto

commit f1041e912b72116d66274d2f15e50ce34a9531fd
Author: Matthew Booth <mbooth@redhat.com>
Date:   Mon Oct 17 15:28:47 2011 +0100

    launch: Store drive information in guestfs_h
    
    This is a NFC on its own, but provides a place-holder for drive metadata which
    can be used after launch.
    
    Fixes by RWMJ:
    
     - Fix the tests: this requires a new internal function 'debug-drives'
       that dumps out the g->drives information so it can be checked in
       two of the tests.  Previously these tests used 'debug-cmdline'.
    
     - Test file existence / use_cache_off in the add_drive_opts function,
       not when launching qemu in the child process.
    
     - Call free along error paths.
    
     - Add comments.

commit 472f02d08b077a5c1ee233d9dcef92ac9b09d4ae
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Oct 14 15:00:32 2011 +0100

    inspect: Fix fstab device mapping for >26 disks
    
    The regular expression matching disk name assumed that there was only a single
    letter suffix. This change handles a naming scheme for any number of disks.

commit 138e118d62046b197b715462072256082ecfc0f7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 19 15:20:19 2011 +0100

    launch: Ensure g->cmdline is allocated before assigning g->cmdline[0].

commit 2f6ec8b4da27c550e2c7187fd17df28f1bdd51a7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 19 13:42:59 2011 +0100

    valgrind: guestfish -i: free strings before exit.
    
    This isn't really necessary, but it keeps valgrind happy.

commit 6d7d645cdd4a9c94c4d95fc52de53c37b88847e4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 18 15:22:01 2011 +0100

    Ubuntu 11.10: Create /run and /run/lock if not already.
    
    In real machines these directories are a ramdisk.

commit b288a1b9718d72f2e4ad0e7c2015123f963fcb06
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 17 15:26:43 2011 +0100

    virt-sysprep: Fix link in documentation.

commit cf4cc1143393d607a7fb4cdbee1434544237d5d4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 17 09:59:43 2011 +0100

    Skip guestmount and virt-sysprep tests if no /dev/fuse.

commit 8cf06ddcddf1fda3a189667dbaaa4560ba49df3c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 15 17:51:16 2011 +0100

    virt-sysprep: Fix test to use guestmount and virt-inspector binaries that have been built.

commit af0c123be8cc62acf9e1368b1d00acccdd6d91e9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 14 22:08:20 2011 +0100

    appliance: Fedora cryptsetup-luks renamed to cryptsetup.
    
    Therefore we need both names to be listed in the file.

commit db499d98e7a290ccbfc4fb333f85021b23155e9d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 14 22:08:14 2011 +0100

    roadmap: Fix Bugzilla URL.

commit bd1cc1273105b4f88a6132aafa8a67af7dcccff7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 14 18:22:46 2011 +0100

    More TODO items.

commit 8b2ebe07c2f7a4943e6891d642850c03ba2e6b34
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 14 18:14:59 2011 +0100

    Update RELEASE-NOTES file.

commit 782a2e0299b0c22155f0c115f94903c519040247
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 14 15:14:57 2011 +0100

    Version 1.13.21.

commit 91730ce7fa648bd835f48dc7a8051939ae317613
Author: Erik Nolte <erik_nolte@acm.org>
Date:   Thu Oct 6 15:56:40 2011 -0600

    Use ArchLinux's new kernel package "linux".

commit f25d2300ce0206b3d4ef5e38d0314d86ea20136e
Author: Michael Scherer <misc@zarb.org>
Date:   Fri Oct 14 01:05:05 2011 +0200

    Add basic support for netbsd detection.

commit 8f6eed00da59614184090e56edef6884f187b436
Author: Michael Scherer <misc@zarb.org>
Date:   Fri Oct 14 01:05:07 2011 +0200

    Add support for pkgsrc, default NetBSD package manager.
    
    For now, only detect the tool, but support from reading
    installed package could be added later ( may require either
    a package of pkgsrc, or a smaller tool to read the db ).

commit 05a8359c7cf98fdcf75628299dd3e64401f07ee4
Author: Michael Scherer <misc@zarb.org>
Date:   Fri Oct 14 01:05:06 2011 +0200

    Add support for mounting ufs from NetBSD, and fix FreeBSD detection on Fedora 16
    
    While testing on Fedora 16, I noticed that Linux will mount the disk
    without trouble by using automatically ufstype=old, and yet do not
    let us read the directories. So we should start directly with usftype=ufs2,
    and if it fail, try 44bsd, as used for netbsd and openbsd ( as seen on
    http://wiki-static.aydogan.net/How_to_mount_FFS_partition_under_Linux ).

commit 15d79b5ea95ba28ebf6d8bb7542d86702edc1e8f
Author: Michael Scherer <misc@zarb.org>
Date:   Fri Oct 14 01:05:04 2011 +0200

    Add the Opensuse logo ( thanks to Vincent Untz )
    
    Like Ubuntu one, it may not be always present.

commit 5332515db3ed87716d702ef2b973816a73ab5702
Author: Michael Scherer <misc@zarb.org>
Date:   Fri Oct 14 01:05:03 2011 +0200

    Add Opensuse and zypper detection support
    
    This would also erronously detect SLES as Opensuse.

commit 1d0683964f996b24b8fcf5bce7611a98443344f3
Author: Michael Scherer <misc@zarb.org>
Date:   Fri Oct 14 01:05:02 2011 +0200

    Add support for Ubuntu logo
    
    Ths logo is present on Lucid Lynx, but may not always be installed, like
    in case of a minimal installation ( or server ). While Edubuntu and Kubuntu
    have different logo, I didn't check where it would be placed.

commit 7d4a99db87b9fe9373b482092db88610fb796012
Author: Michael Scherer <misc@zarb.org>
Date:   Fri Oct 14 01:05:01 2011 +0200

    Detect Mageia distribution

commit 787baf1bad89aecf4d01738fb8344e4446eb5ba1
Author: Michael Scherer <misc@zarb.org>
Date:   Fri Oct 14 01:05:00 2011 +0200

    Partially fix --disable-erlang
    
    Without this, configure will always enable erlang, no matter what
    argument are passed. Now, we can disable it, even if configure still
    need the erlang compiler for some obscure reason.

commit c019d073a4f218b538d5176500b014e83dbce84f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 14 08:36:00 2011 +0100

    virt-sysprep: Add cron-spool, mail-spool, utmp.

commit 05c26a9c099fe7616c95daaa3d473ee23f93e1b1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 13 23:30:13 2011 +0100

    virt-sysprep: Use /dev/urandom instead of /dev/random.

commit 248465a6206dd3881adebcd2c17ea0a0c2f59742
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 13 23:29:58 2011 +0100

    virt-sysprep: More clarifications to the man page.

commit 42f3abe42d601c5d0a1521a36db54dea705a03c7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 13 23:24:28 2011 +0100

    virt-sysprep: Clarify docs on enabling operations.

commit dd73c50dc5439c3e16f1322dce69b1f17af485da
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 13 23:20:27 2011 +0100

    virt-sysprep: Add rhn-systemid.

commit 9e382f1ae33ed25f012596b801e9cc4a440cb74b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 13 15:37:56 2011 +0100

    virt-sysprep: Switch to using guestmount, add more features.
    
    This switches virt-sysprep to use guestmount instead of guestfish.
    This makes the script a little bit easier to modify for sysadmins.
    
    This commit also adds:
    
     - dhcp-client-state
     - dhcp-server-state
     - logfiles
     - random-seed
     - smolt-uuid
     - yum-uuid
    
    SELinux relabelling, and a section on security in the manual page.

commit 189c3d6ac1e3fbd4f8ffbaafdc36b8ad00961284
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 13 15:07:41 2011 +0100

    virt-sysprep: Use Augeas for config file manipulation.

commit 17b26be2325348da1c7f6edf28397b8e45e9e499
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 13 14:30:35 2011 +0100

    virt-sysprep: Add prepend_line utility function.

commit 11be7d8eee16e6249ed2868b5bd552f29508ec02
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 13 11:56:52 2011 +0100

    fish: docs: note how to clean up the remote process properly.
    
    Killing it is always a bad idea, because the qemu subprocess will be
    left hanging around.  The best thing is to send the exit command.
    
    This also makes the change to virt-sysprep.

commit baa1618e0f917017c1934b7da41250029c1791ef
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 13 11:54:18 2011 +0100

    fish: Close guestfs handle explicitly before exiting.
    
    NOTE this is just a cleanup.  It is NOT necessary for correctness,
    since libguestfs itself is correctly closing the handle in the exit
    handler.

commit 049116e1810680275a42faba430fb2f798cb17d8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 13 11:34:04 2011 +0100

    virt-sysprep: Trap ERR as well as EXIT.

commit e57c3c37a8648966e19ef33832f353d0f9487a77
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 13 11:13:05 2011 +0100

    guestmount: Add note to man page about 'fuse' group for Debian.

commit f6db819081a47b038d473cc1c1fd9743410c42a9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 13 11:09:31 2011 +0100

    virt-sysprep: Simplify calls to guestfish --remote.

commit 2135ec267eef87532fbdb346e68a4d1570b045e9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 13 10:36:24 2011 +0100

    virt-sysprep: Further TODO items (thanks Nikita Menkovich).

commit a78a3dea887841c03bfa0d40bab8d1882a00b3f8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 13 10:36:24 2011 +0100

    virt-sysprep: Further TODO items (thanks Marko Myllynen, James Antill).

commit 0beebeb6225bd868fe36b28ff8ad15bfb8c6028e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 11 20:59:29 2011 +0100

    Version 1.13.20.

commit fe31f1897b3550d8fab68992aad27de429d1580c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 11 19:20:53 2011 +0100

    virt-sysprep: Update TODO list again.

commit 92dc3748b6c236f09e7c699d4f841459fff4851c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 11 18:04:46 2011 +0100

    virt-sysprep: Update TODO list (thanks Steve Grubb, Dan Berrange).

commit e6ed656c98f4c0781090a7ee4337267923754dbd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 10 15:13:40 2011 +0100

    TODO: More virt-sysprep suggestions (thanks librarian).

commit c155330f04f933d13298d5cddab6b7f3dc9d218f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 10 13:26:15 2011 +0100

    Add systemtap/DTrace probes.
    
    Mainly this is a documentation change.  However a sample of
    DTrace-compatible userspace probes are also added.

commit d6622d7636d592eb1c01fbcb8b8ad52c2b20615b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 10 09:51:03 2011 +0100

    Update TODO file with future plans for virt-sysprep.

commit c49819f9b3a29329da87e2001d8025b3842bb0db
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 8 13:59:13 2011 +0100

    Version 1.13.19.

commit 1e35941f62bddafd6b88270b22b3afe4a5d37baa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 7 19:22:11 2011 +0100

    New tool: virt-sysprep: system preparation for guests.

commit 3a546663655abfcd6399d4fdb7febc6b0d83b822
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 7 19:20:36 2011 +0100

    fish: Add man page section on calling guestfish remote robustly from bash.

commit df711241fff32036acbc3fae10486816cbdd8ef9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 7 13:52:39 2011 +0100

    virt-alignment-scan: Fix SYNOPSIS in manual page.

commit c6be95453d66ea714a9813a21cfb224d8e346d9e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 7 13:42:27 2011 +0100

    Makefile.am: Fix comment.

commit ffe0e11b4d3db16f0b6632add24db89349279e69
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 6 17:37:01 2011 +0100

    virt-alignment-scan: docs: Add link to RHEL Storage Administration Guide.

commit 8daa036857868775f31c08526d2892a0dc200dce
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 6 10:23:38 2011 +0100

    virt-alignment-scan: More information in man page.
    
    Thanks Mike Snitzer.

commit 74e4e86309c837e172e389ca45d10cebf42e215e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 6 10:22:16 2011 +0100

    virt-resize: Align partitions to multiple of 128 sectors (instead of 64).
    
    This gives us effectively 64 KByte alignment, optimal for all current
    types of storage.

commit 36d8bbb8586bbe571739a79de071edd392001963
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 5 19:12:34 2011 +0100

    Update RELEASE-NOTES file.

commit e59e35708b4ad66c99f908c5226cb232931e1791
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 5 18:13:38 2011 +0100

    Version 1.13.18.

commit b4bb49ffd123e36d6319281dcc2080b30e23e447
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 5 15:06:10 2011 +0100

    New tool: virt-alignment-scan to check alignment of partitions.

commit f3341222b37f91d7f7fcdafe30b107ea9da9ad02
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 5 14:38:07 2011 +0100

    docs: Add directory sections for resize/ and sparsify/

commit ca8c2b599663563976d83766182ab8cf0722c755
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 4 22:42:42 2011 +0100

    Update RELEASE-NOTES file.

commit b0605f265be3f501930516ff95deab2910ced3ac
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 4 20:00:42 2011 +0100

    sparsify: Fix --ignore option to work on canonical device names.

commit b3f61a9db39a639b7e462581cb5e177c778de354
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 4 20:00:21 2011 +0100

    docs: Clearer language in virt-sparsify man page.

commit 4abb239dcc7b1d235783bb0b5e417c4b88b00fea
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 4 19:24:42 2011 +0100

    Version 1.13.17.

commit fac15924f59a076c903d453d20305e00e1ae258a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 4 11:02:30 2011 +0100

    New tool: virt-sparsify to make disk images sparse.

commit 293772bf7511dee41a1f3e842424678c1a6bf9e4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 4 10:58:25 2011 +0100

    docs: Add virt-resize to list of links in guestfs(3).

commit b39b3c5c74f1dfb88a6074aac476df877f1bfc4d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 4 10:58:02 2011 +0100

    docs: virt-win-reg is written in Perl, not virt-resize.

commit b57fcc5064ea87a836bcff188bc614f1dc2b619e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 4 10:57:05 2011 +0100

    Update API support documentation.

commit 2628fa96d8ed5e95ac866abc9b849cc183e596f3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 1 14:35:05 2011 +0100

    Version 1.13.16.

commit b1f7b5f911dc65f39e0c3297a4dfa566c1d5b8ba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 1 10:42:05 2011 +0100

    mount: Not deprecated any more.
    
    This updates commit 5c2f1a2d9433eeb5aebeec26f0412c703bbe7269.

commit 5c2f1a2d9433eeb5aebeec26f0412c703bbe7269
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 1 08:20:50 2011 +0100

    mount: No longer implicitly add -o sync,noatime options.

commit 4e9ed018475ff4bd5171ed50a47ffae7abbdda4b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 29 16:08:20 2011 +0100

    daemon: mkswap --help output changed, breaking linuxfsuuid group detection.

commit d020350c3131f5d0e422f502b4810025a6fc0f11
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 28 22:13:27 2011 +0100

    Version 1.13.15.

commit 04fbcc63ebf5718608f199eb6b09061cd32283c3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 28 14:39:31 2011 +0100

    New API: set-smp, get-smp
    
    These calls allow you to change the number of virtual CPUs assigned to
    the appliance.
    
    This also adds a --smp option to virt-rescue.

commit 8403f5a9d8f1451e2c2b029b51bac18724b18ebf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 28 11:14:06 2011 +0100

    New APIs: compress-out, compress-device-out.
    
    These APIs let you copy compressed files or devices out from the disk
    image.
    
    Compression is useful for large images which are mostly zeroes.  We
    cannot currently do sparseness detection, and compression gives us a
    form of zero detection for free.
    
    Example usage:
    
    $ guestfish --ro -a /dev/vg_pin/F16x64 -i \
        compress-out gzip /etc/passwd /tmp/passwd.gz
    $ file -z /tmp/passwd.gz
    /tmp/passwd.gz: ASCII text (gzip compressed data, was "passwd", from
    Unix, last modified: Sun Aug 28 14:40:46 2011)

commit ffc01285ee4289da90983a3320873f27b3d31c4d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 28 14:17:53 2011 +0100

    daemon: Move useful is_zero function to header file.
    
    Code motion.

commit 322106521f546d7c70c5a38255db7d243a456a6b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 26 13:34:12 2011 +0100

    Add no_timer_check to disable faulty test during boot (RHBZ#502058).
    
    See:
    
    https://bugzilla.redhat.com/show_bug.cgi?id=502058#c15
    https://bugzilla.redhat.com/show_bug.cgi?id=698842#c8
    
    This updates commit 79e66f89e2f6c27486476d7857da58feb491bf5c.

commit 3c7b3634b2c86a4c41fec044ccb59a1fe3224e66
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 26 09:58:46 2011 +0100

    docs: Show how to use a qemu wrapper to edit the qemu command line.

commit 67030c6ef2b89ab98ed30d2ddc8a180c28395312
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 24 22:32:46 2011 +0100

    Version 1.13.14.

commit aa88c1bbd2691a0f84bfcce07e8a0906aaf72d39
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 24 18:50:00 2011 +0100

    Update to latest gnulib.

commit fa13b2838fd32854a4b2c6a5fff47e17a72294fb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 22 14:41:46 2011 +0100

    erlang: Use the official autoconf macros.

commit 8324d2fcf00d5f3d6bc0f10ae61bbfd7c1961d93
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 21 22:28:11 2011 +0100

    todo: Suggestion to improve Erlang bindings.

commit 79e66f89e2f6c27486476d7857da58feb491bf5c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 21 19:31:10 2011 +0100

    Enable APIC.
    
    Originally this was disabled to work around RHBZ#502058.  That bug was
    never officially fixed, but it may have fixed itself.
    
    In the meantime, KVM has broken ordinary PIC support (RHBZ#723822).
    Since APIC is the most common way that regular Linux and Windows
    guests run it makes sense to remove this hack.

commit 660daf31e23f2f7c65f29e1d57019af9ea9eba99
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 21 15:12:28 2011 +0100

    Version 1.13.13.

commit 84763d7fca3668c62ee3fe53d0e00a5a672f687b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 20 18:03:58 2011 +0100

    Add Erlang bindings.

commit 917f947590c92318fee2545ba88245d0de012e31
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 16 15:26:20 2011 +0100

    inspection: Handle /dev/root in /etc/fstab.
    
    This means "the device that holds /etc/fstab", so map it correctly.
    
    This fixes support for ttylinux and also some other guests that use
    /dev/root instead of a real device name.

commit b648b1813fc8e55db790435b5414d9be3ec765d2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 16 15:21:26 2011 +0100

    inspection: Add support for ttylinux (a minimal Linux).

commit 99624d29226ece1abbbdd921183b360f5f80de91
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 15 22:02:43 2011 +0100

    Add an optional group ("grub") for the guestfs_grub_install API.
    
    This also improves the documentation for this call, pointing out
    several pitfalls in using it.
    
    This unfortunately breaks existing callers that might use
    guestfs_grub_install without checking for this new group.

commit 8d8ace19da61dd8bae7f2bfa64966c80ddf0cb2d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 14 18:56:38 2011 +0100

    Version 1.13.12.

commit bddde7799b80b8292879634548c3c92a3cc1c044
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 14 13:52:39 2011 +0100

    test-tool: Display TMPDIR.

commit cda7fa973cbdd5fc4ad3974dcc6b5ea02ec6bb44
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 14 13:19:11 2011 +0100

    test-tool: Refresh libguestfs-test-tool man page.

commit 912284b02e28bd63bdf3397ef841b9782adfd2cd
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 14 13:00:34 2011 +0100

    test-tool: Make the default timeout be 600 seconds (10 minutes).
    
    We could sometimes hit the 120 second timeout, eg. if the appliance
    needed to be rebuilt and the machine was very slow and/or under heavy
    I/O load.  10 minutes should be enough for any reasonable situation.

commit 95136b149212b92e87d0c9badb7d6849a084ed4d
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 14 12:58:43 2011 +0100

    test-tool: Document the -t command line option.

commit c7b88da039725ecd0d1d826b112bc69b518d4c78
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 14 12:58:30 2011 +0100

    test-tool: Use B<...> for command line options in man page.

commit 7c521c7211d61a1bac46c155de1f4d3e8b60b3d7
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Sep 12 11:36:00 2011 +0100

    po-docs: Make podfiles sort stable.

commit cbef2ffb0432756822cd2b02a305384f814e9b50
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Sep 12 11:33:19 2011 +0100

    Stable OCaml dependencies.

commit b3f1457fddd19b1e540866fa01c665aeb371cb44
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 7 15:21:37 2011 +0100

    docs: Add a section explaining the appliance boot process.

commit 504b9d95c4afdc83efd5cca6d98cb73111e8c652
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 1 14:55:18 2011 +0100

    Version 1.13.11.

commit 8ab2b85b2a67270b8cc5a91bb62a70c84cd6a02c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 1 13:37:20 2011 +0100

    Remove old regression test that mainly tested a buggy API.
    
    The guestfs_ll command currently lists files in the appliance if you
    prefix filenames with "/..".  However this is a bug, not a feature,
    and we should not be testing it.

commit 8928de32d391e3ad4dd98bb27472c27bb8bc38ac
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 1 13:15:13 2011 +0100

    debian: Missing build dependency on db4.8-util.

commit 73be6db9bf1c0ae96262a5f4fa9328bb4e648637
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 1 12:59:15 2011 +0100

    daemon: Factor out name of virtio serial channel.
    
    This is just code motion.

commit 5b012024c49672cc69635ff01f9b9e4f87de1c65
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Sep 1 12:58:30 2011 +0100

    Create /sys directory if it doesn't exist already.
    
    Ubuntu 10.04 LTS packages don't create /sys.

commit eb209a3664906257b3dc87b6f7b04ff54e0d1288
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Aug 28 17:58:34 2011 +0100

    Version 1.13.10.

commit 085a56690611980f438e8af2eb47ebb411465775
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Aug 28 17:35:34 2011 +0100

    cat: Small documentation correction.

commit baefb8225c8cbde56a1637c17af5c0965a81060e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 27 17:53:03 2011 +0100

    inspector: Use xmlstarlet instead of xpath in examples.

commit f0f3e1621180724e0a907a30ff5dea9695ddead0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 27 17:47:10 2011 +0100

    man pages: Add a standard EXIT STATUS section to most pages.

commit 69abc787dddbf7855c2871f7f1432563a6af92a1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 26 22:55:09 2011 +0100

    Version 1.13.9.

commit ceb3a57f67f33b33c1f6cafdd0ef81808273f0c0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 26 22:40:27 2011 +0100

    progress: Make default UTF-8 progress bar less black.

commit 09a7545649e6cac0de2c4421cb64b659164174ee
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 26 22:34:49 2011 +0100

    resize: Add --machine-readable option for machine friendly output.

commit 75005e48bb54f25dcc99480d659dfe9353382a15
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 26 22:03:47 2011 +0100

    progress: Add machine readable flag.
    
    Machine-readable progress bars look like:
    
    0/100
    1/100
    2/100

commit 2faef37957629e0436308e759211209e5e823ee0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 26 19:21:23 2011 +0100

    resize: Use guestfish progress bar mini-library.
    
    There are two benefits:
    
     - the progress bars look better
     - there is a reasonably accurate estimate of how long each operation
       will take

commit 9420eaf44ec4067c3740b91b0be0fede08a0c515
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 26 20:28:20 2011 +0100

    Add GUESTFS_EVENT_ENTER event.
    
    This event is generated whenever a libguestfs function is called.

commit 6146412f06c2f6f33c3ea7d571f16d4fe71dddb2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 26 18:17:39 2011 +0100

    fish: Make progress bars into a mini library.
    
    This library could now be called from other virt tools.

commit 0bd055316f8581f4da33b039e33d5f61cc00294c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 26 17:39:06 2011 +0100

    fish: clarify comment: shared source files are used by virt tools too.

commit d64ad1a403ca9dbe81856ba6b78a464c5397af45
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 26 11:54:05 2011 +0100

    Version 1.13.8.

commit 1a4f1df77eecee053eaae35d5544f151d37342e2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 25 13:56:09 2011 +0100

    ruby: Check Ruby callback exists before we call it (RHBZ#733297).

commit 675f336319058fdbaf11ee004968b4543a5a9815
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 25 13:25:07 2011 +0100

    ruby: Use a regular C array to pass the arguments through rb_rescue.

commit 0cd5b9ac15c62eb570ec74d19b4aebde4990fd82
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 25 13:11:28 2011 +0100

    ruby: Append newline character after printing exception in callback.

commit 54911bdd325393d1f7f2861f298463c364b45469
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Mon Aug 22 20:42:09 2011 +0200

    python: Newer versions want parentheses around arguments of "print"

commit d36504e1bbe7d1379b7dd7b97ae2fcb0d78d9a83
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Mon Aug 22 20:42:08 2011 +0200

    python: Don't build static library

commit 4e196ad9a374ecef8a39af3ef028fc593d3b1a46
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 23 20:36:52 2011 +0100

    Version 1.13.7.

commit 4fb3b23fb69e4274f434f9258e38f185426298f7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 23 20:21:29 2011 +0100

    php: Fix bug in PHP tests.
    
    We partitioned the disk, and then tried to create a PV on the whole
    disk.  LVM gave the error:
    
      Device /dev/vda not found (or ignored by filtering).
    
    It is unclear how this bug persisted for so long.  It might be due to
    a change in LVM.

commit ce18be33cd5279a8d4120eedd037400c275585c0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 23 19:50:11 2011 +0100

    Coverity: fix memory leak along error path.

commit a31ac8fc32297cc9185fd20a5578d2bc81cc1bce
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 23 19:29:46 2011 +0100

    Coverity: Initialize msg buffer.
    
    msg_flags was not being initialized and would have been passed to
    sendmsg with a random value.

commit c38cb92ec478c4dca83e4d38963720f463d52314
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 23 19:26:35 2011 +0100

    Coverity: fix memory leak in guestfish.

commit b2edcbe1b9c9d161e96cb56d0efd944e84d84526
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 23 19:19:13 2011 +0100

    Coverity: in daemon, free struct in RStruct, RStructList functions.

commit 631faad97171d7c1238b2e413c663cf61476f440
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 23 18:56:12 2011 +0100

    pclose: Fix other places where we only tested pclose == -1.
    
    pclose can return > 0 when the status of the command was non-zero.

commit f15961911316460f7d45342d63c2d784a483f0d1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 23 18:53:38 2011 +0100

    test_qemu: Improve the error message.
    
    Note that errno is probably not set to a useful value here, so there
    is not much point recording it.

commit a24652c7b27e8494268ccb6c9a5a2e5541ba5efd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 23 18:53:00 2011 +0100

    test_qemu: pclose may return any != 0 on error.
    
    In particular pclose returns a status > 0 if the command fails.

commit 2ace9be4cd69e84cd88e5b0fd74de861a4973c91
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 23 18:43:24 2011 +0100

    qemu detection: Free up previous qemu help/version strings if they exist.

commit 08e77ad8cb4e8ac70d4217ebd5d236eba81645b5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 23 18:02:24 2011 +0100

    Coverity: test_qemu: Ensure FILE * is not leaked along error paths.
    
    This refactors the code in test_qemu slightly to ensure that
    FILE *fp is not leaked on error paths.

commit fa44536b0ff12102c72ae0337e51d272f0fc2353
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 23 16:47:18 2011 +0100

    Coverity: Check guestfs_inspect_get_product_name() != NULL before using.

commit 00fef9eed6a53e10a975814beef775483ff0b3dd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 23 16:41:07 2011 +0100

    rescue: Ignore errno after guestfs_launch.
    
    errno is pretty much random on the error path back from guestfs_launch
    so there is nothing useful to be gained by checking it.
    
    We could do with a better way to detect if appliance launch failed.

commit 9bab154d48e367702b65852c3c822341b474ffd2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 23 16:34:06 2011 +0100

    Coverity: Ignore return value from guestfs_launch in virt-rescue.
    
    We expect guestfs_launch to fail in this program.

commit 4c76aaa391d591c5917a06b0277fb9eb7d6d790f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 23 16:12:27 2011 +0100

    Coverity: Check return value from sscanf in bindtests calls.

commit ca727deac186981f4d9784696324c8f3af79f9e5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 20 11:41:10 2011 +0100

    autobuild: Only add last 100 lines of the log file.

commit 6375aede61d57422ad82f4941693493c07b78aa2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 20 10:49:35 2011 +0100

    New autobuild script.
    
    Remove the old top-level autobuild.sh that confused a lot
    of people.
    
    Add an autobuild.sh script that builds from the latest tarball.

commit a4db75521d6026410425187fc2c5c9cb931a69b5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 19 21:48:44 2011 +0100

    configure: Add --with-extra flag to allow setting the extra version string.
    
    Intended use in Fedora and RHEL is to encode the release
    string, eg.
    
      ./configure [...] --with-extra="-%{release}"

commit 7a5f7311d46ac87532e57aa5be9234acd18bdab8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 19 10:38:30 2011 +0100

    Version 1.13.6.

commit e4cba8f2b1a68e7361ce342ff659cccb0490446e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 18 19:13:32 2011 +0100

    protocol: Fix case where download can fail for small files.
    
    There is another case where downloads of small files could fail if the
    library side (writer) fails.  In this case the library would send back
    a cancellation, but it would be received after the daemon had finished
    sending the whole file (because the file is small enough).  The daemon
    would reenter the main loop and immediately get an unexpected cancel
    message, causing the daemon to die.
    
    This commit also makes test-cancellation-download-librarycancels.sh
    more robust.  We use Monte-Carlo testing with a range of file sizes.
    Small file sizes should trigger the error case.

commit 06019bc82e107f7715ebc59e491610e06dad1e39
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 18 17:46:50 2011 +0100

    Escape special/non-printing characters in debug output (RHBZ#731744).
    
    The default event handler in libguestfs was simply writing all debug
    output directly to stderr.  However if the output contains
    non-printable characters such as terminal control codes then these
    would also be sent directly.
    
    With newer SeaBIOS there is a lame attempt to implement a splash
    screen using terminal control codes, thus when libguestfs tries to
    display debugging output it would cause the screen to clear and debug
    output to be lost.
    
    This commit causes all non-printing characters to be escaped.
    (\n and \r characters from the appliance are treated somewhat
    specially).
    
    Furthermore, instead of using write(2), use buffered stderr calls.

commit 635af5be04265f845186b40e9a9fe7b102ad6909
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 18 17:41:09 2011 +0100

    Remove guestfs___print_timestamped_argv.
    
    This function was used to print the qemu and
    febootstrap-supermin-helper command lines.
    
    Unfortunately in the qemu case it was used incorrectly: it called the
    internal debug function (ie. event API callback) from the forked qemu
    subprocess, which meant that higher level event callbacks might have
    been invoked from the child process.
    
    To fix this, convert the qemu case into a new function called
    print_qemu_command line which just prints the command line directly to
    stderr.  This is called after stderr has been redirected into the pipe
    to the main process.  Thus the qemu command line will be marshalled
    into the event API along with other qemu and appliance output.
    
    After fixing this, only one use of guestfs___print_timestamped_argv
    remained, for printing the febootstrap-supermin-helper command line.
    This is converted to a local function print_febootstrap_command_line.
    
    Also print_febootstrap_command_line is now called before we fork
    febootstrap-supermin-helper, so that messages no longer overlap.

commit 70c033998e0e721dc4f9eb2a20348098b259752c
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Thu Aug 18 00:14:46 2011 +0200

    out-of-tree build: generate ./run from template, fix image checks
    
    ./run can now be run in a separate build directory. Since some files
    needed in the image checks are found in the source tree (but not the
    build tree), the source tree location is passed to make-*-img.sh via
    an environment variable.

commit 5d296dfd609fb1aa865109b1040a4d5bf2981e60
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 17 12:21:35 2011 +0100

    Version 1.13.5

commit 85efbc6aa70d522af066a38fd1aae05b790c46d3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 17 12:41:41 2011 +0100

    fish: Add fish-cmds.h to generator_built.
    
    This updates commit 3064277680ad11f887691646d0fa17bb35f38c19.

commit 0938e43a60f9d729d9795cf45498e60217fece0e
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Wed Aug 17 00:42:00 2011 +0200

    out-of-tree build: fix make and make install
    
    $(srcdir) is not needed for guestfs_c.c.
    *.mli only exists in $(srcdir) and isn't found on "make install" otherwise

commit 8876b2d3764b42ebae3c5fdf61b1899095508169
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Wed Aug 17 00:41:59 2011 +0200

    out-of-tree build: fix documentation generation II

commit 4baec012b1b09a888e570fc89dbaa9fbf9944f34
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Wed Aug 17 00:41:58 2011 +0200

    out-of-tree build: remove unneeded explicit paths

commit 5a50c04906828f6e99db6a9be420c84114476d39
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 16 12:39:28 2011 +0100

    Improve zeroing and detection of zeroes.
    
    This code modifies zero, zero-device, is-zero, is-zero-device.
    
    zero and zero-device are modified so that if the blocks of the device
    already contain zeroes, then we don't write zeroes.  The reason for
    this is to avoid unnecessarily making the underlying storage
    non-sparse or (in the qcow2 case) growing it.
    
    is-zero and is-zero-device are modified so that zero detection is
    faster.  This is a nice side effect of making the first change.
    
    Since avoiding unnecessary zeroing involves reading the blocks before
    writing them, whereas before we just blindly wrote, this can be
    slower.  As you can see from the tests below, in the case where the
    disk is sparse, it actually turns out to be faster, because we avoid
    allocating the underlying blocks.
    
    However in the case where the disk is non-sparse and full of existing
    data, it is much slower.  There might be a case for an API flag to
    adjust whether or not we perform the zero check.  I did not add this
    flag because it is unlikely that the caller would have enough
    information to be able to set the flag correctly.
    
                                    (Elapsed time in seconds)
    Format  Test case                 Before     After
    
    Raw     Sparse                    16.4       5.3
    
            Preallocated zero         17.0       18.8
    
            Preallocated random       16.0       41.3
    
    Qcow2   preallocation=off         18.7       5.6
    
            preallocation=metadata    17.4       5.8
    
    The current code uses a fixed block size of 4K for reading and
    writing.  I also tried the same tests with a block size of 64K but it
    didn't make any significant difference.
    
    (Thanks to Federico Simoncelli for suggesting this change)

commit 1fdd0193fd63af71359748915a0326d623a3d6ad
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 15 14:55:10 2011 +0100

    recipes: Remove two C file dependencies which are not actually used in the POD.

commit 0241c753937e577d51a070f7db471260bf931f9c
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Sun Aug 14 10:58:13 2011 +0200

    out-of-tree build: fix building library

commit 900c9626b9d4f567b21aae433493b4b3b1d09f6d
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Sun Aug 14 10:58:12 2011 +0200

    out-of-tree build: Fix up OCaml bindings and generator

commit 36e0f35a5828458ebeaf72999b3461ab66a230d8
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Sun Aug 14 10:58:11 2011 +0200

    out-of-tree build: fix appliance

commit ff101adf7ead7bcdb46bccdb227ef18d844b965f
Author: Hilko Bengen <bengen@hilluzination.de>
Date:   Sun Aug 14 10:58:08 2011 +0200

    out-of-tree build: fix documentation generation

commit 44c3a300265ef7bfa5d49d2b9a2a8faccd9db2de
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Aug 14 22:07:54 2011 +0100

    ruby: Fix typo in Ruby bindings file.

commit 7739d7f471f9575828bd32489695d92dde005a9c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 12 11:17:16 2011 +0100

    Note that additional memory may be required to typecheck Augeas lenses (RHBZ#729887).

commit 6cabc1cd02e181063596b48df55c3f6db51a6bb9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 12 11:08:57 2011 +0100

    fish: Document that remote run in cmd substitution context hangs.
    
    This documents bug 592910.

commit 2ecaa1f82dbf0731319fa917821d08f470133829
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 11 22:52:06 2011 +0100

    Version 1.13.4.

commit b9838001015a06a69a08b69d9f013d82f0ea3139
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Aug 11 11:45:25 2011 +0100

    Fix 'unknown filesystem' warnings in old inspection code (RHBZ#678231 RHBZ#666578).
    
    This is a comprehensive fix for the warnings from the old (and
    obsolete) Perl inspection code.  For a full description and
    reproducer, see:
    
    https://bugzilla.redhat.com/show_bug.cgi?id=678231#c5

commit 2c57305f72cd6181d1849ae6e1b892aa01c7f844
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 8 18:52:23 2011 +0100

    inspection: Better checking for Windows root disks (RHBZ#729075).
    
    Previously any disk that had /autoexec.bat or /boot.ini or /ntldr
    would be picked up as a candidate for a Windows root disk.  If further
    checking could not find any systemroot (eg. /windows) then this would
    result in complete failure of inspection.
    
    In particular, this got confused by Hp_recovery partitions which have
    /autoexec.bat, but don't have a systemroot in one of the usual places
    (they have /MiniNT instead).
    
    What we do now is to properly investigate all possible systemroot
    places before deciding this is a Windows systemroot, so the subsequent
    failure cannot occur.
    
    (Thanks to lorimar for reporting this bug).

commit f7d18c84dde596699ffc5100fec2cf7b0d582450
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 8 12:41:54 2011 +0100

    build: Set TMPDIR for local testing.
    
    This avoids conflicts with the globally installed libguestfs
    appliance, or lets us build in multiple local directories at the same
    time without conflicts.

commit 54ea124b160eda705c96dfc664b4056848887856
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Aug 7 23:11:37 2011 +0100

    Version 1.13.3.

commit f133f1bb9da2268af2b198d82e2ca191375d5f11
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Aug 7 23:10:50 2011 +0100

    daemon: Don't include .gitignore in EXTRA_DIST.
    
    This updates commit 60d5a50f4d3d9e2c2f5a7d42a6859de709bda3f6.

commit 23793d768096427e9e2658689373efcfa0c2dc54
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Aug 7 21:05:13 2011 +0100

    fish: Add setenv and unsetenv commands.
    
    These commands allow you to manipulate the environment within
    guestfish.

commit 3064277680ad11f887691646d0fa17bb35f38c19
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Aug 7 21:04:00 2011 +0100

    fish: Declare run_* functions in a generated header file.
    
    Calls to these functions are generated, so there is no need to declare
    the functions by hand.

commit 18ee38e1eac132b91706771285d1764641179804
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 6 16:04:36 2011 +0100

    docs: Move deprecation notice up to the top in C man page.

commit f351a144d72ba3c86d49a259a89cea64f9639875
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 6 16:00:01 2011 +0100

    docs: Emphasize deprecation notice in man pages.

commit 60adf092a8900323c048c94f3f0934be416a3eb6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 6 15:57:21 2011 +0100

    docs: Fix function names in deprecation notices.

commit 70f44cc0ea0bcdd025ed657461e07f6778be44ba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 6 15:53:15 2011 +0100

    docs: guestfs_set_out_of_memory_handler returns void, not int.
    
    It always has done.  The documentation was wrong.

commit 1bf3941b9ccabef122cc6479004d18ddcb935eef
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 6 15:49:55 2011 +0100

    docs: Clarify error handler example.

commit 4bd1a5060bc95d8d933efa52f8d4aa26ecc118f5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 5 16:39:43 2011 +0100

    fish: Fix regression tests for new guestfish line numbers.
    
    This updates commit 319e946b92e175c05cdd1fdcb85c9b86f5631011.

commit 319e946b92e175c05cdd1fdcb85c9b86f5631011
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 5 14:58:30 2011 +0100

    fish: Print input file and line number in error messages.
    
    eg:
    *stdin*:37: libguestfs: error: luks_close: Device lukstest is busy.

commit 75cc0fc72c190353dd36f1badf6b142ee4bec079
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 5 14:03:18 2011 +0100

    gnulib: Add all other libs when linking libguestfs.so.
    
    This updates the previous two commits.

commit f45b40029d1e21e3b426218dd3c4123d8d0d1c70
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 5 13:52:42 2011 +0100

    gnulib: Add $(LIB_CLOCK_GETTIME) when linking libguestfs.so.
    
    We don't use this library (it is only used in the daemon),
    but we need to add this to make the linker happy.

commit 60d5a50f4d3d9e2c2f5a7d42a6859de709bda3f6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 5 10:54:19 2011 +0100

    daemon: Remove separate configure of daemon subdirectory.
    
    Combine the two Gnulib instances together.
    
    Add checks from old daemon/configure.ac into configure.ac.
    
    Fix daemon/Makefile.am so it is like a normal subdirectory
    Makefile.am.
    
    Because we are now using the replacement strerror_r function from
    Gnulib (instead of the one from glibc directly), this requires a small
    change to src/guestfs.c.

commit 0d13b052635c24919b1a42d00f20154526c25e96
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 5 12:34:02 2011 +0100

    Update TODO.

commit 6a98ed953b1e3b0d3251385f0ca2dd1dee80b63d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 5 10:49:45 2011 +0100

    debian: bash is required to run libtool replacement script.
    
    This was failing on Debian where $(SHELL) is the minimal dash shell.

commit e1c6d1738a2b9123dd08fb4ecff8176daf558f35
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 5 10:31:03 2011 +0100

    configure: Fix info about virt-resize when OCaml bindings are disabled.

commit 36f662c58fcda43829bcef166e600855960fd223
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 5 10:18:02 2011 +0100

    python: Don't name extension with .so.0.0 and symlinks (thanks Dan Berrange).

commit c515cbdf31e80d9f2dd137c8c4d64c035fad778c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 2 12:30:32 2011 +0100

    Version 1.13.2.

commit d7356a2801130907997acd5c7502e8417566e782
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 2 10:56:41 2011 +0100

    Add regression test to catch missing libraries in the appliance.
    
    Related to RHBZ#727178.

commit 5f9c168d9135fa81ee2f3a15461467fe04c26888
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Aug 2 11:03:50 2011 +0100

    debian: Add gawk to packagelist.
    
    It's already included, but implicitly.

commit 995b3fecb9af7a8bd52b238bad2a631a1193c83a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 1 15:13:08 2011 +0100

    virt-tar test: Stable ordering of test output.
    
    The files could be listed in any order, resulting in the test failing
    for no reason.  Sort the output of tar.

commit 3cf31c2fe0b356ea5c04117c5235b0a3cfe34971
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 1 10:35:18 2011 +0100

    Change link, since PostgreSQL switched to using git.

commit 1d134301fc4d05338d09517abc978d0a90d82e09
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jul 31 20:48:00 2011 +0100

    debian: Build libguestfs-ocaml and libguestfs-ocaml-dev subpackages.

commit bad3f4b54a959685f3c0697238fc5753096834fb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 29 17:38:43 2011 +0100

    Don't fail if HOSTNAME field is missing on Red Hat guests (RHBZ#726739).

commit c70532ab4b3d977ed7484e473107808b22d90a2a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 27 15:43:12 2011 +0100

    perl: Fix another place where qw() was used as parentheses.
    
    This is a fix for Perl 5.14.
    
    See previous commit 5c3c7e8825341e18c9449976f8a321a04cc78d79.

commit 2b8b3f9794ceb43eabd3083e225c669896d8b186
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 26 18:57:19 2011 +0100

    ocaml: Fix locking in event callbacks.
    
    We weren't acquiring the GC lock around some allocations, resulting in
    segfaults when an event callback ran at the same time as a main thread
    allocation or garbage collection.
    
    In particular this fixes a noticable crash in guestfs-browser.

commit b5bdd0f8004af4c6c74a05031cb340b98ae03088
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 26 14:17:19 2011 +0100

    Version 1.13.1.

commit 01f6bce19dbfaf42fa4908683f3cc8785585d023
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 26 12:39:54 2011 +0100

    virt-df: Re-add documentation for --csv option.
    
    The documentation for the --csv option disappeared between 1.6 and 1.8
    when we rewrote virt-df in C.  Re-add it from 1.6 sources.

commit 15289d4b726d7c38702794df23c61ae40879a46c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 25 11:21:48 2011 +0100

    test-tool: Print FEBOOTSTRAP_* environment variables (RHBZ#671082).

commit deb95471fbd229605d9916ff90b2ff7cf92633eb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 25 11:16:24 2011 +0100

    test-tool: Display state of pgroup flag from the handle.
    
    This updates commit f173543fd207bdc254a5eb75180d82ef25eacae9.

commit 5d7dc0dfb65f367dab3560ee23e404fe21373f45
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 25 11:12:48 2011 +0100

    launch: Add qemu_supports_re function.
    
    This function is like qemu_supports, but allows us to grep
    the help text using regular expressions.
    
    Note the function is not used yet.

commit 41cd0e302d6554facd6b9f7daaa78304361efaef
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 25 10:56:52 2011 +0100

    Require PCRE library.
    
    This library is widely available in distros.

commit 316817b5ad98e294a9d2498a4403e82911a75b4a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 22 16:17:06 2011 +0100

    docs: Document FEBOOTSTRAP_KERNEL, FEBOOTSTRAP_MODULES (RHBZ#671082).

commit 8386a57458aceb768f0e59aa090a15a544f7466e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 22 11:12:52 2011 +0100

    perl: Fix CCFLAGS for Perl 5.14.
    
    A change to ExtUtils::CBuilder in Perl 5.14 causes CCFLAGS to
    completely replace, rather than appending, the C flags.
    
    The unfortunate consequence of this is that vital flags such as
    -D_FILE_OFFSET_BITS=64 are missing.  For 32 bit code, this means you
    get binary-incompatible code that completely fails to load.
    
    For further analysis see:
    
    http://www.nntp.perl.org/group/perl.perl5.porters/2011/04/msg171535.html
    
    This commit changes CCFLAGS so that it appends to the existing
    $Config{ccflags} instead of replacing it.  On earlier versions of Perl
    this means we get two copies of the flags, which is unfortunate but
    should be safe.

commit 71eb0bf45649eefa1f0cd4b1372cfc2653c8e7a5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 21 17:59:34 2011 +0100

    build: Redirect ./configure errors in general to config.log.

commit 610642491a4846f45c7b233060ffde46f6ca09f0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 21 17:00:48 2011 +0100

    build: Send failed Perl test configure output to config.log.

commit 806b6e01506dea4eae68ac3e468d9398d63cafcb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 21 10:50:40 2011 +0100

    build: Allow 'make quickcheck' test-tool args to be overridden.
    
    A typical use for this is for packagers who want to increase
    the default timeout:
    
      make quickcheck QUICKCHECK_TEST_TOOL_ARGS="-t 300"

commit 43ab6dfdf38fdafa040b9e9c1665295765f1486c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 20 18:28:07 2011 +0100

    Update version number to 1.13.0.
    
    There is no build or tarball for this, since it is identical
    to 1.12.0.

commit 0b7de697a4273dbcce175085aef45ef62e964fcc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 20 16:37:37 2011 +0100

    Version 1.12.0.

commit 02f3b53863871a8c37f41f691feb6f5ce7b3c2fc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 20 16:37:19 2011 +0100

    Finalize release notes for 1.12 release.

commit 1d0f398d8e3c74ce6a70cbbb8d9b8ae07c6d7ef6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 20 14:41:39 2011 +0100

    blkid: Use -c /dev/null option to kill the cache.
    
    On recent Debian, /etc/blkid.tab is now a symlink to /dev/.blkid.tab.
    Rather than chasing the cache file around (it may move to /run in future)
    use the -c /dev/null option to stop blkid from reading the cache.

commit 168fd4ad5d1e5da93e11388095d41aaa8f804ceb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 20 14:25:32 2011 +0100

    blkid: Detect when value not found and return empty string.
    
    If the blkid command returns 2, that means the value was not found.
    
    Note that this changes the output of the vfs-type API when the
    filesystem has no type (eg when it is empty).  Previously this would
    return an error.  Now it returns empty string "".
    
    We did not document this either way.  Making it return empty string is
    consistent with vfs-label and vfs-uuid.
    
    This change broke list-filesystems, since that code was assuming that
    vfs-type could only return a filesystem type or an error.

commit 764e4e2aa289b645b64feff454d376a86486d219
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 20 13:49:16 2011 +0100

    docs: Update stable release instructions.

commit 422678073bbd55053f020bc6743617792bb99d6b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 20 13:33:47 2011 +0100

    configure: Remove -Wmissing-noreturn warning.

commit 408f07ed3c34b2bad4885b3c000e998e4d350668
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 20 13:20:10 2011 +0100

    po-docs: Fix generation of 'podfiles'.

commit 8b2e60ce4b46e86da093ee64d4e0b0ae3c998d55
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 20 12:07:30 2011 +0100

    appliance: Capture stderr from qemu to the event system.

commit 70daccfe4e9939078436c2830928d8e53432dd84
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 20 12:05:40 2011 +0100

    appliance: Document pipe fds.

commit 5dec7842655dd872bb0fd9fe07f6a9eab6b13bfd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 20 11:45:02 2011 +0100

    Partially revert d82438431c1551610eb7d9945fa76d6387534582.
    
    It appears qemu-kvm does *not* require -machine accel=tcg option.
    That problem disappeared after upgrading seabios(!)  However leave the
    test for qemu -help option, since that's useful to determine if qemu
    is completely broken or not.

commit d82438431c1551610eb7d9945fa76d6387534582
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 19 19:55:24 2011 +0100

    build: Fix virtio-serial test for qemu 0.15.
    
    Now qemu 0.15 won't even start up unless the -machine accel=... option
    is specified.  Essentially this is a regression in qemu.

commit a6f99dd9326c2da66f6b7e49d94901fffdddd6ea
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 19 19:07:50 2011 +0100

    Version 1.11.20.

commit 1c0f75c80689580da73e27c1b4e4d26d4fb2cae8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 19 17:56:14 2011 +0100

    Update release notes.

commit d025e91f6751505c70b7b5f492ee72c67e274ecf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 19 17:54:35 2011 +0100

    java: Add guestfs-java(3) man page.

commit a548c9668315844763456c15e89e35e9702b851a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 19 17:40:52 2011 +0100

    Add missing reference to guestfs-perl(3) to guestfs(3).

commit 20480068caefae4ff62c3564113df0788a2a1c87
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 19 16:34:06 2011 +0100

    java: Tidy up the generated C bindings file.

commit d7da4807e83d4a960daca8f36bbc8a826063b135
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 19 14:45:11 2011 +0100

    java: Fix optional arguments in calls.
    
    This also adds tests.

commit c79ba93f7e53f6a62b5793ba35f1c3b13527eef6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 19 14:32:45 2011 +0100

    java: Enable warnings when compiling C bindings code.
    
    And fix the code so it doesn't generate warnings.

commit d8140d5689e49d926e5e1a53ec685088dec19a6d
Author: Nikita A Menkovich <menkovich@gmail.com>
Date:   Mon Jul 18 13:55:02 2011 +0100

    debian: Fix misspelling in debian/control.
    
    Updates commit c6577ac73db2d2d93a094ca2b7990e0d60e6a93a.

commit 32baae0e55318784af4a736ae956e11b4de274a2
Author: Nikita A Menkovich <menkovich@gmail.com>
Date:   Mon Jul 18 13:57:09 2011 +0100

    debian: Add debian/guestfsd.* to the tarball.

commit c6577ac73db2d2d93a094ca2b7990e0d60e6a93a
Author: Nikita A Menkovich <menkovich@gmail.com>
Date:   Mon Jul 18 13:55:02 2011 +0100

    debian: Fix misspelling in debian/control.

commit 463a739bf0475cf45bf03ad2c4130b2ed656686e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 18 11:55:41 2011 +0100

    Version 1.11.19.

commit 3b9d52b2a82bd6cdb10aa267b514805ad3f5e552
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 18 12:12:42 2011 +0100

    po-docs: Include source (POD files) in EXTRA_DIST.

commit 44d295756fc0fd58a85d4a417ba97145697894fb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 18 09:34:04 2011 +0100

    po-docs: Remove empty Spanish translation file.

commit 33fe14b42f4977740ef12c4d6fc08873b8eef676
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jul 18 09:33:24 2011 +0100

    po-docs: Fix UTF-8 encoding problem.

commit 03459c8fa754e45c7e492b378456e0afac1b0dcb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jul 17 23:05:50 2011 +0100

    po-docs: Update the list of output manpages.

commit f5d26e3cea568be665b6fbb442b328603cba8d93
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jul 17 23:03:37 2011 +0100

    po-docs: Generate list of *.pod files.
    
    Generate the list of *.pod files, instead of hard coding
    it (and having it get very very out of date).  Store the
    list in a separate file po-docs/podfiles.

commit 63c1d5dd6efb9b59a73a11f31aefdc55eaf28384
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jul 17 22:03:22 2011 +0100

    Add notes on making a libguestfs stable release.

commit d28d76b4fba3afe18757ab848346e8123a8bcae1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jul 17 22:02:58 2011 +0100

    Pull latest translations from Transifex.

commit dd497b76f846f6afed206fc86cf72592dedbbe7d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jul 17 22:01:40 2011 +0100

    Add tx pull wrapper script.

commit cd00157efca760ce043dcae216d921841dd25ff9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jul 17 10:29:47 2011 +0100

    ocaml: Generate ocamldoc.
    
    Also includes improvements to the OCaml documentation.

commit e72592563c0be15f1b2400e15205d5e803875685
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 16 19:11:52 2011 +0100

    ocaml: Bind guestfs_last_errno.

commit 8ee5c6d3a77b62f7c107db39751bb60366bee7b7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 16 19:11:37 2011 +0100

    Update API support.

commit 2d3193e971f3c7c976146a55e6c2d49dca9d7e04
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 16 15:26:32 2011 +0100

    Update ROADMAP file.

commit c5bd9539dba8476e79d859c5c09e3277538957b3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 16 15:23:48 2011 +0100

    fish: Don't make --ro the default yet.
    
    Defer this decision to a future version of libguestfs.

commit a711777bedcf64d814bb953ff8771858dbd7161b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 16 15:20:29 2011 +0100

    docs: Separate out combined =item 's in man pages.
    
    Turn:
    
     =item B<-a> | B<--all>
    
    into:
    
     =item B<-a>
    
     =item B<--all>
    
    This gives a more natural-looking manual page, as well as making it
    easier to directly link to these sections.

commit d84bb5dc19afd30c44f984b1c33c92691aa236f7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 16 12:36:07 2011 +0100

    Update and rearrange release notes.

commit 9f135be96e21d899b36ef2287a6ba8cea9beb4ff
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 15 22:09:29 2011 +0100

    Fix test-guestfish-escapes regression test to work with debug/trace enabled.
    
    If debugging or tracing is enabled, extra messages are sent to stderr
    which mess with this test.  Remove the extra messages before checking
    stderr.
    
    This updates commit 617e7f6bafa7de2303c08e1715004aae3141c389.

commit 1f0c650c8ffdf0602ec74b999f62d3efa6822c96
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 15 17:23:41 2011 +0100

    Version 1.11.18.

commit 35b15d918df53b9ced54dbb6015b94f7ee3afca4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 15 16:14:56 2011 +0100

    Update release notes.

commit db5d15792203c1928a450a9eefc87b3133ac4291
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 15 16:10:19 2011 +0100

    Update API support.

commit 1e9e351f178dcb425c4796c90fe7c8c5c250d100
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 15 14:57:00 2011 +0100

    ruby: Add binding for guestfs_user_cancel.

commit f4dadd0fcfe41b9cc6fcd6097c4c3cf509d69879
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 15 14:47:09 2011 +0100

    perl: Add binding for guestfs_user_cancel.

commit 60dd9494f0890dcc6c9a1cce311edc92cb992290
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 15 14:33:29 2011 +0100

    ocaml: Add binding for guestfs_user_cancel.

commit 50c54d2814b13d7d51f659600e93565dc6921b28
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 15 11:01:23 2011 +0100

    fish: Register ^C handler to cancel long transfers.

commit e187aa8431ccf0436d9aee03ee1e80b79f148217
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 15 11:36:23 2011 +0100

    fish: Add is_interactive flag.
    
    Decide early (before launch) if this is going to be an interactive
    session, and set the is_interactive flag.

commit 9ec9c97ce2ba46e56b304d3a367c86adc703160d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 15 10:43:36 2011 +0100

    Add user cancellation to the C API.
    
    This allows long transfers (FileIn and FileOut operations) to be
    cancelled by calling the signal and thread safe guestfs_user_cancel
    function.
    
    Most of this commit consists of a multithreaded program that tests
    user cancellation of uploads and downloads.

commit f173543fd207bdc254a5eb75180d82ef25eacae9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 15 11:38:21 2011 +0100

    New APIs: set-pgroup, get-pgroup
    
    If the pgroup flag is set in the handle, then the qemu and recovery
    subprocesses are placed in separate process groups.  The default is
    false.
    
    The purpose for setting up a process group is that ^C will not be
    passed from the main process down to these processes (killing them).
    This allows ^C and other keyboard events to be caught and handled in
    the main process.

commit 4b53a3737b76cad7aca407a0d9e37fed1d42ef69
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 15 10:42:56 2011 +0100

    guestfs.h: Add missing extern keyword before event functions.

commit d2a25fd1735506e8592bcd70b9c02063023cb149
Author: Nikita A Menkovich <menkovich@gmail.com>
Date:   Thu Jul 14 19:24:43 2011 +0100

    debian: New sub-package: guestfsd.
    
    This patch adds guestfsd debian package to the build.  The daemon can
    be installed in virtualization clients to enable libguestfs live
    access.

commit bb6a1b4cdc3fc441bb10ff4b9670895c199c6206
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 14 18:18:07 2011 +0100

    New API: write-append
    
    Append content to the end of a file.

commit 617e7f6bafa7de2303c08e1715004aae3141c389
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 14 18:17:39 2011 +0100

    fish: Handle backslash escapes in guestfish double-quoted strings.

commit d029fa69db88e216faeedad6ebe0ca337a76fa6e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 14 15:52:29 2011 +0100

    build: Add ./configure --enable-install-daemon
    
    If enabled, then the daemon will be installed in $sbindir
    (eg. /usr/sbin/guestfsd).  The default is off, as now.
    
    This option should be used by packagers when building the libguestfs
    live service.

commit 4accf3197235300029d04d0ab637b66eaaf9f8df
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 14 14:32:34 2011 +0100

    Version 1.11.17.

commit 62a34ff2d33b8692781ab297ca7c9972d72cdb4d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 14 13:42:33 2011 +0100

    resize: Clarify examples in the man page.

commit f2d816573ffba9c5a2022ac5b3b6514eaf02d0f7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 14 11:39:11 2011 +0100

    resize: Add btrfs support to virt-resize (RHBZ#721275).

commit a001a0d710ec61d8bc11841f44ac0d1f296040ea
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 14 11:38:25 2011 +0100

    New API: btrfs-filesystem-resize (RHBZ#721160).
    
    This resizes a btrfs filesystem.

commit 08910ee60cfac9aa648e59dda5dbb429825c561e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 14 13:02:31 2011 +0100

    docs: resize: Not just limited to resizing filesystems in partitions.
    
    If you use --LV-expand then filesystems in LVs can be resized too.

commit c6340f45007b0ab7e1c5391cf78afc10a816553f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 14 11:27:24 2011 +0100

    mkfs: Don't die if mke2fs is not available.
    
    Allow other types of filesystems to be created.

commit c21d6dc29c91691f2dcd914d0cc85f060f83289c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 13 15:59:33 2011 +0100

    Version 1.11.16.

commit fffe73ec6faebe2847ba0fa45c8a397fb5972d25
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 13 15:33:07 2011 +0100

    Update release notes.

commit f91c6f217facc88b60225769c61604a8b8c7169b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 13 15:03:04 2011 +0100

    Refresh README file.
    
    Update and verify the list of requirements, by checking it against
    both configure.ac and the Fedora specfile.
    
    Remove some obsolete sections that covered historical ground.

commit aa8a9ebf29b7fdc97467e911560a1a7a774e9e1f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 13 14:27:28 2011 +0100

    appliance: Add systemd to get /sbin/reboot for virt-rescue (RHBZ#661280).

commit 0c1cdfc6f234540c8cd5f41c239a5a3bf6b0f73e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 13 09:51:00 2011 +0100

    docs: Update API support.

commit d84db26a2bd28bd96aa88b6308dc540278db5c7d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 13 09:44:13 2011 +0100

    virt-resize: Arrange options in man page in alphabetical order.

commit d31de200b82ef66d7e87b32dd5345c053997cc35
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 13 09:27:57 2011 +0100

    virt-resize: Add --ntfsresize-force option.
    
    Use the non-deprecated g#ntfsresize_opts API call, and also add
    the --ntfsresize-force option for forcing resize.

commit 8c26750336f0f9cbcaa1e98278d9062af83a6b65
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 12 19:11:59 2011 +0100

    Version 1.11.15.

commit 995674a44aa00b3c68d47d367a8e92b610ffc700
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 12 17:26:34 2011 +0100

    TODO: Attach method for disconnected operation.

commit 511c82df46f5c6f4a7f984fdb81d4691038ed6da
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 12 17:18:48 2011 +0100

    part-get-bootable: Fix when partitions are missing or unordered (RHBZ#602997).

commit edd747a09060dd191277f1bcae827a94939cfb9d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 12 18:16:40 2011 +0100

    New API: ntfsresize-opts (RHBZ#685009).
    
    This is a more comprehensive fix for RHBZ#685009.  Add a new API which
    allows the --force flag to be passed, allowing multiple NTFS resize
    operations in a single session.

commit 2ba2ddf2113db7bb2afe3f739dc3cbaa5416a4ba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 12 14:13:57 2011 +0100

    Document that ntfsresize cannot be used multiple times (RHBZ#685009).

commit 4d4d3b2498be9dc8ab7e5f16928ac8f1874c2a58
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 12 13:31:42 2011 +0100

    fish: Show device mapper device in tab completion (RHBZ#688062).
    
    With this change:
    
    ><fs> luks-open /dev/vda1 lukstest
    Enter key or passphrase ("key"):
    ><fs> ll /dev/<TAB>
    /dev/mapper/lukstest  /dev/vda              /dev/vda1

commit ce5a8978b54f409de4347f16f7065b063cb47cf1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 12 13:26:25 2011 +0100

    New API: list-dm-devices (RHBZ#688062).
    
    List device mapper devices.

commit 68af98e570adca21b2e4022090adb5d1ac6ca38a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 12 12:23:15 2011 +0100

    Don't mention /dev/mapper in docs for vg-activate{,-all} commands.
    
    Although vg-activate and vg-activate-all do make /dev/mapper/VG-LV
    devices internally, we always prefer to use the /dev/VG/LV format and
    we return this format where possible.  Therefore don't mention
    /dev/mapper in this documentation.

commit 0344248af55802bbbd816b349ec1ba9305996f6e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 12 18:17:35 2011 +0100

    protocol: Force optargs_bitmask to be passed as 0 for non-opt actions.
    
    If the action doesn't take optional arguments, nevertheless force the
    optargs_bitmask field in the header to be passed as 0, and give an
    error if not.

commit c0f72f13c075a754afa7870ecf105138fba821bb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 12 12:51:43 2011 +0100

    list-9p: Avoid double free along error path.
    
    This updates commit 5f10c3350338bbca735a74db26f98da968957bd9.

commit ebe3d8f43a0ab7f60f3c1c612f117e793179f644
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 6 17:25:00 2011 +0100

    Version 1.11.14.

commit 407d8fe1db9b8c9b0b6608353e000cb08daa5605
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 6 10:53:04 2011 +0100

    mkfs-opts: Don't test optional arguments in this test.

commit 39d5c63be6037d1cb8bdf6e5a7fd9e3620c6ba6b
Author: Nikita A Menkovich <menkovich@gmail.com>
Date:   Wed Jul 6 10:36:13 2011 +0100

    mkfs-opts: Add optional sectorsize parameter.

commit f7a11c60437afa700775eaa86a9be1a543427959
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 6 10:50:25 2011 +0100

    capitests: Allow tests to properly test optional arguments.
    
    For optional arguments, you can now specify empty string to mean no
    argument, except for String optional arguments where you must use
    "NOARG" (empty string meaning a supplied empty string argument).

commit 24fb2c1255f751dad98dd1739b3ed3a52ce06f70
Author: Nikita A Menkovich <menkovich@gmail.com>
Date:   Mon Jul 4 10:25:04 2011 +0100

    Implement inode option to mkfs_opts command.
    
    This is needed because older versions of grub(for example in centos)
    do not understand filesystems created with newer version of e2fsprogs.
    By default in e2fsprogs 1.4+ creates partitions with 256 bit inode
    size, and grub expect 128 bit size.

commit 436f8df147d5854800692e8986c7b48eeea648de
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 30 16:06:07 2011 +0100

    Version 1.11.13.

commit f3ada2c7653866f2529c9f18aaa99f76cd984844
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 30 12:57:31 2011 +0100

    Add caution subdirectory containing safety and liveness tests.
    
    Not that I'm paranoid about qemu breaking snapshots of anything like
    that ...

commit 1acb82e9f70a81982c7c2ad8b7966bffc4fcfa8a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 30 12:06:09 2011 +0100

    Update release notes.

commit 76bd81820f50a390b7e853d65f41b29a37e63f43
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 30 11:36:38 2011 +0100

    inspector: Update documentation to cover <icon> element.
    
    This updates commit 7f16c346bbeba2f2fe3c31ccb85158178a284d84.

commit 8c5bdc3e12947580e91c018b71adf9ad3128bb75
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 30 10:14:33 2011 +0100

    python: Add explicit g.close() method (RHBZ#717786).

commit 81fbdee6cc5d231dcbc3eeb01412d46b19974b37
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 29 13:41:50 2011 +0100

    docs: Update API support.

commit 21c118a20e625dccd7cbd454f67a9f9c360c53f1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 28 19:52:11 2011 +0100

    Version 1.11.12.

commit dfb89e3556c02bcc5fbe62f90e3c716a2cbe93da
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 28 18:58:54 2011 +0100

    fish: Add 'display' command for displaying graphical files.

commit 7f16c346bbeba2f2fe3c31ccb85158178a284d84
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 27 15:27:46 2011 +0100

    New API: inspect-get-icon returns the guest icon.
    
    This API returns the guest's favicon if found, else an icon
    representing the guest operating system.  Currently supported by this
    patch: Fedora, RHEL and derivatives, Debian (but not Ubuntu),
    Windows XP, Windows 7.
    
    This also updates virt-inspector to include an <icon> element
    containing the icon in base64 encoding.

commit 5f26270c343bf543a7bf20cf3e6f182f6282f8ea
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 27 16:10:25 2011 +0100

    Change download_to_tmp so it can work with multi-root operating systems.
    
    The previous guestfs___download_to_tmp function did not handle
    multiboot correctly.  In particular it used the same cache name
    for downloaded files from different roots, which could have caused
    things like applications in each root to be confused.
    
    This changes the function so that the cache filename is prefixed
    with the root / fs number, eg. $tmpdir/0-Name instead of $tmpdir/Name.
    
    This change also requires the function to return the new name, so
    all places in the code which called this function had to be
    updated.
    
    This updates and fixes commit 3c1f762abed92f7a358f3bc93e3396d0606b18ad.

commit adb5db58d850ce6d15380177a63c68276f863c98
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 28 08:50:14 2011 +0100

    generator: Fix functions with both RBufferOut and optional args.
    
    No current function returns RBufferOut and has optional args.  Such
    functions would be generated incorrectly.
    
    RBufferOut implies a silent "size_t *size_r" argument is added after
    the regular arguments and before the optional arguments.  Various
    changes to the code generator need to be made to take this into
    account.

commit ea96c7acf7a332c08c2214796add647224a2ede0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 28 17:02:46 2011 +0100

    inspector: Fix comment in virt-inspector.rng.
    
    The comment referred to the command line syntax of the old
    virt-inspector.

commit b3c1dcfaee356a8feddef82c9ecbe5b7c6a4512f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 28 09:58:44 2011 +0100

    inspection: Remove note about root device string.
    
    This is a fairly pointless note/warning since (a) you can't use the
    API if you don't pass a root device string and (b) the code gives you
    a good error message if you pass something that is not a root device
    string.

commit 478f6c5bdbe4b7e466fe7eaca63aaba002f585ce
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 28 10:36:09 2011 +0100

    guestfs.h: Tidy up *_argv structs and other #defines.

commit 123610f1b5133a9e541a245467f60d065ea96575
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 27 18:14:15 2011 +0100

    Revert "Lib.pm: unknown filesystem label SWAP-sda2 (RHBZ#666578)"
    
    This reverts commit 5cab0d6c807d8a3bf9690375c663d11a10e21656.

commit 14bb3b5ae75f41af05ca6d26ebbb5e85aacf2e20
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 22 13:55:14 2011 +0100

    New API: mount-9p lets you mount 9p filesystems (RHBZ#714981).
    
    The updated patch makes 'options' into an optional parameter.

commit 5f10c3350338bbca735a74db26f98da968957bd9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 22 10:13:23 2011 +0100

    New API: list-9p lists 9p filesystem mount tags (RHBZ#714981).

commit 56b94f5f6aa7981533ad867cc908c6e9cca2ba42
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 22 10:36:44 2011 +0100

    trace: Print empty list correctly.
    
    Empty lists returned by RStringList and RHashtable functions
    were incorrectly printed as [""].
    
    Fix this so they are printed as [] instead.

commit e1e78bcef5e4654bd2456bd696840329359d35cd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 21 13:22:16 2011 +0100

    Version 1.11.11.

commit 9287197a85a7b51167a3b6c289a129760e6f9936
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 20 10:35:02 2011 +0100

    Enable deprecated option only with gcc >= 4.5.
    
    Before gcc 4.5, the deprecated option did not take the optional string
    argument (see [1]).  This caused compilation to fail with gcc < 4.5.
    
    [1] http://gcc.gnu.org/gcc-4.5/changes.html

commit cabfaa857fbd325bd0303fa56b28df8ce52aab33
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 18 13:04:18 2011 +0100

    perl: Ignore MYMETA.yml.
    
    This file is created by one of the build tools used by Perl 5.14.

commit ba9343b52d5fec1dd618e5439adc2647ce14dc0c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 18 13:01:12 2011 +0100

    todo: Idea for interactive disk creator program.

commit 5c3c7e8825341e18c9449976f8a321a04cc78d79
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 18 13:00:00 2011 +0100

    perl: Don't use qw() as parentheses.
    
    In Perl 5.14:
    
    Use of qw(...) as parentheses is deprecated at perl/blib/lib/Sys/Guestfs/Lib.pm line 1111.

commit 4ee190628bc05f0c8fad1f6d9c3e85619a91e8b8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 13 18:58:53 2011 +0100

    generator: Rewrite UUIDs that begin with zero byte.
    
    In util-linux <= 2.19, mkswap -U cannot handle the first byte of the
    UUID being zero, so we artificially rewrite such UUIDs.
    
    See: http://article.gmane.org/gmane.linux.utilities.util-linux-ng/4273

commit 1f59849a4a45a1c78488eb41b250de631b4405a6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 10 16:03:55 2011 +0100

    Version 1.11.10.

commit daf55c07978cd29fe6675911bf76da0b056fdae1
Author: Jim Meyering <jim@meyering.net>
Date:   Fri Jun 10 11:57:20 2011 +0200

    build: include <string.h> for src/match.c's use of strlen

commit 343ba6d482643882c3ab3a529f3d882ee1ba36f9
Author: Jim Meyering <meyering@redhat.com>
Date:   Thu Jun 9 22:15:52 2011 +0200

    bootstrap: use --libtool

commit 92a7d592dfd94420563a707e2e83041bb34ed9fb
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Jun 7 19:48:16 2011 +0200

    build: update to latest gnulib
    
    * .gnulib: Update submodule to latest.
    * daemon/m4/gnulib-cache.m4: Regenerate.

commit f5096dd546ac43c7288b3ab7aec1562f070f78f6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 9 10:10:50 2011 +0100

    daemon: Keep Coverity happy by ignoring some return values.

commit 29453a58d818df24c238d0a08a68886ebe4029dd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jun 9 09:39:54 2011 +0100

    Coverity: Don't return freed pointers from command* along error path.
    
    If the external command failed to run, we could free up the allocated
    *stdoutput and *stderror pointers, but then return those freed
    pointers to the caller.  The caller usually tries to print and free
    *stderror, so this is a serious error.
    
    Instead, return *stdoutput as NULL, and *stderror pointing to a
    generic error message.

commit 7a091a11d7aeddc170e4d1b833fd9d7d18c00841
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 8 22:38:53 2011 +0100

    Coverity: Missing return on error path.

commit 346c5b0ebf58c81f657540eeb72abaa41bfc4e3f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 8 22:30:24 2011 +0100

    Coverity: Ensure fp is closed along all error paths.

commit 7c020a14802255c966b2b402b983551b86a08bba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 8 22:27:01 2011 +0100

    Coverity: Close directory handle along error paths.

commit 869c11b30c72c57e48dd63c4641087a06abe80d5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 8 22:25:21 2011 +0100

    Coverity: Don't leak argv arrays.

commit 3135b8c378f9f98ae66e37fd79d305764334980d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 8 22:16:59 2011 +0100

    Coverity: Don't leak error strings.

commit 7fae594df719d1d81a043c4d0280b359f750facb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 8 22:14:21 2011 +0100

    Coverity: Check return value of sysroot_path.
    
    For some reason we were checking the parameter!

commit 3a5bd5aba23583e64bfaabc906ca95b0f9d37578
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 8 22:07:36 2011 +0100

    Coverity: Check return value of malloc.

commit 76dfb74324fa0daa343d7edf89bd05e1fe7b4db0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 8 22:04:25 2011 +0100

    Coverity: Don't close fd_cwd if fd_cwd == -1.

commit 3ed8d5122026f37dd96cc7e8503c4f3ecf0afbb7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 8 22:01:41 2011 +0100

    Coverity: Avoid calling sort_strings (NULL, 0) on empty list.

commit 48ebf50f3136ac27f4252662e351230ffa2b15e5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 8 21:56:56 2011 +0100

    Coverity: Don't call free_strings (NULL).

commit 9160eec4fbf12643d8d5fa13465066822b2fed92
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 8 21:53:07 2011 +0100

    Coverity: Remove unreachable code.

commit bfc02f78f36d88543f8435e450e28c986b667a94
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 8 13:12:01 2011 +0100

    init: Remove timeout in udevadm settle command.
    
    The given timeout (10s) was too low if the appliance was
    running slowly, which caused a cascade of other failures
    during tests.
    
    Note that in udev-171 and above on Fedora, /sbin/start_udev
    no longer exists, so now we are using this manual method to
    start udevd.

commit 2f73ea343cc4a3433f20e99a7835152767a70f80
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 7 12:36:02 2011 +0100

    protocol: Enhance "unexpected end of file when reading from daemon" error.
    
    Make this error more informative, since it is a common error when the
    appliance fails to start up.

commit 9ce239a8365b2209de24f72aa75a7a049ee72d01
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 4 22:22:44 2011 +0100

    Version 1.11.9.

commit cdd11b758f2601f7eeda4fca684638b0335d531a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 4 22:47:52 2011 +0100

    Only include date, not time, in BUGS file.
    
    This is so the file does not change so often when using 'make dist'.

commit 503c8f8661a9bfd4928d720cbfd985121149230c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 4 22:22:04 2011 +0100

    Remove dependency diagram, since it is very out of date.

commit 42e7ea6840cd66e4a136b6417bdee14e152fe140
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 3 17:00:07 2011 +0100

    virt-ls: Add virt-ls -lR option for complex file iteration.

commit bb965ded274f911fb5d7889f88db9adaad1d2a52
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 3 15:19:05 2011 +0100

    virt-ls: Refactor mode selection code.
    
    This is just code motion.

commit 7177340a6f0e3ac1f238c69b0ad5267e18252fe2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 3 14:49:19 2011 +0100

    virt-ls: Small fix for output of --help option.

commit 418842518bf856144e2ab33abb6de417d1b60753
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 4 13:13:11 2011 +0100

    Ubuntu: Fix compilation of virt-resize if old libguestfs already installed.

commit 3819b657b0e3cc7cf99d04fc1f7bced8269e6ce9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 3 09:41:20 2011 +0100

    recipes: in tr command \000 should be \0

commit 08bc8e40cea750bd35493ecab514e8e37c883a0a
Author: Nikita A Menkovich <menkovich@gmail.com>
Date:   Fri May 20 11:26:09 2011 +0100

    daemon: Fix error message.

commit 0c133cf689ba4816ba6e9283c3f9ed7f06dc0a77
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 20 10:54:55 2011 +0100

    todo: Document thoughts on visiting files.

commit b85b4fafe1e23dc99d10647f6d35cd37b0a3f02a
Author: Nikita A Menkovich <menkovich@gmail.com>
Date:   Fri May 20 10:35:06 2011 +0100

    debian: Add build dependencies: dpkg-dev, devscripts, gperf.

commit 4b91462bad010a0b214e808f94a916002be65b91
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 19 14:44:02 2011 +0100

    daemon: Make sysroot_len be size_t instead of int.

commit 7ac2c210dde062a0870431b60d0693c55e2cf17c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 18 22:23:05 2011 +0100

    todo: Remove event log parsing - done.

commit b646886d1aa244a32f37b19b7fb7921176d29fcd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 18 21:11:47 2011 +0100

    build: Install guestfs-recipes.1.html on website.
    
    This updates commit f2c7df589c7e161f33b46d05a943b5489dc2cffe.

commit f2c7df589c7e161f33b46d05a943b5489dc2cffe
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 18 15:45:36 2011 +0100

    Add new guestfs-rescue(1) man page with recipes.

commit 00d34429e5f343bcc3f6afbd27aa3a2ca7820086
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 18 15:27:20 2011 +0100

    Remove guestfish recipes.
    
    These were out of date.  We will replace them with more up to date
    information.

commit 95368927219f2888aeb1232c7ec950dde538bc39
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 18 15:32:59 2011 +0100

    guestfs-examples(3): Remove link to OCaml homepage.

commit 8a1be9265d8fda423a09e267cb92bd3fd2b1e163
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 18 10:04:37 2011 +0100

    Version 1.11.8.

commit f55b32b2db83495fc0987f0fe0e979818704dff1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 18 10:04:05 2011 +0100

    zero: Disable file test because of bug in file command.
    
    See: https://bugzilla.redhat.com/show_bug.cgi?id=705499

commit 94d1dfde2793dccdcaf105d77c6135cdae70fa5e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 17 22:54:20 2011 +0100

    virt-win-reg: Win XP paths can contain %systemdrive%.

commit 4a6890d824b6bcb811e0dca9a0e77d81451a9056
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 17 22:53:53 2011 +0100

    virt-win-reg: systemroot macro should be replaced case insensitive.

commit 598484729632d1207dc3e1493f27499de18d2242
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 17 22:06:00 2011 +0100

    New APIs: is-zero and is-zero-device, to test if file or device is all zeroes.

commit ef6f877b9df261fad1fbf361b8ce7af1055dfbb7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 17 20:57:56 2011 +0100

    Document that guestfs_file output depends on file(1) command.
    
    And therefore practically it cannot be part of the ABI since
    the output of file(1) itself changes from time to time.

commit b777a5a64926e9bf9b7109a0e4fb1332b20fa37f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 17 19:51:37 2011 +0100

    fuse: Add note about allowing other users to see filesystem (RHBZ#705200).

commit 916392e2272b82bf39f9b2d4efe90557639e1f0a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 17 17:48:48 2011 +0100

    Version 1.11.7.

commit 12414ddc020f94e75a791815d2c1ac2b0d76eaf1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 17 15:52:28 2011 +0100

    generator: Mark sfdisk functions as deprecated.
    
    Point to the part-* API calls as replacements.

commit 4ec8fd189dc8404e713c00bcfc36de358f5cdca3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 17 15:52:16 2011 +0100

    generator: Mark mount as deprecated.
    
    Callers should use 'mount_options' or 'mount_vfs' instead.
    
    See also:
    http://libguestfs.org/guestfs.3.html#libguestfs_gotchas

commit 31de91f6d2605899b3a797b73b358eec9c0b1196
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 17 15:51:25 2011 +0100

    generator: Mark wait_ready as deprecated.
    
    The function has been a no op for a very long time.  By marking
    it as deprecated we make it clear that you shouldn't call it
    in new code.

commit b43482964a8c7e19f47943506872cd58601c28e9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 17 15:50:16 2011 +0100

    generator: Check the flags fields.

commit 34acb80a28d1b48e734883a32f7f3344dc216ec0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 17 15:04:56 2011 +0100

    Enable deprecation warnings on all C programs.

commit 8c0aca8d9280fb87027826fe89d70cc2701e7f8b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 17 14:46:16 2011 +0100

    fish: fuse: Remove redundant -DGUESTFS_DEFAULT_PATH.
    
    This was left over from earlier code.  It is used in the base library,
    but not in guestfish or guestmount.

commit be507f6a225345ec3c03096fa05cdb0d0e3dec9a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 17 14:41:54 2011 +0100

    lib: Warn about deprecated functions (enable with -DGUESTFS_WARN_DEPRECATED=1).
    
    This allows C API users to be warned if they are using any deprecated
    functions.
    
    We don't warn about this by default.  Users have to specifically
    request this by defining the cpp symbol GUESTFS_WARN_DEPRECATED as 1.

commit 33adb59b60b1358656439a757f319ba8ce81e26c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 17 14:41:34 2011 +0100

    lib: Add GCC version macro to the header file.
    
    This will be used to internally enable various GCC enhancements.

commit 36b236fc97880c04e2ceeac502ff07a5e9993e28
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 17 14:43:48 2011 +0100

    lib: Add vertical space between each function in <guestfs.h>.

commit 64841fe8957f798df12a38bd81843c7011f2c278
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 17 13:58:20 2011 +0100

    appliance: Use qemu -machine option where available (RHBZ#700369).

commit 2dbe26c372fe102b4c77cb6a3ecfa435117a4ec3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 17 13:16:17 2011 +0100

    virt-win-reg: Support HKEY_USERS keys.
    
    This adds support for various Registry keys under HKEY_USERS (user
    preferences).
    
    (1) HKEY_USERS\<SID>
        where <SID> is a User SID.
    
    For example:
    
      # virt-win-reg Windows 'HKEY_USERS\S-1-5-19'
    
    lists out the LocalService user's registry.
    
    (2) HKEY_USERS\<username>
        where <username> is a Windows local username (this is a
        libguestfs extension).
    
    For example:
    
      # virt-win-reg Windows 'HKEY_USERS\rjones'
    
    lists out the user preferences of user 'rjones'.
    
    HKU can be used as an abbreviation for HKEY_USERS.  Merging is also
    supported.

commit 4443cfab8b16d862c8ab2971acccf4f18802b95c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 17 13:15:25 2011 +0100

    virt-win-reg: Don't use implicit $_ in map_path_to_hive function.

commit 3b4bb214c36d2659dff58e1a79bad8a9c48fa51d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 17 09:00:30 2011 +0100

    virt-win-reg: Don't hard-code the relationship between hive name and path.
    
    The crucial change is the tuple that is returned by map_path_to_hive:
    
    -    my ($hivename, [...]) = map_path_to_hive ($_);
    +    my ($hiveshortname, $hivefile, [...]) = map_path_to_hive ($_);
    
    Previously the $hivename was both the name of the hive (eg. "sam"),
    the name of the local copy in /tmp, and the name of the hive in
    %systemroot%\system32\config.
    
    In the new code, the $hiveshortname (eg. "sam") is still used for the
    local copy in /tmp, but we return $hivefile which is the full Windows
    path (eg. "/windows/system32/config/sam").
    
    The purpose of this change is to allow us in future to return hives
    from other Windows directories, specifically HKEY_USERS hives from
    Windows home directories.
    
    Although this is just code motion, it requires some quite extensive
    changes to virt-win-reg.

commit 9116f0eb01e23c9ec52144de6068c6918ce6c346
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue May 17 11:28:00 2011 +0100

    virt-win-reg: Add --unsafe-printable-strings option.
    
    This also requires hivex >= 1.2.7.

commit 977b61c5257876706218d72afe197c77cea6e6b8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 16 12:08:00 2011 +0100

    todo: See if qemu -machine option can be used to select KVM, TCG acceleration.

commit d6cf002174504eddb7c285f291b8f81c907b6eaa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 12 16:31:29 2011 +0100

    Version 1.11.6.

commit e95671d69e697f5b44775f797f1ef9fc0829d313
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 12 16:04:16 2011 +0100

    debian: Note that libconfig-dev ought to be required.
    
    However it doesn't appear to be in Debian at the moment.

commit 91ea9c1805112233140a463256c89072121fc182
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 12 13:52:27 2011 +0100

    debian: Include debian/ directory in tarball.
    
    This makes it simpler to build Debian and Ubuntu packages from the
    tarballs.

commit 48c91ac03cb0a6ac351822fe70200abb8ac7f761
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 12 13:50:38 2011 +0100

    build: Sort EXTRA_DIST into lexicographic order.

commit 03a8e3fc8eba11abb47a9f6f627b8d49076b1049
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 9 16:30:30 2011 +0100

    configure: Use Python platform-dependent site-packages.
    
    This updates commit c446e6e26e317e105870b0ab25fb082887e23bf6.

commit 2a8cf3aab32c45b327c6b6c1fe6d4e61c7c95909
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 9 15:22:32 2011 +0100

    Version 1.11.5.

commit ea70f55812f1ef621c57814a99a29d6798a5ad30
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 9 14:59:33 2011 +0100

    edit: Reorganize options alphabetically.

commit c665d14f29dd5d66be315b3042cb562aa0c40edd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 9 14:40:12 2011 +0100

    edit: Fix reference to virt-cat in the documentation.
    
    This updates commit 2b5fbc882a0a79646b668c7b95442f0b3673d63a.

commit c446e6e26e317e105870b0ab25fb082887e23bf6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon May 9 14:34:31 2011 +0100

    Use Python distutils to determine include and site-packages directories.
    
    This change was inspired by Hilko Bengen's similar change to hivex:
    http://git.annexia.org/?p=hivex.git;a=commitdiff;h=b808c875a34e62fcdf360534f923d6030590ff44

commit 2b5fbc882a0a79646b668c7b95442f0b3673d63a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 6 17:42:07 2011 -0400

    Rewrite virt-edit in C.

commit 5ce759bfdc70c97121ef34ab4d5c918d568f2474
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun May 8 21:59:50 2011 +0100

    daemon: Remove some less useful debugging messages.
    
    Remove some debug messages which were basically left over from when
    the code was being developed.
    
    However we leave debug messages where it is printing an external
    command that is about to be executed, since those are useful.

commit 5419153954ee0a2597358b992cc29e448a21ca60
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun May 8 16:53:03 2011 +0100

    Version 1.11.4.

commit 607aa95de927b5b8e4b212655c71bf21acbba372
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun May 8 15:13:23 2011 +0100

    Fix guestfs___rollback_cmdline when pos == 0.
    
    Because of the previous change to size_t, when pos == 0 the loop would
    wrap around and cause a segmentation fault.
    
    This fixes a regression introduced by
    commit 10167cea98f93a74abe63f0a54d3a662997e7489.

commit 8ee0ad0caf2f90f4883909cd9b61c4dd6f9cffbf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 6 17:33:44 2011 -0400

    configure: Sort output files in AC_CONFIG_FILES section.

commit 87fb6d852db04d0d707e6587d4579d1cf2bd05ef
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 6 12:23:00 2011 -0400

    fish: Allow -d UUID (specify libvirt domains by UUID).
    
    This applies in all the commands which use the common C option parsing
    code, ie:
    
    * guestfish
    * guestmount
    * virt-cat
    * virt-df
    * virt-filesystems
    * virt-inspector
    * virt-ls
    * virt-rescue

commit be3b028d7f2fadd8d2107a419393511e4510d0a4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 6 12:21:01 2011 -0400

    add-domain: Add allowuuid flag to allow UUIDs to be used for names.
    
    This makes a backwards-compatible change to the add-domain API.  If
    the optional allowuuid flag is true then UUIDs can be used instead of
    names in the domain name parameter.

commit a4c28b4ed1c5a102c8de2a7425568eb504d05c34
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 6 12:32:59 2011 -0400

    add-domain: Suppress libvirt errors on stderr.
    
    Install an error handler on the libvirt error connection so that
    errors are not printed on stderr (instead they go up through the usual
    libguestfs error mechanism).
    
    Unfortunately this doesn't suppress initial connection error messages
    to stderr.  I cannot see how to do this without affecting the global
    libvirt error handler, which is not acceptable for a library to be
    doing.

commit c49fc3831d12788c27b90d12f06a1cd69a88e3be
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun May 1 17:41:20 2011 -0400

    doc: Use I<-...> for cross-references to command line options.
    
    This is now used consistently across all the documentation.

commit 988a8784647a66adbece3c9fb470c06a4cce3cdd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun May 1 14:53:23 2011 -0400

    df: Refresh virt-df(1) man page.
    
    Add examples.
    
    Refresh description.
    
    Use I<...> to refer to command line options.

commit 805e6dbc15eae5a4f85eea3c37e295aefaefeb69
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 30 20:11:21 2011 -0400

    guestfs(3): Note that host file size limits affect guest disk limits.

commit 40f2b698ac765128bfcda5f0db893c95d09ae89a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 30 19:38:20 2011 -0400

    guestfs(3): Refresh documentation for private data area keys.

commit e1836891d435b9ef47e68949a3d69b1258924d0c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 30 19:26:08 2011 -0400

    guestfs(3): Document that old callback functions still work.

commit 108d7a134c5d26b967fa7162d9b80b40112c2869
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 30 19:10:52 2011 -0400

    guestfs(3): Referenced section is above, not below.

commit a5e421570cc840f70f2931e24b3df40c9a14cd2d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 30 19:10:25 2011 -0400

    guestfs(3): Refresh autosync gotcha documentation.

commit 470e373eea218c8d46b0c63dda93ee9ece48940f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 30 18:45:56 2011 -0400

    guestfs(3): Writing to a file descriptor, not just a pipe.

commit dd86183f3f6d4d5ad28e1f12c56ba920934e7ad0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 30 18:31:06 2011 -0400

    guestfs(3): Refresh documentation for guestfs_create, guestfs_close.

commit 91b35746b438240c0b64a22afae630ecbce5e02d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 30 05:55:27 2011 -0400

    Add a trace message to guestfs_close.
    
    Only the "first half" (ie. the call) is traced, because by the time
    the function returns the handle has gone and there's no way to
    generate events.
    
    You should see:
    
      libguestfs: trace: close

commit 10167cea98f93a74abe63f0a54d3a662997e7489
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 30 05:49:06 2011 -0400

    internal: Use size_t instead of int for command line size.

commit 478b2d80ed1d613f621e89a97a0b140004ebac29
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 30 05:45:26 2011 -0400

    guestfs_close: Move local variables close to code that uses them.
    
    This is just code motion.

commit b2f8627ab59daeb03f036dde6c66fb9da736950c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 30 05:42:43 2011 -0400

    guestfs_close: Remove unused local variable.

commit c0f96e9c6eda77e5e99de862dd4366010e4a1ab8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 27 20:10:24 2011 +0100

    guestfs(3): Document limits.

commit ea293658f41fb57a72f03e18d34597ef19c8d89d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 26 11:00:10 2011 +0100

    todo: Integrate with CMDBs (thanks Quinten Laureijs).

commit f24494195ab8541fda7236afb37a4f897c9bcee5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 22 22:53:07 2011 +0100

    python: Ensure Python GIL state is correct during callback.
    
    This updates commit 2cac52000a6a96a583af72e289a4296c596047d5.

commit dfd7efb91fb3120937c4780fee943abd0351c20e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 22 22:26:02 2011 +0100

    Version 1.11.3.

commit 2cac52000a6a96a583af72e289a4296c596047d5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 22 21:36:41 2011 +0100

    python: Implement new event API.
    
    This implements set_event_callback and delete_event_callback so that
    Python programs can use the new event mechanism.

commit 16da7589e91b0030fb5564553447f80b97c0b18c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 22 19:58:29 2011 +0100

    python: Rearrange C files for bindings.
    
    Move the hand-written functions into two new files:
    guestfs-py.h and guestfs-py-byhand.c
    
    This is just code motion.

commit 3acf732c2f23d8508f692efb2b222169914bfcdc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 22 21:34:08 2011 +0100

    perl: Decrement refcount in $g->delete_event_callback.
    
    This updates commit bc468c87d04b34faacd208c49cca4a5096e5103c.

commit 0da6f55a6745686ca056c6bc8ebf647f111cb8e8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 21 17:33:48 2011 +0100

    inspect: Look for %systemroot%/system32 for Windows heuristic.
    
    The virt-v2v transfer ISO had a /windows directory.  The core
    inspection code thought this was a Windows root filesystem.

commit 782f3a36469ca396dbf998ea82af2699153be3ed
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 21 17:29:44 2011 +0100

    list-applications: If software hive is missing, this is an error.
    
    virt-inspector would exit silently if list-applications failed along
    this error path.

commit 2b0ca7e7b8d369a42a51b1feec72ae8f17257c78
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 21 15:09:11 2011 +0100

    inspect: "centos" and "scientificlinux" are now separate distros.
    
    Previously we returned "rhel" for these, which was not accurate.

commit a9ac448cf8a3e8d13b67dc286940abe51226c9dc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 21 14:47:57 2011 +0100

    Update TODO.

commit 6d0d3b7f02a5a4801c6347e1ef0c8cd7755c2454
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 18 21:47:45 2011 +0100

    Version 1.11.2.

commit 08dc4a87b92435678780e9c49fe3bc1e7465d99f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 18 16:56:08 2011 +0100

    python: Release Python GIL while running libguestfs calls.
    
    Release the Python global interpreter lock while running libguestfs
    calls.
    
    We don't release it around guestfs_create() because that is a short
    call that just allocates memory.  We do release it around
    guestfs_close() since that is a potentially long-running (it can call
    wait(2) amongst other things).  We also release it around all the
    other generated Python calls.
    
    We don't yet support callbacks into Python code (ie. the new event
    API).  But when we do in future, we will need to also handle the GIL
    around those callbacks.
    
    This code is adapted from libvirt's python/typewrappers.h.  Thanks to
    Dan Berrange for showing us how to do this properly.

commit a3cce465570bf192e993a67feedfbab7e662c75a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 16 21:35:11 2011 +0100

    fish: --rw option will be mandatory in 1.12 not 1.10.

commit 4c2bb8b301970e8853a8feaa95e3698224640fba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 16 21:26:15 2011 +0100

    fish: Fix typo in guestfish man page (--format option).

commit 34d9fed24ad6a2d2e13bb817820e31373f6756e1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 16 21:12:53 2011 +0100

    inspector: Refresh the virt-inspector(1) manpage.

commit 5d139fa8a4a7f9ff65e7b936fd7376f661c72f48
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 16 15:29:58 2011 +0100

    run script: Don't depend on libtool being installed.
    
    Also use 'exec' to run the program.

commit 79f5720d2ccab820c90b7516f3fbf5e3dcbe9c8f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 16 14:57:33 2011 +0100

    Version 1.11.1.

commit 340ff70c1e28aa0ceb2f45918dabafc8fd7134d3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 16 14:56:38 2011 +0100

    Add images/guestfs-aux/fedora-packages.db{,.txt} to EXTRA_DIST.
    
    This updates commit d95874db3dc6c415061b86275d03770b4f28ffbb.

commit 33a2c184e12c0bdbf061a9f36c87d76c28444712
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 16 07:28:47 2011 +0100

    Remove local LIBGUESTFS_PATH detection from guestfish and guestmount.
    
    Remove the hack that let you run ./fish/guestfish or
    ./fuse/guestmount.  You now have to do:
    
      ./run ./fish/guestfish
    or
      ./run ./fuse/guestmount
    
    to run these programs without installing.

commit 5790f5bfafb12cc2ed9365461bf66e0fdfde7150
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 15 21:43:20 2011 +0100

    Remove ad-hoc run*locally scripts, replace with './run'
    
    Remove all the run*locally scripts and replace with a single top level
    ./run shell script.

commit 0108d7861d4cc9a1f0d87d89080d1be7750e54b5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 14 18:19:04 2011 +0100

    inspector: Handle write failures when creating example-*.xml.

commit 67493bfca44d436143d825b155bf2bc38990ea82
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 14 18:17:43 2011 +0100

    Delete file so db_load doesn't run incrementally.
    
    It turns out that db_load incrementally updates the database (instead
    of writing a new one).  Remove the old database to force db_load to
    write a new one.
    
    This also ensures that we handle write failure gracefully.

commit 36d3a4ce53317b104d48b60c9fe1ed679065d1d4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 14 17:58:51 2011 +0100

    inspector: Include <hostname> in output.

commit d95874db3dc6c415061b86275d03770b4f28ffbb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 14 17:53:48 2011 +0100

    inspect: Get version and release of RPM packages.
    
    This commit downloads the Packages RPM database allowing us to find
    other details about installed RPM packages (via
    inspect-list-applications).  This adds version and release.  Epoch
    cannot yet be found.
    
    This commit also updates the Fedora example image so that it contains
    a dummy RPM Packages database with some data.

commit a986e8dadb0c70634f6d1d89dd3e7bb5d9af3078
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 14 13:28:02 2011 +0100

    inspect: Abstract out db_dump code for listing RPM applications.
    
    There are two changes here:
    
    (1) The code for listing RPM applications ran db_dump and parsed the
    output.  We abstract out that parsing code into a separate reusable
    module (src/dbdump.c).
    
    (2) The old db_dump parsing code used db_dump -p (printable) format.
    Instead use db_dump -k (hex) format so we can read binary fields.

commit 3336b5448f12c9eb25bf7a0cecda1315c4cf07ea
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 13 23:27:05 2011 +0100

    inspect: Split code into separate files.
    
    The src/inspect.c file had grown rather large -- 3,500 lines.  Split
    it across several files according to function.
    
    This is just moving code.
    
    After the split the files are more evenly divided:
    
      536 src/inspect_apps.c
      766 src/inspect.c
      537 src/inspect_fs.c
      404 src/inspect_fs_cd.c
      785 src/inspect_fs_unix.c
      535 src/inspect_fs_windows.c
     3563 total

commit 439a42efdb052748c8457f866b2c68a581034826
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 13 23:02:45 2011 +0100

    inspect: Move shared PCRE match functions to separate file.
    
    This is just moving code around.

commit 3c1f762abed92f7a358f3bc93e3396d0606b18ad
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 13 22:35:35 2011 +0100

    inspect: Cache downloaded files in the handle g->tmpdir.
    
    During inspection we download various files such as the Windows
    'software' and 'system' registries.  Previously these were downloaded
    as temporary files and discarded immediately after use.  This meant
    that the 'software' registry was being downloaded twice by
    virt-inspector (it's required once for basic OS inspection, and a
    second time to list Windows applications).
    
    This commit changes this so that these files are cached in g->tmpdir,
    and thus the second time we just reuse the file we've already
    downloaded.
    
    Callers shouldn't be relying on inspect-list-applications to reread
    the actual registry from the VM (unless you close and reopen the
    handle).  It says in the documentation that the results of inspection
    may be cached in the handle.

commit 70975981bed8e0c01b5966c10b507bb82086e5f8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 13 22:02:08 2011 +0100

    Remove temporary directory containing arbitrary files.
    
    In preparation for caching inspection information in the temporary
    directory (g->tmpdir), allow the temporary directory to contain
    arbitrary files, and remove all of them when the handle is closed.
    
    This just generalizes the previous method of cleaning up the tmpdir.

commit 6740028b333840eec5e8e46e8512f8155728b037
Author: Jim Meyering <jim@meyering.net>
Date:   Wed Apr 13 15:17:32 2011 +0200

    Include string.h and libintl.h, as needed.
    
    * df/df.c: As above.
    * df/main.c: As above.
    * df/output.c: As above.
    * fuse/guestmount.c: As above.
    * inspector/virt-inspector.c: As above.
    * rescue/virt-rescue.c: As above.

commit ace1795d1045be96f92a68e6b61ffdee60431fef
Author: Jim Meyering <jim@meyering.net>
Date:   Wed Apr 13 13:15:39 2011 +0200

    Add more missing include directives.
    
    * cat/virt-cat.c: Include string.h and libintl.h.
    * cat/virt-filesystems.c: Likewise.
    * cat/virt-ls.c: Likewise.

commit 173c374bd01e84deafdaf1f9aa65b0f623e86470
Author: Nikita A Menkovich <menkovich@gmail.com>
Date:   Wed Apr 13 12:41:27 2011 +0100

    debian: Add dependency on libpcre-ocaml-dev.

commit 0db662eae54b21fccadabe817afbc0fa89d980b2
Author: Jim Meyering <jim@meyering.net>
Date:   Wed Apr 13 13:00:06 2011 +0200

    Add missing include directives.
    
    * fish/config.c: Include string.h, for use of strlen.
    * fish/keys.c: Likewise, but for use of memcpy.
    * fish/man.c: Likewise, but for use of memset.

commit a53833fdd21cd573fe8fd02d7a11a3a5e9764ce0
Author: Jim Meyering <jim@meyering.net>
Date:   Wed Apr 13 11:11:42 2011 +0200

    Avoid warning about implicit declaration of strlen.
    
    * src/events.c: Include <string.h>, for use of strlen.

commit 6ec2ed20cbbad871a8b48389cbe5785bb929c99f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 12 22:45:39 2011 +0100

    debian: libguestfs-test-tool-helper no longer exists.

commit 0d9f2c7311b005b2cfe2ecb3ff9fb57d4576ef7b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 12 22:45:18 2011 +0100

    resize: Include stamp file for manpage in CLEANFILES.

commit 6e635ac015d94e1d3c624579984eca9ebd8a4662
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 12 20:14:51 2011 +0100

    Version 1.11.0.

commit 189a2f3075aa7073b608409382bd55cfa375f458
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 12 19:36:25 2011 +0100

    Update RELEASE-NOTES for 1.10 release.

commit 30479a1190b2f1c2526301fd63182481b1dd6ad8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 12 19:36:00 2011 +0100

    Update ROADMAP for 1.12 and beyond.

commit 9e56040cd3169da1321ba9672d0f32910c883a89
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 12 19:35:27 2011 +0100

    README: virtio-serial is required.

commit 62f9e408b4da415448178ad81bf4b2f4e51361b0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 12 18:49:31 2011 +0100

    guestfs(3): Fix documentation for drive letters.
    
    We can now get drive letter mappings through the inspection API.

commit 88ff38dab607f7218756ce87e014c0e699e162f8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 12 18:05:35 2011 +0100

    inspect: Fix some small memory leaks in Windows inspection.
    
    Found using valgrind.

commit 11374abeadfb01252bdb02c0915d1edc79512e79
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 12 17:03:14 2011 +0100

    fish: Allows win:... paths to work with drives mounted anywhere.
    
    This allows you to mount disks on (eg) /c and /e and have the
    guestfish win:... path mechanism map drive letters to the
    right places.

commit c2c755440bceed92ca40a929f4dfe343d3265e2b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 11 12:33:21 2011 +0100

    todo: guestfish drive letters.

commit cde0c0c05741476e748586a59f3470e8bc211718
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Apr 10 21:10:19 2011 +0100

    resize: Update dependencies.

commit d600d53868237e0f2828a912d9672dbd480e315f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Apr 10 20:42:42 2011 +0100

    resize: Don't build this directory in parallel.

commit a6cb8fee205b1615d380456964bebe40bd840fb1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Apr 10 11:12:03 2011 +0100

    resize: Consistent use of 'part' in help output.

commit 61a42ff551073daf345bd03941797e6af1e97128
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Apr 10 11:06:58 2011 +0100

    resize: Missing \n after version.

commit 047173d18683a66cbe8949bc114833984898fed6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 9 22:50:15 2011 +0100

    resize: Link with local copy of guestfs.

commit ee212deef690c6bc0bae307a5566b97f49445aaf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 9 17:11:57 2011 +0100

    Version 1.9.18.

commit de4f5f2fe31804f2be3c4ec749374bb39ff9ab97
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 9 19:55:05 2011 +0100

    Update POT file.

commit d8818f6cb97891a1ffba23a775ad096572a486e0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 9 18:01:11 2011 +0100

    Include po/Makefile.in.in in git, to avoid needing to rerun gettextize.

commit b60a01f9a38f9358672e36e665e045fb85eb081c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 9 21:11:47 2011 +0100

    build: virt-resize manpage.

commit ca03635a4c83afbe9b51fe846a8b3d5361462a90
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 8 14:07:26 2011 +0100

    Rewrite virt-resize in OCaml.
    
    This is a fairly straightforward translation of Perl virt-resize into
    OCaml.  It is bug-for-bug and feature-for-feature identical to the
    Perl version, except as noted below.
    
    The motivation is to have a more solid, high-level, statically safe
    compiled language to go forwards with fixing some of the harder bugs
    in virt-resize.  In particular contracts between different parts of
    the program are now handled by statically typed structures checked at
    compile time, instead of the very ad-hoc unchecked hash tables used by
    the Perl version.
    
    OCaml and the ocaml-pcre library (Perl-Compatible Regular Expressions
    bindings for OCaml) are required.
    
    Extra features in this version:
    
    - 32 bit hosts are now supported.
    
    - We try hard to handle the case where the target disk is not "clean"
      (ie. all zeroes).  It usually works for this case, whereas the
      previous version would usually fail.  However it is still
      recommended that the system administrator creates a fresh blank disk
      for the target before running the program.
    
    - User messages are a bit more verbose and helpful.  You can turn
      these off with the -q (--quiet) option.
    
    There is one lost feature:
    
    - Ability to specify >= T (terabytes) sizes in command line size
      expressions has been removed.  This probably didn't work in the Perl
      version.
    
    Other differences:
    
    - The first partition on the target is no longer aligned; instead we
      place it at the same sector as on the source.  I suspect that
      aligning it was causing the bootloader failures.
    
    - Because it's easier, we do more sanity checking on the source disk.
      This might lead to more failures, but they'd be failures you'd want
      to know about.
    
    - The order in which operations are performed has been changed to make
      it more logical.  The user should not notice any functional
      difference, but debug messages will be quite a bit different.
    
    - virt-resize is a compiled binary, not a script.

commit 3a84e0784e1e3ab7b56850d0f8c9aa42f1ae3da1
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Apr 7 15:30:54 2011 +0100

    Compile rpcgen-generated files with -fno-strict-aliasing
    
    rpcgen generates source which can't be safely compiled with strict-aliasing
    enabled.

commit 6ea263b1f141614e7693a38b13e8f368237760a2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 6 19:45:46 2011 +0100

    test-tool: Don't use static binary helper program, nor ISO.
    
    This simplifies the libguestfs-test-tool program down to essentials.
    Bugs most commonly occur when starting the appliance, so what we
    should concentrate on test is just that.
    
    Previously the test tool built a special static binary helper program,
    packaged it up in an ISO, then ran this inside the appliance.  None of
    this really tested useful failure modes, but they did make the test
    tool itself harder to build, harder for users to run, and more
    brittle.
    
    This change also adds some more debugging of libguestfs state.

commit cbc6b720a4e58d32b6089db05288f4a468742b47
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Apr 6 11:52:20 2011 +0100

    Update RELEASE-NOTES file.

commit 872e67ffdf6c7b19782514445d13e8f405e435c1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 5 21:24:51 2011 +0100

    Version 1.9.17.

commit 5141c8fc02d0d20c0eaffb5de2ed8e4164fe2a94
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 5 19:44:16 2011 +0100

    fish: copy-in, copy-out, edit, more commands can use win:... prefix.

commit b8be128caa27fa5e1636e9e4caff3e23a6dc761f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 5 19:43:30 2011 +0100

    fish: Enhance guestfish win:... parsing to understand drive letters.

commit ade2f824509c5399e60ddab7db2b618aaf8db0aa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 5 18:23:39 2011 +0100

    edit: Allow Windows-style drive letters and paths to be used.

commit 13d8963d8c0203e1f72c519e5acf79ebf7cccb4c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 5 14:03:08 2011 +0100

    New API: inspect-get-drive-mappings
    
    This returns the drive mappings from the Windows Registry.
    
    virt-inspector displays the drive mappings, giving output
    similar to this:
    
      <drive_mappings>
        <drive_mapping name="C">/dev/sda2</drive_mapping>
        <drive_mapping name="E">/dev/sdb1</drive_mapping>
      </drive_mappings>

commit 9e7c6a548353bde925c16434711bcc6208038d83
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 5 12:44:34 2011 +0100

    New API: inspect-get-windows-current-control-set
    
    This returns the actual registry key corresponding to
    CurrentControlSet (eg. it might be "ControlSet001").
    
    Previously the inspection code was hard-coding ControlSet001.  Now we
    use the correct control set, and also make it available to callers
    through the API.
    
    This commit also updates the virt-dhcp-address example so it uses this
    new API.
    
    virt-inspector displays the current control set when available.

commit 9b945cfa781a0f25c3b81239e2fcddceeede6e44
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 5 19:42:00 2011 +0100

    daemon: Reimplement 'mounts' and 'mountpoints' commands.
    
    Reimplement these so they read /proc/mounts instead of trying to parse
    the output of the 'mount' external command.
    
    One consequence of this is that these commands now work again for
    ntfs-3g filesystems.

commit f3eea44f97340f747e46b0df6931a04b53abaf01
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 5 18:44:55 2011 +0100

    Rename resolve_windows_path_silently to case_sensitive_path_silently.
    
    A more accurate description of what this function does.
    
    This is just code motion.

commit 60cdf446063a0ae61c52140355677d7da2327fa2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 5 17:46:23 2011 +0100

    edit: Move 'exit 0' to end of file.
    
    This is just code motion.

commit aed8f220d279e910e0f398fea6fa674cc6a63783
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 5 17:45:41 2011 +0100

    edit: Let $root == $roots[0].
    
    This is just code motion.

commit 4de124debf181ff6af38617b80c2355627e38d35
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Apr 5 17:44:41 2011 +0100

    cat, edit: Reference guestfish equivalent commands in the manual pages.

commit afa17809599f3ebc82c3feef025ca812fb26c9fe
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Apr 4 12:48:02 2011 +0100

    python: Convert any iterable argument to a list (RHBZ#693324).
    
    Thanks to Erez Shinan.

commit 8e61d636bb621e5e2bf6a2f4eb95329ceb2b9890
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 2 22:32:36 2011 +0100

    fish: Add 'pulse mode' to the progress bar.

commit 8629149baa3f1636f88665111beb457d39411fd2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 2 22:31:41 2011 +0100

    fish: Move variable decls to top of function.
    
    This is just code motion.

commit e16d486fa7e49b3638d9c76920b76dc4248b5e81
Author: Nikita A Menkovich <menkovich@gmail.com>
Date:   Sat Apr 2 11:05:19 2011 +0100

    debian: Add missing deps: ocaml-findlib, libstring-shellquote-perl.

commit 5eaffede90d454a9d6542331a77e3a88928705e3
Author: Nikita A Menkovich <menkovich@gmail.com>
Date:   Sat Apr 2 11:04:47 2011 +0100

    mkisofs is obsolete.  Require genisoimage everywhere instead.

commit bbaea1d03acc6f05a52dec11decb9668c9c82912
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Apr 2 09:14:41 2011 +0100

    Pull translations from Transifex.
    
    New Ukrainian po-docs translation added.

commit 8bb22a2902fc723eb809086dd93f5b8ed2ec85b1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 1 20:37:01 2011 +0100

    Version 1.9.16.

commit 9b60f3a9f3b38c085e9265e56ddb839dabe6e416
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 1 16:03:14 2011 +0100

    du: Add pulse mode progress messages.

commit e9feff6f4ca75a7c457927c93ae7f719694b86c7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 1 18:37:29 2011 +0100

    cpmv: Add pulse mode progress messages.

commit 4a64a5a285877df58cd303194735f7414e11e7f3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 1 18:37:39 2011 +0100

    checksum: Add pulse mode progress messages.

commit 40f7323134e058c0920caa18c667ea99a4c8b3e8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 1 15:50:33 2011 +0100

    daemon: Introduce "pulse mode" progress events.
    
    This introduces a new form of progress event, where we don't know how
    much of the operation has taken place, but we nevertheless want to
    send back some indication of activity.  Some progress bar indicators
    directly support this, eg. GtkProgressBar where it is known as "pulse
    mode".
    
    A pulse mode progress message is a special backwards-compatible form
    of the ordinary progress message.  No change is required in callers,
    unless they want to add support for pulse mode.
    
    The daemon sends:
    
     - zero or more progress messages with position = 0, total = 1
     - a single final progress message with position = total = 1
    
    Note that the final progress message may not be sent if the call fails
    and returns an error.  This is consistent with the behaviour of
    ordinary progress messages.
    
    The daemon allows two types of implementation.  Either you can just
    call notify_progress (0, 1); ...; notify_progress (1, 1) as usual.
    
    Or you can call the functions pulse_mode_start, pulse_mode_end and/or
    pulse_mode_cancel (see documentation in daemon/daemon.h).  For this
    second form of call, the guarantee is very weak: it *just* says the
    daemon is still capable of doing something, and it doesn't imply that
    if there is a subprocess that it is doing anything.  However this does
    make it very easy to add pulse mode progress messages to all sorts of
    existing calls that depend on long-running external commands.
    
    To do: add a third variant that monitors a subprocess and only sends
    back progress messages if it's doing something, where "doing
    something" might indicate it's using CPU time or it's printing output.

commit 6e5f64089631622167e60df25ee009ef83df5170
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 1 15:27:46 2011 +0100

    daemon: When running commands, restart select if we receive a signal.

commit 42938f6faf9e724130be28f8e67d3c291bb81cba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 1 15:26:46 2011 +0100

    daemon: Reset SIGPIPE to default before running subprocesses.

commit 371eabfae3790588ed97c0017d2882799c7ea871
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 1 13:30:48 2011 +0100

    Generate progress messages during launch.
    
    This commit generates approximate progress messages during the
    guestfs_launch call.  Currently this code generates:
    
       0 / 12: launch clock starts
       3 / 12: appliance created
       6 / 12: detected that guest kernel started
       9 / 12: detected that /init script is running
      12 / 12: launch completed successfully
    
    (Note this is not an ABI and may be changed or removed in a future
    version).
    
    Progress messages are only generated at all if 5 seconds have elapsed
    since the launch, and they are only generated for the ordinary
    appliance (not if using attach-method to attach to an existing virtio
    serial port).

commit 02971adc3b0f07f3820d0c5e973fabf16d16deb3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 1 13:29:06 2011 +0100

    protocol: Sleep for 1ms before reading log messages.
    
    As explained in the comment:
    
      /* QEMU's console emulates a 16550A serial port.  The real 16550A
       * device has a small FIFO buffer (16 bytes) which means here we see
       * lots of small reads of 1-16 bytes in length, usually single
       * bytes.  Sleeping here for a very brief period groups reads
       * together (so we usually get a few lines of output at once) and
       * improves overall throughput, as well as making the event
       * interface a bit more sane for callers.  With a virtio-serial
       * based console (not yet implemented) we may be able to remove
       * this.  XXX
       */

commit 1bf970cb0e7fc0f9d8c10b567c6c7b4a66e43c17
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 1 12:17:22 2011 +0100

    Shared function to send progress messages.
    
    This is just code motion.

commit 1e6be6afe58de5bfb1ac056b80d3210888edfead
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 1 13:30:24 2011 +0100

    Add prototype for timeval_diff.
    
    This is just code motion.

commit 05dbe09a5c5be3d5f68dc6eb033c4f642fbac8bf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 1 13:54:18 2011 +0100

    docs: Progress messages don't necessarily reach 100% in the error case.
    
    This should be obvious, and now it is documented to avoid any
    confusion.

commit 94945d84c71703adc210793897e1a269a38945f2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 1 13:48:14 2011 +0100

    docs: Fix link to progress messages in guestfs(3).
    
    This updates commit 4e0cf4dbf8a8a96288f70114fdc3939da0aa7ad1.

commit 50e59c237081b2bda36e5a04ecdf446a7fc3ec4c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 1 15:28:42 2011 +0100

    Update copyright date on main guestfs(3) man page.

commit 2c082c5d681c9e0e76d0aad0345df3781d1aa8f1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 1 09:53:53 2011 +0100

    Version 1.9.15.

commit decda45734563d4f7d61355dcaf9318091250f37
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 1 09:53:44 2011 +0100

    fish: Fix incorrect path passed to perror.
    
    Fix commit b8e1dee73a1deef1bfd5937e2abfbe9afef7b1ef.

commit b5130936d870321d8dc28e4369122bd437cab89a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 1 08:50:49 2011 +0100

    Add libguestfs-tools.conf file to EXTRA_DIST.

commit 97d737a88b33d3df97ceacb026b29b1656604a8d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 31 20:20:04 2011 +0100

    examples: Add virt-dhcp-address program.
    
    This is like the mythical 'virt-ifconfig'.  There is not enough
    certainty around the right way to be doing this for us to make
    a full virt tool for this.  Therefore the code is just an example.

commit b41e73008a939ef493d2bfb82c9bd07b0f74736a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 31 20:18:23 2011 +0100

    examples: Use WARN_CFLAGS, WERROR_CFLAGS macros instead of -Wall

commit d5eb5216aae0cb83fae686f490d1c3c37c2c074e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 31 20:17:02 2011 +0100

    examples: size_t-correctness change in inspect_vm.c

commit 1612201a83e732eec7d98d1679dd9dd426bcd10d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 31 18:20:08 2011 +0100

    contrib: Fix URLs in README file.

commit 64bc4495031a1942472038db7aee0bf3b746949d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 31 15:51:00 2011 +0100

    inspect: Detect 32 bit applications running on WOW64 emulator (RHBZ#692545).
    
    These applications are located along a different Registry path.  See
    http://support.microsoft.com/kb/896459 for all the details.
    
    Thanks Jinxin Zheng for finding the bug and the solution.

commit b8e1dee73a1deef1bfd5937e2abfbe9afef7b1ef
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 30 17:03:11 2011 +0100

    Add /etc/libguestfs-tools.conf configuration file.
    
    This allows the default for --ro or --rw to be controlled for the
    three tools guestfish, guestmount and virt-rescue.

commit 4155d20014b24b2203c4dd8b00e2e19450a7e3bb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 30 16:33:14 2011 +0100

    rescue: Add -w|--rw option.

commit 3824935411e8a046f0359578978447dd5a0a1a16
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 30 16:32:33 2011 +0100

    fuse: Document -w flag in --help output.

commit 58f7a5a4ac8cce77dfaded1c29f3ad382b4cc9a8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 29 16:07:21 2011 +0100

    Exclude po-docs directory completely if po4a not available.
    
    Lift the if HAVE_PO4A ... endif completely out of the po-docs
    subdirectory, and just exclude the whole subdirectory if the po4a
    program is not available.

commit edb7501d60a03107c21f023b256d2b01cf116437
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 29 16:03:29 2011 +0100

    tests: Don't fail when compiled without support for NTFS.

commit 759f4369de965f46f4a93b3a75dada050f87e223
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 29 12:20:57 2011 +0100

    perl: Canonicalize /dev/vd* paths in old inspection code (RHBZ#691724).

commit d82d6f0633f63d4a884147b1e85851e96ff8f58d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 28 17:18:24 2011 +0100

    README: Note that getfacl, getfattr are optional dependencies.

commit c3fc40d0c5b5b4667137d07aaecefe8554b90f1b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 28 17:11:51 2011 +0100

    Version 1.9.14.

commit 0d6fd9e1d2488841c912c5351086e536772837ef
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 28 14:45:23 2011 +0100

    fuse: Fix getxattr, listxattr calls and add a regression test (RHBZ#691389).
    
    The documentation for the getxattr and listxattr calls is not very
    clear and as a result we were always returning something different
    from that which the Linux kernel would usually return.
    
    This fixes these calls, at least far enough that both the 'getfattr'
    and 'getfacl' programs now work fine on FUSE-mounted filesystems.
    
    Note that SELinux attrs are *not* passed through.  This appears to be
    a known bug between SELinux and FUSE.  For more information see:
    
    http://www.spinics.net/lists/selinux/msg09460.html

commit 4e529e06a4500959cd783f5029354fea47a253a6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 28 13:35:53 2011 +0100

    fish: fuse: Add -m dev:mnt:opts to allow mount options to be specified.
    
    This lets you turn on ACLs and xattrs by doing:
    
      -m /dev/sda1:/:acl,user_xattr
    
    The extra parameter is passed through to mount_options:
    
      libguestfs: trace: mount_options "acl,user_xattr" "/dev/sda1" "/"

commit feaddb062afcab9117215b4c2188f63d8b647b99
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 28 10:35:14 2011 +0100

    roadmap: Move QMP to 'beyond 1.10'.
    
    See: https://www.redhat.com/archives/libguestfs/2011-March/msg00124.html

commit b8724e23520563606aa15096a50f9964bd2e930a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 28 10:32:14 2011 +0100

    Open release notes for version 1.10.0.

commit e751293e10d5ecbb2ef43a61b9c153a1fc4f0304
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 28 10:03:16 2011 +0100

    ruby: Don't segfault if callbacks throw exceptions (RHBZ#664558).
    (Thanks Chris Lalancette).
    
    See:
    https://bugzilla.redhat.com/show_bug.cgi?id=664558#c6

commit a0e3b2183733c7440ad017c4ffe361935672339b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 25 14:42:40 2011 +0000

    RHEL 5: Use mke4fs on RHEL 5 as replacement for mke2fs.

commit 227bea6c7ef89b707fe2c01c4d0d0fb9081e8c04
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 25 14:34:31 2011 +0000

    mkfs: Force mke2fs to create a filesystem even on raw IDE device (RHBZ#690819).

commit 110bfe1fcc9964b82acf7df6d4d60774471f9157
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 25 12:32:08 2011 +0000

    Rename $tmpdir/sock to $tmpdir/guestfsd.sock.
    
    No functional change; this simply makes the purpose of the
    socket clearer.

commit 23b7c92b0dab43c6feaa137eaf46260f28cdc1f1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 25 11:22:38 2011 +0000

    inspector: Add detection of Slackware.

commit 652a1052373b4d6a6a43ab5e59aeb8db8e2bb284
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 24 12:23:13 2011 +0000

    Version 1.9.13.

commit 3f1e3223c491aa057d02c1da418ed896d09fff7c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 23 16:00:48 2011 +0000

    New API: guestfs_inspect_get_product_variant
    
    This returns a product variant for inspected operating systems.  In
    practice this is a useful way to distinguish between consumer and
    enterprise/server versions of Windows that otherwise have the same
    version number.

commit 0daf7e81a659bcdc1ce327151cc1207b124a35a1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 22 11:50:26 2011 +0000

    fish: Add better quick help to --help output.

commit c8faa5d0b0a17689d27bd33bc787ba0fe9a3f076
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 22 11:50:03 2011 +0000

    fish: Add -w|--rw option to --help output.

commit d06fee159c14d4fe7654a02bae8849c4f82565f8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 22 11:20:38 2011 +0000

    inspect: Don't fail for Windows guests with multiple disks (RHBZ#674130).

commit 5776c145d411e5ae00072ecf422055f3d0bd29e2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 22 11:05:21 2011 +0000

    inspect: Simplify Windows root heuristic code.
    
    Add special is_file_nocase and is_dir_nocase functions and
    remove the duplicate checks for files and directories with
    different cases.

commit 490560439061398d47873484a55fb823be29b285
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 22 11:15:21 2011 +0000

    umount-all: Use /proc/mounts instead of output of 'mount' command.
    
    The particular issue is that ntfs-3g (or FUSE?) no longer appears
    to update /etc/mtab, which meant that umount-all was not unmounting
    these partitions.  But parsing /proc/mounts is simpler and more
    robust in any case.

commit 1541f3a564f8ff14c1a63298120e4dc618ea3274
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 19 18:41:23 2011 +0000

    guestfs(3): 'kernel' -> 'supermin appliance'.

commit cf6f380c544456ee3e84fd41a480ea4cab3d94dd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 19 18:18:56 2011 +0000

    guestfs(3): Indent line to keep code together.

commit c6f45c897575dfc3df63cce1f79ba5456ae6c5f7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 19 12:40:24 2011 +0000

    todo: Add ntfsck.

commit c6310bd242ddaa7b0801df9da7e4fba7346dc53e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 18 20:02:29 2011 +0000

    fish: Add all stamp-*.pod files to CLEANFILES.

commit ec16f13e70111402ab13ddd7dacdcb5270f79342
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 18 19:33:06 2011 +0000

    Version 1.9.12.

commit f4d996fd26762053d68f46de5790aae893f03d38
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 18 18:27:21 2011 +0000

    proto: Fix both-ends-cancel case.
    
    In the case where both ends cancel at the same time (eg. both ends
    realize there are errors before or during the transfer), previously we
    skipped sending back an error from the daemon, on the spurious basis
    that the library would not need it (the library is cancelling because
    of its own error).
    
    However this is wrong: we should always send back an error message
    from the daemon in order to preserve synchronization of the protocol.
    
    A simple test case is:
    
      $ guestfish -N fs -m /dev/sda1 upload nosuchfile /
      libguestfs: error: open: nosuchfile: No such file or directory
      libguestfs: error: unexpected procedure number (66/282)
    
    (Notice two things: there are errors at both ends, and the
    loss of synchronization).
    
    After applying this commit, the loss of synchronization does not occur
    and we just see the library error:
    
      $ guestfish -N fs -m /dev/sda1 upload nosuchfile /
      libguestfs: error: open: nosuchfile: No such file or directory
    
    The choice of displaying the library or the daemon error is fairly
    arbitrary in this case -- it would be valid to display either or even
    to combine them into one error.  Displaying the library error only
    makes the code considerably simpler.
    
    This commit also (re-)enables a test for this case.

commit 33b638109ed66ea360b53b80b1f407b3a5f5ec39
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 18 17:17:30 2011 +0000

    proto: Fix FileIn ops that abort during the chunk upload stage.
    
    As a previous, incorrect attempt to fix RHBZ#576879 we tried to
    prevent the daemon from sending an error reply if the daemon had
    cancelled the transfer.  This is wrong: the daemon should send an
    error reply in these cases.
    
    A simple test case is this:
    
      guestfish -N fs -m /dev/sda1 upload big-file /
    
    (This fails because the target "/" is a directory, not a file.)
    Prior to this commit, libguestfs would hang instead of printing an
    error.  With this commit, libguestfs prints an error.
    
    What is happening is:
    
      (1) Library is uploading
      a file                          (2) In the middle of the long
                                      upload, daemon detects an error.
                                      Daemon cancels.
      (3) Library detects cancel,
      sends cancel chunk, then waits
      for the error reply from the
      daemon.                         (4) Daemon is supposed to send
                                      an error reply message.
    
    Because step (4) wasn't happening, uploads that failed like this would
    hang in the library (waiting for the error message, while the daemon
    was waiting for the next request).
    
    This also adds a regression test.
    
    This temporarily breaks the "both ends cancel" case (RHBZ#576879c5).
    Therefore the test for that is disabled, and this is fixed in the next
    patch in the series.
    
    This partially reverts commit dc706a639eec16084c0618baf7bfde00c6565f63.

commit c7368ce167d6dbfd3e69ba208301c5af3f17a8a1
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Mar 18 16:18:37 2011 +0000

    proto: Don't drop outgoing message when daemon cancels (RHBZ#576879).
    
    This is a (potential) fix for the long standing protocol bug
    which causes loss of synchronization when a FileIn action
    fails very early on the daemon side.  The canonical example
    would be the 'upload' action failing immediately if no filesystem
    is mounted.
    
    What's supposed to happen is this:
    
      (1) library sends
      request message              (2) daemon processes request
      first chunk of data          and sees that it will fail,
                                   sends cancellation
                                   (3) discards chunks of data
      (4) library sees daemon
      cancellation and stops
      sending chunks
    
    It was going wrong in step (1), in guestfs___send_to_daemon.
    In some (timing related) circumstances, send_to_daemon could
    receive the cancellation before sending the first chunk, at
    which point it would exit, *discarding the first chunk*.
    This causes the daemon to fail in step (3) since it reads the
    next request as if it was a chunk, thus losing synchronization.
    (The protocol specifies that you always have to send at least
    one chunk if there is a FileIn or FileOut parameter).
    
    The patch changes guestfs___send_to_daemon so that if it detects
    cancellation, it sends the remaining data in its output buffer
    instead of discarding it.  (This also fixes another edge case
    to do with sending partial data although I don't think we
    ever saw that in practice).

commit 7fb25f53f836172376c25b405b5f88f4ec37eed8
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Mar 18 16:17:09 2011 +0000

    daemon: Improve protocol debug messages.
    
    This adds 'guestfsd: ...' prefix before each message, and
    also puts a message at the top of the main loop just after
    a new message has been received.
    
    The intent is to make it simpler to follow the protocol.

commit dc8e4b057ecd3984d7c27c8ece54048b6a06d662
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 18 11:22:25 2011 +0000

    regressions: Enable both tests for bug 576879 (not fixed).

commit 1e68f84c5a46f3ff650368a897bd4113bd3f4aea
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 18 11:21:55 2011 +0000

    daemon: Print error for invalid chunk.cancel field.
    
    The chunk.cancel field should always be [0|1].  If it is not then
    something has gone badly wrong -- probably loss of synchronization.
    If this occurs print a debug message and return error from
    receive_file function.

commit 65852011d8f5150c5c0bcbfeac90e2fd784905c5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 18 11:20:26 2011 +0000

    proto: Improve debug messages.

commit 502a98948c1bade2969758aff3db09869481105a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 18 11:19:31 2011 +0000

    haskell: Small fixes for ghc 7.

commit e34fc32092e18b38282306558dcef66263a0fb10
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 17 12:46:57 2011 +0000

    regressions: Rename the file we are uploading too.
    
    This updates commit cbd8da6d4dd2e4cbc3b87fbc7cb7d6129eb69172.

commit cbd8da6d4dd2e4cbc3b87fbc7cb7d6129eb69172
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 17 11:57:40 2011 +0000

    regressions: Split the test rhbz576879.sh into two halves.
    
    We suspect that there are in fact two separate bugs.  In any
    case it makes sense for the two tests to be done separately.
    
    Note that these tests still fail.

commit eb6119da38ed98f9fe902401614c2d14ed20bb2e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 16 11:50:16 2011 +0000

    tests: Ignore return value from fwrite.

commit 6bb4d13d718d17ee89602acb97c46bc4d4a38d02
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 15 21:49:53 2011 +0000

    Version 1.9.11.

commit 7160ad148b2947735143f3e06d53fa732ff659ec
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 15 22:00:54 2011 +0000

    ruby: Missing files from EXTRA_DIST.

commit 883390fb2e8cdaf81223eb41c87f245571e3d63d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 15 16:46:00 2011 +0000

    perl: Binding and test for guestfs_last_errno (RHBZ#672491).

commit cf26ef818e918c8c32658399e8aa9e31289109a7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 15 15:00:58 2011 +0000

    ruby: Use ALLOC_N to avoid potential memory leak (RHBZ#667610).

commit c50ed37b71a50b2570a3b16a82a9d73e026be739
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 15 14:52:03 2011 +0000

    ruby: Remove unnecessary checking around StringValueCStr (RHBZ#667610).

commit e9f25e693e3211b0219d84f956dcd3d164bac9d3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 15 14:48:12 2011 +0000

    ruby: Add rdoc documentation (RHBZ#667610).

commit 6a64114929a0b098f5a1e31e17e7802127925007
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 14 22:37:21 2011 +0000

    New event API - Ruby bindings (RHBZ#664558).

commit bc468c87d04b34faacd208c49cca4a5096e5103c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 14 19:42:47 2011 +0000

    New event API - Perl bindings (RHBZ#664558).
    
    The methods $h->set_progress_callback and $h->clear_progress_callback
    have been removed, and replaced with a complete mechanism for setting
    and deleting general-purpose events.
    
    This also updates virt-resize to use the new API.

commit 7e51cc94ddb7527b37111d6fecce96dca14b900a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 14 16:44:17 2011 +0000

    New event API - OCaml bindings (RHBZ#664558).
    
    The functions set_progress_callback and clear_progress_callback have
    been removed, and replaced with a complete mechanism for setting and
    deleting general-purpose events.

commit 4e0cf4dbf8a8a96288f70114fdc3939da0aa7ad1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 10 12:32:22 2011 +0000

    New event API (RHBZ#664558).
    
    This API allows more than one callback to be registered for each
    event, makes it possible to call the API from other languages, and
    allows [nearly all] log, debug and trace messages to be rerouted from
    stderr.
    
    An older version of this API was discussed on the mailing list here:
    https://www.redhat.com/archives/libguestfs/2010-December/msg00081.html
    https://www.redhat.com/archives/libguestfs/2011-January/msg00012.html
    
    This also updates guestfish to use the new API for its progress bars.

commit 6d6b7edd1102f8383643866bf358e494e0d518ef
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 14 13:19:47 2011 +0000

    New APIs: guestfs_first_private, guestfs_next_private to walk over
    the private data area.
    
    This commit adds new APIs for walking over the keys and pointers in
    the private data area associated with each handle (note this is only
    applicable to the C API).

commit d1f1f74e5f45fa5b94ebb096fa65fa33ecc23d09
Author: Angus Salkeld <asalkeld@redhat.com>
Date:   Tue Mar 15 22:43:02 2011 +1100

    check the pid is > 0 before calling waitpid()
    
    Signed-off-by: Angus Salkeld <asalkeld@redhat.com>

commit 6f7c1a9f9d76bdf9f112e12e1508531fb41abfb2
Author: Angus Salkeld <asalkeld@redhat.com>
Date:   Mon Mar 14 22:40:12 2011 +1100

    check the pid is > 0 before calling waitpid()
    
    Signed-off-by: Angus Salkeld <asalkeld@redhat.com>

commit eb304e9689ca474834207605ed52c369bcdec6ea
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 11 10:47:05 2011 +0000

    RHEL5: Old pod2man didn't have --stderr or -u options.

commit 97eab125fa8e3dc481c1f1ba1a847cf43d537585
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 11 10:23:58 2011 +0000

    configure: Remove unnecessary variable assignment.
    
    Left over from pre-virtio-serial days.

commit 003fbdfe5d8b237f42f575199b742c8dde9b8a11
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 11 10:22:58 2011 +0000

    RHEL5: Make use of 'futimens' function optional.

commit 15ba6ae17d5272d3d906f4053ed424447dc910bd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 8 16:22:10 2011 +0000

    Version 1.9.10.

commit c1a227a960066fb9552e0c225bc473be365b67b0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Mar 8 08:10:19 2011 +0000

    Detect Red Hat Desktop as 'rhel' distro (RHBZ#682979).
    
    /etc/redhat-release on Red Hat Desktop contains the following
    string:
      Red Hat Desktop release 4 (Nahant Update 8)
    
    Previously we matched against the string "Red Hat Enterprise Linux"
    but since this does not contain that string, this distro wasn't being
    detected correctly.
    
    Note this also changes the obsolete Perl code, for the benefit of
    virt-v2v.

commit a9d6b948b590f58023a97dddd76302e40d49d2e2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 7 19:30:31 2011 +0000

    Include <locale.h> in compilation units that use setlocale function.
    
    Fix required by gcc 4.6.0.

commit 8037da06feea097716ce700f38c0eac0d5411a7c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 7 19:28:30 2011 +0000

    generator: Introduce error code (errcode) concept.
    
    There was a lot of repeated code to map return types (eg. RErr)
    to error cases (eg. -1 or NULL).
    
    This commit introduces an error code type and two functions to
    map return types to error codes and error codes to strings.

commit 7c721e4fd674c409b3eee60fe237d480afa1c5e2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 7 15:55:56 2011 +0000

    Fix trace segfault for non-daemon functions (RHBZ#682756).
    
    Previously we expanded the code for 'trace_return' unconditionally for
    all non-daemon functions.  However this code was not prepared to
    handle all error conditions, and in fact would segfault if it tried to
    print RStringList or RHashtable where r == NULL.
    
    We need to make the code conditional on the return value, calling
    either 'trace_return' or 'trace_return_error' as appropriate.
    
    Note the difficult case for RConstOptString which returns NULL in
    non-error cases.

commit 2a9e345090ceeae5bdab68407bf1133c040c4f45
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 7 10:53:22 2011 +0000

    Fix URL of transifex instance to be the canonical one.
    
    This updates commit 182a2ceae6d6f50448159e24d8b5c0c92f44407f.

commit 182a2ceae6d6f50448159e24d8b5c0c92f44407f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Mar 7 10:45:27 2011 +0000

    Import project into transifex.
    
    http://www.transifex.net/projects/p/libguestfs/

commit 1c772c921186be34331c7610992f57a69d20d908
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Mar 5 09:17:41 2011 +0000

    debian: Rename nilfs2-tools to nilfs-tools.

commit eda9826d25336bcf661700270c580d4d62128750
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 4 12:13:32 2011 +0000

    virt-make-fs: Round disk size to integer, fix for qemu-img 0.14.
    
    qemu-img used to allow you to specify a fractional image size in bytes
    (or at least, it used to ignore the part after the decimal place).  In
    qemu-img 0.14 it no longer does this so we round down the size to a
    whole number of bytes.

commit 29b3ffdad5d6774f988fd0e25f9c8242e5dd577a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 4 12:13:12 2011 +0000

    virt-make-fs: In debug mode, print qemu-img command line.

commit 290e8864fff8a390d6bbbe20fe9781a03edb4c6a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 4 09:59:15 2011 +0000

    Version 1.9.9.

commit 2b26c7f721fc8ed2e6f64963289981ac286c02aa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Mar 3 13:23:23 2011 +0000

    Fix inspection code when PCRE or hivex is missing.

commit 21fef55ca4907aa9872754f20320c24c7f8a5fac
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 2 05:11:10 2011 +0000

    java: Add a test of g.list_filesystems (a function that returns a Map).

commit eb54a7ede43d9275f10db6fce1472256550da0eb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 2 04:49:12 2011 +0000

    java: Fix generated functions that return RHashtable.
    
    Creating a HashMap directly from JNI is possible but very tedious
    (see: http://java.sun.com/docs/books/jni/html/fldmeth.html#26254)
    
    Instead we use the existing code to return hashes from JNI as plain
    String[], then add some code in the Java wrapper to convert these to
    HashMap<String,String>.

commit 0b2e45da609002d44cbbf689cfdee252e6806648
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 2 04:33:39 2011 +0000

    java: Return Map<String,String> for RHashtable functions.
    
    There's no point returning the specific HashMap type here.
    Return the generic interface type instead.
    
    Note that no users are actually calling these functions yet,
    since at present they always fail.

commit ec62f1127ec4f8609745f9d08b62c65e0ccbd154
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 2 04:30:30 2011 +0000

    java: Fix a minor whitespace error in generated code.
    
    In functions that don't have javadoc, the function prototype wasn't
    being indented correctly.

commit 80aad709954cc4a3a294200e242876599047cef8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 2 05:10:31 2011 +0000

    java: Remove old test file if one was left around.
    
    If a test.img file was left over from a previous run, then it
    would cause the subsequent test to fail.  Therefore remove any
    old test.img file.

commit db98ac041ec36c4e2ce322d336f5792fa8e6922d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Mar 2 05:08:20 2011 +0000

    java: Enable assertions when doing 'make check'.
    
    It turns out that Java assertions are disabled by default.  You have
    to add the 'java -ea' flag to the JVM.  Who knew ..?
    
    Because of this oversight, the tests weren't actually performing the
    assertions that we wanted (although in fact none of the assertions
    were failing).
    
    This change enables assertions when running the tests.

commit f455dc3814bf9f7e7e894ba81360acb0edd92464
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Feb 6 17:18:24 2011 +0000

    Version 1.9.8.

commit 8d7d7c4ecfd202e04d18736718e9c5bb125ce4f0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 3 19:33:30 2011 +0000

    daemon: Ignore return value from chdir.
    
    This updates commit 7eb012f3710bb554d5fc2c4229036901b0b5ad90.

commit a20e5c00c35490fa29668630113a01240a69b701
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 28 19:25:02 2011 +0000

    fish: Add guestfish --live, guestmount --live options.
    
    The other programs have the variable, but the flag is not enabled
    either because it doesn't make sense or because the implications are
    not well understood.

commit 2020eded8a3f381c722abe001be8000723ff2418
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 27 22:45:50 2011 +0000

    Add documentation for attach method.

commit cfd9513a54778e1ade82dc1eb351ea32416938a8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 28 13:19:52 2011 +0000

    Add guestfs_add_domain 'live' flag.
    
    This optional flag controls whether this API call will try to connect
    to a running virtual machine 'guestfsd' process.
    
    If the flag is given and the virtual machine is running, then the
    libvirt XML is parsed looking for a suitable <channel> element, and
    'guestfs_set_attach_method' is called with the corresponding
    virtio-serial socket path.

commit 17434fb159e6391353363b3d11e2c1fb626fe548
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 27 15:54:33 2011 +0000

    lib: Implement attach-method unix:<path>
    
    Allow connections to a Unix domain socket which is connected
    (via virtio-serial) to a guestfsd running free in an existing
    guest.
    
    In order to use this you have to add the following element
    to the libvirt XML:
    
      <channel type='unix'>
        <source mode='bind' path='/tmp/socket'/>
        <target type='virtio' name='org.libguestfs.channel.0'/>
      </channel>
    
    (or perform the equivalent on the qemu command line).
    
    Then in guestfish, you can do:
    
      guestfish \
        attach-method unix:/tmp/socket : \
        run : \
        ll /
    
    (or any other commands as desired).

commit 91324e0a732fe592f2eecd5b541c731bf4f34b74
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 28 15:44:40 2011 +0000

    daemon: Remove -f (don't fork) option.
    
    This option was not being used.

commit 338ecaac0546fe0308df3ae5d0927a171b15edd7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 27 16:54:48 2011 +0000

    daemon: Allow -r option to run daemon standalone.
    
    This changes several aspects of the daemon.  Currently:
    
    * sysroot will be "" (ie. operate directly on /)
    * CHROOT_IN/CHROOT_OUT are disabled
    * autosync doesn't try to unmount everything

commit 7eb012f3710bb554d5fc2c4229036901b0b5ad90
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 3 18:49:35 2011 +0000

    daemon: change to root directory
    
    Ensure the daemon always starts with current directory == root.

commit 58bcfdf321878c475f283caf07c11b6fa7efc4fb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 27 11:20:43 2011 +0000

    New APIs: set-attach-method, get-attach-method.
    
    These allow you to get and set the attach method.  The format
    is one of:
    
    * appliance
    * unix:<path>
    
    It's stored broken out into an enum and a string in the handle.

commit 99f0d8859fdc8f6c81873d4cdd1c8c780ac25e84
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 27 10:12:34 2011 +0000

    lib: Move appliance launching to separate function.
    
    This is just code motion.

commit 5ae752559284efd925fb7959c5760d4fee25f1d6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 3 10:56:01 2011 +0000

    php: Ignore another generated file in php/extension directory.

commit 61a1a2b71c4811b9d6233a43db74229b9364f0c6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Feb 3 09:39:49 2011 +0000

    daemon: Parse /proc/mounts instead of /etc/mtab
    
    Since Fedora util-linux 2.19, the %post script does:
    
      rm -f /etc/mtab
      ln -s /proc/mounts /etc/mtab
    
    We are no longer running %post scripts, so this means that /etc/mtab
    is a plain file in the appliance.  Usual 'mount' still updates it, but
    for some reason mount.ntfs does *not* update it in Fedora 15, meaning
    that you couldn't mount and then operate on NTFS partitions.
    
    It seems better to always parse /proc/mounts (ie. what the kernel
    thinks is mounted) unconditionally, rather than relying on the
    capriciousness of the external mount command.
    
    Therefore, parse /proc/mounts instead of /etc/mtab, but add a note
    saying that in future we should really be parsing
    /proc/self/mountinfo, but that needs a custom parser, and the format
    is rather tricky:
    
    http://lxr.linux.no/#linux+v2.6.37/Documentation/filesystems/proc.txt#L1462

commit f2a4020caf0bc3dd63e9eae95dfc1814f051f87e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Feb 2 20:26:19 2011 +0000

    regressions: Fix rhbz557655.sh so it works with tracing enabled.

commit 5079e0fff3f3c150818adb6febad6393b674f126
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 31 09:34:47 2011 +0000

    guestfs-perl: Fix missing \n
    
    This updates commit 477eebc83dcd33d00d34398692692dae6af04f22.

commit ff6065063335194a8cac88be2d213047bf18a891
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jan 30 23:53:15 2011 +0000

    Version 1.9.7.

commit 0089575d4bd50a7ca55d7c3c8caa8a12ae09d40a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jan 30 23:53:04 2011 +0000

    virt-make-fs: Fix typo in man page.

commit 477eebc83dcd33d00d34398692692dae6af04f22
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jan 30 23:41:05 2011 +0000

    perl: Translate C examples into Perl and include a manual page.

commit 6975e87153f593fddd5c27435c2e6347825daca9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 29 07:01:06 2011 +0000

    perl: Ignore internal_* functions in POD coverage test.
    
    This updates commit 1d999540bddd7aea7c2d0fef8b15223d4acc645f.

commit b6c70b3f50472e20a33320e7d76887b011f33c64
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 28 22:51:36 2011 +0000

    Fix test-guestfish-a.sh regression test for new trace format.
    
    This fixes commit 1d999540bddd7aea7c2d0fef8b15223d4acc645f.

commit f060d5bcd40b4a6506d7994e67d57dccab1651b8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 28 21:41:06 2011 +0000

    autobuild: Add a 'make clean' step.

commit 82f5fdb0dbbc0c7b04861edeadf70c86c9342df2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 28 17:11:40 2011 +0000

    lib: Fix use-after-free bug in XPath parsing code.

commit d2636b0984830d950423dadd936114ff242c4a00
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 28 15:28:25 2011 +0000

    Add a new internal-autosync API to perform autosync.
    
    Instead of explicitly calling umount-all; sync, we add a daemon
    function called internal-autosync which does the same.
    
    Apart from slightly simplifying the process of closing the handle, the
    main advantage is we can modify the daemon for the standalone case so
    that internal-autosync does not do the umount-all operation.

commit 1d999540bddd7aea7c2d0fef8b15223d4acc645f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 28 11:14:42 2011 +0000

    Add a prefix to output when tracing (RHBZ#673479).
    
    Also separate the call and return lines so that everything can be
    easily 'grepped' from debug output.  The trace output now looks like
    this:
    
    $ guestfish -x -N fs exit
    libguestfs: trace: is_config
    libguestfs: trace: is_config = 1
    libguestfs: trace: add_drive "test1.img"
    libguestfs: trace: add_drive = 0
    libguestfs: trace: is_config
    libguestfs: trace: is_config = 1
    libguestfs: trace: launch
    libguestfs: trace: launch = 0
    libguestfs: trace: part_disk "/dev/sda" "mbr"
    libguestfs: trace: part_disk = 0
    &c.

commit 77df7d6d537cebe05e06bf07e6e4a2082fe6656a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 27 17:27:41 2011 +0000

    daemon: Replace root_mounted global with intelligence.
    
    We used to maintain a global flag 'root_mounted' which tells us if the
    user has mounted something on root (ie. on the sysroot directory).
    
    This flag caused a lot of trouble (eg. RHBZ#599503) because it's hard
    to keep the flag updated correctly when the user can do arbitrary
    mounts and also use mkmountpoint.
    
    Remove this flag and replace it with a test to see if something is
    mounted on *or under* the sysroot.  (It has to be *or under* because
    of mkmountpoint and friends).
    
    This also replaces a rather convoluted "have we mounted root yet"
    check in the mount* APIs with a simpler check to see if the mountpoint
    exists and is an ordinary directory.

commit e85fbee7bff9422a370d3f437594d262c043d89b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 27 15:54:00 2011 +0000

    daemon: Add perror to two exit paths to make errors clearer.

commit 8a406c7bee521289c6f8704549f1f144b5bbbbd9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jan 27 09:23:01 2011 +0000

    debian: Include actual shared libraries in python-guestfs package.

commit 92b74729e2608a0266fff3a36d87cebefe66d833
Author: Nikita A Menkovich <menkovich@gmail.com>
Date:   Wed Jan 26 15:34:01 2011 +0000

    mkfs-opts: Add optional "features" parameter.
    
    This allows the -O parameter to be added to the mkfs command line.
    This is used to select filesystem features.

commit dd653336cc34c2e8640aa7e19174a3e339049dc2
Author: Nikita A Menkovich <menkovich@gmail.com>
Date:   Wed Jan 26 15:32:18 2011 +0000

    mkfs-opts: Add a note about blocksize param and UFS filesystems.

commit 2110f6fa8c397f74e38408612d5514a42f3b9cee
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 26 14:15:23 2011 +0000

    generator: Fix generation of library-side stubs with optional String arguments.

commit c76f155496717c526ef0b5e72083bb0034f61d3c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 26 10:00:44 2011 +0000

    packagelist: Add ufsutils for Debian and Ubuntu.
    
    Note there is no mkfs.ufs available for Fedora (see RHBZ#541618
    for details).

commit 36fe0acf8a2e72c223d7a9f7a93815ff276a3cc1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 22 18:05:35 2011 +0000

    Version 1.9.6.

commit e8ab05b12c6b1c13278e549883efd47900a4bac1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 22 14:46:37 2011 +0000

    fish: Fix typo in error message (copy-in should be copy-out).

commit 78f1405de05ef1f2efebafd8245658d1707e59ef
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jan 19 21:47:23 2011 +0000

    Use /var/tmp for the cached appliance (for FHS compliance).
    
    The FHS advises large files not to be stored in the root
    filesystem[1], and that /var/tmp is persistent across reboots[2]
    (whereas /tmp is possibly not[3]).
    
    Therefore we should store the large cached supermin appliance in
    /var/tmp instead of /tmp.  /tmp is still used for all other temporary
    files and directories.
    
    In either case you can override this by setting $TMPDIR.
    
    [1] http://www.pathname.com/fhs/pub/fhs-2.3.html#THEROOTFILESYSTEM
    [2] http://www.pathname.com/fhs/pub/fhs-2.3.html#VARTMPTEMPORARYFILESPRESERVEDBETWEE
    [3] http://www.pathname.com/fhs/pub/fhs-2.3.html#TMPTEMPORARYFILES

commit 316ad8311a41869cf5f253225137dd03d1211ce7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 18 22:38:05 2011 +0000

    fish: Initialize pcmd structure.
    
    On Debian we get this warning which I'm pretty sure is bogus:
    
    fish.c:690: error: 'pcmd.cmd' may be used uninitialized in this
    function [-Wuninitialized]

commit 41bbc0a7a3f3cd768c83183327ffc562d2040a83
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 18 13:21:30 2011 +0000

    Version 1.9.5

commit c3887285abbb3606822626ba396a51cb5df80d43
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 18 11:46:03 2011 +0000

    fish: <! cmd executes a shell command and inlines the resulting commands.
    
    The new guestfish construct "<! cmd" executes the shell command
    "cmd", and then anything printed to stdout by "cmd" is parsed
    and executed as a guestfish command.
    
    This allows some very hairy shell scripting with guestfish.

commit 61a4db138e4f85033c655bf6b24df0949683c24c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 18 11:24:38 2011 +0000

    fish: Factor out command line parsing.
    
    Factor out the code which splits a string into a command line.

commit 4bcb267a248977c6b044e18a72266d665102de30
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 18 10:33:01 2011 +0000

    fish: Make exit_on_error into a completely local variable.
    
    Note that 'time' and 'glob' (which both run subcommands) do not
    correctly pass the exit_on_error flag in the remote case.  This is not
    a regression: the current code doesn't work either.

commit f6a21c1e0d44f9db409ce6583be7b5bc694767a8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 18 10:21:49 2011 +0000

    fish: exit_on_error is a local variable.

commit deadcc73260a82c210417382412f80d14c5292db
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 15 16:40:49 2011 +0000

    todo: Live CD inspection works, but not for Windows 7.

commit 07f1be28e85c37580d882c0a889528c1b9c6b4a0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 15 14:56:36 2011 +0000

    Version 1.9.4.

commit bc93d2ba38eb17a45888b97e8bcfd5f0e0bcb57c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 15 14:56:25 2011 +0000

    README: Note that po4a is mandatory if compiling from git.

commit c2f2a2c6769be908b25b0946f39770d09bb6ddc9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 14 22:20:51 2011 +0000

    Add ability to inspect install disks and live CDs.
    
    For examples of the virt-inspector output, see the additional
    inspector/example-*.xml files in this commit.

commit 4402e6048fb2a56461f9e4d474fc2f1391248781
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 15 13:18:36 2011 +0000

    inspect: Add macros for file size limits.
    
    This also bumps the file size limit for "small text files"
    up to 2 MB, since we want to parse Windows CD txtsetup.sif
    files that are usually around 500K in size.

commit 4ffa2d6798f7a2bf0baec8e1084659cf6358bc31
Author: Nikita A Menkovich <menkovich@gmail.com>
Date:   Fri Jan 14 13:39:38 2011 +0000

    New API: resize2fs-M to resize ext2/3/4 to minimum size.

commit 69f2f6290032e1079dfa1e83fab3559d5d2d690f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 11 21:54:57 2011 +0000

    Version 1.9.3.

commit e5220b26f51d5912371424ab6dfbdb46ce6aa170
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 11 13:55:23 2011 +0000

    df: Skip final '/' character when calculating basename.
    
    Previously it was including the final '/' character when calculating
    the basename for the -a option eg:
    
    Filesystem                                Size       Used  Available  Use%
    /Ubuntu1010x64:/dev/sda1                  9.4G       2.3G       6.6G   25%
    
    With this patch the '/' is not printed.

commit 0c60e4d9dd6549c2135699490ba8a9ec1dd50ab9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 11 10:43:51 2011 +0000

    fish: Don't fail if some mountpoints in /etc/fstab are bogus (RHBZ#668574).
    
    Fix guestfish (and other C tools) so that they ignore errors
    when /etc/fstab contains bogus entries.
    
    Update the documentation for inspect-get-mountpoints to emphasize
    that callers must be aware of this when mounting the returned
    values.
    
    Add a regression test.
    
    Update the example code ("inspect_vm") to reflect the way this
    API ought to be called.
    
    For more detail see:
    https://bugzilla.redhat.com/show_bug.cgi?id=668574

commit fc241abdbac7a016cd2fac169ad64876107df3c8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 11 10:47:11 2011 +0000

    Add logo used on the website.

commit a2bf709b3c68cd95554412c041a455354033fa2b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 10 10:41:20 2011 +0000

    Add cartoon fish logo (not completed).

commit 844d7f575527b5ade34188755e92d0edecb83fec
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jan 9 13:13:02 2011 +0000

    todo: /proc/self/mountinfo

commit 62d4f2550d6b412a4b3ad4b34d4b3d3a67c4eb6c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 8 20:51:58 2011 +0000

    todo: Add notes on inspecting ISO images.

commit 97339a0f43d687efac6f7edafdf21e4b8d9b35e8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jan 8 10:15:39 2011 +0000

    virt-filesystems: Ignore errors when getting label and UUID (RHBZ#668112).
    
    If virt-filesystems was pointed to an image that contained
    bogus or blank filesystems, then calls to vfs-label and/or vfs-uuid
    could fail, resulting in errors like this:
    
    libguestfs: error: vfs_label: /dev/vda1:
    
    These errors can be ignored and shouldn't stop virt-filesystems
    from working.

commit 7e1114445e713c4a15f3f2cede5842044de1735a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jan 7 20:38:55 2011 +0000

    resize: Fix typo in man page (thanks avesh@IRC).

commit 7ce627fce02eae8c7db36b4090fa0ce1bf69bf44
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 4 16:05:11 2011 +0000

    fish: fails to tilde expand '~' when $HOME env is unset (RHBZ#617440).
    
    This also adds a regression test.

commit a9802509184341e731de5c9af363184a9964a8a7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jan 4 16:02:48 2011 +0000

    fish: Fix off-by-one bug in tilde expansion.
    
    Although this doesn't seem to cause a crash, valgrind confirms
    that this is a genuine off-by-one bug.  It could potentially
    cause a crash if you did:
    
      echo 'echo ~root/foo' | guestfish

commit 04a9645ca6a3651e76ca311cd2ff79a22bd2af1f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 3 17:31:46 2011 +0000

    Version 1.9.2.

commit b8f9a20b039b34ba41098d1360866b6f9f74463d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 3 17:16:44 2011 +0000

    New tools: virt-copy-in, virt-copy-out, virt-tar-in, virt-tar-out.
    
    Relatively trivial wrappers around the equivalent guestfish
    commands.  Change also includes new man pages.

commit 72f4b2e7493bf81b111ecd83490c9d3ad2480382
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 3 17:17:54 2011 +0000

    .gitignore: Use full paths for some ignored files.

commit 1b1db82d64a9664f0da1c628ee896a113a605739
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jan 3 14:36:19 2011 +0000

    docs: Add QMP to ROADMAP file.

commit 440cd23f54f44132b8ff3d1e5b0b05b9dd5cc1c0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jan 2 22:55:48 2011 +0000

    filesystems: Document the columns in --long output.

commit 9ae4168c30b8be57909f5b0104c5e925743c6cc0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jan 2 21:43:22 2011 +0000

    Add initial announcement to release notes.

commit f13f3386007381f2955f8cfc45ecf84d9ebfa0ce
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jan 2 21:01:43 2011 +0000

    Update TODO file.

commit dd7ad7c7ebd7b3cf7fbcc03d3baadbb77bf4203a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jan 2 21:01:41 2011 +0000

    inspector: Apps in Windows VMs are now listed - update documentation.

commit f07a0b6f1e01f12db0286ae49744deee0efcb5b9
Author: Douglas Schilling Landgraf <dougsland@redhat.com>
Date:   Sun Jan 2 18:55:12 2011 +0000

    Lib.pm: unknown filesystem /dev/hd{x} (cdrom) (RHBZ#666577)
    
    This a purpose patch to avoid the message "unknown filesystem /dev/hdc".
    Where /dev/hdc is an entry in fstab for CDROM.
    
    Example of fstab:
    /dev/hdc                /media/cdrom            auto
    pamconsole,exec,noauto,managed 0 0
    
    https://bugzilla.redhat.com/show_bug.cgi?id=666577
    
    Signed-off-by: Douglas Schilling Landgraf <dougsland@redhat.com>

commit 5cab0d6c807d8a3bf9690375c663d11a10e21656
Author: Douglas Schilling Landgraf <dougsland@redhat.com>
Date:   Sun Jan 2 18:53:55 2011 +0000

    Lib.pm: unknown filesystem label SWAP-sda2 (RHBZ#666578)
    
    Hi,
    
    This is a purpose patch to avoid the message: unknown filesystem label
    SWAP-sda2.
    
    Instead of validate the label with 'eq', use '=~' and /$label/i.
    
    https://bugzilla.redhat.com/show_bug.cgi?id=666578
    
    Thanks
    Douglas

commit e99ac0394acbba2923e361d84511b9646f464585
Author: Douglas Schilling Landgraf <dougsland@redhat.com>
Date:   Sun Jan 2 18:52:52 2011 +0000

    Lib.pm: avoid message "unknown filesystem /dev/fd0" (RHBZ#666577)
    
    This patch to avoid the message "unknown filesystem /dev/fd0".
    https://bugzilla.redhat.com/show_bug.cgi?id=666577
    
    Signed-off-by: Douglas Schilling Landgraf <dougsland@redhat.com>
    
    Thanks
    Douglas

commit 62c47b74317f148338f5b85302b537a187fab199
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jan 2 16:50:39 2011 +0000

    Tempora mutantur, nos et mutamur in illis.

commit 5c9e8a65fe89e5e6baca8651000885d8467356ff
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 31 11:11:02 2010 +0000

    podwrapper: Fix up the HTML output so most inter-page links work.

commit d71faf98624c1fb2c760e0e9f55205beb06b7644
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 31 10:44:32 2010 +0000

    podwrapper: Fix script indentation.

commit 7a8c60e1c8fbaf09fb2fa2fe10b50df39c0d9650
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 31 10:39:05 2010 +0000

    podwrapper: 'builddir' was not defined - use a properly defined path.

commit 2dbd22727dbd8287adfcdbf4851b2e818d79a8e2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 31 08:41:44 2010 +0000

    Version 1.9.1.

commit ce85a6a82ae80fdfb3eb7c2c2251658f8aadc241
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 30 23:32:09 2010 +0000

    docs: add-domain: Remove ref to not impl add-libvirt-dom API call.

commit 86a53e17de672a79a994b905676b4566da9f072c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 30 23:14:12 2010 +0000

    docs: Refresh programming language list in guestfs(3).

commit 33e9639f2037540a89a9bbaf7212683e8a60fe84
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 30 23:08:18 2010 +0000

    docs: Refresh programming language equivalence example in guestfs(3).

commit cdc798ac3558e416dc756a0fcefad2af5ca307e0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 30 22:56:25 2010 +0000

    docs: Fix missing g handle in guestfs(3) man page.

commit 22042693cc1e0455a4a503dba93a9fedc9c74f04
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 30 22:56:07 2010 +0000

    docs: Refresh guestfs(3)/DOWNLOADING.

commit 1a9b7df8f2092701fdc5a77a4d9edfcaa1a20acf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 30 22:46:29 2010 +0000

    docs: Refresh guestfs(3)/MOUNTING

commit 3f4dc56a32074a02b1b829bd7a91878f73022d1d
Author: Jaswinder Singh <jsingh@redhat.com>
Date:   Thu Dec 23 13:45:26 2010 +0000

    Update Punjabi translations (RHBZ#665358).

commit 49b2ae2e69e1a273b4d4a8746a872ec00b91c86f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 21 17:23:08 2010 +0000

    recipes: Refresh guestfish recipes.

commit b1ca8b5fbb263fd945f21d0ccff99f40a59d562b
Author: Piotr Drąg <piotrdrag@gmail.com>
Date:   Tue Dec 21 13:42:27 2010 +0000

    Updated Polish translation (RHBZ#502533).

commit 327442119ff1f1791a0682928e59b0c4b4752007
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 20 22:33:45 2010 +0000

    fish: --ro will be default in 1.10, not 1.8.

commit e32a85cf9307e45826a38e7271576a965b2f2731
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 19 21:58:05 2010 +0000

    docs: Update API support.

commit 7ba1b55aa79c56ded770f8ea46716eb054fbfe78
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 19 22:08:49 2010 +0000

    api-support: Fix detection of similar APIs.
    
    Because we didn't match on word boundaries, the previous
    code would get confused by similar APIs, eg. getxattr vs getxattrs.

commit d2400da92e5e2cc7fd5e33e61220a33214d5241c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 19 21:53:09 2010 +0000

    docs: Obsolete HACKING file, move content into guestfs(3) man page.
    
    Add a new section called "EXTENDING LIBGUESTFS" to the
    guestfs manual page which contains all the information
    previously in "HACKING".

commit 84fbe21855b5b304413075fecb444135397591e6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 19 21:52:46 2010 +0000

    docs: Refresh README file.

commit dfbdae5dd27b84222825b6826065a3362ab71025
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 19 19:29:02 2010 +0000

    Update TODO file.

commit 8df8ccb287b739748294d4074c09448bd2b2e62b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 19 15:53:07 2010 +0000

    Version 1.9.0.

commit fc279d28060b2ee6f52dbc92cb1541f2494e1258
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 19 15:39:04 2010 +0000

    Update BUGS, PO files for 1.8.0.

commit 48eb763d85cb0b343339c8a49549688e821f0edd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 19 14:31:01 2010 +0000

    Prepare for next stable branch: version 1.8.0.

commit b62e154d97f727f322f954060c67b6ba14cb1925
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 19 14:25:50 2010 +0000

    Update RELEASE-NOTES.

commit e427d86de1ecd4a3b546df33445d0562a4b858ae
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 19 14:20:17 2010 +0000

    Add ROADMAP for 1.10.

commit 85c0bf53085e78b257cf71455a55924fe6e3943b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 19 12:04:43 2010 +0000

    fuse: Add more tracing for calls into guestmount functions.

commit 2712f237b01a3b7c582e253069864b0449b2d66e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 19 11:01:59 2010 +0000

    appliance: Don't exclude upstart (/sbin/reboot) (RHBZ#661280).
    
    Don't exclude upstart from the appliance.  It provides /sbin/reboot
    which is required by virt-rescue.

commit da24e7aab06361b8d9bb5b5c8417611501e94684
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 19 10:56:06 2010 +0000

    appliance: Don't hard-code febootstrap --exclude parameters.
    
    Create a separate file 'excludelist.in' that contains these
    regular expressions, and process it the same way as packagelist.in.

commit 9556903888eed268895a8454491d56302985f7e1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 19 10:55:03 2010 +0000

    appliance: Use a temporary file when processing packagelist.in.

commit acd25281bfa31b78fd03e25b495f66138a4dd987
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 17 18:56:15 2010 +0000

    docs: Add section on using /dev/fd/* with upload and download calls.

commit fa4931bc4e2944e9b3b72843d4b0350d7ad36238
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 17 10:21:41 2010 +0000

    docs: Fix link to function in documentation of "du" and "du-s" commands.

commit 8ae40fa990b38005379c1c831f56c07b6b452bee
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 16 23:21:29 2010 +0000

    Version 1.7.24.

commit 933e970b8ac654586bc3595f56b187fab65b1173
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 16 20:23:17 2010 +0000

    ntfs-3g: Document problems with symlinks and alternatives (RHBZ#663407).

commit 3a3836b933b80c4f9f2c767fda4f8b459f998db2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 16 20:05:48 2010 +0000

    New APIs: getxattr and lgetxattr to get single extended attributes.
    
    These APIs are essentially required to work around a problem
    with ntfs-3g.  This filesystem (or FUSE?) does not list all
    extended attributes of a file when you call listxattr(2).  However
    if you know the name of an extended attribute, you can retrieve
    it directly using getxattr(2).
    
    The current APIs (getxattrs etc) are simple to use, but they
    don't work if we can't list out the extended attributes (ie.
    by calling listxattr(2)).
    
    Example using the new APIs on an ntfs-3g filesystem:
    
    ><fs> lgetxattr "/Documents and Settings" system.ntfs_attrib | hexdump -C
    00000000  16 24 00 00                                       |.$..|
    00000004
    ><fs> lgetxattr "/Documents and Settings" system.ntfs_reparse_data | hexdump -C
    00000000  03 00 00 a0 34 00 00 00  00 00 18 00 1a 00 10 00  |....4...........|
    00000010  5c 00 3f 00 3f 00 5c 00  43 00 3a 00 5c 00 55 00  |\.?.?.\.C.:.\.U.|
    00000020  73 00 65 00 72 00 73 00  00 00 43 00 3a 00 5c 00  |s.e.r.s...C.:.\.|
    00000030  55 00 73 00 65 00 72 00  73 00 00 00              |U.s.e.r.s...|
    0000003c
    ><fs> getxattr "/Documents and Settings" system.ntfs_reparse_data | hexdump -C
    libguestfs: error: getxattr: getxattr: No such file or directory
    ><fs> getxattr "/Documents and Settings" system.ntfs_attrib | hexdump -C
    libguestfs: error: getxattr: getxattr: No such file or directory
    ><fs> lgetxattr "/Documents and Settings" system.ntfs_attrib | hexdump -C
    00000000  16 24 00 00                                       |.$..|
    00000004
    ><fs> getxattr "/Users" system.ntfs_attrib | hexdump -C
    00000000  11 00 00 00                                       |....|
    00000004

commit 236c1fb7db210038abb70ae436aeb4119dd99563
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 16 18:45:08 2010 +0000

    appliance: Add 'attr' package for xattr support in virt-rescue.

commit dec770f171329868081985ca0aa3d52eb3759935
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 12 23:18:26 2010 +0000

    generator: List files generated in a separate file.

commit 9aacbe712d1326cff05a7343cf4603df38e96ef7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 12 23:02:44 2010 +0000

    docs: Update RELEASE-NOTES to latest.

commit 0d267d6cd5cd86c7e5359146ba8745db4a349187
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 12 23:02:30 2010 +0000

    README: Advise using febootstrap >= 3.3.

commit 573e01e0871324c038bac2fd391c86c8b7fb0247
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 12 22:36:06 2010 +0000

    Version 1.7.23.

commit 6e874195970a8e352d104bd0ebc254fd92f3b370
Author: Thomas S Hatch <thatch45@gmail.com>
Date:   Sun Dec 12 10:55:09 2010 -0700

    Removed hfsprogs from supermin packages for Arch

commit e49aefd1f8a85c02d344cef18c8b07aa1c2187f9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 12 10:02:00 2010 +0000

    fish: Clarify documentation for --ro option.

commit e6a3770b43383d66f39230510d8ff01083d5c3ac
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 12 10:01:30 2010 +0000

    fish: Document equivalence of -a/add etc. in man page.

commit f341624668d10c58e2899354cef1e11c4175992a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 12 09:48:59 2010 +0000

    fish: Split ..|.. options into separate items in man page.

commit a6bfc9f3c44c6b4421d5a7b1d872411583a5cffa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 11 23:35:18 2010 +0000

    appliance: Don't set utime on cachedir until we know it is safe.
    
    This could be used to touch an arbitrary file (albeit one which
    must already exist), and this could have been a security problem.

commit f410d571ccbf54b34937dab2868614d35fe59855
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 11 23:23:36 2010 +0000

    appliance: Touch cached appliance files so they don't get tmp cleaned.

commit 3d114fcf84372c52ea769c4bb8efa572936f1f5a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 11 23:07:56 2010 +0000

    Remove extra \n character from end of error messages.

commit 52c6b0d96d26ae056759222fe0ac029ca2d60bbf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 11 18:08:08 2010 +0000

    Version 1.7.22.

commit 4beb2844091310012b5e28971707397d1d51d833
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 11 17:22:43 2010 +0000

    appliance: Be careful about cleaning up old appliances.
    
    This change resolves several issues with current appliance
    building:
    
    (1) Old appliances are cleaned up.
    
    (2) Race conditions between appliance building is handled better.
    
    (3) Several bugs fixed.

commit 363978fa7fc055da380d31103c7de378a08b71fb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 10 17:38:17 2010 +0000

    daemon: Use prog_exists to check for features.
    
    This updates commit 0938509e0422363554023ab99381fd70a22a6e08.

commit 4fb66110c2ffec1bc3f7fdf4a6d09b1d28a78db3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 10 17:19:02 2010 +0000

    debian: Work around warning in Debian udev init script.
    
    See also:
    http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=606622

commit 8d8dc4c10700ee43bd026469665f5a16f6d2cbf5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 10 15:05:17 2010 +0000

    win-reg: Add Windows Tips to documentation.

commit bc484e99c23842aa67d2b533023eeaaa30fd6868
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 10 14:36:18 2010 +0000

    win-reg: Move documentation after options, combine shell quote sections.

commit b4310a810cb4050eb6473971895d3c255f045ccc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 10 13:44:25 2010 +0000

    Version 1.7.21.

commit d72815578f7b8fea9702902d8562430e8a007a46
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Dec 10 12:19:49 2010 +0000

    Remove several unused local variables.
    
    (Revealed by compiling under Debian where this is a warning).

commit 8dafeaa477f9e3d2fde827b8de4b44d66b661b69
Author: Thomas S Hatch <thatch45@gmail.com>
Date:   Thu Dec 9 22:04:24 2010 -0700

    Added packages for Archlinux support

commit 4164e9966456896379f964edb5f0676920f4bba2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 9 18:31:23 2010 +0000

    debian: Dependencies for all the different names of qemu/KVM.

commit 1d4f1ba129610f2c54cf6682df0cf134df89c48d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 9 18:31:03 2010 +0000

    debian: Quilt is not used for patch management.

commit ff99f399f09025eb4c880da8f13d666146dfac7f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 9 18:30:08 2010 +0000

    cat: Remove some unused local variables in virt-cat.c and virt-ls.c.

commit 8e7012131cbf406a936efbbe688aec253bd742a0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 24 11:41:13 2010 +0000

    Add debian/ directory (temporarily).
    
    This was created initially from pkg-libvirt/libguestfs.git
    commit 680ff0b0e8c9133ef987e68392bd3990715f6891.
    
    This is a temporary measure to allow us to build Debian and Ubuntu
    packages more easily.  When downstream packaging is being done on
    these distros we will remove this directory again.
    
    To build a Debian package, use this command:
    
      debuild -i -us -uc -b

commit b5516dc9d4a1418ad683aa7f046aa7fa30152721
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 9 16:24:35 2010 +0000

    debian: Exclude file-rc.
    
    This package duplicates /etc/init.d/README which is
    really supplied by sysv-rc package.

commit ff484e00535e11da17d9c63447abbb6b65e4f11b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 9 12:42:33 2010 +0000

    build: Use ./configure --with-python-installdir=DIR to select Python dir.
    
    We don't always want to install in the site-packages directory.  Allow
    the directory to be chosen using a configure option.  Rename the
    variable PYTHON_INSTALLDIR to reflect its true purpose.

commit 8ea322aba3041e67cf32b43101a3299f89c9b0dc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 9 12:35:41 2010 +0000

    build: Add "checking ... result" around Python tests.

commit 8e4c22db236f08f836a8ab94c8bb025d727684b5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 9 12:06:09 2010 +0000

    build: Remove check for root.
    
    With the new package building system, it is no longer dangerous to run
    'configure', 'make' or 'make check' as root (although it is still not
    necessary and not advisable).  In any case we don't need to check
    this.

commit 75893a554c374f59318844bca3433e6a2d6c774b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 9 16:41:20 2010 +0000

    inspector: Remove some unused local variables.

commit 5376e13806576a392270621ae3cf37c32be40559
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 9 11:54:59 2010 +0000

    fish: Remove some unused local variables.

commit 370f79fd3d3df3511fe50f39491c2d15f653c48f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 23 17:37:25 2010 +0000

    build: Remove AM_GNU_GETTEXT_VERSION macro.
    
    See discussion on the mailing list:
    https://www.redhat.com/archives/libguestfs/2010-December/thread.html#00032

commit f3805e2166e2ab54cd9a6e8b7c536e6f20a61dff
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 8 12:12:08 2010 +0000

    rescue: Add notes about networking.
    
    In particular the 'ping' command does not work because it is
    using QEMU user networking.

commit c5747bd43637efb81485866e1fade3bb55f6d726
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 8 12:11:53 2010 +0000

    rescue: Add note about using virt-rescue as root/non-root.

commit df5ae67129dcbb16e2437b65b4557dfe73c1782d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 7 22:16:02 2010 +0000

    docs: Link to guestfs-examples(3) after simple example.

commit 917c3520c7d6a2f3f9f670e42e0875aa40579a30
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 7 22:15:45 2010 +0000

    docs: Note that guestfs_sync is no longer necessary.

commit 4b8f70d46dcfed1489c97f822e263b8615f21ea0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 7 18:41:40 2010 +0000

    Version 1.7.20.

commit 70a92b3cfb278403c844d22c9a47c82ddfccdb9c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 7 18:39:11 2010 +0000

    build: relink-static.sh script removed from EXTRA_DIST.
    
    This updates commit 9bc15f5d98a3a17d465a94f42dc3ffb60c077293.

commit 0942cab0375cb445cc8edfba87ea82a703383964
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 7 17:55:38 2010 +0000

    ubuntu: deactivate LVs and VGs before removing them.
    
    Even with the '-f' option, LVM on Ubuntu sometimes cannot remove
    active LVs and VGs.
    
    Change lvm-remove-all so it deactivates each LV and VG before
    removing them.

commit 1c63d8239a9a05eeafd4e4b8c882200bc68a3109
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 7 17:32:40 2010 +0000

    Revert "umount-all: Add udev_settle after unmounting disks."
    
    This reverts commit ad2abf89c364d5ec73fb12af63b053637d99d757.
    
    Ubuntu still has errors even with the addition of udev_settle
    after umount-all.  Therefore this was just masking the problem.

commit 0938509e0422363554023ab99381fd70a22a6e08
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 7 16:51:41 2010 +0000

    debian: Fix ntfs3g available API on Debian.
    
    Really we should have a test for "is program on $PATH?" but this
    fix will do for now.

commit 37a242286896afe119163335143ffbdd6842127b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 7 17:16:20 2010 +0000

    fuse: Set UID and GID when performing FUSE tests.
    
    This avoids breakage on Ubuntu.

commit fd4d0d83f133772aa1e84d8a3af6f642f9c73b5c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 7 16:23:41 2010 +0000

    autobuild: Skip some tests on Ubuntu.

commit d29304c1b486c94970aff0631e0bf91c745b0ef9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 7 16:22:23 2010 +0000

    ubuntu: Allow test-luks.sh to be bypassed to workaround Ubuntu bug.
    
    This is necessary because of too old cryptsetup on Ubuntu.

commit ad2abf89c364d5ec73fb12af63b053637d99d757
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 7 16:15:32 2010 +0000

    umount-all: Add udev_settle after unmounting disks.
    
    This helps avoid an error on Ubuntu, but it's not clear if this
    is a real solution or just helps by adjusting the timing of some
    race condition.

commit 4df67f26aef7339ef9690da7becb756c9f3f4eaa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 7 15:29:55 2010 +0000

    fuse: Disable test which doesn't run reliably on Debian.
    
    See discussion in RHBZ#660687.

commit de419e4bace5d5be58a87d76f0c63ec39f327d1a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 7 14:49:34 2010 +0000

    fuse: Fix emulation of open call.
    
    We were being over-complex in this call.  All the FUSE API requires
    this call to do is to check permissions.

commit 97cbb842362e2548a59a1560c50e5f998fa5bda8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 7 13:29:40 2010 +0000

    fuse: Fix segfault in guestmount --verbose.
    
    If hash_delete returns NULL and --verbose option was given then
    this would cause a segfault.

commit 4c5038ab54fb6fdff75ca8d5fdda9e73f48a5050
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 7 09:48:20 2010 +0000

    Add autobuild script.

commit c45b5e7230c6c580645bec46f0c7f8d8dbdf08cf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Dec 7 09:53:16 2010 +0000

    gitignore: Ignore all local* files in the main directory.

commit 1e78cd1690f15a45f80d384edca9b7b868b9b802
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 6 21:24:59 2010 +0000

    appliance: Don't quote the --exclude parameters.
    
    The quotes appear literally on the command line:
    
    $ s="--foo 'bar'"
    $ echo $s
    --foo 'bar'

commit 53853f717c5928bc61809cc26160da118cd556fa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 6 17:44:06 2010 +0000

    Add --with-febootstrap-yum-config.
    
    This allows the febootstrap --yum-config option to be passed through,
    allowing a separate yum configuration to be used.
    
    The hope is that this will enable building in Koji.

commit 9bc15f5d98a3a17d465a94f42dc3ffb60c077293
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 6 18:16:39 2010 +0000

    Remove ability to build static distribution.
    
    We are now going to build binaries for each distribution so
    there is no need to build the quasi-distro-independent static
    binaries any more.

commit 7eaecf8303c229268f1f55dcb5e37ff9f0bf420d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 6 16:46:00 2010 +0000

    regressions: Disable test for 576879.
    
    This test has worked only intermittently for a while.  Disable
    it.  The upstream bug has been reopened.

commit 1d29fc2932334d397edf3a3cdda2d23722e612cf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 6 15:55:36 2010 +0000

    build: Use grub-pc instead of old grub on Debian and Ubuntu.

commit 2ed6a02af6db2b54e0cfd4ea73e42a6b6e275af7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 6 15:01:38 2010 +0000

    build: Add diff to package list for Debian and Ubuntu.

commit 1719b764fe521f9d56eeda9d8bdf1e61ae5df411
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 6 14:59:03 2010 +0000

    build: Add cpio package to package list (for Debian and Ubuntu).

commit e79f1431803f68d66fe6086b3ea7a5ab298d67e0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 6 15:04:00 2010 +0000

    build: Look for other db_dump variations (for Ubuntu).

commit 095433f7b0b0a387268eb1a79c897d97092a9500
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 6 14:32:03 2010 +0000

    ubuntu: Disable xfsprogs from Ubuntu package list.

commit 227c9a4bca760f7f38e255f459720888a8335eeb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 6 14:31:17 2010 +0000

    ubuntu: Make Ubuntu into a separate distro for the package list.
    
    This allows us to select Ubuntu packages separately from Debian ones.

commit 0bb4208467dcfc49389037defe6ce7f291807901
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 23 17:39:31 2010 +0000

    build: Don't emit warnings about stack protector failures.
    
    These are seen on gcc 4.5.1 used in Ubuntu.

commit 34fe8095c52bfc2d5b0b80528aa0fdfa58154e9f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Dec 6 13:39:37 2010 +0000

    debian: Enable more packages in packagelist.in.
    
    These were previously disabled because of problems with
    debirf.  Now we are not using debirf, we can use them
    again.

commit 194bacbe2a6203a83e8d73156e7120de086a705c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Dec 5 11:20:21 2010 +0000

    Version 1.7.19.

commit 8227537100d9076ac5db6ce0e9e223762b676d24
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 4 23:47:47 2010 +0000

    Debian: Extra packages needed to run C API tests.

commit 6d75ce8e6ca1f3f0a946ee4e214f6d2bff07adc4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 4 21:14:17 2010 +0000

    appliance: Change to using febootstrap 3.x supermin appliance.
    
    This removes all support for building the ordinary / old
    style appliance using febootstrap 2.x, debootstrap, debirf,
    fakeroot and fakechroot.
    
    Instead this uses febootstrap 3.x to build the supermin appliance
    in a simpler cross-distro manner.

commit 078fbee4e73036783aefef9401735f8b80e81bb2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 4 19:07:15 2010 +0000

    appliance: Put /init in a separate supermin appliance component.

commit 85ba859aa8ca40299a1b6f112087138ec5dd140a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Dec 4 19:06:39 2010 +0000

    appliance: Don't look for kmod.whitelist.
    
    This file is not used for building the supermin appliance.

commit 0710326ac5f1a06cf1dc3500617d04cf4cba5631
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 2 13:35:14 2010 +0000

    New API: mkfs_opts, mkfs with optional arguments.
    
    This is an extensible version of 'mkfs' which supports optional
    arguments.  There is now no need for 'mkfs_b' since you should
    use 'mkfs_opts' with the optional 'blocksize' argument instead.

commit 65f44b459070a1dbfba66c31e0be69588e49f4a8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 2 13:32:40 2010 +0000

    generator: Code to handle optional arguments in daemon functions.
    
    Previously we only supported optional arguments for library
    functions (commit 14490c3e1aac61c6ac90f28828896683f64f0dc9).
    
    This extends that work so that optional arguments can also be
    passed through to the daemon.

commit 01d62985c3f0234fc0e9e4909c85c6a401c4bfcc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 2 13:31:52 2010 +0000

    fish: Fix generation of code to handle Int/Int64 optional arguments.

commit faf1cd50492fd014267c22a0e988a75f1c337364
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 2 11:35:57 2010 +0000

    Fix argv struct mixup over Int/Int64.

commit 3451d73a693091ae1a33e7dbefbe56c1b93f426a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Dec 2 10:23:30 2010 +0000

    todo: Refresh documentation.

commit 9f2135c4e4062087b9bd525406802da2a25c7365
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 1 18:00:17 2010 +0000

    Version 1.7.18.

commit 8022d46e5e2d9c3ab664ace6c9f185976e34dc20
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 1 13:33:31 2010 +0000

    Add progress notification messages to upload and upload-offset APIs.

commit 11be64049ba3ce36e1be297d2d6f54abca079742
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 1 13:31:25 2010 +0000

    protocol: Handle progress notification messages during FileIn.
    
    If the daemon sends progress notification messages while we
    are uploading FileIn parameters, these are received in
    check_for_daemon_cancellation_or_eof.  Modify this library
    function so that it turns these messages into callbacks.

commit 8bfca99b9ab5774ce8aa1086184479ebb98236b2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 1 13:24:23 2010 +0000

    protocol: Really read 4 bytes while checking for cancellation.
    
    We've not actually hit this bug in practice, but at least in
    theory while checking for cancellation we could read > 0 but
    fewer than 4 bytes, which would effectively be discarded and
    we would lose synchronization.
    
    Note the socket is non-blocking.
    
    Change the code so that we temporarily set the socket back to
    blocking and force the read of all 4 bytes.

commit 7e523077d650cfb71044d5e74aa8fe1f91c019ae
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 1 13:28:26 2010 +0000

    protocol: Send progress_hint in header.
    
    For actions that have FileIn arguments, count the size of all
    the input files and send that in the progress_hint field of the
    request header.

commit 3aa8182c3cc478bf723205f1a4dd84e160768448
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Dec 1 10:30:44 2010 +0000

    protocol: Upload progress messages and optional arguments.
    
    Two unrelated changes to the protocol to support progress
    messages during uploads, and optional arguments.
    
    Note that this makes an incompatible change to the protocol,
    and this is reflected in the protocol version field (3 -> 4).

commit fdc8805362c6fc587bb7985c5290362ad3094f4e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 30 16:52:48 2010 +0000

    df: Fix segfault when using virt-df -a filename
    
    If 'filename' doesn't contain a '/' character then virt-df
    was calculating NULL as the basename and later segfaulting.

commit 8d28fe0ef284a2e786bc92b40fbb4620120de335
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 30 15:01:29 2010 +0000

    Version 1.7.17.

commit b79e075d637f669ce5e4aa2e9b7f578ac8de0839
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 30 14:17:37 2010 +0000

    php: Combine tests to reduce number of launches.

commit 2860b21ee1b86d6c944308a8be181c91bc07fd03
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 30 14:10:40 2010 +0000

    haskell: Combine tests to reduce number of launches.

commit aba7cad7dfbb12fe4e21f9388cf4e50b47117cfb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 30 14:06:27 2010 +0000

    java: Combine tests to reduce number of launches.

commit b034795a259fb5f255c1f9c835d722efab4d4f7c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 30 13:59:50 2010 +0000

    python: Combine tests to reduce number of launches.

commit 13af3835cdcfbf46c8072b7960d73ae9ca5deb4d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 30 13:56:33 2010 +0000

    ocaml: Combine tests together to reduce number of launches.
    
    Combine launch, lvcreate and readdir tests together into a
    single 'basic' test, so that we don't launch the appliance
    so often when testing in this subdirectory.

commit 61a0f7988447fe0911360f8dfc2962086967cc9a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 30 12:42:55 2010 +0000

    capitests: Convert many InitBasicFS tests to InitScratchFS.
    
    These tests run much more quickly if you don't have to run
    'mkfs' and (particularly) partitioning/LV commands between each
    test.
    
    The total time for running 'make -C capitests check' on my laptop
    has gone from 413 seconds down to 221 seconds.

commit f93cdf1ed3323b8d9451a7f4f6365ac30ab8ba81
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 30 11:48:35 2010 +0000

    capitests: Add 'InitScratchFS' test environment.
    
    This should allow us to perform filesystem-based write
    tests much more quickly, because we don't need to recreate
    the filesystem from scratch each time.

commit 17233ce2113aa730752ae3420cc209b2a72ab616
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 30 10:42:31 2010 +0000

    capitests: Move test documentation into HACKING file.

commit ba7ec6aea325b0a6df5777afc057df087f669a7b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 30 10:33:08 2010 +0000

    capitests: Use /dev/sdc for misc tests (instead of /dev/sdb).
    
    This change means that /dev/sdb is not being used during
    the tests (except passively, eg. in listings of devices).
    
    This allows us (in a forthcoming commit) to use /dev/sdb as a
    quick scratch filesystem for testing writes.

commit 6f09e4774ce64a15424a2601df10326d764cc7f7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 27 18:48:48 2010 +0000

    docs: Fix small inaccuracies in virt-resize(1).

commit 866a6a0fa5124a06918f84b7db28f831ab6e4495
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 27 18:43:23 2010 +0000

    docs: Fix typo in virt-filesystems(1).

commit 94e1465129ae738367421c2515ee23623ee80ed9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 27 18:39:35 2010 +0000

    docs: Remove ref to L</add-drive-opts> wrongly copied into some man pages.

commit cece0b85ecd6ea8609d8f838ef6e9aa75b55506f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 26 23:57:42 2010 +0000

    Update API support.

commit 8370d35221ac385908d78141ddcbc5916122fce1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 26 23:56:41 2010 +0000

    Updated RELEASE-NOTES file.

commit 0b2a3bd8404a72a3b7e99e330143c26bf42d458a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 26 22:36:14 2010 +0000

    Version 1.7.16.

commit 272b754093ef824486993540a893d39be8e7e9f0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 26 21:51:11 2010 +0000

    fish: Don't use external pod2text program.
    
    This removes the dependency from guestfish to the external
    pod2text program (and hence the final dependency on perl for
    guestfish).  This is done by storing the formatted pod2text
    output in guestfish as the help text.

commit b4c853f7d493af1d71f352832fed29eb7e377e8f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 26 21:49:58 2010 +0000

    generator: More options for internal pod2text generator.
    
    Allow extra width, and trimming options.
    
    This necessitates a change in the memoized format.  To avoid
    causing crashes if a new generator loads the old format, also
    change the filename of the memo file.

commit 60b3c8e81124a881cd93ed66c167cac37e87c36b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 26 18:26:09 2010 +0000

    libtool fix: Don't do fix if there was no -o option to libtool.
    
    For example if libtool is being run as 'libtool --mode=execute ...'
    
    This fixes commit 4cf4f2b66f850bb39c5bf29d3cd12ada9114d67e.

commit 9e6a8a4cbb30f6f4718669db0c4f7781ea3d6249
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 26 16:50:50 2010 +0000

    Version 1.7.15.

commit a44ec081b6ea10036ca0734197a47b1dfa035a1a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 26 16:53:06 2010 +0000

    build: Add several missing shell scripts to dist.

commit 4cf4f2b66f850bb39c5bf29d3cd12ada9114d67e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 26 16:48:55 2010 +0000

    Remove dependency_libs from libtool *.la files.
    
    Add a libtool wrapper which kills dependency_libs in libtool *.la
    files, to ensure that libtool doesn't add unnecessary extra libraries
    when linking.
    
    See http://lists.fedoraproject.org/pipermail/devel/2010-November/146343.html

commit 18de192b0a4b71ade57acc0b6af311cc17a1bf0a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 26 16:49:54 2010 +0000

    df: Missing direct dependency on libvirt.
    
    virt-df has an (optional) direct dependency on libvirt.  Because of
    libtool's over-linking behaviour this was being missed.

commit a6054bf90f39a84c1a8f8f7d3b9e81e84cb13696
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 26 11:36:50 2010 +0000

    rescue: Rewrite virt-rescue in C.

commit 076a9726e608c914cd4785e9a14e9a903a61ca34
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 26 11:37:28 2010 +0000

    Update HACKING description of tools/ subdirectory.
    
    This fixes commit 18374b5b7d3154e0b8b8a07e3590f6eee762b58e.

commit 403ac796a5067ac558ceca2409270eb55b477299
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 26 10:18:29 2010 +0000

    daemon: Close leaked file descriptor along checksum error path (RHBZ#657499).

commit 746c4b7789ad82e7b7521e456069cef8a1a9592c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 25 18:53:54 2010 +0000

    Version 1.7.14.

commit 18374b5b7d3154e0b8b8a07e3590f6eee762b58e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 23 12:05:04 2010 +0000

    df: Rewrite virt-df in C.
    
    I have diffed the output from the original virt-df with this
    new version, and they agree very closely.  Some differences:
    
     - Old virt-df have a divide-by-zero error in cases where the
       number of used inodes was 0.  New virt-df fixes this.
    
     - New virt-df uses gnulib human_readable library which displays
       numbers to 3 significant figures for -h output (old version
       used an ad hoc function).

commit 4838ec3326d2970e6afe3cde6b368aeae840b969
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 25 15:38:26 2010 +0000

    Export private function 'guestfs___for_each_disk' for use by virt-df.
    
    This private function (not part of the API) allows us to
    iterate over disks from a guest, avoiding the business of
    writing all the XPath code yet again.

commit 70faafe8d4f0c06c3e62c1e1469289255ee30c53
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 23 13:16:01 2010 +0000

    fish: Keep device names in options drives list.
    
    In the 'struct drv *drvs' structure, keep a list of the
    device name(s) for each added drive or guest.  The device name
    is the canonical name as that drive would be known inside
    libguestfs, eg. "/dev/sda"

commit dfa9d6cf32b23e34eeba916a9a263483990a3fce
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 25 15:36:57 2010 +0000

    Fix memory leak (xptype XPath obj) in add-domain API.

commit 3fc6dde15cf47b0cc837fb513ea7b91a12df8ae0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 24 20:02:09 2010 +0000

    Version 1.7.13.

commit 37366ede50b78ff9159e080ebae08a822795452a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 24 20:06:22 2010 +0000

    build: Remove some non-existent files from CLEANFILES.

commit 37e632b7b8e1bd8c9893bb8e3c9a8691c78256a4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 24 18:49:37 2010 +0000

    ruby: Translate C examples into Ruby and include documentation.

commit 472722a72df89895bb11a1244eafa7915b1af116
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 24 18:10:50 2010 +0000

    python: Translate C examples into Python and include documentation.

commit 086bd1f7bfab4c10d890ecca3506a1b091c0d398
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 24 13:34:16 2010 +0000

    ocaml: Translate C examples into OCaml and include documentation.

commit 58012dc9b67aa1b5de9c5dc70e7e471de3ed2a6a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 24 17:19:28 2010 +0000

    docs: Standard C examples, and guestfs-examples(3) man page.

commit e1aca6323e33e0dd50e23dc0d638f5789c9188e4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 24 15:19:33 2010 +0000

    build: Centralize all POD manipulation in 'podwrapper.sh' script.

commit c1592ac93886e7f39a6017272b2486d3f411d054
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 24 14:28:32 2010 +0000

    build: Rename bugs-in-changelog.sh

commit 0f478933108de342b0948b9e3cc6d4f00fbbfe0a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 24 14:25:57 2010 +0000

    build: Rename update-bugs as update-bugs.sh.

commit 4e3837d0f31af26dd460f7196323af10aac24be1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 24 12:42:17 2010 +0000

    generator: Remove unused variable.

commit d20b9cd6b82e26dd2f8cf43d9cc8f1e518f2e077
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 24 11:17:45 2010 +0000

    fuse: Add note in test about how to debug guestmount.

commit 951ea0e189f051c85de14c508d90d3bad0f1ca7a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 24 10:00:06 2010 +0000

    build: virt-make-fs requires String::ShellQuote, add to configure.

commit c6478d6a01c210ef19735429d7602e3458733e25
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 24 08:38:35 2010 +0000

    regressions: Fix test-launch-race to work in non-supermin case.

commit 5d7ee3f0c5b65cc7c417d762a648ce6c5bfdb532
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 23 20:05:56 2010 +0000

    daemon: blkid cache is at a different location on Debian.
    
    Remove both possible cache locations.

commit bd631df66f3eac3156e24ed8c1180d83f0f3a629
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 23 19:56:30 2010 +0000

    debian: Include ntfsprogs in the appliance.
    
    This allows us to build NTFS filesystems at least.  Mounting
    NTFS doesn't work in Debian because of a problem with debirf.

commit 22a50e4e3bb9125c5f2520b812811d4ae2bd7d72
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 23 19:05:53 2010 +0000

    inspect: Detect if db_dump and db_load programs are available.
    
    If db_dump is not available then disable RPM application detection.
    
    Note these utilities have odd names on Debian.

commit 72932bd0c94aa18c6054e7b70b852918f3b01293
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 23 18:42:28 2010 +0000

    build: Move po4a detection up near other program detection.

commit b9bd24b943f22f07b2ed5bf7edeab89bc8028f7e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 23 18:41:59 2010 +0000

    daemon: In sfdisk call blockdev --rereadpt with device name.

commit 8d3e97679a698386980bd1e5e5833542412a56f6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 23 18:12:26 2010 +0000

    ocaml: Fix some unused parameter warnings in OCaml bindings.

commit 4220b7a6411f1eeecc616e37adaa5b2d2fe9aec1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 23 15:55:50 2010 +0000

    Update README to reflect Perl modules that are really still required.

commit 12eb3eb8ab2e64ddccf319f7ddc9ef5fe4a3763a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 23 15:54:08 2010 +0000

    build: XML::Writer Perl module is no longer required.

commit fa0c588d1e70c1eb7020aa14484844bf43ed13ea
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 23 12:05:15 2010 +0000

    filesystems: Fix command synopsis in usage message.
    
    This updates commit fbc2555903be8c88ad9430d871cf0d27c8fded1e.

commit 9e6f85877c3f72bfb17d575601a253d560613569
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 23 10:21:56 2010 +0000

    Version 1.7.12.

commit d90bc32c7472da047c304d74e3a9e4cc21f6080b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 23 10:29:12 2010 +0000

    fish: Link to virt-inspector from guestfish man page.

commit fbc2555903be8c88ad9430d871cf0d27c8fded1e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 22 17:33:35 2010 +0000

    New tool: virt-filesystems
    
    This tool replaces virt-list-filesystems and virt-list-partitions with
    a new tool written in C with a more uniform command line structure
    and output.
    
    This existing Perl tools are deprecated but remain indefinitely.

commit f6d3d5677194ae7aaea70d43845341d91907b5ee
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 22 12:37:55 2010 +0000

    ls: Rewrite virt-ls in C.

commit f33d899fd0900b0cfe6dbbb152ce2fcf479bd38c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 23 09:47:34 2010 +0000

    resize: Fix canonical device function (RHBZ#655554).

commit f8af59c234b6bea50dadc7a6055c8a4739ca4530
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 23 09:03:23 2010 +0000

    inspector: Make whole disk paths canonical (RHBZ#655554).

commit 938c98ad76bd896be750dbc69ade5e251afb8dea
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 22 17:32:32 2010 +0000

    inspector: Fix documentation of -x option in usage.
    
    This updates commit c5cb65f0aac3298e634b183f73fda6644a158018.

commit b875f8e115842b37e6c7c9e59cb263a1cbb334aa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 22 17:31:15 2010 +0000

    cat: Fix documentation of -x option in usage.
    
    This updates commit d29e9a552f5823d1d8cb8d4962cb1301bbf60b0e.

commit 730d4db45ec95d9c9592d7721ff1c5a3db036816
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 22 13:09:26 2010 +0000

    cat: Continue after encountering an error.

commit cb8403c4282ddfbcc204920c72a104eb7f69e373
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 22 12:38:18 2010 +0000

    cat: Fix documentation for command line with format option.

commit 3d3ec55c35f1d2ee8a46b5b685164139f8ef0324
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 19 22:50:30 2010 +0000

    inspector: Fix rule to build HTML file.
    
    This updates commit c5cb65f0aac3298e634b183f73fda6644a158018.

commit ccea24323b1646badf463aaf0ce9fa46adb890fd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 19 22:31:24 2010 +0000

    Version 1.7.11.

commit 16127e773b12ac2395858a2914d340af211c1f48
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 19 22:30:54 2010 +0000

    po-docs: Remove virt-inspector.pl reference from Makefile.am.

commit c5cb65f0aac3298e634b183f73fda6644a158018
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 19 12:48:21 2010 +0000

    inspector: Rewrite virt-inspector in C.

commit 60a62788d48e1d45fcb75cf0bcc7d375c42b83ba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 19 15:31:22 2010 +0000

    fish: Fix memory leak in handling of encrypted volumes by -i option.
    
    This fixes a memory leak introduced by
    commit a232e62dcf508517a32b9a8d7e4529e827be721b.

commit 4f9a670d09b4d620fccc36e7c2df8fc912749f97
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 19 15:30:45 2010 +0000

    inspect: Fix memory leak of hostname.
    
    This fixes a memory leak introduced by
    commit fab75c0337d7897d10ea5e95e47ac05eab81ace9.

commit 53f670c33ad8609c9733aa8e8e3555091fdc9f87
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 19 15:13:00 2010 +0000

    cat: Fix run-cat-locally script so it doesn't go via Perl.

commit 3bd883f344a5d6f155f7252e8a478d5b7935d7c6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 19 13:05:49 2010 +0000

    cat: Give a better error if the user specified no drives on command line.

commit 06e993b7bac2fa1d506b24848c4ffddbdfdf49bc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 19 12:56:06 2010 +0000

    cat: Tidy up documentation for --format option.

commit 16e39ac0b8583c60fb1bc3378483b91886ed6f85
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 18 15:32:05 2010 +0000

    Remove FIPS .*.hmac files from the supermin appliance (RHBZ#654638).

commit e1ad5afaea3f6a3d3ca4131c259b76792b150d2e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 17 23:13:36 2010 +0000

    Version 1.7.10.

commit f445d25d7b6bb65470564c96d7198d63538880a3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 17 16:43:18 2010 +0000

    generator: trace mode prints return values.

commit 6c6aa111795b20533a99a7e38b614b2aa1c0ccb7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 17 16:06:55 2010 +0000

    generator: Make return value into an explicit variable.
    
    This is just code motion.

commit a5884a88fc57174c43d2ae9b50b437a60f6baf0b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 17 15:54:06 2010 +0000

    generator: Make trace flag an explicit variable.
    
    This is just code motion.

commit 5067f8fc779837385c6ce4a41e60420ffa52bbe9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 17 15:07:45 2010 +0000

    todo: Suggest that trace should include return values.

commit 4ac31247605dbcbe4b19212148de0a8671d0a43d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 16 23:34:07 2010 +0000

    rescue: Fix typo in documentation of --network option.

commit 91b490ec79f4f935ff1552b39053ac6fc2b1f0a6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 16 19:08:16 2010 +0000

    Version 1.7.9.

commit 9d3f336152ba9390ed2b27579c4b625d46e3c50d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 16 17:46:50 2010 +0000

    inspector: Replace old examples with ones derived from phony images.

commit fcc631dedb894379cde01af563df3f6a364db7cb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 16 17:37:30 2010 +0000

    images: Make phony Windows image for testing.

commit 9becb385b78eddb9b3817c6accaa6cdb3db0b5af
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 16 16:27:20 2010 +0000

    images: Make phony Ubuntu image for testing.

commit 858d75d3911c9715bf62c3e8088cce3e991fb0fc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 16 16:17:33 2010 +0000

    images: Make a phony Debian image for testing.

commit 6d4815d3a4921219379bc9ec3cceead217668426
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 16 15:41:16 2010 +0000

    images: Make a better phony Fedora image.
    
    This now includes a product string, major and minor version,
    hostname and even some applications.

commit 2bfeaeaa308adf27853c1ec6d1d958a3e4734b8e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 16 15:56:11 2010 +0000

    daemon: findfs-uuid and findfs-label should not return /dev/mapper paths.

commit fab75c0337d7897d10ea5e95e47ac05eab81ace9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 16 12:57:36 2010 +0000

    New API: inspect-get-hostname to return the hostname of the guest.
    
    This returns the hostname of the guest.  Tested on RHEL, Fedora,
    Debian 5, Ubuntu 10.10, FreeBSD 8, Windows 7.

commit 35afe0cb33c986bf595585a716ff259cf3415a1f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 16 12:45:50 2010 +0000

    inspect: Check /etc/lsb-release is not too large before calling head on it.

commit a4448956e9a815aff59cac3d98caf80f620fc4c4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 16 12:35:39 2010 +0000

    inspect: Add function to read the first line of a file, with safety checks.

commit 61cfe13ec49f1d1e9d6124f0ee98520aab720087
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 16 11:16:17 2010 +0000

    inspect: Abstract the wrapper that sets up Augeas.
    
    This is just code motion.

commit e428f914dda1c591f987e2b6f0ceaec828cd29c5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 15 23:22:08 2010 +0000

    Version 1.7.8.

commit 2cfd89d631319cf791c38b5b9f5a8a6331dc2ef2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 15 14:17:20 2010 +0000

    inspector: Replace code for listing applications with new core API.

commit 163be3d72a3f3dc902bcd0856d8aec448bc7907f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 15 12:26:36 2010 +0000

    New API: inspect-list-applications.
    
    This converts the current Perl code in virt-inspector for
    listing applications, into C, making it a part of the core API.
    
    This is also capable of fetching the list of Windows applications
    from the registry.

commit 8a3a4c25d3bb63674c9ccf8483d9bfd89085fe47
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 15 12:40:02 2010 +0000

    inspect: Centralize all file downloads through a single function.

commit 2729421d176e1194537b499911a5eeb5e32a8b09
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Nov 15 22:06:34 2010 +0000

    inspect: Add support for Linux Mint and Mandriva.
    
    Linux Mint is derived from Ubuntu.
    
    Mandriva has a release file, but it also has /etc/lsb-release and
    the same parsing code can be reused.  Mandriva has a package manager
    called urpmi.

commit a22d5a7390339eca5d9bafb2155439ad1ccc02ac
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Nov 15 22:21:15 2010 +0000

    docs: Put list of distros in alphabetical order.

commit 47af6aaab8f2dde736951b4e549c2638d942dae5
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Nov 15 22:20:51 2010 +0000

    docs: Debian and Ubuntu are now separate distros.

commit 3e766f745dc6cf351e56d9955f580152ddb9110a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 15 16:31:30 2010 +0000

    todo: live CD inspection

commit c3ae17cc79a4e8dd4be0a3ae65d33384c175573b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 15 10:14:16 2010 +0000

    Version 1.7.7.

commit e0afd9a3e4bbd073f36a4287744b4c5fe148413f
Author: Maxim Koltsov <kolmax94@gmail.com>
Date:   Sun Nov 14 16:21:56 2010 +0000

    build: Missing backslash again.

commit d8346d5d6428c7293d1ddf58e4f9ec4b7de25380
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 13 18:06:28 2010 +0000

    Version 1.7.6.

commit b943d06466724df39b7261ce75e43b0201ed7372
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 13 14:58:50 2010 +0000

    filearch: Refuse to download initrd if it is huge.

commit 9674a73c08e128d8a7a39a6be6140c373c0e61f0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 13 14:55:14 2010 +0000

    inspect: Fix error out path if minor_version parsing fails.

commit e44cf42f362d793c47d892a18a6853d88abd6ecb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 13 14:54:52 2010 +0000

    inspect: Refuse to download software hive if it is huge.

commit 692f127447d399db21c2e93026d4d2b0ac1839d1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 13 14:49:37 2010 +0000

    inspect: Refuse to parse /etc/fstab if it is huge.

commit 528cd8f64176ca50f5b82db5682b0ee31833b162
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 13 14:49:07 2010 +0000

    lib: Make some error strings localizable.

commit 79b202ca26226e0a95e3f04ac7ff91e9eb918b48
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 13 14:42:06 2010 +0000

    inspect: Inspection support for FreeBSD.
    
    This adds inspection support for FreeBSD.
    
    However this is not quite enough to allow guestfish -i freebsd.img
    to work, because guestfish will try to mount the filesystems,
    which cannot be done because Linux requires special mount options
    for the Universal Filesystem (UFS) used by *BSD.  Nevertheless
    you can manually run the same commands.

commit a5fd85e7392b589d9d90ab515ad3e4bd1befd874
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 13 14:41:01 2010 +0000

    inspect: Optimize root filesystem check.
    
    Avoid duplicate checks for things like /etc and /bin.

commit 55e6ccb23e0b1f954107b4d0284d3d41f7a4e7b8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 13 14:39:21 2010 +0000

    lib: Add match3 function.

commit a48ab78dc8272675caf7bebf17d2112aaaf6332f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 13 14:37:53 2010 +0000

    lib: Add safe_asprintf function.

commit cd96cca38cea638a6db76afceeed76babc9e763c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 13 12:25:56 2010 +0000

    docs: Add a section on security.

commit 35dbedb1b18157b2329e0e55d0b5355f26431814
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 13 11:32:47 2010 +0000

    docs: Rearrange guestfs(3) sections.
    
    This rearranges the sections into a more logical order:
    
     - synopsis and introduction
     - API-related overview sections
     - (security will go here, see next commit)
     - API in detail
     - architecture and other internals
     - usual end sections

commit 92444940f3ff80975e64e07e4a4861454101a529
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 13 08:13:18 2010 +0000

    static: Use correct libraries for static binaries.
    
    Also add virt-cat.static target.

commit 74cc619d942329043d646805c1b94be7df234d10
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Nov 13 07:15:46 2010 +0000

    Version 1.7.5.

commit aec3091fa9c65e2f84d0bf9cdd520e597957eca9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 12 20:25:45 2010 +0000

    ruby: Add 'make install' rule for ruby bindings (RHBZ#652796).

commit 2325c99d07fa750c1098a3b2bc1bc80fb6bc846a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 12 19:33:55 2010 +0000

    todo: Notes on parsing.

commit 3fd2b9d0b6d2bac5e9267fbcf1556f459d7313fe
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Nov 12 12:29:14 2010 +0000

    New APIs: inspect-get-package-format, inspect-get-package-management.
    
    This APIs reimplement some parts of virt-inspector in C.

commit 6ab57837216f498a08d33240c429ed678968fb78
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 11 23:36:54 2010 +0000

    capitests: Remove warning about dead definitions.
    
    This updates commit cb7ec8be4ce6068b6cbc6522a67826cdbd161024.

commit 59db941bf64eae2eed6a8e6451e04aa0cbec8294
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 11 23:36:04 2010 +0000

    Check that just including <guestfs.h> on its own works.

commit 096f341714ee7d1575c93d437a8085821aa88d23
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 11 23:18:57 2010 +0000

    Don't need to include XDR headers in <guestfs.h>.
    
    Include the XDR headers in the internal guestfs-internal.h instead.
    
    This is knock-on effects to several other source files which
    were implicitly relying on indirectly loaded headers.

commit 649b990bbfe4127841d73ae86c92cc902ec56e93
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 11 23:17:37 2010 +0000

    Be less verbose in the macros defending typedefs in <guestfs.h>.
    
    This updates commit 4d59e271046f2b5f0d9b1730cd23425fd631c76c.

commit 3431f397d34740fcd3a2d6f94d03af6e5f8f1a36
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 11 22:25:15 2010 +0000

    perl: Ignore debug functions in Test::Pod::Coverage.

commit f614a6dde922a9bd7351138ed6ebd524634bbd16
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 11 19:04:40 2010 +0000

    Version 1.7.4.

commit f6c4026f85fa6ded33a51ec2757abda9f116fd5f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 11 18:03:12 2010 +0000

    build: xml-light is no longer required (thanks Maxim Koltsov).
    
    At some point we removed the last thing that required
    xml-light, but were still testing for it at various places
    in the build.  This removes all traces.

commit d29e9a552f5823d1d8cb8d4962cb1301bbf60b0e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 11 14:53:51 2010 +0000

    Rewrite virt-cat in C.
    
    With changes in the core API since 1.5, virt-cat was little
    more than a Perl wrapper which did some command line argument
    processing.  Thus it could easily be rewritten in C.
    
    This version also shares core command line argument processing
    with guestfish and guestmount, so the options have changed
    slightly (old-style command line *is* supported).
    
     virt-cat -a disk.img file [file ...]
     virt-cat -d domname file [file ...]
    
    Several other guestfish options are supported including encryption,
    and with the new style multiple files can be downloaded.  See the
    man page for details.

commit 4d900cdac8258daa2e99c6ceb2a4985154e94150
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 11 16:20:25 2010 +0000

    Generate a dummy 'Fedora' fedora.img in images directory for use by tests.
    
    We were generating this dummy 'Fedora' image already in the
    tools directory.  It contains just enough Fedora-like files
    to fool our inspection code and thus to test the tools.
    
    This is general enough that we can use it everywhere.

commit 4d59e271046f2b5f0d9b1730cd23425fd631c76c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 11 12:14:37 2010 +0000

    Defend all typedefs in <guestfs.h> with #ifdefs.
    
    This allows other libraries to redefine those typedefs
    if they need to use but not depend on <guestfs.h>.

commit 6263da7474c6e7818b025979712c9c5d7108640d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 11 11:51:02 2010 +0000

    lib: Make <guestfs.h> be completely generated.
    
    This removes the 'not-quite-separate' guestfs-actions.h and
    guestfs-structs.h files.

commit 4a3726d5ed0dd3174b46ec574eaf4f4140cb193b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 11 11:49:49 2010 +0000

    Fix small typo in a comment in src/Makefile.am.

commit cb7ec8be4ce6068b6cbc6522a67826cdbd161024
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 10 11:31:01 2010 +0000

    capitests: Add the code to test (proposed) add-libvirt-dom C API.
    
    This API was dropped as there are some problems with it.  This
    commit adds the original test code, but commented out.

commit 7509c91a71c729b3223eef4cde10d70daca66c72
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 9 18:56:00 2010 +0000

    fish: Use core add-domain API to implement '-d' option.
    
    This also makes libxml2 and libvirt into optional dependencies.
    If they are missing then the core API will print an error, as
    will the '-d' option to guestfish.

commit f08fe63761d4186d49212b1d2382b1a5a2b8a62f
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 9 18:53:01 2010 +0000

    New API: add-domain
    
    This new API allows you to add the disks from a libvirt
    domain.
    
    In guestfish you can use the 'domain' command to access the
    API, eg:
    
    ><fs> domain Fedora14 libvirturi:qemu:///system
    1
    
    The returned number is the number of disks that were added.
    
    Also here is a proposed (but commented out) low-level API
    which would allow you to add a domain from a virDomainPtr.
    However there are several problems with this API -- see discussion
    on the list:
    https://www.redhat.com/archives/libguestfs/2010-November/thread.html#00028

commit 4ada0a7815075c9cbe9d8b00da791c105ae739a9
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 9 12:08:06 2010 +0000

    generator: Add Pointer parameter type to the generator.
    
    This allows generic "foo *bar" pointers to be passed to
    library functions (not to daemon functions).
    
    In the language bindings (except Perl) these are handled
    as generic int64s with the assumption being that any
    pointer can be converted to and from this.  There is room
    to add specific support for some pointer types in future
    by specializing the match cases.  However this is inherently
    tricky because it depends on the implementation details of
    other bindings (eg. to support virDomainPtr in OCaml depends
    on the implementation details of the ocaml-libvirt project).
    
    Perl is slightly different in that you have to supply a
    typemap.  Again this would depend on the implementation
    detail of an external library unless you supplied a generic
    typemap for int64.

commit eaedf025f5c45a4e05cbf25e145215d48bea8f8d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 10 10:32:33 2010 +0000

    New API: debug-cmdline for printing QEMU command line (internal only).
    
    This is an internal-only debugging API so may be changed or
    removed at any time in the future.

commit 1c29849e0bdc731c023cff00d2c2354a41fd2a92
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 9 18:50:57 2010 +0000

    Add internal facility to checkpoint and roll back the command line.
    
    This internal interface can be used to ensure that certain
    operations are atomic.

commit a0b4caa0821b759de01361b7019c9c9c9607027d
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 9 15:59:40 2010 +0000

    lib: Make pcre, libmagic and hivex libraries optional.
    
    This change makes these libraries optional.  If they are not
    available at compile time then certain core API features will
    be disabled (see below).
    
    This also changes PCRE detection to use pkg-config instead
    of the ad hoc autoconf checks.
    
    The large inspect.c file has been split out into separate
    function-specific files.
    
      file-architecture: requires pcre & libmagic
      inspection: requires pcre & hivex

commit ec63875f9cd7277cf2d49827684bba936add7ce2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 10 10:32:12 2010 +0000

    Don't include debug* commands in the documentation.

commit 2ee6ea2ce128d200928173f3d4b40cadae17de93
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 10 10:51:46 2010 +0000

    capitests: Add whitespace in Makefile.

commit 8ac9575b204a8ac85f9030500cb6eabbf6aa3226
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 9 15:10:32 2010 +0000

    inspect: win64 regexp was dead code.

commit b52183b5491748d9e979d30e55db6d648b102416
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 9 14:50:23 2010 +0000

    lib: Augeas (client side) is not needed by the library.
    
    However it is used by the daemon.

commit bf3b9e2e236b4dd2216200993ba39545ad5160bb
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 9 12:05:08 2010 +0000

    ocaml: Error on compiler warnings.

commit a6454a437f98cc15d8347960f348937c651942e3
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 9 12:04:29 2010 +0000

    ruby: Remove extra space before parenthesis.

commit ed2bd31f9128036cd59399e1d8234023806082a7
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Nov 8 22:36:24 2010 +0000

    Revert "autogen: Touch ocaml/.depend"
    
    This reverts commit a0f85ba643990da25b6afe6a2bbd2407cf312c73.

commit e3acf93ce9e87ce308cf50a4f41408b25dd910e9
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Nov 8 22:35:13 2010 +0000

    Revert "Remove ocaml/.depend from git."
    
    This reverts commit 064569bcbf854a9cf588ce31851d987d5f114ec8.
    
    This commit does the wrong thing: creating an empty ocaml/.depend
    file is wrong because building the OCaml bindings will fail.
    Not having this file will prevent automake from running.  Therefore
    this file has to exist with the correct content in git.

commit 04df249d82ba3a24582bbbf1ad43b3c6ae2b1962
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 8 15:52:07 2010 +0000

    Version 1.7.3.

commit 5a10318ac808fb3cb0bf9071e0cf6b63a0b3eb6a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 8 15:29:35 2010 +0000

    build: Create an AUTHORS file.

commit e5ec461c67820f050b049b41a630069f0efe96d1
Author: Maxim Koltsov <kolmax94@gmail.com>
Date:   Mon Nov 8 15:10:14 2010 +0000

    build: Don't try to rebuild po-docs/<lang> if no po4a.

commit b0a48fa4504f85baa484987f54d8f99703e3ed3b
Author: Maxim Koltsov <kolmax94@gmail.com>
Date:   Mon Nov 8 15:08:01 2010 +0000

    build: Add ./configure --disable-php option.
    
    This disables the PHP language bindings.

commit 8e4a4d3d88b814504c6f2abbf6bf3dab789021b1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 8 14:53:48 2010 +0000

    build: Test for virt tools Perl libraries conditionally.
    
    Only test for these if $PERL is defined, and use $PERL as
    the interpreter.

commit ada875642332b56acbf75d68e964f2f16ca50530
Author: Maxim Koltsov <kolmax94@gmail.com>
Date:   Mon Nov 8 14:46:46 2010 +0000

    build: Add ./configure --disable-haskell option.
    
    This disables the Haskell language bindings.

commit 5b99e1b983b38d3405662c1e2b16f2731d465ce3
Author: Maxim Koltsov <kolmax94@gmail.com>
Date:   Mon Nov 8 14:35:13 2010 +0000

    build: Add ./configure --disable-ruby option.
    
    This disables the Ruby language bindings.

commit 041969480a2712311c2a82a0c118426793a9b338
Author: Maxim Koltsov <kolmax94@gmail.com>
Date:   Mon Nov 8 14:27:27 2010 +0000

    build: Warn if Python include or site-packages not found.

commit 3a7eb8ebdb47878ab9bd6b8aff88744365179f87
Author: Maxim Koltsov <kolmax94@gmail.com>
Date:   Mon Nov 8 14:24:59 2010 +0000

    build: Add ./configure --disable-python option.
    
    This disables the Python language bindings.

commit 57c74708ca4e00db259903998b67489e50b8d12b
Author: Maxim Koltsov <kolmax94@gmail.com>
Date:   Mon Nov 8 14:16:15 2010 +0000

    build: Add ./configure --disable-perl option.
    
    This disables the Perl bindings.

commit 53c524819323dcea8d5e3d56ff4fc6cf49b6c64f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 8 13:59:44 2010 +0000

    ocaml: Remove the old OCaml viewer program.
    
    This program is obsolete and the code has been reused for
    guestfs-browser here:
    http://people.redhat.com/~rjones/guestfs-browser/

commit af7af2fc5e48e4efecd1f65b60e61b88733161b9
Author: Maxim Koltsov <kolmax94@gmail.com>
Date:   Mon Nov 8 13:55:49 2010 +0000

    build: Add ./configure --disable-ocaml option.
    
    This can be used to disable the OCaml bindings.  Note that
    OCaml is still required in any case where you need to rerun
    the generator.

commit 428a45c3e15f03e9861e1b551e1ae8da821dba5f
Author: Maxim Koltsov <kolmax94@gmail.com>
Date:   Mon Nov 8 13:12:53 2010 +0000

    build: Add ./configure --disable-fuse option.
    
    If this option is specified, FUSE support is unconditionally
    disabled.

commit 4e656a61d40ff51e63aa06d857c40c14ff31ddb9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Nov 8 12:46:31 2010 +0000

    supermin: If disabled, don't compile in supermin code or check for supermin.
    
    If supermin is disabled at compile time and the user just wants to
    use the ordinary appliance, there is no need to compile in all
    the supermin code, and in particular there is no need to check
    for the supermin appliance (which involves running
    febootstrap-supermin-helper that probably doesn't exist).
    
    This fixes a warning message observed under Debian w/o supermin:
    
      sh: febootstrap-supermin-helper: command not found

commit 2c4a7ef92a4583a1217213573ad406eb5d745990
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 5 18:36:02 2010 +0000

    fish: Add --rw option (does nothing yet).
    
    This adds the guestfish --rw option, intended in future
    to be required for writing to disk images.
    
    At the moment this does not change the default and so does
    nothing.  This patch is intended for backporting to the
    stable branches so that we can start to introduce scripts
    which use 'guestfish --rw'.

commit 26118d498eefe10c8fa604f949680d2417c8b25c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Nov 7 09:54:51 2010 +0000

    Add missing generated files to the tarball (thanks maksbotan).
    
    C# bindings were omitted entirely.  Add a Makefile.am for this
    directory even though we don't build these.
    
    Because of a missing backslash, some POD files were not being
    included.

commit 371e83c0902d0f6949a09095b1b10280d8881aac
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 5 15:17:45 2010 +0000

    fish: Add --listen --csh to for csh, tcsh compatibility.
    
    (Thanks Eric Blake).

commit be728962ff636e260f09dca6a1175c442d687551
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 5 15:07:11 2010 +0000

    fish: Suggest safer form of eval.
    
    eval "$(guestfish --listen)"
    
    instead of various other forms.
    
    (Thanks Eric Blake).

commit 633ae13c80d40b0f30db73e520c08cf365d2f8a3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 5 15:04:08 2010 +0000

    fish: More portable export sh statment.
    
    Don't depend on bash, but allow sh/dash/etc format:
    GUESTFISH_PID=nn; export GUESTFISH_PID
    
    (Thanks Eric Blake).

commit 7d8807ec3bc0b772d65e2ca1196f0980a037504e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 5 13:43:08 2010 +0000

    New API: inspect-get-roots to return roots from last inspection.
    
    Return the roots found by the last call to inspect-os, but
    without redoing the whole inspection.

commit 9f7926e7274aea9be43cf4bc1a9d1cf42ac6bec0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 5 13:42:07 2010 +0000

    generator: Don't die if an API call isn't listed in API versions file.
    
    For example, it may just have been added.

commit 12cf2f732a275928a7ce727840e1f5ba6684754d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 5 12:20:21 2010 +0000

    Version 1.7.2.

commit e51d6724d55c3a8c39b97c23abdf0b6168833e10
Author: Guido Günther <agx@sigxcpu.org>
Date:   Fri Nov 5 12:24:32 2010 +0000

    configure: Test for 'kvm' binary.

commit 7fc338690f385c2495b7ba5f98346a5c057991ea
Author: Guido Günther <agx@sigxcpu.org>
Date:   Fri Nov 5 12:23:11 2010 +0000

    Include <stdarg.h> in public header.
    
    Public headers use va_list, and this gives an error unless <stdarg.h>
    had been included before the header.

commit 6283982e36eeb3d19940618dc0aec88da08c7516
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 5 11:54:54 2010 +0000

    Don't print out key material in trace output.

commit a232e62dcf508517a32b9a8d7e4529e827be721b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 5 11:39:24 2010 +0000

    fish: '-i' option automatically handles whole-disk encryption.
    
    This feature is also available in guestmount because of the
    shared option parsing code.
    
    You don't need to do anything to enable it, just using -i
    will attempt decryption of encrypted partitions.
    
    Only works for simple Fedora whole-disk encryption.  It's a
    work-in-progress to make it work for other types of encryption.

commit 446db62e113594fef84d2f533ef3a1330153f0bb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 4 17:43:17 2010 +0000

    docs: Fix API support script.
    
    Before libguestfs 1.0.69 we needed to look in src/guestfs.c to
    see all the API calls.

commit ca236acc6773ba6712f499dc73a25e28acae85dc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 4 17:23:21 2010 +0000

    fish: Fix missing guestfish commands in HTML docs.

commit 74f7c9e4b7e27787e2052166eeedfbac5814200b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 4 17:04:03 2010 +0000

    fish: Make the 'help' command more helpful.

commit 7e3d76e41b3c2862ae04744b01e5e23b245393e4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Nov 4 08:43:10 2010 +0000

    docs: Which API calls were first supported in which upstream versions.
    
    Run src/api-support/update-from-tarballs.sh (this won't work
    unless you have a local copy of the tarballs from the website).
    
    src/api-support/added contains the result of running the
    script, a list of pairs: (API name, version first appeared).

commit bfeffeb1e4d6f3725eb8148c098505a9d81a7ba5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 3 23:17:51 2010 +0000

    virt-win-reg: Current is the control set Windows chooses at boot.

commit 9694cd59f8250ae84c23922fda5cbb751e846e3c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 3 22:23:55 2010 +0000

    HACKING: Mention PHP bindings.

commit 19ea54b3f488755731ffc079519d6011dade9e5c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 3 22:11:22 2010 +0000

    docs: Indent *_va and *_argv functions correctly.
    
    This fixes commit f661db2c393d1b7e4211c55682b7fac82a70e36d.

commit ece3b30e4957b2d1d02377a82afb132e8061804d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 3 21:09:51 2010 +0000

    Version 1.7.1.

commit 58915725b1e464f7d447c0051ad916fbc1a82210
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 3 20:34:42 2010 +0000

    fish: Use a perfect hash for faster command lookups.
    
    Existing command lookups are approx O(n^2).  Replace this
    with a perfect hash implementation which should be a lot
    faster.

commit f661db2c393d1b7e4211c55682b7fac82a70e36d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 3 19:26:10 2010 +0000

    generator: Properly lay out and indent multi-line C function decls.

commit 5d6a91844520d07f9477e2ddca4caf8f040ef8a1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 3 18:33:31 2010 +0000

    docs: Clarify no additional error available from guestfs_create.

commit 01d613ae957431d65c700a34e369ef4c06dd6d8f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 3 18:29:58 2010 +0000

    docs: Clarify default error handler.

commit 6a218092812783eaea43919674eb8d1c74a80b33
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 3 18:02:08 2010 +0000

    docs: Error strings are in fact localized, documentation was wrong.

commit aae5bebe6878c01803653fae166c58b7217b6100
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 3 18:01:48 2010 +0000

    docs: Clarify, not every function that returns int returns -1 for errors.

commit 9cd1810b5e5b0a09f1a6eaf64fa14b924fbb0eae
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 3 17:24:50 2010 +0000

    capitests: Test guestfs_last_errno call.

commit 39052d270fcce991238fc5f9939677b5d6e31d15
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 3 16:15:48 2010 +0000

    fuse: Use guestfs_last_errno instead of errno-reversal-hack.

commit 2066805a5d93b62beaf6653324715f0b62b06a05
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 3 15:49:36 2010 +0000

    lib: Expose errno through new API guestfs_last_errno.
    
    If either the daemon sends back an errno, or a system call
    fails in the library, save the errno in the handle and then
    make it available to callers through the guestfs_last_errno
    function.

commit d859c283c469b9d9124d90d0ac32024671372ed5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 3 12:53:00 2010 +0000

    daemon: Send back the errno as a string.
    
    This changes the protocol again so that if the errno is available,
    it is converted to a string (like "EIO") and sent back over the
    protocol to the library.
    
    In this commit the library just discards the string.

commit 2be1648632e5e8dca06d84349314ab5e84f29e5c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 3 17:00:29 2010 +0000

    capitests: Test guestfs_add_drive_opts with optional args from C.

commit b535363e7e7a000cca3651790f911b2d0605968f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 3 16:56:34 2010 +0000

    capitests: Test some basic aspects of the C API.

commit 162c89ed497212859d748506209ffc1b88763ab2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 3 17:37:07 2010 +0000

    capitests: Use ftruncate instead of seek + write to create test files.

commit ec0fe45e48fa4621fc6fa0f5bcc44f184068c86f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 3 17:34:27 2010 +0000

    capitests: Don't open test files with O_NONBLOCK.
    
    I have no idea why we were doing this.

commit 2a33d81e2b7fa2affaaad48538307c818b4a8260
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 3 17:26:00 2010 +0000

    capitests: Set path in TESTS_ENVIRONMENT instead of in tests.c
    
    By exporting LIBGUESTFS_PATH with the right path to the appliance,
    we no longer need to hard code the path in tests.c

commit 8ccc6cd1f798f960e520ea8de24eb1f6a1313d3a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 3 15:46:46 2010 +0000

    generator: Remove unnecessary macro redefinitions.
    
    These macros are already defined in guestfs-internals.h

commit 6b8d05438cc0309f762fabf2f3cc7ae4bf5521c1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 3 15:48:04 2010 +0000

    Define internal safe_calloc shorthand.

commit 9ff99418361cd1b56b00e4ffef52444021e60c72
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Nov 3 12:52:24 2010 +0000

    daemon: Don't use ../src path to include generator_protocol.h
    
    This file is already hard-linked into the current directory, so
    the relative path is not required.

commit c5a6584c4fcc0051e1a333838d7562a4fba7ad1f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 2 20:57:40 2010 +0000

    tests: Remove use of sfdisk from tests.
    
    Some older tests used sfdisk to create partitions for the
    tests.  sfdisk is buggy (more so than parted -- what is it
    with partitioning tools?) so replace these tests with
    equivalent part-* commands.

commit 1937698c25fb9f066dba7b48ad4731927e3e74da
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 2 20:33:06 2010 +0000

    daemon: Tolerate failure of blockdev --rereadpt after sfdisk.
    
    See commit 840536ea5a0568296dfd3e483442c76b93c5a949
    and commit 956fc5a3feacc970ea763697bf28fb686c875408.

commit 47d158596140328e12aa3b8028a77dd40bf12eeb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 2 17:05:58 2010 +0000

    binary: Link guestmount static binary with -lm.
    
    This is indirectly required via the new shared guestfish
    C inspection code by libxml2.

commit c36214c6825d77f1706c5eb5f6316bed88f240e4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 2 17:05:43 2010 +0000

    website: Distribute BUGS and RELEASE-NOTES files to website.

commit a2591230c12efad4a6ad843d9b8991e44fecabb2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 2 16:23:58 2010 +0000

    Version 1.7.0.

commit 3fac199a8b4f4580d348807769d964b94179cd7f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 2 16:18:30 2010 +0000

    Final RELEASE-NOTES file for version 1.6.0.

commit f0c28b391c2ca6d8be4b7b7313042a6b3eb4dc8c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Nov 2 10:11:04 2010 +0000

    inspect: Add support for MeeGo.

commit bf0280bf589573c11529999a73e9ec642dea9d61
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 29 15:49:36 2010 +0100

    Version 1.5.26.

commit 7badf512f6859c2585c434a6d3f5772979bb5131
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Oct 29 11:54:34 2010 +0100

    inspect: Add support for Ubuntu.

commit 96b44334dd7421b8209f839faccb216a2cb0f773
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Oct 29 10:53:05 2010 +0100

    inspect: Add detection of Gentoo.

commit b4618fb060b40ba70f2be28b1b1ad625722a7edf
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Oct 29 10:32:53 2010 +0100

    inspect: Add detection of Arch Linux.

commit 233530d3541dd67ce8fec7d9677cdf659c9d2900
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Oct 29 10:21:33 2010 +0100

    inspect: Add detection of Pardus.

commit a81bf3f3ef24c8b6d66aea1038f7a16a382ff375
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Oct 29 10:50:39 2010 +0100

    inspect: Generic parsing of MAJOR.MINOR in product names.

commit 6e9917f72528d75e819b810bea8e0abd875b6810
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Oct 29 10:49:38 2010 +0100

    inspect: Generic parsing of release files.

commit 994ae6e35650e1eeefe63e3871f55efc41c4f5bb
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Oct 29 10:23:28 2010 +0100

    inspector: Sort <filesystems> section.

commit 12cf22ade46ba07aa162a311d3369096292d6d02
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 29 09:46:59 2010 +0100

    inspect: Ignore Pardus "/.swap" swapfile.

commit a0f85ba643990da25b6afe6a2bbd2407cf312c73
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Oct 29 09:53:57 2010 +0100

    autogen: Touch ocaml/.depend

commit 9f5d2171b8ab6ddedbf1822f24d4da969457433c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 28 22:56:11 2010 +0100

    inspector: List Debian packages.
    
    List Debian packages by downloading and parsing the file
    /var/lib/dpkg/status.

commit 6548a876f367427404a0f9ce9a634b01e0ccac78
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 28 22:32:50 2010 +0100

    inspector: Introductory documentation for XML format.

commit 99ed8d1be7547c3f2c7f7fdd479ab327b5c5ecc5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 28 22:32:05 2010 +0100

    inspector: Debian package format 'deb' instead of 'dpkg'.

commit 237627df37b97c18362755f646bbe1c4b05ee692
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 28 22:29:43 2010 +0100

    inspector: Return canonical block device paths in XML.

commit 4c5ca903b52ccc785a3d879da8506be248b0d6f7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 28 18:46:13 2010 +0100

    Version 1.5.25.

commit f2460699ab7f972b1981d072164a04820c52b0c6
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Oct 28 15:19:14 2010 +0100

    Ensure atomic creation of a cached appliance
    
    Cached appliances are discovered by their predictable path. Previously we were
    creating a cached appliance directly in this predictable path. This had at least
    2 undesirable effects:
    
    * Interrupting appliance creation would leave a corrupt appliance
    * 2 processes could simultaneously attempt to create the same appliance, causing
      corruption.
    
    This patch causes the cached appliance to be created in a temporary directory,
    and then renamed to the predictable path. As rename is an atomic operation, this
    makes the whole creation atomic.
    
    This patch also changes the predictable path to have a prefix of 'guestfs.'.
    This will make it simpler for system administrators to clean up old cached
    appliances.
    
    This patch resolves RHBZ#639405

commit 38af2eaceb4c8e9d675835bcd6e598ccb67daf0f
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Oct 28 15:19:13 2010 +0100

    Call febootstrap-supermin-helper using the new -u and -g options
    
    Use febootstrap-supermin-helper's new -u and -g command line options to setuid,
    rather than doing it in libguestfs.
    
    This resolves an issue with the generation of the cached appliance checksum. The
    checksum was being generated by a call to febootstrap-supermin-helper through
    popen(). Unfortunately, a bash misfeature meant that euid would be reset to uid,
    and the checksum was generated for uid, not euid. When virt-v2v is writing to a
    RHEV target, uid == 0 and euid == 36, which resulted in a cached appliance being
    created for root with permissions for uid 36.
    
    Note this requires febootstrap 2.10.

commit cf8add59d297d196facc2d0b9af45bb1d7946344
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Oct 28 15:19:12 2010 +0100

    Log the febootstrap-supermin-helper command line
    
    A side-effect of change 17e7cb9937a63ed8f9bb0fb6ac7302758be76846 was the the
    febootstrap-supermin-helper was no longer logged. This change adds it back using
    the new guestfs___print_timestamped_argv internal function.

commit 06fef60db5c7a96cb59aa92c4708e10333345e90
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Oct 28 15:19:11 2010 +0100

    New internal function guestfs___print_timestamped_argv
    
    This function generalises the existing print_cmdline used to output the qemu
    command line to output any given command line, and exports it to other modules.
    It also adds a timestamp to the old print_cmdline output for consistency with
    guestfs___print_timestamped_message.

commit 0353688577a27749f40bcc060e5703102c5a9649
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 28 13:41:12 2010 +0100

    list-filesystems: Use core list-filesystems API (RHBZ#642933).
    
    Change virt-list-filesystems to use the core inspection API
    instead of the deprecated Sys::Guestfs::Lib::get_partitions
    function.

commit 756c23997b864aa3e559172c01d247a9a9236b5d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 28 13:40:23 2010 +0100

    Sys::Guestfs::Lib: deprecate get_partitions (RHBZ#642933).
    
    However the code is left since this function is used
    by virt-v2v amongst others.

commit f30210cba89763a32cfbcbfd68ccfcec8d5300e4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 28 11:31:23 2010 +0100

    inspector: Rewrite virt-inspector (RHBZ#642930).
    
    Rewrite virt-inspector:
    
     - remove old and unsupportable features
     - use the C inspection API
     - don't run programs from the guest
    
    The RNG has been updated to reflect the new XML-only output.
    
    The new example files show the new XML output.

commit ca7e941329b31d1bffc8cae9dca6d28b06ecc300
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 27 16:06:11 2010 +0100

    tools: Use C API for inspection (RHBZ#642930).
    
    Update the following tools to use the C API for inspection:
    
     - virt-cat
     - virt-edit
     - virt-ls
     - virt-tar
     - virt-win-reg
    
    None of the tools in the tools/ directory now use the deprecated
    Perl inspection APIs.

commit a51f56adb168ac7d4b65b98c7f0cdb07f266265f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 27 16:47:33 2010 +0100

    New API: inspect-get-windows-systemroot to get systemroot.
    
    We are already using heuristics in the C inspection code to
    determine the Windows %SYSTEMROOT% directory.  This change
    just exposes this information through the API.

commit 40d58fe65e10aa692d056a573e21e5afdc9329c7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 27 15:47:45 2010 +0100

    Sys::Guestfs::Lib: deprecate inspection functions (RHBZ#642930).
    
    Deprecate the guest inspection functions in this module, remove
    documentation, and point users at the core API functions instead.
    
    However we will keep the code here since it is used by virt-v2v
    and virt-inspector.

commit fea2e61ac1129a2f01036d4dfbee8947f3d00886
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 27 14:51:17 2010 +0100

    daemon: Fix /dev/mapper paths from mounts and mountpoints (RHBZ#646432).
    
    Make the LV paths returned by these two commands canonical.

commit 2f52a40bed27e49972b957f1ef3276c422d5ef96
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 28 11:58:56 2010 +0100

    edit: Clean up tmp file handling in virt-edit.
    
    This was probably not a security issue, but this change
    makes the code cleaner by not opening the tmp file twice.
    
    Also be more careful about error checking in close syscall.

commit f93b234401093c63e67f2ffc254f611eee4daf7c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 27 17:32:21 2010 +0100

    doc: Warn about security implications of running commands.

commit e3851914de6bad3deb869ba865d2a6eb53c83151
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 27 15:33:35 2010 +0100

    virt-ls: Small fix to documentation.

commit 064569bcbf854a9cf588ce31851d987d5f114ec8
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Oct 28 15:15:07 2010 +0100

    Remove ocaml/.depend from git.
    
    ocaml/.depend is automatically generated. This patch removes it from git.

commit 0e896a490c46825e2ef998143d338dda5736223e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 27 12:21:02 2010 +0100

    Version 1.5.24.

commit fb998000e60b32219c2bf839044cff59f499dff1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 27 12:17:26 2010 +0100

    Disable test for RHBZ#576879 comment 5.
    
    This test has started to hang, for reasons we don't understand.

commit c66d6f215e8303d4eaf8ccfdb6a58cff04ccc485
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 26 15:28:28 2010 +0100

    Unify guestfish and guestmount options processing (RHBZ#642932).
    
    In guestfish, factor out the processing of the options -a, -c,
    -d, -i, -m, -n, -r, -v, -V, -x into a separate set of files:
    options.c, options.h, inspect.c, virt.c.
    
    Change guestmount so that it uses these same files (from the
    ../fish directory) to process the same options.
    
    This unifies the handling of these options between the two programs.
    It also adds the useful inspection feature to guestmount, so you
    can now do:
    
      guestmount -d Guest -i --ro mnt/

commit d600342b7d29c0176ff96a7807ebb38303ecb3a6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 26 13:01:47 2010 +0100

    df: Add --uuid option to print guest UUIDs instead of names (RHBZ#646821).

commit 6590e04bdcc3038312cb0a5f5545f1f0924907b2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 26 12:46:26 2010 +0100

    todo: Remove obsolete items from TODO file.

commit 33d6e0e7234d8bb1285ed5eac852f4f0a3dd9562
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 26 10:44:11 2010 +0100

    Document problems mixing mkmountpoint and umount-all (RHBZ#599503).

commit 607dcadd2dc7883865ada5ae158e750f19dfff67
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 26 10:04:56 2010 +0100

    appliance: Repo name is not Fedora-specific.
    
    The --with-repo parameter is also used by Debian to specify
    the Debian software repository, so remove references to
    Fedora.

commit f1930720d96d4a601f1ff63e6ce50da23b90188c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 26 10:03:50 2010 +0100

    appliance: Remove repo from appliance filename (RHBZ#638901).
    
    There's no need to have the appliance filename contain the
    repository name it was built from, and this change gives
    downstream users more freedom to mix and match libraries
    and appliances if they want to.

commit 99dc2a9702e6c8a2bf9073af4cbf1803417ec3ee
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 26 09:56:55 2010 +0100

    inspection: Ignore floppy disks and CD-ROM drives (RHBZ#642929).

commit f48cd1f262312ad278a293a20ab442dcfc076a69
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 25 13:22:17 2010 +0100

    Enable autosync by default.

commit 9160dee922ad0866a3f6245fb1e0ad0b2e90170c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 25 12:59:50 2010 +0100

    /dev/mapper paths should not be returned from C inspection APIs (RHBZ#638899).
    
    With this patch, /dev/mapper paths do not appear in the output
    of guestfs_inspect_os, as you can see from this example:
    
    Welcome to guestfish, the libguestfs filesystem interactive shell for
    editing virtual machine filesystems.
    
    Type: 'help' for a list of commands
          'man' to read the manual
          'quit' to quit the shell
    
    Operating system: Fedora release 13 (Goddard)
    /dev/vg_f13x64/lv_root mounted on /              <--- NB
    /dev/vda1 mounted on /boot

commit b01ef8eae1acc5105e623a25c8988bcc3326ea1c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 25 12:52:49 2010 +0100

    New API: lvm-canonical-lv-name: make LV name canonical.
    
    When logical volume names appear in places like /etc/fstab
    files they can have the form "/dev/mapper/foo-bar".  This
    function takes such names and makes them canonical.
    
    Note that this operation cannot be performed using the current
    API, because 'guestfs_stat' does not work on device names, and
    we don't really want to make a 'stat-device' call since that
    exposes too much non-useful detail about the appliance.
    
    With this patch you can do this:
    
    ><fs> debug ll /dev/mapper
    total 8
    drwxrwxr-x  2 root root   4096 Oct 25 12:51 .
    drwxr-xr-x 16 root root   4096 Oct 25 12:51 ..
    crw-------  1 root root 10, 62 Oct 25 12:51 control
    lrwxrwxrwx  1 root root      7 Oct 25 12:51 vg_f13x64-lv_root -> ../dm-0
    lrwxrwxrwx  1 root root      7 Oct 25 12:51 vg_f13x64-lv_swap -> ../dm-1
    
    ><fs> lvm-canonical-lv-name /dev/mapper/vg_f13x64-lv_root
    /dev/vg_f13x64/lv_root
    ><fs> lvm-canonical-lv-name /dev/mapper/vg_f13x64-lv_swap
    /dev/vg_f13x64/lv_swap
    ><fs> lvm-canonical-lv-name /dev/mapper/foo
    libguestfs: error: lvm_canonical_lv_name: lvm_canonical_lv_name_stub: /dev/mapper/foo: No such file or directory
    ><fs> lvm-canonical-lv-name /dev/mapper/control
    libguestfs: error: lvm_canonical_lv_name: /dev/mapper/control: not a logical volume
    ><fs> lvm-canonical-lv-name /dev/vg_f13x64/lv_root
    /dev/vg_f13x64/lv_root

commit 504c3de9fe9db97fb14f2ab8310a588fc3a04458
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 27 10:33:14 2010 +0100

    rescue: Add --network option.
    
    This enables networking in the rescue shell.

commit ec736e20d32febefa2fe35d503886e0999146f0e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 27 10:31:41 2010 +0100

    Don't use kernel module whitelist with ext2-based appliance.
    
    Since the ext2-based appliance is cached, and since it is not
    all loaded into memory (as with the initrd), we might as well
    put all the kernel modules in there.
    
    Note the kmod.whitelist.in file is still used for building the
    ordinary appliance.

commit 61da709722ec244da1c3c7d4f1a8706f76687cb3
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Oct 27 10:55:24 2010 +0100

    Fix networking in the appliance.
    
    Commit 4963be85 re-introduced networking to the appliance,
    but didn't configure the custom network the appliance expects
    since we switched to link local addressing. This patch
    configures QEMU to use the custom network again.
    
    Note that you still need to use guestfs_set_network (g, 1)
    to enable user networking.

commit 9332031543563fd2ae6e0e8731fc770f5a5931db
Author: Matthew Booth <mbooth@redhat.com>
Date:   Tue Oct 26 13:54:17 2010 +0100

    Don't include control characters in BufferIn trace output (RHBZ#646822).
    
    The example below shows what the output looks like for a large
    random buffer.
    
    $ guestfish -N fs -m /dev/sda1 -x -- \
        touch /test : \
        pwrite /test "$(dd if=/dev/urandom bs=128k count=1)" 0
    [...]
    pwrite "/test" "\x7f\xa0/\xb3\x80\xd3\xbc\xc3\xc3.\xb1\xe0\x1b\xafC\x06\xd5;\x0ajJ[o\xc1\xdd\xae\x1f\xce\xb2\x8d\xb3\xd0\x11\xcc$%\xe6<\xc7\xc7\xe7BU*\xc4l%\xaa\xea\xe9\x1an\xda]\xc6I\x0eC\xf9;\xec\x12a\x1f\xeaRH\xb2P\xd6+\xc4\xe6\xa5bW\x99\\x9d\xc8\x9bJ\xef\x99-\x16:h5\xe2\x0f\xa2\xa08\x9bU\x0b$\x138\xcf\xd4j\x9b\x83{%\xac0\xdaa1Xx\xbd`\x8e\xdd\x82\x87\x07\x98\xd2\x9ed\x8bq\xd0\x1f5\x8f\xab\xad4z1\xda\xc4b\xc1\xbc\x0f\xaa\xea\xc1\x15(\xfd1\xc2\x0bF\xe6\x9e\xb0+/g\\xab\xb0b\xde_\xca\xf9\xad\xe1?%\x17\xad\x98\xa4e\xc1\xe0f'\x89\xe9>\xff\xadhYi\xe7\x8c]%\xef\xe0\xa1R\xe5\xd5\x03K\xefI\xdf\xad\xd3\x82\xdb\x0f\xdd\xc3\x8f"\xf1G\xea\xf9r\xdd\xff\x88\x81\xb7\xf2\x0e\x0f\x1d;:\xf2F1\xdb\xb5D\xa1^\x928\xf5\x8e)\xab\xc4\xc3H(\xd0ol\xc6\xe4\xd6\xa3L\x1c\x06\xf4"<truncated, original size 130567 bytes> 0
    [...]

commit c9670080e9b7e614101109d385c66c2fdc15e191
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 25 12:54:59 2010 +0100

    daemon: Print failed path in stat command errors.

commit 1d5ec10659d67020c5b709e4df4c49bc0d59d58c
Author: Karel Klíč <kklic@redhat.com>
Date:   Mon Oct 25 12:48:36 2010 +0100

    fish: Fix too-short allocation in tilde expansion (RHBZ#636061).

commit 247324a4b3d9bf4782e18a629463a808d361fada
Author: Piotr Drąg <piotrdrag@gmail.com>
Date:   Sat Oct 23 12:52:35 2010 +0100

    Update Polish translations (RHBZ#502533).

commit ae748ba3c10ea93e7df03738c4e040fdb77e0c7c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 23 10:45:25 2010 +0100

    fish: Quote optional argument name in error message.

commit b7133b270922df2bc96a35c5316616b18c20c525
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 23 10:45:06 2010 +0100

    fish: Reject unknown opt args (RHBZ#642934,CVE-2010-3851).
    
    This updates commit 0c1d3c02a8147617ee0646e37d011235abdd2c22.

commit 6ecaa6371a340d30c2f818500b377963cf5afdee
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 23 10:23:45 2010 +0100

    fuse: Add --format option to docs (RHBZ#642934,CVE-2010-3851).
    
    This updates commit 44c5ee1163918bd5c9e6aa6c292f0c3bb15b7b25.
    
    Document the --format option in the guestmount manual page.

commit 204d54609b4b3e4ca637f0ce2fe98c33ce9d008b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 22 23:12:16 2010 +0100

    Version 1.5.23.

commit 4b0e7f5c6a097c2426385776f8b9d3ff0a80bb3f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 22 12:48:25 2010 +0100

    resize: Specify format of input, output disk (RHBZ#642934,CVE-2010-3851).
    
    This adds two new options: --format specifies the format of the
    input disk, and --output-format specified the format of the output
    disk.
    
    Requiring the format of the output disk seems a bit strange at first:
    after all, this is the disk that the virt-resize user has to create.
    However it is needed because we sometimes reopen this disk, after
    copying data over the first sector, and in theory a raw-format guest
    could write a qcow2 header here and have it copied to the output
    disk, which we would subsequently reopen.

commit 38bc7c98dff94b5ad451da86817f34a6fbc75b08
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 21 23:33:15 2010 +0100

    virt-make-fs: Specify format of disk (RHBZ#642934,CVE-2010-3851).

commit 1250d553f1bec4365b73ec96532fd1de0f85ea94
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 21 23:06:24 2010 +0100

    df: Specify format of disks (RHBZ#642934,CVE-2010-3851).
    
    The format parameter is taken from libvirt if available, else
    the user should supply the '--format' parameter (eg. for local
    disk files).

commit 641ccab6c3b17f1c94676eab99e8baa9cddf5a0b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 22 10:59:53 2010 +0100

    tools: Specify format of disks (RHBZ#642934,CVE-2010-3851).
    
    Sys::Guestfs::Lib is changed in two ways: firstly we take the format
    string from libvirt and pass it to add_drive_opts.  Secondly we allow
    an extra format =>  parameter to open_guest which allows the
    format to be specified for disk images.
    
    All the tools are changed to add an extra --format parameter allowing
    the format to be specified for direct disk images.

commit 44c5ee1163918bd5c9e6aa6c292f0c3bb15b7b25
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 22 15:01:55 2010 +0100

    fuse: Specify format of disks (RHBZ#642934,CVE-2010-3851).
    
    For command line disk images, specify the format using --format option
    in the same way as for guestfish.

commit 0c1d3c02a8147617ee0646e37d011235abdd2c22
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 21 23:05:26 2010 +0100

    fish: Specify format of disks (RHBZ#642934,CVE-2010-3851).
    
    For libvirt guests, the disk format is copied from libvirt (if
    libvirt knows it).
    
    For command line disk images, you can use --format to override
    format auto-detection.

commit 14490c3e1aac61c6ac90f28828896683f64f0dc9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 20 11:34:57 2010 +0100

    generator: Optional arguments, add-drive-opts (RHBZ#642934,CVE-2010-3851).
    
    This large commit changes the generator so that optional arguments
    can be supported for functions.
    
    The model for arguments (known as the "style") is changed from
    (ret, args) to (ret, args, optargs) where optargs is a more limited
    list of arguments.
    
    One function has been added which takes optional arguments, it is
    "add-drive-opts", modelled as:
    
      (RErr, [String "filename"], #required
             [Bool "readonly"; String "format"; String "iface"]) #optional
    
    Note that this function is processed in the library (does not go over
    the RPC protocol to the daemon).  This has allowed us to simplify
    the current implementation by omitting changes related to RPC or the
    daemon, although we plan to add these at some point in the future.
    
    From C this function can be called in 3 different ways as in these
    examples:
    
      guestfs_add_drive_opts (g, filename,
                              GUESTFS_ADD_DRIVE_OPTS_READONLY, 1,
    			  GUESTFS_ADD_DRIVE_OPTS_FORMAT, "raw",
                              -1);
    
    (the argument(s) between 'filename' and '-1' are the optional ones).
    
      guestfs_add_drive_opts_va (g, filename, args);
    
    where 'args' is a va_list.  This works like the first version.
    
      struct guestfs_add_drive_opts_argv optargs = {
        .bitmask = GUESTFS_ADD_DRIVE_OPTS_READONLY_BITMASK,
        .readonly = 1,
      }
      guestfs_add_drive_opts_argv (g, filename, &optargs);
    
    This last form lets you construct lists of optional arguments, and
    is used by guestfish and the language bindings.
    
    In guestfish optional arguments are used like this:
    
      add-drive-opts filename readonly:true
    
    In OCaml these are mapped naturally to OCaml optional arguments, eg:
    
      g#add_drive_opts ~readonly:true filename;
    
    In Perl these are mapped to extra arguments, eg:
    
      $g->add_drive_opts ($filename, readonly => 1);
    
    In Python these are mapped to optional arguments, eg:
    
      g.add_drive_opts ("file", readonly = 1, format = "qcow2")
    
    In Ruby these are mapped to a final hash argument, eg:
    
      g.add_drive_opts("file", {})
      g.add_drive_opts("file", :readonly => 1)
      g.add_drive_opts("file", :readonly => 1, :iface => "virtio")
    
    In PHP these are mapped to extra parameters.  This is not quite
    accurate since you cannot omit arbitrary optional parameters, but
    there's not much than can be done within the limitations of PHP
    as a language.
    
    Unimplemented in: Haskell, C#, Java.

commit 87be9b26e7004a9a58970b4e97d0d152dc1c0704
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 20 10:49:59 2010 +0100

    generator: Rearrange argt logically (RHBZ#642934,CVE-2010-3851).
    
    This structure has accreted over time.  Rearrange the types
    into a logical order.

commit cd29c50ca820a03b9cecb300a84fb884425cb565
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 22 17:10:49 2010 +0100

    daemon: Use stdint UINT64_C instead of <const>ULL.

commit 2109d8d86aeb66093e0a9f41d3693693e3df66d5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 22 12:13:07 2010 +0100

    inspector: Add comment about why --fish option implies write mode.

commit 4460280960081d8b037719f671a7fcea8be091fb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 21 18:47:44 2010 +0100

    php: Create test file properly before running test.

commit c97d6c16bd74163d26f7ab9c7f55b842802b23d7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 21 18:41:56 2010 +0100

    php: Note that tests are testing the wrong thing.

commit 8f30c3c3f8c063f7c5ff8c6154d881e07a820251
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 21 16:39:04 2010 +0100

    ruby: Run tests one at a time, instead of in parallel.

commit ea6209198026080a9d9e588283e83aa9c4e2f177
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 21 13:59:36 2010 +0100

    generator: Refactor code for Perl bindings.
    
    This simplifies the code that generates the Perl bindings
    by removing repeated sections.

commit ed74706d80394fef709ec0258fc5cf7d974ff8b1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 21 11:59:49 2010 +0100

    generator: Missing newline character.

commit 6391d1a7cfa10337a75465c72d49df3c9ebc65ca
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Oct 21 10:50:25 2010 +0100

    fish: Change 'int argc' to 'size_t argc' throughout.

commit fcd75e021a12fbd93c4d51fbca7844fdb4f7436f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 20 13:35:43 2010 +0100

    generator: Remove unused parameter.
    
    generate_c_call_args optional decl parameter is never actually
    used, so remove it.

commit dad3fcfefd7c013ecbe8fa04df032fefb619e7d6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 19 15:18:15 2010 +0100

    Version 1.5.22.

commit 7d746ba6915e3c0d8fbe41053da64f4e9fa11cd4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 18 14:34:28 2010 +0100

    virt-resize: Document guest boot stops at "GRUB" (RHBZ#640961).

commit f7475ec577b7ca810185e0fd70a39ac9adaae620
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 18 14:18:58 2010 +0100

    df: Correctly quote libvirt domain and filesystem in --csv mode (RHBZ#639986).
    
    This fixes virt-df --csv when used with libvirt domains that contain
    quotes, spaces, commas and other lesser-used characters.

commit 4d88a74532b20bcb60909c0d0983cdf7498aa08c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 18 13:35:06 2010 +0100

    virt-resize: Document qcow2 output format (RHBZ#642826).

commit 94fa736b64591a374e49250173c9cdcc7f4e1211
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 18 13:33:02 2010 +0100

    virt-resize: List truncate(1) in SEE ALSO section.

commit a80177cc847102d5a6e43a8ff87769e86f30bd6c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 18 13:18:20 2010 +0100

    tools: Add section describing quoting libvirt domain names to docs (RHBZ#643624)

commit b3d27793f04ae44b2c11f6422a19b4422ac941cd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 18 12:56:54 2010 +0100

    parted: Don't return "loop" for non-partitioned devices (RHBZ#634246).
    
    If you ran part-get-parttype command on a device which didn't
    contain a partition, it used to return the string "loop".  This
    is an internal representation that parted uses.  We should instead
    return an error because part-get-parttype makes no sense for
    devices which are not partitioned.

commit 361c513dc3e013d2d7e902e3b309a4c37cf6ee0f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 18 12:44:08 2010 +0100

    contrib: Note about what needs to be done for visualization.

commit 06397c2f1ffe56e2300ff9439a2903479c9c3da3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 18 12:41:41 2010 +0100

    todo: Add wishlist items to to-do list.

commit c50eb8f1cc33009f1ed29a002066e026fe2923f4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 6 16:38:12 2010 +0100

    todo: Add note about using blktrace.

commit 241c34fb7acff24713331f015429eb52055553a6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 6 11:30:02 2010 +0100

    contrib: More trace visualization.

commit 13276f753421c2df4f036647ce43e2ae8a2def0c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 6 10:19:20 2010 +0100

    debug: Add qtrace <device> on|off to allow selective traces.

commit 4f6bd18d2e2a9c1d317a07b59072579d8fff42ac
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Oct 6 09:08:39 2010 +0100

    part-disk: Align whole disk partition to 64 sectors.
    
    Change the part-disk command so it aligns the partition to
    64 sectors (instead of 1 or 34 sectors as now).  This should
    ensure that the filesystem contained within is aligned.

commit ccc5425105dce58859c0793c83dd4d17a139d9ed
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 5 22:48:37 2010 +0100

    contrib: Fix small mistake in README file.

commit 37e0c30d9075a35780a945a462913165d973c372
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 5 22:21:43 2010 +0100

    contrib: Update README files.

commit 3e1a5352703a42980d9855f29fbfa6d5788c56ea
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Oct 5 22:19:15 2010 +0100

    contrib: Visualizing block device access and alignment.

commit 6fbbcdd64c1983efeadb846958865373df962078
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 4 20:34:36 2010 +0100

    ocaml: Add g#ocaml_handle method.

commit 63bfcdbdd81b81e6a8e2157de36f9e1638801570
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 4 20:33:14 2010 +0100

    ocaml: Document g#close () method for objects.

commit 6af1cd7245de0183404ea6aadda4c2f63f9f616b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Oct 4 20:29:05 2010 +0100

    ocaml: Create the handle when the object is instantiated.
    
    Previously we had only one handle shared between all objects .. oops.
    This fixes commit 67636f721056d2f2250b0ff8acd981a0294536a9.

commit 67636f721056d2f2250b0ff8acd981a0294536a9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Oct 3 21:18:25 2010 +0100

    ocaml: Add alternate object-oriented programming style.
    
    In original style:
    
    let () =
      let filename = Sys.argv.(1) in
      let g = Guestfs.create () in
      Guestfs.add_drive_ro g filename;
      Guestfs.launch g;
      let roots = Guestfs.inspect_os g in
      print_endline (Guestfs.inspect_get_product_name g roots.(0))
    
    The same code in the new OO style:
    
    let () =
      let filename = Sys.argv.(1) in
      let g = new Guestfs.guestfs in
      g#add_drive_ro filename;
      g#launch ();
      let roots = g#inspect_os () in
      print_endline (g#inspect_get_product_name roots.(0))

commit 1a3324ea2b0f4a4e04f99c4efb5af1d4cc256731
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 2 09:10:22 2010 +0100

    test-copy: Skip this test if /dev/fd is missing, because of broken mock 1.1.4.

commit 887a79d1d1c47e537fdffd1208acbacd598b0f96
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Oct 2 09:07:42 2010 +0100

    test-virt-resize: Skip this test on 32 bit hosts.

commit fd10487c9e5d1196ff751f6f37b75a7e5455f243
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 1 21:04:07 2010 +0100

    Version 1.5.21.

commit ffc75da7139f1ff447b597457458b72eba2bb108
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Oct 1 10:46:38 2010 +0100

    fish: Fix glob command (RHBZ#635969).
    
    This is a fix for the glob command in guestfish which was inadvertently
    broken in commit c359347dd42c9f5b875630537ee3641264826b89.
    
    This also appears to fix:
      https://bugzilla.redhat.com/show_bug.cgi?id=635969
      glob echo mkfs ext2 /dev/vd[b-t]1 prints garbage

commit c6c030b64bab98602363485cb62a9e1d847d570e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 27 17:06:14 2010 +0100

    Add test for virt-resize.
    
    This tests a number of things which have caused problems for us:
    
     - resizing PVs and LV content
     - handling GPT format disks
     - using qcow2 as a target disk format
     - shrinking disk images
    
    Note that the disk content is empty (not a real VM), but this is
    adequate since all we want to test are the operations and calculations
    done by virt-resize.  We are not interested here in whether e2fsprogs
    and LVM actually works.

commit 0dc1f8e7aeb390e72125f459930850b8050318df
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 27 17:00:45 2010 +0100

    resize: Fix handling of GPT and qcow2 (RHBZ#633766, RHBZ#633096).
    
    Previously we copied the bootloader data directly from the
    source disk image to the target disk image using host file
    operations (before launching libguestfs).  This has two problems:
    firstly it has no chance of working with qcow2, and secondly
    it didn't behave properly with GPT.
    
    This changes the code so that everything is done through
    libguestfs.  Block device sizes are now calculated properly
    for qcow2 (RHBZ#633096) because this is done using the libguestfs
    blockdev_getsize64 call.  The partition table is still created
    by parted, but to workaround a bug in parted this is done before
    copying the bootloader.  Finally the bootloader copy is done
    using the new APIs pread-device and pwrite-device.
    
    Shrinking now works, at least for simple cases (RHBZ#633766).

commit 7e4bf29fdf3067f3e83cd818a79ee522ae28e7ef
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 27 12:00:10 2010 +0100

    New API: pread-device, partial read for devices.

commit e65f5213637e71f6f88763ce177fd23c65e1033d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 27 10:51:38 2010 +0100

    pread: Check count and offset parameters are not negative.

commit 533aff2879d85a4061b9d31e9b25996ce0af60f5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 27 10:12:22 2010 +0100

    Freshen POD (manual pages) stylesheet.

commit a50cdb512c31efd75fe09ff6646b02a9a23faa02
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Sep 26 22:41:24 2010 +0100

    Version 1.5.20.

commit eeaab2ba84441a96977281a4472b1bccb9ec80a9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Sep 26 18:00:11 2010 +0100

    New API: pwrite-device
    
    This is the same as the existing 'pwrite' API call, but allows you
    to write to a device.

commit 5a8c8b8bf6e846b8d2d7e710f814d24d9a0183c3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Sep 26 17:59:50 2010 +0100

    pwrite: Check offset is not negative.

commit 406dbf7565e702588f172a8cc534acacb2fd7bee
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Sep 26 22:21:10 2010 +0100

    fish: Refresh guestfish documentation.

commit a7070682932717f318f57f9aca6188a954a7e9aa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Sep 26 19:34:46 2010 +0100

    Document ambiguity between devices and paths in API.

commit d72a617a262e000ce7bc97838ad1f0d640dc66ec
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 24 19:28:01 2010 +0100

    Document accurately how supermin appliance uses /tmp as a cache.

commit c9c0ac7d362fd19214c2c5e5bb7dcd9059950887
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 24 18:54:37 2010 +0100

    Allow $TMPDIR to override most temporary directory uses.
    
    Be more consistent in allowing the user to override use of the
    temporary directory by specifying $TMPDIR.  Also prefer P_tmpdir
    macro (defined in <stdio.h>) if that is defined, rather than
    hard-coding "/tmp" for the fallback location.

commit 840536ea5a0568296dfd3e483442c76b93c5a949
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 24 18:53:21 2010 +0100

    Call blockdev --rereadpt then udev_settle after sfdisk commands.
    
    This updates commit 956fc5a3feacc970ea763697bf28fb686c875408 so
    that we call udev_settle after rereading the partition table.  This
    ensures that the devices nodes for the new partitions have been
    created.

commit be49d1efa2c2447553f12a51c04f2c21f213fd75
Author: Daniel Cabrera <logan@fedoraproject.org>
Date:   Thu Sep 23 18:11:35 2010 +0100

    Update Spanish translations (RHBZ#636918).

commit efdc9c05031b04eecc6558976d65ac91449b51c8
Author: Piotr Drąg <piotrdrag@gmail.com>
Date:   Thu Sep 23 14:45:50 2010 +0100

    Update Polish translations (RHBZ#502533).

commit a7a1c981529a882ae0252584f0752dd1c14b8f00
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 22 21:50:46 2010 +0100

    Version 1.5.19.

commit df69543720de5bf7dd1a734c3bef6d191ceeab33
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 22 17:43:34 2010 +0100

    regressions: Test just-built guestfish.
    
    Instead of testing the installed /usr/bin/guestfish.
    
    This fixes commit ddda0f7bd00a37274dae38f4ce93955b8cfdf7d7.

commit 956fc5a3feacc970ea763697bf28fb686c875408
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 22 16:35:52 2010 +0100

    Call blockdev --rereadpt after sfdisk commands.
    
    On fast machines sfdisk has some sort of race where it
    fails to re-read the partition table it has just created
    (it's not clear if this is a race in sfdisk, the kernel or
    some other component).
    
    This commit works around the problem by calling
    blockdev --rereadpt after sfdisk operations, which
    experience shows is enough to stop the problem from
    happening.

commit f6fda69953ca110104481f1263ec9a96e74dbb88
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 22 15:37:34 2010 +0100

    Version 1.5.18.

commit ddda0f7bd00a37274dae38f4ce93955b8cfdf7d7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 22 14:10:58 2010 +0100

    Test guestfish -a and guestfish -d options.
    
    Since these options were both broken in released version 1.5.17,
    best to have a regression test to catch this in future.

commit e319b120acec1962319cca534d4504a8999135db
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 22 14:10:13 2010 +0100

    appliance: Ignore unreadable dbus service file (Fedora 15).

commit 734b2d2483f0b0e6c3f4e0427dcde19877355f0f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Sep 22 11:59:58 2010 +0100

    fish: Fix segfault in free_drives() function.
    
    This updates commit 8ea62c8d7f3f7f7e4057b93105cf979271aa13f4
    so it doesn't try to free the optarg (stack-allocated) strings.

commit 460aa67118656e7bb53d2d04c70e9ee3a301c076
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 21 21:57:50 2010 +0100

    Version 1.5.17.

commit a54aa3caae32a029a523d293041413d35208e013
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 21 22:49:18 2010 +0100

    Update release notes for new features in 1.5 branch.

commit d75a2bff1264828f02b68a9c8bc7eb2521bd6684
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 18 10:09:04 2010 +0100

    fish: Implement 'hexedit' command.

commit 5d4ae18e2b93073080fbbf8c98b11eec15dbc1e6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 20 18:23:58 2010 +0100

    New APIs: upload-offset and download-offset
    
    These APIs allow you to efficiently write and read parts of
    files or devices.

commit 8c5a4d949ee8ffe4ac7f373e667f2f8930db4543
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 21 19:49:08 2010 +0100

    leak: Clear history before exiting guestfish.
    
    Clear the in-memory history before exiting.  This removes
    some but not all memory leaks associated with using the GNU
    History library.  As far as I can tell it is not possible to
    free up everything used by GNU History.
    
    (Found by valgrind).

commit 8ea62c8d7f3f7f7e4057b93105cf979271aa13f4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 21 19:40:23 2010 +0100

    leak: Free list of drives and mountpoints in guestfish.
    
    Previously the list of -a, -d, -m, -N parameters were leaked.  This
    change frees them explicitly.
    
    This is not such an important fix since guestfish is a one-shot
    program, but it aids in finding other leaks in future.
    
    (Found by valgrind).

commit e7f62742b6141fd19444fc0e191281777cd966f9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 21 19:38:50 2010 +0100

    leak: Free PCRE regexps when library is unloaded.
    
    The compiled PCRE regexps used for inspection were being leaked when
    the library was unloaded.
    
    (Found by valgrind).

commit 6d276dae8d1bbb54d8708c94d23879d39f5fd4a3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 21 19:37:24 2010 +0100

    leak: Appliance name was leaked during guestfs_launch.
    
    This frees the string containing the name of the appliance
    which was previously being leaked during launch.
    
    (Found by valgrind).

commit 0132890790a082c5d0f31cc64367b4897c8e88b7
Author: Matthew Booth <mbooth@redhat.com>
Date:   Tue Sep 21 13:22:58 2010 +0100

    Add more exclusions to .gitignore.

commit d1c2287fe4636db9a54888e71fb150984f00b0e4
Author: Matthew Booth <mbooth@redhat.com>
Date:   Tue Sep 21 10:50:41 2010 +0100

    Fix appliance build dependency problem
    
    The appliance was being completely rebuilt every time guestfsd was updated. This
    was because make.sh depended on guestfsd, which it had to do because it
    called update.sh to install guestfsd.
    
    This fix removes the call to update.sh in make.sh, and therefore the dependency
    on guestfsd. The Makefile already includes a rule to run update.sh when guestfsd
    is updated, so this was unnecessary.

commit ff4ae8633e0ca7c1e679870600830ee4d9f1cd71
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Sep 21 08:53:44 2010 +0100

    fish: Add --echo-keys option to allow passphrases/keys to be echoed.
    
    See also:
    http://catless.ncl.ac.uk/Risks/26.17.html#subj13.3

commit 832864922a044bbd9acf58bc0c5b9bea9d4b2fa5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Sep 19 15:55:46 2010 +0100

    df: Add --one-per-guest option for using one appliance per guest.

commit 17e7cb9937a63ed8f9bb0fb6ac7302758be76846
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 20 14:02:06 2010 +0100

    Fix error launching libguestfs when euid != uid.
    
    When writing to a RHEV target, virt-v2v launches the libguestfs
    appliance with euid:egid = 36:36, which is required to write to
    an NFS target using root_squash.
    
    Since we changed to using a cached appliance, this causes an error on
    start up, as the cached files are owned by root, but the cache directory
    is owned by 36:36.  The reason is that bash resets euid to uid and
    egid to gid so when febootstrap-supermin-helper is executed, it runs as
    root:root.  The cache directory was created by libguestfs directly so
    it has the correct ownership.
    
    This patch fixes the issue by using explicit fork/exec instead of
    system (ie. not going via a shell) and by setting the real UID and
    GID to the effective UID and GID before execing.

commit 6123abc165e707a19e35b5cf16e676f79476116c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Sep 20 13:06:13 2010 +0100

    todo: Suggest removing repo name from appliance name.

commit 0003ea2c3dbaa7e22f4f616539136821d80694b8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 18 09:38:05 2010 +0100

    generator: Generate guestfish-only commands.
    
    The guestfish-only commands such as 'alloc' and 'edit' are
    now generated from one place in the generator instead of being
    spread around ad-hoc in the C code.

commit 585fceb3350c17a3d6ed7f2daffd5e2b3e5fc3e1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Sep 18 08:57:30 2010 +0100

    fish: In guestfish(1) turn command references into links.

commit 3eb76554ef1f2f218f8920d9a8b8fb4ba6b21d66
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Sep 17 14:35:43 2010 +0100

    fish: Correction for online help for 'edit' and 'more' commands.
    
    This corrects commit b5c287bcd456bdb02d8ec0443483df34f4fd6b5d
    and commit 639ca1828b167bf59353f0cd3c8c79c6289bbd5d.

commit a37ec221af8542f4ec76f510f9cd3e78d89caa5c
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 15 22:12:35 2010 +0100

    Version 1.5.16.

commit 6b2ae9a8b0efba044f4d409b70211aba450a6899
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 15 22:08:35 2010 +0100

    configure: Make "fedora-13" the default repository.

commit dd093a7660338ac5ad1959394f09397df2c793de
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 15 21:47:37 2010 +0100

    fish: If -m option fails, suggest a mountpoint.

commit 325587d89e56a27c978b87ad591b4966fe79075f
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 15 20:49:32 2010 +0100

    todo: Remove section since we now have list-filesystems API.

commit d4ba3d3421523b7d9da5da7c0e77df9b215b3e7d
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 15 20:35:06 2010 +0100

    Version 1.5.15.

commit 000c4a82fbd78667849551114b6d08f391324796
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 15 17:22:29 2010 +0100

    New API: list-filesystems: list filesystems
    
    This API is a simpler replacement for the guestfish commands
    list-devices / list-partitions / lvs, in the case where you are
    just examining a guest by hand to see what it contains.
    
    Typical usage and output in guestfish is like this:
    
    $ guestfish --ro -a /dev/vg_trick/F13x64
    ><fs> run
    ><fs> list-filesystems
    /dev/vda1: ext4
    /dev/vg_f13x64/lv_root: ext4
    /dev/vg_f13x64/lv_swap: swap
    
    It can also be used to replace programs that try to mount
    devices to determine if they are mountable filesystems.

commit ffd4820ffe953b0583e3a9357e37d74bed3a2320
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 15 16:39:36 2010 +0100

    New API: part-to-dev: Convert partition name to device name.
    
    This adds a formal API for going from a partition to the containing
    device, eg. /dev/sda1 -> /dev/sda

commit ff38fea645e69e8f4d84f2691dac3116d9bac1c4
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 15 17:15:44 2010 +0100

    generator: Add TestOutputDevice.
    
    This is for testing functions that return a device or partition
    name, so that we can compare the return value with the canonical
    device name (eg. "/dev/vda1" == "/dev/sda1").

commit 43d5ea6f1ed4cc74c521e4d2b0eec6110f5c44fd
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 15 16:37:24 2010 +0100

    todo: More use of libblkid.

commit c98f0733616c900a021136a6753308a673df0afa
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Sep 14 22:29:08 2010 +0100

    fish: In usage message use new-style -i option syntax.

commit 42b62b8240a9b32f0a198105b03cfadaf97a7a7b
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Sep 14 22:28:10 2010 +0100

    fish: Update copyright dates in usage message.

commit 31a2c006cd6486f0ca5afb11e42bcc412385a074
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Sep 14 22:27:06 2010 +0100

    fish: Remove extraneous space from usage message.

commit 7c87dd1cf9cd14f753a2020425a5c20ba262f51b
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Sep 14 22:17:24 2010 +0100

    todo: More ideas.

commit 5a7c430f1f99cbb2aa9cc73318453ca425db3fee
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Sep 14 13:29:59 2010 +0100

    Version 1.5.14.

commit d3c6e50422562af592682fdd58dbadc98069ef18
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Sep 14 12:24:54 2010 +0100

    configure: Check for virtio-serial support in qemu.
    
    All other vmchannel methods are obsolete, but we were still trying
    to check for them.  This replaces all of them with a simple check
    for virtio-serial.

commit 9cab7e3ecd9df8bfa6a3dad1dd11ba88452c819b
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Sep 14 12:24:12 2010 +0100

    pardus: Check for cpio in configure.

commit 17b50a384f315f502ed1c236ce6641195286e3ae
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Sep 13 19:06:39 2010 +0100

    Update Spanish translation (RHBZ#633357).

commit a403e74355d2ef9a45041c931ed68204007905c5
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Sep 13 16:01:53 2010 +0100

    build: Add run-test-tool-locally to EXTRA_DIST.

commit 2b1e36db75c14d7e2f6f6a096d8cec3f1bd8adab
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Sep 13 14:47:43 2010 +0100

    Version 1.5.13.

commit 7419335e1113f28fd17b512992df22eb28cb4c05
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Sep 13 14:49:16 2010 +0100

    appliance: Disable setting scheduler to noop.
    
    This is a workaround until
    https://bugzilla.redhat.com/show_bug.cgi?id=630583
    is fixed (bug in Linux 2.6.36).

commit 3deebe5bf10f3baa954ebc1d12e92efdd635226f
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Sep 13 14:45:18 2010 +0100

    ubuntu: Remove bogus debirf file.

commit 75f0a92debd3f68c544c821fa54a973b91ea7e42
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Sep 13 14:44:46 2010 +0100

    ubuntu: Add linux-image to the packagelist.
    
    It seems that linux-image (ie. the kernel) is omitted in some
    versions of the base packages.

commit 93ae3fa9da7e31bba563977ee61b2df1b395400f
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Sep 13 14:44:05 2010 +0100

    ubuntu: /proc can be a symlink
    
    If it's a symlink then the succeeding mount commnd will fail.
    Remove it and make a /proc directory.

commit da107cf3d959af2d41da4bec3b9f2fd7c09c7ae9
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Sep 13 14:42:47 2010 +0100

    build: 'make quickcheck' rule now uses new run-test-tool-locally script.

commit 9f653edcdc6ecceb7a22441e496f1fc08a95f56c
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Sep 11 17:16:22 2010 +0100

    build: hivex is required.
    
    hivex library has been required since we moved the inspection
    code to C.  Check for this in configure.ac.

commit f565e71560862e9fa3e6d000c5f8fa6deb7e90e0
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Sep 11 13:14:45 2010 +0100

    Version 1.5.12.

commit e903739935ce32190b1c7b087d2cd9c2d2a7ec88
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Sep 11 13:41:26 2010 +0100

    build: require Augeas for library.
    
    Augeas has been required since we moved the inspection code to C,
    however we were not correctly enforcing this in configure.ac, nor
    correctly linking to the library until now.

commit 67fd3a7d99f3001aaf90682e102eba6708d8337a
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Sep 11 13:20:59 2010 +0100

    generator: Provide no-op generator if no OCaml compiler.

commit 2fbac04b9de826fb49400a1fc7a97262b76d078e
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Sep 11 13:14:04 2010 +0100

    build: Don't distribute src/generator.ml, no longer exists.

commit b42262c3db6013c363e2532cf7a466ccaf4d49f0
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Sep 11 12:19:25 2010 +0100

    generator: Calculate MD5 of test.iso at runtime.
    
    Because this used to be compiled into the C test, it changed
    every time the ISO was rebuilt (which because of Makefile deps
    was every run).
    
    Now it is calculated at runtime so the C test file doesn't keep
    changing.

commit 451a28349b11fe08cb3f7ca84e58b6e69646707b
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Sep 11 12:05:03 2010 +0100

    generator: Don't use real uuidgen for UUIDs.
    
    This was one reason why capitests/tests.c changed every time the
    generator was run.

commit 04d8209077d2227eb1d42695ba71147f78987050
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Sep 11 09:25:12 2010 +0100

    Split generator into separate source files.
    
    'src/generator.ml' is no more.  Instead the generator is logically
    split up over many different source files.
    
    Read generator/README for help and tips.
    
    We compile the generator down to bytecode, not native code.  This
    means it will run more slowly, but is done for maximum portability.

commit 264629b9f0ace1062b453b2d0ae55e48385189d3
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Sep 11 08:11:43 2010 +0100

    syntax: Replace -a and -o with && and || for portability.

commit 431503d007b22bf10226843cca84628544fadca9
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Sep 10 23:00:07 2010 +0100

    syntax: Use exit (EXIT_SUCCESS) instead of hard-coded number.

commit 513363290ef146c8cc54ba80087ae8dd66a40ab9
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Sep 10 22:55:32 2010 +0100

    syntax: Remove unused assert.h header.

commit 21aac863e29eca5552c4ae1645306e966f11c1d8
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Sep 10 22:55:03 2010 +0100

    syntax: Remove unused ignore-value.h header.

commit 0e422c0f590caf1d5f182c9b22f0b16e2a31b02b
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Sep 10 22:54:30 2010 +0100

    syntax: Remove unused signal.h header.

commit a0b7045e0abb7e3a7ff4d1324f16e50de94bed55
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Sep 10 22:53:56 2010 +0100

    syntax: Remove unused c-ctype.h header.

commit c1b63526774614dd5a1f6710e63ae466489469d5
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Sep 10 22:56:22 2010 +0100

    syntax: Fully bracket m4 macro arguments.

commit b3d94d6a71e74e817ad5bdb9497e88d19ec2e29d
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Sep 10 22:52:50 2010 +0100

    syntax: Remove trailing spaces.

commit b4a3aec60ed4775f8ca2eb079e389af3a1769069
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Sep 10 22:57:10 2010 +0100

    syntax: Use spaces instead of tabs for indentation.

commit 3d994f3d8e12356223d37c1b45ebe2eb39ef28a6
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Sep 10 22:51:39 2010 +0100

    syntax: Replace _prohibit_regexp with _sc_search_regexp.

commit c359347dd42c9f5b875630537ee3641264826b89
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Sep 10 13:26:10 2010 +0100

    fish: glob should only print commands when trace mode is enabled.

commit b033b55558503a1920c5b7cc1a7e1365749585e0
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Sep 10 13:25:40 2010 +0100

    fish: Add regression test for copy-in and copy-out.

commit 3161cb58a5c9d285c2b9f9c63887138dfc36f28c
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Sep 10 12:01:03 2010 +0100

    README: Document virtio-serial is now the only vmchannel.

commit b1e65806a185c6b2ec36efc04d85c268a65e97cc
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Sep 10 11:53:46 2010 +0100

    fish: const-correctness fixes in copy.c

commit f6246e932cb518cd8d7b3a02c338e736188f4115
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Sep 10 10:29:46 2010 +0100

    Version 1.5.11.

commit 025583593b020d80cf237d4539288f915118f927
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Sep 10 10:28:51 2010 +0100

    Update OCaml dependencies.

commit 646813ec513cb8eae3d9b13c52b846fc36654803
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Sep 10 10:28:37 2010 +0100

    Update PO files.

commit 878c8c77d8b46b1c4dd5189f67f0262d44eed70c
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Sep 10 10:27:45 2010 +0100

    fish: Fix 'copy-out' command when local directory is "/foo".

commit 3578f170a1f70a86fb2213fc576190ad5aff61be
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Sep 10 00:02:56 2010 +0100

    fish: Fix typo in documentation of copy-out.

commit 8902b33c0e2458dbaf939a1859a56c963a117939
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Sep 9 23:25:37 2010 +0100

    Version 1.5.10.

commit f383ac139f5575754715a9dfbe88c67346eaa6e5
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Sep 9 23:25:23 2010 +0100

    todo: Remove discussion of copy-in/copy-out.

commit 2635a9c70e5f8aab85bbcb6b7a645f720d1e4466
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Sep 9 18:49:10 2010 +0100

    fish: Implement copy-in and copy-out commands.

commit 43eed091129212dd29996838cf1d76af0f8fc135
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Sep 9 22:43:32 2010 +0100

    New APIs: is-chardev, is-blockdev, is-fifo, is-symlink, is-socket
    
    These complement the existing is-file and is-dir APIs.

commit 3a99114360636806078bbf614c241e89661bcc7f
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Sep 9 22:20:28 2010 +0100

    daemon: Move 'exists', 'is-file' and 'is-dir' to separate file.
    
    This commit is just code movement.

commit 55b6e18f95950b1a2ec69d549c9e6c8a5758d166
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Sep 9 22:42:57 2010 +0100

    generator: Fix incorrect shortdesc in docs for 'is-dir' command.

commit 22aa9268f548eab9763311a080859d8cf2257a93
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Sep 9 22:42:26 2010 +0100

    generator: Fix documentation for 'is-file' command.

commit 639ca1828b167bf59353f0cd3c8c79c6289bbd5d
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Sep 9 14:11:32 2010 +0100

    fish: Fix 'more' command to work with any file.

commit b5c287bcd456bdb02d8ec0443483df34f4fd6b5d
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Sep 9 14:11:20 2010 +0100

    fish: Fix 'edit' command to work with any file.

commit 13be76168260ee57e3d134177066ca7ceb984092
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Sep 9 13:53:08 2010 +0100

    guestfs: Reference guestfs-browser architecture in threads documentation.

commit b1454e38987473c94f20b10061031f2abe5a69a0
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Sep 9 13:52:48 2010 +0100

    guestfs: Document progress notification messages in protocol.

commit e2ef068cb7d18f0c0d4931f97332a38ea4ea2477
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Sep 9 13:52:32 2010 +0100

    guestfs: More accurate documentation for initial message.

commit 6d9f8f5c140c3116fb0292fcf73f560812c7d5fb
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Sep 9 13:51:52 2010 +0100

    guestfs: Remove traces of documentation for non-existent 'low-level API'

commit f3c05da4f9c226c18476eb135dfcb5875d65bf63
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Sep 9 12:00:36 2010 +0100

    guestfs: Fix typo in man page.

commit 979bcc553897f42024539ae6dd6ba66e9764a92c
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Sep 9 13:40:45 2010 +0100

    todo: Notes on virt copy command.

commit 6a87e0af24e957398ddae7db3c37da5d23f6686c
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 8 17:50:44 2010 +0100

    Bring TODO file up to date.

commit c51ade2e85b1e0b4d6f8537cc2bfe671023cd8b1
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 8 11:03:10 2010 +0100

    Version 1.5.9.

commit d5c8d3b45b9646a4ae9d4ea033e1cc13a6e25c1f
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 8 11:00:00 2010 +0100

    fish: Add guestfish -N bootroot and -N bootrootlv for creating boot+root disks.

commit 574df371a0421b4b83386f43e5095ccea5069e5b
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 8 10:24:01 2010 +0100

    fish: Add guestfish -N lvfs for creating formatted LVs.

commit 422a8d85d21fc29ee75d27917fd03a164048bfc9
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 8 09:58:37 2010 +0100

    fish: Add guestfish -N lv for creating disks with LVs.

commit 45f72c804b6fa76d94b7195bd5faea8c0d6f6b3d
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 8 10:23:28 2010 +0100

    fish: Improve appearance of guestfish -N help output.

commit fa918b166acd6123623fd0d03b5f4840b1579a02
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 8 09:37:22 2010 +0100

    fish: Allow guestfish -N help for listing prepared disk image help.

commit 60cdd02b02578b427ca3926d566811c6bb7a9970
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 8 09:05:18 2010 +0100

    fish: Generate list of prepared disk image types.
    
    This commit shouldn't change the semantics of the code.

commit 06c906168c0a96662ad47473cfe5f2fb3c316757
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Sep 6 10:13:31 2010 +0100

    test-tool: Add a 'run-test-tool-locally' script.
    
    This can be used to run the test tool without installing it.
    It sets the environment variables and command line arguments
    up correctly to run the tool from the build directory.

commit b76284876b9ab50b8aa5851fb960dbb66a58c2e2
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Sep 6 10:04:01 2010 +0100

    appliance: init script does 'ls -lR /dev' (verbose only)
    
    It's useful to see what files are in /dev subdirectories
    at boot, eg. for looking at virtio-serial ports.

commit aa96881a512a144f4611a8e7c9801be9bb7ff9cf
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Sep 6 10:03:38 2010 +0100

    daemon: Don't warn about 'long long' usage.
    
    This removes a fatal warning (-Werror) which stops compilation
    on 32 bit machines.

commit bd77c8d1b47d24619b48e8e2f3683c8ce324fca8
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Sep 5 16:51:45 2010 -0400

    php: Remove 'make clean' rule in subdirectory.

commit 56da696fc24fb2c398965d8cfc3c621dcfe06e9a
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Sep 4 12:45:42 2010 +0100

    Version 1.5.8.

commit 2c61e04c4599536fee771431fb1ebc8384523b2a
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Sep 3 12:15:00 2010 +0100

    PHP bindings.
    
    Note that these are not complete on 32 bit architectures.  PHP doesn't
    offer any convenient 64 bit type (on 32 bit).  Therefore you should
    always use these PHP bindings on 64 bit.

commit 2d8fd7dacd77361bc385be42112289faafb5c60d
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Sep 2 22:45:54 2010 +0100

    Define LIBGUESTFS_HAVE_<shortname> for C API functions.
    
    The actions each have a corresponding define, eg:
    
      #define LIBGUESTFS_HAVE_VGUUID 1
      extern char *guestfs_vguuid (guestfs_h *g, const char *vgname);
    
    However functions which are for testing, debugging or deprecated do
    not have the corresponding define.  Also a few functions are so
    basic (eg. guestfs_create) that there is no point defining a symbol
    for them.

commit 5fc69ce3ece5e4d4a3da9d78da244c4fa301b5ac
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Sep 2 22:27:35 2010 +0100

    build: guestfs-structs.h was missing from libguestfs_la_SOURCES.

commit 8ad79a7c4de406579cf38d938edf44a8b659d03a
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Sep 2 22:25:47 2010 +0100

    Add full docs pot file.

commit 8c48f5ae2ea5221f6c53934262c5505f4b20ca8c
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Sep 2 14:54:44 2010 +0100

    Allow manual pages and POD files to be translated.
    
    This uses the optional po4a package to split these files into
    PO files for translation, and reassemble afterwards.
    
    Note this creates an extra pot file (po-docs/libguestfs-docs.pot).
    We don't (yet) combine this with the main po/libguestfs.pot file.
    The 'libguestfs-docs.pot' file included in this commit is not the
    real thing, just a short cut down snippet for testing.  The real
    thing is created if you update one of the dependent files and
    rebuild.
    
    Note also the dummy ja.po, for testing the principles.

commit 1193df7e0abfa25a78de246b6be148ec09470623
Author: Geert Warrink <geert.warrink@onsnet.nu>
Date:   Thu Sep 2 14:56:36 2010 +0100

    Add Dutch translation (RHBZ#629593).

commit 25521f17d5b0841a13d66fc515fac0cffe23d9a1
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Sep 2 12:01:06 2010 +0100

    ruby: Add Guestfs::Guestfs.new() method.
    
    This is a more standard way to create objects in Ruby.  The old
    way was to call the module function Guestfs::create() which still
    works.

commit b8b0c99b46172712aa190f70182734934587af7b
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Sep 2 11:11:55 2010 +0100

    perl: Document handle is a hashref.
    
    For details see commit eb566f7dc7974b42ac65729a2e5e5bcee329a0a9.

commit 0f24424f357e854a9da382de11e4fe81305c8743
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Sep 2 10:58:28 2010 +0100

    perl: Add documentation about testing availability of methods and features.

commit 71f5cc5a2e2db613a99fe6b89278ce435e3a50d0
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 1 18:44:33 2010 +0100

    build: Link static -ltinfo into guestfish.static binary.

commit d8daebf3095aba66ca8d9ba9b9eb10b2eda7d31a
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 1 17:12:37 2010 +0100

    Version 1.5.7.

commit 231051474bcf3b3096d327a8853299e90139127d
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 1 18:10:41 2010 +0100

    fish: Add missing header file to sources.

commit d1485e02f538d50fd7d4790fb63317093ba8c6bf
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 1 17:12:15 2010 +0100

    ocaml: Add test for progress notification callbacks.

commit 8c37961b455cbc72d4879da65c6aafd332857f05
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 1 17:03:19 2010 +0100

    debug: Add 'debug progress' command.
    
    This debugging command generates progress notification messages,
    used for testing purposes.

commit 99679fe5a28efcee3be2406aeaf446b4e1a976df
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 1 15:38:15 2010 +0100

    debug: Arrange prototypes in alphabetical order.

commit 83f381f5ccfb7e86bfaaeeade9d06c9e54ddb0cf
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 1 15:37:24 2010 +0100

    daemon: Enable debug command by default.
    
    The debug command is useful for internal testing, and so should
    be enabled by default in all builds.
    
    Note that it is still *not* part of the stable ABI.

commit 867319ec5f9030d3c14c32e3302606f2bf11ac27
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 1 13:19:05 2010 +0100

    Consistent use of 'void *opaque' to refer to opaque pointer in C API.
    
    We inconsistently used 'void *data' or 'void *opaque' all over to
    refer to the same thing.  Use 'void *opaque' in all places in the
    published API and documentation.

commit c9bc865a7acf372a66f7c9a3f34440deb32f1ea9
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Aug 31 20:39:40 2010 +0100

    resize: Add progress bar to virt-resize.
    
    With this commit you will see a plain progress bar during the
    lengthy copy operations, similar to below:
    
    Summary of changes:
    /dev/sda1: partition will be left alone
    /dev/sda2: partition will be resized from 7.5G to 9.5G
    /dev/sda2: content will be expanded using the 'pvresize' method
    Copying /dev/sda1 ...
    [############################################################################]
    Copying /dev/sda2 ...
    [########################################------------------------------------]

commit 8ff17e1c9cf348c93ac731281b1e4a0d5fa7caf3
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Aug 31 20:14:17 2010 +0100

    perl: bindings to progress callback.

commit 3978a308a586e3a671807eb3716ba7c7596af21f
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Aug 31 17:04:52 2010 +0100

    ocaml: bindings to progress callback.

commit 4ea0abfce413767868a8f53b3d20e5d2f62dff08
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Aug 31 18:48:32 2010 +0100

    Implement private data area.
    
    The private data area is a hash table which is associated with
    libguestfs handles, that C callers may use to store arbitrary
    data for the lifetime of the handle.
    
    Later the OCaml bindings will use this in order to implement
    callbacks.

commit 54837f6d7ba83178625e2f0c3c063457d9f3f79c
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Aug 28 12:49:55 2010 +0100

    fish: Implement progress bars in guestfish.
    
    The progress bar is updated 3 times per second, and is not displayed
    at all for operations which take less than two seconds.
    
    You can disable progress bars by using the flag --no-progress-bars,
    and you can enable progress bars in non-interactive sessions with
    the flag --progress-bars.
    
    A good way to test this is to use the following command:
    
    guestfish --progress-bars \
              -N disk:10G \
              zero-device /dev/sda
    
    (adjust "10G" to get different lengths of time).

commit 3003df6bbc889c3939e6c478462dc4478d5b89f7
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Aug 28 12:48:49 2010 +0100

    fish: Detect UTF-8 output and open termcap/terminfo database.
    
    Provide a generic mechanism within guestfish to detect if
    output if UTF-8 and to open the termcap (or terminfo) database
    for the current terminal type.

commit 65510965b3475dd80bdbf042992298451dc2b67b
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Sep 1 11:54:15 2010 +0100

    Add progress messages to download command.

commit 133a92be6948ff7e65bfecb7be70b15f4336d2af
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Aug 28 14:29:21 2010 +0100

    Add progress messages to zero-device command.

commit 88ab203e611694bc0d01aca745e8df18cb3f094e
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Aug 28 14:29:07 2010 +0100

    Add progress messages to zero command.

commit 55938405ccd3d5e5736f30c9bd78a51998cd7158
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Aug 28 14:28:42 2010 +0100

    Add progress messages to fill-pattern command.

commit 7f1ecfc87eb45cab401394b980e15f8981511627
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Aug 28 14:28:26 2010 +0100

    Add progress messages to fill command.

commit 41512f498b5f85a941ad165361b01135511fdd23
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Aug 28 11:11:32 2010 +0100

    Add progress messages to copy-size command.

commit e776a46ffcbede6d9b030dbc8f6ab32500b325ec
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Aug 28 10:33:24 2010 +0100

    Implement progress messages in the daemon and library.
    
    This implements progress notification messages in the daemon, and
    adds a callback in the library to handle them.
    
    No calls are changed so far, so in fact no progress messages can
    be generated by this commit.
    
    For more details, see:
    https://www.redhat.com/archives/libguestfs/2010-July/msg00003.html
    https://www.redhat.com/archives/libguestfs/2010-July/msg00024.html

commit a8a44cecbadfd21c7f0483f8c1cdb355d08960a4
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Aug 31 19:25:45 2010 +0100

    ocaml: Remove old entry from .gitignore file.

commit 377926be5bdadda3b149090c7a3a0d694552a9c3
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Aug 27 22:01:23 2010 +0100

    Version 1.5.6.

commit d46230f94e9e472938b61753a134371f8f290929
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Aug 27 21:47:49 2010 +0100

    Requires febootstrap >= 2.9.

commit d89a88d67e577ee6111820cb44c3440b7772608d
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Aug 27 15:27:22 2010 +0100

    daemon: Set O_CLOEXEC flag on the virtio-serial file descriptor.

commit 4932fdca3ca1e9002164a1c0b73876f32739d34d
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Aug 27 13:38:49 2010 +0100

    build: Don't add version extra string to the version number.
    
    If this string was non-empty, then it broke a lot of things because
    autoconf and other parts of the build system were expecting this
    string to contain a simple MAJOR.MINOR.RELEASE version number.
    
    This requires changes to guestfish and guestmount so they use the
    guestfs_version API to fetch the version from the library.  (The
    Perl tools were already doing it this way).  In a way this is more
    accurate, because it's no longer hard-coded in the binary, but
    fetched from the dynamically linked libguestfs.so.

commit 1c523760d32b9e4db8441fc11d59539e213635b5
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Aug 26 16:42:53 2010 +0100

    Update BUGS, PO files.

commit b59aff0bae7a0c564d0af500bc966a3fd972fd09
Author: Daniel Cabrera <logan@fedoraproject.org>
Date:   Thu Aug 26 16:40:44 2010 +0100

    Update Spanish translations (RHBZ#627556).

commit 3f7965b6deb7f0b8886728446e320bac6d1212c9
Author: Daniel Cabrera <logan@fedoraproject.org>
Date:   Thu Aug 26 16:39:39 2010 +0100

    Updated Spanish translations (RHBZ#626843).

commit 9bc72e2f9b988f73f38561fd3802a16a636f1f6e
Author: Piotr Drąg <piotrdrag@gmail.com>
Date:   Thu Aug 26 16:38:11 2010 +0100

    Update Polish translation (RHBZ#502533).

commit 92876a49db8ffbdf3a44d3680c6a8930b4db5cd5
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Aug 26 16:31:40 2010 +0100

    Prepare for version 1.5.5.

commit daead56fae46a4fedfef176fa3ed1ba37f88a078
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Aug 26 15:55:34 2010 +0100

    rescue: Fix typo in comment.

commit c3194e4d370d917db9900a31ea18f10492554da4
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Aug 26 15:08:20 2010 +0100

    Ignore launch() error in virt-rescue. (RHBZ#618556)
    
    launch() expects guestfsd to start, which it never does in virt-rescue, so it
    always returns an error about the appliance shutting down unexpectedly.

commit d3fc7e1e4d592dbdc6b8b9edf92dddc0a67eac28
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Aug 26 14:34:44 2010 +0100

    Shut down the appliance cleanly
    
    When guestfsd exits, or the user exits the virt-rescue shell, the init script
    exits which causes the kernel to panic. This isn't really a functional issue, as
    all useful work is done by this point. However, it does cause virt-rescue to
    display an unsightly error message.
    
    This patch causes the appliance to power off cleanly before the init script
    exits. Note it actually does a reboot rather than a poweroff. This is because
    ACPI is disabled in the appliance, meaning poweroff doesn't work, but qemu is
    configured not to restart on reboot.

commit c0b38fbb27c8771916386f47361833722d54518f
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Aug 26 12:11:59 2010 +0100

    Call sync after guestfsd exits
    
    Core files are not reliably written to disk if guestfsd dumps core. This patch
    makes libguestfs do the same appliance cleanup for guestfsd and virt-rescue,
    which seems to fix the matter.
    
    It also removes a redundant sleep and additional sync when exiting virt-rescue.

commit a45302cb8a0ee3b4ffd0656b24a06ebdf7b50f38
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Aug 26 13:36:10 2010 +0100

    Add a core_pattern debug command
    
    This adds a new debug command, core_pattern, which writes a new pattern for
    coredump files to the appliance kernel, and sets the daemon's hard and soft core
    limits to infinity.

commit a0d514f13d3334b79745d7d1f90a6ac615afa7c2
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Aug 25 11:53:00 2010 +0100

    Include statically linked binaries in the binary distribution.

commit 27ef6f9171127afd248f38d280cf3d0eae51fdaf
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Aug 25 11:41:17 2010 +0100

    Rename global 'xdr_str'.
    
    Two bits of XDR both contained a definition called 'str' which
    means that 'xdr_str' was being exported globally twice.  Because
    of the linker script this didn't affect us.  But it's best to
    rename this global so that conflicts cannot arise.

commit 6d15d4e7c27477507ba355384a340ce86cec617b
Author: Daniel Berrange <berrange@redhat.com>
Date:   Tue Aug 24 14:27:15 2010 +0100

    Add -nodefconfig command line option to qemu.
    
    Without this option, qemu will read some defaults from /etc/qemu/
    configuration files.

commit e503b31c15117a82abfe9dd4ba560ea6d03e45ca
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Aug 24 12:37:39 2010 +0100

    Version 1.5.4.

commit 4963be850090933e5769f9d3412d9eb86f522b1b
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Aug 24 11:53:40 2010 +0100

    New APIs: set-network and get-network to enable network support.
    
    guestfs_set_network (g, true) enables network support in the appliance.

commit 10d1aa3b64f61408bb092d998fb8c5f453a7749c
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Aug 24 11:19:55 2010 +0100

    build: Add 'bindist' rule for building binary distribution.

commit 5c1346dae72064f7fd9c2afe5517afc6f050cd9a
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Aug 23 22:58:51 2010 +0100

    Don't print debug messages when not in verbose mode.
    
    Don't print them because no one's listening ...

commit 831b1fc1805e8450202b5c2cf9ab17a163ab0cc5
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Aug 23 22:19:24 2010 +0100

    Change protocol to send Linux errno from daemon to library.
    
    This changes the protocol so that the Linux errno (if available)
    is sent back to the library.  Note that the errno is not yet
    made available to callers, since it is not clear how best to
    present this Linux-specific number.

commit 90d06e28888d9a492560ca986dca0708f881d173
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Aug 23 22:14:27 2010 +0100

    Raise error message max size to 64K.
    
    This commit removes one of the protocol limits, by raising the
    maximum error message size from 256 bytes to 64K.
    
    Although we could consider raising this further, since the
    error messages are currently stored in fixed sized buffers on
    the stack, that would require more invasive code changes.

commit 866ec00d1f8bc40042795b66ceec12608bb1f9e8
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Aug 23 21:53:32 2010 +0100

    Use virtio-serial, remove other vmchannel methods.
    
    This adds support for virtio-serial, and removes all other
    vmchannel methods.
    
    Virtio-serial is faster than other methods, and is now widely
    available.
    
    I tested this by using the guestfs_upload API on an 83 MB file:
      before: 6.12 seconds (14.1 MB/sec)
       after: 4.20 seconds (20.6 MB/sec)
    (note this is with the current 8K chunk size)

commit 5c31f6126ba4ea3e9056c34c300f6f5e332ab997
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Aug 23 11:12:29 2010 +0100

    Change to using ext2-based, cached supermin appliance.
    
    This changes the method used to build the supermin appliance
    to use the new ext2-based appliance supported by latest febootstrap.
    The appliance can also be cached, so we avoid rebuilding it
    each time it is used.
    
    Mailing list discussion goes into the rationale and details:
    https://www.redhat.com/archives/libguestfs/2010-August/msg00028.html
    
    Requires febootstrap >= 2.8.

commit 4b753c62089be663ac722e4a875bb061d259e87d
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Aug 23 12:54:27 2010 +0100

    Make print_timestamped_message into a cross-module function.
    
    This is just code movement.

commit a2d4a8bf073c3551d174bd6c406e0cf3d27fb560
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Aug 23 12:53:11 2010 +0100

    Factor out code for locating the temporary directory.
    
    This is just code movement.

commit 4d2f1632ad655130fafab3bf7fe8fa5cb59705d8
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Aug 21 12:45:51 2010 +0100

    Whitespace change: Add blank line between structures and functions.

commit c56fa58721a710aeb4a41bd73a472354a2128069
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Aug 21 10:39:39 2010 +0100

    appliance: Remove some obsolete testing rules from Makefile.am
    
    This haven't been used -- and haven't worked -- for a long time.

commit 83c221764d0f74a792790c1eca1f6b3f699fa8b6
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Aug 17 14:30:58 2010 +0100

    Version 1.5.3

commit ad373a4d6c2367b78b0dd337c1797f889a94b713
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Aug 2 23:29:43 2010 +0100

    Remove old ocaml-inspector code.
    
    Not used by anyone, didn't work well, and replaced now by the
    C inspection APIs.

commit 4440e22f4f7ebffe0728a8c019319d1a2b260cf5
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Aug 2 17:43:23 2010 +0100

    fish: Reimplement -i option using new C-based inspection.
    
    Don't shell out to virt-inspector.  Instead, use the new C-based
    inspection APIs.
    
    This is much faster.
    
    The new syntax is slightly different:
    
      guestfish -a disk.img -i
      guestfish -d guest -i
    
    However, the old syntax still works.

commit 1a9aa565b38eafe48621bc2fe42d35ea6a907708
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Aug 2 16:33:25 2010 +0100

    fish: Add -c/--connect and -d/--domain options.
    
    The -d option lets you specify libvirt domains.  The disks from
    these domains are found and added, as if you'd named them with -a.
    
    The -c option lets you specify a libvirt URI, which is needed
    when we consult libvirt to implement the above.

commit 8289aa1ad68ec94c87fc4d538f638d8816052d92
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jul 28 15:40:42 2010 +0100

    New APIs for guest inspection.
    
    This commit converts (some of) the Perl inspection code to C and
    makes it available through core APIs.  The new APIs are:
    
    inspect-os        - Does the inspection, returns list of OSes
    inspect-get-*     - Get results of the inspection
    
    where '*' is one of:
    
      type            - 'windows' or 'linux'
      distro          - Linux distro
      arch            - architecture
      product-name    - long product name string
      major-version
      minor-version   - major.minor version of OS
      mountpoints     - get a list of the mountpoints
      filesystems     - get all filesystems associated with the OS
    
    This works for all existing supported Linux and Windows OSes.

commit 65e9ac4595fbace8f301030469932be518456246
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jul 28 23:11:38 2010 +0100

    New APIs: findfs-label and findfs-uuid
    
    These two calls wrap up the /sbin/findfs command, allowing you
    to find a filesystem by only knowing its label or UUID.
    
    This is especially useful when resolving LABEL=... or UUID=...
    entries in /etc/fstab.
    
    Sample guestfish session:
    
    ><fs> vfs-uuid /dev/vda1
    277dd61c-bf34-4253-a8dc-df500a05e7df
    ><fs> findfs-uuid 277dd61c-bf34-4253-a8dc-df500a05e7df
    /dev/vda1
    ><fs> vfs-label /dev/vda1
    /boot
    ><fs> findfs-label /boot
    /dev/vda1
    ><fs> vfs-uuid /dev/VolGroup00/LogVol00
    40ce7c36-82ce-4a12-a99d-48f5e054162c
    ><fs> findfs-uuid 40ce7c36-82ce-4a12-a99d-48f5e054162c
    /dev/mapper/VolGroup00-LogVol00
    ><fs> findfs-uuid 12345678
    libguestfs: error: findfs_uuid: findfs: unable to resolve 'UUID=12345678'

commit ad4cff2625651bda9de25de9aba96bdf213d0a0a
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jul 28 15:38:57 2010 +0100

    New API: file-architecture
    
    This change simply converts the existing Perl-only function
    file_architecture into a core API call.  The core API call is
    written in C and available in all languages and from guestfish.

commit 3cd272fc6acb043b4002dbcbbf741cecbc4820be
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Aug 17 11:26:54 2010 +0100

    generator: No need to redefine safe_* macros.
    
    These are already defined in "guestfs-internal.h" which is
    included in the .c file.

commit 3905cc7ab496549b6ca0a0f67ec61d1d16968c33
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Aug 17 11:26:26 2010 +0100

    Add safe_strndup call.

commit 64d70228c704c49a023ab35499d003e9bb09cd73
Author: Matthew Booth <mbooth@redhat.com>
Date:   Tue Aug 17 12:19:05 2010 +0100

    Send trace output to stderr.
    
    Trace output sent to stdout can be lost in the event of a crash due to
    buffering.  This patch sends it to stderr instead.

commit 834077946a4a7a44bf7f0e5d19aa1d54d39022a4
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Aug 17 10:31:39 2010 +0100

    Python: Use new PyCapsule API where supported.
    
    See:
    http://lists.fedoraproject.org/pipermail/devel/2010-August/141064.html

commit 29925244c1be2d1d5f71d46eba205278624a1366
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Jul 31 14:35:07 2010 +0100

    generator: Fix typo in error message for RConstOptString.

commit 6280ac9b987c14f89749b4b4fdfec5a647567432
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jul 30 16:32:35 2010 +0100

    New API: is-lv: check if a block device is a logical volume (RHBZ#619793)
    
    This adds a new API, guestfs_is_lv (g, device), which returns true iff
    the named device is an LVM2 logical volume.
    
    A sample guestfish session:
    
    ><fs> lvs
    /dev/vg_f13x64/lv_root
    /dev/vg_f13x64/lv_swap
    ><fs> list-devices
    /dev/vda
    ><fs> list-partitions
    /dev/vda1
    /dev/vda2
    ><fs> is-lv /dev/vg_f13x64/lv_root
    true
    ><fs> is-lv /dev/vg_f13x64/lv_swap
    true
    ><fs> is-lv /dev/vda
    false
    ><fs> is-lv /dev/vda1
    false
    ><fs> is-lv /dev/vda2
    false

commit 737181bcd7b1de8c3a613d6282030c34efa78fb6
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jul 28 12:38:36 2010 +0100

    Rename internal functions.
    
    This is an update to commit 41f25ab3df5f306ac717fa7a6efd58328d30c1ae.
    
    Internal functions should be named guestfs___* (3 underscores) to
    avoid clashing with the implementation of actions (2 underscores).

commit 41f25ab3df5f306ac717fa7a6efd58328d30c1ae
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jul 27 13:01:39 2010 +0100

    Rearrange library code into separate files.
    
    We split the library code into these separate files:
    
     - guestfs.c: creating handles, closing handles, handle-related variables
     - actions.c: generated library-side stubs for each action
     - bindtests.c: generated code to test bindings
     - launch.c: launching the appliance
     - proto.c: the library side of the daemon communications protocol
    
    This is just code movement.

commit a617f521a4f695a63ced1c734128dc6c05b7024f
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jul 27 12:29:59 2010 +0100

    Rename guestfs-{actions,bindtests}.c to {actions,bindtests}.c
    
    Rename these two generated files, in preparation for splitting
    up the main src/guestfs.c file.

commit d30176ddbe44549cbdb637fb5725ad8a57c7ca57
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jul 27 11:11:42 2010 +0100

    TODO: Implement inspector code in C.

commit b42d34be04e5b3cfb809bd3b41508812b522b1d9
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jul 27 11:11:09 2010 +0100

    TODO: Implement recursive upload/download in guestfish.

commit 4a7d8cd5ce082ce770376e650a273d00dd73b5aa
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jul 27 11:10:32 2010 +0100

    TODO: Add link to discussion of progress bars.

commit cd773b0707ff26cd128cc37e21ae1456e67060e2
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jul 22 16:53:54 2010 +0100

    Version 1.5.2.

commit e7ee6eebed6ee3a5b56c0482ba2770e697d8febc
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jul 22 16:49:06 2010 +0100

    regressions: Don't print misleading 'Expect error ...' lines.
    
    Some tests in the regressions directory deliberately print
    error messages.  As long as they still PASS, this is OK.
    
    However these tests also printed some misleading messages
    about what error to expect.  Since error messages were slightly
    different across distros, these messages were not accurate.
    
    Therefore remove these messages, and replace with a general
    message before all tests telling users not to worry about
    errors from the tests as long as the tests don't fail.

commit 945e569db64ab2608b21feba0aa94044c9835ac3
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jul 22 11:00:59 2010 +0100

    New APIs: Support for creating LUKS and managing keys.
    
    This commit adds four APIs for creating new LUKS devices
    and key management.  These are:
    
      luks_format         Format a LUKS device with the default cipher.
      luks_format_cipher  Format with a chosen cipher.
      luks_add_key        Add another key to an existing device.
      luks_kill_slot      Delete a key from an existing device.
    
    This enables all the significant functionality of the
    cryptsetup luks* commands.
    
    Note that you can obtain the UUID of a LUKS device already
    by using vfs-uuid.
    
    This also includes a regression test covering all the LUKS
    functions.

commit 2fd8c259d3daa88b0cdf98090bb57f3dbd178432
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jul 22 16:51:05 2010 +0100

    Move variable initialization close to variable use.

commit 799d52be4f08f6c70c0e8ba1aa7367ba4cdd78c4
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jul 22 14:39:36 2010 +0100

    Revert "add_drive_ro adds readonly=on option if available." (RHBZ#617200).
    
    Adding the readonly=on option is not so clever.  This causes
    qemu to present the disk as read-only to the guest.  (The
    expected behaviour of snapshots=on,readonly=on was that it
    would open the disk O_RDONLY but present a writable disk to
    the guest).
    
    Since the guest sees a read-only disk, we are unable to do any
    recovery if a filesystem on the disk is inconsistent.  This basically
    prevents most accesses to live disk images.
    
    What we really want is a qemu option which presents a writable
    disk to the guest, but only opens the disk on the host side with
    O_RDONLY, to alleviate the udev bug RHBZ#571714.
    
    This reverts commit 676462684e05dd8341dd695762dd99a87d8ec022.

commit 2a286f16215ebfac88a32d259f2b68191eb8d27e
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jul 22 10:59:43 2010 +0100

    generator: Make documentation inside guestfish match man page.

commit e67298ce806c75b687e1812168bfa5aa19a83302
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jul 21 21:40:21 2010 +0100

    Version 1.5.1.

commit 637f8df83726ab9b50e8a6d2181bd1e0e93ec13e
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jul 21 19:50:06 2010 +0100

    New APIs: Support for opening LUKS-encrypted disks.
    
    This adds support for opening LUKS-encrypted disks, via
    three new APIs:
    
      luks_open:    Create a mapping for an encrypted disk.
      luks_open_ro: Same, but read-only mapping.
      luks_close:   Close a mapping.
    
    A typical guestfish session using this functionality looks
    like this:
    
      $ guestfish --ro -a encrypted.img
      ><fs> run
      ><fs> list-devices
      /dev/vda
      ><fs> list-partitions
      /dev/vda1
      /dev/vda2
      ><fs> vfs-type /dev/vda2
      crypto_LUKS
      ><fs> luks-open /dev/vda2 luksdev
      Enter key or passphrase ("key"):
      ><fs> vgscan
      ><fs> vg-activate-all true
      ><fs> pvs
      /dev/dm-0
      ><fs> vgs
      vg_f13x64encrypted
      ><fs> lvs
      /dev/vg_f13x64encrypted/lv_root
      /dev/vg_f13x64encrypted/lv_swap
      ><fs> mount /dev/vg_f13x64encrypted/lv_root /
      ><fs> ll /
      total 132
      dr-xr-xr-x.  24 root root  4096 Jul 21 12:01 .
      dr-xr-xr-x   20 root root     0 Jul 21 20:06 ..
      drwx------.   3 root root  4096 Jul 21 11:59 .dbus
      drwx------.   2 root root  4096 Jul 21 12:00 .pulse
      -rw-------.   1 root root   256 Jul 21 12:00 .pulse-cookie
      dr-xr-xr-x.   2 root root  4096 May 13 03:03 bin
    
    NOT included in this patch:
    
     - An easier way to use this from guestfish.
     - Ability to create LUKS devices.
     - Ability to change LUKS keys on existing devices.
     - Direct access to the /dev/mapper device (eg. if it contains
       anything apart from VGs).

commit 581a7965faa5bf242ab3f8b7c259ab17c2e967f4
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jul 21 12:52:51 2010 +0100

    generator: Add 'Key' parameter type.
    
    Add a 'Key' parameter type, used for passing sensitive key material
    into libguestfs.
    
    Eventually the plan is to mlock() key material into memory.  However
    this is very difficult to achieve because the encoded XDR strings
    end up in many places.  Therefore users should note that key material
    passed to libguestfs might end up in swap.
    
    The only difference between 'Key' and 'String' currently is that
    guestfish requests the key from /dev/tty with echoing turned off.

commit 2e7da2a2f3bbc6d6db148d7dc2ce238bf56f34db
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jul 21 12:52:10 2010 +0100

    generator: Remove unnecessary parameter.
    
    The 'name' parameter is not used on the right hand side of the
    match, so it can be removed.

commit 45a4cd79215752234c4a5a47fb4c9c6741b1594c
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jul 16 18:11:56 2010 +0100

    df: Minimize the number of times we launch the libguestfs appliance.
    
    This commit greatly improves the performance of the 'virt-df'
    command by batching as many disks as possible onto a single appliance.
    In many situations this means the appliance is launched only once,
    versus one launch per domain as before.
    
    However doing it this way is a lot more complex:
    
    (1) Because of limits in Linux and virtio-blk, we can only attach
    26 disks maximum at a time to the appliance.
    
    (2) We have to use LVM filters (lvm-set-filter) to confine LVM to
    the disks of a single guest.

commit d2cf9a15a9f22623dbbed33fb66c5077f1275df2
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jul 16 13:01:21 2010 +0100

    New APIs: lvm-set-filter and lvm-clear-filter.
    
    These APIs allow you to change the device filter, the list of
    block devices that LVM "sees".  Either you can set it to a fixed
    list of devices / partitions, or you can clear it so that LVM sees
    everything.

commit 321ca1ef91a90cec5b94058b84420e8018e3f1d8
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jul 16 12:58:54 2010 +0100

    Use an unsigned type (size_t) for all loop iterators.
    
    This resolves a warning from gcc 4.5:
      assuming signed overflow does not occur when simplifying
        conditional to constant
    
    This page explains the issues in some detail:
      http://www.airs.com/blog/archives/120

commit aac51942aab63a9355ad6724345ea923148bf2a9
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jul 16 12:57:24 2010 +0100

    generator: Don't hard-code name in DeviceList check.
    
    Only one function currently uses DeviceList.  The generated code
    unfortunately hard-coded the argument name from that function.

commit 0c0976496dafda4d172c5a7fc787d6a87d5bce8d
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jul 16 12:55:17 2010 +0100

    build: Don't warn about 'long long'.
    
    Various language bindings simply need this, so we have to allow
    it even though it's a GCC extension.

commit 5b77be72bc4e46c7a53a24f1eb4cbd107a708f17
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jul 16 15:17:01 2010 +0100

    doc: Add guestfish 'lvcreate 1M' gotcha.

commit 70d27f6e796097630134bd8ebc2b65a65b1bf5c4
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Jul 11 23:11:45 2010 +0100

    tar: Remove redundant use statement.

commit 10ea14a3f1adb7023dd0601e4759bd24a030a1c3
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Jul 11 23:11:08 2010 +0100

    edit: Clean up temporary files.
    
    Note to self: The 'tempfile' function does *not* default to
    removing files with the program exits!

commit fed8714b92b57da1a593f74b52635fd267442d5b
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Jul 11 23:09:07 2010 +0100

    edit: Add -b (backup) option and make uploading more robust.

commit 8f6d8b05152fda68e0c01848c0e5239e0093548a
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Jul 11 16:46:15 2010 +0100

    edit: Add -e 'expr' option to non-interactively apply expression to the file.
    
    (Suggested by Justin Clift).

commit 58667f2be077a4b05c9c640d58fb946b52ef2e88
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jul 8 11:54:50 2010 +0100

    Prepare for new development branch, starting at 1.5.0.
    
    Add BUGS and RELEASE-NOTES to EXTRA_DIST.
    
    Also update the RELEASE-NOTES file.

commit 49a71a4c606d52f78c364860a8917cf1076169e7
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jul 2 17:52:51 2010 +0100

    Make tmp directory world readable (RHBZ#610880).
    
    If you have a restrictive umask (0077 for example) then
    files in the tmp directory would be created with 0600
    permissions.  Example:
    
    drwx------.  2 rjones rjones     4096 Jul  2 17:52 .
    drwxrwxrwt. 57 root   root     102400 Jul  2 17:52 ..
    -rw-------.  1 rjones rjones 86328832 Jul  2 17:52 initrd
    lrwxrwxrwx.  1 rjones rjones       46 Jul  2 17:52 kernel -> /boot/vmlinuz-2.6.33-0.40.rc7.git0.fc13.x86_64
    
    This in itself is not a problem.  However in virt-v2v we also
    change UID:GID and the result is that qemu is unable to read
    the initrd file:
    
    qemu: could not load initial ram disk '/tmp/libguestfs2ssynP/initrd'
    
    With this patch we make the tmp directory and the files
    world readable.  After the patch:
    
    $ ls -la /tmp/libguestfsJFVzPg/
    total 116192
    drwxr-xr-x.  2 rjones rjones      4096 Jul  2 18:03 .
    drwxrwxrwt. 56 root   root      102400 Jul  2 18:03 ..
    -rw-r--r--.  1 rjones rjones 118869504 Jul  2 18:03 initrd
    lrwxrwxrwx.  1 rjones rjones        46 Jul  2 18:03 kernel -> /boot/vmlinuz-2.6.33-0.40.rc7.git0.fc13.x86_64

commit 8161ea9bb046c8450384b5b15e1f4b2f3dca582b
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jul 7 15:01:38 2010 +0100

    fish: Don't fail if -m and --listen flags are both given (RHBZ#612178).
    
    Testing this against a Fedora disk image:
    
    $ ./fish/guestfish --ro -a F13.img -m /dev/sda1 --listen
    export GUESTFISH_PID=6033
    $ ./fish/guestfish --remote=6033 -- ping-daemon
    $ ./fish/guestfish --remote=6033 -- ping-daemon
    $ ./fish/guestfish --remote=6033 -- exit
    
    Without this fix the first remote command would fail because
    qemu would have already been killed.

commit cf9e01508d48b752a29df4fceb95ed5306651fe2
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jul 2 20:12:41 2010 +0100

    todo: Add comment about progress of long-running operations.

commit 015b7a2ee6b4ba0f1400640fa16e2526a69d081e
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jul 2 10:50:38 2010 +0100

    inspector: Improve error message when YAML::Any library is not installed.

commit 9928498ad87ed1d7a1c191d5637d36d5f9b09ee4
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Jun 28 13:51:42 2010 +0100

    Explicitly depend on e2fsprogs.
    
    See: http://lists.fedoraproject.org/pipermail/devel/2010-June/137953.html

commit 61adbba900a4150110d9fcd20097b3a5c249e6c7
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Jun 28 09:13:36 2010 +0100

    Fix gfs2 support by adding required kernel modules.

commit 02b3ed7a4a5d1f51b6264e2e094194354a5e4401
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jun 16 16:12:52 2010 +0100

    Version 1.3.21.

commit 1079f74704a06c06996e547fdecf20a8f92799c6
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jun 16 15:25:45 2010 +0100

    ocaml: Fix thread safety of strings in bindings (RHBZ#604691).
    
    There's a thread safety issue with the current OCaml bindings which
    is well explained in the bug report:
    
    https://bugzilla.redhat.com/show_bug.cgi?id=604691
    
    This commit fixes the safety issue by copying strings temporarily
    before releasing the thread lock.  Updated code looks like this:
    
      char *filename = guestfs_safe_strdup (g, String_val (filenamev));
      int r;
    
      caml_enter_blocking_section ();
      r = guestfs_add_drive_ro (g, filename);
      caml_leave_blocking_section ();
      free (filename);
      if (r == -1)
        ocaml_guestfs_raise_error (g, "add_drive_ro");
    
    Also included is a regression test.

commit 1e568f057e8bb7b36cc14e0e531d74b75ad9cb6c
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jun 16 14:29:39 2010 +0100

    TODO: Add a note about impl of list-filesystems.

commit e832959a4d5645cb0168bd7b810d5cfcd6767168
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jun 15 11:15:30 2010 +0100

    todo: More ideas for TODO list.

commit 2ce51fda79ac406b27e27a3ccb65f115f5660c81
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jun 15 11:15:06 2010 +0100

    Update Spanish translations (RHBZ#603870).

commit e67e216118df3a724482cb698a868ecbaacbf326
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jun 11 10:40:48 2010 +0100

    perl: Check all images are defined in first param of open_guest.

commit eb566f7dc7974b42ac65729a2e5e5bcee329a0a9
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jun 10 15:25:43 2010 +0100

    perl: Add explicit close() method (RHBZ#602592).
    
    This add an optional explicit $g->close method which may be
    used to force the handle to be closed immediately.  Note the
    provisos about this method in the manual page entry.  Callers
    should *not* normally use this method.
    
    The implementation of the handle also changes.  Before, the
    handle was a blessed reference to an integer (the integer
    being the pointer to the C guestfs_h handle).  Now we change
    this to a hashref containing currently the following field:
    
      _g => pointer to C guestfs_h handle (as an integer)
    
    If this field is not present, it means that the handle has been
    explicitly closed.  This avoids double-freeing the handle.
    
    The user may add their own fields to this hash in order to store
    per-handle data.  However any fields whose names begin with
    an underscore are reserved for use by the Perl bindings.
    
    This commit also adds a regression test.
    
    This commit also changes the existing warning when you call
    a method without a Sys::Guestfs handle as the first parameter,
    into an error.  This is because such cases are always errors.

commit dbfd93b72f99ebdded394541a48177c415db8cbf
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jun 10 12:38:57 2010 +0100

    Add error callback (RHBZ#602599).
    
    Read the note in the man page before using this feature.

commit 91b00dc092be17a309f14fc35f41dbf1e41c4c58
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jun 10 12:26:06 2010 +0100

    Fix typo in documentation of guestfs_set_launch_done_callback.

commit 4dad67b6839e758dfbb0a8499fb96b3392b3a37b
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jun 8 18:17:37 2010 +0100

    Version 1.3.20.

commit a043b6854a0c4c40726746c0e29d2a183b25ec62
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jun 8 18:17:46 2010 +0100

    Revert "perl: Rerun configure if MAX_PROC_NR changes."
    
    This reverts commit f8ee7869f4836427109959cf20e299a31fa86eaf.

commit d706d7d40e81abac28eb00f8b103db28a282f854
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jun 8 18:12:32 2010 +0100

    TODO: Freeze/thaw filesystems.

commit 6e9b06d99058bdd4d8792506054ec3cd8cb8c736
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jun 8 18:11:16 2010 +0100

    TODO: Need to add regression test for virt-inspector.

commit 899420256134866605a977425aa927ebc4bb6f3f
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jun 8 18:04:17 2010 +0100

    TODO: 'file' command should be fixed.

commit aaf03a51a26ee501f5dbf2720bbb8a5e3b4e1e6b
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jun 8 16:44:18 2010 +0100

    virt-df: Disallow -h and --csv options together (RHBZ#600977).
    
    Before this commit, if you used the -h and --csv options together
    you would get these warnings from virt-df:
    
    $ virt-df -h --csv Guest
    Virtual Machine,Filesystem,Size,Used,Available,Use%
    Argument "13.5G" isn't numeric in printf at /home/rjones/d/libguestfs/tools/virt-df line 298.
    Argument "4.7G" isn't numeric in printf at /home/rjones/d/libguestfs/tools/virt-df line 298.
    Argument "8.1G" isn't numeric in printf at /home/rjones/d/libguestfs/tools/virt-df line 298.
    "/dev/vg_trick/RHEL55x64","/dev/VolGroup00/LogVol00",13,4,8,34.8%
    Argument "98.7M" isn't numeric in printf at /home/rjones/d/libguestfs/tools/virt-df line 298.
    Argument "18.8M" isn't numeric in printf at /home/rjones/d/libguestfs/tools/virt-df line 298.
    Argument "74.9M" isn't numeric in printf at /home/rjones/d/libguestfs/tools/virt-df line 298.
    "/dev/vg_trick/RHEL55x64","/dev/vda1",98,18,74,19.0%
    
    We could fix this so that the human-readable numbers get written
    into the CSV file.  However would probably be wrong for most uses
    of the CSV format (databases and spreadsheets) since they would not
    be able to interpret these human-readable numbers, or worse could
    misinterpret, eg. thinking that "1M" and "1G" are both 1.
    
    Therefore this commit disallows this combination of options.

commit ba39ced8804765705f4c61a92db0fddb8d672c7d
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jun 8 16:04:01 2010 +0100

    file: Fix file command on /dev/VG/LV paths (RHBZ#582484).
    
    Previous commit 4df593496e116dfb635731c058b7627e81fc179c broke the
    "file" command on logical volume paths, since these are symbolic
    links.  We *should* follow these (only).
    
    This inadvertantly broke virt-inspector too, which indicates that
    we need more regression testing in this area.  Since carrying whole
    Fedora images around could make the distribution even larger than
    now, I'm not sure at the moment how to do this.
    
    Thanks to Matt Booth for diagnosing this bug.

commit 1253f577fa162b9170b22f3c543167aa99795920
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Jun 7 15:29:31 2010 +0100

    Use the noop scheduler inside the appliance.
    
    In my limited tests, this seems to make a small but noticable
    difference, improving the performance of some straightforward
    read operations by a little over 10%.
    
    For more information see:
    http://kbase.redhat.com/faq/docs/DOC-5428

commit 1fd03b8400635d9c62ec0d635984128868e5bb63
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jun 4 18:44:49 2010 +0100

    Add release notes.
    
    To generate the "Bugs fixed" list, run the bugs-in-changelog script
    like this:
    
      ./bugs-in-changelog 1.0.89..

commit 6c27155621f75351a3b18237ac7631f0eb12c336
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jun 4 16:38:55 2010 +0100

    Version 1.3.19.
    
    Update BUGS and PO files.

commit 4df593496e116dfb635731c058b7627e81fc179c
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jun 4 11:45:06 2010 +0100

    file: Restrict to regular files (RHBZ#582484).
    
    The file call can hang if called on char devices (because we are
    using the file -s option).
    
    This is hard to solve cleanly without adding another file API.
    
    However this restricts file to regular files, unless called explicitly
    with a /dev/ path.  For non-regular files, it will now return a
    string like "directory".
    
    There is a small semantic change for symbolic links.  Previously
    it would not have worked at all on absolute links (or rather, the
    results would have been undefined).  It would have treated relative
    symlinks to regular files as the regular file itself.  Now it will
    return the string "symbolic link" in both cases.
    
    This commit also makes the API safe when called on untrusted
    filesystems.  Previously a filesystem might have been set up so
    that (eg) /etc/redhat-release was a char device, which would have
    caused virt-inspector and virt-v2v to hang.  Now it will not hang.

commit 74958b0ad44df6ed703cd3009983d04ade3a8e93
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jun 4 11:55:54 2010 +0100

    touch: Restrict touch to regular files only (RHBZ#582484).

commit e3befe5a2e85179dcc5a52aa7d74b9cc5f3430ec
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jun 4 11:23:01 2010 +0100

    daemon: Rearrange code in 'file' command.
    
      path = path to access file (/sysroot/.. or /dev/..)
      display_path = original path, saved so we can display it
      buf = optional buffer which is freed along return codepaths
    
    There should be no change to the semantics of the code.

commit 32f48cc3330a50b7b9e2af7db0f0470da209bb6f
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jun 4 11:21:58 2010 +0100

    gnulib: Ignore asm-underscore.m4 in the correct place.

commit 00cc40a5f3304ff940fed302107067945177f31f
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jun 4 09:46:34 2010 +0100

    Update to latest gnulib.

commit 4d5c22800214008b229e937dada2299de8353d9e
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jun 3 14:03:08 2010 +0100

    mkfs-b: Map block size to cluster size for VFAT and NTFS partitions (RHBZ#599464).
    
    This also adds a regression test for VFAT and (conditionally)
    NTFS filesystems.

commit 0606cb54671e10f104b4eba1c70378ef8725322b
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jun 3 14:01:18 2010 +0100

    mkfs-b: Check that blocksize parameter is > 0 and a power of 2.

commit f9d08600c52dc0730e7dad8d9259b59e32aeece2
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jun 3 14:31:58 2010 +0100

    generator: Allow individual tests to depend on daemon features.
    
    Using IfAvailable "featurename" we allow individual tests to
    only run if the feature is available in the daemon.
    
    This will allow us to extend testing to a lot more optional
    features such as NTFS.

commit cbe80b2bcfdee437d195f25aaf6f5d96329ab360
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jun 3 14:30:36 2010 +0100

    tests: Factor out common code into 'is_available' function.
    
    This commit is just code motion.

commit 8fca8549edb1581448fa45d08d90bad399c5dbfa
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jun 3 11:49:38 2010 +0100

    grub-install: Enable grub-install tests and create explicit device.map file.

commit dccd9b8f525cfae49b89c38066d752e6c054c7f6
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jun 3 11:48:41 2010 +0100

    grub-install: In docs suggest manually creating device.map (RHBZ#484986).

commit fbe0802f9d237837d10026471186b1ef973c0877
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jun 2 18:47:30 2010 +0100

    Version 1.3.18.
    
    Update BUGS and PO files.

commit ac37f65aaf1f162a2cc57fa8c296a1ff4109adb9
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jun 2 17:12:59 2010 +0100

    RHEL 6: sr_mod.ko is needed for RHEL 6 to see CD-ROM devices (RHBZ#598807).

commit cbb026036826f2ab40237aec0b0c5453b859625d
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jun 2 15:35:58 2010 +0100

    parted: Check partition number >= 1 in several calls.

commit 3ab2d089f3eb34562bc2c9ce4310869b46c69d70
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jun 2 12:32:33 2010 +0100

    daemon: Parse output of old parted which didn't support -m option (RHBZ#598309).
    
    This fixes the following commands when run with RHEL 5-era parted:
    
      get-bootable
      get-parttype
      part-list

commit aee7d55fcf754d97d945c318ec06d6387ade067b
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jun 2 12:31:40 2010 +0100

    daemon: count_strings function returns size_t

commit 50eed6d20de9b6d16975c3c0bbf6e545f8fba1fe
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jun 2 15:10:38 2010 +0100

    base64-in: Ignore garbage characters in input.
    
    On RHEL 5 you have to specify the -i option to get the
    external 'base64' command to ignore \n characters.  (The
    Fedora version seems to ignore these characters anyway).
    
    Add this option so the tests can pass on RHEL 5.

commit 1020b212b189968ead013436cac79019fbd8fdad
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jun 2 13:27:19 2010 +0100

    resize2fs: Document this command also works with ext4 (thanks Yufang Zhang).

commit f2b7a8e15c49ebc70c7ea56aefb340362aae5a99
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jun 1 16:27:33 2010 +0100

    fish: help command return error for non-existent commands (RHBZ#597145).
    
    With this change, the exit status indicates error for non-existent
    commands.
    
    $ guestfish -h foo
    foo: command not known, use -h to list all commands
    $ echo $?
    1
    $ guestfish help foo
    foo: command not known, use -h to list all commands
    $ echo $?
    1

commit 9733d4746988b3a072d8bb1daac4b9795b8f4134
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jun 1 16:18:53 2010 +0100

    daemon: write-file: Check range of size parameter (RHBZ#597135).
    
    This also adds a regression test.

commit 52f9cd4882135910ea06e1e50ac6441d455c9ab1
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jun 1 15:50:14 2010 +0100

    daemon: Limit label lengths (RHBZ#597118).

commit 000f8059a53860ddf3319c1f54d4df5dcd6aa846
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jun 2 13:36:19 2010 +0100

    Update BUGS and PO files.

commit da4812ab6b44c29cb3cf181c7aa896420ecb8aa6
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jun 1 14:04:51 2010 +0100

    Fix and deprecate get_e2label and get_e2uuid (RHBZ#597112).
    
    Fix these calls (see description in RHBZ#597112), but also
    deprecate them since the new calls vfs_label and vfs_uuid can
    work on any filesystem type.
    
    This also adds a regression test for the original bug reported
    in RHBZ#597112.

commit 27b730a6820b80a49a4da1af9f4c8e8a952f735e
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jun 1 13:57:12 2010 +0100

    New APIs: vfs-label and vfs-uuid return label and uuid for many fs types.
    
    These APIs generalize the existing 'get-e2label' and 'get-e2uuid'
    calls, to provide calls which should be able to get the label
    and UUID for most filesystem types.  These use 'blkid' to do the
    work.
    
    I have tested that the blkid commands themselves work on RHEL 5.
    
    (Suggested by Yufang Zhang).

commit 21c42e9fabf6cea3d564e338a314479ef120502a
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jun 1 15:27:57 2010 +0100

    daemon: Kill blkid cache to improve reliability of blkid commands.
    
    By killing the cache file, we make blkid work in situations such
    as a just-created filesystem.

commit 85c71f8fff3e80f549342bf995b686ba7303c2b4
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jun 1 13:39:25 2010 +0100

    daemon: Generalize the implementation of vfs-type.
    
    Note that there is no change to the semantics of the code.

commit fc1dc099a1ceeea45d3c21c699daf39618ca714a
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 28 20:08:01 2010 +0100

    todo: Should generate -N option.

commit 0e42861ccf9e55582db13828ca4eaef213de1f8a
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 28 20:05:56 2010 +0100

    todo: Remove implemented resize functions from TODO file.

commit 90b3539e28c1c5ab7e6a21c0d160010444773734
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu May 27 15:47:51 2010 +0100

    Make the supermin appliance include local augeas lenses

commit 245ed4b8eb076a8c4cc5787f49d21c4f68630f9f
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu May 27 15:47:50 2010 +0100

    Rely on new augeas lens for modules.conf and conf.modules
    
    Latest augeas includes a lens for /etc/modules.conf. If this new lens is
    present, the code to force the Modprobe lens to try to match /etc/modules.conf
    as well results in /etc/modules.conf not being parsed at all. This results in
    modprobe_aliases in virt-inspector output being empty.
    
    This change is equivalent to change cfd28d1140393667913689b7b9bcf21c8bfe592c
    from virt-v2v.
    
    An effect of this change is that the Modules_conf augeas lens is now required
    for correct operation on guests which use /etc/modules.conf.
    
    Fixes RHBZ#596776

commit 1b566fd6881943538bc50a92dec90d8d9b19d239
Author: Daniel Cabrera <logan@fedoraproject.org>
Date:   Thu May 27 15:20:37 2010 +0100

    Updates to Spanish translation (RHBZ#596763).

commit e3881fd0b706532fe0820a625cd1529ca07e1094
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 27 12:03:43 2010 +0100

    Version 1.3.17.

commit 0f6c6239fe0d1b4624e4e9776559c21486a9c7cf
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 27 10:37:43 2010 +0100

    Fix documentation for vfs-type to reflect reality.

commit 11eeb8885c7a8ffb59e12cd5fb2ae0fc324df383
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 27 10:32:51 2010 +0100

    Clarify documentation on distro backports in version command.

commit 8355d3245623c106439ca5ef66f24972c8e09019
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 27 10:31:07 2010 +0100

    Add reference to version number documentation to version command.

commit d12a702fe1898f3ea421210d92c705440efe07a8
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 27 10:25:18 2010 +0100

    Clarify sparse behaviour of truncate-size command.

commit 4412fd951ee7766ee9a70bf66b5cf11378a64ed0
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 27 10:03:47 2010 +0100

    Fix typo in documentation of guestfs_readlinklist.

commit b8861242d13cc034383a56ba891d3e0b9123a99c
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 27 10:01:25 2010 +0100

    Fix missing word in docuentation of guestfs_readdir.

commit 1d1cc4114d48623fb44e3d18e74407902c8f2ae9
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 27 09:49:28 2010 +0100

    Revise documentation on creating files.

commit 6b500f1b8e1ac8d28c485a5591c2833b18cc86e2
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 27 09:48:22 2010 +0100

    New API: fallocate64 (replaces fallocate).
    
    guestfs_fallocate takes an integer for the length, effectively
    limiting it to creating 1GB files.  This new call takes an int64_t
    for the length, but is otherwise identical.

commit c1e3cff523d72e8110cbc568a3c280e57c2aabca
Author: Richard Jones <rjones@redhat.com>
Date:   Wed May 26 23:42:43 2010 +0100

    Fix typo in description of echo-daemon command.

commit c35c83167dcdac440213c92e03b5e9bb1cf97ddb
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 25 23:17:58 2010 +0100

    Version 1.3.16.

commit b0cd2042bb5a9e086ea21d34b40418b7d191bc1e
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 25 23:16:23 2010 +0100

    Add bash complation script to EXTRA_DIST.

commit 5fb9cddf1ecc82c0f4fb7701902913ce7effb7a7
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 25 22:45:45 2010 +0100

    Version 1.3.15.

commit 2b7af34c30b5ea6ab4b27032d5ae4cd609c332d2
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 25 22:24:12 2010 +0100

    Add tests for available-all-groups command.

commit f7d3c8ec692a0f2596b0410a47fa69871904b2e9
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 25 20:13:55 2010 +0100

    fish: First pass at guestfish bash completion script.

commit 21bd2db7cf259a17cc3922409937b849e4b83c0f
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 25 13:54:11 2010 +0100

    fish: Don't eat words when completing case-insensitive paths (RHBZ#582993).

commit 53c3b9d2b03fa5cb0ac7e86a5a51f2a18a2b91c1
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 25 13:52:53 2010 +0100

    fish: Sort returned paths so the list is stable across multiple calls.

commit 06d8064ff8a57eba051044efd1ea1a33c34b9df0
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 25 13:52:17 2010 +0100

    fish: Document test1.img, test2.img etc used by -N option in FILES section.

commit 7fd6e4bfb11d1f86c585de06fb2146aa5cbd400e
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 25 13:51:58 2010 +0100

    fish: Create a separate FILES section in the manpage.

commit 34a306ab2a7e6d9f468e8194cef8a05624325260
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 25 13:41:39 2010 +0100

    fish: Move 'EXIT CODE' section to a more logical place in the documentation.

commit 0e28e4104d96bf0bf5b88fb07bb7e5f9f6e6f41f
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 25 11:45:23 2010 +0100

    resize: Refresh the examples in the documentation.
    
    The documentation was previously very intimidating.  Bring some
    common, simple examples up to the top of the page in a separate
    section.

commit 57cc217335ff511e579b094e47b0de57d5c3aaef
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 25 11:44:43 2010 +0100

    fish: Make the read/write warning more prominent.
    
    Follow the example on other manual pages by making the warning
    more prominent.

commit c9f1a45334efca844c8918b9f0de373f16fd9766
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 25 11:28:09 2010 +0100

    fish: New command: 'supported'
    
    This checks all available optional groups and prints out which
    ones are supported by the daemon.  Note you must launch the appliance
    first.
    
    Example:
    
    ><fs> supported
          augeas yes
         inotify yes
     linuxfsuuid yes
    linuxmodules yes
     linuxxattrs yes
            lvm2 yes
           mknod yes
          ntfs3g yes
       ntfsprogs yes
        realpath yes
           scrub yes
         selinux yes
              xz yes
        zerofree yes

commit 1bd1f9b85f45275b1600d148530bc1877ff15213
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 25 11:27:49 2010 +0100

    New API: available-all-groups to return list of all optional groups.

commit f8ee7869f4836427109959cf20e299a31fa86eaf
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 25 11:25:12 2010 +0100

    perl: Rerun configure if MAX_PROC_NR changes.
    
    If MAX_PROC_NR changes (because a new API has been added to the
    generator) then we need to rerun configure in order to set the
    Makefile's ${MAX_PROC_NR} variable, in order to rebuild Makefile.PL.

commit 90c51f911366656c781868c60a96524b7be79717
Author: Piotr Drąg <piotrdrag@gmail.com>
Date:   Tue May 25 09:41:20 2010 +0100

    Update Polish translations (RHBZ#502533).

commit f323479760ab23755d6b4f27c236befb5a4d6111
Author: Richard Jones <rjones@redhat.com>
Date:   Mon May 24 13:35:31 2010 +0100

    Version 1.3.14.

commit a554c62b709491401c9d3db744c21f6e543e11ba
Author: Richard Jones <rjones@redhat.com>
Date:   Mon May 24 13:34:33 2010 +0100

    build: Remove install_kernel from EXTRA_DIST.
    
    This updates commit a34fadf900625f1f7359ecf3ca760820ffa20815,
    removing this now non-existent script from EXTRA_DIST.

commit 613d041c78e25dafc238696f2fe35b51e443f23b
Author: Richard Jones <rjones@redhat.com>
Date:   Mon May 24 12:09:38 2010 +0100

    build: For development releases, print a notice.

commit 94030c5ce8b5848330e15e812a01064d5afcc6d0
Author: Richard Jones <rjones@redhat.com>
Date:   Sat May 22 18:51:57 2010 +0100

    guestfs_version: Correct documentation.
    
    Remove reference to 'ELF weak linking tricks' and replace
    with suggestion to use dl* functions.

commit 012b1c71f4eda3ae779da51d7d81c199d90f667d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 21 18:20:28 2010 +0100

    Build workaround for Python 2.4.x in RHEL 5.
    
    See:
    http://www.python.org/dev/peps/pep-0353/#conversion-guidelines

commit 63e8da5abeaad1d2aa332fc41ad8f161fc567cdf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 21 16:14:07 2010 +0100

    C99 compatible build fix for RHEL 5.

commit 7cb6fac3074c52ac3c3e9ead5d99e4a2887cf7b1
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 21 14:14:59 2010 +0100

    New API: ntfsresize-size to allow shrinking NTFS (RHBZ#585223).

commit 9be89728f2a0ff17d54a0dba981015fa6405eb50
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 21 14:14:25 2010 +0100

    New API: pvresize-size to allow shrinking PVs (RHBZ#585222).

commit 71b02d6654395ff04689055f3820b3ad4e54ec00
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 21 14:13:24 2010 +0100

    New API: resize2fs-size to allow shrinking ext2 filesystems (RHBZ#585221).

commit 5e1aff7856f721bf5737815a5b65c0de23ab0b0c
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 21 13:07:05 2010 +0100

    fish: Allow suffixes on number parameters (eg. 1M)
    
    This small change uses the gnulib xstrtoll functionality to
    enable suffixes on integer parameters in guestfish.  For example:
    
     truncate-size /file 1G
    
    (previously you would have had to given the full number).
    
    This also applies to the 'alloc' and 'sparse' commands (and
    indirectly to the -N option).  The specification for these commands
    has changed slightly, in that 'alloc foo 1MB' would now use SI
    units, allocating 1000000 bytes instead of a true megabyte.  All
    existing uses would use 'alloc foo 1M' which still allocates true
    megabytes.

commit 48a216a06d6fdab3c8292c383a37cd990c0bf939
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 21 14:51:29 2010 +0100

    fish: Fix '-N part' disk partition type sub-option.

commit 478e1942a9fb4d86b0c4701b6b71f1eac376d0c1
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 21 11:25:36 2010 +0100

    TODO: Suggest including undelete utility.

commit aecdf3c117874e3dc44282600b988d18350b3ad5
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 21 11:25:19 2010 +0100

    Fix name of update-bugs script in output file BUGS.

commit 5f9630338b59d422b640a25a02b46abb3c5f1986
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 20 18:53:10 2010 +0100

    ubuntu: Use direct udevd method to start udev on Ubuntu.
    
    On Ubuntu, /etc/init.d/udev is a symlink to an upstart file,
    but running that causes the appliance to hang.
    
    Therefore detect if this is a symlink and fall through to the
    direct start of udevd.  This shouldn't affect Debian because the
    file is not a symlink on standard Debian.

commit 4557112772c2efaaf36c01ecb9dfe2a9f1899cc2
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 20 13:54:13 2010 +0100

    ubuntu: Remove two FUSE packages from the default list.
    
    fuse-utils (a dependency of these) cannot be installed under
    debirf because it does something with the system udevd which is
    not permitted.  Seems to be a bug either in fakeroot or in the
    post install scripts for fuse-utils.

commit 4312988e0e3acc1f641b70072141916d03623570
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 20 11:04:30 2010 +0100

    ubuntu: Ignore packages in packagelist.in which are missing.
    
    For distros using 'yum', packages which cannot be found are just
    ignored.  This allows us to include for example 'e4fsprogs' on the
    list even though that only exists on RHEL 5.
    
    However for Debian-derived distros, missing packages would cause
    apt to fail.  This was particularly a problem when building Ubuntu
    since it doesn't have as complete a list of packages, and the list
    changed a lot between releases.
    
    This commit adds a check first for missing packages, ignoring those
    and thus acting more like 'yum'.

commit 2954491e73d8da7a57eeded2037ae98d1055b3c6
Author: Richard Jones <rjones@ubuntu910x64.home.annexia.org>
Date:   Mon Dec 21 15:52:36 2009 +0000

    Ubuntu: Use apt-get instead of aptitude when installing guestfsd.

commit a34fadf900625f1f7359ecf3ca760820ffa20815
Author: Richard Jones <rjones@ubuntu910x64.home.annexia.org>
Date:   Mon Dec 21 15:50:59 2009 +0000

    Ubuntu: Revert install-kernel to debirf default script.

commit 53ca11ee44f71ed056f72df9769ca93b9a35e1a7
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 20 10:39:44 2010 +0100

    generator: Make 'xz' into an optional group.
    
    On Ubuntu <= Karmic, xz-utils was not packaged, and therefore
    any xz-related tests would fail.  Thus make this an optional
    group so that we can test for this and avoid running the tests
    if xz utils are not present.

commit 30c091f49dafab4ca9c8b6640d19fc0450b15971
Author: Richard Jones <rjones@redhat.com>
Date:   Wed May 19 12:27:00 2010 +0100

    generator: Check parameters are not NULL (RHBZ#501893).
    
    This adds additional tests to check that several types of parameter
    including String are not NULL when passed to the C functions.
    Previously this would cause a segfault inside libguestfs.  With
    this change, you get an error message / exception.
    
    Of the possible pointer parameters, only OptString is now permitted
    to be NULL.
    
    This change does not affect the Perl bindings.  This is because Perl
    XS code was already adding similar checks if you passed undef into
    a parameter expecting a string.

commit e715451fae0ba738973af98a4e506b6c5564626a
Author: Richard Jones <rjones@redhat.com>
Date:   Wed May 19 12:25:03 2010 +0100

    generator: Some String parameters should be OptString (RHBZ#501894).
    
    I haven't checked the list of functions exhaustively, but
    these are the obvious ones.

commit 9735484c3579e4e4705cd99dd2f6617186b069cc
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 18 23:49:43 2010 +0100

    fuse: Implement write syscall (RHBZ#592883).

commit 1214b321621e7750c67423ecf4d9528809e1eeac
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 18 23:20:30 2010 +0100

    New API: Implement pwrite system call (partial fix for RHBZ#592883).

commit 3920ad95f6b2db8fbf20aa26692877a09070cb04
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 18 21:51:05 2010 +0100

    New API: write for creating files with fixed content (RHBZ#501889).
    
    The guestfs_write call can be used to create small files with
    arbitrary 8 bit content, including \0 bytes.
    
    This replaces and deprecates write-file, which cannot be modified
    to use BufferIn because of an unfortunate choice in the ABI: the
    size parameter to write-file, if zero, means that the daemon tries
    to calculate the length of the buffer using strlen.  However this
    fails if we pass a zero-length buffer using BufferIn because then
    the daemon tries to do strlen on a (really) zero length buffer, not
    even containing a terminating \0 character, thus segfaulting.

commit bda6cf75f259992bcba23c3c4c2339c50552f491
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 18 21:47:19 2010 +0100

    generator: Implement BufferIn parameter type (RHBZ#501889).
    
    The BufferIn argument turns into various things:
    
     in C      const char *, size_t parameter pair
    
     in XDR    an opaque<> type (instead of string) which allows \0 chars
    
     in other bindings
               mostly just a string, since most languages except for C
               permit strings to contain any 8 bit data

commit 5af010c96d687a7cf5251107a74770a231f42b77
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 20 10:11:18 2010 +0100

    fish: Fix build error if built without readline.
    
    fish.c:1447: error: 'add_history_line' defined but not used [-Wunused-function]
    
    (Reported by Matt Booth)

commit 6e10a24df0361b3e33cdfa4f0c16018a796f8b78
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 18 23:18:35 2010 +0100

    appliance: Fix /etc/resolv.conf
    
    Since changing to use link local address
    (commit fbf29976b33a69c64dc7847c54454bf2cfa5fde6)
    we have included an incorrect resolv.conf file in the appliance
    which points to the old (qemu) DNS server.  This commit changes
    to use the new DNS server.

commit 58d1f3c0306d2cd9de8cf16071732f88a36c06c1
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 18 21:54:17 2010 +0100

    Update BUGS.

commit 49fae775c4af7e99f94ff17212d153e60b15dd56
Author: Daniel Cabrera <logan@fedoraproject.org>
Date:   Tue May 18 14:38:57 2010 +0100

    Update Spanish translations (RHBZ#593292).

commit 2dc7bb00337656c00fabed2c1f017aac1fa09da4
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 18 10:02:02 2010 +0100

    appliance: Ignore utempter unreadable binaries (for RHEL 6).

commit 155aa76e57c99594a3724933b6d117f1053544b3
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 18 10:01:45 2010 +0100

    appliance: Change comment about unreadable binaries.

commit f1b651a99b93046b46641ca03e5ed6082866f7ef
Author: Richard Jones <rjones@redhat.com>
Date:   Sat May 15 20:54:26 2010 +0100

    Version 1.3.13.

commit ef5f1325888493cfd4f35b5a178188b7740f6765
Author: Richard Jones <rjones@redhat.com>
Date:   Sat May 15 13:49:55 2010 +0100

    Update BUGS

commit d858418b8b1493a4075970cefa3bf1530343c7de
Author: Richard Jones <rjones@redhat.com>
Date:   Sat May 15 08:44:04 2010 +0100

    Update PO files.

commit 002dc21cba1469cc5b1ce5ef4a7984a733b44a1f
Author: Richard Jones <rjones@redhat.com>
Date:   Sat May 15 08:43:02 2010 +0100

    Generate BUGS file from Red Hat Bugzilla database.
    
    Add a script which generates the 'BUGS' file from Red Hat Bugzilla.
    This is run whenever we do 'make dist' and deliberately stored in git.

commit 5d5565ca24b95719461b0c0aebdb0651dd2671ca
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 14 19:42:48 2010 +0100

    virt-df: Display domains in sorted order.

commit ee03a22f4107dd8c04e72e6a843897ad23549547
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 14 17:41:39 2010 +0100

    Updated Spanish translations (RHBZ#592360).

commit 40d270b0113f1e30319909b2d51adb5a57079cd1
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 14 15:15:47 2010 +0100

    Ensure ordinary appliance is updated before trying to build supermin appliance.

commit 2357adc79aaf6e0b1a4b9945e186a80226330538
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 14 12:38:39 2010 +0100

    Version 1.3.12, update PO files.

commit 8700a55d52f25f60f01ef1b67cff6d5c0071700b
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 13 17:07:17 2010 +0100

    Unify supermin appliance building using febootstrap 2.7

commit 55748a94bc840ac07d3c211119372cd16b31f1a0
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 13 09:56:27 2010 +0100

    Improve errors from tar-in/tgz-in commands (RHBZ#591155 RHBZ#591250).
    
    This commit improves the error messages from the tar-in, tgz-in (etc)
    commands by capturing the stderr from the tar command in a file and
    sending that back in the error message.
    
    The method used for the error file is primitive, and there is a case
    for a more generic error file mechanism, but this will do for now.
    
    Sample error messages after this change:
    
    $ virt-tar -u /tmp/test1.img /tmp/not.tar /
    tar_in: tar subcommand failed on directory: /: tar: This does not look like a tar archive
    tar: Skipping to next header
    tar: Exiting with failure status due to previous errors at /home/rjones/d/libguestfs/tools/virt-tar line 247.
    
    $ virt-tar -u /tmp/test1.img /tmp/test.tar /
    tar_in: tar subcommand failed on directory: /: tar: access.log: Cannot open: Read-only file system
    tar: Exiting with failure status due to previous errors at /home/rjones/d/libguestfs/tools/virt-tar line 247.

commit b76fd51e142494058ca0082b547aa5e747ad4b79
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 13 10:17:48 2010 +0100

    Combine common code in daemon/tar.c.
    
    This commit shouldn't result in any change in the semantics
    of the code.

commit dc706a639eec16084c0618baf7bfde00c6565f63
Author: Richard Jones <rjones@redhat.com>
Date:   Wed May 12 19:55:06 2010 +0100

    Fix FileIn cmds losing synch if both ends send cancel messages (RHBZ#576879).
    
    During a FileIn command (eg. upload, tar-in) if both sides
    experience errors, then both sides could send cancel messages,
    the result being lost synchronization.
    
    The reason for the lost synch was because the daemon was ignoring
    this case and sending an error message back which the library side
    (which had cancelled) was not expecting.
    
    Fix this by checking in the daemon for the case where the library
    also cancels during daemon cancellation, and not sending an error
    messages.
    
    This also includes an enhanced regression test which checks for this
    case.
    
    This extends the original fix in
    commit 5922d7084d6b43f0a1a15b664c7082dfeaf584d0.
    
    More details can be found here:
    https://bugzilla.redhat.com/show_bug.cgi?id=576879#c5

commit 11a2ad8c9a1da7fe7f8142be69312d0cb5979e0a
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 13 17:05:41 2010 +0100

    guestfish: Fix build error in 'print_shell_quote' function.
    
    Amend commit 1c6ed48bd3cd471dc so the prototype of
    'print_shell_quote' function is correct.

commit 520d895383c6e2b3eff1c4e3761624ebbb5f8b09
Author: Richard Jones <rjones@redhat.com>
Date:   Wed May 12 19:01:29 2010 +0100

    fish: Fix guestfish -N option when called with unknown image type.
    
    Previously it was falling off the end of the loop if you
    called it with an unknown image type.

commit 94e310dcfbcd368cbe02dbc1643ed2ff9821cd48
Author: Richard Jones <rjones@redhat.com>
Date:   Wed May 12 18:11:37 2010 +0100

    Improved error if virt-inspector cannot find OSes in image (RHBZ#591142).

commit 287f8957fea3efe411c7ac55595d5d6c7b613e4e
Author: Richard Jones <rjones@redhat.com>
Date:   Wed May 12 16:55:59 2010 +0100

    Fix error message in string-e command (RHBZ#588651).

commit 1c6ed48bd3cd471dc6e4613ede9151631e19f55a
Author: Richard Jones <rjones@redhat.com>
Date:   Wed May 12 15:58:00 2010 +0100

    guestfish -i and virt-inspector work on filenames containing spaces (RHBZ#507810).
    
    This commit fixes a long-standing bug which prevented guestfish -i
    and virt-inspector from working on disk images which had a space
    in the filename (or other unsafe characters).  It works by ensuring
    that the strings passed between guestfish -i and virt-inspector are
    quoted correctly in both directions.
    
    Note that this commit adds a dependency from virt-inspector to
    the perl module String::ShellQuote.  We have previously used this
    module in virt-make-fs.

commit 72324580801f2c0e2b702b430b90eb141618c7f4
Author: Richard Jones <rjones@redhat.com>
Date:   Wed May 12 15:01:45 2010 +0100

    Add version numbers to Perl modules (RHBZ#521674).
    
    Sys::Guestfs now contains a version number which reflects the
    ABI that we are compiled against, ie. '0.<MAX_PROC_NR>'.  This has
    the beneficial side effect of causing an error if the user tries
    to mix versions of the Perl module and the XS code.
    
    Sys::Guestfs::Lib now contains a synthetic version number which
    will reflect future changes in that module.

commit b7046fecee400396a35d9cd33d1726d27373c5a2
Author: Richard Jones <rjones@redhat.com>
Date:   Wed May 12 14:26:26 2010 +0100

    Update PO files, including extra strings from Perl files.

commit feb0cd04822231f056c3086f322afbefc2e2467c
Author: Richard Jones <rjones@redhat.com>
Date:   Wed May 12 14:24:23 2010 +0100

    po: Include strings from Perl programs in the PO files (RHBZ#559963).
    
    xgettext will only recognize '*.pl' as being a Perl file (otherwise
    it treats it as a C file and does not correctly find any strings
    in it).
    
    This commit also fixes two actual bugs that xgettext found in the
    strings in our Perl programs.

commit 48133118071a26950840fe33326c09130955c35e
Author: Richard Jones <rjones@redhat.com>
Date:   Wed May 12 14:19:50 2010 +0100

    po: Don't generate po/Makevars file and include Perl keywords (RHBZ#559963).
    
    I don't see a reason to autogenerate po/Makevars, and in the
    earlier commit which changed this file to being autogenerated
    we accidentally lost the special Perl keywords, copyright notice
    and bug reporting address.  Fix all of that.
    
    This partially reverts commit febff9d2a35c4f40abbaf8943146476bdeac671e.

commit 5477d98548661394cf0df3ce48929961e0d2a38f
Author: Richard Jones <rjones@redhat.com>
Date:   Wed May 12 18:10:58 2010 +0100

    Reduce imported functions in virt-df to ones which are actually used.

commit 0c1e77219ea264a51b62e648003bfbea51db8ffb
Author: Richard Jones <rjones@redhat.com>
Date:   Wed May 12 17:32:39 2010 +0100

    New API: fill-pattern for creating files with predefined patterns.

commit 9d158c3ab132df21d58890f18224cd2fe020de67
Author: Richard Jones <rjones@redhat.com>
Date:   Wed May 12 16:12:07 2010 +0100

    Run udev_settle() after swapon/swapoff (RHBZ#516096).

commit 87eecb507ee09a62f3a12f5f75d3417a09c0c8d4
Author: Richard Jones <rjones@redhat.com>
Date:   Wed May 12 15:29:03 2010 +0100

    fish: With both '-x' and '-i', pass through '-x' to inferior process.

commit 3cead7285040673a50a119f3be7de4d7f3334f73
Author: Richard Jones <rjones@redhat.com>
Date:   Sat May 8 20:12:55 2010 +0100

    Version 1.3.11.

commit f35365ecbf348f1030581e59795435987b8adf0f
Author: Richard Jones <rjones@redhat.com>
Date:   Sat May 8 19:57:52 2010 +0100

    virt-rescue: Add extra options.
    
    This commit adds the extra options '--append', '--memsize' and '--selinux'.

commit d0afef23e54f75a521eed8c7261a533776242cfc
Author: Richard Jones <rjones@redhat.com>
Date:   Sat May 8 19:55:27 2010 +0100

    virt-rescue: Refresh documentation.

commit 214a803ac571376d9862b100155f4ac08b4ff86f
Author: Richard Jones <rjones@redhat.com>
Date:   Sat May 8 09:45:19 2010 +0100

    Revert "fish: Add 'please wait' message when launching (and interactive)."
    
    This reverts commit 01fedcde05c930c1413e9fe0909fa1da1f360cdf.

commit 01fedcde05c930c1413e9fe0909fa1da1f360cdf
Author: Richard Jones <rjones@redhat.com>
Date:   Sat May 8 09:37:25 2010 +0100

    fish: Add 'please wait' message when launching (and interactive).

commit 55e9707f8591488542da48fc89738234b4d85016
Author: Richard Jones <rjones@redhat.com>
Date:   Sat May 8 09:28:19 2010 +0100

    launch: Rearrange the code so config check is first.
    
    Move the config state check first in the guestfs_launch function,
    so that we don't reset g->launch_t or calculate the temporary
    directory in the case where the launch function will immediately
    return with an error.

commit 301abf33c6985b61604dfae5db75cf767aa5e651
Author: Richard Jones <rjones@redhat.com>
Date:   Sat May 8 09:26:57 2010 +0100

    generator: FishAction is no longer used, remove this feature.

commit bece54704bb081339a87233bbc5401f2892467be
Author: Richard Jones <rjones@redhat.com>
Date:   Sat May 8 09:25:32 2010 +0100

    fish: Make 'launch' function static.
    
    This commit makes the launch function static and private to
    'fish.c', and changes the generator so the function is no longer
    called for the 'run/launch' command.

commit a96d70113ffcd01f55262c3d0fbe711bee759fec
Author: Richard Jones <rjones@redhat.com>
Date:   Sat May 8 09:14:00 2010 +0100

    fish: In 'reopen' copy trace setting to new handle.

commit 2064e43bcfc7fc5bde08a0442c646a0a46997875
Author: Richard Jones <rjones@redhat.com>
Date:   Sat May 8 09:10:00 2010 +0100

    Ignore test1.img file in directory.

commit 846238a031f690078235b98db573060d2b88a5c1
Author: Richard Jones <rjones@redhat.com>
Date:   Sat May 8 09:09:24 2010 +0100

    fish -N option unconditionally overwrites test*.img files.
    
    This is more convenient and makes it consistent with the
    'alloc' and 'sparse' commands.

commit 8e007581c91a5193e6aec0f6f9aeb379a935c9d4
Author: Richard Jones <rjones@redhat.com>
Date:   Sat May 8 09:04:28 2010 +0100

    fish: Make '-x' option enable traces instead of using separate echo path.
    
    Previously we had separate code paths for echoing commands (-x)
    and tracing (guestfs_set_trace).  This just unifies that so that
    the guestfish -x option enables tracing.

commit 94775c53f163926ef99e6c6b8ab67b402935301d
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 7 23:15:40 2010 +0100

    inspector: Support filesystem-on-image VMs (RHBZ#590167).
    
    $ virt-df /tmp/dbroot.img
    Filesystem                           1K-blocks       Used  Available  Use%
    /tmp/dbroot.img:/dev/vda               3096336     593628    2345424   20%

commit f606a79ed7a20ee59bc0755b1030c6d29e503724
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 7 22:50:50 2010 +0100

    daemon: Use 'error' instead of 'perror' before calling 'abort'.

commit b52ef0b021fc443d88d4d9c43f57468712e40965
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 7 22:49:49 2010 +0100

    daemon: gnulib module 'error' is used directly by the daemon.

commit 63882fb2201c834db57c9b9287ff9349310f7dde
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 7 22:50:22 2010 +0100

    daemon: Use parens around code section for safety.

commit fc6dd9daa13ac774156d0822b5aa7830171feb85
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 7 22:37:55 2010 +0100

    If qemu dies during launch, set an error message (RHBZ#588851).

commit a3eb97d6377c1e0af258029ec08b17584e617cbb
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 7 16:34:08 2010 +0100

    Version 1.3.10.

commit 42f59b28f123f53ae038df23a9abee08e959e46b
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 7 13:30:42 2010 +0100

    daemon: Fix read-file so it fails gracefully for large files (RHBZ#589039).
    
    Pengzhen Cao noticed that read-file would fail for files
    larger than the protocol size; this is *not* the bug.  However
    it would also lose protocol synchronization after this.
    
    The reason was that functions which return RBufferOut in the
    generator must not 'touch' the *size_r parameter along error
    return paths.
    
    I fixed read-file and initrd-cat, and I checked that pread was
    doing the right thing.
    
    This also adds regression tests for read-file with various categories
    of large file.

commit a84f1360499309e2d2ecb661adc6917539b5eef4
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 7 00:13:31 2010 +0100

    daemon: Fix wc* commands to work on absolute symbolic links (RHBZ#579608).

commit 26991ebb8181b57f4c8454f2862c938d7c5d012d
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 7 00:13:05 2010 +0100

    daemon: Fix strings to work on absolute symbolic links (RHBZ#579608).

commit deee8e2b4e377dc2eb23fc551a4d0711ac49b585
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 7 00:12:36 2010 +0100

    daemon: Fix head and tail commands to work on absolute symbolic links (RHBZ#579608).

commit 7d8e5886a6a8ab16c6a69d0e02e7f93cdb7430df
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 7 00:11:55 2010 +0100

    daemon: Fix grep and related to work on absolute symbolic links (RHBZ#579608).

commit 00fae9fe88ca83dfc3ee0b1b7d8e27e644f6e9c7
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 7 00:11:22 2010 +0100

    daemon: Fix checksum to work on absolute symbolic links (RHBZ#579608).

commit 7a4ec57e54ab98de05438bff838a7531391d3965
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 6 21:55:32 2010 +0100

    daemon: Fix hexdump to work on absolute symbolic links (RHBZ#579608).

commit 07369cb77a07f965cbf8e02f485c78a22c091f85
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 6 21:36:24 2010 +0100

    daemon: Fix for commands working on absolute symbolic links (RHBZ#579608).
    
    The original idea (suggested by Al Viro) was to fork and chroot
    into the sysroot and read the file from there.  Because of the
    separate process being chrooted, absolute links would be resolved
    correctly.  The slightly modified idea is to open the file in the
    daemon process (but temporarily chrooted, so symlinks resolve
    correctly), fork, and have the subprocess just be responsible for
    copying the file.  (Strictly speaking we don't need to fork, but
    this implementation is simpler).
    
    This commit just includes the changes needed to the command*()
    functions in daemon/guestfsd.c and adds an absolute symlink to
    the test ISO for testing it.  Later commits will fix the broken
    daemon commands themselves.

commit 34067b5c362d5070e91364cc1ed6487497462b42
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 6 20:32:09 2010 +0100

    daemon: Change command to abort() on resource problems.
    
    The comment in the code describes it thus:
    
      /* Note: abort is used in a few places along the error paths early
       * in this function.  This is because (a) cleaning up correctly is
       * very complex at these places and (b) abort is used when a
       * resource problem is indicated which would be due to much more
       * serious issues - eg. memory or file descriptor leaks.  We
       * wouldn't expect fork(2) or pipe(2) to fail in normal
       * circumstances.
       */

commit 4839d5142ca50818965866287932f9ded14729e6
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri May 7 14:58:32 2010 +0100

    Warn instead of dying if grub refers to non-existent kernel

commit 01c1d82823be7008d7930e7876c31939227a4f41
Author: Richard Jones <rjones@redhat.com>
Date:   Wed May 5 16:10:37 2010 +0100

    Update to latest gnulib.

commit fbf29976b33a69c64dc7847c54454bf2cfa5fde6
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 4 16:06:58 2010 +0100

    Use link-local addresses between appliance and host (RHBZ#588763).

commit 8a9f2ca65521d093ac14307aca4370d9497ac840
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 4 15:06:09 2010 +0100

    Change network configuration to use macros.
    
    Change the network configuration so everything is set using
    some macros at the top of src/guestfs.c.
    
    Also, rename the macros used in the daemon so they are not the
    same.  It was a very long time since these sets of macros had to
    match the ones defined in src/guestfs.c, despite what the comment
    said.
    
    Note that this commit should not change the semantics of the
    program at all.

commit 7d005a9ae820cff3274b456d99b0031d7277a61a
Author: Daniel Cabrera <logan@fedoraproject.org>
Date:   Tue May 4 13:35:01 2010 +0100

    Update Spanish translations (RHBZ#588733).

commit 097266e01cfa28319834bf750649650f3c22006f
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 30 23:12:34 2010 +0100

    tests: In verbose mode, print dashes between each test.
    
    Only affects tests when run with LIBGUESTFS_DEBUG=1.  Lets you easily
    see when each test starts and ends.

commit a0a394a4619c5d45932fee3de8d86cabf0ecb2e7
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 30 18:27:37 2010 +0100

    Version 1.3.9.

commit fd2d10d6ed91f417a9b99bb61526b45bb7ed3e4e
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 30 13:56:11 2010 +0100

    Document that guestfs_mount implies -o sync and performance problem (RHBZ#587582).

commit 90b4e24df6f27c02d3b11d8021b27a197cf18b75
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 30 12:27:00 2010 +0100

    contrib: Add dependency diagram of libguestfs ecosystem.

commit 2f9f3375028a02fdaec62f30e11bacd6524a342c
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 30 11:34:21 2010 +0100

    contrib: Add header to README file.

commit c24de46d06cc3ecccf00bfaaffb06172659cdd0a
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 30 10:51:49 2010 +0100

    lvresize: Use --force so it can make LVs smaller (RHBZ#587484).
    
    This also adds a regression test for this bug.

commit 25c15261253bbd2fb140e5ca1c902acf714f76a9
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 30 09:46:40 2010 +0100

    tools: Fix documentation for CurrentControlSet (thanks Yuval Kashtan).

commit 55641f5d1e9964f8a039005b511b8e688c92cddb
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 29 13:55:52 2010 +0100

    guestfs(3): Documentation on protocol gotchas.

commit d3be0facdd688f06eb4bc3743b53226f2d060482
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 27 15:48:38 2010 +0100

    Version 1.3.8.

commit 467268bc32598db96878307ed0752ea940c1c281
Author: Daniel Cabrera <logan@fedoraproject.org>
Date:   Mon Apr 26 15:57:45 2010 +0100

    Update Spanish translation (RHBZ#585961).

commit 78d2523ec8997679f7fca810de60620df4001e16
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 24 09:10:28 2010 +0100

    fish: Add 'man' command which opens the manual.

commit ce95be8b185ce697816c3446406d7129e01cc0e1
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 24 08:50:40 2010 +0100

    docs: Routine refresh of the documentation for guestfs(3) and guestfish(1).

commit b054e33db629e83c20c3d4e8ff941b7beb5abf34
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 23 14:43:13 2010 +0100

    Version 1.3.7 - note: fixes a segfault in guestfish 1.3.6.

commit 7c285ea84f63e511f95a3c8bfbb98cbf99b9466b
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 23 14:29:56 2010 +0100

    todo docs: Discuss shrinking filesystems and specifying sizes in guestfish.

commit 41ee105aabaf1e9a7efc437b87d9536d3dc14a75
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 23 14:14:26 2010 +0100

    New API: checksums-out for checksumming many files.
    
    Useful API for verifying the integrity of virtual machines.

commit 89a707aac5aa75d70cbb3049e8d328cfe6a40dea
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 23 13:43:05 2010 +0100

    generator: Update docs for checksum to point to checksum-device.

commit af29c84cef791381ac3aebae30d8831b7de77e36
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 23 13:42:10 2010 +0100

    daemon: Split out checksum type to program name mapping into function.
    
    This shouldn't change the semantics of the program.

commit d054dfb2f948f53188f448d2c7fade83db9bbab8
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 23 14:13:42 2010 +0100

    fish: Fix segfault in '-a' option.
    
    This fixes a segfault in the guestfish -a option which you would
    get when using guestfish 1.3.6.

commit 6e269c6e5123c1558589e0a59844dc0187fbd63a
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 23 10:25:35 2010 +0100

    todo docs: Integrate with host intrusion detection systems.

commit 2ed549e95c7ad75f28b5f0dd4c53849e1607444e
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 23 10:23:45 2010 +0100

    todo docs: Mapping filesystems to and from disk blocks.

commit dfe539d7649344a9cee1c821689823e7052446be
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 22 22:29:25 2010 +0100

    Version 1.3.6.

commit 4a9b979a3199dfef64a342f05d666da540203a7c
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 22 10:42:58 2010 +0100

    fish: Add -N option for making prepared disk images.
    
    Previously you might have typed:
    
    $ guestfish
    ><fs> alloc test1.img 100M
    ><fs> run
    ><fs> part-disk /dev/sda mbr
    ><fs> mkfs ext4 /dev/sda1
    
    now you can do the same with:
    
    $ guestfish -N fs:ext4
    
    Some tests have also been updated to use this new
    functionality.

commit 89486c50eaeb8b1cc5a6ff388cb47e859f8565d1
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 22 10:46:34 2010 +0100

    fish docs: Be consistent about using I<-..> for options.

commit e3e67f63b0a6ce952ba92cb966b8ac5ef239dcf9
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 22 10:44:35 2010 +0100

    fish docs: Use L</...> for internal links in the man page.

commit 75d9c056b2db9ceedef9eca64e67ad3350eabad8
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Apr 22 13:57:56 2010 +0100

    Whitelist the loop kernel module
    
    loop is sometimes a module, for example on RHEL 5.

commit 39416cdb11bb2005915ed293eafb3cc6d714416d
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Apr 21 15:39:49 2010 +0100

    Don't die during inspection if rpm -qa or dpkg-query fails
    
    If a problem in the package database prevented package enumeration from working,
    inspection would die. This change makes it emit a warning and continue.

commit 2b43970c8c97f24b1f45c040c6963d30661fa514
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Apr 21 15:39:48 2010 +0100

    Don't die during inspection if initrd doesn't exist
    
    This fixes a problem where inspection would die if grub.conf referenced a
    non-existent initrd. Just return an empty initrd instead.

commit 216557b1ebc013701e7474720bc1280f43e51bb1
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 20 22:20:46 2010 +0100

    Add zfs-fuse (ZFS via FUSE) support to the appliance.

commit c8f302a17453ad58acccd137342438795763606a
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 20 18:46:45 2010 +0100

    Remove checks for Test::Pod and Test::Pod::Coverage.
    
    Although these modules are optionally used by the Perl tests,
    they aren't necessary and won't break the build if they are not
    there.  These modules aren't available in RHEL 5.  Therefore
    remove these checks.

commit d7768dc5262a1eceeca04e3c602712ed99f5fbc9
Author: Daniel Cabrera <logan@fedoraproject.org>
Date:   Tue Apr 20 16:30:27 2010 +0100

    Updated Spanish translations (RHBZ#584038).

commit 199f218bf431b77c12a728f7072bed1553a0f0af
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 20 13:22:09 2010 +0100

    Check user doesn't run configure, make or make check as root.
    
    (Thanks to Yufang Zhang for helping to debug this issue).

commit 175c01d2336c07113f1c2966966957de5c344e3a
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 20 11:04:14 2010 +0100

    Replace 'dd' in tests with use of guestfish 'sparse' command.
    
    'dd' is a very inefficient way to create files.  'truncate' is
    better, but unfortunately that command is not available in RHEL 5.
    So use the guestfish 'sparse' command instead (which also avoids
    allocating disk space).

commit 54a8f8f30de2f3132da97c54d07ca4639c405de1
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 20 10:50:50 2010 +0100

    Document new version numbering policy.
    
    See discussion on mailing list:
    
    https://www.redhat.com/archives/libguestfs/2010-April/msg00005.html
    https://www.redhat.com/archives/libguestfs/2010-April/msg00057.html
    https://www.redhat.com/archives/libguestfs/2010-April/msg00058.html

commit c2a8efc548d6f997049cbb3d63bab360b0d946b6
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 19 20:55:15 2010 +0100

    Document umask (RHBZ#582548, RHBZ#583554).

commit 42e43db927dac13da0afe6dba39708295eb06021
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 19 20:13:05 2010 +0100

    docs: Clarify documentation for mknod (RHBZ#582948).

commit 27a67f8615b5788f5ff21b68b9afc01c35c5b832
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 19 17:25:58 2010 +0100

    Update PO files.

commit aba59fd3555ac8b38ae554a729970afd80e05404
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 19 17:13:46 2010 +0100

    Prepare for version 1.3.5.

commit c3a68961859a617f7c574c528d0f8ac1fdbb53e1
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 19 17:09:58 2010 +0100

    New APIs: base64-in and base64-out for uploading/downloading base64 content.

commit 87e49e7e87e570537f04e34178c9c6d2b876c16c
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 19 16:31:24 2010 +0100

    New API: debug-upload (not a formal part of the API/ABI).
    
    Allow arbitrary files to be uploaded into the appliance, but
    only when --enable-debug-command is enabled.  This lets you
    run shell scripts, like this:
    
      ><fs> debug-upload -<<EOF /tmp/script.sh 0700
      #!/bin/sh -
      # ...
      EOF
      ><fs> debug sh "/tmp/script.sh"

commit 3119aa687d4d594b50ee9df5ff6e8d709eb7ca85
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 19 14:41:01 2010 +0100

    fish: Allow -<<END as a syntax for uploading "heredocs".
    
    For example:
    
        ><fs> upload -<<END /foo
        some data
        some more data
        END
        ><fs> cat /foo
        some data
        some more data

commit 819f30e332160ba05f7bf6dd068622cc07bf9ffc
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 19 11:49:08 2010 +0100

    todo docs: Feature for base64 uploads and scripts.

commit 92d38b9ae3a0b1b4694da5e3d3a3cb155842cd91
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 19 10:20:58 2010 +0100

    docs: Add virt-resize(1) link to guestfish(1) manpage.

commit 1525e2ba0843aa6b1c7bb5ab6d83954cc284f710
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 17 22:19:20 2010 +0100

    Version 1.3.4

commit e55400960a6a06eb6dc16ea96f3c30ed580d3d3a
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 17 20:41:28 2010 +0100

    todo documentation: Idea: List, mount filesystems by UUID and label.

commit abb7365d4df7b945846a9f6189bbbd70e10122d1
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 17 20:36:11 2010 +0100

    todo documentation: remove 'virt-grow/shrink', see virt-resize

commit 398e6830a34e916c52cd23ba6d0b4c00602dfc61
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 17 20:35:34 2010 +0100

    todo documentation: virt-rescue now uses $TERM from library, remove from todo list

commit 3b759fe7fe568a3d643ee99e0aef0adaf163d1e5
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 17 20:34:35 2010 +0100

    todo documentation: Remove old section on PPC bugs.
    
    No one cares for PPC, and if they do they should file these
    as bugs in the bug tracker.

commit fc50bf2680d4ed653ff00d390cd7a17ebeb22cf2
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 17 20:34:21 2010 +0100

    todo documentation: Remove old ideas for Python bindings.

commit 2e0f3ed54b978925c79ca0d33e76bec338b23631
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 17 16:33:07 2010 +0100

    Documentation: Use 'g' instead of 'handle' in documentation.
    
    By convention we use 'g' for handles.  Copy this convention
    through to all the documentation.

commit 6e4bf8e278f5c8bd28eba7152d2f11d1e537ee1b
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 17 16:24:03 2010 +0100

    In guestfs(3), unmount "/" directory in the example.

commit 4680c732585b2c2d292f521f393215c7943096fa
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 17 16:22:53 2010 +0100

    Add compilation/linking example to guestfs(3) man page.

commit 3297466d33e9f9b73ee806ff2ba90ede1a4a02ab
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 17 15:59:41 2010 +0100

    generator: Use shortname in check_state() call.
    
    Saves a tiny bit of space in the library.

commit 09a0427448b1f4328b9246d4d8a26610bb5228c8
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 17 15:46:08 2010 +0100

    Build top-level directories in a more logical order.

commit 2a9abc7791a12af07ec2dada4b3a9a16eb452dca
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 17 15:41:16 2010 +0100

    Rerun generator if images/test.iso does not exist or has been updated.
    
    The MD5 hash of this file is embedded in the output of the
    generator.

commit 5922d7084d6b43f0a1a15b664c7082dfeaf584d0
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 17 14:25:55 2010 +0100

    Fix upload losing synchronization if root not mounted (RHBZ#576879).
    
    Modify the generator so that it can correctly handle early
    cancellation for Pathname|Device|.. parameters.  This fixes
    the upload command, but consequently we need to fix the
    parameters for tar_in and t?z_in commands.  This should also
    mean that 'win:' can now be used as the second argument of
    tar_in and t?z_in commands in guestfish, whereas previously
    this wouldn't have worked.
    
    Adds a regression test for the original problem.

commit 68467cb1c2f8b1cc7844ed6512b7f76ef2aba1d1
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 17 14:14:30 2010 +0100

    generator: Fix typo in a comment.

commit 61ab83d19009a8006dd73ebe16d22494b78be4d1
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 17 13:33:14 2010 +0100

    Improved checking, documentation of modes (RHBZ#582901, RHBZ#582929).
    
    chmod: Disallow negative mode, document mode affected by umask.
    
    mkdir-mode: Disallow negative mode, document that filesystems
    may interpret the mode in different ways.
    
    mknod: Disallow negative mode, document mode affected by umask.
    
    umask: Check the range of umask mask value carefully.

commit 42fc0e02b094ef3b19dae115276a0a33116af6d5
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 17 13:11:20 2010 +0100

    fish: Autocomplete 'sparse' command (RHBZ#582899).
    
    I also rechecked the list of built-in commands against
    the actual commands to make sure no others were omitted.

commit 4e5327187d6474e81241dd2b6f5418be2387a0cb
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 17 13:07:56 2010 +0100

    New API: get-umask, returns the current umask (RHBZ#582891).

commit 116d497c68c2e57f6e92abf8834112a794a145f0
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 17 12:38:18 2010 +0100

    Add a build test for the 'umask' command.

commit 4f376dbafb78ee9b5ad1652360472a14de64753d
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 17 12:33:31 2010 +0100

    fish: Print output from some commands in octal/hex as approp. (RHBZ#583242).

commit e64c1e5aacd605ea177972e56ede5be22ae13d4f
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 17 12:13:23 2010 +0100

    Documentation: lvcreate should say 'logical volume' (RHBZ#582953)

commit b35d2a0fd7a705d2ff60882e5107a7d29f7f8d6e
Author: Daniel Cabrera <logan@fedoraproject.org>
Date:   Wed Apr 14 14:59:30 2010 +0100

    Update Spanish translations (RHBZ#582252).

commit c0d73e0e60b99b87855364ff346551f5ff7efccb
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Apr 14 11:13:04 2010 +0100

    Fix build error in fuse/guestmount.c.
    
    guestmount.c: In function 'main':
    guestmount.c:899: error: implicit declaration of function 'setlocale'
    [-Wimplicit-function-declaration]
    
    guestmount.c wasn't including locale.h.

commit 66477d07e37ffe66cd6fea1105dd92b616d3cd27
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 13 18:42:27 2010 +0100

    New API: Add aug-clear call for clearing an Augeas node.

commit ad752b80d7fa064b7bdd3d4c8d47c95d79265b58
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 13 22:06:43 2010 +0100

    fish: Allow '-' prefix on command line to override exit on error (RHBZ#578407).
    
    Allow -cmd on the command line to mean that normal exit on error
    behaviour is overridden, ie. we will not exit.
    
    This allows you to do:
    
      guestfish -- command : -command : command
    
    with the second command allowing errors.  (Note that '--' is required
    to stop getopt parsing -command as an option).
    
    Also this fixes the remote case which is what the original
    bug report was about.

commit c076aaea7e6d9459c8d8a96d21abd71a0223f098
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 13 21:26:14 2010 +0100

    fish: Update documentation: Add another pipe example.

commit c7c4a476a5957794dc2e9af0ec14b447ecef5740
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 13 21:25:50 2010 +0100

    fish: Update documentation: Using 'lcd' command to change local directory.

commit 3d9b2a707d5739a2b80157a69b57e0cda40cd7bf
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 12 19:52:03 2010 +0100

    Update PO files.

commit bbf56d28b28cbde3bfb09ca8499a7b619d9b66c3
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 12 19:32:38 2010 +0100

    Prepare for version 1.3.3.

commit cdc89bb10ff584d3aaf07b70c264d659e5f416e3
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 12 16:34:36 2010 +0100

    resize: Add --LV-expand option for expanding Linux LVs.

commit 2bec01ba1fcceb4880aa991e599920be9b68996a
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 12 16:33:46 2010 +0100

    New API: lvresize-free to extend LVs into percentage of free space.

commit 508f1ee87e816bf6b6fc8e629ccbb2d61a971169
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 12 16:34:57 2010 +0100

    Fix time and timezone to be correct within the appliance.

commit 960b99f875162ade09b7db886d1362de7d548792
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 12 18:54:58 2010 +0100

    resize: Fix missing newline from end of print.

commit ba099ee689b42dd71b05d12583d69424fcfbc217
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 12 16:32:55 2010 +0100

    resize: Fix regular expression to exactly match ^ext[234]$

commit c53e64a156526adcb9937f63756f17f585f202d3
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 12 12:17:08 2010 +0100

    virt-resize: Mention alternate tools like gparted in the documentation.

commit de5607909b59d9068f64d87c4d9351286a873b42
Author: Daniel Cabrera <logan@fedoraproject.org>
Date:   Mon Apr 12 16:31:43 2010 +0100

    Updated Spanish translation (RHBZ#581501).

commit 9a608a1516bd339dc6d5ebe9952d3bced273c416
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Apr 11 17:02:18 2010 +0100

    Documentation updates.
    
    Fix copyright years.
    Fix URLs to point to new PRC site.
    Make sure guestfish(1) and guestfs(3) manpages reference the
    current list of tools.

commit 4e5678c1040503e7f05048ccb002fbf257bcb762
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 10 21:54:04 2010 +0100

    Version 1.3.2

commit 540da0bc1999deda670e846b8db7291826a1a728
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 10 21:23:27 2010 +0100

    New API: checksum-device for checksumming devices.
    
    Analogous to the usual 'checksum' call.

commit 5466638279b51d46e6b24d4f7148d520cb4f3c34
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 10 13:38:26 2010 +0100

    virt-resize: Enhance virt-resize so it can expand partition content.
    
    Enhance virt-resize so it can expand "first level" partition
    content, including ext/2/3/4/ntfs filesystems and PVs.
    
    Also extensively update the documentation.
    
    This has been tested on a variety of Linux and Windows guests.

commit e6bdd66fa6bdfa4e762f3c67ec1bac83a1d6643b
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 10 13:21:33 2010 +0100

    virt-list-partitions: Add -t / --total option.
    
    This option lists out block devices separately:
    
     $ virt-list-partitions -lht /tmp/WindowsResized.img
     /dev/sda1 ntfs 100.0M
     /dev/sda2 ntfs 11.9G
     /dev/sda device 12.0G

commit add5e22563972210f5c8baf9e8cf651fc1a7bbd8
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 10 13:35:31 2010 +0100

    Bugfixes for virt-resize.
    
     - copy more than 64 boot loader sectors across, since real boot
       loaders (eg. for Windows) can be much larger than this
     - copy bootable flag and ID byte to new partitions
     - start the first partition on the new disk at the same sector
       offset as on the old disk
     - sync the disks before existing

commit b68c030adfdbefe65bc9ecdd673844c01bddb32a
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 10 13:19:43 2010 +0100

    New partition APIs: part_del, part_get_bootable, part_get/set_mbr_id
    
    These APIs flesh out further the partitioning API.

commit cb9350019cc6382a35c98f522c9c4d221c92b605
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 10 13:17:50 2010 +0100

    daemon: More reliable parsing of the output from 'parted print'.
    
    Previously we used strtok.  However this has the problem that
    strtok considers multiple delimiter characters to be like a single
    delimiter, eg. "1:::2" would be parsed the same as "1:2".  In
    other words, the previous code would skip over or fail if there
    are empty fields.

commit 440ad646cdf31bdb5ad2bc92fc51fa6df3fb9c63
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 10 13:16:19 2010 +0100

    daemon: Make the RUN_PARTED macro take an error statement.
    
    This allows us to make the RUN_PARTED macro do something else
    along the error path, other than just returning -1.

commit 30752ac7ca042f533b8d0c4c6144400a8532b154
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 10 13:14:54 2010 +0100

    Documentation: Clarify documentation on the bootable flag.

commit 9752039e52d190c7d62281346fd2170a98434c86
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 10 13:14:12 2010 +0100

    New API: vgscan
    
    Implement vgscan to allow for a full rescan of all LVM
    PVs, VGs and LVs.

commit f8210da95888f0060b25dcca2ae299d5c16ff814
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 10 13:13:07 2010 +0100

    New API: ntfsresize.
    
    This implements the ntfsresize operation, using the external
    program from ntfsprogs.

commit e323d93ed2ab3b55885273ab6bd911e2996346d9
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 10 13:20:52 2010 +0100

    virt-make-fs: Use Sys::Guestfs::Lib::feature_available helper function.

commit d1dd00606d0b5b1430598e5092b017aa15d9ee11
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 9 09:40:59 2010 +0100

    Allow aug-ls to take Augeas variable as argument (RHBZ#580016).

commit 3765f97898a1194d96ab4124e1eb46e25701b3b2
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 8 19:33:57 2010 +0100

    Remove warning "No grub default" (RHBZ#580650).

commit e35debd642bea240609775610b68145dab0a634b
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 8 19:07:45 2010 +0100

    If qemu dies during launch in "null vmchannel" mode, don't hang (RHBZ#579155).
    
    Detect if qemu dies during launch by wait(2)-ing for it, and
    then getting EOF on the qemu pipe.  This was broken in null
    vmchannel mode, causing a hang.

commit dc5df3bfec706803e75a5f2454293db30e753249
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 8 19:06:00 2010 +0100

    Don't kill self accidentally.
    
    Always check that pid > 0 before calling kill (pid, 9).  The
    issue was that sometimes pid == 0, and this ends up killing
    ourselves.

commit fb4ec82d97f71963ea7f830cb0bc38abefcbac99
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 8 18:53:40 2010 +0100

    Fix for "warning: unexpected connection from UID ..."
    
    This warning is currently a fatal error.  The code attempts
    to retry the accept call, but because we don't reset sock = -1
    the retry doesn't happen and it dies anyway.
    
    Set sock = -1 so the retry attempt can happen.

commit 50195d6ec4e893f894ef1bbf7af6eeda56f96600
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 8 16:07:32 2010 +0100

    New API calls to upload/download txz files (RHBZ#580556).

commit 0ce9b2bb9bcac61f7fb5dd2811d9b3b621f8309b
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 8 15:49:14 2010 +0100

    configure: Default to using Fedora 12 repo (was Fedora 11).
    
    Fedora 11 is almost EOL at this point.

commit d0efcd6b63edb3e32a7ff0c7e032d06a2d16f348
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 8 15:17:07 2010 +0100

    Version 1.3.1.

commit d868221d9f746ab17b83e7220cef9227fcad3696
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 7 20:30:46 2010 +0100

    New tool: virt-make-fs for creating filesystems on devices.

commit de7ef2a0fdcbcddfd35ecb8ee2804e1ca0968454
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 7 21:04:01 2010 +0100

    Code cleanups related to RHBZ#580246.
    
    This includes various code cleanups:
    
     (a) A regression test for RHBZ#580246.
    
     (b) Use write instead of fwrite to write out the tar file.  This is
         just because the error handling of write seems to be better
         specified and easier to use.
    
     (c) Use size_t instead of int for length.
    
     (d) Clearer debug messages when in verbose mode.

commit 07f4b20ae959069fca41756b0dc103ec5fa99754
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 8 08:48:38 2010 +0100

    Fix tar-in command hangs when running out of disk space (RHBZ#580246).
    
    The problem was this sequence of events:
    
     (1) File transfer goes through OK.
    
     (2) pclose returns failure (because 'tar' subprocess failed)
    
     (3) We try to cancel the transfer by calling cancel_receive.
    
    Step (3) fails because the transfer (as far as the library is
    concerned) has succeeded, so causing a hang.
    
    The more fundamental reason why we see steps (1) and (2) is that
    'tar' does NOT fail immediately if there is a write error.  Instead
    it continues reading and discarding the input until the end of the
    input before giving "Error exit delayed from previous errors".
    IMHO this is a bug with tar, since an ENOSPC write error should
    be fatal for tar.

commit 4c50f4c38d9a50fbf983c79dd208d1b1598fef8a
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 6 23:54:08 2010 +0100

    fish: Print extended help when the user types an unknown command first.
    
    $ guestfish /tmp/disk.img
    /tmp/disk.img: unknown command
    Did you mean to open a disk image?  guestfish -a disk.img
    For a list of commands:             guestfish -h
    For complete documentation:         man guestfish

commit 2ade61d1f864c75ce65c358e4ac8a012a897b89a
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 6 11:03:03 2010 +0100

    Check error returns from posix_fallocate (RHBZ#579664).
    
    posix_fallocate has a non-standard way to return error indications.
    Thus all our calls to posix_fallocate were effectively unchecked.  For
    example:
    
      $ guestfish alloc test.img 1P
      $ echo $?
      0
      $ ll test.img
      -rw-rw-r--. 1 rjones rjones 0 2010-04-06 11:02 test.img
      $ rm test.img
    
    With this change, errors are detected and reported properly:
    
      $ ./fish/guestfish alloc test.img 1P
      fallocate: File too large
    
    This is a fix for:
    https://bugzilla.redhat.com/show_bug.cgi?id=579664

commit f42f2df8bc45b70064f52b0b279317931c8568fc
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Mar 31 13:19:34 2010 +0100

    Signed/unsigned warning on 64 bit.

commit ce3a9c56b712731dd6ac3694f7e8ac117e2a61dc
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Mar 31 13:19:34 2010 +0100

    New API: guestfs_zero_device to zero whole devices.

commit fb0375a0984efca96db1277398f9fe50ecdd578d
Author: Richard W.M. Jones <rich@annexia.org>
Date:   Tue Mar 30 21:07:27 2010 +0100

    Prettier POD CSS.

commit b08725d3be546ebb6c24b9adc0dcc7b33fc0f580
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Mar 30 17:49:44 2010 +0100

    Update PO files.

commit 2e47daea514fe577bf8b1661ceb070103e20ded1
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Mar 30 17:49:24 2010 +0100

    chmod +x virt-resize binary.

commit 855c321b59ef348f692ec83d16ce1dd99bda65a2
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Mar 30 17:49:06 2010 +0100

    Fix EXTRA_DIST rule.

commit e17c5a24b8dbbef76e183856c4c770b4754c4539
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Mar 30 17:05:56 2010 +0100

    Prepare for 1.0.89.

commit 4b48f93ce6407923ea23451cfe39ac63811d1f42
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Mar 26 17:14:04 2010 +0000

    Improved version of virt-win-reg, supporting exporting and merging.

commit 29c78cc979297b95407a5956b4caa34240a2f5a8
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Mar 30 16:14:09 2010 +0100

    virt-df: Match output with native (coreutils) 'df' command (RHBZ#578123).
    
    This commit fixes the 'Use%' field in the output so it matches what
    coreutils' 'df' command would print.
    
    Firstly we change the calculation to use the space available to root,
    not the space available to non-root.  This means it matches what 'df'
    when run as root in the guest would show.
    
    Secondly we display this rounded up to the next whole percent (ie. using
    ceil), which is also what 'df' does.
    
    Thirdly we change the regression test so it tests this.
    
    Note that even with these changes you are not guaranteed to get precisely
    the same figures from inside and outside the guest, as it depends on
    how quiescent the guest is and how recently the superblock was synced.
    
    Thanks: Rita Wu

commit fc5fbd460aa0aaf6bb65ca5fa1be59345f4f079f
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Mar 30 14:18:44 2010 +0100

    tools: Add basic tests for the virt-* tools.

commit bbe4888cd4aac8f67c6d34e67d8f622c0c4bfcb4
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Mar 30 13:45:16 2010 +0100

    tools: Sectional header for manpages in Makefile.am

commit f25da97554885d5032f124e12c1995d6eab720dd
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Mar 30 13:44:29 2010 +0100

    tools: Rearrange list of tools in Makefile.am.

commit 641e8275b3b63b68c82ef80735bb55f9da05ef2c
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Mar 30 13:34:16 2010 +0100

    daemon: Set TERM=dumb inside the daemon.
    
    Since commit 977edb3185fe8f we have been passing TERM from the
    library into the appliance (for the benefit of virt-rescue).
    However this changes the output of parted, which I would argue
    is a bug in parted:
    
     TERM=xterm /sbin/parted -m -- /dev/sda unit b print 2>&1 | hexdump -C
     00000000  1b 5b 3f 31 30 33 34 68  42 59 54 3b 0a 2f 64 65  |.[?1034hBYT;./de|
    
    Notice the escape-sequence junk before the official "BYT;"
    header.
    
    By setting TERM=dumb we avoid this.

commit f826ce4876135a8abb72383aa5a5681f045f5367
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Mar 27 11:02:03 2010 +0000

    Fix the error message when reply body is too large (RHBZ#509597).

commit ef3a6692412b234a46326d330943556977f7c988
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Mar 27 10:49:24 2010 +0000

    tests: Move alarm(2) calls to the correct place in the tests.
    
    This is a re-fix for RHBZ#505329.

commit 650159fce9b5d6424c233e42aa36c94e13dc2a1b
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Mar 26 21:08:43 2010 +0000

    Prepare for 1.0.88.

commit 977edb3185fe8f0cc01840227ac6d3ea1785d3c9
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Mar 26 20:08:45 2010 +0000

    rescue: Pass $TERM from library into the virt-rescue appliance.
    
    We set it on the kernel command line, then get it out from
    there when the rescue appliance boots.

commit cd551619947d5f1683bca3581da1e35abcad47c2
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Mar 26 20:02:10 2010 +0000

    rescue: Sync disk on exit, and improve messaging.

commit b6a0c8565cdf27e6d4fdf7adb1a66b30d45d5b92
Author: Jim Meyering <jim@meyering.net>
Date:   Fri Mar 26 20:01:45 2010 +0000

    Const-correctness fix.

commit 9e0b31a2af26b8d58a44dd80993a5e73d4942307
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Mar 26 10:10:16 2010 +0000

    appliance: Set $PATH instead of hard-coding paths to binaries everywhere.
    
    Change the appliance so PATH includes common directories.  Thus
    we don't need to hard-code paths to binaries (eg. "/sbin/fdisk")
    everywhere.

commit 57c143da4d9b9e75e6da83ef3b8e8c0979c6f0f6
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Mar 25 19:44:22 2010 +0000

    perl: use newSVpvn for variable length strings.
    
    Previously we used newSVpv (str, len), but if len == 0 then
    this means Perl tries to calculate the string length using
    strlen(3).  This is not desirable when we know the length, in
    which case we should use newSVpvn instead.

commit 3e9d96d246f75bd7d2aa592b84bd6446687cad85
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Mar 25 16:03:42 2010 +0000

    Update PO files.

commit 5a5be3c25cbec7f9e4805446f0a8a6529aee0a8f
Author: Daniel Cabrera <logan@fedoraproject.org>
Date:   Thu Mar 25 16:03:01 2010 +0000

    Update Spanish translation of libguestfs (RHBZ#576876).

commit 00a9ae7365e6bad258bcf079a18dcae94d0853ad
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Mar 24 23:28:14 2010 +0000

    Fix lvresize test on RHEL 5, by fixing guestfs_e2fsck_l.
    
    The problem is that mkfs was making an ext2 filesystem,
    which later we were checking with e4fsck.  e4fsck corrects
    an "error" on the filesystem:
      /dev/VG/LV: Adding dirhash hint to filesystem.
    e4fsck returns 1 (errors corrected) which we were interpreting
    as an error return.

commit c4e8aa245a243b020d6b7bd832674be871a43610
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Mar 24 22:02:34 2010 +0000

    Use ext4 dev tools on RHEL 5 (RHBZ#576688).

commit f57f1012a637a9950af43bf1b4925fa6b233789a
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Mar 24 21:21:23 2010 +0000

    Add support for minix filesystem (RHBZ#576689).

commit 0c43d6378131775fd08626743975c7f2551e1c1e
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Mar 23 22:10:45 2010 +0000

    Version 1.0.87.

commit def627e4daf2d32cebf91f5e01f44a0b7e512129
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Mar 22 18:38:31 2010 +0000

    New tools: virt-resize and virt-list-partitions.
    
    Virt-resize is the main contribution here, a program which can
    be used to expand and shrink partitions in disk images.
    
    Virt-list-partitions is used as an ancillary tool for planning
    resize operations.

commit b6483061c25e90ae1b9e016812dea8e3756d6c23
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Mar 22 18:36:16 2010 +0000

    New API: guestfs_copy_size to copy a fixed number of bytes.
    
    This is similar to 'guestfs_dd', but it copies just a fixed
    number of bytes from the source to the destination.  It's an
    error if the source is too short or if the destination is too
    small.

commit 5d90acbe4b670e14084bbe9d11b717bfb6d95603
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Mar 19 17:21:05 2010 +0000

    Change some _exit(0|1) to _exit(EXIT_SUCCESS|EXIT_FAILURE).

commit cef4ba0b8fec2b95153a07ac9537306e50ba167f
Author: Richard Jones <rich@koneko.home.annexia.org>
Date:   Mon Mar 22 10:30:25 2010 +0000

    Mac OS X: Fix configure-time tests for Ruby.
    
    For ARCHFLAGS change, see:
    http://www.ruby-forum.com/topic/129717#579065
    
    We also add a test for the <guestfs.h> header and include
    that header when testing the library.

commit e5fa90a795ab632918081195c356aa4c02ab61cd
Author: Richard Jones <rich@koneko.home.annexia.org>
Date:   Mon Mar 22 10:29:18 2010 +0000

    guestfs.h: Include <stdint.h>.
    
    This allows programs to work if they just
      #include <guestfs.h>
    and no other headers.  It's not useful in the general
    case, but fixes some configure-time tests, particularly
    the one for Ruby on OS X.

commit 82bd4fac87dce677a69bc5297f11799baf3eb1f5
Author: Richard Jones <rich@koneko.home.annexia.org>
Date:   Mon Mar 22 10:05:49 2010 +0000

    ocaml examples: Fix linking line so it uses local library.

commit 36e8ece4ccdf0cb65cd6a8bb30d95c9813335645
Author: Richard Jones <rich@koneko.home.annexia.org>
Date:   Sun Mar 21 21:47:39 2010 +0000

    Mac OS X: Disable null vmchannel implementation.
    
    As far as I can tell, Darwin has no way to check the peer euid
    of a _loopback_ TCP socket.  This is required for the "null vmchannel"
    implementation to work securely.
    
    Therefore disable this - Darwin will use one of the other supported
    vmchannel implementations instead.

commit d4a202aa7bf45382e84f558239dadc24c73d195d
Author: Richard Jones <rich@koneko.home.annexia.org>
Date:   Sun Mar 21 20:41:41 2010 +0000

    Mac OS X: 'xdr_uint32_t' is 'xdr_u_int32_t'

commit fd8b87ec2b0e535e04508595c3da3e32382f6af0
Author: Richard Jones <rich@koneko.home.annexia.org>
Date:   Sun Mar 21 19:45:50 2010 +0000

    Mac OS X: For PATH_MAX, include <limits.h>

commit 9e397cc16be51f4f3940c7a5b90d0bc43f3f13a8
Author: Richard Jones <rich@koneko.home.annexia.org>
Date:   Sun Mar 21 19:30:25 2010 +0000

    Mac OS X: setlocale function requires <locale.h> header file.

commit dd12eaefb5879255be78f8233f7e503ffbf7c4f1
Author: Richard Jones <rich@koneko.home.annexia.org>
Date:   Sun Mar 21 19:15:40 2010 +0000

    Mac OS X: implement readline functions.
    
    OS X has an older version of readline with some differences
    in the names of functions.

commit 5ebf3a39340696fea0582a58074d22d11247a6e7
Author: Richard Jones <rich@koneko.home.annexia.org>
Date:   Sun Mar 21 19:13:43 2010 +0000

    Mac OS X: provide alternate implementation of posix_fallocate.

commit b2070ae3d797a32a8227c6b9231efa249c94d330
Author: Richard Jones <rich@koneko.home.annexia.org>
Date:   Sun Mar 21 17:49:49 2010 +0000

    Mac OS X: include <rpc/types.h> before <rpc/xdr.h>
    
    In PortableXDR this is not included automatically so we
    have to include it explicitly to get definitions for the
    XDR types.

commit cc6a6a3dcc8e03410a645500c28ee781c95c795f
Author: Richard Jones <rich@koneko.home.annexia.org>
Date:   Sun Mar 21 17:49:09 2010 +0000

    Mac OS X: include <string.h> in guestfs-actions.c
    
    This is required because guestfs-actions.c uses 'memset'.

commit b369fa6f91185efd4503aba4565671b8a0380d23
Author: Richard Jones <rich@koneko.home.annexia.org>
Date:   Sun Mar 21 17:16:04 2010 +0000

    Mac OS X: Fix HAVE_GNU_CALLOC so it works when __GLIBC__ is not defined.

commit a28791d6ac818761405fe898c600bafd7137b857
Author: Richard Jones <rich@koneko.home.annexia.org>
Date:   Sun Mar 21 17:15:26 2010 +0000

    Mac OS X: strerror_r on Macs is not like GNU strerror_r.
    
    Really this should be turned into a configure-time test.
    Perhaps one exists already?

commit a6802f80b3b91bfc7d6846db2989c381385e6a15
Author: Richard Jones <rich@koneko.home.annexia.org>
Date:   Sun Mar 21 17:14:37 2010 +0000

    Mac OS X: define MAX macro if not already defined.

commit 73e472f1f1e9b8830cb74f06659e95507696a4f9
Author: Richard Jones <rich@koneko.home.annexia.org>
Date:   Sun Mar 21 17:14:15 2010 +0000

    Mac OS X: kill(2) requires <signal.h>

commit 1bf76681103c755b1a650e002292aa33f7d0babf
Author: Richard Jones <rich@koneko.home.annexia.org>
Date:   Sun Mar 21 17:13:07 2010 +0000

    generator: Small fix for GODI users.
    
    GODI has an odd package layout, so the generator was unable to
    find xml-light.  Add the GODI directory to the search path.

commit df54298591bec8d34e7855c3528a2d5d450ffb20
Author: Richard Jones <rich@koneko.home.annexia.org>
Date:   Sun Mar 21 16:06:30 2010 +0000

    Ignore m4/intmax.m4

commit 35e916dbcf06ace10c73e67a0a20bae87bb0733b
Author: Richard Jones <rich@koneko.home.annexia.org>
Date:   Sun Mar 21 16:04:09 2010 +0000

    Remove out-of-date comment.

commit ef044690c54deb597bfe706cb88849dda5ebe8fc
Author: Richard Jones <rich@koneko.home.annexia.org>
Date:   Sun Mar 21 16:03:16 2010 +0000

    configure: Add --disable-daemon and --disable-appliance options.
    
    Use these on any platforms where you don't want or need to
    build the daemon/appliance combination.

commit b7d59e2cdaa73b42a2063a0653151bae20497074
Author: Richard Jones <rich@koneko.home.annexia.org>
Date:   Sun Mar 21 16:33:37 2010 +0000

    Run qemu with -nographic option.
    
    On Mac OS X this prevents a short "flash" as qemu opens a
    toplevel window.

commit a7cb2d9b08ca038a96aa180fee0f5e8745d2928d
Author: Richard Jones <rich@koneko.home.annexia.org>
Date:   Sun Mar 21 16:32:27 2010 +0000

    configure: Move host_cpu definition to earlier in the file.

commit 4a065c99e450446e0a9293fa663f97dfed2aa405
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Mar 21 21:23:47 2010 +0000

    appliance: Run depmod to create modules.dep for the kernel.
    
    Since we disabled running new-kernel-pkg in febootstrap, this
    has meant that the normal appliance has not had a modules.dep
    file.  (Supermin was unaffected by this).

commit 7581672c7893fd392ca10b47f044af327011f502
Author: Richard Jones <rich@koneko.home.annexia.org>
Date:   Sun Mar 21 19:30:52 2010 +0000

    Mac OS X: Detect bindtextdomain.
    
    These are missing on Mac OS X.  I think you would need to install
    a gettext package to get these.

commit f5d52fa3c00e525cd5d86089b85f970a5c4e7c21
Author: Richard Jones <rich@koneko.home.annexia.org>
Date:   Mon Mar 22 08:29:17 2010 +0000

    Mac OS X: Use gnulib setenv module explicitly.
    
    See:
    https://www.redhat.com/archives/libguestfs/2010-March/thread.html#00094

commit 50d2af4f8541a81d047753d7d300804ff649230c
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Mar 18 13:48:03 2010 +0000

    New APIs: Query the relationship between LVM objects.
    
    These calls allow you to query the relationship between
    LVM objects, for example, which PVs contain a VG, or which
    LVs are contained in a VG.
    
    See the example / test program 'regressions/test-lvm-mapping.pl'
    for an example of how to do this from Perl.

commit 27e73269d384814eb5f76468f609f7844cb75b0b
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Mar 18 13:46:26 2010 +0000

    daemon: Add a trim utility function.
    
    This function trims the whitespace from around a string.  It
    does this in-place, so it can be called for malloc'd strings.

commit 676462684e05dd8341dd695762dd99a87d8ec022
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Mar 16 21:50:13 2010 +0000

    add_drive_ro adds readonly=on option if available.
    
    Change the add_drive_ro call so it adds the readonly=on option
    if qemu supports that.
    
    This just means that qemu will not try to open the drive with
    O_RDWR, and should not otherwise change the behaviour of qemu or
    libguestfs.  (In particular, writes to the read-only drive are
    still permitted, and are just discarded when the handle is closed).
    
    However it should alleviate RHBZ#571714 where udev was deciding
    to incorrectly relabel a device because we had opened the device
    for writing (even though we didn't actually write to it).

commit 5442f45aea522a728fa5b06396d4f08d8506d7de
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Mar 16 21:44:26 2010 +0000

    Allow qemu_supports to run earlier.
    
    Reimplement qemu_supports() internal function.  Allow it to run
    before launch so we can test qemu features.  Document that you
    should run guestfs_set_qemu as early as possible to make sure
    these tests are reliable.

commit f8d781a00dcc9936802853d624ca92451463ab7f
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Mar 16 20:06:12 2010 +0000

    Add minimal vim to the appliance for virt-rescue.
    
    virt-rescue lacks an editor.  Add vim-minimal (Fedora)
    or vim-tiny (Debian) to make up for this omission.

commit 760a1c84d7e83fede50bb635749f092fb8b191c0
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Mar 16 21:11:23 2010 +0000

    tests: Don't use <guestfs-internal.h> in tests.
    
    It was failing when including this header, as a consequence
    of earlier commit 1f56debfcfdc35d6b0.

commit d89955fde9806d1125e03cc3caddea12df9d0cfa
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Mar 16 11:50:39 2010 +0000

    guestfs.h: More adjustment to comments in the header file.

commit 1f56debfcfdc35d6b0e7fec469dba0598d7f1901
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Mar 16 11:18:51 2010 +0000

    guestfs.h: Move some internal functions to the internal header.
    
    Functions like guestfs__send were never exported through the public
    API (libguestfs.syms prevented that).  However they appeared in the
    public header.  Move them to the internal header.

commit 504177b0aad966ef6db90190ad81eb1a75a193ce
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Mar 16 11:15:28 2010 +0000

    Rearrangement and comment changes in <guestfs.h> header file.
    
    There should be no substantive change.

commit 84bcb4dbee2f3b359409e911deaf82e6e5d0ab43
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Mar 12 18:28:21 2010 +0000

    Prepare for version 1.0.86.

commit 369872b91ed50e2803dc2837183258776e9868e0
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Mar 12 16:23:46 2010 +0000

    Tab to space (whitespace fixes only).

commit ffa3af3b5dd234012f9f4b9c28d483ff371f0ecc
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Mar 12 16:23:14 2010 +0000

    Docs: Change exit(1) -> exit(EXIT_FAILURE)

commit cb9613b993792c1c4b14fa0d9b5001ff644ac2f4
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Mar 12 16:20:31 2010 +0000

    Rewrite libguestfs-supermin-helper in C.
    
    libguestfs-supermin-helper was previously a shell script.  Although
    we had steadily optimized it, there were a number of intractable
    hot spots:
    
      (1) cpio still reads input files in 512 byte chunks; this is *very*
        pessimal behaviour, particularly when SELinux is enabled.
      (2) the hostfiles globbing was done very inefficiently by the shell,
        with the shell rereading the same directory over and over again.
    
    This is a rewrite of this shell script in C.  It is approximately
    3 times faster without SELinux, and has an even greater speed difference
    with SELinux.
    
    The main features are:
    
      (a) It never frees memory, making it simpler.  The program is designed
        to run and exit in sub-second times, so this is acceptable.
      (b) It caches directory reads, making the globbing of host files much
        faster (measured this as ~ 4 x speed up).
      (c) It doesn't use external cpio, but instead contains code to write
        newc format cpio files, which is all that the kernel can read.  Unlike
        cpio, this code uses large buffers for reads and writes.
      (d) Ignores missing or unreadable hostfiles, whereas cpio gave a
        warning.
      (e) Checks all return values from system calls.
      (f) With --verbose flag, it will print messages timing itself.
    
    This passes all tests.
    
    Updated with feedback from Jim Meyering.

commit 891aac7a0c35eb25f853c3960eadf8f1f22ca60b
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Mar 12 09:47:38 2010 +0000

    guestfish: Use xstrtoll to parse Int params (RHBZ#569757 RHBZ#567567).
    
    Change guestfish so it uses xstrtoll to parse Int (31 bit)
    parameters.  This fixes two bugs on 32 bit platforms which
    failed when long = 32 bits.  long long = 64 bits on both.

commit 599f94c9c14c970dcfd7cec8d6898cd3b46af8ca
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Mar 12 15:10:28 2010 +0000

    Special case hostfiles handling for libntfs-3g.so
    
    The ntfs-3g project keeps bumping their soname, and this causes
    dependency problems for the Fedora package.  The root of the problem
    is we depend on /lib/libntfs-3g.so.<N>, but if <N> keeps bumping,
    the dependency keeps breaking.
    
    This commit changes the hostfiles (and hence dependency) to be on
    /lib/libntfs-3g.so.* instead.  The downside to this is we could end
    up pulling more files into the appliance than are strictly required,
    but it will fix the Fedora packaging problems being felt by the
    Fedora maintainer of ntfs-3g.
    
    After applying this commit, the change to hostfiles looks like this:
    
    @@ -1489,7 +1489,7 @@
     ./lib/libpam_misc.so.0
     ./lib/libdmraid.so
     ./lib/libidn.so.11
    -./lib/libntfs-3g.so.74
    +./lib/libntfs-3g.so.*
     ./lib/libext2fs.so.2.*
     ./lib/libpam.so.0
     ./lib/libsepol.so.1
    @@ -1520,7 +1520,6 @@
     ./lib/libnss_files-*.so
     ./lib/libgio-2.0.so.0
     ./lib/libpam_misc.so.0.*
    -./lib/libntfs-3g.so.74.*
     ./lib/libanl.so.1
     ./lib/libdevmapper-event-lvm2.so.2.*
     ./lib/libpthread.so.0

commit ebfcb7f23df4546977628dc718982730682a68c0
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Mar 8 19:31:12 2010 +0000

    inspector: Read information about Windows guests from the Registry.
    
    This commit changes substantially the way that we get information
    about Windows guests.  We now use the Windows Registry to get
    information such as the version, product name and much else.
    
    This uses Win::Hivex (ie. the hivex library).  'reged' is no longer
    needed or used.
    
    As an incidental change, this also tries harder to search for
    %systemroot%, in the case when we cannot find boot.ini (ie.
    Windows Vista and more recent).  This ensures we can get more
    detail from those versions of Windows.

commit 4851466ec5adbbc039222201f7c3b1bc3b97e84e
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Mar 8 19:27:02 2010 +0000

    inspector: Add product_name field to output.
    
    This is a free text string containing the "product name" of
    the OS.  It's mainly useful for Windows guests, and a forthcoming
    patch will get this field from the Windows Registry.

commit ed6fc794c8a2f64f8b987137b54551f4380177f3
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Mar 8 19:28:48 2010 +0000

    inspector: Don't crash if $os->{kernels} does not exist.
    
    ie. on Windows.

commit dcfa05f703ca0c281c12a14450d06dfb4ac7893d
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Mar 8 19:24:48 2010 +0000

    inspector: Sort application names.
    
    This ensures the list of applications is stable.

commit aca024e9766268e6a09a8aeedee562d10910ca6d
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Mar 8 16:04:09 2010 +0000

    Remove plymouth libraries from the appliance.

commit f550f31477794a434fb499f08b7f21aa3b8e8f79
Author: Daniel Cabrera <logan@fedoraproject.org>
Date:   Wed Mar 3 15:49:39 2010 +0000

    Spanish translation of libguestfs (RHBZ#570181).

commit 4891ff9945177e8666af8381d1e0a54b8ce363e2
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Mar 2 10:34:20 2010 +0000

    More complete fix for bash regexp quoting bug.
    
    Commit 457fccae1b665347 was not a complete fix, in that it
    didn't work properly on RHEL 5 era bash (3.2.x).  For example:
    
      file=libntfs-3g.so.74
      [[ "$file" =~ ^lib(.*)\.so\.([0-9]+)\. ]] && \
        echo "lib${BASH_REMATCH[1]}.so.${BASH_REMATCH[2]}.*"
    
    would on those old shells print:
    
      libntfs-3g.so.7.*
    
    It seems the final \. was being treated as a plain period (ie.
    match anything).
    
    The only way to work around this incompatibility is to assign the
    patterns to variables and match on those, ie:
    
      p='^lib(.*)\.so\.([0-9]+)\.'
      [[ "$file" =~ $p ]] && ...
    
    This works in both old and new shells.

commit d09a918e086c19b133fc92c4339038247cfd7443
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Mar 1 13:49:25 2010 +0000

    Prepare for version 1.0.85.
    
    Update PO files.

commit d9e2285837c81baea914107567d26442ec76e3fa
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Mar 1 14:17:12 2010 +0000

    fuse: Fix typo in test.

commit 457fccae1b665347f81045e8c7a3309d8328c4fc
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Mar 1 13:32:34 2010 +0000

    build: Fix for bash quoting in supermin-split.sh.in (RHBZ#566511 RHBZ#566512)
    
    Bash changed how the =~ operator worked, see bash FAQ question
    E14 http://tiswww.case.edu/php/chet/bash/FAQ and
    http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=487387#25
    (RHBZ#566511).
    
    This also stops stray "builddir" (yum database) files being
    incorporated into supermin hostfiles in Koji (RHBZ#566512).

commit afcb3695b6ce9036f8a531745e254f146507f2a0
Author: Piotr Drąg <piotrdrag@gmail.com>
Date:   Mon Mar 1 09:38:07 2010 +0000

    Updated Polish translations (RHBZ#502533).

commit 49d85054fc0088d8b8acab13799e32fabe972e96
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Feb 25 20:02:38 2010 +0000

    Remove bogus msgstr from kn.po.

commit de33cc91ee93f85f06b9976fdc5454c0eb851b8e
Author: Guido Günther <agx@sigxcpu.org>
Date:   Wed Feb 24 09:07:56 2010 +0100

    List application in Debian based vm images
    
    Hi,
    attached patch adds the code to list applications installed in Debian
    based vm images.
    Cheers,
     -- Guido
    
    >From 9427a14725b33415058a0713923c62bd231504ec Mon Sep 17 00:00:00 2001
    From: =?UTF-8?q?Guido=20G=C3=BCnther?= <agx@sigxcpu.org>
    Date: Tue, 23 Feb 2010 21:05:02 +0100
    Subject: [PATCH 2/2] Add application listing for Debian

commit b5c307b7d6c154337b1d2427b81418ebc9e16251
Author: Guido Günther <agx@sigxcpu.org>
Date:   Wed Feb 24 09:06:23 2010 +0100

    Debian package format
    
    Hi,
    Minor nitpick: the Debian folks usually refer to deb as the package format not dpkg.
    Cheers,
     -- Guido
    
    >From 7a9665d40e0a3109833de10f17831ae06fc8885a Mon Sep 17 00:00:00 2001
    From: =?UTF-8?q?Guido=20G=C3=BCnther?= <agx@sigxcpu.org>
    Date: Tue, 23 Feb 2010 21:04:37 +0100
    Subject: [PATCH 1/2] Debina package format is called 'deb' not 'dpkg'

commit d070a017f710244908617eaa8fa147bc335aa660
Author: Guido Günther <agx@sigxcpu.org>
Date:   Tue Feb 23 20:42:48 2010 +0100

    check for grub/menu.lst too
    
    On Tue, Feb 23, 2010 at 08:07:14PM +0100, Guido Günther wrote:
    > On Tue, Feb 23, 2010 at 07:52:43PM +0100, Guido Günther wrote:
    > > Hi,
    > > attached patch makes virt-inspector find the kernels on Debian systems.
    > > Since there is no /etc/grub.conf it falls back to
    > > $grubpartition/grub/menu.lst.
    > Patch got somehow broken. New version fortchcoming. Sorry for the noise.
    Attached now. No idea where the 'if' went in the first version ;)
     -- Guido
    
    >From d30b4946f017ff8bde9d4ff62f93c418a707d9e8 Mon Sep 17 00:00:00 2001
    From: =?UTF-8?q?Guido=20G=C3=BCnther?= <agx@sigxcpu.org>
    Date: Tue, 23 Feb 2010 19:50:40 +0100
    Subject: [PATCH] Check for grub/menu.lst if /etc/grub.conf can't be found

commit 4ff21ceb2561936fc2e204f0a02e6ca8fb8fd507
Author: Guido Günther <agx@sigxcpu.org>
Date:   Tue Feb 23 18:55:56 2010 +0100

    Use 'service' if installed
    
    Hi,
    attached patch should make:
    
    http://git.debian.org/?p=pkg-libvirt/libguestfs.git;a=blob;f=debian/patches/0003-appliance-Use-service-udev-start-instead-of-running-.patch;h=c9e6b8489807d4fb1247cb6a8b6f9799bad2a09e;hb=d3a21b5b6850fc3c6e7903d0f5cafa3eb4197d49
    http://git.debian.org/?p=pkg-libvirt/libguestfs.git;a=blob;f=debian/patches/0004-Ubuntu-Prefer-starting-udev-by-hand-instead-of-using.patch;h=64b65a971b186e6ab1c9351e94b46d6f5aa242e0;hb=d3a21b5b6850fc3c6e7903d0f5cafa3eb4197d49
    
    superflous. If there's an init script it uses 'service' or falls back to
    calling the init script directly if it isn't there, otherwise it starts
    udev directly. Tested on Debian only so far. The patch is based on
    Rich's above two patches.
    Cheers,
     -- Guido
    
    From: =?UTF-8?q?Guido=20G=C3=BCnther?= <agx@sigxcpu.org>
    Date: Tue, 23 Feb 2010 18:49:34 +0100
    Subject: [PATCH] Check for service and use it if it's there
    
    Based on Richard's two patches for the Ubuntu build.

commit 1ea1e536346f59fa63fdd33639ffc297282bfc37
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Feb 24 10:33:27 2010 +0000

    Update PO files.

commit d6a10efaaa51d4c565f79388eda7f909df0e92f9
Author: Shankar Prasad <svenkate@redhat.com>
Date:   Wed Feb 24 10:32:03 2010 +0000

    Added Kannada translations (RHBZ#567860).

commit a8c3723e3818b5a7a31520043c6831115ab9d0e0
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Feb 22 12:53:16 2010 +0000

    Spin off hivex as a separate upstream project.
    
    This commit makes the semi-independent hivex library into a
    separate upstream project.  The git repo for hivex is now:
    
    http://git.annexia.org/?p=hivex.git;a=summary
    
    Downloads of hivex are available here:
    
    http://libguestfs.org/download/
    
    All questions, patches, bugs etc should be sent to the libguestfs
    mailing list and bug tracker.

commit aa4700f0325743aaa16b525637b00ee61b39df13
Author: Guido Günther <agx@sigxcpu.org>
Date:   Sun Feb 21 16:07:20 2010 +0100

    enable scrub on Debian

commit 219b80cc6c9c1410c39a6e540214727e3e3cf022
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Feb 19 13:51:07 2010 +0000

    hivexsh: Print hex bytes >= 0x80 correctly.
    
    These were being interpreted as signed chars, and thus printed
    as "ffffff80" etc.

commit abe54abdd2a51f8fc6da26d4e5d4773f68da695e
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Feb 19 13:50:31 2010 +0000

    Remove unused Perl modules.
    
    These were 'use'd but not actually used.

commit c06ee4ba0207ce41537a4f35245c2e8e42b64772
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Feb 16 08:06:04 2010 +0000

    Update PO files.

commit 04ee1adc919cf70091df624cb4a087703bf599a9
Author: Rajesh Ranjan <rranjan@redhat.com>
Date:   Tue Feb 16 08:04:59 2010 +0000

    Add Hindi translations (RHBZ#565759).

commit 699f38f05f2545a2c188370500df17cc52cbdf98
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Feb 15 23:15:17 2010 +0000

    Turn ProtocolLimitWarning into link to documentation section.

commit e3f371fff23fa01fc8cedc030ffa9e38b9a3bdc3
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Feb 15 22:58:22 2010 +0000

    initrd-cat: Needs ProtocolLimitWarning.

commit dabe72cb8b7b23cc6e6158d458327313b8a8495a
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Feb 15 22:53:40 2010 +0000

    Remove references to FTP, replace with FUSE.
    
    We originally intended to implement an FTP server (and before
    than, an NFS server).  But we didn't implement either.  We
    did however implement a FUSE service (guestmount) which takes
    the place of both.

commit 1f0f0df9b19520979857ab42b192ba46e0bc36dd
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Feb 15 15:55:38 2010 +0000

    Remove some unused variables.
    
    Since we have to compile with -Wno-unused-variables, we don't
    spot unused variables in code.  I found these by compiling the
    code in Ubuntu.

commit 30a0b5cf1606c54cc527d758949422396763cbd3
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Feb 15 15:34:34 2010 +0000

    Distribute .gitignore files.
    
    These are useful for Debian since they keep the tarball unpacked
    in git.

commit ed83d770252dda356bc9f8ad19149ada5e8708a5
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Feb 15 15:33:13 2010 +0000

    Add 'make quickcheck' rule to run a quick check.

commit 2109327021f4d464e2693e507fa92f1497ba0792
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Feb 12 19:43:17 2010 +0000

    Version 1.0.84.

commit e9c37113104c1cfb234535adc9b52ad3880a41ce
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Feb 12 14:06:25 2010 +0000

    daemon: Don't need to prefix error messages with the command name.
    
    The RPC stubs already prefix the command name to error messages.
    The daemon doesn't have to do this.  As a (small) benefit this also
    makes the daemon slightly smaller.
    
    Code in the daemon such as:
    
      if (argv[0] == NULL) {
        reply_with_error ("passed an empty list");
        return NULL;
      }
    
    now results in error messages like this:
    
      ><fs> command ""
      libguestfs: error: command: passed an empty list
    
    (whereas previously you would have seen ..command: command:..)

commit 9b3ef85a3d1b43faa98bb5dc922f8a273a5e1dde
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Feb 12 13:42:57 2010 +0000

    generator: Don't prefix error messages with command name.
    
    The command name is already being added by the RPC stubs, so
    adding it again in Perl and C# just results in doubled error messages
    like:
      foo: foo: the error

commit c03b7e4d756597f30415260a84a3caee3d9d6bde
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Feb 12 12:13:40 2010 +0000

    Sys::Guestfs::Lib::open_guest: Add interface parameter.
    
    This allows you to override the default QEMU block device emulation.

commit 33b4b759afe58c959bdc8b904d618aa1d699a240
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Feb 12 12:08:58 2010 +0000

    Sys::Guestfs::Lib::open_guest: Remove freeform parameters.
    
    Remove the ability to pass freeform parameters to Sys::Virt->new.
    We don't use it, it makes the code more complex to modify, and
    indeed there are no other args that Sys::Virt->new supports so
    this would never be used.
    
    Also change $readwrite to $rw to match parameter name.

commit 946dc06bb861a38cae959416362e4561c9e4829a
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Feb 12 11:47:18 2010 +0000

    New APIs: add-drive{,-ro}-with-if allows you to set QEMU block emulation.
    
    The default if=... comes from configure time (currently it
    defaults to if=virtio).
    
    This change allows you to set the QEMU block emulation.
    
    We don't think this will be used very often, but virt-v2v
    requires it in order to work around a subtle problem with
    running 'mkinitrd' in an appliance attached to a guest.

commit 48a9ff73319d0d065bff2b9374c84bcf6438cb20
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Feb 12 11:46:40 2010 +0000

    generator: 'interface' is a reserved word in Java.

commit 8d70639e27c79ce88c1e61898536c17cd71258e7
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Feb 12 11:27:44 2010 +0000

    add_cdrom: Update docs for adding ISO images.
    
    See also RHBZ#563450 (NB: This commit does not fix the bug).

commit f93cbe5756cf052cce8049087afdcf714a3fc70c
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Feb 9 18:00:24 2010 +0000

    Use mount-options instead of mount to avoid implicit -o sync.
    
    guestfs_mount adds -o sync implicitly.  This causes a very large
    performance problem for write-intensive programs (eg. virt-v2v).
    
    Document this as a "gotcha".
    
    Change the tests, guestfish, Sys::Guestfs::Lib, guestmount to use
    mount-options instead.
    
    (Note that this gotcha does not affect mount-ro).
    
    The source of the performance problem was first identified by
    Matthew Booth.

commit 245ac5673700f54479e9408e8659cb68f80c344a
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Feb 9 16:30:18 2010 +0000

    Add -enable-kvm option to qemu command line.
    
    If the version of qemu being used supports -enable-kvm option,
    then check if /dev/kvm is openable and add this option.
    
    I have found this option makes no difference, although it is
    *supposed* to enable KVM (hardware virtualization) support.

commit e4fbe3e2cd130fa0b1b21a105729cd6ef32aac38
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Feb 9 12:26:22 2010 +0000

    New API call: initrd-cat to list a file from an initrd.

commit 80bc4ffe9341fea06fb1c1e2bd099a53db6655f2
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Feb 8 22:51:19 2010 +0000

    Remove invalid Plural-Forms header from ml.po.

commit c0baa7bdb2b404e8c808700984b3fc1a699d8dd7
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Feb 8 16:44:41 2010 +0000

    Documentation: Added a section on libguestfs gotchas.

commit 6c97a65ce768b357a1481cde0533d4cf0b8b931c
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Feb 8 10:18:31 2010 +0000

    Make virtio block driver be the default for the appliance.
    
    Previously this caused a serious performance regression,
    but we believe this is now fixed:
    https://bugzilla.redhat.com/show_bug.cgi?id=509383

commit a1d388f25859b1c205aebb04dcd4846aa47027a1
Author: Ani Peter <apeter@redhat.com>
Date:   Mon Feb 8 10:06:32 2010 +0000

    Added Malayalam translations (RHBZ#562710).

commit 0d4bc93c737455d75dacab78cb9d65f47c500add
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Feb 5 18:54:52 2010 +0000

    Distribute hivexsh.1.html HTML file.

commit 23e117d8cfb13647d52fa5037464936454351f0a
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Feb 5 18:40:14 2010 +0000

    Update PO files.

commit 665ddb18fafeea53dff508c7dfdd00536ccab52e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Feb 5 17:02:47 2010 +0000

    RHEL5: Keep old automake happy by defining docdir

commit 75f803a9d59a168c611e8518df7b4f75fe3bc98c
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Feb 5 18:01:18 2010 +0000

    Add scripts to EXTRA_DIST.

commit a65cc6b06d870287771302c1965b8d692fdaf560
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Feb 5 17:19:30 2010 +0000

    Update PO files.

commit e543a9a21421e766169b421d48904c6b8ebbfe5e
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Feb 5 17:19:21 2010 +0000

    Prepare for version 1.0.83.

commit 6d7777d48001076a276a75bf491bb1cf138ff941
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Feb 5 17:19:01 2010 +0000

    Add files to EXTRA_DIST.

commit 75beebd0126df18f0badd8d80d5aecd130f52761
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Feb 5 15:12:09 2010 +0000

    hivex: example6: Don't double backslashes.

commit 8e15d5a1899106de5080196ddca392b2ff997ac9
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Feb 5 15:05:36 2010 +0000

    hivex: example6: Hypothetical addition of keys for viostor.

commit 90781ca7d22a22b9abb367c10707639c7bd31c5b
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Feb 5 14:50:19 2010 +0000

    hivex: Fix handling of inline VKs.

commit 0764b932676b66ffca9ffa4cc5a45ebac7d81748
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Feb 5 13:47:32 2010 +0000

    hivexsh: Set correct type for 'expandstring' values.

commit 348bcd59b3fdfd9f8de353260fb31d745388a64e
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Feb 5 12:59:43 2010 +0000

    hivex: Documentation and cleanups.

commit ba48a213aba137fd65df5c8407b6bd49f4476c24
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Feb 5 12:59:18 2010 +0000

    hivex: Make limits into macros.

commit 495aa36aa67a2d626f1a855a0d01cfd5caa86a26
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Feb 5 12:57:53 2010 +0000

    hivexsh: Remove unused variable.
    
    This removes an unused variable left over by
    commit ab608f3948d903af64e814b2e67949a1a71d93a4.

commit 3a06848a71f18106fd79f8c73b490eca82d54dfe
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Feb 4 16:33:18 2010 +0000

    hivex: Complete the implementation of adding child nodes.

commit 006795555e9aa67c0070df4d0ec2d1bb3650e2f9
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Feb 4 18:42:58 2010 +0000

    hivex: More debugging around nk 'unknown2' field.

commit 5b7f2f3f9f0420d914ca8672718539783571db4a
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Feb 4 17:59:11 2010 +0000

    hivex: Check hash fields in lf/lh records.

commit 9a7f01917f674d43ef4a9b056f303f5dc0031210
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Feb 4 16:32:22 2010 +0000

    hivexsh: del command: Fix error message.

commit 3932b383869a1029457fac172827ef2b538d77de
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Feb 4 16:31:55 2010 +0000

    hivexsh: lsval: Remove stray quotation mark.

commit 43504796252dc8c399f490927008fcbf7d97b27b
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Feb 4 16:31:09 2010 +0000

    hivexsh: cd command: fix error handling
    
    The error behaviour of hivex_node_get_child is subtle, so the 'cd'
    command wouldn't always report errors correctly.  This fixes it.

commit 3113582ef88d280cfa3c479cc705c3972c777fb7
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Feb 4 16:29:32 2010 +0000

    hivex: allocate_block should update valid block bitmap.
    
    The internal allocate_block() function wasn't updating the bitmap,
    so if you revisited a block which you had allocated in the same
    session, you could get an EFAULT error.

commit 51efd7de7d80c329b6dab214141eacf626657a95
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Feb 4 16:29:11 2010 +0000

    hivex: More debug messages.

commit d7175703994997a6c40cf78cd74809b82deb1ed4
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Feb 4 16:28:26 2010 +0000

    hivex: Documentation update.
    
    ntreg_lf_record can have id "lf" (old-style hashes) or "lh" (new-
    style hashes).

commit 023a1811a708ac107022133f8931d47442b23c09
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Feb 4 16:27:58 2010 +0000

    hivex: Some missing le32toh endianness conversions.

commit 6ecb9ef1418631a11e10d080ea88556750593f22
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Feb 4 14:12:04 2010 +0000

    hivexsh: Document some peculiarities of the "cd" command.

commit aef0d618b08dc9fb27fb3a729dd8926cff26ae0b
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Feb 3 18:10:38 2010 +0000

    hivex: Implement deleting child nodes.

commit e14d001fc929307cf017408856be6b753908ab43
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Feb 4 13:24:27 2010 +0000

    hivex: Add flags argument to internal get_children() function.
    
    When we later call get_children to visit the intermediate
    ri/lf/lh records, we have already deleted the subkey nk-records,
    so checking that those nk-records are still valid is not very
    helpful.
    
    This commit adds a flag to turn these checks off.

commit 01ba5f80ee02405f2a558e735e32957a710fdd5b
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Feb 4 13:26:04 2010 +0000

    hivex: Don't die on valid registries which have bad declared data lengths.
    
    Some apparently valid registries contain value data length
    declarations which exceed the allocated block size for the
    value.
    
    Previously the code would return EFAULT for such registries.
    However since these appear to be otherwise valid registries,
    turn this into a warning and just use the allocated block size
    as the data length (in other words, truncate the value).

commit 578a5774a3ec00aad31988079eb6aacddcf6643f
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Feb 3 18:09:52 2010 +0000

    hivex: Minimal registry example.
    
    This is the smallest registry you can make and still have it
    load correctly in Windows regedit.

commit d9d885e7c8d93f0623cb0525e725f86969bb1033
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Feb 3 18:04:31 2010 +0000

    hivexsh: Add 'setval' and 'commit' commands.
    
    This adds the 'setval' and 'commit' commands to the hivex shell.
    
    Also adds some example scripts showing use of these.

commit f604f9b0b44c17adcf7a799db06a7fc4c758c5e9
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Feb 3 17:59:03 2010 +0000

    hivex: Begin implementation of writing to hives.
    
    This implements hivex_node_set_values which is used to
    delete the (key, value) pairs at a node and optionally
    replace them with a new set.
    
    This also implements hivex_commit which is used to commit
    changes to hives back to disk.

commit 4718aeb9f0f743a05dfa342bc797617f3b9f96b3
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Jan 18 11:08:56 2010 +0000

    hivex: Add HIVEX_OPEN_WRITE flag to allow hive to be opened for writing.
    
    If this flag is omitted (as in the case for all existing callers)
    then the hive is still opened read-only.
    
    We add a 'writable' flag to the hive handle, and we change the way
    that the hive file (data) is stored.  The data is still mmapped if
    the file is opened read-only, since that is more efficient and allows
    us to handle larger hives.  However if we need to write to the file
    then we have to read it all into memory, since if we had to extend the
    file we need to realloc that data.
    
    Note the manpage section L</WRITING TO HIVE FILES> comes in a later
    commit.

commit db8a46aa1165479ddf2b551e81a7e96bb06fc942
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Feb 3 17:35:53 2010 +0000

    Tools for analyzing and reverse engineering hive files.
    
    This commit is not of general interest.  It contains the tools which
    I used to reverse engineer the hive format and to test changes.
    Keeping these with the rest of the code is useful in case in future
    we encounter a hive file that we fail to modify.
    
    Note that the tools are not compiled by default.  You have to compile
    each explicitly with:
    
      make -C hivex/tools <toolname>.opt
    
    You will also need ocaml-extlib-devel and ocaml-bitstring-devel.

commit 6ea059d6a1bd1be605278057025d34dee675d64d
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Feb 3 17:52:05 2010 +0000

    hivexsh: Change some exit(1) -> exit(EXIT_FAILURE)

commit 286113fa0a7d3b33facc80f06fbc0154fdda43b4
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Feb 3 17:50:51 2010 +0000

    hivexsh: Only print final \n when interactive.
    
    When hivexsh was called non-interactively, it would print an
    annoying extra line.  Only print this line if we are being
    used interactively.

commit ab608f3948d903af64e814b2e67949a1a71d93a4
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Feb 3 17:48:37 2010 +0000

    hivexsh: Change handling of prompt argument to rl_gets()
    
    Make the result of isatty into a global variable (is_tty).
    
    Change the rl_gets() function so it takes the prompt string
    instead of a "display prompt?" flag.  rl_gets() then consults
    the global to find out if it should display the prompt at all.

commit 933505a3be8ea5675151048a48b4746295b56d9b
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Feb 3 17:45:20 2010 +0000

    Document that this flag is clear for default keys.

commit 97dac113f9ee7d7f2ed581db789707ff759c8cb3
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Feb 3 17:44:39 2010 +0000

    Misc documentation and gitignore update.

commit e8ad7d2e1b1422680f9f862e7443de67328de135
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Feb 3 17:41:15 2010 +0000

    Move htole*/le*toh macros into a separate header file.
    
    This allows us to reuse these macros in hivexsh later.

commit 187651c138666d0555bc8ccdd129bb0f51caa72b
Author: Sandeep Shedmake <sshedmak@redhat.com>
Date:   Thu Feb 4 08:50:14 2010 +0000

    Add Marathi translations (RHBZ#561671).

commit f513c8876e548180f7d4286e56aae9308562152f
Author: Piotr Drąg <piotrdrag@gmail.com>
Date:   Tue Feb 2 22:08:24 2010 +0000

    Polish translations (RHBZ#502533).

commit 36a8928599f2decac40bdc4def2ca1b7fd69e2b3
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Feb 2 08:49:56 2010 +0000

    Update PO files.

commit 6121d53a90376b48dde11c184474ec1af5da6bad
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Feb 2 08:49:10 2010 +0000

    Add Gujarti translations (Sweta Kothari) (RHBZ#560918).

commit 9dc69372c804328ecd5883c9d139a7c2f45741f8
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Feb 1 14:50:19 2010 +0000

    Update Oriya translations (thanks Manoj Kumar Giri) (RHBZ#559498).

commit 73c587ff0f2f8f76af39b16dafb0949be7bf0883
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jan 29 19:12:34 2010 +0000

    hivex: Reimplement hivexget as a simple shell script.
    
    hivexget is currently a large C program.  Now that we have hivexsh
    (the shell) we can reimplement hivexget as a simple bash script that
    calls out to hivexsh.

commit 15a5511e038f53ade23fa998985ecd4de39b60d5
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jan 29 12:18:30 2010 +0000

    hivex: Add 'hivexsh' program (shell for navigating registry hives).

commit a6025c11d97ed5802b3729a93d224d2baa20ff12
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jan 29 14:56:13 2010 +0000

    Set locale in C programs so l10n works (RHBZ#559962).
    
    This commit adds the calls to setlocale &c to all of the current
    C programs.
    
    It also adds l10n support to hivexget and hivexml which lacked them
    previously.
    
    To test this, try:
    
    LANG=pa_IN.UTF-8 guestfish --cmd-help
    
    (You can only do this test after installing the package, or at
    least the 'pa.mo' mo-file in the correct place).

commit 088d0c53cfe0dcb20b87707a9055175b2fd6b72f
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jan 29 14:24:54 2010 +0000

    Another unreadable file: /var/log/yum.log

commit 35a2aa114d88f943586bf40c971844245b12e0d6
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jan 29 09:57:37 2010 +0000

    Update PO files.

commit 21cf5f7760b730902e4ab99dae46b8122395d17c
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jan 29 09:57:12 2010 +0000

    Add Tamil translation (RHBZ#559877) (thanks to I.Felix)

commit c9ca0143139af3c5cfe4240dc5366973c98f83e3
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jan 29 09:46:52 2010 +0000

    Update Punjabi translation (RHBZ#559480) (thanks Jaswinder Singh)

commit 2a224424acc47dc0f50fe605463bf2936fceb27c
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jan 29 09:02:14 2010 +0000

    Fix regressions/rhbz557655.sh when debugging is enabled (v2).
    
    The previous fix didn't cope with ordinary warnings emitted by
    qemu (eg. "open /dev/kvm: No such file or directory").  This
    is a hopefully more complete fix for the problem.
    
    See also commit 3cd7ce75f1ce5048a4d9f6aeaf66aff3194e1096.

commit 3cd7ce75f1ce5048a4d9f6aeaf66aff3194e1096
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jan 28 22:35:16 2010 +0000

    Fix regressions/rhbz557655.sh when debugging is enabled.
    
    The regression test for RHBZ#557655 would fail if debugging was
    enabled, because debug output would get mixed up with the test
    output.
    
    To reproduce the error do:
    
    LIBGUESTFS_DEBUG=1 make -C regressions TESTS=rhbz557655.sh check
    
    This commit disables debug for just this test.

commit 74fe427460bd2d455d2860c937ae81a8b5a1d1e7
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jan 28 22:06:27 2010 +0000

    Implement 'vgrename' and 'lvrename' APIs.

commit 3c973b8a960dfde022a7d49b30b8c6d504a182e3
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jan 28 19:28:21 2010 +0000

    Version 1.0.82.

commit 9a7640218c8c13d2924686d96457cfe0d3f91b1c
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jan 28 17:39:06 2010 +0000

    hivex: Const-correctness fix on header_checksum (thanks Jim Meyering).

commit f8753ae9f7c460b7d087820201c0619fe2130cdd
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jan 28 16:25:19 2010 +0000

    hivex: Update some previously unknown nk-record fields.
    
    Update these fields with what we found out from reverse engineering
    the file.  Also bring the unknownX field names into line with
    visualizer.ml.

commit 64fa7b9db7bd8bd543c2afa413ffbcc488988eab
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jan 21 17:07:42 2010 +0000

    hivex: Fix calculation of block size for vk data blocks.

commit c052b36385a56df3017b7e75a610add2b2cdea5a
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jan 21 17:07:21 2010 +0000

    hivex: Display incorrect block size as unsigned in an error message.

commit cb2ec65d5e4a4174b0f24635b971eeb2cdd964ff
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jan 21 16:19:49 2010 +0000

    hivex: display bad block offset in hex

commit 203013dc166efb4067711baab59d3fe513c67921
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jan 21 16:19:26 2010 +0000

    hivex: hive type in vk-record is an unsigned 32 bit int

commit 8635be75c5e5499c388049d10d28bc1313ca832c
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jan 19 15:21:06 2010 +0000

    hivex: Add missing le32toh conversion around field access.
    
    This was missing.  It only worked because we test on a little
    endian platform.

commit a1b72fd0ba5b2fb0a198247b00f9e7230ca8796d
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jan 19 15:20:36 2010 +0000

    hivex: Clarify some more fields.
    
    Taken from sentinelchicken.com documentation.

commit 09d988e8f1cfa42ef9a5abe5c9c151962aa1d2cc
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jan 19 12:22:10 2010 +0000

    hivex: Modify children/values functions to return intermediate blocks.
    
    Modify the functions that return child subnodes and values so they
    can also be used to return a list of the intermediate blocks.  This
    is so we can delete those intermediate blocks (in a later commit).
    
    We also introduce an offset_list structure which is used for collecting
    lists of offsets, ie. lists of nodes, values or blocks.
    
    Note that this commit should not change the semantics of the code.

commit a96877f75061ba35efa9fa5dde9fdcf7a1eeaf2a
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jan 19 10:06:00 2010 +0000

    hivex: Add value_any callback to the visitor.
    
    The visitor currently contains lots of value_* callbacks, such as
    value_string which is called back when the value has type string.
    
    This is fine but it makes it complicated to deal with the case where
    you just want to see 'a value', and don't care about its type.
    
    The value_any callback allows visitors to see values generically.

commit 5fe4d4718cf00876d8de20f4c297dc4ca69db1a4
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Jan 18 17:56:13 2010 +0000

    hivex: Move header checksum code into a function.
    
    This function can be reused later.

commit f1dc74b8d605c07f4b8d4ca0b8dcf3db8c18edd1
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Jan 18 15:24:16 2010 +0000

    hivex: page 'offset_next' field is really 'page_size'.
    
    The documentation, as usual, is contradictory.  However this
    field is definitely the page size in all observed registries.
    Furthermore the following field marked 'unknown' is always
    zero, although this contradicts what the sentinelchicken.com
    paper says.

commit fd70638e05d1e04b276c2504c34abe8c609d19b2
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Jan 18 14:14:40 2010 +0000

    hivex: Collect more statistics about registries.

commit 1e4614ca8f8d2b3d758fef733f1294c611502b94
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Jan 18 10:58:06 2010 +0000

    hivex: Store filename in hive handle.

commit 5eb38569991a3e932ee474921775b0a49fd69980
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jan 28 10:46:01 2010 +0000

    Added Oriya translations (RHBZ#559498).
    
    Translation by Manoj Kumar Giri.

commit dab98a0e52b9bb9930048b94d637a2fdb218fc45
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jan 28 09:59:08 2010 +0000

    supermin: Add special case for libgcc_s-*.so.N
    
    Because this file contains the GCC version and a date, it frequently
    changes on the host.  Create a special case so that this file is
    matched using a wildcard for the version/date part of the name.

commit 1577cb04fa67b94f922139c9b31459778ea8721b
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jan 28 09:49:27 2010 +0000

    Added translations for Punjabi (pa-IN) (RHBZ#559480).
    
    Translated by Jaswinder Singh.
    
    Also updated pot files.

commit 214babb060d9e85e72bad4633310a9b4a5fcb9dd
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jan 26 10:45:14 2010 +0000

    supermin: Prevent multilib corruption (RHBZ#558593).
    
    On some combination of installing, upgrading and removing the base
    libguestfs package on x86_64, multilib can corrupt libguestfs by
    leaving a copy of /usr/bin/libguestfs-supermin-helper around which
    references the wrong architecture (usually, contains links to the
    i386-based appliance, when the x86_64 appliance should be constructed).
    
    This commit changes libguestfs-supermin-helper so that the script is
    the same on all architectures.  Instead, the library passes the
    differences to the script (eg. $host_cpu).  Because the i386 and
    x86_64 libraries should be at different locations (/usr/lib vs
    /usr/lib64) this should prevent multilib from screwing things up.
    
    Related links:
    https://bugzilla.redhat.com/show_bug.cgi?id=558593
    http://rwmj.wordpress.com/2009/11/16/please-someone-shoot-multilib/#content
    https://bugzilla.redhat.com/show_bug.cgi?id=235752

commit 7de6391695120cb1cfc3b77a497d6cf235a453a7
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jan 27 15:30:03 2010 +0000

    Added Telugu translations (RHBZ#559237).
    
    Also ran 'make -C po update-po' to update the POT file.

commit 3c398c8928d3860ca9e3c413046b6f38318bb6ef
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Jan 25 16:16:55 2010 +0000

    supermin: Ignore more unreadable files found on RHEL 6.

commit c479a06f4bba4b0172194cd5def4bc0aed84f5c1
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Jan 25 12:22:36 2010 +0000

    Sync to latest Gnulib.

commit 58abe782bf7137526b4a5c7e6d5d2b145e3b09d2
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jan 22 11:01:06 2010 +0000

    guestfish: Use xstrtol to parse integers (RHBZ#557655).
    
    Current code uses atoi to parse the generator Int type and
    atoll to parse the generator Int64 type.  The problem with the
    ato* functions is that they don't cope with errors very well,
    and they cannot parse numbers that begin with 0.. or 0x..
    for octal and hexadecimal respectively.
    
    This replaces the atoi call with a call to Gnulib xstrtol
    and the atoll call with a call to Gnulib xstrtoll.
    
    The generated code looks like this for all Int arguments:
    
      {
        strtol_error xerr;
        long r;
    
        xerr = xstrtol (argv[0], NULL, 0, &r, "");
        if (xerr != LONGINT_OK) {
          fprintf (stderr,
                   _("%s: %s: invalid integer parameter (%s returned %d)\n"),
                   cmd, "memsize", "xstrtol", xerr);
          return -1;
        }
        /* The Int type in the generator is a signed 31 bit int. */
        if (r < (-(2LL<<30)) || r > ((2LL<<30)-1)) {
          fprintf (stderr, _("%s: %s: integer out of range\n"), cmd, "memsize");
          return -1;
        }
        /* The check above should ensure this assignment does not overflow. */
        memsize = r;
      }
    
    and like this for all Int64 arguments (note we don't need the
    range check for these):
    
      {
        strtol_error xerr;
        long long r;
    
        xerr = xstrtoll (argv[1], NULL, 0, &r, "");
        if (xerr != LONGINT_OK) {
          fprintf (stderr,
                   _("%s: %s: invalid integer parameter (%s returned %d)\n"),
                   cmd, "size", "xstrtoll", xerr);
          return -1;
        }
        size = r;
      }
    
    Note this also fixes an unrelated bug in guestfish handling of
    RBufferOut.  We were using 'fwrite' without checking the return
    value, and this could have caused silent failures, eg. in the case
    where there was not enough disk space to store the resulting file,
    or even if the program was interrupted (but continued) during the
    write.
    
    Replace this with Gnulib 'full-write', and check the return value
    and report errors.

commit 306077ac965cde0a5605782921d33a72bb77c382
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Jan 25 11:34:56 2010 +0000

    Add 'filesize' call.
    
    Returns the size of a file.  You can already do this with 'stat',
    but this call is good for scripting.

commit c9324c2025b2636cda243b71debcb6c6457c6001
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jan 21 10:54:34 2010 +0000

    Missing crc kernel module on RHEL 6 / Linux 2.6.32 (fixes RHBZ#557195)

commit 0c28fb1a520ac6dea018cf42e6e056fe439f2810
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jan 15 14:06:32 2010 +0000

    hivex: Various improvements in header parsing, thanks to better documentation.

commit f004c406e0ac78d7e70d13260f2eff7e0257b4d4
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jan 15 12:42:02 2010 +0000

    hivex: Print header fields.  Print all offsets in hex (in debug output).

commit ac8ee450dbe65990378ca9c13094b7187ae70b0d
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jan 15 12:41:34 2010 +0000

    hivex: Reenable checksum calculations, but don't check result.

commit add1be720e4f4abf95bec17eea346436c8d776c7
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jan 15 12:40:56 2010 +0000

    hivex: Update documentation.

commit 0221c671e4ce572c602f8576e82f89b4c02c6232
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jan 14 16:46:13 2010 +0000

    hivex: Send all debug messages to stderr.

commit fab4298b6361fa62ac649fb885b62cf4ce84ad1b
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jan 14 16:45:59 2010 +0000

    hivex: Remove stray debugging message.

commit d0507993a7c3b39c2c86323a79eb3f4bfd2d19fb
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jan 14 16:29:47 2010 +0000

    hivex: Documentation: Add environment variables section.

commit 949d6e79ad81db208e5181d01f01b736a271c1e5
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jan 14 16:29:40 2010 +0000

    hivex: Whitespace change.

commit 8df82f709ab65a0cd4b28f1e51e27aa9cc702481
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jan 14 16:21:47 2010 +0000

    hivex: Move STR* macros into C file.
    
    Don't pollute the public header file with these macros.

commit 80dc92b979249bd596d906c81c85ca614f14feea
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jan 14 13:26:46 2010 +0000

    hivex: Small updates to the documentation.

commit e28207d5ad7ed96e10467e38788239ef9690285e
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jan 13 14:55:04 2010 +0000

    Fix generation of HTML documentation for website.

commit 279c560c62deca26e633a1d10e9ae120b98cab0c
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jan 13 13:08:30 2010 +0000

    Add guestfs.pod and guestfish.pod to EXTRA_DIST.

commit 33ad9f02e17e8dbcbcf4a751315394e520569f14
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jan 13 13:03:28 2010 +0000

    Prepare for version 1.0.81.

commit 008cbfcc15aa051c2a84d20b3be4caaab77904ea
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jan 13 11:24:44 2010 +0000

    Update to latest Gnulib.

commit b4a4db522fed542f48aa60717e65061c5e83c919
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jan 7 12:21:42 2010 +0000

    qemu: Upstream regression of -stdio serial option.
    
    Best explained by the comment in the code:
    
        /* Newer versions of qemu (from around 2009/12) changed the
         * behaviour of monitors so that an implicit '-monitor stdio' is
         * assumed if we are in -nographic mode and there is no other
         * -monitor option.  Only a single stdio device is allowed, so
         * this broke the '-serial stdio' option.  There is a new flag
         * called -nodefaults which gets rid of all this default crud, so
         * let's use that to avoid this and any future surprises.
         */

commit ce68503d5c74585f7f4df8a9ad3d54f927dfbcad
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jan 6 09:55:57 2010 +0000

    inspector: Update example XML and RNG schema.
    
    This updates commit a59dcdbd1b0a28c960e3792165a13f2daf4f6c35.

commit a59dcdbd1b0a28c960e3792165a13f2daf4f6c35
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jan 5 23:04:57 2010 +0000

    inspector: Make RPM application data more specific (RHBZ#552718).
    
    List applications with epoch, release and arch data.
    
    If epoch is 0, don't store this as an empty string, but as
    undefined, and don't output empty <epoch/> element in the XML.

commit 5e180db9eefcd6b459b805c2215ba4d174e4eb83
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Jan 4 15:39:49 2010 +0000

    Use linker script to control visibility of symbols.

commit db430348cae9f99549a4f7e155a162e71fb9900d
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Jan 4 14:55:24 2010 +0000

    generator: Move all library generation code together.

commit a9666ce8bb5793bf725d8d6d18c5ce545bdaf4a4
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Jan 4 14:40:08 2010 +0000

    generator: Print total lines of generated code.

commit 70c853d67a0cd5e54c821cd08726b91174517221
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Jan 4 14:51:36 2010 +0000

    C#: Add documentation about experimental nature of these bindings.

commit c0e4b5dc693cefdc81a4ec7cc1073a2cae371803
Author: Richard Jones <rich@koneko.local>
Date:   Sat Jan 2 19:46:20 2010 +0000

    Experimental C# bindings.
    
    Tested in only limited situations, with Mono on Linux.

commit d3c615c2d6167e6f0ae4d23b2902ea08a66a11ae
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Jan 2 19:47:37 2010 +0000

    Update copyright years.

commit 8980c01b46eafcf4b5dc127e4696c2cbe1bff09f
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Dec 31 12:26:04 2009 +0000

    Move guestfs(3) and guestfish(1) man pages into subdirectories.
    
    These manual pages have for a very long time 'lived' in the top
    source directory.
    
    Clean up this situation by moving those manual pages (plus associated
    generated files) into the src/ and fish/ subdirectories respectively.

commit 500ab86509e819cdf9c379f0bf6f0076bdd2ab68
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Dec 31 12:16:10 2009 +0000

    generator: Move src/guestfs-bindtests.c next to other src/ files.

commit b177f05ed6e65a9fe1fddc6ca602edcb912ac363
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Dec 31 11:51:48 2009 +0000

    generator: Use Continuation Passing Style (CPS) in output_to function.
    
    This makes the code simpler, shorter and less error-prone.

commit de08dbc83037df26f48bdfda038531f457c192d9
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Dec 31 11:29:49 2009 +0000

    generator: Rename GPLv2 to GPLv2plus, LGPLv2 to LGPLv2plus.
    
    The licenses are "any later version", so reflect this in the
    naming of the parameter to generate_header.

commit 677e021225d05e92034a68cb9a9b487e5331d35d
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Dec 31 11:22:26 2009 +0000

    generated code: Set copyright years to 2009-xxxx when current year > 2009.

commit 2e2eb15df010bbcc605c86b0714ad1ca796fc96d
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Dec 31 11:20:56 2009 +0000

    Remove separate inspector_generator.ml, combine this with generator.ml.
    
    This commit combines the previously separate "inspector_generator.ml"
    program which generated bindings for virt-inspector.
    
    Having two separate programs caused no end of troubles for developers,
    so we now combine them into a single program.
    
    NOTE: OCaml xml-light is now *required* in order to rebuild the
    generated code.

commit 9ff1c97f04e8c0e513262893df71da0d31b34637
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Dec 31 10:52:08 2009 +0000

    generator: Comment and whitespace changes only.

commit 5c6147ecc7ee3cf657edb1e19ad5ab4e973424e0
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Dec 18 19:20:37 2009 +0000

    daemon: Work around udevsettle issue (RHBZ#548121).

commit b3c4ddc8634e8268b151dcbd7ddd35a7286f4f04
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Dec 16 11:53:48 2009 +0000

    Prepare for 1.0.80.

commit 168cdbebb6a4ed81cb2156057b0793487e854c4a
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Dec 16 11:57:51 2009 +0000

    Include latest Polish translations (Piotr Drąg, RHBZ#502533).

commit 1c0ab7ab954c01cac2c87425a4b027e44c80e645
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Dec 16 11:55:21 2009 +0000

    Update PO files.

commit ab100792a1fe13c3e8cc180c94a52c91f0493358
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Dec 16 11:54:53 2009 +0000

    build: Fix typo in filename.

commit 835c0186c8771bb1c850f6c82356f9c731323413
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Dec 16 11:53:30 2009 +0000

    build: Remove references to old contrib/ files which were removed.

commit 4b09663f01224c27f00376011022526437680078
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Dec 16 11:15:26 2009 +0000

    appliance: Special case handling for libbfd in the supermin appliance.
    
    The libbfd library has a constantly changing, non-standard and
    very long name, eg:
    
    /usr/lib64/libbfd-2.20.51.0.2-7.fc13.so
    
    Just add a special case to deal with this.  This fixes the guestfs_strings
    command, which relies on the external strings binary which uses this
    library.

commit 795cf46a03bbe6ca0cbbeb951b8aceaf6e29eaca
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Dec 16 11:04:10 2009 +0000

    appliance: Ignore unreadable dbus helper programs.

commit 3b0d91890da5244dd642a5e7e9fa07312851693d
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Dec 7 11:28:21 2009 +0000

    lib: Link with $(LTLIBTHREAD), required by Gnulib lock module.
    
    This fixes commit cada248a53858341c91f70392e8f5b6e47d9b4fe.

commit f025a9c41dca06452e03a7f0e55cda0b6764038c
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Dec 4 15:38:09 2009 +0000

    appliance: Fix code which gets list of kernels.
    
    The first 'ls' command was failing, so the second 'ls' command
    would never run at all.

commit 9e5fabbe01c0964f7124595beec01dde836d93a6
Author: Jim Meyering <jim@meyering.net>
Date:   Fri Dec 4 15:34:41 2009 +0000

    accommodate leading "+" in git submodule output
    
    * cfg.mk (_submodule_hash): Also filter out "+".
    * autogen.sh: Likewise.

commit cada248a53858341c91f70392e8f5b6e47d9b4fe
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Dec 4 14:35:55 2009 +0000

    lib: Add thread-safety to global list of handles.
    
    This commit uses the Gnulib 'lock' module to implement a mutex on
    the global list of handles which is stored by the library.
    
    Note that Gnulib nicely avoids explicitly linking with -lpthread
    unless the application program itself links to -lpthread.  Locks
    are only enabled in multithreaded applications.
    
    $ ldd src/.libs/libguestfs.so.0.217.0
    	linux-vdso.so.1 =>  (0x00007fffcb7ff000)
    	libc.so.6 => /lib64/libc.so.6 (0x00007f96a4e6c000)
    	/lib64/ld-linux-x86-64.so.2 (0x00007f96a544d000)
    
    Please enter the commit message for your changes. Lines starting

commit 983e7a23456f413394a254f3aa4dbee271a30c47
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Nov 30 14:11:20 2009 +0000

    daemon error handling: Define a new function reply_with_perror_errno.
    
    This allows you to save the errno from a previous call and
    pass it to reply_with_perror.
    
    For example, original code:
    
      r = some_system_call ();
      err = errno;
      do_cleanup ();
      errno = err;
      if (r == -1) {
        reply_with_perror ("failed");
        return -1;
      }
    
    can in future be changed to:
    
      r = some_system_call ();
      err = errno;
      do_cleanup ();
      if (r == -1) {
        reply_with_perror_errno (err, "failed");
        return -1;
      }

commit 4b4e0d0d07bd34f4368c6a213ff757d4ebf98411
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Nov 27 14:14:21 2009 +0000

    daemon error handling: recursive_mkdir shouldn't need to set errno.

commit 50c239c045675c7480d88bf10857f3e85c3385d3
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Nov 30 13:55:04 2009 +0000

    daemon error handling: Clear errno before calling stub functions.
    
    This just ensures that we accurately report errors, even if our
    error path code doesn't set errno.  We won't end up with a bogus
    errno left over from a previous call.

commit f02acc3d307f210d418a0177f374d02a4f8ccb5a
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Nov 27 13:42:43 2009 +0000

    Whitespace change.

commit 582b64a7b18d846e03d5ed2d24036d566b964124
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Nov 26 22:33:52 2009 +0000

    virt-rescue: Freshen documentation.

commit 47ecaa9ad4224803313ecc1d5b96def8eed3dac8
Author: Richard Jones <rich@koneko.home.annexia.org>
Date:   Thu Nov 26 22:32:15 2009 +0000

    guestfish: Freshen documentation.

commit 940ef864d02584720e3ef4f55d680fa3432ba508
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Nov 26 15:38:48 2009 +0000

    daemon: Move prototypes around to keep functions grouped logically.

commit bba019781a0df3744ccbfe9e580786b66dc9afa9
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Nov 26 16:06:03 2009 +0000

    Fix error handling in 'zero' function.

commit 4d53df4d7399d35b51bd69d76e00539d1de825e0
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Nov 26 15:17:37 2009 +0000

    daemon/Win32: Add contributed test script to test daemon using Wine.
    
    This test script allows you to test limited features of the
    Windows daemon by running it on a standard Fedora host using
    Wine.
    
    Read contrib/README and contrib/guestfsd-in-wine.sh in detail
    before using.

commit 115bc4b816ae5e203dff07070ddc8819585f38e5
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Nov 26 14:42:54 2009 +0000

    Ignore guestfsd.exe (Windows daemon).

commit 7a2f4dbbcbe89ea25aea255c4220a0e81eb7b956
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Nov 26 14:34:35 2009 +0000

    Remove old contrib/febootstrap directory.

commit f4845292fbed5560483aa5512af3a409c4f2f7a2
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Nov 26 14:26:44 2009 +0000

    Update PO files.

commit a86eb0e0d2c67e2153139c681632edc72162b8ed
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Nov 26 14:13:27 2009 +0000

    Make realpath call optional, disable it for Windows.

commit 6699491803962a5dee13997f1cc98f119d7101f4
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Nov 26 11:58:27 2009 +0000

    build: update gnulib submodule to latest

commit 9799810df94af7fa67dc23106b407ffed2dc0ec4
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Nov 26 13:23:56 2009 +0000

    daemon: program_name must be defined for Gnulib error module.

commit 15ebf328911fb6376376889c99029bcf2dbe0033
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Nov 26 11:52:28 2009 +0000

    daemon/Win32: use gnulib modules connect, socket and symlinkat (for readlinkat).

commit fd84feb8229f792e22e3cbfa9bf7e8156947eb2f
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Nov 26 11:26:40 2009 +0000

    daemon/Win32: provide htonl, htons, ntohl, ntohs functions.
    
    These functions are not available on Windows.

commit b76462f7433d064019382992163e3553c7906ee7
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Nov 26 11:13:00 2009 +0000

    daemon/Win32: Use Gnulib perror module.

commit 929ba5a843722ab490dd6c8d6f38daf0a1858533
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Nov 26 11:01:01 2009 +0000

    daemon: Link guestfs_protocol.[ch] into the daemon directory.
    
    Instead of doing a recursive call into the src/ directory to build
    the object files, hard link the source files into the daemon
    directory and build them separately.
    
    See:
    http://www.redhat.com/archives/libguestfs/2009-November/msg00254.html
    
    Thanks to Jim Meyering for noticing a typo in the original version.

commit 12f3e9780f2f35f6b81da8eb90ff24dd9ac93253
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Nov 26 10:52:37 2009 +0000

    daemon: Typo generator_build -> generator_built

commit 8e33cd5f2f2e7e30525cb2a70d86de70e3d6a4f9
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Nov 26 09:31:35 2009 +0000

    daemon: Indent C macros to reflect nesting level.

commit fcae398873453d0542123e040b388c3be10b14f8
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Nov 26 09:29:02 2009 +0000

    daemon/Win32: Win32 can't fork message moved to separate function (Jim Meyering)

commit 0a302b78780bad541debf3d3c2f46ad42afecef3
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 25 22:20:22 2009 +0000

    guestfs documentation: Missing space.

commit 8504318756597061bc37de20147367fc5615d6ed
Author: Richard Jones <rich@koneko.home.annexia.org>
Date:   Wed Nov 25 21:41:51 2009 +0000

    guestfs: Update architecture section of documentation.

commit d32cf866981ff7287d480c97fdddaa59bcc0e9c7
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 25 17:12:00 2009 +0000

    Update PO files.

commit fafd87038bdbca159b67efa6ee1b52861daed1f4
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 25 17:10:33 2009 +0000

    daemon: Fix build on Unix.

commit 34ac5d7b7ad068319169410d293495d789893350
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 25 16:54:46 2009 +0000

    daemon: Fix sync() call on Unix.

commit b854ff35a3c8e077e7c021aca3a604f11123d101
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 25 16:33:00 2009 +0000

    daemon/Win32: update comment

commit ed08d34eb6aa5c8fa6d9fba52012da9eb793421d
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 25 15:00:19 2009 +0000

    daemon/Win32: Supply MAX macro for challenged platforms.

commit 8d0d8cd4a340dea6fd3d84ab5b361aa757d5e19e
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 25 14:59:30 2009 +0000

    daemon/Win32: Windows can't daemonize.

commit ea99d9ec56e52758ea0d9f01a605fbc51ec95fba
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 25 14:56:42 2009 +0000

    daemon/Win32: Windows replacement for umask.

commit 33bc8fb6d25143ebba54f34c8ea6f5841a71f3e5
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 25 14:53:17 2009 +0000

    daemon/Win32: Replace setenv with Win32 equivalent.

commit 55355491c5ad2535b99a31ec81241f7f9f92177e
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 25 14:45:20 2009 +0000

    daemon/Win32: Use xdr_u_int for PortableXDR compatibility.
    
    PortableXDR didn't support xdr_uint32_t.  xdr_u_int is the same type.

commit b884456237b71e1a39fae3fc60f5a168b020cd6b
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 25 14:40:52 2009 +0000

    daemon/Win32: Don't bother blocking SIGPIPE on Win32.

commit b20a0916d8711fd3fb448dc5d4febee9d7a6331c
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 25 14:40:39 2009 +0000

    daemon/Win32: Use gnulib getaddrinfo module.

commit 579465ec1f4fdb1789bf94ac7356a3c961f3ae93
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 25 13:07:05 2009 +0000

    daemon/Win32: Implement statvfs using GetDiskFreeSpaceEx.
    
    At the time of writing Gnulib didn't support Win32 for its
    fsusage API.  Therefore this patch uses GetDiskFreeSpaceEx
    if it's available (on Windows) otherwise falls back to using
    Gnulib fsusage.

commit 63516f39a0b1381ef3d06d9eb55141bf6c4466b0
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 25 12:24:01 2009 +0000

    daemon: Move statvfs code into separate file.
    
    This makes no functional change to the code.  It just moves the
    statvfs-related code out of daemon/stat.c into a new file called
    daemon/statvfs.c.

commit b3035e8d7c04a71d9a54ab7e52bc9e169ecf0b47
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 25 12:17:10 2009 +0000

    daemon: Use gnulib futimens module.
    
    Instead of checking for futimens support and falling back
    (incorrectly in one case) to using futimes, use gnulib's
    module.
    
    However the gnulib module does not yet support Win32, so
    this change is only really useful on platforms like RHEL 5.

commit 25081d62684eea9e704ecc0a0a15d2421b203356
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 25 11:59:20 2009 +0000

    daemon/Win32: Use gnulib pread module.

commit fdbc5aa711dde73eb448fbe13165c00a44272d00
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 25 10:26:48 2009 +0000

    sync: Windows implementation of sync() call.
    
    Replace calls to sync() with calls to sync_disks() which supports
    Win32 via FlushFileBuffers.

commit c2aad5cd929a9932c010d045462bd923162fb593
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 24 16:16:08 2009 +0000

    daemon: Alternate implementation of posix_fallocate.
    
    If the posix_fallocate function is not available [ie. Windows]
    use an alternate implementation that just loops and writes.

commit a9519654032d2f09e76870d5d04dae2dff752c5b
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 24 16:10:13 2009 +0000

    dd: Missing include of <string.h>
    
    Breaks compilation on Windows.

commit 34d5df70d858e02ae6adc6537e1a6ea2df938238
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 25 11:38:44 2009 +0000

    daemon/Windows: Define _WIN32_WINNT when compiling on Windows.

commit 62d6ae454f1f75b2a8dc29e681586db73884cd08
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 25 16:24:49 2009 +0000

    build: update gnulib submodule to latest

commit 65ab9e660b0bf38ec644bc36641f2a1de4aa1699
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 25 15:29:39 2009 +0000

    build: update gnulib submodule to latest

commit 4404688aa3b476c820ef6ed6bea7e855f0a53e90
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 24 18:17:07 2009 +0000

    supermin: Die with an error if no kernels found (RHBZ#539746).
    
    Updated with a suggestion from Jim Meyering to use the '-d'
    option to ls to avoid a future case of directories matching.

commit 299d5b9dd260d47ac5121126ecd0e3f7bc4830b5
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 24 15:19:08 2009 +0000

    New tool: virt-list-filesystems
    
    Use this program as a convenient way to list the filesystems
    available in a disk image or libvirt guest.
    
    Example:
    
      $ virt-list-filesystems /dev/vg_trick/Debian5x64
      /dev/debian5x64/home
      /dev/debian5x64/root
      /dev/debian5x64/tmp
      /dev/debian5x64/usr
      /dev/debian5x64/var
      /dev/sda1
    
    This is designed to make it easier for novices to use guestfish
    and guestmount.  In particular with guestmount this acts as a way
    to get a list of filesystems to use with the '-m' option.  ie:
    
      $ virt-list-filesystems unknowndisk.img
      /dev/sda1
      /dev/sda2
      $ guestmount -a unknowndisk.img -m /dev/sda1 /mnt

commit 9b6185b9bf8147e20563608b23eaafce9c5edc2f
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 24 14:27:56 2009 +0000

    availability: Document how to check for single API calls
    
    This documents how to use autotools and dlopen(3) to test for
    the availability of single API calls at compile time and run time
    respectively.

commit 979eda8a5d3ad5cd9a8fe95159258afd681307f7
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 24 14:05:57 2009 +0000

    availability: Add a test for this call.
    
    Because all the tested groups are optional, there's not really
    a group we can reliably test, therefore test against the
    empty list (which should not fail).

commit 3817708a5b182e8c170e653eb383961a34e30245
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 24 14:00:34 2009 +0000

    availability: Clarify and fix documentation.

commit b017cd67bb56284d05fc168d2b3536bee55b9ebf
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 24 14:04:28 2009 +0000

    generator: Passing "" to StringList tests should turn into empty list.
    
    This is a bug in the generator which wasn't being tickled.  If
    you had a test which expected a StringList or DeviceList parameter,
    and you passed "" to that test, then you'd (probably) expect to be
    testing an empty list, but in fact you got a single element list
    containing an empty string.  This fixes it so you get an empty list.

commit 6b2c7a23b6c2d81c9e1825e8eb88ab446f63bf94
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 24 16:00:23 2009 +0000

    daemon: Fix return value from aug_defnode.
    
    Bug fix - the return value from this function was wrong
    in the no-Augeas case.

commit 22e531bc459309d9a871a845cfacd1396ff5b7e4
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Nov 22 19:15:56 2009 +0000

    Implement 'dd' command.

commit acdcbac91e9f03333a47204f2a6c52ac03288305
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Nov 22 19:14:48 2009 +0000

    Use STRPREFIX instead of STREQLEN.

commit e496f30dc5fbfd2452f192b1f2c8dcfa075a55ed
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Nov 22 19:14:19 2009 +0000

    generator: second parameter to upload is Dev_or_Path, not String.

commit a7a88083f0c9d83828dc9154c1c053fcd735d9ba
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Nov 20 18:45:22 2009 +0000

    build: Add missing dependencies in perl directory
    
    make all in the perl directory was missing a check that the library had been
    built.
    
    make check in the perl directory was missing a check that the appliance and test
    images had been built.

commit 1b60344e672e4fc233d7fe6b8ecfcda46a40f4d5
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Nov 20 18:43:20 2009 +0000

    build: Ensure building appliance depends on guestfsd
    
    Previously, only the update.sh rule checked the daemon had been built. update.sh
    is called directly from within make.sh, so in that path the dependency was never
    checked. This adds the daemon dependency explicitly to the rebuild-from-scratch
    path.

commit 1befbee8b8c00026a2f98ab7bc1ed4ca67083042
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Nov 20 18:05:49 2009 +0000

    build: Don't re-check generator.ml for each generator_built in daemon directory

commit 8b135cb5527616d5bc0c829ac9633d511af86766
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Nov 20 17:52:27 2009 +0000

    build: Rebuild the daemon as necessary from other directories
    
    This change ensure that making the appliance will always rebuild the daemon if
    required.

commit d49890d5bca89f87d4e75017fd4f9ba4deb55edb
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Nov 21 21:11:44 2009 +0000

    Update TODO file.

commit 6ce12286729395250fca86eebdfcaaf8aca69f33
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Nov 20 18:20:28 2009 +0000

    perl: Add Sys::Guestfs::Lib::feature_available
    
    This is a nicer Perl wrapper around $g->available call.
    
    Update the other code in Sys::Guestfs::Lib to use it before using
    LVM, Augeas.

commit 64de216ac7b6ef94f801e214a989c578f26956e8
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Nov 20 16:32:53 2009 +0000

    availability: Skip tests when functions are not available.

commit 2d9953097b6d3b71122d444a4550047e97aee009
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Nov 20 14:10:06 2009 +0000

    availability: Add optional groups and implement guestfs_available call.
    
    The current groups are defined very conservatively using the
    following criteria:
     (a) Would be impossible to implement on Windows because of
         sheer architectural differences (eg: mknod).
     (b) Already optional (augeas, inotify).
     (c) Not currently optional but not implemented on older RHEL and
         Debian releases (ntfs-3g.probe, scrub, zerofree).
    
    The optional groups I've defined according to these criteria are:
    
     . augeas
     . inotify
     . linuxfsuuid
     . linuxmodules
     . linuxxattrs
     . lvm2
     . mknod
     . ntfs3g
     . scrub
     . selinux
     . zerofree
    
    (Note that these choices don't prevent us from adding more
    optional groups in future.  On the other hand to avoid breaking
    ABIs we would not wish to change the above groups).
    
    The rest of this large commit is really just implementation:
    
    Each optional function is classified using Optional "group"
    flag in the generator.
    
    The daemon has to implement a function
    
      int optgroup_<name>_available (void);
    
    for each optional group.  Some of these functions are fixed at
    compile time, and some do simple run-time tests.
    
    The do_available implementation in the daemon looks up the correct
    function in a table and runs it.
    
    We document the optional groups in the guestfs(3) man page.
    
    Also: I added a NOT_AVAILABLE macro in order to unify all the
    existing places where we had a message equivalent to
    "function __func__ is not available".

commit 8fd7f255d611d2092a244c4a48c6b7b4529e98b1
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Nov 20 13:06:49 2009 +0000

    availability: Add guestfs_available.
    
    Start a new API allowing groups of functions to be tested for
    availability.
    
    There are two reasons for this:
    
    (1) If libguestfs is built with missing dependencies (eg. no Augeas lib)
    then the corresponding functions are disabled in the appliance.  Up till
    now there has been no way to test for this except to speculatively
    issue commands and check for errors.
    
    (2) When we port the daemon to Win32 it is likely that major pieces of
    functionality won't be available (eg. LVM support).  This API gives
    a way to test for that.
    
    There is no change for existing clients: you still have to check for
    errors from individual API calls.
    
    For new clients, you will be able to test for availability of particular
    APIs.
    
    Usage scenario (A): An LVM editing tool which requires
    both the LVM API and inotify in order to function at all:
    
      char *apis[] = { "inotify", "lvm2", NULL };
      r = guestfs_available (g, apis);
      if (r == -1) {
        /* print an error and exit */
      }
    
    Usage scenario (B): A general purpose tool which optionally provides
    configuration file editing, but this can be disabled, the result
    merely being reduced functionality:
    
      char *apis[] = { "augeas", NULL };
      r = guestfs_available (g, apis);
      enable_config_edit_menus = r == 0;

commit 5c9004347fe5920e2d0aa905ec709a514f0d9e38
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Nov 20 11:48:51 2009 +0000

    daemon/Win32: Use gnulib modules for first porting to Win32.

commit 03cd3050b342cecbc6f657e85637d1d16dbc60ab
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Nov 20 16:48:38 2009 +0000

    build: Add missing dependency libguestfs.la->guestfs_protocol.h

commit e1b48287ebd6143ba516e427772dca04b4b8c75d
Author: Jim Meyering <jim@meyering.net>
Date:   Fri Nov 20 16:25:00 2009 +0100

    build: correct sed transformation to work also on .git-module-status
    
    My patch was wrong.
    I kept the sed transformation the same in the two places,
    but it wasn't strict enough to also work on the file contents.
    Sorry about that.  This fixes it.
    
    >From 93927cc7b9f63c414e5bfeb7eba393fde3295601 Mon Sep 17 00:00:00 2001
    From: Jim Meyering <meyering@redhat.com>
    Date: Fri, 20 Nov 2009 16:23:17 +0100
    Subject: [PATCH libguestfs] build: correct sed transformation to work also on .git-module-status
    
    * autogen.sh: Use a more strict sed transformation so it works also
    on the contents of .git-module-status, which has no prefix.
    * cfg.mk (_submodule_hash): Use a stricter sed regexp.

commit 1b4bab6db252abcc3daab11159b0e45862c10b4c
Author: Jim Meyering <jim@meyering.net>
Date:   Fri Nov 20 14:30:57 2009 +0100

    build: make autogen.sh update .git-module-status, as it should
    
    I ran autogen.sh, but then make was always failing like this:
    
        $ make
        cfg.mk:141: *** gnulib update required; run ./autogen.sh first.  Stop.
    
    Here's the fix:
    
    >From f743f32079fea2e8a17c7f5b59305e584c75dba0 Mon Sep 17 00:00:00 2001
    From: Jim Meyering <meyering@redhat.com>
    Date: Fri, 20 Nov 2009 14:29:55 +0100
    Subject: [PATCH libguestfs] build: make autogen.sh update .git-module-status, as it should
    
    * autogen.sh: Without this, "make" would always say "gnulib update
    required; run ./autogen.sh first", even after you'd run autogen.sh
    successfully.

commit a84dee0f8df3c5d6ef3ecd5423f6bed3086419ac
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Nov 20 12:18:06 2009 +0100

    maint: use EXIT_* symbol (not constant, 2) to indicate key/path not found
    
    * hivex/hivexget.c (EXIT_NOT_FOUND): Define.
    (main): Use exit (EXIT_NOT_FOUND), not "exit (2)".

commit 4d45c45f0928c7791429d351dc69b75167888f7d
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Nov 20 12:15:14 2009 +0100

    maint: use EXIT_SUCCESS and EXIT_FAILURE, not 0 and 1 in "usage", too
    
    Convert by running these commands:
    perl -pi -e 's/\b(usage ?)\(1\)/$1(EXIT_FAILURE)/' \
      fish/fish.c fuse/guestmount.c
    perl -pi -e 's/\b(usage ?)\(0\)/$1(EXIT_SUCCESS)/' \
      fish/fish.c fuse/guestmount.c
    * fish/fish.c (main): Replace 0/1 with EXIT_SUCCESS/EXIT_FAILURE.
    * fuse/guestmount.c (main): Likewise.

commit c372c7c23a298a940b8a0868396ef2ae0d824e4d
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Nov 20 12:09:42 2009 +0100

    maint: use EXIT_SUCCESS and EXIT_FAILURE, not 0 and 1 to exit
    
    Convert all uses automatically, via these two commands:
    git grep -l '\<exit *(1)' \
      | grep -vEf .x-sc_prohibit_magic_number_exit \
      | xargs --no-run-if-empty \
        perl -pi -e 's/\b(exit ?)\(1\)/$1(EXIT_FAILURE)/'
    git grep -l '\<exit *(0)' \
      | grep -vEf .x-sc_prohibit_magic_number_exit \
      | xargs --no-run-if-empty \
      perl -pi -e 's/\b(exit ?)\(0\)/$1(EXIT_SUCCESS)/'
    * .x-sc_prohibit_magic_number_exit: New file.
    
    Edit (RWMJ): Don't change Java code.

commit e94f89f40d989d111882178c87b5bfc22314fca8
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Nov 20 11:50:54 2009 +0100

    maint: remove unnecessary include of openat.h
    
    * daemon/realpath.c: Don't include "openat.h".  not used.

commit 4e9fefd4e894e96e71934055958caeac441664b7
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Nov 20 10:44:38 2009 +0000

    build: update gnulib submodule to latest

commit 0d5b38f1d957609f3f96739507f491a6672f01d5
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Nov 20 10:43:45 2009 +0000

    daemon/gnulib: Include glob module.

commit 295a920f52911c4220dc51245f0cf9d0d2c41241
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Nov 20 10:41:07 2009 +0000

    daemon/Win32: Don't include missing headers.
    
    This is a partial fix for code in guestfsd.c where many of these
    header files are missing on Win32.

commit edb9b3abc03c0a0f84b1cbd9cf5920e3c84e5c18
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Nov 20 10:38:07 2009 +0000

    daemon/Win32: make some functions and fields optional.
    
    inotify: Make this optional on platforms that don't have this interface.
    
    mknod, mkfifo etc.: Make these optional on non-Unix platforms.
    
    readdir: If d_type field is missing on the platform, set the corresponding
    field to 'u'.
    
    stat: st_blocks and st_blksize are missing on non-Unix platforms, so
    set these fields to -1 in the corresponding structures.

commit 7d8a3404b27fcd71f84dbe4c022c4435d0070d6b
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Nov 20 10:36:59 2009 +0000

    daemon/Win32: NAME_MAX does not exist on Windows, use FILENAME_MAX instead.

commit 688bdc1a068a6c0bea58addd04d5bbe6dc1940c4
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Nov 20 10:36:21 2009 +0000

    daemon: Missing #includes revealed by cross-compiling.

commit 4d35cc2ff0589e786b0194b9cfdf3aa7b01f6b29
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Nov 20 10:33:27 2009 +0000

    daemon/Win32: Ignore mingw32-config.cache.
    
    The Fedora Windows cross-compiler 'mingw32-configure' script always
    uses a configure cache.  Ignore that file.

commit a216a8adaaf99021ec2f9b6c3eb2c4074252bbb4
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Nov 19 17:01:53 2009 +0000

    generator: open Unix module by default.
    
    Add:
    
      open Unix
    
    at the top of the generator, which means that we don't need to
    prefix any 'Unix.foo' symbols (we can just use 'foo' instead).
    
    Unfortunately the Unix module shadows one symbol in Pervasives
    (the Pervasives module is opened by default in OCaml code).  That
    symbol is 'stdout'.  So we replace this with 'Pervasives.stdout'
    in two places.  Still a net reduction in code size.

commit 986541c26ddeec7583cfb41412d4edaef60703a2
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Nov 19 16:59:56 2009 +0000

    syntax-check: Fix tab-vs-space issue in the generator.

commit b7423df56e12180df27dfc033ed2e4eae1f0175c
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Nov 19 16:50:19 2009 +0000

    Update PO files.

commit 3d05963f9e0fd2229e04e0add391a4cbcdf8d86c
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Nov 19 16:50:04 2009 +0000

    Update TODO file.

commit 8b3e75a3c78064a9dcf4952c50fe631442313743
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Nov 19 16:10:01 2009 +0000

    build: Fix parallel build of haskell bindings
    
    ghc isn't clever enough not to stomp on itself when building dependencies. This
    change makes the 1 dependency explicit.
    
    It also adds a dependency on src/libguestfs.la.

commit c477e2fb78347728aaacbbc89666dcda1481a4b9
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Nov 19 16:10:00 2009 +0000

    build: Fix inter-directory dependencies
    
    This change adds an explicit dependency on generator.ml for every file it
    generates, except java files. Java is left for another time because it's
    considerably trickier.
    
    It also adds a build rule for src/libguestfs.la so it can be rebuilt as required
    from other directories.
    
    It does this by creating a top level make file, subdir-rules.mk, which can be
    included from sub-directories. sub-directories need to define 'generator_built'
    to include local files which are built by generator.ml, and they will be updated
    automatically.
    
    This fixes parallel make, and will automatically re-create generated files when
    make is run from any directory.
    
    It also fixes the problem which efad4f53 was targetting. Specifically,
    src/guestfs_protocol.(c|h) had an erroneous dependency on stamp-generator, and
    therefore generator.ml, despite not being directly created by it. This caused
    them to be recreated every time generator.ml ran rather than only when
    src/guestfs_protocol.x was updated, which cascaded into a daemon and therefore
    appliance update.
    
    This patch also changes the contents of the distribution tarball by including
    files created by rpcgen.

commit 16c1b3164698900f52294e1396542ddd94a4cae4
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Nov 19 13:48:59 2009 +0000

    generator: Acquire lock to prevent two parallel runs of the generator.
    
    This commit acquires a lock on a file to prevent two parallel runs of
    the generator from stomping on each other.  The second run will wait
    for the first to complete before starting.
    
    The lock is acquired on the "HACKING" file because it's convenient --
    we are already checking this file exists to make sure that we don't
    start off in the wrong directory.
    
    Tested by adding some artificial sleeps in the code to observe
    locking behaviour between two parallel runs.

commit 60d020d363ec49a547fe047ac2f9bd88c8efcd5c
Author: Jim Meyering <jim@meyering.net>
Date:   Thu Nov 19 11:41:50 2009 +0100

    syntax-check: expand TABs in generator.ml
    
    Jim Meyering wrote:
    >>From 6f128e90afb055f9899011c4a592eb289e678936 Mon Sep 17 00:00:00 2001
    > From: Jim Meyering <meyering@redhat.com>
    > Date: Thu, 19 Nov 2009 11:39:10 +0100
    > Subject: [PATCH libguestfs] syntax-check: expand TABs in generator.ml
    >
    > * src/generator.ml: Expand leading TABs to spaces.
    
    That was incomplete.
    Please use the following instead.
    With it, now, "make syntax-check" now passes once again.
    
    >From 716a30d0b692972aac8fbea1fb7ad3318ab3a0d8 Mon Sep 17 00:00:00 2001
    From: Jim Meyering <meyering@redhat.com>
    Date: Thu, 19 Nov 2009 11:39:10 +0100
    Subject: [PATCH libguestfs] syntax-check: expand leading TABs
    
    * src/generator.ml: Expand leading TABs to spaces.
    * fuse/test-fuse.sh: Likewise.

commit f4619c24e2a5cceaf030ee015a5c005b5a84280c
Author: Jim Meyering <meyering@redhat.com>
Date:   Thu Nov 19 11:37:13 2009 +0100

    syntax-check: exempt *.pod from no-trailing-blank prohibition
    
    * .x-sc_trailing_blank: Exempt *.pod.

commit 44097b509c8fa665f8391e393025599a026cddac
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 18 17:41:41 2009 +0000

    BUILT_SOURCES now depends on running the generator.
    
    This completely reverts commit efad4f53923dcca94613e193d6383bd032e70498.

commit 9c75b1554b5121a7d2b24b99badd1333769a9555
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Wed Nov 18 16:02:53 2009 +0000

    daemon/RHEL: Choose correct udev settle script.
    
    On RHEL/CentOS 5.4, udevadm settle command does not work.  This didn't
    affect us before, but now that we're using parted for partitioning, we
    *do* need to wait for udev to settle (because parted isn't waiting for
    this, unlike sfdisk).
    
    This commit chooses the correct program to run.

commit 83eb2cf2fddbe3e06f50c18d5e651853f8d86813
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Wed Nov 18 16:01:23 2009 +0000

    fuse/RHEL: Don't require UTIME_{NOW,OMIT} to be defined.
    
    These macros don't exist on RHEL/CentOS 5.4.  If the feature
    is missing then just don't implement it in the FUSE layer.

commit 09d7b265e6a0b78592b0a8cc78d9382fd5cb680b
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 18 17:31:08 2009 +0000

    appliance: Print uptime.
    
    Print the uptime just before the init script runs the daemon, so we
    have a good idea of how long the kernel boot + init script takes to run.

commit 9473e8f72d1a7db0561e59f01c2dd45630c0a107
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 18 14:11:25 2009 +0000

    recipes: Fix git URL.

commit 52390cde840925d4f7e194fcafa7963ad7a2ec04
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 18 13:40:32 2009 +0000

    Prepare for version 1.0.79.

commit 4ffd4d460bd4b239ea9bcb60fbd225a7d37cb200
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 18 13:40:04 2009 +0000

    fuse: Add test-fuse.sh to EXTRA_DIST.

commit f5a3da14837fe65eab1df41df33f2bafeddcd9ce
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 18 10:37:10 2009 +0000

    generator: Fix API of functions that return RBufferOut
    
    (NB: The API / ABI doesn't actually change here - it's just made much
    simpler to use).
    
    The API for RBufferOut functions was unexpectedly hard to use in the
    case where a zero-length buffer might be returned.  For discussion on
    this see:
    
    https://www.redhat.com/archives/libguestfs/2009-November/thread.html#00115
    
    This commit ensures that in the zero-length buffer case, the return
    value is never NULL.  Thus code is now able to just check if the return
    value == NULL to indicate an error, which is simpler for all concerned.
    
    The implementation of this is, however, more complex because we have
    to be careful about this case inside both the daemon and the library
    code, which is what this commit does.
    
    This has passed a full round of tests.

commit 5c2da21b2ae56adc16bbd5bf9740a04ca70f9f19
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 17 17:03:31 2009 +0000

    fuse: Add tests for guestmount.
    
    This script contains non-exhaustive tests for the system calls
    implemented by guestmount.

commit 336275ee6dbff5efa2152a4f67ef354b81d15d59
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 17 17:02:45 2009 +0000

    fuse: Fix read for empty files.
    
    Error handling for the guestfs_pread call was incorrect, which
    meant that empty files could produce spurious error messages.

commit 3fc9951016d08e2467375e24094a468713637c1f
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 17 20:00:17 2009 +0000

    fish: Improve output of guestfish -h cmd
    
    Display this output like a short manual page.
    
    Don't put <..> around the parameters to the command.

commit 540c85a1102c5876265502f8ae287ea697834d20
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 17 19:51:29 2009 +0000

    New API call: fill - fill a file with octets

commit dcd08dd356ca361703f4f2a2e25b639b219ac40d
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 17 17:01:19 2009 +0000

    fuse: Fix cache invalidation in rename operation.
    
    We need to invalidate both parameters, otherwise the old (moved)
    file can appear that it still exists after the move.

commit a15f118e3b2221e68732ad0545f770b3324d593b
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 17 17:02:15 2009 +0000

    fuse: Fix hard link creation.
    
    The parameters were swapped.  We also need to invalidate the
    cache for both parameters.

commit 366339d41bc9af9d529f2118e1c971c49089d432
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 17 16:59:52 2009 +0000

    fuse: Fix symlink creation (RHBZ#538069).
    
    The parameters were swapped, preventing symlinks from being created.

commit dda10cd9357169d5c55d9d49e270a6202971b8c0
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 17 14:21:54 2009 +0000

    virt-df: Ignore domains which have ID 0.
    
    This is the remainder of the fix for RHBZ#538041.  Domains
    which have ID 0 are special domains.  libvirt defines it as
    the "control plane OS".  Only Xen and HyperV have this
    behaviour, and in both cases we should ignore those domains
    for the purposes of virt-df (user can just run "df" if they
    need that information for the dom0).

commit 9004f3c5302fbb70212ccc420b863c9a3ca75abf
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 17 14:09:58 2009 +0000

    virt-df: Turn errors into warnings when listing all domains.
    
    This is a partial fix for RHBZ#538041.  When listing all domains,
    don't die just because one domain fails, but keep trying for the
    rest.

commit 15de7e0d8d1529803a4c11168a86a05800e0ac13
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 13 22:23:08 2009 +0000

    Docs: copyediting

commit 5f9be62e68b120f51c948404e7f0cf3430962c68
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 13 16:36:04 2009 +0000

    Docs: Add documentation about other language bindings to API overview.

commit b296287daf9b884aa38646717725f5a389f96ca5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 13 16:35:51 2009 +0000

    Docs: line folding in example.

commit 747eb7138ada2c999abc686fc5de18bcad96a1b7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 13 15:57:32 2009 +0000

    Docs: group preformatted sections of text together.

commit 259f78cfa70af5505b8172bb81a3d1e2d7581bb5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 13 15:09:10 2009 +0000

    Docs typo: limited -> limits

commit c2cbf9cd082e2cca69481e31ebd9bafda879fa22
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 13 14:47:32 2009 +0000

    Docs: Add section on using multiple threads.
    
    This section was missing from the previous documentation.

commit 38d8943009e3a637e56af6adb43f6c12a7a357c7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 13 14:13:31 2009 +0000

    Docs: Add/extend API overview.

commit 407f34901361f6d68bca96543042b01581257485
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 13 12:15:09 2009 +0000

    Docs: Remove incorrect statement from man page.
    
    The low-level event-based API never existed so this statement
    in the man page is wrong.  If you want an asynchronous API, use
    threads.

commit 825d855b225c7c76371c72eae4d505a32c374007
Author: Jim Meyering <meyering@redhat.com>
Date:   Thu Nov 12 11:34:08 2009 +0100

    build: revive the ocaml package tests
    
    * autogen.sh: Generalize the ocaml-package-existence test.
    Remove the git-related part of the old test.

commit a6832406fabf251ba89ed91a9f23624fa16f977f
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Nov 11 13:50:24 2009 +0000

    Generate guestfs_protocol.x when stamp-generator updates
    
    This partially reverts efad4f53923dcca94613e193d6383bd032e70498.
    guestfs_protocol.x wasn't being generated when building from a clean checkout.

commit 62288e7118733ee433313267d44133ab5ce4b647
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 11 13:40:04 2009 +0000

    autogen.sh: Remove test for ocaml etc from this script.
    
    This test seems to cause a lot of trouble.  We need to go back to
    the drawing-board on this one.

commit cc9b2e30e5f6d6e77c60e3f501969c4a478899da
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 11 10:55:26 2009 +0000

    Set cpio blocksize to 64K.
    
    See:
    https://www.redhat.com/archives/fedora-devel-list/2009-November/thread.html#00523

commit a11927340db33ae00c41abbb96f91ecff0b3772f
Author: Richard Jones <rjones@debian5x64.home.annexia.org>
Date:   Tue Nov 10 19:12:46 2009 +0000

    Debian: don't depend on gfs-tools since these have depsolving problems.

commit b0c050c7de5b8f834ee9c8328bef843ed385749d
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 10 18:45:13 2009 +0000

    Update PO files for release.

commit 3ca69d9db34ebb31eba7b370ffe25a6178c83449
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 10 18:38:54 2009 +0000

    Check for ocaml-xml-light-devel (xml-light.cmxa)
    
    Also unquote $pkg since OCaml package names can never contain
    spaces or other unfriendly characters.

commit 61a1449b79e304bb8619e0781ec22cb600bedc01
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 10 18:23:52 2009 +0000

    Prepare for version 1.0.78

commit bdfb1bddffa48cfb486331166b8aed91637cb0d6
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Nov 10 18:49:42 2009 +0100

    tell "make syntax-check" that examples/to-xml.c is exempt from some tests
    
    * .x-sc_prohibit_strcmp: Exempt examples/to-xml.c.
    * .x-sc_prohibit_strcmp_and_strncmp: Likewise.

commit ae4589f17b0123044e3b27ebb8e14bc6f539c23c
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 10 17:09:54 2009 +0000

    examples: Don't use STREQ etc in the to-xml.c example.

commit ade327a7af869d4d70e28e2a596473943e0299dd
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 10 17:09:12 2009 +0000

    Don't export STREQ and friends in <guestfs.h>
    
    Move these to private header file(s) and other places as required
    since these aren't part of the public API.

commit 3833ddc6566f92783dc5a8894383c304e3d2c0b4
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 10 16:46:31 2009 +0000

    Fix problems found by 'make syntax check'

commit da33feca279d8feea3cd4b290c0d62c011f30d61
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Nov 9 14:42:55 2009 +0000

    Print timestamped messages during appliance launch.
    
    In verbose mode, print timestamped messages during guestfs_launch
    so we can see how long each step takes.

commit 3ae742c1498b8839250be295173d76b9c5731ed1
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Nov 9 14:16:21 2009 +0000

    Record time of guest launch.
    
    The guest handle field start_t was previously used (when we
    had the wait_ready call), but had fallen into disuse.  Note
    that it could never be accessed through the API.
    
    Rename this field as launch_t, convert it to a timeval, and
    use it to measure the time since guestfs_launch was called
    so that we can start profiling guest launch.

commit 28d74ee234bebaab552a662eb0700a36413b68b5
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Nov 9 14:15:43 2009 +0000

    appliance: Prefix kernel messages with timestamp.

commit b1e1ca2f74a921b3f784537d59c617df29ea1d60
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 4 23:15:26 2009 +0000

    Generic partition creation interface.
    
    This commit introduces a generic partition creation interface
    which should be future-proof and extensible, and partially
    replaces the old sfdisk-based interface.
    
    The implementation is based on parted but is hopefully not too
    dependent on the particulars of parted.
    
    The following new calls are introduced:
    
      guestfs_part_init:
        Initialize a disk with a partition table.  Unlike the sfdisk-
        based interface, we also support GPT and other partition
        types, which is essential to scale to devices larger than 2TB.
    
      guestfs_part_add: Add a partition to an existing disk.
    
      guestfs_part_disk:
        Convenience function which combines part_init & part_add,
        creating a single partition that covers the whole disk.
    
      guestfs_part_set_bootable:
      guestfs_part_set_name:
        Set various aspects of existing partitions.
    
      guestfs_part_list:
        List partitions on a device.  This returns a programming-friendly
        list of partition structs (in contrast to sfdisk-l which cannot
        be parsed).
    
      guestfs_part_get_parttype:
        Return the partition table type, eg. "msdos" or "gpt".
    
    The following calls are planned, but not added currently:
    
      guestfs_part_get_bootable
      guestfs_part_get_name
      guestfs_part_set_type
      guestfs_part_get_type

commit b03995b67f9bc23d066b282bb7dad9b7c71c90da
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 10 11:41:39 2009 +0000

    Add ata_piix to kernel module whitelist (RHBZ#533886).

commit aa4fffd512faf302bacfef70c4f1f81f64820a66
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 10 12:34:27 2009 +0000

    Fix compilation if readline library is not present.

commit 7cf477952aeb448294d8984cf5183b4cef0f6d5d
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 10 12:10:05 2009 +0000

    Fix compilation when Augeas is not present.
    
    It would complain that NEED_AUG macro was defined but not used.

commit b9de2dc61162bf7cb89560319aab5e96b920e8e0
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Nov 9 15:06:36 2009 +0100

    avoid "syntax-check" failure: hide cast of argument to free
    
    * fuse/guestmount.c (fg_readlink): Perform cast in a
     separate statement to hide it from "make syntax-check".

commit 15821057d4729d8bb369af3a230e717af5563abb
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Nov 10 14:31:42 2009 +0100

    build: die early if we lack ocaml, ocamlfind or ocaml-xml-light
    
    * autogen.sh: Ensure that we fail very early when not building
    from a tarball and when one of those is not installed.

commit 0e1e0f10df2c45cf0c43633ce0e59a4780308e63
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Nov 9 15:05:23 2009 +0100

    tests: enable strcmp-related syntax-check tests
    
    * cfg.mk (local-checks-to-skip): Don't skip these checks:
    sc_prohibit_strcmp_and_strncmp, sc_prohibit_strcmp.

commit c9d94984588d166bcdc077a7972a1b454678ba10
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Nov 9 22:33:54 2009 +0100

    change strncasecmp() == 0 to STRCASEEQLEN()
    
    git grep -l 'strncasecmp *([^=]*== *0'|xargs \
      perl -pi -e 's/\bstrncasecmp( *\(.*?\)) *== *0\b/STRCASEEQLEN$1/g'

commit 0c20bd8ea7092b93074ff08cae70e4cf6a06e7c5
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Nov 9 22:33:36 2009 +0100

    change strncasecmp() == 0 to STRCASENEQLEN()
    
    git grep -l 'strncasecmp *([^=]*!= *0'|xargs \
      perl -pi -e 's/\bstrncasecmp( *\(.*?\)) *!= *0\b/STRCASENEQLEN$1/g'

commit 539bf7e8983c53c4cf79ffa64302bef1585bec31
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Nov 9 15:03:01 2009 +0100

    use STREQ, not strcmp: part 2
    
    git grep -l 'strcmp *([^=]*!= *0'|xargs \
      perl -pi -e 's/\bstrcmp( *\(.*?\)) *!= *0\b/STRNEQ$1/g'

commit 9a8889e4d0c532b9f77af3a9cc7aae06adebfb83
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Nov 9 14:30:11 2009 +0100

    use STREQ, not strcmp: part 1
    
    git grep -l 'strcmp *([^=]*== *0'|xargs \
      perl -pi -e 's/\bstrcmp( *\(.*?\)) *== *0/STREQ$1/g'

commit 3e70b34eed5a48640e20fbf6dcba774aaace1f3c
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Nov 9 14:26:21 2009 +0100

    change strncmp() == 0 to STREQLEN()
    
    git grep -l 'strncmp *([^=]*== *0'|xargs \
      perl -pi -e 's/\bstrncmp( *\(.*?\)) *== *0\b/STREQLEN$1/g'

commit 627f89351d06e43564b47ea42cabaa522284c2a1
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Nov 9 14:21:46 2009 +0100

    change strncmp(...) != 0 to STRNEQLEN(...)
    
    git grep -l 'strncmp *([^=]*!= *0'|xargs \
      perl -pi -e 's/\bstrncmp( *\(.*?\)) *!= *0/STRNEQLEN$1/g'

commit 29842da1379ece83eae98ee786b475ae161f1687
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Nov 9 14:06:37 2009 +0100

    convert strcasecmp(...) != 0 to STRCASENEQ(...)
    
    git grep -E -l 'strcasecmp *\(.*!= ?0\b'|xargs \
      perl -pi -e 's/\bstrcasecmp( ?\(.*?\)) != 0/STRCASENEQ$1/g'

commit 9353c6253d5fac1648b13ad9958468a2d9f6ad6f
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Nov 9 13:58:42 2009 +0100

    convert uses of strcasecmp to STRCASEEQ
    
    git grep -l 'strcasecmp *([^=]*== *0'| xargs \
      perl -pi -e 's/\bstrcasecmp( *\(.*?\)) *== *0/STRCASEEQ$1/'

commit 7cd4b6aeee3693463b03608a31cf53f21152c2e8
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Nov 9 19:50:22 2009 +0100

    define STREQ, STRNEQ, STREQLEN, STRCASEQ, etc.
    
    * src/guestfs.h: Define STREQ and company.
    * daemon/daemon.h: Likewise.
    * hivex/hivex.h: Likewise.

commit e645763007e7097c14c1c3ba94010f2e32e536bf
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Nov 9 15:14:53 2009 +0100

    indent with spaces, not TABs
    
    * HACKING: Expand indentation TABs.
    * configure.ac: Likewise.
    * daemon/daemon.h: Likewise.
    * daemon/guestfsd.c: Likewise.
    * fuse/guestmount.c: Likewise.
    * hivex/LICENSE: Likewise.
    * src/generator.ml: Likewise.
    * tools/virt-win-reg: Likewise.

commit d710f768161fc9f78ed8243f2de948b65425c06e
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Nov 9 15:09:35 2009 +0100

    fix doc typo
    
    * fuse/guestmount.pod: Avoid "the the".

commit 9299f25cd277d5481cae2ed8dcd8789417df9f53
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Nov 9 15:08:09 2009 +0100

    placate 'make syntax-check'
    
    * hivex/hivex.c: Remove unused "#include <assert.h>".

commit 4e201a0c9bce31881da868e764101a6d1556c967
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Nov 9 18:01:48 2009 +0100

    avoid syntax-check warning about isdigit use in example program
    
    * .x-sc_avoid_ctype_macros: New file.

commit e0fb48c01f1c25c20e1d5cae0765e65d7eaa4250
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Nov 8 11:57:02 2009 +0000

    appliance: Enhance mkfs to support many more filesystem types.
    
    This fixes support for NTFS, and adds support for:
     - reiserfs
     - btrfs
     - GFS and GFS2
     - JFS
     - HFS and HFS+
     - NILFS
     - OCFS2 (disabled)
    
    We don't enable OCFS2 by default, because it pulls in about
    140 extra packages into the appliance.
    
    GFS & GFS2 default to single node (no lock manager etc).

commit 3cf719bc077a5f0d4f1a79279a5ba6e41d53c9b9
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Nov 8 11:55:38 2009 +0000

    Fix prototype of commandv to match prototype of commandrv.

commit a25d175cf6e8283288fd6d209b37b09ffee0dcf3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 6 17:27:02 2009 +0000

    daemon: Always reflect command stderr to stderr when debugging.
    
    When debugging (ie. LIBGUESTFS_DEBUG=1 & verbose flag set in daemon)
    always reflect any stderr output from commands that we run to
    stderr of the daemon, so it is visible.
    
    Previously if stderror == NULL in command*, stderr output was
    just eaten and discarded which meant useful error messages could
    be lost.

commit d714547ab361962ca6f76ec07736f1515595b2df
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 6 13:19:26 2009 +0000

    daemon: Add flags argument to command*() functions.
    
    This adds new variations of the command*() functions which
    take a 'flags' argument.  Currently the only flag available
    is defined as follows:
    
     COMMAND_FLAG_FOLD_STDOUT_ON_STDERR: For broken external commands
     that send error messages to stdout (hello, parted) but that don't
     have any useful stdout information, use this flag to capture the
     error messages in the *stderror buffer.  If using this flag,
     you should pass stdoutput as NULL because nothing could ever be
     captured in that buffer.
    
    This patch also adds some documentation for command*()
    function.

commit 49e85f8cda664819d0f73c476f1596d1ecc128c8
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Nov 9 11:03:25 2009 +0000

    haskell: Disambiguate truncate symbol.
    
    This is a hack, but GHC doesn't like it if we have a symbol
    with the same name as one in the Haskell Prelude.  Therefore
    we much hide the corresponding symbol in the Prelude when
    building this module.

commit 93e3253fa68f4792a2844e0758c1780896e518e3
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Nov 8 11:57:54 2009 +0000

    ocaml: Update dependencies file.

commit c0465ca3ae5cd55dbc5dc6d3a511ae5431985d3b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 6 12:32:57 2009 +0000

    ocaml: Sort the dependencies so they are stable between machines.

commit 79125c4dea9c69d08b522ed7c85f26dc6ee1bcb3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 6 10:48:37 2009 +0000

    ocaml: General improvements to generated code.

commit e1f5472395b08033c60054e8f87f3c61126c4fa4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Nov 6 09:14:31 2009 +0000

    Fixes for compiling on 32 bit.

commit efad4f53923dcca94613e193d6383bd032e70498
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Nov 5 10:03:59 2009 +0000

    Don't update appliance after running generator.
    
    I'm not sure why these dependencies exist, but they cause the
    appliance to be updated every time the generator runs, which
    appears to be unnecessary.

commit ac2a53bbab44fe94306092b47aeddb899c55345a
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Nov 5 13:13:21 2009 +0000

    appliance: Add xfsprogs to list of packages

commit 857954dfbdd287d2e00d40c8c60f6cbe5b5730e2
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 4 21:51:35 2009 +0000

    fish: Allow <nn>P and <nn>E for petabyte and exabyte allocations.

commit 3266e51054fdc1f584bd7a8611c7706e6d0b7cef
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 4 18:03:58 2009 +0000

    fish: Allow <nn>T for terabyte allocations.

commit 5ce72e039ca332ba19bb9122b7c93d257e745bb5
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 4 17:42:03 2009 +0000

    fish: New command 'sparse', like 'alloc' but to generate sparse files.
    
    With sparse you can make sparse files, which is fun because you
    can experiment with really large devices:
    
      ><fs> sparse /tmp/test.img 100G
      ><fs> run
      ><fs> sfdiskM /dev/vda ,
      ><fs> mkfs ext2 /dev/vda1    # very long pause here ...
      ><fs> mount /dev/vda1 /
    
    To see the real (ie. allocated) size of the sparse file, use the du
    command, eg:
    
      ><fs> !du -h /tmp/test.img
      1.6G -rw-rw-r-- 1 rjones rjones 100G 2009-11-04 17:40 /tmp/test.img

commit fc2cce06ec537f3e6ddf153ffae389ab483e3809
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 4 17:23:11 2009 +0000

    daemon: Build daemon with AC_SYS_LARGEFILE.

commit 4f4880303693bc2e55ce431e87302098654b7f03
Author: Richard Jones <rjones@debian5x64.home.annexia.org>
Date:   Wed Nov 4 16:32:50 2009 +0000

    Debian: Use /bin/bash as the shell for regression test scripts.
    
    /bin/sh on Debian is a minimal shell called 'dash' which doesn't
    support some features we need such as the particular 'function'
    syntax used by regressions/test-stringlist.sh, and therefore
    this script was failing on Debian.
    
    Change all of these scripts to use #!/bin/bash explicitly to avoid
    these sorts of problems.

commit df1af0bbe21e906c11123e66ec470b60e55c9e44
Author: Richard Jones <rjones@debian5x64.home.annexia.org>
Date:   Wed Nov 4 15:47:03 2009 +0000

    daemon: When running external commands, open stdin as /dev/null
    
    Previously when we ran external commands from the daemon, stdin
    (ie. fd 0) was closed.  This caused a problem when running the
    external hexdump command which seems to break if stdin is closed.
    
    This patch opens stdin on /dev/null.

commit a3be3a3b877277c1e4b130e1676b9ad307cafa10
Author: Richard Jones <rjones@debian5x64.home.annexia.org>
Date:   Wed Nov 4 14:31:06 2009 +0000

    Debian: Include ISOFS driver in the kernel.

commit 644fccb4aeed3e39978d340b18821aa704adf1bd
Author: Richard Jones <rjones@debian5x64.home.annexia.org>
Date:   Wed Nov 4 14:30:41 2009 +0000

    Debian: Ignore Debian appliance root when looking for translatable files.

commit 3e4bd83ce0d3f9c7af52adb1dbdf5a5718e81454
Author: Richard Jones <rjones@debian5x64.home.annexia.org>
Date:   Wed Nov 4 14:30:13 2009 +0000

    debian: Ignore some generated debirf files.

commit 333e3da945b056efe6f9d2e4b74abdb19c9e87e8
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 4 12:42:18 2009 +0000

    configure: Fix summary messages.
    
    The following 3 summary messages in the configure output
    always displayed "yes" even if they were not actually
    enabled.
    
    Haskell bindings .................... yes
    virt-inspector ...................... yes
    virt-* tools ........................ yes
    
    Fixed by correcting the code that tests if the automake
    conditional is set.

commit ef642eb4e3bb278b5df14fbcf30403e3d30dcef3
Author: Jim Meyering <jim@meyering.net>
Date:   Tue Nov 3 18:55:21 2009 +0100

    hivex: fail upon integer overflow
    
    * hivex/hivex.c (windows_utf16_to_utf8): Avoid overflow and a
    potential infloop.

commit f95c697a44c321dd1d370620515aa71a71a4ad5b
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Nov 4 11:33:29 2009 +0000

    hivex: Check unchecked calloc (Jim Meyering).

commit f8a0d6608221881a40d67affdc55f6c7bafd69a5
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 3 16:50:08 2009 +0000

    Update PO files.

commit e2976edb674762437352c73a854333c7d9c945af
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 3 16:49:31 2009 +0000

    Fix EXTRA_DIST line in fuse/Makefile.am.

commit bca39315908ad814addc6e5bfccb229ac774f652
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 3 16:49:13 2009 +0000

    Add make.sh.in to EXTRA_DIST.

commit aad55a71f6aa3f7195c4b4b022773c5ae1c01728
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 3 16:44:47 2009 +0000

    Comment out code which provokes strange gcc optimization error.

commit 589ce7e1c85bef6526c1d0de81bca2befbdfcc30
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 3 16:31:37 2009 +0000

    Prepare for 1.0.77.

commit 429de2254176e470035eef05e0f3e9910d46863c
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Oct 30 16:13:13 2009 +0000

    FUSE filesystem support.
    
    This implements FUSE filesystem support so that any libguestfs-
    accessible disk image can be mounted as a local filesystem.
    
    Note: file writes (ie. write(2) system call) is not yet implemented.
    
    The API needs more test coverage, particularly lesser-used system
    calls.
    
    The big unresolved issue is UID/GID mapping between guest filesystem
    IDs and the host.  It's not easy to automate this because you need
    extra details about the guest itself in order to get to its
    UID->username map (eg. /etc/passwd from the guest).

commit 08c9bf5e22ecf06e36cf128416a62214704da411
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Nov 3 15:30:36 2009 +0000

    Allow callers to disable the recovery process.

commit 90cf7fc904fca42665fe04cdd90a4c547d23b00c
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Nov 2 17:02:32 2009 +0000

    New API call: pread
    
    guestfs_pread lets you do partial file reads from arbitrary
    places within a file.  It works like the pread(2) system call.

commit 55a7427b7679e25134cd43488a9f74cb542416ea
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Oct 31 13:41:18 2009 +0000

    New API calls: lstatlist, lxattrlist, readlinklist.
    
    These three functions are very specifically designed for FUSE
    support, so we can list directories efficiently.  Instead of
    making lots of lstat, lgetxattr and readlink calls, we can make just
    three calls per directory to grab all the attributes (which we
    then cache briefly).

commit 2eb19f526164a978c373a760deb30854d56b62ce
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Oct 30 16:10:45 2009 +0000

    New API calls: truncate, truncate_size, mkdir_mode, utimens, lchown.
    
    truncate, truncate_size: Used to truncate files to a particular
    size, or to zero bytes.
    
    mkdir_mode: Like mkdir but allows you to also specify the
    initial permissions for the new directory.
    
    utimens: Set timestamp on a file with nanosecond accuracy.
    
    lchown: Corresponding to lchown(2) syscall (we already have chown).
    
    The implementation is complicated by the fact that we had to
    add an Int64 parameter type to the generator.

commit 00425c073e5c0743ef425cd12108a85ac36b15f4
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Nov 2 14:30:54 2009 +0000

    examples/to-xml.c: Don't depend on Gnulib function.
    
    Since this program is just an example, it shouldn't require
    the Gnulib c-ctype functions.

commit ff704b2291680ca52051452abbce033953f65f3e
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Oct 30 17:11:02 2009 +0000

    appliance: Don't rebuild the appliance every time configure runs.
    
    config.status touches make.sh each time it runs, even if the
    resulting script would not change.  This causes the appliance
    to get rebuilt much more frequently than is necessary.
    
    There's no way to stop configure running, but we can move the
    config.status command into a Makefile rule to stop this
    undesirable behaviour.

commit 7ab898c286b846bdfc3f8d5f8f611f293e12df35
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Nov 2 16:15:14 2009 +0000

    guestfish: Fix a third indentation problem.

commit dd56b3c4c350e77cf47f9c071ac36ed94d02e369
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Nov 2 16:06:23 2009 +0000

    guestfish: Another indentation fix.

commit 4293b71a900ac3abfb178405e228c3f45915f5c0
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Oct 31 13:40:12 2009 +0000

    guestfish: Fix printing of buffers in structs.
    
    Somehow an 'indent' string crept in there, so it was printing:
    
      <char><indent><char><indent><char>...
    
    instead of:
    
      <char><char><char>...

commit 752aec78b012dbeb8997658bf574dfba690bcfed
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Oct 31 13:38:14 2009 +0000

    Fix rstructs_used handling in guestfish generated code.
    
    rstructs_used wasn't correctly generating code for guestfish
    because guestfish doesn't make all functions visible.  Since the
    calculation of rstructs_used was over all functions (including
    ones not available in guestfish) it could have generated
    unnecessary functions.
    
    In fact this error didn't affect us before - but I discovered
    it when I added some extra struct-returning functions (future
    commit).

commit 32ab3c183836ab434ab739bea8238593d70db2ac
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Oct 31 13:37:04 2009 +0000

    daemon: Don't warn on -Wunsafe-loop-optimizations.
    
    Ignore -Wunsafe-loop-optimizations, same as in the top level
    configure file.

commit 6600c275b2a845c3dc26ee97708abd04dd3c5c5c
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Oct 29 20:35:59 2009 +0000

    Add hivex* documentation to website.

commit 2ec5ff5d3436989882d4284690606989e71cef96
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Oct 29 20:33:27 2009 +0000

    Add HTML documentation to website.

commit bb67f62e3c6a326f37a1baaf64709840a155457f
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Oct 29 20:06:47 2009 +0000

    Prepare for 1.0.76.

commit 43a8e107ce8ad6eac99da82366bdf63b401e3d31
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Oct 29 18:46:46 2009 +0000

    Fix misspelling in previous commit.

commit d707ecc55ac2de267608435bdc1052176aecff46
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Oct 29 18:36:12 2009 +0000

    RHEL 5: Also add le{16,64}toh functions

commit a4e27cdf4d3b831792dd20d796dc98a5bc684290
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Oct 29 17:54:48 2009 +0000

    RHEL 5: Detect endianness functions and supply them.

commit e02f42cb1d7f60c9d2f020d7d8c1b5316fb61310
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Oct 29 16:54:18 2009 +0000

    Add virt-win-reg to toplevel Makefile.am, fix POTFILES.in

commit 130d7bc3a2758d18adfb3249e3768afed7a9d4d7
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Oct 29 16:44:09 2009 +0000

    Prepare for version 1.0.75.

commit 792c5283009ed6753239a14df9a6e9c71bea35fd
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Oct 26 11:03:07 2009 +0000

    Support for Windows Registry.
    
    In hivex/:  This mini-library allows us to extract Windows
    Registry binary files ("hives").
    
    There are also two tools: hivexml converts a hive to a
    self-describing XML format.  hivexget can be used to extract
    single subkeys from a hive.
    
    New tool: virt-win-reg.  This is a wrapper around the library
    functionality allowing you to pull out data from the registries
    of Windows guests.

commit d609130cb65fe7795b168a796426e39d64ceda97
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Oct 26 14:26:36 2009 +0000

    New API: vfs_type - get the Linux VFS driver for a mounted device.

commit aa7ca27e4be1fd38a1eff4d24974f053080a9704
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Oct 26 09:12:12 2009 +0000

    Modify Sys::Guestfs::Lib::resolve_windows_path to use case_sensitive_path.

commit ec02f0da1550e37acd95d615ff4fcf88569bcf2c
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Oct 26 09:04:42 2009 +0000

    guestfish: Add win: prefix to use Windows paths.
    
    Add a win: prefix for path arguments in guestfish:
    
    ><fs> file win:c:\windows\system32\config\system.log
    MS Windows registry file, NT/2000 or above

commit 74bde73d5c60c13b894fa60fff680a447499c884
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Oct 26 13:00:46 2009 +0000

    daemon: Change chdir to use openat/fdopendir.
    
    Uses Gnulib implementation of openat which should be portable.

commit 9add3c10a3b769e309f476bd0fd05e2a7126d31d
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Oct 26 08:20:00 2009 +0000

    New API: case-sensitive-path to return case sensitive path on NTFS 3g fs
    
    This function handles an annoyance/peculiarity of the Linux
    NTFS 3g driver, which is that it exports NTFS filesystems with
    names case sensitive, even though under Windows they would be
    case insensitive.
    
    This causes problems because the location of (eg.) c:\windows
    might appear as /windows or /WINDOWS (etc) depending on the
    inconsequential details of how it was originally created.
    
    Example of this problem on a real Windows guest:
    
      ><fs> file /windows/system32/config/system.log
      libguestfs: error: file: access: /windows/system32/config/system.log: No such file or directory
      ><fs> case-sensitive-path /windows/system32/config/system.log
      /WINDOWS/system32/config/system.LOG
      ><fs> file /WINDOWS/system32/config/system.LOG
      MS Windows registry file, NT/2000 or above

commit a4217192672fb4f2ff60efcacc59a202d9f77bd9
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Oct 26 09:30:38 2009 +0000

    inspector: Remove inaccurate paragraph from documentation.

commit a3dfe9398c9f629d013a82c1ba8014b500462f7d
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Oct 25 21:43:37 2009 +0000

    Include HFS (Mac OS X) driver.

commit 805cb234f3d9b3afc6c4bb7c82d9f7c64caeabce
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Oct 21 16:31:26 2009 +0100

    Set LC_ALL=C before running qemu.

commit 300461966b053bb62249f9084d4a85b25fee48f6
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Oct 21 10:16:50 2009 +0100

    init: Check that start_udev succeeded
    
    If start_udev fails for any reason, notice and fall through to manual /dev
    creation.
    
    Patch from Charles Duffy <charles@dyfis.net>

commit c925dce4e7654cbcf66eb90528de18d5d09aa7c4
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Oct 20 15:37:40 2009 +0100

    Version 1.0.74.

commit de64183f3d0d04127c2e7690c87435e6649d30a6
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Oct 20 15:03:16 2009 +0100

    Tab to space fixes, now passes 'make syntax-check'

commit cefc644d58786b73b2baaa2c2912da2738d24511
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Oct 20 10:19:21 2009 +0100

    guestfs_find: Fix memory leak of sysrootdir.

commit ea124897881d9e40d89eca5307e04def0fb42bdb
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Oct 19 17:59:00 2009 +0100

    virt-ls: Modify to use find0 instead of find.
    
    find0 is more scalable than find.  virt-ls will no longer
    crash if asked to recursively list / on a Linux guest.

commit 42c89f2e6bd956f738080b5aec53b7520f4f96da
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Oct 19 17:44:16 2009 +0100

    New API: find0 (unlimited version of find)
    
    This adds a new API call guestfs_find0, which is like guestfs_find
    but mainly doesn't suffer from the protocol limit of the earlier
    command.  The earlier command is not deprecated because it is
    still very useful.
    
    guestfs_find0 uses a FileOut parameter and writes the results to
    an external file.  The filenames in the output are separated by
    ASCII NUL characters (so a bit like "find -print0").
    
    There is also the addition of a regression test for this command.

commit 55f5dc6f1195d7dec5687ece3f6e74dde649ff7c
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Oct 19 16:57:54 2009 +0100

    guestfs_find: Document protocol limits for this API call.
    
    guestfs_find has to send the complete list of files in a single
    protocol message (hence, limited to 2-4 MB).  Unfortunately on
    a typical Linux guest, guestfs_find ("/") will exceed this limit
    resulting in an error.
    
    Therefore we should add an unlimited version of this call in a
    future commit.  This commit just documents the current limit.

commit 4dd6b77ff7037ee220b530cefb412ace3d880f61
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Oct 19 12:16:00 2009 +0100

    New tool: virt-ls
    
    This tool makes available the functionality of "ls", "ll", and "find"
    in a slightly simpler to use form.
    
    Examples:
    
      virt-ls -l myguest /tmp

commit 984a35cfc0ae09821fb39307b98ec8399bcd8982
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Oct 19 11:49:20 2009 +0100

    New tool: virt-tar
    
    This adds a new tool call virt-tar which is a general purpose
    archive and uploading tool.  It doesn't add any functionality
    which wasn't previously possible using guestfish, but makes it
    simpler to access for some users.
    
    Examples:
    
     virt-tar -zx myguest /home home.tar.gz
     virt-tar -zu myguest uploadstuff.tar.gz /tmp

commit 5c4bf92bc298e078ceccdde603313282d038544c
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Oct 19 10:45:44 2009 +0100

    tools: Make warnings about running on live guests more prominent.
    
    Add prominent warnings to the man pages about how it is dangerous
    to run these tools against live guests.

commit 945b6e0a085611b45b2ab0752a66e6e60b21666c
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Oct 19 10:18:46 2009 +0100

    Move virt tools (virt-cat, virt-edit etc) into tools/ subdirectory.
    
    This moves the tool programs into a single directory:
      cat/* -> tools/virt-cat
      df/* -> tools/virt-df
      edit/* -> tools/virt-edit
      rescue/* -> tools/virt-rescue
    
    This in itself simplifies the build process because we only need
    one Makefile and one copy of 'run-locally'.
    
    'run-*-locally' has become just 'run-locally' and takes an extra
    parameter which is the name of the tool, eg:
      run-locally cat [virt-cat params...]
    
    virt-inspector stays in its own directory, because this contains
    more than just a single Perl script.

commit 854f8e0d5643e55d045f5816a520d49a057990ef
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Oct 19 09:10:15 2009 +0100

    Comment: Describe the build order requirements for toplevel directories.

commit 29148ac40fc6ae54769ceb456d4bd533245a3995
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Oct 14 11:24:52 2009 +0100

    Prepare for 1.0.73.

commit f57f338c3bd937e923e1ba7cc4791b9462192110
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Oct 14 11:24:33 2009 +0100

    Add some missing EXTRA_DIST files.

commit d37f69795396ec2354eb2d8480d64b9e5bdafacc
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri Oct 2 15:42:14 2009 +0100

    inspector: Generate language bindings for OCaml.
    
    This commit adds a generic mechanism for deriving language bindings
    for virt-inspector, and implements one concrete binding, for OCaml.
    
    The bindings are generated from the RELAX NG schema (virt-inspector.rng)
    which is supposed to be a correct and always up to date description
    of the XML that the virt-inspector program can generate.
    
    From the RNG we generate a set of types to describe the output of
    virt-inspector for the language, plus an XML parser, plus some
    glue code to actually run an external instance of virt-inspector
    and parse the resulting XML.
    
    At runtime, an external 'virt-inspector --xml <name>' command runs
    and the XML is parsed into language-specific structures.
    
    This has been tested on the four example files (inspector/example?.xml)
    
    The only particular difficulty about the OCaml binding is the use of
    Obj.magic, which is naughty but works because of the isomorphism
    between the representation of tuples and records in OCaml.  This
    seems to cause no problems in my test program.  Apart from this, the
    OCaml binding is straightforward and could be adapted easily for any
    other languages that want type-safe virt-inspector bindings.
    
    It's important to keep virt-inspector.rng up to date with changes
    to virt-inspector's XML output format.

commit c6b8db6493dd633bf48b13daf72cdc9c078b5f9a
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Oct 5 12:25:15 2009 +0200

    build: avoid parallel ocaml/... build failure
    
    A parallel build could fail due to the use in ocaml/examples
    of ocaml/guestfs.cmi before it was built.
    * Makefile.am (SUBDIRS): Add both ocaml and ocaml/examples,
    to ensure they're built in this order, and not in parallel.
    * ocaml/Makefile.am (SUBDIRS): Don't define.

commit 65d61d4244b6301284e3b67e8ff23cc1374c90f2
Author: Piotr Drąg <piotrdrag@gmail.com>
Date:   Mon Oct 5 12:20:53 2009 +0100

    Updated Polish translation

commit 9f206cc4a6c5bc54cc20cc571a77d3aab5e2ea82
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Oct 1 16:59:28 2009 +0100

    inspector: Fix inspector/Makefile.am
    
    Accidentally pushed the older version of the patch in
    commit 9d25e82491ddcf495e1d30694327e4bfd3a23445.
    
    This includes Jim Meyering's suggested changes from
    https://www.redhat.com/archives/libguestfs/2009-October/msg00017.html

commit dde81c0c0e4d6517781392310768dfe8fe4392fe
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Oct 2 16:09:19 2009 +0200

    build: fix compile error
    
    Link demo scripts with just-build library, not the installed one.
    * ocaml/examples/Makefile.am (OCAMLFINDFLAGS): New variable.
    (lvs, viewer): Use it.
    This fix is based on a suggestion from Rich Jones.
    This addresses RHBZ#526917.

commit 9d25e82491ddcf495e1d30694327e4bfd3a23445
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Oct 1 16:59:28 2009 +0100

    inspector: Add tests for RELAX NG schema.

commit ee21bc1f8071bb35409e9f15fb8309348c9a5912
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Oct 1 16:58:38 2009 +0100

    inspector: Add RELAX NG schema for virt-inspector --xml output.

commit 3c58ea10c74e0a4121ad32b5d578955825371d92
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri Oct 2 09:51:06 2009 +0100

    configure: Update comment about viewer.ml.

commit bf6ea125577dccdb18cab635eda1fb79cd98e0d5
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Oct 1 16:06:17 2009 +0100

    inspector: Canonicalize device names (fix RHBZ#526717).
    
    Make filesystem device names canonical, so they are /dev/sd*
    instead of /dev/vd*.

commit 5d01670e31ef3259fb1fc84a83ab27aec8fdac0b
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Oct 1 15:22:12 2009 +0100

    run-*-locally: The programs are now virt-[tool], not virt-[tool].pl
    
    This fixes commit b488436cc54288fcae8988493749f2e6c87f274c.

commit 5021b2efea92c021c04812056149485ac4803e9c
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Oct 1 15:20:14 2009 +0100

    inspector: Don't bomb if no kernels detected.
    
    If $os->{kernels} wasn't defined, virt-inspector would exit with
    an error, leaving partial XML output.
    
    Change the code so it doesn't die in this case, instead just
    leaves out the <kernels> section.

commit d525103c8621f6ff0293311a8e8f9ac0c3580805
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Sep 30 15:32:41 2009 +0100

    OCaml viewer: Use ocamlduce to replace xpath code.

commit d278ef8ad9090441a713c7334804199318aeb3e1
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Sep 29 11:56:26 2009 +0100

    OCaml viewer: Handle exceptions properly.

commit 4c8bdd342450aad1f49a44a009eae015a44f9572
Author: Richard Jones <rich@koneko.home.annexia.org>
Date:   Sat Sep 26 12:45:37 2009 +0100

    OCaml example: graphical disk usage viewer.
    
    This is an example of how to write an app which uses libguestfs
    and libvirt, and has a responsive user interface (using threads).
    It is a Gtk-based "graphical virt-df".
    
    Read the top of the 'viewer.ml' file first for instructions on
    how to compile.  This program is not compiled by default.

commit f8a96c659616b4e88bb2e6af8e23deea3bd96f0c
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Sep 24 11:22:17 2009 +0100

    virt-df: Add note about parsing CSV.

commit 6a14f1c2502f58ff7bed8cb451f95a83f5ee920a
Author: Jim Meyering <meyering@redhat.com>
Date:   Thu Sep 24 10:59:01 2009 +0200

    avoid use of all ctype macros
    
    * cfg.mk (disable_temporarily): Don't disable sc_avoid_ctype_macros.
    * fish/tilde.c: Remove unnecessary inclusion of ctype.h.
    * bootstrap: Add gnulib's c-ctype module to the list.
    * daemon/m4/gnulib-cache.m4: Likewise.
    * daemon/ext2.c: Include "c-ctype.h", not <ctype.h>.
    Use c_isspace, etc, rather than isspace.
    * daemon/guestfsd.c: Likewise.
    * daemon/lvm.c: Likewise.
    * daemon/proto.c: Likewise.
    * fish/fish.c: Likewise.
    * fish/tilde.c: Likewise.
    * src/generator.ml: Likewise.
    * src/guestfs.c: Likewise.
    * examples/to-xml.c: Likewise.
    * examples/Makefile.am (to_xml_CPPFLAGS): Add -I$(top_srcdir)/gnulib/lib
    so inclusion of "c-ctype.h" works.
    (to_xml_CPPFLAGS): Rename from to_xml_CFLAGS.

commit 0ca36888c6975ffa7e03df11bf8ded42156939c7
Author: Jim Meyering <meyering@redhat.com>
Date:   Thu Sep 24 09:34:53 2009 +0200

    maint: prune dead wood from list of skipped syntax-check rules
    
    * cfg.mk (local-checks-to-skip): Remove now-passing and
    no-longer-relevant rule names.

commit dc0c80b3884c5fa2735b55b205e7406599bd77b0
Author: Jim Meyering <meyering@vv.meyering.net.meyering.net>
Date:   Thu Sep 24 09:24:55 2009 +0200

    maint: use spaces, not TABs for indentation
    
    "make syntax-check" was failing.  This fixes it.
    * HACKING: Indent with spaces, not TABs.
    * configure.ac: Likewise.
    * rescue/virt-rescue: Likewise.
    * src/generator.ml: Likewise.

commit 275b0db9619b38a734c4718eec5645536ecc90a0
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Sep 23 13:49:46 2009 +0100

    Prepare for 1.0.72.
    
    Also update PO files.

commit 4bd623f6a2d83b2c27daed56f3020152a7bf31f3
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Sep 23 14:23:47 2009 +0100

    More HTMLFILES.

commit 406d4aea4df47c586a97f44525022ef4cfad4cdf
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Sep 23 14:01:28 2009 +0100

    Include virt tools in EXTRA_DIST.
    
    Partially revert b488436cc54288fcae8988493749f2e6c87f274c.
    It turns out that automake doesn't automatically place bin_SCRIPTS
    in EXTRA_DIST.

commit b488436cc54288fcae8988493749f2e6c87f274c
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Sep 23 12:37:26 2009 +0100

    Rename virt-[tool].pl as virt-[tool]

commit 75b6338da3e6e33c02b931623f074ab5a76a1788
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Sep 23 12:09:26 2009 +0100

    Check return value from readlink.

commit 9adddc19e448781cf2076c44f66242fe48b47c7c
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Sep 23 12:05:55 2009 +0100

    Create manpage atomically.
    
    Don't fail with a partial file if disk full, etc.

commit 154370c0e8a7bfcb6af5236bd7232794c188eabb
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Sep 23 12:04:25 2009 +0100

    Replace @...@ with $(...) in these common Makefile.am files.

commit 82918538abc707fb59fff42204f99ef031c593a9
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Sep 23 11:50:49 2009 +0100

    guestfish: Update 'SEE ALSO' section of the manpage.

commit 7801621dc946fe894c960e683db3cf921ef23af6
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Sep 23 11:12:05 2009 +0100

    New tool: virt-edit
    
    Edit any file in a guest.  This was possibly previously
    using guestfish, but having a separate command makes it
    simpler.
    
    The usage is simply:
    
      virt-edit mydomain /some/file
    
    It runs $EDITOR or vi on the file, and if the user changes
    it, uploads the result back to the VM.

commit d15195bad9e50f4d80e84c39100a217a260fc806
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Sep 23 11:11:21 2009 +0100

    virt-cat: Remove some unused Perl module includes.

commit 1b21ed4f5d9307e87fad094ec177c90d5adb91ce
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Sep 22 19:50:21 2009 +0100

    Add 'virt-rescue' command.
    
    This command runs a "rescue appliance" against a virtual machine
    or disk image.  This is useful for making ad-hoc interactive
    changes to virtual machines.
    
      $ virt-rescue --ro /dev/vg_trick/F11x64
    
      Welcome to virt-rescue, the libguestfs rescue shell.
    
      Note: The contents of / are the rescue appliance.
      You have to mount the guest's partitions under /sysroot
      before you will be able to examine them.
    
      bash: cannot set terminal process group (-1): Inappropriate ioctl for device
      bash: no job control in this shell
      ><rescue> mount /dev/vg_f11x64/lv_root /sysroot
      EXT4-fs (dm-0): barriers enabled
      kjournald2 starting: pid 269, dev dm-0:8, commit interval 5 seconds
      EXT4-fs (dm-0): internal journal on dm-0:8
      EXT4-fs (dm-0): delayed allocation enabled
      EXT4-fs: file extents enabled
      EXT4-fs: mballoc enabled
      EXT4-fs (dm-0): mounted filesystem with ordered data mode
      ><rescue> ls /sysroot/
      bin   dev  home  lib64       media  opt   root  selinux  sys  usr
      boot  etc  lib   lost+found  mnt    proc  sbin  srv      tmp  var
      ><rescue> exit

commit 3bc55551356532c17403508dfd8466beb2b9db1e
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Sep 22 19:52:56 2009 +0100

    Add direct appliance mode flag and implementation.
    
    When the g->direct flag is set, the appliance stdin/stdout
    are not connected to the library.  Instead they inherit the
    stdin/stdout of the caller.
    
    This is used to implement virt-rescue.

commit d186e9d3d371162774d026f85823d9615ac3bbbc
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Sep 22 19:51:47 2009 +0100

    Tidy up appliance rescue code.
    
    The appliance shouldn't run the daemon after we leave the
    rescue shell.  It should just exit instead.

commit 0d9325bd101e4e96d7d0a6c9640874cbb1e15ed1
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Sep 22 13:34:50 2009 +0100

    Rejig configure.ac tests for qemu vmchannel support.
    
    vmchannel is no longer required, so we shouldn't test for it.
    However we should test instead for user mode networking support.
    
    Also fix up the documentation / error messages.
    
    Always test for vmchannel and user mode networking support in
    qemu.  This gives us more troubleshooting information if people
    report bugs.

commit b9da0fe3f74e02b355aa2be961e8df3ab8b16b88
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Sep 22 12:12:56 2009 +0100

    Prepare for 1.0.71.
    
    Update version number and update PO files.
    
    Put latest version and release date on the website front page.

commit 1e9e6e50bd1bb81524185d8e32e3b787dead965b
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Sep 22 10:41:05 2009 +0100

    Change handling of spaces on Linux kernel command line.

commit 419cf4bb01727a8b0f23f48199a2831df6c6650e
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Sep 21 15:34:21 2009 +0100

    Update documentation of qemu / vmchannel.

commit ae2e569489eea72083aab8109d8012f74587f692
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Sep 21 15:27:20 2009 +0100

    Implement "null vmchannel" - no vmchannel needed!
    
    This commit removes the requirement for vmchannel, although retaining
    support for it.
    
    In this configuration, known as "null vmchannel", the library
    listens on a random loopback port.  It passes the number of this
    port to the appliance (guestfs_vmchannel=tcp:10.0.2.2:12345), and
    the daemon then connects back.  The library, instead of connecting,
    listens and accepts the connection during guestfs_launch.
    
    QEMU SLIRP (user mode networking) is still required to make this
    work: SLIRP forwards the TCP connection transparently (instead of
    explicitly as with guestfwd) to 127.0.0.1:<port>
    
    There is a window in which any other local process on the machine
    could see the port number in the qemu command line and try to
    connect to it.  This would be a devastating security hole, because
    any local process could pretend to be the daemon and feed back
    malicious replies to our remote procedure calls.  To prevent this,
    we check the UID of the other side of the TCP connection.  If
    the UID is different from the library's EUID, then we reject the
    connection.  To do this we have to parse /proc/net/tcp.  (On Solaris
    we could use getsockopt (SO_PEERCRED), but this doesn't work on
    Linux TCP sockets).
    
    Other vmchannel(s) are still supported.  This is important, because
    we can't in general be sure the qemu will always support SLIRP.
    In particular, in recent versions of qemu it is possible to compile
    out SLIRP.

commit dcb5aa01835c2cc2310fd8427988a2f2af8924f9
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Sep 21 15:27:02 2009 +0100

    Gnulib: Add arpa-inet and netinet-in modules.

commit 8b217a87bf9175e7e02a5913e5617e0d12dfd09c
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Sep 21 13:03:27 2009 +0100

    Flexible guestfs_vmchannel parameter for future appliances.
    
    This reimplements parts of commit da0a4f8d1f6ddd302ceba028d87c6e009589e503
    in a different, but compatible way.
    
    We pass guestfs_vmchannel=tcp:<ip>:<port> on the command line.  This
    is intended to be used as follows (now and in future versions):
    
      tcp:10.0.2.4:6666    for guestfwd vmchannel
      tcp:10.0.2.2:<port>  for future "no vmchannel" implementation
      /dev/vcon4           for future virtio-console vmchannel*
    
    It also accepts the old-style guestfs=10.0.2.4:6666 parameter which
    is sent by older libraries, and turns this transparently into the
    correct format above.
    
    If no guestfs_vmchannel is passed, then this defaults to the guestfwd
    vmchannel which older libraries would expect.
    
    * Maybe this last one should be dev:/dev/vcon4 or file:/dev/vcon4, but
    we don't need to decide that now.

commit 8b91ee5e2d951ae467ac08421db89af48a642086
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Sep 21 12:32:25 2009 +0100

    Rearrange and tidy up code in guestfsd.c
    
    This just tidies up the main() function in the daemon.  There is
    no longer a huge fixed-sized buffer used for the kernel command
    line.  Variables are moved closer to where they are used.  Some
    local variables turned out to be unused - these are removed.  Finally
    the part that reads the kernel command line is moved into a separate
    function.
    
    There is only minimal functional change here (it now prints out
    the kernel command line).
    
    Literal '4' replaced with 'sizeof' expression, at Jim Meyering's
    suggestion during patch review.

commit 0740d45d28435015365b21213263249321d83878
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Sep 21 12:11:51 2009 +0100

    Make GUESTFWD_PORT into a string.

commit a1c8c3e1be70a821a5e4dfeeee6c78979e587b7a
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Sep 21 12:11:01 2009 +0100

    Remove unnecessary extra space from qemu command line.

commit 8869adf1e811d894088dbb0f371edc23299005c8
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Sep 21 11:52:53 2009 +0100

    Remove guestfs_wait_ready (turn it into a no-op).
    
    This commit changes guestfs_launch so that it both launches
    the appliance and waits until it is ready (ie. the daemon communicates
    back to us).
    
    Since we removed the pretence that we could implement a low-level
    asynchronous API, the need to call launch() followed by wait_ready()
    has looked a bit silly.
    
    Now guestfs_wait_ready() is basically a no-op.  It is left in the
    API for backwards compatibility.  Any calls to guestfs_wait_ready()
    can be removed from client code.

commit 62b322872543c2ec069ac4fb0103ab758f587cef
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Sep 21 12:01:11 2009 +0100

    Combine temporary buffers.
    
    buf[], append[] and memsize_str[] were all temporary buffers
    used in non-overlapping code.
    
    Combine them to use a single buffer (buf[]).

commit 8d8b3fafa3655f0a389d98cac63db23ddf9b446c
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Sep 21 11:07:47 2009 +0100

    Rearrange qemu command line order (no functional change).

commit 27374fa479368a15e3c50ea17343be1397b29a10
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri Sep 18 14:06:07 2009 +0100

    Enable new-style -chardev ... guestfwd command line.
    
    Newer versions of qemu have changed the command line format
    (again).  '-net channel' is now deprecated.  Instead we use:
    
        -chardev socket,id=guestfsvmc,path=/path/to/sock,server,nowait
        -net user,vlan=0,net=10.0.2.0/8,guestfwd=tcp:10.0.2.4:6666-chardev:guestfsvmc
        -net nic,model=ne2k_pci,vlan=0
    
    The old style format is still used if the new style is not
    detected at runtime.

commit d5fad33b4eaa39722ea1dc96de9446ffc4805e01
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Sep 17 16:44:20 2009 +0100

    Fix code which looked for leaked FDs between each command.
    
    This code was not checking the return value from system()
    so it failed if uncommented.  Add ignore_value() around the
    call to system.  However, leave the code still disabled.

commit da0a4f8d1f6ddd302ceba028d87c6e009589e503
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Sep 15 17:14:44 2009 +0100

    Remove explicit guestfs=10.0.2.4:6666 kernel command line parameter.
    
    Since we control the appliance tightly, we can just specify
    that it will always use a particular host and port, and we
    don't need to pass it on the command line each time.
    
    Also the VMCHANNEL_* constants are only relevant to the
    particular guestfwd vmchannel implementation, so we rename
    them as GUESTFWD_*.

commit abac360f324d8c881878c5d9b7fb64be93981125
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Sep 17 15:28:41 2009 +0100

    Daemon: fix handling of errors from xread and xwrite.
    
    If xread or xwrite returns -1, that indicates an error and we
    should exit.  Note that xread/xwrite has already printed the
    error message.

commit bb02f0fbe80ef093731bc9a6a407f1edaccf991d
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Sep 17 14:50:04 2009 +0100

    Fix verbose packet dumping functions.
    
    Add the configure parameter --enable-packet-dump so that this
    code can be enabled without editing the source.
    
    This code is normally commented out, because it is too verbose
    unless you happen to be debugging the underlying protocol.  Because
    it is normally commented out, I found it had bit-rotted slightly.
    This commit also fixes the obvious problems.

commit 5ccae24e06c52977f8b71d00c19f1100c1fa9c4c
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Sep 17 14:49:06 2009 +0100

    'len' should be an unsigned 32 bit int.
    
    This only happened to work by accident before because 'unsigned len'
    happens to be 32 bit on all platforms we support.

commit 6c8a69c602643ae3102c263148a94559d6594381
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Sep 17 14:39:42 2009 +0100

    Disable -Wunsafe-loop-optimizations
    
    This warning indicates that GCC could not do a particular sort
    of loop optimization.  It pops up randomly in certain forms of
    looping code, and seems safe to ignore.

commit b25ebed9e61e8903567a65b5a949d9bf47ee8e29
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Sep 15 17:13:24 2009 +0100

    Update PO files (no functional change).

commit b4852788e0a60eb6b5de84400b6a5c055f8531da
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Sep 15 11:13:54 2009 +0100

    Prepare for version 1.0.70.

commit 5af505c8cfb07840b25529131f304101750c6a04
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Sep 15 11:12:45 2009 +0100

    Update PO files.

commit d778225113dfc34ea4aa4c369937092e63223bba
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Sep 15 11:10:20 2009 +0100

    Set minimum gettext version to 0.17.
    
    This fixes the problem that the 1.0.69 tarball would fail in
    the po/ subdirectory when installing:
    
    make[1]: Entering directory `/builddir/build/BUILD/libguestfs-1.0.69/po'
    /bin/sh @MKINSTALLDIRS@ /builddir/build/BUILDROOT/libguestfs-1.0.69-1.fc11.x86_64/usr/share
    /bin/sh: @MKINSTALLDIRS@: No such file or directory
    make[1]: Leaving directory `/builddir/build/BUILD/libguestfs-1.0.69/po'
    
    RHEL 5.3 has gettext 0.14.6.  However the tarball will still
    build (since it includes all the required code).  This may cause
    a problem if RHEL users want to build from the git repository.

commit bf2f52e9c6f787d3b040083909aa9c11c54873f6
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Tue Sep 15 09:23:49 2009 +0100

    Fix comparison between signed and unsigned (for RHEL 5).

commit acbcbfaf39592b0b9c1864740ff0b3baad053b2e
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Mon Sep 14 20:14:47 2009 +0100

    Move decl out for C99 compliance.

commit 204e6da87d7887816ca71545e01ce1374afa4bb5
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Sep 14 19:35:58 2009 +0100

    Update PO files.

commit 130e7be812c45696877590b2d1bac3ab24883bff
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Sep 14 19:35:46 2009 +0100

    Move guestfs-internal-actions.h to EXTRA_DIST.

commit 7aa0d646d34f7cad4c220570ab4a0caafb6b4dc1
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Sep 14 19:28:14 2009 +0100

    Prepare for 1.0.69.

commit 0a0d743ba80e33e676084f2a254c63d4188857b0
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri Sep 11 20:00:30 2009 +0100

    Remove main loop.
    
    This commit removes the external main loop, which never worked
    and caused a number of bugs.  Requests are now done synchronously,
    and if the user wants to have requests issued in the background
    or to have a responsive GUI, then they'll just have to use threads.
    
    The big change is to push all reads and writes through two
    functions called send_to_daemon (for writes) and recv_from_daemon
    (for reads) which operate synchronously.  These functions
    read/write whole messages, and also handle checking for EOF
    (ie. daemon died) and asynchronous log message events from
    qemu (eg. from debug / dmesg printed by the guest).  A more
    complete description of how these work can be found in the code.
    
    This code passes a complete run of the tests.
    
    Bugs believed to be fixed by this commit:
    
      https://bugzilla.redhat.com/show_bug.cgi?id=501888
      internal error: reply callback called twice
    
      https://bugzilla.redhat.com/show_bug.cgi?id=504418
      In virt-inspector: "download: guestfs_download reply failed, see earlier error messages"
    
    I have tried to avoid reintroducing this:
    
      https://bugzilla.redhat.com/show_bug.cgi?id=508713
      libguestfs: error: write: Broken pipe (guestfish only)
    
    One other benefit of this is that 'set_busy/end_busy' calls
    no longer appear in traces.

commit 59b487b7dd9db0dd6f262ca4b39c471c7d6cfa53
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Sep 14 16:21:04 2009 +0100

    Don't enable trace in set_trace test.
    
    This leaves trace enabled afterwards, resulting in some
    ugly test messages.

commit f9071160c1a5fe21a825398a81ba3ca584892a4e
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Sep 14 15:43:23 2009 +0100

    Fix type punning warning about use of CMSG_DATA in Rawhide.

commit 22cee80bc2f631703bf417a54ef4e0f0837e921a
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Sep 11 09:27:57 2009 +0100

    guestfish: Enable grouping in string lists
    
    This change adds the ability to group entries in a string list with single
    quotes. So the string:
      "'foo bar'"
    becomes 1 token rather than 2. Consequently single quotes must now be escaped:
      "\'"
    resolves to a literal single quote.
    
    Incidentally, this change also alters another, probably unintentional behaviour
    of the previous implementation, in that tokens are separated by any amount of
    whitespace rather than a single whitespace character. I.e.:
      "a  b"
    resolves to:
      'a' 'b'
    rather than:
      'a' '' 'b'
    That last syntax can be used if an empty argument is still desired. Whitespace
    is now also defined to include tabs.
    
    parse_string_list can also now fail if it contains an unmatched open quote.

commit f8eb7a18f859fc778d06b9c3f0cafedbeba1e47f
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Sep 14 13:41:02 2009 +0100

    Ignore localrepo/ directory.
    
    This can be used by people building from source and packagers for
    their own purposes.

commit f04ee08806ec7bd313e9d54f48f2eb911fcb3067
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Sep 9 17:48:30 2009 +0100

    Add command trace functionality.
    
    Enable this by calling guestfs_trace (handle, 1) or by
    setting the LIBGUESTFS_TRACE=1 environment variable.

commit 7f2ac369f7747a033f5e84d8c7fb3aa131f25537
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Sep 9 12:34:13 2009 +0100

    Non-daemon actions indirect through generated code.
    
    Previously non-daemon actions were called directly by
    user code, eg:
    
    /* Non-generated */
    int
    guestfs_set_verbose (guestfs_h *g, int v)
    {
      g->verbose = !!v;
      return 0;
    }
    
    This changes these actions so they go indirectly via
    some generated code, eg:
    
    /* Generated */
    int guestfs_set_verbose (guestfs_h *g,
    		int verbose)
    {
      return guestfs__set_verbose (g, verbose);
    }
    
    /* Non-generated */
    int
    guestfs__set_verbose (guestfs_h *g, int v)
    {
      g->verbose = !!v;
      return 0;
    }
    
    The aim is to have a place in the generated code where
    we can add debug or tracing information for these non-
    daemon calls.

commit d5b89d36224b394391af09fba7ed0a7921175610
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Sep 11 17:04:13 2009 +0100

    guestfish: Redirect stdout when executing remote commands
    
    guestfish --listen necessarily redirects its stdout to /dev/null so as not to
    interfere with eval. The remote protocol doesn't contain any other provision for
    collecting stdout for the caller, so executing guestfish --remote will never
    generate any output.
    
    This patch fixes that by forwarding the caller's STDOUT to the listener over the
    unix socket connection. The listener redirects its STDOUT to the caller's STDOUT
    for the duration of the command, then closes it again.

commit 7eda9e6fb2b1f6504167ab650886f5a336fc6919
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Sat Sep 12 09:45:44 2009 +0100

    Update TODO list

commit 6661e0f21587f43579f50bf28d56ee4d45897093
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri Sep 11 20:21:37 2009 +0100

    Add diffutils package.
    
    On Fedora 12, /usr/bin/cmp is not pulled in unless we explicitly
    add the diffutils package.

commit 13432f02ca29eecaa61c8d66c7c52f9b70b2b3be
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Sep 11 14:27:54 2009 +0100

    Add echo_daemon command
    
    echo_daemon is a simple echo which can be used to test connectivity between the
    client and daemon.

commit 02ae70474d418b202b6a8411daa54f8dfc790206
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Sep 11 10:33:32 2009 +0100

    generator.ml: Fix string list memory leak
    
    Parsed string lists are allocated by malloc, but were never freed.

commit 006873b92da9d0a5c7d9008bd94caabe0028e4c0
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Sep 9 12:03:10 2009 +0100

    Ignore some more m4 files.

commit 13458c821bfbe2e1ac0f355f436097951f465694
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Sep 9 12:01:42 2009 +0100

    Don't include gnulib files in POTFILES.in.

commit cfab42b40752f6dc44971b3c48523b917b374e91
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Sep 4 18:00:23 2009 +0200

    avoid build-from-scratch failure due to missing daemon/configure
    
    * bootstrap: Don't use autoreconf's --norecursive
    option.  We require the default --recursive behavior in order
    to create daemon/configure.  Reported by Matthew Booth.

commit 97ef6a82ed32404b751a23b6658e0f9c7ab3298c
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 31 20:29:08 2009 +0200

    maint: guestfs.c: avoid warning about possible NULL deref from llvm/clang
    
    * src/guestfs.h (guestfs_abort_cb): Declare with attribute noreturn.

commit 41f8b506924243d4fd7570913fbbbd9f8040e11f
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 31 19:51:46 2009 +0200

    maint: guestfs.c: remove unnecessary initialization
    
    * src/guestfs.c (guestfs__receive_file_sync): Don't set "r",
    only to ignore it.

commit de81a7d930a6a2ad558eff9396da20237e06ccc1
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Aug 28 14:07:35 2009 +0200

    generator.ml: avoid a warning about signed overflow in tests.c
    
    * src/generator.ml: Emit "unsigned long int n_failed;" rather than
    "int failed;", to avoid warning from gcc about "assuming signed
    overflow does not occur when simplifying conditional to constant".

commit ba5842c1147f4463fce7f613618938fd5b9a1c1a
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Aug 28 13:53:36 2009 +0200

    generator.ml: avoid defined-but-not-used warnings in guestfs_c_actions.c
    
    * src/generator.ml (emit_ocaml_copy_list_function): New function.
    Emit a function definition only if it will be used.

commit 23740528cd2d75a236aae1fb5d073e8be2e5a295
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Aug 28 13:43:16 2009 +0200

    generator.ml: avoid warnings in generated ocaml/guestfs_c_actions.c
    
    * src/generator.ml: Emit prototypes for ocaml_guestfs_* functions,
    to avoid warnings from gcc -Wmissing-prototypes.  Normally we'd put
    these somewhere else, but in this unusual case, they're not needed
    anywhere else.  Handle the >5-argument case, too, for these:
    ocaml_guestfs_test0_byte, ocaml_guestfs_sfdisk_byte,
    ocaml_guestfs_sfdisk_N_byte.

commit e933691fd1c1a5543c05fcd209ce57daf6cac4f7
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 24 11:39:42 2009 +0200

    build: enable gcc warnings in capitests/ and ocaml/
    
    * capitests/Makefile.am: Use $(WARN_CFLAGS) and $(WERROR_CFLAGS).
    * ocaml/Makefile.am:: Likewise.

commit 4125126085bd81bf96efc2cdbdec0f5596c6c9e8
Author: Jim Meyering <meyering@redhat.com>
Date:   Thu Aug 27 13:23:20 2009 +0200

    ocaml/guestfs_c.c: avoid warning about missing prototypes
    
    * ocaml/guestfs_c.c (ocaml_guestfs_create, ocaml_guestfs_close): Declare.

commit 27420d5dcf7ba550751323ea2f27cf45b9146a91
Author: Jim Meyering <meyering@redhat.com>
Date:   Thu Aug 27 12:36:25 2009 +0200

    ocaml/guestfs_c.c: avoid warning about initialization discarding "const"
    
    * ocaml/guestfs_c.c (guestfs_custom_operations): Add a cast.

commit 1accb67720596bd946809d4032661f5d3adb7a26
Author: Jim Meyering <meyering@redhat.com>
Date:   Thu Aug 27 12:34:38 2009 +0200

    ocaml/guestfs_c.c avoid signed/unsigned-comparison warning
    
    * ocaml/guestfs_c.c (ocaml_guestfs_strings_val): Declare index as
    unsigned int.

commit 0fc0e4bd73c60c1cd742509a70cf79932def4ea5
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Aug 25 16:21:48 2009 +0200

    build: use only one m4/ directory
    
    * Makefile.am (ACLOCAL_AMFLAGS): Specify only one include dir: m4.
    * bootstrap: Tell gnulib-tool to put .m4 files in m4/, not gnulib/m4.
    * autogen.sh: Move autoreconf from here into...
    * bootstrap: ...here, so that it is run only when gnulib-tool is.
    Also, tell it to skip the usual autopoint and libtoolize runs.
    * m4/.gitignore: Update.

commit f482e7ea665938152518fe15cd71cfe882dd2b30
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Aug 25 09:10:21 2009 +0200

    build: invoke autopoint with --force
    
    * bootstrap: Invoke autopoint with --force, to avoid warning
    about existing build-aux/config.rpath.
    Invoke libtoolize before gnulib-tool, to avoid spurious warnings.
    * autogen.sh: Add comments.
    Remove build-aux/config.rpath before running autoreconf.

commit 52befe975fb3dcc780785f769429e2eeb72698ac
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Aug 25 09:43:04 2009 +0200

    build: update gnulib submodule to latest
    
    * .gnulib: Update to latest.

commit 881770900938595565036b9b191cfdf39ff0dc98
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Aug 21 19:44:36 2009 +0200

    build: don't define _GNU_SOURCE manually
    
    Now that we're using gnulib in earnest, any manual definition
    would provoke a redefinition warning.
    * fish/fish.c (_GNU_SOURCE): Don't define.
    * fish/destpaths.c (_GNU_SOURCE): Likewise.
    * src/guestfs.c (_GNU_SOURCE): Likewise.
    * bootstrap (modules): Add asprintf, strchrnul, strerror, strndup
    and vasprintf.
    * fish/fish.c (main): Set argv[0] to sanitized program_name, so
    functions like getopt_long that use argv[0] use the clean name.

commit b9a691af0fa468873eda3706a1c797568857785b
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Aug 21 19:19:39 2009 +0200

    guestfish: diagnose stdout write failure
    
    Use gnulib's closeout module to ensure any failure to write to
    stdout is detected and reported.
    * fish/fish.c: Include "closeout.h".
    (main): Call atexit (close_stdout);
    * bootstrap (modules): Add closeout.

commit 8e6d1e1a31a69589fde10e3e230620f1e9d27866
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 24 11:32:17 2009 +0200

    guestfish: don't try to diagnose getopt failure
    
    * fish/fish.c: ... getopt_long already does that.  Instead, suggest
    "Try `guestfish --help' for more information."

commit 6cd965e007f65d6e62872c6ddd782f1de06046e3
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Aug 21 19:05:20 2009 +0200

    guestfish: write --help to stdout, use gnulib's progname module
    
    * fish/fish.c: Include "progname.h".
    (main): Call set_program_name to initialize.
    Don't hard-code guestfish everywhere.  Use program_name.
    However, be careful when modifying argv[0], since it is used
    in the hopes that it is an absolute file name.
    (usage): Don't spew all of --help for a mis-typed option.
    Split long lines.

commit acdf8907dee4fad3049bcc19921ffa96b9b5376b
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 24 11:34:22 2009 +0200

    build: avoid some autoconf warnings
    
    * configure.ac: Move gl_EARLY and gl_INIT to be earlier.

commit 005c82b8b89c50f9fb606ce3f5855a0c9b7b1c23
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Aug 24 11:45:49 2009 +0100

    Todo: ntfsclone.

commit 0abb1ec2b3f0e1f482f93b1c8b3d2ef59bc0321e
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Sat Aug 22 10:40:42 2009 +0100

    Add waitpid along guestfs_close path (RHBZ#518747).

commit 89c3e552e311744c4a26194b48c07c5bd2d9dd83
Author: Jim Meyering <meyering@redhat.com>
Date:   Thu Aug 20 13:56:47 2009 +0200

    fish/: enable -Werror and all of gcc's warning options
    
    * fish/Makefile.am: Use $(WARN_CFLAGS) $(WERROR_CFLAGS).

commit 33687dfaa00658a602180f3afcebe9552804a048
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Aug 21 15:04:32 2009 +0200

    generator.ml: avoid signed/unsigned-comparison warning in fish/cmds.c
    
    * src/generator.ml (emit_print_list_function): Emit code that doesn't
    evoke warnings.  s/int/unsigned int/
    (emit print_*_indent): Likewise, s/int/unsigned int/

commit fad78c609423fe10139b468ec229c3d6792718e2
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Aug 21 15:02:16 2009 +0200

    destpaths.c: avoid signed/unsigned-comparison warning
    
    * fish/destpaths.c (free_words): Change param type: s/int/size_t/.

commit 78e2a30b90621e417b8677868092bc6426d7b097
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Aug 21 14:59:49 2009 +0200

    fish.c: don't perform arithmetic on void* pointers
    
    * fish/fish.c (xwrite): Use char*.

commit fbd7db94066d45df7eb980234fee8603c427daa9
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Aug 21 14:58:20 2009 +0200

    fish.c: avoid signed/unsigned-comparison warning
    
    * fish/fish.c (script): Change type of index to "unsigned int".

commit 7b2d9feb821376603bcbc0707e21edce36109f9a
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Aug 21 14:55:39 2009 +0200

    fish.c: avoid "assignment discards qualifiers..." warning
    
    * fish/fish.c (main): Cast-away-const.
    * fish/fish.h (bad_cast): Define.  Safer than using an actual cast.

commit 05fd2a60466cb7c270b60e9b93c46548acf319cd
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Aug 21 14:50:23 2009 +0200

    tilde.c: avoid a warning
    
    * fish/tilde.c (find_home_for_username): Change param type: s/int/size_t/
    (try_tilde_expansion): Adjust caller.

commit 2d80a11d189e4785a9804c87588dfabd1d593007
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Aug 21 14:45:13 2009 +0200

    fish.c: avoid warnings
    
    * fish/rc.c (UNIX_PATH_MAX): Remove unused definition.
    * fish/fish.h (rc_listen): Declare with __attribute__((noreturn)).

commit c17ff8145718ed86419a7f6c5000b73dd54e324a
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Aug 21 14:41:49 2009 +0200

    edit.c: avoid warning about signed/unsigned comparison
    
    * fish/edit.c (load_file): Change type of param from int to size_t.
    (do_edit): Adjust caller.

commit 7faff93c3cd2143ee20127f75625f5c520b9d787
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Aug 20 16:28:35 2009 +0100

    Remove virt-v2v.  New repo: http://gitorious.org/virt-v2v/

commit d1c35f871022e40f9abd93048c1115c6565f94cb
Author: Jim Meyering <meyering@redhat.com>
Date:   Thu Aug 20 12:29:46 2009 +0200

    daemon: diagnose socket write failure
    
    * daemon/proto.c (send_chunk): Don't ignore socket-write error.
    * daemon/proto.c (send_file_end): Return "int", not void,
    so we can propagate send_chunk failure to caller.
    * daemon/daemon.h (send_file_end): Update prototype.
    * daemon/tar.c (do_tar_out, do_tgz_out): Update uses of send_file_end.
    * daemon/upload.c (do_download): Likewise.

commit 0c92c583d5291e1a3a966b36f107bf48e4bfad93
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 19 21:37:56 2009 +0100

    tests: Found three more references to the squashfs, replaced with ISO.

commit b4acbdbfa1b29c23df2ea6bcc093a118843d3381
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Aug 19 17:51:40 2009 +0100

    tests: namemax on ISO devices is 255
    
    Was 256 for the old squashfs device.

commit 0a016df319420f9291c806bf8c8b528705b1bdc5
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Aug 19 15:51:27 2009 +0100

    Cleanup initialisation of hash entries in Lib.pm

commit 2f3a0e3975ddecce2330324a152530c5b99f22f9
Author: Richard Jones <rjones@debian5x64.home.annexia.org>
Date:   Wed Aug 19 15:09:27 2009 +0100

    tests: Use ISO instead of squashfs.
    
    The squashfs format changes too much.  Use an ISO file for
    the tests instead.

commit 2b891ceef355ce2d6532d65f8febbe3833d4399e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 19 14:03:35 2009 +0100

    mke2fs: Use e4fsprogs programs if available.
    
    On RHEL 5, mke2fs is ancient, and there is a non-standard "mke4fs"
    binary which acts like the more recent mke2fs on Fedora.  Since there
    are several annoyances and actual bugs in the ancient RHEL 5 mke2fs,
    use mke4fs instead if it's available.

commit 5da810b96072c0fd71d78713025a2e104295d0ff
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 19 14:02:08 2009 +0100

    tests: modprobe fat instead of ext2 module.
    
    On RHEL 5, ext2 is compiled into the kernel, so trying to modprobe
    it will fail.  I've checked that fat.ko is always a module on the
    platforms we care about (RHEL 5, Fedora 11, Debian), so use that
    to test instead.

commit 9d04d360c6086e048982b107b2bd7be5df884a83
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 19 14:01:13 2009 +0100

    tests: Conditionally skip UUID tests.
    
    More tests introduced which break with old e2fsprogs that didn't
    support UUIDs.  Skip those tests when the old platform is
    detected.
    
    Also tidy up this code a little.

commit 64d042cb08cd724baa3f60889436d9e0e0a69263
Author: Jim Meyering <meyering@redhat.com>
Date:   Wed Aug 19 14:30:02 2009 +0200

    avoid build failure due to Haskell keyword clash
    
    * src/generator.ml: Fix this particular problem by
    renaming the "module" parameter to "modulename".
    Avoid the general problem by ensuring that no parameter name is
    in the set of nearly all Haskell, OCaml and C reserved words.
    (zfile): Adjust one more offender: s/method/meth/.

commit 569989b7505be8e1ad556fed02805acbf38d1188
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Aug 19 12:52:16 2009 +0100

    Export inspect_linux_kernel in Lib.pm

commit 256c084a2373b77950c88d82f666357e06306e31
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Aug 19 11:42:46 2009 +0100

    Add boot/grub_fs to output
    
    If present, this gives the mount point of the filesystem which contains grub.
    All entries in grub.conf will be relative to this filesystem.

commit 6aa44937d5ee9accb0025cd8536c5adafd24ef23
Author: Jim Meyering <meyering@redhat.com>
Date:   Wed Aug 19 10:01:07 2009 +0200

    guestfish: detect more failed syscalls
    
    * fish/fish.c (issue_command): Detect/diagnose more failed syscalls.

commit 0f7656f2870fd5f1644e54438e7639fa2dcbc747
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Aug 19 09:44:51 2009 +0100

    Prepare for version 1.0.68.

commit 8f1b06f64807239d4b4c923af4db8626a866ff6f
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Aug 19 09:37:44 2009 +0100

    guestfs_launch: Correct checks for dup failure.

commit e55c1fc51e0f9bb5da9b35b8915bd04401798d14
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Aug 19 09:10:24 2009 +0100

    Updated PO files.

commit ab8edb0cf9a23ee4a1655ad3a26a0cff7d61ac3d
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Aug 19 09:09:47 2009 +0100

    build: Comment out some unused macros.
    
    GCC 4.4.1 warns about some unused macros.  Comment these out
    while they are not used.

commit df63ba5e7d916444bb1adae886e5135e8d278b28
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Aug 18 14:56:48 2009 +0200

    build: new configure-time option: --enable-gcc-warnings
    
    * configure.ac: Define/configure it.
    * src/Makefile.am: Use new variables.

commit f1b48465f7e051527ff84370de7f312a706e604b
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Aug 18 15:39:26 2009 +0200

    suppress warnings from -Wmissing-noreturn
    
    Even though these functions are marked as "not implemented yet",
    and they will surely return a value once implemented, ...
    * src/guestfs.c (select_add_timeout): Declare with noreturn attribute.
    (select_remove_timeout): Likewise.

commit 3fa23b14d28d8018f71f659d7e5902850695b24b
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Aug 18 15:35:32 2009 +0200

    suppress a warning from -Wswitch-default
    
    * src/guestfs.c (guestfs_end_busy): Add a "default:" label.

commit d93a02ce3ff1a8aa8ef2ca8be5bf79bbcf8537f4
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Aug 18 15:32:40 2009 +0200

    suppress signed/unsigned-comparison warnings
    
    * src/guestfs.c [struct guestfs_h] (msg_in_size, msg_in_allocated):
    (msg_out_size, msg_out_allocated): Change type from int to unsigned int.

commit dd922bedb7c3e85fbbe1eed10e371aec47138a1d
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Aug 18 15:23:35 2009 +0200

    build: don't perform arithmetic on void* pointers
    
    * src/guestfs.c (receive_file_data_sync, xread, xwrite): Use char*.

commit 1821af4d614aa8bd6a5b911217ac1f557a19820a
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Aug 18 15:12:26 2009 +0200

    generator.ml: suppress signed/unsigned-compare warnings
    
    * src/generator.ml (check_reply_header): Emit parameter declarations
    that are unsigned, so as to avoid signed/unsigned-compare warnings.

commit 93ab20eb367b1c177a73620222afdf1f616dea1c
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Aug 18 15:03:55 2009 +0200

    build: suppress an ignored-dup-return-value warning
    
    * src/guestfs.c (guestfs_launch): Handle dup failure.

commit 1d8afa2416416acaf8b7ffc500cadfde13e3aca3
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Aug 18 14:55:59 2009 +0200

    build: suppress an ignored-write-return-value warning
    
    * bootstrap (modules): Add ignore-value.
    * src/guestfs.c: Include "ignore-value.h".
    (stdout_event): Ignore failure to write to stderr.
    Also, prefer STDERR_FILENO over the literal "2".
    * src/Makefile.am (libguestfs_la_CPPFLAGS): Include gnulib's .h files.
    (libprotocol_la_CFLAGS): Remove -Wall -Wno-unused.

commit 53ce488f380e3dd94c26bf507c5639975125a1ee
Author: Matthew Booth <mbooth@redhat.com>
Date:   Tue Aug 18 15:06:20 2009 +0100

    New 'modprobe' command.
    
    Allow kernel modules to be loaded into the appliance.

commit 7b65b7d323b1933cc1137e677d0e5c33d8bc7ff2
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Aug 18 10:15:57 2009 +0200

    avoid compiler warnings about unused vars in generated code
    
    * fish/Makefile.am: Compile rc_protocol.c into a convenience library,
    so it can have its own CFLAGS, and link that into guestfish.
    
    generator.ml: Use TABs, not spaces for indentation.

commit a75756628f7e822da29b3728ec8e949c60c5cc3f
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Aug 18 09:16:56 2009 +0100

    generator: Small code rearrangement.
    
    Move code which updates pod2text memo file into a separate function.

commit 9c5f05ec14655195fc94dc7c72d132087abe634b
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 17 20:44:01 2009 +0200

    generator.ml: do not emit unused print_* functions
    
    * src/generator.ml: Do not emit functions like print_xattr,
    print_lvm_vg, print_inotify_event, that are not used.

commit 8966b137660fff6619905e842ef793c4c9ed4f6e
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 17 20:28:34 2009 +0200

    generator.ml: do not emit unused print_*_list functions
    
    * src/generator.ml (emit_print_list_function): New function.
    Emit a function definition only if it will be used.

commit c3be5c3297d18bfe2545914f0e07574430437ebe
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 17 18:47:46 2009 +0200

    generator.ml: avoid warnings in generated tests.c
    
    * src/generator.ml: Avoid warnings in generated tests.c, regarding
    print_strings, and in exercising any function that takes a StringList
    or DeviceList parameter.
    (print_strings): Change param type to "char *const *s".
    Declare fully-const initializer for each list-taking function use.
    Cast *List argument to "(char **)".

commit 5a07cdc35856adfa25b8d0924a8d641b2320aadf
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 17 18:44:37 2009 +0200

    avoid compiler warnings about unused vars in generated code
    
    * src/Makefile.am: Compile protocol.c into a convenience library, so it
    can have its own CFLAGS, and link that with the destination one.

commit 24a6cf4533118e04367f7fcdc6eadaa4e2dfbc56
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Aug 18 08:56:18 2009 +0100

    Implement 'debug ls' and 'debug ll' commands.
    
    These commands can be used to list files in the appliance.

commit a578bd9c8ebfc311ec7c9c01085a9cf84be4eae2
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 17 21:14:34 2009 +0200

    generator.ml: Use TABs, not spaces for indentation.

commit 59b26635a02fdf3cb095f0c9735943de6f7878b8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 17 12:27:43 2009 +0100

    Ignore manywarnings.m4 / warnings.m4.

commit 722ff7a4bc034a8fe078d766a30589c07b8bd870
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 17 12:26:58 2009 +0100

    java: Small fix to Java bindings.
    
    Missing declaration of local variable 'i'.

commit 4d8efdd4552874092263bf567701c3459b05a780
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 17 12:23:32 2009 +0100

    HACKING: Document make targets and ./configure --enable-gcc-warnings.

commit d17bd636a8114498aa27ffd4d0dd38a1822fe7cd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Aug 17 12:23:16 2009 +0100

    Remove redundant macro.

commit 9b41eeb91733ee681a6a804464b6930d42ed8fd1
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 17 11:56:10 2009 +0200

    indent with spaces, not TABs

commit 9dd53bcb10283295d7fb5f0a3469be2984d99926
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 17 10:35:05 2009 +0200

    daemon: enable -Werror and many gcc warnings when --enable-gcc-warnings
    
    * daemon/m4/gnulib-cache.m4: Add two modules: manywarnings, warnings.
    * daemon/configure.ac: Implement --enable-gcc-warnings, and selectively
    disable a few warning options that are either not useful or that provoke
    too many warnings for now.
    Define and AC_SUBST WARN_CFLAGS and WERROR_CFLAGS.
    * daemon/Makefile.am (guestfsd_CFLAGS): Use $(WARN_CFLAGS)
    and $(WERROR_CFLAGS), rather than just -Wall.

commit c36fa40b981401cdbf61f596b804e79283d658b2
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 17 10:30:52 2009 +0200

    xattr.c: avoid warning about comparison between signed and unsigned
    
    * daemon/xattr.c (getxattrs): Use an unsigned index.

commit fabf3f661579710d543db46718ec627a53bad61f
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 17 10:25:42 2009 +0200

    guestfsd: don't ignore failed write-to-socket
    
    * daemon/proto.c (reply): Fix typo that would cause us to ignore
    failed write-to-socket.

commit 82a5f441ccc8286885bcab082560207d50acfefd
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 17 09:51:52 2009 +0200

    daemon.h: avoid warning about possible noreturn function
    
    * daemon/daemon.h (main_loop): Use "noreturn" attribute.

commit 9b0ab841856ed7168171f6dceaede88dc9fbb9b2
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 17 09:43:18 2009 +0200

    sfdisk.c, fallocate.c: use a string literal as format
    
    * daemon/fallocate.c (do_fallocate): Format was not a string literal.
    * daemon/sfdisk.c (sfdisk): Likewise.

commit 29e7b9908ea6a4c2a864955e73d5b1d7d64f1fc8
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 17 09:40:16 2009 +0200

    wc, blockdev: avoid warnings about discarding "const" qualifiers
    
    * daemon/wc.c (wc): Make "flag" param const.
    * daemon/blockdev.c (call_blockdev): Likewise, for "switc".

commit 5a9b41ed4462ec765303b973f74f17d5c0138a9a
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 17 09:38:50 2009 +0200

    daemon/zero: don't ignore write and close errors
    
    * daemon/zero.c (do_zero): Detect write and close errors.

commit ff2f3fc656b62ba4291ddb4a7238426c446db7c3
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 17 09:24:47 2009 +0200

    guestfsd.c: don't perform arithmetic on void pointers
    
    * daemon/guestfsd.c (xread, xwrite): Use char* pointers instead.

commit e82d864e02f7ab36881c6cda2798bb76370ee6c7
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 17 09:16:20 2009 +0200

    command.c: avoid shadowing a global function
    
    * daemon/command.c (do_sh_lines, do_sh): Do not shadow global "command".

commit d7569c00787fb92a8cd2f08c537ea1662f987901
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 17 09:15:34 2009 +0200

    avoid warning about old-style no-param function definition
    
    * daemon/df.c (do_df, do_df_h): Add "void".
    * sync.c (do_sync): Likewise.

commit 7793f8eda6b26002cb751503928e06f7b9c4a7d2
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 17 08:49:00 2009 +0200

    generator.ml: emit slightly prettier code
    
    * src/generator.ml: Emit a few omitted newlines.

commit 31053d2027d3db9423edcfc70a725b6ca3a7c84c
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Aug 14 16:54:44 2009 +0200

    python: avoid "_POSIX_C_SOURCE" redefinition warning
    
    * src/generator.ml: Include <Python.h> *before* <stdio.h>
    to avoid redefinition warning about "_POSIX_C_SOURCE".

commit adf20c0c4d9f488d55254f54a79079b9cacbde8d
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Aug 7 09:38:37 2009 +0200

    adjust const "**" pointers to avoid warnings
    
    Also, ...
    * src/generator.ml: Add DeviceList type, and propagate that change
    out to all calling/interface code.

commit 2ad9dbbe595b5311019376a55b13db0d7c5d8988
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Sun Aug 16 11:15:10 2009 +0100

    test-tool: Recognize '-t timeout' as an option.

commit a61bccecfba1c9501910d28de24bac945e95001f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 15 18:03:21 2009 +0100

    New commands: mkfs-b, mke2journal*, mke2fs-J*
    
    mkfs-b: Pass the -b (blocksize) parameter to mkfs.
    
    mke2journal and friends: Lets you create external ext2 journals on
    devices.
    
    mke2fs-J and friends: Lets you create ext2/3/4 filesystems with
    external journals.

commit da54ae6abbd840e28c294949bc796a231f050d6d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Aug 15 18:02:08 2009 +0100

    generator: Generate the UUIDs for tests randomly.
    
    Adds a uuidgen function which gets the random UUID from the
    uuid program.  Uses this for tests.

commit 801e7d8418927e4308b8cb0a079015bbc9212d5e
Merge: 322ff98 fee26ee
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Aug 14 22:05:39 2009 +0200

    Merge branch '226-elide'

commit 322ff984a39d53422b772bfeb8f69e7c648da8c0
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Aug 14 21:01:48 2009 +0200

    build: avoid "make sytnax-check" failure
    
    * daemon/configure.ac: Change a leading TAB to 8 spaces.

commit fee26ee231d22481a93176b29a9629c780b45dc3
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Aug 14 19:33:35 2009 +0200

    generator.ml: don't emit unused functions
    
    * src/generator.ml: Use "rstructs_used" to emit definitions only for
    put_TYPE_list functions that are used.

commit 4b940d1e349e382cb077be97af43a4893de9ea55
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Aug 14 19:12:18 2009 +0200

    generator.ml: factor out a function
    
    * src/generator.ml (emit_put_list_function): New function.

commit 8300b097ecbd66a1c9e2595e92bf4caca18768e4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Aug 14 16:54:55 2009 +0100

    Work out which RStruct/RStructList structs are really used, and how.

commit 8249460acfc0ab7298d125b4ea29c72729a4582b
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Aug 13 20:45:06 2009 +0100

    guestfish: Add --selinux option.

commit 299bd94e2ace3daa39add2ae9dc7799596b91fcd
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Aug 13 17:27:38 2009 +0100

    Version 1.0.67.

commit 33f53aeb5061cb64aabdaa181632e080f4f4d898
Author: Jim Meyering <meyering@redhat.com>
Date:   Thu Aug 13 18:29:59 2009 +0200

    tests: increase likelihood that heap abuse triggers failure
    
    * regressions/Makefile.am (TESTS_ENVIRONMENT): Always set
    MALLOC_PERTURB_ to a random value in 1..255.

commit 2447695a8dfb67a883c91b43f7b931573e1d3908
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Aug 13 17:23:25 2009 +0100

    appliance: Remove /usr/sbin/tcpd - it's unreadable on RHEL 5.4.

commit 98334f9d3a9120c829c5efacfe402b2cf6254ca2
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Aug 13 17:16:14 2009 +0100

    appliance: Replace LANG=C with LC_ALL=C

commit 4556fd64a8e236ec041cc00ed9687ef9bd455812
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Aug 13 16:41:37 2009 +0100

    umount: Enable device name translation for device parameter.

commit 40a0f2595515b5624ddd93cf26c4ed6383ac530e
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Aug 13 15:00:38 2009 +0100

    mount: Check mountpoints are absolute paths.

commit 9f7bec212fc7d146b4fd4be6e8b3e98677dc0a0a
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Thu Aug 13 14:43:57 2009 +0100

    selinux: Don't fail if libselinux is not found.

commit 77b9dc04cf336e751287837fa35390d875b22e4b
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Aug 13 14:41:52 2009 +0100

    Misc parameters which are String but should be Pathname.

commit dcd67e2c4e81bb270ea7f5ed8b6675b114afca60
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Aug 13 14:41:05 2009 +0100

    In rmmountpoint, have to explicitly check for ABS_PATH (*not* NEED_ROOT).

commit 0790c58e369d8fe77c8d1c6473dd757c63abebab
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Aug 13 14:39:59 2009 +0100

    inotify-add-watch does not need to explicitly check for ABS_PATH.

commit 80c479162db74c461d671128237975aecc982a5e
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Aug 13 14:39:31 2009 +0100

    cp/cp-a/mv parameters marked as Pathname.

commit 9beb53ca567147aa2cd03c8e68b11706bc284713
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Aug 13 14:37:43 2009 +0100

    do_equal does not need to explicitly check for NEED_ROOT/ABS_PATH.

commit e99fb52fb7112dd72be0a43970542df85590556a
Author: Jim Meyering <meyering@redhat.com>
Date:   Thu Aug 13 14:47:00 2009 +0200

    generator.ml: convert leading TABs to spaces

commit bd34e4e9421edee4289b8239e50c1e45a3d842fb
Author: Jim Meyering <meyering@redhat.com>
Date:   Wed Aug 12 21:16:30 2009 +0200

    sfdisk: guard against buffer overflow
    
    * daemon/sfdisk.c (sfdisk): Don't let outrageous "extra_flag"
    or "device" strings overflow a fixed-size buffer.

commit a0bb8e69de762aa88144c7a4825e13c446c2bbcb
Author: Jim Meyering <meyering@redhat.com>
Date:   Wed Aug 12 09:49:24 2009 +0200

    do_umount: don't use RESOLVE_DEVICE anymore
    
    * daemon/mount.c (do_umount): Don't use RESOLVE_DEVICE here,
    now that the caller always invokes REQUIRE_ROOT_OR_RESOLVE_DEVICE.

commit 3a5a66de8f847a0ff11fdcf6c1644e19aa54c0f7
Author: Jim Meyering <meyering@redhat.com>
Date:   Wed Aug 12 10:57:03 2009 +0200

    generator.ml: factor out "pr_args n" function

commit 08c27722647d14a30648dd02e221e1e803d1189e
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Aug 11 18:07:17 2009 +0200

    generator.ml: finish adding Dev_or_Path support
    
    * src/generator.ml: Update all rules to handle Dev_or_Path.
    (the above changes to generator.ml are mostly mechanical)
    Emit a use of REQUIRE_ROOT_OR_RESOLVE_DEVICE.
    * daemon/upload.c (do_download): Remove use of
    REQUIRE_ROOT_OR_RESOLVE_DEVICE, now that it's automatically done
    in calling code.
    * daemon/file.c (do_file): Likewise.

commit 1020246b278aade9671d12dae2554cf7538cf0de
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Aug 11 17:38:05 2009 +0200

    generator.ml: add type: Dev_or_Path
    
    * src/generator.ml (file, download): Use it.

commit 1f0810eb3a98cbfd347af59b6b9bc624ddff6028
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Aug 11 17:17:08 2009 +0200

    generator.ml: constify do_mkdtemp
    
    * daemon/dir.c (do_mkdtemp): Rewrite for a "const" parameter.
    * src/generator.ml (mkdtemp): Declare parameter to be of type Pathname.

commit d70eb3c45bc93f9e9c7ba735e7209d0ede0e505b
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Aug 11 16:17:41 2009 +0200

    generator.ml: move String/Device decls "down" to definition

commit 84fc760439e82e6b3616abd0d1f9bd7d7eb01ec0
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Aug 11 15:59:56 2009 +0200

    generator.ml: use new "Pathname" designation
    
    Nearly every file-related function in daemons/*.c is affected:
    Remove this pair of statements from each affected do_* function:
    -  NEED_ROOT (return -1);
    -  ABS_PATH (dir, return -1);
    and change the type of the corresponding parameter to "const char *".
    * src/generator.ml: Emit NEED_ROOT just once, even when there are two or
    more Pathname args.

commit 79b5084f70cb67c37dd7cbe60821a78981fd8d59
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Aug 11 12:16:51 2009 +0200

    generator.ml: new type, "Pathname"
    
    * src/generator.ml: Emit NEED_ROOT and ABS_PATH into generated
    stubs.c, rather than requiring they be added manually at the start
    of each and every do_* function that operates on a "path" parameter.
    Update grammar: Pathname is just a String, with the above exception.
    Do not update augeas "path" parameters, since they are not file names,
    but rather ":"-separated search paths.  Except aug_init, for which
    "path" *is* a file name.

commit 752147a1da4b1c2381ecba301627427c82b8d8a4
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Aug 11 11:56:33 2009 +0200

    generator.ml: emit "const char *" for Device and String params
    
    * src/generator.ml: Emit "const char *", not "char *" for Device and
    String params, now that the non-const code is hoisted into the calling
    code in stubs.c.

commit a4d2e6df0bbbd7dc9e5bf400e4e35efec0a18ff0
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 10 23:15:25 2009 +0200

    fix daemon.h's use of NEED_ROOT-in-#define

commit 6bda071b5cd8393b37653687027c4ae6c6cf3804
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 10 23:11:01 2009 +0200

    update all NEED_ROOT uses
    
    run this command:
      git grep -l -w NEED_ROOT|xargs perl -pi -e \
        's/(NEED_ROOT) \((.*?)\)/$1 (return $2)/'

commit 0c07f0d23698798475e0d09491812aca52440328
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 10 23:07:21 2009 +0200

    * src/generator.ml: Change all `String "device"' to `Device "device"'.
    
    Then update each affected function, removing each uses of RESOLVE_DEVICE,
    now that it's generated in caller from stub.c.
    * daemon/blockdev.c (call_blockdev): Remove use of RESOLVE_DEVICE.
    * daemon/devsparts.c (do_mkfs): Likewise.
    * daemon/ext2.c (do_e2fsck_f, do_get_e2label, do_get_e2uuid): Likewise.
    (do_resize2fs, do_set_e2label, do_set_e2uuid, do_tune2fs_l): Likewise.
    * daemon/fsck.c (do_fsck): Likewise.
    * daemon/grub.c (do_grub_install): Likewise.
    * daemon/lvm.c (do_lvremove, do_pvcreate, do_pvremove): Likewise.
    (do_pvresize): Likewise.
    * daemon/mount.c (do_mount_vfs): Likewise.
    * daemon/ntfs.c (do_ntfs_3g_probe): Likewise.
    * daemon/scrub.c (do_scrub_device): Likewise.
    * daemon/sfdisk.c (sfdisk, sfdisk_flag): Likewise.
    * daemon/swap.c (do_mkswap, do_mkswap_L, do_mkswap_U): Likewise.
    (do_swapoff_device, do_swapon_device): Likewise.
    * daemon/zero.c (do_zero): Likewise.
    * daemon/zerofree.c (do_zerofree): Likewise.

commit 8601bbda56cdb2b8491b6e2054596ec9599c38f1
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 10 22:50:00 2009 +0200

    update generator to emit each RESOLVE_DEVICE call
    
    * src/generator.ml: Emit RESOLVE_DEVICE (device, goto done);
    just before each Device-enabled do_$FUNCTION.

commit fc266e5ab8c4f013d0e473029c5e0b4cd32cca92
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 10 19:10:14 2009 +0200

    s/NEED_ROOT_OR_IS_DEVICE/REQUIRE_ROOT_OR_RESOLVE_DEVICE/

commit ecd828beb250648541492a69a188a71305897e4e
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 10 19:08:11 2009 +0200

    guestfsd.c: correct s/IS_DEVICE/RESOLVE_DEVICE/ in another comment

commit 302c18e7d095755ab1bcd0b79fd8952e2450ac7a
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 10 23:13:31 2009 +0200

    manually adjust ABS_PATH uses for new semantics
    
    * daemon/file.c (do_cat): fix an ABS_PATH use

commit 0dd6c8c8442d4ff588f6dac2efab24d3409b0dec
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 10 19:03:36 2009 +0200

    update all uses of ABS_PATH
    
    run this command:
      git grep -l -w ABS_PATH|xargs perl -pi -e \
        's/(?:ABS_PATH)( \(.*?,) (.*?)\)/ABS_PATH$1 return $2)/'

commit 4a5e13f15734aa7363e605f716ad6e29c67475c5
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 10 19:02:12 2009 +0200

    propagate semantic changes to NEED_ROOT, NEED_ROOT_OR_IS_DEVICE
    
    changing IS_DEVICE semantics leads to changing semantics of
    NEED_ROOT_OR_IS_DEVICE and NEED_ROOT, too.
    * daemon/daemon.h: Update definitions.

commit e8795f3e9cc7e60a5ad709c0e3b53f60e37fd6c0
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 10 18:54:51 2009 +0200

    convert the last few, manually

commit 1997858e90da728287ef26a6d01a5766ac914312
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 10 18:51:32 2009 +0200

    change almost all uses: s/IS_DEVICE/RESOLVE_DEVICE/
    
    Use this command:
      git grep -l -w IS_DEVICE|xargs perl -pi -e \
        's/\b(?:IS_DEVICE)\b( \(.*?,) (.*?)\)/RESOLVE_DEVICE$1 return $2)/'

commit 966dbd977f12b639169a48042b558834f627e5f8
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 10 18:49:55 2009 +0200

    * daemon/daemon.h (RESOLVE_DEVICE): Rename from IS_DEVICE.
    
    Change parameter from "errcode" (which would be returned) to "fail_stmt"
    so that a caller can specify e.g., "goto done" upon failure.

commit dd449ffba1a5fb3373d847ee1d7b26e9df3ccb1c
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 10 18:17:05 2009 +0200

    generator.ml: define new String-like type: "Device"

commit da90c9d8761caced81b9cf7d6e41180afa53ecb9
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Aug 13 11:48:27 2009 +0100

    Don't assume grub is on a separate boot filesystem
    
    Paths in grub.conf are relative to the filesystem containing it. grub parsing
    currently assumes that it is on /boot, and will fail if it isn't, for example
    because a guest only has a single partition.
    
    This patch makes grub parsing work harder to work out what grub paths are
    relative to. Firstly, it looks for a previous detected 'linux-grub' filesystem.
    If this isn't found, it tries to work out which filesystem contains
    /boot/grub/menu.lst and uses that.

commit d082a76d679b019784bc0b131028ee74e381f4a2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Aug 12 22:12:20 2009 +0100

    add_drive: Don't use cache=off if not supported by underlying filesystem.
    
    If you use the guestfs_add_drive function, then currently it
    generates a qemu command line element like:
    
      -drive ...,cache=off,...
    
    This causes qemu to try to open the device with O_DIRECT.
    Unfortunately some filesystems don't support this flag, notably tmpfs,
    which means you can't use libguestfs in conjunction with tmpfs.  On
    some systems /tmp is a tmpfs filesystem.
    
    This patch fixes this so that if the filesystem doesn't support
    O_DIRECT, then we omit the cache=off parameter.  This seems reasonable
    from a reliability point of view, because if you're using tmpfs then
    you probably didn't expect reliability in the case where your system
    suddenly powers off.

commit 67a679afb17747b5ec392e56cf6121b085b38a3a
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Aug 12 16:56:09 2009 +0100

    Add 'setcon', 'getcon' commands to set and get the SELinux context.

commit 27566d8323e4a8af59f5649aeeaef97ebd55cbd0
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Aug 12 18:23:17 2009 +0100

    Return error if allocations fail.

commit a9b0a6d54fe5fa6564f657650d4608240c71ea3a
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Aug 12 17:40:22 2009 +0100

    Add documentation for SELinux configuration.
    
    Also use L</...> to link between sections.

commit 0bf856930af2f5c45e9c24fd929a3feb25242d01
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Aug 12 17:40:07 2009 +0100

    Spelling fix: labelled -> labeled.

commit 2361905686c62b4163232139c3d390acd2c07916
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Aug 12 16:31:06 2009 +0100

    If using SELinux, mount /selinux in the appliance.
    
    If selinux=1 on the Linux kernel command line, then we mount
    /selinux in the appliance.  We will also bind-mount this
    directory into guests when we run commands.

commit 8157503b09e24667ddab833c1d12dd643ceac71b
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Aug 12 16:10:35 2009 +0100

    Allow selinux=? kernel flag to be controlled.
    
    Adds new API calls to set and get this flags.

commit bf76b637d25fb70f0320caa63e264104112feaab
Author: Jim Meyering <meyering@redhat.com>
Date:   Wed Aug 12 14:44:14 2009 +0200

    fish: don't read freed memory
    
    * fish/rc.c (rc_remote): Close file handle only *after* xdr_destroy,
    because that latter may flush its file handle (implicated via
    xdrstdio_create).  FYI, this failure is triggered for me only when
    MALLOC_PERTURB_ is set to nonzero < 256 in my environment.

commit f1d23409f7297c8435c939b919fe5c2331fd484e
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Aug 11 09:53:16 2009 +0200

    doc: improve emacs snippets
    
    * HACKING: Make (setq indent-tabs-mode nil) apply to nearly all
    files, not just C-mode ones.

commit 19bb2e59f4b976a0022fd1acb7b1620403985b70
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Aug 12 10:38:54 2009 +0100

    Fix regression test rhbz503169c10.sh.
    
    'll' command has changed semantics very slightly
    (see commit 6727e7c8bdf1cb39264a9de6333d228b51c39956).
    We need to fix this test so it doesn't try to run
    the ll command without a mounted disk.

commit 0aaf061c2f73f8852c59afaa9706f42bc578caae
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Aug 11 19:35:04 2009 +0100

    Add contents of /proc/mounts to the debugging information.

commit 6727e7c8bdf1cb39264a9de6333d228b51c39956
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Aug 11 13:16:27 2009 +0200

    daemon/ls: make do_ll require root, like all the rest
    
    * ls.c (do_ll): Do invoke "NEED_ROOT" here, and add a FIXME to
    provide a "debug ll" command with the semantics we're removing.

commit 9f7ebef3d464a2e40fae75012201a5da2740b99c
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 10 15:00:48 2009 +0200

    build: avoid first-time configure-from-clone failure
    
    * bootstrap: Run autopoint before using the file it creates,
    po/Makevars.template.  Reported by Richard Jones.  Details here:
    https://www.redhat.com/archives/libguestfs/2009-August/msg00135.html

commit 13a499406fe43ab3a6d4d13c660f6a8b368e638f
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 10 12:44:09 2009 +0200

    build: enable automake's silent rules option
    
    * configure.ac: Use AM_SILENT_RULES([yes]).
    Those who want verbose build output may configure with
    --disable-silent-rules or use "make V=1".
    * daemon/configure.ac: Likewise.

commit 92ac2400a326256ef819e0195d7ecfa7f03645be
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 10 12:17:00 2009 +0200

    build: daemon/do_debug: parameters aren't always unused
    
    * daemon/debug.c (MAYBE_UNUSED): Define.
    (do_debug): Mark parameters as unused only when they really
    are unused.  Spotted by Richard Jones.
    
    SCALAR(0xdd8370)
    prefer sizeof *VAR sizeof TYPE (no semantic change)

commit 98869b86413ff59afa009f9d06ebc0cc4477ab31
Author: Jim Meyering <meyering@redhat.com>
Date:   Thu Aug 6 16:05:44 2009 +0200

    build: avoid warnings in daemon/inotify.c
    
    Avoid "comparison between signed and unsigned integer expressions"
    warnings.  If it's at all hard or risky to avoid this type of warning,
    then it's not worthwhile.  Here, it's easy and safe.
    * daemon/inotify.c (inotify_posn): Declare local to be of unsigned type.
    (do_inotify_read, do_inotify_files): Likewise.

commit 835f6b2c067f3105a330f1a4309eade3afc80ee6
Author: Jim Meyering <meyering@redhat.com>
Date:   Thu Aug 6 15:28:48 2009 +0200

    build: avoid warnings in daemon/guestfsd.c
    
    * daemon/guestfsd.c (print_arginfo, print_shell_quote): Mark each
    "info" parameter as unused.

commit 5b3452e99992ffb2cee7e6353243b553cdc74a46
Author: Jim Meyering <meyering@redhat.com>
Date:   Thu Aug 6 15:26:13 2009 +0200

    build: avoid warnings in daemon/debug.c
    
    * daemon/debug.c (do_debug): Mark parameters as unused.

commit 7c68bcde3d34047cfbae45fb26a221a52ab6e3ea
Author: Jim Meyering <meyering@redhat.com>
Date:   Thu Aug 6 15:25:03 2009 +0200

    define ATTRIBUTE_UNUSED
    
    * daemon/daemon.h (__attribute__, ATTRIBUTE_UNUSED): Define.

commit 894d7c6733373bb333a4e148cf17c0aab97b8f96
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Aug 7 20:07:03 2009 +0200

    daemon/file.c: remove duplicate absolute-path check
    
    * daemon/file.c (do_file): Remove redundant use of ABS_PATH.
    It's redundant because the preceding line invokes NEED_ROOT_OR_IS_DEVICE,
    which also invokes ABS_PATH.

commit c8419d45c8ca6d0592a5a47399988908fd550d3f
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri Aug 7 17:38:44 2009 +0100

    Tidy up generation of java/Makefile.inc.
    
    (Just whitespace and comment changes, and small restructuring
    of the code).

commit f0d6be10c2d7bbf49bfa1cdbcb99e356458aa60f
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri Aug 7 09:51:04 2009 +0100

    Debug: Improve the way the qemu command line is printed.
    
    Change the way the qemu command is displayed to look like
    this:
    
    /usr/bin/qemu-kvm \
        -drive file=/tmp/test.img,cache=off,if=virtio \
        -m 500 \
        -no-reboot \
        -kernel /tmp/libguestfsHBJHRh/kernel \
        -initrd /tmp/libguestfsHBJHRh/initrd \
        [...]
    
    This allows the command line to be copied and pasted directly
    into the shell, and also makes it simpler to read.

commit b5b87cdb764dc757295316878a7fd6e2ff01bec4
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri Aug 7 09:31:35 2009 +0100

    Allow network interface to be configured.
    
    Add ./configure --with-net-if=(virtio|ne2k_pci) option.
    
    This lets you workaround the following virtio_net bug:
    
    https://bugzilla.redhat.com/show_bug.cgi?id=516022

commit 39e4f1dad208124640f0f795518390ba680a9704
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri Aug 7 08:32:56 2009 +0100

    Tests: swapon_device test mkswap /dev/sda1 instead of /dev/sdb.
    
    On RHEL 5, mkswap /dev/sdb fails, even with the '-f' option
    (contradictory to what the manual page says).
    
    This commit adds a new 'InitPartition' initialization which
    just creates /dev/sda1, and then does the swap test on that.

commit 530a90d3d4d7d107f52ac8db90fdb86c4f3e1737
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Aug 6 18:46:57 2009 +0100

    Always pass mkswap -f parameter.
    
    Otherwise mkswap will give a silly error if you ask it to
    swap on a whole device.

commit a8a4ce2bd3fd021e063cb3b939b45059f07ed053
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Aug 6 18:40:59 2009 +0100

    Tests: Don't test block size in statvfs test.
    
    The block size changes between kernel releases, causing
    a false failure in the tests.  The error was:
    
    test_statvfs_0: bsize was 65536, expected 131072

commit 6abec8f18473b8f373fb48a05265c0c5df881ff5
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Aug 6 17:02:25 2009 +0100

    Version 1.0.66

commit 1503652d07683b21c69a16f6e6f6af9aef84b839
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Aug 6 15:44:20 2009 +0100

    RHEL 5: inotify_init1 call did not exist on RHEL 5.

commit 690472768c2b94daaca3c9980bc31fcd6b09e8b7
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Aug 6 14:35:46 2009 +0100

    Fix: segfault in tab completion (RHBZ#516024).
    
    Actually this fixes two bugs: 'strs' was not being freed on every
    path, and the tab completion segfault described in the bug report.

commit 2b8019e56cf40fe8e8223b4e57cfd590495e8e60
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Aug 6 14:14:18 2009 +0100

    Fix errno check in readdir in devsparts.c

commit 5d78de834c53bfe29d2cc0397ac093428abe8425
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Aug 6 13:38:17 2009 +0100

    Add ne2k-pci driver to the appliance.
    
    This allows people to use the ne2k-pci network driver, for those
    situations where the virtio_net driver is broken (cough 516022 cough).

commit fbb3482a48b46f2ae51fb7600926fc04dc2c5ef1
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Aug 6 12:52:49 2009 +0100

    Make user network numbering explicit.
    
    Use:
     -net user,vlan=0,net=10.0.2.0/8
    just to make the (already implicit) 10.0.2.x network explicit.

commit 2237c2a2b2015388a19236f5bf4d966a045b388b
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Aug 6 12:10:52 2009 +0100

    appliance: More debug added to /init.

commit 12aedab609e09bdf8dd304487940d9d4ea46cb79
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Aug 6 13:07:51 2009 +0100

    Exclude daemon/lib and daemon/tests from being added to po/POTFILES.in

commit d35528d2405038b5864c8bfa85bd30d0f1485261
Author: Jim Meyering <meyering@redhat.com>
Date:   Thu Aug 6 07:50:11 2009 -0400

    build: remove bootstrap's --gnulib-srcdir option
    
    ...because it probably didn't work, and even if it did, we've
    discovered that using a separate git repo like that can lead
    to subtle mix-ups.
    Also, fix invocation of gnulib-tool in daemon/.

commit 03e59ae92a640def5e651eb092e8e8dba8c0daab
Author: Jim Meyering <meyering@redhat.com>
Date:   Thu Aug 6 13:47:48 2009 +0200

    build: fix build failure
    
    * bootstrap (gnulib_tool): Create lib and tests directories
    under daemon/ before running gnulib-tool there.

commit e05ddc70f1fa6d1e8253d69c5d17e69bfad2be90
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 3 11:44:51 2009 +0100

    daemon: use gnulib
    
    * daemon/Makefile.am (SUBDIRS): Define.
    (AM_CPPFLAGS): Define, to include from gnulib's lib/
    (LDADD): Define, to link with gnulib's libgnu.a.
    * daemon/configure.ac: Use AC_CONFIG_AUX_DIR([build-aux]),
    gl_EARLY and gl_INIT.
    (AC_CONFIG_FILES): Add lib/Makefile and tests/Makefile
    * daemon/m4/gnulib-cache.m4: New file, generated by running
    ../.gnulib/gnulib-tool --import --with-tests hash
    * daemon/.gitignore: Ignore all of the imported files.
    build: tell bootstrap about daemon/
    * bootstrap: Run gnulib-tool --update in daemon/.
    Remove bootstrap's --gnulib-srcdir option, because it probably
    didn't work, and even if it did, we've discovered that using
    a separate git repo like that can lead to subtle mix-ups.

commit 315b3069a083c89921f8ee44de19c53cea7e3b11
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Aug 6 11:01:20 2009 +0100

    appliance: Include more debug output in the /init script.
    
    Output more debugging information from this script, to enhance the
    usefulness of LIBGUESTFS_DEBUG output.

commit 98bc29fda446f5c667f4bc799161b3446bfc2ca1
Author: Matthew Booth <mbooth@redhat.com>
Date:   Mon Aug 3 16:04:50 2009 +0100

    Recognise cd-rom devices in devsparts.c
    
    Also:
    * Un-duplicate device detection code by creating a common mapping function.
    * Add some more comments.

commit b1e3c305f8e604a527c2f6b5a8f61cfebeec2b41
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Aug 5 23:33:22 2009 +0100

    Fix test failures in upload and download (RHBZ#515764)
    
    The tests hardcoded an MD5 of the test file, COPYING.LIB, whose contents had
    change. This change causes it to compute the MD5 rather than hardcoding it.
    
    OCaml provided by rjones.

commit 65326fe130cbb08ca797f257b552f301f0cec412
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Aug 6 08:56:39 2009 +0100

    Add copyright and license notice to regressions/test-noexec-stack.pl

commit e725c8bab2b1246d53309ba603d4c7f5b22cfdda
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Aug 5 17:32:02 2009 +0100

    Add some newly-untracked files to .gitignore

commit 8eb7f1a58f424ad0f210fe638574b5067d2ac97b
Author: Matthew Booth <mbooth@redhat.com>
Date:   Mon Aug 3 20:29:24 2009 +0100

    Fix swapon_label test
    
    The swapon label test has a side-effect, in that it creates a new partition.
    This causes the later failure of the list_partitions test.
    
    This change causes the swapon_label test to zero /dev/sdb after the test, and
    then re-read the partition table.

commit 634c033df2e698e1fcc692585fa445d019f0b6e6
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Aug 5 16:00:12 2009 +0100

    Add resultant change to po/POTFILES.in
    
    I missed this when committing 7e9cb884492aec243337ffc8e4432a9ff2690956

commit 7e9cb884492aec243337ffc8e4432a9ff2690956
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Aug 5 14:55:54 2009 +0100

    Add a test for an executable stack in resultant binaries

commit a86f512716d0e9054d4c409ef77b0115e8e1d56a
Author: Jim Meyering <meyering@redhat.com>
Date:   Wed Aug 5 08:01:38 2009 -0400

    build: generate some just-removed files in po/
    
    * bootstrap: Generate po/Makevars and po/LINGUAS.

commit 0c463dd0aa962c405b1be32c925acf9891c96bfc
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Aug 4 14:21:32 2009 +0200

    build: remove trailing blank lines; enable the syntax-check rule
    
    * cfg.mk (disable_temporarily): Remove sc_prohibit_trailing_blank_lines.
    * appliance/Makefile.am: Remove trailing blank line(s).
    * appliance/debian/modules/y0_install-guestfsd: Likewise.
    * appliance/make.sh.in: Likewise.
    * appliance/packagelist.in: Likewise.
    * appliance/update.sh.in: Likewise.
    * haskell/run-bindtests: Likewise.
    * ocaml/run-bindtests: Likewise.
    * python/run-python-tests: Likewise.
    * recipes/squashfs.example: Likewise.
    * ruby/run-ruby-tests: Likewise.

commit 3625b0198c74f2e01eb76b99dadba3a80f97a880
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Aug 4 14:19:29 2009 +0200

    build: exempt symlinks from trailing-blank-line prohibition
    
    * cfg.mk (sc_prohibit_trailing_blank_lines): Exempt symlinks.

commit a4c544ef1282b2ac73ce43885bd7a9691958958e
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Aug 4 14:03:17 2009 +0200

    build: enable syntax-check: TAB-only indentation in Makefiles
    
    * cfg.mk (disable_temporarily): Remove sc_makefile_TAB_only_indentation.

commit 1fc38df2dfe7e991e27d4c2fdd50fbd41ee9cf70
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Aug 4 14:01:38 2009 +0200

    build: tweak HACKING so we pass "make syntax-check"
    
    * HACKING: Convert leading TABs.

commit 8ae7e1057f43e9b79260cdf191f39d657fdf0293
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Aug 4 14:00:11 2009 +0200

    build: remove trailing blanks, enable syntax-check
    
    * regressions/test-cancellation-download-librarycancels.sh:
    * src/generator.ml:
    * cfg.mk (disable_temporarily): Remove sc_trailing_blank.
    * .x-sc_trailing_blank: New file.

commit e15ff2113f5b2a7e0aa138c47c14e93268d25aed
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Aug 4 14:46:38 2009 +0200

    maint: use COPYING.LIB version 2.1
    
    * COPYING.LIB: Update to 2.1.
    * .x-sc_TAB_in_indentation: Also exempt COPYING.LIB.

commit dc3d0e3b8ed8e77b1314f09d116ed97f6a440914
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Aug 4 13:55:51 2009 +0200

    build: don't emit trailing blanks, remove generated file
    
    * ocaml/Makefile.am (.depend): Don't redirect directly to $@.
    Filter out trailing blanks.
    * ocaml/.depend: Regenerate.

commit febff9d2a35c4f40abbaf8943146476bdeac671e
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Aug 4 13:49:19 2009 +0200

    build: remove more files added by ./autogen.sh
    
    * po/LINGUAS: Remove file.
    * po/Makefile.in.in: Likewise.
    * po/Makevars: Likewise.
    * po/Rules-quot: Likewise.
    * po/boldquot.sed: Likewise.
    * po/en@boldquot.header: Likewise.
    * po/en@quot.header: Likewise.
    * po/insert-header.sin: Likewise.
    * po/quot.sed: Likewise.
    * po/remove-potcdate.sin: Likewise.

commit f5034ceb5b7ec349ae19a8abdeec85835183d8ea
Author: Jim Meyering <meyering@redhat.com>
Date:   Tue Aug 4 04:47:17 2009 -0400

    build: tell aclocal to search gnulib/m4, too
    
    * Makefile.am (ACLOCAL_AMFLAGS): Append "-I gnulib/m4".

commit 4c2c2793bad56ce05caf6244e10fd5bcd7023383
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 3 10:55:34 2009 -0400

    Document and enforce the new spaces-only indentation policy.
    
    * cfg.mk (disable_temporarily): Remove sc_TAB_in_indentation,
    to enable the "make syntax-check" that enforces this.
    * .x-sc_TAB_in_indentation: New file.  Exceptions.
    * HACKING: Document the policy, with tips on how to conform.

commit 2f1a50d81671810256dce0852e6b1e0810ac44af
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 3 11:10:13 2009 -0400

    Convert all TABs-as-indentation to spaces.
    
    Do it by running this command:
    [exempted files are matched via .x-sc_TAB_in_indentation]
    
      git ls-files \
        | pcregrep -vf .x-sc_TAB_in_indentation \
        | xargs pcregrep -l '^ *\t' \
        | xargs perl -MText::Tabs -ni -le \
          '$m=/^( *\t[ \t]*)(.*)/; print $m ? expand($1) . $2 : $_'

commit 72c829395bb6a4800516d4f535e18af48195585b
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 3 11:00:22 2009 -0400

    Remove files imported via autogen.sh.
    
    * m4/.gitignore: Ignore these files.
    * m4/codeset.m4: Remove file.
    * m4/gettext.m4: Likewise.
    * m4/glibc2.m4: Likewise.
    * m4/glibc21.m4: Likewise.
    * m4/iconv.m4: Likewise.
    * m4/intdiv0.m4: Likewise.
    * m4/intl.m4: Likewise.
    * m4/intldir.m4: Likewise.
    * m4/intlmacosx.m4: Likewise.
    * m4/intltool.m4: Likewise.
    * m4/inttypes-pri.m4: Likewise.
    * m4/inttypes.m4: Likewise.
    * m4/inttypes_h.m4: Likewise.
    * m4/isc-posix.m4: Likewise.
    * m4/lcmessage.m4: Likewise.
    * m4/lib-ld.m4: Likewise.
    * m4/lib-link.m4: Likewise.
    * m4/lib-prefix.m4: Likewise.
    * m4/lock.m4: Likewise.
    * m4/longdouble.m4: Likewise.
    * m4/longlong.m4: Likewise.
    * m4/nls.m4: Likewise.
    * m4/po.m4: Likewise.
    * m4/printf-posix.m4: Likewise.
    * m4/progtest.m4: Likewise.
    * m4/signed.m4: Likewise.
    * m4/size_max.m4: Likewise.
    * m4/stdint_h.m4: Likewise.
    * m4/uintmax_t.m4: Likewise.
    * m4/ulonglong.m4: Likewise.
    * m4/visibility.m4: Likewise.
    * m4/wchar_t.m4: Likewise.
    * m4/wint_t.m4: Likewise.
    * m4/xsize.m4: Likewise.

commit c498ad1fea5a8ca7783a24929b472756f45c57a0
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 3 11:09:13 2009 -0400

    allow use of #if HAVE_CONFIG_H, for example code
    
    * .x-sc_prohibit_have_config_h: New file, to exempt examples.

commit ad7818c34d4d6ef6b0959ef7dbbf006968166030
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 3 15:39:09 2009 +0200

    guestfs: fix typo in my recent change
    
    * src/guestfs.c (guestfs_perrorf): Rename former err to errnum,
    to avoid compilation error.

commit 5fa153b18661e3651e1cc57bb3f477f9bef37f8f
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 3 15:21:44 2009 +0200

    Guard #inclusion of config.h in examples.
    
    * examples/hello.c [HAVE_CONFIG_H]: Include <config.h> conditionally.
    * examples/to-xml.c: Likewise.

commit 58e7e42033b1ac5044ae03f0aa5d5082c5fdb497
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 3 08:32:44 2009 -0400

    build: reenable "syntax-check" rule: sc_const_long_option
    
    * cfg.mk (disable_temporarily): Remove sc_const_long_option.
    * daemon/guestfsd.c (main): Declare long_options to be "const".
    * fish/fish.c (main): Likewise.
    * test-tool/test-tool.c (main): Likewise.

commit a3cceb6f1c9e55759f5d6a07bf5c74a7ea825dcd
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 3 05:53:26 2009 -0400

    build: temporarily disable failing "syntax-check" rules
    
    * cfg.mk (disable_temporarily): Define.

commit 480a489ee4c31cb2f9c9f45941645f05b5f74c67
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 3 05:18:10 2009 -0400

    maint: use a git submodule for gnulib
    
    * .gitmodules: New file, to track gnulib.
    * .gnulib: Submodule directory.
    * Makefile.am (EXTRA_DIST): Don't list config.rpath or
    gitlog-to-changelog.
    * autogen.sh: Adapt to use the new submodule.
    * cfg.mk: New file.
    (SUBDIRS): Add gnulib/lib and gnulib/tests.
    (dist-hook): Reflect new location of getlog-to-changelog.
    * configure.ac: Set build-aux/ as AUX_DIR.
    Invoke gl_EARLY and gl_INIT.
    (AC_CONFIG_FILES): Add gnulib/lib/Makefile and gnulib/tests/Makefile.

commit 3572996364d9d24406241dee5155048440053ecf
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 3 05:33:35 2009 -0400

    always include <config.h>
    
    * ocaml/guestfs_c.c: Include <config.h>.
    * examples/to-xml.c: Likewise.
    * examples/hello.c: Likewise.

commit d39310d10894808580f7c0cfb425083f55685e12
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 3 06:58:16 2009 -0400

    build: add -I option to get config.h.
    
    * ocaml/Makefile.am (AM_CPPFLAGS): Define.
    (guestfs_c.o, guestfs_c_actions.o): Use it.

commit d0fa2e6b7bccb00dbaae09a4d4c1a87b1dea0351
Author: Jim Meyering <meyering@redhat.com>
Date:   Mon Aug 3 08:43:54 2009 -0400

    guestfs: don't fault upon failed vasprintf
    
    * src/guestfs.c (guestfs_perrorf): Handle failed vasprintf.

commit 6279c4bbf9cbbe66917ce9ffa4b98eca9040bcd9
Author: Matthew Booth <mbooth@redhat.com>
Date:   Mon Aug 3 11:43:38 2009 +0100

    Cleanup whitespace warnings in Lib.pm

commit e2fa1fe4efcb3bbfe5b7cc2e98b10357abb59422
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Jul 31 17:31:54 2009 +0100

    Use grub entries to find Linux kernels
    
    This change adds grub parsing to Lib.pm. It adds the following structure to $os:
      {boot}
      ->{configs}
        ->[0]
          ->{title}   = "Fedora (2.6.29.6-213.fc11.i686.PAE)"
          ->{kernel}  = \kernel
          ->{cmdline} = "ro root=/dev/mapper/vg_mbooth-lv_root rhgb"
          ->{initrd}  = \initrd
      ->{default} = 0
    
    The kernel and initrd entries are just references to their top level entries
    under kernels and initrd_modules respectively.
    
    It also changes the way Linux kernels and initrd are discovered. Instead of
    searching /lib/modules and /boot for files with matching names, kernels and
    initrds are scanned as they are discovered in grub.conf.
    
    Additionally, the following attributes are added to the kernels top level entry:
    * path
        The path to the kernel's vmlinuz file.
    * package
        The name of the package which installed the kernel.
    
    The xml output of virt-inspector is updated to reflect all of the above changes.

commit 1ba754119a43c4dd715d2e0a4637e50e10ac6987
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 31 23:24:11 2009 +0100

    guestfish: Display RStructList results more pleasantly.

commit 4610db9f1b77f8c263b348fda1974be165a7f841
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 31 22:31:05 2009 +0100

    Add interface to Linux 'inotify' API.

commit 804330120dcbedc754174fdfdf13cf7577a7eba9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 31 15:57:46 2009 +0100

    lib: Add selinux=0 to default kernel command line.
    
    SELinux exists in a very disturbed state if it is enabled at
    boot time, but no policy is loaded.  In particular, it messes
    up the security.selinux extended attributes on files in a
    not-very-useful way.
    
    We can't enable SELinux because we don't know what policy
    can or should be loaded.  Therefore it's best to disable it
    completely.

commit 8647c4ada502d0ce2b940f9e9cd47378d99a9164
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Jul 31 14:30:09 2009 +0100

    Update incorrect comment in Lib.pm
    
    Related: change the name of the function the comment describes to be more
    accurate.

commit 686f28dd7eb98c17aa98c981adf64c53af99e125
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 31 12:12:29 2009 +0100

    Improve warnings about missing tests.
    
    Don't warn where a command just has no tests.
    
    Instead check other commands' tests so we get a definitive
    (and much smaller) list of commands that are not tested anywhere.

commit 77b2275dfcebce16ceea17ddf77a7f9d0a41c082
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 31 11:55:38 2009 +0100

    New commands: swapon-*, swapoff-*, mkswap-file.
    
    swapon-device
    swapoff-device
    swapon-file
    swapoff-file
    swapon-label
    swapoff-label
    swapon-uuid
    swapoff-uuid
    mkswap-file

commit 0e6e32025885286e2de39efca34ced2aaf26b3a3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 31 08:57:10 2009 +0100

    New command: 'fallocate' to (pre-)allocate sized files.

commit afaff775c12f32b7912f194e2fcc8e76b8c82572
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 31 08:39:43 2009 +0100

    New commands: 'ln', 'ln-f', 'ln-s', 'ln-sf' and 'readlink'.
    
    These commands can be used to make hard and symbolic links.  The
    readlink command is used to read existing symbolic links.

commit 7c3a90f94cd6b8fec9cdd1c052b91a14c0ee0e0e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 31 07:39:30 2009 +0100

    Add 'realpath' command.

commit 641f6ae3bf14940d9057860fb022c2946c1daf1c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 31 07:40:57 2009 +0100

    Ignore failure of 'mv' commands in appliance Makefile.
    
    A lot of people report these as 'errors' when they are not.
    Hide the error messages.

commit bbe5877b6c86ace6f27c6f95c559a61888693923
Author: Jim Meyering <jim@meyering.net>
Date:   Thu Jul 30 14:03:48 2009 +0200

    configure.ac: more quoting
    
    Also, prohibit an invalid value of $JAVA_HOME,
    since it must be used unquoted below.

commit 995752f9ca73c0991d969d26be7494914b5f3aaf
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jul 30 12:10:52 2009 +0100

    build: If guestfwd test fails, need to print AC_MSG_RESULT 'no'

commit 8aa10e0bd024eed36f15a7e1fbe889e374425e09
Author: Jim Meyering <jim@meyering.net>
Date:   Thu Jul 30 10:50:49 2009 +0200

    build: fix test for --nocompress option
    
    Richard W.M. Jones wrote:
    > On Wed, Jul 29, 2009 at 10:50:44PM +0200, Jim Meyering wrote:
    >> The test for febootstrap-to-initramfs' --nocompress option
    >> was always failing for me on F11.  Here's why:
    > [...]
    >
    > Ouch that's obscure.  I've applied this patch and the previous
    > one you sent too.  Thanks!
    
    Our messages crossed.
    Rebasing my fixed patch and adjusting the log:
    
    >From 9e7846da50ceeee57187f703835bd3975e789719 Mon Sep 17 00:00:00 2001
    From: Jim Meyering <meyering@redhat.com>
    Date: Wed, 29 Jul 2009 16:33:02 -0400
    Subject: [PATCH] build: quote the other option test similarly
    
    * configure.ac: Quote properly.

commit fe1f08254967f7d053101fe3c5171346ae2be93e
Author: Jim Meyering <jim@meyering.net>
Date:   Wed Jul 29 22:50:44 2009 +0200

    build: fix test for --nocompress option
    
    The test for febootstrap-to-initramfs' --nocompress option
    was always failing for me on F11.  Here's why:
    
      $ bash                               ~/w/co/libguestfs:210-comment-fix
      $ t=`febootstrap-to-initramfs 2>&1`
      [Exit 1]
      $ if ! echo $t|grep -sq -- --nocompress; then echo not found; fi
      not found
    
    Notice: without quotes, the [--nocompress] term expands to "k",
    because I happen to have a temporary file named "k":
    
      $ echo $t
      Usage: febootstrap-to-initramfs [--files=filelist] k DIR Please read
      febootstrap-to-initramfs(8) man page for more information.
      $ echo "$t"
      Usage: febootstrap-to-initramfs [--files=filelist] [--nocompress] DIR
      Please read febootstrap-to-initramfs(8) man page for more information.
    
    a simpler example gives a clue:
    
      $ touch a b c
      $ echo [--z]
      a b c
      $ echo [--a]
      a
      $ echo [--b]
      a b
    
    it's interpreting [--nocompress] as a range: "-" through "n", plus
    the other characters, ocmpres.  "k" falls in the --n range.
    
    Anyhow, here's the fix:
    
    >From 84855642ed41828d01d55123cfab8d8dede759c1 Mon Sep 17 00:00:00 2001
    From: Jim Meyering <meyering@redhat.com>
    Date: Wed, 29 Jul 2009 16:33:02 -0400
    Subject: [PATCH] build: fix test for --nocompress option
    
    * configure.ac: Fix underquoting bug that would cause the test
    for febootstrap-to-initramfs' --nocompress option always to fail
    with certain-letter-named files in the top directory.

commit 5fd9891646a16792dda91505db6610ad9e36a704
Author: Jim Meyering <meyering@redhat.com>
Date:   Wed Jul 29 14:48:45 2009 -0400

    fix comments; move declarations
    
    * daemon/devsparts.c (do_list_devices, do_list_partitions):
    Remove stray words in comments.
    Move declarations down to definition.

commit d58084f387f8e141224d06169959eb0854dd9bc2
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Jul 29 23:02:42 2009 +0100

    Whitespace and comment changes.

commit a9b5fc1e39350c36f78cc19e2f066a3c315c8751
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Jul 29 22:53:23 2009 +0100

    df: Fix alignment of columns.

commit f8f10578093e926f5f36289a6c11615d067fbcad
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Jul 29 21:34:06 2009 +0100

    guestfish: Make more strings translatable.
    
    However this doesn't yet attempt to translate the POD
    command documentation.  We need a plan to do that.

commit 7c4f90ddb8378dcf90cb0cc219105dccaa8a9d6e
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Jul 29 18:46:55 2009 +0100

    tests: Use squashfs for static data where possible.
    
    Instead of creating a new InitBasicFS for just about every test,
    where a test doesn't need to write to the filesystem it is far
    faster to use prepared data on an InitSquashFS instead.
    
    This commit changes as many tests as possible to make this so,
    making the tests much faster.

commit bf2b08560f649c22152e4138531ad0b46b4ad1b3
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Jul 29 18:44:46 2009 +0100

    tests: Fix read_file test.
    
    The test ignored the fact that this function returns a (char *, size_t)
    pair, and just treated the char * as a string.  This of course would
    fail if the string didn't happen to be nul-terminated.
    
    The tests are updated to add a new TestOutputBuffer type which should
    be used with functions that return RBufferOut.

commit 9847e0c07d5907887e26ec60192fa12aa46277ee
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Jul 29 18:10:48 2009 +0100

    Implement '*grep*' family of commands.

commit a3944a2b30daf2fb0239433ea8a862df16d36b6a
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Jul 29 16:51:10 2009 +0100

    Updated Polish translations (Piotr Drąg).

commit 330a601317afa4cc77f2108cb9af007e764eeacd
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Jul 29 16:09:29 2009 +0100

    Version 1.0.65.

commit 2f4459f55b9af7c86ad537b4e652cc8ebe10d080
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Jul 29 15:59:28 2009 +0100

    Updated PO files.

commit e6a3836772a6e9a769539b29e9988aaa5f140d40
Author: Jim Meyering <jim@meyering.net>
Date:   Wed Jul 29 14:16:03 2009 +0200

    build: avoid locale-specific changes in generated, VC'd file
    
    When I build with LC_ALL=C in my environment,
    the all-local rule generates po/POTFILES.in that
    is sorted differently from the on that is checked in:
    
        diff --git a/po/POTFILES.in b/po/POTFILES.in
        index ca01b3d..154915a 100644
        --- a/po/POTFILES.in
        +++ b/po/POTFILES.in
        @@ -63,12 +63,11 @@ fish/tilde.c
         fish/time.c
         inspector/virt-inspector.pl
         java/com_redhat_et_libguestfs_GuestFS.c
        -ocaml/guestfs_c_actions.c
         ocaml/guestfs_c.c
        +ocaml/guestfs_c_actions.c
         perl/bindtests.pl
        -perl/Guestfs.c
        -perl/lib/Sys/Guestfs/Lib.pm
         perl/lib/Sys/Guestfs.pm
        +perl/lib/Sys/Guestfs/Lib.pm
         python/guestfs-py.c
         ruby/ext/guestfs/_guestfs.c
         src/guestfs-actions.c
    
    If we generate that file so that sort always uses the C locale, then,
    this type of difference will not arise.  Here's the patch to fix the
    rule as well as to reflect the change in the generated file:
    
    >From 609e1d1840da25614a7c9e8954e5356050c9f2ad Mon Sep 17 00:00:00 2001
    From: Jim Meyering <meyering@redhat.com>
    Date: Wed, 29 Jul 2009 08:13:35 -0400
    Subject: [PATCH] build: avoid locale-specific changes in generated, VC'd file
    
    * Makefile.am (all-local): Use LC_ALL=C to sort in C locale.
    * po/POTFILES.in: Regenerate.

commit 4fbd283c67831d8ef0f0b49045b3369f3ce036db
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 29 16:01:23 2009 +0100

    On RHEL 5, 'file' command prints 'AMD x86-64' for 'x86-64' arch.

commit b742f0874798050d31ef31fb7f66053e34d36194
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Jul 29 15:55:17 2009 +0100

    Run cpio with --quiet option so it doesn't print 'xx blocks'

commit aa999d0586fd69094cb06ccb3ae5c429649662e0
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Wed Jul 29 15:49:48 2009 +0100

    Lib.pm: Skip tests if perl-libintl module is not available.

commit 8b854734bd13b7f68b72422932de3bf24c84ca15
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Jul 29 15:33:22 2009 +0100

    Lib.pm: Use Perl backtick instead of slurp (Aron Griffis).

commit 25c4b0190c22e3bdc5594aff994c8e8f99db5ab3
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Wed Jul 29 15:02:16 2009 +0100

    Don't show empty CD devices (RHBZ#514505).

commit 2d5b0e7599b456d6817b0f225f5ed4ce4795d043
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Jul 29 12:45:11 2009 +0100

    ocaml: Rebuild the tests from source if the main library changes.

commit 06df9ec2413d7f5ae366bfab1b2177d7b3929837
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Jul 29 09:48:08 2009 +0100

    inspector: Determine guest architecture.
    
    This commit adds kernel and userspace architecture detection
    (fully for Linux, partially for Windows).  It adds an architecture
    for each kernel detected, and an architecture for each root (ie.
    userspace) found.

commit 1f65b900f0f17a700035dea9a76b910504f4507c
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Jul 28 17:55:35 2009 +0100

    Lib.pm: Add file_architecture command.
    
    This command detects the architecture of some types of binaries,
    libraries, kernel modules and initrd images.

commit 7cbd1bbdd5e613561ea7227081f7ddd666b98ee0
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Jul 29 10:15:06 2009 +0100

    Lib: Document the $ro parameter for mount_operating_system properly.

commit 4ce1433497e625b4060add414c1d0bc7a9a30392
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Jul 29 09:39:02 2009 +0100

    Mention related tools in the manual page.

commit ad7497c533cc5c24f667104bebbfa5f6dda8c8f6
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Jul 28 17:14:14 2009 +0100

    Whitespace: indent some names in images/Makefile.am correctly.

commit a82bfb88e553c6626c99757779f9b500664409ba
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Jul 28 15:43:14 2009 +0100

    Lib.pm: Use 'file' as replacement for 'zfile'.

commit 549bba81e739ab10d8013c9ca88ce70b0ddda8e4
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Jul 28 15:29:23 2009 +0100

    Pass '-z' parameter to 'file' command so it looks inside compressed files.
    
    Also we deprecate the old 'zfile' command.

commit 6fe5a945c5cf8094f4d0bf05763418ec20f4c5f2
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Jul 28 15:24:44 2009 +0100

    Add DeprecatedBy flag to mark functions which are deprecated.

commit 75c9b770ad23af1bece9df3b8c87eb9f60ab2024
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Jul 28 15:23:28 2009 +0100

    Need to declare asprintf_nowarn as inline to avoid gcc complaining.

commit 0f2e9c84e9ff1071260770930068642ecc8ac0d9
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jul 27 22:27:45 2009 +0100

    Replace shell_quote function with %Q and %R printf specifiers.
    
    %Q => simple shell quoted string
    %R => path will be prefixed by /sysroot
    
    eg. snprintf (cmd, sizeof cmd, "cat %R", path); system (cmd);

commit bf920f57677c67f903cf8c4c985ce3d290b1dbde
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jul 27 16:39:02 2009 +0100

    Add InitSquashFS test type, for tests that just use the squashfs (/dev/sdd).
    
    This also speeds up those tests because we don't have to wait
    to create a filesystem which is never used.

commit 22eb7fc966bafebedfde437c9b9c9fb903a8bc35
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Jul 24 14:56:38 2009 +0100

    Make read-only optional in mount_operating_system()

commit 3385d7a1bf6afb8508ce334c6231c35cbe2fbae0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 24 18:29:42 2009 +0100

    More ideas on a quick Perl one-liner syntax for TODO file.

commit 3082681cc661011c8745936cc8c05e6fa84e0b98
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 24 15:46:15 2009 +0100

    guestfish -iv should print virt-inspector command (for debugging).

commit d296feb05fbbd331a4ae3ed3e18bb822acdc13c8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 24 14:36:50 2009 +0100

    Reformat the TODO file.

commit 9e8e99c921bccb9ac3b3965a7d689ff443799426
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri Jul 24 09:31:49 2009 +0100

    Pass cgroup_disable=memory, saves ~ 5MB of RAM.

commit 6a0d9a9937162eee090f8dc331921724aef5784d
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jul 23 18:57:05 2009 +0100

    get_append call can return NULL, but bindings didn't handle it.
    
    It's not a good idea because there is no way to return an error
    indication.  However at least this means it won't segfault.

commit 9af502eff08017941a58ad676d0cbb867f83a341
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jul 23 12:45:12 2009 +0100

    RHEL 5 thinks squashfs is HFS+ filesystem, unless we specify the type explicitly.

commit 9c32abcbf6d5c3350e8e3ec4ab6cb4a8c4d1392f
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jul 23 11:16:15 2009 +0100

    Remove hard-coded qemu-kvm, replace with $QEMU.

commit 23cc897c1e2e4d3cd2cff5c7b9c74ebc54e8fff1
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jul 23 10:45:36 2009 +0100

    Version 1.0.63

commit f9de01b9b97e3d13959754446464f9b768deea81
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Jul 22 20:58:39 2009 +0100

    Add libguestfs-test-tool.
    
    This is an end-user testing tool, designed to test basic functionality
    of libguestfs/qemu/kernel combination on the end-user's final host
    machine.
    
    It does not perform a thorough test, but should be enough to find
    most booting issues.
    
    Also this is intended to be used when reporting bugs.

commit 26f69f706e8c661c6ae7946da1b9a4b7bf9150b9
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Jul 22 21:18:01 2009 +0100

    Fix typo in error message.

commit 23e6fc3f61294acf1bce2003dc4060df25e899f9
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Jul 22 21:11:10 2009 +0100

    Revert "Add 'set-kernel'/'get-kernel'/LIBGUESTFS_KERNEL to override appliance kernel."
    
    This reverts commit 34d2df41626f1ee4172a6d40b06d72d6ed9d6348.

commit 1a5755dbbff0fa4d87984cb7d67cb8239fd71a84
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Jul 22 13:42:51 2009 +0100

    set-append and set-kernel parameters are both nullable.
    
    (So are the return values, but leave that bug for another day).

commit 34d2df41626f1ee4172a6d40b06d72d6ed9d6348
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Jul 22 13:35:48 2009 +0100

    Add 'set-kernel'/'get-kernel'/LIBGUESTFS_KERNEL to override appliance kernel.
    
    This allows you to override the appliance kernel with an easy
    command or environment variable.

commit afe8096e9aa2a18541e92262d9473de4a65fa29e
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Jul 22 12:39:21 2009 +0100

    Todo: Suggestion for 'replace' command.

commit 10258cadd0067cb49b89faf1ce424b1c01f5a7c3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 21 16:01:04 2009 +0100

    Add commented-out support for alternate guestfwd syntax.
    
    This commit just moves code around.  The new support is not enabled
    because it doesn't work.  See qemu-devel, subject
    "guestfwd option doesn't allow supplementary ,server,nowait"

commit b2ae7ed6e67b3cf596e1000ec5219bbefb6123dd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 21 15:59:35 2009 +0100

    configure: Detect new-style guestfwd support (RHBZ#512957)
    
    However new qemu 0.10.5 still doesn't work.

commit 83458d26fafd027f5c5c18208b4937cbde6e5ad7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 21 13:34:46 2009 +0100

    Library: Pass more options on the Linux kernel command line.
    
    Always pass:
      noapic             (APIC causes problems for lots of people)
      udevtimeout=300    (for very slow qemu using softemu)
      acpi=off           (ACPI is troublesome and unnecessary, so turn it off)

commit 000f54aac80191b42e0c307440d09fafd4d5fac2
Author: Matthew Booth <mbooth@redhat.com>
Date:   Tue Jul 21 11:46:24 2009 +0100

    Split $os->{version} into $os->{major_version} and $os->{minor_version}

commit 98430c35faa073c60d4c00542c090fe0407c5af7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 21 11:47:57 2009 +0100

    Allow TMPDIR to override directory used for temporary files (RHBZ#512905).

commit e315e0723ec8c2f84809f06d7f2ede4955dd6c67
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 21 11:00:47 2009 +0100

    Generator: Implement RBufferOut and "read-file" call.
    
    This commit implements the RBufferOut type for returning
    arbitrary 8 bit data from calls.
    
    We also implement the guestfs_read_file call to read a
    whole file that can contain any 8 bit content, but up to
    a limit of ~ 2 MB.

commit f6eb8d44942c3d550c72933c406905f2cb86278d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 21 11:10:19 2009 +0100

    Docs: Fully document the guestfs_readdir ftyp return field.

commit 8ab8377ef64ec0e2483826388cf7d3c07ffa8ecc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 21 10:59:51 2009 +0100

    Docs: Add "API Overview" section to guestfs(3) manpage.
    
    This section collects together related API calls, to provide
    more coherent documentation about different ways to carry
    out actions such as uploading and downloading.

commit 039831c74c42553705abad99236ef6541e8dfcd5
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jul 20 19:04:40 2009 +0100

    Generator: Improve accuracy of a comment.

commit 7a14e0509d5cc976deda9b5299f56930e0317502
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jul 20 15:09:11 2009 +0100

    virt-inspector --fish: Fix incorrect '-a' parameter (RHBZ#512709)
    
    virt-inspector --fish dom
    virt-inspector --ro-fish dom
    
    Both of the above commands give incorrect results if run on a
    libvirt domain, eg:
    
    $ virt-inspector --ro-fish RHEL54Betax64
    ==> --ro -a RHEL54Betax64 -m /dev/VolGroup00/LogVol00:/ -m /dev/sda1:/boot
                ^^^^^^^^^^^^^
    
    This is because the current code just prints back the original @ARGV
    parameters.
    
    This patch fixes this by getting the image names instead.

commit 06f6cc32f02c25b88e763237332b17dc7c6c6837
Author: Matthew Booth <mbooth@redhat.com>
Date:   Mon Jul 20 11:16:55 2009 +0100

    Replace 'distrofamily' with feature tags
    
    It turns out that the distribution hierarchy is not as reliable concept as you
    might think. This patch removes distrofamily again.
    
    Instead of distrofamily, we will add feature tags. This patch adds 2 feature
    tags for Linux distributions:
    
    package_format (eg rpm/dpkg)
    package_management (eg rhn/yum/apt)
    
    This change is reflected in the output of virt-inspector

commit 503bd498dac5689f84983b583035a9a4a1f9e756
Author: Guido Günther <agx@sigxcpu.org>
Date:   Sat Jul 18 18:20:29 2009 +0200

    add nls_base.ko and nls_cp437.ko for vfat

commit 78029b529ad98769685d607230b70f71832d5906
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Sat Jul 18 10:43:52 2009 +0100

    Make /sysroot path configurable.
    
    Currently /sysroot is hard-coded throughout the daemon code.
    
    This patch turns the path into a variable so that we can change
    it in future, for example to allow standalone mode to be implemented.
    
    This patch was tested by running all the C API tests successfully.

commit e8c954933b2bfb3bc3ead5a151d49d164f1a8eab
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri Jul 17 17:40:30 2009 +0100

    Version 1.0.62.

commit 8ae10a31ab249994783e3cbcb0b8ee4b2fc591a0
Merge: b993f75 9e90b24
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri Jul 17 16:33:30 2009 +0100

    Merge branch 'master' of git+ssh://g-rjones@et.redhat.com/git/libguestfs

commit b993f75d55240187fb5f62f87e303490bfc68d86
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 17 16:32:05 2009 +0100

    RHEL 5.4 fix: Check for qemu-kvm binary in /usr/libexec

commit 9e90b24c7d76489f93830377e3d7d3c37f36c30c
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Jul 16 23:48:25 2009 +0100

    Differentiate 'distro' and 'distrofamily' in Sys::Guestfs::Lib
    
    Change distro in the output formally known as virt-inspector to reflect the
    actual distro. Possible values are now: fedora, rhel, centos, scientific,
    debian.
    
    Add new distrofamily entry which is one of: redhat, debian. Currently all
    distros except 'debian' are in the redhat family.
    
    This allows you to, for example, select a RHEL/CentOS/Scientific Linux specific
    kernel for installation rather than assuming they're all the same.
    
    Note this also changes the behaviour of virt-inspector --query. It will now only
    return rhel=yes for RHEL.

commit 2ab233b3124f4dd3e7c686de110d9a97cc525c18
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri Jul 17 09:37:37 2009 +0100

    cat: Example of finding DHCP IP address of a VM.

commit 963576e9001c658d2e386a992f39a768eac3894c
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri Jul 17 09:37:18 2009 +0100

    Fix non-srcdir builds: Ignore perl/Makefile-pl.old

commit 4c54721ad46b77c52eb6bb7e3ffe74325ac52797
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri Jul 17 09:36:28 2009 +0100

    Fix non-srcdir builds: further fixes to OCaml build rules.

commit 4d321bc8f157dac4bad828287758f92ea5a5173a
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jul 16 19:29:47 2009 +0100

    Fixes for non-srcdir builds: Only include POTFILES from SUBDIRS directories.

commit 0c4ec8c09a40f6c1aa18e87231bded3cfdbdb53b
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jul 16 19:27:16 2009 +0100

    Fix non-srcdir builds: fix OCaml build rules.

commit 551baf3082bf4a346a8320df182cb3840418388f
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jul 16 18:52:44 2009 +0100

    Fix non-srcdir builds: Files generated by configure should be in the tarball.

commit ebc5a981dc9219f6e4c33b8918be8753c4fc878c
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jul 16 18:32:57 2009 +0100

    Fix non-srcdir builds: Don't include generated *_protocol.c files in POTFILES.

commit 6bb4c300addd0776d9f74653b98383c717bc29a1
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jul 16 18:31:25 2009 +0100

    Don't clean up some non-generated files.

commit 811b4a51dc25219e19527304892e7f688867e105
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jul 16 18:23:53 2009 +0100

    Fix for non-srcdir builds: more misc fixes.

commit 98515732084c6856c2e22364b2ae64113c2c37c6
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jul 16 18:08:44 2009 +0100

    Fix for non-srcdir builds: Run src/generator.ml from the srcdir.
    
    Note that files generated by src/generator.ml are stored in
    the srcdir, *not* the builddir.  The reason is so that they
    can be included in the tarball and will appear in the srcdir
    for tarball builds.

commit a865795a7edfdc939cf3864ca1b7ea9cdc564dc7
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jul 16 18:04:01 2009 +0100

    More misc fixes to non-srcdir builds.

commit 4f3736162076419641a6225ac28b29d340020604
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jul 16 17:52:59 2009 +0100

    More misc fixes for non-srcdir builds.

commit fd6fecea052b608db0e7b328b1b4a2669258a66f
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jul 16 17:15:40 2009 +0100

    Miscellaneous fixes for non-srcdir builds.

commit 7428b0a70caed014d0cb4126fe8a77432d8957c6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 15 23:12:02 2009 +0100

    New commands: 'mkmountpoint' and 'rmmountpoint'
    
    These specialized commands are used to create additional mountpoints
    before mounting filesystems.  They are only used where you want to
    mount several unrelated or read-only filesystems together, and need
    additional care to use correctly.
    
    Here is how to use these calls to unpack the "Russian doll" nest
    of a Fedora 11 live CD:
    
     add-ro Fedora-11-i686-Live.iso
     run
     mkmountpoint /cd
     mkmountpoint /squash
     mkmountpoint /ext3
     mount /dev/sda /cd
     mount-loop /cd/LiveOS/squashfs.img /squash
     mount-loop /squash/LiveOS/ext3fs.img /ext3
    
    The inner filesystem is now unpacked under the /ext3 mountpoint.

commit 7fc3faabc71621a9d8b429d15327955f20757080
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 15 22:25:51 2009 +0100

    New command: 'mountpoints' which returns a hash of device -> mountpoint.

commit dbbbc753043aca5a32a96fa391851cc394e2ceea
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Jul 15 19:16:02 2009 +0100

    Build fix: perl-libintl is not required for the basic Perl bindings.

commit 9771ab2cab74887c6537a4bb16b5f12037e95e12
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Jul 15 17:18:19 2009 +0100

    Version 1.0.61

commit bdf7a27a790ff26664f91d95239ec33c5467bfeb
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Jul 15 16:34:19 2009 +0100

    New tool virt-cat: display a file in a virtual machine.
    
    This script is just a simpler way to cat a file from a VM.  It
    is otherwise equivalent to using guestfish.
    
     virt-cat someguest /etc/fstab
    
     virt-cat someguest /var/log/messages | tail

commit b3595c5553035798b7b33d05c9326f7e8dd55e69
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Jul 15 14:24:41 2009 +0100

    Make Perl strings translatable using perl-libintl.
    
    All Perl strings are now marked as translatable using __"string"
    or __x("string {placeholder}", placeholder => $_).  Perl strings
    now get copied to the PO files.
    
    The po/POTFILES.in file is now updated automagically whenever we
    add new *.c, *.pl or *.pm files into the repository.

commit 9449b0fce4145a56df9d43169d61e8b2c4e41b09
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Jul 15 11:39:04 2009 +0100

    guestfish: Add tilde expansion for paths (RHBZ#511372).
    
    This commit adds tilde expansion for local users in guestfish:
    
      ><fs> echo "~"
      ~
      ><fs> echo ~
      /home/rjones
      ><fs> echo ~foo
      ~foo
      ><fs> echo ~rjones/bar
      /home/rjones/bar
      ><fs> echo ~roo
      ~roo
      ><fs> echo ~root/foo
      /root/foo
      ><fs> echo ~root
      /root

commit 1d29b4e40bed1145e2ca359bda62d5aa218dbc41
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 14 15:50:29 2009 +0100

    Version 1.0.60.

commit f67babb7567f2012d299c59bdddc1b2f3dde5b11
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 14 15:59:45 2009 +0100

    java/Makefile.inc: Include this generated file.
    
    We have to include this generated file because it is part of
    the build system, thus required to exist before the generator
    runs.

commit b2da776b250a3a081f2929d604dd2423a5bbff8a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 14 15:41:51 2009 +0100

    File missing from tarball: rc_protocol.x

commit 8d53f8869f85b46ec3495db74565a241f33fe2cc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 14 15:19:34 2009 +0100

    Version 1.0.59.

commit 72c6cc02e2c66cccf3c092a232f107cca5896fe1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 14 14:34:57 2009 +0100

    RHEL 5: header was called <sys/xattr.h>

commit 74ee9390d3a7063470925d6d78dd9ba73bb4c634
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 14 14:31:18 2009 +0100

    Fix: daemon/xattr.c can now compile even when no xattr support.

commit a86aa7d152ed996170714a3a4516eab58bf8b59d
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jul 13 13:06:26 2009 +0100

    Guestfish feature: remote control of guestfish over a pipe.
    
    The use case is to have a long-running guestfish process in
    a shell script, and thus to avoid the overhead of starting
    guestfish each time.  Do:
    
     eval `guestfish --listen`
    
     guestfish --remote somecmd
     guestfish --remote someothercmd
     guestfish --remote exit
    
    This patch also supports having multiple guestfish processes
    at the same time.
    
    The protocol is simple XDR messages over a Unix domain socket.

commit 5d6cc25900df4e13e4085f13d4f846cc9719ce61
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 14 13:47:18 2009 +0100

    Removed getfattr/setfattr from TODO list, since now implemented.

commit 2600359b9b520ab386f069fbbcd656e5cdbd9b76
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 14 11:50:55 2009 +0100

    Support for Linux extended attributes.
    
    This commit adds six calls to support Linux extended attributes.
    They are:
      getxattrs     list all extended attributes for a file or directory
      setxattr      add/replace an extended attribute
      removexattr   remove an extended attribute
      lgetxattrs    \
      lsetxattr     (same as above, but operate on symbolic links)
      lremovexattr  /
    
    See attr(5) for more information.
    
    This also adds support for the FBuffer field type, which maps to
    an XDR opaque<> or a C (int, char *) pair.

commit 7b3c76c95162f773dec03e0555d3060f0d2546c9
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Jul 14 12:47:53 2009 +0100

    virt-inspector: Ignore swap partitions marked as "none".

commit 9af96c41f64567e6fbe0dd25f6ffa90385e9c49a
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Jul 14 11:48:55 2009 +0100

    Improve launch error message.
    
    The previous error message was confusing for new users:
    
      libguestfs: error: guestfs_mount: call launch() before using this function
    
    The new error message explains the action that the user must take,
    especially if they are using guestfish:
    
      ><fs> mount /dev/sda1 /
      libguestfs: error: guestfs_mount: call launch before using this function
      (in guestfish, don't forget to use the 'run' command)

commit 7c97febc5ffaeffda7231c88b2966fd85c0bb335
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Jul 14 11:37:05 2009 +0100

    Add reiserfs module to kernel whitelist.

commit c7845fb23e1353ae0331d8300271f813b637628c
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jul 13 18:28:45 2009 +0100

    Only allow virt-v2v to be run on single root guests (ie. no multi-boot).

commit 4e444d5c09d78b0d292d95d1f97de12f26cc139d
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jul 13 18:06:10 2009 +0100

    Ignore old-style initrd which is a compressed ext2 filesystem.
    
    'cpio' chokes on these, taking ages to decide that they are
    not cpio files, and producing masses of messages.  This was
    causing virt-inspector to be very slow (many minutes) on
    RHEL 3 guests.  With this fix, speed is back to normal.

commit 7d41d75c1d4e6dbe61f6cd353bc104663340483f
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jul 13 18:00:07 2009 +0100

    Implement new 'zfile' command, to show file type inside compressed files.

commit f9ecb943be086087feeeaeb49bd8865fd5e54545
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jul 13 16:49:12 2009 +0100

    Ignore java/Makefile.inc (generated file).

commit 96fdcf7f2ed0c0d32cf14b5fea95cfba94f2c977
Author: Matthew Booth <mbooth@redhat.com>
Date:   Mon Jul 13 13:51:42 2009 +0100

    Automatically generate list of built java sources

commit 456446a86909dd05a5162aca4d676f680b47abc4
Author: Matthew Booth <mbooth@redhat.com>
Date:   Mon Jul 13 12:55:02 2009 +0100

    Revert "Fix checking of generator being run from the right directory."
    
    This reverts commit 35c646965a21d452cf74ef3683612210a653c36d.
    
    As well as reverting this change, add a comment explaining that
    configure must run first.

commit 56f7a8a4c8af55d09caef883b60e61e8569ef5a1
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jul 13 12:27:35 2009 +0100

    Move BUILT_SOURCES so the comment is back in the right place.

commit ffd17f8e94af972429f5135208c795c0dbcdfbc8
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jul 13 12:12:34 2009 +0100

    Order alphabetically the options in guestfish.1 manpage.

commit ad64aff8342198f11cf7d8ffff148a9cd5afe6ce
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 11 21:35:03 2009 +0100

    Guestfish: implement -x option, echo commands before executing them.

commit 89dfb94d3ec0276e1bcbaf63c9ecee3ec4e73619
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 11 21:33:41 2009 +0100

    Fix: '-D' was not recognized as a parameter to guestfish.

commit 8d167a98eca95352e36775068bbc0d90f3009edb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 11 21:27:23 2009 +0100

    Regression test: Test reopening the handle in the same process.

commit 625d0bd56189450f48b6308371bf08ee6312d59f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 11 21:20:17 2009 +0100

    Guestfish: Add 'reopen' command to reopen the libguestfs handle.

commit b48dea6217920ef26e4745a9797c07a21407574f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 11 21:07:57 2009 +0100

    Add missing documentation for "more" command in guestfish help output.

commit c66f3600cd76c7fe0e318004c416f7845b934bc6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 11 14:00:53 2009 +0100

    Add tests to many non-daemon functions.
    
    Tests are added to the following functions:
      get_qemu get_path get_append get_autosync
      is_ready is_config is_launching is_busy
      set_memsize get_memsize get_pid

commit 35cf94c61f9f5e15a4e218bdaedba77c36aa4e5b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 11 13:44:53 2009 +0100

    Add TestOutputIntOp, CompareWithIntOp.
    
    These constructors allow enhanced tests where we compare
    the result of a test against some operator, eg. >= 1 or < 5

commit 5b0a37c47aaec0a753a00026b52c305442fd6678
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 11 13:38:01 2009 +0100

    Test for "version" command should be InitNone.

commit d7db5317bc4624184fccd816cbacfce3f75cbd27
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 11 13:37:24 2009 +0100

    Add comment to the code about InitNone and InitEmpty.
    
    These two constructors are treated as identical, but they
    should be distinct concepts.

commit 55c2a4677b4b6c172b4331d0c9cc9a12e8e20084
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jul 11 13:36:31 2009 +0100

    Fix UPDATES and host_cpu in configure.ac.
    
    UPDATES does not need to be propagated into config.h.
    
    host_cpu was AC_DEFINE'd twice.

commit 3f2ba6fdfbb82234e8a546dc54d568f49cd2e56b
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Sat Jul 11 12:12:33 2009 +0100

    Documentation for virt-v2v.

commit ce315bba284b40c2a729fce1ed2e3d7a746173f8
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Sat Jul 11 11:20:46 2009 +0100

    V2V outline program.

commit fa36a09e7af4275d53098908bfec2441c4ef9ff1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 10 23:14:16 2009 +0100

    Don't list Java files explicitly, since these files are auto-generated.

commit bbd6aeaccce04915be0706efda11c6d40f1f90a6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 10 22:46:06 2009 +0100

    Version 1.0.58.

commit 924df6051655ad145eca78e50dff84166b7124f3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 10 22:15:53 2009 +0100

    Proposal to add BufferIn and RBufferOut types (not implemented).

commit 335a8e3b0efa4c9dee01591134aeeb2b17ae22f5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 10 22:01:50 2009 +0100

    Sys::Guestfs::Lib: Exit with error if a libvirt domain appears to have no disks.

commit b2f01ebcbeed5bc0c954f80283baf7b5ba52256e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 10 21:59:46 2009 +0100

    virt-df: Recognise libvirt domains with file-backed disks.
    
    File-backed disks (<source file="...">) didn't get recognised
    before.  This patch fixes the problem.

commit 995715ebf9935a64f0321c09a527538706aa3cb7
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri Jul 10 17:57:41 2009 +0100

    Add --version options to virt-df, virt-inspector and virt-v2v.

commit 745f1d9ee8480b3a38f778fcc4506ce86da473a6
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri Jul 10 17:52:09 2009 +0100

    Add 'version' call to get true library version number.
    
    This patch also changes the way that the version is specified
    in configure.ac.  It is now made out of four parts (major, minor,
    release and extra) and constructed for AC_INIT.

commit 2105fabddfdcecca68e20285808b4d8bbe133227
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri Jul 10 16:28:15 2009 +0100

    Move 'use File::Temp' from virt-inspector program to Sys::Guestfs::Lib.

commit beb83b6760069558ce0bd23991866789818927ef
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri Jul 10 14:10:31 2009 +0100

    Version 1.0.57.

commit ca2b02887e268256ef6c66d6032571d3da70ff9c
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri Jul 10 14:09:47 2009 +0100

    Update PO files.

commit 7f021a32a29433153f9d4a69951eab97586f3b77
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri Jul 10 14:09:33 2009 +0100

    Additional C files for POTFILES.in.

commit 6d9804170017b4c44fa6d288e110b63573da14b4
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri Jul 10 14:02:45 2009 +0100

    Rename internal subroutines with leading underscore character.
    
    Otherwise Pod::Coverage in the tests will complain that the
    internal subroutines are undocumented.

commit e547e639b14072bc238cf161669bc3d94a8d6e13
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri Jul 10 13:04:17 2009 +0100

    Working version of virt-df.

commit ca75b55ec25f8ae3463702f16cdeb95ebde2916a
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri Jul 10 12:06:11 2009 +0100

    Fix for returning structures (hashes) from Perl calls.
    
    Calls such as stat and statvfs which returned a single structure
    were returning an array of values instead of a full hash of keys +
    values.
    
    Fix this by pushing the key names on the stack too.

commit 0fc6b7affd28ad77566e832f338650b771145ea1
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri Jul 10 11:43:17 2009 +0100

    '$_' should be marked as a local variable in Sys::Guestfs::Lib::open_guest.

commit 03e1f74ee08dc71bc09cc7655bf4732685f80b43
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri Jul 10 11:41:43 2009 +0100

    Properly close fds and unregister handlers in guestfs_close.
    
    This caused a segfault if you tried to repeatedly open and close
    a guestfs handle in the same program.  The reason is that the
    old handler remained registered (not always - it was racey).
    
    This adds proper cleanup to the guestfs_close path, also for file
    descriptors.

commit 67a3d3e3915a18a58702b7e68f514d9dc9a82a2e
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri Jul 10 10:44:20 2009 +0100

    Added framework for 'virt-df' command.

commit 9b56a72636ba7511f7bef19572c161327b9a01df
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri Jul 10 10:23:11 2009 +0100

    Ignore any file called 'localconfigure'.
    
    Developers should put their custom parameters for configure/autogen.sh
    into a script called ./localconfigure, and this script will be ignored
    by git and the build system.

commit 6e790a9d6b225fad4ab080489bd8226c3adb3506
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri Jul 10 10:22:47 2009 +0100

    Added outline of the virt-v2v script.

commit c1768e07fb207328daa36e3afce3933bcf9ae6cf
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jul 9 19:37:09 2009 +0100

    Remove virt-inspector --force option - it didn't do anything.

commit cf9d291e6dcf09a1d16d50a80fa420d4957f7da1
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jul 9 19:25:01 2009 +0100

    Sys::Guestfs::Lib minor documentation clean-up.

commit 22528e9bc486cbb6357192bd758c417c61bba955
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jul 9 18:29:08 2009 +0100

    Move the inspection analysis code into Sys::Guestfs::Lib library.
    
    Creates new functions:
      inspect_all_partitions
      inspect_partition
      inspect_operating_systems
      mount_operating_system
      inspect_in_detail
    
    Includes far more documentation for the process.

commit 64c565dc905cef89a681c0bd9dce0864f3b03797
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jul 9 15:29:28 2009 +0100

    Move 'resolve_windows_path' to Sys::Guestfs::Lib.

commit 7058e5c63ecc8ed41c9fcc011fbe215bad6f6369
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jul 9 14:35:34 2009 +0100

    Move 'get_partitions' call into Sys::Guestfs::Lib.

commit 2f70ca487bee8babe5aef27f00a2131ea86ebd50
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jul 9 14:01:58 2009 +0100

    Add Sys::Guestfs::Lib - useful functions for using libguestfs from Perl.
    
    This adds an extra Perl module called Sys::Guestfs::Lib which
    adds useful functions for using libguestfs from Perl.
    
    The intention is that common code shared between virt-inspector,
    virt-df and virt-v2v will move into this library.
    
    This patch also changes virt-inspector to use this library.

commit e3c2a599027f88a617b46b77be1673de0c94faee
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jul 9 14:01:10 2009 +0100

    Just whitespace changes in the generator code.

commit 92d47d7f85b68635e08d371568268cff4f76860e
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed Jul 8 17:20:52 2009 +0100

    Update with links to the new mailing list.

commit 35c646965a21d452cf74ef3683612210a653c36d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 7 20:28:29 2009 +0100

    Fix checking of generator being run from the right directory.
    
    Originally it was looking for 'config.status', but this file
    might not exist until configure has been run.  Make it look for
    HACKING instead.

commit 9e67beed7a5053a391e25150ddf4e990f2769cb9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jul 7 20:06:27 2009 +0100

    Version 1.0.56.

commit b095858eb232039230c528b1d720670efad891c2
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Tue Jul 7 19:39:58 2009 +0100

    RHEL 5: Mount squashfs with explicit type.

commit bee76c62d0c1d481cc856c15337ed705e00246ed
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Tue Jul 7 19:02:59 2009 +0100

    RHEL 5: Skip 'scrub' test if command is not in the initramfs.

commit 291986771c95345daaf28fbcb0c54214b8e6b835
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Tue Jul 7 19:01:45 2009 +0100

    RHEL 5: 'mkswap -U' not supported, check before testing it.

commit 8e7277fc7436d2e1eab2c395a34ced47745c6214
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Tue Jul 7 17:34:31 2009 +0100

    Update ocaml/.depend.

commit 2e632a654f82a86c0bd29d935d1ed0b5db46113d
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Tue Jul 7 17:33:47 2009 +0100

    RHEL 5: RHEL kernels don't have $arch at the end, so look for non-arch kernels too.

commit 11400fde901e1c7a6d3c3887f322af66374793c2
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Tue Jul 7 17:33:09 2009 +0100

    RHEL 5: $(builddir) did not exist with this old autoconf/automake, so workaround.

commit 9a3c4a62398d9f0c553ac2b5f43a3eefafd7bac5
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Tue Jul 7 17:32:34 2009 +0100

    RHEL 5: for (int i = ...) is not permitted with this old version of GCC.

commit 157035503b509385084cafac8e5c5fa0afa2fef7
Merge: 6fb57e4 d5532e9
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Tue Jul 7 16:55:51 2009 +0100

    Merge branch 'master' of git://git.et.redhat.com/libguestfs

commit d5532e9ad29b28c2b323ad0abe4e0caa6e03f675
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Jul 7 13:42:34 2009 +0100

    Generate structs and struct lists generically.
    
    This modifies the way that struct and struct lists are generated
    (for return values) so that there is no need to add an explicit
    new type when adding a new structure.
    
    All tests pass, and the C API should be compatible.
    
    I have also inspected the changes that are made to the generated
    code by hand.

commit 6c87a747cae61097915c71f6d505f101579e8c7a
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Jul 7 13:03:36 2009 +0100

    Fix for 349814e9d912c4: Get correct path when building Ruby bindings.

commit b5e29ac706004ad29da2e0949beda41e8e27e398
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jul 6 16:01:51 2009 +0100

    Test two (of four) cancellation paths.

commit 82c7e685bf71c70bd1c1c0b9db002157e5788db4
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jul 6 16:01:23 2009 +0100

    Add a debug message to the library cancellation path.

commit 51ecd63944bb1374ebad518d814deaa2096bc365
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jul 6 13:10:25 2009 +0100

    Introduce regression tests for various qemu failures.
    
    Test failure of qemu and recovery of the library:
     - mid-command
     - between commands
     - during launch [test not working yet]
     - explicitly killed by guestfs_kill_subprocess
    
    Also this patch cleans up the other tests in this directory
    and disables the long-winded test-bootbootboot test.

commit f1fadb92179b68519b57680718e30a389a63d5e5
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jul 6 12:46:44 2009 +0100

    guestfish: Always fflush stdout between commands.

commit bf39034d3fd3e4fe83fe80acf60977cbfe7d1c3d
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jul 6 12:37:14 2009 +0100

    Whitespace change in ocaml/.depend file.

commit 7cbb86e4c8b6b8bca8606d219c5571549ceabba6
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jul 6 12:30:59 2009 +0100

    Add 'get-pid' command.
    
    This is used to get the PID of the qemu subprocess, mainly for
    debugging and testing purposes.

commit cab0443e2508209fab67bfe0f723ee79cc5e2929
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jul 6 12:30:33 2009 +0100

    Todo: Remote-control guestfish through a pipe.

commit 35d2b05e634bd77b3f3670d8d844caf750607482
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jul 6 12:05:55 2009 +0100

    Sort the .gitignore file (no semantic change).

commit 3fc2412186693a7fe04d19df5adf9decc4ffdf34
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jul 6 12:03:35 2009 +0100

    Remove files generated by autoreconf (Guido Gunter and Matthew Booth).

commit 51d0620ad90f913cb749e641a839876b3ef755f8
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Sun Jul 5 16:04:50 2009 +0100

    Don't die if reply message is oversized (RHBZ#509597).

commit a11cb4ac38cf245472d93e8df13c5ac630b883a7
Author: Guido Günther <agx@sigxcpu.org>
Date:   Sat Jul 4 14:41:23 2009 +0200

    use 'stupid_simple' instead of 'nested' initramfs
    
    speeds up start of the appliance

commit 22b787d17bf038d50b8f9a31db09c7de3a8f82eb
Author: Guido Günther <agx@sigxcpu.org>
Date:   Fri Jul 3 22:20:05 2009 +0200

    select proper kernel by architecture

commit 349814e9d912c4f372b8fbdfb10b03749911021f
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Jul 3 11:52:50 2009 +0100

    Make it possible to build in a separate directory
    
    This patch allows you to do:
    mkdir build
    cd build
    ../configure ...
    make
    
    This will output all generated files to the build directory. Given that
    autogen automatically runs configure, you can also do:
    
    BUILDDIR=./build ./autogen.sh
    
    which will do the right thing.
    
    Also:
    
    * Fix a dependency bug which means that guestfs_protocol.h
      isn't automatically rebuilt.
    * Re-running autogen.sh with no arguments won't blow away your previous
      configure arguments.

commit 5f9cb51f11879ece8b921d833850505d7e57d339
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Jul 3 14:17:23 2009 +0200

    generate slightly more "const-correct" code
    
    * src/generator.ml: Add a few "const" attributes.

commit 0cc0e9e39f816c3f6174c74bf4cb136a5b4e13ea
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Jul 3 12:05:22 2009 +0200

    avoid leak upon failed realloc
    
    * daemon/guestfsd.c (commandrv): Free original buffer (rather
    than leaking it) if realloc fails.

commit a7b73d4a1e09f12b2002083618056f0c823c1dcf
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Jul 3 11:53:49 2009 +0200

    remove trailing blanks

commit e9f5144537a4d89cc875bce42b269d1e2b119d8f
Author: Jim Meyering <meyering@redhat.com>
Date:   Fri Jul 3 11:52:19 2009 +0200

    daemon/readdir: avoid a small leak
    
    * daemon/readdir.c (do_readdir): Free both p and v.name, in case
    only one of the allocations failed.

commit 3f903f01d9d68f427d6afe8aa3daf24257c05c22
Author: Guido Günther <agx@sigxcpu.org>
Date:   Thu Jul 2 17:30:40 2009 +0200

    touch fakeroot.log
    
    indicationg we're done creating the appliance

commit 7e34d2cf59c2c8098683967c32782ffd8ca66aa7
Author: Guido Günther <agx@sigxcpu.org>
Date:   Fri Jul 3 12:42:38 2009 +0200

    remove superflous debirf scripts

commit 2018441f426aac5a6e48fc6d7cf8155122706215
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 3 12:02:21 2009 +0100

    Guestfish tab-completion on destination paths, fixed this time.
    
    Tab-completion on destination paths should now work correctly.

commit 3b5c29f589d4637af4a6f0453975a3df13a6113d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 3 11:31:01 2009 +0100

    Don't keep rebuilding debirf module symlinks.

commit ebed95e5138bea5c56590286f3dcf364748fc38f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 3 11:10:49 2009 +0100

    'readdir-and-stat' call is now effectively implemented.

commit a67c46b4b2ff5a2c4305e39d1bb105b658ca5f89
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jul 3 10:47:10 2009 +0100

    Add Debian appliance directory to the distfile.
    
    'make dist' won't copy symlinks into the output file, so we
    have to add a rule to the Makefile to copy these.
    
    (Issue reported by Guido Gunther).

commit 6fb57e430c8daa06d8d938ac02a104c8aadbbda5
Merge: b7e094f ee4c49f
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Fri Jul 3 00:22:14 2009 +0100

    Merge branch 'master' of git+ssh://192.168.122.1/home/rjones/d/libguestfs

commit 447dae7df43e8a98da59d94f1aef9895e087aa13
Author: Jim Meyering <meyering@redhat.com>
Date:   Thu Jul 2 15:39:08 2009 +0200

    use safe_malloc and safe_calloc in generated code
    
    * src/generator.ml (safe_malloc): Define to guestfs_safe_malloc.
    (safe_calloc): Define to guestfs_safe_calloc.
    [most generated code]: Fail immediately upon failure of otherwise-
    unchecked malloc and calloc calls.
    * src/guestfs.c: Include <stddef.h>.
    (xalloc_oversized): Define.
    * src/guestfs.h (guestfs_safe_calloc): Declare.

commit d0bdef850e7bf0edc1a8ee1f05880cdf867aeeb6
Author: Jim Meyering <meyering@redhat.com>
Date:   Thu Jul 2 15:25:58 2009 +0200

    prefer sizeof *VAR over sizeof TYPE (no semantic change)
    
    * src/generator.ml: Slightly safer, in case the
    declared type ever changes.

commit ee4c49fad5a3e36c6e909ab90bcb7d719c9395b3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 2 21:51:47 2009 +0100

    Prepare for 1.0.55.  PO files also updated.

commit b2c76a898b9d6fff09af05e4e3bd1d54c8816a95
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 2 21:50:30 2009 +0100

    Add 'sfdiskM' command.
    
    This command is a saner interface to partitioning.
    
    All partition sizes are specified in megabytes (not cylinders).
    You don't need to specify the cyls/heads/secs parameters.
    
    All the test code has been updated to use this, so it is now
    CHS-independent (eg. when CHS changes as between IDE and virtio).

commit c95f61b0a2e273c9376fe92c58ef6c4914d4ef17
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 2 21:48:17 2009 +0100

    Remove generated files guestfs_protocol.[ch].
    
    These generated files were accidentally left in when we
    removed the other generated files in cset
    b3cb0b04eb2d38ba32c160a83d8e3894b376907b.

commit 7d3cccb66df63815f8230009b8d2fdf8965fbaa8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 2 21:33:51 2009 +0100

    Don't rebuild the whole appliance if just the /init script has been changed.

commit 373a9ad0abb09ee079da834d251a744cdbe9ae70
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 2 21:32:59 2009 +0100

    Improve virtio-blk performance (RHBZ#509383).

commit c7a3729f459a845f4e7b30c09ea378c54ee49c32
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 2 17:38:55 2009 +0100

    Add ./configure --with-drive-if=(ide|scsi|virtio)
    
    With this flag the packager can decide to default to a particular
    qemu drive model.  The current default is 'ide', however note that
    we intend to change this in future to 'virtio' once some upstream
    regressions are fixed.  Packagers can force a particular drive
    model if they wish.

commit 8863ecde5dba262c0736da7505a9fa3655ed42f6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 2 16:02:32 2009 +0100

    Add the guestfish 'time' command.
    
     ><fs> time sfdisk /dev/sda 0 0 0 ,
     elapsed time: 6.12 seconds

commit 62e41312acd0f7fe7f3622a73d6f6efc27b1b511
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 2 15:11:59 2009 +0100

    Add list of function_names to the daemon.
    
    Messages which include the proc_nr can now also include the
    name of the actual function being called.

commit c127ad3d4a494abb2d9bb4fb6eaa179431d2411a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 2 14:11:19 2009 +0100

    In verbose mode, daemon will display the time elapsed for each command.

commit c12edb2d52956e17f7848e34ae1607dc6f0a2a81
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 2 14:10:55 2009 +0100

    Ignore generated file appliance/debian/debirf.conf

commit 9f19ddd0c42a509018340a82bd7dc13a0996e6f5
Author: Guido Günther <agx@sigxcpu.org>
Date:   Tue Jun 30 15:01:14 2009 +0200

    Build Debian based appliance using debirf

commit bcd7bd3aabf4a28bca24bf5d22ed3a68322ec637
Author: Guido Günther <agx@sigxcpu.org>
Date:   Tue Jun 16 23:47:36 2009 +0200

    add debirf files

commit 4e8884823caef364d271075fb9df7dbe450b892c
Author: Guido Günther <agx@sigxcpu.org>
Date:   Thu Jul 2 10:46:37 2009 +0200

    unconditionally load dm module
    
    needed for device mapper (LVM)

commit badfe3a7418cd77614415b71b28ead5f0a43a5e5
Author: Guido Günther <agx@sigxcpu.org>
Date:   Tue Jun 30 14:44:09 2009 +0200

    add missing module
    
    for modularized Debian kernels

commit 0bfadd6908aa9d6a15990541d61bc3cf8600e54b
Author: Jim Meyering <meyering@redhat.com>
Date:   Thu Jul 2 13:36:04 2009 +0200

    avoid automake failure
    
    * daemon/configure.ac: Use AM_PROG_CC_C_O, not AC_PROG_CC_C_O.

commit 11d8dd84d475c89c7fff702e7f7ac5bf57971ac4
Author: Jim Meyering <meyering@redhat.com>
Date:   Thu Jul 2 13:30:07 2009 +0200

    arrange to build some generated sources
    
    * src/Makefile.am (BUILT_SOURCES): Define.
    ($(BUILT_SOURCES)): Depend on stamp-generator.

commit cf61715fa7f8dcf644bebebfa7f2741d8d79a644
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 2 13:07:07 2009 +0100

    Re-add src/MAX_PROC_NR (generated file).
    
    This file is required by configure, so we need to add it so
    it is available after the git checkout.

commit b6b2004db1056d628a4d8c30dd61b14fb18cf876
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 2 12:23:08 2009 +0100

    Memoize the output of pod2text function in the generator.
    
    This speeds up the generator greatly.

commit ab4d96654e5e76da18f84ccdc99580823af9ecb6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 2 12:04:54 2009 +0100

    Updated PO files.

commit b3cb0b04eb2d38ba32c160a83d8e3894b376907b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 2 11:38:36 2009 +0100

    Remove generated code from git.
    
    Git users now require the OCaml compiler in order to regenerate
    the generated code after a checkout.
    
    Generated code will remain in the tarball, so users of the
    source tarball will not need the OCaml compiler.

commit da85ed425dc828ef4b8817f64d448101a88507b5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Jul 2 11:29:00 2009 +0100

    Generator now runs automatically when it has changed.

commit 5186251f8f681f2ebb028423bb49a748861fd11e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 1 20:56:58 2009 +0100

    Add 'readdir' call.
    
    This adds a readdir call (mostly intended for programs).  The
    return value is a list of guestfs_dirent structures.
    
    This adds the new types 'struct guestfs_dirent' and
    'struct guestfs_dirent_list', along with all the code to
    return these in the different language bindings.
    
    Also includes additional tests for OCaml and Perl bindings
    to test this.

commit f20854ec61eef1aea313920f0cf193a78c1a9219
Author: Jim Meyering <meyering@redhat.com>
Date:   Wed Jul 1 16:09:33 2009 +0200

    fish: handle some out-of-memory conditions
    
    * fish/destpaths.c (xalloc_oversized): Define.
    (complete_dest_paths_generator): Use size_t as type for a few
    variables, rather than int.
    Don't deref NULL or undef on failed heap alloc.
    Don't leak on failed realloc.
    Detect theoretical overflow when count_strings returns a very
    large number of strings.
    Handle asprintf failure.
    (APPEND_STRS_AND_FREE): Rewrite as do {...}while(0), so that each use
    can/must be followed by a semicolon.  Better for auto-formatters.

commit 99e28249d52ca5495b636e14ae3e4387ee62c8fe
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 1 17:15:24 2009 +0100

    Call 'udevadm settle' after operations which add/remove device nodes.
    
    Because udev operates asynchronously, we found errors which were
    caused by a previous command (eg. sfdisk or pvremove) creating
    or removing a device, and that change not having happened by the
    time the next command was run.
    
    This patch adds calls to '/sbin/udevadm settle' after any commands
    which can add or remove device nodes.
    
    If udev is not being used or not available, this should have no
    effect.  The command fails and this is silently ignored.

commit 3e2d925717d1dac6b3862e98192c12d1080c2152
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 1 17:13:39 2009 +0100

    All instances of 'pclose' now check for return value != 0.
    
    We are generally interested that the subcommand ran without
    error, ie. had exit status of 0.  'pclose' returns the exit
    status, so we now check that pclose (fp) != 0.

commit fe27753ae5925cbe50042e47115364a57aadbbd7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 1 16:36:13 2009 +0100

    Fix error handling of external sfdisk command.
    
    Should use 'pclose' instead of 'fclose' (although fclose happens
    to work because of glibc internals).
    
    The result of pclose is the exit status of the command, so we
    need to test this is != 0.

commit 896079e29b4d49c6c18ac3316a94bfbe2f307648
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 30 14:01:40 2009 +0100

    Generated code for the virtio_blk change.

commit 4513f2ec7b6aa843005ba886cdd1747b6ff00915
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 30 13:59:29 2009 +0100

    Change to use virtio_blk (virtio block device) by default.
    
    virtio_blk is the fast, virt-native block device driver
    supported by qemu and KVM.  Note that virtio_blk device
    names are called /dev/vd*.
    
    Existing scripts should continue working because device name
    translation will silently change device names of the form
    /dev/sd* to /dev/vd* as required.
    
    See also:
    http://libguestfs.org/guestfs.3.html#block_device_naming

commit 202e11543ead0d21a8485879654c927ec95ea7f0
Author: Jim Meyering <meyering@redhat.com>
Date:   Wed Jul 1 15:45:01 2009 +0200

    Don't dereference or free undefined "msg" upon OOM.
    
    * src/guestfs.c (guestfs_error): Handle failing vasprintf.

commit e909c5e31f6b60e68220177b5cd5e81cfacb8d0d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 1 14:51:06 2009 +0100

    Add libguestfs(3) as an alias manpage for guestfs(3).

commit 2d47f87a3cb9c30340c58619819675981a09e2e5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 1 14:48:35 2009 +0100

    Updated PO files.

commit 996c02c80fbac3f0979863ebc9129de9b7d3709c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 1 14:45:52 2009 +0100

    Reorder the environment variables alphabetically in the documentation.

commit ad0e5d67c2b3e55fadda37cef816702f1d8d643b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 1 14:43:49 2009 +0100

    Document the $PAGER environment variable.

commit 70946fc1b7c7db06a7c11f9088719f0dd6eac1c4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jul 1 14:42:41 2009 +0100

    Document the LIBGUESTFS_MEMSIZE environment variable.

commit 532009d1ccf16b87859dd58884a82512e8eba937
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 30 15:10:31 2009 +0100

    Change statvfs test so it doesn't depend on device size.
    
    Current statvfs test depended on a lot of filesystem details
    which can change if the CHS of the underlying block device
    changes (eg. with the switch from IDE -> virtio).  These are
    not really necessary to test the call, so instead just check
    for filesystem features.

commit cf42e4d3879da45171e58dbcda25d6671aeb8f3e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 30 15:12:48 2009 +0100

    Clean up the output of the C API test code.
    
    Set output mode to unbuffered so that we see ordinary output
    messages and errors at the same time.
    
    Align "skipped" messages.

commit d4ecaee4d354147e5839ea71c65ea74092793a42
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 30 17:48:07 2009 +0100

    Todo: getfattr, setfattr.

commit a885afb07cc568b4fab66c008379e6059e6f8a22
Author: Guido Günther <agx@sigxcpu.org>
Date:   Tue Jun 30 12:17:40 2009 +0200

    Whitelist kernel modules for hardware emulated by QEMU
    
    (Modified from Guido's original patch to use a wildcard to
    specify all virtio modules - RWMJ).

commit 0884d8bbae6d76a603ec1385ada2938f88981c5c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 30 13:09:44 2009 +0100

    Generated code for mknod, mkfifo, mknod_b, mknod_c, umask.

commit f850e1f065fb04df7cc87a921ab3c658741cc393
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 30 13:08:34 2009 +0100

    New commands: mknod, mkfifo, mknod_b, mknod_c and umask.
    
    These commands are used to create block and char device
    nodes or FIFOs (named pipes) in the filesystem.
    
    The umask command is required also because the permissions
    used by mknod are masked by the umask.
    
    Also document and guarantee that the umask starts as 022.

commit a10a2d46f572829fcd1f4266315106f231327d08
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 30 13:07:07 2009 +0100

    Use octal numbers for modes in the test suite.
    
    We have to use the OCaml convention (0o...).  Note that in
    OCaml 0777 is a _decimal_ number.  It'll catch you out.

commit f68b3ac861ae607a333211c775dded82ae2b2c4a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 30 11:17:06 2009 +0100

    Generated code for 'set_memsize'/'get_memsize' calls.

commit 3d15f7e652340777514ff30c3cfc560a90b612ec
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 30 11:16:22 2009 +0100

    Add 'set_memsize'/'get_memsize' calls.
    
    Allow the qemu memory size to be specified either by API
    calls or by setting the LIBGUESTFS_MEMSIZE environment
    variable.

commit 284797c1561e5e089986027d469bd16ee1a983df
Author: Guido Günther <agx@sigxcpu.org>
Date:   Mon Jun 29 22:56:54 2009 +0200

    Use udev if available (Guido Gunter).
    
    Added support for Fedora's udev (Richard Jones).

commit b4fade6392ccb2961f0d7e2bf45dfc2e20333aed
Author: Guido Günther <agx@sigxcpu.org>
Date:   Mon Jun 29 18:40:00 2009 +0200

    define REDHAT and DEBIAN
    
    so we can preprocess packagelist.in

commit 3155a268151d70a669517a1f1ea8563a7d91cdb8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 20:39:41 2009 +0100

    Todo: Suggest an environment variable for memsize configuration.

commit da8ddb2745c3d53c36e3ad7f09836a4c27a4d3e6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 20:24:47 2009 +0100

    Generated code for the 'mkswap*' commands.

commit 662617ae725c5e41c24128a037060419fbe4b026
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 20:23:42 2009 +0100

    Implement 'mkswap', 'mkswap_L' and 'mkswap_U' commands.
    
    These commands are used to make Linux swap devices.  The mkswap_L
    command makes one with a label.  The mkswap_U command makes one
    with a known UUID.

commit e820df70c7c7486cc4d5cc9f3e7ddbbae195fd41
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 20:24:38 2009 +0100

    Todo: Allow memsize to be configured.

commit 6812864f3783fbe7d3b8e8f33ef1899463fccd02
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 18:52:14 2009 +0100

    Todo: Investigations into 'binarch' command.

commit 786e64ef01c54eb5d84b6cf2564a8c002ace885a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 18:40:42 2009 +0100

    Rearrange guestfish commands in the manpage.

commit f339cb33703fc1b561d9956c29c4eb0e57334a91
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 17:48:03 2009 +0100

    Add missing documentation for new 'more' and 'less' commands in guestfish.

commit d9105530a7da4dffb5cdcb38ef7af0f58f7d515c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 17:33:52 2009 +0100

    Version 1.0.54

commit 2cd636cc441041016744606a5a3b954155eca8d8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 17:33:32 2009 +0100

    Check for XML::Writer dependency for virt-inspector.

commit 1799b5ce4741446704418fe06ea7e13a91028b7e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 17:33:08 2009 +0100

    Remove generated files in make clean.

commit 128f822e16bb96677c75b88125e18f48d7ccedaf
Merge: 103fb55 ad47510
Author: Matthew Booth <mbooth@redhat.com>
Date:   Mon Jun 29 16:27:05 2009 +0100

    Merge commit 'et/master'

commit ad475104ec7fae456d3309cbf4261b893ed160bb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 16:22:10 2009 +0100

    Fix for 'broken pipe' error when qemu dies (RHBZ#508713).

commit 5d6b6a3fbbfea19c606b984bac9cf64b6b81cafe
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 16:05:22 2009 +0100

    Generated code for mount-loop command.

commit a548d51b703f5385797594a37287f4532af289a2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 16:03:54 2009 +0100

    Add mount-loop command (RHBZ#508668).
    
    Loop device mounts don't work for the generic 'mount' commands
    because the first parameter should be a file not a device.
    
    We want to separate out files parameters from device parameters
    in the long term, so this adds a new mount-loop command for this
    purpose.

commit 25ebdcd50685c4364fc852feca201f8335d47b52
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 16:00:49 2009 +0100

    Fix memory leak in daemon/mount.c:do_mount_vfs.

commit 103fb55e6b1428366ab31a0f17484ef1baa68e96
Author: Matthew Booth <mbooth@redhat.com>
Date:   Mon Jun 29 15:34:29 2009 +0100

    Output the config filename containing a modprobe alias in XML
    
    This change affects the XML output:
    
    /operatingsystems/operatingsystem/modprobealiases/alias/text() =>
    /operatingsystems/operatingsystem/modprobealiases/alias/modulename/text()
    
    Additionally there are two new elements:
    
    /operatingsystems/operatingsystem/modprobealiases/alias/augeas
    /operatingsystems/operatingsystem/modprobealiases/alias/file
    
    These contain information about the location of the alias directive.
    /augeas is an augeas path. /file is the path of the file containing the
    directive.

commit 107a76ad3680fda05cfd58136d62eeab4e77a8dc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 15:18:04 2009 +0100

    Todo list: More suggestions.

commit c6d6f5ae1b76ec9aa5c540906aeed73d25d13eb9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 15:18:17 2009 +0100

    Generated code for 'initrd-list'.

commit 4dff42aa13dd726fb6b02843d0f4db4b4b330fe3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 15:16:40 2009 +0100

    Add 'initrd-list' command to list contents of initrd images.
    
    Add 'initrd-list' command to list the files inside (new-style)
    initrd images.  Update virt-inspector to use this instead of
    the less efficient download/unpack locally method.

commit 228b19aa9c28b03b339e8e23fcb46359e3ab617e
Author: Matthew Booth <mbooth@redhat.com>
Date:   Mon Jun 29 14:39:27 2009 +0100

    Add a comment to device naming heuristic

commit e492608f2f3809a824cb70ee03ff305964b69dd7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 12:47:20 2009 +0100

    Generated code for 'du' command.

commit 9a92446bcad09b492dee42dd5950bac67073fbea
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 12:46:59 2009 +0100

    Added 'du' command.
    
    This command estimates file usage for files and directories.

commit b2ed0f4c55c2bd3d07341ba2207f0cb238eb4e18
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 12:26:11 2009 +0100

    Generated code for df / df-h.

commit 405cf2a5772611ea05cca9fefa843154a9bc64a3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 12:25:31 2009 +0100

    Add 'df' and 'df-h' commands.
    
    df and df-h commands can be used interactively to show disk
    space usage.
    
    Use existing statvfs command from programs.

commit 8f382fd9e7b1745a4b1d6f25f0a775bed2573b8e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 12:09:52 2009 +0100

    Todo: Removed suggestion for short form for pipes.

commit 19a1382fc9317ab88cdbf1dde76a8015868af51d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 12:05:58 2009 +0100

    Implement "more" and "less" commands in guestfish.
    
    Use commands such as:
      more /etc/passwd
      less /etc/fstab
    
    These commands are specific to guestfish.

commit 17a45063960b4158fbe9541a2530ed6903b4f761
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 11:48:50 2009 +0100

    Todo list: Pipes now implemented, so remove from list.

commit 826020fe18bf2eee43f8afea392874bb88c0650a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 11:47:07 2009 +0100

    Generated code for head/tail commands.

commit 3854bbdecd1c089959fb812a739b84a96c05fbbf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 11:46:19 2009 +0100

    Implement "head", "head-n", "tail", "tail-n" commands.
    
    These commands let you view parts of a large file without
    passing the whole file over the network connection.

commit 5af058b7d02607dcbcfb8f561cc0b8fec9a7d305
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 11:18:19 2009 +0100

    Prevent 'n' being used as a parameter name.
    
    Parameters named 'n' sometimes break the Perl bindings, so
    check for this in the generator and prevent it.

commit f450ce75b754fb869b34433c0126f7bb592b141b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 10:09:13 2009 +0100

    Generated code for 'wc_*' commands.

commit 62ccc07e744d5ebfb45d9344827d36f9f61699f4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 10:08:59 2009 +0100

    Todo: wc command done.

commit 7613eb0c7c95649e2152a7fa4d1e6e5e8c653e96
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 10:08:25 2009 +0100

    Implementation of 'wc_c', 'wc_w' and 'wc_l' commands.
    
    These commands count characters, words and lines in a file respectively.

commit 4585b0bbceb3ff73fcf2fbee554000b135297c19
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 09:53:51 2009 +0100

    Implement TEST_ONLY environment variable to run selected tests only.
    
    To run just selected tests, do:
      TEST_ONLY="hexdump mkfs" make -C capitests check

commit 72caee07a5f4f2d7e34c954dba500ffbdbc27207
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 09:43:54 2009 +0100

    Add large test files with standard content for the C API test.
    
    Large test files with standard content for the C API test, and
    add a regression test for previous hexdump failure on large files.

commit ccacf5dec5207d94bc692bfa59670bc8ee4d049f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 09:43:38 2009 +0100

    Todo: RUN_ONLY_FOR

commit c18b48958520ada3712b9ac3954ebe1c449570cf
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Mon Jun 29 09:39:08 2009 +0100

    Todo: 'wc' command.

commit 88da5cf8a32e683ed1d78419fcde609a389a2f65
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 27 15:00:48 2009 +0200

    Guestfish pipes.

commit d164ae963297a99e2222bc32b11928c1635c45d8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jun 28 13:54:22 2009 +0200

    Haskell bindings: Implement bindtests.

commit ef2b0cf761b6281a6a728aacb6ac0ec91fad33c8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jun 28 13:34:11 2009 +0200

    Haskell bindings: Int and Int64 return types.

commit 9414a730d2c8f4a5efffe9396fbbb2a5d10c15c0
Merge: 05273da 66f728d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jun 28 13:28:30 2009 +0200

    Merge branch 'master' of git+ssh://g-rjones@et.redhat.com/git/libguestfs

commit 05273da8830f2f10e417115a3981924a8b14228a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jun 28 13:27:33 2009 +0200

    Haskell bindings: fix boolean arguments.

commit ec34c2bfbfcc53eadf823536dc182710e19b48b2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sun Jun 28 13:17:23 2009 +0200

    Haskell bindings: Fix integer arguments.

commit 66f728d4f84306cef689a6150c5a1aec3c765508
Author: Matthew Booth <mbooth@redhat.com>
Date:   Fri Jun 26 11:29:14 2009 +0100

    Clean up XML output
    
    This change makes XML use XML::Writer, and modifies the output in the
    following 2 ways:
    
    * /operatingsystems/operatingsystem/os is renamed to
      /operatingsystems/operatingsystem/name
    
    * /operatingsystems/kernels/version becomes an attribute of
      /operatingsystems/kernel for consistency with initrds

commit 247225c4415b28d02a82b7fc4dfdd35728437711
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Jun 25 17:19:29 2009 +0100

    Make virt-inspector look in more places for module aliases
    
    Specifically:
    /etc/conf.modules
    /etc/modules.conf
    /etc/modprobe.conf
    /etc/modprobe.d/*

commit 7ca3e5b08ae6e6f062b5065475ffb07cb08a7610
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Jun 25 14:33:26 2009 +0100

    Add yaml output for virt-inspector

commit 1154aff2c68b7ac156713c7fd66b5aa8907a3cb2
Author: Matthew Booth <mbooth@redhat.com>
Date:   Thu Jun 25 10:17:37 2009 +0100

    Make run-inspector-locally try to work out where it is installed
    
    This change means that you can run run-inspector-locally from any
    directory. You can also symlink to it and it'll do the right thing. This
    means you can put a symlink to run-inspectory-locally in your path
    called 'virt-inspector', and 'guestfish -i' will work.

commit 13229b1d54c03be098ab75e6d451b5b46a98550d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 24 21:18:43 2009 +0100

    More TODO items for future work.

commit 67a469c3eb68cbf735749118249ea6cd2c892486
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 24 20:10:53 2009 +0100

    Allow guestfish -i / virt-inspector on live domains, in limited circumstances.

commit 215041c7178922341ecbfdb23eb203f2bb8c29c4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 24 20:04:58 2009 +0100

    Fix detection of optional libvirt support in virt-inspector.

commit efdf252102a65b691e405f80de4261dfc8a0035b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 24 20:01:41 2009 +0100

    Document the guestfish --version option in the manual page.

commit da947eadcfa1367c2d634667068db813a87a6dd1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 24 19:57:24 2009 +0100

    Clarify documentation for mkdtemp.

commit 0574eab8bc7d8e72db862ec36815835938a5fdf1
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 24 18:25:09 2009 +0100

    Generated code for 'mkdtemp' command.

commit 8228eec99045ae720d8ef35851aa8c278f6b4e5c
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 24 18:22:37 2009 +0100

    Add mkdtemp command.

commit af0cfda7e4942c14c9db7304962f8471ccad170f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 24 17:16:17 2009 +0100

    Version 1.0.53.

commit 1f6bc26fc0967c6e4ae4a4514d9734288839c0fd
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 24 15:36:58 2009 +0100

    Fix libvirt integration in virt-inspector.

commit 53f5ea28ffe26c112e51ebdef6d46c25919ced4f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 24 15:35:59 2009 +0100

    Fix permissions on generated scripts in the appliance/ directory.

commit 63d28e74b3a2c4e6f3e31fc1f8e1219a1a943404
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 24 12:41:24 2009 +0100

    Version 1.0.52.

commit b96fb7eb3aa0ac67957ed15a7dd22bc7399cad44
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 24 12:15:57 2009 +0100

    Quote command line arguments to virt-inspector.

commit b91d47063c729246c65c41f827bcb1dc927529c0
Merge: e1c62f6 5e332cc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 24 11:55:57 2009 +0100

    Merge branch 'master' of git+ssh://g-rjones@et.redhat.com/git/libguestfs

commit e1c62f6332ae07cb6f95130dcc9852701d085e2b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 24 11:54:48 2009 +0100

    Added guestfish -i option to run virt-inspector.
    
    You can invoke guestfish with:
     guestfish -i libvirt-domain
     guestfish -i disk-image(s)

commit 5e332cc6c06532191f793a6789bafe818f726258
Author: Matthew Booth <mbooth@redhat.com>
Date:   Wed Jun 24 11:50:08 2009 +0100

    Fix dependencies in perl so it doesn't always rebuild

commit 46551d9c51193a4bca2e1b249b8c5f111e1dc7b5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 24 09:59:39 2009 +0100

    Implement guestfish -f option to allow guestfish scripts.
    
    New '-f' option allows scripts to be written using:
     #!/usr/bin/guestfish -f

commit 94a49c8207277ec4017a0fb9a3cd8f1e61a518f6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 24 09:56:34 2009 +0100

    Incorrect assignment on glob error path.

commit ca5239918ce6de45a694610a11678cadc20cf2fb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed Jun 24 09:45:14 2009 +0100

    Todo items: guestfish options -i and -f.

commit d3270cfadd3416bd9961a2c6fb1cc131c43979da
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 23 22:02:10 2009 +0100

    Implement libtool library versioning.
    
    Use maximum proc_nr (MAX_PROC_NR) as a surrogate for the
    library ABI version, resulting in version numbers such as
    libguestfs.so.0.<MAX_PROC_NR>.0 for the final library.
    
    Add ABI guarantee to the documentation.

commit d2c0ee0ff7a9afdcdc1605dd464760f98d1b57d7
Author: Matthew Booth <mbooth@redhat.com>
Date:   Tue Jun 23 17:35:40 2009 +0100

    Make the supermin helper look for any x86 kernel
    
    If you've got a non-PAE kernel installed on an i686 machine, the kernel
    architecture is i586. This change makes sure that supermin finds the
    installed kernel.

commit bcb3fc0c3336c05e9ecbbfb25c7c31b42bd3e32e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 23 15:53:44 2009 +0100

    Generated code for 'scrub-*' commands.

commit da7cf3670fe60301beeb175ff6c284b737d5b7f4
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 23 15:53:21 2009 +0100

    Added 'scrub-*' commands for securely scrubbing filesystems.

commit 69a481362c20b0ac3985d3003a0078a349ace0a2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 23 15:52:45 2009 +0100

    Bump up default guest size to 500M.

commit 2eda36dbadd4687f7488a86eea9313bbe30cde82
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 23 10:17:59 2009 +0100

    Updated Polish translation (RHBZ#502533).

commit 675411d34f807420d1b714436fc5a58fc0022dae
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 23 10:07:46 2009 +0100

    Command line argument handling.

commit 1d07f1f88a08fc84d91db0931fcf34d1f9db36d3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Tue Jun 23 08:27:52 2009 +0100

    '-no-kqemu' option is no longer necessary to avoid a warning.

commit 0b00aa44ea85ccce17a3579d14e9d4b0f0dd9185
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jun 22 17:02:15 2009 +0100

    Version 1.0.51

commit ead9aa23e2192471d2030f38ece828adfd50de3e
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jun 22 16:53:24 2009 +0100

    Add whitespace to the init script (no functional change).

commit 6f63b699aa03271468f4af9f90933e2d8dbd3db0
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jun 22 16:43:42 2009 +0100

    Issue MAKEDEV commands in a loop (RHBZ#507374).

commit 227b1eea90713d190a9cf5463af106af0b4eee2c
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jun 22 15:07:42 2009 +0100

    Check parameter types in Ruby bindings (RHBZ#507346).

commit 3eab7260a5e36ce6da0dff39456eb9100a13222b
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jun 22 14:24:52 2009 +0100

    Improve error message when appliance doesn't match library.

commit ca4a0c718083db4485edebe4d1b931090e098fa5
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jun 22 14:14:45 2009 +0100

    Missing \n character in Ruby bindings.

commit 3dfc0a8c5da8f3a4a6c13e936d4306b79b231dde
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jun 22 12:40:57 2009 +0100

    Make CHROOT_IN/OUT macros should loudly if the syscall fails.

commit 7c2e6fd3e98840c91b0bac8e13e2eb564810ba04
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jun 22 12:24:27 2009 +0100

    Include the lsof package.

commit 697f50aea8638fc9f5d1a250de6c1b9f4697500e
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jun 22 12:24:14 2009 +0100

    Check return value from close() call.

commit baa5a4099425803f01fa7eb2dce40c80c9c7611e
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jun 22 12:23:56 2009 +0100

    The 'debug sh' command now uses a real shell.

commit bb3a781783734e9f89f2cfa2cabca1efb32bcc45
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jun 22 12:23:31 2009 +0100

    test-boot-realistic rule should boot the rescue shell.

commit 23273711bdbb07cabb19c095797a33d71b7fe711
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jun 22 12:23:12 2009 +0100

    Rebuild supermin appliance when the daemon is updated.

commit 8736b6fa7173ddc33687c4bd9e3fb22d65922fd1
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jun 22 10:02:11 2009 +0100

    Version 1.0.50.

commit 394c8bec21d47b74567a4148fdbf87318c301441
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jun 22 09:35:43 2009 +0100

    Add 'glob' command for guestfish.

commit ad8a256f54a6cb99f89bb444c8597a152a793dce
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jun 22 08:20:42 2009 +0100

    Generated code for 'glob-expand'.

commit 05c34c1c1479bb07b31cfbf912743a8cf014a636
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jun 22 08:20:32 2009 +0100

    Add 'glob-expand' command.

commit 4211c7a258debd236017a19c70965bc1b3658edb
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jun 22 07:49:50 2009 +0100

    Generated code for 'sh' and 'sh-lines' commands.

commit 57d2dfab18ad3d987d9273bb7c1f42e73e0bbcb2
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jun 22 07:49:37 2009 +0100

    Add 'sh' and 'sh-lines' commands.

commit 6654f617a6f720baa8f1ced89179e11679353d1e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 20 16:05:12 2009 +0100

    Check return value from waitpid call in command*() functions.

commit 3ab8336db394683dad5f485388461e9146ac04ad
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 20 15:30:39 2009 +0100

    Add strong note about deprecation of functions which take either device names or filenames.

commit 3c5b447efd42b03c24104bdc1f3260e879bb1d25
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Sat Jun 20 14:55:49 2009 +0100

    Check return value from pclose.

commit 65acb799d2c94e6628f647f2319eb8d16f29a0d5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 19 19:48:19 2009 +0100

    Update to-do list.

commit 3216e9505da3652afad20c0a4612e931359117c2
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 19 19:48:05 2009 +0100

    Generated files for 1.0.49.

commit 606d8ccee17c27e6ecf6fcfc9d05c5758ba77611
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 19 19:28:51 2009 +0100

    Prepare for version 1.0.49.

commit e250646e7cc99df9bb617c28d13c327ff79ab601
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 19 18:25:38 2009 +0100

    Supermin: choose newest available kernel.

commit b7f39224e17eecf53ea2671122d4b3176e4d202f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 19 14:47:22 2009 +0100

    Move init script into a separate file.

commit 677b280411cd3596051f288eecb73b5d8ae23caa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Jun 19 14:26:44 2009 +0100

    Move distro package list to a separate packagelist.in file.

commit e395d7db8fd3fe3d1b121258fe2f401d6b3e64c8
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jun 18 21:06:22 2009 +0100

    Add tab-completion of guest filenames (currently disabled).

commit ace1f0ee2b0a2534e45f14599e38d2d06a03d4d4
Author: Guido Günther <agx@sigxcpu.org>
Date:   Mon Jun 15 20:27:52 2009 +0200

    check for Debian tools

commit e00b27fea31a67f3bae2f91c70ab1e6816673c4d
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jun 18 14:37:12 2009 +0100

    Remove unreadable binaries that give warnings in supermin appliance.

commit 6cb84b6e94f424afb9e25b392148fe679d4c7d51
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jun 18 14:27:20 2009 +0100

    Rename guestfs-supermin-helper -> libguestfs-supermin-helper.

commit be4508dbc4542e9f68fc8c539f8b1bf5193c3a2f
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Jun 16 11:22:31 2009 +0100

    Version 1.0.48.

commit 71322ebf4ee7dfb53db344aaedd70518a3c7a552
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Jun 16 10:55:36 2009 +0100

    Don't compress the supermin base initramfs.

commit 95b902b657dbce901f01fb97bd3cd52bd61636cb
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Jun 16 09:56:44 2009 +0100

    Reverse sense of whitelist test.

commit 28e2bceefeedbef82dcc24e60e8a22da0960354a
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Jun 16 09:56:19 2009 +0100

    Fix build_supermin_appliance to return kernel / initrd names.

commit 2b4e82d6ca502581bc63fd873e4b55aa93463f62
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jun 15 23:06:21 2009 +0100

    Missing files in previous release, so version 1.0.47

commit 3087b47c3abac1ad8773dd07500b51423e62079f
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jun 15 23:02:36 2009 +0100

    Missing files from previous release.

commit 9c662c7ea543ca5bc9ffae45283e92db7ba68e1f
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jun 15 22:47:09 2009 +0100

    Generated files for 1.0.46 release.

commit 5dc2f852d275b79c3e338c6ea5629c6baf4e1a8e
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jun 15 22:39:57 2009 +0100

    Prepare for 1.0.46.

commit 414aa67f2bcbbc5009b92f32611aa9196836736b
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jun 15 11:50:35 2009 +0100

    Experimental implementation of the supermin appliance (passes most tests).

commit eebec43a15a5de3a5b9f1281654f9cbdd44e19cf
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jun 15 11:37:58 2009 +0100

    Check for febootstrap-to-initramfs --files option.

commit d6ca37a95b5ed5b7e5c8e0a54fa5a5bbf0fa2075
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Sat Jun 13 12:58:24 2009 +0100

    Add --enable-supermin option.

commit 14ec52d3dc332a02dcb7d95b5f5d21fd863fc99e
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Sat Jun 13 12:58:47 2009 +0100

    Documentation for the supermin appliance.

commit 161c7cd7f9c9d1099c35db20f78d7e5a20ea6517
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Mon Jun 15 14:45:05 2009 +0100

    Move kernel module list to a separate whitelist file.

commit 67232e4a701f51ac770a085727a665277086a5ae
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Sat Jun 13 11:18:54 2009 +0100

    Update status of libguestfs in Debian.

commit 3ed322c7c8f1b7342af095ba6a8fb60a8e9a076b
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Sat Jun 13 11:16:43 2009 +0100

    Remove /lib/kbd (keyboard maps) from the appliance.

commit 812a2d57a8b847247796da2cd79a73aa1ab16b66
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Sat Jun 13 11:11:03 2009 +0100

    Remove firmware from the appliance.

commit aa7676aa74f3396fc65ae6b4bf01af7efe021e7e
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Sat Jun 13 10:59:51 2009 +0100

    make.sh calls update.sh directly.
    
    Combine the common tail of make.sh and update.sh so that make
    just calls update at the end directly.  The effect is the same.

commit 2e25c4255746b144932f84b7b6671d7d03f52278
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Sat Jun 13 10:48:16 2009 +0100

    Rename (make|update)-initramfs.sh.in -> (make|update).sh.in

commit bf4eda4d89468b232070dbe0161848acaac1c04a
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jun 12 13:39:32 2009 +0100

    Prepare for 1.0.45

commit f6018d198782c1e9ed062ba60dbd0a590c3b7d7b
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jun 11 17:27:18 2009 +0100

    Add guestfs_rescue=1 appliance option to start a rescue shell.

commit 6a623e37e191385c0d9285e3ec1136b2a02e6156
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jun 11 16:57:59 2009 +0100

    Catching hanging qemu in tests (RHBZ#505329).

commit 8a58d6b6252d07a2d157e892bddfdbb510616705
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Jun 11 16:57:29 2009 +0100

    More TODO-list suggestions and a summary of PPC situation.

commit b7e094fa14b306fe776b9b2695cf82fa32d4923f
Merge: 32857b6 ccc1d21
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Wed Jun 10 15:46:41 2009 +0100

    Merge branch 'master' of git://git.et.redhat.com/libguestfs

commit 1bc540ffd0521140600aa319cced7feb42ec5c0d
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jun 10 15:45:00 2009 +0100

    Prepare for 1.0.44.

commit ccc1d216032ff61a81eb1116df44d5bd82079462
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jun 10 15:31:29 2009 +0100

    Remove obsolete comment from generator.

commit 32857b6c1686c94b3c69c88307b137997f74f23d
Merge: ba85a1c 179778a
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Wed Jun 10 15:34:36 2009 +0100

    Merge branch 'master' of git+ssh://192.168.2.134/home/rjones/d/libguestfs

commit 179778adeed965a9652c344a201d2078d868d391
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jun 10 15:31:29 2009 +0100

    Remove obsolete comment from generator.

commit d96554c58fd48db02156044fc15b181e453f0315
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jun 10 15:31:13 2009 +0100

    Specify type of squashfs filesystem.

commit ba85a1cf6275fe008ca379e2da6698ad8eb1d845
Merge: 908aaf4 9cd8ec1
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Wed Jun 10 15:10:03 2009 +0100

    Merge branch 'master' of git+ssh://192.168.2.134/home/rjones/d/libguestfs

commit 9cd8ec1f5082791e4d731a66524d101bdee49654
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jun 10 15:06:44 2009 +0100

    Allow HFS+, UFS and XFS filesystems (add to kmod whitelist).

commit 908aaf4bb0727831377547a64a4f680dafb6b221
Merge: 8224bfd dc3b5a7
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Wed Jun 10 14:32:59 2009 +0100

    Merge branch 'master' of git+ssh://192.168.2.134/home/rjones/d/libguestfs

commit dc3b5a7a52fd1a53ba482042fcfb8c4b0bf83b09
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jun 10 14:29:41 2009 +0100

    CentOS fix: Skip checksum test if no squashfs module.

commit 8224bfd0020ee9e2cb6c58c8d1b8eeba3028e943
Merge: edbb821 ff211d0
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Wed Jun 10 14:23:15 2009 +0100

    Merge branch 'master' of git://git.et.redhat.com/libguestfs

commit 8c637e1fb03d4a4ff36af770758671b3cabf9842
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jun 10 14:23:05 2009 +0100

    CentOS fix: skip ntfs-3g.probe tests if no binary.

commit ff211d06eb5d1949d74011f9fa60b9f5915f8a05
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jun 10 14:13:34 2009 +0100

    Done: Device independent naming feature.

commit 875dc84cc01dacb1e254e294a66e179b96fbdbc6
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jun 10 12:48:26 2009 +0100

    Implement device name translation.  Remove device name hacks in tests.

commit 56bef498f46ac3dd580f4bde3c8f3ed2fe688826
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jun 10 11:49:42 2009 +0100

    In the daemon, change all const char * parameters to char *.

commit edbb821cb7daefacb7b78821926d751ba40cc232
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jun 10 13:27:13 2009 +0100

    Fix #2

commit b3bf5d9634880d8c9d8a247504a6a89436a0afe5
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jun 10 13:22:45 2009 +0100

    Fix device tests.

commit 1e97e406c36031617a86a4fa6bb78a112848ee87
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jun 10 12:48:26 2009 +0100

    Implement device name translation.  Remove device name hacks in tests.

commit 7ec11d3aa119ea57d0ac249a9e65884045e2642a
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jun 10 12:48:02 2009 +0100

    Fix small sfdisk bug.

commit 887290e949d54c6ac4c9b787231e588f84f2367c
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jun 10 11:49:42 2009 +0100

    In the daemon, change all const char * parameters to char *.

commit 2df2f2854ed2d1f9857ef3c5aaca29810cf3c506
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Jun 10 11:11:14 2009 +0100

    Add IS_DEVICE checks for all calls which take a device parameter.

commit 4aea83962337ac5e5847398e2128a9dbb8779247
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jun 9 22:01:00 2009 +0100

    Describe the standard naming scheme and translation algorithm.

commit fe491524cefd1ede281debbc128dab4ce26d7ab6
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jun 9 15:21:33 2009 +0100

    Added more to-do items to the list.

commit 27161658c897544a58c7d4f87c08f2ee8ce08d43
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jun 9 11:20:05 2009 +0100

    New website, change et.redhat.com references to libguestfs.org

commit 9726fe0b346cefb3e055b3a2f9daf0bf5252267d
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jun 9 10:51:02 2009 +0100

    Prepare for 1.0.43.

commit 7baf58278b620504d67acd01d3d992603fcd3b70
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Jun 9 10:33:34 2009 +0100

    Add support for decoding the Windows registry.

commit 460d139e6a52da67a4f1947035b1978610349f78
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Jun 8 17:44:18 2009 +0100

    Generated code for ntfs_3g_probe command.

commit 3de234656bc61a2d35b0f1a9ccb1e6ef7535166b
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Jun 8 17:44:14 2009 +0100

    Add 'ntfs_3g_probe' command so we can probe the "mountability" of an NTFS partition.

commit 88be1d399915c716ff312f29a7d3f3afcfd509f8
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Jun 8 15:54:26 2009 +0100

    Todo: qemu options.

commit c1ac7607bfe845db3c8bb3e0a766d5f16d56b2ed
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Jun 8 15:48:39 2009 +0100

    Add missing documentation for guestfish 'lcd' command.

commit 3496c6c3dfb5ef4ab93f6aae86512665a37b23cf
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Jun 8 15:46:23 2009 +0100

    More TODO items.

commit fa8cb5dac284bf463677380e5ef55370f447d870
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Jun 8 10:01:42 2009 +0100

    Added 'lcd' command to guestfish.

commit 85d7e275b5460df6f075a6931cbaed7d0a0dcb7c
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Jun 6 17:44:01 2009 +0100

    Prepare for 1.0.42

commit 42b90f2d0d5b16da948f77e99e84c9192e742a4e
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Jun 6 17:34:42 2009 +0100

    Parse /etc/modprobe.conf and initrd to give us a closer understanding
    of what the guest will actually boot on.

commit f18af71ff43dd87d343b459134a470900f84b833
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Jun 6 13:19:44 2009 +0100

    Added query mode to virt-inspector.

commit 0b3b482542319bf329974397c99b8c0663b9e536
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Jun 5 15:51:14 2009 +0100

    Modules are *.o in Linux 2.4 kernels.

commit 8281007ff4369feaebc5b8e3395fcbf4a8548561
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jun 4 15:09:16 2009 +0100

    Version 1.0.41.

commit ab81d09a710242ab61001ef5e8ffd321725b47a7
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jun 4 15:05:23 2009 +0100

    Fix RHBZ#503169 comment 13 (regression) and add a regression test.

commit 96b9d82e2f4f24cdd41040f54a7597202c04cf7e
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jun 4 15:04:05 2009 +0100

    Added regression test for RHBZ503169#c10

commit dcd8742578a57e0871d6db4797014bbfd854a57b
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jun 4 14:09:00 2009 +0100

    Move pure regression tests to their own subdirectory.

commit b6adf09c4d2cc3f1d0285950c151b1fd7688ec67
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jun 4 14:59:16 2009 +0100

    Generated code for the 'sleep' command.

commit 2ef06eacc2be08b0268c98a4d157176aff9356e0
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jun 4 14:58:14 2009 +0100

    Added 'sleep' command.

commit 9cedbba1a498e2a31be103c3adcd2df1ff9168c2
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jun 4 11:00:03 2009 +0100

    Prepare for version 1.0.40.

commit a903368c6db67dc599e5cbefe9e41611fba81faf
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jun 4 10:58:28 2009 +0100

    Add missing /dev devices (bug 503169 comment 10).

commit 6490ed4e5106b7c4e10c693068525c879dfb5964
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jun 4 09:14:47 2009 +0100

    Generated PO files for 1.0.39.

commit 3e70c50a0a17109f4f373a8fd909cac0edafdf7b
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Thu Jun 4 09:09:25 2009 +0100

    Prepare for version 1.0.39.

commit 80e15757879c4cf21e0511c62e57c19efb4aab63
Author: Charles Duffy <cduffy@messageone.com>
Date:   Thu Jun 4 08:45:04 2009 +0100

    Use --rbind rather than --bind for bind mounting /dev (to get /dev/pts).

commit 9d6de016ccd932c18001c08c371bf83c6dbff8f0
Author: Charles Duffy <cduffy@messageone.com>
Date:   Thu Jun 4 08:44:00 2009 +0100

    mount /dev via tmpfs before MAKEDEV invocation.
    This ensures that /dev can be bind-mounted when running commands,
    as initramfs cannot be bind-mounted.

commit d1da506d35e3c14b0bbe5397d73994fe082bc831
Author: Charles Duffy <cduffy@messageone.com>
Date:   Tue Jun 2 11:30:26 2009 -0500

    use add_drive_ro for --mount parameters from guestfish when called with --ro
    
    To prevent writes (such as ext3 journal replay) from occuring even when --ro is
    passed, guestfish should use add_drive_ro() for any drives specified on the
    command line with --add if --ro is also passed.
    
    As we need to look through the entire command line for --ro before adding any
    drives, we move the add process out of the argument-parsing loop and into its
    own function, patterned off mount_mps().
    
    Signed-off-by: Charles Duffy <charles_duffy@dell.com>

commit 76711b7e918f6dc504d3b5e11c6cac5ee11cc34f
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Jun 2 15:50:50 2009 +0100

    No parallel make in ocaml/ directory (RHBZ#502309).

commit 3aa9883eb155fe4e0b6f72f3bf6f6c9c5c6161f4
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Jun 2 14:51:45 2009 +0100

    Version 1.0.38

commit d1a1ab972bb22f4c38a21fcc73f81650aaa03b4e
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Jun 2 14:25:25 2009 +0100

    Generated code for 'add_drive_ro' call.

commit bfdc03be234d6d95f18450846433bce4f97e184c
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue Jun 2 14:24:16 2009 +0100

    Add 'add_drive_ro' call. Fix up documentation. Plus a couple of minor code improvements in the tests.

commit 5abae435f0cb239b70878968e040d61a6730b897
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 29 16:12:51 2009 +0100

    Squashfs recipe.

commit afa6f05e2e0d784250ab6408ff13152920d74495
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 29 15:30:57 2009 +0100

    Correctly handle malloc/realloc(0)
     - malloc and realloc(0) are valid requests.  Some implementations
       may return NULL for these, which would not indicate an error.

commit 80c5acfd148ede4ec1ca2dc2330b043b0cea29d5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 29 13:40:29 2009 +0100

    Prepare for version 1.0.37

commit e02066bcb33a2aed5f23dd18c3168dc66efddb18
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 29 12:59:32 2009 +0100

    Use a squashfs attached as /dev/sdd during the C API tests.

commit 75d260b6968309159f3335588f0e3f773d32a663
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 29 12:15:37 2009 +0100

    Add cramfs and squashfs kernel modules (RHBZ#503135).

commit a011c5f3263601cd8555e50a4dfa03e27fdb7361
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 29 12:14:35 2009 +0100

    Fix the rule which rebuilds make-initramfs.sh.

commit f6e36bf361c587e0dbb2f0c71f5d22a7cf7f4f42
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 29 11:20:29 2009 +0100

    Fix mkdir-p if directory exists (RHBZ#503133).

commit 1e4173be10cf762c85f7f64ab27be98f3b57dd7a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 28 23:14:47 2009 +0100

    Rerun generator to update tests.

commit cebe6df7456ed60cb2ae25875b2a4f377297491b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 28 22:49:39 2009 +0100

    Version 1.0.36

commit 70e5dd559b79c81012979fd38673df075b769e82
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 28 22:03:18 2009 +0100

    Fix path to COPYING.LIB

commit d6a0adf00900b05b7e9e14a29caf86fb30dec6a9
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 28 21:06:40 2009 +0100

    To-do: Note that we need to finish the bindings tests.

commit a3d4d655ffdd335372051c14ca53e8664ff799eb
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 28 20:41:12 2009 +0100

    Distribute bindtests.rb in the tarball.

commit 22bc6a969bebfa8547422033f665c768fe8c7c1e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 28 20:38:50 2009 +0100

    Distribute bindtests.pl with the tarball.

commit d5424b938a989ba32e45982521f9cd56d093d163
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 28 20:28:04 2009 +0100

    Distribute bindtests file.

commit b03ce92f2a6775ed5c950a5a3aedfc6133711aba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 28 20:27:11 2009 +0100

    Fix path to guestfish in test-bootbootboot script.

commit 3a7590f2bb716ec6ce0e5b7445f3ec7409ba1b4b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 28 20:26:50 2009 +0100

    Fix permissions on ocaml/run-bindtests

commit babc0846cc911b01a58a7385d30ad25889b7175a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 28 20:15:51 2009 +0100

    Add tests for bindings parameters, fix several broken bindings.

commit c41fe04a652437c920acb0e820762c53bf44a139
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 28 16:23:04 2009 +0100

    Add the test0* functions, used to test language bindings.

commit e2206733d1287f5809dbde954f3eb64420471b0d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 28 13:15:34 2009 +0100

    Move C API tests out of root build dir into 'capitests' subdir.

commit a1e8cdf2a254c5eddaf525cd7c34e4c937690204
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 28 13:00:31 2009 +0100

    Move the appliance and build scripts into new appliance/ subdirectory.

commit 4e444d53cc9497b7cb36ad35fdee825cade72b0f
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed May 27 17:12:50 2009 +0100

    Updated PO files.

commit c59310f777a0437ebd95e14bf0b1987c61d8e0e8
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed May 27 17:11:57 2009 +0100

    Removed contrib/*.spec files.

commit e7d66edd8d481f162904d611bd499f968f2f74ef
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed May 27 17:04:48 2009 +0100

    Version 1.0.34.

commit e58626a0e59ebb1c3417de33080fa65cfe0b482a
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Wed May 27 16:17:13 2009 +0100

    Back to GNU gettext 0.14 for RHEL 5.

commit 6b668620681ada82857e09922a0feb004ee65882
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Wed May 27 16:12:52 2009 +0100

    abs_top_builddir doesn't exist in old RHEL 5 automake, use top_builddir instead.

commit 9c16028a2317a4e1ae5b0831a8a71c98c86852ae
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Wed May 27 16:11:24 2009 +0100

    Removed these old/obsolete specfiles.  For replacements see contrib/README.  (for Charles Duffy).

commit 6cfe0854e27bfecfb001aae12a960af8f06108c4
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed May 27 13:00:23 2009 +0100

    Version 1.0.33

commit 1b2c0e34b15a8f41f5036d127d60efed687b6c97
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed May 27 12:46:04 2009 +0100

    Improve javadoc (RHBZ#501883).

commit 6610af333b93d93f6f0f4b917e0caee0d35ba389
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed May 27 12:29:35 2009 +0100

    Guestfish built-in commands auto-complete (RHBZ#501878).

commit 65ad55778b8cd8e948d59fd3624966018366c45f
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed May 27 12:22:00 2009 +0100

    Fix Java configure tests (RHBZ#501885).

commit 08414bbb3c75585453c3bb084d4317b6107e4e8f
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed May 27 11:48:01 2009 +0100

    To-do item.

commit 7682199cfca20a52664c8e52035a06345862f226
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed May 27 11:40:59 2009 +0100

    README, TODO and HACKING files are now shown on the website.

commit 213988115a8fd25266050228ac5184264f56baf8
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed May 27 11:33:02 2009 +0100

    Allow more ext filesystem kmods (Charles Duffy).

commit b8b89f509c353fb662794c58bc840c8468c6e18f
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed May 27 11:31:39 2009 +0100

    Improve documentation in README file.

commit 8dfae186196e6cd740c1db0e0be2b5ac94b87993
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue May 26 10:04:20 2009 +0100

    Fix bug links.

commit 9f2e9d7c3d38ab9e1be7dbed84d4eea0d86d1ec2
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue May 26 09:55:25 2009 +0100

    Version 1.0.32

commit 2d1890d149bc200bd94e16f9a4f06eb13a2e3697
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue May 26 09:47:41 2009 +0100

    Added Polish translation (Piotr Drąg) (fixes RHBZ#502533).

commit f01957c37a1cdf74cf01a6c86b8b5a312b27dfba
Author: Richard Jones <rjones@debian5x64.home.annexia.org>
Date:   Sun May 24 16:01:45 2009 +0100

    (Commented out) Overwrite /sbin/init

commit bf19b4f0c4b0894924c1c69f3b87504f07c4404d
Author: Richard Jones <rjones@debian5x64.home.annexia.org>
Date:   Sun May 24 16:01:27 2009 +0100

    Print a message when /init starts.

commit 4091fffcd5d7b2820086e019b71eae23a2d4a9e9
Author: Richard Jones <rjones@debian5x64.home.annexia.org>
Date:   Sun May 24 13:53:23 2009 +0100

    Small documentation bug in configure script.

commit f7ef94f5158cc56d7b1fb391e5907abd87dc4c3f
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri May 22 10:52:43 2009 +0100

    In daemon, set PATH, SHELL and LANG environment variables.

commit 5f76f421d05041fc66fe0944ea3b85723f0d4cc4
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Fri May 22 10:52:28 2009 +0100

    Add 'debug env' command to print environment.

commit 31aaa279b51a5a16dbbd40879696eb850abfb224
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 21 20:32:05 2009 +0100

    Updated POT file.

commit 26637995f07006b7664e572879018adca7e328cb
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 21 20:22:32 2009 +0100

    Prepare for 1.0.31.

commit 7784b51430c6b4dbd85c6b023191ed3bb233ad77
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 21 20:21:43 2009 +0100

    Individual tests can be skipped by setting SKIP_TEST_<CMD>[_<N>]=1

commit 4010d56856f49b2be6f0cb227b47c48a38691a6a
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 21 19:48:57 2009 +0100

    Updated POT file.

commit df4b00d9cc8bf5882f121382222398288c51bb51
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 21 19:36:33 2009 +0100

    Prepare for version 1.0.30.  Reduce boot loop script to 10 boots.

commit b28815d7bf03d156af0276a11433638dcd736662
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 21 17:16:00 2009 +0100

    Add test-bootbootboot.sh script to EXTRA_DIST.

commit 167752ec90a88204ef762f8f7d8007fecc0d260e
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 21 16:31:34 2009 +0100

    Version 1.0.29

commit 3e408f493496597dc026d20778837f421f05a9dd
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 21 16:18:16 2009 +0100

    Generated code for e2fsck-f command.

commit 0f81d0941a2705d49bc129f69924265fa60d9677
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 21 16:17:38 2009 +0100

    Add e2fsck_f command, and modify lvresize test to use it (RHBZ 502018).

commit 2a042d9844ca203ccea28a5d533c18f2dbdfcfa7
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 21 16:03:31 2009 +0100

    Fix pvremove, vgremove, lvremove tests (RHBZ 502007).

commit d215800f10314dd5019d8d171961f8b97a35e817
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 21 15:59:11 2009 +0100

    Ignore generated file.

commit ff9c8dfcd178dcd3a35ae3e368b461f3bf44b2ad
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 21 12:45:26 2009 +0100

    Version 1.0.28

commit d70248333edf8a5b5f509609cf2c8f7fd77d5e05
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 21 12:01:36 2009 +0100

    Gettextize the source, make library strings translatable.

commit 29204fe10d6ad46bace50e82557cb95e8a0f3529
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 21 10:54:32 2009 +0100

    Intltoolize the source.

commit ff1b92c857d3c0377ce5062e2291fc3332dfc11e
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 21 10:00:00 2009 +0100

    Bugs have been moved to Red Hat Bugzilla.

commit 080545d0f87cca424420d05a743ab1f42becb72f
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Wed May 20 17:29:06 2009 +0100

    Bug about Fedora specfile.

commit f6bcb7b2ee269d82fee5e2d83bbb9187791033ce
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue May 19 15:25:45 2009 +0100

    To-do list for virt-inspector.

commit 91e3bbb85610904802191d055c25e5b285a9cb48
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue May 19 12:34:44 2009 +0100

    Prepare for 1.0.27

commit 123ad23a7e6df309553887affb7a44b8308a32d8
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue May 19 12:29:27 2009 +0100

    test-bootbootboot.sh is a test, not a source file.

commit 7b309445d4e9f93088ca052469338c8e3ce8dcbf
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue May 19 12:29:04 2009 +0100

    Skip 'zerofree' test if the command doesn't exist in the appliance.

commit 4c7183285105fd74496133c059a093b78dbe7723
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue May 19 12:21:32 2009 +0100

    virt-inspector now lists installed modules.

commit 1fc41b39dac877ccec1284da8bb14baa4df368b8
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue May 19 12:05:43 2009 +0100

    Generated code for 'find' command.

commit d1df2f342489bbbba086cae2bb95971c8e404cad
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue May 19 12:05:33 2009 +0100

    Added 'find' command.

commit 8b4819058243957c8fbbc92ef4fbbc0b46655380
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue May 19 12:05:06 2009 +0100

    Fix a memory leak in handling of tar files.

commit 135d55fe24bce65f8eb8ca50193eda8287fe7c9a
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue May 19 10:57:55 2009 +0100

    Inspect kernels for Linux OSes.

commit 816f3bcde7ed64b57b35fea80b09a721317df274
Author: Richard Jones <rjones@trick.home.annexia.org>
Date:   Tue May 19 10:57:32 2009 +0100

    Base appliance on Fedora 11 (by default - may be overriden by configure).

commit ca49c50e06834bbc68e21630a5552c57494f2b53
Author: Richard Jones <rjones@redhat.com>
Date:   Mon May 18 20:22:53 2009 +0100

    Generated code for lvresize, resize2fs.

commit 0695593702b8612b500ff0b3bf800e5934f9b56e
Author: Richard Jones <rjones@redhat.com>
Date:   Mon May 18 20:22:36 2009 +0100

    Add: lvresize, resize2fs commands.

commit 38797198d8f60b0a1793d7f228f69c757307ac3f
Author: Richard Jones <rjones@redhat.com>
Date:   Mon May 18 17:23:49 2009 +0100

    Version 1.0.26.

commit 85ed8cef99c19b4143844991d14e0b848fecc5da
Author: Richard Jones <rjones@redhat.com>
Date:   Mon May 18 17:16:24 2009 +0100

    Add vg-activate{,-all} commands, and resize recipe.

commit adf0974245af914c46b48766d0efdd5ee8608dda
Author: Richard Jones <rjones@redhat.com>
Date:   Mon May 18 13:59:57 2009 +0100

    Ignore old make-initramfs file.

commit af7e3fc047447ff77ade4640194f9ec519068951
Author: Richard Jones <rjones@redhat.com>
Date:   Sat May 16 08:45:14 2009 +0100

    To-do: Explain the situation with resizing block devices.

commit 5cd39c83e23eb300d1bdfa806902a31b409ff420
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 15 14:01:28 2009 +0100

    Add: pvresize, sfdisk-N, sfdisk-l, sfdisk-kernel-geomtry, sfdisk-disk-geometry commands.  Pass --no-reread flag to sfdisk.

commit b8e5f51c79f539a740827506cc9da3ffcb6c87f8
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 15 14:00:41 2009 +0100

    To-do: zerofree done, Haskell bindings need to be completed.

commit d901cc916102f1aaccfb73396b48aa303e5b8cd7
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 14 23:47:17 2009 +0100

    Add support for zerofree command.

commit 4aa4ecc380edc509aba886417c67d9c39ab51c9a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 14 21:44:17 2009 +0100

    To-do: zerofree

commit 7ca3bda1660b58b82f4a11bc5637bf610a43aba6
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 14 14:43:53 2009 +0100

    Enable run-time conditional test prerequisites.

commit 17fa7abbb83024deb639aebf27686848e232e085
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 14 13:00:12 2009 +0100

    Add test prerequisites.

commit 1eeaf2ea11a502bae686fde753b31a72e700a3ba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu May 14 11:20:00 2009 +0100

    Added a couple of bugs related to test code.

commit 16d6d9851ad33fde675b45c27725ea394b718c7a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 13 22:13:49 2009 +0100

    Bugs related to OptString handling.

commit 5d628a4a9cc11eb9a61a1dc683aadca9ac378736
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 13 18:03:41 2009 +0100

    Don't stash strings in the handle.
     - makes it impossible to write bindings for set_{path,qemu,append}
       functions

commit e8ecc08f663b44f3d79517affe52f137858dfe00
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Wed May 13 17:51:14 2009 +0100

    Add 'append', LIBGUESTFS_APPEND to set additional kernel options.

commit 5b17af107f75a0d6f3a39b88b9c18714014eb7af
Author: Richard Jones <rjones@redhat.com>
Date:   Wed May 13 15:55:26 2009 +0100

    Allow number of loops to be set on command line.

commit 70ac63f8c5e5818113e55e3fc77e6baf7be660cf
Author: Richard Jones <rjones@redhat.com>
Date:   Wed May 13 12:56:32 2009 +0100

    Tidy-up of test script.

commit c1f9ecec84093ea64f30311246fc18849a1aa460
Author: Richard Jones <rjones@redhat.com>
Date:   Wed May 13 11:44:11 2009 +0100

    Exit early from script on error.

commit 1ed352b5dd07ee6068e0255e17bf81dc609af702
Author: Richard Jones <rjones@redhat.com>
Date:   Wed May 13 11:43:21 2009 +0100

    Increase the wait time for vmchannel socket to appear (fix for slow / heavily-loaded) machines.

commit 09c42a97daeae4fdccf40374620e533469a281a6
Author: Richard Jones <rjones@redhat.com>
Date:   Wed May 13 11:16:24 2009 +0100

    Test booting repeatedly to track down qemu boot hangs.

commit d5709ba3fd9b666012926e0a2a7e36107433eb98
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 12 17:56:36 2009 +0100

    Version 1.0.25

commit e595146b5c742de5604a175f0d150931d9f6aa6d
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 12 17:55:33 2009 +0100

    test-command is not an actual test program.

commit 791a34b6d9408f2b412d84a75d8617748d2262b4
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 12 17:24:45 2009 +0100

    Prepare for version 1.0.24

commit b2a5fec5f8b8b6bf1313d8474448cd8b50057d1b
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 12 17:17:19 2009 +0100

    Refactor line splitting code in the daemon, and fix it so it works.

commit 45d78361d791f4a752fca9472b81bdc75f9f92a4
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 12 17:16:59 2009 +0100

    Test the 'command' and 'command_lines' functions thoroughly.

commit 8a7a6180a865e6895fa531865c5016d793271dfe
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 12 15:04:43 2009 +0100

    Remove Perl from appliance - fixes large appliance problem on Rawhide builds.

commit 03ff42cb2e088b00c15023d456058cbcdc5d3c81
Author: Richard Jones <rjones@redhat.com>
Date:   Tue May 12 12:58:45 2009 +0100

    Remove the specfile from the tarball.  Include contrib/ dir.

commit 1856e2ba451c472f5312d1441cced1995b27428a
Author: Richard Jones <rjones@redhat.com>
Date:   Mon May 11 16:44:07 2009 +0100

    Version 1.0.23

commit 8cddd6c7e754c8d893eb991bef0171641ad4479e
Author: Richard Jones <rjones@redhat.com>
Date:   Mon May 11 15:43:00 2009 +0100

    Depend on new febootstrap 2.0, and use febootstrap-install.

commit 09128ca421f13da9fb6446cd7b09b0ae89c3876f
Author: Richard Jones <rjones@redhat.com>
Date:   Mon May 11 10:51:21 2009 +0100

    Perl bindings fix: Not enough memory was allocated for array params.

commit d43dac69483e8ec62e8356d93f761684ce2f5cc8
Author: Richard Jones <rjones@redhat.com>
Date:   Sat May 9 17:19:24 2009 +0100

    Partial Haskell bindings.

commit f0a5cd69f92f734b94e2361a939e4a1eb01dad9c
Author: Richard Jones <rjones@redhat.com>
Date:   Sun May 10 13:51:51 2009 +0100

    Handle EINTR, EAGAIN in select main loop.

commit 62c11fb60ef722c77215357a14465b44b5c7402f
Author: Richard Jones <rjones@redhat.com>
Date:   Sat May 9 15:37:40 2009 +0100

    Note about using FUSE / mountlo code.

commit c889d127598f5613a49ee713adeb7165f473dbdc
Author: Richard Jones <rjones@redhat.com>
Date:   Sat May 9 13:52:24 2009 +0100

    Version 1.0.22

commit f9356f33b040b3ff5038aa30b21b30b1ad489e1c
Author: Richard Jones <rjones@redhat.com>
Date:   Sat May 9 13:43:15 2009 +0100

    Valgrind now implemented - remove from TODO list

commit c419731e3a04333aea7d1af7e1069221a34344a5
Author: Richard Jones <rjones@redhat.com>
Date:   Sat May 9 13:40:31 2009 +0100

    Add 'make valgrind' target to run tests under valgrind.

commit 09492abb6590c8b804273172dc5340705a868f95
Author: Richard Jones <rjones@redhat.com>
Date:   Sat May 9 13:31:08 2009 +0100

    Fix four memory leaks in guestfs.c revealed by valgrind.

commit cdc726dcfc8bd0b9351cc6879df1e35f37af7fb8
Author: Richard Jones <rjones@redhat.com>
Date:   Sat May 9 13:30:40 2009 +0100

    Fix memory leak in error return path.

commit 12baf36e87c6a0968939e98b1969bc1b9d8cb0bc
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 8 20:16:03 2009 +0100

    Experimental febootstrap install script.

commit cead6fe22d32e8fcdb26c60fdad5db49bf3f0ec0
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 8 15:49:42 2009 +0100

    To-do: Use valgrind.

commit 08361c8987f4552649b6c708f52e940e1575fa6e
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 8 15:49:34 2009 +0100

    Bug: Segfault in Perl bindings.

commit 2fa68269fa63c5aab2015e3ee6ee1d33185e6e0a
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 8 15:48:02 2009 +0100

    List installed applications (NOT WORKING).

commit 15e0fd573a87488c66cb3a6f0da01f3ab5f2f6ed
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 8 15:20:36 2009 +0100

    Generated code to support last 3 commits.

commit 77c3f9d0ed25218fc3f24cee083a2083157d8e0a
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 8 15:20:20 2009 +0100

    Add test script to test recovery from qemu failure.

commit c10fa84ada465d83bcbe0550ed512215036b4bea
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 8 15:19:51 2009 +0100

    Implement -command (to ignore errors) in guestfish, and allow recovery from qemu process failure.

commit 33377fc61d4356a0e83cf7ef39d545842647481c
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 8 15:19:03 2009 +0100

    Allow recovery from guest failure.

commit 0faa5dde7b992ba11bb88f77b3424676c7c492e4
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 8 14:28:03 2009 +0100

    Generated code to support previous 2 commits.

commit fa7c8bb79b45aecdf65ed93635a42f3fdf301134
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 8 14:27:47 2009 +0100

    Implement 'strings' and 'hexdump' commands.

commit bd7c8ee043dd02e2cfa3eba2ac5875fc34990610
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 8 14:27:02 2009 +0100

    Bug: write_file doesn't work with strings containing ASCII NUL.

commit 28e18580c25809050ecc6acd55bf9fe35740ca66
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 8 11:37:42 2009 +0100

    Note another bug found when testing on Koji.

commit 7310279bafaa24506c2381a486fe2be0a9cff931
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 8 09:29:20 2009 +0100

    Missing BRs in spec file.

commit 4be389ce26ce38491a5b9f16f9f0f9d81d7002fb
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 8 08:50:27 2009 +0100

    Version 1.0.21

commit 93ad7365e400915e6ce7fe6896ca7b599e7cf83a
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 8 08:44:34 2009 +0100

    Change memory calculation to choose a generous amount of memory.

commit d50dbf2d7cda1edc18d5249dae051cd58e65b99a
Merge: f78de84 b99a342
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 8 08:40:49 2009 +0100

    Merge branch 'master' of git+ssh://192.168.122.141/home/rjones/d/libguestfs

commit b99a342f370695c30283f97d3b88c8736f0e279f
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Fri May 8 08:39:05 2009 +0100

    Added RHEL/CentOS example spec file.

commit f78de847966ce143c39f640a4ebecfa4b5236713
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 8 08:32:26 2009 +0100

    Force qemu quit when kernel panics (Charles Duffy).

commit 12c714e71d0c084babd90b62679ad318a1569792
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 7 21:39:37 2009 +0100

    Update date in changelog line.

commit a6155ea18b3d184f74438ae157dc43c4b8b3cbe4
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 7 21:34:08 2009 +0100

    Update %changelog in the specfile.

commit 4dffb3bbb5346410fe8b958add4a956b915d48a9
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 7 21:29:08 2009 +0100

    Prepare for version 1.0.20.

commit 427b5f079fd344919ecf568bab2084825aacf606
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 7 21:21:32 2009 +0100

    Fix leak in realloc failure (Jim Meyering).

commit dd8b152da0e899104fec305159640d08d7d6cdd9
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 7 21:10:01 2009 +0100

    Use unsigned type for lengths.

commit bb349b05333aa5bf87a3882f15458d8f7341d807
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 7 21:01:02 2009 +0100

    Handle EINTR and EAGAIN in reads.

commit 672c4ba257924c3e64836c08fb3b55bc4a6b2aba
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 7 20:52:33 2009 +0100

    Specify prototyping behaviour for Perl XSUBs.

commit e88c37bc71a54f1b8cff6a4bdc04b39fc32b28bf
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 7 19:28:21 2009 +0100

    Create daemon/m4 subdirectory if it doesn't exist already.

commit bfa4d217f09c00d574e1cf9266281ce15f2c9f1e
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Thu May 7 19:19:49 2009 +0100

    Set mandir (as in RHEL 5).

commit ab48e523b3f215dff09f68d3c0544ceec8757c68
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Thu May 7 18:51:34 2009 +0100

    Version 1.0.19

commit 6f0b962724a087a11edb5ce47aa06fa276fcb54b
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Thu May 7 17:24:02 2009 +0100

    Misc changes to make tests pass in RHEL 5.

commit fd2eccd2eff8da2272e9dbcdf9c6f0be9e687d4c
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Thu May 7 16:58:49 2009 +0100

    Include /usr/sbin on the $PATH (for RHEL 5).

commit c0beb26a0bc86188d38f2b36cbcd6cf20a676713
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Thu May 7 16:58:31 2009 +0100

    Need to keep and modprobe dm_mod module for device-mapper support on RHEL 5.

commit db1aacb8e0ac28283e1d9f7d02119868de19836b
Author: Richard Jones <rjones@centos5x32.home.annexia.org>
Date:   Thu May 7 16:57:55 2009 +0100

    /dev/hd* is also a block device on RHEL 5.

commit 74a31e619b6907caa80f987e16020edd85c9367f
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 7 16:05:50 2009 +0100

    Add BR on ncurses-devel (needed for RHEL 5).

commit 01b20efdf43b87981c6b9899122e22ef307ee52f
Author: Richard Jones <rjones@redhat.com>
Date:   Thu May 7 15:51:02 2009 +0100

    Augeas is now completely optional.

commit 818cb88fce5e60e5ffffe98e49da346083464300
Author: Richard Jones <rjones@redhat.com>
Date:   Wed May 6 20:46:17 2009 +0100

    Added TODO item.

commit 65dab4f7f761c8ec0a2040956ffdbb14423503d2
Merge: 2c273b9 8f19940
Author: Richard Jones <rjones@redhat.com>
Date:   Wed May 6 17:55:46 2009 +0100

    Merge branch 'master' of git+ssh://rich@hakodate/home/rich/d/libguestfs

commit 8f199409ab7ae1f3d327f46c265125985aeb3aff
Author: Richard Jones <rich@hakodate.home.annexia.org>
Date:   Wed May 6 17:55:18 2009 +0100

    Note bug about chroot not found.

commit 2c273b92c182adc4621c0426c9ddb44efcdd21b1
Author: Richard Jones <rjones@redhat.com>
Date:   Wed May 6 16:33:26 2009 +0100

    Note Augeas support should be optional (TODO).

commit bb98bbb91c74cca47b5e1f79fd54f4024572fd22
Author: Richard Jones <rich@hakodate.home.annexia.org>
Date:   Wed May 6 15:29:01 2009 +0100

    Fix missing futimens bug.

commit 459da0831ca259fc06dacb773e5ce602bd4ac226
Author: Richard Jones <rich@hakodate.home.annexia.org>
Date:   Wed May 6 15:21:46 2009 +0100

    AC_CHECK_FUNCS for multiple functions.

commit 9a571d41f56c86e290781492ba410070c34b3379
Author: Richard Jones <rich@hakodate.home.annexia.org>
Date:   Wed May 6 15:20:15 2009 +0100

    RARRAY_LEN macro for Ruby < 1.9.  Small strictness fix for OCaml < 3.10.

commit 76758f42b1abc89d5857697c87ead5036ed81b13
Author: Richard Jones <rich@hakodate.home.annexia.org>
Date:   Wed May 6 15:11:40 2009 +0100

    Backport CAMLreturnT for OCaml <= 3.10

commit 64847eed1658e7287c51e920e1a600e15b9eb1c2
Author: Richard Jones <rich@hakodate.home.annexia.org>
Date:   Wed May 6 15:08:13 2009 +0100

    Missing include <ctype.h>

commit 4b382eb8110050cb5b769c6f7d79b0b77eb79719
Author: Richard Jones <rich@hakodate.home.annexia.org>
Date:   Wed May 6 14:52:15 2009 +0100

    virt-inspector configure bug.

commit 60258700e81a6a68875496f365d9f9cec19c8df2
Author: Richard Jones <rich@hakodate.home.annexia.org>
Date:   Wed May 6 13:07:58 2009 +0100

    Added bugs noted by Charles Duffy.

commit ec8920e019930f29d3da4c318d3383e623cbfe22
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 1 19:00:22 2009 +0100

    Another TODO item.

commit 0cad78b28d48dfcc31f53292d0424ba5ded7fe12
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 1 18:51:15 2009 +0100

    Typo in documentation.

commit a4d88af2c13692e38fb7cfce77b082cee6e0462f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 1 17:41:28 2009 +0100

    Implement !local in guestfish.

commit 4ecdf8ec07d7eb4bfa4e1b5eef413e721a1f3711
Author: Richard Jones <rjones@redhat.com>
Date:   Fri May 1 13:10:47 2009 +0100

    Version 1.0.18

commit f47dafd23186938a22d41739d9bc695c7760b912
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 1 12:16:08 2009 +0100

    Generated code for 'equal' command.

commit d9ea3e8d979c3ade1b21f27083788fd33fa3b1fa
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 1 12:15:58 2009 +0100

    Added 'equal' command to compare files.

commit 8c3b820c2b687345448e3d74a7101b07ff32688e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 1 11:47:31 2009 +0100

    Generated code for ping-daemon command.

commit 632012e6419f04fab93909f92ecbab5a2c590447
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 1 11:47:23 2009 +0100

    Added ping-daemon command.

commit 24bee20ce4196d45891925332a47a05aa5e40938
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 1 11:27:52 2009 +0100

    Generated code for dmesg command.

commit 8c60f5c681b5d7cf90bc798fcaf94cd4e242e27f
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 1 11:27:32 2009 +0100

    Added dmesg command.

commit 9222136ac9b2e404dba128b1ac74dacaa8bf1038
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 1 11:18:53 2009 +0100

    Generated code for drop-caches command.

commit 2dc9e8a858b62830d15a8186fe575eb7903d2171
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 1 11:18:44 2009 +0100

    Added drop-caches command.

commit ac286b26df1aabceca26dac66c325a3676ace4cc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 1 11:00:46 2009 +0100

    Generated code for cp, cp-a and mv commands.

commit 3cb794463a62239e36d730bc5d2d3eb4c7a66096
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 1 11:00:34 2009 +0100

    Add cp, cp-a and mv commands.

commit af5087450063fe013ac2df4db39451d7da6152a3
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 1 10:59:51 2009 +0100

    Always look for qemu-kvm, even on non-x86_64 platform.

commit 65f77271f290eca1d8b91d16fc6e123037f86229
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri May 1 10:11:12 2009 +0100

    Check fakechroot >= 2.9

commit 62fa13411d4eac94473fd2fdcb8f4fade36cf0d0
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 30 23:39:31 2009 +0100

    Version 1.0.17

commit e118c14b9552de311cbc1734e03a3226b484c1e8
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 30 23:10:22 2009 +0100

    Generated code for grub-install command.

commit b55bf8158f0b7f6b1760b7b3b5f7c1274a149127
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 30 23:10:15 2009 +0100

    Add grub-install command.

commit 0fea1c76712c3c9a8e4309aa0b325e48a0a935b8
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 30 22:39:36 2009 +0100

    Replace rtl8139 network card with virtio-net.

commit 58b9f95e00d4524c1ac7d994365e65b96cde5a8c
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 30 21:29:40 2009 +0100

    Add documentation for the 'edit' and 'echo' commands.

commit 4581eb2523eeb4d094d53af0555cb7e0f760ae2d
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 30 20:11:04 2009 +0100

    Added guestfish 'echo' command.

commit df189925e4a0e6f80b0aebbd78201db09a63daf3
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 30 19:53:52 2009 +0100

    Added a comment syntax to guestfish (# ...).

commit f1c552c43607299bb32aecc1bf696bbc31f94dc8
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 30 19:44:28 2009 +0100

    Prepare for version 1.0.16.

commit 36f9dac1a2530b575dab9226f6ddd85e6e8c8590
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 30 19:32:58 2009 +0100

    Added notes to the 'fsck' command documentation.

commit 62df226f26bd6ac3c481a7790eb89d760d2f0386
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 30 19:28:54 2009 +0100

    Added 'zero' command to wipe partition tables and superblocks.

commit 2a42bec2c5ee521f29179a5aab713f5a9ca2c3b8
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 30 19:28:08 2009 +0100

    Correct the path to /sbin/fsck.

commit 89404ec0ba9781b55cb3a87689bcc519e7d73ea2
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 30 18:59:02 2009 +0100

    Enable parallel builds (Jim Meyering).

commit 0703248d233744047515418893dac05ce013a642
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 30 18:57:07 2009 +0100

    Add generated code for 'fsck' command.

commit c69c3695303d5a660ad093a076c2e364ae6061de
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 30 18:56:55 2009 +0100

    Added 'fsck' command.

commit 296b536c965820b8334150df0247a0657f6e35fd
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 30 18:05:13 2009 +0100

    Bind-mount /dev, /proc and /sys into chroot when running commands.

commit f7e6ffa8a82f8a7a214a47ff32f46d9e893902d8
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 30 17:34:23 2009 +0100

    Autosync now runs umount-all; sync

commit e4733575efff31742444b180cdcfbc2504b144c8
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 30 17:23:57 2009 +0100

    Fix umount_all command so it unmounts filesystems in the correct order.

commit 41b959fd9b057354f642d84398b875d02b88b864
Author: Jim Meyering <jim@meyering.net>
Date:   Thu Apr 30 15:55:58 2009 +0200

    build: don't tell "make clean" to remove my '~' backup files
    
    Hi Rich,
    
    automake's policy on what to remove via "make clean" is reasonable:
    if running build rules creates it, then "make clean" can and should remove it.
    However, even if build rules happen
    to create backup files, please remove only the specific ones
    they can create, not all of the ones in a directory.  Just in case
    someone relies on those and expect them to hang around...
    
    >From 1e8be391ac17b4ddcf9671e8413d2660844e6993 Mon Sep 17 00:00:00 2001
    From: Jim Meyering <meyering@redhat.com>
    Date: Thu, 30 Apr 2009 15:47:52 +0200
    Subject: [PATCH] build: don't tell "make clean" to remove my '~' backup files
    
    * Makefile.am (CLEANFILES): Don't remove '~' backup files.
    * daemon/Makefile.am: Ditto.
    * examples/Makefile.am: Ditto.
    * fish/Makefile.am: Ditto.
    * images/Makefile.am: Ditto.
    * inspector/Makefile.am: Ditto.
    * java/Makefile.am: Ditto.
    * ocaml/Makefile.am: Ditto.
    * ocaml/examples/Makefile.am: Ditto.
    * perl/Makefile.am: Ditto.
    * python/Makefile.am: Ditto.
    * ruby/Makefile.am: Ditto.
    * src/Makefile.am: Ditto.

commit 5e62afd7ce5145eee1894fab6f0722119fee1d31
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 30 16:09:50 2009 +0100

    Safer way to copy RPMs in no-net builds (Jim Meyering).

commit 3c5bcce927dfa9213469d1f641408a0105685291
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 30 15:43:11 2009 +0100

    Updated the generator so it only overwrites files if they've changed.

commit abb447c32abdea467374edc30704818dd2883da7
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 30 14:20:07 2009 +0100

    Correction to 366a86fb6097ab0f704443f0a6ae2addbc3745d5:
      The code in fish/completion.c is generated, so update the generator instead.

commit 366a86fb6097ab0f704443f0a6ae2addbc3745d5
Author: Jim Meyering <jim@meyering.net>
Date:   Thu Apr 30 14:34:02 2009 +0200

    * fish/completion.c (commands): Declare with a 2nd "const".
    
    It's a const array of const strings.
    
    >From 70c53d3169ae53fc4874e00975893d33387c51e6 Mon Sep 17 00:00:00 2001
    From: Jim Meyering <meyering@redhat.com>
    Date: Thu, 30 Apr 2009 14:33:01 +0200
    Subject: [PATCH] * fish/completion.c (commands): Declare with a 2nd "const".

commit de2cf8615aacb4aa1ee521d65e7ef22fb73dcbb3
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 30 14:15:00 2009 +0100

    Use AC_PROG_CC_STDC because we really need an ISO C compiler (Jim Meyering).

commit ab0397017cc26833c09946cca19d86b907822a94
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 30 14:01:53 2009 +0100

    Use safe_malloc and/or check returns from malloc (Jim Meyering).

commit 6f5c3984a7ddfc111287e2ec214ba823db737db4
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 30 13:36:26 2009 +0100

    Fix unchecked malloc (Jim Meyering).

commit 4f7cc37e5f4a209773062d67e5f61a81f7800fc8
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 30 13:36:06 2009 +0100

    Fix unchecked malloc & realloc in 'commandv' func (Jim Meyering).

commit 6dff51fc7d8a33925f164bd66c2c26cd4b94b3df
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 30 13:35:36 2009 +0100

    Check return value from realloc call (Jim Meyering).

commit 668d27b56857230fb81c04d1663a5aca1b9e77b9
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 30 13:02:29 2009 +0100

    Rename tune2fs.c -> ext2.c

commit f666990c2f6d94beee4f21c0e52e582eee68b054
Merge: 141f019 1507d23
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 28 22:44:59 2009 +0100

    Merge branch 'master' of git+ssh://g-rjones@et.redhat.com/git/libguestfs

commit 1507d230a8ca04f9d8114cd7f6b6fa4161abe746
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 28 22:06:27 2009 +0100

    [PATCH] add dependency to ensure make-initramfs.sh is rebuilt when (Jim Meyering)

commit 141f019348017d0ae217b9c3fd9805a963313d82
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 28 17:44:10 2009 +0100

    Resync with proposed Fedora specfile.

commit 1957e9ed3402120f4868dcea04abb51ceb44df30
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 28 17:37:59 2009 +0100

    Build virt-inspector HTML for the website.

commit fd99b96c973a1a60060b2585a9b74b360f4738c4
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 28 16:06:02 2009 +0100

    Prepare for 1.0.15.

commit 0aa45a5662bcb96348bd4753fb0404991f713319
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 28 16:04:12 2009 +0100

    XML output.

commit 6f2929c4635c3f2af4a9211981d9edd1f58cce69
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 28 15:15:56 2009 +0100

    Perl output.

commit 5ca50cbee961aa2f8592b3a38fba41e2a732b282
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 28 15:08:26 2009 +0100

    --fish and --ro-fish options working.

commit 5aa57fbd34eb34922719d08712303b9d73ec215f
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 28 10:04:27 2009 +0100

    Added virt-inspector program from virt-v2v.

commit 798b8dc5d84bc9b4884c67389950377ac2b97a66
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 28 11:39:27 2009 +0100

    s/builddir/top_builddir/ (Luciano Miguel Ferreira Rocha).

commit 1d96b8bdb42e44049aa84d1daa3e5d835d525b03
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 28 09:59:35 2009 +0100

    Fix perl hanging during configure (thanks to Luciano Miguel Ferreira Rocha).

commit b03ee3675bed8d739ae722ed8c030ae02b3cb0ed
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 27 13:41:59 2009 +0100

    Generated code for ext2 UUID and label functions.

commit afca1dba5eeb989c231a22df26e48f0967387547
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 27 13:41:30 2009 +0100

    Functions for getting and setting the ext2 UUID and label.

commit e5b86fce27b0900d653911e64a85c3857c2fe604
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Apr 26 17:59:35 2009 +0100

    Version 1.0.14

commit 0b2748bb2729bea0d6f6b794e7f6e0cfb8d36bcc
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Apr 26 12:11:23 2009 +0100

    Add --version option (show version) to guestfish.

commit edd99a3f7903f6f80d3f73643cd6ee114dbdd553
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Apr 26 12:09:06 2009 +0100

    Added the --ro option (readonly) to guestfish.

commit 9501ab7792e50e464dc65e9190a0e1d84b5dd423
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Apr 26 11:15:57 2009 +0100

    Update BUGS with latest status.

commit 79633552a42f5d6d60d5204c39acb0bc093199ae
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Apr 26 11:11:48 2009 +0100

    Get ready for version 1.0.13.

commit 64a6a828bd318622420cf3018899392fd80c14e7
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Apr 26 11:06:47 2009 +0100

    Multiple callbacks during file transfers could cause data corruption - FIXED.

commit b176abd7bb39ba69ecb523138732dba4b91f4090
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Apr 26 10:43:07 2009 +0100

    Check for multiple callback in RPC code.

commit ab76c39d696c7f0a0071bfbac0e36af69594e68c
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Apr 26 09:52:42 2009 +0100

    More checks.

commit 2df2819aa552d1cc7bf6a450aaf4d090a4341a68
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Apr 26 09:52:13 2009 +0100

    Include UTF-8 NLS.

commit a30f66436eac79b9e532e448882d03375c0d5e78
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Apr 26 09:51:48 2009 +0100

    Use ferror to check for error conditions in pipe.

commit 38f9222d21fb3c3005872de05247ff16a66db945
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Apr 26 09:51:30 2009 +0100

    Carefully check return values from xwrite.

commit e65e1d5d0053431702bc99e5d59725324adf1af5
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Apr 26 07:05:12 2009 +0100

    Don't echo output in scripts.

commit 0583c8c2c3500715fe5757d2e2fcb0fdc019c2ae
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Apr 26 06:48:31 2009 +0100

    Added rpmqa example.

commit 027897d4ddaf886a309a032b488f64512d2dc873
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Apr 26 06:34:54 2009 +0100

    Document qemu wrappers.

commit 9e4a31f66cb956daeb1dcee9aafadc7da3313999
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 25 22:59:19 2009 +0100

    Documentation fix.

commit 68b7076d4b61f00c5a2fd9282f0a3c59d429c7df
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 25 22:56:57 2009 +0100

    Note about bugs.

commit 252bf70225e95dcd4b254d8bcfa8e9cb5251f11b
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 25 22:56:42 2009 +0100

    Clean up *~ files in recipes/

commit b787efa8c627b459c876c11e59199df626011123
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 25 22:56:34 2009 +0100

    New recipe: iso2tar.

commit 96124562bbadc7c4bbf0a4ceca39b838dbe47ed7
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 25 22:43:24 2009 +0100

    Include UDF driver (for CD/DVDs).

commit 39944fb11248786c1eb0ee0f9fd5447e5d3f1ed6
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 25 22:06:04 2009 +0100

    Include the right RPMs and kernel modules for NTFS & VFAT mkfs and mounts.

commit aed0fa2c015e56a882fd6d4b759c82df08fc40d7
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 25 21:41:09 2009 +0100

    Generated code for lvremove, vgremove, pvremove.

commit 58caa9e5f1dca3916178894876b938a6a45771b0
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 25 21:40:50 2009 +0100

    Implement lvremove, vgremove, pvremove.

commit b6d5c9e646d0aa18699a88d02ed9205380553b65
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 25 18:28:24 2009 +0100

    Better generation of recipes page.

commit a057a058e72d0949db4140e9a03b7a0e5b3c823c
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 25 12:36:45 2009 +0100

    export2tar recipe

commit 396bc943ed9cb7c6df091b18bc2eebe93ccc27d1
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 25 12:20:15 2009 +0100

    Improve CSS on recipes page.

commit b86d7b975629ae099ad9a137ced6f23b17c1531a
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 25 11:34:18 2009 +0100

    Added guestfish recipes.

commit ae17137f643c33f0ad8f61dc1abe4800815ddcc3
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 25 10:38:39 2009 +0100

    If LIBGUESTFS_PATH is set, guestfish shouldn't modify the path.

commit 2b21eec8d423d15c97227567834ce978f8cae42c
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 25 08:36:52 2009 +0100

    Added configure test for qemu vmchannel support.

commit ae5be84decf1a40e1de22176c747e110b77829a2
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 24 23:17:07 2009 +0100

    Experimental recovery process should help with not cleaning up qemu.

commit 18bf945023071d5d4ec8d96e25142e0ffd066e7c
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 24 22:26:50 2009 +0100

    Remove the debug mode from make-initramfs.sh.

commit 072567882711725190593f2196e658d5ebf6d5ca
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 24 19:03:18 2009 +0100

    Add support for ext4 to examples/to-xml.c

commit 251858d521c55f6b65d9a671d79c39007514a74e
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 24 18:33:06 2009 +0100

    chmod /sysroot (also makes it known to fakeroot)

commit 18d15a9e5b2324699feef0d710197bdd0f1b7b23
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 24 14:52:49 2009 +0100

    Resync specfile with proposed specfile in Fedora RR.

commit 56826a0dc9533cb1d7d227c5a2f70d8d31a4dd8f
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 24 14:31:38 2009 +0100

    Ruby bindings didn't NULL-terminate an array, resulting in segfault.

commit ab6f429a5a5ba084bdc948c0c21b2dceeae6298d
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 24 14:29:58 2009 +0100

    Added bug about qemu not being cleaned up after segfault.

commit b3021495a92b0d5bd2a91f922be42f28b0b321c8
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 24 13:19:21 2009 +0100

    Get ready for version 1.0.12.

commit 851b9a18d24de8fa81d4ca3063df59668484e884
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 24 13:15:49 2009 +0100

    Don't allocate file chunks on the stack.

commit 4507dd497f9a5eb8584e6d0937a87dc659cfa144
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Fri Apr 24 13:00:49 2009 +0100

    Don't use large message buffer on the stack (fixes Java/i386 segfault).

commit 5b0fcfffc1872f335a2a6da9505f2e8926b1a740
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 23 20:08:29 2009 +0100

    Fix 64 bit memsize overhead.

commit 8be6c7056d18cd5aa5edddfc73bfd4206b038cee
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 23 19:33:00 2009 +0100

    catsprintf leaks, use open_memstream instead.

commit 012a2ec1acf7a7a2d859f78ea4932ae9fb30522d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 23 19:23:52 2009 +0100

    Remove the 'debug mem' command, it's never going to work.

commit 5f8c46db05966a6e31b696d629fd3f74e4fb6c71
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 23 19:23:33 2009 +0100

    Reduce the amount of memory allocated to guests based on some testing.

commit 21dbad6b95d5355f622e74c9c9d8a547c04e6e00
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 23 18:52:34 2009 +0100

    Implement 'debug sh' and 'debug fds' commands.

commit e2870fb94cbd22affecdd16e8f75f75e78d1c18b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 23 18:52:06 2009 +0100

    Implement extensible strings with catprintf.

commit 6eaa49faddeef5ec086ad7c58e0cd591fb4400dc
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 23 18:51:12 2009 +0100

    Use AC_GNU_SOURCE in daemon.  Don't need _GNU_SOURCE in C files any more.

commit b18961055531f0107ed4f62c0d2f28e4ac1270e0
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 23 14:47:06 2009 +0100

    Fix buffer overrun in guestfish command-line parsing.

commit 8f9f02d483b87c787d089cf9329f5f1b81d3a77e
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 23 14:39:31 2009 +0100

    Generated code for debug command.

commit 713283f4a67b3a1960ca96ce6608d046fc202d2d
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 23 14:39:18 2009 +0100

    Add outline of 'debug' command.

commit 81d4a01ac03bc2996eea1ca4cc3182e50d21e6ba
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 23 11:47:06 2009 +0100

    Automatically generate ChangeLog file from the git log (thanks: Jim Meyering).

commit 6fd5bc84893c600af75ef64fa9f9a043b665c76a
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 23 11:32:53 2009 +0100

    Substitute '-' in command names in guestfish documentation.

commit 5d13ccaf55aed74b8e2d778c064c544e6300e0a5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 23 11:11:35 2009 +0100

    Fix Java tests by passing correct library path to JVM.

commit d660085d7aff275b720ef4efb28ecafd7d7209e5
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 23 10:54:27 2009 +0100

    Configure script tests for Perl modules.

commit cf13c86a2c6fd56c07d7a92bcd28f99598c6a259
Merge: 54ca2f1 dd98434
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 23 10:32:31 2009 +0100

    Merge branch 'master' of git+ssh://g-rjones@et.redhat.com/git/libguestfs

commit dd98434c1b45f7a27065b13839089c7265203e2d
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 23 10:28:28 2009 +0100

    Avoid a cast warning on 32 bit.

commit 54ca2f1f8c21e53af6798a68c897ce3b9acbfc91
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 23 10:19:33 2009 +0100

    Instructions on running KVM as non-root (Robert P. J. Day).

commit 8261323786f5cfa2f9d71d79b4ae8065352eae2b
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 22 22:01:08 2009 +0100

    Version 1.0.10

commit 79cdf81e2fb717ea4372a55170d16800cdbddf23
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 22 21:02:49 2009 +0100

    Generated code for new mount_* commands.

commit d7ffe439e8ec5304a1a2d1eb591d348c4ab84f38
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 22 21:02:15 2009 +0100

    Add mount_ro, mount_options, mount_vfs.  Fix small bug in OCaml generator.

commit 35dc2f5706a957fe9a17d4bc29ad433c541d2fa0
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 22 19:17:29 2009 +0100

    Get ready for 1.0.9.

commit c5b2282111ead9a0c59db5f40229d20fe0203681
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 22 19:15:11 2009 +0100

    Force a specific network NIC model (allows to work with latest qemu from SVN).

commit 92c2c33d6162ae0781be47472051305bae332252
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 22 15:27:42 2009 +0100

    Fix infinite loop encountered when reading Windows disk in example program.

commit a8d25362435121ada85656c08cd79642f79f9f7b
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 22 11:47:07 2009 +0100

    Added pkgconfig file (libguestfs.pc).

commit f99cb04943f1c4583e52df684011766add78ea28
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 22 11:30:58 2009 +0100

    Version 1.0.7

commit 228e71fe10128c6f91a6935e6b148c49801bb17f
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 22 11:03:05 2009 +0100

    Fix quoting of list args in guestfish manpage.

commit 93b14fcfe5376326632cb04e0c2f0cf1912cdbc6
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 22 11:02:00 2009 +0100

    Resync specfile to Fedora RR.

commit b837b64c74567b5291964005f691a18655396460
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 22 10:20:48 2009 +0100

    Create /tmp directory in the initramfs.

commit 94b95dc06c34d89cc56fb096b1e30b5e19d06c10
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 22 10:06:40 2009 +0100

    Include fuse.ko module in image.

commit 4bcb05e92f090f872fb823ffdadd241486a13107
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 22 09:18:02 2009 +0100

    Version 1.0.6.

commit 5e635ed9102d0ad4d0e0d03a60c8493451628473
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 22 09:04:04 2009 +0100

    Note, but don't fix, javadoc bug.

commit a331c0ca48bd796b3b382da2756537831293f44f
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 22 09:03:27 2009 +0100

    qemu runtime done - remove from TODO list.

commit 43db06ea892cc157324a6b837ca430607441c509
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 22 09:00:39 2009 +0100

    Allow qemu binary to be overridden at runtime.

commit 54dd7be5855055a698291084c0074a1abac7b921
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 22 08:46:35 2009 +0100

    Allow selection of qemu using --with-qemu

commit 0d89fb44869a22c0a3fb84fd13d31006e41799f9
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 22 08:14:49 2009 +0100

    Error message about using --with-java-home=no to disable Java support.

commit b36dab0552df45d3d08aeeaf931294d091516f1f
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 21 23:15:25 2009 +0100

    Fixes for Java.

commit 6d5f69f81a888e26a425800c80d2892e10d74cea
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 21 22:38:28 2009 +0100

    Add extra kernel modules required for ext4 support.

commit f52bc724a30e45c28f231b48bca5fe0eb22592f0
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 21 22:27:22 2009 +0100

    Updated documentation, prepare for 1.0.5 release.

commit 231b2cf3c76b0613ac580901919b33db2ec6791d
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 21 22:24:25 2009 +0100

    Another Java test.

commit 2b568496e6d571be317bcecd58785edbf5d39ba1
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 21 22:05:44 2009 +0100

    Testing the Java bindings.

commit 7f818fa00c3d019146c7178f152408038d4a4d52
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 21 21:14:55 2009 +0100

    Java bindings compile, not tested.

commit 28bce4792198bc832e6ac0027a57091daa4c91c7
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 21 14:38:12 2009 +0100

    Add summary message, fix libruby detection.

commit f087927c5c9ef891ba6c943ce887ae9f40258a83
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 21 14:25:31 2009 +0100

    More notes in the TODO list.

commit b9014d6a0da8b2b3a76c4ab51fab2773fe7480b2
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 21 14:25:16 2009 +0100

    Basic Java build environment.

commit 936108f54cbf8e81132a0a0a8c093a4056f0e11c
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 20 23:40:50 2009 +0100

    Various fixes to build and test in Koji.

commit 89f060b5cfecc11558174b7e0b3867f2b8d9c135
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 20 21:16:25 2009 +0100

    Fixes for CDPATH being set.

commit 6a77cc2611a84c6e46f45fff49d8f22059f8aa05
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 20 19:30:11 2009 +0100

    Use standard names for the OCaml/Perl/Python/Ruby subpackages.

commit 9b281a66c0b2db5f50531528a1bc8d7c53ecf373
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 20 18:20:34 2009 +0100

    Ruby also supported

commit 6397feeb74af9c750b0430bc88f0855b1f7f1d28
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 20 16:52:13 2009 +0100

    Include the __cplusplus header magic so API really callable from C++.

commit e44128bf547024509bc064e728fb269504486659
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 20 16:28:02 2009 +0100

    Version 1.0.3.

commit d802fd46928674fd399a495e48f8d8650678a851
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 20 15:59:08 2009 +0100

    Removed TODO item, now implemented.

commit 0232e722826cfda0f6042da983f9eb871f24e946
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 20 15:54:22 2009 +0100

    Added tar-in, tar-out, tgz-in, tgz-out commands.

commit 11350529fee2dbbcfda333bbe10d72f023dc2109
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 20 15:13:34 2009 +0100

    Various fixes to the daemon:
     - make sure SIGPIPE doesn't kill us
     - warn not to use macros in FileIn functions
     - add shell_quote function

commit feb188d27787c595f12507ce5bff5431c4932523
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 20 14:58:36 2009 +0100

    Some fixes to daemon upload command:
     - don't leak the file descriptor along error paths
     - can't use those macros in FileIn functions

commit 4ce2b7b7fb949f584e4ad4b9d18121459be34a6a
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 20 14:58:04 2009 +0100

    Make daemon cancellation really work.

commit c5d37435aa9e257fac1c2d517fadc7630fa0d869
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 20 13:14:07 2009 +0100

    Add tests for the upload and download commands.

commit 469c6cdfd5f2ffb07eaf01c16a21ed1e5cb174c1
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 20 11:45:29 2009 +0100

    Prepare for version 1.0.2.

commit 42341cc00362a9983142a95f36622ea5baeb280a
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 20 11:45:11 2009 +0100

    Avoid warning: Don't generate read_reply label unless needed.

commit 2069ade88144d8efd272a74be24b5c9ff49844dc
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 20 11:35:57 2009 +0100

    Fix file descriptor leak in daemon.

commit 24ccbb29ac475187f51a27dcd318db2b4824a0c1
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 20 10:19:45 2009 +0100

    Generated code for 'checksum' command.

commit aef3d2013fee188c9607f35657c45df88503cd64
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 20 10:19:29 2009 +0100

    Add 'checksum' command.

commit 170f262f0413de843af62b968f6d12c1c476ae7f
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 20 00:22:02 2009 +0100

    Implement upload and download commands.

commit d5151686d82b66c50935010fd5458be0e4386bab
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Apr 19 14:51:50 2009 +0100

    Use GUESTFS_LAUNCH_FLAG in the daemon, and use correct uint32_t.

commit 13465753d3ed056609ec1e3137750a05d0497a66
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Apr 19 14:39:19 2009 +0100

    Document initial message.

commit 08c333a73893a0fc413e7619c8e64bebaebc741a
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Apr 19 14:33:46 2009 +0100

    Document the internal protocol.

commit d73a4f097f96e7246718671b0a85cb94f0d3a88f
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Apr 19 12:41:35 2009 +0100

    Implement NEED_ROOT_OR_IS_DEVICE macro.

commit 749708a7ec8930c34605ec58c18fefe0ed8e7981
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Apr 19 12:29:25 2009 +0100

    Implement _send_sync, _send_file_sync and _receive_file_sync.

commit bb07a7f858da5d07c57360e62c0ddfd24ce6be45
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 18 22:33:15 2009 +0100

    Begin to add the upload and download commands.

commit 7bf3e1a43512293b1a3f78f880b57e7bbd372eae
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 18 21:21:44 2009 +0100

    Add ruby/ directory, add more warnings.

commit 42a8baf3c9abc6f742671f37e9e24b607e5f9857
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 18 16:29:00 2009 +0100

    Split out send and reply operations into separate callbacks.

commit 8e54ab289550a35747530e5b723fd35a22aa689a
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 18 15:41:22 2009 +0100

    guestfs_send -> guestfs__send, in case we want a future command called "send".

commit ef499de8946cf4b8120ef7917b2e5d7f9115041f
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 18 15:31:53 2009 +0100

    Separate out the high-level API actions.
     - Split out the high-level API actions so that they are in a
       separate file, and use the defined guestfs C API, instead of
       fiddling around with internal structures.

commit ad1d84a142169baaed293de71fb9430178d9f999
Merge: 1765330 8a4cdce
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 18 13:27:06 2009 +0100

    Merge branch 'master' of git+ssh://g-rjones@et.redhat.com/git/libguestfs

commit 1765330e07a48dc6f7bdef7007f69ebe606fa731
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 18 13:17:12 2009 +0100

    Rewrite of main loop impl, start of FileIn/FileOut support.

commit 8a4cdcef21770cb19368a3f9d5cff3df3c01f833
Merge: 0206f0e 92804de
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 18 10:16:34 2009 +0100

    Merge branch 'master' of git+ssh://g-rjones@et.redhat.com/git/libguestfs

commit 0206f0ead2a0d9a19b9fd58f61bf5eb5dc33b87d
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 18 10:16:03 2009 +0100

    Version 1.0.1

commit 92804dec7c4982d2039f81586bc4a5cacb46217b
Author: Richard W.M. Jones <rjones@redhat.com>
Date:   Thu Apr 16 23:55:56 2009 +0100

    Allow Ruby bindings to build correctly even if libguestfs not installed.

commit e88c365cfbc125b7f16f8b28ab74a0c32d150722
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 16 22:25:36 2009 +0100

    Fix spec file.

commit a5f68bd57d887c8c8818dbb92a9f8b7643f67827
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 16 22:13:20 2009 +0100

    Ruby bindings.

commit 5a6da98c943be987441673a590c151f15573b6cc
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 16 17:44:47 2009 +0100

    Resync with proposed Fedora specfile.

commit 1e60354dc8fb306fa139ae744a596f4f5bcbd9a7
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 16 17:38:27 2009 +0100

    Missing free() on return path (thanks: Steve Grubb).

commit 3ae8631c8fb1f9f05aab3549fd56a8b41cd99784
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 16 17:35:59 2009 +0100

    TODO list updated.

commit ecee63de60a2419abf54eb1967dab04643234ed6
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 16 16:34:23 2009 +0100

    Note slow kernel boot times for F11/12.

commit b56d67859c6835e9a33e9099b0eccbe02bca12d2
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 16 12:38:06 2009 +0100

    Updated TODO, BUGS.

commit 3eba057f5a16300eff4247d7beb4a3f51c094b1d
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 16 11:39:22 2009 +0100

    Added Python documentation.

commit 7e47aaa137128982fa6ee514c4b714c515819afb
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 16 01:31:19 2009 +0100

    Really needs qemu 0.10 for vmchannel support.

commit ce6c6978eedadcf2235dc1ac83bc0868f58c532b
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 15 23:58:11 2009 +0100

    0.9.9 for final cleanups before 1.0 release.

commit 05712b2457a44ee0f0020eced77db03c2aa419a1
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 15 23:54:51 2009 +0100

    'guestfish edit' commands and several bugfixes.

commit 54a6c3212ce1f942979639d2f2bd726414fff7c2
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 15 20:38:01 2009 +0100

    Started BUGS list.

commit 612a358b8935381e5b8d706e4a77689cd316a18d
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 15 20:27:30 2009 +0100

    Move guestfish 'alloc' command to a separate file.

commit 76f1a7d9941ba5b4ebc9e574cf9ee97e50294586
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 15 17:59:43 2009 +0100

    Version 0.9.3.

commit 4905c1ae8b12577943b53fd7b23187f5a59f07f0
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 15 17:58:35 2009 +0100

    Show byte sizes in example.

commit b348eacbc4d84337856cf7cca518d61c63e92631
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 15 17:48:54 2009 +0100

    Generated code for blockdev_* calls, RInt64, enhanced tests.

commit e038597ebd1e43c83a8ddde21c4f1898eb7a9a98
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 15 17:47:34 2009 +0100

    Added blockdev_* calls.  RInt64 type.  Enhanced tests.

commit 706c75629733d05a891a81eebe373d124409cfb8
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 15 16:04:27 2009 +0100

    Be strict about commands which don't test themselves, warn about missing tests.

commit 52471f572ec036a76bc977bcf39cfab179dfbc13
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 15 16:00:10 2009 +0100

    Version 0.9.2.

commit 3e9f98d0f73ec483b970c19ad1752acc380c38b9
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 15 14:19:03 2009 +0100

    Display ext2/3 details, and some bug fixes.

commit 0c2376a5c05053ce6a0479ade544be860c400fdb
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 15 14:09:01 2009 +0100

    Correctly free memory in RHashtable binding for OCaml & Python.

commit ad5abc8d367c9c410051062cae066b1b141b4c76
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 15 13:59:07 2009 +0100

    Generated code for tune2fs-l command and RHashtable return type.

commit d5ae4a54e83018687ec05255bc39e7f5ab71a453
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 15 13:58:44 2009 +0100

    Added tune2fs-l command and RHashtable return type.

commit 7fe2b338e4102a23ecd2f89b447b7618f0e93312
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 15 12:34:18 2009 +0100

    Added to-xml program.

commit 197f0ceeac625a20b923b274c6025eb0ccaeaed1
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 15 10:52:37 2009 +0100

    Remove 'df' program from examples - didn't ever work.

commit 6bcbe54b5785cb8c911ccf4b724ae6abfdf53ce4
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 15 10:45:01 2009 +0100

    Generated code for stat/lstat/statvfs changes.

commit 212a55d483c2a20e61f42211c0c64aab3645cb09
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 15 10:44:27 2009 +0100

    Added stat, lstat, statvfs and associated stat structures.

commit 946eec285f634e51b3ea6416a6d7947427c66797
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 14 20:47:51 2009 +0100

    Quoting in guestfish.

commit 8d898dadd931a9bb27202bb26f51828debb27906
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 14 16:16:34 2009 +0100

    Version 0.9.1

commit d268e64fe76944dc042e7ec68a65e59a6cff16ce
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 14 15:52:04 2009 +0100

    Added bindings for GNU readline.

commit 374af1d1c85580a7768967bf2f199f10182b011e
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 14 14:38:31 2009 +0100

    Better handling of trailing \n problem.

commit 5a563bbd9b2779640e3358f4bf1eaac622b58cae
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 14 14:20:47 2009 +0100

    Typos and documentation updates.

commit 98a43eba2fe2b18f5042138556c6beede0277223
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 14 14:20:07 2009 +0100

    Generated changes to perl XS bindings.

commit 5365ebd501850ea10d9a5b28fc6480ea34dbe16d
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 14 13:51:12 2009 +0100

    Add 'command' and 'command-lines'. Fix args freeing in Perl bindings.

commit 161018ed1e90c796e6e099859979da02d5f3e410
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 14 13:09:06 2009 +0100

    Fix 'file(1)' command to work on /dev devices.

commit adefe14e308a0f8cf73f9c60693a3dbbded157b9
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 13 23:58:33 2009 +0100

    Generated files for file(1) command.

commit 42283403886da648bb239177369aa65c0a659255
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 13 23:58:02 2009 +0100

    Added file(1) command.

commit a29a2e99ce120415941894da45087a360e6c65d3
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 13 23:57:26 2009 +0100

    Note a bug.

commit 2a243cfbe1938d324ac6445aa2917ec3db0d8c50
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 13 20:13:06 2009 +0100

    guestfs -> GuestFS

commit 55e302bb1002e236afc9b2d33aa47128b8542133
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 13 20:07:03 2009 +0100

    Python files.  Add $QUICK_RPMBUILD flag to avoid running tests.

commit 4ee9666a388f771e9b353dbedc90f52a73bb86e1
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 13 20:06:46 2009 +0100

    Install guestfs.py

commit f286a81cab9059ef3be51bf745e2903e065b36ea
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 13 19:40:50 2009 +0100

    Missing dependency.

commit ec89b939882564b0f7a481298e06111b7578d60d
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 13 19:39:39 2009 +0100

    Describe all available bindings.

commit 632d452727d32905627037e295aca38ce0b38f57
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 13 19:39:20 2009 +0100

    Need to package generator.ml -- oops.

commit 0344eb0b3cbbaaf0529c4e0d8f13db6199a407db
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 13 19:15:22 2009 +0100

    Prepare for 0.9 release.

commit adcf5dc6aa53c02877e6bc16e211b7062a8ea33c
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 13 19:15:12 2009 +0100

    Extra CLEANFILES.

commit 70c2ffc39677a9f5eb6b2230cb9ca2606b2fd966
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 13 19:10:10 2009 +0100

    Additional test programs for Perl, Python, OCaml bindings.

commit b3f11c5f62f725fa3f09452b38d52dba764f80d0
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 13 18:32:03 2009 +0100

    Lots, mainly Python bindings.

commit f968f6c36fda3bb66cd37cd56de250c29afa7698
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 13 10:33:44 2009 +0100

    Stricter checks on short descriptions.

commit b6722e6313e955ad0c1e4e4ec594c8e74cdd27af
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 13 10:27:20 2009 +0100

    OCaml bindings build using the installed, not built, library.

commit 848fd706616ca65be7f74b48b39c95363640a187
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 13 00:51:56 2009 +0100

    Old versions of augeas lack aug_load, aug_defvar, aug_node.  Check for those calls.

commit d68cce2e307fe13616a66c52f88ddf87bfae9c6a
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 13 00:29:00 2009 +0100

    Version 0.8.1

commit 7e7b2d30b13c2daad59995c06392cb4b24ffa9e6
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Apr 12 23:54:49 2009 +0100

    Distribute TODO file.

commit b7c9d26ddeb1f230c1eb4435f3893af0054cfdf7
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Apr 12 22:27:04 2009 +0100

    Fix looping bug in parse_string_list, and remove debug message.

commit f1a10c6285cca30f8c9491ae08951137457bb018
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Apr 12 19:01:07 2009 +0100

    More BuildRequires.

commit 6174ef5c2859309b1b648bc96145df095312e6e7
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Apr 12 11:57:53 2009 +0100

    More TODO items.

commit 819efe7df8b0f9a48e0ef59cbb5bdccc99c9c6d5
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Apr 12 09:42:32 2009 +0100

    Add BR qemu (required to run the tests).

commit 0102b0cc9ba68155795eb0ab1ad3bb9f9f29368d
Author: Richard Jones <rjones@redhat.com>
Date:   Sun Apr 12 09:42:19 2009 +0100

    Added some ideas in TODO file.

commit 8eadcfd57d79d92d8366a86bbd220912ac735d3e
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 11 18:04:49 2009 +0100

    Minor adjustments for 0.8 release.

commit c169a0bb9ddde5b61045d95fb2728b43751488f1
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 11 17:30:57 2009 +0100

    Don't delete examples/Makefile.

commit b4d2a01828e5de85e5eee3631f7fe3925a0312ca
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 10 18:25:07 2009 +0100

    Added test suite.

commit 99f68f259f92eee884c6c7396f61b9c16e2bf354
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 10 15:10:29 2009 +0100

    Added test framework, no tests implemented yet.

commit c7f85827cf89a088fa85808202edc75c820fd14e
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 10 15:06:29 2009 +0100

    Need to set LD_LIBRARY_PATH so we pick up the right C library.

commit 286841877f4223d67ec00b83e5a2aabfbb9e19ed
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 10 12:53:28 2009 +0100

    Generated files for previous commands.

commit 44da812b424f5e10e268d47149d012d49edf858b
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 10 12:52:49 2009 +0100

    New commands: rm rmdir rm-rf mkdir mkdir-p chmod chown

commit dd0432e2efc2e22ddbc9fb0a2746ee1c6a9c582f
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 10 12:47:34 2009 +0100

    CHROOT_OUT must preserve errno.

commit 1c8f9c274adb342b263d083f0ac0c24e4b600974
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 10 12:47:04 2009 +0100

    Fix off-by-one error in Augeas wrapper code.

commit 95de8eea73b6fc105de728aad7571cfd0042666f
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 10 11:49:51 2009 +0100

    Change Err -> RErr for consistency with other return types.

commit 71fa671c6dd4decccb3d99941a5d02b0d13e0152
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 10 10:55:28 2009 +0100

    Documentation fix.

commit e61494eb0755d5323e04d8dca3867a154965092a
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 10 10:52:38 2009 +0100

    Code cleanup.

commit 3acec39588bd574a616fa0671a29cd1280f356fb
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 10 10:46:50 2009 +0100

    Add more function checking.

commit 469224a9eca9b575063e6a1ca1b1d97adb3448cb
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 10 10:26:10 2009 +0100

    Just use plain lists for argument representation.

commit 7c71920ab4f1b1beea3e1a38b91e2d81922d6cfb
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 10 10:19:00 2009 +0100

    Documentation fixes.

commit fb19874b1e1c40f3f5efafb39151b1bfc3ef725e
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 10 10:13:59 2009 +0100

    Correction in the aug-ls documentation.

commit d19ceb226c242844467b2935c1e19b989b4315e8
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 9 19:47:22 2009 +0100

    Remove *~ files when doing 'make clean'.

commit 2834059b2ac047bc099ed7617c4f6174d441d7e1
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 9 19:42:22 2009 +0100

    Documentation update.

commit 7e948f45852e4aab24775200da4b0de3c5904bdc
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 9 19:36:49 2009 +0100

    Bumped version number.

commit 01c26253a12ed1e6b1199f8c85f049a7fc4aef28
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 9 19:36:07 2009 +0100

    Added aug-ls (generated code).

commit 0677b12f2273ed266da9dd276c129342d6a939a2
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 9 19:35:16 2009 +0100

    Add aug-ls command (non-generated code).

commit 42643f08970c2efa5cb71a92166fbe323474c203
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 9 17:42:15 2009 +0100

    No need for mirror, add HTML docs to subpackages.

commit c989e8832df70b4cb8200ba8d5622048e560f1f7
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 9 17:42:01 2009 +0100

    Distribute the pod.css file.

commit 233595cc4e3c3422a5f5d8aec3314029da3f0ec7
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 9 16:48:46 2009 +0100

    Generate webpages.

commit e7eca50046e9a69dac27c0bee832af0a3014e02c
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 9 13:19:38 2009 +0100

    Added Augeas support.

commit a2e1d51acda406fd4193f121ac9f879e60cf4302
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 9 13:19:12 2009 +0100

    Updated HACKING notes about debugging.

commit c168ce1c91c8f4f615ec53e140970e0017ad750d
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 8 23:47:31 2009 +0100

    Generated code for new guestfs_read_lines API call.

commit f4299f7ea55c4bbc9302e102d2fc801829e75ef6
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 8 23:47:28 2009 +0100

    Definition and implementation of new guestfs_read_lines API call.

commit 45f3a8981723079a5a020ab9438593531b1d8368
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 8 23:13:31 2009 +0100

    Version 0.6

commit bf26360e5e91148a4479f812c2b43acce4f5884e
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 8 23:06:51 2009 +0100

    Added OCaml examples.

commit 13339826ea01f8dbd581b5d2544e7692171cf386
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 8 22:52:11 2009 +0100

    OCaml bindings compile.

commit 94050e0344685b6916e21581e618ad3e85795008
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 8 20:26:35 2009 +0100

    Many non-daemon functions are now auto-generated.

commit b5ff6816face6f8c1700d4f1df752c710620ff95
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 8 17:19:09 2009 +0100

    Version 0.5: Numerous small fixes to make rpmbuild work again.

commit c3168fc03cdff6be5638107b12f74bc895af55ed
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 8 15:22:29 2009 +0100

    Added more Perl bindings tests.

commit 447b96e57cdf40ddc3b7669ba65dbea961748f71
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 8 15:08:10 2009 +0100

    Bug fix: Trailing whitespace from 'pvs' command.

commit 9908e03e922b670437bcd89b6873f9ebc914567e
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 8 15:02:39 2009 +0100

    Fixed Perl bindings, they now work properly.

commit 00e309d3608661eaa8c9cc69ba5bf175c612698d
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 8 13:54:19 2009 +0100

    Ignore perl/Guestfs.bs file.

commit 0d112d58af8b2c28de9ee4ae5b0ed3527757bdfe
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 8 13:46:21 2009 +0100

    Updated generated files.

commit 562efcba335bc726954ed2ebcd75ece9c3aba41f
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 8 13:46:05 2009 +0100

    Mention OCaml & Perl bindings in introduction.  Error handlers must copy 'msg' if they want to stash it.

commit 622bc0af28dab528b04b50c74d34813dd2428bd1
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 8 13:45:14 2009 +0100

    File was removed, updated dependencies.

commit 5828e17afdc2fe22947ca68f879e2071359f5f81
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 8 13:44:46 2009 +0100

    Need to distribute OCaml bits even if OCaml not found.

commit 1ee6da96efe8340a7d3904a865d80cd59d9d3fde
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 8 13:44:13 2009 +0100

    First version of Perl bindings, compiled but not tested.

commit 8dcc88f867ab0bed24df49d8c0f347f1357bfffd
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 8 13:42:26 2009 +0100

    Added a note that I'm not going to do Python bindings for now.

commit 4144e2106cc70ad8f1e081b57da09f9c1e276812
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 7 16:52:25 2009 +0100

    Outline OCaml bindings.

commit 21ba59ce3cbc594ce9c7aeecd4dadb8430e4042d
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 7 14:55:25 2009 +0100

    Added guestfish(1) manpage.

commit bccbfe5ab55c8aa5bbb0fb6e209936ff1359605a
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 7 13:51:12 2009 +0100

    Fix: "aclocal: couldn't open directory `m4': No such file or directory"

commit acf9000252da7f4f3fde693ecc03461007cf0bf9
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 7 13:08:50 2009 +0100

    Added framework for the language bindings.

commit dfb90f793a40d38da47ee1b604ed0a73a05281d0
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 7 11:06:28 2009 +0100

    New header file.

commit 4af6b4777ae5ec3109f8a99c61ff84c3a5123abc
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 7 11:06:23 2009 +0100

    Remove unnecessary kernel drivers.  Big reduction in image size.

commit af92796e0308b31c9a6167e1c7bde6510ca409d7
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 7 10:42:15 2009 +0100

    Fix incorrect realloc size which was causing 'ls' command to fail on large directories.

commit 6085137e65cb63aaf725207f2929a571d1149420
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 7 10:25:46 2009 +0100

    Implement simple lvs/vgs/pvs commands.

commit 7ea56c8d0bca01a602df8e87e52d90c5b44e2cc2
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 7 09:52:46 2009 +0100

    Rename pvs -> pvs-full (etc), so we can add simple pvs (etc) commands.

commit 73d6932ab2dd3f9120a1f4a532621c07cb174705
Author: Richard Jones <rjones@redhat.com>
Date:   Tue Apr 7 06:50:31 2009 +0100

    pvs/vgs/lvs commands working now.

commit 8e570870f577ff0c3db074f88924633b559af5d4
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 6 12:55:26 2009 +0100

    Implement list-devices and list-partitions.

commit 1cf85b1e60e85c4940869c6291d75ac44a5bd190
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 6 11:44:48 2009 +0100

    Implementations of 'cat', 'ls', and some cleanups.

commit bf17bf81fef275892d24458ce5f1e5290b426742
Author: Richard Jones <rjones@redhat.com>
Date:   Mon Apr 6 11:43:14 2009 +0100

    Debugging tips.

commit e5e9541f2de4af37bca98633aa75f9f9533a07db
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 4 16:52:52 2009 +0100

    Fix incorrect short description of 'cat' command

commit 843514eef9dc6d04d71e031ba9ddb16e2beb9a04
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 4 16:38:28 2009 +0100

    Implement RString and RStringList return types.
     - implement 'll' command.
     - outlines for 'ls' and 'cat' commands.

commit eb50cde931893e54c5aa9816cbca49e36891be8f
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 4 14:51:48 2009 +0100

    Implement the alloc shell command.

commit fdeae81d81e979d74059f01350e94dbf37700075
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 4 14:51:31 2009 +0100

    guest_add_{drive,cdrom} now test if the files exist.

commit f0624da341ceadf637c700fa91727707bd44b41a
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 4 13:17:46 2009 +0100

    Add %post and %postun.

commit 6941420efeefc48100a545806271af2de92dda26
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 4 13:17:32 2009 +0100

    Fix parsing of paths with more than one element.

commit 8358ea9524509c02448fe52d5bea205c9c3f869e
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 4 12:54:47 2009 +0100

    LIBGUESTFS_PATH implementation.

commit 017b503c3bf79ad87cd66f73d36b4be5b31d10ad
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 4 11:29:44 2009 +0100

    Document --add and --mount options.

commit 236b5295bf3e497153a5cae9708c3d0249f2daf6
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 4 11:27:26 2009 +0100

    Mostly working spec file.

commit c9cc61940b41b1abb763a1932adfc3461372c10b
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 4 10:41:34 2009 +0100

    Implemented autosync, make it the default for guestfish.

commit 64a5ae0e969754c709974104a83e6d1dbb4c2764
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 4 10:29:25 2009 +0100

    Generate actions section in guestfs.3 man page.

commit 6d37b7698c1e2add43f0e8908e1bc30700f95f7e
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 4 09:40:44 2009 +0100

    Implemented running actions in guestfish.

commit b4c040d30e2677313a892ffe4cde0d53e446da7d
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 4 01:49:36 2009 +0100

    More tidy up of messages.

commit 76f3ea8fb3318966c376bc6fbccbd5a81a9ec564
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 4 01:40:43 2009 +0100

    Command line, help.

commit 4567839859befc5aa9e1eee942dc2ba0701516e2
Author: Richard Jones <rjones@redhat.com>
Date:   Sat Apr 4 00:58:40 2009 +0100

    Command line and interactive shell parsing, prompts etc.

commit bc0b3d6f473e607972d29be27f7ae6b1d0489c3b
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 3 23:47:47 2009 +0100

    Added outline of shell command, added generator support.

commit b72ec21d24824720385c9cd024b7f1eae734f4a4
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 3 22:45:42 2009 +0100

    Small updates to the generator.

commit 99bd425a0a8fb02c27e0c22b32dafa804773a7b1
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 3 22:25:34 2009 +0100

    Implemented 'mount' and 'touch' commands.

commit f5d2602bf6d40ecc71a5a17e0be9f480e9a4453a
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 3 22:24:32 2009 +0100

    Added a HACKING file.

commit 8ae9f67a1767c44ce1650d54665d1e7936181603
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 3 20:30:42 2009 +0100

    Added images/ directory for test images, and one image.

commit 316bbc36662c0df6b3d0ad48790e0b551a291df6
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 3 19:51:02 2009 +0100

    Parses return values and returned errors properly.

commit ff1f39794b2688f0fd6a0c367164e3d715136837
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 3 19:16:27 2009 +0100

    Make the partition configurable.

commit e83181345f8bedc8c3196184f3e3274c6a1c41a3
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 3 19:13:48 2009 +0100

    Added README file for examples directory.

commit 3906e4ff91c208e0ae90ab8b18e69e678a9bed8e
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 3 19:11:44 2009 +0100

    No verbose.  User can enable by setting LIBGUESTFS_DEBUG=1 if they want.

commit 9c5ea364505f9f2553a20e93b78a61e3953eacf8
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 3 19:11:29 2009 +0100

    Pass -no-kqemu parameter to avoid warning about kqemu.

commit d134143b55ecb5f7e6f74318acbf04f9e1370af6
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 3 19:08:19 2009 +0100

    Makes a series of non-trivial calls.

commit 40ca9a57829f2e82362e391d7d998bf33c8bd671
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 3 17:24:35 2009 +0100

    Daemon and library are mostly talking to each other now.

commit cd2fd58da3f5648a62f3fb7586cdc910c09a31af
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 3 17:23:33 2009 +0100

    Remove initramfs/fakelog.root if make-initramfs fails.

commit 1fbc83c9c265e3942e9799289584c66f7d5d6cf5
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 3 17:23:03 2009 +0100

    Remove NFS support - we will probably use FTP instead.

commit 55bf8fd622e9f84364b505db6591ace3ec2b5447
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 3 11:29:55 2009 +0100

    Lots more auto-generation.

commit a8b84fe17f5df830d3498ecf885e52f0914182dd
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 3 11:27:52 2009 +0100

    Set up ethernet interface.

commit 8d0068a752ee8e6bc223de5cb7cac5d190a8855e
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 3 01:15:17 2009 +0100

    Start the generated code and code generator.

commit 15dbb6973a7af11b81df047194228ea86d46939b
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 3 01:14:44 2009 +0100

    Add the first version of the guestfsd daemon.

commit 207056e82372093fa5bc678a9e55a2abc33704fa
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 3 01:13:42 2009 +0100

    Add update-initramfs.sh.in so we don't need to rebuild initramfs for
    small changes in the daemon.

commit 11d20e2b9f7dc1becba30d16c378c704a3ad1f50
Author: Richard Jones <rjones@redhat.com>
Date:   Fri Apr 3 01:12:21 2009 +0100

    Updated to newer GPLv2 document.

commit 56465eb694ba2077de37e66600c7bef96061cbe4
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 2 20:55:41 2009 +0100

    Correctly handle the case when select runs out of filehandles.

commit 163e399a001a300a53a4c99887742608d23e09ad
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 2 20:46:55 2009 +0100

    Code to handle the daemon communications socket.

commit 88f69eb03160a62d38a361a5ad68c6ba1e767a20
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 2 20:07:21 2009 +0100

    Guest boots, and basic select/callbacks work.

commit e94fca28c7503464c6ef0a9739c0d22741ef4dce
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 2 17:00:13 2009 +0100

    Ignore generated manual page.

commit 27146d368a4956a44c59d1a7fea4ab92685e080c
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 2 15:15:55 2009 +0100

    More documentation updates.

commit 82dd4b8a308dc97acabf37551bb780434f5e497a
Author: Richard Jones <rjones@redhat.com>
Date:   Thu Apr 2 12:10:59 2009 +0100

    More documentation.

commit 5de49dc0d82a86032eb51e2cb9e43813e2480594
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 1 20:29:03 2009 +0100

    Documentation of low-level API.

commit fddf794d1a4446c94f652af4eeba37a599355e6f
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 1 16:08:23 2009 +0100

    Add test-boot-realistic target.

commit fe6820c1bbaec015a883804545362a8c9b6b4583
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 1 16:08:01 2009 +0100

    Correct permissions problem in root filesystem by using febootstrap-run
    properly.

commit 6ed48042e4a8b009b5e38efbf4766a2676a33935
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 1 12:57:45 2009 +0100

    Various fixes to the build system, add 'make test-boot-image' target.

commit 002cdf48fee7a59d13865ea9848671b588e86daf
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 1 12:57:25 2009 +0100

    Run autoreconf with -i parameter.

commit 7ec96575f7cd74615f1ead8bc834bc07c3dc2999
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 1 12:57:10 2009 +0100

    More files to ignore.

commit 8c07ad6191e2a13cf240a47dbed72afdc4010aa4
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 1 12:56:49 2009 +0100

    Print size of kernel, don't need to delete gnome/help any more.

commit 1a2deb2bcdb0c8ec509b1d98805e0fc46122c5a9
Author: Richard Jones <rjones@redhat.com>
Date:   Wed Apr 1 12:53:40 2009 +0100

    Moved .cvsignore -> .gitignore.

commit 863d13ea1aadddc122ad82f4dad20e73231b48f2
Author: rjones <rjones>
Date:   Tue Mar 24 14:15:13 2009 +0000

    Build the initramfs.

commit 91df7a164befc0c9a24f85733837874da5a057ac
Author: rjones <rjones>
Date:   Tue Mar 24 09:38:31 2009 +0000

    Now using febootstrap.

commit 09c16b5da0ec982bfffe654a55abd637a3335c95
Author: rjones <rjones>
Date:   Wed Mar 4 13:18:48 2009 +0000

    Starts up QEMU now

commit b6233d1fff5d9a6bbc61e7123a57bdd7d8cbc792
Author: rjones <rjones>
Date:   Tue Mar 3 15:35:50 2009 +0000

    Running qemu as a subprocess.

commit 407caabfd04a8bb6338a7fcf4f46d85d75e709df
Author: rjones <rjones>
Date:   Tue Mar 3 09:08:12 2009 +0000

    Final fixes to build environment, and added autogen.sh.

commit 28d760b1542da7ff83b18c4ca60c2d03f327c2f4
Author: rjones <rjones>
Date:   Tue Mar 3 08:58:37 2009 +0000

    Build environment set up for libguestfs.
